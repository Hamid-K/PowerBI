"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["lazy-modeling-dialogs"],{70049:function(De,J,p){p.d(J,{P:function(){return R},d:function(){return se}});var I=p(37419),e=p(73449),se={leading:!0,trailing:!1};function R(X,d){return void 0===d&&(d=se),function(B){return B.lift(new D(X,!!d.leading,!!d.trailing))}}var D=function(){function X(B,F,k){this.durationSelector=B,this.leading=F,this.trailing=k}return X.prototype.call=function(F,k){return k.subscribe(new M(F,this.durationSelector,this.leading,this.trailing))},X}(),M=function(X){function d(F,k,T,w){var W;return(W=X.call(this,F)||this).destination=F,W.durationSelector=k,W._leading=T,W._trailing=w,W._hasValue=!1,W}(0,I.Z)(d,X);var B=d.prototype;return B._next=function(k){this._hasValue=!0,this._sendValue=k,this._throttled||(this._leading?this.send():this.throttle(k))},B.send=function(){var T=this._sendValue;this._hasValue&&(this.destination.next(T),this.throttle(T)),this._hasValue=!1,this._sendValue=void 0},B.throttle=function(k){var T=this.tryDurationSelector(k);T&&this.add(this._throttled=(0,e.ft)(T,new e.IY(this)))},B.tryDurationSelector=function(k){try{return this.durationSelector(k)}catch(T){return this.destination.error(T),null}},B.throttlingDone=function(){var k=this._throttled,T=this._trailing;k&&k.unsubscribe(),this._throttled=void 0,T&&this.send()},B.notifyNext=function(){this.throttlingDone()},B.notifyComplete=function(){this.throttlingDone()},d}(e.Ds)},55862:function(De,J,p){p.d(J,{p:function(){return D}});var I=p(37419),e=p(47875),se=p(96721),R=p(70049);function D(B,F,k){return void 0===F&&(F=se.P),void 0===k&&(k=R.d),function(T){return T.lift(new M(B,F,k.leading,k.trailing))}}var M=function(){function B(k,T,w,W){this.duration=k,this.scheduler=T,this.leading=w,this.trailing=W}return B.prototype.call=function(T,w){return w.subscribe(new X(T,this.duration,this.scheduler,this.leading,this.trailing))},B}(),X=function(B){function F(T,w,W,ae,x){var Y;return(Y=B.call(this,T)||this).duration=w,Y.scheduler=W,Y.leading=ae,Y.trailing=x,Y._hasTrailingValue=!1,Y._trailingValue=null,Y}(0,I.Z)(F,B);var k=F.prototype;return k._next=function(w){this.throttled?this.trailing&&(this._trailingValue=w,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(d,this.duration,{subscriber:this})),this.leading?this.destination.next(w):this.trailing&&(this._trailingValue=w,this._hasTrailingValue=!0))},k._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},k.clearThrottle=function(){var w=this.throttled;w&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),w.unsubscribe(),this.remove(w),this.throttled=null)},F}(e.L);function d(B){B.subscriber.clearThrottle()}},69872:function(De,J,p){var I=this&&this.__extends||function(){var D=function(X,d){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,F){B.__proto__=F}||function(B,F){for(var k in F)F.hasOwnProperty(k)&&(B[k]=F[k])})(X,d)};return function(M,X){function d(){this.constructor=M}D(M,X),M.prototype=null===X?Object.create(X):(d.prototype=X.prototype,new d)}}(),e=p(12878),se=p(55914),R=function(D){function M(X){var d=D.call(this)||this;return d._value=X,d}return I(M,D),Object.defineProperty(M.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),M.prototype._subscribe=function(X){var d=D.prototype._subscribe.call(this,X);return d&&!d.closed&&X.next(this._value),d},M.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new se.ObjectUnsubscribedError;return this._value},M.prototype.next=function(X){D.prototype.next.call(this,this._value=X)},M}(e.Subject);J.BehaviorSubject=R},13502:function(De,J,p){var I=p(92994),e=p(21468),se=p(21886),R=p(89962),D=p(57055),M=function(){function d(B){this._isScalar=!1,B&&(this._subscribe=B)}return d.prototype.lift=function(B){var F=new d;return F.source=this,F.operator=B,F},d.prototype.subscribe=function(B,F,k){var T=this.operator,w=e.toSubscriber(B,F,k);if(w.add(T?T.call(w,this.source):this.source||D.config.useDeprecatedSynchronousErrorHandling&&!w.syncErrorThrowable?this._subscribe(w):this._trySubscribe(w)),D.config.useDeprecatedSynchronousErrorHandling&&w.syncErrorThrowable&&(w.syncErrorThrowable=!1,w.syncErrorThrown))throw w.syncErrorValue;return w},d.prototype._trySubscribe=function(B){try{return this._subscribe(B)}catch(F){D.config.useDeprecatedSynchronousErrorHandling&&(B.syncErrorThrown=!0,B.syncErrorValue=F),I.canReportError(B)&&B.error(F)}},d.prototype.forEach=function(B,F){var k=this;return new(F=X(F))(function(T,w){var W;W=k.subscribe(function(ae){try{B(ae)}catch(x){w(x),W&&W.unsubscribe()}},w,T)})},d.prototype._subscribe=function(B){var F=this.source;return F&&F.subscribe(B)},d.prototype[se.observable]=function(){return this},d.prototype.pipe=function(){for(var B=[],F=0;F<arguments.length;F++)B[F]=arguments[F];return 0===B.length?this:R.pipeFromArray(B)(this)},d.prototype.toPromise=function(B){var F=this;return new(B=X(B))(function(k,T){var w;F.subscribe(function(W){return w=W},function(W){return T(W)},function(){return k(w)})})},d.create=function(B){return new d(B)},d}();function X(d){if(d||(d=D.config.Promise||Promise),!d)throw new Error("no Promise impl found");return d}J.Observable=M},11312:function(De,J,p){var I=p(57055),e=p(65122);J.empty={closed:!0,next:function(R){},error:function(R){if(I.config.useDeprecatedSynchronousErrorHandling)throw R;e.hostReportError(R)},complete:function(){}}},12878:function(De,J,p){var I=this&&this.__extends||function(){var k=function(w,W){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ae,x){ae.__proto__=x}||function(ae,x){for(var Y in x)x.hasOwnProperty(Y)&&(ae[Y]=x[Y])})(w,W)};return function(T,w){function W(){this.constructor=T}k(T,w),T.prototype=null===w?Object.create(w):(W.prototype=w.prototype,new W)}}(),e=p(13502),se=p(66061),R=p(86044),D=p(55914),M=p(95066),X=p(976),d=function(k){function T(w){var W=k.call(this,w)||this;return W.destination=w,W}return I(T,k),T}(se.Subscriber);J.SubjectSubscriber=d;var B=function(k){function T(){var w=k.call(this)||this;return w.observers=[],w.closed=!1,w.isStopped=!1,w.hasError=!1,w.thrownError=null,w}return I(T,k),T.prototype[X.rxSubscriber]=function(){return new d(this)},T.prototype.lift=function(w){var W=new F(this,this);return W.operator=w,W},T.prototype.next=function(w){if(this.closed)throw new D.ObjectUnsubscribedError;if(!this.isStopped)for(var W=this.observers,ae=W.length,x=W.slice(),Y=0;Y<ae;Y++)x[Y].next(w)},T.prototype.error=function(w){if(this.closed)throw new D.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=w,this.isStopped=!0;for(var W=this.observers,ae=W.length,x=W.slice(),Y=0;Y<ae;Y++)x[Y].error(w);this.observers.length=0},T.prototype.complete=function(){if(this.closed)throw new D.ObjectUnsubscribedError;this.isStopped=!0;for(var w=this.observers,W=w.length,ae=w.slice(),x=0;x<W;x++)ae[x].complete();this.observers.length=0},T.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},T.prototype._trySubscribe=function(w){if(this.closed)throw new D.ObjectUnsubscribedError;return k.prototype._trySubscribe.call(this,w)},T.prototype._subscribe=function(w){if(this.closed)throw new D.ObjectUnsubscribedError;return this.hasError?(w.error(this.thrownError),R.Subscription.EMPTY):this.isStopped?(w.complete(),R.Subscription.EMPTY):(this.observers.push(w),new M.SubjectSubscription(this,w))},T.prototype.asObservable=function(){var w=new e.Observable;return w.source=this,w},T.create=function(w,W){return new F(w,W)},T}(e.Observable);J.Subject=B;var F=function(k){function T(w,W){var ae=k.call(this)||this;return ae.destination=w,ae.source=W,ae}return I(T,k),T.prototype.next=function(w){var W=this.destination;W&&W.next&&W.next(w)},T.prototype.error=function(w){var W=this.destination;W&&W.error&&this.destination.error(w)},T.prototype.complete=function(){var w=this.destination;w&&w.complete&&this.destination.complete()},T.prototype._subscribe=function(w){return this.source?this.source.subscribe(w):R.Subscription.EMPTY},T}(B);J.AnonymousSubject=F},95066:function(De,J,p){var I=this&&this.__extends||function(){var R=function(M,X){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,B){d.__proto__=B}||function(d,B){for(var F in B)B.hasOwnProperty(F)&&(d[F]=B[F])})(M,X)};return function(D,M){function X(){this.constructor=D}R(D,M),D.prototype=null===M?Object.create(M):(X.prototype=M.prototype,new X)}}(),se=function(R){function D(M,X){var d=R.call(this)||this;return d.subject=M,d.subscriber=X,d.closed=!1,d}return I(D,R),D.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var M=this.subject,X=M.observers;if(this.subject=null,X&&0!==X.length&&!M.isStopped&&!M.closed){var d=X.indexOf(this.subscriber);-1!==d&&X.splice(d,1)}}},D}(p(86044).Subscription);J.SubjectSubscription=se},66061:function(De,J,p){var I=this&&this.__extends||function(){var F=function(T,w){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(W,ae){W.__proto__=ae}||function(W,ae){for(var x in ae)ae.hasOwnProperty(x)&&(W[x]=ae[x])})(T,w)};return function(k,T){function w(){this.constructor=k}F(k,T),k.prototype=null===T?Object.create(T):(w.prototype=T.prototype,new w)}}(),e=p(67793),se=p(11312),R=p(86044),D=p(976),M=p(57055),X=p(65122),d=function(F){function k(T,w,W){var ae=F.call(this)||this;switch(ae.syncErrorValue=null,ae.syncErrorThrown=!1,ae.syncErrorThrowable=!1,ae.isStopped=!1,arguments.length){case 0:ae.destination=se.empty;break;case 1:if(!T){ae.destination=se.empty;break}if("object"==typeof T){T instanceof k?(ae.syncErrorThrowable=T.syncErrorThrowable,ae.destination=T,T.add(ae)):(ae.syncErrorThrowable=!0,ae.destination=new B(ae,T));break}default:ae.syncErrorThrowable=!0,ae.destination=new B(ae,T,w,W)}return ae}return I(k,F),k.prototype[D.rxSubscriber]=function(){return this},k.create=function(T,w,W){var ae=new k(T,w,W);return ae.syncErrorThrowable=!1,ae},k.prototype.next=function(T){this.isStopped||this._next(T)},k.prototype.error=function(T){this.isStopped||(this.isStopped=!0,this._error(T))},k.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},k.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,F.prototype.unsubscribe.call(this))},k.prototype._next=function(T){this.destination.next(T)},k.prototype._error=function(T){this.destination.error(T),this.unsubscribe()},k.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},k.prototype._unsubscribeAndRecycle=function(){var T=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=T,this},k}(R.Subscription);J.Subscriber=d;var B=function(F){function k(T,w,W,ae){var x=F.call(this)||this;x._parentSubscriber=T;var Y,S=x;return e.isFunction(w)?Y=w:w&&(Y=w.next,W=w.error,ae=w.complete,w!==se.empty&&(S=Object.create(w),e.isFunction(S.unsubscribe)&&x.add(S.unsubscribe.bind(S)),S.unsubscribe=x.unsubscribe.bind(x))),x._context=S,x._next=Y,x._error=W,x._complete=ae,x}return I(k,F),k.prototype.next=function(T){if(!this.isStopped&&this._next){var w=this._parentSubscriber;M.config.useDeprecatedSynchronousErrorHandling&&w.syncErrorThrowable?this.__tryOrSetError(w,this._next,T)&&this.unsubscribe():this.__tryOrUnsub(this._next,T)}},k.prototype.error=function(T){if(!this.isStopped){var w=this._parentSubscriber,W=M.config.useDeprecatedSynchronousErrorHandling;if(this._error)W&&w.syncErrorThrowable?(this.__tryOrSetError(w,this._error,T),this.unsubscribe()):(this.__tryOrUnsub(this._error,T),this.unsubscribe());else if(w.syncErrorThrowable)W?(w.syncErrorValue=T,w.syncErrorThrown=!0):X.hostReportError(T),this.unsubscribe();else{if(this.unsubscribe(),W)throw T;X.hostReportError(T)}}},k.prototype.complete=function(){var T=this;if(!this.isStopped){var w=this._parentSubscriber;if(this._complete){var W=function(){return T._complete.call(T._context)};M.config.useDeprecatedSynchronousErrorHandling&&w.syncErrorThrowable?(this.__tryOrSetError(w,W),this.unsubscribe()):(this.__tryOrUnsub(W),this.unsubscribe())}else this.unsubscribe()}},k.prototype.__tryOrUnsub=function(T,w){try{T.call(this._context,w)}catch(W){if(this.unsubscribe(),M.config.useDeprecatedSynchronousErrorHandling)throw W;X.hostReportError(W)}},k.prototype.__tryOrSetError=function(T,w,W){if(!M.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{w.call(this._context,W)}catch(ae){return M.config.useDeprecatedSynchronousErrorHandling?(T.syncErrorValue=ae,T.syncErrorThrown=!0,!0):(X.hostReportError(ae),!0)}return!1},k.prototype._unsubscribe=function(){var T=this._parentSubscriber;this._context=null,this._parentSubscriber=null,T.unsubscribe()},k}(d);J.SafeSubscriber=B},86044:function(De,J,p){var I=p(76661),e=p(67633),se=p(67793),R=p(39258);function M(X){return X.reduce(function(d,B){return d.concat(B instanceof R.UnsubscriptionError?B.errors:B)},[])}J.Subscription=function(){function X(d){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,d&&(this._ctorUnsubscribe=!0,this._unsubscribe=d)}return X.prototype.unsubscribe=function(){var d;if(!this.closed){var B=this,F=B._parentOrParents,k=B._ctorUnsubscribe,T=B._unsubscribe,w=B._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,F instanceof X)F.remove(this);else if(null!==F)for(var W=0;W<F.length;++W)F[W].remove(this);if(se.isFunction(T)){k&&(this._unsubscribe=void 0);try{T.call(this)}catch(S){d=S instanceof R.UnsubscriptionError?M(S.errors):[S]}}if(I.isArray(w)){W=-1;for(var x=w.length;++W<x;){var Y=w[W];if(e.isObject(Y))try{Y.unsubscribe()}catch(Q){d=d||[],Q instanceof R.UnsubscriptionError?d=d.concat(M(Q.errors)):d.push(Q)}}}if(d)throw new R.UnsubscriptionError(d)}},X.prototype.add=function(d){var B=d;if(!d)return X.EMPTY;switch(typeof d){case"function":B=new X(d);case"object":if(B===this||B.closed||"function"!=typeof B.unsubscribe)return B;if(this.closed)return B.unsubscribe(),B;if(!(B instanceof X)){var F=B;(B=new X)._subscriptions=[F]}break;default:throw new Error("unrecognized teardown "+d+" added to Subscription.")}var k=B._parentOrParents;if(null===k)B._parentOrParents=this;else if(k instanceof X){if(k===this)return B;B._parentOrParents=[k,this]}else{if(-1!==k.indexOf(this))return B;k.push(this)}var T=this._subscriptions;return null===T?this._subscriptions=[B]:T.push(B),B},X.prototype.remove=function(d){var B=this._subscriptions;if(B){var F=B.indexOf(d);-1!==F&&B.splice(F,1)}},X.EMPTY=((d=new X).closed=!0,d),X;var d}()},57055:function(De,J){var p=!1;J.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(I){I&&new Error,p=I},get useDeprecatedSynchronousErrorHandling(){return p}}},21886:function(De,J){J.observable=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},976:function(De,J){J.rxSubscriber=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),J.$$rxSubscriber=J.rxSubscriber},55914:function(De,J){J.ObjectUnsubscribedError=function(){function I(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return I.prototype=Object.create(Error.prototype),I}()},39258:function(De,J){J.UnsubscriptionError=function(){function I(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(se,R){return R+1+") "+se.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return I.prototype=Object.create(Error.prototype),I}()},92994:function(De,J,p){var I=p(66061);J.canReportError=function(se){for(;se;){var M=se.destination;if(se.closed||se.isStopped)return!1;se=M&&M instanceof I.Subscriber?M:null}return!0}},65122:function(De,J){J.hostReportError=function(I){setTimeout(function(){throw I},0)}},90128:function(De,J){J.identity=function(I){return I}},76661:function(De,J){J.isArray=function(){return Array.isArray||function(p){return p&&"number"==typeof p.length}}()},67793:function(De,J){J.isFunction=function(I){return"function"==typeof I}},67633:function(De,J){J.isObject=function(I){return null!==I&&"object"==typeof I}},89962:function(De,J,p){var I=p(90128);function se(R){return 0===R.length?I.identity:1===R.length?R[0]:function(M){return R.reduce(function(X,d){return d(X)},M)}}J.pipe=function(){for(var R=[],D=0;D<arguments.length;D++)R[D]=arguments[D];return se(R)},J.pipeFromArray=se},21468:function(De,J,p){var I=p(66061),e=p(976),se=p(11312);J.toSubscriber=function(D,M,X){if(D){if(D instanceof I.Subscriber)return D;if(D[e.rxSubscriber])return D[e.rxSubscriber]()}return D||M||X?new I.Subscriber(D,M,X):new I.Subscriber(se.empty)}},35565:function(De,J,p){p.r(J),p.d(J,{LazyModelingDialogModule:function(){return Qh}});var Q,q,me,I=p(62458),e=p(50423),se=function(){function i(){}return Object.defineProperty(i.prototype,"originalCalendarName",{set:function(n){this._originalCalendarName=n,this._calendarName=n},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"calendarName",{set:function(n){this._calendarName=n},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"timeUnitColumnsMap",{set:function(n){this._timeUnitColumnsMap=n},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"oldCalendarName",{get:function(){return this._calendarName!==this._originalCalendarName?this._originalCalendarName:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"calendar",{get:function(){var n=!_.isEmpty(this._calendarName);if(I.fF.assert(function(){return n},"BuildCalendarService needs calendarName"),I.fF.assertValue(this._timeUnitColumnsMap,"BuildCalendarService needs timeUnitColumnsMap"),n&&this._timeUnitColumnsMap)return{name:this._calendarName,associations:Array.from(this._timeUnitColumnsMap.values())}},enumerable:!1,configurable:!0}),i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(n){return new(n||i)}}),i}(),R=p(9398),D=p(64647),M=p(72289),X=p(29329),d=p(81337),B=p(41627),F=p(34763),k=function(){function i(){this._onChange=new e.EventEmitter,this.notificationsSuspended=!1,this.subscriptions=new F.w}return Object.defineProperty(i.prototype,"onChange",{get:function(){return this._onChange.asObservable()},enumerable:!1,configurable:!0}),i.prototype.executeAsync=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,t()];case 1:return n=r.sent(),this.notifyChanges(),[2,n]}})})},i.prototype.execute=function(t){var n=t();return this.notifyChanges(),n},i.prototype.notifyChanges=function(){this.notificationsSuspended||this._onChange.emit()},i.prototype.subscribe=function(t,n){this.subscriptions.add(t.subscribe(function(r){n(r)}))},i.prototype.suspendNotifications=function(){return!this.notificationsSuspended&&(this.notificationsSuspended=!0,!0)},i.prototype.resumeNotifications=function(){this.notificationsSuspended=!1},i.prototype.unsubscribe=function(){this.subscriptions.unsubscribe()},i}(),T=function(){function i(){this.editorState={selectedRole:void 0,selectedTable:void 0},this.roles={}}return i.prototype.getFilter=function(t,n,r){return this.getFilterInGroup(this.getRoleTable(t,n).filtersGroup,r,!1)},i.prototype.getFilterInGroup=function(t,n,r){if(t.id===n)return r?void 0:t;for(var o=0,a=t.children;o<a.length;o++){var l=a[o];if(l.id===n)return r?t:l;if(l.isGroup()){var s=this.getFilterInGroup(l,n,r);if(s)return s}}},i.prototype.getFlatIndex=function(t,n,r){var o,a=r;if(t.id===n)return{index:a,found:!0};for(var s=!1,c=0,u=null!==(o=t?.children)&&void 0!==o?o:[];c<u.length;c++){var f=u[c];if(a++,f.id===n){s=!0;break}if(f.isGroup()){var v=this.getFlatIndex(f,n,a);if(a=v.index,v.found){s=!0;break}}}return{index:a,found:s}},i.prototype.getRole=function(t){return this.roles[t]},i.prototype.getRoles=function(){return _.values(this.roles).sort(function(t,n){return t.name.localeCompare(n.name)})},i.prototype.getRoleTable=function(t,n){var r;return null===(r=this.roles[t])||void 0===r?void 0:r.getTable(n)},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(n){return new(n||i)}}),i}(),w=p(8898),ae=function(){function i(){}return i.getUniqueName=function(t,n){if(n.indexOf(t)<0)return t;for(var a,r=/\d+/g,o=[];null!==(a=r.exec(t));){var l=a[0];o.push({value:Number.parseInt(l,void 0),prefix:t.substr(0,r.lastIndex-l.length),suffix:t.substr(r.lastIndex)})}for(var s=0,c=o=_.reverse(o);s<c.length;s++)for(var u=c[s],f=u.value+1;f<1e6;f++){var v=u.prefix+f+u.suffix;if(n.indexOf(v)<0)return v}return this.getUniqueName(t+" (2)",n)},i}(),x=function(i){return i.equals="FilterOperator_Equal",i.doesNotEqual="FilterOperator_DoesNotEqual",i.in="In",i.notIn="Not_In",i.greaterThan="FilterOperator_GreaterThan",i.greaterThanOrEqual="FilterOperator_GreaterThanOrEqual",i.lessThan="FilterOperator_LessThan",i.lessThanOrEqual="FilterOperator_LessThanOrEqual",i.isEmpty="FilterOperator_IsEmptyString",i.isNotEmpty="FilterOperator_IsNotEmptyString",i.isTrue="FilterOperator_IsTrue",i.isFalse="FilterOperator_IsFalse",i.isBlank="FilterOperator_IsBlank",i.isNotBlank="FilterOperator_IsNotBlank",i.dateIs="FilterOperator_Is",i.dateIsNot="FilterOperator_IsNot",i.dateIsAfter="FilterOperator_GreaterThan_DT",i.dateIsOnOrAfter="FilterOperator_GreaterThanOrEqual_DT",i.dateIsBefore="FilterOperator_LessThan_DT",i.dateIsOnOrBefore="FilterOperator_LessThanOrEqual_DT",i}({}),Y=p(28326),S=p(17819),Z=Y.dx.getCurrentCulture(),re=[x.dateIs,x.dateIsAfter,x.dateIsBefore,x.dateIsNot,x.dateIsOnOrAfter,x.dateIsOnOrBefore,x.isBlank,x.isNotBlank,x.in,x.notIn],ne=[x.equals,x.doesNotEqual,x.greaterThan,x.greaterThanOrEqual,x.isBlank,x.isNotBlank,x.lessThan,x.lessThanOrEqual,x.in,x.notIn],he=[x.isBlank,x.isNotBlank,x.isEmpty,x.isNotEmpty,x.isTrue,x.isFalse],_e=[{first:x.dateIs,second:x.equals},{first:x.dateIsNot,second:x.doesNotEqual},{first:x.dateIsAfter,second:x.greaterThan},{first:x.dateIsBefore,second:x.lessThan},{first:x.dateIsOnOrAfter,second:x.greaterThanOrEqual},{first:x.dateIsOnOrBefore,second:x.lessThanOrEqual}],Ae=((Q={}).Binary=_.values(x),Q.Boolean=[x.isTrue,x.isFalse,x.isBlank,x.isNotBlank],Q.Currency=(0,d.__spreadArray)([],ne,!0),Q.Date=(0,d.__spreadArray)([],re,!0),Q.DateTime=(0,d.__spreadArray)([],re,!0),Q.Number=(0,d.__spreadArray)([],ne,!0),Q.Text=(0,d.__spreadArray)((0,d.__spreadArray)([],ne,!0),[x.isEmpty,x.isNotEmpty],!1),Q.Time=(0,d.__spreadArray)([],re,!0),Q.Variant=_.values(x),Q.WholeNumber=(0,d.__spreadArray)([],ne,!0),Q),ct=((q={}).Binary="",q.Boolean="",q.Currency="##".concat(Z.numberFormat["."],"##"),q.Date=Z.calendar.patterns.d,q.DateTime=Z.calendar.patterns.d,q.Number="##".concat(Z.numberFormat["."],"##"),q.Text="",q.Time="",q.Variant="",q.WholeNumber="##",q),Fe=function(){function i(){}return i.getPlaceholderForType=function(t){return t?ct[t]:""},i.getOperatorsForType=function(t){return t?Ae[t]:_.values(x)},i.matchesForDaxGeneration=function(t,n){var r=i.getOperatorsForType(t);if(n in r)return!0;for(var o=0,a=_e;o<a.length;o++){var l=a[o];if(l.first===n&&l.second in r||l.second===n&&l.first in r)return!0}return!1},i.getDefaultOperatorForType=function(t){return"Date"===t||"DateTime"===t||"Time"===t?x.dateIs:"Boolean"===t?x.isTrue:x.equals},i.getOperatorForComparisonType=function(t,n){var r="Date"===n||"DateTime"===n||"Time"===n;switch(t){case S.mO.EqualTo:case S.mO.StrictEqualTo:return r?x.dateIs:x.equals;case S.mO.GreaterThan:return r?x.dateIsAfter:x.greaterThan;case S.mO.GreaterThanEqualTo:return r?x.dateIsOnOrAfter:x.greaterThanOrEqual;case S.mO.LessThan:return r?x.dateIsBefore:x.lessThan;case S.mO.LessThanEqualTo:return r?x.dateIsOnOrBefore:x.lessThanOrEqual;case S.mO.NotEqualTo:return r?x.dateIsNot:x.doesNotEqual}},i.isUnaryOperator=function(t){return-1!==he.findIndex(function(n){return n===t})},i}(),dt=function(i){function t(){var n=i.call(this)||this;return n.name="ColumnDataTypeNotSupportedForRLS",n}return(0,d.__extends)(t,i),t}(Error),it=function(){function i(){}return i.fromDateTimeUserString=function(t){if(void 0!==t){var n=t.split(new RegExp(" |T|-")).map(function(o){return+o});if(3===n.length||6===n.length){n[1]=n[1]-1;var r=new(Function.prototype.bind.apply(Date,[null].concat(n)));if(r instanceof Date&&!isNaN(r))return r}}},i.fromPbiDatePicker=function(t){var n;if(t&&!isNaN(new Date(t).valueOf()))return null!==(n=Y.dx.parseDate(t))&&void 0!==n?n:new Date(t)},i}(),Ee=function(i){return i.InvalidColumnSpecified="RLS_FilterError_InvalidColumnSpecified",i.InvalidFilterValue="RLS_FilterError_InvalidFilterValue",i.BadColumnType="RLS_FilterError_ColumnDataType",i.BadFilterExpression="RLS_FilterError_BadFilterExpression",i.NotYetImplemented="RLS_FilterError_NotYetImplemented",i.BadFilterValueForDataType="RLS_FilterError_DataTypeMismatch",i.BadValueSpecified="RLS_FilterError_BadValueSpecified",i.InvalidComparison="RLS_FilterError_InvalidComparison",i.UnsupportedDateTimeLiteral="RLS_FilterError_BadDateTimeFormat",i.UnsupportedFunctionInValue="RLS_FilterError_UnsupportedFunctionInValue",i.UnsupportedArthInValue="RLS_FilterError_ArithmeticNotSupportedInValue",i.InvalidFilterExpression="RLS_FilterError_InvalidFilterExpression",i}({}),Ge=function(){function i(t,n){this.column=t,this.operator=n}return i.prototype.isNumber=function(){return!1},i.prototype.isString=function(){return!1},i.prototype.isDate=function(){return!1},i.prototype.isList=function(){return!1},i.prototype.isFunction=function(){return!1},i.prototype.isError=function(){return!1},i}(),et=function(i){function t(n,r,o){var a=i.call(this,n,r)||this;return a.value=o,a}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.getUserStringValues=function(){return void 0===this.value?[void 0]:[Y.dx.formatValue(this.getValue())]},t.prototype.getDaxString=function(){if(void 0!==this.value)return""+this.value},t.prototype.isNumber=function(){return!0},t.prototype.isInteger=function(){return void 0!==this.value&&this.value%1==0},t}(Ge),Ve=function(i){function t(n,r,o){var a=i.call(this,n,r)||this;return a.value=o,a}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.getUserStringValues=function(){return[this.value]},t.prototype.getDaxString=function(){if(this.value)return'"'.concat(this.value.replace(/"/g,'""'),'"')},t.prototype.isString=function(){return!0},t}(Ge),Ze=function(i){function t(n,r,o){var a=i.call(this,n,r)||this;return a.value=o,a}return(0,d.__extends)(t,i),t.prototype.getUserStringValues=function(){return void 0===this.value?[void 0]:[Y.dx.formatValue(this.getValue(),"d")]},t.prototype.getDaxStringValue=function(){if(!this.value)return"";var n=""+this.value.getDate();n.length<2&&(n="0"+n);var r=""+(this.value.getMonth()+1);r.length<2&&(r="0"+r);var o=""+this.value.getFullYear();return"".concat(o,"-").concat(r,"-").concat(n)},t.prototype.getDaxString=function(){if(this.value)return'dt"'.concat(this.getDaxStringValue(),'"')},t.prototype.getValue=function(){return this.value},t.prototype.isDate=function(){return!0},t}(Ge),je=function(i){function t(n,r,o){var a=i.call(this,n,r)||this;return a.value=o,a}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.getUserStringValues=function(){var n;return void 0===this.value?[void 0]:(null!==(n=this.value)&&void 0!==n?n:[]).map(function(r){return r.getUserStringValues()}).reduce(function(r,o){return(0,d.__spreadArray)((0,d.__spreadArray)([],r,!0),o,!0)},[])},t.prototype.getDaxString=function(){if(this.value)return"".concat(this.value.map(function(n){return"".concat(n.getDaxString())}))},t.prototype.isList=function(){return!0},t}(Ge),We=function(i){function t(n,r,o){var a=i.call(this,n,r)||this;return a.value=o,a}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.getUserStringValues=function(){return[]},t.prototype.getDaxString=function(){if(this.value)return'"'.concat(this.value,'"')},t.prototype.isFunction=function(){return!0},t}(Ge),Le=function(i){function t(n,r,o){var a=i.call(this,n,r)||this;return a.errorKey=o,a}return(0,d.__extends)(t,i),t.prototype.getUserStringValues=function(){return[]},t.prototype.getValue=function(){},t.prototype.getDaxString=function(){},t.prototype.isError=function(){return!0},t}(Ge),He=function(i){return i.BLANK="BLANK",i.TRUE="TRUE",i.FALSE="FALSE",i}({}),xt=function(){function i(){}return i.buildFromDAXFilterValue=function(t,n,r,o){var a=this;if(!r)return new Le(t,n,Ee.BadValueSpecified);if(r.isError())return new Le(t,n,r.errorKey);if(!t||o){if(r.isDate())return new Ze(t,n,r.getValue());if(r.isFunction())return new We(t,n,r.getValue());if(r.isList()){var l=r.getValue().map(function(f){return a.buildFromDAXFilterValue(t,void 0,f,!0)});return new je(t,n,l)}if(r.isNumber())return new et(t,n,r.getValue());if(r.isString())return new Ve(t,n,r.getValue())}if(r.isFunction())switch(r.getValue()){case He.BLANK:switch(n){case x.doesNotEqual:case x.dateIsNot:return new We(t,x.isNotBlank,He.BLANK);case x.equals:case x.dateIs:return new We(t,x.isBlank,He.BLANK);default:return new Le(t,n,Ee.BadFilterValueForDataType)}case He.TRUE:return new We(t,x.isTrue,He.TRUE);case He.FALSE:return new We(t,x.isFalse,He.FALSE)}else{var c=t.dataType;if("Binary"===c)return new Le(t,n,Ee.BadColumnType);if("Currency"===c||"WholeNumber"===c||"Number"===c)return r.isNumber()?new et(t,n,r.getValue()):r.isList()&&_.every(r.getValue(),function(f){return!f.isError()&&f.isNumber()})?(l=r.getValue().filter(function(v){return v.isNumber()}),new je(t,n,l.map(function(v){return new et(t,n,v.getValue())}))):new Le(t,n,Ee.BadFilterValueForDataType);if("Date"===c||"DateTime"===c)return r.isDate()?new Ze(t,n,r.getValue()):r.isList()&&_.every(r.getValue(),function(f){return!f.isError()&&f.isDate()})?(l=r.getValue().filter(function(v){return v.isDate()}),new je(t,n,l.map(function(v){return new Ze(t,n,v.getValue())}))):new Le(t,n,Ee.BadFilterValueForDataType);if("Text"===c){if(r.isString()&&""===r.getValue())return new Ve(t,n===x.equals?x.isEmpty:x.isNotEmpty,r.getValueAsString());if(r.isString()&&""!==r.getValue())return new Ve(t,n,r.getValueAsString());if(r.isList()&&_.every(r.getValue(),function(f){return!f.isError()&&f.isString()}))return l=r.getValue().filter(function(v){return v.isString()}),new je(t,n,l.map(function(v){return new Ve(t,n,v.getValue())}))}else{if("Time"===c)return new Le(t,n,Ee.NotYetImplemented);if("Variant"===c)return new Le(t,n,Ee.BadColumnType)}}},i.buildNewFilterValue=function(t,n,r){var a,o=this;if(void 0===r&&(r=void 0),n===x.in||n===x.notIn){var l=r.map(function(f){return o.buildNewFilterValue(t,void 0,[f])});return l.length?new je(t,n,l):new Le(t,n,Ee.BadFilterValueForDataType)}var s=(null!==(a=r?.length)&&void 0!==a?a:0)>0?r[0]:void 0;switch(t?.dataType){case"Binary":case"Variant":return new Le(t,n,Ee.BadColumnType);case"Boolean":return new We(t,n,void 0);case"Time":return new Le(t,n,Ee.NotYetImplemented);case"Currency":case"Number":case"WholeNumber":var c=void 0===s?void 0:Y.dx.parseFloat(s);return isNaN(c)?new Le(t,n,Ee.BadFilterValueForDataType):new et(t,n,c);case"Text":return void 0===s||""===s?new Le(t,n,Ee.BadFilterValueForDataType):new Ve(t,n,s);case"Date":case"DateTime":var u=it.fromPbiDatePicker(s);return!u||u.getFullYear()>9999?new Le(t,n,Ee.BadFilterValueForDataType):new Ze(t,n,u);default:return}},i}(),ut=function(i){return i.InvalidColumn="InvalidColumn",i.InvalidOperator="InvalidOperator",i.InvalidValue="InvalidValue",i.Success="Success",i}({}),yt=function(){function i(){}return i.validateFilter=function(t,n){var r;if(t.isFilter()){var o=null===(r=n?.columns)||void 0===r?void 0:r.findByName(t.columnName);if(!o)return{result:ut.InvalidColumn};if(!t.operator||Fe.matchesForDaxGeneration(o.dataType,t.operator))return{result:ut.InvalidOperator};if(Fe.isUnaryOperator(t.operator))return{result:ut.Success,value:void 0};var l=xt.buildNewFilterValue(o,t.operator,t.value);return l.isError()?{result:ut.InvalidValue,value:l}:{result:ut.Success,value:l}}},i}(),It=p(59694),Ke=p(68082),Ft=function(){function i(t,n){this.id=t,this.level=n,this.columnName=void 0,this.operator=void 0,this.value=[],this.errorKeys=[]}return Object.defineProperty(i.prototype,"isList",{get:function(){return this.operator===x.in||this.operator===x.notIn},enumerable:!1,configurable:!0}),i.prototype.clone=function(){var t=new i(this.id,this.level);return t.columnName=this.columnName,t.operator=this.operator,t.value=this.value,t.errorKeys=(0,d.__spreadArray)([],this.errorKeys,!0),t},i.prototype.isFilter=function(){return!0},i.prototype.isGroup=function(){return!1},i}(),Pt=function(){function i(t,n){this.id=t,this.level=n,this.isAndOperator=!0,this.children=[],this.isCollapsed=!1}return i.prototype.clone=function(){var t=new i(this.id,this.level);t.isAndOperator=this.isAndOperator,t.isCollapsed=this.isCollapsed;for(var n=0,r=this.children;n<r.length;n++)t.children.push(r[n].clone());return t},Object.defineProperty(i.prototype,"hasErrors",{get:function(){for(var n=0,r=this.children;n<r.length;n++){var o=r[n];if(o.isGroup()){if(o.hasErrors)return!0}else if(o.isFilter()&&o.errorKeys.length>0)return!0}},enumerable:!1,configurable:!0}),i.prototype.isFilter=function(){return!1},i.prototype.isGroup=function(){return!0},i}(),Ce=function(){function i(t){this.rlsState=t}return i.prototype.addChild=function(t,n){t.isGroup()&&t.children.push(n)},i.prototype.createFilter=function(t,n){return new Ft(t,n)},i.prototype.createFilterGroup=function(t,n){return new Pt(t,n)},i.prototype.initializeFromSource=function(t,n,r,o){var a;t.columnName=null===(a=o?.column)||void 0===a?void 0:a.name,t.errorKeys=(0,d.__spreadArray)([],n,!0),t.operator=r,t.value=o?.getUserStringValues(),o?.isError()&&(o?.column&&(!t.columnName||""===t.columnName)&&(t.columnName=o.column.name),o?.operator&&!t.operator&&(t.operator=o.operator))},i.prototype.setError=function(t,n){t.isFilter()&&t.errorKeys.push(n)},i.prototype.setFilterValue=function(t,n,r,o){var a=this.rlsState.getFilter(t,n,r);a.isFilter()&&(a.value=o,a.errorKeys=[])},i.prototype.updateFilter=function(t,n,r,o,a){var l=this.rlsState.getFilter(t,n,r);l.isFilter()&&(o&&(l.columnName=o),a&&(l.operator=a),l.errorKeys=[])},i.prototype.updateGroup=function(t,n,r){this.isDefined(n)&&(t.isCollapsed=n),this.isDefined(r)&&(t.isAndOperator=r)},i.prototype.validateGroup=function(t,n,r){for(var o=!0,a=0,l=r.children;a<l.length;a++){var s=l[a];(s.isGroup()&&!this.validateGroup(t,n,s)||s.isFilter()&&!this.validateFilter(n,s))&&(o=!1)}return o},i.prototype.validateFilter=function(t,n){var r,o=yt.validateFilter(n,t);return o.result===ut.Success||(!(null===(r=o.value)||void 0===r)&&r.isError()&&(n.errorKeys=[],this.setError(n,o.value.errorKey)),!1)},i.prototype.isDefined=function(t){return null!=t},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(T))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ge=function(){function i(t){this.tableName=t,this.filtersGroup=new Pt(0,0),this.daxExpression="",this.isDaxEditorOpen=!1,this.errorMessage="",this.lastVerifiedDax=""}return Object.defineProperty(i.prototype,"tableFilters",{get:function(){return this.filtersGroup?this.filtersGroup.children:[]},enumerable:!1,configurable:!0}),i}(),U=function(){function i(t,n){this.filterService=t,this.rlsState=n}return i.prototype.addFilter=function(t,n){t.filtersGroup=t.filtersGroup?t.filtersGroup:this.filterService.createFilterGroup(0,0),n.id=this.getNextId(t),t.filtersGroup.children.push(n)},i.prototype.addSiblingFilter=function(t,n,r){t.filtersGroup=t.filtersGroup?t.filtersGroup:this.filterService.createFilterGroup(0,0),n.id=this.getNextId(t);var o=this.getParent(t,r);if(o){n.level=o.level+1;var a=o?.children.findIndex(function(l){return l.id===r});a>-1&&o.children.splice(a+1,0,n)}},i.prototype.clone=function(t){var n,r=new ge(t.tableName);return t.isDaxEditorOpen?this.initializeDax(r,t.daxExpression):(this.initialize(r,null===(n=t.filtersGroup)||void 0===n?void 0:n.clone(),!1),r.lastVerifiedDax=t.lastVerifiedDax,r.lastEditedInDax=t.lastEditedInDax,r.daxExpression=t.daxExpression),r},i.prototype.create=function(t){return new ge(t)},i.prototype.deleteFilters=function(t,n){var r=this;n.map(function(a){return r.getFilter(t,a)}).forEach(function(a){var l=r.getParent(t,a.id),s=l?.children.indexOf(a);s>-1&&l.children.splice(s,1)})},i.prototype.getNextId=function(t){return this.maxId(t.filtersGroup)+1},i.prototype.initialize=function(t,n,r){t.filtersGroup=n,t.isDaxEditorOpen=!1,t.lastEditedInDax=r},i.prototype.initializeDax=function(t,n){t.filtersGroup=void 0,t.daxExpression=n,t.isDaxEditorOpen=!0,t.lastEditedInDax=!0,t.lastVerifiedDax=n},i.prototype.getFilter=function(t,n){return this.rlsState.getFilterInGroup(t.filtersGroup,n,!1)},i.prototype.getIsDaxEditorOpen=function(t,n){var r;return null===(r=this.rlsState.getRoleTable(t,n))||void 0===r?void 0:r.isDaxEditorOpen},i.prototype.getParent=function(t,n){return this.rlsState.getFilterInGroup(t.filtersGroup,n,!0)},i.prototype.getSameParent=function(t,n){var r=this,o=n.map(function(l){return r.getFilter(t,l)});if(o&&0!==o.length){var a=this.getParent(t,o[0].id);return o.every(function(l){return!!l&&(l.id===n[0]||a===r.getParent(t,l.id))})?a:null}},i.prototype.groupFilters=function(t,n){var r=this,o=n.map(function(c){return r.getFilter(t,c)});if(t){var a=this.getSameParent(t,o.map(function(c){return c.id})),l=a.children.findIndex(function(c){return o.indexOf(c)>-1}),s=new Pt(this.getNextId(t),a.level+1);return o.forEach(function(c){r.deleteFilters(t,[c.id]),r.setLevel(c,c.level+1),s.children.push(c)}),a.children.splice(l,0,s),s}},i.prototype.rebalanceFilterGroups=function(t){var n=this;t.filtersGroup.children.filter(function(a){return a.isGroup()&&a.children.length<=1}).forEach(function(a){return n.ungroupFilterGroup(t,a)})},i.prototype.setLevel=function(t,n){var r=this;t.level=n,t.isGroup()&&t.children.forEach(function(o){return r.setLevel(o,n+1)})},i.prototype.ungroupFilters=function(t,n){var r=this,o=n.map(function(l){return r.getFilter(t,l)});o.filter(function(l){return l.isGroup()||l.isFilter()&&-1===o.indexOf(r.getParent(t,l.id))}).forEach(function(l){l.isGroup()?r.ungroupFilterGroup(t,l):l.isFilter()&&r.ungroupFilter(t,l)}),this.rebalanceFilterGroups(t)},i.prototype.maxId=function(t){for(var n=t.id,r=0,o=t.children;r<o.length;r++){var a=o[r],l=a.isGroup()?this.maxId(a):a.id;n=Math.max(n,l)}return n},i.prototype.ungroupFilter=function(t,n){var r=this.getParent(t,n.id),o=t.filtersGroup,a=o.children.indexOf(r),l=n.clone();this.setLevel(l,n.level-1),this.deleteFilters(t,[n.id]),o.children.splice(a,0,l)},i.prototype.ungroupFilterGroup=function(t,n){var r,o=this,a=t.filtersGroup,l=[],s=a.children.indexOf(n);(0,d.__spreadArray)([],n.children,!0).forEach(function(c){var u=c.clone();o.setLevel(u,c.level-1),o.deleteFilters(t,[c.id]),l.push(u)}),this.deleteFilters(t,[n.id]),(r=a.children).splice.apply(r,(0,d.__spreadArray)([s,0],l,!1))},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Ce),e.\u0275\u0275inject(T))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),P=function(){function i(t){this.errorKey=t}return i.prototype.getValue=function(){},i.prototype.isError=function(){return!0},i}(),O=function(){function i(){}return i.prototype.isGroup=function(){return!0},i.prototype.isFilter=function(){return!1},i.prototype.isError=function(){return!1},i}(),ue=function(){function i(t){var n,r;this.columnName=void 0,this.operator=void 0,this.value=void 0,this.errorKeys=[],this.value=t,t&&!t?.getValue()&&t.isError()?this.errorKeys.push(t.errorKey):(null!==(n=t.column)&&void 0!==n&&n.name?this.columnName=null===(r=t.column)||void 0===r?void 0:r.name:this.errorKeys.push(Ee.InvalidColumnSpecified),t.operator?this.operator=t.operator:this.errorKeys.push(Ee.InvalidComparison))}return i.prototype.isGroup=function(){return!1},i.prototype.isFilter=function(){return!0},i.prototype.isError=function(){return!1},i}(),Te=function(){function i(){}return i.prototype.getValueAsString=function(){return""+this.getValue()},i.prototype.isNumber=function(){return!1},i.prototype.isString=function(){return!1},i.prototype.isDate=function(){return!1},i.prototype.isList=function(){return!1},i.prototype.isFunction=function(){return!1},i.prototype.isError=function(){return!1},i.prototype.negate=function(){throw"Cannot negate a non-number value"},i}(),$e=function(i){function t(n){var r=i.call(this)||this;return r.value=n,r}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.isNumber=function(){return!0},t.prototype.negate=function(){this.value=-1*this.value},t}(Te),rt=function(i){function t(n){var r=i.call(this)||this;return r.value=n,r}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.isString=function(){return!0},t}(Te),mt=function(i){function t(n){var r=i.call(this)||this;return r.value=n,r}return(0,d.__extends)(t,i),t.fromLiteral=function(n){var r=n.substring(3,n.length-1),o=it.fromDateTimeUserString(r);if(void 0===o)throw"Date is not properly formatted";return new t(o)},t.fromDateFunction=function(n){if(3!==n.length||!n[0].isNumber()||!n[1].isNumber()||!n[2].isNumber())throw"Dates must be constructed based on 3 number parameters";return new t(new Date(n[0].getValue(),n[1].getValue()-1,n[2].getValue()))},t.prototype.getValue=function(){return this.value},t.prototype.isDate=function(){return!0},t}(Te),Re=function(i){function t(n){var r=i.call(this)||this;return r.value=n,r}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.isList=function(){return!0},t}(Te),xe=function(i){function t(n){var r=i.call(this)||this;return r.value=n,r}return(0,d.__extends)(t,i),t.prototype.getValue=function(){return this.value},t.prototype.isFunction=function(){return!0},t}(Te),be=function(){function i(){}return i.prototype.visitConstantScalar=function(t){return t.type===S.AP.String?new rt(t.value):new $e(+t.value)},i.prototype.visitDateTimeLiteral=function(t){try{return mt.fromLiteral(t.value)}catch{return new P(Ee.UnsupportedDateTimeLiteral)}},i.prototype.visitNegation=function(t){var n=t.expression.accept(this);return n.isError()||n.negate(),n},i.prototype.visitTableConstructor=function(t){for(var n=[],r=0,o=t.rows;r<o.length;r++){var l=o[r].accept(this);if(l.isError())return l;n.push(l)}var s;if(_.every(n,function(c){return!c.isError()&&c.isNumber()}))s=n.map(function(c){if(!c.isError()&&c.isNumber())return c});else if(_.every(n,function(c){return!c.isError()&&c.isString()}))s=n.map(function(c){if(!c.isError()&&c.isString())return c});else{if(!_.every(n,function(c){return!c.isError()&&c.isDate()}))return new P(Ee.BadFilterValueForDataType);s=n.map(function(c){if(!c.isError()&&c.isDate())return c})}return new Re(s)},i.prototype.visitRowConstructor=function(t){for(var n=[],r=0,o=t.items;r<o.length;r++){var l=o[r].accept(this);if(l.isError())return l;l.isList()||n.push(l)}if(1!==n.length||n[0].isList()||n[0].isFunction())throw"A list specified as part of IN can only have one element per row and cannot include sub-lists or functions";return n[0].isNumber()?new $e(n[0].getValue()):n[0].isDate()?n[0]:new rt(n[0].getValueAsString())},i.prototype.visitFunction=function(t){switch(t.functionName.toLowerCase()){case"date":for(var r=[],o=0,a=t.parameters;o<a.length;o++){var s=a[o].accept(this);if(s.isError())return s;s.isList()||r.push(s)}return mt.fromDateFunction(r);case"blank":return new xe(He.BLANK);case"true":return new xe(He.TRUE);case"false":return new xe(He.FALSE);default:return new P(Ee.UnsupportedFunctionInValue)}},i.prototype.visitKeyword=function(t){return t.equals(S.M5.True)?new xe(He.TRUE):t.equals(S.M5.False)?new xe(He.FALSE):new P("Unsupported keyword found")},i.prototype.visitLogicalOperation=function(t){return new P("Cannot have sub-logical operation inside a comparison")},i.prototype.visitComparison=function(t){return new P("Cannot have sub-logical operation inside a comparison")},i.prototype.visitArithmetic=function(t){return new P(Ee.UnsupportedArthInValue)},i.prototype.visitTableReference=function(t){return new P("Table references not implemented for DAX UI comparisons")},i.prototype.visitColumnReference=function(t){return new P("Column references not implemented for DAX UI comparisons")},i.prototype.visitMeasureReference=function(t){return new P("Measure references not implemented for DAX UI comparisons")},i.prototype.visitUnknown=function(t){return new P("Unknown expression found when parsing DAX UI comparisons")},i.prototype.visitVarReturn=function(t){return new P("VarReturn is not supported for DAX UI comparisons")},i.prototype.visitVariableReference=function(t){return new P("Variable references not supported for DAX UI Comparisons")},i.prototype.visitVariationColumnReference=function(t){return new P("Variation column references not implemented for DAX UI comparisons")},i.prototype.visitTextConcatenation=function(t){return new P("Text concatenation not implemented for DAX UI comparisons")},i.prototype.visitIn=function(t){return new P(Ee.UnsupportedFunctionInValue)},i.prototype.visitNot=function(t){return new P(Ee.UnsupportedFunctionInValue)},i.prototype.visitOmittedArgument=function(t){return new P("Omitted argument expressions are not implemented for DAX UI comparisons")},i.prototype.visitMultiIdentifier=function(t){return new P("MultiIdentifierExpression are not implemented for DAX UI comparisons")},i.prototype.visitAxis=function(t){return new P("AxisExpression are not implemented for DAX UI comparisons")},i.prototype.visitEnum=function(t){return new P("EnumExpression are not implemented for DAX UI comparisons")},i.prototype.visitStartAt=function(t){return new P("StartAtExpression is not implemented for DAX UI comparisons")},i.prototype.visitSort=function(t){return new P("SortExpression is not implemented for DAX UI comparisons")},i.prototype.visitOrderBy=function(t){return new P("OrderByExpression is not implemented for DAX UI comparisons")},i.prototype.visitVariableDefinition=function(t){return new P("VariableDefinition is not implemented for DAX UI comparisons")},i.prototype.visitMeasureExpression=function(t){return new P("MeasureExpression is not implemented for DAX UI comparisons")},i.prototype.visitQuery=function(t){return new P("QueryExpression is not implemented for DAX UI comparisons")},i.prototype.visitQueries=function(t){return new P("QueriesExpression is not implemented for DAX UI comparisons")},i}(),N=function(){function i(t){this.ignoreDataTypeErrors=t,this.valueVisitor=new be}return i.prototype.isGroup=function(t){return!t.isError()&&t.isGroup()},i.prototype.treatAsFilter=function(t){return t.isError()||t.isFilter()},i.prototype.visitLogicalOperation=function(t,n){var l,r=t.left.accept(this,n),o=t.right.accept(this,n),a=this.getLogicalOperator(t.operator);return this.isGroup(o)&&this.isGroup(r)?o.isAndOperator===r.isAndOperator?o.isAndOperator===a?((l=new O).children=(0,d.__spreadArray)((0,d.__spreadArray)([],r.children,!0),o.children,!0),l.isAndOperator=a,l):((l=new O).children=[r,o],l.isAndOperator=a,l):o.isAndOperator===a?((l=new O).children=(0,d.__spreadArray)([r],o.children,!0),l.isAndOperator=a,l):((l=new O).children=(0,d.__spreadArray)((0,d.__spreadArray)([],r.children,!0),[o],!1),l.isAndOperator=a,l):this.treatAsFilter(o)&&this.treatAsFilter(r)?((l=new O).children=[r,o],l.isAndOperator=a,l):this.isGroup(o)&&this.treatAsFilter(r)?this.addFilterToGroup(o,r,a,!0):this.treatAsFilter(o)&&this.isGroup(r)?this.addFilterToGroup(r,o,a,!1):void 0},i.prototype.visitComparison=function(t,n){var r,o;if(t.left instanceof S.Sx){var a=t.left.propertyName,l=null===(r=n?.columns)||void 0===r?void 0:r.find(function(c){return c.name===a});return this.buildRLSFromDAX(n,a,Fe.getOperatorForComparisonType(t.comparison,l?.dataType),t.right)}if(t.left instanceof S.bM&&t.left.expressionText.startsWith("[")&&t.left.expressionText.endsWith("]")){var s=t.left.expressionText.substring(1,t.left.expressionText.length-2);return l=null===(o=n?.columns)||void 0===o?void 0:o.find(function(u){return u.name===s}),this.buildRLSFromDAX(n,s,Fe.getOperatorForComparisonType(t.comparison,l?.dataType),t.right)}return this.buildError(Ee.InvalidColumnSpecified)},i.prototype.visitNot=function(t,n){var r=t.expression.accept(this,n);return r.isError()?r:r.isFilter()?(r.operator===x.in?r.operator=x.notIn:r.operator===x.dateIs&&(r.operator=x.dateIsNot),r):this.buildError(Ee.InvalidFilterExpression)},i.prototype.visitIn=function(t,n){return t.left instanceof S.Sx?this.buildRLSFromDAX(n,t.left.propertyName,x.in,t.right):this.buildError(Ee.InvalidColumnSpecified)},i.prototype.visitArithmetic=function(t,n){return new P("ArithmeticExpression not supported for RLS Filter Groups")},i.prototype.visitConstantScalar=function(t,n){return new P("ConstantScalarExpression not supported for RLS Filter Groups")},i.prototype.visitDateTimeLiteral=function(t,n){return new P("DateTimeLiteralExpression not supported for RLS Filter Groups")},i.prototype.visitNegation=function(t,n){return new P("NegationExpression not supported for RLS Filter Groups")},i.prototype.visitFunction=function(t,n){return new P("FunctionExpression not supported for RLS Filter Groups")},i.prototype.visitTableReference=function(t,n){return new P("TableReferenceExpression not supported for RLS Filter Groups")},i.prototype.visitColumnReference=function(t,n){return new P("ColumnReferenceExpression not supported for RLS Filter Groups")},i.prototype.visitMeasureReference=function(t,n){return new P("MeasureReferenceExpression not supported for RLS Filter Groups")},i.prototype.visitUnknown=function(t,n){return new P("UnknownExpression not supported for RLS Filter Groups")},i.prototype.visitVarReturn=function(t,n){return new P("VarReturnExpression not supported for RLS Filter Groups")},i.prototype.visitVariableReference=function(t,n){return new P("VariableReferenceExpression not supported for RLS Filter Groups")},i.prototype.visitVariationColumnReference=function(t,n){return new P("VariationColumnReferenceExpression not supported for RLS Filter Groups")},i.prototype.visitTextConcatenation=function(t,n){return new P("TextConcatenationExpression not supported for RLS Filter Groups")},i.prototype.visitRowConstructor=function(t,n){return new P("RowConstructorExpression not supported for RLS Filter Groups")},i.prototype.visitTableConstructor=function(t,n){return new P("TableConstructorExpression not supported for RLS Filter Groups")},i.prototype.visitKeyword=function(t,n){return new P("KeywordExpression not supported for RLS Filter Groups")},i.prototype.visitOmittedArgument=function(t,n){return new P("OmittedArgumentExpression not supported for RLS Filter Groups")},i.prototype.visitMultiIdentifier=function(t,n){return new P("MultiIdentifierExpression not supported for RLS Filter Groups")},i.prototype.visitAxis=function(t,n){return new P("AxisExpression not supported for RLS Filter Groups")},i.prototype.visitEnum=function(t,n){return new P("EnumExpression not supported for RLS Filter Groups")},i.prototype.visitStartAt=function(t,n){return new P("StartAtExpression not supported for RLS Filter Groups")},i.prototype.visitSort=function(t,n){return new P("SortExpression not supported for RLS Filter Groups")},i.prototype.visitOrderBy=function(t,n){return new P("OrderByExpression not supported for RLS Filter Groups")},i.prototype.visitVariableDefinition=function(t,n){return new P("VariableDefinition not supported for RLS Filter Groups")},i.prototype.visitMeasureExpression=function(t,n){return new P("MeasureExpression not supported for RLS Filter Groups")},i.prototype.visitQuery=function(t,n){return new P("QueryExpression not supported for RLS Filter Groups")},i.prototype.visitQueries=function(t,n){return new P("QueriesExpression not supported for RLS Filter Groups")},i.prototype.getLogicalOperator=function(t){return t===S.A3.And},i.prototype.addFilterToGroup=function(t,n,r,o){var a;return t.isAndOperator===r?((a=new O).children=o?(0,d.__spreadArray)([n],t.children,!0):(0,d.__spreadArray)((0,d.__spreadArray)([],t.children,!0),[n],!1),a.isAndOperator=r,a):((a=new O).children=o?[n,t]:[t,n],a.isAndOperator=r,a)},i.prototype.visitFilterValueNode=function(t){return t.accept(this.valueVisitor)},i.prototype.buildError=function(t){var n=new P(t),r=xt.buildFromDAXFilterValue(void 0,void 0,n,this.ignoreDataTypeErrors);return new ue(r)},i.prototype.buildRLSFromDAX=function(t,n,r,o){var a,l=null===(a=t?.columns)||void 0===a?void 0:a.find(function(f){return f.name===n}),s=this.visitFilterValueNode(o),c=xt.buildFromDAXFilterValue(l,r,s,this.ignoreDataTypeErrors);return new ue(c)},i}(),L=p(71328),h=p(48563),g=p(60353),m=p(74249),b=function(){function i(t){this.daxCapabilitiesService=t}return i.prototype.getDaxContext=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a,l;return(0,d.__generator)(this,function(s){switch(s.label){case 0:return r=(0,g.C)(n),o=(0,S.o4)(r),[4,this.getDataSourceInfo()];case 1:return a=s.sent(),l=o.tables.find(function(c){return c.name===t}),[2,(0,S.Sm)(o,(0,S.yD)(a),l)]}})})},i.prototype.getDataSourceInfo=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,r,a;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return[4,Promise.all([this.daxCapabilitiesService.getReservedWords(),this.daxCapabilitiesService.getCapabilities()])];case 1:return a=l.sent(),t=a[0],r=(0,h.w)(a[1].Functions),[2,{reservedWords:t,functionDataFromEngine:r}]}})})},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(m.r))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),y=function(){function i(t){this.daxContextService=t}return i.prototype.parse=function(t,n,r,o){return(0,d.__awaiter)(this,void 0,void 0,function(){var a,l,s,c,u,f;return(0,d.__generator)(this,function(C){switch(C.label){case 0:a={expressionTree:null},l=new N(o),C.label=1;case 1:return C.trys.push([1,3,,4]),[4,this.daxContextService.getDaxContext(n,r)];case 2:return c=C.sent(),(u=r.tables.find(function(E){return E.name===n}))?((0,S.co)(t,c,47,a),(f=a.expressionTree)?(s=f.accept(l,u),[3,4]):[2]):[2,void 0];case 3:return C.sent(),s=l.buildError(Ee.BadFilterExpression),[3,4];case 4:return s.isError()?[2,this.buildError(s.errorKey,o)]:[2,s]}})})},i.prototype.getAnonymizedExpression=function(t,n,r){return(0,d.__awaiter)(this,void 0,void 0,function(){var o;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return t?[4,this.daxContextService.getDaxContext(n,r)]:[2,null];case 1:return o=l.sent(),[2,L.y.buildAnonymousExpression((0,S.wS)(t,0,0,null,null,!1),o,S.w_.delimitIdentifier)]}})})},i.prototype.buildError=function(t,n){var r=new P(t),o=xt.buildFromDAXFilterValue(void 0,void 0,r,n);return new ue(o)},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(b))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),A=function(){function i(){this.count=0}return i.prototype.getNextID=function(){return this.count++},i}(),K=function(){function i(t){this.filterService=t}return i.prototype.convert=function(t){var n=new A;return this.convertInternal(t,0,n)},i.prototype.convertInternal=function(t,n,r){if(!t.isError()){if(t.isFilter())return this.convertFilter(t,n,r);var o=this.filterService.createFilterGroup(r.getNextID(),n);this.filterService.updateGroup(o,!1,t.isAndOperator),n++;for(var a=0,l=t.children;a<l.length;a++){var s=l[a];this.filterService.addChild(o,s.isError()?this.convertError(s,n,r):this.convertInternal(s,n,r))}return n--,o}},i.prototype.convertFilter=function(t,n,r){var o=this.filterService.createFilter(r.getNextID(),n);return this.filterService.initializeFromSource(o,t.errorKeys,t.operator,t.value),o},i.prototype.convertError=function(t,n,r){var o=this.filterService.createFilter(r.getNextID(),n);return this.filterService.initializeFromSource(o,[t.errorKey],void 0,void 0),o},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Ce))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ee=function(){function i(t,n,r,o,a){this.filterService=t,this.tableService=n,this.daxToRlsService=r,this.filterBuilder=o,this.dataModelService=a}return i.prototype.canConvertDaxToFilters=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.parseRoleDax(n,t.tableName)];case 1:return[2,o.sent().isParsable]}})})},i.prototype.convertDaxToFilters=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.parseRoleDax(n,t.tableName)];case 1:return(r=o.sent()).convertedFilters&&(r.convertedFilters=this.removeErrorFilters(r.convertedFilters)),this.setFiltersOnTable(t,r,t.lastEditedInDax),[2]}})})},i.prototype.loadRolePermissions=function(t,n,r,o){var a,l;return(0,d.__awaiter)(this,void 0,void 0,function(){var s,c,u,f,v,C,E,z;return(0,d.__generator)(this,function(ce){switch(ce.label){case 0:s=[],c=0,u=n,ce.label=1;case 1:return c<u.length?(f=u[c],(null===(a=f?.columns)||void 0===a?void 0:a.length)>0?(v=this.tableService.create(f.name),s.push(v),t&&(C=null===(l=t.tablePermissions)||void 0===l?void 0:l.findByName(f.name))?[4,this.parseRoleDax(C.filterExpression,f.name)]:[3,3]):[3,3]):[3,4];case 2:E=ce.sent(),z=this.tableService.getIsDaxEditorOpen(t.name,f.name),!r||E.isParsable&&""===C.errorMessage&&!z?(v.daxExpression=E.daxExpression,this.setFiltersOnTable(v,E,o.get(v.tableName))):this.tableService.initializeDax(v,E.daxExpression),v.errorMessage=C.errorMessage,ce.label=3;case 3:return c++,[3,1];case 4:return[2,s]}})})},i.prototype.setFiltersOnTable=function(t,n,r){return(0,d.__awaiter)(this,void 0,void 0,function(){var o;return(0,d.__generator)(this,function(a){return n.convertedFilters&&(n.convertedFilters.isGroup()?this.tableService.initialize(t,n.convertedFilters,r):(o=this.filterService.createFilterGroup(-1,0),n.convertedFilters.level=1,o.children=[n.convertedFilters],o.isAndOperator=!0,this.tableService.initialize(t,o,r))),[2]})})},i.prototype.parseRoleDax=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return[4,this.daxToRlsService.parse(t,n,this.dataModelService.getDataModel(),!1)];case 1:return r=l.sent(),o=!0,r&&(r.isError()?o=!1:(a=this.filterBuilder.convert(r),this.canParseFilters(r,0)?a.isGroup()&&a.hasErrors?o=!1:a.isFilter()&&(o=0===a.errorKeys.length):o=!1)),[2,{daxExpression:t,isParsable:o,parsedFilters:r,convertedFilters:a}]}})})},i.prototype.removeErrorFilters=function(t){var n=this;if(t.isFilter())return t.errorKeys.length>0?null:t;var r=[];return t.children.forEach(function(o){var a=n.removeErrorFilters(o);null!=a&&r.push(a)}),t.children=r,t},i.prototype.canParseFilters=function(t,n){if(n>2||t.isError())return!1;var r=!0;if(t.isGroup())for(var o=0,a=t.children;o<a.length;o++)r=r&&this.canParseFilters(a[o],n+1);return r},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Ce),e.\u0275\u0275inject(U),e.\u0275\u0275inject(y),e.\u0275\u0275inject(K),e.\u0275\u0275inject(Ke.n))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Pe=((me={})[x.equals]="==",me[x.doesNotEqual]="<>",me[x.in]="{0} IN {{1}}",me[x.notIn]="NOT({0} IN {{1}})",me[x.greaterThan]=">",me[x.greaterThanOrEqual]=">=",me[x.lessThan]="<",me[x.lessThanOrEqual]="<=",me[x.isEmpty]='== ""',me[x.isNotEmpty]='<> ""',me[x.isBlank]="== Blank()",me[x.isNotBlank]="<> Blank()",me[x.dateIs]="==",me[x.dateIsNot]="NOT({0} == {1})",me[x.dateIsAfter]=">",me[x.dateIsOnOrAfter]=">=",me[x.dateIsBefore]="<",me[x.dateIsOnOrBefore]="<=",me[x.isTrue]="== true()",me[x.isFalse]="== false()",me),pe=function(){function i(t,n){this.rlsState=t,this.roleParsingService=n,this.currentLevel=0}return i.prototype.convertFilter=function(t,n,r,o){void 0===o&&(o=!0);var a=this.rlsState.getFilter(t,n.name,r);if(a.isFilter())return this.convertFilterToString(n,a,o)},i.prototype.convertFilterGroup=function(t,n,r,o){void 0===o&&(o=!0);var a=this.rlsState.getFilter(t,r.name,n);if(a.isGroup())return this.convertFilterGroupInternal(a,r,o)},i.prototype.standardizeDax=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.roleParsingService.parseRoleDax(t,n.name)];case 1:return(r=o.sent()).convertedFilters?r.convertedFilters.isGroup()?r.convertedFilters.hasErrors?[2,t]:[2,this.convertFilterGroupInternal(r.convertedFilters,n)]:r.convertedFilters.errorKeys.length>0?[2,t]:[2,this.convertFilterToString(n,r.convertedFilters,!0)]:[2,""]}})})},i.prototype.convertFilterGroupInternal=function(t,n,r){if(void 0===r&&(r=!0),t.children.length){for(var o="",a=this.getOperatorClause(t.isAndOperator),l=0;l<t.children.length;l++){this.currentLevel+=1;var s=t.children[l],c=s.isGroup()?this.convertFilterGroupInternal(s,n,r):this.convertFilterToString(n,s,r);this.currentLevel-=1,0===l?o=c:o+=" ".concat(a," ").concat(c)}return this.currentLevel>0?"(".concat(o,")"):o}},i.prototype.convertFilterToString=function(t,n,r){var o,a,l,s,c=t.columns.findByName(n.columnName),u=yt.validateFilter(n,t);if(r&&u.result!==ut.Success)throw"Could not convert filters to DAX";var f=null!==(a=null===(o=u.value)||void 0===o?void 0:o.getDaxString())&&void 0!==a?a:"",v=null!==(s=null===(l=n.columnName)||void 0===l?void 0:l.replace(/]/g,"]]"))&&void 0!==s?s:"";if(c?.dataType)switch(c.dataType){case"Binary":case"Variant":throw new dt}switch(n.operator){case x.in:case x.notIn:case x.dateIsNot:if(void 0===f)throw"Invalid filters attempting to be saved to DAX";return(0,It.W)(Pe[n.operator],"[".concat(v,"]"),f);case x.isBlank:case x.isNotBlank:case x.isEmpty:case x.isNotEmpty:case x.isTrue:case x.isFalse:return"[".concat(v,"] ").concat(Pe[n.operator]);default:if(void 0===f)throw"Invalid filters attempting to be saved to DAX";return"[".concat(v,"] ").concat(Pe[n.operator]," ").concat(f)}},i.prototype.getOperatorClause=function(t){return t?"&&":"||"},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(T),e.\u0275\u0275inject(ee))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Oe=p(54357),vt=function(){function i(t){this._roleTables={},this.inEditState=!1,this.name=t}return Object.defineProperty(i.prototype,"roleTables",{get:function(){return _.values(this._roleTables).sort(function(n,r){return n.tableName.localeCompare(r.tableName)})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"renamedFrom",{get:function(){return this._renamedFrom},set:function(n){this._renamedFrom=n},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isRenamed",{get:function(){return!!this._renamedFrom},enumerable:!1,configurable:!0}),i.prototype.getTable=function(t){return this._roleTables[t]},i}(),pt=function(){function i(t){this.tableService=t}return i.prototype.create=function(t){return new vt(t)},i.prototype.clone=function(t,n){var r=this,o=new vt(n);return this.populate(o,t.roleTables.map(function(a){return r.tableService.clone(a)})),o},i.prototype.initialize=function(t,n){for(var r=0,o=n;r<o.length;r++){var a=o[r];t._roleTables[a.tableName]=a}},i.prototype.populate=function(t,n){t._roleTables={};for(var r=0,o=n;r<o.length;r++){var a=o[r];t._roleTables[a.tableName]=a}},i.prototype.rename=function(t,n,r){void 0===r&&(r=!1),r&&(t.renamedFrom=t.name),t.name=n},i.prototype.setTable=function(t,n){t._roleTables[n.tableName]&&delete t._roleTables[n.tableName],t._roleTables[n.tableName]=n},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(U))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Be=p(65181),hn=function(){function i(t,n,r,o,a,l,s,c,u){this.rlsState=t,this.rlsToDax=n,this.modelService=r,this.filterService=o,this.roleService=a,this.tableService=l,this.roleParsingService=s,this.localizationService=c,this.eventAggregationService=u}return i.prototype.addFilter=function(t,n,r){var o,a=this.rlsState.getRoleTable(t,n),l=this.getModelTable(n);if(l&&a){var s=this.filterService.createFilter(-1,1),c=null===(o=l.columns)||void 0===o?void 0:o.nonSystemColumns[0],u=Fe.getDefaultOperatorForType(c.dataType);return r?this.tableService.addSiblingFilter(a,s,r):this.tableService.addFilter(a,s),this.filterService.updateFilter(t,n,s.id,c.name,u),s}},i.prototype.copyFiltersFromRole=function(t,n,r){var o=this.rlsState.getRoleTable(t,r),a=this.tableService.clone(o),l=this.rlsState.getRole(n);this.roleService.setTable(l,a)},i.prototype.forceConvertDaxToFilters=function(t,n,r){return(0,d.__awaiter)(this,void 0,void 0,function(){var o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return o=this.rlsState.getRoleTable(t,n),[4,this.roleParsingService.convertDaxToFilters(o,r)];case 1:return a.sent(),[2]}})})},i.prototype.canConvertDaxToFilter=function(t,n,r){return(0,d.__awaiter)(this,void 0,void 0,function(){var o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return o=this.rlsState.getRoleTable(t,n),[4,this.roleParsingService.canConvertDaxToFilters(o,r)];case 1:return[2,a.sent()]}})})},i.prototype.createRole=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return t=_.values(this.rlsState.roles).map(function(o){return o.name}),n=ae.getUniqueName(this.localizationService.get("Untitled"),t),[4,this.createRoleByName(n)];case 1:return[2,r.sent()]}})})},i.prototype.createRoleByName=function(t){var n;return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a,l,s,c;return(0,d.__generator)(this,function(u){for(r=this.roleService.create(t),o=[],a=0,l=this.getModelTables();a<l.length;a++)s=l[a],(null===(n=s?.columns)||void 0===n?void 0:n.length)>0&&(c=this.tableService.create(s.name),o.push(c));return this.roleService.initialize(r,o),this.rlsState.roles[t]&&delete this.rlsState.roles[t],this.rlsState.roles[t]=r,[2,r]})})},i.prototype.deleteFilterItems=function(t,n,r){var o=this.rlsState.getRoleTable(t,n);this.tableService.deleteFilters(o,r)},i.prototype.deleteRole=function(t){delete this.rlsState.roles[t]},i.prototype.duplicateRole=function(t){var n=this.rlsState.getRole(t),r=ae.getUniqueName(n.name,_.map(this.rlsState.roles,"name")),o=this.roleService.clone(n,r);return this.rlsState.roles[o.name]=o,o},i.prototype.getDax=function(t,n,r){var o,a,l,s=null===(o=this.rlsState.getRole(t))||void 0===o?void 0:o.getTable(n);if(!s)return"";if(s.isDaxEditorOpen)return null!==(a=s.daxExpression)&&void 0!==a?a:"";if(s.tableFilters.length<1)return"";if(s.lastEditedInDax)return s.daxExpression;var c=this.getModelTable(n);return null!==(l=this.rlsToDax.convertFilterGroup(t,s.filtersGroup.id,c,r))&&void 0!==l?l:""},i.prototype.getModelTable=function(t){var n,r;return null===(r=null===(n=this.modelService.model)||void 0===n?void 0:n.tables)||void 0===r?void 0:r.findByName(t)},i.prototype.getSameParent=function(t,n,r){var o=this.rlsState.getRoleTable(t,n);return this.tableService.getSameParent(o,r)},i.prototype.getSelectedItemsSorted=function(t,n,r){var o=this,a=this.rlsState.getRoleTable(t,n),l=function(c){return o.rlsState.getFlatIndex(a.filtersGroup,c,0).index};return r.sort(function(s,c){return l(s)-l(c)}).map(function(s){return o.rlsState.getFilter(t,n,s)})},i.prototype.group=function(t,n,r){var o=this.rlsState.getRoleTable(t,n);return this.tableService.groupFilters(o,r)},i.prototype.isRoleDirty=function(t,n){return void 0===n&&(n=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a,l;return(0,d.__generator)(this,function(c){if(r=this.rlsState.getRole(t),!(o=this.getModelRole(t))&&!n)return[2,!0];for(a=0,l=_.values(r.roleTables);a<l.length;a++)if(this.isRoleTableDirty(o,l[a]))return[2,!0];return[2,!1]})})},i.prototype.isRoleTableDirty=function(t,n){var r,o;return(null===(r=this.getDax(t.name,n.tableName,!1))||void 0===r?void 0:r.trim())!==(null===(o=this.getModelExpression(t,n.tableName))||void 0===o?void 0:o.trim())},i.prototype.getModelExpression=function(t,n){var r,o,a;return null!==(a=null===(o=null===(r=t?.tablePermissions)||void 0===r?void 0:r.findByName(n))||void 0===o?void 0:o.filterExpression)&&void 0!==a?a:""},i.prototype.moveFilterItem=function(t,n,r,o,a){var l,s,c=this;if(o===a||o<0)return{shouldClear:!1};var le,u=this.rlsState.getRoleTable(t,n),f=this.rlsState.getFilter(t,n,a),v=this.rlsState.getFlatIndex(u.filtersGroup,a,0).index,C=this.rlsState.getFilter(t,n,o),E=this.rlsState.getFlatIndex(u.filtersGroup,o,0).index,z=this.getSelectedItemsSorted(t,n,r),ce=-1===z.indexOf(f)?[f]:z;if(le=C.isGroup()&&!C.isCollapsed&&v<E?C:this.getSameParent(t,n,[C.id]),ce.find(function(we){return!c.isDragAndDropPossible(we,le)}))return{shouldClear:!1};ce.forEach(function(we){c.tableService.setLevel(we,le.level+1);var Ue=c.getSameParent(t,n,[we.id]),Je=Ue.children.indexOf(we);Ue.children.splice(Je,1)});var fe=le.children.indexOf(C);return v<E?(l=le.children).splice.apply(l,(0,d.__spreadArray)([fe+1,0],ce,!1)):(s=le.children).splice.apply(s,(0,d.__spreadArray)([fe,0],ce,!1)),this.rebalanceFilterGroups(t,n),{shouldClear:r.indexOf(f.id)>=0}},i.prototype.rebalanceFilterGroups=function(t,n){var r=this.rlsState.getRoleTable(t,n);this.tableService.rebalanceFilterGroups(r)},i.prototype.refresh=function(t){var n;return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o=this;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return[4,Promise.all(null===(n=this.getModelRoles())||void 0===n?void 0:n.map(function(l){return(0,d.__awaiter)(o,void 0,void 0,function(){var s,c;return(0,d.__generator)(this,function(u){switch(u.label){case 0:return s=this.roleService.create(l.name),[4,this.createNewRLSTables(s,t)];case 1:return c=u.sent(),this.roleService.initialize(s,c),[2,s]}})})}))];case 1:return r=a.sent(),this.rlsState.roles={},r.forEach(function(l){o.rlsState.roles[l.name]=l}),this.calculateSelectionState(),[2]}})})},i.prototype.renameRole=function(t,n){if(n=n?.trim(),!n||this.getModelRole(n))return!1;var r=this.rlsState.getRole(t),o=this.rlsState.getRole(n);if(r&&!o){var a=this.getModelRole(t);return delete this.rlsState.roles[t],a?this.roleService.rename(r,n,!0):this.roleService.rename(r,n),this.rlsState.roles[n]=r,this.rlsState.editorState.selectedRole=n,!0}return!1},i.prototype.setDaxOnTable=function(t,n,r,o,a){void 0===o&&(o=""),void 0===a&&(a=!1);var l=this.rlsState.getRoleTable(t,n);l.daxExpression=r,l.filtersGroup=void 0,l.isDaxEditorOpen=!0,l.errorMessage=o,a&&(l.lastVerifiedDax=r)},i.prototype.setGroupOperator=function(t,n,r,o){var a=this.rlsState.getRoleTable(t,n),l=this.tableService.getFilter(a,r);l.isGroup()&&this.filterService.updateGroup(l,void 0,o)},i.prototype.setLevel=function(t,n,r,o){var a=this.rlsState.getRoleTable(t,n),l=this.tableService.getFilter(a,r);this.tableService.setLevel(l,o)},i.prototype.toggleCollapsedState=function(t,n,r,o){var a=this,l=this.rlsState.getRoleTable(t,n),s=this.tableService.getFilter(l,r);s.isGroup()&&(this.filterService.updateGroup(s,o,void 0),s.children.forEach(function(c){a.toggleCollapsedState(t,n,c.id,o)}))},i.prototype.ungroup=function(t,n,r){var o=this.rlsState.getRoleTable(t,n);o&&(this.tableService.ungroupFilters(o,r),this.rebalanceFilterGroups(t,n))},i.prototype.markSaveComplete=function(){this.eventAggregationService.publishToClient("RlsSaveEventSuccess",null)},i.prototype.calculateSelectionState=function(){if(!this.rlsState.roles[this.rlsState.editorState.selectedRole]){var t=this.rlsState.getRoles();this.rlsState.editorState.selectedRole=t.length>0?t[0].name:void 0}if(this.rlsState.editorState.selectedRole&&!this.rlsState.editorState.selectedTable){var n=this.rlsState.getRole(this.rlsState.editorState.selectedRole);this.rlsState.editorState.selectedTable=n.roleTables.length>0?n.roleTables[0].tableName:void 0}},i.prototype.createNewRLSTables=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a=this;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return r=this.getModelRole(t.name),o=new Map,r&&r.tablePermissions?[4,Promise.all(_.forEach(r.tablePermissions.getItems(),function(s){return(0,d.__awaiter)(a,void 0,void 0,function(){var c,u;return(0,d.__generator)(this,function(f){switch(f.label){case 0:return c=!1,n?[4,this.rlsToDax.standardizeDax(s.filterExpression,this.getModelTable(s.name))]:[3,2];case 1:u=f.sent(),c=s.filterExpression!==u,f.label=2;case 2:return o.set(s.name,c),[2]}})})}))]:[3,2];case 1:l.sent(),l.label=2;case 2:return[4,this.roleParsingService.loadRolePermissions(r,this.getModelTables(),n,o)];case 3:return[2,l.sent()]}})})},i.prototype.getModelRole=function(t){var n,r;return null===(r=null===(n=this.modelService.model)||void 0===n?void 0:n.roles)||void 0===r?void 0:r.find(function(o){return o.name===t})},i.prototype.getModelRoles=function(){var t,n,r,o;return null!==(o=null===(r=null===(n=null===(t=this.modelService)||void 0===t?void 0:t.model)||void 0===n?void 0:n.roles)||void 0===r?void 0:r.getItems())&&void 0!==o?o:[]},i.prototype.getModelTables=function(){var t,n,r;return(null!==(r=null===(n=null===(t=this.modelService.model)||void 0===t?void 0:t.tables)||void 0===n?void 0:n.getItems())&&void 0!==r?r:[]).filter(function(a){return a.canDefineRls})},i.prototype.isDragAndDropPossible=function(t,n){return null!==n&&!(t.isGroup()&&1===n.level)},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(T),e.\u0275\u0275inject(pe),e.\u0275\u0275inject(Oe.b),e.\u0275\u0275inject(Ce),e.\u0275\u0275inject(pt),e.\u0275\u0275inject(U),e.\u0275\u0275inject(ee),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(w.x))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Dn=p(69409),ot=function(i){function t(n,r,o,a,l,s){var c=i.call(this)||this;return c.rlsState=n,c.internalApi=r,c.filterService=o,c.rlsToDax=a,c.allowDax=!1,l.registerService("rlsApiService",c),c.allowDax=s.daxPane,c}return(0,d.__extends)(t,i),t.prototype.addFilter=function(n,r){var o=this;return this.execute(function(){var a=o.internalApi.addFilter(n,r);return o.setLastEditedInDax(!1),a})},t.prototype.addSiblingFilter=function(n,r,o){var a=this;return this.execute(function(){var l=a.internalApi.addFilter(n,r,o);return a.setLastEditedInDax(!1),l})},t.prototype.copyFiltersFromRole=function(n,r,o){var a=this;this.execute(function(){a.internalApi.copyFiltersFromRole(n,r,o)})},t.prototype.createRole=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(r){return[2,this.execute(function(){return(0,d.__awaiter)(n,void 0,void 0,function(){var o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return[4,this.internalApi.createRole()];case 1:return o=a.sent(),this.suspendNotifications(),this.selectRole(o.name),this.resumeNotifications(),this.setLastEditedInDax(!1),[2,o]}})})})]})})},t.prototype.createRoleByName=function(n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,d.__generator)(this,function(o){return[2,this.execute(function(){return(0,d.__awaiter)(r,void 0,void 0,function(){var a;return(0,d.__generator)(this,function(l){return a=this.internalApi.createRoleByName(n),this.suspendNotifications(),this.selectRole(n),this.resumeNotifications(),this.setLastEditedInDax(!1),[2,a]})})})]})})},t.prototype.deleteFilterItems=function(n,r,o){var a=this;this.execute(function(){a.internalApi.deleteFilterItems(n,r,o),a.setLastEditedInDax(!1)})},t.prototype.deleteRole=function(n){var r=this;this.execute(function(){r.internalApi.deleteRole(n);var o=r.getRoles();r.rlsState.editorState.selectedRole=o?.length>0?o[0].name:void 0,r.setLastEditedInDax(!1)})},t.prototype.duplicateRole=function(n){var r=this;return this.execute(function(){return r.internalApi.duplicateRole(n)})},t.prototype.getEditorState=function(){return this.rlsState.editorState},t.prototype.getFilter=function(n,r,o){return this.rlsState.getFilter(n,r,o)},t.prototype.getRole=function(n){return this.rlsState.getRole(n)},t.prototype.getRoles=function(){return this.rlsState.getRoles()},t.prototype.getModelRole=function(n){return this.internalApi.getModelRoles().find(function(r){return r.name===n})},t.prototype.getSameParent=function(n,r,o){return this.internalApi.getSameParent(n,r,o)},t.prototype.getSelectedTable=function(){return this.getCurrentTable()},t.prototype.getSelectedItemsSorted=function(n,r,o){return this.internalApi.getSelectedItemsSorted(n,r,o)},t.prototype.group=function(n,r,o){var a=this;return this.execute(function(){var l=a.internalApi.group(n,r,o);return a.setLastEditedInDax(!1),l})},t.prototype.isRlsDirty=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r,l,s;return(0,d.__generator)(this,function(u){switch(u.label){case 0:n=0,r=_.values(this.rlsState.roles),u.label=1;case 1:return n<r.length?[4,this.internalApi.isRoleDirty(r[n].name)]:[3,4];case 2:if(u.sent())return[2,!0];u.label=3;case 3:return n++,[3,1];case 4:for(l=0,s=this.internalApi.getModelRoles();l<s.length;l++)if(!this.rlsState.roles[s[l].name])return[2,!0];return[2,!1]}})})},t.prototype.canVerifyRlsExpression=function(n,r){if(!this.canRevertRlsExpression(n,r))return!1;var o=this.getRole(n).getTable(r);return!!o.lastEditedInDax&&o.lastVerifiedDax!==o.daxExpression},t.prototype.canRevertRlsExpression=function(n,r){var o=this.internalApi.getModelRoles().find(function(l){return l.name===n}),a=this.rlsState.getRole(n).getTable(r);return o?this.internalApi.isRoleTableDirty(o,a):""!==a.daxExpression},t.prototype.moveFilterItem=function(n,r,o,a,l){var s=this;return this.execute(function(){var c=s.internalApi.moveFilterItem(n,r,o,a,l);return c.shouldClear&&s.setLastEditedInDax(!1),c})},t.prototype.rebalanceFilterGroups=function(n,r){var o=this;return this.execute(function(){return o.internalApi.rebalanceFilterGroups(n,r)})},t.prototype.refresh=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(r){return[2,this.executeAsync(function(){return(0,d.__awaiter)(n,void 0,void 0,function(){return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.internalApi.refresh(this.allowDax)];case 1:return o.sent(),[2]}})})})]})})},t.prototype.renameRole=function(n,r){var o=this;return this.execute(function(){return o.internalApi.renameRole(n,r)})},t.prototype.selectRole=function(n){var r=this;return this.execute(function(){r.rlsState.editorState.selectedRole=n})},t.prototype.selectTable=function(n){var r=this;return this.execute(function(){r.rlsState.editorState.selectedTable=n})},t.prototype.setLastEditedInDax=function(n){this.getCurrentTable()&&(this.getCurrentTable().lastEditedInDax=n)},t.prototype.setDaxOnTable=function(n,r,o,a,l){var s=this;return void 0===a&&(a=""),void 0===l&&(l=!1),this.executeAsync(function(){return(0,d.__awaiter)(s,void 0,void 0,function(){return(0,d.__generator)(this,function(c){return this.internalApi.setDaxOnTable(n,r,o,a,l),this.setLastEditedInDax(!0),[2]})})})},t.prototype.setFilterValue=function(n,r,o,a){var l=this;return this.execute(function(){l.filterService.setFilterValue(n,r,o,a),l.setLastEditedInDax(!1)})},t.prototype.setGroupOperator=function(n,r,o,a){var l=this;return this.execute(function(){l.internalApi.setGroupOperator(n,r,o,a),l.setLastEditedInDax(!1)})},t.prototype.setLevel=function(n,r,o,a){var l=this;return this.execute(function(){return l.internalApi.setLevel(n,r,o,a)})},t.prototype.switchToDax=function(){var n=this,r=this.getCurrentTable();if(r)return this.executeAsync(function(){return(0,d.__awaiter)(n,void 0,void 0,function(){var o,a;return(0,d.__generator)(this,function(l){return o="",a="",r.daxExpression&&r.lastEditedInDax?(o=r.daxExpression,a=r.errorMessage):r.tableFilters&&r.tableFilters.length>0&&(o=this.rlsToDax.convertFilterGroup(this.rlsState.editorState.selectedRole,r.filtersGroup.id,this.internalApi.getModelTable(this.rlsState.editorState.selectedTable),!1)),this.internalApi.setDaxOnTable(this.rlsState.editorState.selectedRole,this.rlsState.editorState.selectedTable,o,a),[2]})})})},t.prototype.switchToFilters=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,d.__generator)(this,function(o){return(n=this.getCurrentTable())?[2,this.executeAsync(function(){return(0,d.__awaiter)(r,void 0,void 0,function(){return(0,d.__generator)(this,function(a){switch(a.label){case 0:return[4,this.internalApi.forceConvertDaxToFilters(this.rlsState.editorState.selectedRole,this.rlsState.editorState.selectedTable,n.daxExpression)];case 1:return a.sent(),n.isDaxEditorOpen=!1,[2]}})})})]:[2]})})},t.prototype.toggleCollapsedState=function(n,r,o,a){var l=this;return this.execute(function(){return l.internalApi.toggleCollapsedState(n,r,o,a)})},t.prototype.updateFilter=function(n,r,o,a,l){var s=this;return this.execute(function(){s.filterService.updateFilter(n,r,o,a,l),s.setLastEditedInDax(!1)})},t.prototype.ungroup=function(n,r,o){var a=this;return this.execute(function(){a.internalApi.ungroup(n,r,o),a.setLastEditedInDax(!1)})},t.prototype.validateFilters=function(){var n=this;return this.execute(function(){for(var r=!0,o=0,a=_.values(n.rlsState.roles);o<a.length;o++)for(var l=a[o],s=0,c=_.values(l._roleTables);s<c.length;s++){var u=c[s],f=n.internalApi.getModelTable(u.tableName);n.filterService.validateGroup(l.name,f,u.filtersGroup)||(r=!1)}return r})},t.prototype.validateDaxCanBeSynced=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return n=this.getCurrentRole(),(r=this.getCurrentTable()).errorMessage?[2,!1]:n&&r?[4,this.internalApi.canConvertDaxToFilter(n.name,r.tableName,r.daxExpression)]:[3,2];case 1:return[2,o.sent()];case 2:return[2,!0]}})})},t.prototype.markSaveComplete=function(){this.internalApi.markSaveComplete()},t.prototype.getCurrentRole=function(){if(this.rlsState.editorState.selectedRole)return this.rlsState.getRole(this.rlsState.editorState.selectedRole)},t.prototype.getCurrentTable=function(){if(this.rlsState.editorState.selectedTable){var n=this.getCurrentRole();return n?.getTable(this.rlsState.editorState.selectedTable)}},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(T),e.\u0275\u0275inject(hn),e.\u0275\u0275inject(Ce),e.\u0275\u0275inject(pe),e.\u0275\u0275inject(Dn.$),e.\u0275\u0275inject(B.m))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(k),Tn=function(){function i(t){this.rlsService=t}return i.prototype.registerEditor=function(t,n){var r;this.editor=t,this.previouslySavedValue=n,null===(r=this.editor)||void 0===r||r.setValue(this.previouslySavedValue)},i.prototype.resetEditorValue=function(t){var n;this.previouslySavedValue=t,null===(n=this.editor)||void 0===n||n.setValue(this.previouslySavedValue)},i.prototype.onContentChanged=function(){this.editor.formulaText=this.editor.getText(),this.submit()},i.prototype.submit=function(){var t,n=null===(t=this.editor)||void 0===t?void 0:t.formulaText.trim();if(n!==this.previouslySavedValue){var r=this.rlsService.getEditorState(),o=this.rlsService.getSelectedTable();this.rlsService.setDaxOnTable(r.selectedRole,r.selectedTable,n,o.errorMessage),this.previouslySavedValue=n}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(ot))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),jt=p(558),Ci=p(21661),Yt=p(79061),Si=p(68101),sn=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[b,y]}),i}(),cn=p(56200),Mi=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[K,Ce,ot,T,pe,ee,pt,hn,U],imports:[sn,cn.R3,X.S,sn]}),i}(),wi=p(59051),ie=p(77476),ye=p(17174),In=p(44408),nn=p(55710),dn=function(){function i(){}return i.prototype.transform=function(t,n,r){return _.orderBy(t,n,r)},i.\u0275fac=function(n){return new(n||i)},i.\u0275pipe=e.\u0275\u0275definePipe({name:"orderBy",type:i,pure:!0}),i}(),xi=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({}),i}(),Pi=p(50932),rn=p(45125),Wt=p(56545),Oi=p(50057),ft=p(85102),Ct=["*"],mn=function(){function i(){this.remove=new e.EventEmitter}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["editable-list-item"]],outputs:{remove:"remove"},ngContentSelectors:Ct,decls:5,vars:3,consts:[[1,"editableListItemContent"],["localizeTooltip","Delete","data-testid","remove-btn",1,"removeButton",3,"click"],["aria-hidden","true",1,"glyphicon","pbi-glyph-close","glyph-mini"]],template:function(n,r){1&n&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275projection(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"button",1),e.\u0275\u0275listener("click",function(){return r.remove.emit()}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275element(4,"i",2),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,1,"Delete")))},dependencies:[Oi.r,ft.F],styles:["[_nghost-%COMP%]{display:list-item;padding:3px 0;list-style-type:none}[_nghost-%COMP%]   .editableListItemContent[_ngcontent-%COMP%]{display:inline-block;max-width:calc(100% - 44px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[_nghost-%COMP%]   .removeButton[_ngcontent-%COMP%]{background:0 0;border:0;float:right;padding:3px 16px}[_nghost-%COMP%]:hover{background-color:var(--neutral-light-color, #EAEAEA)}"]}),i}(),Fn=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[Yt.v]}),i}(),fn=p(16748),kn=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[xi,ie.CommonModule,Yt.v,wi.U8,Pi.F,ye.u5,ye.UX,Fn,Wt.g,nn.jT,In.Ps,fn.H,rn.z,rn.z]}),i}(),Bn=p(16973),Ei=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[ie.CommonModule]}),i}(),vn=p(8902),Di=p(93088),Ln=p(47913),Nn=p(51521),Vn=p(6015),Ti=p(94770),Un=p(93367),Ii=p(94841),Ri=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[ie.CommonModule]}),i}(),fr=p(67659),G=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[ie.CommonModule,Yt.v,fr._,Nn.h]}),i}(),j=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[ie.CommonModule,Yt.v,G,G]}),i}(),H=p(16095),te=p(14977),oe=p(44913),de=p(78035),ve=p(47768),ke=p(17177),Ie=p(8816),Xe=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:vn.Mi,useExisting:D.g},Tn],imports:[Ei,jt._t,Yt.v,cn.R3,Bn.e,X.S,Di.z,Ii.b,Ln.V,Nn.h,Vn.C,Ti.f,Un.U,Ri,j,H.Z,sn,Mi,kn,Ci.Cl,te.B,oe.lK,de.Y,ve.I,ke.T6,Ie.w,Si.B,kn]}),i}(),tt=p(13254),Ne=p(45411),Ye=p(39433),St=p(55533),zn=p(79725),_n=p(63766),jn=p(11582),vr=p(30435),Ht=p(59623),va=p(11962),_a=p(82156),_r={loadChildren:function(){return Promise.resolve().then(p.bind(p,72289)).then(function(t){return t.FluentListModule})}};p(76072).E.addLazyLoadForLegacyMapping("@powerbi/CoreFluentList/fluent-list.module#FluentListModule",_r.loadChildren);var ya=[{path:"dummy-lazy-route-for-fluent-list",loadChildren:_r.loadChildren}],Ca=p(30651),Sa=p(5915),Ma=p(16149),wa=p(46303),br=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:vn.Mi,useExisting:D.g},se],imports:[cn.R3,Bn.e,Ln.V,Vn.C,Un.U,tt.x,Ye.t,St.q,fn.H,zn.j,_n.l,H.Z,Ne.m,X.S,Xe,jn.$9,te.B,vr.nU,Ht.up,oe.lK,va.V7,ve.I,ke.T6,Ie.w,Ca.Jy,Sa.d,Ma.m,wa.b,M.FluentListModule,_a.N,R.Bz.forChild(ya),cn.R3,X.S,Xe]}),i}(),Se=p(41114),Ai="PBI.CopilotDescriptions.Accepted",Fi=(Se.cx[Ai]=(0,Se.b1)(Ai),"PBI.CopilotDescriptions.Discarded"),ki=(Se.cx[Fi]=(0,Se.b1)(Fi),"PBI.CopilotDescriptions.Retried"),Bi=(Se.cx[ki]=(0,Se.b1)(ki),"PBI.CopilotDescriptions.Requested"),Gt=(Se.cx[Bi]=(0,Se.b1)(Bi),p(35510)),Dt=p(94759),xa=p(92060),yr=p(42790),gt=p(12985),Mt=p(98665),Pa=p(79590),Wn="GenerateMeasureDescriptions",Cr=function(){function i(t,n,r,o,a,l){this.localizationService=t,this.telemetryService=n,this.certifiedEventsService=r,this.copilotScenarioService=o,this.accountService=a,this.consumptionMethod=l,this._loading$=new Gt.X(!1),this.loading$=this._loading$.asObservable(),this.featureName=(0,Dt.mN)("Usage",Wn)}return i.prototype.generateMeasureDescriptions=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return n=this.buildMeasureDescriptionsRequest(t),[4,this.requestDescriptions(n)];case 1:return[2,r.sent()]}})})},i.prototype.buildMeasureDescriptionsRequest=function(t){return{scenarioDefinition:{generateModelItemDescriptions:{modelItems:this.sanitizeMeasures(t).map(function(o){return{urn:gt.X6.getMeasureUrn(o.table.name,o.name,o.schemaName),type:1,name:o.name,expression:o.expression}})}}}},i.prototype.requestDescriptions=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,this.accountService.isSignedInAsync()];case 1:return r.sent()?(this.logFunnelEvent(!0,["ClickButton"]),[4,this.requestDescriptionsInternal(t,n)]):[3,3];case 2:return[2,r.sent()];case 3:this.logFunnelEvent(!1,["ClickButton"]),r.label=4;case 4:return[4,this.accountService.trySignInAsync()];case 5:return r.sent(),[4,this.accountService.isSignedInAsync(!0)];case 6:return r.sent()?[4,this.requestDescriptionsInternal(t,n)]:[3,8];case 7:return[2,r.sent()];case 8:throw this.getErrorObj({code:"NotAuthorized"})}})})},i.prototype.requestDescriptionsInternal=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:n?(t.isUserInitiatedRetry=!0,this.logEvent(ki)):this.logEvent(Bi),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getMeasureDescriptions(t)];case 2:if((r=a.sent()).modelItems)return this.logReliabilityEvent("Succeeded"),[2,r];if(r.error)throw r.error;return[3,4];case 3:throw o=a.sent(),this.logFunnelEvent(!0,["Error"]),this.logReliabilityEvent("Failed"),this.getErrorObj(o);case 4:return[2]}})})},i.prototype.getMeasureDescriptions=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(l){return[2,this.copilotScenarioService.runScenario("generateModelItemDescriptions",t.scenarioDefinition.generateModelItemDescriptions,{stream:!1,isUserInitiatedRetry:t.isUserInitiatedRetry}).toPromise()]})})},i.prototype.setIsLoading=function(t){this._loading$.next(t)},i.prototype.sanitizeMeasures=function(t){for(var n=[],r=/(\/\/).*|(\/\*)(?:(?!\*\/)(.|\n))*(\*\/)/g,o=/"([^"]*)"/g,a=0,l=t;a<l.length;a++){var s=l[a],c=s.expression;c=c?(c=(c=c.replace(r,"")).replace(o,'"STRING LITERAL"')).trim():"",n.push((0,d.__assign)((0,d.__assign)({},s),{expression:c}))}return n},i.prototype.getErrorObj=function(t){var n=this.localizationService.get("Error"),r=t.message,o="https://go.microsoft.com/fwlink/?linkid=2258254",a=this.localizationService.get("LearnMore"),l=t.code,s=t.details;switch(l){case Dt.a$.OpenAIDisallowedCode:n=this.localizationService.get("Copilot_AccessDenied"),r=this.localizationService.get("CopilotCapability_AdminDisabled_Message");break;case Dt.a$.ScenarioCapacityRequiredCode:case Dt.a$.ScenarioSkuNotSupportedCode:n=this.localizationService.get("CopilotCapability_NoAccess_Title"),r=this.localizationService.get("CopilotCapability_NoEligibleWorkspace_Message"),o="https://go.microsoft.com/fwlink/?linkid=2249079",a=this.localizationService.get("CopilotCapability_CapacityRequirements_LearnMoreMessage");break;case Dt.a$.OpenAIDisallowedForCrossRegionCode:n=this.localizationService.get("Copilot_AccessDenied"),r=this.localizationService.get("CopilotCapability_CrossGeoNotAllowed_Message_Alternative"),o="https://go.microsoft.com/fwlink/?linkid=2249079",a=this.localizationService.get("CopilotCapability_SaveToWorkspace_LearnMore")}return{title:n,message:r,code:l,link:o,linkText:a,details:s}},i.prototype.logEvent=function(t){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,originatingService:Dt.F1,featureName:this.featureName,activityName:t,activityStatus:"Succeeded",activityAttributes:this.getHierarchyAttributes(!0),resultCode:void 0})},i.prototype.logFunnelEvent=function(t,n){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,featureName:(0,Dt.mN)("Funnel",Wn,n),activityName:n.length?n[n.length-1]:"UnknownActivity",activityStatus:"Succeeded",activityAttributes:this.getHierarchyAttributes(t),resultCode:void 0})},i.prototype.logReliabilityEvent=function(t){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,featureName:(0,Dt.mN)("Reliability",Wn),activityName:Wn,activityStatus:t,activityAttributes:this.getHierarchyAttributes(!0),resultCode:void 0})},i.prototype.getHierarchyAttributes=function(t){return{IsSignedIn:t,Location:(0,Dt.MG)(this.consumptionMethod),ContentMode:"Edit",ContentType:"Model"}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(Mt.y0),e.\u0275\u0275inject(Mt.ly),e.\u0275\u0275inject(Pa.Q),e.\u0275\u0275inject(xa.F),e.\u0275\u0275inject(yr.$))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),at=p(67489),Rt=p(64284),Oa=p(79571),Ea=p(52042),Da=p(4516),Ta=p(96278),Ot=p(9380),Nt=p(96777),kt=p(36858),Vt=p(74913),Sr=p(65e3);function Ia(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",3)(1,"p",4),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",5)(5,"h2"),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.copyCurrentDescription())}),e.\u0275\u0275pipe(9,"localize"),e.\u0275\u0275pipe(10,"localize"),e.\u0275\u0275element(11,"tri-svg-icon",7),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"p",8),e.\u0275\u0275text(13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",9)(15,"h2"),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.copyCopilotDescription())}),e.\u0275\u0275pipe(19,"localize"),e.\u0275\u0275pipe(20,"localize"),e.\u0275\u0275element(21,"tri-svg-icon",7),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"p",10),e.\u0275\u0275text(23),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.retry())}),e.\u0275\u0275pipe(25,"localize"),e.\u0275\u0275element(26,"tri-svg-icon",12),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,11,"Description_Will_Be_Visible")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,13,"Current")),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(9,15,"Visual_CopyValue")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(10,17,"Visual_CopyValue")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(r.input.currentDescription),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(17,19,"From_Copilot_No_Preview")),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(19,21,"Visual_CopyValue")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(20,23,"Visual_CopyValue")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(r.fromCopilotDescription),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(25,25,"TryAgain")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,27,"TryAgain")," ")}}function Ra(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",13)(1,"p",14),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",15),e.\u0275\u0275element(5,"div",16),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,1,"DialogFooter_OKActionWorkingOnIt")))}function Aa(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-link",19),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("external",!0)("href",n.error.link),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.error.linkText," ")}}function Fa(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",17)(1,"h1"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"p"),e.\u0275\u0275text(4),e.\u0275\u0275template(5,Aa,2,3,"tri-link",18),e.\u0275\u0275elementEnd()()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.error.title),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",n.errorMessage," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.error.link)}}var Mr=function(){function i(t,n,r,o,a,l,s,c,u,f){this.copilotInteractiveRequirementsService=t,this.generateModelItemDescriptionService=n,this.templateDialogPayload=r,this.telemetryService=o,this.certifiedEventsService=a,this.localizationService=l,this.renderer2=s,this.elementRef=c,this.featureSwitchService=u,this.consumptionMethod=f,this.loading=!1,this.errorClass="has-error",this.retried=!1}return i.prototype.ngOnInit=function(){var t=this;this.featureName=(0,Dt.mN)("Usage","GenerateMeasureDescriptions"),this.input=this.templateDialogPayload.input,this.templateDialogPayload.onOkButtonClick=function(){return t.ok()},this.templateDialogPayload.onCancelButtonClick=function(){return t.close()},this.requestDescriptions()},i.prototype.ok=function(){return this.logEvent(Ai),this.logFunnelEvent(["KeepResponse"]),Promise.resolve({ok:!0,response:this.response})},i.prototype.close=function(){return this.logEvent(Fi),this.logFunnelEvent(["DiscardResponse"]),Promise.resolve({ok:!1})},i.prototype.copyCurrentDescription=function(){navigator.clipboard.writeText(this.input.currentDescription)},i.prototype.copyCopilotDescription=function(){navigator.clipboard.writeText(this.fromCopilotDescription)},i.prototype.retry=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){switch(t.label){case 0:return[4,this.requestDescriptions(!0)];case 1:return t.sent(),[2]}})})},i.prototype.requestDescriptions=function(t){var n,r;return(0,d.__awaiter)(this,void 0,void 0,function(){var o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return this.resetState(),this.retried=t,this.setLoading(!0),this.featureSwitchService.featureSwitches.copilotLicensingStatusCheck?[4,this.copilotInteractiveRequirementsService.validateRequirements({showLoadingDialog:!1})]:[3,5];case 1:return o=a.sent(),null!==(n=o?.copilotStatus)&&void 0!==n&&n.enabled?[4,this.tryRequestDescriptions(t)]:[3,3];case 2:return a.sent(),[3,4];case 3:this.templateDialogPayload.closeDialogFromConsumer({ok:!1,response:{modelItems:void 0,error:{code:null===(r=o?.copilotStatus)||void 0===r?void 0:r.reason}}}),a.label=4;case 4:return[3,7];case 5:return[4,this.tryRequestDescriptions(t)];case 6:a.sent(),a.label=7;case 7:return this.setLoading(!1),[2]}})})},i.prototype.tryRequestDescriptions=function(t){var n;return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a;return(0,d.__generator)(this,function(l){switch(l.label){case 0:r=(0,d.__assign)({},this.input.args),l.label=1;case 1:return l.trys.push([1,3,,4]),o=this,[4,this.generateModelItemDescriptionService.requestDescriptions(r,t)];case 2:return o.response=l.sent(),this.fromCopilotDescription=null===(n=this.response.modelItems[0])||void 0===n?void 0:n.description,[3,4];case 3:return"NotAuthorized"===(a=l.sent()).code&&this.templateDialogPayload.closeDialogFromConsumer({ok:!1}),this.setError(a),[3,4];case 4:return[2]}})})},i.prototype.setLoading=function(t){this.loading=t,this.templateDialogPayload.toggleOkButton(t),this.templateDialogPayload.setCancelButtonText(this.localizationService.get(t?"Cancel_ButtonText":"Settings_DiscardButtonText"))},i.prototype.setError=function(t){this.error=t,this.setErrorMessage(),this.response={modelItems:void 0,error:t},this.renderer2.addClass(this.elementRef.nativeElement,this.errorClass),this.templateDialogPayload.setOkButtonText(this.localizationService.get("ModalDialogButtonText_Ok")),this.templateDialogPayload.toggleCancelButton(!0)},i.prototype.setErrorMessage=function(){var t;t=_.isEmpty(this.error.details)?this.error.message:this.error.details.map(function(n){return n.message}).join(" "),this.errorMessage=t},i.prototype.resetState=function(){this.renderer2.removeClass(this.elementRef.nativeElement,this.errorClass),this.templateDialogPayload.setOkButtonText(this.localizationService.get("Keep_It")),this.templateDialogPayload.toggleCancelButton(!1),this.error=void 0,this.response=void 0},i.prototype.logEvent=function(t){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,originatingService:Dt.F1,featureName:this.featureName,activityName:t,activityStatus:"Succeeded",activityAttributes:{retried:this.retried},resultCode:void 0})},i.prototype.logFunnelEvent=function(t){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,featureName:(0,Dt.mN)("Funnel","GenerateMeasureDescriptions",t),activityName:t?.length?t[t.length-1]:"UnknownActivity",activityStatus:"Succeeded",activityAttributes:{IsSignedIn:!0,Location:(0,Dt.MG)(this.consumptionMethod),ContentMode:"Edit",ContentType:"Model"},resultCode:void 0})},i.dialogNameKey=Rt.q0,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Ta.g),e.\u0275\u0275directiveInject(Cr),e.\u0275\u0275directiveInject(at.x),e.\u0275\u0275directiveInject(Mt.y0),e.\u0275\u0275directiveInject(Mt.ly),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(e.Renderer2),e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(Ot.vZ),e.\u0275\u0275directiveInject(yr.$))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["generate-model-item-descriptions"]],features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)((0,d.__spreadArray)((0,d.__spreadArray)([Cr,at.x],Ea.c,!0),(0,Oa.FH)({artifactType:"SemanticModel",llmNames:["gpt-4-32k"],scenarioNames:["MeasureDescription"]}),!0),[Da.qb],!1))],decls:4,vars:3,consts:[["class","copilot-model-item-description-dialog",4,"ngIf"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],[1,"copilot-model-item-description-dialog"],[1,"dialog-description"],[1,"current-title-container"],[3,"pbiTooltip","click"],["tri-svg-icon-20","","name","copy_20_regular"],[1,"current-description"],[1,"from-copilot-title-container"],[1,"from-copilot-description"],["tri-button","",1,"retry-btn",3,"click"],["tri-svg-icon-20","","name","arrow_sync_20_regular"],[1,"loading"],[1,"loading-message"],[1,"loading-bar-container"],[1,"loading-bar"],[1,"error"],["target","_blank",3,"external","href",4,"ngIf"],["target","_blank",3,"external","href"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"template-dialog"),e.\u0275\u0275template(1,Ia,29,29,"div",0),e.\u0275\u0275template(2,Ra,6,3,"div",1),e.\u0275\u0275template(3,Fa,6,3,"div",2),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.loading&&!r.error),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.loading),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.error))},dependencies:[ie.NgIf,Nt.J,kt.V,Vt.M,Sr.v,ft.F],styles:["[_nghost-%COMP%]     .pbi-dialog-header h2{color:var(--colorNeutralForeground1)!important}[_nghost-%COMP%]     .pbi-dialog-header .header-description{margin-top:10px;margin-bottom:0!important;color:var(--colorNeutralForeground1);font-size:var(--md-font-size)}.has-error[_nghost-%COMP%]     dialog-header{display:none}.copilot-model-item-description-dialog[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1)}.copilot-model-item-description-dialog[_ngcontent-%COMP%]   .dialog-description[_ngcontent-%COMP%]{margin:-6px 0 0}.copilot-model-item-description-dialog[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:0;font-size:var(--md-font-size)!important;font-weight:var(--font-weight-bold)}.copilot-model-item-description-dialog[_ngcontent-%COMP%]   .current-title-container[_ngcontent-%COMP%], .copilot-model-item-description-dialog[_ngcontent-%COMP%]   .from-copilot-title-container[_ngcontent-%COMP%]{display:flex}.copilot-model-item-description-dialog[_ngcontent-%COMP%]   .current-title-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .copilot-model-item-description-dialog[_ngcontent-%COMP%]   .from-copilot-title-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px 0 0 4px;height:20px;border:none;background:none;padding:0}.copilot-model-item-description-dialog[_ngcontent-%COMP%]   .current-title-container[_ngcontent-%COMP%]     svg, .copilot-model-item-description-dialog[_ngcontent-%COMP%]   .from-copilot-title-container[_ngcontent-%COMP%]     svg{fill:var(--colorNeutralForeground1)}.copilot-model-item-description-dialog[_ngcontent-%COMP%]   .current-description[_ngcontent-%COMP%]{margin:0}.copilot-model-item-description-dialog[_ngcontent-%COMP%]   .from-copilot-description[_ngcontent-%COMP%]{margin:0 0 10px}.loading[_ngcontent-%COMP%]   .loading-message[_ngcontent-%COMP%]{margin:0;font-size:var(--sm-font-size);font-weight:var(--font-weight-semi-bold)}.loading[_ngcontent-%COMP%]   .loading-bar-container[_ngcontent-%COMP%]{margin:5px auto 0;padding:2px;position:relative;height:2px;border:0px;border-radius:4px;background-image:linear-gradient(to right,#117865,#11D4B0,#00F0FF,#00F0FF,#11D4B0,#117865)}.loading[_ngcontent-%COMP%]   .loading-bar-container[_ngcontent-%COMP%]   .loading-bar[_ngcontent-%COMP%]{top:0;right:100%;bottom:0;left:0;width:0;position:absolute;background-image:linear-gradient(to right,transparent,#DCF41F,transparent);animation:_ngcontent-%COMP%_loading-bar-animation 2s linear infinite}.error[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:var(--xlg-font-size);color:var(--colorNeutralForeground1);line-height:var(--pbi-font-28);font-weight:var(--font-weight-semi-bold)}.error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1)}@keyframes _ngcontent-%COMP%_loading-bar-animation{0%{left:0%;right:100%;width:0%}50%{left:0%;right:0%;width:100%}to{left:100%;right:0%;width:0%}}"]}),i}(),Et=p(59017),ka=p(33554),wr=p(63057),bn=p(11547),xr=p(60225),Me=p(14172),Bt=p(81905),qe=p(83317),st=p(59973),nt=p(48787),Hn=p(24874),Li=p(95281),yn=p(82762),Pr=p(77526),Ni=p(6754),Or=p(17653),Er=p(94853),Kt=p(29804),Gn=p(92989),$t=p(70863),Dr="PBIConstructCandidateRelationship",Ba=Se.cx[Dr]=(0,Se.b1)(Dr),Tr="PBIAskToSkipRelationshipValidation",La=Se.cx[Tr]=(0,Se.b1)(Tr),Ir="PBIValidateUpdatedRelationship",Na=Se.cx[Ir]=(0,Se.b1)(Ir),Rr="PBIASValidationCacheEventName",Va=Se.cx[Rr]=(0,Se.b1)(Rr),V=p(40430);function Vi(i){return"BothDirections"===i?V.jE.BothDirections:V.jE.OneDirection}function Ui(i,t){return"Many"===i&&"Many"===t?V.KA.ManyToMany:"Many"===i&&"One"===t?V.KA.ManyToOne:"One"===i&&"One"===t?V.KA.OneToOne:"One"===i&&"Many"===t?V.KA.OneToMany:V.KA.None}function zi(i){return"BothDirections"===i?V.Lv.BothDirections:"OneDirection"===i?V.Lv.OneDirection:V.Lv.None}var Ua=p(38078),Qe=p(95867),za=function(i){function t(n){var r=i.call(this)||this;return r.name="RelationshipNotExistError",r.message="relationship ".concat(n," does not exist in model"),r}return(0,d.__extends)(t,i),t}(Error);function Ar(i,t,n,r){if(!i)return Br(t,n,r);var o=function(i,t){var n=(0,Qe.gq)(t,i);if(!n)throw new za(i);return n}(i,n),a={fromTableName:o.fromTable.name,fromColumnName:o.fromColumn.name,toTableName:o.toTable.name,toColumnName:o.toColumn.name};return kr(a,t)?(0,d.__spreadArray)([Kn(a,(0,Qe.UM)(n,a.fromTableName),(0,Qe.UM)(n,a.toTableName))],Br(t,n,r),!0):Lr(o,t)?Nr(t,(0,Qe.UM)(n,t.fromTableName),(0,Qe.UM)(n,t.toTableName),r):[]}function Fr(i,t,n){return{relationshipUpdateProperties:{isActive:i.isActive,referentialIntegrity:i.referentialIntegrity,fromCardinality:i.fromCardinality,toCardinality:i.toCardinality,crossFilteringBehavior:i.crossFilteringBehavior,securityFilteringBehavior:i.securityFilteringBehavior,fromColumns:[gt.X6.getColumnUrn(i.fromTableName,i.fromColumnName,t)],toColumns:[gt.X6.getColumnUrn(i.toTableName,i.toColumnName,n)]}}}function Kn(i,t,n){return{relationshipDelete:{fromColumns:[gt.X6.getColumnUrn(i.fromTableName,i.fromColumnName,t)],toColumns:[gt.X6.getColumnUrn(i.toTableName,i.toColumnName,n)]}}}function Cn(i,t,n){return{relationshipCreate:{name:Ua.b$.generateGuid(),isActive:i.isActive,referentialIntegrity:i.referentialIntegrity,fromCardinality:i.fromCardinality,toCardinality:i.toCardinality,crossFilteringBehavior:i.crossFilteringBehavior,securityFilteringBehavior:i.securityFilteringBehavior,fromColumns:[gt.X6.getColumnUrn(i.fromTableName,i.fromColumnName,t)],toColumns:[gt.X6.getColumnUrn(i.toTableName,i.toColumnName,n)]}}}function ji(i){var t=(0,d.__assign)({},i),n=t.fromTableName;t.fromTableName=t.toTableName,t.toTableName=n;var r=t.fromColumnName;return t.fromColumnName=t.toColumnName,t.toColumnName=r,t}function $n(i){if("One"!==i.fromCardinality||"Many"!==i.toCardinality)return i;var t=ji(i);return(0,d.__assign)((0,d.__assign)((0,d.__assign)({},i),t),{fromCardinality:"Many",toCardinality:"One"})}function kr(i,t){return t.fromTableName!==i.fromTableName||t.toTableName!==i.toTableName||t.fromColumnName!==i.fromColumnName||t.toColumnName!==i.toColumnName}function Br(i,t,n){var r=i.fromTableName,a=i.toTableName,s=(0,Qe.Te)(t,r,a,i.fromColumnName,i.toColumnName);return s?Lr(s,i)?Nr(i,(0,Qe.UM)(t,r),(0,Qe.UM)(t,a),n):[]:function(i,t,n,r){return r&&"One"===i.fromCardinality&&"Many"===i.toCardinality?[Cn($n(i),n,t)]:[Cn(i,t,n)]}(i,(0,Qe.UM)(t,r),(0,Qe.UM)(t,a),n)}function Lr(i,t){if(kr({fromTableName:i.fromTable.name,fromColumnName:i.fromColumn.name,toTableName:i.toTable.name,toColumnName:i.toColumn.name},t))throw new Error("Expect to check the same relationship's properties");return i.fromCardinality!==t.fromCardinality||i.toCardinality!==t.toCardinality||i.crossFilteringBehavior!==t.crossFilteringBehavior||i.isActive!==t.isActive||i.securityFilteringBehavior!==t.securityFilteringBehavior||i.referentialIntegrity!==t.referentialIntegrity}function Nr(i,t,n,r){if(r&&"One"===i.fromCardinality&&"Many"===i.toCardinality){var o=$n(i),a=n,l=t;return[Kn(i,t,n),Cn(o,a,l)]}return[Fr(i,t,n)]}function Wi(i){return i===V.KA.ManyToMany||i===V.KA.ManyToOne?"Many":"One"}function Hi(i){return i===V.KA.ManyToMany||i===V.KA.OneToMany?"Many":"One"}function Gi(i){return i===V.jE.Automatic?"Automatic":i===V.jE.BothDirections?"BothDirections":"OneDirection"}function Ki(i,t,n,r){return i?"OneDirection"!==n&&r&&t===V.Lv.BothDirections?"BothDirections":"OneDirection":"None"}var ht=function(i){return i[i.InvalidKey=0]="InvalidKey",i[i.String=1]="String",i[i.Int=2]="Int",i[i.Double=3]="Double",i[i.DateTime=4]="DateTime",i[i.Date=5]="Date",i[i.Time=6]="Time",i[i.Boolean=7]="Boolean",i}({}),Ha=function(){function i(){}return i.getRelationshipProbabilityMatrix=function(t,n){var r=this;if(t&&n){for(var o=t.map(function(E){return r.getNormalizedName(E)}),a=n.map(function(E){return r.getNormalizedName(E)}),l=t.map(function(E){return r.getColumnKey(E,!0)}),s=n.map(function(E){return r.getColumnKey(E,!0)}),c=[],u=0;u<t.length;u++){c[u]=[];for(var f=t[u],v=0;v<n.length;v++)c[u][v]=this.getRelationshipProbability(f,n[v],o[u],a[v],l[u],s[v])}return c}},i.getRelationshipProbability=function(t,n,r,o,a,l){var s=0;if(t&&n){var c=this.getRelationshipKeyType(t),u=this.getRelationshipKeyType(n);c===u&&c!==ht.InvalidKey&&(s=.1,0===t.name.localeCompare(n.name)?s=.9:r===o?s=.8:a===l&&(s=.7),s>.1&&(c!==u&&(s*=.9),(c===ht.DateTime||u===ht.DateTime||c===ht.Date||u===ht.Date||c===ht.Time||u===ht.Time)&&(s*=.5),this.canHaveRelationship(t,n)||(s=0)))}return s},i.canHaveRelationship=function(t,n){return void 0===t?this.isPossibleKey(n):!_.isEqual(t.table,n.table)&&this.isPossibleKey(t)&&this.isPossibleKey(n)&&this.getRelationshipKeyType(t)===this.getRelationshipKeyType(n)},i.isPossibleKey=function(t){return this.getRelationshipKeyType(t)!==ht.InvalidKey},i.getNormalizedName=function(t){var n=t.name,r=t.table.name,o=this.splitIntoWords(n);return o.length>0?o.join("-"):(0,d.__spreadArray)((0,d.__spreadArray)([],this.splitIntoWords(r),!0),[n],!1).join("-")},i.splitIntoWords=function(t,n){var r=this;return void 0===n&&(n=void 0),(t=t.replace(this.camelRegex,function(a){return" "+a})).toLowerCase().split(this.specialCharactersRegex).filter(function(a){return!r.isNoise(a,n)})},i.isNoise=function(t,n){return!t||!!n&&n?.length>0&&n.includes(t)},i.getColumnKey=function(t,n){void 0===n&&(n=!0);var r=t.table?t.table.name:"",o=t.name,a=this.getRelationshipKeyType(t);if(n){var l=(o=(o=o.replace(this.numberRegex,"")).replace(this.commentRegex,"")).split(".");l.length>=2&&(o=l[l.length-1],r=l[l.length-2])}var u=this.splitIntoWords(o,n?["name","id","key","code","pk","fk"]:void 0);return(u.length>0?u.join(""):this.splitIntoWords(r).join(""))+":"+a.toString()},i.getRelationshipKeyType=function(t){if(t.columnType===V.QD.RowNumber||t.table.isCalculationGroup)return ht.InvalidKey;switch(t.dataType){case"Text":return ht.String;case"WholeNumber":return ht.Int;case"Currency":case"Number":return ht.Double;case"Date":return ht.Date;case"Time":return ht.Time;case"DateTime":return ht.DateTime;case"Boolean":return ht.Boolean;default:return ht.InvalidKey}},i.camelRegex=/[A-Z]([a-z]+|[A-Z]*$)/g,i.commentRegex=/\([^\(//)]*\)/g,i.numberRegex=/[0-9]/g,i.specialCharactersRegex=/[ \+\*\?\^\$\\\.\[\]\{\}\(\)\|\/`~!@#%&_\-=:;"',<>]/g,i}(),lt=p(44271),Qn=p(53439),Qt=p(33197);function $i(i,t,n,r,o){var a=(0,lt.YD)(i,n,o),l=(0,lt.YD)(t,r,o);return{fromTable:a.table,toTable:l.table,fromColumn:a.column,toColumn:l.column}}function Xn(i,t,n){return(0,lt.mE)(i,t)||(0,lt.mE)(i,n)}function Vr(i){var t;if(!i)throw new Error("no data queries defined");for(var n=[],r=0,o=i;r<o.length;r++){var a=o[r];if(a.getColumnsCardinalityInfo){var l=n.find(function(s){return s.getColumnsCardinalityInfo});l?(t=l.getColumnsCardinalityInfo.columns).push.apply(t,a.getColumnsCardinalityInfo.columns):n.push({getColumnsCardinalityInfo:{columns:(0,d.__spreadArray)([],a.getColumnsCardinalityInfo.columns,!0)}})}a.validateReferentialIntegrity&&n.push({validateReferentialIntegrity:(0,d.__assign)({},a.validateReferentialIntegrity)})}return n}function Ur(i){return function(i){return!i.containsNulls&&i.distinctRowCount===i.rowCount}(i)?"One":"Many"}var Ja=function(){function i(t){this.directReachableTables=new Map,this.relationships=t,this.buildDirectReachableTables()}return i.prototype.canSetIsActive=function(t,n){if(!this.directReachableTables.has(t))return!0;var a,l,r=new Set,o=[];for(r.add(t),o.push(t);o.length>0;)if(a=o.shift(),this.directReachableTables.has(a)){l=this.directReachableTables.get(a);for(var s=0,c=Array.from(l.values());s<c.length;s++){var u=c[s];if(u===n)return!1;r.has(u)||(r.add(u),o.push(u))}}return!0},i.prototype.buildDirectReachableTables=function(){for(var t=0,n=this.relationships.filter(function(l){return l.isActive});t<n.length;t++){var r=n[t],o=gt.X6.getTableUrn(r.fromTable.name,r.fromTable.schemaName),a=gt.X6.getTableUrn(r.toTable.name,r.toTable.schemaName);this.addDirectRelatedTable(this.directReachableTables,o,a),"BothDirections"===r.crossFilteringBehavior&&this.addDirectRelatedTable(this.directReachableTables,a,o)}},i.prototype.addDirectRelatedTable=function(t,n,r){var o;t.has(n)?o=t.get(n):t.set(n,o=new Set),o.add(r)},i}(),zr=p(47060),un=p(60780),jr=function(){function i(t,n,r,o){var a=this;this.featureSwitchService=t,this.executeDataQueriesRequestCacheService=n,this.localizationService=r,this.dataModelService=o,this.constructCardinalityOneSideValidationTask=function(l,s){return(0,d.__awaiter)(a,void 0,void 0,function(){var c;return(0,d.__generator)(this,function(u){switch(u.label){case 0:if(!l.getColumnsCardinalityInfo)throw new Error("getColumnsCardinalityInfo should be defined in target data query");return[4,(0,lt.ey)(l,s)];case 1:if(!(c=u.sent()).hasOwnProperty("columnsCardinalityInfo"))throw new Error("columnsCardinalityInfo should be defined in target query response");return function(i,t,n){var r,o;if(1!==(null===(r=i?.columns)||void 0===r?void 0:r.length)&&_.isEmpty(i?.columns[0].column))throw new Error("Expect to have one column exist to do column cardinaity one side validation");if(1!==(null===(o=t?.columnsCardinalityInfo)||void 0===o?void 0:o.length))throw new Error("Expect to have one column result exist for column cardinaity one side validation");var l=Qt.G.createObject(i.columns[0].column),s=l.getTopLevelPart().name,c=l.getSecondLevelPart().name;!function(i,t,n,r){if(i.containsNulls)throw new lt._v("CardinalityOneValidationError",r.format("RelationshipUniqueKeyColumnContainsNullInvalid",t,n));if(i.distinctRowCount!==i.rowCount)throw new lt._v("CardinalityOneValidationError",r.format("RelationshipUniqueKeyColumnContainsDuplicateInvalid",t,n))}(t.columnsCardinalityInfo[0],c,s,n)}(l.getColumnsCardinalityInfo,c,this.localizationService),[2]}})})},this.constructRIValidationTask=function(l,s){return(0,d.__awaiter)(a,void 0,void 0,function(){var c;return(0,d.__generator)(this,function(u){switch(u.label){case 0:if(!l.validateReferentialIntegrity)throw new Error("referentialIntegrity should be defined in target data query");return[4,(0,lt.ey)(l,s)];case 1:if(!(c=u.sent()).hasOwnProperty("isValid"))throw new Error("validateReferentialIntegrityResult should be defined in target query response");return function(i,t,n){if(!i?.foreignKeyColumn)throw new Error("Expect foreignKeyColumn defined in validateReferentialIntegrity");if(!i?.primaryKeyColumn)throw new Error("Expect validateReferentialIntegrity defined in validateReferentialIntegrity");if(!t.hasOwnProperty("isValid"))throw new Error("Expect isValid defined in validate referiential integrity result");var o=Qt.G.createObject(i.foreignKeyColumn).getTopLevelPart().name,l=Qt.G.createObject(i.primaryKeyColumn).getTopLevelPart().name;!function(i,t,n,r){if(!i)throw new lt._v("ReferentialIntegrityValidationError",r.format("RelationshipAssumeReferentialIntegrityInvalid",t,n))}(t.isValid,o,l,n)}(l.validateReferentialIntegrity,c,this.localizationService),[2]}})})}}return i.prototype.constructDataValidationTasks=function(t){var n,r=$n(t),o=[],a=this.dataModelService.getDataModel(),l=(n=$i(r.fromTableName,r.toTableName,r.fromColumnName,r.toColumnName,a)).fromTable,s=n.toTable,u=n.toColumn,f=gt.X6.getColumnUrn(l.name,n.fromColumn.name,l.schemaName),v=gt.X6.getColumnUrn(s.name,u.name,s.schemaName),C=this.featureSwitchService.featureSwitches.allowDirectLakeDataValidation,E=[];"One"!==r.fromCardinality||(0,Qe.xs)(l)||Xn(C,l,s)||E.push({getColumnsCardinalityInfo:{columns:[{column:f}]}}),"One"!==r.toCardinality||(0,Qe.xs)(s)||Xn(C,l,s)||E.push({getColumnsCardinalityInfo:{columns:[{column:v}]}}),!r.referentialIntegrity||(0,Qe.xs)(l)||(0,Qe.xs)(s)||Xn(C,l,s)||E.push({validateReferentialIntegrity:{foreignKeyColumn:f,primaryKeyColumn:v}});var fe=new lt._v("ExecuteDataQueriesFailed",this.localizationService.format("RelationshipExecuteDataQueriesFailed"));this.executeDataQueriesRequestCacheService.tryToConstructDataQueriesRequestIfMissInCache(E,fe,Vr);for(var we=0,Ue=E;we<Ue.length;we++){var Je=Ue[we];if(!this.executeDataQueriesRequestCacheService.isDataQueryInCache(Je))throw new Error("data query should be found from cache");var ze=this.executeDataQueriesRequestCacheService.getDataQueryRequest(Je);Je.getColumnsCardinalityInfo&&o.push(this.constructCardinalityOneSideValidationTask(Je,ze)),Je.validateReferentialIntegrity&&o.push(this.constructRIValidationTask(Je,ze))}return o},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Ot.vZ),e.\u0275\u0275inject(un.H),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(Ke.n))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),qa=p(78386),Wr=function(){function i(){this.cache=new Map}return i.prototype.ngOnDestroy=function(){this.cache.clear()},i.prototype.setApplyChangeCache=function(t,n){this.checkModelChangeDefined(t),this.checkApplyChangeRequestDefined(n);var r=this.getCacheKey(t);this.cache.set(r,n)},i.prototype.isApplyChangeInCache=function(t){this.checkModelChangeDefined(t);var n=this.getCacheKey(t);return this.cache.has(n)},i.prototype.getApplyChangeRequest=function(t){if(this.checkModelChangeDefined(t),!this.isApplyChangeInCache(t))throw new qa.h;var n=this.getCacheKey(t);return this.cache.get(n)},i.prototype.removeCache=function(t){this.checkModelChangeDefined(t);var n=this.getCacheKey(t);return this.cache.delete(n)},i.prototype.getCacheKey=function(t){return JSON.stringify(t)},i.prototype.checkModelChangeDefined=function(t){if(!t)throw new Error("model change is not defined")},i.prototype.checkApplyChangeRequestDefined=function(t){if(!t)throw new Error("applyChangeRequest is not defined")},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(n){return new(n||i)}}),i}(),Hr=function(){function i(t,n,r,o,a){this.featureSwitchService=t,this.applyChangeRequestCacheService=n,this.telemetryService=r,this.dataModelService=o,this.modelAuthoring=a}return i.prototype.constructASValidationTask=function(t,n){var r,o=this,a=$n(n),l=[],s=this.dataModelService.getDataModel(),c=(r=$i(a.fromTableName,a.toTableName,a.fromColumnName,a.toColumnName,s)).fromTable,u=r.toTable,f=!1;if("One"===a.fromCardinality&&(0,Qe.xs)(c)&&(f=!0),"One"===a.toCardinality&&(0,Qe.xs)(u)&&(f=!0),!0===a.isActive&&(f=!0),f){var v=Ar(t,n,s,this.featureSwitchService.featureSwitches.relationshipValidation),C=void 0;if(v.length>0){var E={changes:v},z=this.normalizeModelChange(E),ce=!0;this.applyChangeRequestCacheService.isApplyChangeInCache(z)||(ce=!1,this.applyChangeRequestCacheService.setApplyChangeCache(z,this.modelAuthoring.apply(E,!0,!0,!0))),this.telemetryService.logEvent(Va,{isCacheHit:ce,cacheKey:JSON.stringify(E)}),C=new Promise(function(le,fe){return o.applyChangeRequestCacheService.getApplyChangeRequest(z).then(function(we){return le()}).catch(function(we){return fe(we)})}),l.push(C)}}return l},i.prototype.normalizeModelChange=function(t){return{changes:t.changes.map(function(r){return r.relationshipCreate?{relationshipCreate:(0,d.__assign)((0,d.__assign)({},r.relationshipCreate),{name:"guid",securityFilteringBehavior:"None"})}:r.relationshipUpdateProperties?{relationshipUpdateProperties:(0,d.__assign)((0,d.__assign)({},r.relationshipUpdateProperties),{securityFilteringBehavior:"None"})}:r})}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Ot.vZ),e.\u0275\u0275inject(Wr),e.\u0275\u0275inject(Mt.y0),e.\u0275\u0275inject(Ke.n),e.\u0275\u0275inject(Qn.S))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Qi=function(){function i(t,n,r,o,a,l,s,c){this.dataModelService=t,this.modelAuthoring=n,this.featureSwitchService=r,this.localizationService=o,this.relationshipDataValidationTasks=a,this.executeDataQueriesRequestCacheService=l,this.applyChangeASRelationshipValidationService=s,this.modelService=c}return i.prototype.validateUpdatedRelationship=function(t,n,r){void 0===r&&(r=!1);var o=[];return r&&o.push.apply(o,this.applyChangeASRelationshipValidationService.constructASValidationTask(t,n)),o.push.apply(o,this.relationshipDataValidationTasks.constructDataValidationTasks(n)),{validationResult:Promise.all((0,d.__spreadArray)([],o,!0))}},i.prototype.commitChanges=function(t,n,r){return void 0===r&&(r=!0),(0,d.__awaiter)(this,void 0,void 0,function(){var o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return(o=Ar(t,n,this.dataModelService.getDataModel(),this.featureSwitchService.featureSwitches.relationshipValidation)).length>0?[4,this.modelAuthoring.apply({changes:o},!r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},i.prototype.constructCandidateRelationship=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a,l,s,c,u,f,v,C,z,ce,le,fe,we,Ue;return(0,d.__generator)(this,function(Je){switch(Je.label){case 0:return r=Qt.G.createObject(t),o=Qt.G.createObject(n),a=r.getTopLevelPart().name,l=r.getSecondLevelPart().name,s=o.getTopLevelPart().name,c=o.getSecondLevelPart().name,u=gt.X6.getTableUrn(a,r.getSchemaName()),f=gt.X6.getTableUrn(s,o.getSchemaName()),Ue=$i(a,s,l,c,this.dataModelService.getDataModel()),v=Ue.fromTable,C=Ue.toTable,this.verifyRelationshipNotExist(a,s,l,c),Xn(this.featureSwitchService.featureSwitches.allowDirectLakeDataValidation,v,C)?(z="Many",ce="One",[3,3]):[3,1];case 1:return[4,this.getFromToColumnsCardinalityInfo(t,n)];case 2:le=Je.sent(),z=Ur(le.fromColumn),ce=Ur(le.toColumn),Je.label=3;case 3:return fe=function(i,t){return"One"===i&&"One"===t?"BothDirections":"One"===i&&"Many"===t||"Many"===i&&"One"===t?"OneDirection":"Many"===i&&"Many"===t?"BothDirections":void 0}(z,ce),we="One"===z&&"Many"===ce?this.canSetIsActive(f,u,"BothDirections"===fe):this.canSetIsActive(u,f,"BothDirections"===fe),[2,{fromTableName:a,fromColumnName:l,toTableName:s,toColumnName:c,isActive:we,fromCardinality:z,toCardinality:ce,crossFilteringBehavior:fe,securityFilteringBehavior:this.canParticipateInRlsFiltering(a,s)?"OneDirection":"None",referentialIntegrity:!1}]}})})},i.prototype.canSetIsActive=function(t,n,r){void 0===r&&(r=!1);var o=new Ja(this.dataModelService.getDataModel().relationships),a=o.canSetIsActive(t,n);return r?a&&o.canSetIsActive(n,t):a},i.prototype.getFromToColumnsCardinalityInfo=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a,l,s,c,u,f;return(0,d.__generator)(this,function(v){switch(v.label){case 0:r=[{getColumnsCardinalityInfo:{columns:[{column:t}]}},{getColumnsCardinalityInfo:{columns:[{column:n}]}}],o=new lt._v("ExecuteDataQueriesFailed",this.localizationService.format("RelationshipExecuteDataQueriesFailed")),this.executeDataQueriesRequestCacheService.tryToConstructDataQueriesRequestIfMissInCache(r,o,Vr),a=[],l=0,s=r,v.label=1;case 1:if(!(l<s.length))return[3,4];if(!this.executeDataQueriesRequestCacheService.isDataQueryInCache(c=s[l]))throw new Error("data query should be found from cache");return[4,this.executeDataQueriesRequestCacheService.getDataQueryRequest(c)];case 2:if(u=v.sent(),!(f=(0,zr.Tk)(c,u)).hasOwnProperty("columnsCardinalityInfo")||1!==f.columnsCardinalityInfo.length)throw new Error("expect to get column cardinality info for column cardinality info result");a.push(f.columnsCardinalityInfo[0]),v.label=3;case 3:return l++,[3,1];case 4:return[2,{fromColumn:a[0],toColumn:a[1]}]}})})},i.prototype.verifyRelationshipNotExist=function(t,n,r,o){!function(i,t,n,r,o,a){for(var s=0,c=o.relationships;s<c.length;s++){var u=c[s];if(u.fromTable.name===i&&u.toTable.name===n&&u.fromColumn.name===t&&u.toColumn.name===r)throw new lt._v("RelationshipAlreadyExistedError",a.get("RelationshipAlreadyExistsError"));if(u.fromTable.name===n&&u.toTable.name===i&&u.fromColumn.name===r&&u.toColumn.name===t)throw new lt._v("RelationshipAlreadyExistedError",a.get("RelationshipAlreadyExistsError"))}}(t,r,n,o,this.dataModelService.getDataModel(),this.localizationService)},i.prototype.canParticipateInRlsFiltering=function(t,n){var r=this.modelService.model.findTable(t),o=this.modelService.model.findTable(n);return!!r?.canParticipateInRlsFilteringAcrossRelationships&&!!o?.canParticipateInRlsFilteringAcrossRelationships},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Ke.n),e.\u0275\u0275inject(Qn.S),e.\u0275\u0275inject(Ot.vZ),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(jr),e.\u0275\u0275inject(un.H),e.\u0275\u0275inject(Hr),e.\u0275\u0275inject(Oe.b))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),on=function(){function i(t,n,r){this.modelService=t,this.localizationService=n,this.featureSwitchService=r}return i.prototype.canSupportReferentialIntegrity=function(t,n,r){return t!==V.KA.ManyToMany&&this.supportsReferentialIntegrity(n,r)},i.prototype.canSupportSecurityFilteringBehavior=function(t,n,r){if(!this.modelService.model.supportSecurityFilteringBehavior)return!1;var a=r===V.KA.OneToOne,l=this.modelService.model.findTable(t),s=this.modelService.model.findTable(n);return!a&&!!l?.canSetSecurityFiltering&&!!s?.canSetSecurityFiltering},i.prototype.canEnableSecurityFilteringBehavior=function(t,n,r){return t&&n===V.jE.BothDirections&&r},i.prototype.canSupportManyToMany=function(){return this.modelService.model.supportManyToManyRelationships},i.prototype.getCardinalityOptions=function(){var t=[{value:V.KA.ManyToOne,displayValue:this.localizationService.get("Many_To_One")},{value:V.KA.OneToOne,displayValue:this.localizationService.get("One_To_One")},{value:V.KA.OneToMany,displayValue:this.localizationService.get("One_To_Many")}];return this.canSupportManyToMany()&&t.push({value:V.KA.ManyToMany,displayValue:this.localizationService.get("Many_To_Many")}),t},i.prototype.getCrossFilterOptions=function(t,n,r){var o=[{value:V.jE.OneDirection,displayValue:this.localizationService.get("Single")},{value:V.jE.BothDirections,displayValue:this.localizationService.get("Visual_LabelStyle_Both")}];return t===V.KA.OneToOne?o.filter(function(a){return a.value===V.jE.BothDirections}):t===V.KA.ManyToMany&&this.featureSwitchService.featureSwitches.relationshipValidation?(0,d.__spreadArray)([{value:V.jE.OneDirection,displayValue:this.localizationService.format("SingleFilterDirection",r,n)},{value:V.jE.OneDirectionReversed,displayValue:this.localizationService.format("SingleFilterDirection",n,r)}],o.filter(function(a){return a.value===V.jE.BothDirections}),!0):o},i.prototype.getAllTableOptions=function(){var t=this;return _.map(_.filter(this.getCommittedTables(),function(n){return!n.isCalculationGroup&&t.hasValidColumns(n.columns.nonSystemColumns)}),function(n){return n.name})},i.prototype.hasValidColumns=function(t){var n=this;return t.filter(function(r){return n.isPossibleKey(r)}).length>0},i.prototype.isPossibleKey=function(t){switch(t.dataType){case"Text":case"WholeNumber":case"Number":case"DateTime":case"Date":case"Time":case"Boolean":return!0;default:return!1}},i.prototype.getCommittedTables=function(){var t=this;return _.filter(this.modelService.model.tables.getItems(),function(n){return t.isCommittedTable(n)})},i.prototype.isCommittedTable=function(t){return(!this.isCalculatedTable(t)||!this.isNew(t))&&this.isUserTable(t)},i.prototype.isCalculatedTable=function(t){return 1===_.size(t.partitions.getItems())&&!!_.find(t.partitions.getItems(),function(n){return n.sourceType===V.Pv.Calculated})},i.prototype.isNew=function(t){return!!_.find(t.annotations.getItems(),function(n){return n.name===Qe.j0})},i.prototype.isUserTable=function(t){return!t.isPrivate&&!t.showAsVariationOnly},i.prototype.getRelationshipTableOptions=function(t){var n=this,r=this.getAvailableTables().filter(function(a){return n.hasValidColumns(a.columns.nonSystemColumns)});if(!t)return r.map(function(a){return a.name});var o=this.modelService.model.findTable(t);return r.filter(function(a){return a.name!==t&&(0,$t.ic)(o,a)}).map(function(a){return a.name})},i.prototype.getTableOptions=function(t,n){var o,a,r=this,l=this.getAvailableTables(),s=this.modelService.model.findTable(t),c=this.modelService.model.findTable(n),u=this.areTablesInSameIsland(s,c);s&&c&&c?.isProxyModelSource&&!u&&(l=_.filter(l,function(v){return v.island.id!==c.island.id}));var f=null===(a=null===(o=c?.partitions)||void 0===o?void 0:o.get(0))||void 0===a?void 0:a.source;return f&&(l=_.filter(l,function(v){var C,E;return(null===(E=null===(C=v.partitions)||void 0===C?void 0:C.get(0))||void 0===E?void 0:E.source)!==f})),l=_.filter(l,function(v){return r.hasValidColumns(v.columns.nonSystemColumns)}),_.filter(_.map(l,function(v){return v.name}),function(v){return v!==n})},i.prototype.getColumnOptions=function(t){var r,n=this;return _.map(_.filter(null===(r=this.modelService.model.tables.findByName(t))||void 0===r?void 0:r.columns.nonSystemColumns,function(o){return n.isPossibleKey(o)}),function(o){return o.name})},i.prototype.canSupportRLS=function(t,n){var r=this.modelService.model.findTable(t),o=this.modelService.model.findTable(n);return!!r?.canParticipateInRlsFilteringAcrossRelationships&&!!o?.canParticipateInRlsFilteringAcrossRelationships},i.prototype.getAvailableTables=function(){return _.filter(this.getCommittedTables(),function(t){return!t.isCalculationGroup})},i.prototype.supportsReferentialIntegrity=function(t,n){var r=!1,o=this.modelService.model.findTable(t),a=this.modelService.model.findTable(n),l=[o,a].every(function(c){return c&&null!==c.partitions&&!c.isImported}),s=this.areTablesInSameIsland(o,a);return l&&s&&(r=!0),r},i.prototype.areTablesInSameIsland=function(t,n){var r,o;return(null===(r=t?.island)||void 0===r?void 0:r.id)===(null===(o=n?.island)||void 0===o?void 0:o.id)},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Oe.b),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(Ot.vZ))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Xi=function(i){function t(n,r,o,a,l,s,c){var u=i.call(this,{fromColumnName:void 0,toColumnName:void 0,toTableName:void 0,fromTableName:void 0,isActive:void 0,cardinality:void 0,crossFilteringBehavior:void 0,referentialIntegrity:void 0,securityFilteringBehavior:void 0,warningMessage:void 0,warningLink:void 0,hasCommitedChangeInProgress:void 0,hasValidationInProgress:void 0,validationText:void 0,isValidationSucceed:void 0,warningMessageType:void 0})||this;return u.localizationService=n,u.relationshipEditService=r,u.modelService=o,u.featureSwitchService=a,u.telemetryService=l,u.relPropertyDataFactory=s,u.templateDialogPayload=c,u.fromTable$=u.select(function(f){return f.fromTableName}),u.toTable$=u.select(function(f){return f.toTableName}),u.fromColumn$=u.select(function(f){return f.fromColumnName}),u.toColumn$=u.select(function(f){return f.toColumnName}),u.cardinality$=u.select(function(f){return f.cardinality}),u.crossFilterBehavior$=u.select(function(f){return f.crossFilteringBehavior}),u.isActive$=u.select(function(f){return f.isActive}),u.securityFilteringBehavior$=u.select(function(f){return f.securityFilteringBehavior}),u.referentialIntegrity$=u.select(function(f){return f.referentialIntegrity}),u.warningMessage$=u.select(function(f){return f.warningMessage}),u.warningLink$=u.select(function(f){return f.warningLink}),u.hasCommitedChangeInProgress$=u.select(function(f){return f.hasCommitedChangeInProgress}),u.hasValidationInProgress$=u.select(function(f){return f.hasValidationInProgress}),u.validationText$=u.select(function(f){return f.validationText}),u.isValidationSucceed$=u.select(function(f){return f.isValidationSucceed}),u.warningMessageType$=u.select(function(f){return f.warningMessageType}),u.fromToTable$=u.select(function(f){return{fromTableName:f.fromTableName,toTableName:f.toTableName}}),u.relationshipAdvancedPropertiesUpdate$=u.select(u.cardinality$,u.crossFilterBehavior$,u.isActive$,u.securityFilteringBehavior$,u.referentialIntegrity$,function(f,v,C,E,z){return{cardinality:f,crossFilteringBehavior:v,isActive:C,securityFilteringBehavior:E,referentialIntegrity:z}},{debounce:!0}),u.relationshipProperties$=u.select(u.fromTable$,u.fromColumn$,u.toTable$,u.toColumn$,u.relationshipAdvancedPropertiesUpdate$,function(f,v,C,E,z){return(0,d.__assign)({fromTableName:f,fromColumnName:v,toTableName:C,toColumnName:E},z)},{debounce:!0}),u.fromToColumnProperties$=u.select(u.fromTable$,u.fromColumn$,u.toTable$,u.toColumn$,function(f,v,C,E){return{fromTableName:f,fromColumnName:v,toTableName:C,toColumnName:E}},{debounce:!0}),u.fromToColumnCardinalityProperties$=u.select(u.fromTable$,u.fromColumn$,u.toTable$,u.toColumn$,u.cardinality$,function(f,v,C,E,z){return{fromTableName:f,fromColumnName:v,toTableName:C,toColumnName:E,cardinality:z}},{debounce:!0}),u.updateWarningMessageFromRelPropertiesChange(),u.setDefaultCrossFilterBehaviorWhenUndefined(),u.resetSecurityBehaviorBothBasedOnIsActiveCrossFilterBehavior(),u.constructCandidateRelWhenFromToColsDefinedButCaridnalityIsNotDefined(),u.getRelationshipProbabilitiesWhenFromToTableButFromOrToColNotDefined(),u}return(0,d.__extends)(t,i),t.prototype.updateWarningMessageFromRelPropertiesChange=function(){var n=this;this.relationshipProperties$.pipe((0,qe.R)(this.destroy$)).subscribe(function(r){r.cardinality===V.KA.ManyToMany?n.tryUpdateManyManyWarningMessage(r):n.enableNewManageRelationshipDialog?n.unsetManyManyWarningMessage():n.updateWarningMessage(void 0,void 0)})},t.prototype.setDefaultCrossFilterBehaviorWhenUndefined=function(){var n=this;this.relationshipProperties$.pipe((0,qe.R)(this.destroy$),(0,st.h)(function(r){return typeof r.cardinality<"u"&&typeof r.crossFilteringBehavior>"u"})).subscribe(function(r){switch(r.cardinality){case V.KA.OneToOne:case V.KA.ManyToMany:n.updateCrossFilterDirection(V.jE.BothDirections);break;case V.KA.OneToMany:case V.KA.ManyToOne:n.updateCrossFilterDirection(V.jE.OneDirection)}})},t.prototype.resetSecurityBehaviorBothBasedOnIsActiveCrossFilterBehavior=function(){var n=this;this.relationshipProperties$.pipe((0,qe.R)(this.destroy$),(0,st.h)(function(r){return r.securityFilteringBehavior===V.Lv.BothDirections})).subscribe(function(r){(!r.isActive||r.crossFilteringBehavior!==V.jE.BothDirections)&&n.updateSecurityFilteringBehavior(V.Lv.OneDirection)})},t.prototype.constructCandidateRelWhenFromToColsDefinedButCaridnalityIsNotDefined=function(){var n=this;this.fromToColumnCardinalityProperties$.pipe((0,qe.R)(this.destroy$),(0,st.h)(function(r){return!!r.fromColumnName&&!!r.toColumnName&&!!r.fromTableName&&!!r.toTableName&&typeof r.cardinality>"u"}),(0,st.h)(function(r){return n.featureSwitchService.featureSwitches.relationshipValidation})).subscribe(function(r){n.constructCandidateRelationship(r)})},t.prototype.getRelationshipProbabilitiesWhenFromToTableButFromOrToColNotDefined=function(){var n=this;this.fromToColumnProperties$.pipe((0,qe.R)(this.destroy$),(0,st.h)(function(r){return!(!r.fromTableName||!r.toTableName||r.fromColumnName&&r.toColumnName)})).subscribe(function(r){var o,a,l=n.modelService.getTable(r.fromTableName),s=n.modelService.getTable(r.toTableName),c=n.relPropertyDataFactory.getColumnOptions(l.name),u=null===(o=l?.columns)||void 0===o?void 0:o.filter(function(E){return c.includes(E.name)}),f=n.relPropertyDataFactory.getColumnOptions(s.name),v=null===(a=s?.columns)||void 0===a?void 0:a.filter(function(E){return f.includes(E.name)}),C=Ha.getRelationshipProbabilityMatrix(u,v);n.updateColumnRelationshipProbabilities(r.fromTableName,r.toTableName,r.fromColumnName,r.toColumnName,C)})},t.prototype.ngOnDestroy=function(){var n,r;null===(n=this.validateUpdatedRelationshipSub)||void 0===n||n.unsubscribe(),null===(r=this.constructCandidateRelSub)||void 0===r||r.unsubscribe(),i.prototype.ngOnDestroy.call(this)},t.prototype.validateRelationship=function(n){var r=this;void 0===n&&(n=!1),this.validateUpdatedRelationshipSub=this.relationshipProperties$.pipe((0,Ni.b)(300),(0,nt.q)(1),(0,Or.b)(function(o){var a,l;r.updateIsValidationSucceed(!1),r.updateHasValidationInProgress(!0,r.localizationService.get("Validating_Text")),r.unsetNonInfoWarningMessage(),r.validateUpdatedRelatioshipTelemetryEvent=r.telemetryService.startEvent(Na,{fromTableMode:null===(a=(0,$t.AG)(r.modelService.model,o.fromTableName))||void 0===a?void 0:a.storageMode,toTableMode:null===(l=(0,$t.AG)(r.modelService.model,o.toTableName))||void 0===l?void 0:l.storageMode,location:"Dialog"}),r.validateUpdatedRelatioshipTelemetryEvent.event.info.startValidateUpdatedRelationship=(0,Kt.z)()}),(0,Hn.b)(function(o){return r.validateUpdatedRelationship(o,r.validateUpdatedRelatioshipTelemetryEvent,n)})).subscribe(function(o){r.unsetNonInfoWarningMessage(),r.updateIsValidationSucceed(!0),r.updateHasValidationInProgress(!1,void 0),r.validateUpdatedRelatioshipTelemetryEvent.event.info.endValidateUpdatedRelationship=(0,Kt.z)(),r.validateUpdatedRelatioshipTelemetryEvent.resolve()},function(o){r.updateIsValidationSucceed(!1);var a=Yi(o),l=Gr(a),s=Gn.r.getErrorMessageFromApiObject(o);r.updateWarningMessage(s,a,l),r.validateUpdatedRelatioshipTelemetryEvent.event.info.endValidateUpdatedRelationship=(0,Kt.z)(),r.validateUpdatedRelatioshipTelemetryEvent.event.info.hasValidationError=!0,r.validateUpdatedRelatioshipTelemetryEvent.reject((0,Er.GB)(o)),r.updateHasValidationInProgress(!1,void 0)})},t.prototype.setRelationshipState=function(n){this.setState(function(r){return(0,d.__assign)((0,d.__assign)({},r),n)})},t.prototype.updateFromTable=function(n){var r=this;this.fromTable$.pipe((0,nt.q)(1),(0,st.h)(function(o){return o!==n})).subscribe(function(o){r.cancelValidateConstructRelTasks(),r.patchState({fromTableName:n}),r.patchState({fromColumnName:void 0}),r.resetRelationshipAdvancedPropertiesUndefined()})},t.prototype.updateToTable=function(n){var r=this;this.toTable$.pipe((0,nt.q)(1),(0,st.h)(function(o){return o!==n})).subscribe(function(o){r.cancelValidateConstructRelTasks(),r.patchState({toTableName:n}),r.patchState({toColumnName:void 0}),r.resetRelationshipAdvancedPropertiesUndefined()})},t.prototype.updateFromColumnName=function(n){var r=this;this.fromColumn$.pipe((0,qe.R)(this.destroy$),(0,Ni.b)(0),(0,nt.q)(1),(0,st.h)(function(o){return o!==n})).subscribe(function(o){r.cancelValidateConstructRelTasks(),r.patchState({fromColumnName:n}),r.resetRelationshipAdvancedPropertiesUndefined()})},t.prototype.updateToColumnName=function(n){var r=this;this.toColumn$.pipe((0,qe.R)(this.destroy$),(0,Ni.b)(0),(0,nt.q)(1),(0,st.h)(function(o){return o!==n})).subscribe(function(o){r.cancelValidateConstructRelTasks(),r.patchState({toColumnName:n}),r.resetRelationshipAdvancedPropertiesUndefined()})},t.prototype.updateCardinality=function(n){this.cancelValidateConstructRelTasks(),this.patchState({cardinality:n}),n===V.KA.OneToOne&&this.updateCrossFilterDirection(V.jE.BothDirections),this.enableNewManageRelationshipDialog&&this.validateRelationship(!0)},t.prototype.updateCrossFilterDirection=function(n){this.patchState({crossFilteringBehavior:n})},t.prototype.updateIsActive=function(n){this.cancelValidateConstructRelTasks(),this.patchState({isActive:n}),this.enableNewManageRelationshipDialog&&this.validateRelationship(!0)},t.prototype.unsetManyManyWarningMessage=function(){var n=this;this.warningMessageType$.pipe((0,nt.q)(1),(0,st.h)(function(r){return"ManyToManyInfo"===r})).subscribe(function(r){return n.updateWarningMessage(void 0,void 0)})},t.prototype.unsetNonInfoWarningMessage=function(){var n=this;this.warningMessageType$.pipe((0,nt.q)(1),(0,st.h)(function(r){return"ManyToManyInfo"!==r})).subscribe(function(r){return n.updateWarningMessage(void 0,void 0)})},t.prototype.tryUpdateManyManyWarningMessage=function(n){var r=this;this.warningMessageType$.pipe((0,nt.q)(1),(0,st.h)(function(o){return"RelationshipAlreadyExistedError"!==o})).subscribe(function(o){return r.updateWarningMessage(r.localizationService.format("relationshipAdvancedCardinalityManyToManyWarning",n.fromColumnName,n.toColumnName),"ManyToManyInfo","https://go.microsoft.com/fwlink/?linkid=2011502")})},t.prototype.updateReferentialIntegrity=function(n){this.cancelValidateConstructRelTasks(),this.patchState({referentialIntegrity:n}),this.enableNewManageRelationshipDialog&&this.validateRelationship(!0)},t.prototype.updateSecurityFilteringBehavior=function(n){this.patchState({securityFilteringBehavior:n})},t.prototype.updateWarningMessage=function(n,r,o){void 0===o&&(o=void 0),this.patchState({warningMessage:n,warningMessageType:r,warningLink:o})},t.prototype.updateHasCommitedChangeInProgress=function(n,r){this.patchState({hasCommitedChangeInProgress:n,validationText:r})},t.prototype.cancelConstructRelTask=function(){this.constructCandidateRelSub&&this.constructCandidateRelSub.unsubscribe(),this.constructCandidateRelationshipTelemetryEvent&&(this.constructCandidateRelationshipTelemetryEvent.event.info.isConstructRelationshipCanceled=!0,this.constructCandidateRelationshipTelemetryEvent.event.info.endConstructCandidateRelationship=(0,Kt.z)(),this.constructCandidateRelationshipTelemetryEvent.resolve()),this.updateHasValidationInProgress(!1,void 0)},t.prototype.cancelValidateRelTask=function(){this.validateUpdatedRelationshipSub&&this.validateUpdatedRelationshipSub.unsubscribe(),this.validateUpdatedRelatioshipTelemetryEvent&&(this.validateUpdatedRelatioshipTelemetryEvent.event.info.isValidateUpdatedRelationshipCanceled=!0,this.validateUpdatedRelatioshipTelemetryEvent.event.info.endValidateUpdatedRelationship=(0,Kt.z)(),this.validateUpdatedRelatioshipTelemetryEvent.resolve()),this.updateHasValidationInProgress(!1,void 0)},t.prototype.updateHasValidationInProgress=function(n,r){this.patchState({hasValidationInProgress:n,validationText:r})},t.prototype.cancelValidateConstructRelTasks=function(){this.cancelConstructRelTask(),this.cancelValidateRelTask()},Object.defineProperty(t.prototype,"enableNewManageRelationshipDialog",{get:function(){return this.featureSwitchService.featureSwitches.newManageRelationshipDialog&&this.modelService.model&&this.modelService.model.supportManageRelationships},enumerable:!1,configurable:!0}),t.prototype.updateIsValidationSucceed=function(n){this.patchState({isValidationSucceed:n})},t.prototype.resetRelationshipAdvancedPropertiesUndefined=function(){this.patchState({cardinality:void 0,crossFilteringBehavior:void 0,isActive:void 0,referentialIntegrity:void 0,securityFilteringBehavior:void 0})},t.prototype.constructCandidateRelationship=function(n){var o,a,r=this;this.constructCandidateRelationshipTelemetryEvent=this.telemetryService.startEvent(Ba,{fromTableMode:null===(o=(0,$t.AG)(this.modelService.model,n.fromTableName))||void 0===o?void 0:o.storageMode,toTableMode:null===(a=(0,$t.AG)(this.modelService.model,n.toTableName))||void 0===a?void 0:a.storageMode});var l=this.constructCandidateRelationshipTelemetryEvent.event.info;l.entryPoint="Dialog",l.startConstructCandidateRelationship=(0,Kt.z)();var s=gt.X6.getColumnUrn(n.fromTableName,n.fromColumnName,(0,$t.Kp)(this.modelService.model,n.fromTableName)),c=gt.X6.getColumnUrn(n.toTableName,n.toColumnName,(0,$t.Kp)(this.modelService.model,n.toTableName));if(this.updateHasValidationInProgress(!0,this.localizationService.get("RelationshipCardinalityValidationInProgress")),this.updateWarningMessage(void 0,void 0),this.equalsToEditRelationshipInitialProperties(n)){l.equalsToEditRelationshipInitialProperties=!0,l.endConstructCandidateRelationship=(0,Kt.z)(),this.constructCandidateRelationshipTelemetryEvent.resolve();var u=this.templateDialogPayload.input;this.setCandidateRelationship({fromColumnName:u.fromColumn,toColumnName:u.toColumn,toTableName:u.toTable,fromTableName:u.fromTable,isActive:u.isActive,cardinality:Ui(u.fromCardinality,u.toCardinality),crossFilteringBehavior:Vi(u.crossFilterDirection),referentialIntegrity:u.referentialIntegrity,securityFilteringBehavior:zi(u.securityFilteringBehavior)})}else this.constructCandidateRelSub=(0,yn.D)(this.relationshipEditService.constructCandidateRelationship(s,c)).pipe((0,Me.U)(function(f){return{fromColumnName:f.fromColumnName,toColumnName:f.toColumnName,toTableName:f.toTableName,fromTableName:f.fromTableName,isActive:f.isActive,cardinality:Ui(f.fromCardinality,f.toCardinality),crossFilteringBehavior:Vi(f.crossFilteringBehavior),referentialIntegrity:f.referentialIntegrity,securityFilteringBehavior:zi(f.securityFilteringBehavior)}})).subscribe(function(f){l.endConstructCandidateRelationship=(0,Kt.z)(),r.constructCandidateRelationshipTelemetryEvent.resolve(),r.setCandidateRelationship(f)},function(f){l.endConstructCandidateRelationship=(0,Kt.z)(),l.hasValidationError=!0,r.updateHasValidationInProgress(!1,void 0);var v=Gn.r.getErrorMessageFromApiObject(f),C=Yi(f),E=Gr(C);if("RelationshipAlreadyExistedError"===C){var z=r.findRelationship(n);if(!z)throw new Error("should find existed relationship from modelService");r.setRelationshipState({fromColumnName:z.fromColumn.name,toColumnName:z.toColumn.name,toTableName:z.toColumn.table.name,fromTableName:z.fromColumn.table.name,isActive:z.isActive,cardinality:z.cardinality,crossFilteringBehavior:z.crossFilteringBehavior,referentialIntegrity:z.relyOnReferentialIntegrity,securityFilteringBehavior:z.securityFilteringBehavior})}r.updateWarningMessage(v,C,E),r.constructCandidateRelationshipTelemetryEvent.reject((0,Er.GB)(f))})},t.prototype.setCandidateRelationship=function(n){this.updateHasValidationInProgress(!1,void 0),this.setRelationshipState(n)},t.prototype.equalsToEditRelationshipInitialProperties=function(n){return null!==this.templateDialogPayload.input.relationshipName&&this.templateDialogPayload.input.fromTable===n.fromTableName&&this.templateDialogPayload.input.fromColumn===n.fromColumnName&&this.templateDialogPayload.input.toTable===n.toTableName&&this.templateDialogPayload.input.toColumn===n.toColumnName},t.prototype.validateUpdatedRelationship=function(n,r,o){void 0===o&&(o=!1);var a=n;n.crossFilteringBehavior===V.jE.OneDirectionReversed&&n.cardinality===V.KA.ManyToMany&&(a=(0,d.__assign)((0,d.__assign)({},n),ji(n)));var l=Gi(a.crossFilteringBehavior),s=!!a.isActive,c={fromColumnName:a.fromColumnName,fromTableName:a.fromTableName,toColumnName:a.toColumnName,toTableName:a.toTableName,isActive:s,fromCardinality:Wi(a.cardinality),toCardinality:Hi(a.cardinality),securityFilteringBehavior:Ki(this.relPropertyDataFactory.canSupportRLS(a.fromTableName,a.toTableName),a.securityFilteringBehavior,l,s),referentialIntegrity:!!a.referentialIntegrity,crossFilteringBehavior:l};return r.event.info.properties=JSON.stringify(c),this.relationshipEditService.validateUpdatedRelationship(this.templateDialogPayload.input.relationshipName,c,o).validationResult},t.prototype.updateColumnRelationshipProbabilities=function(n,r,o,a,l){if(l){var s=0,c=0,u=0,f=this.relPropertyDataFactory.getColumnOptions(n),v=this.relPropertyDataFactory.getColumnOptions(r);if(o&&!a){if(-1===(c=f.findIndex(function(ce){return ce===o})))throw new Error("column not found in fromTable");for(var C=0;C<v.length;C++)(E=l[c][C])>s&&(s=E,u=C)}if(a&&!o){if(u=v.findIndex(function(ce){return ce===a}),-1===c)throw new Error("column not found in toTable");for(C=0;C<f.length;C++)(E=l[C][u])>s&&(s=E,c=C)}if(!a&&!o)for(C=0;C<f.length;C++)for(var z=0;z<v.length;z++){var E;(E=l[C][z])>s&&(s=E,c=C,u=z)}s>.5&&(o||this.updateFromColumnName(f[c]),a||this.updateToColumnName(v[u]))}},t.prototype.findRelationship=function(n){var r=this;return Object.keys(this.modelService.model.relationships).map(function(a){return r.modelService.model.relationships[a]}).find(function(a){return a.fromColumn.name===n.fromColumnName&&a.fromColumn.table.name===n.fromTableName&&a.toColumn.name===n.toColumnName&&a.toColumn.table.name===n.toTableName||a.fromColumn.table.name===n.toTableName&&a.fromColumn.name===n.toColumnName&&a.toColumn.table.name===n.fromTableName&&a.toColumn.name===n.fromColumnName})},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(Qi),e.\u0275\u0275inject(Oe.b),e.\u0275\u0275inject(Ot.vZ),e.\u0275\u0275inject(Mt.y0),e.\u0275\u0275inject(on),e.\u0275\u0275inject(at.x))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(Li.m1);function Yi(i){var t="Unknown";if(i instanceof lt._v)switch(i.code){case"ExecuteDataQueriesFailed":t="ExecuteDataQueriesFailed";break;case"CardinalityOneValidationError":t="CardinalityOneValidationError";break;case"ReferentialIntegrityValidationError":t="ReferentialIntegrityValidationError";break;case"RelationshipAlreadyExistedError":t="RelationshipAlreadyExistedError"}else if("ASOperationExceptionError"===i.code){var n=Gn.r.getDetailValueFromApiObject(i,"ModelingServiceError_AdditionalErrorCode");"PFE_XL_USERELATIONSHIP_AMBIGUOUS_PATH"===n?t="PFE_XL_USERELATIONSHIP_AMBIGUOUS_PATH":"PFE_XM_COLUMN_UNIQUE_CONSTRAINT"===n&&(t="CardinalityOneValidationError")}return t}function Gr(i){if("ReferentialIntegrityValidationError"===i)return"https://go.microsoft.com/fwlink/?LinkId=746269"}var Kr=function(){function i(t,n,r,o,a){this.modelService=t,this.executeDataQueriesRequestCacheService=n,this.localizationService=r,this.featureSwitchService=o,this.dataModelService=a}return i.prototype.getTableData=function(t,n,r,o){return(0,d.__awaiter)(this,void 0,void 0,function(){var a,l,s,c,u,f,v,C,E,z,ce;return(0,d.__generator)(this,function(le){switch(le.label){case 0:if(a=this.featureSwitchService.featureSwitches.allowDirectLakeDataValidation,l=[],!_.isEmpty(t)&&!_.isEmpty(n)&&!(0,lt.mE)(a,(0,Qe.AG)(this.dataModelService.getDataModel(),t))&&l.push({table:t,tableColumnOptions:n,dataQuery:this.getTableDataRequest(t,n)}),!_.isEmpty(r)&&!_.isEmpty(o)&&!(0,lt.mE)(a,(0,Qe.AG)(this.dataModelService.getDataModel(),r))&&l.push({table:r,tableColumnOptions:o,dataQuery:this.getTableDataRequest(r,o)}),_.isEmpty(l))return[2,void 0];s=new lt._v("ExecuteDataQueriesFailed",this.localizationService.format("RelationshipExecuteDataQueriesFailed")),c=l.map(function(fe){return fe.dataQuery}),this.executeDataQueriesRequestCacheService.tryToConstructDataQueriesRequestIfMissInCache(c,s),u=[],f=0,v=l,le.label=1;case 1:if(!(f<v.length))return[3,4];if(!this.executeDataQueriesRequestCacheService.isDataQueryInCache((C=v[f]).dataQuery))throw(E=new Error("data query should be found from cache")).name=C.table,E;return[4,this.executeDataQueriesRequestCacheService.getDataQueryRequest(C.dataQuery)];case 2:z=le.sent(),ce=(0,zr.Tk)(C.dataQuery,z),u.push({table:C.table,rows:this.formatTableData(C.table,C.tableColumnOptions,ce.rows)}),le.label=3;case 3:return f++,[3,1];case 4:return[2,u]}})})},i.prototype.formatTableData=function(t,n,r){var o,a,l,s=[],c=[],u=[];if(_.isEmpty(r))return[];for(var f=0,v=n;f<v.length;f++){var C=v[f],E=this.modelService.model.tables.findByName(t).columns.findByName(C);if(null!==(o=E.formatInformation)&&void 0!==o&&o.formatString){if(c.push(E.formatInformation.formatString),"DateTime"!==E.dataType&&"Date"!==E.dataType&&"Time"!==E.dataType&&"Currency"!==E.dataType&&"Number"!==E.dataType&&"WholeNumber"!==E.dataType&&"Boolean"!==E.dataType)throw new Error("unexpected data type format information combination");u.push(E.dataType)}else c.push(null),u.push(null)}for(var z=0,ce=r;z<ce.length;z++){var le=ce[z],fe=[];if(null==le)for(var we=0,Ue=n;we<Ue.length;we++)fe.push({value:""});else for(var ze=0;ze<n.length;ze++)if(null!=c[ze]&&"null"!==le.cells[ze].value)if("DateTime"===u[ze]||"Date"===u[ze]||"Time"===u[ze]){var yi=new Date(le.cells[ze].value);"Invalid Date"===yi.toString()?fe.push({value:le.cells[ze].value}):fe.push({value:null!==(a=Y.dx.formatValue(yi,c[ze]))&&void 0!==a?a:le.cells[ze].value})}else"Currency"===u[ze]||"Number"===u[ze]||"WholeNumber"===u[ze]?Number.isNaN(+le.cells[ze].value)||(+le.cells[ze].value).toString()!==le.cells[ze].value?fe.push({value:le.cells[ze].value}):fe.push({value:null!==(l=Y.dx.formatValue(+le.cells[ze].value,c[ze]))&&void 0!==l?l:le.cells[ze].value}):"Boolean"===u[ze]&&fe.push({value:String(le.cells[ze].value)});else fe.push({value:le.cells[ze].value});s.push({cells:fe})}return s},i.prototype.getTableDataRequest=function(t,n){if(_.isEmpty(t)||_.isEmpty(n))throw new Error("table and tableColumnOptions should not be empty");return{getTableData:{table:gt.X6.getTableUrn(t),columnNames:n}}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Oe.b),e.\u0275\u0275inject(un.H),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(Ot.vZ),e.\u0275\u0275inject(Ke.n))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),$r=function(i){function t(n,r,o){var a=i.call(this,{cardinalityOptions:[],crossFilterOptions:[],canEnableSecurityFilteringBehavior:void 0,canSupportSecurityFilteringBehavior:void 0,canSupportReferentialIntegrity:void 0,fromColumns:[],toColumns:[],fromTableOptions:[],toTableOptions:[],fromTableData:void 0,toTableData:void 0,fromTableDataLoading:!1,fromTableLoadDataErrorMessage:void 0,toTableDataLoading:!1,toTableLoadDataErrorMessage:void 0})||this;return a.relationshipPropertyStore=n,a.relationshipPropertyDataFactoryService=r,a.relationshipTableDataService=o,a.cardinalityOptions$=a.select(function(l){return l.cardinalityOptions}),a.crossFilterOptions$=a.select(function(l){return l.crossFilterOptions}),a.canEnableSecurityFilteringBehavior$=a.select(function(l){return l.canEnableSecurityFilteringBehavior}),a.canSupportSecurityFilteringBehavior$=a.select(function(l){return l.canSupportSecurityFilteringBehavior}),a.canSupportReferentialIntegrity$=a.select(function(l){return l.canSupportReferentialIntegrity}),a.toColumns$=a.select(function(l){return l.toColumns}),a.fromColumns$=a.select(function(l){return l.fromColumns}),a.fromTableOptions$=a.select(function(l){return l.fromTableOptions}),a.toTableOptions$=a.select(function(l){return l.toTableOptions}),a.fromTableData$=a.select(function(l){return l.fromTableData}),a.toTableData$=a.select(function(l){return l.toTableData}),a.fromTableDataLoading$=a.select(function(l){return l.fromTableDataLoading}),a.fromTableLoadDataErrorMessage$=a.select(function(l){return l.fromTableLoadDataErrorMessage}),a.toTableDataLoading$=a.select(function(l){return l.toTableDataLoading}),a.toTableLoadDataErrorMessage$=a.select(function(l){return l.toTableLoadDataErrorMessage}),a.getTableDataSubscription=new F.w,a.relationshipPropertyStore.fromToColumnProperties$.pipe((0,qe.R)(a.destroy$),(0,st.h)(function(l){return!!(l.fromTableName&&l.toTableName&&l.fromColumnName&&l.toColumnName)})).subscribe(function(l){return a.updateCardinalityOptions()}),a.relationshipPropertyStore.fromToTable$.pipe((0,qe.R)(a.destroy$),(0,Pr.x)()).subscribe(function(l){a.updateToTableOptions(l.fromTableName),a.updateFromTableOptions(l.toTableName),a.updateToOrFromTableData(l.fromTableName,l.toTableName)}),a.relationshipPropertyStore.relationshipProperties$.pipe((0,qe.R)(a.destroy$),(0,st.h)(function(l){return!!l.fromTableName&&!!l.toTableName&&!!l.fromColumnName&&!!l.toColumnName&&typeof l.cardinality<"u"})).subscribe(function(l){a.updateCrossFilterOptions(l),a.updateCanSupportReferentialIntegrity(l),a.updateCanSupportSecurityFilteringBehavior(l),typeof l.isActive<"u"&&typeof l.crossFilteringBehavior<"u"&&a.updateCanEnableSecurityFilteringBehavior(l)}),a}return(0,d.__extends)(t,i),t.prototype.ngOnDestroy=function(){i.prototype.ngOnDestroy.call(this),this.getTableDataSubscription.unsubscribe()},t.prototype.updateCardinalityOptions=function(){this.patchState({cardinalityOptions:this.relationshipPropertyDataFactoryService.getCardinalityOptions()})},t.prototype.updateCrossFilterOptions=function(n){this.patchState({crossFilterOptions:this.relationshipPropertyDataFactoryService.getCrossFilterOptions(n.cardinality,n.fromTableName,n.toTableName)})},t.prototype.updateCanSupportReferentialIntegrity=function(n){this.patchState({canSupportReferentialIntegrity:this.relationshipPropertyDataFactoryService.canSupportReferentialIntegrity(n.cardinality,n.fromTableName,n.toTableName)})},t.prototype.updateCanSupportSecurityFilteringBehavior=function(n){this.patchState({canSupportSecurityFilteringBehavior:this.relationshipPropertyDataFactoryService.canSupportSecurityFilteringBehavior(n.fromTableName,n.toTableName,n.cardinality)})},t.prototype.updateCanEnableSecurityFilteringBehavior=function(n){this.patchState({canEnableSecurityFilteringBehavior:this.relationshipPropertyDataFactoryService.canEnableSecurityFilteringBehavior(n.isActive,n.crossFilteringBehavior,this.relationshipPropertyDataFactoryService.canSupportSecurityFilteringBehavior(n.fromTableName,n.toTableName,n.cardinality))})},t.prototype.updateToOrFromTableData=function(n,r){var a,l,o=this;n&&(a=this.relationshipPropertyDataFactoryService.getColumnOptions(n),this.patchState({fromColumns:a}),this.patchState({fromTableDataLoading:!0}),this.patchState({fromTableLoadDataErrorMessage:void 0})),r&&(l=this.relationshipPropertyDataFactoryService.getColumnOptions(r),this.patchState({toColumns:l}),this.patchState({toTableDataLoading:!0}),this.patchState({toTableLoadDataErrorMessage:void 0})),this.relationshipPropertyStore.enableNewManageRelationshipDialog&&(this.getTableDataSubscription=(0,yn.D)(this.relationshipTableDataService.getTableData(n,a,r,l)).subscribe(function(s){s&&s.forEach(function(c){c.table===n?(o.patchState({fromTableData:{rows:c.rows}}),o.patchState({fromTableDataLoading:!1})):c.table===r&&(o.patchState({toTableData:{rows:c.rows}}),o.patchState({toTableDataLoading:!1}))})},function(s){s.name===n?(o.patchState({fromTableData:void 0}),o.patchState({fromTableDataLoading:!1}),o.patchState({fromTableLoadDataErrorMessage:s.message})):s.name===r&&(o.patchState({toTableData:void 0}),o.patchState({toTableDataLoading:!1}),o.patchState({toTableLoadDataErrorMessage:s.message}))}))},t.prototype.updateToTableOptions=function(n){this.patchState({toTableOptions:this.relationshipPropertyDataFactoryService.getRelationshipTableOptions(n)})},t.prototype.updateFromTableOptions=function(n){this.patchState({fromTableOptions:this.relationshipPropertyDataFactoryService.getRelationshipTableOptions(n)})},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(Xi),e.\u0275\u0275inject(on),e.\u0275\u0275inject(Kr))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(Li.m1),wt=p(64560),Qr=function(i){return i.AddRelatedTables="AddRelatedTables",i}({}),il=new e.InjectionToken("DiagramState.IDiagramLayoutHostService"),Xr=new e.InjectionToken("DiagramState.DiagramViewHostService");function rl(i){return{edgeIncremental:!0,tables:i}}var Yr="PBI.Diagram.Layout",sl=Se.cx[Yr]=(0,Se.b1)(Yr),Zr="PBI.Diagram.Changed",cl=Se.cx[Zr]=(0,Se.b1)(Zr),Yn="1.1.0",Zi="1.1.0",dl=p(96876),pn=p(30794),ul=function(){function i(t){this.left=t?t.left:0,this.top=t?t.top:0,this.width=t?t.width:0,this.height=t?t.height:0}return i.prototype.getCenter=function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},i.prototype.moveBy=function(t){return new i({left:this.left+t.x,top:this.top+t.y,width:this.width,height:this.height})},i.prototype.moveByMargin=function(t){return this.moveBy({x:t,y:t})},i.prototype.extendBy=function(t){return new i({left:this.left-t,top:this.top-t,width:this.width+2*t,height:this.height+2*t})},i.prototype.contains=function(t){return t&&this.left<=t.left&&t.left+t.width<=this.left+this.width&&this.top<=t.top&&t.top+t.height<=this.top+this.height},i.prototype.canFit=function(t){return t&&t.width<=this.width&&t.height<=this.height},i.prototype.intersects=function(t){return t&&t.left<=this.left+this.width&&this.left<=t.left+t.width&&t.top<=this.top+this.height&&this.top<=t.top+t.height},i.getBoundingRect=function(t){for(var n,r=0,o=t;r<o.length;r++){var a=o[r];if(a)if(n){var l=Math.min(a.left,n.left),s=Math.max(a.left+a.width,n.left+n.width),c=Math.min(a.top,n.top);n={left:l,top:c,width:s-l,height:Math.max(a.top+a.height,n.top+n.height)-c}}else n=a}return n?new i(n):null},i.getPointsRect=function(t){for(var n,r=0,o=t;r<o.length;r++){var a=o[r];if(a)if(n){var l=Math.min(a.x,n.left),s=Math.max(a.x,n.left+n.width),c=Math.min(a.y,n.top);n={left:l,top:c,width:s-l,height:Math.max(a.y,n.top+n.height)-c}}else n={left:a.x,top:a.y,width:0,height:0}}return n?new i(n):null},i.isIRect=function(t){return i.exists(t.left)&&i.exists(t.top)&&i.exists(t.width)&&i.exists(t.height)},i.exists=function(t){return null!=t},i.prototype.addPoint=function(t){if(t.x<this.left){var n=this.left+this.width;this.left=t.x,this.width=n-this.left}if(t.y<this.top){var r=this.top+this.height;this.top=t.y,this.height=r-this.top}this.left+this.width<t.x&&(this.width=t.x-this.left),this.top+this.height<t.y&&(this.height=t.y-this.top)},i.prototype.addRect=function(t){this.addPoint({x:t.left,y:t.top}),this.addPoint({x:t.left+t.width,y:t.top+t.height})},i.prototype.area=function(){return this.width*this.height},i}(),Jr=function(){function i(t,n,r,o,a){this.layedOut=!1,this.name=t,this.fromNodeIndex=n,this.fromNodeItem=r,this.toNodeIndex=o,this.toNodeItem=a}return i.copyFrom=function(t){var n=new i(t.name,t.fromNodeIndex,t.fromNodeItem,t.toNodeIndex,t.toNodeItem);return n.crossFilterAngle=t.crossFilterAngle,n.crossFilterLocation=_.cloneDeep(t.crossFilterLocation),n.fromLocation=_.cloneDeep(t.fromLocation),n.fromNodeIndex=t.fromNodeIndex,n.fromNodeItem=t.fromNodeItem,n.fromShapeRotateAngle=t.fromShapeRotateAngle,n.layedOut=t.layedOut,n.points=_.cloneDeep(t.points),n.toLocation=_.cloneDeep(t.toLocation),n.toNodeIndex=t.toNodeIndex,n.toNodeItem=t.toNodeItem,n.toShapeRotateAngle=t.toShapeRotateAngle,n},i.createFromRelationship=function(t){return new i(t.name,t.fromTable,t.fromColumn,t.toTable,t.toColumn)},i.prototype.clear=function(){this.points=[],this.layedOut=!1,this.fromLocation=void 0,this.toLocation=void 0},i.prototype.isSameEdge=function(t){return this.name===t.name},i.prototype.isSameRelationship=function(t){return this.name===t.name},i}(),qr=function(){function i(t){this.layedOut=!1,this.width=0,this.height=0,this.zIndex=0,this.nodeIndex=t}return i.copyFrom=function(t){var n=new i(t.nodeIndex);return n.height=t.height,n.layedOut=t.layedOut,n.left=t.left,n.top=t.top,n.width=t.width,n.zIndex=t.zIndex,n},i}(),pl=function(){function i(){this.nodes=[],this.edges=[],this.boundingBoxPosition={x:0,y:0},this.boundingBoxWidth=0,this.boundingBoxHeight=0}return i.fromNodes=function(t,n){var r=new i;return r.nodes=t,r.edges=n,r},i.copyFrom=function(t){var n=new i;return n.nodes=t.nodes.map(function(r){return qr.copyFrom(r)}),n.edges=t.edges.map(function(r){return Jr.copyFrom(r)}),n.boundingBoxPosition=t.boundingBoxPosition,n.boundingBoxHeight=t.boundingBoxHeight,n.boundingBoxWidth=t.boundingBoxWidth,n},i.prototype.removeNodes=function(t){_.remove(this.nodes,function(n){return t.findIndex(function(r){return n.nodeIndex===r})>=0}),this.removeEdgesForNodes(t)},i.prototype.removeEdgesForNodes=function(t){_.remove(this.edges,function(n){return t.findIndex(function(r){return r===n.fromNodeIndex})>=0||t.findIndex(function(r){return r===n.toNodeIndex})>=0})},i.getEscapedName=function(t){return t?t.replace(new RegExp(":","g"),".").replace(new RegExp(",","g"),'"'):""},i}(),gl=function(){function i(){}return Object.defineProperty(i.prototype,"layedOut",{get:function(){return this.points&&this.points.length>=2&&!!this.crossFilterLocation&&!!this.fromLocation&&!!this.toLocation},enumerable:!1,configurable:!0}),i.prototype.matches=function(t){return t.name===this.name},i.prototype.update=function(t){var n=!1;return this.areEqualPoints(this.fromLocation,t.fromLocation)||(n=!0,this.fromLocation=t.fromLocation),this.fromShapeRotateAngle!==t.fromShapeRotateAngle&&(n=!0,this.fromShapeRotateAngle=t.fromShapeRotateAngle),this.areEqualPoints(this.toLocation,t.toLocation)||(n=!0,this.toLocation=t.toLocation),this.toShapeRotateAngle!==t.toShapeRotateAngle&&(n=!0,this.toShapeRotateAngle=t.toShapeRotateAngle),this.areSameArray(this.points,t.points)||(n=!0,this.points=_.cloneDeep(t.points)),this.areEqualPoints(this.crossFilterLocation,t.crossFilterLocation)||(n=!0,this.crossFilterLocation=t.crossFilterLocation),this.crossFilterAngle!==t.crossFilterAngle&&(n=!0,this.crossFilterAngle=t.crossFilterAngle),n},i.prototype.areEqualPoints=function(t,n){return!t&&!n||!(!t||!n)&&t.x===n.x&&t.y===n.y},i.prototype.areSameArray=function(t,n){if(!t&&!n)return!0;if(!t||!n||t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!this.areEqualPoints(t[r],n[r]))return!1;return!0},i}(),eo=function(){function i(){this.zIndex=0,this.isTableCollapsed=!1,this.expandedHeight=0}return i.prototype.isLayedOut=function(){return this.layedOut},Object.defineProperty(i.prototype,"layedOut",{get:function(){var n,r,o,a;return this.exists(null===(n=this.position)||void 0===n?void 0:n.left)&&this.exists(null===(r=this.position)||void 0===r?void 0:r.top)&&(null===(o=this.position)||void 0===o?void 0:o.height)>0&&(null===(a=this.position)||void 0===a?void 0:a.width)>0},enumerable:!1,configurable:!0}),i.prototype.exists=function(t){return null!=t},i}(),to=function(){function i(){this.isLayoutPending=!1,this.zoomValue=100,this.scrollPosition={x:0,y:0},this.boundingBox={left:0,top:0,width:1e3,height:1e3},this.showExtraHeaderInfo=!1,this.showKeyFieldsWhenCollapsed=!0,this.pinKeyFieldsToTop=!1,this.displayMode="NoTables",this._tables={},this._relationships=[]}return i.prototype.calculateBoundingBox=function(){var t=_.values(this._tables).filter(function(n){return n.layedOut});return this.boundingBox=t.length>0?ul.getBoundingRect(t.map(function(n){return n.isLayedOut()?n.position:void 0})):{left:0,top:0,width:1e3,height:1e3},this.zoomValue||(this.zoomValue=100),this.boundingBox},i.prototype.getOrAddTable=function(t,n){if(!(t in this._tables)){var r=new eo;r.nodeIndex=t,this._tables[t]=r}return n&&(this._tables[t].nodeLineageTag=n),this._tables[t]},i.prototype.hasRelationship=function(t){return this._relationships.findIndex(function(n){return n.matches(t)})>=0},i.prototype.getOrAdd=function(t){var n=this._relationships.find(function(o){return o.matches(t)});if(n)return{added:!1,rel:n};var r=new gl;return r.name=t.name,r.fromNodeIndex=t.fromNodeIndex,r.fromNodeItem=t.fromNodeItem,r.toNodeIndex=t.toNodeIndex,r.toNodeItem=t.toNodeItem,this._relationships.push(r),{added:!0,rel:r}},i.prototype.getOrAddRelationship=function(t){return this.getOrAdd({fromNodeIndex:t.fromTable,fromNodeItem:t.fromColumn,name:t.name,toNodeIndex:t.toTable,toNodeItem:t.toColumn})},i.prototype.getOrAddExistingRelationship=function(t){var n=this.getOrAdd(t);return n.added&&n.rel.update(t),n.rel},i.prototype.getOrAddLayoutEdgeRelationship=function(t){return this.getOrAdd(t).rel},i.prototype.getTable=function(t){return this._tables[t]},i.prototype.getTableNames=function(){return Object.keys(this._tables)},i.prototype.getTablesSortedByZIndex=function(){return this.getAllTables().sort(function(t,n){return t.zIndex-n.zIndex}).map(function(t){return t.nodeIndex})},i.prototype.getAllTables=function(){return _.values(this._tables)},i.prototype.getAllRelationships=function(){return this._relationships},i.prototype.getDiagramTable=function(t){return this.getTable(t)},i.prototype.hasTable=function(t){return t in this._tables},i.prototype.getCurrentLayout=function(){for(var t,n,r,o,a,l,s,c,u=new pl,f=0,v=_.values(this._tables);f<v.length;f++){var C=v[f],E=new qr(C.nodeIndex);E.height=null===(t=C.position)||void 0===t?void 0:t.height,E.layedOut=C.layedOut,E.left=null===(n=C.position)||void 0===n?void 0:n.left,E.top=null===(r=C.position)||void 0===r?void 0:r.top,E.width=null===(o=C.position)||void 0===o?void 0:o.width,E.zIndex=C.zIndex,u.nodes.push(E)}for(var z=0,ce=this._relationships;z<ce.length;z++){var le=ce[z],fe=new Jr(le.name,le.fromNodeIndex,le.fromNodeItem,le.toNodeIndex,le.toNodeItem);fe.crossFilterAngle=le.crossFilterAngle,fe.crossFilterLocation=le.crossFilterLocation,fe.fromLocation=le.fromLocation,fe.fromShapeRotateAngle=le.fromShapeRotateAngle,fe.layedOut=le.layedOut,fe.points=le.points,fe.toLocation=le.toLocation,fe.toShapeRotateAngle=le.toShapeRotateAngle,u.edges.push(fe)}return u.boundingBoxHeight=(null===(a=this.boundingBox)||void 0===a?void 0:a.height)||1e3,u.boundingBoxWidth=(null===(l=this.boundingBox)||void 0===l?void 0:l.width)||1e3,u.boundingBoxPosition={x:(null===(s=this.boundingBox)||void 0===s?void 0:s.left)||0,y:(null===(c=this.boundingBox)||void 0===c?void 0:c.top)||0},u},i.prototype.removeDiagramTables=function(t){for(var n=0,r=t;n<r.length;n++){var o=r[n];o in this._tables&&delete this._tables[o]}_.remove(this._relationships,function(a){return t.findIndex(function(l){return l===a.fromNodeIndex})>0||t.findIndex(function(l){return l===a.toNodeIndex})>0})},i.prototype.applyLayout=function(t,n){if(!t)return!1;for(var r=!1,o=0,a=t.nodes;o<a.length;o++){var l=a[o],s=this.getOrAddTable(l.nodeIndex,void 0),c={height:l.height,width:l.width,left:l.left,top:l.top};c!==s.position&&(r=!0,s.position=c)}for(var u=0,f=t.edges;u<f.length;u++){var v=f[u],C=this.getOrAddLayoutEdgeRelationship(v).update(v);r=r||C}return n&&this.calculateBoundingBox(),r},i}(),Ji=function(){function i(){}return i.buildDiagrams=function(t){return t.diagrams.map(function(n){var r,o,a=new to;a.name=n.name,a.ordinal=n.ordinal,a.isLayoutPending=!1,a.scrollPosition={x:(null===(r=n.scrollPosition)||void 0===r?void 0:r.x)||0,y:(null===(o=n.scrollPosition)||void 0===o?void 0:o.y)||0},a.zoomValue=n.zoomValue,a.pinKeyFieldsToTop=!!n.pinKeyFieldsToTop,a.showExtraHeaderInfo=!!n.showExtraHeaderInfo,a.showKeyFieldsWhenCollapsed=!n.hideKeyFieldsWhenCollapsed,a.tablesLocked=!!n.tablesLocked;for(var l=0,s=n.nodes;l<s.length;l++){var c=s[l],u=new eo;u.nodeIndex=c.nodeIndex,u.nodeLineageTag=c.nodeLineageTag,u.position={height:c.size.height,width:c.size.width,left:c.location.x,top:c.location.y},u.zIndex=c.zIndex,u.isTableCollapsed=c?.expandedHeight>10,u.expandedHeight=c.expandedHeight||0,a._tables[c.nodeIndex]=u}return a.calculateBoundingBox(),a})},i.buildSerializedDiagram=function(t){return{ordinal:t.ordinal,scrollPosition:t.scrollPosition,nodes:_.values(t._tables).map(function(n){return{location:{x:n.position.left,y:n.position.top},nodeIndex:n.nodeIndex,nodeLineageTag:n.nodeLineageTag,size:{height:n.position.height,width:n.position.width},zIndex:n.zIndex,expandedHeight:n.isTableCollapsed?n.expandedHeight:void 0}}),name:t.name,zoomValue:t.zoomValue,pinKeyFieldsToTop:t.pinKeyFieldsToTop,showExtraHeaderInfo:t.showExtraHeaderInfo,hideKeyFieldsWhenCollapsed:!t.showKeyFieldsWhenCollapsed,tablesLocked:!!t.tablesLocked}},i}(),fl=function(){function i(){this.locationBuffer=20,this.newDefaultWidth=234,this.additionalNewWidth=54,this.additionalNewHeight=37}return i.prototype.Upgrade=function(t){for(var r={version:"1.1.0",diagrams:[],selectedDiagram:null,defaultDiagram:null},o=0,a=0,l=t.diagrams;a<l.length;a++){var s=l[a],c={ordinal:s.isDefault?0:o++,name:s.name,zoomValue:s.zoomValue,nodes:[],scrollPosition:{x:0,y:0}};if(s.isDefault&&(r.defaultDiagram=s.name,r.selectedDiagram=s.name),s.layout&&s.layout.nodes)for(var u=0,f=s.layout.nodes;u<f.length;u++){var v=f[u];c.nodes.push({location:{x:v.left,y:v.top},nodeIndex:v.nodeIndex,size:{width:v.width,height:v.height},zIndex:0})}this.SetNewWidths(c),this.SetNewHeights(c)&&(delete c.scrollPosition,delete c.zoomValue),r.diagrams.push(c)}return null==r.selectedDiagram&&(r.selectedDiagram=r.diagrams[0].name),r},i.prototype.SetNewWidths=function(t){var n={},r=0;if(t.nodes&&t.nodes.length>0){for(var o=_.sortBy(t.nodes,function(f){return f.location.x}),a=0,l=o;a<l.length;a++)n[l[a].nodeIndex]=0;for(var c=0;c<o.length;c++){for(var u=c+1;u<o.length;u++)(r=this.getNeededSpaceForWidth(o[c],o[u],n))>0&&(n[o[u].nodeIndex]=Math.max(n[o[u].nodeIndex],r));o[c].location.x=o[c].location.x+n[o[c].nodeIndex],o[c].size.width=o[c].size.width+this.additionalNewWidth}}},i.prototype.getNeededSpaceForWidth=function(t,n,r){if(n.location.y+n.size.height<t.location.y-this.locationBuffer||n.location.y>t.location.y+t.size.height+this.locationBuffer||n.location.x<=t.location.x)return 0;var a=t.location.x+t.size.width+(t.size.width<this.newDefaultWidth?this.additionalNewWidth:0)+this.locationBuffer+r[t.nodeIndex];return n.location.x>=a?0:a-n.location.x+this.locationBuffer},i.prototype.SetNewHeights=function(t){if(t.nodes&&t.nodes.length>0){for(var n=_.sortBy(t.nodes,function(f){return f.location.y}),r={},o=0,a=0,l=n;a<l.length;a++)r[l[a].nodeIndex]=0;for(var c=0;c<n.length;c++){for(var u=c+1;u<n.length;u++)(o=this.getNeededSpaceForHeight(n[c],n[u],r))>0&&(r[n[u].nodeIndex]=Math.max(r[n[u].nodeIndex],o));n[c].location.y=n[c].location.y+r[n[c].nodeIndex],n[c].size.height=n[c].size.height+this.additionalNewHeight}return!0}return!1},i.prototype.getNeededSpaceForHeight=function(t,n,r){if(n.location.x+n.size.width<t.location.x-this.locationBuffer||n.location.x>t.location.x+t.size.width+this.locationBuffer||n.location.y<=t.location.y)return 0;var o=t.location.y+t.size.height+this.additionalNewHeight+this.locationBuffer+r[t.nodeIndex];return n.location.y>=o?0:o-n.location.y+this.locationBuffer},i}(),vl=function(){function i(){}return i.prototype.Upgrade=function(t){return null},i}(),_l=function(){function i(){var t;this.loaders=((t={})["1.0.0"]=new fl,t["1.1.0"]=new vl,t)}return i.prototype.getUpgrader=function(t){return t&&this.loaders[t]?this.loaders[t]:null},i}(),io=function(){function i(){this.upgraders=new _l}return i.prototype.serialize=function(t){return JSON.stringify(t)},i.prototype.deserialize=function(t,n){try{var r=this.deserializeAndUpgradeToCurrent(t);return this.isLayoutEmpty(r)&&(r=this.deserializeAndUpgradeToCurrent(n)),r}catch{return null}},i.prototype.deserializeAndUpgradeToCurrent=function(t){var n=JSON.parse(t);return n.version?n.version===Yn?{current:n}:this.upgradeToVersion(n,Yn):null},i.prototype.upgradeToVersion=function(t,n){var r=t;if(r.version){for(;r.version!==n&&(r=this.upgraders.getUpgrader(r.version).Upgrade(r)););return this.getDeserializationResult(r)}return null},i.prototype.getDeserializationResult=function(t){return{current:t}},i.prototype.isLayoutEmpty=function(t){var n=t.current;return!n||!n.diagrams||0===n.diagrams.length||1===n.diagrams.length&&!n.diagrams[0].nodes},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(n){return new(n||i)},providedIn:"root"}),i}(),qi=function(){function i(t){this.diagramPersistence=t,this.diagrams={},this._isDirty=!1,this._keepLayoutUpdated=!1,this.setPreviewVersionAndEmpty()}return Object.defineProperty(i.prototype,"isPreview",{get:function(){return this.version===Zi},enumerable:!1,configurable:!0}),i.prototype.setCurrentVersionAndEmpty=function(){this.version=Yn,this.diagrams={}},i.prototype.setPreviewVersionAndEmpty=function(){this.version=Zi,this.diagrams={}},Object.defineProperty(i.prototype,"versionString",{get:function(){return this.version},enumerable:!1,configurable:!0}),i.prototype.setDiagramContent=function(t){this.diagrams[t.name]=t},i.prototype.loadSerializedState=function(t,n){var r=this.diagramPersistence.deserialize(t,n),o=[];r?(o=Ji.buildDiagrams(r.current),this.selectedDiagram=r.current.selectedDiagram,this.defaultDiagram=r.current.defaultDiagram,this.version=r.current.version):this.version=Yn,this.diagrams={};for(var a=0,l=o;a<l.length;a++){var s=l[a];this.diagrams[s.name]=s}this._isDirty=!1,this.hasDiagrams()&&(this.defaultDiagram||(this.defaultDiagram=_.values(this.diagrams)[0].name),!this.selectedDiagram&&this.defaultDiagram&&(this.selectedDiagram=this.defaultDiagram))},i.prototype.getSerializedState=function(t){var n=this.diagramPersistence.serialize(this.getPersistedDiagrams());return t&&(this._isDirty=!1),n},i.prototype.isDirty=function(){return this._isDirty},i.prototype.markDirty=function(t){void 0===t&&(t=!0),this._isDirty=t},i.prototype.addDiagram=function(t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!0);var o=new to;return o.name=t,o.tablesLocked=n,o.ordinal=_.isEmpty(this.diagrams)?0:Math.max.apply(Math,_.values(this.diagrams).map(function(a){return a.ordinal}))+1,this.diagrams[o.name]=o,(r||1===this.getDiagramNames().length)&&(this.selectedDiagram=o.name),this.defaultDiagramName||(this.defaultDiagram=o.name),o},i.prototype.renameDiagram=function(t,n){if(t in this.diagrams){var r=this.diagrams[t];if(r.name!==this.defaultDiagramName&&(delete this.diagrams[t],r.name=n,this.diagrams[n]=r,this.selectedDiagram===t))return this.selectedDiagram=n,r}return null},i.prototype.deleteDiagram=function(t){return t in this.diagrams&&this.diagrams[t].name!==this.defaultDiagramName&&(delete this.diagrams[t],this.resetDiagramsOrdinal(),this.selectedDiagram===t&&(this.selectedDiagram=this.defaultDiagramName),!0)},i.prototype.getDiagrams=function(){return _.sortBy(_.values(this.diagrams),function(t){return t.ordinal})},i.prototype.getDiagram=function(t){return this.diagrams&&(t||this.selectedDiagramName)?t?this.diagrams[t]:this.diagrams[this.selectedDiagram]:null},i.prototype.getDiagramByOrdinal=function(t){return _.values(this.diagrams).find(function(n){return n.ordinal===t})},i.prototype.getDiagramNames=function(){return Object.keys(this.diagrams)},i.prototype.containsDiagramName=function(t){return t in this.diagrams},i.prototype.hasDiagrams=function(){return Object.keys(this.diagrams).length>0},i.prototype.setDiagram=function(t){if(t in this.diagrams){var n=this.diagrams[t];return this.selectedDiagram=t,n}return null},Object.defineProperty(i.prototype,"selectedDiagramName",{get:function(){return this.selectedDiagram},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"defaultDiagramName",{get:function(){return this.defaultDiagram},enumerable:!1,configurable:!0}),i.prototype.enableLayout=function(){this._keepLayoutUpdated=!0},Object.defineProperty(i.prototype,"keepLayoutUpdated",{get:function(){return this._keepLayoutUpdated},enumerable:!1,configurable:!0}),i.prototype.getPersistedDiagrams=function(){var n=_.sortBy(_.values(this.diagrams),function(o){return o.ordinal}).map(function(o){return Ji.buildSerializedDiagram(o)});return{version:this.version,diagrams:n,selectedDiagram:this.selectedDiagram,defaultDiagram:this.defaultDiagram}},i.prototype.resetDiagramsOrdinal=function(){for(var t=_.sortBy(_.values(this.diagrams),function(r){return r.ordinal}),n=0;n<t.length;n++)this.diagrams[t[n].name].ordinal=n},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(io))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(),ro=function(){function i(){}return i.fixupDiagram=function(t,n){var r=this.removeRelationships(t,n);return this.addRelationships(t,n)||r},i.removeRelationships=function(t,n){for(var r={},o=n._relationships.length,a=0,l=n._relationships;a<l.length;a++)r[l[a].name]=!1;for(var c=0,u=t.relationships;c<u.length;c++)r[u[c].name]=!0;for(var v=[],C=function(fe){if(r[fe.name]){var we=t.relationships.find(function(Je){return Je.name===fe.name});we&&we.fromTable===fe.fromNodeIndex&&we.fromColumn===fe.fromNodeItem&&we.toTable===fe.toNodeIndex&&we.toColumn===fe.toNodeItem&&v.push(fe)}},E=0,z=n._relationships;E<z.length;E++)C(z[E]);return n._relationships=v,o!==n._relationships.length},i.addRelationships=function(t,n){for(var r=!1,o=0,a=t.relationships;o<a.length;o++){var l=a[o];if(l.fromTable in n._tables&&l.toTable in n._tables){var s=n.getOrAddRelationship(l);r=r||s.added||!s.rel.layedOut}}return r},i.fixForTableRenames=function(t,n){for(var r=0,o=t._relationships;r<o.length;r++){var a=o[r];a.fromNodeIndex in n&&(a.fromNodeIndex=n[a.fromNodeIndex]),a.toNodeIndex in n&&(a.toNodeIndex=n[a.toNodeIndex])}},i}(),bl=function(){function i(){}return i.fixupDiagram=function(t,n,r){var o={nodesUpdated:!1,edgesUpdated:!1};return this.fixupNamesByLineageTag(t,n),o.edgesUpdated=this.removeTables(t,n),r&&(o.nodesUpdated=this.addNewTables(t,n)),o},i.addNewTables=function(t,n){for(var r=!1,o=0,a=t.tables;o<a.length;o++){var l=a[o];l.name in n._tables||(n.getOrAddTable(l.name,l.lineageTag),r=!0)}return r},i.fixupNamesByLineageTag=function(t,n){for(var r={},o={},a=0,l=_.values(n._tables);a<l.length;a++)(s=l[a]).nodeLineageTag&&(o[s.nodeLineageTag]=s);for(var c=0,u=t.tables;c<u.length;c++)(s=u[c]).lineageTag&&s.lineageTag in o&&(f=o[s.lineageTag]).nodeIndex!==s.name&&(r[f.nodeIndex]=s.name);if(0!==_.keys(r).length){for(var v=[],C=0,E=_.keys(r);C<E.length;C++){var z=E[C],ce=r[z],f=n._tables[z];delete n._tables[z],f.nodeIndex=ce,v.push(f)}ro.fixForTableRenames(n,r);for(var le=0,fe=v;le<fe.length;le++){var s;n._tables[(s=fe[le]).nodeIndex]=s}}},i.removeTables=function(t,n){for(var r=!1,o={},a=0,l=_.keys(n._tables);a<l.length;a++)o[s=l[a]]=!1;for(var c=0,u=t.tables;c<u.length;c++)o[u[c].name]=!0;for(var v=0,C=(0,d.__spreadArray)([],_.keys(n._tables),!0);v<C.length;v++){var s;o[s=C[v]]||(delete n._tables[s],r=!0)}return r},i}(),yl=function(){function i(t,n){this.diagramState=t,this.diagramPersistence=n}return i.prototype.mergeSavedLayout=function(t){for(var n=this.diagramPersistence.deserialize(t,""),r=Ji.buildDiagrams(n.current),o=this.diagramState.getDiagramNames(),a=this.diagramState.getDiagram(this.diagramState.selectedDiagramName),l=0,s=o;l<s.length;l++){var c=s[l];c!==a.name&&this.diagramState.deleteDiagram(c)}for(var u=0,f=0,v=r.sort(function(Je){return Je.ordinal});f<v.length;f++){var C=v[f];C.name!==a.name&&(this.diagramState.setDiagramContent(C),u===a.ordinal&&u++,C.ordinal=u++)}var E=r.find(function(Je){return Je.name===a.name});if(E){var z=a.getTableNames().filter(function(Je){return!E.hasTable(Je)});a.removeDiagramTables(z);for(var ce=0,le=E.getTableNames();ce<le.length;ce++){var fe=le[ce],we=E._tables[fe];if(!a.hasTable(fe)){var Ue=a.getOrAddTable(fe,we.nodeLineageTag);Ue.expandedHeight=we.expandedHeight,Ue.isTableCollapsed=we.isTableCollapsed,Ue.position=we.position,Ue.zIndex=we.zIndex}}}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(qi),e.\u0275\u0275inject(io))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(),Cl=function(){function i(t,n,r){this.diagramStateService=t,this.layoutMergerService=n,this.diagramViewHostService=r}return i.prototype.createNewDiagram=function(t,n,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=!0);var l=this.diagramStateService.addDiagram(t,o,a);return this.updateDisplayModes(n,r),l},i.prototype.validateTableSizes=function(){for(var t=0,n=this.diagramStateService.getDiagrams();t<n.length;t++)for(var r=n[t],o=0,a=_.values(r._tables);o<a.length;o++){var l=a[o];if(l.position||(l.position={width:0,height:0}),l.position.width<1||l.position.height<1){var s=this.diagramViewHostService.getSize(l.nodeIndex,l.isTableCollapsed,r.showKeyFieldsWhenCollapsed,r.showExtraHeaderInfo);l.position.width=s.width,l.position.height=s.height}}},i.prototype.removeAllDiagramNodes=function(t){var n=this.diagramStateService.getDiagram(t);n._tables={},n._relationships=[],n.calculateBoundingBox(),this.updateDisplayMode(t,void 0)},i.prototype.removeDiagramNodes=function(t,n){this.diagramStateService.getDiagram(t).removeDiagramTables(n),this.updateDisplayMode(t,void 0)},i.prototype.findNode=function(t,n){try{return this.diagramStateService.getDiagram(t)._tables[n]}catch{return null}},i.prototype.findOrAddNode=function(t,n,r,o){void 0===o&&(o=null);var a=this.diagramStateService.getDiagram(t),l=a.getOrAddTable(n,r);if(l.position||(l.position={width:0,height:0}),o&&o.position)l.position=(0,d.__assign)({},o.position),l.isTableCollapsed=o.isTableCollapsed,l.expandedHeight=o.expandedHeight;else if(l.position.width<1||l.position.height<1){var s=this.diagramViewHostService.getSize(l.nodeIndex,l.isTableCollapsed,a.showKeyFieldsWhenCollapsed,a.showExtraHeaderInfo);l.position.width=s.width,l.position.height=s.height}return this.updateDisplayMode(t),l},i.prototype.getOrAddRelationship=function(t,n){return this.diagramStateService.getDiagram(t).getOrAddRelationship(n).rel},i.prototype.getOrAddExistingRelationship=function(t,n){return this.diagramStateService.getDiagram(t).getOrAddExistingRelationship(n)},i.prototype.clearEdgePoints=function(t,n){var r=this.diagramStateService.getDiagram(t);_.remove(r._relationships,function(o){return n.findIndex(function(a){return a===o.fromNodeIndex})>0||n.findIndex(function(a){return a===o.toNodeIndex})>0})},i.prototype.bringNodeToFront=function(t,n){var r=this.diagramStateService.getDiagram(t);if(r.getTableNames().length<=1)return!1;var o=_.values(r._tables).sort(function(f,v){return f.zIndex-v.zIndex}),a=o[o.length-1];if(a.nodeIndex===n&&a.zIndex!==o[o.length-2].zIndex)return!1;for(var l=1,s=0,c=o;s<c.length;s++){var u=c[s];u.zIndex=u.nodeIndex===n?o.length:l++}return!0},i.prototype.getEdgesForNode=function(t,n){return this.diagramStateService.getDiagram(t)._relationships.filter(function(o){return o.fromNodeIndex===n||o.toNodeIndex===n})},i.prototype.renameNode=function(t,n,r,o){var a=this,l=this.findNode(t,n);if(l){var s=this.getEdgesForNode(t,n);return this.removeDiagramNodes(t,[n]),this.findOrAddNode(t,r,o,l).nodeLineageTag=o,s.forEach(function(u){u.fromNodeIndex===n&&(u.fromNodeIndex=r),u.toNodeIndex===n&&(u.toNodeIndex=r),a.getOrAddExistingRelationship(t,u)}),!0}return!1},i.prototype.serializeDiagrams=function(t){return this.diagramStateService.getSerializedState(t)},i.prototype.deserializeDiagrams=function(t,n,r){this.diagramStateService.loadSerializedState(t,n),this.updateDisplayModes(r,!1),this.validateTableSizes()},i.prototype.mergeSavedLayout=function(t){this.layoutMergerService.mergeSavedLayout(t)},i.prototype.calculateBoundingBox=function(t){return this.diagramStateService.getDiagram(t).calculateBoundingBox()},i.prototype.getRelationshipsOnDiagram=function(t){var n=this.diagramStateService.getDiagram(t),r=this.diagramViewHostService.getHostedModel(),o=[];if(!r)return o;if(n&&n._tables&&r&&r.relationships)for(var a=function(f){f.fromTable&&f.toTable&&f.fromTable in n._tables&&r.tables.findIndex(function(v){return v.name===f.fromTable})>=0&&f.toTable in n._tables&&r.tables.findIndex(function(v){return v.name===f.toTable})>=0&&o.push(f)},l=0,s=r.relationships;l<s.length;l++)a(s[l]);return o},i.prototype.getRelationshipsForDiagram=function(t){var n=this.diagramStateService.getDiagram(t);return this.diagramViewHostService.hasModel()&&n?._tables?this.diagramViewHostService.getRelationshipsBetweenTables(Object.keys(n._tables)):{}},i.prototype.getDiagramRelationships=function(t){var n=this.diagramStateService.getDiagram(t),r=this.diagramViewHostService.getHostedModel(),o=[];if(n&&n._tables&&r&&r.relationships)for(var a=0,l=r.relationships;a<l.length;a++)o.push(n.getOrAddRelationship(l[a]).rel);return o},i.prototype.setTablesCollapsed=function(t,n,r){var o=this,a=!1,l=this.diagramStateService.getDiagram(t);return n.map(function(s){var c=l.getTable(s),u=null;c.isTableCollapsed!==r&&(r?(u=o.diagramViewHostService.getSize(s,r,l.showKeyFieldsWhenCollapsed,l.showExtraHeaderInfo),c.expandedHeight=c.position.height,c.isTableCollapsed=!0,c.position.height=u.height):(c.position.height=c.expandedHeight,c.isTableCollapsed=!1),a=!0)}),a},i.prototype.updateDiagramForModel=function(t,n,r,o){var a=this.diagramStateService.getDiagram(t),l=this.diagramViewHostService.getHostedModel();if(this.updateDisplayMode(t,this.getIsModelOverThreshold(r),o),"OverThreshold"===a.displayMode||!l)return"None";var s=bl.fixupDiagram(l,a,n);return this.validateTableSizes(),s.edgesUpdated=s.edgesUpdated||ro.fixupDiagram(l,a),this.updateDisplayMode(t,this.getIsModelOverThreshold(r),o),s.nodesUpdated?"FullUpdate":s.edgesUpdated?"EdgesOnly":"None"},i.prototype.updateDisplayModes=function(t,n){var r=this,o=this.getIsModelOverThreshold(t);_.forEach(this.diagramStateService.getDiagramNames(),function(a){r.updateDisplayMode(a,o,n)})},i.prototype.updateDisplayMode=function(t,n,r){var o=this.diagramStateService.defaultDiagramName,a=this.diagramStateService.getDiagram(t);if(void 0===n){if("OverThreshold"===a.displayMode)return;n=!1}a.displayMode=!n||r||a.name!==o&&0!==a.getTableNames().length?0===a.getTableNames().length?"NoTables":"ShowTables":"OverThreshold"},i.prototype.getIsModelOverThreshold=function(t){var n=this.diagramViewHostService.getHostedModel();return!!n&&n.tables.length>t},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(qi),e.\u0275\u0275inject(yl),e.\u0275\u0275inject(Xr))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Zn=function(){function i(t,n,r,o,a,l,s,c){this.diagramStateService=t,this.diagramManagement=n,this.telemetryService=r,this.layoutHostService=a,this.diagramViewHostService=l,this.modelViewCapabilitesService=s,this.eventAggregationService=c,this.diagramCollectionChanged=new pn.xQ,this.diagramChanged=new pn.xQ,this.diagramTableThreshold=75,this.overrideThreshold=!1,this.subscriptions=new F.w,this.changeSourceHistory=[],o.registerService("diagramService",this),this.setThreshold(this.layoutHostService.getDiagramTableThreshold())}return i.prototype.setThreshold=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return this.diagramTableThreshold=t,[4,this.tableThresholdChanged(!0)];case 1:return n.sent(),[2]}})})},i.prototype.notifyDiagramCollectionChanged=function(){this.logAndClearChangeSourceHistory(),this.diagramCollectionChanged.next({diagrams:this.getDiagrams(),selectedDiagram:this.getDiagram(null)})},i.prototype.notifyDiagramChanged=function(t){this.logAndClearChangeSourceHistory(),this.diagramChanged.next(t)},i.prototype.ngOnDestroy=function(){this.subscriptions&&this.subscriptions.unsubscribe()},i.prototype.initializeDiagramLayout=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(r){return this.diagramManagement.deserializeDiagrams(t,n,this.diagramTableThreshold),this.diagramStateService.hasDiagrams()||(this.diagramStateService.setPreviewVersionAndEmpty(),this.addDiagram()),this.diagramViewHostService.savedDiagramsLoaded(this.diagramStateService.versionString,this.getDiagrams()),this.diagramViewHostService.diagramVersionSet(this.diagramStateService.versionString),this.changeSourceHistory.push("InitializeDiagramLayout"),this.notifyDiagramCollectionChanged(),this.diagramStateService.markDirty(!1),[2]})})},i.prototype.getDiagramLayouts=function(t){return this.diagramStateService.getSerializedState(t)},i.prototype.isDiagramUpgradedToPreview=function(){return this.diagramStateService.isPreview||this.modelViewCapabilitesService.diagramLayoutMinVersion===Zi},i.prototype.isDiagramLayoutDirty=function(){return this.diagramStateService.isDirty()},i.prototype.getDiagrams=function(){return this.diagramStateService.getDiagrams()},i.prototype.getDiagramNames=function(){return this.diagramStateService.getDiagramNames()},i.prototype.getDiagram=function(t){return this.diagramStateService.getDiagram(t)},i.prototype.getSelectedDiagram=function(){return this.diagramStateService.getDiagram(null)},i.prototype.getPersistedDiagrams=function(){return this.diagramStateService.getPersistedDiagrams()},i.prototype.markDirty=function(t){void 0===t&&(t=!0),this.diagramStateService.markDirty(t)},Object.defineProperty(i.prototype,"selectedDiagramName",{get:function(){return this.diagramStateService.selectedDiagramName},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"defaultDiagramName",{get:function(){return this.diagramStateService.defaultDiagramName},enumerable:!1,configurable:!0}),i.prototype.getDiagramNode=function(t,n){return this.diagramStateService.getDiagram(t).getTable(n)},i.prototype.getOrCreateDiagramEdge=function(t,n){return this.diagramStateService.getDiagram(t).getOrAddRelationship(n).rel},i.prototype.getDiagramRelationships=function(t){return this.diagramManagement.getDiagramRelationships(t)},i.prototype.getRelationshipsForDiagram=function(t){return this.diagramManagement.getRelationshipsForDiagram(t)},i.prototype.renameDiagram=function(t,n,r){void 0===r&&(r=!0);var o=this.diagramStateService.getDiagram(t);if(o){var a=this.getUniqueName(n,this.diagramStateService.getDiagramNames());this.diagramStateService.renameDiagram(t,a),this.diagramStateService.markDirty(),(r||1===this.diagramStateService.getDiagramNames().length)&&this.setDiagramByName(o.name),this.changeSourceHistory.push("RenameDiagram"),this.notifyDiagramCollectionChanged()}},i.prototype.deleteDiagram=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(r){switch(r.label){case 0:return this.getDiagram(t)&&t!==this.diagramStateService.defaultDiagramName&&this.diagramStateService.deleteDiagram(t)?(this.diagramStateService.markDirty(),[4,this.ensureSelectedDiagramHasLayout(!0)]):[3,2];case 1:r.sent(),this.changeSourceHistory.push("DeleteDiagram"),this.notifyDiagramCollectionChanged(),r.label=2;case 2:return[2]}})})},i.prototype.setDiagram=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return(n=this.diagramStateService.getDiagramByOrdinal(t))&&n.name!==this.diagramStateService.selectedDiagramName?[4,this.setDiagramByName(n.name)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},i.prototype.setDiagramByName=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return this.diagramStateService.setDiagram(t),this.diagramStateService.markDirty(),[4,this.ensureSelectedDiagramHasLayout(!0)];case 1:return n.sent(),this.changeSourceHistory.push("SetDiagramByName"),this.notifyDiagramCollectionChanged(),[2]}})})},i.prototype.resetTableHeights=function(t,n){var r=this;void 0===n&&(n=!0);var o=this.diagramStateService.getDiagram(t);o&&(_.forEach(_.values(o._tables),function(a){var l=r.diagramViewHostService.getSize(a.nodeIndex,!1,o.showKeyFieldsWhenCollapsed,o.showExtraHeaderInfo);a.isTableCollapsed=!1,a.position.height=l.height,a.position.width=l.width}),this.diagramManagement.clearEdgePoints(t,Object.keys(o._tables)),o.calculateBoundingBox(),n&&(this.changeSourceHistory.push("ResetTableHeights"),this.notifyDiagramChanged(o.name)))},i.prototype.canEditModel=function(){return this.diagramViewHostService.canEditModel()},i.prototype.setTablePosition=function(t,n,r){this.moveNodes(n,[{tableName:t,newPosition:r}],!0)},i.prototype.setTablesCollapsed=function(t,n){this.diagramManagement.setTablesCollapsed(this.diagramStateService.selectedDiagramName,t,n)&&(this.performFullEdgeLayout(),this.diagramStateService.markDirty())},i.prototype.setDiagramProperties=function(t){var n=this.diagramStateService.getDiagram(t.diagramName),r=!1,o=!1,a=!1;if(null!=t.pinKeyFieldsToTop&&t.pinKeyFieldsToTop!==n.pinKeyFieldsToTop&&(n.pinKeyFieldsToTop=t.pinKeyFieldsToTop,r=!0),null!=t.showExtraHeaderInfo&&t.showExtraHeaderInfo!==n.showExtraHeaderInfo&&(n.showExtraHeaderInfo=t.showExtraHeaderInfo,r=!0,a=!0),null!=t.showKeyFieldsWhenCollapsed&&t.showKeyFieldsWhenCollapsed!==n.showKeyFieldsWhenCollapsed&&(n.showKeyFieldsWhenCollapsed=t.showKeyFieldsWhenCollapsed,r=!0,o=!0),Object.keys(n._tables).length>0&&(o||a)){for(var l=0,s=_.values(n._tables);l<s.length;l++){var c=s[l];if(a&&this.diagramViewHostService.canShowHeaderInfo(c.nodeIndex)){var u=18;n.showExtraHeaderInfo||(u*=-1),c.position.height+=u}if(o&&c.isTableCollapsed){var f=this.diagramViewHostService.getSize(c.nodeIndex,c.isTableCollapsed,n.showKeyFieldsWhenCollapsed,n.showExtraHeaderInfo);c.position.height=f.height}}this.performFullEdgeLayout()}else r&&(this.changeSourceHistory.push("SetDiagramProperties"),this.notifyDiagramChanged(n.name))},i.prototype.tableThresholdChanged=function(t){return void 0===t&&(t=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,this.diagramManagement.updateDisplayModes(this.diagramTableThreshold,this.overrideThreshold)];case 1:return r.sent(),t&&_.forEach(this.diagramStateService.getDiagramNames(),function(o){return(0,d.__awaiter)(n,void 0,void 0,function(){return(0,d.__generator)(this,function(a){switch(a.label){case 0:return this.changeSourceHistory.push("TableThresholdChanged"),[4,this.notifyDiagramChanged(o)];case 1:return a.sent(),[2]}})})}),[2]}})})},i.prototype.moveNodes=function(t,n,r){return void 0===r&&(r=!0),(0,d.__awaiter)(this,void 0,void 0,function(){var o,a,l,s=this;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return o=this.diagramStateService.getDiagram(t),a=this.diagramManagement.getIsModelOverThreshold(this.diagramTableThreshold),!this.overrideThreshold&&a&&this.diagramStateService.defaultDiagramName===o.name?[2]:(l=this.diagramViewHostService.getHostedModel(),_.forEach(n,function(u){var f=l.tables.find(function(E){return E.name===u.tableName}),v=s.diagramManagement.findOrAddNode(t,u.tableName,f.lineageTag);if(v.position.left=u.newPosition.left,v.position.top=u.newPosition.top,u.newPosition.height||u.newPosition.width){if(-1===u.newPosition.width||-1===u.newPosition.height){var C=s.diagramViewHostService.getSize(v.nodeIndex,v.isTableCollapsed,o.showKeyFieldsWhenCollapsed,o.showExtraHeaderInfo);u.newPosition.height=u.newPosition.height&&C?C.height:v.position.height,u.newPosition.width=u.newPosition.width&&C?C.width:v.position.width}v.position.height=u.newPosition.height,v.position.width=u.newPosition.width}}),this.diagramManagement.updateDisplayMode(o.name,a,this.overrideThreshold),r&&o.calculateBoundingBox(),this.diagramStateService.markDirty(),r?[4,this.performFullEdgeLayout()]:[3,2]);case 1:return c.sent(),[3,4];case 2:return[4,this.performSubsetEdgeLayout(n.map(function(u){return u.tableName}))];case 3:c.sent(),c.label=4;case 4:return[2]}})})},i.prototype.setNodePositionsWithoutLayout=function(t,n){var r=this,o=this.diagramStateService.getDiagram(t),a=this.diagramManagement.getIsModelOverThreshold(this.diagramTableThreshold);if(this.overrideThreshold||!a||this.diagramStateService.defaultDiagramName!==o.name){var l=this.diagramViewHostService.getHostedModel();_.forEach(n,function(s){var c=l.tables.find(function(v){return v.name===s.tableName}),u=r.diagramManagement.findOrAddNode(t,s.tableName,c.lineageTag);if(u.position.left=s.newPosition.left,u.position.top=s.newPosition.top,s.newPosition.height||s.newPosition.width){if(-1===s.newPosition.width||-1===s.newPosition.height){var f=r.diagramViewHostService.getSize(u.nodeIndex,u.isTableCollapsed,o.showKeyFieldsWhenCollapsed,o.showExtraHeaderInfo);s.newPosition.height=s.newPosition.height&&f?f.height:u.position.height,s.newPosition.width=s.newPosition.width&&f?f.width:u.position.width}u.position.height=s.newPosition.height,u.position.width=s.newPosition.width}}),o.calculateBoundingBox(),this.diagramStateService.markDirty()}},i.prototype.addOrUpdateTables=function(t,n){var r=this,o=this.diagramViewHostService.getHostedModel();n.forEach(function(a){var l=o.tables.find(function(s){return s.name===a});r.diagramManagement.findOrAddNode(t,a,l.lineageTag)})},i.prototype.bringNodeToFront=function(t,n){this.diagramManagement.bringNodeToFront(t,n)&&(this.changeSourceHistory.push("BringNodeToFront"),this.notifyDiagramChanged(t))},i.prototype.setZoomValue=function(t,n){var r=this.diagramStateService.getDiagram(t);r&&r.zoomValue!==n&&(r.zoomValue=n,this.diagramStateService.markDirty(),this.changeSourceHistory.push("SetZoomValue"),this.notifyDiagramChanged(t))},i.prototype.setScrollPosition=function(t,n){var r=this.diagramStateService.getDiagram(t);r&&(r.scrollPosition.x!==n.x||r.scrollPosition.y!==n.y)&&(r.scrollPosition=n,this.diagramStateService.markDirty(),this.changeSourceHistory.push("SetScrollPosition"),this.notifyDiagramChanged(t))},i.prototype.addDiagram=function(t,n){return void 0===t&&(t=!1),void 0===n&&(n=!0),(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return r=this.diagramStateService.hasDiagrams()?this.getDiagramName():this.diagramViewHostService.getDefaultDiagramName(),o=this.getSelectedDiagram(),a=this.diagramManagement.createNewDiagram(r,this.diagramTableThreshold,this.overrideThreshold,t,n),o&&(a.pinKeyFieldsToTop=o.pinKeyFieldsToTop,a.showExtraHeaderInfo=o.showExtraHeaderInfo,a.showKeyFieldsWhenCollapsed=o.showKeyFieldsWhenCollapsed),this.diagramStateService.defaultDiagramName!==r?[3,2]:[4,this.populateDiagrams()];case 1:return l.sent(),[3,3];case 2:this.eventAggregationService.publishToClient("NewLayoutEvent",{}),l.label=3;case 3:return this.changeSourceHistory.push("AddDiagram"),this.notifyDiagramCollectionChanged(),[2,r]}})})},i.prototype.mergeSavedLayout=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return this.changeSourceHistory.push("MergeLayout"),this.diagramManagement.mergeSavedLayout(t),[4,this.populateDiagrams()];case 1:return n.sent(),[2]}})})},i.prototype.removeDiagramTables=function(t,n){this.diagramManagement.removeDiagramNodes(t,n);var r=this.diagramStateService.getDiagram(t);r.calculateBoundingBox(),this.diagramStateService.markDirty(),this.changeSourceHistory.push("RemoveDiagramTables"),this.notifyDiagramChanged(r.name)},i.prototype.resetSelectedLayout=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){switch(t.label){case 0:return this.resetTableHeights(null,!1),[4,this.performFullLayout()];case 1:return t.sent(),[2]}})})},i.prototype.populateDiagrams=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return t=this.diagramStateService.defaultDiagramName,_.forEach(this.diagramStateService.getDiagramNames(),function(o){return(0,d.__awaiter)(n,void 0,void 0,function(){return(0,d.__generator)(this,function(a){switch(a.label){case 0:return[4,this.populateDiagram(o,o===t,!1)];case 1:return[2,a.sent()]}})})}),this.diagramStateService.enableLayout(),[4,this.ensureSelectedDiagramHasLayout()];case 1:return r.sent(),this.changeSourceHistory.push("PopulateDiagrams"),this.notifyDiagramCollectionChanged(),[2]}})})},i.prototype.populateDiagram=function(t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),(0,d.__awaiter)(this,void 0,void 0,function(){var o,a,l,s;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return o=this.diagramManagement.updateDiagramForModel(t,n,this.diagramTableThreshold,this.overrideThreshold),a=this.diagramStateService.getDiagram(t),"None"!==o||r?(a.calculateBoundingBox(),this.diagramStateService.selectedDiagramName!==a.name?[3,4]:(l=this.telemetryService.startEvent(sl,{tables:a.getTableNames().length,relationships:a.getAllRelationships().length,isDefault:a.name===this.diagramStateService.defaultDiagramName}),"EdgesOnly"!==o||r?(a.name!==this.diagramStateService.defaultDiagramName&&this.diagramStateService.markDirty(),[4,this.performIncrementalNodeLayout()]):[3,2])):[3,4];case 1:case 3:return s=c.sent(),l.resolve(),[2,s];case 2:return[4,this.performFullEdgeLayout()];case 4:return(this.diagramStateService.selectedDiagramName===a.name||"None"!==o)&&(this.changeSourceHistory.push("PopulateDiagram"),this.notifyDiagramChanged(t)),[2,!1]}})})},i.prototype.ensureSelectedDiagramHasLayout=function(t){return void 0===t&&(t=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return(n=this.diagramStateService.getDiagram(null))?_.values(n._tables).findIndex(function(o){return!o.layedOut})>=0?[4,this.performIncrementalNodeLayout()]:[3,2]:[3,4];case 1:return r.sent(),[3,4];case 2:return t||n._relationships.findIndex(function(o){return!o.layedOut})>=0?[4,this.performFullEdgeLayout()]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}})})},i.prototype.addRelatedTables=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r,o,a,l,s=this;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return n=this.diagramStateService.getDiagram(null),r=this.diagramViewHostService.getHostedModel(),o=Object.keys(n._tables),a=0,l={},_.forEach(r.relationships,function(u){var f=o.find(function(z){return z===u.toTable}),v=t.find(function(z){return z===u.toTable}),C=o.find(function(z){return z===u.fromTable}),E=t.find(function(z){return z===u.fromTable});C||f||!v&&!E?v&&!C?l[u.fromTable]=!0:!f&&E&&(l[u.toTable]=!0):(l[u.fromTable]=!0,l[u.toTable]=!0)}),_.forEach(Object.keys(l),function(u){if(!(u in n._tables)){var f=r.tables.find(function(E){return E.name===u}),v=s.diagramManagement.findOrAddNode(n.name,u,f.lineageTag),C=s.diagramViewHostService.getSize(u,v.isTableCollapsed,n.showKeyFieldsWhenCollapsed,n.showExtraHeaderInfo);v.position={left:-1,top:-1,height:C.height,width:C.width},a++}}),n.calculateBoundingBox(),a>0?[4,this.performFullLayout()]:[3,2];case 1:c.sent(),c.label=2;case 2:return this.diagramStateService.markDirty(),[2]}})})},i.prototype.renameTable=function(t,n,r){return(0,d.__awaiter)(this,void 0,void 0,function(){var o,a=this;return(0,d.__generator)(this,function(l){return o=!1,_.forEach(this.diagramStateService.getDiagramNames(),function(s){a.diagramManagement.renameNode(s,t,n,r)&&(o=!0,a.changeSourceHistory.push("RenameTable"),a.notifyDiagramChanged(s))}),o&&this.diagramStateService.markDirty(),[2]})})},i.prototype.containsDiagramName=function(t){return this.diagramStateService.containsDiagramName(t)},i.prototype.getDiagramName=function(){var n,t=1;do{n=this.diagramViewHostService.getDiagramName(t++)}while(this.diagramStateService.containsDiagramName(n));return n},i.prototype.performFullLayout=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){switch(t.label){case 0:return[4,this.performLayout({nodeFull:!0},!0)];case 1:return[2,t.sent()]}})})},i.prototype.performSubsetEdgeLayout=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return[4,this.performLayout(rl(t),!0)];case 1:return[2,n.sent()]}})})},i.prototype.performFullEdgeLayout=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){switch(t.label){case 0:return[4,this.performLayout({edgeFull:!0},!0)];case 1:return[2,t.sent()]}})})},i.prototype.performIncrementalNodeLayout=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){switch(t.label){case 0:return[4,this.performLayout({nodeIncremental:!0},!0)];case 1:return[2,t.sent()]}})})},i.prototype.performLayout=function(t,n){return void 0===n&&(n=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return this.diagramManagement.getIsModelOverThreshold(this.diagramTableThreshold)&&!this.overrideThreshold&&this.getSelectedDiagram().name===this.defaultDiagramName?[2,!1]:(r=this.diagramStateService.getDiagram(null),[4,this.layoutHostService.performLayout(r,t)]);case 1:return(o=l.sent())?((a=r.applyLayout(o,!!t.edgeIncremental||!!t.nodeIncremental||!!t.nodeFull))&&n&&(this.changeSourceHistory.push("PerformLayout"),this.notifyDiagramChanged(r.name)),[2,a]):[2,!1]}})})},i.prototype.getUniqueName=function(t,n){return ae.getUniqueName(t,n)},i.prototype.overrideTableThreshold=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){switch(t.label){case 0:return this.overrideThreshold=!0,this.tableThresholdChanged(!0),[4,this.populateDiagram(this.defaultDiagramName,!0,!1)];case 1:return t.sent(),[2]}})})},i.prototype.logAndClearChangeSourceHistory=function(){for(var t=new Map,n=0,r=this.changeSourceHistory;n<r.length;n++){var a=t.get(o=r[n]);a||t.set(o,0),t.set(o,(a||0)+1)}for(var l={},s=0,c=Array.from(t.keys());s<c.length;s++){var o,u=t.get(o=c[s]);l[o]=u}this.telemetryService.logEvent(cl,{changeSourceCount:JSON.stringify(l)}),this.changeSourceHistory=[]},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(qi),e.\u0275\u0275inject(Cl),e.\u0275\u0275inject(Mt.y0),e.\u0275\u0275inject(Dn.$),e.\u0275\u0275inject(il),e.\u0275\u0275inject(Xr),e.\u0275\u0275inject(dl.R),e.\u0275\u0275inject(w.x))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Sl=function(){function i(t){this.diagramService=t}return i.prototype.getHandlers=function(t){var n=this;return[[Qr.AddRelatedTables,{enabled:function(){return n.isEditableDiagram()&&(!t||!n.containsAllTables(t))},executeMany:function(o){return n.diagramService.addRelatedTables(o.map(function(a){return a.name}))}}]]},i.prototype.isEditableDiagram=function(){var t,n;return(null===(t=this.diagram)||void 0===t?void 0:t.name)!==this.diagramService.defaultDiagramName&&!(null!==(n=this.diagram)&&void 0!==n&&n.tablesLocked)},Object.defineProperty(i.prototype,"diagram",{get:function(){return this.diagramService.getSelectedDiagram()},enumerable:!1,configurable:!0}),i.prototype.containsAllTables=function(t){return this.diagram.getTableNames().length===t.model.tables.length},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Zn))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Jn=function(i){return i.ExpandAllCards="ExpandAllCards",i.CollapseAllCards="CollapseAllCards",i}({}),xl=function(){function i(t){this.diagramService=t}return i.prototype.getHandlers=function(){var t=this,n=this.diagramService.getSelectedDiagram()?this.diagramService.getSelectedDiagram().getTableNames():[];return[[Jn.ExpandAllCards,{executeMany:function(o){return t.diagramService.setTablesCollapsed(n,!1)}}],[Jn.CollapseAllCards,{executeMany:function(o){return t.diagramService.setTablesCollapsed(n,!0)}}]]},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Zn))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),er=p(84130),oo=p(35702),Zt=p(83633),Pl=function(){function i(t,n,r,o){this.diagramService=t,this.selectionService=n,this.schemaChangeService=r,this.dialogService=o}return i.prototype.newDiagramTab=function(){this.diagramService.addDiagram()},i.prototype.deleteDiagramTab=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(o){switch(o.label){case 0:return t?[3,2]:[4,this.dialogService.openDeleteLayoutConfirmDialog(n)];case 1:1===o.sent()&&this.diagramService.deleteDiagram(n),o.label=2;case 2:return[2]}})})},i.prototype.toggleObjectsIsHidden=function(t){var n=Array.from(this.selectionService.selection),r=[],o=!t;n.forEach(function(a){var l=a;l.hasIsHidden()&&r.push({object:l,newValue:o})}),r.length&&this.schemaChangeService.setIsHidden(r)},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Zn),e.\u0275\u0275inject(er.z),e.\u0275\u0275inject(oo.G),e.\u0275\u0275inject(Zt.e))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ao=function(i){return i.RemoveTablesFromDiagram="RemoveTablesFromDiagram",i}({}),El=function(){function i(t,n){this.diagramService=t,this.selectionService=n}return i.prototype.getHandlers=function(t){var n=this;return this.isEditableDiagram()?[[ao.RemoveTablesFromDiagram,{enabled:function(){return n.canRemoveTable(t)},executeMany:function(o){return n.removeTablesFromDiagram(o)}}]]:[]},i.prototype.isEditableDiagram=function(){var t,n;return(null===(t=this.diagram)||void 0===t?void 0:t.name)!==this.diagramService.defaultDiagramName&&!(null!==(n=this.diagram)&&void 0!==n&&n.tablesLocked)},Object.defineProperty(i.prototype,"diagram",{get:function(){return this.diagramService.getSelectedDiagram()},enumerable:!1,configurable:!0}),i.prototype.canRemoveTable=function(t){var n=this;return _.findIndex([t],function(r){return n.diagram.hasTable(r.name)})>=0},i.prototype.removeTablesFromDiagram=function(t){this.selectionService.clear(),this.diagramService.removeDiagramTables(this.diagram.name,t.map(function(n){return n.name}))},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(Zn),e.\u0275\u0275inject(er.z))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Dl=p(34145),Tl=p(9738),an=[Sl,El,xl,Pl,{provide:Dl.q,useExisting:Oe.b},{provide:Tl.W6,useExisting:er.z}],gn=p(55375);function Il(i,t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return n=i.get("Skip"),r=i.get("RelationshipValidationTitle"),[4,gn.Z.buildOKCancelDialog({title:r,message:i.get("RelationshipValidatingIsTakingLongLabel"),additionalMessages:[i.get("RelationshipValidatingLabel")]},"Skip Relationship Validation",t,i,n,i.get("Cancel_ButtonText"))];case 1:return[2,a.sent()]}})})}function Rl(i,t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return n=i.get("Confirm"),r=i.get("RelationshipConfirmSaveTitle"),[4,gn.Z.buildOKCancelDialog({title:r,message:i.get("RelationshipConfirmSaveMessage")},"Confirm Save Relationship",t,i,n,i.get("Cancel_ButtonText"))];case 1:return[2,a.sent()]}})})}var Sn=p(58938),qn=p(24326),Al=p(10965),Jt=p(20551),ei=p(64716),ti=p(85721),Mn=p(45769),Fl=p(23873),Tt=function(){function i(t){this.localization=t}return i.prototype.transform=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t?this.localization.format(t,n):""},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o,16))},i.\u0275pipe=e.\u0275\u0275definePipe({name:"translate",type:i,pure:!0}),i}();function kl(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-grid",2),e.\u0275\u0275listener("selectionChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a?l.columnSelectionChange.emit(a):null)}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("no-grid-data",0===r.rows.length),e.\u0275\u0275property("columns",r.columns)("rows",r.rows)("rowHeaders",!1)("allowExpandSelection",!1)("enforceSelectingColumn",!0)("isReadOnly",!0)("nextSelectionInput",r.selectedColumn)}}function Bl(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275element(1,"tri-svg-icon",4),e.\u0275\u0275elementStart(2,"p",5),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,1,"Preview_Table_Unavailable")))}var Ll=function(){function i(){this.columnSelectionChange=new e.EventEmitter}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["table-columns-data-grid"]],inputs:{columns:"columns",rows:"rows",selectedColumn:"selectedColumn"},outputs:{columnSelectionChange:"columnSelectionChange"},decls:2,vars:2,consts:[[3,"no-grid-data","columns","rows","rowHeaders","allowExpandSelection","enforceSelectingColumn","isReadOnly","nextSelectionInput","selectionChange",4,"ngIf"],["class","preview-table-unavailable-message",4,"ngIf"],[3,"columns","rows","rowHeaders","allowExpandSelection","enforceSelectingColumn","isReadOnly","nextSelectionInput","selectionChange"],[1,"preview-table-unavailable-message"],["tri-svg-icon-48","","name","table_unavailable_48_regular","sprite","modeling-icons",1,"table-svg-icon"],[1,"tri-caption1","empty-grid-message"]],template:function(n,r){1&n&&(e.\u0275\u0275template(0,kl,1,9,"tri-grid",0),e.\u0275\u0275template(1,Bl,5,3,"div",1)),2&n&&(e.\u0275\u0275property("ngIf",r.columns),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===r.rows.length))},dependencies:[ie.NgIf,Fl.o,Vt.M,Tt],styles:["[_nghost-%COMP%]   tri-grid[_ngcontent-%COMP%]{height:105px;max-width:637px}[_nghost-%COMP%]   tri-grid[_ngcontent-%COMP%]     .table{padding:0}[_nghost-%COMP%]   tri-grid.no-grid-data[_ngcontent-%COMP%]{height:126px}[_nghost-%COMP%]   tri-grid.no-grid-data[_ngcontent-%COMP%]     .headers{overflow-x:auto;height:126px}[_nghost-%COMP%]   tri-grid.no-grid-data[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport{display:none}[_nghost-%COMP%]     ::-webkit-scrollbar{height:8px!important}[_nghost-%COMP%]     ::-webkit-scrollbar-thumb{border:2px solid transparent!important;background-clip:content-box}.preview-table-unavailable-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;top:-80px;position:relative;pointer-events:none}.preview-table-unavailable-message[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.preview-table-unavailable-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;pointer-events:all}.empty-grid-message[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1)}"]}),i}();function Nl(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",36)(1,"p"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("selectionStyle","single"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.text)}}function Vl(i,t){1&i&&e.\u0275\u0275elementContainer(0)}function Ul(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",36)(1,"p"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("selectionStyle","single"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.text)}}function zl(i,t){1&i&&e.\u0275\u0275elementContainer(0)}var jl=function(t,n,r,o){return{columns:t,rows:n,displayEmptyGrid:!0,selectedColumn:r,columnSource:o}},Wl=function(t,n,r,o,a){return{columns:t,rows:n,displayEmptyGrid:r,selectedColumn:o,columnSource:a}};function Hl(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",26)(2,"div",27)(3,"label",28),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",29),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementStart(8,"tri-dropdown",30),e.\u0275\u0275listener("valueChange",function(v){e.\u0275\u0275restoreView(n);var C=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(C.propertyStore.updateFromTable(v.text))}),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementStart(10,"tri-dropdown-trigger")(11,"p"),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,Nl,3,3,"tri-dropdown-item",31),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(16,Vl,1,0,"ng-container",32),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",33)(19,"div",27)(20,"label",34),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"div",29),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementStart(25,"tri-dropdown",35),e.\u0275\u0275listener("valueChange",function(v){e.\u0275\u0275restoreView(n);var C=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(C.propertyStore.updateToTable(v.text))}),e.\u0275\u0275pipe(26,"async"),e.\u0275\u0275pipe(27,"async"),e.\u0275\u0275elementStart(28,"tri-dropdown-trigger")(29,"p"),e.\u0275\u0275text(30),e.\u0275\u0275pipe(31,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(32,Ul,3,3,"tri-dropdown-item",31),e.\u0275\u0275pipe(33,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(34,zl,1,0,"ng-container",32),e.\u0275\u0275pipe(35,"async"),e.\u0275\u0275pipe(36,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var l,s,c,u,r=e.\u0275\u0275nextContext(),o=e.\u0275\u0275reference(53),a=e.\u0275\u0275reference(55);e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,17,"From_Table_Dropdown_Label")),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(7,19,"Relationship_Dialog_Change_Table_Tooltip")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",e.\u0275\u0275pipeBind1(9,21,r.selectedFromTableDropdownOption$))("options",r.triDropdownConfigOptions),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(null==(l=e.\u0275\u0275pipeBind1(13,23,r.selectedFromTableDropdownOption$))?null:l.text),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(15,25,r.fromTableDropdownOptions$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",(null==(s=e.\u0275\u0275pipeBind1(17,27,r.fromColumnsDataTable$))?null:s.length)>0?o:a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction4(45,jl,r.fromColumnsDataTable$,r.fromRows$,r.selectedFromColumn$,r.fromTableColumn)),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(22,29,"To_Table_Dropdown_Label")),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(24,31,"Relationship_Dialog_Change_Table_Tooltip")),e.\u0275\u0275advance(2),e.\u0275\u0275property("isDisabled",!e.\u0275\u0275pipeBind1(26,33,r.selectedFromTableDropdownOption$))("value",e.\u0275\u0275pipeBind1(27,35,r.selectedToTableDropdownOption$))("options",r.triDropdownConfigOptions),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==(c=e.\u0275\u0275pipeBind1(31,37,r.selectedToTableDropdownOption$))?null:c.text),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(33,39,r.toTableDropdownOptions$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",(null==(u=e.\u0275\u0275pipeBind1(35,41,r.toColumnsDataTable$))?null:u.length)>0?o:a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction5(50,Wl,r.toColumnsDataTable$,r.toRows$,!!e.\u0275\u0275pipeBind1(36,43,r.selectedFromTableDropdownOption$),r.selectedToColumn$,r.toTableColumn))}}function Gl(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",26)(1,"div",10)(2,"label",37),e.\u0275\u0275text(3,"Table 1"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",29),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementStart(6,"select",38)(7,"option",39),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(10,"label",40),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementStart(13,"span"),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(16,"div",10)(17,"label",41),e.\u0275\u0275text(18,"Table 2"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"div",29),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementStart(21,"select",42)(22,"option",39),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(25,"label",43),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementStart(28,"span"),e.\u0275\u0275text(29),e.\u0275\u0275pipe(30,"async"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(31,"div",5)(32,"span",44),e.\u0275\u0275text(33),e.\u0275\u0275pipe(34,"translate"),e.\u0275\u0275elementEnd()()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(5,9,"Relationship_Dialog_Change_Table_Tooltip")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(9,11,n.propertyStore.fromTable$)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(12,13,"Column"),":"),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(15,15,n.propertyStore.fromColumn$),""),e.\u0275\u0275advance(5),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(20,17,"Relationship_Dialog_Change_Table_Tooltip")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(24,19,n.propertyStore.toTable$)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(27,21,"Column"),":"),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(30,23,n.propertyStore.toColumn$),""),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(34,25,"Define_Cardinality_And_Crossfilterdirection"))}}function Kl(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",36)(1,"p"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("selectionStyle","single"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.text)}}function $l(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",45)(2,"tri-dropdown",46),e.\u0275\u0275listener("valueChange",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.propertyStore.updateCardinality(l.data))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementStart(5,"tri-dropdown-trigger")(6,"p"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(9,Kl,3,3,"tri-dropdown-item",31),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&i){var o,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("isDisabled",e.\u0275\u0275pipeBind1(3,5,r.disableCardinalityDropDown$))("value",e.\u0275\u0275pipeBind1(4,7,r.selectedCardinalityDropdownOption$))("options",r.triDropdownConfigOptions),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==(o=e.\u0275\u0275pipeBind1(8,9,r.selectedCardinalityDropdownOption$))?null:o.text),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(10,11,r.cardinalityDropdownOptions$))}}function Ql(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"option",49),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("ngValue",n.value),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue,"")}}function Xl(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"select",47),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.propertyStore.updateCardinality(a))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Ql,2,2,"option",48),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngModel",e.\u0275\u0275pipeBind1(1,3,r.propertyStore.cardinality$))("disabled",e.\u0275\u0275pipeBind1(2,5,r.disableCardinalityDropDown$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(4,7,r.dataStore.cardinalityOptions$))}}function Yl(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",36)(1,"p"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("selectionStyle","single"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.text)}}function Zl(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",45)(2,"tri-dropdown",50),e.\u0275\u0275listener("valueChange",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.propertyStore.updateCrossFilterDirection(l.data))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementStart(5,"tri-dropdown-trigger")(6,"p"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(9,Yl,3,3,"tri-dropdown-item",31),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&i){var o,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("isDisabled",e.\u0275\u0275pipeBind1(3,5,r.disableCrossFilterBehaviorDropDown$))("value",e.\u0275\u0275pipeBind1(4,7,r.selectedCrossFilterDropdownOption$))("options",r.triDropdownConfigOptions),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==(o=e.\u0275\u0275pipeBind1(8,9,r.selectedCrossFilterDropdownOption$))?null:o.text),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(10,11,r.crossFilterDropdownOptions$))}}function Jl(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"option",53),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("ngValue",n.value),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue,"")}}function ql(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"select",51),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.propertyStore.updateCrossFilterDirection(a))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Jl,2,2,"option",52),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngModel",e.\u0275\u0275pipeBind1(1,3,r.propertyStore.crossFilterBehavior$))("disabled",e.\u0275\u0275pipeBind1(2,5,r.disableCrossFilterBehaviorDropDown$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(4,7,r.dataStore.crossFilterOptions$))}}function es(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-checkbox",54),e.\u0275\u0275listener("onChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.updateSecurityFilterBehavior(a))}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(1,3,"Security_Filter_Direction"))("disabled",e.\u0275\u0275pipeBind1(2,5,r.disableSecurityFilterCheckBox$))("checked",e.\u0275\u0275pipeBind1(3,7,r.isSecurityBehaviorChecked$))}}function ts(i,t){1&i&&(e.\u0275\u0275elementStart(0,"tri-link",55),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("\xa0",e.\u0275\u0275pipeBind1(2,1,"Generic_LearnMore"),""))}function ns(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",56)(1,"pbi-spinner",57)(2,"span",58),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()()()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,1,n.propertyStore.validationText$))}}function is(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-message-bar",59),e.\u0275\u0275listener("hideMessageBar",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.resetWarningMessage())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",e.\u0275\u0275pipeBind1(1,1,r.messageBarModel$))}}function rs(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"table-columns-data-grid",60),e.\u0275\u0275listener("columnSelectionChange",function(s){var u=e.\u0275\u0275restoreView(n).columnSource,f=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(f.updateRelationshipFromToColumns(s,u))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=t.columns,o=t.rows,a=t.selectedColumn;e.\u0275\u0275classProp("preview-unavailable",0===e.\u0275\u0275pipeBind1(1,5,o).length),e.\u0275\u0275property("columns",e.\u0275\u0275pipeBind1(2,7,r))("rows",e.\u0275\u0275pipeBind1(3,9,o))("selectedColumn",e.\u0275\u0275pipeBind1(4,11,a))}}var os=function(t){return{"display-empty-grid-label":t}};function as(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",61)(1,"div",62),e.\u0275\u0275element(2,"tri-svg-icon",63),e.\u0275\u0275elementStart(3,"p",64),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()()),2&i&&(e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(4,os,t.displayEmptyGrid)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,2,"Select_Table_To_Preview")))}var ls=function(t){return{new:t}},lo=function(){function i(t,n,r,o,a,l,s,c,u){var f=this;this.propertyStore=t,this.dataStore=n,this.relationshipEditService=r,this.relPropertyDataFactory=o,this.localizationService=a,this.featureSwitchService=l,this.dialogService=s,this.telemetryService=c,this.templateDialogPayload=u,this.fromTableColumn="fromTableColumn",this.toTableColumn="toTableColumn",this.hasRelationshipAlreadyExisted$=this.propertyStore.warningMessageType$.pipe((0,Me.U)(function(v){return"RelationshipAlreadyExistedError"===v})),this.isSecurityBehaviorChecked$=this.propertyStore.securityFilteringBehavior$.pipe((0,Me.U)(function(v){return v===V.Lv.BothDirections})),this.displayWarningMessaged$=(0,Et.aj)([this.propertyStore.warningMessage$,this.propertyStore.hasCommitedChangeInProgress$]).pipe((0,Me.U)(function(v){return v[0]&&!v[1]})),this.showSpinner$=(0,Et.aj)([this.propertyStore.hasCommitedChangeInProgress$,this.propertyStore.hasValidationInProgress$]).pipe((0,Me.U)(function(v){return v[0]||v[1]})),this.disableOkButton$=(0,Et.aj)([this.propertyStore.hasCommitedChangeInProgress$.pipe((0,Me.U)(function(v){return!!v})),this.propertyStore.cardinality$.pipe((0,Me.U)(function(v){return typeof v>"u"})),this.propertyStore.crossFilterBehavior$.pipe((0,Me.U)(function(v){return typeof v>"u"})),this.propertyStore.warningMessageType$.pipe((0,Me.U)(function(v){return f.hasValidationError(v)}))]).pipe((0,Me.U)(function(v){return v[0]||v[1]||v[2]||v[3]})),this.messageBarModel$=(0,Et.aj)([this.propertyStore.warningMessage$,this.propertyStore.warningMessageType$,this.propertyStore.warningLink$]).pipe((0,Me.U)(function(v){var C=v[0],z=v[2];return{bannerType:f.hasValidationError(v[1])?1:2,message:C,allowDismiss:!1,link:z,linkDisplayName:f.localizationService.get("LearnMore"),linkAriaLabel:f.localizationService.get("LearnMore")}})),this.disableCardinalityDropDown$=(0,Et.aj)([this.propertyStore.fromToColumnProperties$.pipe((0,Me.U)(function(v){return!!(v.fromTableName&&v.fromColumnName&&v.toTableName&&v.toColumnName)})),this.propertyStore.hasCommitedChangeInProgress$,this.hasRelationshipAlreadyExisted$]).pipe((0,Me.U)(function(v){return!v[0]||!!v[1]||!!v[2]})),this.disableCrossFilterBehaviorDropDown$=(0,Et.aj)([this.propertyStore.hasCommitedChangeInProgress$,this.propertyStore.cardinality$,this.hasRelationshipAlreadyExisted$]).pipe((0,Me.U)(function(v){return!!v[0]||typeof v[1]>"u"||!!v[2]})),this.disableIsActiveCheckBox$=(0,Et.aj)([this.propertyStore.hasCommitedChangeInProgress$,this.propertyStore.cardinality$,this.propertyStore.crossFilterBehavior$,this.hasRelationshipAlreadyExisted$]).pipe((0,Me.U)(function(v){return!!v[0]||typeof v[1]>"u"||typeof v[2]>"u"||!!v[3]})),this.disableSecurityFilterCheckBox$=(0,Et.aj)([this.propertyStore.hasCommitedChangeInProgress$,this.dataStore.canEnableSecurityFilteringBehavior$,this.propertyStore.cardinality$,this.propertyStore.crossFilterBehavior$,this.hasRelationshipAlreadyExisted$]).pipe((0,Me.U)(function(v){return!!v[0]||!v[1]||typeof v[2]>"u"||typeof v[3]>"u"||!!v[4]})),this.disableReferentialIntegrityCheckBox$=(0,Et.aj)([this.propertyStore.hasCommitedChangeInProgress$,this.dataStore.canSupportReferentialIntegrity$,this.propertyStore.cardinality$,this.propertyStore.crossFilterBehavior$,this.hasRelationshipAlreadyExisted$]).pipe((0,Me.U)(function(v){return!!v[0]||!v[1]||typeof v[2]>"u"||typeof v[3]>"u"||!!v[4]})),this.selectedFromTableDropdownOption$=this.propertyStore.fromTable$.pipe((0,Bt.w)(function(v){return f.fromTableDropdownOptions$.pipe((0,Me.U)(function(C){return C?.find(function(E){return E.text===v})}))})),this.selectedToTableDropdownOption$=this.propertyStore.toTable$.pipe((0,Bt.w)(function(v){return f.toTableDropdownOptions$.pipe((0,Me.U)(function(C){return C?.find(function(E){return E.text===v})}))})),this.selectedCardinalityDropdownOption$=this.propertyStore.cardinality$.pipe((0,Bt.w)(function(v){return f.cardinalityDropdownOptions$.pipe((0,Me.U)(function(C){return C?.find(function(E){return E.data===v})}))})),this.selectedCrossFilterDropdownOption$=this.propertyStore.crossFilterBehavior$.pipe((0,Bt.w)(function(v){return f.crossFilterDropdownOptions$.pipe((0,Me.U)(function(C){return C?.find(function(E){return E.data===v})}))})),this.selectedFromColumn$=this.propertyStore.fromColumn$.pipe((0,Bt.w)(function(v){return f.dataStore.fromColumns$.pipe((0,Me.U)(function(C){return f.getTargetColumnRangeSelection(v,C)}))})),this.selectedToColumn$=this.propertyStore.toColumn$.pipe((0,Bt.w)(function(v){return f.dataStore.toColumns$.pipe((0,Me.U)(function(C){return f.getTargetColumnRangeSelection(v,C)}))})),this.fromRows$=this.dataStore.fromTableData$.pipe((0,Me.U)(function(v){var C=[];if(!v)return[];for(var E=0,z=v.rows;E<z.length;E++){for(var le=[],fe=0,we=z[E].cells;fe<we.length;fe++)le.push(we[fe].value);C.push(le)}return C})),this.toRows$=this.dataStore.toTableData$.pipe((0,Me.U)(function(v){var C=[];if(!v)return[];for(var E=0,z=v.rows;E<z.length;E++){for(var le=[],fe=0,we=z[E].cells;fe<we.length;fe++)le.push(we[fe].value);C.push(le)}return C})),this.toColumnsDataTable$=this.dataStore.toColumns$.pipe((0,Me.U)(function(v){return v?.map(function(C){return{name:C,type:"Text",width:96}})})),this.fromColumnsDataTable$=this.dataStore.fromColumns$.pipe((0,Me.U)(function(v){return v?.map(function(C){return{name:C,type:"Text",width:96}})})),this.toTableDropdownOptions$=this.dataStore.toTableOptions$.pipe((0,Me.U)(function(v){return v?.map(function(C,E){return{key:E,text:C}})})),this.fromTableDropdownOptions$=this.dataStore.fromTableOptions$.pipe((0,Me.U)(function(v){return v?.map(function(C,E){return{key:E,text:C}})})),this.cardinalityDropdownOptions$=this.dataStore.cardinalityOptions$.pipe((0,Me.U)(function(v){return v?.map(function(C){return{key:C.displayValue,text:C.displayValue,data:C.value}})})),this.crossFilterDropdownOptions$=this.dataStore.crossFilterOptions$.pipe((0,Me.U)(function(v){return v?.map(function(C){return{key:C.displayValue,text:C.displayValue,data:C.value}})})),this.triDropdownConfigOptions={dropdownWidth:320,dropdownMaxWidth:320},this.destroy$=new ka.t(1)}return i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},i.prototype.ngOnInit=function(){var t=this;this.propertyStore.hasValidationInProgress$.pipe((0,qe.R)(this.destroy$),(0,st.h)(function(n){return!n})).subscribe(function(n){t.skipValidationDialogRef&&t.skipValidationDialogRef.close(2)}),this.initialRelationshipName=this.templateDialogPayload.input.relationshipName,this.propertyStore.setRelationshipState((0,d.__assign)({},this.convertToRelationshipProperties(this.templateDialogPayload.input))),this.templateDialogPayload.onCancelButtonClick=function(){return(0,d.__awaiter)(t,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return[2,this.cancel()]})})},this.templateDialogPayload.onOkButtonClick=function(){return(0,d.__awaiter)(t,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return[2,this.ok()]})})},this.disableOkButton$.pipe((0,qe.R)(this.destroy$)).subscribe(function(n){t.templateDialogPayload.setOkButtonState(n)})},i.prototype.cancel=function(){return Promise.resolve({backToManageRelationshipDialog:this.navigateBackToManageRelationshipDialogAfterClose})},i.prototype.ok=function(){var n,t=this;return null===(n=this.commitChangeSubscription)||void 0===n||n.unsubscribe(),this.propertyStore.hasValidationInProgress$.pipe((0,nt.q)(1),(0,st.h)(function(r){return!r&&t.featureSwitchService.featureSwitches.relationshipValidation}),(0,Me.U)(function(r){return t.propertyStore.validateRelationship()})).subscribe(function(r){}),"number"==typeof this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(function(){return t.trySkipValidation()},1e3),this.commitChangeSubscription=(0,wr.T)(this.propertyStore.isValidationSucceed$,this.openConfirmCommitDialog()).pipe((0,qe.R)(this.destroy$),(0,qe.R)(this.propertyStore.warningMessageType$.pipe((0,st.h)(function(r){return"CardinalityOneValidationError"===r||"ReferentialIntegrityValidationError"===r||"RelationshipAlreadyExistedError"===r||"PFE_XL_USERELATIONSHIP_AMBIGUOUS_PATH"===r}))),(0,st.h)(function(r){return r||!t.featureSwitchService.featureSwitches.relationshipValidation}),(0,nt.q)(1)).subscribe(function(){return(0,d.__awaiter)(t,void 0,void 0,function(){return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,this.commiteRelationshipChange()];case 1:return[2,r.sent()]}})})}),!1},i.prototype.commiteRelationshipChange=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n,r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:this.propertyStore.updateHasCommitedChangeInProgress(!0,this.localizationService.get("Validating_Text")),this.resetWarningMessage(),t=!1,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.commitChange()];case 2:return o.sent(),[3,4];case 3:return n=o.sent(),r=Gn.r.getErrorMessageFromApiObject(n),this.propertyStore.updateWarningMessage(r,Yi(n),void 0),t=!0,[3,4];case 4:return this.propertyStore.updateHasCommitedChangeInProgress(!1,void 0),t||(clearTimeout(this.timeoutID),this.templateDialogPayload.closeDialogFromConsumer({backToManageRelationshipDialog:this.navigateBackToManageRelationshipDialogAfterClose})),[2]}})})},i.prototype.openConfirmCommitDialog=function(){var t=this;return this.propertyStore.warningMessageType$.pipe((0,qe.R)(this.destroy$),(0,st.h)(function(n){return"ExecuteDataQueriesFailed"===n||"Unknown"===n}),(0,nt.q)(1),(0,Bt.w)(function(n){return(0,d.__awaiter)(t,void 0,void 0,function(){var r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return r=this,[4,Rl(this.localizationService,this.dialogService)];case 1:return r.confirmCommitDialogRef=o.sent(),[2,this.confirmCommitDialogRef.afterClosed().toPromise()]}})})}),(0,Me.U)(function(n){var r;return 1!==n&&(null===(r=t.commitChangeSubscription)||void 0===r||r.unsubscribe()),1===n}))},i.prototype.trySkipValidation=function(){var t=this;this.propertyStore.hasValidationInProgress$.pipe((0,nt.q)(1),(0,st.h)(function(n){return n&&t.featureSwitchService.featureSwitches.relationshipValidation&&!t.skipValidationDialogRef}),(0,Bt.w)(function(n){return(0,d.__awaiter)(t,void 0,void 0,function(){var r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return r=this,[4,Il(this.localizationService,this.dialogService)];case 1:return r.skipValidationDialogRef=o.sent(),this.askToSkipRelationshipValidationTelemetryEvent=this.telemetryService.startEvent(La,{location:"Dialog"}),[2,this.skipValidationDialogRef.afterClosed().toPromise()]}})})}),(0,Hn.b)(function(n){var r;return 1===n?(t.propertyStore.cancelConstructRelTask(),t.propertyStore.cancelValidateRelTask(),null===(r=t.commitChangeSubscription)||void 0===r||r.unsubscribe(),t.askToSkipRelationshipValidationTelemetryEvent.event.info.skipValidation=!0,t.askToSkipRelationshipValidationTelemetryEvent.resolve(),t.skipValidationDialogRef=null,t.commiteRelationshipChange()):(t.askToSkipRelationshipValidationTelemetryEvent.resolve(),t.skipValidationDialogRef=null,(0,bn.of)(void 0))}),(0,qe.R)(this.destroy$)).subscribe(function(n){})},i.prototype.updateRelationshipFromToColumns=function(t,n){var r=this,o=t.start.column;(0,Et.aj)([this.dataStore.fromColumns$,this.dataStore.toColumns$]).pipe((0,nt.q)(1),(0,Me.U)(function(a){var l=a[0],s=a[1];return"fromTableColumn"===n?(l.length<=o&&(0,xr._)(function(){return new Error("can not find fromColumn from fromTable's columns")}),l[o]):"toTableColumn"===n?(s.length<=o&&(0,xr._)(function(){return new Error("can not find fromColumn from fromTable's columns")}),s[o]):void 0})).subscribe(function(a){"fromTableColumn"===n?r.propertyStore.updateFromColumnName(a):"toTableColumn"===n&&r.propertyStore.updateToColumnName(a)},function(a){throw a})},i.prototype.commitChange=function(){var t=this;return this.propertyStore.relationshipProperties$.pipe((0,nt.q)(1),(0,Hn.b)(function(n){var r=n;n.crossFilteringBehavior===V.jE.OneDirectionReversed&&n.cardinality===V.KA.ManyToMany&&(r=(0,d.__assign)((0,d.__assign)({},n),ji(n)));var o=!!r.isActive,a=Gi(r.crossFilteringBehavior),l={fromColumnName:r.fromColumnName,fromTableName:r.fromTableName,toColumnName:r.toColumnName,toTableName:r.toTableName,fromCardinality:Wi(r.cardinality),toCardinality:Hi(r.cardinality),crossFilteringBehavior:a,isActive:o,referentialIntegrity:!!r.referentialIntegrity,securityFilteringBehavior:Ki(t.relPropertyDataFactory.canSupportRLS(r.fromTableName,r.toTableName),r.securityFilteringBehavior,a,o)};return t.relationshipEditService.commitChanges(t.initialRelationshipName,l,!1)})).toPromise()},i.prototype.resetWarningMessage=function(){this.propertyStore.updateWarningMessage(void 0,void 0,void 0)},i.prototype.updateSecurityFilterBehavior=function(t){this.propertyStore.updateSecurityFilteringBehavior(t?V.Lv.BothDirections:V.Lv.OneDirection)},i.prototype.getTargetColumnRangeSelection=function(t,n){if(t){var r=n.findIndex(function(o){return o===t});if(!(r<0))return{start:{row:-1,column:r},end:{row:-1,column:r}}}},i.prototype.convertToRelationshipProperties=function(t){return{fromTableName:t.fromTable,fromColumnName:t.fromColumn,toTableName:t.toTable,toColumnName:t.toColumn,isActive:typeof t.isActive<"u"?t.isActive:void 0,securityFilteringBehavior:typeof t.securityFilteringBehavior<"u"?zi(t.securityFilteringBehavior):void 0,crossFilteringBehavior:typeof t.crossFilterDirection<"u"?Vi(t.crossFilterDirection):void 0,referentialIntegrity:typeof t.referentialIntegrity<"u"?t.referentialIntegrity:void 0,cardinality:this.getCardinality(t)}},i.prototype.getCardinality=function(t){return typeof t.fromCardinality<"u"&&typeof t.toCardinality<"u"?Ui(t.fromCardinality,t.toCardinality):void 0},i.prototype.hasValidationError=function(t){return"CardinalityOneValidationError"===t||"ReferentialIntegrityValidationError"===t||"PFE_XL_USERELATIONSHIP_AMBIGUOUS_PATH"===t||"RelationshipAlreadyExistedError"===t},Object.defineProperty(i.prototype,"navigateBackToManageRelationshipDialogAfterClose",{get:function(){return this.templateDialogPayload.input.backToManageRelationshipDialogAfterClose&&this.propertyStore.enableNewManageRelationshipDialog},enumerable:!1,configurable:!0}),i.dialogNameKey="CreateOrEditRelationshipComponent",i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Xi),e.\u0275\u0275directiveInject($r),e.\u0275\u0275directiveInject(Qi),e.\u0275\u0275directiveInject(on),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(Ot.vZ),e.\u0275\u0275directiveInject(Sn.x),e.\u0275\u0275directiveInject(Mt.y0),e.\u0275\u0275directiveInject(at.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["create-or-edit-relationship"]],features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)((0,d.__spreadArray)([],an,!0),[on,un.H,jr,Hr,Wr,Qi,Xi,$r,Kr,at.x],!1))],decls:56,vars:54,consts:[[3,"ngClass"],["role","dialog",1,"dialog"],["Name","create_or_edit_relationship_dialog","aria-labelledby","dialog_body","aria-describedby","relationshipSummary",1,"dialog-content"],["id","dialog_body",1,"dialog-body"],[1,"cr-body-container"],[1,"cr-details-container"],["id","relationshipSummary"],[4,"ngIf","ngIfElse"],["oldPreviewTable",""],[1,"cr-row"],[1,"cr-row-block"],["id","cardinality-label","for","cardinality",1,"cr-label"],["legacyCardinalityDropdown",""],["id","crossFilter-label","for","crossfilterdirection",1,"cr-label"],["legacyCrossFilterDropdown",""],[1,"cr-row","cr-settings"],[1,"cr-row-block","cr-checkbox-div"],["ngDefaultControl","",1,"cr-checkbox","isActive",3,"label","checked","disabled","onChange"],["class","cr-checkbox securityFilter","ngDefaultControl","",3,"label","disabled","checked","onChange",4,"ngIf"],["ngDefaultControl","",1,"cr-checkbox","referentialIntegrity",3,"label","disabled","checked","onChange"],["href","https://go.microsoft.com/fwlink/?LinkId=746269","external","true","target","_blank",4,"ngIf"],["aria-live","polite",1,"cr-errors-warning-section"],["class","validating-spinner",4,"ngIf"],[3,"viewModel","hideMessageBar",4,"ngIf"],["tableColumnGrid",""],["emptyGrid",""],[1,"cr-row","cr-tables"],[1,"table-dropdown-container"],["id","from-table-dropdown-label","for","fromTableInput",1,"cr-label"],["pbiTooltipShowDelay","1000",1,"dropdown-div",3,"pbiTooltip"],["compact","","aria-labelledby","from-table-dropdown-label","data-testid","fromTableDropdown",1,"table-tri-dropdown",3,"value","options","valueChange"],[3,"value","selectionStyle",4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"new","cr-row","cr-tables"],["id","to-table-dropdown-label","for","toTableInput",1,"cr-label"],["compact","","aria-labelledby","to-table-dropdown-label","data-testid","toTableDropdown",1,"table-tri-dropdown",3,"isDisabled","value","options","valueChange"],[3,"value","selectionStyle"],["for","fromTableInput",1,"cr-label"],["autofocus","","id","fromTableInput","name","fromtableInput","disabled","",1,"table-dropdown","cr-dropdown"],[1,"table-option"],["id","fromColumnLabel",1,"cr-label"],["for","toTableInput",1,"cr-label"],["autofocus","","id","toTableInput","name","totableInput","disabled","",1,"table-dropdown","cr-dropdown"],["id","toColumnLabel",1,"cr-label"],["id","cardinalitySummary"],["pbiTooltipShowDelay","1000",1,"dropdown-div"],["compact","","aria-labelledby","cardinality-label","data-testid","cardinalityDropdown",1,"relationship-properties-tri-dropdown",3,"isDisabled","value","options","valueChange"],["autofocus","","id","cardinality","name","cardinality",1,"cardinality-dropdown","cr-dropdown",3,"ngModel","disabled","ngModelChange"],["class","cardinality-option",3,"ngValue",4,"ngFor","ngForOf"],[1,"cardinality-option",3,"ngValue"],["compact","","aria-labelledby","crossFilter-label",1,"relationship-properties-tri-dropdown",3,"isDisabled","value","options","valueChange"],["autofocus","","id","crossfilterdirection","name","crossfilterdirection",1,"crossfilterdirection-dropdown","cr-dropdown",3,"ngModel","disabled","ngModelChange"],["class","cross-filter-option",3,"ngValue",4,"ngFor","ngForOf"],[1,"cross-filter-option",3,"ngValue"],["ngDefaultControl","",1,"cr-checkbox","securityFilter",3,"label","disabled","checked","onChange"],["href","https://go.microsoft.com/fwlink/?LinkId=746269","external","true","target","_blank"],[1,"validating-spinner"],["data-testid","dialog-validating-spinner",1,"pbi-spinner-medium","pbi-spinner-inline-layout","pbi-spinner-immediate-message"],[1,"validating-text"],[3,"viewModel","hideMessageBar"],[3,"columns","rows","selectedColumn","columnSelectionChange"],[1,"empty-grid-container",3,"ngClass"],[1,"empty-grid-label"],["tri-svg-icon-48","","name","table_32_regular",1,"table-svg-icon"],[1,"tri-caption1","empty-grid-message"]],template:function(n,r){if(1&n&&(e.\u0275\u0275elementStart(0,"template-dialog",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(9,Hl,37,56,"ng-container",7),e.\u0275\u0275template(10,Gl,35,27,"ng-template",null,8,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(12,"div")(13,"div",9)(14,"div",10)(15,"label",11),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(18,$l,11,13,"ng-container",7),e.\u0275\u0275template(19,Xl,5,9,"ng-template",null,12,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",10)(22,"label",13),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(25,Zl,11,13,"ng-container",7),e.\u0275\u0275template(26,ql,5,9,"ng-template",null,14,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"div",15)(29,"div",16)(30,"tri-checkbox",17),e.\u0275\u0275listener("onChange",function(c){return r.propertyStore.updateIsActive(c)}),e.\u0275\u0275pipe(31,"translate"),e.\u0275\u0275pipe(32,"async"),e.\u0275\u0275pipe(33,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(34,"div",16),e.\u0275\u0275template(35,es,4,9,"tri-checkbox",18),e.\u0275\u0275pipe(36,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"div",16)(38,"tri-checkbox",19),e.\u0275\u0275listener("onChange",function(c){return r.propertyStore.updateReferentialIntegrity(c)}),e.\u0275\u0275pipe(39,"async"),e.\u0275\u0275pipe(40,"translate"),e.\u0275\u0275pipe(41,"translate"),e.\u0275\u0275pipe(42,"async"),e.\u0275\u0275pipe(43,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(44,ts,3,3,"tri-link",20),e.\u0275\u0275pipe(45,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(46,"div",21),e.\u0275\u0275template(47,ns,5,3,"div",22),e.\u0275\u0275pipe(48,"async"),e.\u0275\u0275template(49,is,2,3,"tri-message-bar",23),e.\u0275\u0275pipe(50,"async"),e.\u0275\u0275pipe(51,"async"),e.\u0275\u0275elementEnd()()()()()()(),e.\u0275\u0275template(52,rs,5,13,"ng-template",null,24,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(54,as,6,6,"ng-template",null,25,e.\u0275\u0275templateRefExtractor)),2&n){var o=e.\u0275\u0275reference(11),a=e.\u0275\u0275reference(20),l=e.\u0275\u0275reference(27);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(52,ls,r.propertyStore.enableNewManageRelationshipDialog)),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(8,20,"Select_Related_Tables_And_Colmns")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.propertyStore.enableNewManageRelationshipDialog)("ngIfElse",o),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(17,22,"Cardinality")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.propertyStore.enableNewManageRelationshipDialog)("ngIfElse",a),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(24,24,"Cross_Filter_Direction")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.propertyStore.enableNewManageRelationshipDialog)("ngIfElse",l),e.\u0275\u0275advance(5),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(31,26,"Make_Relationship_Active"))("checked",e.\u0275\u0275pipeBind1(32,28,r.propertyStore.isActive$))("disabled",e.\u0275\u0275pipeBind1(33,30,r.disableIsActiveCheckBox$)),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(36,32,r.dataStore.canSupportSecurityFilteringBehavior$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(39,34,r.disableReferentialIntegrityCheckBox$)?e.\u0275\u0275pipeBind1(40,36,"Assume_Referential_Integrity"):e.\u0275\u0275pipeBind1(41,38,"Assume_Referential_Integrity_Sentence"))("disabled",e.\u0275\u0275pipeBind1(42,40,r.disableReferentialIntegrityCheckBox$))("checked",e.\u0275\u0275pipeBind1(43,42,r.propertyStore.referentialIntegrity$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(45,44,r.disableReferentialIntegrityCheckBox$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(48,46,r.showSpinner$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(50,48,r.showSpinner$)&&e.\u0275\u0275pipeBind1(51,50,r.displayWarningMessaged$))}},dependencies:[ye.YN,ye.Kr,ye.Fj,ye.EJ,ye.JJ,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,ie.NgTemplateOutlet,Nt.J,qn.k,kt.V,Al.r,Jt.M3,ei.l,ti.q,Jt.ii,Mn.h,Vt.M,Sr.v,Ll,Tt,ie.AsyncPipe,ft.F],styles:[".modern-dialogCloseIcon[_ngcontent-%COMP%]{background-color:var(--white-color);color:var(--gray-130);cursor:pointer;display:block;margin-left:auto;height:28px;width:28px}.modern-dialogCloseIcon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:8px}.modern-dialogCloseIcon[_ngcontent-%COMP%]:hover{background-color:var(--neutral-lighter-color)}.dragHandle[_ngcontent-%COMP%]{height:24px;left:0;position:absolute;top:0;width:100%;width:calc(100% - 28px)}.close-button[_ngcontent-%COMP%]{font-size:12px;padding:8px}.dialog[_ngcontent-%COMP%]{width:727px;display:flex;flex-direction:column;box-sizing:border-box}.cr-title-container[_ngcontent-%COMP%]{display:flex;padding-bottom:10px;width:100%;font-size:20px;font-weight:600}.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0}.cr-details-container[_ngcontent-%COMP%]{display:block;padding:5px 5px 15px 0}.cr-body-container[_ngcontent-%COMP%]{display:block;font-size:14px;overflow-y:auto;width:100%}.cr-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;overflow:hidden}.cr-row.cr-tables[_ngcontent-%COMP%]{margin-bottom:30px}.cr-row.cr-settings[_ngcontent-%COMP%]{flex-wrap:wrap}.cr-row-block[_ngcontent-%COMP%]{display:block}.cr-row-block[_ngcontent-%COMP%]   .cr-dropdown[_ngcontent-%COMP%]{width:296px;height:32px;font-size:14px;margin-bottom:10px;color:#484644;border:1px solid var(--gray-110);border-radius:2px}.cr-row-block[_ngcontent-%COMP%]   .cr-dropdown[_ngcontent-%COMP%]:disabled{background-color:var(--gray-20);border:1px solid var(--gray-60);color:var(--gray-90)}.cr-row-block.cr-checkbox-div[_ngcontent-%COMP%]{width:296px;padding:10px 0 0 10px;box-sizing:border-box}.cardinality-dropdown[_ngcontent-%COMP%], .crossfilterdirection-dropdown[_ngcontent-%COMP%]{margin-bottom:15px}.cr-label[_ngcontent-%COMP%]{display:block;padding:0 0 5px;font-weight:600}.cr-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.cr-errors-warning-section[_ngcontent-%COMP%]{height:64px;margin-bottom:18px;margin-top:8px;font-size:12px;color:var(--gray-180)}.cr-errors-warning-section[_ngcontent-%COMP%]   .validating-spinner[_ngcontent-%COMP%]{padding-top:25px}.break-line[_ngcontent-%COMP%]{height:1px;margin:0 -24px;color:var(--gray-30);opacity:20%}.dialog-footer[_ngcontent-%COMP%]{display:flex;margin:auto 0;position:relative;height:auto}.dialog-footer[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%]{margin:auto 0 auto auto}.dialog-footer[_ngcontent-%COMP%]   .primary[_ngcontent-%COMP%]{margin-left:12px;background-color:var(--theme-primary-color);border-color:var(--theme-primary-color);color:var(--button-primary-content-color)}.dialog-footer[_ngcontent-%COMP%]   .primary[_ngcontent-%COMP%]:disabled{background-color:var(--gray-90);border-color:inherit}.cr-button[_ngcontent-%COMP%]{margin-left:8px;min-width:60px;padding:6px 16px;font-weight:600;border-radius:2px;border:1px solid var(--gray-110);background-color:var(--white-color);color:var(--gray-180)}.cr-button[_ngcontent-%COMP%]:focus{outline:1px solid}[_nghost-%COMP%]     .pbi-dialog{border:none}[_nghost-%COMP%]     .pbi-dialog-header{min-height:unset!important}[_nghost-%COMP%]     .popout-button.compact{padding-bottom:0!important}[_nghost-%COMP%]     .tri-dropdown-trigger-container{margin-bottom:4px}.relationship-properties-tri-dropdown[_ngcontent-%COMP%]{width:311px}.table-tri-dropdown[_ngcontent-%COMP%]{width:320px}.table-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForegroundDisabled)}tri-dropdown-item[_ngcontent-%COMP%]{font-size:14px}tri-dropdown-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}table-columns-data-grid[_ngcontent-%COMP%]{height:105px;max-width:638px;width:100%;width:-moz-available;width:-webkit-fill-available;width:fill-available;border:1px solid var(--colorNeutralStroke1);border-radius:4px;overflow:hidden}table-columns-data-grid.preview-unavailable[_ngcontent-%COMP%]{height:126px;border-color:var(--colorNeutralStroke3)}.new[_ngcontent-%COMP%]   .dialog[_ngcontent-%COMP%]{max-width:638px;width:100%}.new[_ngcontent-%COMP%]   .cr-body-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.new[_ngcontent-%COMP%]   .cr-details-container[_ngcontent-%COMP%]{padding:5px 5px 0 0}.new[_ngcontent-%COMP%]   .cr-row.cr-settings[_ngcontent-%COMP%]{padding-top:8px}.new[_ngcontent-%COMP%]   .cr-checkbox-div[_ngcontent-%COMP%]{padding:0;margin-left:-5px;width:316px}.new[_ngcontent-%COMP%]   .cr-checkbox-div[_ngcontent-%COMP%]   .referentialIntegrity[_ngcontent-%COMP%]{display:inline-block}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:15px;margin-bottom:0}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]   .table-dropdown-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:4px}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]   .table-dropdown-container[_ngcontent-%COMP%]   .cr-label[_ngcontent-%COMP%]{display:flex;width:320px;flex-direction:column;align-items:flex-start;gap:4px;line-height:20px;padding:0}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]   .table-dropdown-container[_ngcontent-%COMP%]   .dropdown-div[_ngcontent-%COMP%]{display:flex;width:320px;height:24px;justify-content:center;align-items:center}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]   .empty-grid-container[_ngcontent-%COMP%]{display:flex;padding:16px 232px;flex-direction:column;justify-content:space-between;align-items:flex-start;border-radius:4px;border:1px solid var(--colorNeutralStroke3)}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]   .empty-grid-container[_ngcontent-%COMP%]   .empty-grid-label[_ngcontent-%COMP%]{visibility:hidden;display:flex;flex-direction:column;align-items:center}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]   .empty-grid-container[_ngcontent-%COMP%]   .empty-grid-message[_ngcontent-%COMP%]{margin:0;color:var(--colorNeutralForeground1)}.new[_ngcontent-%COMP%]   .cr-row.cr-tables[_ngcontent-%COMP%]   .empty-grid-container.display-empty-grid-label[_ngcontent-%COMP%]   .empty-grid-label[_ngcontent-%COMP%]{visibility:visible}"]}),i}(),_t=p(13529),so="PBI.EX.CustomDateTableOpenDialog",co=(Se.cx[so]=(0,Se.b1)(so),"PBI.EX.CustomDateTableCommit"),uo=(Se.cx[co]=(0,Se.b1)(co),"PBI.EX.DateTableOpenDialog"),ss=Se.cx[uo]=(0,Se.b1)(uo),po="PBI.EX.DateTableCommit",cs=Se.cx[po]=(0,Se.b1)(po),go="PBI.ManageRelationshipsEditRelationshipEventName",ho=Se.cx[go]=(0,Se.b1)(go),mo="PBI.ManageRelationshipsDeleteRelationshipsEventName",fo=Se.cx[mo]=(0,Se.b1)(mo),vo="PBI.ManageRelationshipsToggleRelationshipActiveEventName",ds=Se.cx[vo]=(0,Se.b1)(vo),_o="PBI.ManageRelationshipsFilterRelationshipsEventName",us=Se.cx[_o]=(0,Se.b1)(_o),bo="PBI.ManageRelationshipsNewRelationshipEventName",ps=Se.cx[bo]=(0,Se.b1)(bo),yo="PBI.ManageRelationshipsAutodetectRelationshipsEventName",gs=Se.cx[yo]=(0,Se.b1)(yo),ni="PBI.CustomCalendars.Save",Co="PBI.CustomCalendars.Delete",vs=p(11275),_s=p(68246),bt=p(59968),tr=p(76688);function bs(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",6)(1,"span",7),e.\u0275\u0275element(2,"i",8),e.\u0275\u0275elementStart(3,"span",9),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"button",10),e.\u0275\u0275listener("triMenuButtonClick",function(l){var c=e.\u0275\u0275restoreView(n).$implicit,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.onMoreActionsMenuItemClicked(l,c.name))}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275element(7,"i",11),e.\u0275\u0275elementEnd()()}if(2&i){var r=t.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(r.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("triMenu",o.getMenuItems(r)),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,3,"Options_Menu"))}}var ys=function(){function i(t){this.localizationService=t,this.addNewCalendar=new e.EventEmitter,this.editCalendar=new e.EventEmitter,this.deleteCalendar=new e.EventEmitter,this.calendarMenuItemsMap=new Map}return i.prototype.ngOnChanges=function(t){var n=this;t.calendars&&(this.calendarMenuItemsMap.clear(),this.calendars.forEach(function(r){var o={items:[{id:"edit",type:Ht.fz.Button,text:n.localizationService.get("Edit"),tooltip:n.localizationService.get("Edit"),disabled:!r.capabilities.canEdit},{id:"delete",type:Ht.fz.Button,text:n.localizationService.get("Delete"),tooltip:n.localizationService.get("Delete"),disabled:!r.capabilities.canDelete}]};n.calendarMenuItemsMap.set(r.name,o)}))},i.prototype.getMenuItems=function(t){return this.calendarMenuItemsMap.get(t.name)},i.prototype.onAddNewCalendar=function(){this.addNewCalendar.emit()},i.prototype.onEditCalendar=function(t){this.editCalendar.emit(t)},i.prototype.onDeleteCalendar=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return this.deleteCalendar.emit(t),[2]})})},i.prototype.onMoreActionsMenuItemClicked=function(t,n){switch(t.id){case"edit":this.onEditCalendar(n);break;case"delete":this.onDeleteCalendar(n)}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["manage-calendars"]],inputs:{calendars:"calendars"},outputs:{addNewCalendar:"addNewCalendar",editCalendar:"editCalendar",deleteCalendar:"deleteCalendar"},features:[e.\u0275\u0275NgOnChangesFeature],decls:6,vars:1,consts:[[1,"manage-calendars"],[1,"calendars-list"],["class","calendar-item",4,"ngFor","ngForOf"],[1,"add-new-calendar-btn",3,"click"],[1,"glyphicon","glyph-small","pbi-glyph-add","add-new-calendar-icon"],["localize","CalendarOptions_NewCalendar"],[1,"calendar-item"],[1,"calendar"],[1,"glyphicon","glyph-small","pbi-glyph-calendar","calendar-icon"],[1,"calendar-name"],["tri-button","",1,"more-actions-btn",3,"triMenu","triMenuButtonClick"],[1,"glyphicon","glyph-small","pbi-glyph-more"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"section",0)(1,"ul",1),e.\u0275\u0275template(2,bs,8,5,"li",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",3),e.\u0275\u0275listener("click",function(){return r.onAddNewCalendar()}),e.\u0275\u0275element(4,"i",4)(5,"span",5),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.calendars))},dependencies:[ie.NgForOf,bt.X,tr.rX,ft.F],styles:[".manage-calendars[_ngcontent-%COMP%]{font-size:14px;line-height:20px;margin-top:12px;display:flex;flex-direction:column}.manage-calendars[_ngcontent-%COMP%]   ul.calendars-list[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0;max-height:280px;overflow-y:scroll}.manage-calendars[_ngcontent-%COMP%]   ul.calendars-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:44px;display:flex}.manage-calendars[_ngcontent-%COMP%]   ul.calendars-list[_ngcontent-%COMP%]   li.calendar-item[_ngcontent-%COMP%]{border-bottom:1px solid var(--neutral-lighter-color)}.manage-calendars[_ngcontent-%COMP%]   ul.calendars-list[_ngcontent-%COMP%]   li.calendar-item[_ngcontent-%COMP%]   .calendar[_ngcontent-%COMP%]{display:flex;align-items:center;width:90%}.manage-calendars[_ngcontent-%COMP%]   ul.calendars-list[_ngcontent-%COMP%]   li.calendar-item[_ngcontent-%COMP%]   .calendar[_ngcontent-%COMP%]   .calendar-icon[_ngcontent-%COMP%]{padding:0 16px 0 12px}.manage-calendars[_ngcontent-%COMP%]   ul.calendars-list[_ngcontent-%COMP%]   li.calendar-item[_ngcontent-%COMP%]   .more-actions-btn[_ngcontent-%COMP%]{border:none;background-color:transparent}.manage-calendars[_ngcontent-%COMP%]   .add-new-calendar-btn[_ngcontent-%COMP%]{height:44px;border:none;background-color:transparent;padding-left:0;display:flex;align-items:center}.manage-calendars[_ngcontent-%COMP%]   .add-new-calendar-btn[_ngcontent-%COMP%]   .add-new-calendar-icon[_ngcontent-%COMP%]{padding:0 16px 0 12px}.manage-calendars[_ngcontent-%COMP%]   .add-new-calendar-btn[_ngcontent-%COMP%]:hover{background-color:var(--button-default-hover-fill-color)}"],changeDetection:0}),i}(),ii=p(29746),nr=p(75334),Cs=p(24829),So=p(89237),Ss=["trigger"],Ms=["triFilterOverlay"];function ws(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275listener("click",function(){var c=e.\u0275\u0275restoreView(n).$implicit,u=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(u.onSelect(c))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&i){var r=t.$implicit,o=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",o.disabled)("hidden",!a.isfilteredItem(r)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.name," ")}}var xs=function(t){return{"first-item-group":t}},Ps=function(t){return{"hidden-group-name":t}};function Os(i,t){if(1&i&&(e.\u0275\u0275elementContainerStart(0,2),e.\u0275\u0275elementStart(1,"div",3)(2,"div",4),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,ws,2,3,"div",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var n=t.$implicit,r=t.index;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(4,xs,0===r)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(6,Ps,!n.groupName)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.groupName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.items)}}var Es=function(){function i(t){this.itemSelectorData=t,this.itemGroups=this.itemSelectorData.itemGroups}return i.prototype.ngOnInit=function(){this.filteredItems=this.itemGroups},i.prototype.onSelect=function(t){this.itemSelectorData.onItemSelect(t)},i.prototype.onKey=function(t){this.filteredItems=this.itemGroups.map(function(n){return{groupName:n.groupName,disabled:n.disabled,items:n.items.filter(function(r){return r.name.includes(t.toLocaleLowerCase())})}})},i.prototype.isfilteredItem=function(t){var n;return null===(n=this.filteredItems)||void 0===n?void 0:n.some(function(r){return r.items.map(function(o){return o.name}).includes(t.name)})},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(ii.yM))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["item-selector"]],viewQuery:function(n,r){if(1&n&&(e.\u0275\u0275viewQuery(Ss,5,e.ElementRef),e.\u0275\u0275viewQuery(Ms,5)),2&n){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.menuTrigger=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.triFilterOverlay=o.first)}},decls:5,vars:7,consts:[["role","textbox",1,"item-search-box",3,"placeholderText","value"],["class","items-groups-container",4,"ngFor","ngForOf"],[1,"items-groups-container"],[1,"item-group",3,"ngClass"],[1,"item-group-name",3,"ngClass"],["triMenuItem","","class","item-group-item",3,"disabled","hidden","click",4,"ngFor","ngForOf"],["triMenuItem","",1,"item-group-item",3,"disabled","hidden","click"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"tri-menu-other")(1,"tri-search-box",0),e.\u0275\u0275listener("value",function(a){return r.onKey(a)}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Os,5,8,"ng-container",1),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("placeholderText",e.\u0275\u0275pipeBind1(3,5,"SearchBox_Text")),e.\u0275\u0275attribute("aria-placeholder",e.\u0275\u0275pipeBind1(2,3,"SearchBox_Text")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.filteredItems))},dependencies:[ie.NgClass,ie.NgForOf,Cs.r,tr.Wm,So.U,ft.F],styles:[".cdk-overlay-pane tri-menu-other{overflow-y:scroll}  .cdk-overlay-pane tri-menu-other .item-search-box{width:256px;margin:4px;padding:6px}  .cdk-overlay-pane tri-menu-other .item-group{width:100%;display:flex;flex-direction:column}  .cdk-overlay-pane tri-menu-other .item-group:not(.first-item-group){border-top:solid 1px var(--globalColorGrey92)}  .cdk-overlay-pane tri-menu-other .item-group .item-group-name{height:32px;margin-left:6px;display:flex;flex-wrap:wrap;align-content:center;font-family:Segoe UI;font-size:14px;font-weight:400;line-height:20px}  .cdk-overlay-pane tri-menu-other .item-group .item-group-name.hidden-group-name{display:none}  .cdk-overlay-pane tri-menu-other .item-group .item-group-item{margin:0 10px}"],changeDetection:0}),i}(),ri=p(55490);function Ds(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",7)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("selectionStyle",o.multipleSelection?"multiple":"single")("disabled",r.disabled)("hidden",!o.isfilteredItem(n))("value",n),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.name)}}var Ts=function(t){return{"first-item-group":t}},Is=function(t){return{"no-item-group-name":t}};function Rs(i,t){if(1&i&&(e.\u0275\u0275elementContainerStart(0,3),e.\u0275\u0275elementStart(1,"div",4)(2,"div",5),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Ds,3,5,"tri-dropdown-item",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var n=t.$implicit,r=t.index;e.\u0275\u0275advance(1),e.\u0275\u0275property("triTooltip",n.groupTooltip)("ngClass",e.\u0275\u0275pureFunction1(5,Ts,0===r)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(7,Is,!n.groupName)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.groupName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.items)}}var As=function(){return{showFullContent:!0,disableDefaultFocus:!0}},Fs=function(){function i(){this.valueChange=new e.EventEmitter}return i.prototype.ngOnInit=function(){var t=this;this.currentItemGroups=this.itemGroups,this.filteredItems=this.currentItemGroups,this.selectedItems$=new Gt.X([]),_.isEmpty(this.initialSelectedItems)||this.selectedItems$.next(this.initialSelectedItems),this.selectedValues$=this.selectedItems$.pipe((0,Me.U)(function(n){return _.isEmpty(n)?t.inputDefaultValue:n.map(function(r){return r.name}).toString()}))},i.prototype.onSelect=function(t){var n=this.multipleSelection?t:[t];this.selectedItems$.next(n),this.valueChange.emit(n)},i.prototype.onKey=function(t){var n=_.cloneDeep(this.currentItemGroups);this.filteredItems=_.map(n,function(r){return r.items=_.filter(r.items,function(o){return o.name.toLocaleLowerCase().includes(t.toLocaleLowerCase())}),r})},i.prototype.onDropdownOpen=function(){var t=this;this.disabled||(this.currentItemGroups=this.itemGroups,setTimeout(function(){var n=document.querySelector(".dropdown-listbox-panel tri-search-box input");n&&(n.focus(),n.value="",t.onKey("")),Array.from(document.querySelectorAll(".dropdown-listbox-panel input")).forEach(function(r){r.setAttribute("tabIndex","-1")})},0))},i.prototype.isfilteredItem=function(t){return _.some(this.filteredItems,function(n){return _.includes(n.items.map(function(r){return r.name}),t.name)})},i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["dropdown-listbox"]],inputs:{itemGroups:"itemGroups",multipleSelection:"multipleSelection",disabled:"disabled",inputDefaultValue:"inputDefaultValue",initialSelectedItems:"initialSelectedItems"},outputs:{valueChange:"valueChange"},decls:10,vars:17,consts:[[1,"dropdown-listbox-container",3,"options","multiple","isDisabled","value","valueChange","click"],["role","textbox",1,"search-box-in-list",3,"placeholderText","value"],["class","tri-dropdown-item-container",4,"ngFor","ngForOf"],[1,"tri-dropdown-item-container"],[1,"item-group",3,"triTooltip","ngClass"],[1,"dropdown-item-group-name",3,"ngClass"],["class","dropdown-item",3,"selectionStyle","disabled","hidden","value",4,"ngFor","ngForOf"],[1,"dropdown-item",3,"selectionStyle","disabled","hidden","value"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"tri-dropdown",0),e.\u0275\u0275listener("valueChange",function(a){return r.onSelect(a)})("click",function(){return r.onDropdownOpen()}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"tri-dropdown-trigger"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div")(6,"tri-search-box",1),e.\u0275\u0275listener("value",function(a){return r.onKey(a)}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,Rs,5,9,"ng-container",2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275property("options",e.\u0275\u0275pureFunction0(16,As))("multiple",r.multipleSelection)("isDisabled",r.disabled)("value",e.\u0275\u0275pipeBind1(1,8,r.selectedItems$)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,10,r.selectedValues$)," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("placeholderText",e.\u0275\u0275pipeBind1(8,14,"SearchBox_Text")),e.\u0275\u0275attribute("aria-placeholder",e.\u0275\u0275pipeBind1(7,12,"SearchBox_Text")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.currentItemGroups))},dependencies:[ie.NgClass,ie.NgForOf,Jt.M3,ei.l,ti.q,Jt.ii,ri.Z,So.U,ie.AsyncPipe,ft.F],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   tri-dropdown[_ngcontent-%COMP%]{width:100%}  tri-dropdown-overlay tri-search-box.search-box-in-list{width:100%}  tri-dropdown-overlay .item-group:not(.first-item-group){border-top:solid 1px var(--globalColorGrey92)}  tri-dropdown-overlay .dropdown-item-group-name{font-weight:600;font-size:12px;height:32px;text-indent:4px;display:flex;align-items:center}  tri-dropdown-overlay .dropdown-item-group-name.no-item-group-name{display:none}"],changeDetection:0}),i}(),ks=["trigger"];function Bs(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"dropdown-listbox",34),e.\u0275\u0275listener("valueChange",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext().$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onPrimaryColumnChange(l,s))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!o.enableAddTimeUnit)("inputDefaultValue",e.\u0275\u0275pipeBind1(1,5,"CalendarOptions_PrimaryColumn_Input_DefaultValue"))("initialSelectedItems",o.getSelectedPrimaryColumn(r))("multipleSelection",!1)("itemGroups",o.getPrimaryColumn(r))}}function Ls(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var o,n=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(null!==(o=r.getSelectedPrimaryColumnName(n))&&void 0!==o?o:"\u2014")}}function Ns(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"dropdown-listbox",34),e.\u0275\u0275listener("valueChange",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext().$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onAssociatedColumnsChange(l,s))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",o.isAssocliatedColumnsDisabled(r))("inputDefaultValue",e.\u0275\u0275pipeBind1(1,5,"CalendarOptions_AssociatedColumns_Input_DefaultValue"))("initialSelectedItems",o.getSelectedAssociateColumns(r))("multipleSelection",!0)("itemGroups",o.getAssociatedColumns(r))}}function Vs(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var o,n=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(null!==(o=r.getSelectedAssociateColumnNames(n))&&void 0!==o?o:"\u2014")}}var Us=function(t){return{"time-unit-year":t}};function zs(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tr",23),e.\u0275\u0275listener("click",function(){var s=e.\u0275\u0275restoreView(n).$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.editTimeUnit(s))}),e.\u0275\u0275elementStart(1,"td",24),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td",25),e.\u0275\u0275template(4,Bs,2,7,"dropdown-listbox",26),e.\u0275\u0275template(5,Ls,2,1,"div",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"td",28),e.\u0275\u0275template(7,Ns,2,7,"dropdown-listbox",26),e.\u0275\u0275template(8,Vs,2,1,"div",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"td",29)(10,"button",30),e.\u0275\u0275listener("click",function(){var s=e.\u0275\u0275restoreView(n).$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.editTimeUnit(s))}),e.\u0275\u0275element(11,"tri-svg-icon",31),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"button",32),e.\u0275\u0275listener("click",function(){var s=e.\u0275\u0275restoreView(n).$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.deleteTimeUnit(s))}),e.\u0275\u0275element(13,"tri-svg-icon",33),e.\u0275\u0275elementEnd()()()}if(2&i){var r=t.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(6,Us,"Year"===r)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(o.timeUnitNameMap.get(r)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r===o.editingTimeUnit),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r!==o.editingTimeUnit),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r===o.editingTimeUnit),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r!==o.editingTimeUnit)}}var js=function(t){return{"invalid-calendar-name":t}},Ws=function(t){return{"hide-message":t}},Hs=function(){function i(t,n,r,o){this.localizationService=t,this.buildCalendarService=n,this.dataModelService=r,this.triOverlay=o,this.setOkButtonState=new e.EventEmitter,this.timeUnitNameMap=new Map([["Year",this.localizationService.get("TimeUnit_Year")],["Quarter",this.localizationService.get("TimeUnit_Quarter")],["Month",this.localizationService.get("TimeUnit_Month")],["Week",this.localizationService.get("TimeUnit_Week")],["Date",this.localizationService.get("Date")]])}return i.prototype.ngOnInit=function(){var t=this;switch(this.model=this.dataModelService.getDataModel(),this.tableColumns=_.filter(this.tableEntity.columns,function(a){return(0,Qe.rh)(a)}),this.buildCalendarService.originalCalendarName=this.editingCalendarName,this.timeUnitColumnsMap=new Map,this.buildCalendarService.timeUnitColumnsMap=this.timeUnitColumnsMap,this.availableTimeUnits=new Set(this.timeUnitNameMap.keys()),this.usedTimeUnits=new Set,this.timeUnitItemGroups=[],this.dialogState){case _t.Q.CreateCalendar:this.validCalendarName=!0,this.originalTimeUnitColumnsMap=_.cloneDeep(this.timeUnitColumnsMap),this.addEditTimeUnit("Year");break;case _t.Q.EditCalendar:this.calendarName=this.editingCalendarName;var r=this.tableEntity.calendars.find(function(a){return a.name===t.calendarName}).timeUnitColumnAssociations;0===r.length?this.addEditTimeUnit("Year"):r.forEach(function(a){var l=a.timeUnit,s=a.primaryColumn.name,c=_.map(a.associatedColumns,function(u){return u.name});t.timeUnitColumnsMap.set(l,{timeUnit:l,primaryColumnName:s,associatedColumnNames:c}),t.addEditTimeUnit(l)}),this.originalTimeUnitColumnsMap=_.cloneDeep(this.timeUnitColumnsMap),this.buildCalendarService.calendarName=this.editingCalendarName,this.calendarNameExisted=!1;var o=nr.cm.validateName(this.model,this.localizationService,"Calendar",this.tableEntity.name,this.calendarName,this.editingCalendarName,this.tableEntity.schemaName);this.validCalendarName=_.isEmpty(this.calendarName)||!o.hasError,this.enableAddTimeUnit=!o.hasError,this.setOkState()}this.timeUnitItemGroups.push({groupName:void 0,items:this.getSortedTimeUnits(this.availableTimeUnits).map(function(a){return{value:a,name:t.timeUnitNameMap.get(a)}})}),this.timeUnitItemGroups.push({groupName:this.localizationService.format("CalendarOptions_UnavailableColumns",this.usedTimeUnits.size),disabled:!0,items:this.getSortedTimeUnits(this.usedTimeUnits).map(function(a){return{value:a,name:t.timeUnitNameMap.get(a)}})})},i.prototype.changeCalendarName=function(){var t=nr.cm.validateName(this.model,this.localizationService,"Calendar",this.tableEntity.name,this.calendarName,this.editingCalendarName,this.tableEntity.schemaName);this.validCalendarName=_.isEmpty(this.calendarName)||!t.hasError,this.enableAddTimeUnit=!t.hasError,this.calendarNameExisted=t.error===nr.jr.DuplicatedName,this.buildCalendarService.calendarName=this.calendarName,this.setOkState()},i.prototype.isAvailableTimeUnit=function(t){return this.availableTimeUnits.has(t)},i.prototype.addTimeUnit=function(t){this.addEditTimeUnit(t),this.updateTimeUnitItemGroups(),this.setOkState()},i.prototype.getPrimaryColumn=function(t){for(var n=[],r=[],o=0,a=this.tableColumns;o<a.length;o++){var l=a[o];!this.isValidPrimaryColumnDataType(l.dataType)||this.isUsedColumn(l.name,t,!0)?r.push({name:l.name}):n.push({name:l.name})}var s=[];return s.push({items:n}),s.push({groupName:this.localizationService.format("CalendarOptions_UnavailableColumns",r.length),disabled:!0,items:r}),s},i.prototype.getSelectedPrimaryColumn=function(t){var n=this.timeUnitColumnsMap.get(t);return n?[{name:n.primaryColumnName}]:[]},i.prototype.getSelectedPrimaryColumnName=function(t){var n;return null===(n=this.timeUnitColumnsMap.get(t))||void 0===n?void 0:n.primaryColumnName},i.prototype.onPrimaryColumnChange=function(t,n){I.fF.assert(function(){return 1===t.length},"ManageCalendarComponent onPrimaryColumnChange has only one primary column");var r=t[0],o=this.timeUnitColumnsMap.get(n);o?(o.primaryColumnName=r.name,this.timeUnitColumnsMap.set(n,o)):o={timeUnit:n,primaryColumnName:r.name,associatedColumnNames:void 0},this.timeUnitColumnsMap.set(n,o),this.setOkState()},i.prototype.getAssociatedColumns=function(t){for(var n=[],r=[],o=0,a=this.tableColumns;o<a.length;o++){var l=a[o];"Text"!==l.dataType||this.isUsedColumn(l.name,t,!1)?r.push({name:l.name}):n.push({name:l.name})}var s=[];return s.push({items:n}),s.push({groupName:this.localizationService.format("CalendarOptions_UnavailableColumns",r.length),disabled:!0,items:r}),s},i.prototype.getSelectedAssociateColumns=function(t){var n,r,o=this.timeUnitColumnsMap.get(t);return null!==(r=null===(n=o?.associatedColumnNames)||void 0===n?void 0:n.map(function(a){return{name:a}}))&&void 0!==r?r:[]},i.prototype.getSelectedAssociateColumnNames=function(t){var n,r=null===(n=this.timeUnitColumnsMap.get(t))||void 0===n?void 0:n.associatedColumnNames;return _.isEmpty(r)?void 0:r.toString()},i.prototype.onAssociatedColumnsChange=function(t,n){var r=this.timeUnitColumnsMap.get(n);I.fF.assertValue(r,"primary column should be set before associated columns"),r.associatedColumnNames=t.map(function(o){return o.name}),this.timeUnitColumnsMap.set(n,r),this.setOkState()},i.prototype.isAssocliatedColumnsDisabled=function(t){var n;return!this.validCalendarName||!(null!==(n=this.timeUnitColumnsMap.get(t))&&void 0!==n&&n.primaryColumnName)},i.prototype.associatedColumnsTooltip=function(t){return this.isAssocliatedColumnsDisabled(t)?this.localizationService.get("CalendarOptions_AssociatedColumns_Input_Tooltip"):void 0},i.prototype.editTimeUnit=function(t){this.editingTimeUnit=t},i.prototype.deleteTimeUnit=function(t){this.timeUnitColumnsMap.delete(t),this.usedTimeUnits.delete(t),this.availableTimeUnits.add(t),this.updateTimeUnitItemGroups(),this.setOkState()},i.prototype.getSortedTimeUnits=function(t){return["Year","Quarter","Month","Week","Date"].filter(function(o){return t.has(o)})},i.prototype.openAddTimeUnitOverlay=function(){var t=this,n=this.triOverlay.position().flexibleConnectedTo(this.menuTrigger).withPositions([(0,ii.Oq)()]).withPush(!1).withGrowAfterOpen(!0);this.triOverlay.open({component:Es,data:{itemGroups:this.timeUnitItemGroups,onItemSelect:function(o){t.addTimeUnit(o.value),t.triOverlay.closeAll()}},options:{positionStrategy:n,hasBackdrop:!0,disposeOnNavigation:!0,backdropClass:ii.Eh,scrollStrategy:this.triOverlay.scrollStrategies.block()},closeOnBackdropClick:!0})},i.prototype.isUsedColumn=function(t,n,r){var o=_.flatMap(Array.from(this.timeUnitColumnsMap.values()));return _.some(o,function(a){return a.timeUnit!==n?a.primaryColumnName===t||_.some(a.associatedColumnNames,function(l){return l===t}):r?_.some(a.associatedColumnNames,function(l){return l===t}):a.primaryColumnName===t})},i.prototype.addEditTimeUnit=function(t){this.usedTimeUnits.add(t),this.availableTimeUnits.delete(t),this.editingTimeUnit=t},i.prototype.isValidPrimaryColumnDataType=function(t){switch(t){case"DateTime":case"Date":case"Text":case"WholeNumber":return!0;default:return!1}},i.prototype.setOkState=function(){var t=this.calendarName!==this.editingCalendarName||!_.isEqual(this.timeUnitColumnsMap,this.originalTimeUnitColumnsMap),n=this.isValidCalendar();this.setOkButtonState.emit(!t||!n)},i.prototype.isValidCalendar=function(){return this.enableAddTimeUnit},i.prototype.updateTimeUnitItemGroups=function(){var t=this;this.timeUnitItemGroups[0].items=this.getSortedTimeUnits(this.availableTimeUnits).map(function(n){return{value:n,name:t.timeUnitNameMap.get(n)}}),this.timeUnitItemGroups[1].groupName=this.localizationService.format("CalendarOptions_UnavailableColumns",this.usedTimeUnits.size),this.timeUnitItemGroups[1].items=this.getSortedTimeUnits(this.usedTimeUnits).map(function(n){return{value:n,name:t.timeUnitNameMap.get(n)}})},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(se),e.\u0275\u0275directiveInject(Ke.n),e.\u0275\u0275directiveInject(ii.wX))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["manage-calendar"]],viewQuery:function(n,r){var o;(1&n&&e.\u0275\u0275viewQuery(ks,5,e.ElementRef),2&n)&&(e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.menuTrigger=o.first))},inputs:{tableEntity:"tableEntity",dialogState:"dialogState",editingCalendarName:"editingCalendarName"},outputs:{setOkButtonState:"setOkButtonState"},decls:40,vars:35,consts:[[1,"manage-calendar"],[1,"calendar-name"],[1,"calendar-name-label"],[1,"calendar-name-is-required"],["type","text",1,"calendar-name-input",3,"ngClass","placeholder","ngModel","ngModelChange"],[1,"class-name-existed-message",3,"ngClass"],["tri-svg-icon-12","","name","error_circle_12_filled"],[1,"add-time-units"],["tri-button","","appearance","primary","id","open-button","type","button",1,"pbi-fluent-button","primary",3,"disabled","click"],["trigger",""],["tri-svg-icon-20","",1,"add-svg-icon",3,"name"],["id","new-calendar-text","localize","CalendarOptions_AddTimeUnit",1,"button-text"],["tri-svg-icon-20","",1,"chevron-down-svg-icon",3,"name"],[1,"time-unit-table"],[1,"time-unit-head-row"],[1,"time-unit-head-th","time-unit"],[1,"time-unit-head-th","primary-column"],["localize","CalendarOptions_PrimaryColumn_Header"],["pbiTooltipPosition","after",1,"glyphicon","glyph-small","pbi-glyph-info",3,"pbiTooltip"],[1,"time-unit-head-th","associated-columns"],["localize","CalendarOptions_AssociatedColumns_Header"],[1,"time-unit-head-th","icon"],["class","time-unit-row",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"time-unit-row",3,"ngClass","click"],[1,"time-unit-data","time-unit"],[1,"time-unit-data","primary-column"],["tabindex","0",3,"disabled","inputDefaultValue","initialSelectedItems","multipleSelection","itemGroups","valueChange",4,"ngIf"],[4,"ngIf"],[1,"time-unit-data","associated-columns"],[1,"time-unit-data","icon"],["tri-button","","size","small",1,"time-unit-edit-button",3,"click"],["name","edit_20_regular","size","small"],["tri-button","","size","small",1,"time-unit-delete-button",3,"click"],["name","delete_20_regular","size","small"],["tabindex","0",3,"disabled","inputDefaultValue","initialSelectedItems","multipleSelection","itemGroups","valueChange"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"section",0)(1,"div",1)(2,"div")(3,"span",2),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span",3),e.\u0275\u0275text(7," *"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"input",4),e.\u0275\u0275listener("ngModelChange",function(a){return r.calendarName=a})("ngModelChange",function(){return r.changeCalendarName()}),e.\u0275\u0275pipe(9,"localize"),e.\u0275\u0275pipe(10,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",5),e.\u0275\u0275element(12,"tri-svg-icon",6),e.\u0275\u0275elementStart(13,"span"),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(16,"div",7)(17,"button",8,9),e.\u0275\u0275listener("click",function(){return r.openAddTimeUnitOverlay()}),e.\u0275\u0275pipe(19,"localize"),e.\u0275\u0275element(20,"tri-svg-icon",10)(21,"span",11)(22,"tri-svg-icon",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"table",13)(24,"thead")(25,"tr",14)(26,"th",15),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"th",16),e.\u0275\u0275element(30,"span",17)(31,"i",18),e.\u0275\u0275pipe(32,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"th",19),e.\u0275\u0275element(34,"span",20)(35,"i",18),e.\u0275\u0275pipe(36,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(37,"th",21),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(38,"tbody"),e.\u0275\u0275template(39,zs,14,8,"tr",22),e.\u0275\u0275elementEnd()()()()),2&n&&(e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,15,"CalendarOptions_CalendarName")),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(10,19,"CalendarOptions_CalendarName_Input_DefaultValue")),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(31,js,!r.validCalendarName))("ngModel",r.calendarName),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(9,17,"CalendarOptions_CalendarName")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(33,Ws,!r.calendarNameExisted)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(15,21,"CalendarOptions_CalendarName_Input_ExistedName_Message")),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",!r.enableAddTimeUnit),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(19,23,"Open")),e.\u0275\u0275advance(3),e.\u0275\u0275property("name","add_20_regular"),e.\u0275\u0275advance(2),e.\u0275\u0275property("name","chevron_down_20_regular"),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,25,"TimeInterval_Unit")," "),e.\u0275\u0275advance(4),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(32,27,"CalendarOptions_PrimaryColumn_Header_Tooltip")),e.\u0275\u0275advance(4),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(36,29,"CalendarOptions_AssociatedColumns_Header_Tooltip")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",r.getSortedTimeUnits(r.usedTimeUnits)))},dependencies:[ye.Fj,ye.JJ,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,bt.X,kt.V,Vt.M,Fs,ft.F],styles:[".manage-calendar[_ngcontent-%COMP%]{--columnWidth: 240px;font-size:14px}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]{padding:16px 0;border-bottom:1px solid var(--colorNeutralBackground3);display:flex;flex-direction:column}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]   .calendar-name-label[_ngcontent-%COMP%]{font-weight:var(--fontWeightSemibold)}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]   .calendar-name-is-required[_ngcontent-%COMP%]{color:var(--colorPaletteRedForeground1)}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]   .calendar-name-input[_ngcontent-%COMP%]{margin-top:4px;width:276px;height:32px;border:1px solid var(--colorNeutralStroke1);border-bottom:1px solid;border-radius:4px;background-color:transparent}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]   .calendar-name-input.invalid-calendar-name[_ngcontent-%COMP%]{border-color:var(--globalColorRedPrimary)}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]   .class-name-existed-message[_ngcontent-%COMP%]{display:flex;align-items:center}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]   .class-name-existed-message.hide-message[_ngcontent-%COMP%]{display:none}.manage-calendar[_ngcontent-%COMP%]   .calendar-name[_ngcontent-%COMP%]   .class-name-existed-message[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{padding-right:4px;fill:var(--globalColorRedPrimary)}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:16px 0}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]{width:100%}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:block;height:220px;overflow:scroll}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-row[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]{display:flex}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-row[_ngcontent-%COMP%]   .time-unit-head-th[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-row[_ngcontent-%COMP%]   .time-unit-data[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]   .time-unit-head-th[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]   .time-unit-data[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center;height:32px}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-row[_ngcontent-%COMP%]   .time-unit-head-th[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-row[_ngcontent-%COMP%]   .time-unit-data[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]   .time-unit-head-th[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]   .time-unit-data[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{margin-left:4px;padding:2px;font-weight:400}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center;padding:6px 0}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row.time-unit-year[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground5)}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]   .time-unit-data.icon[_ngcontent-%COMP%]{display:none}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground5Hover)}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]:hover   .time-unit-data.icon[_ngcontent-%COMP%]{display:flex!important;align-items:center}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-row[_ngcontent-%COMP%]:hover   .time-unit-data.icon[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:transparent}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-th[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-data[_ngcontent-%COMP%]{margin-inline:8px}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-th.time-unit[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-data.time-unit[_ngcontent-%COMP%]{width:128px}.manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-th.primary-column[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-data.primary-column[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-head-th.associated-columns[_ngcontent-%COMP%], .manage-calendar[_ngcontent-%COMP%]   .add-time-units[_ngcontent-%COMP%]   .time-unit-table[_ngcontent-%COMP%]   .time-unit-data.associated-columns[_ngcontent-%COMP%]{width:var(--columnWidth)}"],changeDetection:0}),i}();function Gs(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",10)(1,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.onMarkAsDateTable())}),e.\u0275\u0275element(2,"span",12),e.\u0275\u0275elementEnd()()}}function Ks(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",3)(1,"section",4),e.\u0275\u0275element(2,"div",5)(3,"span",6)(4,"a",7),e.\u0275\u0275elementStart(5,"manage-calendars",8),e.\u0275\u0275listener("addNewCalendar",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.onAddNewCalendar())})("editCalendar",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onEditCalendar(a))})("deleteCalendar",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onDeleteCalendar(a))}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(7,Gs,3,0,"section",9),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("calendars",e.\u0275\u0275pipeBind1(6,2,r.calendars$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.canSetAsDateTable)}}function $s(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"section",13),e.\u0275\u0275element(2,"span",14)(3,"a",15),e.\u0275\u0275elementStart(4,"manage-calendar",16),e.\u0275\u0275listener("setOkButtonState",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.setOkButtonState(a))}),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("tableEntity",r.tableEntity)("dialogState",r.state)("editingCalendarName","EditCalendar"===r.state?r.editingCalendarName:void 0)}}var Mo=function(){function i(t,n,r,o,a,l,s,c){this.dataModelService=t,this.localizationService=n,this.dateTableService=r,this.templateDialogPayload=o,this.telemetryService=a,this.certifiedEventsService=l,this.buildCalendarService=s,this.calendarModelAuthoringService=c}return i.prototype.ngOnInit=function(){var n,t=this;if(this.args=this.templateDialogPayload.input,I.fF.assertValue(this.args,"custom-date-table-dialog args missing"),this.args){var r=this.dataModelService.getDataModel();this.canSetAsDateTable=(0,Qe.x9)(r,this.args.tableName),this.tableEntity=(0,Qe.AG)(r,this.args.tableName),this.calendars$=this.dataModelService.modelChanged$.pipe((0,Me.U)(function(a){return a.modelChangedResult&&(t.tableEntity=(0,Qe.AG)(a.model,t.args.tableName)),t.tableEntity.calendars?_.cloneDeep(t.tableEntity.calendars):[]}));var o=null!==(n=this.args.initialState)&&void 0!==n?n:_t.Q.CalendarOptions;o===_t.Q.EditCalendar&&(this.editingCalendarName=this.args.editingCalendarName),this.setDialogState(o),this.log("PBI.CustomCalendars.OpenDialog","Succeeded",{entryPoint:this.args.entryPoint})}},i.prototype.onMarkAsDateTable=function(){this.dateTableService.showOrEditDateTable(this.tableEntity.name,this.tableEntity.schemaName,"CalendarOptions")},i.prototype.onAddNewCalendar=function(){this.setDialogState(_t.Q.CreateCalendar)},i.prototype.setDialogState=function(t){var n=this;switch(t){case _t.Q.CalendarOptions:this.templateDialogPayload.setTitle(this.localizationService.format("CalendarOptions_ForTable",this.tableEntity.name)),this.templateDialogPayload.toggleOkButton(!1),this.templateDialogPayload.setOkButtonState(!1),this.templateDialogPayload.setOkButtonText(this.localizationService.get("Done_ButtonText")),this.templateDialogPayload.onOkButtonClick=function(){return n.templateDialogPayload.closeDialogFromConsumer(void 0),Promise.resolve(!0)},this.templateDialogPayload.onCancelButtonClick=function(){return Promise.resolve(void 0)},this.templateDialogPayload.toggleCancelButton(!0),this.state=_t.Q.CalendarOptions;break;case _t.Q.CreateCalendar:this.log("PBI.CustomCalendars.Create","Succeeded"),this.templateDialogPayload.setTitle(this.localizationService.format("CalendarOptions_CustomizeCalendarForTable",this.tableEntity.name)),this.templateDialogPayload.toggleOkButton(!1),this.templateDialogPayload.setOkButtonState(!0),this.templateDialogPayload.setOkButtonText(this.localizationService.get("SaveAndClose_ButtonText")),this.templateDialogPayload.onOkButtonClick=function(){return(0,d.__awaiter)(n,void 0,void 0,function(){var r,a,l;return(0,d.__generator)(this,function(s){switch(s.label){case 0:r=this.dataModelService.getDataModel(),a=gt.X6.getTableUrn(this.tableEntity.name,r.editableSchemaName),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.calendarModelAuthoringService.createCalendar(a,this.buildCalendarService.calendar)];case 2:return s.sent(),this.log(ni,"Succeeded",{dialogState:t}),[3,4];case 3:throw l=s.sent(),this.log(ni,"Failed",{dialogState:t}),l;case 4:return this.setDialogState(_t.Q.CalendarOptions),[2,Promise.resolve(!0)]}})})},this.templateDialogPayload.onCancelButtonClick=function(){return n.setDialogState(_t.Q.CalendarOptions),Promise.resolve(!0)},this.templateDialogPayload.toggleCancelButton(!1),this.templateDialogPayload.setCancelButtonText(this.localizationService.get("CloseWithoutSaving")),this.state=_t.Q.CreateCalendar;break;case _t.Q.EditCalendar:this.log("PBI.CustomCalendars.Update","Succeeded"),this.templateDialogPayload.setTitle(this.localizationService.format("CalendarOptions_CustomizeCalendarForTable",this.tableEntity.name)),this.templateDialogPayload.toggleOkButton(!1),this.templateDialogPayload.setOkButtonText(this.localizationService.get("SaveAndClose_ButtonText")),this.templateDialogPayload.onOkButtonClick=function(){return(0,d.__awaiter)(n,void 0,void 0,function(){var r,o,a,l;return(0,d.__generator)(this,function(s){switch(s.label){case 0:r=this.buildCalendarService.oldCalendarName?{name:this.buildCalendarService.calendar.name,oldName:this.buildCalendarService.oldCalendarName}:void 0,o=this.dataModelService.getDataModel(),a=o.editableSchemaName,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.calendarModelAuthoringService.editCalendar(this.tableEntity.name,r,this.buildCalendarService.calendar,a)];case 2:return s.sent(),this.log(ni,"Succeeded",{dialogState:t}),[3,4];case 3:throw l=s.sent(),this.log(ni,"Failed",{dialogState:t}),l;case 4:return this.setDialogState(_t.Q.CalendarOptions),[2,Promise.resolve(!0)]}})})},this.templateDialogPayload.onCancelButtonClick=function(){return n.setDialogState(_t.Q.CalendarOptions),Promise.resolve(!0)},this.templateDialogPayload.toggleCancelButton(!1),this.templateDialogPayload.setCancelButtonText(this.localizationService.get("CloseWithoutSaving")),this.state=_t.Q.EditCalendar}},i.prototype.onEditCalendar=function(t){this.editingCalendarName=t,this.setDialogState(_t.Q.EditCalendar)},i.prototype.onDeleteCalendar=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.calendarModelAuthoringService.deleteCalendar(this.tableEntity.name,t,this.tableEntity.schemaName)];case 1:return r.sent(),this.log(Co,"Succeeded"),[3,3];case 2:throw n=r.sent(),this.log(Co,"Failed"),n;case 3:return[2]}})})},i.prototype.setOkButtonState=function(t){this.templateDialogPayload.setOkButtonState(t)},i.prototype.log=function(t,n,r){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,featureName:"Custom Calendars",activityName:t,activityStatus:n,activityAttributes:r,resultCode:void 0})},i.dialogNameKey=Rt.Rb,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Ke.n),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(vs.i),e.\u0275\u0275directiveInject(at.x),e.\u0275\u0275directiveInject(Mt.y0),e.\u0275\u0275directiveInject(Mt.ly),e.\u0275\u0275directiveInject(se),e.\u0275\u0275directiveInject(_s.e))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["calendar-options"]],features:[e.\u0275\u0275ProvidersFeature([at.x])],decls:4,vars:2,consts:[[1,"dialog-content"],["class","calendar-options",4,"ngIf"],[4,"ngIf"],[1,"calendar-options"],[1,"manage-calendars-section"],["localize","CalendarOptions_ManageCalendars",1,"manage-calendars-header"],["localize","CalendarOptions_ManageCalendars_Description"],["href","https://go.microsoft.com/fwlink/?linkid=","localize","Generic_LearnMore","target","_blank",1,"learn-more-manage-calendars"],[3,"calendars","addNewCalendar","editCalendar","deleteCalendar"],["class","mark-as-date-table-section",4,"ngIf"],[1,"mark-as-date-table-section"],[1,"mark-as-date-table-btn",3,"click"],["localize","MarkAsDateTable"],[1,"manage-calendar-section"],["localize","CalendarOptions_CustomizeCalendarForTable_Description"],["href","https://go.microsoft.com/fwlink/?linkid=","localize","Generic_LearnMore","target","_blank",1,"learn-more-create-calendar"],[3,"tableEntity","dialogState","editingCalendarName","setOkButtonState"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"div",0),e.\u0275\u0275template(2,Ks,8,4,"div",1),e.\u0275\u0275template(3,$s,5,3,"div",2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","CalendarOptions"===r.state),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","CreateCalendar"===r.state||"EditCalendar"===r.state))},dependencies:[ie.NgIf,bt.X,Nt.J,ys,Hs,ie.AsyncPipe],styles:[".dialog-content[_ngcontent-%COMP%]{font-size:14px;line-height:20px}.dialog-content[_ngcontent-%COMP%]   a.learn-more-manage-calendars[_ngcontent-%COMP%], .dialog-content[_ngcontent-%COMP%]   a.learn-more-create-calendar[_ngcontent-%COMP%]{margin-left:4px}.dialog-content[_ngcontent-%COMP%]   a.learn-more-manage-calendars[_ngcontent-%COMP%]:link, .dialog-content[_ngcontent-%COMP%]   a.learn-more-create-calendar[_ngcontent-%COMP%]:link{color:var(--colorBrandForegroundLink)}.dialog-content[_ngcontent-%COMP%]   .calendar-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.dialog-content[_ngcontent-%COMP%]   .calendar-options[_ngcontent-%COMP%]   .manage-calendars-section[_ngcontent-%COMP%]   .manage-calendars-header[_ngcontent-%COMP%]{margin-bottom:4px;font-weight:var(--fontWeightSemibold);font-size:14px}.dialog-content[_ngcontent-%COMP%]   .calendar-options[_ngcontent-%COMP%]   .mark-as-date-table-section[_ngcontent-%COMP%]{margin:16px 0 6px}.dialog-content[_ngcontent-%COMP%]   .calendar-options[_ngcontent-%COMP%]   .mark-as-date-table-section[_ngcontent-%COMP%]   .mark-as-date-table-btn[_ngcontent-%COMP%]{border:0;background:none;color:var(--colorBrandForegroundLink)}  .mat-mdc-dialog-container calendar-options{width:800px;height:600px;display:block}  .mat-mdc-dialog-container calendar-options .pbi-dialog-header{margin-top:0!important}  .mat-mdc-dialog-container calendar-options .mat-mdc-dialog-content{overflow:hidden!important}"],changeDetection:0}),i}(),Qs=p(53419),Xs=p(10556),wo=function(){function i(t,n,r,o,a,l){this.executeDataQueriesRequestCacheService=t,this.dataQueriesExecutionService=n,this.featureSwitchService=r,this.dataModelService=o,this.localizationService=a,this.telemetryService=l}return i.prototype.validateDateColumn=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a,l,s;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return r=this.telemetryService.startEvent(Xs.fbs,{}),o=this.dataModelService.getDataModel(),a=(0,lt.YD)(t,n,o),[4,this.getValidationResult(a.table,a.column)];case 1:return l=c.sent(),(s=this.getValidationErrors(l)).length>0&&(r.event.info.errors=JSON.stringify(l)),r.resolve(),[2,s]}})})},i.prototype.getDefaultValidationResult=function(){return{hasNoNullValues:!0,hasUniqueValue:!0,hasOneTimeFraction:!0,hasContiguousDates:!0}},i.prototype.constructIsValidKeyForDataTableDataQuery=function(t,n){return{isValidKeyForDateTable:{column:gt.X6.getColumnUrn(t.name,n.name,n.schemaName)}}},i.prototype.getValidationResult=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,d.__generator)(this,function(a){return(0,lt.mE)(this.featureSwitchService.featureSwitches.allowDirectLakeDataValidation,t)?[2,this.getDefaultValidationResult()]:(r=this.constructIsValidKeyForDataTableDataQuery(t,n),this.executeDataQueriesRequestCacheService.isDataQueryInCache(r)||(o=(0,lt.p_)([r],this.dataQueriesExecutionService,new lt._v("ExecuteDataQueriesFailed",this.localizationService.format("DateTableValidationExecuteDataQueriesFailed"))),this.executeDataQueriesRequestCacheService.setDataQueryCache(r,o)),[2,this.getDataQueryResult(r)])})})},i.prototype.getDataQueryResult=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:if(!this.executeDataQueriesRequestCacheService.isDataQueryInCache(t))throw new Error("data query should be found from cache");if(!t.isValidKeyForDateTable)throw new Error("Expect isValidKeyForDateTable to be present on the data query");return n=this.executeDataQueriesRequestCacheService.getDataQueryRequest(t),[4,(0,lt.ey)(t,n)];case 1:if(!(r=o.sent()).hasOwnProperty("hasNoNullValues"))throw new Error("Expect hasNoNullValues defined in dateColumnValidations");if(!r.hasOwnProperty("hasUniqueValue"))throw new Error("Expect hasUniqueValue defined in dateColumnValidations");if(!r.hasOwnProperty("hasOneTimeFraction"))throw new Error("Expect hasOneTimeFraction defined in dateColumnValidations");if(!r.hasOwnProperty("hasContiguousDates"))throw new Error("Expect hasContiguousDates defined in dateColumnValidations");return[2,r]}})})},i.prototype.getValidationErrors=function(t){var n=[];return t.hasNoNullValues||n.push("CustomDateTableDialog_DateColumnError_NullValues"),t.hasUniqueValue||n.push("CustomDateTableDialog_DateColumnError_DuplicateValues"),t.hasOneTimeFraction||n.push("CustomDateTableDialog_DateColumnError_MultipleTimeFractions"),t.hasContiguousDates||n.push("CustomDateTableDialog_DateColumnError_NonContiguousDates"),n},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(un.H),e.\u0275\u0275inject(Qs.$),e.\u0275\u0275inject(Ot.vZ),e.\u0275\u0275inject(Ke.n),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(Mt.y0))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Ys=p(13414),Zs=p(54729);function Js(i,t){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"tri-dropdown-item",18)(2,"p",19),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!r.viewModel.table||r.viewModel.isValidating)("value",n),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.getColumnName(n))}}function qs(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275element(1,"tri-svg-icon",21)(2,"span",22),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,1,"CustomDateTableDialog_DateColumnValidatedSucessfully")))}function ec(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",23),e.\u0275\u0275element(1,"tri-svg-icon",24),e.\u0275\u0275elementStart(2,"span",25),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("name","error_circle_12_filled")("alt","Error"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,3,n.viewModel.validationErrors[0]))}}function tc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",26),e.\u0275\u0275element(1,"tri-message-bar",27),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("viewModel",n.errorMessageViewModel)}}function nc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",28)(1,"tri-spinner",29)(2,"label",30),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"GroupEditor_WaitForGroupIdValidation")," "))}var ic=function(t){return{"error-border":t}},rc=function(t){return{"choose-column-prompt":t}};function oc(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section")(1,"section"),e.\u0275\u0275element(2,"label",9),e.\u0275\u0275elementStart(3,"tri-dropdown",10),e.\u0275\u0275listener("valueChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onDateColumnSelected(a))})("valueChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.viewModel.selectedDateColumn=a)}),e.\u0275\u0275elementStart(4,"tri-dropdown-trigger")(5,"p",11),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(7,Js,4,3,"ng-container",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"section",13),e.\u0275\u0275template(9,qs,4,3,"div",14),e.\u0275\u0275template(10,ec,5,5,"div",15),e.\u0275\u0275template(11,tc,2,1,"div",16),e.\u0275\u0275template(12,nc,5,3,"div",17),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(10,ic,(null==r.viewModel.validationErrors?null:r.viewModel.validationErrors.length)>0))("isDisabled",r.displaySpinner())("value",r.viewModel.selectedDateColumn),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(12,rc,!r.viewModel.selectedDateColumn)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(r.getColumnName(r.viewModel.selectedDateColumn)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.viewModel.dateColumns),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.displayValidationSuccessMessage()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.displayValidationErrorMessage()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.displayUnexpectedErrorMessage()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.displaySpinner())}}var xo=function(){function i(t,n,r,o,a){this.customDateTableValidationRunnerService=t,this.localizationService=n,this.telemetryService=r,this.modelService=o,this.templateDialogPayload=a}return i.prototype.ngOnDestroy=function(){},i.prototype.close=function(){},i.prototype.ngOnInit=function(){var t=this;this.args=this.templateDialogPayload.input,I.fF.assertValue(this.args,"date-table-dialog args missing"),this.args&&(this.tableEntity=this.modelService.model.findTable(this.args.entityName),this.schema=this.tableEntity.schemaName,this.isMarkedAsDateTable=this.getTableState(),this.createViewModel(),this.errorMessageViewModel={bannerType:1,iconName:"dismiss_circle_16_filled",message:this.localizationService.get("DateTableDialog_GenericErrorMessage")},this.telemetryService.logEvent(ss,{entryPoint:this.args.entryPoint,isEnabled:this.isMarkedAsDateTable}),this.templateDialogPayload.onOkButtonClick=function(){return t.commit()},this.templateDialogPayload.onCancelButtonClick=function(){return t.cancel()},this.viewModel.selectedDateColumn||this.templateDialogPayload.setOkButtonState(!0))},i.prototype.cancel=function(){return Promise.resolve(void 0)},i.prototype.commit=function(){var t,n={schema:this.schema,tableName:this.tableEntity.name,dateColumnName:null===(t=this.viewModel.selectedDateColumn)||void 0===t?void 0:t.name,enabled:this.isMarkedAsDateTable};return this.telemetryService.logEvent(cs,{entryPoint:this.args.entryPoint,action:this.getTelemetryAction()}),Promise.resolve(n)},i.prototype.createViewModel=function(){var t=_.filter(this.tableEntity.columns.getItems(),function(n){return n&&n.isDateTime});this.viewModel={table:this.tableEntity,dateColumns:t,selectedDateColumn:this.getPrimaryDateColumn(),validationErrors:void 0,isValidating:!1,isValidated:!1,hasUnexpectedError:!1}},i.prototype.getTableState=function(){return this.tableEntity.isDateTable},i.prototype.getPrimaryDateColumn=function(){return _.find(this.tableEntity.columns.getItems(),function(t){return t&&t.isDateTime&&t.isKey})},i.prototype.getTelemetryAction=function(){return this.isMarkedAsDateTable?this.tableEntity.isDateTable?"Edit":"Mark":"Unmark"},i.prototype.displayValidationSuccessMessage=function(){var t;return this.viewModel.isValidated&&void 0!==(null===(t=this.viewModel.selectedDateColumn)||void 0===t?void 0:t.name)&&!this.viewModel.hasUnexpectedError},i.prototype.displayValidationErrorMessage=function(){return!this.canCommit()&&!this.viewModel.isValidating&&this.viewModel.selectedDateColumn&&!this.viewModel.hasUnexpectedError},i.prototype.displayUnexpectedErrorMessage=function(){return!this.canCommit()&&!this.viewModel.isValidating&&this.viewModel.selectedDateColumn&&this.viewModel.hasUnexpectedError},i.prototype.displaySpinner=function(){return!this.canCommit()&&this.viewModel.selectedDateColumn&&this.viewModel.isValidating},i.prototype.getColumnName=function(t){return t?t.name:this.localizationService.get("DateTableDialog_ChooseColumn")},i.prototype.onDateColumnSelected=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,d.__generator)(this,function(a){switch(a.label){case 0:if(this.viewModel.validationErrors=void 0,this.viewModel.selectedDateColumn=t,this.viewModel.hasUnexpectedError=!1,n=document.getElementById("validationSection"),!this.viewModel.selectedDateColumn)return n?.setAttribute("tabindex","-1"),this.templateDialogPayload.setOkButtonState(!0),[2];this.viewModel.isValidating=!0,this.viewModel.isValidated=!1,this.templateDialogPayload.setOkButtonState(!0),a.label=1;case 1:return a.trys.push([1,3,4,5]),r=this.viewModel,[4,this.customDateTableValidationRunnerService.validateDateColumn(this.tableEntity.name,this.viewModel.selectedDateColumn.name)];case 2:return r.validationErrors=a.sent(),[3,5];case 3:return a.sent(),this.viewModel.hasUnexpectedError=!0,[3,5];case 4:return this.viewModel.isValidating=!1,this.viewModel.isValidated=this.canCommit(),this.templateDialogPayload.setOkButtonState(!this.viewModel.isValidated),n?.setAttribute("tabindex","0"),n?.focus(),[7];case 5:return[2]}})})},i.prototype.onMarkAsDateTableToggle=function(){var t;this.isMarkedAsDateTable=!this.isMarkedAsDateTable,this.viewModel.validationErrors=void 0,this.viewModel.selectedDateColumn=void 0,this.viewModel.hasUnexpectedError=!1,!this.isMarkedAsDateTable&&null!==(t=this.viewModel.table)&&void 0!==t&&t.isDateTable?(this.viewModel.selectedDateColumn=this.getPrimaryDateColumn(),this.templateDialogPayload.setOkButtonState(!1)):this.templateDialogPayload.setOkButtonState(!0)},i.prototype.canCommit=function(){return this.viewModel&&this.viewModel.selectedDateColumn&&0===_.size(this.viewModel.validationErrors)&&!this.viewModel.isValidating&&!this.viewModel.hasUnexpectedError},i.dialogNameKey=Rt.Gq,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(wo),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(Mt.y0),e.\u0275\u0275directiveInject(Oe.b),e.\u0275\u0275directiveInject(at.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["date-table"]],features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)((0,d.__spreadArray)([],an,!0),[at.x,un.H,wo],!1))],decls:20,vars:18,consts:[[1,"dialogContent"],[1,"dialog-description-content"],[1,"description-spacing","fluentTheme-md-reg"],[1,"dialog-description-warning"],["href","https://go.microsoft.com/fwlink/?linkid=866591","localize","Generic_LearnMore","target","_blank",1,"pbi-external-link","learn-more-date-column"],["for","toggleDateTable","localize","MarkAsADateTable",1,"toggle-header","fluentTheme-md-semiBold"],["id","toggleDateTable",1,"toggle-date-table","fluentTheme-md-reg",3,"ngModel","disabled","aria-label","ngModelChange"],["tri-switch-text",""],[4,"ngIf"],["for","columnSelect","localize","DateTableDialog_ChooseDateColumn",1,"choose-column-label","fluentTheme-md-semiBold"],["id","columnSelect",1,"choose-column-dropdown",3,"ngClass","isDisabled","value","valueChange"],[1,"choose-column-option","fluentTheme-md-reg",3,"ngClass"],[4,"ngFor","ngForOf"],["id","validationSection","tabindex","-1"],["role","region","aria-live","polite","class","validation-container",4,"ngIf"],["aria-live","polite","class","validation-container","data-testid","dt-validation-error","role","region",4,"ngIf"],["class","system-error-container fluentTheme-sm-reg","aria-live","polite","role","region",4,"ngIf"],["class","validation-container","aria-live","polite","role","region",4,"ngIf"],[3,"disabled","value"],[1,"choose-column-option","fluentTheme-md-reg"],["role","region","aria-live","polite",1,"validation-container"],["tri-svg-icon-12","","name","checkmark_circle_12_filled",1,"checkmark-icon"],["localize","CustomDateTableDialog_DateColumnValidatedSucessfully",1,"validation-message","fluentTheme-sm-reg"],["aria-live","polite","data-testid","dt-validation-error","role","region",1,"validation-container"],["tri-svg-icon-12","",1,"error-icon",3,"name","alt"],[1,"error-text","fluentTheme-sm-reg"],["aria-live","polite","role","region",1,"system-error-container","fluentTheme-sm-reg"],[3,"viewModel"],["aria-live","polite","role","region",1,"validation-container"],["labelPosition","after","size","extra-tiny",1,"spinner-with-text"],[1,"validation-message","fluentTheme-sm-reg"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"div",0)(2,"section")(3,"div",1),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",2)(6,"span",3),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(8,"a",4),e.\u0275\u0275pipe(9,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"section"),e.\u0275\u0275element(11,"label",5),e.\u0275\u0275elementStart(12,"tri-switch",6),e.\u0275\u0275listener("ngModelChange",function(){return r.onMarkAsDateTableToggle()}),e.\u0275\u0275pipe(13,"localize"),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementStart(15,"div",7),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"localize"),e.\u0275\u0275pipe(18,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(19,oc,13,14,"section",8),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(r.args.description),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(r.args.warning),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(9,8,"Generic_LearnMore")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngModel",r.isMarkedAsDateTable)("disabled",r.displaySpinner())("aria-label",r.isMarkedAsDateTable?e.\u0275\u0275pipeBind1(13,10,"ToggleSwitchOn"):e.\u0275\u0275pipeBind1(14,12,"ToggleSwitchOff")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(r.isMarkedAsDateTable?e.\u0275\u0275pipeBind1(17,14,"ToggleSwitchOn"):e.\u0275\u0275pipeBind1(18,16,"ToggleSwitchOff")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.isMarkedAsDateTable))},dependencies:[ye.JJ,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,bt.X,Nt.J,Jt.M3,ei.l,ti.q,Jt.ii,Mn.h,Vt.M,Ys.t,Zs.D,ft.F],styles:[".dialogContent[_ngcontent-%COMP%]{background:var(--colorNeutralBackground1);width:784px;height:552px;color:var(--colorNeutralForeground2);line-height:20px;word-wrap:break-word}.dialogContent[_ngcontent-%COMP%]   .dialog-description-content[_ngcontent-%COMP%]{padding-bottom:20px}.dialogContent[_ngcontent-%COMP%]   .description-spacing[_ngcontent-%COMP%]{padding-bottom:16px}.dialogContent[_ngcontent-%COMP%]   .learn-more-date-column[_ngcontent-%COMP%]{margin-left:4px;text-decoration:underline;line-height:20px}.toggle-header[_ngcontent-%COMP%]{padding-bottom:2px;color:var(--colorNeutralForeground1);line-height:20px;word-wrap:break-word}.toggle-date-table[_ngcontent-%COMP%]{display:block;padding-left:8px;padding-bottom:16px;color:var(--colorNeutralForeground1);line-height:20px;word-wrap:break-word}.choose-column-label[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1);line-height:20px;word-wrap:break-word;padding-bottom:4px}.choose-column-dropdown[_ngcontent-%COMP%]{border-radius:4px;width:300px}.choose-column-option[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1);line-height:20px;word-wrap:break-word}.choose-column-prompt[_ngcontent-%COMP%]{color:var(--colorNeutralForeground4);line-height:20px;word-wrap:break-word}.validation-container[_ngcontent-%COMP%]{padding-top:2px;width:300px}.system-error-container[_ngcontent-%COMP%]{padding-top:16px}.checkmark-icon[_ngcontent-%COMP%]{padding-right:4px;padding-bottom:4px;height:12px;width:12px;fill:var(--globalColorGreenShade10)}.validation-message[_ngcontent-%COMP%]{color:var(--colorNeutralForeground3);line-height:16px;word-wrap:break-word}.error-border[_ngcontent-%COMP%]{border-radius:4px;border:1px var(--globalColorRedPrimary) solid}.error-icon[_ngcontent-%COMP%]{padding-right:4px;padding-bottom:4px;height:12px;width:12px;fill:var(--globalColorRedShade10)}.error-text[_ngcontent-%COMP%]{color:var(--globalColorRedShade10);line-height:16px;word-wrap:break-word}.spinner-with-text[_ngcontent-%COMP%]{margin-left:4px;display:inline-block}"]}),i}(),Po=function(){function i(t,n){this.schemaChangeService=t,this.modelService=n}return i.prototype.updateCurationTable=function(t,n,r,o,a){return(0,d.__awaiter)(this,void 0,void 0,function(){var l,s;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return l={changes:[]},s=this.modelService.model.findTable(t),[4,this.schemaChangeService.setDescription([{object:s,newValue:r}],l)];case 1:return c.sent(),[4,this.schemaChangeService.setDefaultLabel([{object:s,newValue:o}],l)];case 2:return c.sent(),[4,this.schemaChangeService.setKeyColumn([{object:s,newValue:a}],l)];case 3:return c.sent(),[4,this.schemaChangeService.setIsCuratedForDataSearch([{object:s,newValue:n}],l)];case 4:return c.sent(),[4,this.schemaChangeService.apply(l)];case 5:return c.sent(),[2]}})})},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(oo.G),e.\u0275\u0275inject(Oe.b))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}();function ac(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275element(1,"div",21),e.\u0275\u0275elementStart(2,"div",22),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"FeaturedTable_Missing_Description")," "))}var lc=function(t){return{"ft-row-block-input-disabled":t}};function sc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"option",23),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("ngValue",n.name)("disabled",n.isHidden)("ngClass",e.\u0275\u0275pureFunction1(4,lc,n.isHidden)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function cc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275element(1,"div",21),e.\u0275\u0275elementStart(2,"div",24),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"FeaturedTable_Missing_DefaultLabel")," "))}function dc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275element(1,"div",21),e.\u0275\u0275elementStart(2,"div",24),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"FeaturedTable_Hidden_RowLabel")," "))}function uc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"option",25),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("ngValue",n.name)("disabled",n.isHidden),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function pc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275element(1,"div",21),e.\u0275\u0275elementStart(2,"div",26),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"FeaturedTable_Missing_KeyColumn")," "))}function gc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275element(1,"div",21),e.\u0275\u0275elementStart(2,"div",26),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"FeaturedTable_Hidden_KeyColumn")," "))}var ir=function(t){return{highlightInputError:t}};function hc(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",1)(1,"div",2)(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementStart(5,"a",3),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"div",2)(9,"span",4),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"div",5)(13,"div",6)(14,"div",7)(15,"label",8),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"div",9)(19,"textarea",10),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.viewModel.description=a)}),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275text(21,"                "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(22,ac,5,3,"div",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"div",12)(24,"div",7)(25,"label",13),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"div",9)(29,"select",14),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.viewModel.defaultLabelName=a)}),e.\u0275\u0275elementStart(30,"option",15),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(33,sc,2,6,"option",16),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(34,cc,5,3,"div",11),e.\u0275\u0275template(35,dc,5,3,"div",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"div",12)(37,"div",7)(38,"label",17),e.\u0275\u0275text(39),e.\u0275\u0275pipe(40,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(41,"div",9)(42,"select",18),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.viewModel.keyColumn=a)}),e.\u0275\u0275elementStart(43,"option",15),e.\u0275\u0275text(44),e.\u0275\u0275pipe(45,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(46,uc,2,3,"option",19),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(47,pc,5,3,"div",11),e.\u0275\u0275template(48,gc,5,3,"div",11),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(4,24,"FeaturedTables_Summary")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,26,"Generic_LearnMore")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(11,28,"FeaturedTables_RequiredInformation")," "),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(17,30,"Description")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.viewModel.description)("ngClass",e.\u0275\u0275pureFunction1(42,ir,r.isDescriptionInvalid())),e.\u0275\u0275attribute("placeholder",e.\u0275\u0275pipeBind1(20,32,void 0===r.viewModel.description?"Multiple_Values":"Enter_A_Description")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.isDescriptionInvalid()),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(27,34,"Row_Label")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.viewModel.defaultLabelName)("ngClass",e.\u0275\u0275pureFunction1(44,ir,r.isRowLabelInvalid())),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngValue",null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(32,36,"Row_Label_None_Option")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.rowLabelColumns),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isRowLabelEmpty()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isRowLabelHidden()),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(40,38,"Key_Column")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.viewModel.keyColumn)("ngClass",e.\u0275\u0275pureFunction1(46,ir,r.isKeyColumnInvalid())),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngValue",null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(45,40,"Key_Column_None_Option")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.keyColumns),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isKeyColumnEmpty()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isKeyColumnHidden())}}var Oo=function(){function i(t,n,r,o,a){this.modelService=t,this.highContrastCssGenerationService=n,this.updateCurationTableService=r,this.localization=o,this.templateDialogPayload=a,this.destroy$=new pn.xQ}return i.prototype.ngOnInit=function(){var t=this;this.initializeHighContrastRules(),this.viewActive=!1,this.show(this.templateDialogPayload.input),this.templateDialogPayload.onCancelButtonClick=function(){return(0,d.__awaiter)(t,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return[2,this.cancel()]})})},this.templateDialogPayload.onOkButtonClick=function(){return(0,d.__awaiter)(t,void 0,void 0,function(){return(0,d.__generator)(this,function(n){return[2,this.save()]})})}},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},i.prototype.show=function(t){var n,r,o,a;this.currentTable=this.modelService.model.findTable(t.table),this.rowLabelColumns=null===(r=null===(n=this.currentTable)||void 0===n?void 0:n.columns)||void 0===r?void 0:r.nonSystemColumns,this.keyColumns=null===(a=null===(o=this.currentTable)||void 0===o?void 0:o.columns)||void 0===a?void 0:a.dataColumns,this.viewActive=!0,this.updateViewModel()},i.prototype.save=function(){var t,n;return(0,d.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return this.viewModel.showValidationAfterStartup=!0,this.isDescriptionInvalid()||this.isRowLabelInvalid()||this.isKeyColumnInvalid()?[2]:[4,this.updateCurationTableService.updateCurationTable(this.currentTable.name,!0,this.viewModel.description,this.viewModel.defaultLabelName,this.viewModel.keyColumn)];case 1:return o.sent(),null===(n=null===(t=this.modelService)||void 0===t?void 0:t.modelChange$)||void 0===n||n.pipe((0,Me.U)(function(a){var l;return null!==(l=a?.appliedChanges)&&void 0!==l?l:[]}),(0,st.h)(function(a){return a?.filter(function(l){return l.updateDataSearchCuration}).length>0}),(0,nt.q)(1),(0,qe.R)(this.destroy$)).subscribe(function(a){r.templateDialogPayload.closeDialogFromConsumer()}),[2]}})})},i.prototype.isDescriptionInvalid=function(){return!(!this.isNullOrWhitespace(this.viewModel.description)||!this.viewModel.showValidationAfterStartup)},i.prototype.isRowLabelInvalid=function(){var t=this,n=this.currentTable.columns.filter(function(o){return o.name===t.viewModel.defaultLabelName});return(!this.viewModel.defaultLabelName||!!(n&&n.length>0)&&n[0].isHidden)&&this.viewModel.showValidationAfterStartup},i.prototype.isRowLabelHidden=function(){var t=this,n=this.currentTable.columns.filter(function(o){return o.name===t.viewModel.defaultLabelName});return!!(n&&n.length>0)&&n[0].isHidden&&this.viewModel.showValidationAfterStartup},i.prototype.isRowLabelEmpty=function(){return!(this.viewModel.defaultLabelName||!this.viewModel.showValidationAfterStartup)},i.prototype.isKeyColumnInvalid=function(){return(!this.viewModel.keyColumn||this.isKeyColumnHidden())&&this.viewModel.showValidationAfterStartup},i.prototype.isKeyColumnEmpty=function(){return!(this.viewModel.keyColumn||!this.viewModel.showValidationAfterStartup)},i.prototype.isKeyColumnHidden=function(){var t=this,n=this.currentTable.columns.filter(function(o){return o.name===t.viewModel.keyColumn});return!!(n&&n.length>0)&&n[0].isHidden&&this.viewModel.showValidationAfterStartup},i.prototype.showTooltipForHiddenColumn=function(t,n){return t.isHidden?this.localization.get(n):""},i.prototype.cancel=function(){this.templateDialogPayload.closeDialogFromConsumer()},i.prototype.updateViewModel=function(){this.viewModel={tableName:this.currentTable.name,description:this.currentTable.description,defaultLabelName:this.columnToDisplay(this.currentTable.defaultLabelColumnName),keyColumn:this.columnToDisplay(this.currentTable.keyColumnName),showValidationAfterStartup:!1}},i.prototype.columnToDisplay=function(t){if(t){var n=this.currentTable.columns.filter(function(o){return o.name===t});if(n&&n.length>0&&n[0].isHidden)return null}return t},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement a:focus, .themeableElement div:focus, .themeableElement label:focus","{ border-color: @buttonForegroundColor !important; outline: @buttonForegroundColor solid 1px !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .error-button::before","{ color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .required::after","{ color: @foregroundColor !important; }")},i.prototype.isNullOrWhitespace=function(t){return typeof t>"u"||null==t||""===t.trim()},i.dialogNameKey=Rt.Js,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Oe.b),e.\u0275\u0275directiveInject(D.g),e.\u0275\u0275directiveInject(Po),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(at.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["data-search-curation-dialog"]],features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)((0,d.__spreadArray)([],an,!0),[Po,at.x],!1))],decls:2,vars:1,consts:[["class","ft-container","cdkFocusInitial","",4,"ngIf"],["cdkFocusInitial","",1,"ft-container"],[1,"ft-details-container"],["href","https://go.microsoft.com/fwlink/?linkid=2125500","target","_blank"],["id","ftRequiredInformationLabel"],["role","group",1,"ft-body-container"],["role","group",1,"ft-description","ft-row"],[1,"ft-row-block"],["for","viewModel.description","id","ftDescriptionLabel",1,"ft-label","required"],[1,"ft-row-block-input"],["id","ft-textarea-description","name","description","aria-required","true","aria-labelledby","ftDescriptionLabel ftDescriptionError",1,"themeableElement","multiline-editor",3,"ngModel","ngClass","ngModelChange"],["class","ft-row-block alert","role","alert",4,"ngIf"],["role","group",1,"ft-row"],["for","rowLabelPicker","id","rowLabelPickerLabel",1,"ft-label","required"],["name","rowLabelPicker","aria-required","true","id","rowLabelPicker","aria-labelledby","rowLabelPickerLabel rowLabelPickerError",1,"form-control","ps-select-control",3,"ngModel","ngClass","ngModelChange"],[3,"ngValue"],[3,"ngValue","disabled","ngClass",4,"ngFor","ngForOf"],["for","keyColumnPicker","id","keyColumnPickerLabel",1,"ft-label","required"],["name","keyColumnPicker","aria-required","true","id","keyColumnPicker","aria-labelledby","keyColumnPickerLabel keyColumnPickerError",1,"form-control","ps-select-control",3,"ngModel","ngClass","ngModelChange"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],["role","alert",1,"ft-row-block","alert"],[1,"glyphicon","error-button"],["id","ftDescriptionError",1,"ft-error-block"],[3,"ngValue","disabled","ngClass"],["id","rowLabelPickerError",1,"ft-error-block"],[3,"ngValue","disabled"],["id","keyColumnPickerError",1,"ft-error-block"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"template-dialog"),e.\u0275\u0275template(1,hc,49,48,"div",0),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.viewModel&&r.modelService.model&&r.modelService.model.tables))},dependencies:[ye.YN,ye.Kr,ye.Fj,ye.EJ,ye.JJ,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,Nt.J,Tt],styles:['.modern-dialogCloseIcon[_ngcontent-%COMP%]{background-color:var(--white-color);color:var(--gray-130);cursor:pointer;display:block;margin-left:auto;height:28px;width:28px}.modern-dialogCloseIcon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:8px}.modern-dialogCloseIcon[_ngcontent-%COMP%]:hover{background-color:var(--neutral-lighter-color)}.dragHandle[_ngcontent-%COMP%]{height:24px;left:0;position:absolute;top:0;width:100%;width:calc(100% - 28px)}.ft-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:327px}.ft-body-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:5px}.ft-body-container[_ngcontent-%COMP%]{display:block;font-size:12px;overflow-y:auto;width:100%}.ft-row[_ngcontent-%COMP%]{display:block;overflow:hidden}.ft-row-block[_ngcontent-%COMP%]{padding-right:10px;max-width:97%;float:left}.multiline-editor[_ngcontent-%COMP%]{resize:none}.ft-label[_ngcontent-%COMP%]{display:block;padding-bottom:5px;padding-right:5px}.ft-row-block-input[_ngcontent-%COMP%]{margin-bottom:5px}.ft-row-block-input[_ngcontent-%COMP%] > textarea[_ngcontent-%COMP%], input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:97.7%;box-sizing:content-box;padding:2px;background:var(--colorNeutralBackground1)}.ft-row-block-input-disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.required[_ngcontent-%COMP%]:after{content:"*";color:var(--warning-color);margin-left:3px;padding-top:12px;font:var(--sm-font-size)}.glyphicon[_ngcontent-%COMP%]{vertical-align:middle}.error-button[_ngcontent-%COMP%]{background:transparent;color:var(--neutral-secondary-alt-color);font-family:var(--fluent-font-family);font-size:16px;height:16px;line-height:0;width:20px;min-width:20px;padding:0;margin-left:7px}.error-button[_ngcontent-%COMP%]:focus{outline:0px solid transparent}.error-button[_ngcontent-%COMP%]:before{content:"\\ece4";font-family:PowrMDL2;color:var(--fluent-theme-error-dark-color);line-height:18px}.alert[_ngcontent-%COMP%]{background-color:var(--fluent-theme-error-background-color);width:97%;margin-top:2px;height:22px}.ft-error-block[_ngcontent-%COMP%]{color:var(--gray-160);display:inline-block;text-align:center;vertical-align:middle;margin-left:4px}.highlightInputError[_ngcontent-%COMP%]{border-color:var(--fluent-theme-error-dark-color)}.highlightInputError[_ngcontent-%COMP%]:focus{border-color:var(--fluent-theme-error-dark-color);outline:none}.ft-details-container[_ngcontent-%COMP%]{display:block;font-size:12px;padding:5px}.ft-details-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--colorBrandForegroundLink);cursor:pointer}  .pbi-dialog{border:none}']}),i}(),oi=function(i){return i.day="RelativeDateUnit_Day",i.month="RelativeDateUnit_Month",i.quarter="Insights_QuartersSingular",i.year="RelativeDateUnit_Year",i.days="RelativeDateUnit_Days",i.months="RelativeDateUnit_Months",i.quarters="Insights_QuartersPlural",i.years="RelativeDateUnit_Years",i}({}),mc=function(i){return i.Day="TimeUnit_Days",i.Month="TimeUnit_Months",i.Quarter="TimeUnit_Quarters",i.Year="TimeUnit_Years",i.Invalid="Generic_Select_Value",i}({}),qt=function(){function i(){}return i.calculateRefreshTimeLines=function(t,n){this.incrementalHead=this.calculateIncrementalHead(t,n),this.archiveFromDate=this.calculatearchiveFromDate(this.incrementalHead,n),this.refreshFromDate=this.calculaterefreshFromDate(this.incrementalHead,n),this.archiveToDate=this.calculateArchiveToDate(this.refreshFromDate),this.refreshToDate=this.calculateRefreshToDate(this.refreshFromDate,n),this.dqOnwardDate=this.calculateDirectQueryOnwardDate(t,n)},i.calculateRefreshToDate=function(t,n){var r=new Date(t.getTime());return(r=this.addGranularity(r,n.incrementalGranularity,n.incrementalPeriods)).setDate(r.getDate()-1),r},i.calculateDirectQueryOnwardDate=function(t,n){return this.getStartDateBasedOnGranularity(t,n.incrementalGranularity)},i.calculateArchiveToDate=function(t){var n=new Date(t.getTime());return n.setDate(n.getDate()-1),n},i.calculatearchiveFromDate=function(t,n){var r=new Date(t.getTime());return this.addGranularity(r,n.rollingWindowGranularity,-1*n.rollingWindowPeriods),this.getStartDateBasedOnGranularity(r,n.rollingWindowGranularity)},i.calculateIncrementalHead=function(t,n){var r=new Date(t.getTime());return this.addGranularity(r,n.incrementalGranularity,n.incrementalPeriodsOffset),this.getStartDateBasedOnGranularity(r,n.incrementalGranularity)},i.calculaterefreshFromDate=function(t,n){var r=new Date(t.getTime());return this.addGranularity(r,n.incrementalGranularity,1-n.incrementalPeriods)},i.getStartDateBasedOnGranularity=function(t,n){switch(n){case V.dQ.Year:return this.getStartOfYear(t);case V.dQ.Quarter:return this.getStartOfQuarter(t);case V.dQ.Month:return this.getStartOfMonth(t);case V.dQ.Day:return this.getStartOfDay(t);default:throw"Invalid Granularity"}},i.addGranularity=function(t,n,r){switch(n){case V.dQ.Year:return this.setYear(t,t.getFullYear()+r),t;case V.dQ.Quarter:return this.setMonth(t,t.getMonth()+3*r),t;case V.dQ.Month:return this.setMonth(t,t.getMonth()+r),t;case V.dQ.Day:return t.setDate(t.getDate()+r),t;default:throw"Invalid Granularity"}},i.setMonth=function(t,n){var r=t.getDate();return t.setMonth(n),t.getDate()!==r&&t.setDate(0),t},i.setYear=function(t,n){var r=t.getDate();return t.setFullYear(n),t.getDate()!==r&&t.setDate(0),t},i.getStartOfYear=function(t){return new Date(t.getFullYear(),0,1)},i.getStartOfQuarter=function(t){return new Date(t.getFullYear(),3*Math.floor(t.getMonth()/3),1)},i.getStartOfMonth=function(t){return new Date(t.getFullYear(),t.getMonth(),1)},i.getStartOfDay=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())},i}();function Ut(i){return void 0!==V.dQ[i]&&"string"==typeof V.dQ[i]&&V.dQ[i]!==V.dQ.Invalid}function Eo(i){return[V.dQ.Day,V.dQ.Month,V.dQ.Quarter,V.dQ.Year].indexOf(i)}var ai=p(76227),fc=function(){function i(t){this.windowLowerLimit=0,this.windowUpperLimit=120,this.targetTable=t,this.reset()}return Object.defineProperty(i.prototype,"isValid",{get:function(){return!this.isActive||this.isIncrementalRangeValid()&&this.isRollingRangeValid()&&this.isWindowGranularitiesValid()&&(!this.detectDataChanges||!!this.pollingColumnName)},enumerable:!1,configurable:!0}),i.prototype.isWindowGranularitiesValid=function(){if(!Ut(this.rollingWindowGranularity)||!Ut(this.incrementalGranularity))return!1;var t=Eo(this.incrementalGranularity),n=Eo(this.rollingWindowGranularity),r=this.convertToDaysForVerification(this.incrementalGranularity,this.incrementalPeriods),o=this.convertToDaysForVerification(this.rollingWindowGranularity,this.rollingWindowPeriods);return t>=0&&n>=0&&n>=t&&o>=r},i.prototype.isIncrementalPeriodNullOrValid=function(){return!this.incrementalPeriods||this.isIncrementalRangeValid()},i.prototype.isRollingPeriodNullOrValid=function(){return!this.rollingWindowPeriods||this.isRollingRangeValid()},i.prototype.isIncrementalRangeValid=function(){return!!this.incrementalPeriods&&this.incrementalPeriods>this.windowLowerLimit&&this.incrementalPeriods<=this.windowUpperLimit},i.prototype.isRollingRangeValid=function(){return!!this.rollingWindowPeriods&&this.rollingWindowPeriods>this.windowLowerLimit&&this.rollingWindowPeriods<=this.windowUpperLimit},i.prototype.isWindowGranularityParametersSet=function(){return!!(Ut(this.rollingWindowGranularity)&&Ut(this.incrementalGranularity)&&this.rollingWindowPeriods&&this.incrementalPeriods)},Object.defineProperty(i.prototype,"isDirty",{get:function(){return this.targetRefreshPolicy&&!this.isActive||!this.targetRefreshPolicy&&this.isActive||this.targetRefreshPolicy&&(this.targetRefreshPolicy.incrementalGranularity!==this.incrementalGranularity||this.targetRefreshPolicy.incrementalPeriods!==this.incrementalPeriods||this.targetRefreshPolicy.incrementalPeriodsOffset!==this.incrementalPeriodsOffset||this.targetRefreshPolicy.rollingWindowGranularity!==this.rollingWindowGranularity||this.targetRefreshPolicy.rollingWindowPeriods!==this.rollingWindowPeriods||this.pollingColumnDisabled&&this.targetRefreshPolicy.pollingExpression!==this.pollingExpression||this.targetRefreshPolicy.pollingColumnName!==this.pollingColumnName||this.targetTable.pollingExpressionSet!==this.detectDataChanges||this.targetRefreshPolicy.mode!==this.refreshPolicyMode)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"refreshPolicyMode",{get:function(){return this.allowDQ?V.fO.Hybrid:V.fO.Import},enumerable:!1,configurable:!0}),i.prototype.reset=function(){this.targetRefreshPolicy=this.targetTable.refreshPolicy,this.isActive=!!this.targetRefreshPolicy,this.targetRefreshPolicy?(this.incrementalPeriodsOffsetFlag=this.targetRefreshPolicy.incrementalPeriodsOffset===ai.v.PERIODS_OFFSET_SET,this.incrementalPeriods=this.targetRefreshPolicy.incrementalPeriods,this.incrementalGranularity=this.targetRefreshPolicy.incrementalGranularity,this.incrementalPeriodsOffset=this.targetRefreshPolicy.incrementalPeriodsOffset,this.rollingWindowPeriods=this.targetRefreshPolicy.rollingWindowPeriods,this.rollingWindowGranularity=this.targetRefreshPolicy.rollingWindowGranularity,this.pollingExpression=this.targetRefreshPolicy.pollingExpression,this.allowDQ=this.targetRefreshPolicy.mode===V.fO.Hybrid,this.detectDataChanges=this.targetTable.pollingExpressionSet,this.pollingColumnName=this.targetRefreshPolicy.pollingColumnName,this.pollingColumnDisabled=!!this.targetRefreshPolicy.pollingExpression&&!this.targetRefreshPolicy.pollingColumnName):(this.incrementalPeriodsOffsetFlag=!1,this.incrementalPeriods=null,this.incrementalGranularity=V.dQ.Invalid,this.incrementalPeriodsOffset=0,this.rollingWindowPeriods=null,this.rollingWindowGranularity=V.dQ.Invalid,this.pollingExpression=null,this.allowDQ=!1,this.detectDataChanges=!1,this.pollingColumnName=null,this.pollingColumnDisabled=!1)},i.prototype.rollingWindowDetailsFriendlyName=function(t){var n=t.format("Incremental_Refresh_Rolling_Window_Prefix"),r=t.format("Incremental_Refresh_Rolling_Window_Suffix");return n+' "'+this.targetTable.partitionColumnName+'" '+r},i.prototype.incrementalWindowDetailsFriendlyName=function(t){var n=t.format("Incremental_Refresh_Incremental_Window_Prefix"),r=t.format("Incremental_Refresh_Rolling_Window_Suffix");return n+' "'+this.targetTable.partitionColumnName+'" '+r},i.prototype.detectDataChangesFriendlyName=function(t){if(!this.incrementalPeriods||!this.incrementalGranularity)return t.format("Incremental_Refresh_Detect_Data_Changes_Label");var n=t.format("Incremental_Refresh_Detect_Data_Changes_Label_Prefix"),r=t.format("Incremental_Refresh_Detect_Data_Changes_Label_Suffix"),o=this.incrementalPeriods>1?this.incrementalGranularity.toLowerCase()+"s":this.incrementalGranularity.toLowerCase(),a=t.format(oi[o]);return n+this.incrementalPeriods+" "+a+" "+r},i.prototype.importRangeFriendlyName=function(t){if(!this.rollingWindowPeriods||!Ut(this.rollingWindowGranularity))return t.format("Incremental_Refresh_With_DQ_Archival_Start_Label");var n=this.rollingWindowPeriods>1?this.rollingWindowGranularity.toLowerCase()+"s":this.rollingWindowGranularity.toLowerCase(),r=t.format(oi[n]),o=t.format("Incremental_Refresh_With_DQ_Before_Refresh_Label");return"".concat(this.rollingWindowPeriods," ").concat(r," ").concat(o)},i.prototype.refreshRangeFriendlyName=function(t){if(!this.incrementalPeriods||!Ut(this.incrementalGranularity))return t.format("Incremental_Refresh_With_DQ_Refresh_Start_Label");var n=this.incrementalPeriods>1?this.incrementalGranularity.toLowerCase()+"s":this.incrementalGranularity.toLowerCase(),r=t.format(oi[n]),o=t.format("Incremental_Refresh_With_DQ_Before_Refresh_Label");return"".concat(this.incrementalPeriods," ").concat(r," ").concat(o)},i.prototype.importDateRangeStringRepresentation=function(t){if(this.isWindowGranularityParametersSet()){qt.calculateRefreshTimeLines(new Date,this);var r=qt.archiveFromDate.toLocaleDateString(),o=qt.archiveToDate.toLocaleDateString();return t.format("Incremental_Refresh_With_DQ_Import_Timelines_Info",r,o)}},i.prototype.refreshDateRangeStringRepresentation=function(t){if(this.isWindowGranularityParametersSet()){qt.calculateRefreshTimeLines(new Date,this);var r=qt.refreshFromDate.toLocaleDateString(),o=qt.refreshToDate.toLocaleDateString();return t.format("Incremental_Refresh_With_DQ_Refresh_Timelines_Info",r,o)}},i.prototype.realTimeOnwardDataStringRepresentation=function(t){qt.calculateRefreshTimeLines(new Date,this);var r=qt.dqOnwardDate.toLocaleDateString();return t.format("Incremental_Refresh_With_DQ_Onward_Timelines_Info",r)},i.prototype.incrementalRefreshCompleteFriendlyName=function(t){if(!this.incrementalPeriods||!this.incrementalGranularity)return t.format("Incremental_Refresh_Refresh_Complete_Periods_Label_Default");var n=t.format("Incremental_Refresh_Refresh_Complete_Periods_Label"),r=this.incrementalPeriods>1?this.incrementalGranularity.toLowerCase()+"s":this.incrementalGranularity.toLowerCase();return n+" "+t.format(oi[r])},i.prototype.setPeriodsOffset=function(){this.incrementalPeriodsOffset=ai.v.PERIODS_OFFSET_SET},i.prototype.unsetPeriodsOffset=function(){this.incrementalPeriodsOffset=ai.v.PERIODS_OFFSET_NOT_SET},i.prototype.toASRefreshPolicy=function(){if(this.isActive){var t=new ai.v;return t.incrementalPeriods=this.incrementalPeriods,t.incrementalGranularity=this.incrementalGranularity,t.incrementalPeriodsOffset=this.incrementalPeriodsOffset,t.mode=this.refreshPolicyMode,t.rollingWindowGranularity=this.rollingWindowGranularity,t.rollingWindowPeriods=this.rollingWindowPeriods,t.pollingColumnName=this.pollingColumnName,t.pollingExpression=this.pollingExpression,t.policyType=V.xL.Basic,t.table=this.targetTable,t}return null},i.prototype.finalizePollingExpressionSettings=function(){this.detectDataChanges?this.pollingColumnDisabled&&(this.pollingColumnName=null,this.pollingExpression=this.targetRefreshPolicy.pollingExpression):(this.pollingColumnName=null,this.pollingExpression=null)},i.prototype.convertToDaysForVerification=function(t,n){if(t&&n&&Ut(t))switch(t){case V.dQ.Day:return n;case V.dQ.Month:return 30*n;case V.dQ.Quarter:return 90*n;case V.dQ.Year:return 365*n}},i}(),en=p(32293),li=p(25561),rr=p(55369),or=p(70268),vc=["*"],ar=function(){function i(t){this.highContrastCssGenerationService=t,this.initializeHighContrastRules()}return i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".mat-select-panel::-webkit-scrollbar","{ background-color: @backgroundColor !important; border: 2px solid @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-select-panel::-webkit-scrollbar-track","{ background-color: @backgroundColor !important; box-shadow: inset 0 0 5px @foregroundColor  ! important; }"),this.highContrastCssGenerationService.addRule(".mat-select-panel::-webkit-scrollbar-thumb","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-select-panel::-webkit-scrollbar-button:single-button:vertical:decrement",'{ background: @foregroundColor url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" viewbox="0 0 20 20" version="1.1" style="position:absolute;width:0;height:0"><polygon style="stroke:@foregroundColor;fill:@backgroundColor;" points="0, 13, 8, 0, 16, 13"></polygon></svg>\') !important;'),this.highContrastCssGenerationService.addRule(".mat-select-panel::-webkit-scrollbar-button:single-button:vertical:increment",'{ background: @foregroundColor url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" viewbox="0 0 20 20" version="1.1" style="position:absolute;width:0;height:0"><polygon style="stroke:@foregroundColor;fill:@backgroundColor;" points="0, 4, 8, 16, 16, 4"></polygon></svg>\') !important;'),this.highContrastCssGenerationService.addRule(".mat-select-panel::-webkit-scrollbar-button","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-table::-webkit-scrollbar","{ background-color: @backgroundColor !important; border: 2px solid @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-table::-webkit-scrollbar-track","{ background-color: @backgroundColor !important; box-shadow: inset 0 0 5px @foregroundColor  ! important; }"),this.highContrastCssGenerationService.addRule(".mat-table::-webkit-scrollbar-thumb","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-table::-webkit-scrollbar-button:single-button:vertical:decrement",'{ background: @foregroundColor url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" viewbox="0 0 20 20" version="1.1" style="position:absolute;width:0;height:0"><polygon style="stroke:@foregroundColor;fill:@backgroundColor;" points="0, 13, 8, 0, 16, 13"></polygon></svg>\') !important;'),this.highContrastCssGenerationService.addRule(".mat-table::-webkit-scrollbar-button:single-button:vertical:increment",'{ background: @foregroundColor url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" viewbox="0 0 20 20" version="1.1" style="position:absolute;width:0;height:0"><polygon style="stroke:@foregroundColor;fill:@backgroundColor;" points="0, 4, 8, 16, 16, 4"></polygon></svg>\') !important;'),this.highContrastCssGenerationService.addRule(".mat-table::-webkit-scrollbar-button","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-select-arrow","{ border-left: 5px solid transparent !important; border-right: 5px solid transparent !important; }"),this.highContrastCssGenerationService.addRule(".ma-disabled-select","{ border: 2px solid @disabledTextColor !important; }"),this.highContrastCssGenerationService.addRule(".ma-disabled-select .mat-select-arrow","{ color: @disabledTextColor !important; border-color: @disabledTextColor !important; border-left: 5px solid transparent !important; border-right: 5px solid transparent !important; }"),this.highContrastCssGenerationService.addRule(".ma-enabled-select:focus .mat-select-value-text > span","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".ma-enabled-select:focus","{ background-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".ma-enabled-select:focus .mat-select-placeholder","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".ma-enabled-select:focus .mat-select-value","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".ma-enabled-select:focus .mat-select-value-text","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".ma-enabled-select:focus .mat-select-arrow","{ color: @selectedForegroundColor !important; border-color: @selectedForegroundColor !important; border-left: 5px solid transparent !important; border-right: 5px solid transparent !important; }"),this.highContrastCssGenerationService.addRule(".mat-option.mat-active","{ background-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-option.mat-active > .mat-option-text","{ color: @selectedForegroundColor !important; }"),this.highContrastCssGenerationService.addRule(".mat-option.mat-option-disabled > .mat-option-text","{ color: @disabledTextColor !important; }"),this.highContrastCssGenerationService.addRule("input[disabled]::-webkit-input-placeholder","{ color: @disabledTextColor !important; }"),this.highContrastCssGenerationService.addRule("input:not([disabled])::-webkit-input-placeholder","{ color: @foregroundColor !important; }")},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(D.g))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["modeling-styles"]],ngContentSelectors:vc,decls:1,vars:0,template:function(n,r){1&n&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275projection(0))},styles:['@charset "UTF-8";  modeling-styles button{border:0;font-family:Segoe UI,wf_segoe-ui_normal,helvetica,arial,sans-serif;font-size:14px;padding:0}  modeling-styles input,   modeling-styles textarea{font-family:Segoe UI,wf_segoe-ui_normal,helvetica,arial,sans-serif;font-size:12px}  modeling-styles input.checkbox[type=checkbox]{position:absolute;opacity:0}  modeling-styles input.checkbox[type=checkbox]+label{cursor:pointer;overflow:hidden;padding-left:24px;position:relative;text-overflow:ellipsis;white-space:nowrap}  modeling-styles input.checkbox[type=checkbox]:not(:checked)+label:before{border:1px solid #cacaca;content:"";height:12px;left:0;position:absolute;top:2px;width:12px;background:var(--white-color)}  modeling-styles input.checkbox[type=checkbox]:checked+label:before{border:1px solid #cacaca;content:"";height:12px;left:0;position:absolute;top:2px;width:12px;background:var(--theme-primary-color);border-color:var(--theme-primary-color)}  modeling-styles input.checkbox[type=checkbox]+label:after{color:var(--black-color);content:"\\2714";font-size:12px;left:3px;line-height:12px;position:absolute;top:2px;transition:color .07s ease-in,margin-bottom .07s ease-in}  modeling-styles input.checkbox[type=checkbox]:not(:checked)+label:after{opacity:0;transform:scale(0)}  modeling-styles input.checkbox[type=checkbox]:checked+label:after{opacity:1;transform:scale(1)}  modeling-styles input.checkbox[type=checkbox]:disabled:checked+label:before{background-color:#ddd;border-color:#bbb;box-shadow:none}  modeling-styles input.checkbox[type=checkbox]:disabled:checked+label:after{color:var(--neutral-secondary-alt-color3)}  modeling-styles input.checkbox[type=checkbox]:disabled+label{color:#aaa}  modeling-styles input.checkbox[type=checkbox]:indeterminate+label:before{background:var(--theme-primary-color);border-color:var(--theme-primary-color)}  modeling-styles input.checkbox[type=checkbox]:indeterminate+label:after{content:"\\2012";font-weight:700;opacity:1;transform:scale(1)}  modeling-styles input.checkbox[type=checkbox]:focus+label{outline:auto 1px;outline-color:-webkit-focus-ring-color}  modeling-styles .noselect{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}  modeling-styles .custom-scroll-y{overflow:hidden;overflow-y:auto}  modeling-styles .custom-scroll-y::-webkit-scrollbar,   modeling-styles .custom-scroll-xy::-webkit-scrollbar{width:8px}  modeling-styles .custom-scroll-x::-webkit-scrollbar,   modeling-styles .custom-scroll-xy::-webkit-scrollbar{height:8px}  modeling-styles .custom-scroll-y::-webkit-scrollbar-thumb,   modeling-styles .custom-scroll-xy::-webkit-scrollbar-thumb{background-color:#aaa;border-radius:4px;outline:1px solid transparent}  modeling-styles .custom-scroll-x{overflow:hidden;overflow-x:auto}  modeling-styles .mat-select-auto-size .mat-select-value{max-width:100%;min-width:180px;width:auto}  modeling-styles .cdk-virtual-scroll-viewport::-webkit-scrollbar{width:8px}  modeling-styles .cdk-virtual-scroll-viewport::-webkit-scrollbar-thumb{background-color:#aaa;border-radius:4px;outline:1px solid transparent}']}),i}();function _c(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",52),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Set_Policy_Warning")))}function bc(i,t){1&i&&(e.\u0275\u0275elementContainerStart(0,53),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementContainerEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Table_Mode_Warning")," "))}function yc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",55),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"a",56),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,2,"Incremental_Refresh_Include_In_Report_Refresh_Warning")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,4,"Generic_LearnMore")))}function Cc(i,t){if(1&i&&e.\u0275\u0275template(0,yc,6,6,"span",54),2&i){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(9),r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",r.showIncludeInReportRefreshWarning)("ngIfElse",n)}}function Sc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",58),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"a",56),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,2,"Incremental_Refresh_Parameter_Warning")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,4,"Generic_LearnMore")))}function Mc(i,t){if(1&i&&e.\u0275\u0275template(0,Sc,6,6,"span",57),2&i){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(11),r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",r.showParameterWarning)("ngIfElse",n)}}function wc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",60),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"a",61),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,2,"Incremental_Refresh_M_Query_Folding_Warning")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,4,"Generic_LearnMore")))}function xc(i,t){if(1&i&&e.\u0275\u0275template(0,wc,6,6,"span",59),2&i){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngIf",n.showMQueryUnfoldableWaring())}}function Pc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"div",44),e.\u0275\u0275element(2,"div",45),e.\u0275\u0275elementStart(3,"div",46),e.\u0275\u0275template(4,_c,3,3,"span",47),e.\u0275\u0275template(5,bc,3,3,"ng-container",48),e.\u0275\u0275template(6,Cc,1,2,"ng-template",null,49,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(8,Mc,1,2,"ng-template",null,50,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(10,xc,1,1,"ng-template",null,51,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()()),2&i){var n=e.\u0275\u0275reference(7),r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",!r.canApplyRefreshPolicy),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.showModeWarning)("ngIfElse",n)}}function Oc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",62),e.\u0275\u0275element(1,"div",63),e.\u0275\u0275elementStart(2,"span",64),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementStart(5,"a",56),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(4,2,"Incremental_Refresh_Help")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,4,"Generic_LearnMore")))}function Ec(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"option",65),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.name)}}function Dc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"label",66),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"ToggleSwitchOn")))}function Tc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"label",66),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"ToggleSwitchOff")))}function Ic(i,t){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"option",67),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.getRefreshGranularityFriendlyName(n)," ")}}function Rc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Period_Validation_Message")," "))}function Ac(i,t){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"option",67),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.getRefreshGranularityFriendlyName(n)," ")}}function Fc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Period_Validation_Message"),""))}function kc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Invalid_Granularity_Message"),""))}function Bc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"option",65),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n)}}function Lc(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",21)(1,"label",68),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"select",69),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.currentPolicyEdit.pollingColumnName=a)}),e.\u0275\u0275template(4,Bc,2,2,"option",16),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275classMap(r.refreshActive&&!r.currentPolicyEdit.pollingColumnDisabled&&r.canApplyRefreshPolicy?"ir-label":"ir-label-disabled"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(r.detectDataChangesLabelContent),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.pollingColumnName)("disabled",!r.refreshActive||r.currentPolicyEdit.pollingColumnDisabled||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.getDateTimeColumnNames())}}var lr=function(t){return{"ir-invalid-select":t}};function Nc(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",4)(1,"div",5)(2,"div",6)(3,"span",7),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,Pc,12,3,"div",8),e.\u0275\u0275elementStart(7,"div",9),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,Oc,8,6,"div",10),e.\u0275\u0275elementStart(11,"div",11)(12,"div",12)(13,"div",13)(14,"label",14),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"select",15),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentTable=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.tableSelectionChanged())}),e.\u0275\u0275template(18,Ec,2,2,"option",16),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"div",13)(20,"label",17),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"label",18)(24,"mat-slide-toggle",19),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.refreshActive=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.toggleRefresh())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(25,Dc,3,3,"label",20),e.\u0275\u0275template(26,Tc,3,3,"label",20),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(27,"div",11)(28,"div",21)(29,"label",22),e.\u0275\u0275text(30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"div",23)(32,"input",24),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.rollingWindowPeriods=a)}),e.\u0275\u0275pipe(33,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(34,"select",25),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.rollingWindowGranularity=a)}),e.\u0275\u0275elementStart(35,"option",26),e.\u0275\u0275text(36),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(38,Ic,3,2,"ng-container",27),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(39,"div",21)(40,"div",28),e.\u0275\u0275template(41,Rc,3,3,"div",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(42,"div",21)(43,"label",29),e.\u0275\u0275text(44),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"div",30)(46,"input",31),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.incrementalPeriods=a)}),e.\u0275\u0275pipe(47,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(48,"select",32),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.incrementalGranularity=a)}),e.\u0275\u0275elementStart(49,"option",26),e.\u0275\u0275text(50),e.\u0275\u0275pipe(51,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(52,Ac,3,2,"ng-container",27),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(53,"div",21)(54,"div",33),e.\u0275\u0275template(55,Fc,3,3,"div",8),e.\u0275\u0275template(56,kc,3,3,"div",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(57,"div",21)(58,"input",34),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.detectDataChanges=a)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(59,"label",35),e.\u0275\u0275text(60),e.\u0275\u0275pipe(61,"translate"),e.\u0275\u0275elementStart(62,"a",36),e.\u0275\u0275text(63),e.\u0275\u0275pipe(64,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(65,Lc,5,7,"div",37),e.\u0275\u0275elementStart(66,"div",21)(67,"input",38),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.incrementalPeriodsOffsetFlag=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.refreshPeriodOffsetChanged())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(68,"label",39),e.\u0275\u0275text(69),e.\u0275\u0275elementStart(70,"a",40),e.\u0275\u0275text(71),e.\u0275\u0275pipe(72,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(73,"div",41)(74,"button",42),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.saveAll())}),e.\u0275\u0275text(75),e.\u0275\u0275pipe(76,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(77,"button",43),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.cancel())}),e.\u0275\u0275text(78),e.\u0275\u0275pipe(79,"translate"),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(5,55,"Incremental_Refresh_Label_Generic")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.canApplyRefreshPolicy||r.showIncludeInReportRefreshWarning||r.showParameterWarning||r.showMQueryUnfoldableWaring()),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(9,57,"Incremental_Refresh_Details")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.showParameterWarning),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,59,"Table_ToolTip")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.currentTable)("disabled",!r.canApplyRefreshPolicy),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.userTables),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(22,61,"Incremental_Refresh_Label_Generic")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.refreshActive)("disabled",!r.canApplyRefreshPolicy||r.isRefreshDisabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.refreshActive),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.refreshActive),e.\u0275\u0275advance(3),e.\u0275\u0275classMap(r.currentPolicyEdit.isActive&&r.canApplyRefreshPolicy?"ir-label":"ir-label-disabled"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(r.rollingWindowDetailsLabelContent),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(33,63,"Generic_Enter_Value")),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(81,lr,!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isRollingPeriodNullOrValid())))("ngModel",r.currentPolicyEdit.rollingWindowPeriods)("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.rollingWindowGranularity)("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("value",r.invalidWindowGranularity),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(37,65,"Generic_Select_Value")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.getRefreshGranularities()),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.currentPolicyEdit.isActive&&!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isRollingPeriodNullOrValid())),e.\u0275\u0275advance(2),e.\u0275\u0275classMap(r.currentPolicyEdit.isActive&&r.canApplyRefreshPolicy?"ir-label":"ir-label-disabled"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(r.incrementalWindowDetailsLabelContent),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(47,67,"Generic_Enter_Value")),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(83,lr,!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isIncrementalPeriodNullOrValid())))("ngModel",r.currentPolicyEdit.incrementalPeriods)("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.incrementalGranularity)("ngClass",e.\u0275\u0275pureFunction1(85,lr,r.currentPolicyEdit.isActive&&(null==r.currentPolicyEdit?null:r.currentPolicyEdit.isWindowGranularityParametersSet())&&!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isWindowGranularitiesValid())))("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("value",r.invalidWindowGranularity),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(51,69,"Generic_Select_Value")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.getRefreshGranularities()),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.currentPolicyEdit.isActive&&!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isIncrementalPeriodNullOrValid())),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.currentPolicyEdit.isActive&&(null==r.currentPolicyEdit?null:r.currentPolicyEdit.isWindowGranularityParametersSet())&&!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isWindowGranularitiesValid())),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.detectDataChanges)("disabled",!r.refreshActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(61,71,"Incremental_Refresh_Refresh_Trigger_Label")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(64,73,"Generic_LearnMore")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.currentPolicyEdit.detectDataChanges),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.incrementalPeriodsOffsetFlag)("disabled",!r.refreshActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",r.incrementalRefreshCompleteLabelContent," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(72,75,"Generic_LearnMore")),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",!r.viewActive||!r.stagedChanges||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(76,77,"Apply_All")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(79,79,"ModalDialog_Cancel")," ")}}var sr=function(){function i(t,n,r,o,a,l,s,c){this.modelService=t,this.localizationService=n,this.telemetryEventService=r,this.extendedSchemaChangeService=o,this.highContrastCssGenerationService=a,this.zone=l,this.dialogRef=s,this.matDialogData=c,this.viewActive=!1,this.queryFoldableAnnotationName="PBI_IsMQueryFoldable",this.initializeHighContrastRules()}return i.prototype.ngOnInit=function(){this.show(this.matDialogData)},i.prototype.show=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(r){return t?.table?(this.data=t,this.zone.run(function(){n.canApplyRefreshPolicy=n.modelService.model.canApplyRefreshPolicy,n.currentTable=n.modelService.model.findTable(n.data.table),n.userTables=n.initializeUserTables(),n.initializeRefreshEdits(),n.tableSelectionChanged(),n.telemetryEventService.logEvent("RefreshPolicyDialogOpen"),n.viewActive=!0}),[2]):(I.fF.assertFail("Incremental refresh dialog opened without a table name"),[2])})})},i.prototype.initializeUserTables=function(){if(this.modelService.model&&this.modelService.model.tables)return _.values(li.k.getUserTables(this.modelService.model.tables,!1,!1,!1))},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule("label.ir-label-disabled","{ color: @disabledTextColor !important; }")},i.prototype.initializeRefreshEdits=function(){if(this.modelService.model&&this.modelService.model.tables){this.editablePolicies=[];for(var t=0,n=_.values(li.k.getUserTables(this.modelService.model.tables,!1,!1,!1));t<n.length;t++){var o=new fc(n[t]);this.editablePolicies.push(o)}}},i.prototype.toggleRefresh=function(){this.currentTable&&(this.currentPolicyEdit.isActive=this.refreshActive)},i.prototype.getRefreshGranularities=function(){return Object.keys(V.dQ).filter(function(t){return Ut(t)})},i.prototype.getRefreshGranularityFriendlyName=function(t){return this.localizationService.format(mc[t])},Object.defineProperty(i.prototype,"invalidWindowGranularity",{get:function(){return V.dQ.Invalid},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rollingWindowDetailsLabelContent",{get:function(){return this.currentPolicyEdit&&this.currentPolicyEdit.isActive&&this.currentPolicyEdit.targetTable.partitionColumnName?this.currentPolicyEdit.rollingWindowDetailsFriendlyName(this.localizationService):this.localizationService.format("Incremental_Refresh_Rolling_Window_Default")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"incrementalWindowDetailsLabelContent",{get:function(){return this.currentPolicyEdit&&this.currentPolicyEdit.isActive&&this.currentPolicyEdit.targetTable.partitionColumnName?this.currentPolicyEdit.incrementalWindowDetailsFriendlyName(this.localizationService):this.localizationService.format("Incremental_Refresh_Incremental_Window_Default")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stagedChanges",{get:function(){return this.editablePolicies.every(function(n){return n.isValid})&&this.editablePolicies.some(function(n){return n.isDirty})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showIncludeInReportRefreshWarning",{get:function(){return this.currentTable&&this.currentTable.excludeFromModelRefresh},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"areParametersSet",{get:function(){return this.currentTable&&this.currentTable.canSetRefreshPolicy},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showParameterWarning",{get:function(){return this.currentTable&&!this.areParametersSet},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showModeWarning",{get:function(){return null===this.currentTable.partitions||this.currentTable.partitions.get(0).mode!==V.XG.Import},enumerable:!1,configurable:!0}),i.prototype.showMQueryUnfoldableWaring=function(){if(this.currentTable.annotations&&this.currentTable.annotations.findByName(this.queryFoldableAnnotationName)){var t=this.currentTable.annotations.findByName(this.queryFoldableAnnotationName);if(t&&null!=t.value)return!1}return!0},Object.defineProperty(i.prototype,"isRefreshDisabled",{get:function(){return!(this.currentTable&&this.areParametersSet)},enumerable:!1,configurable:!0}),i.prototype.tableSelectionChanged=function(){var t=this;if(!this.currentTable)return this.currentTable=null,this.currentPolicyEdit=null,void(this.refreshActive=!1);var n=this.editablePolicies.find(function(r){return r.targetTable.name===t.currentTable.name});n?(this.currentPolicyEdit=n,this.refreshActive=this.currentPolicyEdit.isActive):(this.currentPolicyEdit=null,this.refreshActive=!1)},i.prototype.refreshPeriodOffsetChanged=function(){this.currentPolicyEdit.incrementalPeriodsOffsetFlag?this.currentPolicyEdit.setPeriodsOffset():this.currentPolicyEdit.unsetPeriodsOffset()},i.prototype.saveAll=function(){for(var t=this,n=[],o=0,a=this.editablePolicies.filter(function(c){return c.isDirty});o<a.length;o++){var l=a[o];l.finalizePollingExpressionSettings();var s=l.toASRefreshPolicy();n.push({object:l.targetTable,newValue:s}),this.telemetryEventService.logEvent("RefreshPolicySchemaApply")}n.length&&this.extendedSchemaChangeService.setRefreshPolicy(n).then(function(){t.dialogRef.close()},function(c){})},i.prototype.cancel=function(){this.dialogRef.close()},i.prototype.getDateTimeColumnNames=function(){return this.currentTable.columns.filter(function(t){return t.modelDataType===V.nH.DateTime&&t.columnType!==V.QD.Calculated&&t.columnType!==V.QD.CalculatedTableColumn}).map(function(t){return t.name})},Object.defineProperty(i.prototype,"detectDataChangesLabelContent",{get:function(){return this.currentPolicyEdit&&this.currentPolicyEdit.isActive&&this.currentPolicyEdit.incrementalPeriods&&Ut(this.currentPolicyEdit.incrementalGranularity)?this.currentPolicyEdit.detectDataChangesFriendlyName(this.localizationService):this.localizationService.format("Incremental_Refresh_Detect_Data_Changes_Label")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"incrementalRefreshCompleteLabelContent",{get:function(){return this.currentPolicyEdit&&this.currentPolicyEdit.isActive&&this.currentPolicyEdit.incrementalPeriods&&Ut(this.currentPolicyEdit.incrementalGranularity)?this.currentPolicyEdit.incrementalRefreshCompleteFriendlyName(this.localizationService):this.localizationService.format("Incremental_Refresh_Refresh_Complete_Periods_Label_Default")},enumerable:!1,configurable:!0}),i.dialogNameKey=Rt.Lw,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Oe.b),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(or.E),e.\u0275\u0275directiveInject(rr.N),e.\u0275\u0275directiveInject(D.g),e.\u0275\u0275directiveInject(e.NgZone),e.\u0275\u0275directiveInject(en.so),e.\u0275\u0275directiveInject(en.WI))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["incremental-refresh-policy-dialog"]],features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)([],an,!0))],decls:6,vars:1,consts:[["mat-dialog-title","",1,"dragHandle","mat-dialog-title"],[1,"modern-dialogCloseIcon","themeableElement",3,"click"],[1,"glyphicon","pbi-glyph-close"],["class","ir-dialog-container","cdkFocusInitial","",4,"ngIf"],["cdkFocusInitial","",1,"ir-dialog-container"],[1,"ir-body","themeableElement"],[1,"ir-title-container"],[1,"ir-title-content"],[4,"ngIf"],[1,"ir-details-container"],["class","ir-help-container",4,"ngIf"],[1,"ir-body-container"],[1,"ir-row"],[1,"ir-row-block"],["id","tableLabel","for","tableInput",1,"ir-label"],["autofocus","","id","tableInput","aria-labelledby","tableLabel tableWarnLabel includeInReportRefreshWarnLabel paramWarnLabel policyWarnLabel",3,"ngModel","disabled","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["id","incrLabel",1,"ir-label"],["for","incrementalRefreshSwitch",1,"ir-label"],["id","incrementalRefreshSwitch","aria-labelledby","incrLabel",1,"ir-toggle",3,"ngModel","disabled","ngModelChange"],["class","ir-toggle-label","for","incrementalRefreshSwitch",4,"ngIf"],[1,"ir-row","ir-row-block"],["for","rollingWindowSettingsInput","id","rollingWindowLabel"],["id","rollingWindowSettingsInput",1,"ir-row-block-container"],["type","number","id","rollingWindowPeriods","min","1","max","120","aria-valuemin","1","aria-valuemax","120","required","","aria-required","true","aria-labelledby","rollingWindowLabel","aria-controls","rollingPeriodValidationLabel",1,"ir-num-input",3,"ngClass","ngModel","placeholder","disabled","ngModelChange"],["id","rollingWindowGranularity","aria-labelledby","rollingWindowLabel",3,"ngModel","disabled","ngModelChange"],["selected","",3,"value"],[4,"ngFor","ngForOf"],["role","alert","aria-live","polite","id","rollingPeriodValidationLabel",1,"ir-validation-message"],["for","incrementalSettingsInput","id","incrementalWindowLabel"],["id","incrementalSettingsInput",1,"ir-row-block-container"],["type","number","id","incrementalPeriods","min","1","max","120","aria-valuemin","1","aria-valuemax","120","required","","aria-required","true","aria-labelledby","incrementalWindowLabel","aria-controls","validationMessage",1,"ir-num-input",3,"ngClass","ngModel","placeholder","disabled","ngModelChange"],["id","incrementalGranularity","aria-labelledby","incrementalWindowLabel","aria-controls","validationMessage",3,"ngModel","ngClass","disabled","ngModelChange"],["id","validationMessage","role","alert","aria-live","polite",1,"ir-validation-message"],["id","detectDataChangesInput","type","checkbox","aria-label","detectDataChangesInput",1,"checkbox",3,"ngModel","disabled","ngModelChange"],["for","detectDataChangesInput"],["href","https://go.microsoft.com/fwlink/?linkid=869753","target","_blank",1,"ir-link"],["class","ir-row ir-row-block",4,"ngIf"],["id","incrementalPeriodOffsetInput","type","checkbox","aria-labelledby","periodLabel",1,"checkbox",3,"ngModel","disabled","ngModelChange"],["for","incrementalPeriodOffsetInput","id","periodLabel"],["href","https://go.microsoft.com/fwlink/?linkid=869754","target","_blank",1,"ir-link"],[1,"ir-action-button-container","themeableElement"],[1,"ir-button","ir-save-button",3,"disabled","click"],[1,"ir-button",3,"click"],[1,"ir-warning-container"],[1,"ir-symbol","ir-warning-symbol"],[1,"ir-warning-content"],["id","policyWarnLabel",4,"ngIf"],["id","tableWarnLabel",4,"ngIf","ngIfElse"],["checkForIncludeInReportRefresh",""],["checkForParameters",""],["checkForMFolding",""],["id","policyWarnLabel"],["id","tableWarnLabel"],["id","includeInReportRefreshWarnLabel",4,"ngIf","ngIfElse"],["id","includeInReportRefreshWarnLabel"],["href","https://go.microsoft.com/fwlink/?linkid=869752","target","_blank",1,"ir-link"],["id","paramWarnLabel",4,"ngIf","ngIfElse"],["id","paramWarnLabel"],["id","queryFoldingWarning",4,"ngIf"],["id","queryFoldingWarning"],["href","https://go.microsoft.com/fwlink/?linkid=2050828","target","_blank",1,"ir-link"],[1,"ir-help-container"],[1,"ir-symbol","ir-help-symbol"],[1,"ir-help-content"],[3,"ngValue"],["for","incrementalRefreshSwitch",1,"ir-toggle-label"],[3,"value"],["for","refreshTriggerColumnInput","id","detectColumnLabel"],["id","refreshTriggerColumnInput","aria-labelledby","detectColumnLabel",3,"ngModel","disabled","ngModelChange"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"modeling-styles"),e.\u0275\u0275elementContainerStart(1),e.\u0275\u0275element(2,"div",0),e.\u0275\u0275elementStart(3,"div",1),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275element(4,"span",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275template(5,Nc,80,87,"div",3),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",r.viewActive&&r.modelService.model&&r.modelService.model.tables))},dependencies:[ye.YN,ye.Kr,ye.Fj,ye.wV,ye.Wl,ye.EJ,ye.JJ,ye.Q7,ye.qQ,ye.Fd,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,ar,Tt],styles:['@charset "UTF-8";.modern-dialogCloseIcon[_ngcontent-%COMP%]{background-color:var(--white-color);color:var(--gray-130);cursor:pointer;display:block;margin-left:auto;height:28px;width:28px}.modern-dialogCloseIcon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:8px}.modern-dialogCloseIcon[_ngcontent-%COMP%]:hover{background-color:var(--neutral-lighter-color)}.dragHandle[_ngcontent-%COMP%]{height:24px;left:0;position:absolute;top:0;width:100%;width:calc(100% - 28px)}[_nghost-%COMP%]{--barBackgroundInfo: var(--fluent-theme-neutral-light-color, @fluentThemeNeutralLightColor);--barBackgroundWarning: var(--alert-color, @alertColor);--barBorderInfo: none;--barBorderWarning: none;--linkColor: var(--info-dark-color, @infoDarkColor)}[data-legacy-theming=false]   [_nghost-%COMP%]{--barBackgroundInfo: var(--colorNeutralBackground1);--barBackgroundWarning: var(--colorWarningBackground1);--barBorderInfo: 1px solid var(--colorNeutralStrokeAccessible);--barBorderWarning: 1px solid var(--colorWarningBorder1);--linkColor: var(--colorBrandForegroundLink)}.ir-dialog-container[_ngcontent-%COMP%]{padding:0 28px;display:flex;flex-direction:column;height:640px;width:660px;box-sizing:border-box}.ir-dialog-container[_ngcontent-%COMP%]   .ir-body[_ngcontent-%COMP%]{margin:0;min-height:calc(100% - 60px);height:calc(100% - 60px);padding-bottom:0}.ir-dialog-container[_ngcontent-%COMP%]   .ir-action-button-container[_ngcontent-%COMP%]{position:static;bottom:0;width:100%}.ir-title-container[_ngcontent-%COMP%]{display:flex;padding-bottom:10px;width:100%}.ir-title-content[_ngcontent-%COMP%]{font-size:20px;font-weight:600}.ir-details-container[_ngcontent-%COMP%]{display:block;font-size:12px;padding:5px 5px 10px;width:100%}.ir-help-container[_ngcontent-%COMP%]{background-color:var(--barBackgroundInfo);border:var(--barBorderInfo);display:flex;margin-right:10px;padding:5px 5px 10px;width:calc(100% - 20px)}.ir-help-symbol[_ngcontent-%COMP%]:before{content:"\\e946";font-family:PowrMDL2;font-size:15px}.ir-warning-symbol[_ngcontent-%COMP%]:before{content:"\\e7ba";font-family:PowrMDL2;font-size:15px;display:flex;padding-left:5px}.ir-symbol[_ngcontent-%COMP%]{padding:5px;text-align:center}.ir-warning-container[_ngcontent-%COMP%]{background-color:var(--barBackgroundWarning);border:var(--barBorderWarning);display:inline-flex;align-items:center;font-size:12px;margin-right:10px;padding:5px;width:calc(100% - 20px)}.ir-toggle-label[_ngcontent-%COMP%]{font-size:12px;line-height:12px;padding-left:5px;position:relative;top:-3px}.ir-help-content[_ngcontent-%COMP%]{font-size:12px;padding:5px}.ir-link[_ngcontent-%COMP%]{color:var(--linkColor);cursor:pointer}.ir-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.ir-body-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:5px}.ir-body-container[_ngcontent-%COMP%]{display:block;font-size:12px;overflow-y:auto;width:100%}.ir-row[_ngcontent-%COMP%]{display:inline-block;overflow:hidden;width:calc(100% - 10px)}.ir-row-block[_ngcontent-%COMP%]{display:block;float:left;padding-right:5px;max-width:95%}.ir-label[_ngcontent-%COMP%], .ir-label-disabled[_ngcontent-%COMP%]{display:block;padding-bottom:5px}.ir-row-block-container[_ngcontent-%COMP%]{display:inline-block}.ir-num-input[_ngcontent-%COMP%]{padding:0;width:85px}.ir-body[_ngcontent-%COMP%]{min-height:100%;padding:0 0 60px;margin:0;position:relative}.ir-action-button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:calc(100% - 50px);position:absolute;bottom:28px;height:60px}.ir-button[_ngcontent-%COMP%]{float:right;height:20px;min-width:60px;margin:5px 8px 0;box-sizing:border-box;padding:0;border:1px solid var(--neutral-light-color);font-size:calc(var(--sm-font-size-value) * 1px);text-align:center}.ir-button[_ngcontent-%COMP%]:active   .ir-button[_ngcontent-%COMP%]:hover, .ir-button[_ngcontent-%COMP%]:focus, .ir-button[_ngcontent-%COMP%]:active{border-color:var(--neutral-secondary-alt-color);background-color:var(--neutral-light-color);outline:none}.ir-button[_ngcontent-%COMP%]:disabled{background-color:var(--neutral-light-color);border-color:var(--neutral-light-color);color:var(--neutral-tertiary-color);cursor:default}.ir-button[_ngcontent-%COMP%]:disabled:hover, .ir-button[_ngcontent-%COMP%]:disabled:focus, .ir-button[_ngcontent-%COMP%]:disabled:active{background-color:var(--neutral-lighter-color);border-color:var(--neutral-lighter-color);color:var(--neutral-tertiary-color)}.ir-save-button[_ngcontent-%COMP%]{background-color:var(--theme-primary-color)}.ir-save-button[_ngcontent-%COMP%]:focus, .ir-save-button[_ngcontent-%COMP%]:active{border-color:var(--neutral-secondary-alt-color);background-color:var(--theme-primary-color);outline:none}.ir-invalid-select[_ngcontent-%COMP%]{border-color:var(--warning-color)}.ir-toggle[_ngcontent-%COMP%]{padding-left:5px}.ir-validation-message[_ngcontent-%COMP%]{color:var(--warning-color)}.ir-warning-content[_ngcontent-%COMP%]{margin-top:\\a0 9px;display:grid;padding:5px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{font-family:Segoe UI,wf_segoe-ui_normal,helvetica,arial,sans-serif;font-size:var(--sm-font-size)}  .pbi-dialog{border:none}']}),i}(),Do=function(){function i(){}return i.findRelatedNonDualTables=function(t,n){var r=this,o=n.model.getRelatedTables([t]);return o.filter(function(a){return r.getStorageMode(a,n)===V.XG.Import||r.getStorageMode(a,n)===V.XG.DirectQuery}),o},i.getStorageMode=function(t,n){var r=n.model.findTable(t);if(r.partitions&&r.partitions.length>=1)return r.partitions.get(0).mode},i}(),si=p(56011),tn=p(76492),ci=p(42189),di=p(9529),Vc=p(64734);function Uc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",26),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Set_Policy_Warning")))}function zc(i,t){1&i&&(e.\u0275\u0275elementContainerStart(0,27),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementContainerEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Table_Mode_Warning")," "))}function jc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",29),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"a",30),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,2,"Incremental_Refresh_Include_In_Report_Refresh_Warning")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,4,"Generic_LearnMore")))}function Wc(i,t){if(1&i&&e.\u0275\u0275template(0,jc,6,6,"span",28),2&i){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(9),r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",r.showIncludeInReportRefreshWarning)("ngIfElse",n)}}function Hc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",32),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"a",30),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,2,"Incremental_Refresh_Parameter_Warning")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,4,"Generic_LearnMore")))}function Gc(i,t){if(1&i&&e.\u0275\u0275template(0,Hc,6,6,"span",31),2&i){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(11),r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",r.showParameterWarning)("ngIfElse",n)}}function Kc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",34),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"a",35),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,2,"Incremental_Refresh_M_Query_Folding_Warning")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,4,"Generic_LearnMore")))}function $c(i,t){if(1&i&&e.\u0275\u0275template(0,Kc,6,6,"span",33),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",n.showMQueryUnfoldableWaring())}}function Qc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"div",18),e.\u0275\u0275element(2,"div",19),e.\u0275\u0275elementStart(3,"div",20),e.\u0275\u0275template(4,Uc,3,3,"span",21),e.\u0275\u0275template(5,zc,3,3,"ng-container",22),e.\u0275\u0275template(6,Wc,1,2,"ng-template",null,23,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(8,Gc,1,2,"ng-template",null,24,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(10,$c,1,1,"ng-template",null,25,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()()),2&i){var n=e.\u0275\u0275reference(7),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",!r.canApplyRefreshPolicy),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.showModeWarning)("ngIfElse",n)}}function Xc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",5),e.\u0275\u0275element(1,"i",6),e.\u0275\u0275elementStart(2,"section"),e.\u0275\u0275element(3,"span",36)(4,"a",8),e.\u0275\u0275elementEnd()()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("innerHtml",n.getRelatedNonDualTablesWarningMessage(),e.\u0275\u0275sanitizeHtml)}}function Yc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Zc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.getRefreshGranularityFriendlyName(n)," ")}}function Jc(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Period_Validation_Message")," "))}function qc(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"p",51),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.currentPolicyEdit.importDateRangeStringRepresentation(n.localizationService),"")}}function ed(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.getRefreshGranularityFriendlyName(n)," ")}}function td(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Period_Validation_Message"),""))}function nd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_Invalid_Granularity_Message"),""))}function id(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"p",51),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.currentPolicyEdit.refreshDateRangeStringRepresentation(n.localizationService),"")}}var To=function(t){return{"ir-invalid-select":t}};function rd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",38)(1,"div",39)(2,"div",40)(3,"span",41),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"input",42),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.rollingWindowPeriods=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.setApplyButtonState())}),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"pbi-dropdown",43),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.rollingWindowGranularity=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.setApplyButtonState())}),e.\u0275\u0275elementStart(9,"pbi-dropdown-trigger"),e.\u0275\u0275text(10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"pbi-dropdown-item",37),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(14,Zc,2,2,"pbi-dropdown-item",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"span"),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"div",44),e.\u0275\u0275template(19,Jc,3,3,"div",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(20,qc,2,1,"p",45),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",39)(22,"div",46)(23,"span",47),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"input",48),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.incrementalPeriods=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.setApplyButtonState())}),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"pbi-dropdown",49),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.incrementalGranularity=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.setApplyButtonState())}),e.\u0275\u0275elementStart(29,"pbi-dropdown-trigger"),e.\u0275\u0275text(30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"pbi-dropdown-item",37),e.\u0275\u0275text(32),e.\u0275\u0275pipe(33,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(34,ed,2,2,"pbi-dropdown-item",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"span"),e.\u0275\u0275text(36),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(38,"div",50),e.\u0275\u0275template(39,td,3,3,"div",1),e.\u0275\u0275template(40,nd,3,3,"div",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(41,id,2,1,"p",45),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,29,"Incremental_Refresh_With_DQ_Import_Starting_Label")),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(7,31,"Generic_Enter_Value")),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(45,To,!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isRollingPeriodNullOrValid())))("ngModel",r.currentPolicyEdit.rollingWindowPeriods)("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.rollingWindowGranularity)("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.getRefreshGranularityFriendlyName(r.currentPolicyEdit.rollingWindowGranularity)," "),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("value",r.invalidWindowGranularity),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(13,33,"Generic_Select_Value")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.getRefreshGranularities()),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(17,35,"Incremental_Refresh_With_DQ_Before_Refresh_Label")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.showRollingPeriodValidationMessage),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.canDisplayRefreshTimelines),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(25,37,"Incremental_Refresh_With_DQ_Refresh_Starting_Label")),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(27,39,"Generic_Enter_Value")),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(47,To,!(null!=r.currentPolicyEdit&&r.currentPolicyEdit.isIncrementalPeriodNullOrValid())))("ngModel",r.currentPolicyEdit.incrementalPeriods)("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.incrementalGranularity)("disabled",!r.currentPolicyEdit.isActive||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.getRefreshGranularityFriendlyName(r.currentPolicyEdit.incrementalGranularity)," "),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("value",r.invalidWindowGranularity),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(33,41,"Generic_Select_Value")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.getRefreshGranularities()),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(37,43,"Incremental_Refresh_With_DQ_Before_Refresh_Label")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.showRefreshPeriodValidationMessage),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.showInvalidGranularityMessage),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.canDisplayRefreshTimelines)}}function od(i,t){1&i&&(e.\u0275\u0275elementStart(0,"p",60),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_With_DQ_Ineligible_Table_Help_Text"),""))}function ad(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"p",61),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.currentPolicyEdit.realTimeOnwardDataStringRepresentation(n.localizationService),"")}}function ld(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n," ")}}function sd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",62)(1,"label",63),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"pbi-dropdown",64),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.currentPolicyEdit.pollingColumnName=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.setApplyButtonState())}),e.\u0275\u0275elementStart(4,"pbi-dropdown-trigger"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,ld,2,2,"pbi-dropdown-item",12),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275classMap(r.refreshActive&&!r.currentPolicyEdit.pollingColumnDisabled&&r.canApplyRefreshPolicy?"ir-label":"ir-label-disabled"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",r.detectDataChangesLabelContent," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",r.currentPolicyEdit.pollingColumnName)("disabled",!r.refreshActive||r.currentPolicyEdit.pollingColumnDisabled||!r.canApplyRefreshPolicy),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.currentPolicyEdit.pollingColumnName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.getDateTimeColumnNames())}}function cd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section"),e.\u0275\u0275element(1,"label",52),e.\u0275\u0275elementStart(2,"div",53)(3,"pbi-checkbox",54),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.allowDQ=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.updateIncrementalPeriodOffsetFlag())}),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"a",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,od,3,3,"p",55),e.\u0275\u0275template(7,ad,2,1,"p",56),e.\u0275\u0275elementStart(8,"div",53)(9,"pbi-checkbox",54),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.incrementalPeriodsOffsetFlag=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.refreshPeriodOffsetChanged())})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.setApplyButtonState())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"a",57),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",53)(12,"pbi-checkbox",54),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.currentPolicyEdit.detectDataChanges=a)})("ngModelChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.setApplyButtonState())}),e.\u0275\u0275pipe(13,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(14,"a",58),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(15,sd,7,8,"div",59),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275classMap(r.showHybridRefreshIneligibleWarning?"ir-checkbox ir-disabledcheckbox":"ir-checkbox"),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(4,15,"Incremental_Refresh_DirectQuery_Trigger_Label"))("disabled",!r.refreshActive||!r.canApplyRefreshPolicy||r.showHybridRefreshIneligibleWarning)("ngModel",r.currentPolicyEdit.allowDQ),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.showHybridRefreshIneligibleWarning),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.canDisplayRefreshTimelines&&r.currentPolicyEdit.allowDQ),e.\u0275\u0275advance(2),e.\u0275\u0275property("label",r.incrementalRefreshCompleteLabelContent)("disabled",!r.refreshActive||!r.canApplyRefreshPolicy||r.currentPolicyEdit.allowDQ)("ngModel",r.currentPolicyEdit.incrementalPeriodsOffsetFlag),e.\u0275\u0275advance(3),e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(13,17,"Incremental_Refresh_Refresh_Trigger_Label"))("disabled",!r.refreshActive||!r.canApplyRefreshPolicy)("ngModel",r.currentPolicyEdit.detectDataChanges),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.currentPolicyEdit.detectDataChanges)}}function dd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",75)(1,"div",76),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",77),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"Incremental_Refresh_With_DQ_Archive_Label")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,4,"CdsaAuthoring_Iframe_IncrementalRefresh")))}function ud(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",78)(1,"div",76),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",77),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",79),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,3,"Incremental_Refresh_With_DQ_Archive_Label")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,5,"CdsaAuthoring_Iframe_IncrementalRefresh")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(9,7,"Incremental_Refresh_With_DQ_Realtime_Label")))}function pd(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",80),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.currentPolicyEdit.refreshRangeFriendlyName(n.localizationService))}}function gd(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",81),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.currentPolicyEdit.refreshRangeFriendlyName(n.localizationService))}}function hd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",82),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_With_DQ_Refresh_Date_Label")))}function md(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",83),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Incremental_Refresh_With_DQ_Refresh_Date_Label")))}function fd(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"section",65),e.\u0275\u0275element(1,"label",66),e.\u0275\u0275template(2,dd,7,6,"div",67),e.\u0275\u0275template(3,ud,10,9,"div",68),e.\u0275\u0275elementStart(4,"div",69)(5,"div",70),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,pd,2,1,"div",71),e.\u0275\u0275template(8,gd,2,1,"div",72),e.\u0275\u0275template(9,hd,3,3,"div",73),e.\u0275\u0275template(10,md,3,3,"div",74),e.\u0275\u0275elementEnd()()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!n.currentPolicyEdit.allowDQ),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.currentPolicyEdit.allowDQ),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.currentPolicyEdit.importRangeFriendlyName(n.localizationService)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.currentPolicyEdit.allowDQ),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.currentPolicyEdit.allowDQ),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.currentPolicyEdit.allowDQ),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.currentPolicyEdit.allowDQ)}}var Io=function(i){function t(n,r,o,a,l,s,c,u,f,v,C){var E=i.call(this,n,r,o,a,l,s,c,C)||this;return E.featureSwitch=u,E.templateDialogPayload=f,E.dataModelService=v,E.matDialogData=C,E.showHybridRefreshIneligibleWarning=!1,E}return(0,d.__extends)(t,i),t.prototype.ngOnInit=function(){var n=this;this.data=this.templateDialogPayload.input,i.prototype.show.call(this,this.data),this.templateDialogPayload.onOkButtonClick=function(){return n.saveAll()},this.templateDialogPayload.onCancelButtonClick=function(){return n.cancel()},this.templateDialogPayload.setOkButtonState(!0)},t.prototype.saveAll=function(){return i.prototype.saveAll.call(this),Promise.resolve(void 0)},t.prototype.cancel=function(){return Promise.resolve(void 0)},t.prototype.updateIncrementalPeriodOffsetFlag=function(){this.currentPolicyEdit.allowDQ?(this.previousIncrementalPeriodsOffsetValue=this.currentPolicyEdit.incrementalPeriodsOffsetFlag,this.currentPolicyEdit.incrementalPeriodsOffsetFlag=!0):this.currentPolicyEdit.incrementalPeriodsOffsetFlag=this.previousIncrementalPeriodsOffsetValue,this.refreshPeriodOffsetChanged(),this.setApplyButtonState()},t.prototype.showDirectQueryCheckbox=function(){return this.featureSwitch.featureSwitches.enableHybridTables},t.prototype.setApplyButtonState=function(){this.templateDialogPayload.setOkButtonState(!(this.viewActive&&this.stagedChanges&&this.canApplyRefreshPolicy))},t.prototype.tableSelectionChanged=function(){i.prototype.tableSelectionChanged.call(this);var n=this.dataModelService.getClientDataModel().dataModelExtendedState.tableNamesEligibleForHybridIncrementalRefresh;this.showHybridRefreshIneligibleWarning=-1===n.indexOf(this.currentTable.name)},t.prototype.displayRelatedNonDualTablesWarning=function(){return Do.findRelatedNonDualTables(this.currentTable.name,this.modelService).length>0&&this.currentPolicyEdit.isActive&&this.currentPolicyEdit.isValid&&this.currentPolicyEdit.allowDQ},t.prototype.getRelatedNonDualTablesWarningMessage=function(){var n=Do.findRelatedNonDualTables(this.currentTable.name,this.modelService);if(n.sort(),n.length)switch(n.length){case 1:return this.localizationService.format("Incremental_Refresh_With_DQ_Related_Dual_Tables_Warning",n[0]);case 2:return this.localizationService.format("Incremental_Refresh_With_DQ_Related_Dual_Tables_Warning","".concat(n[0],",</b> and <b>").concat(n[1]));case 3:return this.localizationService.format("Incremental_Refresh_With_DQ_Related_Dual_Tables_Warning","".concat(n[0],", ").concat(n[1],",</b> and <b>").concat(n[2]));default:return this.localizationService.format("Incremental_Refresh_With_DQ_Related_Dual_Tables_Warning","".concat(n[0],", ").concat(n[1],",</b> and <b>").concat(n[2]," ..."))}},Object.defineProperty(t.prototype,"canDisplayRefreshTimelines",{get:function(){var r;return(null===(r=this.currentPolicyEdit)||void 0===r?void 0:r.isWindowGranularityParametersSet())&&!this.showInvalidGranularityMessage&&!this.showRefreshPeriodValidationMessage&&!this.showRollingPeriodValidationMessage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showRefreshPeriodValidationMessage",{get:function(){var r;return this.currentPolicyEdit.isActive&&!(null!==(r=this.currentPolicyEdit)&&void 0!==r&&r.isIncrementalPeriodNullOrValid())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showInvalidGranularityMessage",{get:function(){var r,o;return this.currentPolicyEdit.isActive&&(null===(r=this.currentPolicyEdit)||void 0===r?void 0:r.isWindowGranularityParametersSet())&&!(null!==(o=this.currentPolicyEdit)&&void 0!==o&&o.isWindowGranularitiesValid())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showRollingPeriodValidationMessage",{get:function(){var r;return this.currentPolicyEdit.isActive&&!(null!==(r=this.currentPolicyEdit)&&void 0!==r&&r.isRollingPeriodNullOrValid())},enumerable:!1,configurable:!0}),t.dialogNameKey=Rt.o6,t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275directiveInject(Oe.b),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(or.E),e.\u0275\u0275directiveInject(rr.N),e.\u0275\u0275directiveInject(D.g),e.\u0275\u0275directiveInject(e.NgZone),e.\u0275\u0275directiveInject(en.so),e.\u0275\u0275directiveInject(Ot.vZ),e.\u0275\u0275directiveInject(at.x),e.\u0275\u0275directiveInject(Ke.n),e.\u0275\u0275directiveInject(en.WI))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["incremental-refresh-policy-with-directquery"]],features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)((0,d.__spreadArray)([],an,!0),[at.x],!1)),e.\u0275\u0275InheritDefinitionFeature],decls:28,vars:13,consts:[[1,"dialogContent"],[4,"ngIf"],["localize","Incremental_Refresh_With_DQ_Info"],["href","https://go.microsoft.com/fwlink/?linkid=2173666","localize","Generic_LearnMore","target","_blank",1,"pbi-external-link","learn-more"],["class","warning",4,"ngIf"],[1,"warning"],[1,"info-icon","glyphicon","pbi-glyph-info","glyph-small"],["localize","Incremental_Refresh_With_DQ_Warning_Info",1,"warning-text"],["href","https://go.microsoft.com/fwlink/?linkid=869752","localize","Generic_LearnMore","target","_blank",1,"pbi-external-link","learn-more"],[1,"table-dropdown-section"],["for","tableSelect","id","tableSelectLabel","localize","Select_Table",1,"table-select-label"],["id","tableSelect","aria-labelledby","tableSelectLabel","disabled","!canApplyRefreshPolicy",1,"dropdown",3,"value","valueChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","refreshToggle","localize","Incremental_Refresh_With_DQ_Toggle_Label",1,"refresh-toggle-label"],["ngDefaultControl","","id","refreshToggle","aria-labelledby","refreshToggleLabel",3,"ngModel","disabled","ngModelChange"],["id","refreshToggleLabel"],["class","ir-range-settings",4,"ngIf"],["class","review-and-apply-section",4,"ngIf"],[1,"ir-warning-container"],[1,"ir-symbol","ir-warning-symbol"],[1,"ir-warning-content"],["id","policyWarnLabel",4,"ngIf"],["id","tableWarnLabel",4,"ngIf","ngIfElse"],["checkForIncludeInReportRefresh",""],["checkForParameters",""],["checkForMFolding",""],["id","policyWarnLabel"],["id","tableWarnLabel"],["id","includeInReportRefreshWarnLabel",4,"ngIf","ngIfElse"],["id","includeInReportRefreshWarnLabel"],["href","https://go.microsoft.com/fwlink/?linkid=869752","target","_blank",1,"pbi-external-link","learn-more"],["id","paramWarnLabel",4,"ngIf","ngIfElse"],["id","paramWarnLabel"],["id","queryFoldingWarning",4,"ngIf"],["id","queryFoldingWarning"],["href","https://go.microsoft.com/fwlink/?linkid=2050828","target","_blank",1,"pbi-external-link","learn-more"],[1,"warning-text",3,"innerHtml"],[3,"value"],[1,"ir-range-settings"],[1,"ir-settings-block"],[1,"ir-import-settings"],["id","rollingWindowLabel"],["type","number","id","rollingWindowPeriods","ngDefaultControl","","min","1","max","120","aria-valuemin","1","aria-valuemax","120","required","","aria-required","true","aria-labelledby","rollingWindowLabel","aria-controls","rollingPeriodValidationLabel",1,"ir-num-input",3,"ngClass","ngModel","placeholder","disabled","ngModelChange"],["id","rollingWindowGranularity","ngDefaultControl","","aria-labelledby","rollingWindowLabel",1,"dropdown",3,"ngModel","disabled","ngModelChange"],["role","alert","aria-live","polite","id","rollingPeriodValidationLabel",1,"ir-validation-message"],["class","ir-import-data-info",4,"ngIf"],[1,"ir-dq-settings"],["id","incrementalWindowLabel"],["type","number","id","incrementalSettingsInput","ngDefaultControl","","min","1","max","120","aria-valuemin","1","aria-valuemax","120","required","","aria-required","true","aria-labelledby","incrementalWindowLabel","aria-controls","validationMessage",1,"ir-num-input",3,"ngClass","ngModel","placeholder","disabled","ngModelChange"],["id","incrementalGranularity","ngDefaultControl","","aria-labelledby","incrementalWindowLabel",1,"dropdown",3,"ngModel","disabled","ngModelChange"],["id","validationMessage","role","alert","aria-live","polite",1,"ir-validation-message"],[1,"ir-import-data-info"],["localize","Incremental_Refresh_With_DQ_Optional_Settings_Label",1,"optional-settings-label"],[1,"ir-checkbox-container"],["ngDefaultControl","",1,"ir-checkbox",3,"label","disabled","ngModel","ngModelChange"],["class","ir-ineligible-help-text",4,"ngIf"],["class","ir-import-data-info dq-info",4,"ngIf"],["href","https://go.microsoft.com/fwlink/?linkid=869754","localize","Generic_LearnMore","target","_blank",1,"pbi-external-link","learn-more"],["href","https://go.microsoft.com/fwlink/?linkid=869753","localize","Generic_LearnMore","target","_blank",1,"pbi-external-link","learn-more"],["class","ir-row ir-row-block ir-select-datetime-container",4,"ngIf"],[1,"ir-ineligible-help-text"],[1,"ir-import-data-info","dq-info"],[1,"ir-row","ir-row-block","ir-select-datetime-container"],["for","refreshTriggerColumnInput","id","detectColumnLabel"],["id","refreshTriggerColumnInput","ngDefaultControl","","aria-labelledby","detectColumnLabel",1,"dropdown",3,"ngModel","disabled","ngModelChange"],[1,"review-and-apply-section"],["localize","Incremental_Refresh_With_DQ_Review_Apply_Label",1,"review-and-apply-label"],["class","ir-bar-view",4,"ngIf"],["class","ir-bar-view-dq",4,"ngIf"],[1,"ir-info-text-box"],[1,"ir-archive-info"],["class","ir-incremental-info",4,"ngIf"],["class","ir-incremental-info ir-dq",4,"ngIf"],["class","ir-refresh-info",4,"ngIf"],["class","ir-refresh-info ir-dq",4,"ngIf"],[1,"ir-bar-view"],[1,"ir-bar-view-segment-archived"],[1,"ir-bar-view-segment-ir"],[1,"ir-bar-view-dq"],[1,"ir-bar-view-segment-refresh"],[1,"ir-incremental-info"],[1,"ir-incremental-info","ir-dq"],[1,"ir-refresh-info"],[1,"ir-refresh-info","ir-dq"]],template:function(r,o){1&r&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"div",0),e.\u0275\u0275template(2,Qc,12,3,"div",1),e.\u0275\u0275elementStart(3,"section"),e.\u0275\u0275element(4,"span",2)(5,"a",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,Xc,5,1,"div",4),e.\u0275\u0275elementStart(7,"div",5),e.\u0275\u0275element(8,"i",6),e.\u0275\u0275elementStart(9,"section"),e.\u0275\u0275element(10,"span",7)(11,"a",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"div")(13,"section",9),e.\u0275\u0275element(14,"label",10),e.\u0275\u0275elementStart(15,"pbi-dropdown",11),e.\u0275\u0275listener("valueChange",function(l){return o.currentTable=l})("valueChange",function(){return o.tableSelectionChanged()})("ngModelChange",function(){return o.setApplyButtonState()}),e.\u0275\u0275elementStart(16,"pbi-dropdown-trigger"),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(18,Yc,2,2,"pbi-dropdown-item",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"section"),e.\u0275\u0275element(20,"label",13),e.\u0275\u0275elementStart(21,"pbi-toggle-button",14),e.\u0275\u0275listener("ngModelChange",function(l){return o.refreshActive=l})("ngModelChange",function(){return o.toggleRefresh()})("ngModelChange",function(){return o.setApplyButtonState()}),e.\u0275\u0275elementStart(22,"span",15),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(25,rd,42,49,"div",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(26,cd,16,19,"section",1),e.\u0275\u0275template(27,fd,11,7,"section",17),e.\u0275\u0275elementEnd()()()),2&r&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!o.canApplyRefreshPolicy||o.showIncludeInReportRefreshWarning||o.showParameterWarning||o.showMQueryUnfoldableWaring()),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",o.displayRelatedNonDualTablesWarning()),e.\u0275\u0275advance(9),e.\u0275\u0275property("value",o.currentTable),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",o.currentTable.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",o.userTables),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",o.refreshActive)("disabled",!o.canApplyRefreshPolicy||o.isRefreshDisabled),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(24,11,"Incremental_Refresh_With_DQ_Label_Generic"),""),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.refreshActive),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.refreshActive),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.refreshActive))},dependencies:[ye.Fj,ye.wV,ye.JJ,ye.Q7,ye.qQ,ye.Fd,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,bt.X,Nt.J,si.v,tn.H,ci.r,di._,tn.T,Vc.d,Tt],styles:['@charset "UTF-8";.modern-dialogCloseIcon[_ngcontent-%COMP%]{background-color:var(--white-color);color:var(--gray-130);cursor:pointer;display:block;margin-left:auto;height:28px;width:28px}.modern-dialogCloseIcon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:8px}.modern-dialogCloseIcon[_ngcontent-%COMP%]:hover{background-color:var(--neutral-lighter-color)}.dragHandle[_ngcontent-%COMP%]{height:24px;left:0;position:absolute;top:0;width:100%;width:calc(100% - 28px)}[_nghost-%COMP%]{--barBackgroundInfo: var(--fluent-theme-neutral-light-color, @fluentThemeNeutralLightColor);--barBackgroundWarning: var(--alert-color, @alertColor);--barBorderInfo: none;--barBorderWarning: none}[data-legacy-theming=false]   [_nghost-%COMP%]{--barBackgroundInfo: var(--colorNeutralBackground1);--barBackgroundWarning: var(--colorWarningBackground1);--barBorderInfo: 1px solid var(--colorNeutralStrokeAccessible);--barBorderWarning: 1px solid var(--colorWarningBorder1)}.dialogContent[_ngcontent-%COMP%]{overflow:overlay;max-height:574px;line-height:20px}.dialogContent[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-right:8px}.dialogContent[_ngcontent-%COMP%]   .ir-warning-symbol[_ngcontent-%COMP%]:before{content:"\\e7ba";font-family:PowrMDL2;font-size:15px;display:flex;padding-left:5px}.dialogContent[_ngcontent-%COMP%]   .ir-symbol[_ngcontent-%COMP%]{padding:5px;text-align:center}.dialogContent[_ngcontent-%COMP%]   .ir-warning-container[_ngcontent-%COMP%]{background-color:var(--barBackgroundWarning);border:var(--barBorderWarning);display:inline-flex;align-items:center;font-size:12px;margin-bottom:10px}.dialogContent[_ngcontent-%COMP%]   .ir-warning-content[_ngcontent-%COMP%]{margin-top:\\a0 9px;display:grid;padding:5px}.dialogContent[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{margin:12px 0;padding:8px;background-color:var(--barBackgroundInfo);border:var(--barBorderInfo);line-height:16px;font-size:var(--sm-font-size);position:relative;height:40px}.dialogContent[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{position:absolute;left:32px;right:32px;font-size:12px}.dialogContent[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{position:absolute;width:16px;height:16px;left:8px;top:11px;font-size:16px;line-height:19px}.dialogContent[_ngcontent-%COMP%]   .learn-more[_ngcontent-%COMP%]{margin-left:4px;font-size:inherit;text-decoration:none}.dialogContent[_ngcontent-%COMP%]   #tableSelect[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   #refreshTriggerColumnInput[_ngcontent-%COMP%]{width:300px;margin-bottom:12px}.dialogContent[_ngcontent-%COMP%]   .table-select-label[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .refresh-toggle-label[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .optional-settings-label[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .review-and-apply-label[_ngcontent-%COMP%]{display:block;margin-bottom:12px;font-weight:600}.dialogContent[_ngcontent-%COMP%]   .pbi-toggle-button-circle[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .pbi-toggle-button[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   #refreshTriggerColumnInput[_ngcontent-%COMP%]{margin-left:8px}.dialogContent[_ngcontent-%COMP%]   #refreshToggle[_ngcontent-%COMP%]{margin:0 0 12px 8px}.dialogContent[_ngcontent-%COMP%]   .ir-dq-settings[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-import-settings[_ngcontent-%COMP%]{display:flex}.dialogContent[_ngcontent-%COMP%]   .ir-dq-settings[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-import-settings[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 8px 0;height:20px}.dialogContent[_ngcontent-%COMP%]   .ir-dq-settings[_ngcontent-%COMP%]   #rollingWindowPeriods[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-dq-settings[_ngcontent-%COMP%]   #incrementalSettingsInput[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-import-settings[_ngcontent-%COMP%]   #rollingWindowPeriods[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-import-settings[_ngcontent-%COMP%]   #incrementalSettingsInput[_ngcontent-%COMP%]{width:92px;height:28px;box-sizing:border-box}.dialogContent[_ngcontent-%COMP%]   .ir-dq-settings[_ngcontent-%COMP%]   #rollingWindowGranularity[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-dq-settings[_ngcontent-%COMP%]   #incrementalGranularity[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-dq-settings[_ngcontent-%COMP%]   #refreshTriggerColumnInput[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-import-settings[_ngcontent-%COMP%]   #rollingWindowGranularity[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-import-settings[_ngcontent-%COMP%]   #incrementalGranularity[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-import-settings[_ngcontent-%COMP%]   #refreshTriggerColumnInput[_ngcontent-%COMP%]{width:102px;height:28px;box-sizing:border-box;margin-left:8px}.dialogContent[_ngcontent-%COMP%]   .ir-import-data-info[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   #detectColumnLabel[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-ineligible-help-text[_ngcontent-%COMP%]{font-size:12px;height:28px;margin:0 8px;line-height:16px}.dialogContent[_ngcontent-%COMP%]   .ir-import-data-info.dq-info[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   #detectColumnLabel.dq-info[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-ineligible-help-text.dq-info[_ngcontent-%COMP%]{margin-top:-10px}.dialogContent[_ngcontent-%COMP%]   .ir-ineligible-help-text[_ngcontent-%COMP%]{color:var(--gray-90)}.dialogContent[_ngcontent-%COMP%]   .ir-checkbox-container[_ngcontent-%COMP%]{display:flex;margin-left:8px}.dialogContent[_ngcontent-%COMP%]   .review-and-apply-section[_ngcontent-%COMP%]{height:100px}.dialogContent[_ngcontent-%COMP%]   .ir-bar-view[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-bar-view-dq[_ngcontent-%COMP%]{margin-left:27px;margin-right:27px;font-size:10px;font-weight:600;text-align:center;height:21px;display:flex;box-shadow:0 .3px .9px rgba(0,0,0,.11),0 1.6px 3.6px rgba(0,0,0,.13)}.dialogContent[_ngcontent-%COMP%]   .ir-bar-view[_ngcontent-%COMP%]   .ir-bar-view-segment-archived[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-bar-view-dq[_ngcontent-%COMP%]   .ir-bar-view-segment-archived[_ngcontent-%COMP%]{border-radius:0 2px 2px 0;background:#FAF9F8;width:341px;height:100%}.dialogContent[_ngcontent-%COMP%]   .ir-bar-view[_ngcontent-%COMP%]   .ir-bar-view-segment-ir[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-bar-view-dq[_ngcontent-%COMP%]   .ir-bar-view-segment-ir[_ngcontent-%COMP%]{border-radius:0 2px 2px 0;color:var(--text-primary-content-color);background:var(--theme-primary-color);width:171px;height:100%}.dialogContent[_ngcontent-%COMP%]   .ir-bar-view-dq[_ngcontent-%COMP%]{margin-right:14px;height:21px}.dialogContent[_ngcontent-%COMP%]   .ir-bar-view-dq[_ngcontent-%COMP%]   .ir-bar-view-segment-archived[_ngcontent-%COMP%]{border-radius:0 2px 2px 0;background:#FAF9F8;width:311px}.dialogContent[_ngcontent-%COMP%]   .ir-bar-view-dq[_ngcontent-%COMP%]   .ir-bar-view-segment-ir[_ngcontent-%COMP%]{border-radius:0 2px 2px 0;background:var(--theme-primary-color);width:139px}.dialogContent[_ngcontent-%COMP%]   .ir-bar-view-dq[_ngcontent-%COMP%]   .ir-bar-view-segment-refresh[_ngcontent-%COMP%]{border-radius:0 2px 2px 0;background-image:repeating-linear-gradient(145deg,var(--theme-primary-color) 0 2px,#fff 2px 4px);width:75px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]{position:relative;margin-top:5px;font-size:10px;line-height:12px;text-align:center}.dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-archive-info[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-refresh-info[_ngcontent-%COMP%], .dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-incremental-info[_ngcontent-%COMP%]{width:72px;position:absolute}.dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-archive-info[_ngcontent-%COMP%]{left:0}.dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-incremental-info[_ngcontent-%COMP%]{left:332px}.dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-incremental-info.ir-dq[_ngcontent-%COMP%]{left:302px}.dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-refresh-info[_ngcontent-%COMP%]{right:0}.dialogContent[_ngcontent-%COMP%]   .ir-info-text-box[_ngcontent-%COMP%]   .ir-refresh-info.ir-dq[_ngcontent-%COMP%]{left:441px}.dialogContent[_ngcontent-%COMP%]   .ir-validation-message[_ngcontent-%COMP%]{color:var(--warning-color);line-height:16px;font-size:12px;margin-bottom:12px;margin-left:8px}  #rollingWindowGranularity button,   #incrementalGranularity button{height:28px}  .pbi-checkbox-text{margin-left:8px}  pbi-checkbox.ir-checkbox.ir-disabledcheckbox{margin-bottom:10px}  .pbi-dropdown-item:focus,   .item.pbi-focus-outline:focus{outline:1px solid var(--black-color)}']}),t}(sr),vd=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["inline-message"]],inputs:{error:"error"},decls:2,vars:1,consts:[["tabindex","0",1,"error-message"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"label",0),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(r.error))},styles:[".error-message[_ngcontent-%COMP%]{display:block;padding:24px;color:var(--warning-color);background:var(--neutral-light-color)}"]}),i}(),_d=p(52591),bd=function(){function i(t,n){this.targetTable=t,this.targetColumn=n,this.reset()}return i.prototype.reset=function(){this.targetAggregation=this.targetColumn.alternateOf,this.isActive=!!this.targetAggregation,this.targetAggregation?(this.baseColumn=this.targetAggregation.baseColumn,this.baseTable=this.targetAggregation.baseTable,this.summarization=this.targetAggregation.summarization):(this.baseColumn=null,this.baseTable=null,this.summarization=null)},i.prototype.toTOMAlternateOf=function(){if(this.isActive){var t=new _d.G;return t.baseColumn=this.baseColumn,t.baseTable=this.baseTable,t.summarization=this.summarization,t}return null},Object.defineProperty(i.prototype,"isValid",{get:function(){return!this.isActive||this.summarization===V.k3.CountTableRows&&!!this.baseTable&&!this.baseColumn||this.summarization!==V.k3.CountTableRows&&!!this.summarization&&!!this.baseColumn&&!!this.baseTable},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isDirty",{get:function(){return this.targetAggregation&&!this.isActive||!this.targetAggregation&&this.isActive||this.targetAggregation&&(this.targetAggregation.baseColumn!==this.baseColumn||this.targetAggregation.baseTable!==this.baseTable||this.targetAggregation.summarization!==this.summarization)},enumerable:!1,configurable:!0}),i}(),yd=function(){function i(t,n,r,o){this.aggregations=t,this.userTables=n,this.strongRelationships=r,this.model=o,this.initializeTablesWithRLSAndMapOfRolesToTables(),this.tablesWithRLS&&this.tablesWithRLS.length>0&&this.initializeTableFilteringMap()}return i.prototype.duplicateAggregationsValidation=function(t,n){var r=this;if(!t||t.length<2)return!1;var o,a=t.filter(function(c){return!!c.summarization});if(a.length<2)return!1;if(o=Array.from(new Set(a.map(function(c){return r.generateAggregationMappingAsAString(c)}))).length!==a.length,!n)return o;if(o){var s=t.filter(function(c){return c.targetColumn===n})[0];return!!a.some(function(c){return c.targetColumn!==n&&r.generateAggregationMappingAsAString(c)===r.generateAggregationMappingAsAString(s)})}},i.prototype.generateAggregationMappingAsAString=function(t){return t.summarization+(t.baseTable?t.baseTable.name:null)+(t.baseColumn?t.baseColumn.name:null)},i.prototype.groupByOnDifferentTableValidation=function(t){if(!t||0===t.length)return!1;var n=t.filter(function(a){return a.isActive&&a.isValid});if(n.length<2)return!1;var r=Array.from(new Set(n.map(function(a){return a.summarization})));if(r.indexOf(V.k3.Count)>-1||r.indexOf(V.k3.CountTableRows)>-1||r.indexOf(V.k3.Max)>-1||r.indexOf(V.k3.Min)>-1||r.indexOf(V.k3.Sum)>-1)return!1;var o=Array.from(new Set(n.map(function(a){return a.baseTable})));return!(1===r.length&&1===o.length)},i.prototype.numericAggregationsWithMultipleUnrelatedDetailTables=function(t){if(t&&!(t.length<2)&&this.strongRelationships){var n=new Array,r=t.filter(function(z){return z.isActive&&z.isValid&&z.summarization!==V.k3.GroupBy}),o=t.filter(function(z){return z.isActive&&z.isValid&&z.summarization===V.k3.GroupBy});if(0!==r.length&&0!==o.length){var a=Array.from(new Set(r.map(function(z){return z.baseTable})));if(a[0].model.relationships&&0!==Object.keys(a[0].model.relationships).length){for(var u,f,l=Array.from(new Set(o.map(function(z){return z.baseColumn}))),s=function(ce){u=new Array,u=c.computeTheListOfRelatedTables(ce,u),f=!0;for(var le=function(yi){if(!u.some(function(Xh){return Xh===yi.table}))return f=!1,"break"},fe=0,we=l;fe<we.length&&"break"!==le(we[fe]);fe++);f||n.push(r.filter(function(ze){return ze.baseTable===ce})[0])},c=this,v=0,C=a;v<C.length;v++)s(C[v]);return n}}}},i.prototype.computeTheListOfRelatedTables=function(t,n){var o,r=this;if(n.push(t),!(o=_.values(t.model.relationships).filter(function(u){return r.userTables.some(function(f){return f===u.fromTable})&&r.userTables.some(function(f){return f===u.toTable})&&r.strongRelationships.some(function(f){return f.name===u.name})&&u.fromTable===t&&(u.isRelationshipManyToOne()||u.isRelationshipOneToOne())}))||0===o.length)return n;for(var l=0,s=o.map(function(u){return u.toTable});l<s.length;l++){var c=s[l];-1===n.indexOf(c)&&this.computeTheListOfRelatedTables(c,n)}return n},i.prototype.doesAtleastOneNonFilteringTableNotHaveAggsValidator=function(t){if(!(this.aggregations&&t&&t.model&&t.model.relationships))return!1;var n=this.aggregations.filter(function(a){return a.isActive&&a.isValid}),r=this.getNonFilteringTables(t);if(!r)return!1;r=r.filter(function(a){return a.name!==t.name});var o=n.map(function(a){return a.targetTable});return r.some(function(a){return-1===o.indexOf(a)})},i.prototype.getNonFilteringTables=function(t){var n=this,r=new Array,o=_.values(t.model.relationships).filter(function(u){return n.userTables.some(function(f){return f===u.fromTable})&&n.userTables.some(function(f){return f===u.toTable})&&(u.fromTable===t||u.toTable===t)});if(o){var a=o.filter(function(u){return u.isRelationshipOneToOne()}),l=a.map(function(u){return u.fromTable!==t?u.fromTable:u.toTable}),s=new Array;s=a?o.filter(function(u){return-1===a.indexOf(u)}):o;var c=this.getNonFilteringTableInRelationshipWithManyOnOneSide(t,s);return r.push.apply(r,l),r.push.apply(r,c),r}},i.prototype.getNonFilteringTableInRelationshipWithManyOnOneSide=function(t,n){var r=new Array,o=new Array,a=n.filter(function(s){return s.crossFilteringBehavior===V.jE.OneDirection&&s.toTable===t});a&&(r=a.map(function(s){return s.fromTable}));var l=n.filter(function(s){return s.crossFilteringBehavior===V.jE.BothDirections});return l&&(o=l.map(function(s){return s.fromTable!==t?s.fromTable:s.toTable})),r.push.apply(r,o),r},i.prototype.determineRoleThatFiltersCurrentTableButDoesntFilterDetailTable=function(t,n){var r=this;if(!this.tablesWithRLS||0===this.tablesWithRLS.length)return null;var o=this.mapOfTableToFilteringTables[t.name];if(!o||0===o.length)return null;var a=o.filter(function(u){return r.tablesWithRLS.findIndex(function(f){return f===u})>=0});if(!a||0===a.length||!this.mapOfTableToRole[a[0]])return null;var l=this.mapOfTableToFilteringTables[n.name];if(!l||0===l.length)return this.getRLSFailedResult(a[0]);var s=l.filter(function(u){return r.tablesWithRLS.findIndex(function(f){return f===u})>=0});if(!s||0===s.length)return this.getRLSFailedResult(a[0]);if(a.every(function(u){return-1!==s.indexOf(u)}))return null;var c=a.filter(function(u){return-1===s.indexOf(u)});return c&&c[0]?this.getRLSFailedResult(c[0]):null},i.prototype.getRLSFailedResult=function(t){return{roleName:this.mapOfTableToRole[t],tableName:t}},i.prototype.initializeTablesWithRLSAndMapOfRolesToTables=function(){if(this.model&&(this.tablesWithRLS=[],this.mapOfTableToRole={},this.model.roles))for(var t=0,n=this.model.roles.getItems();t<n.length;t++){var r=n[t];if(r.tablePermissions)for(var o=0,a=r.tablePermissions.getItems();o<a.length;o++){var l=a[o];if(l.filterExpression){var s=this.model.findTable(l.name);s&&(this.tablesWithRLS.push(s.name),this.mapOfTableToRole[s.name]=r.name)}}}},i.prototype.initializeTableFilteringMap=function(){var t=this,n={};if(this.model&&this.model.relationships)for(var r=0,o=_.values(this.model.relationships);r<o.length;r++){var a=o[r];a.isActive&&(a.isRelationshipOneToOne()||a.crossFilteringBehavior===V.jE.BothDirections?(this.appendValueToMap(a.fromTable.name,a.toTable.name,n),this.appendValueToMap(a.toTable.name,a.fromTable.name,n)):this.appendValueToMap(a.fromTable.name,a.toTable.name,n))}this.mapOfTableToFilteringTables=this.flattenMap(n),this.userTables.forEach(function(l){t.appendValueToMap(l.name,l.name,t.mapOfTableToFilteringTables)})},i.prototype.flattenMap=function(t){for(var n={},r=0,o=Object.keys(t);r<o.length;r++){var a=o[r];this.computeListOfFilteringTables(a,t[a],t,n)}return n},i.prototype.computeListOfFilteringTables=function(t,n,r,o){if(t&&r&&0!==Object.keys(r).length)for(var a=[],l=new(Array.bind.apply(Array,(0,d.__spreadArray)([void 0],n||[],!1)));l.length>0;){var s=l.shift();s!==t&&!this.isIn(s,a)&&!this.isIn(s,o[t])&&(this.appendValueToMap(t,s,o),l=r[s]?l.concat((0,d.__spreadArray)([],r[s]||[],!0)):l,a.push(s))}},i.prototype.isIn=function(t,n){return!!n&&n.findIndex(function(r){return r===t})>=0},i.prototype.appendValueToMap=function(t,n,r){!t||!n||!r||(t in r||(r[t]=[]),r[t].push(n))},i}(),Cd=function(){function i(){}return i.filterSummarizationTypeBasedOnDataType=function(t){if(!t)return[];switch(t){case V.nH.Automatic:case V.nH.Boolean:case V.nH.String:case V.nH.Unknown:case V.nH.Variant:return[V.k3.GroupBy,V.k3.Max,V.k3.Min];case V.nH.Binary:case V.nH.DateTime:case V.nH.Decimal:case V.nH.Double:return[V.k3.Sum,V.k3.GroupBy,V.k3.Max,V.k3.Min];case V.nH.Int64:return Object.keys(V.k3);default:return[V.k3.GroupBy,V.k3.Max,V.k3.Min]}},i}(),Sd=function(){function i(t){this.targetTable=t,this.reset()}return i.prototype.reset=function(){this.targetPrecedence=this.targetTable.alternateSourcePrecedence,(0===this.targetPrecedence||this.targetPrecedence)&&(this.precedence=this.targetPrecedence)},Object.defineProperty(i.prototype,"isValid",{get:function(){return 0===this.precedence||!(!this.precedence||this.precedence%1!=0)&&!isNaN(this.precedence)&&this.precedence>=i.intMin&&this.precedence<=i.intMax},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isDirty",{get:function(){return this.precedence!==this.targetTable.alternateSourcePrecedence},enumerable:!1,configurable:!0}),i.intMin=-2147483647,i.intMax=2147483647,i}(),At=p(11894),Md=p(36459),wd=p(78173),xd=["tableRow"];function Pd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",23),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Aggregations_Not_Supported_When_There_Are_Pending_Model_Changes")))}function Od(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"span",24),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.currentTableIsBaseTableInAnAggregationMappingLabel)}}function Ed(i,t){1&i&&(e.\u0275\u0275elementStart(0,"span",25),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Aggregations_Not_Supported_When_Agg_Table_On_Filtering_Side")))}function Dd(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",17),e.\u0275\u0275element(1,"div",18),e.\u0275\u0275elementStart(2,"div",19),e.\u0275\u0275template(3,Pd,3,3,"span",20),e.\u0275\u0275template(4,Od,2,1,"span",21),e.\u0275\u0275template(5,Ed,3,3,"span",22),e.\u0275\u0275elementEnd()()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!n.canApplyAggregations),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isCurrentTableABaseTableInAnAggregationMapping),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.atleastOneNonFilteringTableNotHaveAggs)}}function Td(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",26),e.\u0275\u0275element(1,"spinner")(2,"br"),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,1,"Loading_Text")))}function Id(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",58),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Rd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",59),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Precedence_Is_Invalid"),""))}function Ad(i,t){1&i&&(e.\u0275\u0275elementStart(0,"mat-header-cell"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Aggregation_Column_Label")," "))}function Fd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-cell")(1,"div")(2,"label",60),e.\u0275\u0275listener("keydown",function(l){var c=e.\u0275\u0275restoreView(n).index,u=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(u.onArrowKey(l,c,"columnName"))}),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()()}if(2&i){var r=t.$implicit,o=t.index;e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate1("id","",o,"-columnName"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.name," ")}}function kd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"mat-header-cell",61),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Summarization_All_Caps")," "))}function Bd(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",66),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext(3);e.\u0275\u0275propertyInterpolate("title",o.isSummarizationValid(r,n)?null:o.disabledSummarizationTitle(n)),e.\u0275\u0275property("disabled",!o.isSummarizationValid(r,n))("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o.localizedSummarizationValue(n)," ")}}function Ld(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-cell")(1,"tri-dropdown",62,63),e.\u0275\u0275listener("valueChange",function(){var c=e.\u0275\u0275restoreView(n).$implicit,u=e.\u0275\u0275nextContext(3);return u.setCurrentColumn(c),e.\u0275\u0275resetView(u.makeAggregationActive(c))})("ngModelChange",function(s){var u=e.\u0275\u0275restoreView(n).$implicit,f=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(f.currentlySelectedAggregation(u).summarization=s)})("keydown.arrowRight",function(s){var u=e.\u0275\u0275restoreView(n).index,f=e.\u0275\u0275reference(2),v=e.\u0275\u0275nextContext(3);return s.stopImmediatePropagation(),f.close(),e.\u0275\u0275resetView(v.onArrowKey(s,u,"summarization"))})("keydown.arrowLeft",function(s){var u=e.\u0275\u0275restoreView(n).index,f=e.\u0275\u0275reference(2),v=e.\u0275\u0275nextContext(3);return s.stopImmediatePropagation(),f.close(),e.\u0275\u0275resetView(v.onArrowKey(s,u,"summarization"))}),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"tri-dropdown-trigger",64),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Bd,2,4,"tri-dropdown-item",65),e.\u0275\u0275elementEnd()()}if(2&i){var r=t.$implicit,o=t.index,a=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("placeholder",a.disableAllManageAggregationDialogElement?"":e.\u0275\u0275pipeBind1(3,7,"Select_Summarization_Type_Dropdown_Value")),e.\u0275\u0275propertyInterpolate1("id","",o,"-summarization"),e.\u0275\u0275property("disabled",a.disableAllManageAggregationDialogElement)("ngModel",a.currentlySelectedAggregation(r).summarization),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("value",e.\u0275\u0275pipeBind1(5,9,"Select_Summarization_Type_Dropdown_Value")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",a.currentlySelectedAggregation(r).summarization||e.\u0275\u0275pipeBind1(7,11,"Select_Summarization_Type_Dropdown_Value")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",a.getSummarizationTypes())}}function Nd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"mat-header-cell",67),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Detail_Table_Label")," "))}function Vd(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",71),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(4);e.\u0275\u0275propertyInterpolate("title",r.isDetailTableOptionDisabled(n)?r.disabledDetailTableTitle(n):null),e.\u0275\u0275property("value",n)("disabled",r.isDetailTableOptionDisabled(n)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Ud(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-cell")(1,"tri-dropdown",68,69),e.\u0275\u0275listener("ngModelChange",function(s){var u=e.\u0275\u0275restoreView(n).$implicit,f=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(f.currentlySelectedAggregation(u).baseTable=s)})("valueChange",function(){var c=e.\u0275\u0275restoreView(n).$implicit,u=e.\u0275\u0275nextContext(3);return u.setCurrentColumn(c),e.\u0275\u0275resetView(u.resetBaseColumn())})("keydown.arrowRight",function(s){var u=e.\u0275\u0275restoreView(n).index,f=e.\u0275\u0275reference(2),v=e.\u0275\u0275nextContext(3);return s.stopImmediatePropagation(),f.close(),e.\u0275\u0275resetView(v.onArrowKey(s,u,"baseTable"))})("keydown.arrowLeft",function(s){var u=e.\u0275\u0275restoreView(n).index,f=e.\u0275\u0275reference(2),v=e.\u0275\u0275nextContext(3);return s.stopImmediatePropagation(),f.close(),e.\u0275\u0275resetView(v.onArrowKey(s,u,"baseTable"))}),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"tri-dropdown-trigger"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,Vd,2,4,"tri-dropdown-item",70),e.\u0275\u0275elementEnd()()}if(2&i){var r=t.$implicit,o=t.index,a=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("placeholder",a.detailTableDisabled(r)?"":e.\u0275\u0275pipeBind1(3,6,"Generic_Select_Value")),e.\u0275\u0275propertyInterpolate1("id","",o,"-baseTable"),e.\u0275\u0275property("disabled",a.detailTableDisabled(r))("ngModel",a.currentlySelectedAggregation(r).baseTable),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",a.currentlySelectedAggregation(r).baseTable&&a.currentlySelectedAggregation(r).baseTable.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",a.getDetailTables())}}function zd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"mat-header-cell",72),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Detail_Column_Label")," "))}function jd(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",76),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext(3);e.\u0275\u0275propertyInterpolate("title",o.isDetailColumnTypeValid(r,n)?null:o.disabledDetailColumnTitle(r)),e.\u0275\u0275property("disabled",!o.isDetailColumnTypeValid(r,n))("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.name)}}function Wd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-cell")(1,"tri-dropdown",73,74),e.\u0275\u0275listener("ngModelChange",function(s){var u=e.\u0275\u0275restoreView(n).$implicit,f=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(f.currentlySelectedAggregation(u).baseColumn=s)})("valueChange",function(){var c=e.\u0275\u0275restoreView(n).$implicit,u=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(u.setCurrentColumn(c))})("keydown.arrowRight",function(s){var u=e.\u0275\u0275restoreView(n).index,f=e.\u0275\u0275reference(2),v=e.\u0275\u0275nextContext(3);return s.stopImmediatePropagation(),f.close(),e.\u0275\u0275resetView(v.onArrowKey(s,u,"baseColumn"))})("keydown.arrowLeft",function(s){var u=e.\u0275\u0275restoreView(n).index,f=e.\u0275\u0275reference(2),v=e.\u0275\u0275nextContext(3);return s.stopImmediatePropagation(),f.close(),e.\u0275\u0275resetView(v.onArrowKey(s,u,"baseColumn"))}),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"tri-dropdown-trigger"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,jd,2,4,"tri-dropdown-item",75),e.\u0275\u0275elementEnd()()}if(2&i){var r=t.$implicit,o=t.index,a=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("placeholder",a.detailColumnDisabled(r)?"":e.\u0275\u0275pipeBind1(3,6,"Generic_Select_Value")),e.\u0275\u0275propertyInterpolate1("id","",o,"-baseColumn"),e.\u0275\u0275property("disabled",a.detailColumnDisabled(r))("ngModel",a.currentlySelectedAggregation(r).baseColumn),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",a.currentlySelectedAggregation(r).baseColumn&&a.currentlySelectedAggregation(r).baseColumn.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",a.getDetailColumns(r))}}function Hd(i,t){1&i&&e.\u0275\u0275element(0,"mat-header-cell")}function Gd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-cell")(1,"div",77),e.\u0275\u0275listener("click",function(){var l=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.makeAggregationInactive(l))})("keyup.enter",function(){var l=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(3);return s.setCurrentColumn(l),e.\u0275\u0275resetView(s.makeAggregationInactive(l))})("keydown",function(a){var s=e.\u0275\u0275restoreView(n).index,c=e.\u0275\u0275nextContext(3);return a.stopImmediatePropagation(),e.\u0275\u0275resetView(c.onArrowKey(a,s,"clearAggregation"))}),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()()}if(2&i){var r=t.index;e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate1("id","",r,"-clearAggregation"),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,2,"Clear_Aggregation_Icon_Label"))}}function Kd(i,t){1&i&&e.\u0275\u0275element(0,"mat-header-row")}var $d=function(t){return{"ma-invalid-select":t}};function Qd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-row",78,79),e.\u0275\u0275listener("click",function(){var s=e.\u0275\u0275restoreView(n).$implicit,c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.setCurrentColumn(s))}),e.\u0275\u0275elementEnd()}if(2&i){var r=t.$implicit,o=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(1,$d,o.isHighlightedRow(r)))}}function Xd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Duplicate_Aggregation_Mappings")))}function Yd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Aggregation_Mappings_On_Same_Detail_Table_Error_Message"),""))}function Zd(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Settings_Aggregation_Will_Hide_Table")))}function Jd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"div",27)(2,"div",28)(3,"div",29)(4,"label",30),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",31)(8,"tri-dropdown",32),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.currentTable=a)})("valueChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.tableSelectionChanged(a))}),e.\u0275\u0275elementStart(9,"tri-dropdown-trigger"),e.\u0275\u0275text(10),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(11,Id,2,2,"tri-dropdown-item",33),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(12,"div",34)(13,"div",28)(14,"label",35),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",36),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275elementStart(19,"span",37),e.\u0275\u0275text(20),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(22,"\ue946"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(23,"pbi-spin-button",38,39),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.currentTablePrecedence.precedence=a)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(25,Rd,3,3,"div",40),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(26,"div",41)(27,"mat-table",42,43),e.\u0275\u0275elementContainerStart(29,44),e.\u0275\u0275template(30,Ad,3,3,"mat-header-cell",45),e.\u0275\u0275template(31,Fd,4,2,"mat-cell",46),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(32,47),e.\u0275\u0275template(33,kd,3,3,"mat-header-cell",48),e.\u0275\u0275template(34,Ld,9,13,"mat-cell",46),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(35,49),e.\u0275\u0275template(36,Nd,3,3,"mat-header-cell",50),e.\u0275\u0275template(37,Ud,7,8,"mat-cell",46),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(38,51),e.\u0275\u0275template(39,zd,3,3,"mat-header-cell",52),e.\u0275\u0275template(40,Wd,7,8,"mat-cell",46),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(41,53),e.\u0275\u0275template(42,Hd,1,0,"mat-header-cell",45),e.\u0275\u0275template(43,Gd,3,4,"mat-cell",46),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275template(44,Kd,1,0,"mat-header-row",54),e.\u0275\u0275template(45,Qd,2,3,"mat-row",55),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(46,"div",56)(47,"div",57),e.\u0275\u0275template(48,Xd,3,3,"div",13),e.\u0275\u0275template(49,Yd,3,3,"div",13),e.\u0275\u0275template(50,Zd,3,3,"div",13),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,19,"Aggregation_Table_Label")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.currentTable)("disabled",r.disableTableSelection),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.currentTable.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.userTables),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,21,"Precedence_Label")),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(18,23,"Precedence_Explanation")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(21,25,"Precedence_Explanation")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.currentTablePrecedence.precedence)("options",r.precedenceOptions)("required",!0)("aria-labelledby",r.precedenceLabel),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.currentTablePrecedence.isValid),e.\u0275\u0275advance(2),e.\u0275\u0275property("dataSource",r.tableColumns),e.\u0275\u0275advance(17),e.\u0275\u0275property("matHeaderRowDef",r.displayedColumns),e.\u0275\u0275advance(1),e.\u0275\u0275property("matRowDefColumns",r.displayedColumns),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.areAggregationsDuplicate()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.groupByOnDiffernetDetailTable()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.addingAggregationsToTable())}}function qd(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",4)(1,"div",5)(2,"div",6)(3,"span",7),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,Dd,6,3,"div",8),e.\u0275\u0275elementStart(7,"div",9)(8,"span",10),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementStart(11,"a",11),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(14,Td,6,3,"div",12),e.\u0275\u0275template(15,Jd,51,27,"div",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",14)(17,"button",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.saveAll())}),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"button",16),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.cancel())}),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(5,9,"ManageAggregations")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.showSpinner&&r.disableAllManageAggregationDialogElement),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(10,11,"ManageAggregations_Summary")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(13,13,"Generic_LearnMore")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.showSpinner),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.showSpinner),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",r.showSpinner||r.disableApplyAllButton),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(19,15,"Apply_All")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,17,"ModalDialog_Cancel")," ")}}var Ro=function(){function i(t,n,r,o,a,l,s,c,u,f){this.modelService=t,this.localizationService=n,this.resolver=r,this.telemetryEventService=o,this.extendedSchemaChangeService=a,this.highContrastCssGenerationService=l,this.dataModelCompute=s,this.featureSwitch=c,this.dialogRef=u,this.matDialogData=f,this.commonSQLString="sql",this.precedenceOptions={minValue:-2147483648,maxValue:2147483647,stepAmount:1},this.showSpinner=!0,this.displayedColumns=["columnName","summarization","baseTable","baseColumn","clearAggregation"],this.initializeHighContrastRules(),this.viewActive=!1}return i.prototype.ngOnInit=function(){this.show(this.matDialogData)},i.prototype.show=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return this.canApplyAggregations=this.modelService.model.canApplyRefreshPolicy,t&&t.table?(this.currentTable=this.modelService.model.findTable(t.table),this.tableName=t.table):(this.currentTable=null,this.tableName=null),this.userTables=this.initializeUserTables(),this.detailTables=this.initializeDetailTables(),this.currentTable=this.userTables.find(function(o){return o.name===n.tableName}),this.initializeEdits(),[4,this.modelPropertiesUpdated()];case 1:return r.sent(),this.strongRelationships&&this.dqAndDualTableDataSourceTypeMapping&&(this.aggregationsValidator=new yd(this.editableAggregations,this.userTables,this.strongRelationships,this.modelService.model),this.showSpinner=!1,this.tableSelectionChanged(this.currentTable)),this.telemetryEventService.logEvent("ManageAggregationsDialogOpen"),this.viewActive=!0,[2]}})})},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .mat-select-panel","{ background-color: @backgroundColor !important }"),this.highContrastCssGenerationService.addRule(".themeableElement #visibilityContainer ::-webkit-scrollbar","{ background-color: @backgroundColor !important; border: 1px solid @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement #visibilityContainer ::-webkit-scrollbar-track","{ background-color: @backgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement #visibilityContainer ::-webkit-scrollbar-thumb","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement #visibilityContainer ::-webkit-scrollbar-button","{ background-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement a:focus, .themeableElement div:focus, .themeableElement label:focus","{ border-color: @buttonForegroundColor !important; outline: @buttonForegroundColor solid 1px !important; }")},i.prototype.modelPropertiesUpdated=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return t=this,[4,this.dataModelCompute.computeStrongRelationships(1)];case 1:return t.strongRelationships=r.sent(),n=this,[4,this.dataModelCompute.computeDataSourceTypesForDQAndDualTables()];case 2:return n.dqAndDualTableDataSourceTypeMapping=r.sent(),[2]}})})},i.prototype.initializeUserTables=function(){if(this.modelService.model&&this.modelService.model.tables)return _.values(li.k.getUserTables(this.modelService.model.tables,!1,!1,!0))},i.prototype.initializeDetailTables=function(){if(this.modelService.model&&this.modelService.model.tables)return _.values(li.k.getUserTables(this.modelService.model.tables,!1,!1,!1))},i.prototype.initializeEdits=function(){var t,n;if(null!==(t=this.modelService.model)&&void 0!==t&&t.tables){this.editableAggregations=[],this.editableTablePrecedences=[];for(var r=0,o=this.userTables;r<o.length;r++){var a=o[r],l=new Sd(a);if(this.editableTablePrecedences.push(l),a.columns)for(var c=0,u=(null===(n=a?.columns)||void 0===n?void 0:n.nonSystemColumns)||[];c<u.length;c++){var v=new bd(a,u[c]);this.editableAggregations.push(v)}}}},i.prototype.saveAll=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n,r,o,a,l,s,c,u=this;return(0,d.__generator)(this,function(f){switch(f.label){case 0:if(this.areAggregationsDuplicate()||this.groupByOnDiffernetDetailTable()||this.unrelatedDetailTables())return[2];t={changes:[]},n=this.editableAggregations.filter(function(v){return v.isDirty}),r=0,o=n,f.label=1;case 1:return r<o.length?[4,this.extendedSchemaChangeService.setIsHidden([{object:(c=o[r]).targetTable,newValue:!!c.toTOMAlternateOf()}],t)]:[3,5];case 2:return f.sent(),[4,this.extendedSchemaChangeService.setAggregation([{object:c.targetColumn,newValue:c.toTOMAlternateOf()}],t)];case 3:f.sent(),this.telemetryEventService.logEvent("AggregationsSchemaApply"),f.label=4;case 4:return r++,[3,1];case 5:a=this.editableTablePrecedences.filter(function(v){return v.isDirty}),l=0,s=a,f.label=6;case 6:return l<s.length?[4,this.extendedSchemaChangeService.setAlternateSourcePrecedence([{object:(c=s[l]).targetTable,newValue:c.precedence}],t)]:[3,9];case 7:f.sent(),this.telemetryEventService.logEvent("TablePrecedenceSchemaApply"),f.label=8;case 8:return l++,[3,6];case 9:return t.changes.length?[4,this.extendedSchemaChangeService.apply(t).then(function(){u.dialogRef.close()},function(v){})]:[3,11];case 10:f.sent(),f.label=11;case 11:return[2]}})})},i.prototype.cancel=function(){this.dialogRef.close()},i.prototype.downKey=function(t,n){t<this.currentAggregations.length-1&&t++,document.getElementById(t+"-"+n).focus()},i.prototype.upKey=function(t,n){t>0&&t--,document.getElementById(t+"-"+n).focus()},i.prototype.leftRightKeys=function(t,n,r){var o;(o=this.getNextColumnDef(r,n))&&(0===document.getElementById(t+"-"+o).tabIndex?document.getElementById(t+"-"+o).focus():this.leftRightKeys(t,o,r))},i.prototype.getNextColumnDef=function(t,n){var r,o=this.displayedColumns.length;for(r=0;r<o&&this.displayedColumns[r]!==n;r++);return"left"===t&&0!==r?this.displayedColumns[--r]:"right"===t&&r!==o-1?this.displayedColumns[++r]:void 0},i.prototype.onArrowKey=function(t,n,r){switch(t.key){case"ArrowUp":this.upKey(n,r);break;case"ArrowDown":this.downKey(n,r);break;case"ArrowRight":this.leftRightKeys(n,r,"right");break;case"ArrowLeft":this.leftRightKeys(n,r,"left")}},i.prototype.tableSelectionChanged=function(t){var n;if(!t)return this.currentTable=null,this.currentAggregations=null,this.currentAggregation=null,this.currentTablePrecedence=null,void(this.tableColumns=null);if(!this.editableTablePrecedences||0===this.editableTablePrecedences.length||!t.columns||!this.editableAggregations||0===this.editableAggregations.length)return this.currentAggregation=null,void(this.currentAggregations=null);var r=this.editableTablePrecedences.filter(function(a){return a.targetTable===t});if(r&&1===r.length){this.currentTablePrecedence=r[0],this.tableColumns=new At.r4((null===(n=t?.columns)||void 0===n?void 0:n.nonSystemColumns)||[]),this.currentAggregations=this.editableAggregations.filter(function(a){return a.targetTable===t}),this.currentAggregation=this.currentAggregations[0],this.atleastOneNonFilteringTableNotHaveAggs=this.doesAtleastOneNonFilteringTableNotHaveAggs,this.isCurrentTableABaseTableInOtherAggMapping=this.isCurrentTableABaseTableInAnAggregationMapping;var o=this.initializeValidDetailTables();o&&o.length>0&&(this.validDetailTables=o)}},i.prototype.addingAggregationsToTable=function(){return!!this.editableAggregations&&this.editableAggregations.some(function(t){return t.isActive&&t.isDirty})},Object.defineProperty(i.prototype,"stagedChanges",{get:function(){return this.displayInlineError(),this.editableAggregations.every(function(n){return n.isValid})&&this.editableTablePrecedences.every(function(n){return n.isValid})&&(this.editableAggregations.some(function(n){return n.isDirty})||this.editableTablePrecedences.some(function(n){return n.isDirty}))},enumerable:!1,configurable:!0}),i.prototype.getSummarizationTypes=function(){return Object.keys(V.k3)},i.prototype.localizedSummarizationValue=function(t){switch(t){case V.k3.Count:return this.localizationService.format("Aggregate_CountNonNull");case V.k3.CountTableRows:return this.localizationService.format("CountTableRows");case V.k3.GroupBy:return this.localizationService.format("GroupBy");case V.k3.Max:return this.localizationService.format("Max");case V.k3.Min:return this.localizationService.format("Min");case V.k3.Sum:return this.localizationService.format("Aggregate_Sum")}},i.prototype.initializeValidDetailTables=function(){var t=this;return this.getDetailTables().filter(function(n){return!t.isDetailTableInvalid(n)})},i.prototype.isSummarizationValid=function(t,n){if(t&&n){var r=Cd.filterSummarizationTypeBasedOnDataType(t.modelDataType);return!!r&&r.indexOf(n)>-1}},i.prototype.currentlySelectedAggregation=function(t){if(!t||!this.currentAggregations)return null;var n=this.currentAggregations.filter(function(r){return r.targetColumn===t});return n&&1===n.length?n[0]:null},i.prototype.detailTableDisabled=function(t){if(!t||!this.canApplyAggregations)return!0;var n=this.currentlySelectedAggregation(t);return(!n.baseTable||!this.isCountTableRowsSummarization(n))&&this.isSummarizationNotSelected(n)},i.prototype.isSummarizationNotSelected=function(t){return!t||!t.summarization},i.prototype.detailColumnDisabled=function(t){if(!t||!this.canApplyAggregations)return!0;var n=this.currentlySelectedAggregation(t);return!n.baseColumn&&(this.isSummarizationNotSelected(n)||this.isCountTableRowsSummarization(n)||this.isDetailTableNotSelected(n))},i.prototype.isCountTableRowsSummarization=function(t){return!!t&&t.summarization===V.k3.CountTableRows},i.prototype.isDetailTableNotSelected=function(t){return!t||!t.baseTable},i.prototype.getDetailTables=function(){var t=this;return this.detailTables.filter(function(n){return n!==t.currentTable})},i.prototype.getDetailColumns=function(t){var n,r;if(t){var o=this.currentlySelectedAggregation(t);if(o.baseTable&&o.baseTable.columns)return(null===(r=null===(n=o.baseTable)||void 0===n?void 0:n.columns)||void 0===r?void 0:r.nonSystemColumns)||[]}},i.prototype.isDetailColumnTypeValid=function(t,n){if(!t)return!1;var r=this.currentlySelectedAggregation(t);return!(!r||!r.targetColumn)&&(r.summarization!==V.k3.GroupBy&&r.summarization!==V.k3.Max&&r.summarization!==V.k3.Min&&r.summarization!==V.k3.Sum||n.modelDataType===t.modelDataType)},i.prototype.setCurrentColumn=function(t){this.currentColumn=t,this.currentAggregation=this.currentlySelectedAggregation(this.currentColumn)},i.prototype.resetBaseColumn=function(){this.currentlySelectedAggregation(this.currentColumn).baseColumn=null},i.prototype.makeAggregationActive=function(t){var n=this.currentlySelectedAggregation(t);n&&(n.isActive=!0,n.baseColumn=null,n.baseTable=null)},i.prototype.makeAggregationInactive=function(t){var n=this.currentlySelectedAggregation(t);n&&(n.isValid&&this.removeInlineError(t,!0),n.isActive=!1,n.baseColumn=null,n.baseTable=null,n.summarization=null)},i.prototype.disabledSummarizationTitle=function(t){return t===V.k3.Sum?this.localizationService.format("Aggregation_Column_Validation_For_Sum_Aggregations"):t===V.k3.Count||t===V.k3.CountTableRows?this.localizationService.format("Aggregation_Column_Validation_For_Count_Aggregations"):void 0},i.prototype.disabledDetailColumnTitle=function(t){if(t){var n=this.currentlySelectedAggregation(t);if(n&&n.summarization)return this.localizationService.format("Aggregation_Detail_Column_Validation_For_Aggregations",this.localizedSummarizationValue(n.summarization))}},i.prototype.isDetailTableInvalid=function(t){return!(!(this.isTableInImportMode(t)||this.isTableInDualMode(t)||this.isTableInDirectLakeMode(t)||this.isChainedAggregationTable(t))&&this.isDQOrDualOrDLOverDQAggValid(t))||!!this.aggregationsValidator&&!!this.aggregationsValidator.determineRoleThatFiltersCurrentTableButDoesntFilterDetailTable(this.currentTable,t)},i.prototype.isDetailTableOptionDisabled=function(t){return!(!this.showSpinner&&this.validDetailTables&&0!==this.validDetailTables.length)||-1===this.validDetailTables.indexOf(t)},i.prototype.isChainedAggregationTable=function(t){var n=this;return this.editableAggregations.some(function(r){return r.targetTable===t&&t!==n.currentTable&&r.isActive&&r.isValid})},i.prototype.isTableInImportMode=function(t){return t.partitions.get(0).mode===V.XG.Import},i.prototype.isTableInDualMode=function(t){return t.partitions.get(0).mode===V.XG.Dual},i.prototype.isTableInDirectLakeMode=function(t){return t.partitions.get(0).mode===V.XG.DirectLake},i.prototype.isDQOrDualOrDLOverDQAggValid=function(t){if(this.dqAndDualTableDataSourceTypeMapping&&this.currentTable&&t&&(this.isTableInDirectQueryMode(this.currentTable)||this.isTableInDualMode(this.currentTable)||this.isTableInDirectLakeMode(this.currentTable))&&this.isTableInDirectQueryMode(t)){var n=this.tryGetDataSourceType(this.currentTable),r=this.tryGetDataSourceType(t);if(null!=n&&null!=r&&!this.isSQLSource(n)&&n!==r)return!1}return!0},i.prototype.isTableInDirectQueryMode=function(t){return t.partitions.get(0).mode===V.XG.DirectQuery},i.prototype.tryGetDataSourceType=function(t){return t.name in this.dqAndDualTableDataSourceTypeMapping?this.dqAndDualTableDataSourceTypeMapping[t.name]:null},i.prototype.isSQLSource=function(t){return t.toLocaleLowerCase().includes(this.commonSQLString)},Object.defineProperty(i.prototype,"isCurrentTableABaseTableInAnAggregationMapping",{get:function(){var n=this;return!!this.editableAggregations.some(function(r){return r.baseTable===n.currentTable&&r.isActive&&r.isValid})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"doesAtleastOneNonFilteringTableNotHaveAggs",{get:function(){return!!this.aggregationsValidator&&this.aggregationsValidator.doesAtleastOneNonFilteringTableNotHaveAggsValidator(this.currentTable)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"disableAllManageAggregationDialogElement",{get:function(){return!this.canApplyAggregations||this.isCurrentTableABaseTableInOtherAggMapping||this.atleastOneNonFilteringTableNotHaveAggs},enumerable:!1,configurable:!0}),i.prototype.disabledDetailTableTitle=function(t){if(this.isTableInImportMode(t)||this.isTableInDualMode(t)||this.isTableInDirectLakeMode(t))return this.localizationService.format("Aggregation_Detail_Table_Disabled_non_DirectQuery_Table_Message",t.name);if(this.isChainedAggregationTable(t))return this.localizationService.format("Aggregation_Detail_Table_Disabled_Chained_Aggregation_Table_Message",t.name);if(this.isDQOrDualOrDLOverDQAggValid(t)){if(this.aggregationsValidator){var n=this.aggregationsValidator.determineRoleThatFiltersCurrentTableButDoesntFilterDetailTable(this.currentTable,t);return n&&n.roleName&&n.tableName?this.localizationService.format("Aggregation_Detail_Table_Disabled_Because_Of_RLS_Table_Filtering_Predicate",n.roleName,n.tableName):""}return""}return this.localizationService.format("Aggregation_Detail_Table_Disabled_Invalid_DQ_Or_Dual_Over_DQ_Agg_Table_Message")},Object.defineProperty(i.prototype,"currentTableIsBaseTableInAnAggregationMappingLabel",{get:function(){var n=this,r=this.editableAggregations.filter(function(a){return a.baseTable===n.currentTable&&a.isActive&&a.isValid});return this.localizationService.format("Aggregation_Table_Has_Mappings_To_Other_Tables",r[0].targetTable.name)},enumerable:!1,configurable:!0}),i.prototype.isHighlightedRow=function(t){if(!t)return!1;var n=this.currentlySelectedAggregation(t);return n.isActive&&n.isValid?this.areAggregationsDuplicate(t)||this.groupByOnDiffernetDetailTable(t)||this.unrelatedDetailTables(t)||!this.isSummarizationValid(t,n.summarization)||!this.isDetailColumnTypeValid(t,n.baseColumn)||!this.isDQOrDualOrDLOverDQAggValid(n.baseTable):void 0},Object.defineProperty(i.prototype,"disableApplyAllButton",{get:function(){return!this.stagedChanges||this.inlineErrorDisplayed||this.areAggregationsDuplicate()||this.groupByOnDiffernetDetailTable()||this.unrelatedDetailTables()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"disableTableSelection",{get:function(){return!(!this.currentAggregations||!this.editableAggregations)&&!(!this.currentAggregations.some(function(n){return n.isActive})||!this.editableAggregations.some(function(n){return n.isDirty}))&&(!this.stagedChanges||this.inlineErrorDisplayed||this.areAggregationsDuplicate()||this.groupByOnDiffernetDetailTable()||this.unrelatedDetailTables())},enumerable:!1,configurable:!0}),i.prototype.areAggregationsDuplicate=function(t){return void 0===t&&(t=null),!(!this.currentAggregations||!this.aggregationsValidator)&&this.aggregationsValidator.duplicateAggregationsValidation(this.currentAggregations,t)},i.prototype.groupByOnDiffernetDetailTable=function(t){return!this.aggregationsValidator||(t?this.currentlySelectedAggregation(t).isActive&&this.aggregationsValidator.groupByOnDifferentTableValidation(this.currentAggregations):this.aggregationsValidator.groupByOnDifferentTableValidation(this.currentAggregations))},i.prototype.unrelatedDetailTables=function(t){if(!this.aggregationsValidator)return!1;var n=this.aggregationsValidator.numericAggregationsWithMultipleUnrelatedDetailTables(this.currentAggregations);if(t){if(n&&n.length>0){var r=n.some(function(a){return a.targetColumn===t}),o=this.currentlySelectedAggregation(t);return!!(o.isActive&&o.isValid&&r)||(this.removeInlineError(t,!1),!1)}return this.removeInlineError(t,!1),!1}return!!n&&n.length>0},i.prototype.displayInlineError=function(){if(this.inlineErrorDisplayed=!1,this.currentTable&&this.aggregationMappings&&0!==this.aggregationMappings.length)for(var t=0,n=this.aggregationMappings.toArray();t<n.length;t++){var r=n[t],o=r.element.nativeElement.textContent.split(" ",2)[1],a=this.currentTable.columns.findByName(o),l=this.currentlySelectedAggregation(a);if(l&&l.summarization&&l.baseTable&&l.baseColumn){var s=l.baseTable,c=l.baseColumn,u=l.summarization,f=r.element.nativeElement.nextElementSibling;if(this.isSummarizationValid(a,u))if(this.isDetailColumnTypeValid(a,c)){if(this.unrelatedDetailTables(a)){var E=this.localizationService.format("Aggregation_Mappings_With_Unrelated_Columns_Error_Message");if(f&&f.textContent===E){this.inlineErrorDisplayed=!0;continue}this.tryCreateInlineErrorMessage(r,E)}else if(!this.isDQOrDualOrDLOverDQAggValid(s)){var z=this.localizationService.format("Aggregation_Detail_Table_Disabled_Invalid_DQ_Or_Dual_Over_DQ_Agg_Table_Message");if(f&&f.textContent===z){this.inlineErrorDisplayed=!0;continue}this.tryCreateInlineErrorMessage(r,z)}}else{var C=this.disabledDetailColumnTitle(a);if(f&&f.textContent===C){this.inlineErrorDisplayed=!0;continue}this.tryCreateInlineErrorMessage(r,C)}else{var v=this.disabledSummarizationTitle(u);if(f&&f.textContent===v){this.inlineErrorDisplayed=!0;continue}this.tryCreateInlineErrorMessage(r,v)}}}},i.prototype.tryCreateInlineErrorMessage=function(t,n){if(t&&n){var r=this.resolver.resolveComponentFactory(vd),o=t.createComponent(r);o.instance.error=n,o.changeDetectorRef.detectChanges(),this.inlineErrorDisplayed=!0}},i.prototype.removeInlineError=function(t,n){if(t&&this.aggregationMappings)for(var r=0,o=this.aggregationMappings.toArray();r<o.length;r++){var a=o[r],l=this.localizationService.format("Aggregation_Mappings_With_Unrelated_Columns_Error_Message"),s=this.localizationService.format("Aggregation_Detail_Table_Disabled_Invalid_DQ_Or_Dual_Over_DQ_Agg_Table_Message"),c=this.currentlySelectedAggregation(t),u=a.element.nativeElement.nextElementSibling;if(u&&u.textContent===l||n&&u&&u.textContent===this.disabledSummarizationTitle(c.summarization)&&!this.isSummarizationValid(c.targetColumn,c.summarization)||n&&u&&u.textContent===this.disabledDetailColumnTitle(t)&&!this.isDetailColumnTypeValid(c.targetColumn,c.baseColumn)||n&&u&&u.textContent===s&&!this.isDQOrDualOrDLOverDQAggValid(c.baseTable)){var f=a.element.nativeElement.textContent.split(" ",2)[1];t===this.currentTable.columns.findByName(f)&&a.clear()}}},i.dialogNameKey=Rt.Nh,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Oe.b),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(e.ComponentFactoryResolver),e.\u0275\u0275directiveInject(or.E),e.\u0275\u0275directiveInject(rr.N),e.\u0275\u0275directiveInject(D.g),e.\u0275\u0275directiveInject(Md.X),e.\u0275\u0275directiveInject(Ot.vZ),e.\u0275\u0275directiveInject(en.so),e.\u0275\u0275directiveInject(en.WI))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["manage-aggregations-dialog"]],viewQuery:function(n,r){var o;(1&n&&e.\u0275\u0275viewQuery(xd,5,e.ViewContainerRef),2&n)&&(e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.aggregationMappings=o))},features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)([],an,!0))],decls:6,vars:1,consts:[["mat-dialog-title","",1,"dragHandle","mat-dialog-title"],[1,"modern-dialogCloseIcon","themeableElement",3,"click"],[1,"glyphicon","pbi-glyph-close"],["class","ma-dialog-container","cdkFocusInitial","",4,"ngIf"],["cdkFocusInitial","",1,"ma-dialog-container"],["aria-labelledby","aggTitleLabel","aria-describedby","aggSummaryLabel",1,"ma-body","themeableElement"],[1,"ma-title-container"],["id","aggTitleLabel",1,"ma-title-content"],["class","ma-warning-container","aria-live","assertive",4,"ngIf"],[1,"ma-details-container"],["id","aggSummaryLabel"],["href","https://go.microsoft.com/fwlink/?linkid=871428","target","_blank",1,"pbi-external-link"],["class","ma-centeredSpinner",4,"ngIf"],[4,"ngIf"],[1,"ma-action-button-container","themeableElement"],[1,"pbi-fluent-button","primary","ma-button","ma-save-button",3,"disabled","click"],[1,"pbi-fluent-button","cancel","ma-button",3,"click"],["aria-live","assertive",1,"ma-warning-container"],[1,"ma-symbol","ma-warning-symbol"],[1,"ma-warning-content"],["id","aggsWarnLabelForPendingModelChanges",4,"ngIf"],["id","aggWarningLabelForBaseTableAggregation",4,"ngIf"],["id","aggWarningLabelForFilteringTableRelationship",4,"ngIf"],["id","aggsWarnLabelForPendingModelChanges"],["id","aggWarningLabelForBaseTableAggregation"],["id","aggWarningLabelForFilteringTableRelationship"],[1,"ma-centeredSpinner"],[1,"ma-body-container","themeableElement"],[1,"ma-row"],[1,"ma-row-block","aggregation-dropdown-container"],["id","tableLabel","for","tableInput",1,"ma-label"],[1,"dropdown-container"],["id","tableInput","aria-labelledby","tableLabel","compact","",1,"dropdown",3,"ngModel","disabled","ngModelChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"ma-row-block","precedence-input-container"],["id","precedenceLabel","for","precedence",1,"ma-label"],["tabindex","0","pbiTooltipPosition","after",1,"ma-help-symbol",3,"pbiTooltip"],[1,"precedenceTooltip"],["aria-controls","precedenceValidationLabel",3,"ngModel","options","required","aria-labelledby","ngModelChange"],["formControl","ngModel"],["role","alert","aria-live","polite","id","precedenceValidationLabel",4,"ngIf"],["id","visibilityContainer",1,"table-body-container","themeableElement"],[3,"dataSource"],["table",""],["matColumnDef","columnName"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","summarization"],["id","summarizationLabel",4,"matHeaderCellDef"],["matColumnDef","baseTable"],["id","baseTableLabel",4,"matHeaderCellDef"],["matColumnDef","baseColumn"],["id","baseColumnLabel",4,"matHeaderCellDef"],["matColumnDef","clearAggregation"],[4,"matHeaderRowDef"],[3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"ma-row","ma-row-block"],["role","alert",1,"ma-validation-message"],[3,"value"],["role","alert","aria-live","polite","id","precedenceValidationLabel"],["tabindex","0",3,"id","keydown"],["id","summarizationLabel"],["aria-labelledby","summarizationLabel","compact","",1,"dropdown",3,"placeholder","disabled","ngModel","id","valueChange","ngModelChange","keydown.arrowRight","keydown.arrowLeft"],["summarization",""],[1,"themeableElement",3,"value"],["class","themeableElement",3,"disabled","value","title",4,"ngFor","ngForOf"],[1,"themeableElement",3,"disabled","value","title"],["id","baseTableLabel"],["aria-labelledby","baseTableLabel","compact","",1,"dropdown",3,"placeholder","disabled","ngModel","id","ngModelChange","valueChange","keydown.arrowRight","keydown.arrowLeft"],["baseTable",""],["class","themeableElement",3,"value","disabled","title",4,"ngFor","ngForOf"],[1,"themeableElement",3,"value","disabled","title"],["id","baseColumnLabel"],["aria-labelledby","baseColumnLabel","compact","",1,"dropdown",3,"placeholder","disabled","ngModel","id","ngModelChange","valueChange","keydown.arrowRight","keydown.arrowLeft"],["baseColumn",""],["class","themeableElement",3,"title","disabled","value",4,"ngFor","ngForOf"],[1,"themeableElement",3,"title","disabled","value"],["tabindex","0","role","button",1,"ma-delete-icon",3,"id","click","keyup.enter","keydown"],[3,"ngClass","click"],["tableRow",""]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"modeling-styles"),e.\u0275\u0275elementContainerStart(1),e.\u0275\u0275element(2,"div",0),e.\u0275\u0275elementStart(3,"div",1),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275element(4,"span",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275template(5,qd,23,19,"div",3),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",r.userTables))},dependencies:[ye.JJ,ye.Q7,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,At.ty,At.wO,At.S4,At.t3,At.R3,At.Al,At.L7,At.ML,At.fg,At.Zw,ar,wd.a,kt.V,Jt.M3,ei.l,ti.q,Jt.ii,Tt],styles:['@charset "UTF-8";.modern-dialogCloseIcon[_ngcontent-%COMP%]{background-color:var(--white-color);color:var(--gray-130);cursor:pointer;display:block;margin-left:auto;height:28px;width:28px}.modern-dialogCloseIcon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:8px}.modern-dialogCloseIcon[_ngcontent-%COMP%]:hover{background-color:var(--neutral-lighter-color)}.dragHandle[_ngcontent-%COMP%]{height:24px;left:0;position:absolute;top:0;width:100%;width:calc(100% - 28px)}[_nghost-%COMP%]{--colorTextForeground: var(--theme-secondary-color);--colorBackground: var(--fluent-theme-white-color)}[data-legacy-theming=false]   [_nghost-%COMP%]{--colorTextForeground: var(--colorNeutralForeground1);--colorBackground: var(--colorNeutralBackground1)}.ma-dialog-container[_ngcontent-%COMP%]{padding:0 28px;display:flex;flex-direction:column;height:600px;width:800px;box-sizing:border-box;max-height:calc(100% - 28px)}.ma-dialog-container[_ngcontent-%COMP%]   .ma-body[_ngcontent-%COMP%]{margin:0;height:calc(100% - 60px);min-height:calc(100% - 60px);padding-bottom:0;flex:100 100 auto}.ma-dialog-container[_ngcontent-%COMP%]   .ma-action-button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;height:60px;margin-bottom:auto;align-self:flex-end;padding-bottom:10px;position:static;width:100%}.ma-dialog-container[_ngcontent-%COMP%]   .ma-button[_ngcontent-%COMP%]{align-self:flex-end}.ma-body[_ngcontent-%COMP%]{margin:0;min-height:100%;padding:0;position:relative}.ma-title-container[_ngcontent-%COMP%]{display:flex;padding-bottom:10px;width:100%;color:var(--colorTextForeground)}.ma-title-content[_ngcontent-%COMP%]{font-family:var(--fluent-font-family);font-size:20px;font-weight:600}.ma-warning-container[_ngcontent-%COMP%]{background-color:var(--alert-color);display:flex;font-size:12px;margin-right:10px;padding:5px 5px 2px;width:calc(100% - 20px)}.ma-warning-symbol[_ngcontent-%COMP%]:before{content:"\\e7ba";font-family:PowrMDL2;font-size:15px}.ma-warning-content[_ngcontent-%COMP%]{margin-top:\\a0 9px;display:grid;padding:5px}.ma-details-container[_ngcontent-%COMP%]{display:block;font-size:12px;padding:5px 5px 10px;width:100%;color:var(--colorTextForeground)}.ma-help-container[_ngcontent-%COMP%]{background-color:var(--neutral-light-color);display:flex;margin-right:10px;padding:5px 5px 10px;width:calc(100% - 20px)}.ma-symbol[_ngcontent-%COMP%]{height:30px;margin-top:5px;padding:5px;text-align:center;width:30px}.ma-body-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:5px}.ma-body-container[_ngcontent-%COMP%]{display:block;font-size:12px;overflow-y:auto;width:100%;color:var(--colorTextForeground)}.ma-centeredSpinner[_ngcontent-%COMP%]{display:block;font-size:12px;overflow-y:auto;width:100%;padding-top:25%;padding-left:45%;align-items:center}.ma-row[_ngcontent-%COMP%]{display:inline-flex;overflow:hidden;width:calc(100% - 10px)}.ma-row-block[_ngcontent-%COMP%]{display:block;float:left;padding-right:10px;max-width:95%}.ma-label[_ngcontent-%COMP%]{display:block;padding-bottom:5px;padding-right:5px;color:var(--colorTextForeground)}.ma-help-symbol[_ngcontent-%COMP%]{font-family:PowrMDL2;font-size:15px;margin-bottom:6px}.ma-help-content[_ngcontent-%COMP%]{font-size:12px;padding:5px}.ma-action-button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:calc(100% - 50px);position:absolute;overflow:hidden;bottom:0;height:60px}.pbi-fluent-button[_ngcontent-%COMP%]{margin:8px}.table-body-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:0;max-height:70%;width:calc(100% - 30px)}.mat-table[_ngcontent-%COMP%]{overflow:auto;max-height:300px;min-width:100%;background-color:var(--colorBackground);color:var(--colorTextForeground)}.mat-select-panel[_ngcontent-%COMP%]{width:80%!important}.mat-option[_ngcontent-%COMP%]{border:1px}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{align-items:center!important;display:flex!important;flex:1!important;min-height:48px!important;color:var(--colorTextForeground)}.mat-cell[_ngcontent-%COMP%]   tri-dropdown[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]   tri-dropdown[_ngcontent-%COMP%]{width:100%}.mat-header-cell[_ngcontent-%COMP%]{font-weight:700!important}.ma-delete-icon[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:contain;cursor:pointer;float:center;height:16px;width:16px}.ma-delete-icon[_ngcontent-%COMP%]:before{content:"\\e74d";font-family:PowrMDL2;margin-right:2px;margin-left:2px}.ma-validation-message[_ngcontent-%COMP%]{color:var(--warning-color);padding:5px}.ma-invalid-select[_ngcontent-%COMP%]{border-color:var(--warning-color);border-style:solid;border-width:1px}.mat-header-row[_ngcontent-%COMP%]{padding:0 5px!important;border-bottom-color:var(--colorNeutralStroke1)}.mat-row[_ngcontent-%COMP%]{padding:0 5px!important;border-bottom-color:var(--colorNeutralStroke2)}.mat-column-columnName[_ngcontent-%COMP%], .mat-column-summarization[_ngcontent-%COMP%], .mat-column-baseTable[_ngcontent-%COMP%], .mat-column-baseColumn[_ngcontent-%COMP%]{flex:0 0 23%;padding:0 0 0 5px}.mat-column-clearAggregation[_ngcontent-%COMP%]{flex:0 0 3%!important;padding:0 0 0 5px}.precedenceTooltip[_ngcontent-%COMP%]{height:1px;width:1px;position:absolute;overflow:hidden;top:-10px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], tri-dropdown[_ngcontent-%COMP%]{font-family:Segoe UI,wf_segoe-ui_normal,helvetica,arial,sans-serif;font-size:var(--sm-font-size)}  .mat-mdc-dialog-container{overflow:hidden}  .pbi-dialog{border:none}.aggregation-dropdown-container[_ngcontent-%COMP%], .precedence-input-container[_ngcontent-%COMP%]{width:100%}.dropdown[_ngcontent-%COMP%]{width:100%;line-height:1}.modern-dialogCloseIcon[_ngcontent-%COMP%]{background-color:var(--colorBackground)}']}),i}(),ui=p(22318),eu=p(41198),tu=p(77445),nu=p(26112),iu=function(i){function t(n){var r=i.call(this)||this;return r.sortingDataAccessor=function(o,a){switch(a){case"fromtablecolumn":return o.fromColumn.displayName.toLowerCase();case"relationship":return o.relationshipSymbol.cardinality.toString()+o.relationshipSymbol.crossFilteringBehavior.toString();case"totablecolumn":return o.toColumn.displayName.toLowerCase();case"active":return o.isActive.toString();default:return I.fF.assertFail("sort not currently implemented"),-1}},r.filterPredicate=function(o,a){var s=(0,nu.K)(a).relationshipSymbol;if(_.isEmpty(s.cardinalitiesCriterion)||_.isEmpty(s.crossFilteringCriterion)){if(_.isEmpty(s.cardinalitiesCriterion)){if(_.isEmpty(s.crossFilteringCriterion))return!0;for(var le=0,fe=s.crossFilteringCriterion;le<fe.length;le++)if(o.relationshipSymbol.crossFilteringBehavior===(f=fe[le]))return!0}else for(var z=0,ce=s.cardinalitiesCriterion;z<ce.length;z++)if(o.relationshipSymbol.cardinality===(E=ce[z]))return!0}else for(var c=0,u=s.crossFilteringCriterion;c<u.length;c++)for(var f=u[c],v=0,C=s.cardinalitiesCriterion;v<C.length;v++){var E=C[v];if(o.relationshipSymbol.crossFilteringBehavior===f&&o.relationshipSymbol.cardinality===E)return!0}return!1},r.setData(n),r}return(0,d.__extends)(t,i),t.prototype.setData=function(n){this.data=n},t}(At.r4),ru=p(57243),ou=function(){function i(t,n){this.relationship=t,this.localizationService=n}return Object.defineProperty(i.prototype,"fromColumn",{get:function(){return{icon:this.getColumnIcon(this.relationship.fromColumn,this.relationship.model).pipe((0,nt.q)(1)),displayName:this.relationship.fromColumn.table.name+" ("+this.relationship.fromColumn.name+")"}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"toColumn",{get:function(){return{icon:this.getColumnIcon(this.relationship.toColumn,this.relationship.model).pipe((0,nt.q)(1)),displayName:this.relationship.toColumn.table.name+" ("+this.relationship.toColumn.name+")"}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"relationshipSymbol",{get:function(){return{cardinality:this.relationship.cardinality,crossFilteringBehavior:this.relationship.crossFilteringBehavior,tooltipData:{cardinality:this.getRelationshipCardinalityString(this.relationship.cardinality),crossFilteringBehavior:this.getCrossFilteringBehavior(this.relationship.crossFilteringBehavior)}}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isActive",{get:function(){return this.localizationService.get(this.relationship.isActive?"Active":"Inactive")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"data",{get:function(){return this.relationship},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"uniqueId",{get:function(){return this.relationship.name},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canEdit",{get:function(){return this.relationship.canEdit},enumerable:!1,configurable:!0}),i.prototype.getColumnIcon=function(t,n){return i.iconFactoryHelper$.pipe((0,Me.U)(function(r){return r.getFluentIcon(t,n)}))},i.prototype.getRelationshipCardinalityString=function(t){switch(t){case V.KA.ManyToMany:return this.localizationService.get("Many_To_Many_for_label");case V.KA.ManyToOne:return this.localizationService.get("Many_To_One_for_label");case V.KA.OneToOne:return this.localizationService.get("One_To_One_for_label");default:return void I.fF.assertFail("relationship cardinality is invalid")}},i.prototype.getCrossFilteringBehavior=function(t){switch(t){case V.jE.OneDirection:return this.localizationService.get("Single");case V.jE.BothDirections:return this.localizationService.get("Visual_LabelStyle_Both");default:return void I.fF.assertFail("Cross filtering behavior is invalid")}},i.iconFactoryHelper$=(0,yn.D)(Promise.resolve().then(p.bind(p,26725))).pipe((0,ru.d)()),i}(),Ao=p(56401),pi=function(i){function t(n,r,o,a,l,s){var c=i.call(this,{relationships:[],modelChangeInProgress:!1,autodetectRelationshipsInProgress:!1})||this;return c.modelService=n,c.localizationService=r,c.dialogService=o,c.templateDialogPayload=a,c.relationshipPropertyDataFactory=l,c.modelAuthoring=s,c.relationships$=c.select(function(u){return u.relationships}),c.modelChangeInProgress$=c.select(function(u){return u.modelChangeInProgress}),c.autodetectRelationshipsInProgress$=c.select(function(u){return u.autodetectRelationshipsInProgress}),c.deleteSelectedRelationship=function(){return(0,d.__awaiter)(c,void 0,void 0,function(){var u=this;return(0,d.__generator)(this,function(f){switch(f.label){case 0:return[4,this.confirmToDeleteRelationship()];case 1:return f.sent()&&this.getSelectedRelationship().pipe((0,nt.q)(1),(0,Or.b)(function(){return u.updateModelChangeInProgress(!0)}),(0,Hn.b)(function(v){if(0===v.length)throw new Error("expect to have relationships selected");var C=v.map(function(E){return Kn({fromTableName:E.data.fromColumn.table.name,fromColumnName:E.data.fromColumn.name,toTableName:E.data.toColumn.table.name,toColumnName:E.data.toColumn.name},E.data.fromColumn.table.schemaName,E.data.toColumn.table.schemaName)});return u.modelAuthoring.apply({changes:C})})).subscribe(function(){return u.updateModelChangeInProgress(!1)},function(){return u.updateModelChangeInProgress(!1)}),[2]}})})},c.deleteRelationship=function(u){return(0,d.__awaiter)(c,void 0,void 0,function(){var f,v=this;return(0,d.__generator)(this,function(C){switch(C.label){case 0:return[4,this.confirmToDeleteRelationship()];case 1:return C.sent()?(this.updateModelChangeInProgress(!0),f=[u].map(function(E){return Kn({fromTableName:E.fromColumn.table.name,fromColumnName:E.fromColumn.name,toTableName:E.toColumn.table.name,toColumnName:E.toColumn.name},E.fromColumn.table.schemaName,E.toColumn.table.schemaName)}),[2,this.modelAuthoring.apply({changes:f}).then(function(){return v.updateModelChangeInProgress(!1)},function(){return v.updateModelChangeInProgress(!1)})]):[2]}})})},c.toggleRelationshipIsActive=function(u){var f=Gi(u.crossFilteringBehavior),v=!u.isActive,C=Fr({fromTableName:u.fromColumn.table.name,fromColumnName:u.fromColumn.name,toTableName:u.toColumn.table.name,toColumnName:u.toColumn.name,isActive:v,referentialIntegrity:u.relyOnReferentialIntegrity,fromCardinality:Wi(u.cardinality),toCardinality:Hi(u.cardinality),crossFilteringBehavior:f,securityFilteringBehavior:Ki(c.relationshipPropertyDataFactory.canSupportRLS(u.fromColumn.table.name,u.toColumn.table.name),u.securityFilteringBehavior,f,v)},u.fromTable.schemaName,u.toTable.schemaName);c.updateModelChangeInProgress(!0),c.modelAuthoring.apply({changes:[C]}).then(function(){return c.updateModelChangeInProgress(!1)},function(){return c.updateModelChangeInProgress(!1)})},c.autodetectRelationships=function(){c.updateAutodetectRelationshipsInProgress(!0),c.modelAuthoring.detectRelationships(!0).then(function(u){return(0,d.__awaiter)(c,void 0,void 0,function(){var f,v,C=this;return(0,d.__generator)(this,function(E){switch(E.label){case 0:return u?[4,this.confirmToAddDetectedRelationship((f=u.relationshipsDetectionResult.relationships).length)]:(this.updateAutodetectRelationshipsInProgress(!1),[2]);case 1:return E.sent(),this.updateAutodetectRelationshipsInProgress(!1),f.length>0?(this.updateModelChangeInProgress(!0),v=[],f.forEach(function(z){var ce=Qt.G.createObject(z.fromColumnUrn),le=Qt.G.createObject(z.toColumnUrn),fe=ce.getTopLevelPart().name,we=ce.getSecondLevelPart().name,Ue=le.getTopLevelPart().name,ze=Cn({fromTableName:fe,fromColumnName:we,toTableName:Ue,toColumnName:le.getSecondLevelPart().name,isActive:z.isActive,referentialIntegrity:z.referentialIntegrity,fromCardinality:z.fromCardinality,toCardinality:z.toCardinality,crossFilteringBehavior:z.crossFilteringBehavior,securityFilteringBehavior:z.securityFilteringBehavior},(0,$t.Kp)(C.modelService.model,fe),(0,$t.Kp)(C.modelService.model,Ue));v.push(ze)}),[2,this.modelAuthoring.apply({changes:v}).then(function(){return C.updateModelChangeInProgress(!1)},function(){return C.updateModelChangeInProgress(!1)})]):[2]}})})},function(u){c.updateAutodetectRelationshipsInProgress(!1)})},c.relationshipsDataSource=new iu([]),c.selectionModel=new tu.Ov(!0,[]),c.modelService.modelChange$.pipe((0,qe.R)(c.destroy$)).subscribe(function(u){var f,v=_.isEmpty(null===(f=u?.model)||void 0===f?void 0:f.relationships)?[]:Object.keys(u.model.relationships).map(function(C){return new ou(u.model.relationships[C],c.localizationService)});c.updateRelationships(v)}),c.relationships$.pipe((0,qe.R)(c.destroy$)).subscribe(function(u){c.relationshipsDataSource.setData(u),c.updateSelections(u)}),c}return(0,d.__extends)(t,i),t.prototype.ngOnDestroy=function(){i.prototype.ngOnDestroy.call(this)},t.prototype.getSelectedRelationship=function(){var n=this;return this.relationships$.pipe((0,Me.U)(function(r){return r.filter(function(o){return n.selectionModel.isSelected((0,Ao.T)(o))})}))},t.prototype.confirmToDeleteRelationship=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return n=this.localizationService.get("Delete"),r=this.localizationService.get("DeleteRelationshipConfirmationTitle"),[4,gn.Z.buildOKCancelDialog({title:r,message:this.localizationService.get("DeleteRelationshipConfirmationMessage")},"Delete Relationship",this.dialogService,this.localizationService,n,this.localizationService.get("Cancel_ButtonText"))];case 1:return[4,l.sent().afterClosed().toPromise()];case 2:return[2,1===l.sent()]}})})},t.prototype.confirmToAddDetectedRelationship=function(n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return r=this.localizationService.get("Autodetect"),o=n>0?this.localizationService.format("AutodetectRelationshipsFound",n):this.localizationService.get("AutodetectRelationshipsNoneFound"),[4,gn.Z.buildCancelDialog(r,o,"Autodetect Relationship",this.dialogService,this.localizationService,this.localizationService.get("Close"))];case 1:return[2,l.sent().afterClosed().toPromise()]}})})},t.prototype.updateFilterChange=function(n,r){this.relationshipsDataSource.filter=JSON.stringify({relationshipSymbol:{crossFilteringCriterion:n??[],cardinalitiesCriterion:r??[]}})},t.prototype.updateModelChangeInProgress=function(n){this.patchState({modelChangeInProgress:n}),this.templateDialogPayload.setSpinnerDisplay(n)},t.prototype.updateAutodetectRelationshipsInProgress=function(n){this.patchState({autodetectRelationshipsInProgress:n})},t.prototype.updateRelationships=function(n){this.patchState({relationships:(0,d.__spreadArray)([],n,!0)})},t.prototype.updateSelections=function(n){for(var r,o=this.selectionModel.selected,a=new Set(_.map(n,function(f){return(0,Ao.T)(f)})),l=[],s=0,c=o;s<c.length;s++){var u=c[s];a.has(u)||l.push(u)}(r=this.selectionModel).deselect.apply(r,l||[])},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(Oe.b),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(Sn.x),e.\u0275\u0275inject(at.x),e.\u0275\u0275inject(on),e.\u0275\u0275inject(Qn.S))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(Li.m1),gi=function(i){return i.Cardinality="Cardinality",i.CrossFilteringBehavior="CrossFilteringBehavior",i}({}),cr=function(i){return i.OneToOne="OneToOne",i.ManyToOne="ManyToOne",i.ManyToMany="ManyToMany",i}({}),Fo=function(i){return i.OneDirection="OneDirection",i.BothDirections="BothDirections",i}({}),su=function(){function i(t){this.data=t}return i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Ie.WF))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["relationship-tooltip"]],decls:10,vars:8,consts:[[1,"tooltip-label"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"span",0),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div")(6,"span",0),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,4,"Cardinality"),":"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.data.cardinality,""),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(8,6,"Cross_Filter_Direction"),":"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.data.crossFilteringBehavior,""))},dependencies:[ft.F],styles:['.tooltip-label[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-bold, 700)}'],changeDetection:0}),i}(),cu=p(45916),du=p(94030),uu=p(18460),pu=["fromColumnCell"],gu=["toColumnCell"],hu=["relationshipCell"],mu=["activeCell"],fu=["dialogTemplate"],vu=["autodetectButton"],_u=["editButton"],bu=["deleteButton"],yu=["filterButton"],Cu=["rightButtonSet"],Su=["fluentListContainer"];function Mu(i,t){1&i&&e.\u0275\u0275element(0,"pbi-spinner",33)}function wu(i,t){1&i&&e.\u0275\u0275element(0,"tri-svg-icon",34),2&i&&e.\u0275\u0275property("name","flash_20_regular")}function xu(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",28,29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.detectRelationships())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275template(3,Mu,1,0,"pbi-spinner",30),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,wu,1,1,"tri-svg-icon",31),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275element(7,"span",32),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,3,"Autodetect")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(4,5,r.autodetectRelationshipsInProgress$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(6,7,r.autodetectRelationshipsInProgress$))}}function Pu(i,t){1&i&&(e.\u0275\u0275elementStart(0,"p",35),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"No_Relationships_Defined")," "))}function Ou(i,t){if(1&i&&e.\u0275\u0275element(0,"pbi-svg-use-symbol",41),2&i){var n=t.ngIf;e.\u0275\u0275property("sheet",n.sheet)("symbolId",n.symbolId)}}var hi=function(t){return{width:t}};function Eu(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"span",36)(1,"div",37),e.\u0275\u0275template(2,Ou,1,2,"pbi-svg-use-symbol",38),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",39)(5,"span",40),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()()()),2&i){var n=t.$implicit,o=t.colindex,a=t.tabindex;e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction1(10,hi,t.colWidth.fromtablecolumn+"px")),e.\u0275\u0275property("tabindex",a)("triTooltip",n.fromColumn.displayName)("triTooltipAlwaysShow",!0),e.\u0275\u0275attribute("aria-colindex",o),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,8,n.fromColumn.icon)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(n.fromColumn.displayName)}}function Du(i,t){if(1&i&&e.\u0275\u0275element(0,"pbi-svg-use-symbol",41),2&i){var n=t.ngIf;e.\u0275\u0275property("sheet",n.sheet)("symbolId",n.symbolId)}}function Tu(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"span",36)(1,"div",37),e.\u0275\u0275template(2,Du,1,2,"pbi-svg-use-symbol",38),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",39)(5,"span",40),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()()()),2&i){var n=t.$implicit,o=t.colindex,a=t.tabindex;e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction1(10,hi,t.colWidth.totablecolumn+"px")),e.\u0275\u0275property("tabindex",a)("triTooltip",n.toColumn.displayName)("triTooltipAlwaysShow",!0),e.\u0275\u0275attribute("aria-colindex",o),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,8,n.toColumn.icon)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(n.toColumn.displayName)}}function Iu(i,t){1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275element(0,"tri-svg-icon",53))}function Ru(i,t){1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275elementStart(0,"div",54)(1,"span"),e.\u0275\u0275text(2,"1"),e.\u0275\u0275elementEnd()())}function Au(i,t){1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275element(0,"tri-svg-icon",55))}function Fu(i,t){1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275element(0,"tri-svg-icon",57))}function ku(i,t){1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275element(0,"tri-svg-icon",58))}function Bu(i,t){if(1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275template(0,Fu,1,0,"ng-template",49),e.\u0275\u0275template(1,ku,1,0,"ng-template",null,56,e.\u0275\u0275templateRefExtractor)),2&i){var n=e.\u0275\u0275reference(2),r=e.\u0275\u0275nextContext().$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",r.relationshipSymbol.cardinality===o.RelationshipCardinalityManyToOne)("ngIfElse",n)}}function Lu(i,t){1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275element(0,"tri-svg-icon",59))}function Nu(i,t){1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275elementStart(0,"div",60)(1,"span"),e.\u0275\u0275text(2,"1"),e.\u0275\u0275elementEnd()())}function Vu(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",42),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(3,"svg",43),e.\u0275\u0275element(4,"rect",44)(5,"rect",45)(6,"rect",46)(7,"rect",47)(8,"rect",48),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,Iu,1,0,"ng-template",49),e.\u0275\u0275template(10,Ru,3,0,"ng-template",null,50,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(12,Au,1,0,"ng-template",49),e.\u0275\u0275template(13,Bu,3,2,"ng-template",null,51,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(15,Lu,1,0,"ng-template",49),e.\u0275\u0275template(16,Nu,3,0,"ng-template",null,52,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit,r=t.colWidth,o=t.colindex,a=t.tabindex,l=e.\u0275\u0275reference(11),s=e.\u0275\u0275reference(14),c=e.\u0275\u0275reference(17),u=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction1(17,hi,r.relationship+"px")),e.\u0275\u0275property("triTooltip",u.RelationshipTooltipComponent)("triTooltipComponentData",n.relationshipSymbol.tooltipData)("aria-label",e.\u0275\u0275pipeBind1(1,13,"Cardinality")+" "+n.relationshipSymbol.tooltipData.cardinality+" "+e.\u0275\u0275pipeBind1(2,15,"Cross_Filter_Direction")+" "+n.relationshipSymbol.tooltipData.crossFilteringBehavior)("tabindex",a),e.\u0275\u0275attribute("aria-colindex",o),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",n.relationshipSymbol.cardinality===u.RelationshipCardinalityManyToMany||n.relationshipSymbol.cardinality===u.RelationshipCardinalityManyToOne)("ngIfElse",l),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.relationshipSymbol.crossFilteringBehavior===u.CrossFilteringBehaviorBothDirection)("ngIfElse",s),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.relationshipSymbol.cardinality===u.RelationshipCardinalityManyToMany)("ngIfElse",c)}}function Uu(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",61),e.\u0275\u0275listener("contextmenu",function(u){var v=e.\u0275\u0275restoreView(n).$implicit,C=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(C.toggleContextMenu(u,v))}),e.\u0275\u0275elementStart(1,"div",62)(2,"span",63),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"div",64)(5,"button",65),e.\u0275\u0275listener("triMenuButtonClick",function(u){var v=e.\u0275\u0275restoreView(n).$implicit,C=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(C.onRelationshipContextMenuButtonClicked(u,v))})("triMenuOpen",function(){var f=e.\u0275\u0275restoreView(n).$implicit,v=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(v.menuFocusedItem=f)}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275element(7,"tri-svg-icon",13),e.\u0275\u0275elementEnd()()()}if(2&i){var r=t.$implicit,o=t.colWidth,a=t.colindex,l=t.tabindex,s=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction1(11,hi,o.active+"px")),e.\u0275\u0275property("tabindex",l),e.\u0275\u0275attribute("aria-colindex",a),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(r.isActive),e.\u0275\u0275advance(2),e.\u0275\u0275property("triTooltipPosition","below")("triMenu",s.relationshipContextMenu(r)),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,9,"FieldListProperty_Context_Menu")),e.\u0275\u0275advance(2),e.\u0275\u0275property("name","more_horizontal_20_regular")}}var zu=function(t){return{"no-relationships":t}},ko=function(){function i(t,n,r,o,a,l,s,c){var u=this;this.localizationService=t,this.manageRelationshipsStoreService=n,this.templateDialogPayload=r,this.telemetryService=o,this.triMenuService=a,this.featureSwitchService=l,this.highContrastCssGenerationService=s,this.dataModelService=c,this.shouldHideFilterListSearchBox=!0,this.RelationshipTooltipComponent=su,this.fluentListModulePath="@powerbi/CoreFluentList/fluent-list.module#FluentListModule",this.fluentListTableBaseComponentId="FluentListTableBaseComponentId",this.hostedEnvironmentTelemetryHint="manage-relationships-list",this.RelationshipCardinalityManyToMany=V.KA.ManyToMany,this.RelationshipCardinalityManyToOne=V.KA.ManyToOne,this.CrossFilteringBehaviorBothDirection=V.jE.BothDirections,this.filters=[],this.selection=this.manageRelationshipsStoreService.selectionModel,this.focusedRowId$=new Gt.X(null),this.hoveredRowId$=new Gt.X(null),this.columnConfigs$=new Gt.X([]),this.modelChangeInProgress$=this.manageRelationshipsStoreService.modelChangeInProgress$,this.disableEditBtn$=(0,Et.aj)([this.manageRelationshipsStoreService.modelChangeInProgress$,this.selection.changed,this.selection.changed.pipe((0,Bt.w)(function(C){return u.manageRelationshipsStoreService.getSelectedRelationship()}))]).pipe((0,Me.U)(function(C){return C[0]||1!==u.selection.selected.length||!C[2].every(function(le){return le.canEdit})}),(0,ui.O)(!0)),this.disableEditBtnToolTip$=(0,Et.aj)([this.disableEditBtn$,this.selection.changed.pipe((0,Bt.w)(function(C){return u.manageRelationshipsStoreService.getSelectedRelationship()}))]).pipe((0,Me.U)(function(C){if(C[0])return u.localizationService.get(C[1].length>0?"Manage_Relationship_Edit_Button_Tooltip_Multi_Selection":"Manage_Relationship_Edit_Button_Tooltip_No_Selection")}),(0,ui.O)(this.localizationService.get("Manage_Relationship_Edit_Button_Tooltip_No_Selection"))),this.disableDeleteBtn$=(0,Et.aj)([this.manageRelationshipsStoreService.modelChangeInProgress$,this.selection.changed,this.selection.changed.pipe((0,Bt.w)(function(C){return u.manageRelationshipsStoreService.getSelectedRelationship()}))]).pipe((0,Me.U)(function(C){return C[0]||0===u.selection.selected.length||!C[2].every(function(le){return le.canEdit})}),(0,ui.O)(!0)),this.disableDeleteBtnToolTip$=this.disableDeleteBtn$.pipe((0,Me.U)(function(C){return C?u.localizationService.get("Manage_Relationship_Delete_Button_Tooltip_No_Selection"):void 0})),this.autodetectRelationshipsInProgress$=this.manageRelationshipsStoreService.autodetectRelationshipsInProgress$,this.disableAutodetectButtonOnDirectLake=!1,this.filters=function(i){return[{displayName:i.get("Cardinality"),id:gi.Cardinality,items:[{displayName:i.get("One_To_One_for_label"),id:cr.OneToOne,value:V.KA.OneToOne},{displayName:i.get("Many_To_One_for_label"),id:cr.ManyToOne,value:V.KA.ManyToOne},{displayName:i.get("Many_To_Many_for_label"),id:cr.ManyToMany,value:V.KA.ManyToMany}]},{displayName:i.get("Cross_Filter_Direction"),id:gi.CrossFilteringBehavior,items:[{displayName:i.get("Single"),id:Fo.OneDirection,value:V.jE.OneDirection},{displayName:i.get("Visual_LabelStyle_Both"),id:Fo.BothDirections,value:V.jE.BothDirections}]}]}(this.localizationService),this.dataSource=this.manageRelationshipsStoreService.relationshipsDataSource,this.fluentListTableBaseInputArgs={focusedRowId$:this.focusedRowId$,hoveredRowId$:this.hoveredRowId$,dataSource:this.dataSource,selection:this.selection,allowSelection:!0,columnConfigs$:this.columnConfigs$.pipe((0,eu.n)(function(C){return C.length<1})),defaultSort:{id:"fromtablecolumn",start:"asc",disableClear:!1},hostedEnvironmentTelemetryHint:this.hostedEnvironmentTelemetryHint,useKeyboardNavigation:!0,alwaysDisplayTable:!0};var f=this.dataModelService.getDataModel();this.disableAutodetectButtonOnDirectLake=!this.featureSwitchService.featureSwitches.allowDirectLakeDataValidation&&this.isDirectLakeModel(f),this.initializeHighContrastRules()}return i.prototype.ngAfterViewInit=function(){this.setColumnConfigs()},i.prototype.setColumnConfigs=function(){this.columnConfigs$.next([{name:"fromtablecolumn",visible$:(0,bn.of)(!0),canResize:!0,canSort:!0,class:"col-header col-column",cellTemplate:this.fromColumnCell,defaultWidth:248,minWidth:248,content:this.localizationService.get("From_Header"),tooltip:[this.localizationService.get("From_Header"),this.localizationService.get("FilterPane_Filter_Sort_ZA"),this.localizationService.get("FilterPane_Filter_Sort_AZ")]},{name:"relationship",visible$:(0,bn.of)(!0),canResize:!0,canSort:!0,class:"col-header col-relationship",cellTemplate:this.relationshipCell,defaultWidth:148,minWidth:148,content:this.localizationService.get("Relationship"),tooltip:[this.localizationService.get("Relationship"),this.localizationService.get("FilterPane_Filter_Sort_ZA"),this.localizationService.get("FilterPane_Filter_Sort_AZ")]},{name:"totablecolumn",visible$:(0,bn.of)(!0),canResize:!0,canSort:!0,class:"col-header col-column",cellTemplate:this.toColumnCell,defaultWidth:248,minWidth:248,content:this.localizationService.get("To_Header"),tooltip:[this.localizationService.get("To_Header"),this.localizationService.get("FilterPane_Filter_Sort_ZA"),this.localizationService.get("FilterPane_Filter_Sort_AZ")]},{name:"active",visible$:(0,bn.of)(!0),canResize:!0,canSort:!0,class:"col-header col-active",cellTemplate:this.activeCell,defaultWidth:100,minWidth:100,content:this.localizationService.get("Status"),tooltip:[this.localizationService.get("Status"),this.localizationService.get("FilterPane_Filter_Sort_ZA"),this.localizationService.get("FilterPane_Filter_Sort_AZ")]}])},i.prototype.editRelationship=function(t){if(!t)throw new Error("menu focused item should be defined before edit relationship from menu item");this.templateDialogPayload.closeDialogFromConsumer({closeStatus:"OpenEditRelationshipDialog",args:{fromTableId:t.data.fromColumn.table.name,fromColumnId:t.data.fromColumn.name,toTableId:t.data.toColumn.table.name,toColumnId:t.data.toColumn.name}}),this.telemetryService.logEvent(ho,{entryPoint:"ContextMenu"})},i.prototype.deleteRelationship=function(t){if(!t)throw new Error("menu focused item should be defined before delete relationship from menu item");this.manageRelationshipsStoreService.deleteRelationship(t.data),this.telemetryService.logEvent(fo,{numberOfRelationshipToDelete:1,entryPoint:"ContextMenu"})},i.prototype.detectRelationships=function(){this.manageRelationshipsStoreService.autodetectRelationships(),this.telemetryService.logEvent(gs)},i.prototype.toggleActive=function(t){if(!t)throw new Error("menu focused item should be defined before set relationship active from menu item");this.telemetryService.logEvent(ds),this.manageRelationshipsStoreService.toggleRelationshipIsActive(t.data)},i.prototype.onFilterChange=function(t){if(this.shouldHideFilterListSearchBox&&t){var n=t.selected.filter(function(o){return o.groupId===gi.CrossFilteringBehavior}).map(function(o){return o.value}),r=t.selected.filter(function(o){return o.groupId===gi.Cardinality}).map(function(o){return o.value});this.manageRelationshipsStoreService.updateFilterChange(n,r),this.telemetryService.logEvent(us,{crossFilterBehaviors:JSON.stringify(n),cardinalities:JSON.stringify(r)})}},i.prototype.deleteSelectedRelationships=function(){"true"!==this.deleteButtonRef.nativeElement.ariaDisabled&&(this.manageRelationshipsStoreService.deleteSelectedRelationship(),this.telemetryService.logEvent(fo,{numberOfRelationshipToDelete:this.selection.selected.length,entryPoint:"TopButton"}))},i.prototype.editSelectedRelationship=function(){var t=this;"true"!==this.editButtonRef.nativeElement.ariaDisabled&&this.manageRelationshipsStoreService.getSelectedRelationship().pipe((0,nt.q)(1)).subscribe(function(n){if(1!==n.length)throw new Error("expect to edit only one relationship but got ".concat(n.length));t.telemetryService.logEvent(ho,{entryPoint:"TopButton"}),t.templateDialogPayload.closeDialogFromConsumer({closeStatus:"OpenEditRelationshipDialog",args:{fromTableId:n[0].data.fromColumn.table.name,fromColumnId:n[0].data.fromColumn.name,toTableId:n[0].data.toColumn.table.name,toColumnId:n[0].data.toColumn.name}})})},i.prototype.createNewRelationship=function(){this.templateDialogPayload.closeDialogFromConsumer({closeStatus:"OpenNewRelationshipDialog",args:{fromColumnId:void 0,fromTableId:void 0,toTableId:void 0,toColumnId:void 0}}),this.telemetryService.logEvent(ps)},i.prototype.onRelationshipContextMenuButtonClicked=function(t,n){switch(t.id){case"edit":this.editRelationship(n);break;case"delete":this.deleteRelationship(n);break;case"toggleActive":this.toggleActive(n)}},i.prototype.relationshipContextMenu=function(t){var n=!1;return this.modelChangeInProgress$.pipe((0,nt.q)(1)).subscribe(function(r){return n=r}),{styles:{width:"248px"},items:[{id:"edit",type:Ht.fz.Button,text:this.localizationService.get("Edit"),disabled:!t.canEdit||n,icon:{sprite:"fluentui-icons",name:"edit_20_regular"}},{id:"delete",type:Ht.fz.Button,text:this.localizationService.get("Delete"),disabled:!t.canEdit||n,icon:{sprite:"fluentui-icons",name:"delete_20_regular"}},{type:Ht.fz.Divider},{id:"toggleActive",type:Ht.fz.Button,text:this.getToggleActiveText(t),disabled:!t.canEdit||n,icon:{sprite:"fluentui-icons",name:""}}]}},i.prototype.getToggleActiveText=function(t){var n;return null!==(n=t.data)&&void 0!==n&&n.isActive?this.localizationService.get("Switch_Status_To_Inactive"):this.localizationService.get("Switch_Status_To_Active")},i.prototype.toggleContextMenu=function(t,n){var r=this;t.stopPropagation(),t.preventDefault();var a=new e.ElementRef(t.currentTarget.getElementsByTagName("button").item(0)),l=this.triMenuService.open({menu:this.relationshipContextMenu(n),origin:a});l.onButtonClick$.pipe((0,qe.R)(l.onClose$)).subscribe(function(s){r.onRelationshipContextMenuButtonClicked(s,n),l.close()})},i.prototype.onTab=function(t){var n=t.target,r=!1;this.autoDetectButtonRef.nativeElement.contains(n)?r=this.focusOnRightButtonSet():this.rightButtonSetRef.nativeElement.contains(n)?r=this.focusOnTable():this.fluentListRef.nativeElement.contains(n)&&(r=this.focusOnOkButton()),r&&(t.stopPropagation(),t.preventDefault())},i.prototype.onShiftTab=function(t){var n=t.target,r=!1;this.rightButtonSetRef.nativeElement.contains(n)?r=this.focusOnAutoDetectButton():this.fluentListRef.nativeElement.contains(n)?r=this.focusOnRightButtonSet():this.getOkButtonRef().nativeElement.contains(n)&&(r=this.focusOnTable()),r&&(t.stopPropagation(),t.preventDefault())},i.prototype.handleRightButtonSetKeyDown=function(t){var n=t.target;switch(t.key){case"ArrowRight":switch(n){case this.editButtonRef.nativeElement:this.deleteButtonRef.nativeElement.focus();break;case this.deleteButtonRef.nativeElement:this.getFilterButton().focus();break;case this.getFilterButton():this.editButtonRef.nativeElement.focus()}break;case"ArrowLeft":switch(n){case this.editButtonRef.nativeElement:this.getFilterButton().focus();break;case this.deleteButtonRef.nativeElement:this.editButtonRef.nativeElement.focus();break;case this.getFilterButton():this.deleteButtonRef.nativeElement.focus()}}},i.prototype.focusOnTable=function(){return this.getFirstTableCell().focus(),!0},i.prototype.focusOnRightButtonSet=function(){return this.editButtonRef.nativeElement.focus(),!0},i.prototype.focusOnAutoDetectButton=function(){return this.autoDetectButtonRef.nativeElement.focus(),!0},i.prototype.focusOnOkButton=function(){return this.getOkButtonRef().nativeElement.focus(),!0},i.prototype.getOkButtonRef=function(){return this.okButtonRef||(this.okButtonRef=new e.ElementRef(this.dialogTemplateRef.nativeElement.querySelector("#okButton"))),this.okButtonRef},i.prototype.getFirstTableCell=function(){return this.firstTableCell||(this.firstTableCell=this.fluentListRef.nativeElement.querySelector('[aria-rowindex="1"] [aria-colindex="1"] input')),this.firstTableCell},i.prototype.getFilterButton=function(){return this.filterButton||(this.filterButton=this.filterButtonRef.nativeElement.querySelector("button")),this.filterButton},i.prototype.isDirectLakeModel=function(t){var n;return null===(n=t.tables)||void 0===n?void 0:n.some(function(r){var o;return null===(o=r.partitions)||void 0===o?void 0:o.some(function(a){return"DirectLake"===a.mode})})},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .themeableElement .col-relationship .relationship-outlines .relationship-icon-border","{ fill:  @backgroundColor !important; }")},i.dialogNameKey=Rt.eV,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(pi),e.\u0275\u0275directiveInject(at.x),e.\u0275\u0275directiveInject(Mt.y0),e.\u0275\u0275directiveInject(Ht.sI),e.\u0275\u0275directiveInject(Ot.vZ),e.\u0275\u0275directiveInject(D.g),e.\u0275\u0275directiveInject(Ke.n))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["manage-relationships"]],viewQuery:function(n,r){if(1&n&&(e.\u0275\u0275viewQuery(pu,5),e.\u0275\u0275viewQuery(gu,5),e.\u0275\u0275viewQuery(hu,5),e.\u0275\u0275viewQuery(mu,5),e.\u0275\u0275viewQuery(Ht.rX,5),e.\u0275\u0275viewQuery(fu,5),e.\u0275\u0275viewQuery(vu,5),e.\u0275\u0275viewQuery(_u,5),e.\u0275\u0275viewQuery(bu,5),e.\u0275\u0275viewQuery(yu,5,e.ElementRef),e.\u0275\u0275viewQuery(Cu,5),e.\u0275\u0275viewQuery(Su,5)),2&n){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.fromColumnCell=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.toColumnCell=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.relationshipCell=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.activeCell=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.triMenu=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.dialogTemplateRef=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.autoDetectButtonRef=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.editButtonRef=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.deleteButtonRef=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.filterButtonRef=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.rightButtonSetRef=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.fluentListRef=o.first)}},features:[e.\u0275\u0275ProvidersFeature([pi,at.x,on])],decls:45,vars:46,consts:[["dialogTemplate",""],[3,"keydown.tab","keydown.shift.tab"],[1,"toolbar"],[1,"left-button-set"],["tri-button","","appearance","primary","id","new-relationship-button","type","button",1,"pbi-fluent-button","primary",3,"disabled","click"],["newRelationshipButton",""],["tri-svg-icon-20","",1,"add-svg-icon",3,"name"],["id","new-relationship-text","localize","New_Relationship",1,"button-text"],["tri-button","","class","pbi-fluent-button","id","autodetect-button","type","button",3,"click",4,"ngIf"],[1,"right-button-set",3,"keydown"],["rightButtonSet",""],["tri-button","","id","edit-relationship-button","type","button",1,"pbi-fluent-button",3,"triTooltip","click"],["editButton",""],["tri-svg-icon-20","",3,"name"],["id","edit-text","localize","Edit",1,"button-text"],["tri-button","","id","delete-relationship-button","type","button",1,"pbi-fluent-button",3,"triTooltip","click"],["deleteButton",""],["id","delete-text","localize","Delete",1,"button-text"],["id","relationship-list-filter",3,"filters","isTrident","shouldHideSearchBox","filterChange"],["filterButton",""],[1,"fluent-list-container",3,"ngClass"],["fluentListContainer",""],[3,"modulePath","componentId","inputArgs"],["class","no-relationship-label",4,"ngIf"],["fromColumnCell",""],["toColumnCell",""],["relationshipCell",""],["activeCell",""],["tri-button","","id","autodetect-button","type","button",1,"pbi-fluent-button",3,"click"],["autodetectButton",""],["class","pbi-spinner-medium",4,"ngIf"],["class","flash-svg-icon","tri-svg-icon-20","",3,"name",4,"ngIf"],["id","autodetect-text","localize","Autodetect",1,"button-text"],[1,"pbi-spinner-medium"],["tri-svg-icon-20","",1,"flash-svg-icon",3,"name"],[1,"no-relationship-label"],["cdkMonitorElementFocus","","role","gridcell",1,"col","col-column",3,"tabindex","triTooltip","triTooltipAlwaysShow"],[1,"icon-container"],[3,"sheet","symbolId",4,"ngIf"],[1,"table-column-content-container"],[1,"table-column-content"],[3,"sheet","symbolId"],["cdkMonitorElementFocus","","role","gridcell",1,"col","col-relationship",3,"triTooltip","triTooltipComponentData","aria-label","tabindex"],["width","105","height","25","viewBox","0 0 105 25","fill","none","xmlns","http://www.w3.org/2000/svg",1,"relationship-outlines"],["x","20.5","y","12.3164","width","24","height","1",1,"relationship-outlines-line"],["x","60.5","y","12.3164","width","24","height","1",1,"relationship-outlines-line"],["x","4.5","y","4.31641","width","17","height","17","rx","4.5","stroke-width","1",1,"relationship-icon-border"],["x","44","y","3.81641","width","17","height","17","rx","4.5","stroke-width","1",1,"relationship-icon-border"],["x","84.5","y","4.31641","width","17","height","17","rx","4.5","stroke-width","1",1,"relationship-icon-border"],[3,"ngIf","ngIfElse"],["fromOneIcon",""],["oneDirectionIcon",""],["toOneIcon",""],["tri-svg-icon-16","","name","asterisk_16_regular","sprite","modeling-icons",1,"relationship-icon","cardinality-icon","from-cardinality-icon"],[1,"one-icon-container","relationship-icon","one-from-cardinality-icon"],["tri-svg-icon-16","","name","caret_left_right_16_filled","sprite","modeling-icons",1,"relationship-icon","cross-filter-icon"],["rightArrowIcon",""],["tri-svg-icon-16","","name","caret_left_24_filled",1,"relationship-icon","cross-filter-icon"],["tri-svg-icon-16","","name","caret_right_24_filled",1,"relationship-icon","cross-filter-icon"],["tri-svg-icon-16","","name","asterisk_16_regular","sprite","modeling-icons",1,"relationship-icon","cardinality-icon","to-cardinality-icon"],[1,"one-icon-container","relationship-icon","one-to-cardinality-icon"],["cdkMonitorElementFocus","","role","gridcell","aria-haspopup","menu",1,"col","col-active",3,"tabindex","contextmenu"],[1,"active-status-container"],[1,"active-status"],[1,"col-active-context-menu-button-container"],["tri-button","",1,"col-active-context-menu-button",3,"triTooltipPosition","triMenu","triMenuButtonClick","triMenuOpen"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"div",null,0)(2,"template-dialog",1),e.\u0275\u0275listener("keydown.tab",function(a){return r.onTab(a)})("keydown.shift.tab",function(a){return r.onShiftTab(a)}),e.\u0275\u0275elementStart(3,"div",2)(4,"div",3)(5,"button",4,5),e.\u0275\u0275listener("click",function(){return r.createNewRelationship()}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275element(9,"tri-svg-icon",6)(10,"span",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(11,xu,8,9,"button",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",9,10),e.\u0275\u0275listener("keydown",function(a){return r.handleRightButtonSetKeyDown(a)}),e.\u0275\u0275elementStart(14,"button",11,12),e.\u0275\u0275listener("click",function(){return r.editSelectedRelationship()}),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275pipe(18,"localize"),e.\u0275\u0275pipe(19,"async"),e.\u0275\u0275element(20,"tri-svg-icon",13)(21,"span",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"button",15,16),e.\u0275\u0275listener("click",function(){return r.deleteSelectedRelationships()}),e.\u0275\u0275pipe(24,"async"),e.\u0275\u0275pipe(25,"async"),e.\u0275\u0275pipe(26,"localize"),e.\u0275\u0275pipe(27,"async"),e.\u0275\u0275element(28,"tri-svg-icon",13)(29,"span",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"tri-list-filter",18,19),e.\u0275\u0275listener("filterChange",function(a){return r.onFilterChange(a)}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(32,"div",20,21),e.\u0275\u0275elementContainerStart(34),e.\u0275\u0275element(35,"pbi-lazy-load",22),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275template(36,Pu,3,3,"p",23),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(37,Eu,7,12,"ng-template",null,24,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(39,Tu,7,12,"ng-template",null,25,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(41,Vu,18,19,"ng-template",null,26,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(43,Uu,8,13,"ng-template",null,27,e.\u0275\u0275templateRefExtractor)),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(8,26,r.modelChangeInProgress$)),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(7,24,"New_Relationship")),e.\u0275\u0275advance(4),e.\u0275\u0275property("name","add_20_regular"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.disableAutodetectButtonOnDirectLake),e.\u0275\u0275advance(3),e.\u0275\u0275classProp("is-disabled",e.\u0275\u0275pipeBind1(16,28,r.disableEditBtn$)),e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(17,30,r.disableEditBtnToolTip$)),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(18,32,"Edit"))("aria-disabled",e.\u0275\u0275pipeBind1(19,34,r.disableEditBtn$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("name","edit_20_regular"),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("is-disabled",e.\u0275\u0275pipeBind1(24,36,r.disableDeleteBtn$)),e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(25,38,r.disableDeleteBtnToolTip$)),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(26,40,"Delete"))("aria-disabled",e.\u0275\u0275pipeBind1(27,42,r.disableDeleteBtn$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("name","delete_20_regular"),e.\u0275\u0275advance(2),e.\u0275\u0275property("filters",r.filters)("isTrident",!0)("shouldHideSearchBox",r.shouldHideFilterListSearchBox),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(44,zu,0===r.dataSource.data.length)),e.\u0275\u0275advance(3),e.\u0275\u0275property("modulePath",r.fluentListModulePath)("componentId",r.fluentListTableBaseComponentId)("inputArgs",r.fluentListTableBaseInputArgs),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===r.dataSource.data.length))},dependencies:[ie.NgClass,ie.NgIf,bt.X,Nt.J,qn.k,cu.R,du.y,tr.rX,Vt.M,ri.Z,uu.R,ie.AsyncPipe,ft.F],styles:['.pbi-fluent-button[_ngcontent-%COMP%]{display:flex;height:32px;line-height:16px;padding:0 12px;align-items:center;gap:4px}.pbi-fluent-button[_ngcontent-%COMP%]   .button-text[_ngcontent-%COMP%]{display:inline-flex;padding:0 0 2px 2px;align-items:flex-start;text-align:center;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}.pbi-fluent-button[_ngcontent-%COMP%]   .add-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForegroundOnBrand)}.left-button-set[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1 0 0;gap:8px}.right-button-set[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;gap:8px}.toolbar[_ngcontent-%COMP%]{display:flex;height:32px;padding:6px 8px 6px 0;align-items:flex-start;gap:8px;align-self:stretch;border-bottom:solid 1px var(--colorNeutralStroke2)}.col-column[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1 0 0;align-self:stretch}.col-active[_ngcontent-%COMP%]{display:flex;width:88px;flex-direction:row;justify-content:center;align-items:flex-start}.col-active[_ngcontent-%COMP%]   .col-active-context-menu-button-container[_ngcontent-%COMP%]{display:inline-flex;padding:6px 0;align-items:flex-start;height:32px;width:32px}.col-active[_ngcontent-%COMP%]   .col-active-context-menu-button[_ngcontent-%COMP%]{display:flex;align-items:center;height:32px;width:32px;padding:0;border-radius:4px;justify-content:center}.col-active[_ngcontent-%COMP%]   .active-status-container[_ngcontent-%COMP%]{display:flex;padding:11px 8px 13px;align-items:flex-end;gap:4px;flex:1 0 0;align-self:stretch}.col-active[_ngcontent-%COMP%]   .active-status[_ngcontent-%COMP%]{color:var(--colorNeutralForeground2);width:44px;display:inline-block;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.col-active-context-menu-button[_ngcontent-%COMP%], [tri-button][_ngcontent-%COMP%], #relationship-list-filter[_ngcontent-%COMP%]  .tri-filter-menu-trigger-button{border:none}.fluent-list-container.no-relationships[_ngcontent-%COMP%]   .no-relationship-label[_ngcontent-%COMP%]{height:516px;padding-left:8px;padding-top:11px;margin:0}.fluent-list-container.no-relationships[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport{height:0px}.fluent-list-container[_ngcontent-%COMP%]     .column-headers{margin:0}.fluent-list-container[_ngcontent-%COMP%]     .column-headers .col.col-checkbox{padding:0;flex:0 0 32px}.fluent-list-container[_ngcontent-%COMP%]     .mat-sort-header-container{padding:11px 8px 13px}.fluent-list-container[_ngcontent-%COMP%]     .col-header{padding-left:0}.fluent-list-container[_ngcontent-%COMP%]     .col-headers{margin:0}.fluent-list-container[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport{height:527px}.fluent-list-container[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{padding:0}.fluent-list-container[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper .col.col-checkbox{padding:0;flex:0 0 32px;display:flex;width:32px;height:45px;flex-direction:column;justify-content:center;align-items:flex-start;flex-shrink:0}.fluent-list-container[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper .row{height:45px;align-self:stretch}.fluent-list-container[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper .row .col{padding:0}.fluent-list-container[_ngcontent-%COMP%]     .cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper .row .col.col-relationship{width:152px;height:45px;padding:11px 0 0 4px;flex-shrink:0;align-self:stretch}.fluent-list-container[_ngcontent-%COMP%]     .checkbox, .fluent-list-container[_ngcontent-%COMP%]     .masterCheckbox{margin:8px}.fluent-list-container[_ngcontent-%COMP%]     .mat-checkbox-inner-container{height:16px;width:16px}.fluent-list-container[_ngcontent-%COMP%]     .mat-checkbox-inner-container .mat-checkbox-background, .fluent-list-container[_ngcontent-%COMP%]     .mat-checkbox-inner-container .mat-checkbox-frame{border-radius:2px;border-color:var(--colorNeutralForeground3)}.icon-container[_ngcontent-%COMP%]{display:flex;padding:10px 4px 10px 8px;align-items:center;gap:8px;align-self:stretch}.icon-placeholder[_ngcontent-%COMP%]{width:20px;flex-shrink:0}.relationship-outlines[_ngcontent-%COMP%]{position:absolute}.relationship-outlines-line[_ngcontent-%COMP%]{fill:var(--colorNeutralStrokeAccessible)}.relationship-icon-border[_ngcontent-%COMP%]{stroke:var(--colorNeutralStroke1);fill:var(--colorNeutralBackground1)}.relationship-icon[_ngcontent-%COMP%]{position:relative;vertical-align:middle;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-bold, 700)}.one-icon-container[_ngcontent-%COMP%]{height:16px;width:16px;display:inline-block;line-height:initial}.one-from-cardinality-icon[_ngcontent-%COMP%]{left:9px}.one-to-cardinality-icon[_ngcontent-%COMP%]{left:57px}.from-cardinality-icon[_ngcontent-%COMP%]{left:5px;top:1px}.to-cardinality-icon[_ngcontent-%COMP%]{left:53px}.cross-filter-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForeground3);color:var(--colorNeutralForeground3);left:28px}.cardinality-icon[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1);fill:var(--colorNeutralForeground1)}.table-column-content-container[_ngcontent-%COMP%]{padding:11px 8px 13px;display:flex;align-items:flex-end;gap:4px;flex:1 0 0;align-self:stretch}.table-column-content[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:200px}pbi-svg-use-symbol[_ngcontent-%COMP%]{height:16px;width:16px;transform:scale(1.25)}'],changeDetection:0}),i}();function ju(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n)}}function Wu(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,ju,2,1,"p",8),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.descriptions)}}function Hu(i,t){1&i&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275element(1,"pbi-spinner",10),e.\u0275\u0275elementEnd())}function Gu(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.clickAutodetect())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()}2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Autodetect")))}var Bo=function(){function i(t,n,r,o,a){this.localizationService=t,this.templateDialogPayload=n,this.manageRelationshipsStoreService=r,this.dataModelService=o,this.modelAuthoring=a,this.supportAutodetect=!1,this.descriptions=[],this.autodetectRelationshipsInProgress$=this.manageRelationshipsStoreService.autodetectRelationshipsInProgress$,this.defaultOkText=t.get("OK_ButtonText"),this.defaultCancelText=t.get("Cancel_ButtonText")}return i.prototype.ngOnInit=function(){this.descriptions=[],this.templateDialogPayload.input.autodetect?this.autodetect(this.templateDialogPayload.input.tables):this.areImportedTables(this.templateDialogPayload.input.tables)?(this.supportAutodetect=!0,this.descriptions.push(this.localizationService.get("RelationshipDetectingConfirmationMessage"))):this.descriptions.push(this.localizationService.get("RelationshipDetectingConfirmationMessageWithoutAutoDetect"))},i.prototype.closeDialog=function(){this.templateDialogPayload.closeDialogFromConsumer({closeStatus:"Close"})},i.prototype.clickAutodetect=function(){this.templateDialogPayload.closeDialogFromConsumer({closeStatus:"Autodetect"})},i.prototype.clickCreateRelationships=function(){this.templateDialogPayload.closeDialogFromConsumer({closeStatus:"ManageRelationship"})},i.prototype.areImportedTables=function(t){var n=this;return t.every(function(r){var o=(0,Qe.AG)(n.dataModelService.getDataModel(),r);return"Import"===(0,Qe.iJ)(o)})},i.prototype.getAutodetectMessageAndSchemaChanges=function(t,n){if(this.descriptions=[],!t||_.isEmpty(t.relationshipsDetectionResult.relationships))return this.descriptions.push(this.localizationService.get("NoRelationshipsWereDetected")),null;for(var o=[],a=0,l=t.relationshipsDetectionResult.relationships;a<l.length;a++){var s=l[a],c=Qt.G.createObject(s.fromColumnUrn),u=Qt.G.createObject(s.toColumnUrn),f=c.getTopLevelPart().name,v=u.getTopLevelPart().name,C=c.getSecondLevelPart().name,E=u.getSecondLevelPart().name;if(this.isTableRelated(f,n)&&this.isTableRelated(v,n)){this.descriptions.push(f+"["+C+"] => "+v+"["+E+"]");var z=Cn({fromTableName:f,fromColumnName:C,toTableName:v,toColumnName:E,isActive:s.isActive,referentialIntegrity:s.referentialIntegrity,fromCardinality:s.fromCardinality,toCardinality:s.toCardinality,crossFilteringBehavior:s.crossFilteringBehavior,securityFilteringBehavior:s.securityFilteringBehavior},(0,Qe.AG)(this.dataModelService.getDataModel(),f).schemaName,(0,Qe.AG)(this.dataModelService.getDataModel(),v).schemaName);o.push(z)}}return _.isEmpty(o)&&this.descriptions.push(this.localizationService.get("NoRelationshipsWereDetected")),o},i.prototype.isTableRelated=function(t,n){return n.some(function(r){return r===t})},i.prototype.autodetect=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return this.manageRelationshipsStoreService.updateAutodetectRelationshipsInProgress(!0),[4,this.modelAuthoring.detectRelationships(!0)];case 1:return n=o.sent(),r=this.getAutodetectMessageAndSchemaChanges(n,t),this.manageRelationshipsStoreService.updateAutodetectRelationshipsInProgress(!1),r?[2,this.modelAuthoring.apply({changes:r})]:[2]}})})},i.dialogNameKey=Rt.W1,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(at.x),e.\u0275\u0275directiveInject(pi),e.\u0275\u0275directiveInject(Ke.n,8),e.\u0275\u0275directiveInject(Qn.S))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["fix-missing-relationships-dialog"]],features:[e.\u0275\u0275ProvidersFeature([at.x,pi,on])],decls:15,vars:17,consts:[["role","dialog",1,"dialog"],[1,"dialog-content"],[4,"ngIf"],["class","spinner-container",4,"ngIf"],["footer-left-content","",1,"footer-button-set"],["tri-button","","appearance","primary","id","autodetectButton","data-testid","dailog-autodetect-btn","class","pbi-fluent-button","type","button",3,"click",4,"ngIf"],["tri-button","","id","createRelationshipsButton","data-testid","dailog-cr-btn","type","button",1,"pbi-fluent-button",3,"click"],["tri-button","","id","closeMRButton","data-testid","mr-report-view-dailog-close-btn","type","button",1,"pbi-fluent-button",3,"click"],[4,"ngFor","ngForOf"],[1,"spinner-container"],[1,"pbi-spinner-extra-small"],["tri-button","","appearance","primary","id","autodetectButton","data-testid","dailog-autodetect-btn","type","button",1,"pbi-fluent-button",3,"click"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"div",0)(2,"div",1),e.\u0275\u0275template(3,Wu,2,1,"div",2),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,Hu,2,0,"div",3),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",4),e.\u0275\u0275template(8,Gu,3,3,"button",5),e.\u0275\u0275elementStart(9,"button",6),e.\u0275\u0275listener("click",function(){return r.clickCreateRelationships()}),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"button",7),e.\u0275\u0275listener("click",function(){return r.closeDialog()}),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(4,9,r.autodetectRelationshipsInProgress$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(6,11,r.autodetectRelationshipsInProgress$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.supportAutodetect),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("primary",!r.supportAutodetect)("primaryBtn",!r.supportAutodetect),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,13,"Create_Relationship")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(14,15,"Close")))},dependencies:[ie.NgForOf,ie.NgIf,Nt.J,qn.k,ie.AsyncPipe,ft.F],styles:[".dialog[_ngcontent-%COMP%]{width:500px}.footer-button-set[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1 0 0;gap:8px;justify-content:end}.primary[_ngcontent-%COMP%]{background-color:var(--colorBrandBackground);border:none;color:var(--colorNeutralForegroundOnBrand);fill:var(--colorNeutralForegroundOnBrand);position:relative}"]}),i}(),Lo=function(){function i(t,n){this.dialogRef=t,this.multipleTables=n.multipleTables}return i.prototype.cancel=function(){this.dialogRef.close({removeFromDiagram:!1,deleteFromModel:!1})},i.prototype.removeFromDiagram=function(){this.dialogRef.close({removeFromDiagram:!0,deleteFromModel:!1})},i.prototype.deleteFromModel=function(){this.dialogRef.close({removeFromDiagram:!1,deleteFromModel:!0})},i.dialogNameKey=Rt.bS,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(en.so),e.\u0275\u0275directiveInject(en.WI))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["remove-or-delete-table"]],decls:17,vars:11,consts:[["role","dialog",1,"dialog-section","container","themeableElement"],["mat-dialog-title","",1,"dragHandle","mat-dialog-title"],[1,"modern-dialogCloseIcon","themeableElement",3,"click"],[1,"glyphicon","pbi-glyph-close"],["Name","remove_or_delete_table_dialog","aria-labelledby","dialog_header","aria-describedby","dialog_body","tabindex","-1",1,"dialog-content"],["id","dialog_header","tabindex","-1",1,"dialog-header",3,"localize"],["id","dialog_body",1,"dialog-body"],["tabindex","-1",1,"dialog-description",3,"localize"],[1,"dialog-footer"],[1,"dialog-actions"],["localize","COMMANDS_REMOVE_SELECTED_TABLES",1,"pbi-fluent-button","primary",3,"click"],["localize","WebDiagram_Delete_Objects",1,"pbi-fluent-button",3,"click"],["localize","Cancel_ButtonText",1,"pbi-fluent-button",3,"click"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"modeling-styles")(1,"div",0),e.\u0275\u0275element(2,"div",1),e.\u0275\u0275elementStart(3,"div",2),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275element(4,"span",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275element(6,"div",5),e.\u0275\u0275elementStart(7,"div",6),e.\u0275\u0275element(8,"p",7),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"div",8)(10,"div",9)(11,"button",10),e.\u0275\u0275listener("click",function(){return r.removeFromDiagram()}),e.\u0275\u0275pipe(12,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",11),e.\u0275\u0275listener("click",function(){return r.deleteFromModel()}),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"button",12),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd()()()()()),2&n&&(e.\u0275\u0275advance(6),e.\u0275\u0275property("localize",r.multipleTables?"RemoveOrDeleteMultipleTable":"RemoveOrDeleteTable"),e.\u0275\u0275advance(2),e.\u0275\u0275property("localize",r.multipleTables?"RemoveOrDeleteMultipleTableContent":"RemoveOrDeleteTableContent"),e.\u0275\u0275advance(3),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(12,5,"COMMANDS_REMOVE_SELECTED_TABLES")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(14,7,"WebDiagram_Delete_Objects")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(16,9,"Cancel_ButtonText")))},dependencies:[bt.X,ar,ft.F],styles:['.flat-button[_ngcontent-%COMP%]{border:2px solid transparent;cursor:pointer;padding:6px 18px;background-color:var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);min-width:100px;line-height:var(--lg-font-size, 16px)}.flat-button[_ngcontent-%COMP%]:focus{border:2px solid var(--fluent-theme-black-color, #000)}.flat-button[_ngcontent-%COMP%]:active, .flat-button[_ngcontent-%COMP%]:hover{background-color:var(--fluent-theme-neutral-light-color, #EDEBE9);border:2px solid var(--fluent-theme-black-color, #000)}.flat-button.primary[_ngcontent-%COMP%]{color:var(--button-primary-content-color);background-color:var(--button-primary-base-fill-color, #F2C811)}.flat-button.primary[_ngcontent-%COMP%]:active, .flat-button.primary[_ngcontent-%COMP%]:hover{background-color:var(--button-primary-hover-fill-color)}.flat-button.large[_ngcontent-%COMP%]{font-size:20px;padding-top:12px;padding-bottom:12px}html[data-focus-source=key] button.pbi-borderless-button[_ngcontent-%COMP%]:focus{border:none!important;outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.pbi-modern-button[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;height:32px;padding:0 16px;border:none;border-radius:var(--button-border-radius);color:var(--gray-180, #252423);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-modern-button[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-4px}.pbi-modern-button[_ngcontent-%COMP%]:disabled{background-color:var(--gray-20, #F3F2F1);color:var(--gray-90, #A19F9D)}.pbi-modern-button.save[_ngcontent-%COMP%]{border:none;background-color:var(--fluent-theme-primary-color, #F2C811);color:var(--button-primary-content-color, #252423);margin-right:8px}.pbi-modern-button.save[_ngcontent-%COMP%]:hover{background-color:var(--fluent-theme-dark-alt-color, #DAB50F)}.pbi-modern-button.save[_ngcontent-%COMP%]:active{background-color:var(--fluent-theme-dark-color, #A98C0C)}.pbi-modern-button.primaryBtn[_ngcontent-%COMP%]:not(:disabled){background-color:var(--button-primary-base-fill-color, #F2C811);color:var(--button-primary-content-color, #161514)}.pbi-modern-button.primaryBtn[_ngcontent-%COMP%]:not(:disabled):hover{background-color:var(--button-primary-hover-fill-color, #DAB50F)}.pbi-modern-button.primaryBtn[_ngcontent-%COMP%]:not(:disabled):active, .pbi-modern-button.primaryBtn[_ngcontent-%COMP%]:not(:disabled):active:hover{background-color:var(--button-primary-active-fill-color, #A98C0C)}.pbi-modern-button.secondaryBtn[_ngcontent-%COMP%]:not(:disabled){background-color:var(--fluent-theme-white-color, #FFF);border:1px solid var(--gray-110, #8A8886)}.pbi-modern-button.secondaryBtn[_ngcontent-%COMP%]:not(:disabled):hover{background-color:var(--gray-40, #E1DFDD);color:var(--gray-210, #161514)}.pbi-modern-button.secondaryBtn[_ngcontent-%COMP%]:not(:disabled):active, .pbi-modern-button.secondaryBtn[_ngcontent-%COMP%]:not(:disabled):active:hover{background-color:var(--gray-50, #D2D0CE);color:var(--gray-210, #161514)}.pbi-modern-button.cancel[_ngcontent-%COMP%]{border-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);background-color:var(--fluent-theme-white-color, #FFF)}.pbi-modern-button.cancel[_ngcontent-%COMP%]:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);border-color:var(--fluent-theme-neutral-quarter-color, #D2D0CE)}.pbi-modern-button.cancel[_ngcontent-%COMP%]:active{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);border-color:var(--fluent-theme-neutral-secondary-color, #605E5C)}.pbi-modern-button.compact[_ngcontent-%COMP%]{height:24px}.pbi-fluent-button[_ngcontent-%COMP%], .pbi-fluent-small-button[_ngcontent-%COMP%], .pbi-hero-button[_ngcontent-%COMP%]{--colorButtonBorder: var(--gray-110);--colorButtonForeground: var(--gray-180);--colorButtonBackground: var(--fluent-theme-white-color);--colorButtonDefaultHoverBackground: var(--button-default-hover-fill-color);--colorButtonDefaultActiveBackground: var(--button-default-active-fill-color);--colorButtonDisabledForeground: var(--button-disabled-content-color);--colorButtonDisabledBackground: var(--button-disabled-base-color);--colorButtonDisabledBorder: var(--button-disabled-base-color);--colorButtonPrimaryForeground: var(--button-primary-content-color);--colorButtonPrimaryBackground: var(--button-primary-base-fill-color);--colorButtonPrimaryBorder: var(--button-primary-base-fill-color);--colorButtonPrimaryHoverBackground: var(--button-primary-hover-fill-color);--colorButtonPrimaryHoverBorder: var(--button-primary-hover-fill-color);--colorButtonPrimaryActiveBackground: var(--button-primary-active-fill-color);--colorButtonPrimaryActiveBorder: var(--button-primary-active-fill-color);border-radius:var(--button-border-radius);border:1px solid var(--colorButtonBorder);color:var(--colorButtonForeground);background-color:var(--colorButtonBackground)}[data-legacy-theming=false][_ngcontent-%COMP%]   .pbi-fluent-button[_ngcontent-%COMP%], [data-legacy-theming=false][_ngcontent-%COMP%]   .pbi-fluent-small-button[_ngcontent-%COMP%], [data-legacy-theming=false][_ngcontent-%COMP%]   .pbi-hero-button[_ngcontent-%COMP%]{--colorButtonBorder: var(--colorNeutralStroke1);--colorButtonForeground: var(--colorNeutralForeground1);--colorButtonBackground: var(--colorNeutralBackground1);--colorButtonDefaultHoverBackground: var(--colorNeutralBackground1Hover);--colorButtonDefaultActiveBackground: var(--colorNeutralBackground1Pressed);--colorButtonDisabledForeground: var(--colorNeutralForegroundDisabled);--colorButtonDisabledBackground: var(--colorNeutralBackgroundDisabled);--colorButtonDisabledBorder: var(--colorNeutralStrokeDisabled);--colorButtonPrimaryForeground: var(--colorNeutralForegroundOnBrand);--colorButtonPrimaryBackground: var(--colorBrandBackground);--colorButtonPrimaryBorder: var(--colorBrandBackground);--colorButtonPrimaryHoverBackground: var(--colorBrandBackgroundHover);--colorButtonPrimaryHoverBorder: var(--colorBrandBackgroundHover);--colorButtonPrimaryActiveBackground: var(--colorBrandBackgroundPressed);--colorButtonPrimaryActiveBorder: var(--colorBrandBackgroundPressed)}.pbi-fluent-button[_ngcontent-%COMP%]:focus, .pbi-fluent-small-button[_ngcontent-%COMP%]:focus, .pbi-fluent-button[data-force-element-state=focus][_ngcontent-%COMP%], .pbi-fluent-small-button[data-force-element-state=focus][_ngcontent-%COMP%], .pbi-hero-button[_ngcontent-%COMP%]:focus, .pbi-hero-button[data-force-element-state=focus][_ngcontent-%COMP%]{outline:none}html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-fluent-button[_ngcontent-%COMP%]:focus, html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-fluent-small-button[_ngcontent-%COMP%]:focus, html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-fluent-button[data-force-element-state=focus][_ngcontent-%COMP%], html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-fluent-small-button[data-force-element-state=focus][_ngcontent-%COMP%], html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-hero-button[_ngcontent-%COMP%]:focus, html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-hero-button[data-force-element-state=focus][_ngcontent-%COMP%]{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-3px}.pbi-fluent-button[_ngcontent-%COMP%]:hover, .pbi-fluent-small-button[_ngcontent-%COMP%]:hover, .pbi-fluent-button[data-force-element-state=hover][_ngcontent-%COMP%], .pbi-fluent-small-button[data-force-element-state=hover][_ngcontent-%COMP%], .pbi-hero-button[_ngcontent-%COMP%]:hover, .pbi-hero-button[data-force-element-state=hover][_ngcontent-%COMP%]{background-color:var(--colorButtonDefaultHoverBackground)}.pbi-fluent-button[_ngcontent-%COMP%]:active, .pbi-fluent-small-button[_ngcontent-%COMP%]:active, .pbi-fluent-button[data-force-element-state=active][_ngcontent-%COMP%], .pbi-fluent-small-button[data-force-element-state=active][_ngcontent-%COMP%], .pbi-hero-button[_ngcontent-%COMP%]:active, .pbi-hero-button[data-force-element-state=active][_ngcontent-%COMP%]{background-color:var(--colorButtonDefaultActiveBackground)}.pbi-fluent-button[_ngcontent-%COMP%]:disabled, .pbi-fluent-small-button[_ngcontent-%COMP%]:disabled, .pbi-fluent-button[aria-disabled=true][_ngcontent-%COMP%], .pbi-fluent-small-button[aria-disabled=true][_ngcontent-%COMP%], .pbi-hero-button[_ngcontent-%COMP%]:disabled, .pbi-hero-button[aria-disabled=true][_ngcontent-%COMP%]{color:var(--colorButtonDisabledForeground);background-color:var(--colorButtonDisabledBackground);border-color:var(--colorButtonDisabledBorder)}.pbi-fluent-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%], .pbi-fluent-small-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%], .pbi-hero-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%]{color:var(--colorButtonPrimaryForeground);background-color:var(--colorButtonPrimaryBackground);border-color:var(--colorButtonPrimaryBorder)}.pbi-fluent-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%]:hover, .pbi-fluent-small-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%]:hover, .pbi-fluent-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[data-force-element-state=hover][_ngcontent-%COMP%], .pbi-fluent-small-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[data-force-element-state=hover][_ngcontent-%COMP%], .pbi-hero-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%]:hover, .pbi-hero-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[data-force-element-state=hover][_ngcontent-%COMP%]{background-color:var(--colorButtonPrimaryHoverBackground);border-color:var(--colorButtonPrimaryHoverBorder)}.pbi-fluent-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%]:active, .pbi-fluent-small-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%]:active, .pbi-fluent-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[data-force-element-state=active][_ngcontent-%COMP%], .pbi-fluent-small-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[data-force-element-state=active][_ngcontent-%COMP%], .pbi-hero-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[_ngcontent-%COMP%]:active, .pbi-hero-button.primary[_ngcontent-%COMP%]:not(:disabled, [aria-disabled=true])[data-force-element-state=active][_ngcontent-%COMP%]{background-color:var(--colorButtonPrimaryActiveBackground);border-color:var(--colorButtonPrimaryActiveBorder)}.pbi-fluent-small-button[_ngcontent-%COMP%]{height:28px;padding:4px 8px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.pbi-fluent-button[_ngcontent-%COMP%], .pbi-hero-button[_ngcontent-%COMP%]{height:32px;padding:6px 16px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}html[_ngcontent-%COMP%]:not([dir=rtl])   .pbi-hero-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{padding:8px 8px 8px 0}html[dir=rtl][_ngcontent-%COMP%]   .pbi-hero-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{padding:8px 0 8px 8px}.pbi-hero-button[_ngcontent-%COMP%]{display:flex;align-items:center;height:32px}.pbi-hero-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:16px;height:16px}.pbi-icon-button[_ngcontent-%COMP%]{--iconButtonForeground: var(--gray-140);--iconButtonBackgroundHover: var(--gray-20);--iconButtonBackgroundActive: var(--gray-30);--iconButtonForegroundDisabled: var(--gray-60);padding:0;background:none;border:1px solid transparent;color:var(--iconButtonForeground);height:32px;width:32px}[data-legacy-theming=false][_ngcontent-%COMP%]   .pbi-icon-button[_ngcontent-%COMP%]{--iconButtonForeground: var(--colorNeutralForeground2);--iconButtonBackgroundHover: var(--colorNeutralBackground1Hover);--iconButtonBackgroundActive: var(--colorNeutralBackground1Selected);--iconButtonForegroundDisabled: var(--colorNeutralForegroundDisabled)}.pbi-icon-button.pbi-with-text[_ngcontent-%COMP%]{display:flex;align-items:center;width:auto;padding-right:8px}.pbi-icon-button.pbi-with-text[_ngcontent-%COMP%]   pbi-office-icon[_ngcontent-%COMP%]{padding:0 8px}.pbi-icon-button[_ngcontent-%COMP%]:enabled:hover{background:var(--iconButtonBackgroundHover);border-color:transparent}.pbi-icon-button[_ngcontent-%COMP%]:enabled:active, .pbi-icon-button[_ngcontent-%COMP%]:enabled.active{background:var(--iconButtonBackgroundActive);border-color:transparent}.pbi-icon-button[_ngcontent-%COMP%]:disabled, .pbi-icon-button[aria-disabled=true][_ngcontent-%COMP%]{color:var(--iconButtonForegroundDisabled)}.pbi-icon-button[_ngcontent-%COMP%]:disabled:hover, .pbi-icon-button[aria-disabled=true][_ngcontent-%COMP%]:hover{color:var(--iconButtonForegroundDisabled)}html[data-focus-source=key][_ngcontent-%COMP%]   .pbi-icon-button[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.modern-dialogCloseIcon[_ngcontent-%COMP%]{background-color:var(--fluent-theme-white-color, #FFF);color:var(--fluent-theme-neutral-secondary-color, #605E5C);cursor:pointer;display:block;margin-left:auto;height:28px;width:28px}.modern-dialogCloseIcon[_ngcontent-%COMP%]:hover{background-color:#f4f4f4}.modern-dialogCloseIcon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:8px}.dragHandle[_ngcontent-%COMP%]{height:24px;left:0;position:absolute;top:0;width:100%;width:calc(100% - 28px)}.dialog-section[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.dialog-content[_ngcontent-%COMP%]{padding-left:28px;padding-right:28px}.dialog-header[_ngcontent-%COMP%]{font-weight:600;font-size:20px;line-height:28px;padding-bottom:16px}.dialog-body[_ngcontent-%COMP%]{font-size:14px;height:51px}.dialog-body[_ngcontent-%COMP%]   .dialog-description[_ngcontent-%COMP%]{margin:0}.dialog-footer[_ngcontent-%COMP%]{display:flex;padding-bottom:14px;padding-left:28px;padding-right:28px}.dialog-footer[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{font-size:14px;align-self:center}.dialog-footer[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%]{margin:0 0 0 auto}.dialog-footer[_ngcontent-%COMP%]   .primary[_ngcontent-%COMP%]{margin-left:12px}.pbi-fluent-button[_ngcontent-%COMP%], .pbi-hero-button[_ngcontent-%COMP%]{margin-left:8px}  .pbi-dialog{border:none}']}),i}(),No=p(37150),dr=function(){function i(){}return i.unsupportedMembersErrorCode="CloudRLSNotSupportedMembers",i.notProLicenseErrorCode="ProLicenseRequiredForCloudRls",i}(),Ku=function(){return function(){this.inputUserList=[],this.validEmailsList=[],this.validObjectIds=[],this.hasValidationError=!1,this.isDirty=!1}}();function Vo(i){i.modelAddedMembers={},i.modelRemovedMembers={}}function wn(i){return i.userPrincipalName?i.userPrincipalName.toLowerCase():i.objectId}function Yu(i){return _.values(i.modelAddedMembers)}function Zu(i){return _.values(i.modelRemovedMembers)}function Uo(i,t){i.modelUsers=function(i){return _.zipObject(i.map(function(t){return wn(t)}),i)}(t),mi(i)}function zo(i){var t,n=i.modelUsers,r=(null===(t=i.contract)||void 0===t?void 0:t.members)||[];if(n&&Object.keys(n).length!==r.length)return!0;for(var o=0,a=r;o<a.length;o++)if(!i.modelUsers[wn(a[o])])return!0;return!1}function tp(i,t){var n=t.toLowerCase();return i.modelUsers[n]||null}function np(i,t){var n=wn(t);delete i.modelUsers[n],delete i.modelAddedMembers[n],mi(i)}function ip(i,t){var n=wn(t);i.modelUsers[n]||(i.modelRemovedMembers[n]?delete i.modelRemovedMembers[n]:i.modelAddedMembers[n]=t,i.modelUsers[n]=t,mi(i))}function mi(i){i.userList=_.values(i.modelUsers)}function jo(i){var t=[];return i.roleMembershipsInformation&&(t=_.chain(i.roleMembershipsInformation).map(function(n){return function(i){var t={userList:void 0,modelUsers:void 0,modelAddedMembers:{},modelRemovedMembers:{},id:i.id,contract:i,displayName:i.name,emailsList:new Ku,emailsListValid:!1,emailsListErrorMessage:""};return Uo(t,i.members||[]),t}(n)}).sortBy(function(n){return n.displayName.toLowerCase()}).value()),t}var Wo="PBI.RowLevelSecurity.LoadRoles",Ho=Se.cx[Wo]=(0,Se.b1)(Wo),Go="PBI.RowLevelSecurity.AddNewRole",Ko=(Se.cx[Go]=(0,Se.b1)(Go),"PBI.RowLevelSecurity.DeleteRole"),$o=(Se.cx[Ko]=(0,Se.b1)(Ko),"PBI.RowLevelSecurity.UpdateRole"),op=Se.cx[$o]=(0,Se.b1)($o),ap=p(14463),lp=p(69872),sp=p(81213),cp=p(73875),dp=function(){function i(t){this.httpService=t}return i.prototype.getModelRoles=function(t,n){var r=this.httpService.powerbiRequestOptions(n,"GetModelRoleMembership");return this.httpService.get("metadata/model/"+t+"/rlsmembership/",r)},i.prototype.updateMembershipForRoles=function(t,n,r){var o=this.httpService.powerbiRequestOptions(r,"UpdateRoleMembership");return this.httpService.post("metadata/model/"+t+"/rlsmembership/",n,o)},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(cp.O))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(),Qo=function(i){return i[i.Filters=0]="Filters",i[i.Members=1]="Members",i[i.Unknown=2]="Unknown",i}({}),ur=function(){function i(t,n,r,o,a,l,s){this.errorService=t,this.localizationService=n,this.promiseFactory=r,this.rowLevelSecurityHttpService=o,this.telemetryService=a,this.dialogService=l,this.featureSwitchService=s,this.forceRoleRefresh=!1,this._roleMembersChanged=new lp.BehaviorSubject(void 0)}return i.prototype.onModelUpdated=function(t){this.model&&this.model.id===t&&(this.forceRoleRefresh=!0)},Object.defineProperty(i.prototype,"roleMembersChanged",{get:function(){return this._roleMembersChanged.asObservable()},enumerable:!1,configurable:!0}),i.prototype.updateRoleMemberChange=function(t){this._roleMembersChanged.next(t)},Object.defineProperty(i.prototype,"rolesPromise",{get:function(){return this.rolesDeferred.promise},enumerable:!1,configurable:!0}),i.prototype.findRole=function(t){return _.find(this.roles,function(n){return n.id===t})},i.prototype.loadRolesById=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,d.__generator)(this,function(o){return this.forceRoleRefresh=!1,this.rolesDeferred=this.promiseFactory.defer(),this.model=void 0,n=this.telemetryService.startEvent(Ho,{modelId:t,roleCount:0}),this.rowLevelSecurityHttpService.getModelRoles(t).toPromise().then(function(a){r.roles=jo(a.data),r.rolesDeferred.resolve(r.roles),n.event.info.roleCount=r.roles.length,n.resolve()},function(a){var l=a.error;l&&l.code===dr.notProLicenseErrorCode?n.resolve():(r.errorService.error(r.localizationService.get("RowLevelSecurity_FailedToLoadRoles"),"RowLevelSecurity_FailedToLoadRoles",{requestId:a.requestId,statusCode:a.status.toString()}),n.reject()),r.rolesDeferred.reject(),r.forceRoleRefresh=!0}),[2]})})},i.prototype.loadRoles=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,d.__generator)(this,function(o){return!this.forceRoleRefresh&&this.model===t&&t.cloudRlsEnabled?[2]:(this.forceRoleRefresh=!1,this.rolesDeferred=this.promiseFactory.defer(),this.model=t,t.cloudRlsEnabled?(n=this.telemetryService.startEvent(Ho,{modelId:this.model.id,roleCount:0}),this.rowLevelSecurityHttpService.getModelRoles(this.model.id).toPromise().then(function(a){r.roles=jo(a.data),r.rolesDeferred.resolve(r.roles),n.event.info.roleCount=r.roles.length,n.resolve()},function(a){var l=a.error;l&&l.code===dr.notProLicenseErrorCode?n.resolve():(r.errorService.error(r.localizationService.get("RowLevelSecurity_FailedToLoadRoles"),"RowLevelSecurity_FailedToLoadRoles",{requestId:a.requestId,statusCode:a.status.toString()}),n.reject()),r.rolesDeferred.reject(),r.forceRoleRefresh=!0}),[2]):(this.roles=[],this.rolesDeferred.resolve([]),[2]))})})},i.prototype.showReportRequiredDialog=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t;return(0,d.__generator)(this,function(n){return t=this.localizationService.get(this.featureSwitchService.featureSwitches.rlsExternalReportImpersonationEnabled?"RowLevelSecurity_TestRole_NoReportsContentOtherWorkspace":"RowLevelSecurity_TestRole_NoReportsContent"),this.dialogService.promptSimpleDialog(this.localizationService.get("RowLevelSecurity_TestRole_NoReportsTitle"),t,void 0,void 0,this.localizationService.get("ModalDialogButtonText_GotIt")),[2]})})},i.prototype.showUnsavedChangesDialog=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,this.dialogService.openHostDialog({dialogName:"UnsavedChangesHandlingDialog",componentName:"UnsavedChangesHandlingDialogComponent",config:{width:"750px"}})];case 1:return[2,r.sent().afterClosed().toPromise()]}})})},i.prototype.showSaveDialogIfDirty=function(t,n,r){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(a){switch(a.label){case 0:return t&&function(i){return zo(i)}(t)?[4,this.showUnsavedChangesDialog()]:[3,2];case 1:switch(a.sent().unsavedChangesHandlingType){case 0:r&&r.resolve(!1);break;case 1:this.updateRole(t),n(),r&&r.resolve(!0);break;case 2:(function(i){var t=i.contract;i.displayName=t.name,Uo(i,t.members||[]),Vo(i)})(t),n(),r&&r.resolve(!0);break;default:return I.fF.assertFail("unsupported response from dialog!"),[2]}return[3,3];case 2:r&&r.resolve(!0),n(),a.label=3;case 3:return[2]}})})},i.prototype.updateRole=function(t,n){var o,a,r=this,l=this.promiseFactory.defer();if(n||(n=this.model.id),3===(null===(o=this.model)||void 0===o?void 0:o.lastRefreshStatus)||1===(null===(a=this.model)||void 0===a?void 0:a.packagePublishStatus))l.reject(),this.showRefreshInProgressDialog();else{var s=_.countBy(function(i){return i.userList}(t),function(f){return f.groupType?"group":"individual"}),c=this.telemetryService.startEvent(op,{individualCount:s.individual,groupCount:s.group,ruleCount:0,membersChanged:zo(t),rulesChanged:!1,modelId:n}),u={roleMemberships:[{id:t.id,name:t.contract.name,addedMembers:_.values(Yu(t)),removedMembers:_.values(Zu(t))}]};this.rowLevelSecurityHttpService.updateMembershipForRoles(n,u,c.event).toPromise().then(function(){(function(i){i.contract.name=i.displayName,i.contract.members=i.userList.slice(0),Vo(i)})(t),c.resolve(),l.resolve({})},function(f){var v=f.error;v&&v.code===dr.unsupportedMembersErrorCode?(r.handleUnsupportedMembersError(v["pbi.error"].parameters),c.event.info.userError="CloudRLSNotSupportedMembers",c.resolve(),l.reject(Qo.Members)):(r.errorService.error(r.localizationService.get("RowLevelSecurity_FailedToUpdateRole"),"RowLevelSecurity_FailedToUpdateRole",{requestId:f.requestId,statusCode:f.status.toString()}),c.reject(),l.reject(Qo.Unknown))})}return l.promise},i.prototype.showRefreshInProgressDialog=function(){this.dialogService.showSimpleDialog(this.localizationService.get("ModalDialog_CloudRlsDataRefreshTitle"),this.localizationService.get("ModalDialog_CloudRlsDataRefreshMessage"),void 0,void 0,this.localizationService.get("PBI_Button_Label_Close"))},i.prototype.handleUnsupportedMembersError=function(t){for(var n in t)if(t[n]){var r=this.findRole(parseInt(n,10));r.emailsListValid=!1,r.emailsListErrorMessage=this.localizationService.format("RowLevelSecurity_Members_CloudRLSNotSupportedMembers",[t[n]]);for(var a=0,l=t[n].split(", ");a<l.length;a++){var c=tp(r,l[a]);c&&(r.emailsList.inputUserList.push(c),np(r,c))}}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(sp.T),e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(ap.t),e.\u0275\u0275inject(dp),e.\u0275\u0275inject(Mt.y0),e.\u0275\u0275inject(Sn.x),e.\u0275\u0275inject(Ot.vZ))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(),up=p(65966),fi="PBISetRolePermissions",Xo=Se.cx[fi]=(0,Se.b1)(fi),pp=(Se.cx[fi]=(0,Se.b1)(fi),p(41961)),gp=[[["","dock","top"]],[["","dock","left"]],[["","dock","center"]],[["","dock","right"]],[["","dock","bottom"]]],hp=["[dock=top]","[dock=left]","[dock=center]","[dock=right]","[dock=bottom]"],pr=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["docking-container"]],ngContentSelectors:hp,decls:7,vars:0,consts:[[1,"dockVContainer","dockFill"],["dock","center",1,"dockHContainer","dockFill"]],template:function(n,r){1&n&&(e.\u0275\u0275projectionDef(gp),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275projection(1),e.\u0275\u0275elementStart(2,"div",1),e.\u0275\u0275projection(3,1),e.\u0275\u0275projection(4,2),e.\u0275\u0275projection(5,3),e.\u0275\u0275elementEnd(),e.\u0275\u0275projection(6,4),e.\u0275\u0275elementEnd())},styles:["[_nghost-%COMP%],   .dockFill{width:100%;height:100%}  .dockVContainer{display:flex;flex-direction:column}  .dockVContainer [dock=top]{order:1;flex:initial}  .dockVContainer [dock=center]{order:2;flex-grow:1000;flex-shrink:1000;flex:auto;min-height:50px}  .dockVContainer [dock=bottom]{order:3;flex:initial}  .dockHContainer{display:flex;flex-direction:row}  .dockHContainer [dock=left]{order:1;flex:initial}  .dockHContainer [dock=center]{order:2;flex:auto;flex-grow:1000;flex-shrink:1000;min-width:50px}  .dockHContainer [dock=right]{order:3;flex:initial}"]}),i}(),Yo=["*"],mp=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["pbi-pivot"]],ngContentSelectors:Yo,decls:2,vars:0,consts:[["role","tablist",1,"pbi-pivot","themeableElement"]],template:function(n,r){1&n&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275projection(1),e.\u0275\u0275elementEnd())},styles:['[_nghost-%COMP%]{display:flex}[_nghost-%COMP%]   .pbi-pivot[_ngcontent-%COMP%]{display:flex;width:100%}[_nghost-%COMP%]     pbi-pivot-item button{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]     .pbi-pivot-item-selected button{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}[_nghost-%COMP%]     .pbi-pivot-item-selected button .inner-button:after{bottom:-12px}.pbi-pivot-small[_nghost-%COMP%]     pbi-pivot-item button{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.pbi-pivot-small[_nghost-%COMP%]     .pbi-pivot-item-selected button{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600)}.pbi-pivot-small[_nghost-%COMP%]     .pbi-pivot-item-selected button .inner-button:after{bottom:-12px}.pbi-pivot-large[_nghost-%COMP%]     pbi-pivot-item button{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}.pbi-pivot-large[_nghost-%COMP%]     .pbi-pivot-item-selected button{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-semi-bold, 600)}.pbi-pivot-large[_nghost-%COMP%]     .pbi-pivot-item-selected button .inner-button:after{bottom:-11px}']}),i}(),fp=function(){function i(){this.disabled=!1,this.select=new e.EventEmitter}return i.prototype.onPivotClick=function(){this.disabled||this.select.emit()},i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["pbi-pivot-item"]],hostVars:2,hostBindings:function(n,r){2&n&&e.\u0275\u0275classProp("pbi-pivot-item-selected",r.selected)},inputs:{selected:"selected",disabled:"disabled"},outputs:{select:"select"},ngContentSelectors:Yo,decls:3,vars:4,consts:[["role","tab","data-testid","pivot-item-list-btn",1,"pbi-focus-outline-inset",3,"click"],[1,"inner-button"]],template:function(n,r){1&n&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(){return r.onPivotClick()}),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275projection(2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275classProp("disabled",r.disabled),e.\u0275\u0275attribute("aria-disabled",r.disabled)("aria-selected",r.selected))},styles:['[_nghost-%COMP%]{--colorFieldDisabled: var(--gray-90);--colorBackgroundDisabled: var(--gray-20);--colorBackgroundHover: auto;--colorBackgroundSelected: var(--fluent-theme-primary-color);--colorForeground: auto;display:inline-flex}[data-legacy-theming=false]   [_nghost-%COMP%]{--colorFieldDisabled: var(--colorNeutralBackgroundDisabled);--colorBackgroundDisabled: auto;--colorBackgroundHover: var(--colorNeutralSubtleBackgroundHover);--colorBackgroundSelected: var(--colorNeutralForeground3BrandSelected);--colorForeground: var(--colorNeutralForeground1)}button[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative;border:none;height:44px;padding:11px 8px;color:var(--colorForeground)}button[_ngcontent-%COMP%]:not(:hover){background:none}button[_ngcontent-%COMP%]:hover{background-color:var(--colorBackgroundHover)}button[_ngcontent-%COMP%]:hover   .inner-button[_ngcontent-%COMP%]{position:initial}button[_ngcontent-%COMP%]:hover   .inner-button[_ngcontent-%COMP%]:after{bottom:0;left:0;right:0}button[_ngcontent-%COMP%]:focus   .inner-button[_ngcontent-%COMP%]{position:initial}button[_ngcontent-%COMP%]:focus   .inner-button[_ngcontent-%COMP%]:after{bottom:0;left:0;right:0}button.disabled[_ngcontent-%COMP%]{forced-color-adjust:none;color:var(--colorFieldDisabled, #A19F9D);background-color:var(--colorBackgroundDisabled, #F3F2F1)}button[_ngcontent-%COMP%]   .inner-button[_ngcontent-%COMP%]{display:flex;align-items:center;margin:0 10px;position:relative}.pbi-pivot-item-selected[_nghost-%COMP%]   .inner-button[_ngcontent-%COMP%]:after{content:"";position:absolute;display:block;left:0;right:0;height:4px;background:var(--colorBackgroundSelected, #F2C811)}@media (forced-colors: active){.pbi-pivot-item-selected[_nghost-%COMP%]   .inner-button[_ngcontent-%COMP%]:after{background-color:var(--globalColorhcHighlight)!important}}']}),i}(),vp=p(18405),_p=function(){function i(){this.datasetIdChanged=new Gt.X(void 0)}return Object.defineProperty(i.prototype,"host",{get:function(){return this._host},set:function(n){this._host=n},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"datasetId",{get:function(){return this._datasetId},set:function(n){this._datasetId=n,this.datasetIdChanged.next(n)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"modelingSessionId",{get:function(){return this._modelingSessionId},set:function(n){this._modelingSessionId=n},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"datasetIdChanged$",{get:function(){return this.datasetIdChanged.asObservable()},enumerable:!1,configurable:!0}),i.prototype.cleanSettings=function(){this.host=void 0,this.datasetId=void 0,this.modelingSessionId=void 0},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(n){return new(n||i)},providedIn:"root"}),i}(),bp=p(85732),yp=p(98187),zt=function(i){return i[i.ExternalSharingDisabled=0]="ExternalSharingDisabled",i[i.EmailDomainNotInTenant=1]="EmailDomainNotInTenant",i[i.BlockedDomains=2]="BlockedDomains",i[i.MaxOneTimeEmailCountReached=3]="MaxOneTimeEmailCountReached",i[i.InvalidUser=4]="InvalidUser",i[i.ExternalOrganization=5]="ExternalOrganization",i[i.InvalidUsersInExistingLink=6]="InvalidUsersInExistingLink",i}({}),Cp=function(){function i(t,n,r){this.domainHelperService=t,this.featureSwitchService=n,this.localizationService=r}return i.prototype.validateEmailTags=function(t,n){var r=this;return(0,yn.D)(this.domainHelperService.getVerifiedDomains()).pipe((0,Me.U)(function(o){var a=[];n.maxNumberOfEmailsAllowedAtATime&&t.length>n.maxNumberOfEmailsAllowedAtATime&&a.push({errorType:zt.MaxOneTimeEmailCountReached,errorDetails:n.maxNumberOfEmailsAllowedAtATime.toString()});for(var l=0,s=0,c=[],u=[],f=0,v=t;f<v.length;f++){var C=v[f];if(C.userPrincipalName){var z=C.userPrincipalName.split("@")[1].toLowerCase();o.verifiedDomains[z.toUpperCase()]||(c.push(z),l++),o.blockedDomains[z.toUpperCase()]&&(u.push(z),s++)}}var ce=c.length,le=u.length;return!r.featureSwitchService.featureSwitches.externalSharingEnabled&&ce>0?a.push({errorType:zt.ExternalSharingDisabled}):n.shouldBlockExternalDomains&&ce>0?a.push({errorType:zt.EmailDomainNotInTenant}):n.shouldBlockConsumerDomains&&le>0?a.push({errorType:zt.BlockedDomains,errorDetails:u.join(r.localizationService.get("ListJoin_Separator"))}):ce>0&&a.push({errorType:zt.ExternalOrganization}),{externalEmailCount:l,consumerEmailCount:s,validationErrors:a}}))},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(yp.z),e.\u0275\u0275inject(Ot.vZ),e.\u0275\u0275inject(Be.o))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(),Mp=p(37272),wp=p(93864),xp=p(44641);function Pp(i,t){if(1&i&&e.\u0275\u0275element(0,"message-banner",11),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("viewModel",r.getMessageBannerViewModel(n))}}function Op(i,t){1&i&&e.\u0275\u0275element(0,"pbi-spinner")}function Ep(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"editable-list-item",12),e.\u0275\u0275listener("remove",function(){var l=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.removeMember(l))}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()}if(2&i){var r=t.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.displayName)}}function Dp(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",1),e.\u0275\u0275element(1,"span",2),e.\u0275\u0275elementStart(2,"div",3)(3,"emails-list-modern",4,5),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.viewModel.emailsList.inputUserList=a)}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,Pp,1,1,"message-banner",6),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275elementStart(8,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.addMembers())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,Op,1,0,"pbi-spinner",8),e.\u0275\u0275elementStart(10,"div",9),e.\u0275\u0275template(11,Ep,3,1,"editable-list-item",10),e.\u0275\u0275pipe(12,"orderBy"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.viewModel.emailsList.inputUserList)("formControl",r.emailsListControl)("inputPlaceholder",e.\u0275\u0275pipeBind1(5,16,"EmailsListPlaceholder"))("allowSecurityGroups",!0)("allowObjectIds",!0)("includeGuests",!0)("allowDistributionLists",!0)("addUserOnBlur",!0)("actions",r.emailsListActions$)("checkValidOrgUser",!0)("showRelevantUsers",!1),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(7,18,r.uniqueErrors$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",r.isAddButtonDisabled()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.validatingTags),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind2(12,20,null==r.viewModel?null:r.viewModel.userList,r.sortingFields))("ngForTrackBy",r.trackByFn)}}var Tp=function(){function i(t,n,r){var o=this;this.localizationService=t,this.emailValidationHelper=n,this.rowLevelSecurity=r,this.emailsListControl=new ye.p4(null,null,this.userValidator()),this.warnings$=new Gt.X([]),this.destroy$=new pn.xQ,this.emailsListActions$=new Gt.X(null),this.uniqueErrors$=(0,Et.aj)([this.warnings$,this.emailsListControl.statusChanges.pipe((0,ui.O)([]))]).pipe((0,qe.R)(this.destroy$),(0,Me.U)(function(a){var l,s,u=_.concat(null!==(s=null===(l=o.emailsListControl.errors)||void 0===l?void 0:l.error)&&void 0!==s?s:[],a[0]??[]);return _.sortBy(_.uniqBy(u,function(f){return f.errorType}),function(f){return f.errorType})})),this.sortingFields=[function(a){return a&&a.displayName?a.displayName.toLocaleLowerCase():null}]}return i.prototype.ngOnInit=function(){var t=this;this.emailsListControl.valueChanges.pipe((0,qe.R)(this.destroy$)).subscribe(function(n){t.viewModel.emailsList.inputUserList=n})},i.prototype.ngOnChanges=function(t){var n,r;if(null!==(r=null===(n=t.viewModel)||void 0===n?void 0:n.currentValue.emailsList)&&void 0!==r&&r.inputUserList){var o=t.viewModel.currentValue.emailsList.inputUserList;this.emailsListActions$.next(0),this.viewModel.emailsList.inputUserList=o}},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete(),this.emailsListActions$.complete()},i.prototype.isAddButtonDisabled=function(){return _.isEmpty(this.emailsListControl.value)||!this.validateEmails()},i.prototype.addMembers=function(){for(var t=0,n=this.emailsListControl.value;t<n.length;t++)ip(this.viewModel,n[t]);this.viewModel.emailsList.inputUserList=[],this.rowLevelSecurity.updateRoleMemberChange(this.viewModel)},i.prototype.removeMember=function(t){(function(i,t){var n=wn(t);i.modelAddedMembers[n]?delete i.modelAddedMembers[n]:i.modelRemovedMembers[n]=t,delete i.modelUsers[n],mi(i)})(this.viewModel,t),this.rowLevelSecurity.updateRoleMemberChange(this.viewModel)},i.prototype.validateEmails=function(){var t;return _.isNil(null===(t=this.emailsListControl)||void 0===t?void 0:t.errors)},i.prototype.userValidator=function(){var t=this;return function(n){return n.value?t.emailValidationHelper.validateEmailTags(n.value,{shouldBlockConsumerDomains:!1,shouldBlockExternalDomains:!0,maxNumberOfEmailsAllowedAtATime:100}).pipe((0,Me.U)(function(r){var o=_.remove(r.validationErrors,function(a){return a.errorType===zt.ExternalOrganization});return t.warnings$.next(o),r.validationErrors.length>0?{error:r.validationErrors}:null})):Mp.E}},i.prototype.getMessageBannerViewModel=function(t){switch(t.errorType){case zt.ExternalOrganization:return{bannerType:2,iconName:"pbi-glyph-warning",message:this.localizationService.get("Sharing_ExternalOrganizationNew")};case zt.ExternalSharingDisabled:return{bannerType:1,iconName:"pbi-glyph-error-circle-exclamation",message:this.localizationService.get("Sharing_ExternalSharingDisabled")};case zt.EmailDomainNotInTenant:return{bannerType:1,iconName:"pbi-glyph-error-circle-exclamation",message:this.localizationService.get("EmailsList_EmailDomainNotInTenant")};case zt.InvalidUser:return{bannerType:1,iconName:"pbi-glyph-error-circle-exclamation",message:this.localizationService.get("Sharing_InvalidEmail")};default:return{bannerType:1,iconName:"pbi-glyph-error-circle-exclamation",message:this.localizationService.get("ClientError_UnknownClientErrorValue")}}},i.prototype.trackByFn=function(t,n){return n.userPrincipalName||n.objectId},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(Cp),e.\u0275\u0275directiveInject(ur))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-members"]],inputs:{viewModel:"viewModel"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","rlsMembers",4,"ngIf"],[1,"rlsMembers"],["localize","RowLevelSecurity_Members_Description",1,"input-field-label"],[1,"emailsList"],[3,"ngModel","formControl","inputPlaceholder","allowSecurityGroups","allowObjectIds","includeGuests","allowDistributionLists","addUserOnBlur","actions","checkValidOrgUser","showRelevantUsers","ngModelChange"],["emailsList",""],[3,"viewModel",4,"ngFor","ngForOf"],["tri-button","","appearance","primary","type","button","size","small","localize","RowLevelSecurity_Members_Add","data-testid","rls-add-btn",1,"membersButton","pbi-fluent-button","primary",3,"disabled","click"],[4,"ngIf"],["data-testid","current-user-list",1,"editableList"],["data-testid","current-user-list-item",3,"remove",4,"ngFor","ngForOf","ngForTrackBy"],[3,"viewModel"],["data-testid","current-user-list-item",3,"remove"]],template:function(n,r){1&n&&e.\u0275\u0275template(0,Dp,13,23,"div",0),2&n&&e.\u0275\u0275property("ngIf",null==r.viewModel?null:r.viewModel.emailsList)},dependencies:[ie.NgForOf,ie.NgIf,bt.X,wp.t,ye.JJ,ye.oH,mn,qn.k,xp.A,dn,ie.AsyncPipe,ft.F],styles:["[_nghost-%COMP%]{height:100%;overflow:auto}.rlsMembers[_ngcontent-%COMP%]{height:100%;min-height:375px}.rlsMembers[_ngcontent-%COMP%]   .emailsList[_ngcontent-%COMP%]{padding-top:5px}.rlsMembers[_ngcontent-%COMP%]   .memberInput[_ngcontent-%COMP%]{width:400px;margin-right:15px}.rlsMembers[_ngcontent-%COMP%]   .membersButton[_ngcontent-%COMP%]{margin:12px 12px 20px;height:36px;padding:8px 20px;border-radius:0}.rlsMembers[_ngcontent-%COMP%]   .editableList[_ngcontent-%COMP%]{margin-bottom:12px}.rlsMembers[_ngcontent-%COMP%]   .editableList[_ngcontent-%COMP%]   editable-list-item[_ngcontent-%COMP%]{padding:4px 0 4px 12px}"]}),i}(),xn=function(){function i(t,n,r){this.zone=t,this.changeDetector=n,this.defaultState=r,this.initialized=!1,this.afterStateChanged=new e.EventEmitter,this.subscriptions=new F.w,this.stateSubject$=new Gt.X(r),this.state$=this.stateSubject$.asObservable()}return i.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},i.prototype.getDefaultState=function(){return(0,d.__assign)({},this.defaultState)},i.prototype.getCurrentState=function(){return this.stateSubject$.getValue()},i.prototype.modifyState=function(t){var n=this;this.zone.runOutsideAngular(function(){return(0,d.__awaiter)(n,void 0,void 0,function(){var r;return(0,d.__generator)(this,function(o){return r=(0,d.__assign)({},this.getCurrentState()),this.updateState(t(r),!0),[2]})})})},i.prototype.initialize=function(){var t=this;this.initialized=!0,this.zone.run(function(){t.changeDetector.detectChanges(),t.zone.runOutsideAngular(function(){t.afterStateChanged.emit({previousState:null,newState:t.getCurrentState()})})})},i.prototype.updateState=function(t,n){var r=this;void 0===n&&(n=!1);var o=this.stateSubject$.getValue(),a=(0,d.__assign)((0,d.__assign)({},o),t);(n||!_.isEqual(a,o))&&this.zone.run(function(){r.stateSubject$.next(a),r.initialized&&r.changeDetector.detectChanges(),r.zone.runOutsideAngular(function(){r.afterStateChanged.emit({previousState:o,newState:a})})})},i.\u0275fac=function(n){e.\u0275\u0275invalidFactory()},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),gr=function(i){function t(n,r,o){var a=i.call(this,o,r,{roles:[]})||this;return a.rlsService=n,a.roles=[],a._editingRoleName=void 0,a.refreshState(),a}return(0,d.__extends)(t,i),t.prototype.setEditingRole=function(n){this._editingRoleName=n,this.refreshState()},t.prototype.load=function(n){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(r){switch(r.label){case 0:return this.subscribeToServices(),this._canEdit=n,[4,this.refreshState()];case 1:return r.sent(),[2]}})})},t.prototype.updateFromModel=function(){var n=this;this.roles=this.rlsService.getRoles(),this.roles.find(function(r){return r.name===n._editingRoleName})||(this._editingRoleName=void 0)},t.prototype.subscribeToServices=function(){var n=this;this.subscriptions.add(this.rlsService.onChange.subscribe(function(){n.refreshState()}))},t.prototype.refreshState=function(n){return void 0===n&&(n=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.zone.runOutsideAngular(function(){return(0,d.__awaiter)(r,void 0,void 0,function(){var a,l,s=this;return(0,d.__generator)(this,function(c){return a=this.getDefaultState(),this.updateFromModel(),l=this.rlsService.getEditorState(),a.roles=this.roles.map(function(u){return{name:u.name,isEditing:s._editingRoleName===u.name,isSelected:l.selectedRole===u.name,showWarning:!!u.roleTables.find(function(f){var v;return(null===(v=f.filtersGroup)||void 0===v?void 0:v.hasErrors)||""!==f.errorMessage}),canEdit:s._canEdit}}),this.updateState(a,n),[2]})})})];case 1:return o.sent(),[2]}})})},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(ot),e.\u0275\u0275inject(e.ChangeDetectorRef),e.\u0275\u0275inject(e.NgZone))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(xn),Ip=p(93247);function vi(i,t,n){var r=n.activeElement;if(r&&r.classList.contains(t)){var o=i(r);o&&o.classList.contains(t)&&o.focus()}}var Zo=p(80357),Rp=p(24150),_i=p(55334),Ap=["listItem"];function Fp(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",10),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.rename=a)}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngModel",r.rename)}}function kp(i,t){1&i&&(e.\u0275\u0275element(0,"span",11),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"localize")),2&i&&(e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(2,4,"Error")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,2,"Error")))}function Bp(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",12),e.\u0275\u0275listener("pbiMenuButtonClick",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onRolesMenuItemClicked(a))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",r.disableUI)("pbiMenu",r.rolesMenu)("pbiTooltip",e.\u0275\u0275pipeBind1(1,3,"Options_Menu"))}}var Lp=function(t,n){return{selected:t,disabled:n}},Np=function(){function i(t,n,r,o,a){var l=this;this.dialogService=t,this.localizationService=n,this.rlsService=r,this.stateService=o,this.document=a,this.roleListItemClassName="rls-list-item",this.disableUI=!1,this.editableLabelOptions={disableClick:!0,customTooltip:!0,inputMatchLabelWidth:!0,onEdit:function(){return l.startEdit()},onBlur:function(){return l.commitEdit()},onEscape:function(){l.listItem.nativeElement.focus()}},this.getNextElement=function(s){var c=s.parentElement.nextElementSibling;return c&&c.firstElementChild},this.getPrevElement=function(s){var c=s.parentElement.previousElementSibling;return c&&c.firstElementChild}}return Object.defineProperty(i.prototype,"rolesMenu",{get:function(){return!this.disableUI&&this.role.canEdit?{items:[{id:1,type:wt.iB.Button,text:this.localizationService.get("ItemAction_Rename")},{id:2,type:wt.iB.Button,text:this.localizationService.get("ModalDialog_Duplicate")},{id:3,type:wt.iB.Button,text:this.localizationService.get("Delete")}]}:{items:[]}},enumerable:!1,configurable:!0}),i.prototype.selectRole=function(){this.disableUI||this.rlsService.selectRole(this.role.name)},i.prototype.startEdit=function(){this.disableUI||!this.role.canEdit||(this.isRename=!0,this.rename=this.role.name,this.selectRole(),this.stateService.setEditingRole(this.role.name))},i.prototype.commitEdit=function(){var t,n,r=null!==(n=null===(t=this.rename)||void 0===t?void 0:t.trim())&&void 0!==n?n:"";this.stateService.setEditingRole(void 0),r&&r!==this.role.name&&(this.rlsService.renameRole(this.role.name,r)||this.showRenameConfirmationDialog(r)),this.isRename=!1},i.prototype.onRolesMenuItemClicked=function(t){1===t.id?this.startEdit():2===t.id?this.rlsService.duplicateRole(this.role.name):3===t.id&&this.rlsService.deleteRole(this.role.name)},i.prototype.handleKeydown=function(t){switch(t.key){case"Enter":return this.selectRole();case" ":this.role.isEditing||(t.preventDefault(),this.selectRole());break;case"F2":if(t.preventDefault(),t.stopPropagation(),!(0,Ip.Vb)(t)&&!this.disableUI)return this.startEdit();break;case"ArrowUp":return t.preventDefault(),void vi(this.getPrevElement,this.roleListItemClassName,this.document);case"ArrowDown":return t.preventDefault(),void vi(this.getNextElement,this.roleListItemClassName,this.document);case"Tab":t.shiftKey&&(t.preventDefault(),t.stopPropagation(),(this.document.querySelector(".create-role-button")||this.document.querySelector("#createPaneTab > button")||this.document.querySelector("#closeButton")).focus());default:return}},i.prototype.showRenameConfirmationDialog=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return[4,gn.Z.buildCancelDialog(this.localizationService.get("RLS_Editor_Rename_Error_Title"),this.localizationService.format("RLS_Editor_Rename_Error_Message",t),"Rename Role Error",this.dialogService,this.localizationService,this.localizationService.get("OK_ButtonText"))];case 1:return n.sent(),[2]}})})},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Sn.x),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(gr),e.\u0275\u0275directiveInject(ie.DOCUMENT))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-role"]],viewQuery:function(n,r){var o;(1&n&&e.\u0275\u0275viewQuery(Ap,5),2&n)&&(e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.listItem=o.first))},inputs:{role:"role",index:"index",rolesLength:"rolesLength",disableUI:"disableUI"},decls:12,vars:24,consts:[["role","tab","pbiTooltipShowDelay","1000","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small","pbiMenuActivation","contextmenu",1,"pbi-focus-outline",3,"tabindex","ngClass","aria-label","pbiTooltip","pbiMenu","mousedown","dblclick","keydown","click","pbiMenuButtonClick"],["listItem",""],[1,"dock-container"],[1,"left-container"],[1,"icon","glyphicon","glyph-small","pbi-glyph-table-permission","rls-item-icon"],[1,"center-container"],["class","edit-label",3,"ngModel","ngModelChange",4,"pbiEditableLabel","pbiEditableLabelValue","pbiEditableLabelMode","pbiEditableLabelEditable"],[1,"right-container"],["class","warning-icon glyphicon glyph-mini pbi-glyph-warning","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small","pbiTooltipShowDelay","1000",3,"pbiTooltip",4,"ngIf"],["class","context-menu-button glyphicon glyph-mini pbi-glyph-more pbi-focus-outline-inset","tabindex","-1","pbiTooltipPosition","after","pbiTooltipShowDelay","1000",3,"disabled","pbiMenu","pbiTooltip","pbiMenuButtonClick",4,"ngIf"],[1,"edit-label",3,"ngModel","ngModelChange"],["pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small","pbiTooltipShowDelay","1000",1,"warning-icon","glyphicon","glyph-mini","pbi-glyph-warning",3,"pbiTooltip"],["tabindex","-1","pbiTooltipPosition","after","pbiTooltipShowDelay","1000",1,"context-menu-button","glyphicon","glyph-mini","pbi-glyph-more","pbi-focus-outline-inset",3,"disabled","pbiMenu","pbiTooltip","pbiMenuButtonClick"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"li",0,1),e.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()})("dblclick",function(){return r.startEdit()})("keydown",function(a){return r.handleKeydown(a)})("click",function(){return r.selectRole()})("pbiMenuButtonClick",function(a){return r.onRolesMenuItemClicked(a)}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementStart(4,"div",2)(5,"div",3),e.\u0275\u0275element(6,"span",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",5),e.\u0275\u0275template(8,Fp,1,1,"input",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div",7),e.\u0275\u0275template(10,kp,3,6,"span",8),e.\u0275\u0275template(11,Bp,2,5,"button",9),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275classMap(r.roleListItemClassName),e.\u0275\u0275propertyInterpolate("aria-label",r.role.name+" "+e.\u0275\u0275pipeBind1(2,17,"RLS_Role")+" "+(!r.role.isEditing&&r.role.showWarning?e.\u0275\u0275pipeBind1(3,19,"Error"):"")),e.\u0275\u0275property("tabindex",1===r.index?0:-1)("ngClass",e.\u0275\u0275pureFunction2(21,Lp,r.role.isSelected,r.disableUI))("pbiTooltip",r.role.name)("pbiMenu",r.rolesMenu),e.\u0275\u0275attribute("aria-selected",r.role.isSelected)("aria-setsize",r.rolesLength)("aria-posinset",r.index),e.\u0275\u0275advance(8),e.\u0275\u0275property("pbiEditableLabel",r.editableLabelOptions)("pbiEditableLabelValue",r.role.name)("pbiEditableLabelMode",r.isRename)("pbiEditableLabelEditable",r.role.canEdit),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.role.isEditing&&r.role.showWarning),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.role.canEdit))},dependencies:[ye.Fj,ye.JJ,ye.On,ie.NgClass,ie.NgIf,Zo.l8,Rp.D,kt.V,_i.Y],styles:[".selected[_ngcontent-%COMP%]{background:var(--colorNeutralBackground1Selected);border:1px solid var(--colorNeutralStrokeAccessible);border-radius:2px}.selected.disabled[_ngcontent-%COMP%]{background:transparent}.rls-list-item[_ngcontent-%COMP%]{padding:5px 4px}.rls-item-icon[_ngcontent-%COMP%], .context-menu-button[_ngcontent-%COMP%], .warning-icon[_ngcontent-%COMP%]{padding:0 2px;border:none;vertical-align:middle}.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled);forced-color-adjust:none}.warning-icon[_ngcontent-%COMP%]{color:var(--colorPaletteRedForeground1)}.context-menu-button[_ngcontent-%COMP%]{vertical-align:middle;background-color:transparent;border-color:transparent}.context-menu-button[_ngcontent-%COMP%]:hover{background-color:transparent;border-color:transparent}  .textLabel{margin:0 4px;font-size:var(--sm-font-size);border:none;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.edit-label[_ngcontent-%COMP%]{margin:1px 2px 0;font-size:var(--sm-font-size);color:var(--colorNeutralForeground3);background:var(--colorNeutralBackground1);border:none;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.edit-label[_ngcontent-%COMP%]:focus{outline:none}.dock-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.left-container[_ngcontent-%COMP%]{order:1;flex:initial}.center-container[_ngcontent-%COMP%]{min-height:1px!important;order:2;flex:auto;flex-grow:1000;flex-shrink:1000;min-width:5px}.right-container[_ngcontent-%COMP%]{order:3;flex:initial}"]}),i}();function Vp(i,t){if(1&i&&e.\u0275\u0275element(0,"rls-role",3),2&i){var n=t.$implicit,r=t.index,o=e.\u0275\u0275nextContext().ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("role",n)("index",r+1)("rolesLength",o.roles.length)("disableUI",a.disableUI)}}function Up(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"ul",1),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275template(2,Vp,1,4,"rls-role",2),e.\u0275\u0275elementEnd()),2&i){var n=t.ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,4,"RLS_Role"))("aria-labelledby",r.labelledby),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.roles)("ngForTrackBy",r.trackByRole)}}var Jo=function(){function i(t){this.stateService=t,this.state$=this.stateService.state$,this.roleListItemClassName="rls-list-item",this.disableUI=!1,this.canEdit=!0}return i.prototype.ngAfterViewInit=function(){this.stateService.load(this.canEdit)},i.prototype.refresh=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){return this.stateService.setEditingRole(void 0),[2]})})},i.prototype.trackByRole=function(t,n){return n.name},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(gr))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-role-list"]],inputs:{disableUI:"disableUI",canEdit:"canEdit",labelledBy:"labelledBy"},features:[e.\u0275\u0275ProvidersFeature([gr])],decls:2,vars:3,consts:[["id","rls-role-list","role","tablist",4,"ngIf"],["id","rls-role-list","role","tablist"],[3,"role","index","rolesLength","disableUI",4,"ngFor","ngForOf","ngForTrackBy"],[3,"role","index","rolesLength","disableUI"]],template:function(n,r){1&n&&(e.\u0275\u0275template(0,Up,3,6,"ul",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,r.state$))},dependencies:[ie.NgForOf,ie.NgIf,Np,ie.AsyncPipe,_i.Y],styles:["[_nghost-%COMP%]{flex-grow:1;overflow:auto}ul[_ngcontent-%COMP%]{padding:0}"],changeDetection:0}),i}();function zp(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-message-bar",13),e.\u0275\u0275listener("hideMessageBar",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.emitHideMessageBar())}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",r.messageBarModel)}}function jp(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"span",14),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",n.disableUI?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" (",(null==n.currentRoleViewModel||null==n.currentRoleViewModel.userList?null:n.currentRoleViewModel.userList.length)||0,") ")}}function Wp(i,t){if(1&i&&(e.\u0275\u0275elementContainerStart(0,15),e.\u0275\u0275element(1,"rls-members",16,17),e.\u0275\u0275elementContainerEnd()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("viewModel",n.currentRoleViewModel)}}var Hp=function(i){function t(){var n=i.call(this)||this;return n.name="ModelIdNotExistError",n}return(0,d.__extends)(t,i),t}(Error),Gp=function(){function i(t,n,r,o,a,l,s){var c=this;this.modelingHostService=t,this.changeDetector=n,this.rlsService=r,this.rowLevelSecurity=o,this.modelingDialogService=a,this.store=l,this.eventAggregationService=s,this.hideMessageBar=new e.EventEmitter,this.destroy$=new pn.xQ,this.subscriptions=new F.w,this.initializeHighContrastRules(),this.subscriptions.add(this.rlsService.onChange.subscribe(function(){var u;c.rlsService.getEditorState().selectedRole!==(null===(u=c.currentRole)||void 0===u?void 0:u.name)&&c.selectedRoleChanged()}))}return i.prototype.ngOnInit=function(){var t=this;this.store.select(vp.hX).pipe((0,Me.U)(function(n){return _.values(n.entities).find(function(r){return r.dbName===t.modelingHostService.datasetId})}),(0,Me.U)(function(n){return n?.id}),(0,Pr.x)(),(0,qe.R)(this.destroy$)).subscribe(function(n){t.modelId=n}),this.refresh()},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete(),this.subscriptions.unsubscribe()},i.prototype.selectedRoleChanged=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return this.unsavedAssignPaneChangesExist()?[4,this.modelingDialogService.openRLSEditorConfirmationDialog(Zt.l.AssignPaneRoleSelection)]:[3,3];case 1:return 1!==n.sent()?[3,3]:[4,this.save()];case 2:n.sent(),n.label=3;case 3:return[4,this.refresh()];case 4:return n.sent(),[2]}})})},i.prototype.save=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,d.__generator)(this,function(n){switch(n.label){case 0:return this.unsavedAssignPaneChangesExist()?(this.startUIBlocking(),[4,this.rowLevelSecurity.updateRole(this.currentRoleViewModel,this.modelId).then(function(){return t.eventAggregationService.publishToClient("LoadClientDataModelEvent",{refreshModel:!0}),t.stopUIBlocking(),!0},function(){return t.stopUIBlocking(),!1})]):[2];case 1:return[2,n.sent()]}})})},i.prototype.refresh=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,d.__generator)(this,function(r){switch(r.label){case 0:if(t=this.rlsService.getEditorState().selectedRole,this.currentRole=this.rlsService.getRole(t),!this.modelId)throw new Hp;return this.startUIBlocking(),this.rowLevelSecurity.loadRolesById(this.modelId),[4,this.rowLevelSecurity.rolesPromise];case 1:return r.sent(),this.stopUIBlocking(),this.currentRoleViewModel=this.currentRole&&this.rowLevelSecurity.roles?this.rowLevelSecurity.roles.find(function(o){return o.displayName===n.currentRole.name}):void 0,this.changeDetector.detectChanges(),[2]}})})},i.prototype.unsavedAssignPaneChangesExist=function(){return this.currentRoleViewModel&&this.isDirty()},i.prototype.emitHideMessageBar=function(){this.hideMessageBar.emit()},i.prototype.isDirty=function(){for(var t,n,r,o={},a=0,l=(null===(n=null===(t=this.currentRoleViewModel)||void 0===t?void 0:t.contract)||void 0===n?void 0:n.members)||[];a<l.length;a++){var s=l[a];o[s.displayName]=s}var c=(null===(r=this.currentRoleViewModel)||void 0===r?void 0:r.userList)||[];if(Object.keys(o).length!==c.length)return!0;for(var u=0,f=c;u<f.length;u++)if(!o[f[u].displayName])return!0;return!1},i.prototype.initializeHighContrastRules=function(){},i.prototype.startUIBlocking=function(){this.eventAggregationService.publish("UIBlockingStateChangeEvent",{isBlocking:!0})},i.prototype.stopUIBlocking=function(){this.eventAggregationService.publish("UIBlockingStateChangeEvent",{isBlocking:!1})},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(_p),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(ur),e.\u0275\u0275directiveInject(Zt.e),e.\u0275\u0275directiveInject(bp.yh),e.\u0275\u0275directiveInject(w.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-assign-pane"]],inputs:{disableUI:"disableUI",messageBarModel:"messageBarModel",showMessageBar:"showMessageBar"},outputs:{hideMessageBar:"hideMessageBar"},decls:16,vars:12,consts:[[1,"assign-pane-title-bar"],["id","assign-pane-message",1,"tab-title",3,"ngClass"],["class","save-message-bar",3,"viewModel","hideMessageBar",4,"ngIf"],[1,"assign-pane-content"],[1,"role-column"],["localize","EditScorecardSettings_Role_Settings_Roles","id","assign-pane-roles-list",1,"list-title",3,"ngClass"],[3,"canEdit","disableUI","labelledBy"],["roleList",""],[1,"members-column"],["dock","top",1,"roleOptionHeader"],["localize","RowLevelSecurity_Members",3,"ngClass"],["class","rightMemberCount",3,"ngClass",4,"ngIf"],["dock","center",4,"ngIf"],[1,"save-message-bar",3,"viewModel","hideMessageBar"],[1,"rightMemberCount",3,"ngClass"],["dock","center"],[3,"viewModel"],["rlsMembers",""]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"span",1),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,zp,1,1,"tri-message-bar",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",3)(6,"div",4),e.\u0275\u0275element(7,"h3",5)(8,"rls-role-list",6,7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",8)(11,"docking-container")(12,"div",9),e.\u0275\u0275element(13,"span",10),e.\u0275\u0275template(14,jp,2,2,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(15,Wp,3,1,"ng-container",12),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",r.disableUI?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,10,"RLS_Editor_AssignPane_Message")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.showMessageBar),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",r.disableUI?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275property("canEdit",!1)("disableUI",r.disableUI)("labelledBy","assign-pane-roles-list"),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngClass",r.disableUI?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.currentRoleViewModel),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.currentRoleViewModel))},dependencies:[pr,bt.X,ie.NgClass,ie.NgIf,Tp,Mn.h,Jo,Tt],styles:['.assign-pane-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:420px;padding-bottom:16px}.role-column[_ngcontent-%COMP%]{border-right:1px solid var(--gray-40, #E1DFDD);padding-right:16px;box-sizing:border-box;width:196px;overflow:hidden;display:flex;flex-direction:column}.members-column[_ngcontent-%COMP%]{padding-left:16px;box-sizing:border-box;flex-grow:2}.list-title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-regular, 400);line-height:28px;color:var(--colorNeutralForeground1)}.tab-title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);margin:16px 0;display:block;line-height:22px}.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}tri-message-bar[_ngcontent-%COMP%]{margin-bottom:16px}']}),i}(),qo="RLS_Switch_Dax",ea=function(i){function t(n,r,o,a,l){var s=i.call(this,a,l,{canSwitchMode:!1,daxMode:!1,selectedRole:void 0,selectedTable:void 0,switchModeMessage:qo})||this;return s.localizationService=n,s.rlsService=r,o.daxPane&&(s.supportsSwitch=!0),s.refreshState(),s}return(0,d.__extends)(t,i),t.prototype.initialize=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return i.prototype.initialize.call(this),this.subscriptions.add(this.rlsService.onChange.subscribe(function(){n.refreshState()})),[4,this.refreshState()];case 1:return r.sent(),[2]}})})},t.prototype.refreshState=function(n){return void 0===n&&(n=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.zone.runOutsideAngular(function(){return(0,d.__awaiter)(r,void 0,void 0,function(){var a,l,s;return(0,d.__generator)(this,function(c){return a=this.rlsService.getEditorState(),l=this.rlsService.getSelectedTable(),s={canSwitchMode:this.supportsSwitch,daxMode:this.supportsSwitch&&l?.isDaxEditorOpen,selectedRole:a.selectedRole,selectedTable:a.selectedTable,switchModeMessage:this.localizationService.get(l?.isDaxEditorOpen?"RLS_Switch_Default":qo)},this.updateState(s,n),[2]})})})];case 1:return o.sent(),[2]}})})},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(Be.o),e.\u0275\u0275inject(ot),e.\u0275\u0275inject(B.m),e.\u0275\u0275inject(e.NgZone),e.\u0275\u0275inject(e.ChangeDetectorRef))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(xn),ta=p(49088),bi=p(63708),na=p(1685),ia=function(i){function t(n,r,o){var a=i.call(this,r,o,{daxFormula:"",selectedTable:"",selectedRole:"",errorMessage:"",canRevertExpression:!1,canVerifyExpression:!1})||this;return a.rlsService=n,a.refreshState(),a}return(0,d.__extends)(t,i),t.prototype.initialize=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return i.prototype.initialize.call(this),this.subscribeToServices(),[4,this.refreshState()];case 1:return n.sent(),[2]}})})},t.prototype.refreshState=function(n){return void 0===n&&(n=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.zone.runOutsideAngular(function(){return(0,d.__awaiter)(r,void 0,void 0,function(){var a,l,s;return(0,d.__generator)(this,function(c){if(a={daxFormula:"",selectedTable:"",selectedRole:"",errorMessage:"",canRevertExpression:!1,canVerifyExpression:!1},(l=this.rlsService.getEditorState()).selectedRole&&l.selectedTable)try{s=this.rlsService.getRole(l.selectedRole).getTable(l.selectedTable),a.daxFormula=s.daxExpression,a.selectedTable=s.tableName,a.selectedRole=l.selectedRole,a.errorMessage=s.errorMessage,a.canRevertExpression=this.rlsService.canRevertRlsExpression(l.selectedRole,l.selectedTable),a.canVerifyExpression=this.rlsService.canVerifyRlsExpression(l.selectedRole,l.selectedTable)}catch{}return this.updateState(a,n),[2]})})})];case 1:return o.sent(),[2]}})})},t.prototype.subscribeToServices=function(){var n=this;this.subscriptions.add(this.rlsService.onChange.subscribe(function(){n.refreshState()}))},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(ot),e.\u0275\u0275inject(e.NgZone),e.\u0275\u0275inject(e.ChangeDetectorRef))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(xn);function $p(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"monaco-editor-host",12),e.\u0275\u0275listener("initialized",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onMonacoEditorInitialized())})("onBlur",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onBlur())})("onContentChanged",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onContentChanged(l))})("keydown.esc",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.handleDaxEditorEscapeKeydown(l))}),e.\u0275\u0275elementEnd()}if(2&i){var r=t.ngIf,o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("allowFormatting",!0)("isReadOnly",!1)("languageOptions",r)("customCreationOptions",o.editOptions)}}var ra=function(t,n){return{bannerType:t,message:n}};function Qp(i,t){if(1&i&&e.\u0275\u0275element(0,"tri-message-bar",13),2&i){var n=e.\u0275\u0275nextContext().ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",e.\u0275\u0275pureFunction2(1,ra,r.errorBannerType,n.errorMessage))}}function Xp(i,t){if(1&i&&(e.\u0275\u0275element(0,"tri-message-bar",13),e.\u0275\u0275pipe(1,"translate")),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("viewModel",e.\u0275\u0275pureFunction2(3,ra,n.infoBannerType,e.\u0275\u0275pipeBind1(1,1,"RLS_Editor_RoleFilterExpressionInfo")))}}function Yp(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"docking-container")(1,"div",2)(2,"button",3),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.verifyDaxContent())}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275element(4,"tri-svg-icon",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",5),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.revertDax())}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275element(7,"tri-svg-icon",6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div",7,8),e.\u0275\u0275listener("keydown",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.handleEditorContainerKeydown(l))}),e.\u0275\u0275template(10,$p,1,4,"monaco-editor-host",9),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",10),e.\u0275\u0275template(13,Qp,1,4,"tri-message-bar",11),e.\u0275\u0275template(14,Xp,2,6,"tri-message-bar",11),e.\u0275\u0275elementEnd()()}if(2&i){var r=t.ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(3,7,"RLS_Editor_Verify"))("disabled",!r.canVerifyExpression),e.\u0275\u0275advance(3),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(6,9,"Revert_Changes"))("disabled",!r.canRevertExpression),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(11,11,o.languageOptions$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.errorMessage),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.errorMessage)}}var Zp=function(){function i(t,n,r,o,a,l,s){this.rlsService=t,this.stateService=n,this.daxEditorService=r,this.modelingDialogService=o,this.dataModelService=a,this.daxCapabilitiesService=l,this.document=s,this.verifyDax=new e.EventEmitter,this.editOptions={automaticLayout:!1,fixedOverflowWidgets:!0},this.errorBannerType=1,this.infoBannerType=0,this.editable=!0,this.state$=this.stateService.state$,this.languageOptions$=(0,yn.D)(this.daxCapabilitiesService.getCapabilities())}return i.prototype.updateFilter=function(t){if(t=t?.trim(),t!==this.stateService.getCurrentState().daxFormula){var r=this.rlsService.getEditorState();this.rlsService.setDaxOnTable(r.selectedRole,r.selectedTable,t)}},i.prototype.ngOnInit=function(){var t;return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r,o,l,s,c,u=this;return(0,d.__generator)(this,function(f){switch(f.label){case 0:return this.stateService.initialize(),null===(t=this.textEditorHost)||void 0===t||t.focus(),n=(0,g.C)(this.dataModelService.getDataModel()),r=this.stateService.getCurrentState(),[4,Promise.all([this.daxCapabilitiesService.getReservedWords(),this.daxCapabilitiesService.getCapabilities()])];case 1:return c=f.sent(),o=c[0],l=(0,h.w)(c[1].Functions),s={reservedWords:o,functionDataFromEngine:l},this.subscriptions=this.stateService.afterStateChanged.subscribe(function(v){var C,E,z,ce,le,fe,we,Ue;(null===(C=v.previousState)||void 0===C?void 0:C.selectedTable)!==(null===(E=v.newState)||void 0===E?void 0:E.selectedTable)||(null===(z=v.previousState)||void 0===z?void 0:z.selectedRole)!==(null===(ce=v.newState)||void 0===ce?void 0:ce.selectedRole)?(ta._.configureModel(n,s,{syntaxType:bi.Up.Expression,tableName:null===(le=v.newState)||void 0===le?void 0:le.selectedTable,type:bi.eN.Role},!1),u.daxEditorService.resetEditorValue(v.newState.daxFormula)):(null===(fe=v.previousState)||void 0===fe?void 0:fe.daxFormula)!==(null===(we=v.newState)||void 0===we?void 0:we.daxFormula)&&"textarea"!==(null===(Ue=document.activeElement)||void 0===Ue?void 0:Ue.tagName.toLowerCase())&&u.daxEditorService.resetEditorValue(v.newState.daxFormula)}),ta._.configureModel(n,s,{syntaxType:bi.Up.Expression,tableName:r.selectedTable,type:bi.eN.Role},!1),[2]}})})},i.prototype.onBlur=function(){this.daxEditorService.submit()},i.prototype.revertDax=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,r,o,a,l;return(0,d.__generator)(this,function(c){switch(c.label){case 0:return[4,this.modelingDialogService.openRLSEditorConfirmationDialog(Zt.l.Revert)];case 1:return 1!==c.sent()?[2]:(n=this.rlsService.getEditorState(),r=this.rlsService.getModelRole(n.selectedRole),o=r?.tablePermissions.find(function(u){return u.name===n.selectedTable}),a=o?o.filterExpression:"",l=o?o.errorMessage:"",this.stateService.getCurrentState().daxFormula===a?[3,3]:[4,this.rlsService.setDaxOnTable(n.selectedRole,n.selectedTable,a,l)]);case 2:c.sent(),this.daxEditorService.resetEditorValue(a),c.label=3;case 3:return[2]}})})},i.prototype.verifyDaxContent=function(){this.verifyDax.emit()},i.prototype.onContentChanged=function(t){this.daxEditorService.onContentChanged()},i.prototype.ngOnDestroy=function(){var t;null===(t=this.subscriptions)||void 0===t||t.unsubscribe()},i.prototype.onMonacoEditorInitialized=function(){var t=this.stateService.getCurrentState();this.daxEditorService.registerEditor(this.textEditorHost,t.daxFormula)},i.prototype.tryToSwitchToFilters=function(){},i.prototype.handleDaxEditorEscapeKeydown=function(t){t.preventDefault(),t.stopPropagation(),this.document.querySelector(".editor-host-container").focus()},i.prototype.handleEditorContainerKeydown=function(t){var n=t.target;switch(t.key){case"Enter":n.classList.contains("editor-host-container")&&(t.preventDefault(),t.stopPropagation(),n.querySelector("textarea").focus());break;case"Tab":t.shiftKey||(t.preventDefault(),t.stopPropagation(),this.document.querySelector("#okButton:enabled, #cancelButton").focus())}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(ia),e.\u0275\u0275directiveInject(Tn),e.\u0275\u0275directiveInject(Zt.e),e.\u0275\u0275directiveInject(Ke.n),e.\u0275\u0275directiveInject(m.r),e.\u0275\u0275directiveInject(ie.DOCUMENT))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-dax-pane"]],viewQuery:function(n,r){var o;(1&n&&e.\u0275\u0275viewQuery(na.C,5),2&n)&&(e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.textEditorHost=o.first))},inputs:{editable:"editable"},outputs:{verifyDax:"verifyDax"},features:[e.\u0275\u0275ProvidersFeature([ia])],decls:3,vars:3,consts:[[1,"dax-wrapper"],[4,"ngIf"],["dock","top",1,"dax-editor-buttons"],["data-unique-id","dax-expression-verify",1,"dax-expression-verify",3,"pbiTooltip","disabled","click"],["tri-svg-icon-20","","name","checkmark_20_regular",1,"checkmark-icon"],["data-unique-id","dax-expression-cancel",1,"dax-expression-revert",3,"pbiTooltip","disabled","click"],["tri-svg-icon-20","","name","dismiss_20_regular",1,"dismiss-icon"],["dock","center","tabindex","0",1,"editor-host-container",3,"keydown"],["monacoEditorHostContainer",""],["mode","dax","theme","dax",3,"allowFormatting","isReadOnly","languageOptions","customCreationOptions","initialized","onBlur","onContentChanged","keydown.esc",4,"ngIf"],["dock","bottom","role","alert","aria-live","polite"],[3,"viewModel",4,"ngIf"],["mode","dax","theme","dax",3,"allowFormatting","isReadOnly","languageOptions","customCreationOptions","initialized","onBlur","onContentChanged","keydown.esc"],[3,"viewModel"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Yp,15,13,"docking-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,r.state$)))},dependencies:[pr,ie.NgIf,kt.V,Mn.h,Vt.M,na.C,Tt,ie.AsyncPipe,_i.Y],styles:[".dax-editor[_ngcontent-%COMP%]{height:250px;margin-bottom:5px}.editor-host-container[_ngcontent-%COMP%]{flex:1;padding:8px;height:250px;border:1px solid var(--colorNeutralStroke1);margin-bottom:5px}.dax-editor-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;background-color:var(--colorNeutralBackground1)}.dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px;background-color:transparent;color:var(--colorNeutralForeground1);display:flex;border:none}.dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4}.dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .dismiss-icon[_ngcontent-%COMP%], .dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .checkmark-icon[_ngcontent-%COMP%]{height:24px;width:24px}.dax-editor-buttons[_ngcontent-%COMP%]   button.dax-expression-verify[_ngcontent-%COMP%]:hover:not(:disabled), .dax-editor-buttons[_ngcontent-%COMP%]   button.dax-expression-verify[_ngcontent-%COMP%]:focus:not(:disabled){fill:var(--globalColorGreenPrimary);color:var(--globalColorGreenPrimary)}.dax-editor-buttons[_ngcontent-%COMP%]   button.dax-expression-revert[_ngcontent-%COMP%]:hover:not(:disabled), .dax-editor-buttons[_ngcontent-%COMP%]   button.dax-expression-revert[_ngcontent-%COMP%]:focus:not(:disabled){fill:var(--colorPaletteRedForeground1);color:var(--colorPaletteRedForeground1)}html[data-focus-source=key][_ngcontent-%COMP%]   .dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, html[data-focus-source=key][_ngcontent-%COMP%]   .dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus,   html[data-focus-source=key] .dax-editor-buttons button:focus,   html[data-focus-source=key] .dax-editor-buttons button *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:0px}html[data-focus-source=mouse][_ngcontent-%COMP%]   .dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, html[data-focus-source=mouse][_ngcontent-%COMP%]   .dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus, html[data-focus-source=program][_ngcontent-%COMP%]   .dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, html[data-focus-source=program][_ngcontent-%COMP%]   .dax-editor-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]:focus     html[data-focus-source=mouse] .dax-editor-buttons button:focus,   html[data-focus-source=mouse] .dax-editor-buttons button *:focus,   html[data-focus-source=program] .dax-editor-buttons button:focus,   html[data-focus-source=program] .dax-editor-buttons button *:focus{outline:none}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   tri-message-bar[_ngcontent-%COMP%]{max-height:100px;overflow:scroll}"],changeDetection:0}),i}(),oa=function(i){function t(n,r,o){var a=i.call(this,o,r,{tables:[],noRoleSelected:!0})||this;return a.rlsService=n,a.refreshState(),a}return(0,d.__extends)(t,i),t.prototype.initialize=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return i.prototype.initialize.call(this),this.subscribeToServices(),[4,this.refreshState(!0)];case 1:return n.sent(),[2]}})})},t.prototype.subscribeToServices=function(){var n=this;this.subscriptions.add(this.rlsService.onChange.subscribe(function(){n.refreshState(!0)}))},t.prototype.refreshState=function(n){return void 0===n&&(n=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.zone.runOutsideAngular(function(){return(0,d.__awaiter)(r,void 0,void 0,function(){var a,l,s,c,u;return(0,d.__generator)(this,function(f){return a=this.getDefaultState(),(l=this.rlsService.getEditorState()).selectedRole&&(s=null!==(u=null===(c=this.rlsService.getRole(l.selectedRole))||void 0===c?void 0:c.roleTables)&&void 0!==u?u:[],a.tables=s.map(function(v){var C,E,z;return{name:v.tableName,isSelected:v.tableName===l.selectedTable,showFilterIcon:v.isDaxEditorOpen?(null===(C=v.daxExpression)||void 0===C?void 0:C.length)>0:(null===(E=v.tableFilters)||void 0===E?void 0:E.length)>0,showWarningIcon:(null===(z=v.filtersGroup)||void 0===z?void 0:z.hasErrors)||""!==v.errorMessage}}),a.noRoleSelected=!l.selectedRole),this.updateState(a,n),[2]})})})];case 1:return o.sent(),[2]}})})},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(ot),e.\u0275\u0275inject(e.ChangeDetectorRef),e.\u0275\u0275inject(e.NgZone))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(xn);function Jp(i,t){1&i&&(e.\u0275\u0275element(0,"span",10),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate")),2&i&&(e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(2,4,"Error")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,2,"Error")))}function qp(i,t){1&i&&(e.\u0275\u0275element(0,"span",11),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,1,"Filter_Active"))}var eg=function(t,n){return{selected:t,disabled:n}};function tg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"li",3),e.\u0275\u0275listener("click",function(){var u=e.\u0275\u0275restoreView(n).$implicit,f=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(f.selectTable(u))})("keydown",function(c){var f=e.\u0275\u0275restoreView(n).$implicit,v=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(v.handleKeydown(c,f))})("mousedown",function(c){return c.stopPropagation()})("pbiMenuButtonClick",function(c){e.\u0275\u0275restoreView(n);var u=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(u.onTablesMenuItemClicked(c))}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"span",4),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementStart(5,"span",5),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",6),e.\u0275\u0275template(8,Jp,3,6,"span",7),e.\u0275\u0275template(9,qp,2,3,"span",8),e.\u0275\u0275elementStart(10,"button",9),e.\u0275\u0275listener("pbiMenuButtonClick",function(c){e.\u0275\u0275restoreView(n);var u=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(u.onTablesMenuItemClicked(c))}),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementEnd()()()}if(2&i){var r=t.$implicit,o=t.index,a=e.\u0275\u0275nextContext().ngIf,l=e.\u0275\u0275nextContext();e.\u0275\u0275classMap(l.tableListItemClassName),e.\u0275\u0275propertyInterpolate("aria-label",r.name+(r.showFilterIcon?" "+e.\u0275\u0275pipeBind1(1,18,"ManageRolesTableHasFilter"):"")+(r.showWarningIcon?" "+e.\u0275\u0275pipeBind1(2,20,"Error"):"")),e.\u0275\u0275property("tabindex",0===o?0:-1)("ngClass",e.\u0275\u0275pureFunction2(26,eg,r.isSelected,!l.editable))("pbiTooltip",r.name)("pbiMenu",l.tablesMenu(r)),e.\u0275\u0275attribute("aria-selected",r.isSelected)("aria-setsize",a.tables.length)("aria-posinset",o+1),e.\u0275\u0275advance(3),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,22,"Table_ToolTip")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",r.name," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.showWarningIcon),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.showFilterIcon&&!r.showWarningIcon),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",a.noRoleSelected||!l.editable)("pbiMenu",l.tablesMenu(r))("pbiTooltip",e.\u0275\u0275pipeBind1(11,24,"Options_Menu"))}}function ng(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"ul",1),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275template(2,tg,12,29,"li",2),e.\u0275\u0275elementEnd()),2&i){var n=t.ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,4,"Table_ToolTip"))("aria-labelledby",r.labelledBy),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.tables)("ngForTrackBy",r.trackByTable)}}var ig=function(){function i(t,n,r,o){this.localizationService=t,this.rlsService=n,this.stateService=r,this.document=o,this.state$=this.stateService.state$,this.tableListItemClassName="rls-list-item",this.editable=!0}return i.prototype.ngAfterViewInit=function(){this.stateService.initialize()},i.prototype.onTablesMenuItemClicked=function(t){var n=this.rlsService.getEditorState().selectedRole,r=this.rlsService.getRole(t.id);r&&this.rlsService.copyFiltersFromRole(r.name,n,t.data.tableName)},i.prototype.selectTable=function(t){var n=this.rlsService.getEditorState().selectedTable;!this.editable||n===t?.name||this.rlsService.selectTable(t?.name)},i.prototype.tablesMenu=function(t){var n=this.copyTableOptions(t);return{items:[{type:wt.iB.SubMenu,text:this.localizationService.get("Copy_Table_Filter_From"),disabled:!(n.length>0),menu:{items:(0,d.__spreadArray)([],n,!0)}}]}},i.prototype.handleKeydown=function(t,n){switch(t.key){case"Enter":return this.selectTable(n);case" ":return t.preventDefault(),this.selectTable(n);case"ArrowUp":return t.preventDefault(),void vi(function(o){return o.previousElementSibling},this.tableListItemClassName,this.document);case"ArrowDown":return t.preventDefault(),void vi(function(o){return o.nextElementSibling},this.tableListItemClassName,this.document);case"Tab":t.shiftKey&&(t.preventDefault(),t.stopPropagation(),(this.document.querySelector("rls-role-list .rls-list-item")||this.document.querySelector("#createPaneTab > button")||this.document.querySelector("#closeButton")).focus())}},i.prototype.trackByTable=function(t,n){return n.name},i.prototype.copyTableOptions=function(t){var n,r=this.rlsService.getEditorState().selectedRole,o=null===(n=this.rlsService.getRole(r))||void 0===n?void 0:n.getTable(t.name),a=[];return this.rlsService.getRoles().forEach(function(l){var s,c;if(l.name!==r){var u=l.roleTables.find(function(f){return f.tableName===t.name});u&&((null===(c=null===(s=u.filtersGroup)||void 0===s?void 0:s.children)||void 0===c?void 0:c.length)>0||u.daxExpression)&&a.push({id:l.name,type:wt.iB.Button,text:l.name,data:o})}}),a},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(oa),e.\u0275\u0275directiveInject(ie.DOCUMENT))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-table-list"]],inputs:{editable:"editable",labelledBy:"labelledBy"},features:[e.\u0275\u0275ProvidersFeature([oa])],decls:2,vars:3,consts:[["role","tablist",4,"ngIf"],["role","tablist"],["role","tab","class","pbi-focus-outline","pbiTooltipShowDelay","1000","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small","pbiMenuActivation","contextmenu",3,"tabindex","class","ngClass","aria-label","pbiTooltip","pbiMenu","click","keydown","mousedown","pbiMenuButtonClick",4,"ngFor","ngForOf","ngForTrackBy"],["role","tab","pbiTooltipShowDelay","1000","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small","pbiMenuActivation","contextmenu",1,"pbi-focus-outline",3,"tabindex","ngClass","aria-label","pbiTooltip","pbiMenu","click","keydown","mousedown","pbiMenuButtonClick"],[1,"icon","glyphicon","glyph-small","pbi-glyph-table","rls-item-icon"],[1,"table-name"],[1,"inline-items"],["tabindex","-1","class","warning-icon glyphicon glyph-mini pbi-glyph-warning","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small","pbiTooltipShowDelay","1000",3,"pbiTooltip",4,"ngIf"],["tabindex","-1","class","filter-icon glyphicon glyph-mini pbi-glyph-filter",4,"ngIf"],["tabindex","-1","pbiTooltipPosition","after","pbiTooltipShowDelay","1000",1,"context-menu-button","glyphicon","glyph-mini","pbi-glyph-more","pbi-focus-outline-inset",3,"disabled","pbiMenu","pbiTooltip","pbiMenuButtonClick"],["tabindex","-1","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small","pbiTooltipShowDelay","1000",1,"warning-icon","glyphicon","glyph-mini","pbi-glyph-warning",3,"pbiTooltip"],["tabindex","-1",1,"filter-icon","glyphicon","glyph-mini","pbi-glyph-filter"]],template:function(n,r){1&n&&(e.\u0275\u0275template(0,ng,3,6,"ul",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,r.state$))},dependencies:[ie.NgClass,ie.NgForOf,ie.NgIf,Zo.l8,kt.V,Tt,ie.AsyncPipe],styles:["[_nghost-%COMP%]   ul[_ngcontent-%COMP%]{height:396px;overflow:auto}ul[_ngcontent-%COMP%]{padding:0}.table-name[_ngcontent-%COMP%]{max-width:88px;height:20px;display:inline-block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.selected[_ngcontent-%COMP%]{background:var(--colorNeutralBackground1Selected);border:1px solid var(--colorNeutralStrokeAccessible);border-radius:2px}.selected.disabled[_ngcontent-%COMP%]{background:transparent}.rls-list-item[_ngcontent-%COMP%]{height:34px;padding:5px 4px;cursor:pointer;box-sizing:border-box;display:flex;margin:2px;align-items:center}.rls-item-icon[_ngcontent-%COMP%], .context-menu-button[_ngcontent-%COMP%], .filter-icon[_ngcontent-%COMP%], .warning-icon[_ngcontent-%COMP%]{vertical-align:middle;border:none;padding:0 2px}.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled);forced-color-adjust:none}.inline-items[_ngcontent-%COMP%]{margin-left:auto}.inline-items[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]{color:var(--colorPaletteRedForeground1)}.inline-items[_ngcontent-%COMP%]   .context-menu-button[_ngcontent-%COMP%], .inline-items[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%], .inline-items[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]{vertical-align:middle;background-color:transparent;border-color:transparent}.inline-items[_ngcontent-%COMP%]   .context-menu-button[_ngcontent-%COMP%]:hover, .inline-items[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]:hover, .inline-items[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]:hover{background-color:transparent;border-color:transparent}"],changeDetection:0}),i}(),aa=p(22844),rg=p(25131),og=function(){return{"aria-label":"Delete"}};function ag(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",4)(1,"span",5),e.\u0275\u0275listener("click",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.startEdit(a))}),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",6),e.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()})("keyup.enter",function(a){return a.stopPropagation()})("click",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return l.valueRemoved.emit(l.tagValue),e.\u0275\u0275resetView(a.stopPropagation())}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.tagValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction0(3,og)),e.\u0275\u0275attribute("disabled",r.isDisabled||null)}}var lg=function(t,n,r){return{"string-input":t,"number-input":n,"error-state":r}};function sg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",10),e.\u0275\u0275listener("blur",function(a){return e.\u0275\u0275restoreView(n),e.\u0275\u0275nextContext(2).updateTagValue(a.target.value),e.\u0275\u0275resetView(a.stopPropagation())})("keydown.enter",function(a){return e.\u0275\u0275restoreView(n),e.\u0275\u0275nextContext(2).updateTagValue(a.target.value),e.\u0275\u0275resetView(a.stopPropagation())}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(5,lg,r.dataType===r.PbiTagValueType.String,r.dataType!==r.PbiTagValueType.String,r.displayErrorState))("type",r.dataType===r.PbiTagValueType.String?"text":"number")("value",r.tagValue),e.\u0275\u0275attribute("disabled",r.isDisabled||null)("aria-label",r.tagValue)}}var cg=function(t,n){return{disabled:t,"error-state":n}};function dg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-date-picker",11),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.updateTagValue(a))})("focusOff",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.handleCalendarFocusOut())}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("multiSelect",!0)("ngModel",r.tagValue)("disableInputBox",r.isDisabled)("ngClass",e.\u0275\u0275pureFunction2(6,cg,r.isDisabled,r.displayErrorState))("emitInvalidInputValues",!1)("placeholder",r.placeholder)}}function ug(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275template(1,sg,1,9,"input",8),e.\u0275\u0275template(2,dg,1,9,"pbi-date-picker",9),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.dataType!==n.PbiTagValueType.Date),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.dataType===n.PbiTagValueType.Date)}}var Xt=function(i){return i[i.String=0]="String",i[i.Number=1]="Number",i[i.Date=2]="Date",i}({}),la=function(){function i(){this.dataType=Xt.String,this.displayErrorState=!1,this.forceEditMode=!1,this.inEditMode=!1,this.isDisabled=!1,this.tagValue="",this.valueRemoved=new e.EventEmitter,this.valueChanged=new e.EventEmitter,this.cancelEditMode=new e.EventEmitter,this.PbiTagValueType=Xt}return i.prototype.startEdit=function(t){this.inEditMode=!0,t.stopPropagation()},i.prototype.cancelEdit=function(t){t.stopPropagation(),this.cancelEditInternal()},i.prototype.handleCalendarFocusOut=function(){this.cancelEditInternal()},i.prototype.updateTagValue=function(t){t instanceof String&&(t=t?.trim());var n=t!==this.tagValue;this.cancelEditInternal(!t&&this.dataType!==Xt.Date),n&&this.valueChanged.emit(t)},i.prototype.cancelEditInternal=function(t){void 0===t&&(t=!0),this.forceEditMode||(this.inEditMode=!1,t&&this.cancelEditMode.emit())},i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["pbi-tag"]],inputs:{dataType:"dataType",displayErrorState:"displayErrorState",forceEditMode:"forceEditMode",inEditMode:"inEditMode",isDisabled:"isDisabled",placeholder:"placeholder",tagValue:"tagValue"},outputs:{valueRemoved:"valueRemoved",valueChanged:"valueChanged",cancelEditMode:"cancelEditMode"},decls:4,vars:5,consts:[[1,"pbi-tag",3,"tabindex","ngClass","keydown.esc","keyup.enter"],[3,"ngSwitch"],["class","view-mode",4,"ngSwitchCase"],["class","edit-mode",4,"ngSwitchCase"],[1,"view-mode"],[3,"click"],[1,"close-button","glyphicon","glyph-mini","pbi-glyph-exit","pbi-focus-outline-inset",3,"localizeAttr","mousedown","keyup.enter","click"],[1,"edit-mode"],["class","input-field new-item-input","tabindex","0",3,"ngClass","type","value","blur","keydown.enter",4,"ngIf"],["tabindex","0",3,"multiSelect","ngModel","disableInputBox","ngClass","emitInvalidInputValues","placeholder","ngModelChange","focusOff",4,"ngIf"],["tabindex","0",1,"input-field","new-item-input",3,"ngClass","type","value","blur","keydown.enter"],["tabindex","0",3,"multiSelect","ngModel","disableInputBox","ngClass","emitInvalidInputValues","placeholder","ngModelChange","focusOff"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("keydown.esc",function(a){return r.cancelEdit(a)})("keyup.enter",function(a){return r.startEdit(a)}),e.\u0275\u0275elementContainerStart(1,1),e.\u0275\u0275template(2,ag,4,4,"div",2),e.\u0275\u0275template(3,ug,3,2,"div",3),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("tabindex",r.inEditMode?"-1":"0")("ngClass",r.isDisabled?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",r.inEditMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",!1),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",!0))},dependencies:[ie.NgClass,ie.NgIf,ie.NgSwitch,ie.NgSwitchCase,aa.b,rg.N,ye.JJ,ye.On],styles:["[_nghost-%COMP%]{--colorBackgroundColor: var(--fluent-theme-neutral-lighter-color, #F3F2F1);--colorBackgroundColorViewModeDisabled: var(--gray-20, #F3F2F1);--colorInputBackgroundColor: var(--fluent-theme-white-color, #FFF);--colorBorderColor: var(--gray-110, #8A8886);--colorBorderColorViewModeDisabled: var(--gray-60, #C8C6C4);--colorBorderColorError: var(--fluent-theme-error-dark-color, #A80000);--colorDisabled: var(--gray-90, #A19F9D);--colorCloseButton: var(--gray-130, #605E5C);--colorCloseButtonHover: var(--gray-40, #E1DFDD)}[data-legacy-theming=false]   [_nghost-%COMP%]{--colorBackgroundColor: var(--colorNeutralBackground2);--colorBackgroundColorViewModeDisabled: var(--colorNeutralBackgroundDisabled);--colorInputBackgroundColor: var(--colorNeutralBackground1);--colorBorderColor: var(--colorNeutralStroke1);--colorBorderColorViewModeDisabled: var(--colorNeutralStrokeDisabled);--colorBorderColorError: var(--colorPaletteRedForeground1);--colorDisabled: var(--colorNeutralForegroundDisabled);--colorCloseButton: var(--colorNeutralForeground1);--colorCloseButtonHover: var(--colorNeutralForeground1Hover)}.pbi-tag[_ngcontent-%COMP%]{background-color:var(--colorBackgroundColor);height:32px;display:flex;flex-direction:row;justify-content:space-between;box-sizing:border-box;align-items:center;max-width:inherit}.pbi-tag[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px;font-size:var(--md-font-size, 14px);display:inline-block;width:calc(100% - 44px);overflow:hidden;vertical-align:text-bottom;text-overflow:ellipsis;white-space:nowrap}.pbi-tag[_ngcontent-%COMP%]   .view-mode[_ngcontent-%COMP%]{border:1px solid var(--colorNeutralStrokeAccessible);border-radius:2px;max-width:inherit}.pbi-tag.disabled[_ngcontent-%COMP%]   .view-mode[_ngcontent-%COMP%]{background-color:var(--colorBackgroundColorViewModeDisabled);border:1px solid var(--colorBorderColorViewModeDisabled);color:var(--colorDisabled);pointer-events:none}input.error-state[_ngcontent-%COMP%]{border:1px solid var(--colorBorderColorError)}.string-input[_ngcontent-%COMP%], .number-input[_ngcontent-%COMP%]{max-width:inherit}.close-button[_ngcontent-%COMP%]{background-color:inherit;border:none;padding:0;color:var(--colorCloseButton);font-size:var(--sm-font-size, 12px);height:30px;width:28px;text-align:center;cursor:pointer}.close-button[_ngcontent-%COMP%]:disabled{pointer-events:none;color:var(--colorDisabled)}.close-button[_ngcontent-%COMP%]:hover{background-color:var(--colorCloseButtonHover)}.new-item-input[_ngcontent-%COMP%]{height:32px;padding-left:8px;padding-right:8px;font-size:var(--md-font-size, 14px);line-height:20px;box-sizing:border-box;border-radius:2px;border:1px solid var(--colorBorderColor);background-color:var(--colorInputBackgroundColor)}.new-item-input[_ngcontent-%COMP%]:disabled{color:var(--colorDisabled)}  pbi-date-picker{display:block;width:125px}"],changeDetection:0}),i}(),sa=function(){function i(){}return i.prototype.constructValueState=function(t){var n,a,r=t.operator===x.in||t.operator===x.notIn,o=Fe.isUnaryOperator(t.operator);return a="Date"===t.dataType||"DateTime"===t.dataType?Xt.Date:"Currency"===t.dataType||"Number"===t.dataType||"WholeNumber"===t.dataType?Xt.Number:Xt.String,{columnName:t.columnName,filterId:t.filterId,hasError:t.hasError,isList:r,isUnary:o,lineId:t.lineId,operator:t.operator,placeholder:o?"":Fe.getPlaceholderForType(t.dataType),tagType:a,value:t.value,stringValue:(null===(n=t.value)||void 0===n?void 0:n.length)>0?t.value[0]:""}},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(n){return new(n||i)}}),i}(),Pn=function(){function i(t,n,r){this.rlsService=t,this.modelService=n,this.filterValueService=r}return i.prototype.buildFilterLineItems=function(t,n,r){var o,a,l=null===(a=null===(o=this.rlsService.getRole(t))||void 0===o?void 0:o.getTable(n))||void 0===a?void 0:a.filtersGroup;return l?this.buildGroupItem(l,{currentId:0,selectedFilters:r,roleName:t,tableName:n}):[]},i.prototype.buildCommonProperties=function(t,n){var r=n.currentId++;return{level:t.level+1,filterId:t.id,lineId:r,isRoot:0===t.level,isGroup:t.isGroup(),isNested:t.level>1,isSelected:n.selectedFilters.findIndex(function(o){return o===t.id})>=0,parentAndOperator:!1,tableName:n.tableName,roleName:n.roleName,isLastItem:!1,canGroup:!1}},i.prototype.buildFilterItem=function(t,n,r){var o,a,l,s;if(0!==t.level&&0!==n.currentId){var c=null===(o=this.getColumn(n.tableName,t.columnName))||void 0===o?void 0:o.dataType,u=this.getFilterOperators(n.tableName,t.columnName,t.operator),f=r.children.findIndex(function(E){return E.id===t.id}),v=void 0===r.children.slice(f+1).find(function(E){return E.isFilter()}),C=(0,d.__assign)((0,d.__assign)({},this.buildCommonProperties(t,n)),{columnName:t.columnName,columns:null===(s=null===(l=null===(a=this.getTable(n.tableName))||void 0===a?void 0:a.columns)||void 0===l?void 0:l.nonSystemColumns)||void 0===s?void 0:s.map(function(E){return E.name}),hasError:t.errorKeys.length>0,operatorName:u.selected,operatorOptions:u.options,isLastItem:v});return C.value=this.filterValueService.constructValueState({columnName:t.columnName,dataType:c,filterId:C.filterId,hasError:C.hasError,lineId:C.lineId,operator:u.selected,value:t.value}),[C]}},i.prototype.buildGroupItem=function(t,n,r){if(0===t.level&&0!==n.currentId)return[];var o=[(0,d.__assign)((0,d.__assign)({},this.buildCommonProperties(t,n)),{isAndOperator:t.isAndOperator,isCollapsed:t.isCollapsed,parentAndOperator:!!r&&r.isGroup()&&r.isAndOperator,showColumnHeader:!t.isCollapsed&&void 0!==t.children.find(function(u){return u.isFilter()})})];if(!t.isCollapsed)for(var a=0,l=t.children;a<l.length;a++){var s=l[a],c=s.isGroup()?this.buildGroupItem(s,n,t):this.buildFilterItem(s,n,t);if(!c)return[];o.push.apply(o,c)}return o},i.prototype.getFilterOperators=function(t,n,r){var o;if(!n||!this.modelService.model)return{options:Fe.getOperatorsForType(void 0),selected:void 0};var a=null===(o=this.getColumn(t,n))||void 0===o?void 0:o.dataType,l=Fe.getOperatorsForType(a);return-1===l.indexOf(r)&&(r=Fe.getDefaultOperatorForType(a)),{options:l,selected:r}},i.prototype.getColumn=function(t,n){var r,o;return null===(o=null===(r=this.getTable(t))||void 0===r?void 0:r.columns)||void 0===o?void 0:o.findByName(n)},i.prototype.getTable=function(t){var n;return null===(n=this.modelService.model)||void 0===n?void 0:n.findTable(t)},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275inject(ot),e.\u0275\u0275inject(Oe.b),e.\u0275\u0275inject(sa))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),On=function(i){function t(n,r,o,a,l){var s=i.call(this,a,l,{selectedRole:void 0,selectedTable:void 0,isTableSelected:!1,lineItems:[],canPressDelete:!1,canGroup:!1,canUngroup:!1,canSelectAll:!1})||this;return s.rlsService=n,s.filterLineService=r,s.eventAggregationService=o,s._selectedFilters=[],s._lastSelectedState=void 0,s}return(0,d.__extends)(t,i),t.prototype.clearSelectedFilters=function(){this._selectedFilters=[],this.refreshState()},t.prototype.initialize=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return this.subscribeToServices(),[4,this.refreshState(!0)];case 1:return n.sent(),i.prototype.initialize.call(this),[2]}})})},t.prototype.refreshState=function(n){return void 0===n&&(n=!1),(0,d.__awaiter)(this,void 0,void 0,function(){var r,o=this;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return r=this.getSelectedFilters(),[4,this.zone.runOutsideAngular(function(){return(0,d.__awaiter)(o,void 0,void 0,function(){var l,s,c=this;return(0,d.__generator)(this,function(u){return l=this.getDefaultState(),s=this.rlsService.getEditorState(),l.selectedTable=s.selectedTable,l.isTableSelected=!!s.selectedTable,l.selectedRole=s.selectedRole,(l=this.updateFilters(l)).lineItems.length>0&&(l.canPressDelete=this._selectedFilters.length&&l.isTableSelected,l.canGroup=!!l.selectedTable&&this._selectedFilters.length>1&&!!this.rlsService.getSameParent(s.selectedRole,s.selectedTable,this._selectedFilters)&&this.canGroupSelectedFilters(),l.canUngroup=this._selectedFilters.length>0&&r.every(function(f){return f.level>1||f.isGroup()}),l.canSelectAll=!(l.lineItems.length&&this._selectedFilters.length===l.lineItems.length-1),l.lineItems.forEach(function(f){f.canGroup=c.canGroupSelectedFilters()&&!f.isGroup&&!f.isNested&&c._selectedFilters.filter(function(v){return v!==f.filterId}).length>0})),this.updateState(l,n),[2]})})})];case 1:return a.sent(),[2]}})})},t.prototype.selectAllFilters=function(){this._selectedFilters=this.getCurrentState().lineItems.filter(function(n){return!n.isRoot}).map(function(n){return n.filterId}),this.refreshState()},t.prototype.selectFilter=function(n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return-1===(r=this._selectedFilters.indexOf(n))?this._selectedFilters.push(n):this._selectedFilters.splice(r,1),[4,this.refreshState()];case 1:return o.sent(),[2]}})})},t.prototype.addSiblingFilter=function(n){var r=this.rlsService.getEditorState();this.rlsService.addSiblingFilter(r.selectedRole,r.selectedTable,n)},t.prototype.deleteFilter=function(n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o,a;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return r=this.rlsService.getEditorState(),o=this._selectedFilters.indexOf(n),a=[n],-1!==o&&(a=this._selectedFilters.map(function(s){return s}),this.clearSelectedFilters()),this.rlsService.deleteFilterItems(r.selectedRole,r.selectedTable,a),this.rlsService.rebalanceFilterGroups(r.selectedRole,r.selectedTable),[4,this.refreshState()];case 1:return l.sent(),[2]}})})},t.prototype.group=function(n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return r=this.rlsService.getEditorState(),o=this._selectedFilters.map(function(s){return s}),-1===this._selectedFilters.indexOf(n)&&o.push(n),this.clearSelectedFilters(),o=this.rlsService.getSelectedItemsSorted(r.selectedRole,r.selectedTable,o).map(function(s){return s.id}),this.rlsService.group(r.selectedRole,r.selectedTable,o),[4,this.refreshState()];case 1:return l.sent(),[2]}})})},t.prototype.canGroupSelectedFilters=function(){if(_.isEmpty(this._selectedFilters))return!1;for(var n=0,r=this.getSelectedFilters();n<r.length;n++){var o=r[n];if(o.isGroup()||o.level>1)return!1}return!0},t.prototype.getSelectedFilters=function(){var n=this,r=this.rlsService.getEditorState();return r.selectedRole&&r.selectedTable?this._selectedFilters.map(function(o){return n.rlsService.getFilter(r.selectedRole,r.selectedTable,o)}):[]},t.prototype.subscribeToServices=function(){var n=this;this.subscriptions.add(this.rlsService.onChange.subscribe(function(){var r=(0,d.__assign)({},n.rlsService.getEditorState());(!n._lastSelectedState||n._lastSelectedState.selectedRole!==r.selectedRole||n._lastSelectedState.selectedTable!==r.selectedTable)&&n.clearSelectedFilters(),n._lastSelectedState=r,n.refreshState(!0)})),this.subscriptions.add(this.eventAggregationService.subscribe("RlsSaveEventSuccess",function(){return n.clearSelectedFilters()}))},t.prototype.updateFilters=function(n){var r=this.rlsService.getEditorState();return n.lineItems=r.selectedRole&&r.selectedTable?this.filterLineService.buildFilterLineItems(r.selectedRole,r.selectedTable,this._selectedFilters):[],n},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275inject(ot),e.\u0275\u0275inject(Pn),e.\u0275\u0275inject(w.x),e.\u0275\u0275inject(e.NgZone),e.\u0275\u0275inject(e.ChangeDetectorRef))},t.\u0275prov=e.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(xn),ca=p(5467),hr=p(86663),da=function(i){return i[i.String=0]="String",i[i.Number=1]="Number",i[i.Date=2]="Date",i}({});function mg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0,4),e.\u0275\u0275elementStart(1,"pbi-tag",5),e.\u0275\u0275listener("valueChanged",function(l){var s=e.\u0275\u0275restoreView(n),c=s.$implicit,u=s.index,f=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(f.updateTag(c,l,u))})("valueRemoved",function(){var l=e.\u0275\u0275restoreView(n),s=l.$implicit,c=l.index,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.valueRemoved.emit({tag:s,index:c}))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=t.$implicit,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tagValue",r)("isDisabled",o.isDisabled)("dataType",o.dataType)("placeholder",o.placeholder)}}function fg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"pbi-tag",6),e.\u0275\u0275listener("valueChanged",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.addNewTag(a))})("cancelEditMode",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.showAddButton())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("dataType",r.dataType)("placeholder",r.placeholder)("inEditMode",!0)}}var vg=function(t){return{"error-state":t}},_g=function(){return{"aria-label":"AddValue"}};function bg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",7),e.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()})("click",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.displayInputLayout(a))})("keyup.enter",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.displayInputLayout(a))}),e.\u0275\u0275element(1,"span",8)(2,"i",9),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",r.isDisabled)("ngClass",e.\u0275\u0275pureFunction1(4,vg,r.displayErrorState))("localizeAttr",e.\u0275\u0275pureFunction0(6,_g)),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","ItemAction_Add")}}var yg=function(){return{"aria-label":"PBI_Tag_List_AriaLabel"}},Cg=function(){function i(t){this.changeDetector=t,this.tags=[],this.dataType=Xt.String,this.isDisabled=!1,this.displayErrorState=!1,this.valueRemoved=new e.EventEmitter,this.valueAdded=new e.EventEmitter,this.valueUpdated=new e.EventEmitter,this.inEditMode=!1,this.displayAddButton=!0,this.PbiTagValueType=Xt}return i.prototype.updateTag=function(t,n,r){this.displayAddButton=!0,this.inEditMode=!1,n&&this.valueUpdated.emit({tag:t,newValue:n,index:r}),this.changeDetector.detectChanges()},i.prototype.addNewTag=function(t){t&&this.valueAdded.emit(t),this.displayAddButton=!0,this.changeDetector.detectChanges()},i.prototype.showAddButton=function(){this.displayAddButton=!0,this.changeDetector.detectChanges()},i.prototype.displayInputLayout=function(t){this.displayAddButton=!1,t.stopPropagation(),this.changeDetector.detectChanges()},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["pbi-tag-list"]],inputs:{tags:"tags",dataType:"dataType",isDisabled:"isDisabled",displayErrorState:"displayErrorState",placeholder:"placeholder"},outputs:{valueRemoved:"valueRemoved",valueAdded:"valueAdded",valueUpdated:"valueUpdated"},decls:4,vars:5,consts:[["tabindex","0",1,"container",3,"localizeAttr"],["class","item",4,"ngFor","ngForOf"],[4,"ngIf"],["class","add-button",3,"disabled","ngClass","localizeAttr","mousedown","click","keyup.enter",4,"ngIf"],[1,"item"],[3,"tagValue","isDisabled","dataType","placeholder","valueChanged","valueRemoved"],[3,"tagValue","dataType","placeholder","inEditMode","valueChanged","cancelEditMode"],[1,"add-button",3,"disabled","ngClass","localizeAttr","mousedown","click","keyup.enter"],[3,"localize"],[1,"glyphicon","pbi-glyph-add","glyph-mini"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,mg,2,4,"ng-container",1),e.\u0275\u0275template(2,fg,2,3,"ng-container",2),e.\u0275\u0275template(3,bg,3,7,"button",3),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("localizeAttr",e.\u0275\u0275pureFunction0(4,yg)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.tags),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.displayAddButton),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.displayAddButton))},dependencies:[ie.NgClass,ie.NgForOf,ie.NgIf,bt.X,aa.b,la],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:4px;background-color:inherit;max-width:inherit}.container[_ngcontent-%COMP%]   pbi-tag[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{max-width:inherit}.add-button[_ngcontent-%COMP%]{background-color:var(--fluent-theme-white-color, #FFF);border:1px solid var(--gray-110, #8A8886);border-radius:2px;height:32px;padding:2px;cursor:pointer}.add-button[_ngcontent-%COMP%]:hover{background-color:var(--fluent-theme-white-color, #FFF)}.add-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:6px 8px;font-size:var(--md-font-size, 14px)}.add-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:8px}.add-button[_ngcontent-%COMP%]:disabled{background-color:var(--gray-20, #F3F2F1);border-color:var(--gray-60, #C8C6C4);color:var(--gray-90, #A19F9D);pointer-events:none}.add-button.error-state[_ngcontent-%COMP%]{border:1px solid var(--fluent-theme-error-dark-color, #A80000)}"],changeDetection:0}),i}();function Sg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",2)(1,"pbi-tag",3),e.\u0275\u0275listener("valueChanged",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.updateFilterFromText(a))}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("tagValue",r.state.stringValue)("dataType",r.state.tagType)("placeholder",r.state.placeholder)("forceEditMode",!0)("inEditMode",!0)("displayErrorState",r.state.hasError)}}function Mg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",4)(1,"pbi-tag-list",5),e.\u0275\u0275listener("valueRemoved",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.removeListItem(a.index))})("valueUpdated",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.updateListItem(a.newValue,a.index))})("valueAdded",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.addListItem(a))}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("tags",r.state.value)("dataType",r.state.tagType)("displayErrorState",r.state.hasError)("placeholder",r.state.placeholder)}}var ua=function(){function i(t,n){this.rlsService=t,this.filterPaneState=n,this.PbiTagValueType=Xt}return i.prototype.removeListItem=function(t){var n=(0,d.__spreadArray)([],this.state.value,!0);n.splice(t,1),this.saveFilterValue(n)},i.prototype.addListItem=function(t){var n=(0,d.__spreadArray)([],this.state.value,!0);n.push(this.getValueAsString(t)),this.saveFilterValue(n)},i.prototype.updateListItem=function(t,n){var r=(0,d.__spreadArray)([],this.state.value,!0);r[n]=this.getValueAsString(t),this.saveFilterValue(r)},i.prototype.updateFilterFromText=function(t){this.saveFilterValue([this.getValueAsString(t)])},i.prototype.saveFilterValue=function(t){var n=this.filterPaneState.getCurrentState();this.rlsService.setFilterValue(n.selectedRole,n.selectedTable,this.state.filterId,t)},i.prototype.getValueAsString=function(t){return function(i,t){return function(i,t){return i===da.Date}(i)?Y.dx.formatValue(t,"d"):function(i,t){return i===da.Date}(i)?Y.dx.formatValue(t):t}(this.state.tagType,t)},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(On))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-filter-value"]],inputs:{editable:"editable",state:"state"},decls:2,vars:2,consts:[["class","single-tag-container",4,"ngIf"],["class","multi-tag-container",4,"ngIf"],[1,"single-tag-container"],[3,"isDisabled","tagValue","dataType","placeholder","forceEditMode","inEditMode","displayErrorState","valueChanged"],[1,"multi-tag-container"],[3,"isDisabled","tags","dataType","displayErrorState","placeholder","valueRemoved","valueUpdated","valueAdded"]],template:function(n,r){1&n&&(e.\u0275\u0275template(0,Sg,2,7,"div",0),e.\u0275\u0275template(1,Mg,2,5,"div",1)),2&n&&(e.\u0275\u0275property("ngIf",!r.state.isList&&!r.state.isUnary),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.state.isList))},dependencies:[ie.NgIf,Cg,la],styles:[".single-tag-container[_ngcontent-%COMP%], .multi-tag-container[_ngcontent-%COMP%]{margin:4px 4px 4px 0}.multi-tag-container[_ngcontent-%COMP%]   pbi-tag-list[_ngcontent-%COMP%]{max-width:160px}  pbi-date-picker{background-color:var(--colorNeutralBackground1)!important;border-color:var(--colorNeutralStroke1)!important}  pbi-date-picker .calendar-button{border-color:var(--colorNeutralStroke1)!important}  pbi-date-picker.input-error{border-color:var(--colorPaletteRedForeground1)!important}  pbi-date-picker.disabled{border-color:var(--colorNeutralStrokeDisabled)!important;color:var(--colorNeutralForegroundDisabled)!important}  pbi-date-picker.error-state{border-color:var(--colorPaletteRedForeground1)!important}  .pbi-tag input{width:160px}"],changeDetection:0}),i}(),wg=function(t,n){return{selected:t,disabled:n}};function xg(i,t){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",6),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,wg,n.state.isSelected,!n.editable))}}var Pg=function(t){return{selected:t}};function Og(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-checkbox",7),e.\u0275\u0275listener("click",function(a){return a.stopPropagation()})("onChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.select())}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(3,Pg,r.state.isSelected))("disabled",!r.editable)("checked",r.state.isSelected)}}function Eg(i,t){if(1&i&&e.\u0275\u0275element(0,"span",16),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",n.editable?null:"disabled")("localize",n.state.parentAndOperator?"Logical_And_Operator":"Logical_Or_Operator"),e.\u0275\u0275attribute("id","filter-attr-1-{{state.lineId}}")}}function Dg(i,t){1&i&&e.\u0275\u0275element(0,"span",13),2&i&&e.\u0275\u0275property("localize","All")}function Tg(i,t){1&i&&e.\u0275\u0275element(0,"span",13),2&i&&e.\u0275\u0275property("localize","Any")}function Ig(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("mousedown",function(a){return a.stopPropagation()})("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.toggleCollapsedState())}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",r.state.isCollapsed?"pbi-glyph-arrowright":"pbi-glyph-chevrondownsmall")("disabled",!r.editable),e.\u0275\u0275attribute("aria-expanded",!r.state.isCollapsed)("aria-labelledby","filter-attr-3-{{state.lineId}}")}}function Rg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,Eg,1,3,"span",9),e.\u0275\u0275elementStart(2,"pbi-dropdown",10),e.\u0275\u0275listener("valueChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.toggleAndOperator())}),e.\u0275\u0275elementStart(3,"pbi-dropdown-trigger"),e.\u0275\u0275template(4,Dg,1,1,"span",11),e.\u0275\u0275template(5,Tg,1,1,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"pbi-dropdown-item",12),e.\u0275\u0275element(7,"span",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"pbi-dropdown-item",12),e.\u0275\u0275element(9,"span",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(10,"span",14),e.\u0275\u0275template(11,Ig,1,4,"button",15),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isRoot),e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("value",r.state.isAndOperator),e.\u0275\u0275attribute("id","filter-attr-2-{{state.lineId}}"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.state.isAndOperator),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isAndOperator),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","All"),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","Any"),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","Grouped_Filters")("ngClass",r.editable?null:"disabled"),e.\u0275\u0275attribute("id","filter-attr-3-{{state.lineId}}"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isRoot)}}function Ag(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",25),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("pbiTooltip",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n," ")}}function Fg(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",26),e.\u0275\u0275pipe(1,"titlecase"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"titlecase"),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("pbiTooltip",e.\u0275\u0275pipeBind1(1,3,e.\u0275\u0275pipeBind1(2,5,n))),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,7,e.\u0275\u0275pipeBind1(5,9,n))," ")}}var kg=function(){return{dropdownWidth:200}},Bg=function(){return{showFullContent:!0}};function Lg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",18)(1,"pbi-dropdown",19,20),e.\u0275\u0275listener("valueChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.updateFilterColumn(a))}),e.\u0275\u0275elementStart(3,"pbi-dropdown-trigger"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Ag,2,3,"pbi-dropdown-item",21),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"pbi-dropdown",22),e.\u0275\u0275listener("valueChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.applyOperator(a))}),e.\u0275\u0275elementStart(7,"pbi-dropdown-trigger"),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"titlecase"),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(11,Fg,6,11,"pbi-dropdown-item",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"rls-filter-value",24),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("options",e.\u0275\u0275pureFunction0(19,kg))("value",r.state.columnName)("ngClass",r.state.isNested?"indented-column":"normal-column"),e.\u0275\u0275attribute("id","filter-attr-1-{{state.lineId}}"),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",r.state.columnName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.state.columns),e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("options",e.\u0275\u0275pureFunction0(20,Bg))("value",r.state.operatorName),e.\u0275\u0275attribute("id","filter-attr-2-{{state.lineId}}"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(9,15,e.\u0275\u0275pipeBind1(10,17,r.state.operatorName))," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.state.operatorOptions),e.\u0275\u0275advance(1),e.\u0275\u0275property("state",r.state.value)("editable",r.editable)}}var Ng=function(t,n){return{"dark-gray-bg":t,"no-background":n}};function Ug(i,t){if(1&i&&e.\u0275\u0275element(0,"span",13),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("localize","RLS_Filters_Subheader_New")("ngClass",n.editable?null:"disabled")}}function zg(i,t){if(1&i&&e.\u0275\u0275elementContainer(0,14),2&i){e.\u0275\u0275nextContext(2);var n=e.\u0275\u0275reference(6);e.\u0275\u0275property("ngTemplateOutlet",n)}}function jg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",10),e.\u0275\u0275listener("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.handleKeydown(a))}),e.\u0275\u0275elementStart(1,"div",2)(2,"div",11),e.\u0275\u0275template(3,Ug,1,2,"span",12),e.\u0275\u0275template(4,zg,1,1,"ng-container",3),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("tabindex",0===r.state.lineId?0:-1),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.state.isRoot),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.state.isGroup)}}function Wg(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",18),e.\u0275\u0275elementContainer(1,14),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext(2);var n=e.\u0275\u0275reference(6);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",n)}}var Hg=function(t,n,r){return{disabled:t,selected:n,"dark-gray-bg":r}};function Gg(i,t){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",21),2&i){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(1,Hg,!n.editable,n.state.isSelected,n.state.isSelected))}}var pa=function(t){return{"dark-gray-bg":t}};function Kg(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",19),e.\u0275\u0275elementContainerStart(1,14),e.\u0275\u0275template(2,Gg,1,5,"pbi-icon",20),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&i){var n=e.\u0275\u0275nextContext(2),r=e.\u0275\u0275reference(8);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(3,pa,n.state.isSelected)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",r),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.state.isRoot&&!n.state.isLevelEnd)}}var mr=function(t){return{"indented-column":t}};function $g(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275listener("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.handleKeydown(a))})("contextmenu",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.openContextMenu(a))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementStart(6,"div",2)(7,"div",11),e.\u0275\u0275template(8,Wg,2,1,"div",16),e.\u0275\u0275template(9,Kg,3,5,"div",17),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(20,mr,r.state.isNested))("cdkDragData",r.state.filterId-1)("cdkDragLockAxis","y")("cdkDragDisabled",r.state.isRoot||!r.editable),e.\u0275\u0275attribute("aria-label",r.state.isGroup?e.\u0275\u0275pipeBind1(1,10,r.state.parentAndOperator?"Logical_And_Operator":"Logical_Or_Operator")+" "+e.\u0275\u0275pipeBind1(2,12,r.state.isAndOperator?"All":"Any")+" "+e.\u0275\u0275pipeBind1(3,14,"Grouped_Filters"):e.\u0275\u0275pipeBind1(4,16,"Generic_Row")+" "+r.state.lineId+" "+r.state.columnName+" "+e.\u0275\u0275pipeBind1(5,18,r.state.operatorName)+" "+(null==r.state.value||null==r.state.value.value?null:r.state.value.value.join(", ")))("aria-level",r.state.level)("aria-checked",r.state.isGroup?"":r.state.isSelected)("filter-id",r.state.filterId),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",r.state.isGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isGroup)}}function Qg(i,t){if(1&i&&e.\u0275\u0275elementContainer(0,14),2&i){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(10);e.\u0275\u0275property("ngTemplateOutlet",n)}}function Xg(i,t){if(1&i&&e.\u0275\u0275elementContainer(0,14),2&i){e.\u0275\u0275nextContext();var n=e.\u0275\u0275reference(12);e.\u0275\u0275property("ngTemplateOutlet",n)}}function Yg(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",31),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.toggleCollapsedState())})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.handleInputKeydown(a))}),e.\u0275\u0275element(1,"tri-svg-icon",32),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("disabled",!r.editable),e.\u0275\u0275attribute("aria-expanded",!r.state.isCollapsed)("aria-disabled",!r.editable),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",r.state.isCollapsed?"chevron_right_20_regular":"chevron_down_20_regular")}}function Zg(i,t){if(1&i&&e.\u0275\u0275element(0,"span",33),2&i){var n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngClass",n.editable?null:"disabled")("localize",n.state.parentAndOperator?"Logical_And_Operator":"Logical_Or_Operator"),e.\u0275\u0275attribute("id","filter-attr-1-{{state.lineId}}")}}function Jg(i,t){1&i&&e.\u0275\u0275element(0,"span",29),2&i&&e.\u0275\u0275property("localize","All")}function qg(i,t){1&i&&e.\u0275\u0275element(0,"span",29),2&i&&e.\u0275\u0275property("localize","Any")}function eh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",23),e.\u0275\u0275template(1,Yg,2,4,"button",24),e.\u0275\u0275template(2,Zg,1,3,"span",25),e.\u0275\u0275elementStart(3,"pbi-dropdown",26),e.\u0275\u0275listener("valueChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.toggleAndOperator())})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.handleInputKeydown(a))}),e.\u0275\u0275elementStart(4,"pbi-dropdown-trigger"),e.\u0275\u0275template(5,Jg,1,1,"span",27),e.\u0275\u0275template(6,qg,1,1,"span",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"pbi-dropdown-item",28),e.\u0275\u0275element(8,"span",29),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"pbi-dropdown-item",28),e.\u0275\u0275element(10,"span",29),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(11,"span",30),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isRoot),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isRoot),e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("value",r.state.isAndOperator),e.\u0275\u0275attribute("id","filter-attr-2-{{state.lineId}}"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.state.isAndOperator),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isAndOperator),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","All"),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","Any"),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","Grouped_Filters")("ngClass",r.editable?null:"disabled"),e.\u0275\u0275attribute("id","filter-attr-3-{{state.lineId}}")}}function th(i,t){if(1&i&&e.\u0275\u0275template(0,eh,12,14,"div",22),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",n.state.isGroup)}}var nh=function(t){return{selected:t}};function ih(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-checkbox",48),e.\u0275\u0275listener("click",function(a){return a.stopPropagation()})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.handleInputKeydown(a))})("onChange",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.select())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(6,nh,r.state.isSelected))("disabled",!r.editable)("checked",r.state.isSelected)("ariaLabel",r.state.columnName+" "+e.\u0275\u0275pipeBind1(1,4,r.state.operatorName)+" "+(null==r.state.value||null==r.state.value.value?null:r.state.value.value.join(", ")))}}function rh(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",49),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("pbiTooltip",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n," ")}}function oh(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",50),e.\u0275\u0275pipe(1,"titlecase"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"titlecase"),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n)("pbiTooltip",e.\u0275\u0275pipeBind1(1,3,e.\u0275\u0275pipeBind1(2,5,n))),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,7,e.\u0275\u0275pipeBind1(5,9,n))," ")}}var ah=function(){return{dropdownWidth:200}},lh=function(){return{showFullContent:!0}},ga=function(t,n){return{disabled:t,selected:n}};function sh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",35),e.\u0275\u0275projection(1),e.\u0275\u0275template(2,ih,2,8,"pbi-checkbox",36),e.\u0275\u0275elementStart(3,"pbi-dropdown",37,38),e.\u0275\u0275listener("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.handleInputKeydown(a))})("valueChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.updateFilterColumn(a))}),e.\u0275\u0275elementStart(5,"pbi-dropdown-trigger"),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,rh,2,3,"pbi-dropdown-item",39),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"pbi-dropdown",40),e.\u0275\u0275listener("valueChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.applyOperator(a))})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.handleInputKeydown(a))}),e.\u0275\u0275elementStart(9,"pbi-dropdown-trigger"),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"titlecase"),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,oh,6,11,"pbi-dropdown-item",41),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",42),e.\u0275\u0275listener("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.handleInputKeydown(a))}),e.\u0275\u0275element(15,"rls-filter-value",43),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"button",44),e.\u0275\u0275listener("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.handleInputKeydown(a))})("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.group())}),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275element(19,"tri-svg-icon",45),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"button",46),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.deleteFilterItem())})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.handleInputKeydown(a))}),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275element(23,"tri-svg-icon",47),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(38,pa,r.state.isSelected)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.state.isRoot&&!r.state.isLevelEnd),e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("options",e.\u0275\u0275pureFunction0(40,ah))("value",r.state.columnName)("aria-labelledby","rlsColumnHeaderLabel"),e.\u0275\u0275attribute("id","filter-attr-1-{{state.lineId}}"),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",r.state.columnName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.state.columns),e.\u0275\u0275advance(1),e.\u0275\u0275property("isDisabled",!r.editable)("options",e.\u0275\u0275pureFunction0(41,lh))("value",r.state.operatorName)("ngClass",e.\u0275\u0275pureFunction1(42,mr,r.state.isNested))("aria-labelledby","rlsOperatorHeaderLabel"),e.\u0275\u0275attribute("id","filter-attr-2-{{state.lineId}}"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(11,26,e.\u0275\u0275pipeBind1(12,28,r.state.operatorName))," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.state.operatorOptions),e.\u0275\u0275advance(2),e.\u0275\u0275property("state",r.state.value)("editable",r.editable),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(44,ga,!r.editable,r.state.isSelected))("triTooltip",e.\u0275\u0275pipeBind1(17,30,"Group_Action"))("disabled",!r.state.canGroup),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(18,32,"Group_Action")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(47,ga,!r.editable,r.state.isSelected))("triTooltip",e.\u0275\u0275pipeBind1(21,34,"Delete")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(22,36,"Delete"))}}function ch(i,t){if(1&i&&e.\u0275\u0275template(0,sh,24,50,"div",34),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",!n.state.isGroup)}}function dh(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"div",52)(1,"div",53),e.\u0275\u0275element(2,"span",29),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",54),e.\u0275\u0275element(4,"span",29),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",54),e.\u0275\u0275element(6,"span",29),e.\u0275\u0275elementEnd()()),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(4,mr,!n.state.isRoot)),e.\u0275\u0275advance(2),e.\u0275\u0275property("localize","Column"),e.\u0275\u0275advance(2),e.\u0275\u0275property("localize","Condition"),e.\u0275\u0275advance(2),e.\u0275\u0275property("localize","Value")}}function uh(i,t){if(1&i&&e.\u0275\u0275template(0,dh,7,6,"div",51),2&i){var n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",n.state.showColumnHeader)}}function ph(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",55)(1,"button",56),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.addSiblingFilter())})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.handleKeydown(a))}),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275element(4,"tri-svg-icon",57)(5,"span",58),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",r.state.isNested?"pbi-fluent-button-new indented-column":"pbi-fluent-button-new")("triTooltip",e.\u0275\u0275pipeBind1(2,4,"New")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,6,"New")),e.\u0275\u0275advance(4),e.\u0275\u0275property("localize","New")}}var gh=["*"],hh=function(i){function t(n,r,o,a,l,s,c){var u=i.call(this,n,r,o,a,l,s,c)||this;return u.componentFactoryResolver=n,u.filterPaneState=r,u.document=o,u.pbiMenuService=a,u.localizationService=l,u.rlsService=s,u.filterLineStateService=c,u}return(0,d.__extends)(t,i),t.prototype.deleteFilterItem=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return[4,this.filterPaneState.deleteFilter(this.state.filterId)];case 1:return n.sent(),[2]}})})},t.prototype.group=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return[4,this.filterPaneState.group(this.state.filterId)];case 1:return n.sent(),[2]}})})},t.prototype.addSiblingFilter=function(){var n=this;this.filterPaneState.addSiblingFilter(this.state.filterId),this.filterPaneState.state$.pipe((0,nt.q)(1)).subscribe(function(r){var o,a=_.maxBy(r.lineItems,"filterId").filterId;null===(o=n.document.querySelector(".filter-list-item[filter-id='".concat(a,"'] .edit-mode input")))||void 0===o||o.focus()})},t.prototype.handleKeydown=function(n){var r,o,a,l,s,c,u=n.target,f=u.closest("rls-new-filter-line");switch(n.key){case"ArrowUp":if(n.preventDefault(),u.classList.contains("new-button")){f.querySelector(".filter-list-item").focus();break}if(u.classList.contains("filter-list-item")){var v=null===(r=f.previousElementSibling)||void 0===r?void 0:r.querySelector(".new-button");if(v){v.focus();break}null===(a=null===(o=f.previousElementSibling)||void 0===o?void 0:o.querySelector(".filter-list-item"))||void 0===a||a.focus()}break;case"ArrowDown":if(n.preventDefault(),u.classList.contains("new-button")||u.classList.contains("filter-list-item")){var C=null===(l=u.nextElementSibling)||void 0===l?void 0:l.querySelector(".new-button");if(C){C.focus();break}null===(c=null===(s=f.nextElementSibling)||void 0===s?void 0:s.querySelector(".filter-list-item"))||void 0===c||c.focus()}break;case"Enter":u.classList.contains("filter-list-item")&&(n.preventDefault(),u.querySelector("input, button").focus());break;case" ":u.classList.contains("filter-list-item")&&!this.state.isRoot&&!this.state.isGroup&&(n.preventDefault(),n.stopPropagation(),this.select());break;case"Tab":n.preventDefault(),n.shiftKey?this.document.querySelector("#add-new-filter-button, #filter-pane-select-all-button, #filter-pane-add-button").focus():this.document.querySelector("#okButton:enabled, #cancelButton").focus()}},t.prototype.handleInputKeydown=function(n){var r,o=n.target;switch(n.key){case"Escape":n.preventDefault(),n.stopPropagation(),o.closest(".filter-list-item").focus();break;case"Tab":n.stopPropagation(),n.shiftKey?o.classList.contains("pbi-checkbox-input")?(n.preventDefault(),o.closest(".filter-expression").querySelector(".inline-delete-button").focus()):o.classList.contains("arrow-button")&&(n.preventDefault(),o.closest(".filter-group").querySelector(".and-dropdown .popout-button").focus()):o.classList.contains("inline-delete-button")?(n.preventDefault(),o.closest(".filter-expression").querySelector(".pbi-checkbox-input").focus()):o.parentElement.classList.contains("and-dropdown")&&(n.preventDefault(),null===(r=o.closest(".filter-group").querySelector(".arrow-button"))||void 0===r||r.focus())}},t.\u0275fac=function(r){return new(r||t)(e.\u0275\u0275directiveInject(e.ComponentFactoryResolver),e.\u0275\u0275directiveInject(On),e.\u0275\u0275directiveInject(ie.DOCUMENT),e.\u0275\u0275directiveInject(ca.o),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(Pn))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["rls-new-filter-line"]],inputs:{editable:"editable",state:"state",totalItems:"totalItems"},features:[e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:gh,decls:15,vars:6,consts:[["class","pbi-focus-outline filter-list-item",3,"tabindex","keydown",4,"ngIf"],["prevent-focus-loss","false","tabindex","-1","role","treeitem","cdkDrag","","class","pbi-focus-outline filter-list-item","cdkDragBoundary",".filter-viewport",3,"ngClass","cdkDragData","cdkDragLockAxis","cdkDragDisabled","keydown","contextmenu",4,"ngIf"],[1,"filter-item-container"],[3,"ngTemplateOutlet",4,"ngIf"],["groupContainer",""],["itemContainer",""],["groupHeader",""],["newButton",""],["id","rlsColumnHeaderLabel","hidden","","aria-hidden","true",3,"localize"],["id","rlsOperatorHeaderLabel","hidden","","aria-hidden","true",3,"localize"],[1,"pbi-focus-outline","filter-list-item",3,"tabindex","keydown"],[1,"filter-item-div"],["class","filter-group-text","id","filter-description",3,"localize","ngClass",4,"ngIf"],["id","filter-description",1,"filter-group-text",3,"localize","ngClass"],[3,"ngTemplateOutlet"],["prevent-focus-loss","false","tabindex","-1","role","treeitem","cdkDrag","","cdkDragBoundary",".filter-viewport",1,"pbi-focus-outline","filter-list-item",3,"ngClass","cdkDragData","cdkDragLockAxis","cdkDragDisabled","keydown","contextmenu"],["class","group-item",4,"ngIf"],["class","line-item",3,"ngClass",4,"ngIf"],[1,"group-item"],[1,"line-item",3,"ngClass"],["name","gripper-dots-vertical","size","small","class","gripper","cdkDragHandle","",3,"ngClass",4,"ngIf"],["name","gripper-dots-vertical","size","small","cdkDragHandle","",1,"gripper",3,"ngClass"],["class","filter-group",4,"ngIf"],[1,"filter-group"],["tri-button","","class","pbi-fluent-button-new arrow-button","type","button",3,"disabled","click","keydown",4,"ngIf"],["class","filter-group-text logic-and-or",3,"ngClass","localize",4,"ngIf"],[1,"and-dropdown","pbi-focus-outline",3,"isDisabled","value","valueChange","keydown"],[3,"localize",4,"ngIf"],[3,"value"],[3,"localize"],[1,"filter-group-text",3,"localize","ngClass"],["tri-button","","type","button",1,"pbi-fluent-button-new","arrow-button",3,"disabled","click","keydown"],["tri-svg-icon-20","",1,"chevron-icon",3,"name"],[1,"filter-group-text","logic-and-or",3,"ngClass","localize"],["class","filter-expression",3,"ngClass",4,"ngIf"],[1,"filter-expression",3,"ngClass"],["class","select-checkbox",3,"ngClass","disabled","checked","ariaLabel","click","keydown","onChange",4,"ngIf"],["role","select",1,"column-dropdown","pbi-focus-outline",3,"isDisabled","options","value","aria-labelledby","keydown","valueChange"],["colDropDown",""],["pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipShowDelay","1000","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip",4,"ngFor","ngForOf"],["role","select",1,"operator-dropdown","pbi-focus-outline",3,"isDisabled","options","value","ngClass","aria-labelledby","valueChange","keydown"],["pbiTooltipShowDelay","1000","pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip",4,"ngFor","ngForOf"],[1,"filter-value",3,"keydown"],[3,"state","editable"],["tri-button","","id","group-filter-button","type","button","triTooltipAlwaysShow","true",1,"pbi-fluent-button-new","inline-button",3,"ngClass","triTooltip","disabled","keydown","click"],["tri-svg-icon-20","","name","group_20_regular",1,"group-icon"],["tri-button","","type","button","triTooltipAlwaysShow","true",1,"pbi-fluent-button-new","inline-button","inline-delete-button",3,"ngClass","triTooltip","click","keydown"],["tri-svg-icon-20","","name","delete_20_regular",1,"delete-icon"],[1,"select-checkbox",3,"ngClass","disabled","checked","ariaLabel","click","keydown","onChange"],["pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipShowDelay","1000","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip"],["pbiTooltipShowDelay","1000","pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip"],["class","filter-line-header",3,"ngClass",4,"ngIf"],[1,"filter-line-header",3,"ngClass"],[1,"header","column-header"],[1,"header"],[1,"new-button-container"],["tri-button","","type","button","triTooltipAlwaysShow","true","tabindex","-1",1,"new-button",3,"ngClass","triTooltip","click","keydown"],["tri-svg-icon-20","","name","add_20_regular",1,"add-icon"],[1,"filter-pane-button-text-new",3,"localize"]],template:function(r,o){1&r&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275template(0,jg,5,3,"div",0),e.\u0275\u0275template(1,$g,10,22,"div",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275template(3,Qg,1,1,"ng-container",3),e.\u0275\u0275template(4,Xg,1,1,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,th,1,1,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(7,ch,1,1,"ng-template",null,5,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(9,uh,1,1,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(11,ph,6,8,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275element(13,"span",8)(14,"span",9)),2&r&&(e.\u0275\u0275property("ngIf",o.state.isRoot),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!o.state.isRoot),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.state.isGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.state.isLastItem),e.\u0275\u0275advance(9),e.\u0275\u0275property("localize","Column"),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","Condition"))},dependencies:[jt.Zt,jt.Bh,bt.X,ie.NgClass,ie.NgForOf,ie.NgIf,ie.NgTemplateOutlet,si.v,tn.H,ci.r,di._,tn.T,hr._,kt.V,Vt.M,ri.Z,ua,Tt,ie.TitleCasePipe,_i.Y],styles:['.filter-list-item[_ngcontent-%COMP%]{outline-offset:-2px;width:538px}.filter-list-item[_ngcontent-%COMP%]:hover   .gripper[_ngcontent-%COMP%], .filter-list-item[_ngcontent-%COMP%]:focus   .gripper[_ngcontent-%COMP%], .filter-list-item[_ngcontent-%COMP%]:focus-within   .gripper[_ngcontent-%COMP%], .filter-list-item[_ngcontent-%COMP%]:hover   .inline-button[_ngcontent-%COMP%], .filter-list-item[_ngcontent-%COMP%]:focus   .inline-button[_ngcontent-%COMP%], .filter-list-item[_ngcontent-%COMP%]:focus-within   .inline-button[_ngcontent-%COMP%]{opacity:1}.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.filter-item-container[_ngcontent-%COMP%]{align-items:start;width:546px}.filter-item-container.no-background[_ngcontent-%COMP%]{background-color:none}.filter-item-container.normal-column[_ngcontent-%COMP%]{margin-left:36px}.filter-item-container.dark-gray-bg[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground3)}.filter-item-container[_ngcontent-%COMP%]:hover   .gripper[_ngcontent-%COMP%], .filter-item-container[_ngcontent-%COMP%]:focus   .gripper[_ngcontent-%COMP%], .filter-item-container[_ngcontent-%COMP%]:hover   .inline-button[_ngcontent-%COMP%], .filter-item-container[_ngcontent-%COMP%]:focus   .inline-button[_ngcontent-%COMP%]{opacity:1}.filter-item-container[_ngcontent-%COMP%]:hover   .line-item[_ngcontent-%COMP%], .filter-item-container[_ngcontent-%COMP%]:focus   .line-item[_ngcontent-%COMP%], .filter-item-container[_ngcontent-%COMP%]:hover   .filter-expression[_ngcontent-%COMP%], .filter-item-container[_ngcontent-%COMP%]:focus   .filter-expression[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground6)}.filter-item-container[_ngcontent-%COMP%]   .filter-item-div[_ngcontent-%COMP%]{display:flex;width:538px;padding:4px}.filter-group[_ngcontent-%COMP%]{flex-grow:1;display:flex;align-items:center}.line-item[_ngcontent-%COMP%], .filter-expression[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:var(--colorNeutralBackground2);border-radius:2px}.line-item.dark-gray-bg[_ngcontent-%COMP%], .filter-expression.dark-gray-bg[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground3)}.indented-column[_ngcontent-%COMP%]{margin-left:36px}.gripper[_ngcontent-%COMP%]{cursor:move;margin-left:4px}.gripper.disabled[_ngcontent-%COMP%]{forced-color-adjust:none;color:var(--colorNeutralForegroundDisabled)}.inline-button[_ngcontent-%COMP%], .gripper[_ngcontent-%COMP%]{opacity:0;color:var(--colorNeutralForeground2);background-color:inherit}.inline-button.selected[_ngcontent-%COMP%], .gripper.selected[_ngcontent-%COMP%], .inline-button[_ngcontent-%COMP%]:focus, .gripper[_ngcontent-%COMP%]:focus, .inline-button[_ngcontent-%COMP%]:focus-within, .gripper[_ngcontent-%COMP%]:focus-within, .inline-button[_ngcontent-%COMP%]:hover, .gripper[_ngcontent-%COMP%]:hover{opacity:1}.inline-button[_ngcontent-%COMP%]{height:32px;padding:0 6px;align-items:center;gap:4px;display:flex}.select-checkbox[_ngcontent-%COMP%], .gripper[_ngcontent-%COMP%]{width:20px;height:20px}.select-checkbox[_ngcontent-%COMP%]{margin:10px 8px 10px 6px}.filter-group-text[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:14px;margin-right:8px;vertical-align:bottom;color:var(--colorNeutralForeground1);line-height:32px}.filter-group-text.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.filter-group-text.logic-and-or[_ngcontent-%COMP%]{width:25.2px;text-align:center}.and-dropdown[_ngcontent-%COMP%]{margin-right:4px;width:80px}.expand-collapse-button[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1);border:none;background:transparent;margin:0 8px 0 auto;padding:0;line-height:32px;width:12px;font-size:12px}.expand-collapse-button[_ngcontent-%COMP%]:disabled{color:var(--colorNeutralForegroundDisabled)}.filter-line-header[_ngcontent-%COMP%]{padding-left:36px;display:flex;flex-direction:row;border-bottom:1px solid var(--colorNeutralStroke2)}.filter-line-header[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{width:118px;margin-right:8px;height:32px;display:flex;align-items:center}.filter-line-header[_ngcontent-%COMP%]   .header.column-header[_ngcontent-%COMP%]{margin-left:30px}.filter-line-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{justify-content:center;align-items:center;color:var(--colorNeutralForeground1);font-size:14px;font-style:normal;font-weight:600;line-height:20px}.new-button-container[_ngcontent-%COMP%]{padding-left:72px;gap:10px}.column-dropdown[_ngcontent-%COMP%]{width:118px}.operator-dropdown[_ngcontent-%COMP%]{margin:0 8px;width:118px}.cdk-drag-preview[_ngcontent-%COMP%]{z-index:99999!important;box-sizing:border-box;border-radius:4px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0;vertical-align:middle;text-align:center}.cdk-drag-animating[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   [tri-button][_ngcontent-%COMP%], [_nghost-%COMP%]   .pbi-fluent-button-new[_ngcontent-%COMP%]{border:none}[_nghost-%COMP%]     .pbi-fluent-button-new.inline-button tri-svg-icon:hover, [_nghost-%COMP%]     .pbi-fluent-button-new.inline-button svg:hover{background-color:var(--colorNeutralBackground3)}[_nghost-%COMP%]     .pbi-fluent-button-new.arrow-button:hover, [_nghost-%COMP%]     .pbi-fluent-button-new.new-button:hover{background-color:var(--colorNeutralBackground1)}[_nghost-%COMP%]     .single-tag-container{margin:0 4px 0 0;max-width:160px}[_nghost-%COMP%]     .multi-tag-container{max-width:160px}[_nghost-%COMP%]     .advanced-control{height:32px}']}),t}(function(){function i(t,n,r,o,a,l,s){this.componentFactoryResolver=t,this.filterPaneState=n,this.document=r,this.pbiMenuService=o,this.localizationService=a,this.rlsService=l,this.filterLineStateService=s}return i.prototype.handleKeydown=function(t){switch(t.key){case"Tab":return void t.stopPropagation();case"Escape":t.preventDefault(),t.stopPropagation(),t.target.closest("rls-filter-line").focus()}},i.prototype.openContextMenu=function(t){var n=this;if(t.preventDefault(),t.stopPropagation(),!this.shouldHideMenu()){var r=t.target;this.pbiMenuService.open({menu:this.getMenu(),origin:{element:r,x:0===t.x?r.getBoundingClientRect().x:t.x,y:0===t.y?r.getBoundingClientRect().y:t.y},componentFactoryResolver:this.componentFactoryResolver,closeOnButtonClick:!0,menuMode:wt.Kb.Compact}).onButtonClick$.pipe((0,nt.q)(1)).subscribe(function(a){n.menuItemClick(a)})}},i.prototype.select=function(){this.filterPaneState.selectFilter(this.state.filterId)},i.prototype.toggleAndOperator=function(){var t=this;this.executeWithGroupState(function(n,r){t.rlsService.setGroupOperator(n.selectedRole,n.selectedTable,r.filterId,!r.isAndOperator)})},i.prototype.toggleCollapsedState=function(){var t=this;this.executeWithGroupState(function(n,r){t.rlsService.toggleCollapsedState(n.selectedRole,n.selectedTable,r.filterId,!r.isCollapsed)})},i.prototype.updateFilterColumn=function(t){var n=this;this.executeWithFilterState(function(r,o){var a=n.filterLineStateService.getFilterOperators(n.state.tableName,t,o.operatorName);n.rlsService.updateFilter(r.selectedRole,r.selectedTable,o.filterId,t,a.selected)})},i.prototype.applyOperator=function(t){var n=this;this.executeWithFilterState(function(r,o){n.rlsService.updateFilter(r.selectedRole,r.selectedTable,o.filterId,o.columnName,t)})},i.prototype.executeWithFilterState=function(t){t(this.filterPaneState.getCurrentState(),this.state)},i.prototype.executeWithGroupState=function(t){t(this.filterPaneState.getCurrentState(),this.state)},i.prototype.findNextSiblingIndex=function(){for(var t=this.filterPaneState.getCurrentState().lineItems,n=this.state.lineId+1;n<t.length;n++)if(t[n].level===this.state.level)return n;return-1},i.prototype.findPrevSiblingIndex=function(){for(var t=this.filterPaneState.getCurrentState().lineItems,n=this.state.lineId-1;n>0;n--)if(t[n].level===this.state.level)return n;return-1},i.prototype.getMenu=function(){var t=this.state.lineId,n={items:[]},r={items:[]},o={id:0,type:wt.iB.SubMenu,text:this.localizationService.get("ItemAction_Move"),menu:r};n.items.push(o);var a={id:1,type:wt.iB.Button,text:this.localizationService.get("ItemAction_Move_Up"),disabled:t<=1},l={id:2,type:wt.iB.Button,text:this.localizationService.get("ItemAction_Move_Down"),disabled:t===this.totalItems-1||this.isLastGroupFilter()},s={id:3,type:wt.iB.Button,text:this.localizationService.get("ItemAction_Move_Top"),disabled:t<=1},c={id:4,type:wt.iB.Button,text:this.localizationService.get("ItemAction_Move_Bottom"),disabled:t===this.totalItems-1||this.isLastGroupFilter()};return r.items.push(a,l,s,c),n},i.prototype.getParent=function(){return this.rlsService.getSameParent(this.state.roleName,this.state.tableName,[this.state.filterId])},i.prototype.isLastGroupFilter=function(){var t=this;if(!this.isGroup(this.state))return!1;var n=this.getParent();return n.children.findIndex(function(r){return r.id===t.state.filterId})===n.children.length-1},i.prototype.isGroup=function(t){return t.isGroup},i.prototype.shouldHideMenu=function(){var t=this.filterPaneState.getCurrentState().lineItems.filter(function(n){return n.level<=2}).length;return 0===this.state.lineId||this.state.level<=2&&t<=2},i.prototype.menuItemClick=function(t){var n=this.filterPaneState.getCurrentState();switch(t.id){case 2:var r=void 0;if(this.isGroup(this.state)&&!this.state.isCollapsed){var o=this.findNextSiblingIndex();r=-1!==o?o:this.state.lineId}else r=this.state.lineId+1;this.moveFilterItem(this.state.filterId,n.lineItems[r].filterId);break;case 1:if(r=void 0,this.isGroup(this.state)){var a=this.findPrevSiblingIndex();r=-1!==a?a:this.state.lineId}else r=this.state.lineId-1;this.moveFilterItem(this.state.filterId,n.lineItems[r].filterId);break;case 3:this.moveFilterItem(this.state.filterId,n.lineItems[1].filterId);break;case 4:this.moveFilterItem(this.state.filterId,n.lineItems[this.totalItems-1].filterId)}},i.prototype.moveFilterItem=function(t,n){if(n!==t){var r=this.filterPaneState.getCurrentState(),o=r.lineItems.filter(function(a){return a.isSelected&&!a.isGroup}).map(function(a){return a.filterId});o.find(function(a){return a===t})&&this.filterPaneState.clearSelectedFilters(),this.rlsService.moveFilterItem(r.selectedRole,r.selectedTable,o,n,t)}},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(e.ComponentFactoryResolver),e.\u0275\u0275directiveInject(On),e.\u0275\u0275directiveInject(ie.DOCUMENT),e.\u0275\u0275directiveInject(ca.o),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(Pn))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-filter-line"]],inputs:{editable:"editable",state:"state",totalItems:"totalItems"},decls:6,vars:14,consts:[["prevent-focus-loss","false","role","treeitem","cdkDrag","",1,"pbi-focus-outline","filter-list-item",3,"cdkDragData","cdkDragLockAxis","cdkDragDisabled","contextmenu","keydown"],[1,"filter-item-container",3,"ngClass"],["name","gripper-dots-vertical","size","small","class","gripper","cdkDragHandle","",3,"ngClass",4,"ngIf"],["class","select-checkbox",3,"ngClass","disabled","checked","click","onChange",4,"ngIf"],["class","filter-group",4,"ngIf"],["class","filter-expression",4,"ngIf"],["name","gripper-dots-vertical","size","small","cdkDragHandle","",1,"gripper",3,"ngClass"],[1,"select-checkbox",3,"ngClass","disabled","checked","click","onChange"],[1,"filter-group"],["class","filter-group-text logic-and-or",3,"ngClass","localize",4,"ngIf"],[1,"and-dropdown","pbi-focus-outline",3,"isDisabled","value","valueChange"],[3,"localize",4,"ngIf"],[3,"value"],[3,"localize"],[1,"filter-group-text",3,"localize","ngClass"],["class","expand-collapse-button glyphicon glyph-small group-arrow",3,"ngClass","disabled","mousedown","click",4,"ngIf"],[1,"filter-group-text","logic-and-or",3,"ngClass","localize"],[1,"expand-collapse-button","glyphicon","glyph-small","group-arrow",3,"ngClass","disabled","mousedown","click"],[1,"filter-expression"],[1,"column-dropdown","pbi-focus-outline",3,"isDisabled","options","value","ngClass","valueChange"],["colDropDown",""],["pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipShowDelay","1000","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip",4,"ngFor","ngForOf"],[1,"operator-dropdown","pbi-focus-outline",3,"isDisabled","options","value","valueChange"],["pbiTooltipShowDelay","1000","pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip",4,"ngFor","ngForOf"],[3,"state","editable"],["pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipShowDelay","1000","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip"],["pbiTooltipShowDelay","1000","pbiTooltipPosition","after","pbiTooltipCheckChildren","true","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",3,"value","pbiTooltip"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("contextmenu",function(a){return r.openContextMenu(a)})("keydown",function(a){return r.handleKeydown(a)}),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275template(2,xg,1,4,"pbi-icon",2),e.\u0275\u0275template(3,Og,1,5,"pbi-checkbox",3),e.\u0275\u0275template(4,Rg,12,14,"div",4),e.\u0275\u0275template(5,Lg,13,21,"div",5),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275property("cdkDragData",r.state.filterId)("cdkDragLockAxis","y")("cdkDragDisabled",r.state.isRoot||!r.editable),e.\u0275\u0275attribute("aria-labelledby","filter-attr-1-{{state.lineId}} filter-attr-2-{{state.lineId}} filter-attr-3-{{state.lineId}}")("aria-level",r.state.level)("filter-id",r.state.filterId),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(11,Ng,r.state.isNested,r.state.isRoot)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isRoot),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isRoot),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.state.isGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.state.isGroup))},dependencies:[jt.Zt,jt.Bh,bt.X,ie.NgClass,ie.NgForOf,ie.NgIf,si.v,tn.H,ci.r,di._,tn.T,hr._,kt.V,ua,Tt,ie.TitleCasePipe],styles:['.filter-list-item[_ngcontent-%COMP%]{outline-offset:-2px}.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.filter-item-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:4px;min-height:40px;align-items:start;background-color:var(--colorNeutralBackground2)}.filter-item-container.no-background[_ngcontent-%COMP%]{background-color:none}.filter-item-container.dark-gray-bg[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground3)}.filter-item-container[_ngcontent-%COMP%]:hover   .select-checkbox[_ngcontent-%COMP%], .filter-item-container[_ngcontent-%COMP%]:focus   .select-checkbox[_ngcontent-%COMP%]{opacity:1}.filter-group[_ngcontent-%COMP%]{flex-grow:1;display:flex;align-items:center}.filter-expression[_ngcontent-%COMP%]{display:flex;align-items:start}.gripper[_ngcontent-%COMP%]{margin-top:10px;cursor:move;margin-left:8px}.gripper.disabled[_ngcontent-%COMP%]{forced-color-adjust:none;color:var(--colorNeutralForegroundDisabled)}.select-checkbox[_ngcontent-%COMP%]{margin:10px 8px 10px 6px;width:20px;height:20px;opacity:0}.select-checkbox.selected[_ngcontent-%COMP%], .select-checkbox[_ngcontent-%COMP%]:focus, .select-checkbox[_ngcontent-%COMP%]:focus-within{opacity:1}.filter-group-text[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:14px;margin-right:8px;vertical-align:bottom;color:var(--colorNeutralForeground1);line-height:32px}.filter-group-text.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.filter-group-text.logic-and-or[_ngcontent-%COMP%]{width:25.2px;text-align:center}.and-dropdown[_ngcontent-%COMP%]{margin:4px 4px 4px 0;width:80px}.expand-collapse-button[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1);border:none;background:transparent;margin:0 8px 0 auto;padding:0;line-height:32px;width:12px;font-size:12px}.expand-collapse-button[_ngcontent-%COMP%]:disabled{color:var(--colorNeutralForegroundDisabled)}.column-dropdown[_ngcontent-%COMP%]{width:100px}.column-dropdown.indented-column[_ngcontent-%COMP%]{margin:4px 4px 4px 33px}.column-dropdown.normal-column[_ngcontent-%COMP%]{margin:4px 4px 4px 0}.operator-dropdown[_ngcontent-%COMP%]{margin:4px 4px 4px 0;width:100px}.cdk-drag-preview[_ngcontent-%COMP%]{z-index:99999!important;box-sizing:border-box;border-radius:4px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0;vertical-align:middle;text-align:center}.cdk-drag-animating[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}  .advanced-control{height:32px}']}),i}());function mh(i,t){if(1&i&&e.\u0275\u0275element(0,"rls-new-filter-line",16),2&i){var n=t.$implicit,r=e.\u0275\u0275nextContext(2).ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("editable",o.editable)("totalItems",r.lineItems.length)("state",n)}}function fh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275listener("cdkDropListDropped",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.drop(l))}),e.\u0275\u0275template(1,mh,1,3,"rls-new-filter-line",15),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("cdkDropListData",r.lineItems),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.lineItems)("ngForTrackBy",o.trackByFilterId)}}function vh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"div",1),e.\u0275\u0275listener("keydown",function(l){e.\u0275\u0275restoreView(n);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.handleToolbarKeydown(l))}),e.\u0275\u0275elementStart(2,"button",2),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.add())}),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275element(5,"tri-svg-icon",3)(6,"span",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",5),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.selectOrDeselectAll())}),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275element(12,"tri-svg-icon",6)(13,"span",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.deleteFilterItem())}),e.\u0275\u0275pipe(15,"translate"),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275element(17,"tri-svg-icon",8)(18,"span",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.group())}),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275element(22,"tri-svg-icon",10)(23,"span",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.ungroup())}),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275pipe(26,"translate"),e.\u0275\u0275element(27,"tri-svg-icon",12)(28,"span",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(29,fh,2,3,"div",13),e.\u0275\u0275elementEnd()}if(2&i){var r=t.ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275attribute("aria-labelledby",o.labelledBy),e.\u0275\u0275advance(1),e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(3,27,"New"))("disabled",!o.editable||!r.isTableSelected||!r.selectedRole),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,29,"New"))("aria-disabled",!o.editable||!r.isTableSelected||!r.selectedRole),e.\u0275\u0275advance(4),e.\u0275\u0275property("localize","New"),e.\u0275\u0275advance(1),e.\u0275\u0275property("triTooltip",r.canSelectAll?e.\u0275\u0275pipeBind1(8,31,"SelectAll"):e.\u0275\u0275pipeBind1(9,33,"DeselectAll"))("disabled",!o.editable||r.lineItems.length<=1),e.\u0275\u0275attribute("aria-label",r.canSelectAll?e.\u0275\u0275pipeBind1(10,35,"SelectAll"):e.\u0275\u0275pipeBind1(11,37,"DeselectAll"))("aria-disabled",!o.editable||r.lineItems.length<=1),e.\u0275\u0275advance(6),e.\u0275\u0275property("localize",r.canSelectAll?"SelectAll":"DeselectAll"),e.\u0275\u0275advance(1),e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(15,39,"Delete"))("disabled",!o.editable||!r.canPressDelete),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(16,41,"Delete"))("aria-disabled",!o.editable||!r.canPressDelete),e.\u0275\u0275advance(4),e.\u0275\u0275property("localize","Delete"),e.\u0275\u0275advance(1),e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(20,43,"Group_Action"))("disabled",!o.editable||!r.canGroup),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(21,45,"Group_Action"))("aria-disabled",!o.editable||!r.canGroup),e.\u0275\u0275advance(4),e.\u0275\u0275property("localize","Group_Action"),e.\u0275\u0275advance(1),e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(25,47,"Ungroup"))("disabled",!o.editable||!r.canUngroup),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(26,49,"Ungroup"))("aria-disabled",!o.editable||!r.canUngroup),e.\u0275\u0275advance(4),e.\u0275\u0275property("localize","Ungroup"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.lineItems.length>1)}}var _h=function(){function i(t,n,r,o){this.stateService=t,this.lineStateService=n,this.rlsService=r,this.document=o,this.editable=!0,this.state$=this.stateService.state$}return i.prototype.ngAfterViewInit=function(){this.stateService.initialize()},i.prototype.selectOrDeselectAll=function(){this.currentState.canSelectAll?this.stateService.selectAllFilters():this.stateService.clearSelectedFilters()},i.prototype.drop=function(t){var n=t.currentIndex,r=t.previousIndex;n++,r++,this.moveFilterItem(n,r)},i.prototype.moveFilterItem=function(t,n){if(t!==n){var r=this.currentState,o=r.lineItems.filter(function(a){return a.isSelected&&!a.isGroup}).map(function(a){return a.filterId});o.find(function(a){return a===r.lineItems[n].filterId})&&this.stateService.clearSelectedFilters(),this.rlsService.moveFilterItem(r.selectedRole,r.selectedTable,o,r.lineItems[t].filterId,r.lineItems[n].filterId)}},i.prototype.add=function(){var t=this,n=this.currentState;this.rlsService.addFilter(n.selectedRole,n.selectedTable),this.state$.pipe((0,nt.q)(1)).subscribe(function(r){var o,a=_.maxBy(r.lineItems,"filterId").filterId;null===(o=t.document.querySelector(".filter-list-item[filter-id='".concat(a,"'] .edit-mode input")))||void 0===o||o.focus()})},i.prototype.deleteFilterItem=function(){var t=this.currentState,n=this.getSelectedItems(!0);this.stateService.clearSelectedFilters(),this.rlsService.deleteFilterItems(t.selectedRole,t.selectedTable,n),this.rlsService.rebalanceFilterGroups(t.selectedRole,t.selectedTable)},i.prototype.group=function(){var t=this.currentState,n=this.getSelectedItems(!0);this.stateService.clearSelectedFilters(),this.rlsService.group(t.selectedRole,t.selectedTable,n)},i.prototype.ungroup=function(){var t=this.currentState,n=this.getSelectedItems(!0);this.stateService.clearSelectedFilters(),this.rlsService.ungroup(t.selectedRole,t.selectedTable,n)},i.prototype.getSelectedItems=function(t){if(t){var n=this.currentState;return this.rlsService.getSelectedItemsSorted(n.selectedRole,n.selectedTable,this.getSelectedItems(!1)).map(function(o){return o.id})}return this.currentState.lineItems.filter(function(o){return o.isSelected}).map(function(o){return o.filterId})},i.prototype.trackByFilterId=function(t,n){return n.filterId},i.prototype.handleToolbarKeydown=function(t){switch(t.key){case"ArrowRight":var n=this.getFocusableNextElementSibling(t.target.nextElementSibling);n?.focus();break;case"ArrowLeft":var r=this.getFocusablePreviousElementSibling(t.target.previousElementSibling);r?.focus();break;case"Tab":t.shiftKey&&(t.preventDefault(),t.stopPropagation(),document.querySelector(".switch-view-button").focus())}},i.prototype.getFocusableNextElementSibling=function(t){return t&&t.disabled?this.getFocusableNextElementSibling(t.nextElementSibling):t},i.prototype.getFocusablePreviousElementSibling=function(t){return t&&t.disabled?this.getFocusablePreviousElementSibling(t.previousElementSibling):t},Object.defineProperty(i.prototype,"currentState",{get:function(){return this.stateService.getCurrentState()},enumerable:!1,configurable:!0}),i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(On),e.\u0275\u0275directiveInject(Pn),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(ie.DOCUMENT))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-filter-pane"]],inputs:{editable:"editable",labelledBy:"labelledBy"},features:[e.\u0275\u0275ProvidersFeature([On,Pn,sa])],decls:2,vars:3,consts:[[4,"ngIf"],["role","toolbar",1,"filter-pane-buttons-new",3,"keydown"],["tri-button","","size","small","appearance","subtle","triTooltipAlwaysShow","true","id","add-new-filter-button","type","button",1,"pbi-fluent-button-new",3,"triTooltip","disabled","click"],["tri-svg-icon-20","","name","add_20_regular",1,"add-icon"],[1,"filter-pane-button-text-new",3,"localize"],["tri-button","","size","small","appearance","subtle","triTooltipAlwaysShow","true","id","select-all-filter-button","type","button","tabindex","-1",1,"pbi-fluent-button-new",3,"triTooltip","disabled","click"],["tri-svg-icon-20","","name","select_all_on_20_regular",1,"select-all-icon"],["tri-button","","size","small","appearance","subtle","triTooltipAlwaysShow","true","id","delete-filter-button","type","button","tabindex","-1",1,"pbi-fluent-button-new",3,"triTooltip","disabled","click"],["tri-svg-icon-20","","name","delete_20_regular",1,"delete-icon"],["tri-button","","size","small","appearance","subtle","triTooltipAlwaysShow","true","id","group-filter-button","type","button","tabindex","-1",1,"pbi-fluent-button-new",3,"triTooltip","disabled","click"],["tri-svg-icon-20","","name","group_20_regular",1,"group-icon"],["tri-button","","size","small","appearance","subtle","triTooltipAlwaysShow","true","id","ungroup-filter-button","type","button","tabindex","-1",1,"pbi-fluent-button-new",3,"triTooltip","disabled","click"],["tri-svg-icon-20","","name","group_dismiss_20_regular",1,"ungroup-icon"],["class","filter-viewport","cdkDropList","","role","tree",3,"cdkDropListData","cdkDropListDropped",4,"ngIf"],["cdkDropList","","role","tree",1,"filter-viewport",3,"cdkDropListData","cdkDropListDropped"],[3,"editable","totalItems","state",4,"ngFor","ngForOf","ngForTrackBy"],[3,"editable","totalItems","state"]],template:function(n,r){1&n&&(e.\u0275\u0275template(0,vh,30,51,"div",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,r.state$))},dependencies:[jt.Wj,bt.X,ie.NgForOf,ie.NgIf,Vt.M,ri.Z,hh,Tt,ie.AsyncPipe],styles:['.filter-pane-buttons[_ngcontent-%COMP%]{border-bottom:1px solid #E1DFDD;display:flex;justify-content:space-between;width:100%}.filter-pane-buttons[_ngcontent-%COMP%]   .filter-pane-button-text[_ngcontent-%COMP%]{margin-left:8px}.filter-pane-buttons[_ngcontent-%COMP%]   button.pbi-glyph-select-all[_ngcontent-%COMP%]{padding-left:0}.filter-pane-button[_ngcontent-%COMP%]{color:var(--colorNeutralForeground1);border:none;background:transparent;overflow:hidden;padding:6px 0 0}.filter-pane-button[_ngcontent-%COMP%]:disabled{color:var(--colorNeutralForegroundDisabled);background-color:transparent}.filter-pane-button[_ngcontent-%COMP%]:disabled   .filter-pane-button-text[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.filter-pane-button.collapse-icon[_ngcontent-%COMP%]{margin:0 8px 0 auto}.filter-pane-button-text[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:14px;margin-right:8px;white-space:nowrap;vertical-align:bottom;color:var(--colorNeutralForeground1)}.filter-pane-button-text.logic-and-or[_ngcontent-%COMP%]{width:25.2px;text-align:center}.filter-viewport[_ngcontent-%COMP%]{margin-top:8px;width:100%;height:335px;overflow-y:scroll;overflow-x:hidden}.list-sub-head[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);line-height:0px;padding:4px 0;color:var(--colorNeutralForeground1)}.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.filter-pane-buttons-new[_ngcontent-%COMP%]{display:flex;align-items:flex-start;padding-bottom:4px;border-bottom:1px solid #E1DFDD;width:100%}.filter-pane-button-text-new[_ngcontent-%COMP%]{display:flex;padding:0 0 2px 2px;align-items:flex-start}'],changeDetection:0}),i}();function bh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-message-bar",22),e.\u0275\u0275listener("hideMessageBar",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.emitHideMessageBar())}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("viewModel",r.messageBarModel)}}function yh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",23),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.tryToSwitchView())}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext().ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",o.disableUI||!r.selectedRole||!r.selectedTable),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.switchModeMessage)}}function Ch(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"rls-dax-pane",24),e.\u0275\u0275listener("verifyDax",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.verifyDax())}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("editable",!r.disableUI)}}function Sh(i,t){if(1&i&&e.\u0275\u0275element(0,"rls-filter-pane",15),2&i){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("editable",!n.disableUI)("labelledBy","filter-data-header")}}function Mh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",1)(2,"span",2),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,bh,1,1,"tri-message-bar",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",4)(7,"div",5),e.\u0275\u0275element(8,"h3",6),e.\u0275\u0275elementStart(9,"div",7)(10,"button",8),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.createRole())}),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275element(13,"tri-svg-icon",9)(14,"span",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(15,"rls-role-list",11,12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",13),e.\u0275\u0275element(18,"h3",14)(19,"rls-table-list",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",16)(21,"div",17),e.\u0275\u0275element(22,"h3",18),e.\u0275\u0275template(23,yh,3,2,"button",19),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(24,Ch,1,1,"rls-dax-pane",20),e.\u0275\u0275template(25,Sh,1,2,"rls-filter-pane",21),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=t.ngIf,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",o.disableUI?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,21,"RLS_Editor_CreatePane_Message")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.showMessageBar),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",o.disableUI?"disabled":null),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(11,23,"New_Role"))("disabled",o.disableUI),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(12,25,"New_Role")),e.\u0275\u0275advance(3),e.\u0275\u0275property("name","add_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",o.disableUI?"disabled":null)("localize","New"),e.\u0275\u0275advance(1),e.\u0275\u0275property("disableUI",o.disableUI)("labelledBy","create-pane-roles-list"),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize","Select_Tables")("ngClass",o.disableUI?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275property("editable",!o.disableUI)("labelledBy","rls-table-header"),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize","RLS_Filters_Header")("ngClass",o.disableUI?"disabled":null),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.canSwitchMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.daxMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.daxMode)}}var wh=function(){function i(t,n,r,o){this.stateService=t,this.rlsService=n,this.localizationService=r,this.dialogService=o,this.hideMessageBar=new e.EventEmitter,this.verify=new e.EventEmitter,this.state$=this.stateService.state$}return i.prototype.tryToSwitchView=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return(t=this.rlsService.getSelectedTable())&&t.isDaxEditorOpen?[4,this.rlsService.validateDaxCanBeSynced()]:[3,5];case 1:return o.sent()?[3,3]:[4,this.confirmSwitchAndLoseRLS()];case 2:if(!o.sent())return[2];o.label=3;case 3:return[4,this.rlsService.switchToFilters()];case 4:return o.sent(),[3,6];case 5:this.rlsService.switchToDax(),o.label=6;case 6:return[2]}})})},i.prototype.verifyDax=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){return this.verify.emit(),[2]})})},i.prototype.emitHideMessageBar=function(){this.hideMessageBar.emit()},i.prototype.confirmSwitchAndLoseRLS=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,gn.Z.buildOKCancelDialog({title:this.localizationService.get("RLS_Switch_Default"),message:this.localizationService.format("RLS_Switch_Warning")},"ConfirmSwitchToRLSDialogTitle",this.dialogService,this.localizationService)];case 1:return[4,r.sent().afterClosed().toPromise()];case 2:return[2,1===r.sent()]}})})},i.prototype.ngAfterViewInit=function(){this.stateService.initialize()},i.prototype.refresh=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(t){switch(t.label){case 0:return[4,this.rlsService.refresh()];case 1:return t.sent(),[2]}})})},i.prototype.createRole=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t;return(0,d.__generator)(this,function(n){switch(n.label){case 0:return[4,this.rlsService.createRole()];case 1:return t=n.sent(),this.rlsService.selectRole(t.name),[2]}})})},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(ea),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(Sn.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["rls-create-pane"]],inputs:{disableUI:"disableUI",messageBarModel:"messageBarModel",showMessageBar:"showMessageBar"},outputs:{hideMessageBar:"hideMessageBar",verify:"verify"},features:[e.\u0275\u0275ProvidersFeature([ea])],decls:2,vars:3,consts:[[4,"ngIf"],[1,"create-pane-title-bar"],["id","create-pane-message",1,"tab-title",3,"ngClass"],["class","save-message-bar",3,"viewModel","hideMessageBar",4,"ngIf"],[1,"create-pane-content"],[1,"role-column"],["localize","EditScorecardSettings_Role_Settings_Roles","id","create-pane-roles-list",1,"list-title","pbi-focus-outline",3,"ngClass"],[1,"left-align"],["tri-button","","pbiTooltipAlwaysShow","true","pbiTooltipCaretSize","small",1,"pbi-fluent-button","create-role-button",3,"pbiTooltip","disabled","click"],["tri-svg-icon-20","",3,"name"],[1,"button-text",3,"ngClass","localize"],[3,"disableUI","labelledBy"],["roleList",""],[1,"table-column"],["id","rls-table-header",1,"list-title",3,"localize","ngClass"],[3,"editable","labelledBy"],[1,"dax-column"],[1,"dax-title-row"],["id","filter-data-header","aria-describedby","filter-description",1,"list-title","pbi-focus-outline",3,"localize","ngClass"],["tri-button","","class","pbi-fluent-button switch-view-button",3,"disabled","click",4,"ngIf"],[3,"editable","verifyDax",4,"ngIf"],[3,"editable","labelledBy",4,"ngIf"],[1,"save-message-bar",3,"viewModel","hideMessageBar"],["tri-button","",1,"pbi-fluent-button","switch-view-button",3,"disabled","click"],[3,"editable","verifyDax"]],template:function(n,r){1&n&&(e.\u0275\u0275template(0,Mh,26,27,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&n&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,r.state$))},dependencies:[bt.X,ie.NgClass,ie.NgIf,kt.V,Mn.h,Vt.M,Zp,ig,Jo,_h,Tt,ie.AsyncPipe],styles:['.create-pane-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:436px}.role-column[_ngcontent-%COMP%], .table-column[_ngcontent-%COMP%]{border-right:1px solid var(--gray-40, #E1DFDD);padding-right:16px;box-sizing:border-box;width:196px;overflow:hidden;display:flex;flex-direction:column}.table-column[_ngcontent-%COMP%]{width:212px;padding:0 16px}.dax-column[_ngcontent-%COMP%]{width:610px;padding-left:16px;box-sizing:border-box;flex-grow:2;overflow-y:hidden}.dax-title-row[_ngcontent-%COMP%]{width:100%;height:32px}.list-title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-regular, 400);margin:0 0 8px;line-height:28px;float:left;color:var(--colorNeutralForeground1)}.left-align[_ngcontent-%COMP%]{align-self:flex-start}.create-role-button[_ngcontent-%COMP%]{padding:3.5px 16px;margin-bottom:16px;box-sizing:border-box;border-radius:var(--borderRadiusSmall)}.button-text[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:14px;margin-inline-start:1.5px;direction:ltr;white-space:nowrap;vertical-align:middle;line-height:30px;color:var(--colorNeutralForeground1)}.switch-view-button[_ngcontent-%COMP%]{padding:2px 16px;box-sizing:border-box;border-radius:var(--borderRadiusSmall);float:right}.tab-title[_ngcontent-%COMP%]{margin:16px 0;display:block;line-height:22px;font-size:var(--lg-font-size, 16px)}.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}tri-message-bar[_ngcontent-%COMP%]{margin-bottom:16px}'],changeDetection:0}),i}(),xh=["createTab"],Ph=["assignTab"],Oh=["createPane"],Eh=["assignPane"],Dh=["tabGroup"];function Th(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-pivot",3)(1,"pbi-pivot-item",4,5),e.\u0275\u0275listener("select",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.selectView(a.views.CreatePane))})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.handleCreateAssignTabKeyDown(a))}),e.\u0275\u0275element(3,"span",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"pbi-pivot-item",7,8),e.\u0275\u0275listener("select",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.selectView(a.views.AssignPane))})("keydown",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.handleCreateAssignTabKeyDown(a))}),e.\u0275\u0275element(6,"span",9),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("selected",r.activeView===r.views.CreatePane)("disabled",r.isDisabled),e.\u0275\u0275advance(3),e.\u0275\u0275property("selected",r.activeView===r.views.AssignPane)("disabled",r.isDisabled)}}function Ih(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"rls-create-pane",10,11),e.\u0275\u0275listener("verify",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.verifyContent())})("hideMessageBar",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.hideNotifications())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disableUI",r.isDisabled)("showMessageBar",r.showMessageBar)("messageBarModel",r.messageBarModel)}}function Rh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"rls-assign-pane",12,13),e.\u0275\u0275listener("hideMessageBar",function(){e.\u0275\u0275restoreView(n);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.hideNotifications())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disableUI",r.isDisabled)("showMessageBar",r.showMessageBar)("messageBarModel",r.messageBarModel)}}var En=function(i){return i.CreatePane="CreatePane",i.AssignPane="AssignPane",i}({}),ln=function(i){return i[i.Success=0]="Success",i[i.FailedDaxConversion=1]="FailedDaxConversion",i[i.FailedToSave=2]="FailedToSave",i}({}),Ah=function(){function i(t,n,r,o,a,l,s,c,u,f,v,C,E){var z=this;this.localizationService=t,this.notificationBarService=n,this.telemetryService=r,this.eventAggregationService=o,this.rlsItemVisitor=a,this.dataModelService=l,this.daxToRLSService=s,this.rlsService=u,this.rolesService=f,this.modelService=v,this.changeDetector=C,this.zone=E,this.showMessageBar=!1,this.setRLSRolePermissionsEventInfo=[],this.isDisabled=!1,this.isInitialized=!1,this.activeView=En.CreatePane,this.views=En,this.validatePaneChange=new e.EventEmitter(!1),this.subscriptions=new F.w,this.allowDax=c.daxPane,this.allowAssign=c.assignPane,this.initializeHighContrastRules(),this.subscriptions.add(this.eventAggregationService.subscribe("UIBlockingStateChangeEvent",function(ce){z.isDisabled=ce.isBlocking,z.changeDetector.detectChanges()}))}return i.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){t.zone.run(function(){t.refreshRoles().then(function(){t.isInitialized=!0,t.calculateNotifications(),t.changeDetector.detectChanges()})})},0),this.allowAssign&&(this.assignTab.nativeElement.querySelector("button").tabIndex=-1)},i.prototype.ngOnDestroy=function(){this.hideNotifications(),this.subscriptions.unsubscribe()},i.prototype.refreshRoles=function(){var t,n,r,o;return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(a){switch(a.label){case 0:return[4,this.rlsService.refresh()];case 1:return a.sent(),[4,!(null===(t=this.createPane)||void 0===t||!t.refresh)&&(null===(n=this.createPane)||void 0===n?void 0:n.refresh())];case 2:return a.sent(),[4,!(null===(r=this.assignPane)||void 0===r||!r.refresh)&&(null===(o=this.assignPane)||void 0===o?void 0:o.refresh())];case 3:return a.sent(),[2]}})})},i.prototype.selectView=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return t===this.activeView?[2]:(this.hideNotifications(),n={newView:t,cancel:new up.B},this.validatePaneChange.emit(n),[4,n.cancel.promise]);case 1:return o.sent()||(this.activeView=t,this.changeDetector.detectChanges()),[2]}})})},i.prototype.saveContent=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n,r,o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return this.hideNotifications(),t=!0,[4,this.rlsService.isRlsDirty()];case 1:return n=a.sent(),this.activeView===En.CreatePane&&n?[4,this.saveCreatePane()]:[3,3];case 2:switch(r=a.sent()){case ln.Success:this.showNotificationMessage(3,this.localizationService.get("RLS_Editor_CreatePane_Success_Message")),this.rlsService.markSaveComplete();break;case ln.FailedDaxConversion:this.showNotificationMessage(1,this.localizationService.get("RLS_Editor_CreatePane_Error_Message"));break;case ln.FailedToSave:this.showNotificationMessage(1,this.localizationService.get("RLS_Editor_Save_Error_Message"))}return[2,r===ln.Success];case 3:return this.activeView===En.AssignPane&&this.assignPane.unsavedAssignPaneChangesExist()?(o=t)?[4,this.assignPane.save()]:[3,5]:[3,6];case 4:o=a.sent(),a.label=5;case 5:return(t=o)?(this.showNotificationMessage(3,this.localizationService.get("RLS_Editor_AssignPane_Assign_Success_Message")),[2,!0]):(this.showNotificationMessage(1,this.localizationService.get("RLS_Editor_Save_Error_Message")),[2,!1]);case 6:return[2,t]}})})},i.prototype.verifyContent=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n,r,o,a=this;return(0,d.__generator)(this,function(l){switch(l.label){case 0:return this.hideNotifications(),[4,this.rlsService.isRlsDirty()];case 1:return t=l.sent(),this.activeView===En.CreatePane&&t?[4,this.setTablePermissionsPayload(n={})]:[3,4];case 2:return l.sent(),r=[],this.updateModelRoleSchemaChanges(Object.keys(n),r),this.updateTablePermissionSchemaChanges(n,r),this.telemetryService.logEvent(Xo,{rolePermissions:this.setRLSRolePermissionsEventInfo.map(function(s){return JSON.stringify(s)}),daxVerification:!0}),[4,this.rolesService.verifyRoleSettings(r)];case 3:(o=l.sent()).length||this.showNotificationMessage(1,this.localizationService.get("RLS_Editor_Verify_Error_Message")),o.forEach(function(s){return(0,d.__awaiter)(a,void 0,void 0,function(){var c=this;return(0,d.__generator)(this,function(u){return s.tablePermissions.forEach(function(f){return(0,d.__awaiter)(c,void 0,void 0,function(){var v;return(0,d.__generator)(this,function(C){switch(C.label){case 0:return[4,this.rlsService.setDaxOnTable(s.name,f.name,f.filterExpression,null!==(v=f.errorMessage)&&void 0!==v?v:"",!0)];case 1:return C.sent(),[2]}})})}),[2]})})}),l.label=4;case 4:return[2]}})})},i.prototype.handleCreateAssignTabKeyDown=function(t){switch(t.key){case"ArrowRight":this.assignTab.nativeElement.querySelector("button").focus();break;case"ArrowLeft":this.createTab.nativeElement.querySelector("button").focus();break;case"Tab":t.shiftKey&&this.createTab.nativeElement.querySelector("button").focus()}},i.prototype.saveCreatePane=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return this.allowDax||this.rlsService.validateFilters()?[4,this.setTablePermissionsPayload(t={})]:[2,ln.FailedDaxConversion];case 1:return o.sent(),n=[],this.updateModelRoleSchemaChanges(Object.keys(t),n),this.updateTablePermissionSchemaChanges(t,n),this.telemetryService.logEvent(Xo,{rolePermissions:this.setRLSRolePermissionsEventInfo.map(function(a){return JSON.stringify(a)}),daxVerification:!1}),[4,this.rolesService.applyRoleSettings(n)];case 2:return o.sent()?[2,ln.Success]:[2,ln.FailedToSave]}})})},i.prototype.setTablePermissionsPayload=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return this.setRLSRolePermissionsEventInfo=[],[4,Promise.all(this.rlsService.getRoles().map(function(o){return(0,d.__awaiter)(n,void 0,void 0,function(){var a,s,u,f,c=this;return(0,d.__generator)(this,function(v){switch(v.label){case 0:return a=[],[4,this.rlsService.isRlsDirty()];case 1:return v.sent()?(s=null===(f=null===(u=this.modelService.model)||void 0===u?void 0:u.roles)||void 0===f?void 0:f.findByName(o.name),[4,Promise.all(o.roleTables.filter(function(C){var E,z;return C.tableFilters.length||(null===(z=null===(E=s?.tablePermissions)||void 0===E?void 0:E.findByName(C.tableName))||void 0===z?void 0:z.filterExpression)||C.isDaxEditorOpen}).map(function(C){return(0,d.__awaiter)(c,void 0,void 0,function(){var E,z,ce;return(0,d.__generator)(this,function(le){switch(le.label){case 0:return C.isDaxEditorOpen?[4,this.createPermission(C.daxExpression,C.tableName)]:[3,2];case 1:return ce=le.sent(),this.setRLSRolePermissionsEventInfo.push({entrypoint:"DaxEditor",anonymizedFilterExpression:ce.anonymizedFilterExpression}),a.push(ce),[3,4];case 2:return E=this.modelService.model.tables.findByName(C.tableName),z=C.tableFilters.length?this.rlsItemVisitor.convertFilterGroup(o.name,C.filtersGroup.id,E,!this.allowDax):null,[4,this.createPermission(z,C.tableName)];case 3:ce=le.sent(),this.setRLSRolePermissionsEventInfo.push({entrypoint:"FiltersView",anonymizedFilterExpression:ce.anonymizedFilterExpression}),a.push(ce),le.label=4;case 4:return[2]}})})}))]):[3,3];case 2:v.sent(),v.label=3;case 3:return t[o.name]=a.length>0?{setRolePermissions:{permissions:a,roleName:o.name,schema:null}}:void 0,[2]}})})}))];case 1:return r.sent(),[2]}})})},i.prototype.updateModelRoleSchemaChanges=function(t,n,r){var a={};this.modelService.model.roles.forEach(function(C){a[C.name]=!0});for(var l=0,s=t;l<s.length;l++){var u=this.rlsService.getRole(c=s[l]);a[c]&&!u.isRenamed?delete a[c]:u.isRenamed?(n.push({roleRename:{after:c,before:u.renamedFrom,schema:null}}),delete a[u.renamedFrom]):n.push({roleCreate:{permission:"Read",roleName:c,schema:null}})}if(!r)for(var f=0,v=Object.keys(a);f<v.length;f++){var c;n.push({roleDelete:{roleName:c=v[f],schema:null}})}},i.prototype.updateTablePermissionSchemaChanges=function(t,n){Object.keys(t).forEach(function(r){var o=t[r];o&&n.push(o)})},i.prototype.createPermission=function(t,n){return(0,d.__awaiter)(this,void 0,void 0,function(){var r;return(0,d.__generator)(this,function(o){switch(o.label){case 0:return[4,this.daxToRLSService.getAnonymizedExpression(t,n,this.dataModelService.getDataModel())];case 1:return r=o.sent(),[2,{filterExpression:t||null,anonymizedFilterExpression:r,tableName:n}]}})})},i.prototype.initializeHighContrastRules=function(){},i.prototype.calculateNotifications=function(){this.hideNotifications(),this.rlsService.getRoles().find(function(n){return!!n.roleTables.find(function(r){return!r.isDaxEditorOpen&&r.filtersGroup.hasErrors})})&&this.showNotificationMessage(1,this.localizationService.get("RLS_Editor_CreatePane_ParsingError"))},i.prototype.showNotificationMessage=function(t,n){this.showMessageBar=!0,this.messageBarModel={bannerType:t,message:n,allowDismiss:!0}},i.prototype.hideNotifications=function(){this.showMessageBar=!1,this.messageBarModel=void 0},i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(No.S),e.\u0275\u0275directiveInject(Mt.y0),e.\u0275\u0275directiveInject(w.x),e.\u0275\u0275directiveInject(pe),e.\u0275\u0275directiveInject(Ke.n),e.\u0275\u0275directiveInject(y),e.\u0275\u0275directiveInject(B.m),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(pp.f),e.\u0275\u0275directiveInject(Oe.b),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(e.NgZone))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["RLS-editor"]],viewQuery:function(n,r){if(1&n&&(e.\u0275\u0275viewQuery(xh,5,e.ElementRef),e.\u0275\u0275viewQuery(Ph,5,e.ElementRef),e.\u0275\u0275viewQuery(Oh,5),e.\u0275\u0275viewQuery(Eh,5),e.\u0275\u0275viewQuery(Dh,5)),2&n){var o=void 0;e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.createTab=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.assignTab=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.createPane=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.assignPane=o.first),e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.tabGroup=o.first)}},outputs:{validatePaneChange:"validatePaneChange"},decls:5,vars:4,consts:[["dock","top","class","pbi-pivot-small",4,"ngIf"],["dock","center",3,"ngSwitch"],[4,"ngSwitchCase"],["dock","top",1,"pbi-pivot-small"],["id","createPaneTab",3,"selected","disabled","select","keydown"],["createTab",""],["localize","Create_ButtonText"],["id","assignPaneTab",3,"selected","disabled","select","keydown"],["assignTab",""],["localize","Assign"],["role","tabpanel","aria-labelledby","createPaneTab",3,"disableUI","showMessageBar","messageBarModel","verify","hideMessageBar"],["createPane",""],["role","tabpanel","aria-labelledby","assignPaneTab",3,"disableUI","showMessageBar","messageBarModel","hideMessageBar"],["assignPane",""]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"docking-container"),e.\u0275\u0275template(1,Th,7,4,"pbi-pivot",0),e.\u0275\u0275elementStart(2,"div",1),e.\u0275\u0275template(3,Ih,3,3,"ng-container",2),e.\u0275\u0275template(4,Rh,3,3,"ng-container",2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.allowAssign),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",r.activeView),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",r.views.CreatePane),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",r.views.AssignPane))},dependencies:[pr,bt.X,ie.NgIf,ie.NgSwitch,ie.NgSwitchCase,mp,fp,Gp,wh],styles:["[_nghost-%COMP%]     .notification-bar{position:inherit;margin-bottom:16px}[_nghost-%COMP%]     .inner-button:after{bottom:-5px!important}[_nghost-%COMP%]     .inner-button{margin:0 4px}[_nghost-%COMP%]     pbi-pivot-item button{height:30px;margin:0;padding:11px 4px}[_nghost-%COMP%]     pbi-pivot-item button.disabled{background-color:transparent}"]}),i}(),Fh=["rlsEditor"],Lt=function(i){return i[i.SaveApproved=0]="SaveApproved",i[i.DontSave=1]="DontSave",i[i.Cancelled=2]="Cancelled",i[i.NoSaveNeeded=3]="NoSaveNeeded",i}({}),ha=function(){function i(t,n,r,o,a,l){var c,s=this;this.modelingDialogService=t,this.modelService=n,this.templateDialogPayload=r,this.rlsService=o,this.rowLevelSecurity=a,this.eventAggregationService=l,this.ngOnDestroySubject$=new pn.xQ,this.subscriptions=new F.w,this.uiBlockingHandler=function(u){s.templateDialogPayload.setSpinnerDisplay(u.isBlocking),s.templateDialogPayload.setOkButtonState(!0)},this.initializeHighContrastRules(),this.subscriptions.add(this.eventAggregationService.subscribe("UIBlockingStateChangeEvent",this.uiBlockingHandler)),this.subscriptions.add(null===(c=this.modelService)||void 0===c?void 0:c.modelChange$.subscribe(function(){return(0,d.__awaiter)(s,void 0,void 0,function(){var u;return(0,d.__generator)(this,function(f){switch(f.label){case 0:return[4,null===(u=this.rlsEditor)||void 0===u?void 0:u.refreshRoles()];case 1:return f.sent(),[2]}})})}))}return i.prototype.ngOnInit=function(){var t=this;this.templateDialogPayload.onOkButtonClick=function(){return(0,d.__awaiter)(t,void 0,void 0,function(){return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,this.rlsEditor.saveContent()];case 1:return r.sent()||this.templateDialogPayload.setOkButtonState(!1),[2]}})})},this.templateDialogPayload.onCancelButtonClick=function(){return(0,d.__awaiter)(t,void 0,void 0,function(){return(0,d.__generator)(this,function(n){switch(n.label){case 0:return[4,this.handleUnsavedChanges()];case 1:return n.sent(),[2]}})})},(0,wr.T)(this.rlsService.onChange,this.rowLevelSecurity.roleMembersChanged).pipe((0,qe.R)(this.ngOnDestroySubject$)).subscribe(function(){return(0,d.__awaiter)(t,void 0,void 0,function(){var n;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,this.unsavedChangesExist()];case 1:return n=r.sent(),this.templateDialogPayload.setOkButtonState(!n),[2]}})})}),this.uiBlockingHandler({isBlocking:!1})},i.prototype.ngOnDestroy=function(){this.ngOnDestroySubject$.next(),this.ngOnDestroySubject$.complete(),this.subscriptions.unsubscribe()},i.prototype.validatePaneChange=function(t){var n;return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(l){switch(l.label){case 0:return[4,this.confirmSaveChanges(!1)];case 1:switch(l.sent()){case Lt.DontSave:return[3,2];case Lt.SaveApproved:return[3,4];case Lt.Cancelled:return[3,6];case Lt.NoSaveNeeded:return[3,7]}return[3,8];case 2:return[4,null===(n=this.rlsEditor)||void 0===n?void 0:n.refreshRoles()];case 3:return l.sent(),t.cancel.resolve(!1),[3,8];case 4:return[4,this.rlsEditor.saveContent()];case 5:return l.sent()?t.cancel.resolve(!1):(t.cancel.resolve(!0),this.templateDialogPayload.setOkButtonState(!1)),[3,8];case 6:return t.cancel.resolve(!0),[3,8];case 7:return t.cancel.resolve(!1),[3,8];case 8:return[2]}})})},i.prototype.handleUnsavedChanges=function(){return(0,d.__awaiter)(this,void 0,void 0,function(){var t;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,this.confirmSaveChanges(!0)];case 1:return(t=r.sent())!==Lt.SaveApproved?[3,3]:[4,this.rlsEditor.saveContent()];case 2:return r.sent()?this.templateDialogPayload.closeDialogFromConsumer():this.templateDialogPayload.setOkButtonState(!1),[3,4];case 3:(t===Lt.DontSave||t===Lt.NoSaveNeeded)&&this.templateDialogPayload.closeDialogFromConsumer(),r.label=4;case 4:return[2]}})})},i.prototype.initializeHighContrastRules=function(){},i.prototype.confirmSaveChanges=function(t){return(0,d.__awaiter)(this,void 0,void 0,function(){var n,o;return(0,d.__generator)(this,function(a){switch(a.label){case 0:return n=t?Zt.l.CloseDialog:Zt.l.ChangeTab,[4,this.unsavedChangesExist()];case 1:return a.sent()?[4,this.modelingDialogService.openRLSEditorConfirmationDialog(n)]:[3,3];case 2:return 1===(o=a.sent())?[2,Lt.SaveApproved]:2===o?[2,Lt.DontSave]:[2,Lt.Cancelled];case 3:return[2,Lt.NoSaveNeeded]}})})},i.prototype.handleShiftTab=function(t){var n=t.target.id;if("okButton"===n||"cancelButton"===n&&document.querySelector("#okButton").disabled){var r=document.querySelector(".filter-list-item, .editor-host-container");r&&(t.preventDefault(),t.stopPropagation(),r.focus())}},i.prototype.unsavedChangesExist=function(){var t,n,r;return(0,d.__awaiter)(this,void 0,void 0,function(){return(0,d.__generator)(this,function(a){switch(a.label){case 0:return[4,this.rlsService.isRlsDirty()];case 1:return[2,(a.sent()??!1)||null!==(r=null===(n=null===(t=this.rlsEditor)||void 0===t?void 0:t.assignPane)||void 0===n?void 0:n.unsavedAssignPaneChangesExist())&&void 0!==r&&r]}})})},i.dialogNameKey=Rt.TU,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(Zt.e),e.\u0275\u0275directiveInject(Oe.b),e.\u0275\u0275directiveInject(at.x),e.\u0275\u0275directiveInject(ot),e.\u0275\u0275directiveInject(ur),e.\u0275\u0275directiveInject(w.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["RLS-editor-dialog"]],viewQuery:function(n,r){var o;(1&n&&e.\u0275\u0275viewQuery(Fh,5),2&n)&&(e.\u0275\u0275queryRefresh(o=e.\u0275\u0275loadQuery())&&(r.rlsEditor=o.first))},features:[e.\u0275\u0275ProvidersFeature((0,d.__spreadArray)((0,d.__spreadArray)([],an,!0),[at.x,No.S],!1))],decls:4,vars:0,consts:[["cdkFocusInitial","",3,"keydown.shift.tab"],[1,"dialogContent"],[3,"validatePaneChange"],["rlsEditor",""]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"template-dialog",0),e.\u0275\u0275listener("keydown.shift.tab",function(a){return r.handleShiftTab(a)}),e.\u0275\u0275elementStart(1,"div",1)(2,"RLS-editor",2,3),e.\u0275\u0275listener("validatePaneChange",function(a){return r.validatePaneChange(a)}),e.\u0275\u0275elementEnd()()())},dependencies:[Nt.J,Ah],styles:['.dialogContent[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-primary-color, #323130);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);width:1002px;line-height:20px}.dialogContent[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{outline:none}html[data-focus-source=key][_ngcontent-%COMP%]   .dialogContent[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.dialogContent[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-right:8px}  pbi-dropdown pbi-dropdown-trigger{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}  template-dialog{padding:32px 32px 16px!important}  .mat-mdc-dialog-title{margin:0 0 16px!important}  .pbi-dialog-header{min-height:45px!important}  .notification-bar{position:inherit!important}']}),i}(),kh=p(47808),ma=p(68070),Bh=function(t){return{hidden:t}};function Lh(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",34),e.\u0275\u0275element(1,"pbi-icon",35),e.\u0275\u0275elementStart(2,"span",36),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(3,Bh,!n.isSelected)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.name)}}function Nh(i,t){1&i&&e.\u0275\u0275element(0,"pbi-pane-divider")}function Vh(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"section",30)(1,"div",31),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Lh,4,5,"pbi-dropdown-item",32),e.\u0275\u0275template(4,Nh,1,0,"pbi-pane-divider",33),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit,r=t.last;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.key),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r)}}function Uh(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayName," ")}}function zh(i,t){if(1&i){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",38)(1,"pbi-checkbox",14),e.\u0275\u0275listener("ngModelChange",function(a){e.\u0275\u0275restoreView(n);var l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.includeDefaultCalendar=a)}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",r.includeDefaultCalendar)("label",e.\u0275\u0275pipeBind1(2,2,"AssistedDateTable_Include_Original_Calendar_Label"))}}function jh(i,t){if(1&i&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",39),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var n=t.$implicit;e.\u0275\u0275property("displayCheckbox",!0)("disabled",n.isDisabled)("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.customName," ")}}var Wh=function(){return{panelClass:"source-column-dropdown",disableDefaultFocus:!0}},Hh=function(){return{panelClass:"start-of-year-dropdown"}},Gh=function(){return{panelClass:"date-attributes-dropdown"}},fa=function(){function i(t,n,r,o){this.templateDialogPayload=t,this.localizationService=n,this.changeDetector=r,this.modelService=o,this.sourceColumns=[],this.selectedSourceColumns=[],this.filteredSourceColumnsMap=new Map,this.selectedSourceColumnsLabel="",this.hideSourceColumn=!0,this.showIncludeDefaultCalendar=!1,this.includeDefaultCalendar=!0,this.dateAttributesLabel="",this.isDateAttributeSelectAllChecked=!1,this.sourceColumns=this.modelService.model.tables.map(function(a){return a.columns.filter(function(l){return l.isDateTime})}).flat().map(function(a){return(0,d.__assign)((0,d.__assign)({},a),{isSelected:!1})}),this.startMonthsOfYear=[{displayName:this.localizationService.get("Month_January"),value:1},{displayName:this.localizationService.get("Month_February"),value:2},{displayName:this.localizationService.get("Month_March"),value:3},{displayName:this.localizationService.get("Month_April"),value:4},{displayName:this.localizationService.get("Month_May"),value:5},{displayName:this.localizationService.get("Month_June"),value:6},{displayName:this.localizationService.get("Month_July"),value:7},{displayName:this.localizationService.get("Month_August"),value:8},{displayName:this.localizationService.get("Month_September"),value:9},{displayName:this.localizationService.get("Month_October"),value:10},{displayName:this.localizationService.get("Month_November"),value:11},{displayName:this.localizationService.get("Month_December"),value:12}],this.selectedStartMonthOfYear=this.startMonthsOfYear[0],this.dateAttributes=[{dateAttribute:"Date",isHidden:!0,customName:this.localizationService.get("Date"),isDisabled:!0},{dateAttribute:"DateKey",isHidden:!0,customName:this.localizationService.get("DateKey")},{dateAttribute:"DayOfMonth",isHidden:!0,customName:this.localizationService.get("DayOfMonth")},{dateAttribute:"DayOfWeek",isHidden:!0,customName:this.localizationService.get("DayOfWeek")},{dateAttribute:"Month",isHidden:!0,customName:this.localizationService.get("TimeUnit_Month")},{dateAttribute:"MonthNumber",isHidden:!0,customName:this.localizationService.get("MonthNumber")},{dateAttribute:"MonthYear",isHidden:!0,customName:this.localizationService.get("MonthYear")},{dateAttribute:"QuarterYear",isHidden:!0,customName:this.localizationService.get("QuarterYear")},{dateAttribute:"QuarterNumber",isHidden:!0,customName:this.localizationService.get("QuarterNumber")},{dateAttribute:"Quarter",isHidden:!0,customName:this.localizationService.get("CdsaAuthoring_Iframe_Quarter")},{dateAttribute:"Week",isHidden:!0,customName:this.localizationService.get("TimeUnit_Week")},{dateAttribute:"WeekNumber",isHidden:!0,customName:this.localizationService.get("WeekNumber")},{dateAttribute:"WeekYear",isHidden:!0,customName:this.localizationService.get("WeekYear")},{dateAttribute:"Year",isHidden:!0,customName:this.localizationService.get("TimeUnit_Year")},{dateAttribute:"YearMonthNumber",isHidden:!0,customName:this.localizationService.get("YearMonthNumber")},{dateAttribute:"YearNumber",isHidden:!0,customName:this.localizationService.get("YearNumber")},{dateAttribute:"YearQuarterNumber",isHidden:!0,customName:this.localizationService.get("YearQuarterNumber")}]}return i.prototype.ngOnInit=function(){var n,t=this;this.input=this.templateDialogPayload.input,this.templateDialogPayload.onOkButtonClick=function(){return t.saveAndClose()};var r=new Set(this.input.srcColumns);this.selectedSourceColumns=this.sourceColumns.filter(function(a){return r.has(a.urn)}),this.selectedSourceColumns.forEach(function(a){return a.isSelected=!0}),this.hideSourceColumn=this.input.hideSourceColumn,this.updateFilteredSourceColumns(),this.updateSelectedSourceColumnsLabel(),this.selectedStartMonthOfYear=this.startMonthsOfYear.find(function(a){return a.value===t.input.startMonthOfYear}),this.includeDefaultCalendar=!this.input.hideDefaultCalendar,this.onStartMonthOfYearChange();var o=_.keyBy(this.dateAttributes,"dateAttribute");this.selectedDateAttributes=[],null===(n=this.input.dateAttributes)||void 0===n||n.forEach(function(a){var l=o[a.dateAttribute];l&&(l.isHidden=a.isHidden,l.customName=a.customName,l.isHidden||t.selectedDateAttributes.push(l))}),this.isDateAttributeSelectAllChecked=this.selectedDateAttributes.length===this.dateAttributes.length,this.updateFilteredDateAttributes(),this.updateDateAttributesLabel(),this.changeDetector.detectChanges()},i.prototype.onSrcColumnsSearchTextChange=function(t){this.updateFilteredSourceColumns(t),this.changeDetector.detectChanges()},i.prototype.onDateAttributeSearchTextChange=function(t){this.updateFilteredDateAttributes(t),this.changeDetector.detectChanges()},i.prototype.onDateAttributeValueChange=function(){this.updateDateAttributesLabel(),this.changeDetector.detectChanges()},i.prototype.onDateAttributeSelectAllClicked=function(){var t;this.isDateAttributeSelectAllChecked=!this.isDateAttributeSelectAllChecked,this.selectedDateAttributes=this.dateAttributes.filter(function(n){return n.isDisabled}),this.isDateAttributeSelectAllChecked&&(t=this.selectedDateAttributes).push.apply(t,this.dateAttributes.filter(function(n){return!n.isDisabled})),this.updateDateAttributesLabel(),this.changeDetector.detectChanges()},i.prototype.onStartMonthOfYearChange=function(){this.showIncludeDefaultCalendar=this.selectedStartMonthOfYear!==this.startMonthsOfYear[0],this.changeDetector.detectChanges()},i.prototype.onSelectedSourceColumnChange=function(t){var n=new Set(t.map(function(r){return r.urn}));this.sourceColumns.forEach(function(r){return r.isSelected=n.has(r.urn)}),this.templateDialogPayload.setOkButtonState(_.isEmpty(t)),this.updateSelectedSourceColumnsLabel(),this.changeDetector.detectChanges()},i.prototype.updateSelectedSourceColumnsLabel=function(){this.selectedSourceColumnsLabel=0===this.selectedSourceColumns.length?this.localizationService.get("Select_Columns"):this.selectedSourceColumns.map(function(t){return t.name}).join(", ")},i.prototype.updateDateAttributesLabel=function(){this.dateAttributesLabel=0===this.selectedDateAttributes.length?this.localizationService.get("Select_Columns"):this.localizationService.format("Selected",this.selectedDateAttributes.length)},i.prototype.updateFilteredSourceColumns=function(t){void 0===t&&(t=""),t=t?.toLocaleLowerCase();var n=new Set(this.selectedSourceColumns.map(function(u){return u.urn}));this.filteredSourceColumnsMap.clear();for(var r=0,o=this.sourceColumns;r<o.length;r++){var a=o[r],l=a.table.name,s=a.name;if(!t||l.toLowerCase().includes(t)||s.toLowerCase().includes(t)||n.has(a.urn)){var c=l;this.filteredSourceColumnsMap.has(c)||this.filteredSourceColumnsMap.set(c,[]),this.filteredSourceColumnsMap.get(c).push(a)}}},i.prototype.updateFilteredDateAttributes=function(t){void 0===t&&(t="");var n=new Set(this.selectedDateAttributes.map(function(r){return r.dateAttribute}));t=t?.toLocaleLowerCase(),this.filteredDateAttributes=_.isEmpty(t)?this.dateAttributes.slice(0):this.dateAttributes.filter(function(r){return r.customName.toLocaleLowerCase().includes(t)||n.has(r.dateAttribute)})},i.prototype.saveAndClose=function(){return Promise.resolve({srcColumns:this.selectedSourceColumns.map(function(t){return{tableName:t.table.name,columnName:t.name}}),dateAttributes:this.selectedDateAttributes.map(function(t){return t.dateAttribute}),startMonthOfYear:this.selectedStartMonthOfYear.value,hideSourceColumn:this.hideSourceColumn,hideDefaultCalendar:!this.showIncludeDefaultCalendar})},i.dialogNameKey=Rt.aJ,i.\u0275fac=function(n){return new(n||i)(e.\u0275\u0275directiveInject(at.x),e.\u0275\u0275directiveInject(Be.o),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Oe.b))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["author-date-table"]],features:[e.\u0275\u0275ProvidersFeature([at.x])],decls:55,vars:49,consts:[[1,"dialog-description"],["localize","AssistedDateTable_Description"],["href","https://go.microsoft.com/fwlink/?linkid=2258817","target","_blank","rel","noopener noreferrer","localize","LearnMore",1,""],[1,"col-select"],[1,"column-select-header"],["localize","AssistedDateTable_Select_Column_Label",1,"fluentTheme-md-semiBold"],["name","info","size","mini",3,"pbiTooltip"],[1,"source-column-section"],["multiple","",3,"options","maxHeight","value","valueChange"],[1,"pbi-dropdown-header","source-column-dropdown-header"],[3,"onSearchTextChanged"],["pbiSearchInput","",1,"pbi-focus-outline",3,"placeholder","keyup"],["class","source-table-section",4,"ngFor","ngForOf"],[1,"hide-source-column"],[3,"ngModel","label","ngModelChange"],[1,"start-of-year"],["localize","AssistedDateTable_Start_Of_Year_Label",1,"fluentTheme-md-semiBold"],[1,"start-of-year-section"],[3,"options","value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["class","include-original-calendar",4,"ngIf"],[1,"date-table-columns"],[1,"date-table-columns-header"],["localize","AssistedDateTable_Date_Table_Columns_Label",1,"fluentTheme-md-semiBold"],[1,"date-table-columns-section"],[1,"pbi-dropdown-header","date-attributes-dropdown-header"],[3,"checked","label","onClick"],[3,"displayCheckbox","disabled","value",4,"ngFor","ngForOf"],[1,"date-table-preview"],["localize","AssistedDateTable_Date_Table_Preview_Label",1,"fluentTheme-md-semiBold"],[1,"source-table-section"],[1,"table-name","fluentTheme-sm-semiBold"],["class","col-name",3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-name",3,"value"],["name","checkmark","size","mini",1,"checked-indicator",3,"ngClass"],[1,"col-name"],[3,"value"],[1,"include-original-calendar"],[3,"displayCheckbox","disabled","value"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"section",0),e.\u0275\u0275element(2,"span",1)(3,"a",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"section",3)(5,"section",4),e.\u0275\u0275element(6,"label",5)(7,"pbi-icon",6),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"section",7)(10,"pbi-dropdown",8),e.\u0275\u0275listener("valueChange",function(a){return r.selectedSourceColumns=a})("valueChange",function(a){return r.onSelectedSourceColumnChange(a)}),e.\u0275\u0275elementStart(11,"pbi-dropdown-trigger"),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"section",9)(14,"pbi-search-box",10),e.\u0275\u0275listener("onSearchTextChanged",function(a){return r.onSrcColumnsSearchTextChange(a)}),e.\u0275\u0275elementStart(15,"input",11),e.\u0275\u0275listener("keyup",function(){return null}),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275pipe(17,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(18,"pbi-pane-divider"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,Vh,5,3,"section",12),e.\u0275\u0275pipe(20,"keyvalue"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"section",13)(22,"pbi-checkbox",14),e.\u0275\u0275listener("ngModelChange",function(a){return r.hideSourceColumn=a}),e.\u0275\u0275pipe(23,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(24,"section",15)(25,"section",4),e.\u0275\u0275element(26,"label",16)(27,"pbi-icon",6),e.\u0275\u0275pipe(28,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"section",17)(30,"pbi-dropdown",18),e.\u0275\u0275listener("valueChange",function(a){return r.selectedStartMonthOfYear=a})("valueChange",function(){return r.onStartMonthOfYearChange()}),e.\u0275\u0275elementStart(31,"pbi-dropdown-trigger"),e.\u0275\u0275text(32),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(33,Uh,2,2,"pbi-dropdown-item",19),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(34,zh,3,4,"section",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"section",21)(36,"section",22),e.\u0275\u0275element(37,"label",23)(38,"pbi-icon",6),e.\u0275\u0275pipe(39,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(40,"section",24)(41,"pbi-dropdown",8),e.\u0275\u0275listener("valueChange",function(a){return r.selectedDateAttributes=a})("valueChange",function(){return r.onDateAttributeValueChange()}),e.\u0275\u0275elementStart(42,"pbi-dropdown-trigger"),e.\u0275\u0275text(43),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(44,"section",25)(45,"pbi-search-box",10),e.\u0275\u0275listener("onSearchTextChanged",function(a){return r.onDateAttributeSearchTextChange(a)}),e.\u0275\u0275elementStart(46,"input",11),e.\u0275\u0275listener("keyup",function(){return null}),e.\u0275\u0275pipe(47,"localize"),e.\u0275\u0275pipe(48,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(49,"pbi-checkbox",26),e.\u0275\u0275listener("onClick",function(){return r.onDateAttributeSelectAllClicked()}),e.\u0275\u0275pipe(50,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(51,"pbi-pane-divider"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(52,jh,2,4,"pbi-dropdown-item",27),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(53,"section",28),e.\u0275\u0275element(54,"label",29),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(8,26,"AssistedDateTable_Date_Table_Columns_Tooltip")),e.\u0275\u0275advance(3),e.\u0275\u0275property("options",e.\u0275\u0275pureFunction0(46,Wh))("maxHeight",500)("value",r.selectedSourceColumns),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.selectedSourceColumnsLabel," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("placeholder",e.\u0275\u0275pipeBind1(17,30,"SearchBox_Text")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(16,28,"SearchBox_Text")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(20,32,r.filteredSourceColumnsMap)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",r.hideSourceColumn)("label",e.\u0275\u0275pipeBind1(23,34,"AssistedDateTable_Hide_Selected_Column")),e.\u0275\u0275advance(5),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(28,36,"AssistedDateTable_Start_Of_Year_Tooltip")),e.\u0275\u0275advance(3),e.\u0275\u0275property("options",e.\u0275\u0275pureFunction0(47,Hh))("value",r.selectedStartMonthOfYear),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.selectedStartMonthOfYear.displayName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.startMonthsOfYear),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.showIncludeDefaultCalendar),e.\u0275\u0275advance(4),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(39,38,"AssistedDateTable_Date_Table_Columns_Tooltip")),e.\u0275\u0275advance(3),e.\u0275\u0275property("options",e.\u0275\u0275pureFunction0(48,Gh))("maxHeight",150)("value",r.selectedDateAttributes),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.dateAttributesLabel," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("placeholder",e.\u0275\u0275pipeBind1(48,42,"SearchBox_Text")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(47,40,"SearchBox_Text")),e.\u0275\u0275advance(3),e.\u0275\u0275property("checked",r.isDateAttributeSelectAllChecked)("label",e.\u0275\u0275pipeBind1(50,44,"SelectAll")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.filteredDateAttributes))},dependencies:[ye.JJ,ye.On,ie.NgClass,ie.NgForOf,ie.NgIf,bt.X,Nt.J,si.v,tn.H,ci.r,di._,tn.T,hr._,kh.P,ma.a,ma.p,kt.V,ie.KeyValuePipe,ft.F],styles:[".col-select[_ngcontent-%COMP%], .hide-source-column[_ngcontent-%COMP%], .start-of-year[_ngcontent-%COMP%], .include-original-calendar[_ngcontent-%COMP%], .date-table-columns[_ngcontent-%COMP%], .date-table-preview[_ngcontent-%COMP%]{margin-top:16px}label[_ngcontent-%COMP%]{display:inline-flex;align-items:center;height:26px}pbi-dropdown[_ngcontent-%COMP%]{height:32px;width:300px}pbi-icon[_ngcontent-%COMP%]{width:20px;height:20px;align-items:center;justify-content:center;display:inline-flex;cursor:pointer}.source-column-section[_ngcontent-%COMP%]{display:flex;flex-direction:column}.pbi-dropdown-header[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column}.pbi-dropdown-header.source-column-dropdown-header[_ngcontent-%COMP%]{height:50px}.pbi-dropdown-header.date-attributes-dropdown-header[_ngcontent-%COMP%]{height:82x}.pbi-dropdown-header[_ngcontent-%COMP%]{justify-content:center}.pbi-dropdown-header[_ngcontent-%COMP%]   pbi-search-box[_ngcontent-%COMP%]{width:292px}.pbi-dropdown-header.date-attributes-dropdown-header[_ngcontent-%COMP%]{padding:0 4px;display:flex;flex-direction:column}.pbi-dropdown-header.date-attributes-dropdown-header[_ngcontent-%COMP%]   pbi-search-box[_ngcontent-%COMP%], .pbi-dropdown-header.date-attributes-dropdown-header[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{height:32px;display:flex;align-items:center;box-sizing:border-box}.pbi-dropdown-header.date-attributes-dropdown-header[_ngcontent-%COMP%]   pbi-search-box[_ngcontent-%COMP%]{width:292px;padding:0 4px}.pbi-dropdown-header.date-attributes-dropdown-header[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{padding:0 8px;margin:0;width:100%}pbi-dropdown-item[_ngcontent-%COMP%]{box-sizing:border-box;padding:0 4px}.source-table-section[_ngcontent-%COMP%]{display:flex;flex-direction:column}.source-table-section[_ngcontent-%COMP%]   .table-name[_ngcontent-%COMP%]{display:flex;align-items:center;height:32px;padding:0 8px}pbi-pane-divider[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),i}(),Kh=[{componentIdentifier:lo.dialogNameKey,componentType:lo},{componentIdentifier:Ro.dialogNameKey,componentType:Ro},{componentIdentifier:ko.dialogNameKey,componentType:ko},{componentIdentifier:xo.dialogNameKey,componentType:xo},{componentIdentifier:Mo.dialogNameKey,componentType:Mo},{componentIdentifier:sr.dialogNameKey,componentType:sr},{componentIdentifier:Oo.dialogNameKey,componentType:Oo},{componentIdentifier:Lo.dialogNameKey,componentType:Lo},{componentIdentifier:Io.dialogNameKey,componentType:Io},{componentIdentifier:ha.dialogNameKey,componentType:ha},{componentIdentifier:Mr.dialogNameKey,componentType:Mr},{componentIdentifier:fa.dialogNameKey,componentType:fa},{componentIdentifier:Bo.dialogNameKey,componentType:Bo}],$h=p(42729),Qh=function(){function i(){}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[br,$h.c.withManifest(Kh),Xe,br,Xe]}),i}()},48563:function(De,J,p){p.d(J,{w:function(){return e}});var I=p(17819);function e(d){return d.map(function(B){return function(d){return{name:d.Name,description:d.Description,category:R(d.Category),pushableToDQ:D(d.PushableToDirectQuery),parameters:M(d.Parameters),visualCalculationsInfo:d.VisualCalculationsInfo}}(B)})}function R(d){switch(d){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 8;case 9:return 9}}function D(d){var B=0;return 1===d?B=1:2===d?B=2:3===d&&(B=3),B}function M(d){return d?d.map(function(B){return function(d){return new I.Hw(d.Name,d.Optional,d.Repeatable,d.RepeatGroup,d.Skippable)}(B)}):[]}},98187:function(De,J,p){p.d(J,{z:function(){return X}});var I=p(81337),e=p(14463),se=p(59055),R=p(98665),D=p(50423),M=p(629),X=function(){function d(B,F,k){this.promiseFactory=B,this.telemetryService=F,this.httpService=k}return d.prototype.emailIsInVerifiedDomain=function(B){return(0,I.__awaiter)(this,void 0,void 0,function(){var F,k;return(0,I.__generator)(this,function(w){switch(w.label){case 0:F=this.promiseFactory.defer(),w.label=1;case 1:return w.trys.push([1,3,,4]),[4,this.getVerifiedDomains()];case 2:return k=w.sent(),F.resolve(this.verifyEmailInGivenVerifiedDomains(B,k)),[3,4];case 3:return w.sent(),F.reject(),[3,4];case 4:return[2,F.promise]}})})},d.prototype.getVerifiedDomains=function(){return(0,I.__awaiter)(this,void 0,void 0,function(){var B,F,k,T,w,W;return(0,I.__generator)(this,function(x){switch(x.label){case 0:return this.verifiedDomainsPromise?[2,this.verifiedDomainsPromise]:[3,1];case 1:B=this.promiseFactory.defer(),F=this.telemetryService.startEvent(se.f8),k=this.httpService.powerbiRequestOptions(F.event,"TenantVerifiedDomains"),x.label=2;case 2:return x.trys.push([2,4,,5]),[4,this.httpService.get("powerbi/invitation/verifiedDomains",k)];case 3:return T=x.sent(),w={verifiedDomains:{},blockedDomains:{}},(W=T.data).verifiedDomains&&W.verifiedDomains.map(function(Y){var S=Y.toUpperCase();return w.verifiedDomains[S]=S,S}),W.blockedDomains&&W.blockedDomains.map(function(Y){var S=Y.toUpperCase();return w.blockedDomains[S]=S,S}),B.resolve(w),F.resolve(),[3,5];case 4:return x.sent(),B.reject(),[3,5];case 5:return this.verifiedDomainsPromise=B.promise,[2,this.verifiedDomainsPromise]}})})},d.prototype.verifyEmailInGivenVerifiedDomains=function(B,F){var k=B.split("@");return!(!F||!_.isEmpty(F.verifiedDomains))||k.length>1&&F&&!!F.verifiedDomains[k[1].toUpperCase()]},d.\u0275fac=function(F){return new(F||d)(D.\u0275\u0275inject(e.t),D.\u0275\u0275inject(R.y0),D.\u0275\u0275inject(M.M))},d.\u0275prov=D.\u0275\u0275defineInjectable({token:d,factory:d.\u0275fac,providedIn:"root"}),d}()},93864:function(De,J,p){p.d(J,{t:function(){return be}});var I=p(81337),e=p(41114),se="PBI.EmailsList.PasteInfo",R=e.cx[se]=(0,e.b1)(se),D=p(93247),M=p(50423),X=p(17174),d=p(89075),B=p(35911),F=p(2142),k=p(73221),T=p(98665),w=p(35510),W=p(30794),ae=p(40133),x=p(11547),Y=p(58417),S=p(82762),Q=p(37272),Z=p(14172),re=p(77526),ne=p(57243),he=p(55862),_e=p(81905),Ae=p(22318),ct=p(6663),Fe=p(59973),dt=p(83317),it=p(17653),Ee=p(42195),Ge=p(59822),et=p(48787),Ve=p(15910),Ze=p(65181),je=p(98187),We=p(77476),Le=p(34895),He=p(21661),xt=p(33846),ut=p(87650),yt=p(86663),It=p(73425),Ke=p(44641),Ft=p(223),Pt=["emailsInput"],Ce=["emailsList"];function ge(N,L){if(1&N&&(M.\u0275\u0275elementStart(0,"div",14),M.\u0275\u0275text(1),M.\u0275\u0275elementEnd()),2&N){var h=L.ngIf,g=M.\u0275\u0275nextContext();M.\u0275\u0275advance(1),M.\u0275\u0275textInterpolate1(" ",g.getSuggestionsText(h)," ")}}function U(N,L){if(1&N&&M.\u0275\u0275text(0),2&N){var h=M.\u0275\u0275nextContext();M.\u0275\u0275textInterpolate(h.inputLabel)}}function P(N,L){if(1&N&&M.\u0275\u0275element(0,"pbi-icon",15),2&N){var h=M.\u0275\u0275nextContext();M.\u0275\u0275property("name",h.inputIcon)}}function O(N,L){1&N&&M.\u0275\u0275element(0,"pbi-icon",21)}var ue=function(L,h){return{userEmail:L,displayName:h}};function Te(N,L){if(1&N){var h=M.\u0275\u0275getCurrentView();M.\u0275\u0275elementStart(0,"mat-chip",18),M.\u0275\u0275listener("removed",function(){var A=M.\u0275\u0275restoreView(h).$implicit,K=M.\u0275\u0275nextContext(2);return M.\u0275\u0275resetView(K.remove(A))}),M.\u0275\u0275element(1,"user-details-host",19),M.\u0275\u0275template(2,O,1,0,"pbi-icon",20),M.\u0275\u0275elementEnd()}if(2&N){var g=L.$implicit,m=M.\u0275\u0275nextContext(2);M.\u0275\u0275property("disabled",m.disabled),M.\u0275\u0275advance(1),M.\u0275\u0275property("details",M.\u0275\u0275pureFunction2(5,ue,null==g?null:g.userPrincipalName,null==g?null:g.displayName))("forceShowDisplayNameInTooltip",!0)("coloredDefaultUserPhoto",m.coloredDefaultUserPhoto),M.\u0275\u0275advance(1),M.\u0275\u0275property("ngIf",!(null!=m.ngControl&&m.ngControl.disabled))}}function $e(N,L){if(1&N&&(M.\u0275\u0275elementStart(0,"div",16),M.\u0275\u0275template(1,Te,3,8,"mat-chip",17),M.\u0275\u0275pipe(2,"async"),M.\u0275\u0275elementEnd()),2&N){var h=M.\u0275\u0275nextContext();M.\u0275\u0275advance(1),M.\u0275\u0275property("ngForOf",M.\u0275\u0275pipeBind1(2,1,h.selectedUsers$))}}function rt(N,L){1&N&&(M.\u0275\u0275elementStart(0,"div",22),M.\u0275\u0275element(1,"spinner"),M.\u0275\u0275elementEnd())}function mt(N,L){if(1&N){var h=M.\u0275\u0275getCurrentView();M.\u0275\u0275elementStart(0,"input",23,24),M.\u0275\u0275listener("matChipInputTokenEnd",function(A){M.\u0275\u0275restoreView(h);var K=M.\u0275\u0275nextContext();return M.\u0275\u0275resetView(K.add(A,2))})("paste",function(A){M.\u0275\u0275restoreView(h);var K=M.\u0275\u0275reference(2);return M.\u0275\u0275nextContext().onPaste(A),M.\u0275\u0275resetView(K.closePanel())})("blur",function(A){M.\u0275\u0275restoreView(h);var K=M.\u0275\u0275nextContext();return M.\u0275\u0275resetView(K.onBlur(A))})("focus",function(A){M.\u0275\u0275restoreView(h);var K=M.\u0275\u0275nextContext();return M.\u0275\u0275resetView(K.onFocus(A))})("keydown.escape",function(A){M.\u0275\u0275restoreView(h);var K=M.\u0275\u0275reference(2),ee=M.\u0275\u0275nextContext();return M.\u0275\u0275resetView(ee.onEscape(A,K))}),M.\u0275\u0275pipe(3,"async"),M.\u0275\u0275elementEnd()}if(2&N){var g=M.\u0275\u0275nextContext(),m=M.\u0275\u0275reference(13),b=M.\u0275\u0275reference(6);M.\u0275\u0275property("placeholder",M.\u0275\u0275pipeBind1(3,9,g.selectedUsers$).length>0?void 0:g.inputPlaceholder)("disabled",g.disabled)("formControl",g.emailsListControl)("matAutocomplete",m)("matChipInputFor",b)("matChipInputSeparatorKeyCodes",g.separatorKeysCodes),M.\u0275\u0275attribute("title",g.inputPlaceholder)("aria-label",g.inputAriaLabelledBy?void 0:g.inputPlaceholder)("aria-labelledby",g.inputAriaLabelledBy)}}function Re(N,L){if(1&N&&(M.\u0275\u0275elementStart(0,"mat-option",25),M.\u0275\u0275element(1,"user-details-host",26),M.\u0275\u0275elementEnd()),2&N){var h=L.$implicit,g=M.\u0275\u0275nextContext();M.\u0275\u0275property("value",h),M.\u0275\u0275advance(1),M.\u0275\u0275property("showOneLine",!1)("details",M.\u0275\u0275pureFunction2(6,ue,g.getUserEmail(h),h.displayName))("forceShowDisplayNameInTooltip",!0)("coloredDefaultUserPhoto",g.coloredDefaultUserPhoto),M.\u0275\u0275attribute("data-testid",g.getUserEmail(h))}}function xe(N,L){if(1&N&&(M.\u0275\u0275elementContainerStart(0),M.\u0275\u0275elementStart(1,"div",27),M.\u0275\u0275element(2,"message-banner",28),M.\u0275\u0275elementEnd(),M.\u0275\u0275elementContainerEnd()),2&N){var h=M.\u0275\u0275nextContext();M.\u0275\u0275advance(2),M.\u0275\u0275property("viewModel",h.messageBannerViewModel)}}var be=function(N){function L(h,g,m,b,y,A){var K=N.call(this)||this;return K.userDirectoryHttpService=h,K.localizationService=g,K.domainHelperService=m,K.telemetryService=b,K.cdr=y,K.ngControl=A,K.showRelevantUsers=!0,K.defaultSelectedUsers=[],K.coloredDefaultUserPhoto=!1,K.onInputFocus=new M.EventEmitter,K.awaitingRequestsCount=new w.X(0),K.isBusy$=K.awaitingRequestsCount.pipe((0,Z.U)(function(ee){return _.gt(ee,0)}),(0,re.x)(),(0,ne.d)(1)),K.separatorKeysCodes=[D.K5],K.emailsListControl=new X.p4("",null,K.findUserValidator()),K.emailSuggestionResults=new w.X([]),K.selectedUsers$=new w.X([]),K.onSelectedUsersChange=function(){},K.onComponentBlur=function(){},K.ngControl&&(K.ngControl.valueAccessor=K),K}return(0,I.__extends)(L,N),L.prototype.ngOnInit=function(){var h=this;this.pasteHandler=new W.xQ,this.lifecycleSubscriptions.add(this.pasteHandler.pipe((0,he.p)(1e3),(0,_e.w)(function(g){return(0,I.__awaiter)(h,void 0,void 0,function(){var m,b,y,A,K,ee;return(0,I.__generator)(this,function(me){switch(me.label){case 0:return this.emailsListControl.markAsPending(),m=g.clipboardData.getData("Text").split(/;|,|\n/).filter(function(Pe){return _.trim(Pe).length>0}),b=_.size(m)<=100,y=this.telemetryService.startEvent(R,{inputCount:_.size(m)}),[4,this.addUser(m,b,3)];case 1:return A=me.sent(),K=0===_.size(A),this.propagateSelectedUsersChange(K),this.emailsInput.nativeElement.value=_.join(A,","),(ee=_.size(m)>100)&&this.emailsListControl.setErrors({TooManyUsers:_.size(m)}),(K||ee)&&this.cdr.markForCheck(),y.resolve(),[2]}})})})).subscribe()),this.lifecycleSubscriptions.add(this.emailsListControl.statusChanges.pipe((0,Ae.O)(this.emailsListControl.status),(0,re.x)(),(0,ct.G)(),(0,Fe.h)(function(g){return"PENDING"===g[0]})).subscribe(function(){return h.cdr.markForCheck()})),this.actions&&this.actions.pipe((0,dt.R)(this.onDestroy$)).subscribe(function(g){0===g&&h.reset()}),this.applyDefaultSelectedUsers(),this.onChanges$.subscribe(function(g){h.onChanges(g)})},L.prototype.ngAfterViewInit=function(){this.notUseUnallowedAttributes()},L.prototype.onChanges=function(h){h.defaultSelectedUsers&&this.applyDefaultSelectedUsers()},L.prototype.applyDefaultSelectedUsers=function(){this.defaultSelectedUsers&&this.defaultSelectedUsers.length>0&&this.selectedUsers$.value&&0===this.selectedUsers$.value.length&&this.selectedUsers$.next(this.defaultSelectedUsers)},L.prototype.reset=function(){this.selectedUsers$.next([]),this.emailsListControl.setValue(null),this.emailsInput&&(this.emailsInput.nativeElement.value=""),this.propagateSelectedUsersChange(!0)},L.prototype.propagateSelectedUsersChange=function(h){h&&this.emailsListControl.setErrors(null),this.onSelectedUsersChange(this.selectedUsers$.value)},L.prototype.add=function(h,g){var m;return(0,I.__awaiter)(this,void 0,void 0,function(){var b;return(0,I.__generator)(this,function(K){switch(K.label){case 0:return this.emailsListControl.invalid||this.emailsListControl.pending?[2]:(b=null===(m=h.chipInput)||void 0===m?void 0:m.inputElement,[4,this.addUser([h.value],!0,g)]);case 1:return 0===K.sent().length&&(b&&(b.value=""),this.propagateSelectedUsersChange(!0),this.emailsListControl.setValue(null)),[2]}})})},Object.defineProperty(L.prototype,"hasValidPendingInput",{get:function(){var g=this.emailsInput.nativeElement.value;return!!g&&B.JJ.test(g)},enumerable:!1,configurable:!0}),L.prototype.addUser=function(h,g,m){return(0,I.__awaiter)(this,void 0,void 0,function(){var b,y,A,K,ee,me;return(0,I.__generator)(this,function(Pe){switch(Pe.label){case 0:b=[],y=0,A=h,Pe.label=1;case 1:return y<A.length?(K=A[y],(K=_.trim(K))?(ee=void 0,g?[4,this.findUsers(K).pipe((0,Z.U)(function(pe){return 1===pe.length?pe[0]:null})).toPromise()]:[3,3]):[3,6]):[3,7];case 2:ee=Pe.sent(),Pe.label=3;case 3:return this.emailsListControl.value||1!==m?(me=void 0,ee?[3,5]:[4,this.validateEmail(K,g&&this.checkValidOrgUser,!g||this.allowExternalUsers)]):[3,6];case 4:me=Pe.sent(),Pe.label=5;case 5:me?(this.emailsListControl.setErrors(me),b.push(K),this.cdr.markForCheck()):this.selectedUsers$.next(this.selectedUsers$.value.concat([ee??this.getADUserMetadataFromEmail(K)])),Pe.label=6;case 6:return y++,[3,1];case 7:return[2,b]}})})},L.prototype.getADUserMetadataFromEmail=function(h){return{displayName:void 0,userPrincipalName:h,objectId:void 0,emailAddress:h,objectType:1,isSecurityGroup:!1}},L.prototype.remove=function(h){this.selectedUsers$.next(this.selectedUsers$.value.filter(function(g){return g!==h})),this.propagateSelectedUsersChange(!0)},L.prototype.select=function(h){this.selectedUsers$.next(this.selectedUsers$.value.concat([h.option.value])),this.propagateSelectedUsersChange(!0),this.emailsInput.nativeElement.value="",this.emailsListControl.setValue(null)},L.prototype.findUserValidator=function(){var h=this;return function(g){return(0,ae.H)(500).pipe((0,_e.w)(function(){var m=_.trim(g.value);return _.isString(g.value)&&m?h.findUsers(g.value).pipe((0,it.b)(function(y){return h.emailSuggestionResults.next(y)}),(0,Ee.zg)(function(y){return _.isEmpty(y)?h.validateEmail(g.value,h.checkValidOrgUser,h.allowExternalUsers):(0,x.of)(null)})):(h.emailSuggestionResults.next([]),(0,x.of)(null))}))}},L.prototype.sendFindUsersRequest=function(h){var g=this;return function(N,L){return new Y.y(function(h){var g,m;try{g=N()}catch(A){return void h.error(A)}try{m=L()}catch(A){return void h.error(A)}var y=(m?(0,S.D)(m):Q.E).subscribe(h);return function(){y.unsubscribe(),g&&g.unsubscribe()}})}(function(){return{unsubscribe:function(){return g.awaitingRequestsCount.next(g.awaitingRequestsCount.value-1)}}},function(){var b=g.allowAnyGroup||g.allowSecurityGroups||g.allowUnifiedGroups||g.allowEmailEnabledSecurityGroups?g.blockUsers?2:3:1;return g.awaitingRequestsCount.next(g.awaitingRequestsCount.value+1),g.userDirectoryHttpService.findUsers(h,b,F.OsI,!!g.includeGuests,g.showRelevantUsers,g.allowAnyGroup,!0)})},L.prototype.findUsers=function(h){var g=this;return this.sendFindUsersRequest(h).pipe((0,Z.U)(function(m){return _.reduce(m.data,function(b,y){var A;if(g.isValidObjectType(y)&&-1===_.findIndex(g.selectedUsers$.value,function(pe){return g.compareADEntities(y,pe)})){var ee=y.displayName&&y.displayName.toLocaleLowerCase()===h.toLocaleLowerCase(),me=null===(A=y.userPrincipalName)||void 0===A?void 0:A.split("@")[0],Pe=me&&me.toLocaleLowerCase()===h.toLocaleLowerCase();ee||Pe?b.unshift(y):b.push(y)}return b},[])}),(0,Ge.K)(function(){return(0,x.of)([])}))},L.prototype.compareADEntities=function(h,g){return h.userPrincipalName&&g.userPrincipalName?h.userPrincipalName===g.userPrincipalName:!(!h.objectId||!g.objectId)&&h.objectId===g.objectId},L.prototype.writeValue=function(h){h&&this.selectedUsers$.next(h)},L.prototype.registerOnChange=function(h){this.onSelectedUsersChange=h},L.prototype.registerOnTouched=function(h){this.onComponentBlur=h},L.prototype.onPaste=function(h){h.preventDefault(),this.pasteHandler.next(h)},Object.defineProperty(L.prototype,"messageBannerViewModel",{get:function(){var g=this.localizationService.get("ClientError_UnknownClientErrorValue"),m=1;return this.emailsListControl.hasError("DuplicateEmail")||this.emailsListControl.hasError("InvalidEmail")?g=this.localizationService.get("Sharing_InvalidEmail"):this.emailsListControl.hasError("ExternalUser")?(g=this.localizationService.format("Sharing_ExternalOrganization",this.emailsListControl.getError("ExternalUser")),m=1):this.emailsListControl.hasError("InvalidOrgUser")?(g=this.localizationService.format("GrantAccessPane_InvalidEmails",this.emailsListControl.getError("InvalidOrgUser")),m=1):this.emailsListControl.hasError("TooManyUsers")&&(g=this.localizationService.format("TooManyUsers_BlockedEmails",this.emailsListControl.getError("TooManyUsers")),m=1),{bannerType:m,iconName:1===m?"pbi-glyph-error-circle-exclamation":"pbi-glyph-warning",message:g}},enumerable:!1,configurable:!0}),L.prototype.onBlur=function(h){return(0,I.__awaiter)(this,void 0,void 0,function(){var g,m;return(0,I.__generator)(this,function(b){switch(b.label){case 0:return h.relatedTarget&&"MAT-OPTION"===h.relatedTarget.tagName?[2]:(this.onComponentBlur(this.selectedUsers$.value),this.addUserOnBlur?(g=this.emailsInput.nativeElement,this.emailsListControl.pending?[4,this.emailsListControl.statusChanges.pipe((0,Fe.h)(function(y){return"PENDING"!==y}),(0,et.q)(1)).toPromise()]:[3,2]):[3,3]);case 1:b.sent(),b.label=2;case 2:return(m=_.trim(g.value))?[2,this.add({input:g,value:m,chipInput:new d.IP(this.emailsInput,{separatorKeyCodes:[]})},1)]:[2];case 3:return[2]}})})},L.prototype.onEscape=function(h,g){var m;null!==(m=g?.autocomplete)&&void 0!==m&&m.isOpen&&(h?.stopPropagation(),g.closePanel())},L.prototype.onFocus=function(h){this.onInputFocus.emit(h)},L.prototype.validateEmail=function(h,g,m){return void 0===m&&(m=!1),(0,I.__awaiter)(this,void 0,void 0,function(){var y;return(0,I.__generator)(this,function(A){switch(A.label){case 0:return B.JJ.test(h)?-1!==_.findIndex(this.selectedUsers$.value,function(K){return K.userPrincipalName===h})?[2,{DuplicateEmail:!0}]:[4,this.domainHelperService.emailIsInVerifiedDomain(h)]:[3,2];case 1:return(y=A.sent())||m?y&&g?[2,{InvalidOrgUser:h}]:[2,null]:[2,{ExternalUser:h}];case 2:return[2,{InvalidEmail:!0}]}})})},L.prototype.isValidObjectType=function(h){return 2===h.objectType?!!this.allowAnyGroup||(h.isSecurityGroup?this.allowSecurityGroups||this.allowEmailEnabledSecurityGroups&&3===h.groupType:2===h.groupType?this.allowDistributionLists:this.allowUnifiedGroups):1===h.objectType&&h.aadAppId?this.allowServicePrincipals:(1===h.objectType||3===h.objectType)&&!this.blockUsers},L.prototype.getUserEmail=function(h){return h.userPrincipalName||h.emailAddress||(h.aadAppId?"AppID: "+h.aadAppId:null)},L.prototype.notUseUnallowedAttributes=function(){this.emailsList._multiple=void 0,this.emailsList.ariaOrientation=void 0},L.prototype.getSuggestionsText=function(h){return h>0?this.localizationService.format("Email_Address_Suggestion_Count_Text",[h]):""},L.\u0275fac=function(g){return new(g||L)(M.\u0275\u0275directiveInject(Ve.W),M.\u0275\u0275directiveInject(Ze.o),M.\u0275\u0275directiveInject(je.z),M.\u0275\u0275directiveInject(T.y0),M.\u0275\u0275directiveInject(M.ChangeDetectorRef),M.\u0275\u0275directiveInject(X.a5,10))},L.\u0275cmp=M.\u0275\u0275defineComponent({type:L,selectors:[["emails-list-modern"]],viewQuery:function(g,m){if(1&g&&(M.\u0275\u0275viewQuery(Pt,5),M.\u0275\u0275viewQuery(Ce,5)),2&g){var b=void 0;M.\u0275\u0275queryRefresh(b=M.\u0275\u0275loadQuery())&&(m.emailsInput=b.first),M.\u0275\u0275queryRefresh(b=M.\u0275\u0275loadQuery())&&(m.emailsList=b.first)}},hostVars:4,hostBindings:function(g,m){2&g&&M.\u0275\u0275classProp("disabled",(null==m.ngControl?null:m.ngControl.disabled)||m.disabled)("invalid",(null==m.ngControl?null:m.ngControl.invalid)||m.emailsListControl.invalid)},inputs:{allowAnyGroup:"allowAnyGroup",allowSecurityGroups:"allowSecurityGroups",allowUnifiedGroups:"allowUnifiedGroups",allowEmailEnabledSecurityGroups:"allowEmailEnabledSecurityGroups",allowObjectIds:"allowObjectIds",blockUsers:"blockUsers",isRequired:"isRequired",includeGuests:"includeGuests",allowExternalUsers:"allowExternalUsers",allowDistributionLists:"allowDistributionLists",allowServicePrincipals:"allowServicePrincipals",inputLabel:"inputLabel",inputPlaceholder:"inputPlaceholder",inputIcon:"inputIcon",inputAriaLabelledBy:"inputAriaLabelledBy",disabled:"disabled",maxSelectableUsers:"maxSelectableUsers",hideChips:"hideChips",hideError:"hideError",hideInput:"hideInput",addUserOnBlur:"addUserOnBlur",checkValidOrgUser:"checkValidOrgUser",showRelevantUsers:"showRelevantUsers",actions:"actions",defaultSelectedUsers:"defaultSelectedUsers",coloredDefaultUserPhoto:"coloredDefaultUserPhoto"},outputs:{onInputFocus:"onInputFocus"},features:[M.\u0275\u0275InheritDefinitionFeature],decls:17,vars:17,consts:[["id","emailsList","appearance","none","cdkScrollable","",1,"emails-list"],["class","x-screen-reader","aria-live","assertive",4,"ngIf"],[1,"email-list-input-wrapper"],[3,"ngIf"],["role","listbox",1,"chip-list",3,"required"],["emailsList",""],["class","inputIcon","size","small",3,"name",4,"ngIf"],["class","chips-wrapper",4,"ngIf"],["class","autoCompleteSpinner",4,"ngIf"],["matChipInput","","aria-owns","email-list-modern-suggestions","aria-controls","email-list-modern-suggestions","data-testid","emails-list-input","data-unique-id","EmailsListInput",3,"placeholder","disabled","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd","paste","blur","focus","keydown.escape",4,"ngIf"],["id","email-list-modern-suggestions","data-testid","email-sugessions-dropdown",3,"optionSelected"],["auto","matAutocomplete"],["data-automation-type","Suggestion",3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["aria-live","assertive",1,"x-screen-reader"],["size","small",1,"inputIcon",3,"name"],[1,"chips-wrapper"],["defaultTabIndex","0","tabindex","0","role","option",3,"disabled","removed",4,"ngFor","ngForOf"],["defaultTabIndex","0","tabindex","0","role","option",3,"disabled","removed"],[3,"details","forceShowDisplayNameInTooltip","coloredDefaultUserPhoto"],["name","close","size","mini","matChipRemove","",4,"ngIf"],["name","close","size","mini","matChipRemove",""],[1,"autoCompleteSpinner"],["matChipInput","","aria-owns","email-list-modern-suggestions","aria-controls","email-list-modern-suggestions","data-testid","emails-list-input","data-unique-id","EmailsListInput",3,"placeholder","disabled","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd","paste","blur","focus","keydown.escape"],["emailsInput","","trigger","matAutocompleteTrigger"],["data-automation-type","Suggestion",3,"value"],[3,"showOneLine","details","forceShowDisplayNameInTooltip","coloredDefaultUserPhoto"],["role","alert","aria-atomic","true"],[3,"viewModel"]],template:function(g,m){var b;(1&g&&(M.\u0275\u0275elementStart(0,"mat-form-field",0),M.\u0275\u0275template(1,ge,2,1,"div",1),M.\u0275\u0275pipe(2,"async"),M.\u0275\u0275elementStart(3,"label",2),M.\u0275\u0275template(4,U,1,1,"ng-template",3),M.\u0275\u0275elementStart(5,"mat-chip-list",4,5),M.\u0275\u0275template(7,P,1,1,"pbi-icon",6),M.\u0275\u0275template(8,$e,3,3,"div",7),M.\u0275\u0275template(9,rt,2,0,"div",8),M.\u0275\u0275elementEnd(),M.\u0275\u0275template(10,mt,4,11,"input",9),M.\u0275\u0275pipe(11,"async"),M.\u0275\u0275elementEnd(),M.\u0275\u0275elementStart(12,"mat-autocomplete",10,11),M.\u0275\u0275listener("optionSelected",function(A){return m.select(A)}),M.\u0275\u0275template(14,Re,2,9,"mat-option",12),M.\u0275\u0275pipe(15,"async"),M.\u0275\u0275elementEnd()(),M.\u0275\u0275template(16,xe,3,1,"ng-container",13)),2&g)&&(M.\u0275\u0275advance(1),M.\u0275\u0275property("ngIf",null==(b=M.\u0275\u0275pipeBind1(2,11,m.emailSuggestionResults))?null:b.length),M.\u0275\u0275advance(3),M.\u0275\u0275property("ngIf",m.inputLabel),M.\u0275\u0275advance(1),M.\u0275\u0275property("required",m.isRequired),M.\u0275\u0275attribute("aria-label",m.inputAriaLabelledBy?void 0:m.inputPlaceholder)("aria-labelledby",m.inputAriaLabelledBy),M.\u0275\u0275advance(2),M.\u0275\u0275property("ngIf",!!m.inputIcon),M.\u0275\u0275advance(1),M.\u0275\u0275property("ngIf",!m.hideChips),M.\u0275\u0275advance(1),M.\u0275\u0275property("ngIf",m.emailsListControl.pending),M.\u0275\u0275advance(1),M.\u0275\u0275property("ngIf",!m.hideInput&&(!m.maxSelectableUsers||M.\u0275\u0275pipeBind1(11,13,m.selectedUsers$).length<m.maxSelectableUsers)),M.\u0275\u0275advance(4),M.\u0275\u0275property("ngForOf",M.\u0275\u0275pipeBind1(15,15,m.emailSuggestionResults)),M.\u0275\u0275advance(2),M.\u0275\u0275property("ngIf",m.emailsListControl.invalid&&!m.hideError))},dependencies:[We.NgForOf,We.NgIf,Le.VN,Le.QJ,He.PQ,xt.CK,d.ir,d.lw,d.IP,d.Y6,ut.v_,X.Fj,X.JJ,X.oH,yt._,It.O,Ke.A,Ft.s,We.AsyncPipe],styles:['[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{border:0px solid;width:min-content;min-height:32px;padding:6px 8px!important;margin:0!important;box-sizing:border-box;caret-color:auto;line-height:1.4}[_nghost-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{display:block;line-height:1.125}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]{max-width:100%;display:flex}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]     .mat-chip-list-wrapper{max-width:100%;margin:0}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]   .chips-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-height:190px;overflow:auto}[_nghost-%COMP%]   .inputIcon[_ngcontent-%COMP%]{padding:0 8px}[_nghost-%COMP%]     .mat-chip{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);font-weight:400;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis}[_nghost-%COMP%]     .mat-standard-chip{min-height:24px!important}[_nghost-%COMP%]     .mat-standard-chip.mat-chip-with-trailing-icon{padding:0 2px 0 0!important}[_nghost-%COMP%]     .mat-standard-chip .mat-chip-remove{height:12px!important}[_nghost-%COMP%]     .mat-form-field-appearance-standard, [_nghost-%COMP%]     .mat-form-field-wrapper, [_nghost-%COMP%]     .mat-form-field-flex{padding:0}[_nghost-%COMP%]     .mat-form-field-infix{border:0px;padding:0;width:min-content;min-height:32px}[_nghost-%COMP%]     .mat-form-field-appearance-standard .mat-form-field-flex, [_nghost-%COMP%]     .mat-chip-list-wrapper{padding-top:0!important;padding-bottom:0!important}[_nghost-%COMP%]     user-details-host{width:calc(100% - 24px)}[_nghost-%COMP%]     user-details{width:100%}[_nghost-%COMP%]     .user-info{width:calc(100% - 29px)}[_nghost-%COMP%]     .user-name, [_nghost-%COMP%]     .user-email{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]{display:flex;flex-flow:wrap}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{opacity:1;color:var(--colorNeutralForeground4, #707070)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{border:1px solid var(--fluent-theme-neutral-tertia-color, #A19F9D);border-radius:2px;background-color:var(--fluent-theme-white-color, #FFF)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]:hover{border-color:var(--fluent-theme-black-color, #000)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]:focus-within{border:2px solid var(--colorNeutralStrokeFocus2)}[_nghost-%COMP%]   .autoCompleteSpinner[_ngcontent-%COMP%]{position:absolute;top:4px;right:6px;overflow:auto}.invalid[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{border-color:var(--fluent-theme-error-dark-color, #A80000)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-light-color, #EDEBE9)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:none}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{width:100%}html:not([dir="rtl"])   .disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{margin-right:12px}html[dir="rtl"]   .disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{margin-left:12px}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--colorNeutralForegroundDisabled, #bdbdbd)}user-details-host[_ngcontent-%COMP%]     .user-email, user-details-host[_ngcontent-%COMP%]     .user-name{line-height:16px}.mat-option.mat-active[_ngcontent-%COMP%]{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.x-screen-reader[_ngcontent-%COMP%]{position:absolute!important;overflow:hidden!important;clip:rect(1px,1px,1px,1px)!important;width:1px!important;height:1px!important;border:0!important;padding:0!important;margin:0!important}'],changeDetection:0}),L}(k.w)},50932:function(De,J,p){p.d(J,{F:function(){return ne}}),p(93864),p(94120),p(82775);var R=p(59051),D=p(21661),M=p(77476),X=p(17174),d=p(94908),B=p(34895),F=p(89075),k=p(87650),T=p(56545),w=p(52040),W=p(93367),ae=p(16095),x=p(70137),Y=p(88717),S=p(68264),Q=p(6342),q=p(50423);function Z(he){return function(){return he.scrollStrategies.close()}}var ne=function(){function he(){}return he.\u0275fac=function(Ae){return new(Ae||he)},he.\u0275mod=q.\u0275\u0275defineNgModule({type:he}),he.\u0275inj=q.\u0275\u0275defineInjector({providers:[{provide:d.g8,deps:[R.aV],useFactory:Z}],imports:[M.CommonModule,B.D8,F.yD,k.wp,X.UX,D.Cl,S.z,W.U,x.F,T.g,Q.N,Y.R,w.x,ae.Z]}),he}()},60353:function(De,J,p){p.d(J,{C:function(){return se}});var I=p(95867),e=p(5207);function se(w){return{tables:R(w).map(function(W){return function(w){return{name:w.name,isUserTable:(0,I.$i)(w),description:w.description,columns:w.columns?w.columns.map(function(W){return function(w){return{name:w.name,isUserColumn:(0,I.rh)(w),description:w.description,variationTable:d(w)}}(W)}):[],measures:w.measures?w.measures.map(function(W){return function(w){return{name:w.name,description:w.description,expression:w.expression,isExternal:!!w.sourceLineageTag}}(W)}):[],calendars:w.calendars?w.calendars.map(function(W){return function(w){return{name:w.name}}(W)}):[]}}(W)}),relationships:w.relationships?D(w).map(function(W){return function(w){return{active:w.isActive,from:{table:w.fromTable.name,column:w.fromColumn?w.fromColumn.name:void 0,cardinality:T(w.fromCardinality)},to:{table:w.toTable.name,column:w.toColumn?w.toColumn.name:void 0,cardinality:T(w.toCardinality)}}}(W)}):[]}}function R(w){return w.tables.filter(function(W){return W.schemaName!==e._.DataWarehouseSchema})}function D(w){return w.relationships.filter(function(W){return W.fromTable.schemaName!==e._.DataWarehouseSchema&&W.toTable.schemaName!==e._.DataWarehouseSchema})}function d(w){if(w.variations&&w.variations.length>0)return w.variations[0].relationship.toTable.name}function T(w){switch(w){case"Many":case"None":return"many";case"One":return"one"}}},4516:function(De,J,p){p.d(J,{qb:function(){return Ti}});var et,Ve,Ze,je,We,Le,He,I=p(11105),se=(p(81337),p(35510)),S=(p(11547),p(41198),p(48787),p(14172),p(59822),p(60134),p(69712),p(98665),p(50423)),Z=(p(54729),p(32293)),Ae=(p(18942),p(65181),p(59968),p(22844),p(37419)),ct=p(1108),Fe=p(59051),dt=p(22760),it=p(48138),Ee=p(77476),Ge=p(51193);function xt(G,j){}var ut_params_enterAnimationDuration="150ms",ut_params_exitAnimationDuration="75ms",yt=function(G){function j(){var H;return(H=G.apply(this,arguments)||this).enterAnimationDuration=Z._H.params.enterAnimationDuration,H.exitAnimationDuration=Z._H.params.exitAnimationDuration,H}return(0,Ae.Z)(j,G),j}(Z.vA),It=function(G){(0,Ae.Z)(H,G);var j=H.prototype;function H(te,oe,de,ve,ke,Ie,Xe,tt,Ne){var Ye;return(Ye=G.call(this,te,oe,de,ve,ke,Ie,Xe,Ne)||this)._changeDetectorRef=tt,Ye._state="enter",Ye}return j._onAnimationDone=function(oe){var de=oe.toState,ve=oe.totalTime;"enter"===de?this._openAnimationDone(ve):"exit"===de&&this._animationStateChanged.next({state:"closed",totalTime:ve})},j._onAnimationStart=function(oe){var de=oe.toState,ve=oe.totalTime;"enter"===de?this._animationStateChanged.next({state:"opening",totalTime:ve}):("exit"===de||"void"===de)&&this._animationStateChanged.next({state:"closing",totalTime:ve})},j._startExitAnimation=function(){this._state="exit",this._changeDetectorRef.markForCheck()},j._getAnimationState=function(){return{value:this._state,params:{enterAnimationDuration:this._config.enterAnimationDuration||ut_params_enterAnimationDuration,exitAnimationDuration:this._config.exitAnimationDuration||ut_params_exitAnimationDuration}}},H}(Z.X2);(et=It).\u0275fac=function(j){return new(j||et)(S.\u0275\u0275directiveInject(S.ElementRef),S.\u0275\u0275directiveInject(Ge.qV),S.\u0275\u0275directiveInject(Ee.DOCUMENT,8),S.\u0275\u0275directiveInject(yt),S.\u0275\u0275directiveInject(Ge.ic),S.\u0275\u0275directiveInject(S.NgZone),S.\u0275\u0275directiveInject(Fe.Iu),S.\u0275\u0275directiveInject(S.ChangeDetectorRef),S.\u0275\u0275directiveInject(Ge.tE))},et.\u0275cmp=S.\u0275\u0275defineComponent({type:et,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-dialog-container"],hostVars:7,hostBindings:function(j,H){1&j&&S.\u0275\u0275syntheticHostListener("@dialogContainer.start",function(oe){return H._onAnimationStart(oe)})("@dialogContainer.done",function(oe){return H._onAnimationDone(oe)}),2&j&&(S.\u0275\u0275hostProperty("id",H._config.id),S.\u0275\u0275attribute("aria-modal",H._config.ariaModal)("role",H._config.role)("aria-labelledby",H._config.ariaLabel?null:H._ariaLabelledByQueue[0])("aria-label",H._config.ariaLabel)("aria-describedby",H._config.ariaDescribedBy||null),S.\u0275\u0275syntheticHostProperty("@dialogContainer",H._getAnimationState()))},features:[S.\u0275\u0275InheritDefinitionFeature],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(j,H){1&j&&S.\u0275\u0275template(0,xt,0,0,"ng-template",0)},dependencies:[dt.Pl],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions.mat-dialog-actions-align-center,.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions.mat-dialog-actions-align-end,.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}"],encapsulation:2,data:{animation:[Z.Nv.dialogContainer]}});var Ke=function(G){function j(){return G.apply(this,arguments)||this}return(0,Ae.Z)(j,G),j}(Z.so),Ft=new S.InjectionToken("MatDialogData"),Pt=new S.InjectionToken("mat-dialog-default-options"),Ce=new S.InjectionToken("mat-dialog-scroll-strategy"),U={provide:Ce,deps:[Fe.aV],useFactory:function(G){return function(){return G.scrollStrategies.block()}}},P=function(G){function j(H,te,oe,de,ve,ke,Ie,Xe){var tt;return(tt=G.call(this,H,te,de,ke,Ie,ve,Ke,It,Ft,Xe)||this).dialogConfigClass=yt,tt}return(0,Ae.Z)(j,G),j}(Z.Se);(Ve=P).\u0275fac=function(j){return new(j||Ve)(S.\u0275\u0275inject(Fe.aV),S.\u0275\u0275inject(S.Injector),S.\u0275\u0275inject(Ee.Location,8),S.\u0275\u0275inject(Pt,8),S.\u0275\u0275inject(Ce),S.\u0275\u0275inject(Ve,12),S.\u0275\u0275inject(Fe.Xj),S.\u0275\u0275inject(S.ANIMATION_MODULE_TYPE,8))},Ve.\u0275prov=S.\u0275\u0275defineInjectable({token:Ve,factory:Ve.\u0275fac});var O=0;(Ze=function(){function G(H,te,oe){this.dialogRef=H,this._elementRef=te,this._dialog=oe,this.type="button"}var j=G.prototype;return j.ngOnInit=function(){this.dialogRef||(this.dialogRef=mt(this._elementRef,this._dialog.openDialogs))},j.ngOnChanges=function(te){var oe=te._matDialogClose||te._matDialogCloseResult;oe&&(this.dialogResult=oe.currentValue)},j._onButtonClick=function(te){(0,Z.RI)(this.dialogRef,0===te.screenX&&0===te.screenY?"keyboard":"mouse",this.dialogResult)},G}()).\u0275fac=function(j){return new(j||Ze)(S.\u0275\u0275directiveInject(Ke,8),S.\u0275\u0275directiveInject(S.ElementRef),S.\u0275\u0275directiveInject(P))},Ze.\u0275dir=S.\u0275\u0275defineDirective({type:Ze,selectors:[["","mat-dialog-close",""],["","matDialogClose",""]],hostVars:2,hostBindings:function(j,H){1&j&&S.\u0275\u0275listener("click",function(oe){return H._onButtonClick(oe)}),2&j&&S.\u0275\u0275attribute("aria-label",H.ariaLabel||null)("type",H.type)},inputs:{ariaLabel:["aria-label","ariaLabel"],type:"type",dialogResult:["mat-dialog-close","dialogResult"],_matDialogClose:["matDialogClose","_matDialogClose"]},exportAs:["matDialogClose"],features:[S.\u0275\u0275NgOnChangesFeature]}),(je=function(){function G(H,te,oe){this._dialogRef=H,this._elementRef=te,this._dialog=oe,this.id="mat-dialog-title-"+O++}var j=G.prototype;return j.ngOnInit=function(){var te=this;this._dialogRef||(this._dialogRef=mt(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(function(){var oe;null==(oe=te._dialogRef._containerInstance)||null==(oe=oe._ariaLabelledByQueue)||oe.push(te.id)})},j.ngOnDestroy=function(){var te,oe=this,de=null==(te=this._dialogRef)||null==(te=te._containerInstance)?void 0:te._ariaLabelledByQueue;de&&Promise.resolve().then(function(){var ve=de.indexOf(oe.id);ve>-1&&de.splice(ve,1)})},G}()).\u0275fac=function(j){return new(j||je)(S.\u0275\u0275directiveInject(Ke,8),S.\u0275\u0275directiveInject(S.ElementRef),S.\u0275\u0275directiveInject(P))},je.\u0275dir=S.\u0275\u0275defineDirective({type:je,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-dialog-title"],hostVars:1,hostBindings:function(j,H){2&j&&S.\u0275\u0275hostProperty("id",H.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]});function mt(G,j){for(var H=G.nativeElement.parentElement;H&&!H.classList.contains("mat-dialog-container");)H=H.parentElement;return H?j.find(function(te){return te.id===H.id}):null}(We=function(){}).\u0275fac=function(j){return new(j||We)},We.\u0275dir=S.\u0275\u0275defineDirective({type:We,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-dialog-content"]}),(Le=function(){this.align="start"}).\u0275fac=function(j){return new(j||Le)},Le.\u0275dir=S.\u0275\u0275defineDirective({type:Le,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-dialog-actions"],hostVars:4,hostBindings:function(j,H){2&j&&S.\u0275\u0275classProp("mat-dialog-actions-align-center","center"===H.align)("mat-dialog-actions-align-end","end"===H.align)},inputs:{align:"align"}}),(He=function(){}).\u0275fac=function(j){return new(j||He)},He.\u0275mod=S.\u0275\u0275defineNgModule({type:He}),He.\u0275inj=S.\u0275\u0275defineInjector({providers:[P,U],imports:[ct.Su,Fe.U8,dt.eL,it.BQ,it.BQ]});var N=p(41114),L="PBI.CES.TryShowSurveyToast",g=(N.cx[L]=(0,N.b1)(L),"PBI.CES.TryShowSurveyDialog"),b=(N.cx[g]=(0,N.b1)(g),"PBI.CES.GetBaseUrl"),A=(N.cx[b]=(0,N.b1)(b),"PBI.CES.LoadExternalScript"),ee=(N.cx[A]=(0,N.b1)(A),"PBI.CES.RenderSurvey"),Pe=(N.cx[ee]=(0,N.b1)(ee),"PBI.CES.DismissToast"),Oe=(N.cx[Pe]=(0,N.b1)(Pe),"PBI.CES.ShareFeedbackClick"),pt=(N.cx[Oe]=(0,N.b1)(Oe),"PBI.CES.GetEligibility"),hn=(N.cx[pt]=(0,N.b1)(pt),"PBI.CES.PostEventAndGetEligibility"),ot=(N.cx[hn]=(0,N.b1)(hn),"PBI.CES.PostEvent"),jt=(N.cx[ot]=(0,N.b1)(ot),"PBI.CES.PostPatchFeedback"),Yt=(N.cx[jt]=(0,N.b1)(jt),"PBI.CES.TakeSurveyClick"),rn=(N.cx[Yt]=(0,N.b1)(Yt),p(9380),p(58938),p(73875),p(17497),p(27887),p(85732),window,new se.X(!1),p(14714)),Ti=(p(28687),p(71234),p(42790),p(94759),p(89053),p(83019),p(66525),p(77200),window,p(81905),p(89424),p(40682),p(96608),{provide:rn.vb,useFactory:function(){return(0,I.Z)()}})},52042:function(De,J,p){p.d(J,{c:function(){return R}});var I=p(81337),e=p(79571),se=p(79590),R=(0,I.__spreadArray)([se.Q],(0,e.ik)(),!0)},79590:function(De,J,p){p.d(J,{Q:function(){return S}});var I=p(81337),e=p(82762),se=p(60225),R=p(50423),D=p(48787),M=p(24874),X=p(81905),d=p(59822),B=p(17653),F=p(18353),k=p(57243),T=p(30940),w=p(76072),W=p(62458),ae=p(14714),x=p(9380),Y={answerQuestion:{aggregationProperty:"answer"},copilotSummary:{aggregationProperty:"summary"},aiNarrative:{aggregationProperty:"summary"}},S=function(){function Q(q,Z){this.featureSwitch=q,this.copilotUsageMetadataService=Z,this.pbiCopilotProxyPath=(0,R.inject)(T.Z,{optional:!0}),this.lazyProvider=(0,R.inject)(w.E)}return Q.prototype.runScenario=function(q,Z,re){var ne=this;return void 0===re&&(re={}),this.copilotUsageMetadataService.currentCopilotUsageMetadata$.pipe((0,D.q)(1),(0,M.b)(function(he){return(0,e.D)(ne.getProxyService()).pipe((0,X.w)(function(){var _e;return ne.getScenarioResponse(q,(0,I.__assign)((0,I.__assign)({scenarioDefinition:(_e={},_e[q]=Z,_e)},he),{isUserInitiatedRetry:re.isUserInitiatedRetry}),re.stream)}),(0,d.K)(function(_e){return(0,se._)(_e)}))}))},Q.prototype.getScenarioResponse=function(q,Z,re){var ne;if(!Z.scenarioDefinition[q])throw W.fF.assertFail("Expected request to contain parameters"),{code:"CopilotScenarioParameters_NotAvailable"};if(re){var he=null===(ne=Y[q])||void 0===ne?void 0:ne.aggregationProperty;return this.proxyService.runScenario(Z,re).pipe((0,B.b)(function(Ae){if("string"!=typeof Ae[he])throw W.fF.assertFail("Expected response to contain '".concat(he.toString(),"' string property")),{code:"CopilotScenario_NotAvailable"}}),(0,F.R)(function(Ae,ct){var Fe,dt=Ae?Ae[he].toString()+ct[he].toString():ct[he];return(0,I.__assign)((0,I.__assign)({},ct),((Fe={})[he]=dt,Fe))}),(0,k.d)({bufferSize:1,refCount:!0}))}return this.proxyService.runScenario(Z,re)},Q.prototype.getCopilotScenarioModel=function(){var q=1;return this.featureSwitch.featureSwitches.aiNarrativesGPT4o?q=6:this.featureSwitch.featureSwitches.aiNarrativesGPT4_32K?q=3:this.featureSwitch.featureSwitches.aiNarrativesGPT4Turbo?q=5:this.featureSwitch.featureSwitches.aiNarrativesGPT4?q=2:this.featureSwitch.featureSwitches.aiNarrativesDV3&&(q=4),q},Q.prototype.getProxyService=function(){return(0,I.__awaiter)(this,void 0,void 0,function(){var q;return(0,I.__generator)(this,function(Z){switch(Z.label){case 0:return q=this,[4,this.lazyProvider.get(this.pbiCopilotProxyPath||"@powerbi/PBICopilotWeb/pbicopilot-web.module#PBICopilotWebModule","copilotScenarioProxyService")];case 1:return q.proxyService=Z.sent(),[2,this.proxyService]}})})},Q.\u0275fac=function(Z){return new(Z||Q)(R.\u0275\u0275inject(x.vZ),R.\u0275\u0275inject(ae.K$))},Q.\u0275prov=R.\u0275\u0275defineInjectable({token:Q,factory:Q.\u0275fac}),Q}()},83019:function(De,J,p){p.d(J,{C_:function(){return d},P0:function(){return Ze},T4:function(){return We},fD:function(){return He},ob:function(){return se},yI:function(){return D}});var I=p(41114),e="PBI.Copilot.CompletionEvent",se=I.cx[e]=(0,I.b1)(e),R="PBI.Copilot.EmbeddingEvent",D=I.cx[R]=(0,I.b1)(R),M="PBI.Copilot.StreamCompletionEvent",X="PBI.Copilot.ChatCompletionEvent",d=I.cx[X]=(0,I.b1)(X),F=(I.cx[M]=(0,I.b1)(M),"PBI.Copilot.GetSerializedSchema"),T=(I.cx[F]=(0,I.b1)(F),"PBI.Copilot.UndoSkill"),W=(I.cx[T]=(0,I.b1)(T),"PBI.Copilot.RetrySkill"),x=(I.cx[W]=(0,I.b1)(W),"PBI.Copilot.ZeroPromptAction"),S=(I.cx[x]=(0,I.b1)(x),"PBI.Copilot.PromptGuideAction"),q=(I.cx[S]=(0,I.b1)(S),"PBI.Copilot.SkillSetExecution"),re=(I.cx[q]=(0,I.b1)(q),"PBI.Copilot.UserTurn"),he=(I.cx[re]=(0,I.b1)(re),"PBI.Copilot.CopilotTurn"),Ae=(I.cx[he]=(0,I.b1)(he),"PBI.Copilot.CopilotTurnSkillExecution"),Fe=(I.cx[Ae]=(0,I.b1)(Ae),"PBI.Copilot.AggregationError"),it=(I.cx[Fe]=(0,I.b1)(Fe),"PBI.Copilot.NonRetriableError"),Ge=(I.cx[it]=(0,I.b1)(it),"PBI.Copilot.RetriableError"),Ve=(I.cx[Ge]=(0,I.b1)(Ge),"PBI.Copilot.FeedbackDialog"),Ze=I.cx[Ve]=(0,I.b1)(Ve),je="PBI.Copilot.FeedbackDialogError",We=I.cx[je]=(0,I.b1)(je),Le="PBI.Copilot.FeedbackDialogView",He=I.cx[Le]=(0,I.b1)(Le)},47754:function(De,J,p){p.d(J,{L:function(){return x}});var I=p(82515),e=p(14463),se=p(34410),R=p(59055),D=p(38078),M=p(98665),X=p(76609),d=p(50423),B=p(27887),F=p(32140),k=p(18942),T=p(85732),x=function(){function Y(S,Q,q,Z,re,ne,he,_e){this.applicationOptions=S,this.userInfo=Q,this.userProfileImageService=q,this.telemetryService=Z,this.sanitizer=re,this.store=ne,this.groupPhotos=[],this.userPhotos=[],this.findGroupIconPromises=[],this.getOtherUserPhotoPromises=[],this.getGroupIconPromises=[],this.userMetadataHttpService=he,this.promiseFactory=_e}return Y.prototype.getGroupIcons=function(S){var Q=this;if(void 0===S&&(S=4900),this.groupIconsPromise)return this.groupIconsPromise;var q=this.promiseFactory.defer();return setTimeout(function(){var Z=Q.telemetryService.startEvent(R.Sj);Q.userMetadataHttpService.getUserGroupIcons(Z.event).toPromise().then(function(re){re.data&&(q.resolve(re.data),Q.store.dispatch(new I.YI({groupIcons:re.data})))},function(){q.reject()})},S),this.groupIconsPromise=q.promise,q.promise},Y.prototype.getGroupIcon=function(S,Q){var q=this;void 0===Q&&(Q=4900);var Z=_.find(this.getGroupIconPromises,function(he){return he.groupObjectId===S});if(Z)return Z.promise;var re=this.promiseFactory.defer(),ne=this.applicationOptions.isE2ERun?this.getRejectedHttpResultPromiseWithNotFound():this.userMetadataHttpService.getGroupIcon(S).toPromise();return setTimeout(function(){ne.then(function(he){if(he.data){var _e=q.base64Enconding(he.data.groupIcon);re.resolve(_e),q.groupPhotos.push({groupObjectId:S,groupIcon:_e})}else re.reject()},function(he){q.resultHasStatusEquivalentOfNotFound(he.status)?(re.resolve(""),q.groupPhotos.push({groupObjectId:S,groupIcon:""})):re.reject()})},Q),this.getGroupIconPromises.push({groupObjectId:S,promise:re.promise}),re.promise},Y.prototype.getUserPhoto=function(){var S=this;if(this._userPhotoPromise)return this._userPhotoPromise;var Q=this.userProfileImageService.getUserPhoto();return this._userPhotoPromise=Q,Q.then(function(q){S.userPhotos.push({userObjectId:S.userInfo.puid,userIcon:q});var Z=q.substring(4,q.length-1),re=S.sanitizer.bypassSecurityTrustUrl(Z);S.store.dispatch(new I.Ar(re))},function(q){if(q.name!==X.SJ)throw q}),Q},Y.prototype.getOtherUserPhoto=function(S){var Q=this,q=_.find(this.getOtherUserPhotoPromises,function(ne){return ne.userObjectId===S});if(q)return q.promise;var Z=this.promiseFactory.defer();return(this.applicationOptions.isE2ERun?this.getRejectedHttpResultPromiseWithNotFound():this.userMetadataHttpService.getOtherUserPhoto(S).toPromise()).then(function(ne){if(ne.data.type===D.JA){var he=URL.createObjectURL(ne.data);return Z.resolve(he),void Q.userPhotos.push({userObjectId:S,userIcon:he})}Z.reject()},function(ne){Q.resultHasStatusEquivalentOfNotFound(ne.status)?(Z.resolve(""),Q.userPhotos.push({userObjectId:S,userIcon:""})):Z.reject()}),this.getOtherUserPhotoPromises.push({userObjectId:S,promise:Z.promise}),Z.promise},Y.prototype.findGroupIcon=function(S,Q){var q=this,Z=_.find(this.findGroupIconPromises,function(ne){return ne.groupObjectId===S});if(Z)return Z.promise;var re=this.promiseFactory.defer();return this.getGroupIcons(Q).then(function(ne){var he=_.find(ne,function(Ae){return Ae.groupObjectId===S});if(he){var _e=q.base64Enconding(he.groupIcon);re.resolve(_e),q.groupPhotos.push({groupObjectId:S,groupIcon:_e})}else re.reject("Group with objectid "+S+" has no icon")},function(){re.reject()}),this.findGroupIconPromises.push({groupObjectId:S,promise:re.promise}),re.promise},Y.prototype.findOrGetGroupPhoto=function(S){var Q=this,q=this.promiseFactory.defer(),Z=_.find(this.groupPhotos,function(re){return re.groupObjectId===S});return Z?""!==Z.groupIcon?q.resolve(Z.groupIcon):q.reject():this.findGroupIcon(S).then(function(re){q.resolve(re)},function(){Q.getGroupIcon(S).then(function(re){q.resolve(re)},function(re){q.reject()})}),q.promise},Y.prototype.findOrGetUserPhoto=function(S){var Q=this.promiseFactory.defer(),q=_.find(this.userPhotos,function(Z){return Z.userObjectId===S});return q?""!==q.userIcon?Q.resolve(q.userIcon):Q.reject():S===this.userInfo.puid?this._userPhotoPromise&&this._userPhotoPromise.then(function(Z){Q.resolve(Z)}):this.getOtherUserPhoto(S).then(function(Z){Z?Q.resolve(Z):Q.reject()}),Q.promise},Y.prototype.base64Enconding=function(S){return"data:image/jpeg;base64,"+S},Y.prototype.resultHasStatusEquivalentOfNotFound=function(S){return 404===S||400===S||500===S},Y.prototype.getRejectedHttpResultPromiseWithNotFound=function(){return this.promiseFactory.reject({data:{},status:404,headers:function(){return""}})},Y.\u0275fac=function(Q){return new(Q||Y)(d.\u0275\u0275inject(B.V),d.\u0275\u0275inject(F.a),d.\u0275\u0275inject(X.lH),d.\u0275\u0275inject(M.y0),d.\u0275\u0275inject(k.H7),d.\u0275\u0275inject(T.yh),d.\u0275\u0275inject(se.y),d.\u0275\u0275inject(e.t))},Y.\u0275prov=d.\u0275\u0275defineInjectable({token:Y,factory:Y.\u0275fac,providedIn:"root"}),Y}()},21e3:function(De,J,p){p.d(J,{H:function(){return B}});var I=p(82762),e=p(33554),se=p(9936),R=p(14172),D=p(48787),M=p(50423),X=p(47754),d=p(15910),B=function(){function F(k,T){this.profileImageService=k,this.userHttpService=T,this.usersCache={}}return F.prototype.getUserPhoto=function(k){return(0,I.D)(this.profileImageService.getOtherUserPhoto(k))},F.prototype.getUserDetails=function(k){var T=this;k=_.filter(k,function(Q){return!!Q});var w=[],W=[];if(_.isEmpty(k))return(0,I.D)([]);for(var ae=0,x=k;ae<x.length;ae++){var S=x[ae].toLowerCase();this.usersCache[S]||(this.usersCache[S]=new e.t(1),W.push(S)),w.push(this.usersCache[S])}return _.isEmpty(W)||this.userHttpService.getUserDetails(W).pipe((0,D.q)(1)).subscribe(function(Q){var q={};if(_.some(Q?.data))for(var Z=0,re=Q?.data;Z<re.length;Z++){var _e=(ne=re[Z]).userPrincipalName,Ae=ne.objectId;T.upsert(ne.emailAddress,ne,q),T.upsert(_e,ne,q),T.upsert(Ae,ne,q)}for(var Fe=0,dt=_.filter(W,function(it){return!q[it]});Fe<dt.length;Fe++){var ne;T.usersCache[ne=dt[Fe]].next(void 0),T.usersCache[ne].complete()}},function(){for(var Q,q,Z=0,re=W;Z<re.length;Z++){var ne=re[Z];null===(Q=T.usersCache[ne])||void 0===Q||Q.next(void 0),null===(q=T.usersCache[ne])||void 0===q||q.complete(),delete T.usersCache[ne]}}),(0,se.D)(w).pipe((0,R.U)(function(Q){return _.filter(Q,function(q){return!!q})}))},F.prototype.findUsers=function(k,T){return this.userHttpService.findUsers(k,1,T,!0,!0).pipe((0,R.U)(function(w){return w?.data}))},F.prototype.upsert=function(k,T,w){if(k){var W=k.toLowerCase();this.usersCache[W]||(this.usersCache[W]=new e.t(1)),this.usersCache[W].next(T),this.usersCache[W].complete(),w[W]=!0}},F.\u0275fac=function(T){return new(T||F)(M.\u0275\u0275inject(X.L),M.\u0275\u0275inject(d.W))},F.\u0275prov=M.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac,providedIn:"root"}),F}()},6342:function(De,J,p){p.d(J,{N:function(){return F}});var I=p(21e3),e=p(77476),se=p(10723),R=p(79061),D=p(76037),M=p(56545),X=p(88717),d=p(68264),B=p(50423),F=function(){function k(){}return k.\u0275fac=function(w){return new(w||k)},k.\u0275mod=B.\u0275\u0275defineNgModule({type:k}),k.\u0275inj=B.\u0275\u0275defineInjector({providers:[{provide:se.K,useClass:I.H}],imports:[e.CommonModule,R.v,D.J,M.g,X.R,d.z]}),k}()},23873:function(De,J,p){p.d(J,{o:function(){return L}});var I=p(81337),e=p(50423),se=p(21661),R=p(30794),D=p(83317),M=p(3307),X=p(17653),d=p(77526),B=p(59973),F=p(48787),k=p(12587),T=p(35510),w=p(74466);function x(h,g,m){return(0,w.ZP)(h,function(b){-1===b.start.column&&(b.start.column=0,b.end.column=m-1),-1===b.start.row&&(b.start.row=0,b.end.row=g-1),b.start.row=Math.max(0,Math.min(b.start.row,g-1)),b.start.column=Math.max(0,Math.min(b.start.column,m-1)),b.end.row=Math.max(0,Math.min(b.end.row,g-1)),b.end.column=Math.max(0,Math.min(b.end.column,m-1))})}function Y(h,g){switch(g){case"Date":if(h){_.isString(h)&&(h=h.replace(/\//g,"-"));var m=new Date(h);if(_.isFinite(m.getTime()))return m}return;case"Number":return _.isFinite(parseFloat(h))?parseFloat(h):void 0;default:return h}}(0,w.Fl)(!1);var S=function(){function h(){this._columns$=new T.X([]),this._rows$=new T.X([])}return Object.defineProperty(h.prototype,"columns",{get:function(){return this._columns$.value},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"rows",{get:function(){return this._rows$.value},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"rows$",{get:function(){return this._rows$.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"columns$",{get:function(){return this._columns$.asObservable()},enumerable:!1,configurable:!0}),h.prototype.setColumns=function(g){this._columns$.next(g||[])},h.prototype.setRows=function(g){this._rows$.next(g||[])},h.prototype.appendRow=function(){this.ensureRows(this.rows.length+1)},h.prototype.ensureRows=function(g){var m=this.rows;g<=m.length||this.setRows((0,I.__spreadArray)((0,I.__spreadArray)([],m,!0),_.map(new Array(g-m.length),function(){return[]}),!0))},h.prototype.setCellData=function(g,m){if(this.isValidCell(g)){var b=this.rows,y=(0,I.__spreadArray)((0,I.__spreadArray)((0,I.__spreadArray)([],_.slice(b,0,g.row),!0),[(0,I.__spreadArray)([],b[g.row],!0)],!1),_.slice(b,g.row+1,b.length),!0);y[g.row][g.column]=m,this.setRows(y)}},h.prototype.deleteRows=function(g,m){var b=this.rows;this.setRows((0,I.__spreadArray)((0,I.__spreadArray)([],_.slice(b,0,g),!0),_.slice(b,g+m,b.length),!0))},h.prototype.emptyRange=function(g){var m=this;this.setRows((0,w.Uy)(this.rows,function(b){for(var y=(g=x(g,m.rows.length,m.columns.length)).start.row;y<=g.end.row;y++)for(var A=g.start.column;A<=g.end.column;A++)b[y][A]=null}))},h.prototype.isValidCell=function(g){return!(!_.isFinite(g.row)||!_.isFinite(g.column)||g.row>=this._rows$.value.length||g.column>=this._columns$.value.length||g.row<0||g.column<0)},h.\u0275prov=e.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac=function(m){return new(m||h)}}),h}(),Q=function(){function h(g){this.dataSource=g,this._editingCell$=new T.X(void 0),this._isReadOnly$=new T.X(!1),this.isReadOnly$=this._isReadOnly$.asObservable()}return Object.defineProperty(h.prototype,"isReadOnly",{get:function(){return!!this._isReadOnly$.value},enumerable:!1,configurable:!0}),h.prototype.setReadOnly=function(g){this.cancelEditing(),this._isReadOnly$.next(!!g)},Object.defineProperty(h.prototype,"editingCell$",{get:function(){return this._editingCell$.asObservable()},enumerable:!1,configurable:!0}),h.prototype.isEditing=function(){return!!this._editingCell$.value},h.prototype.isEditingCell=function(g){var m=this._editingCell$.value;return!!m&&!!g&&g.column===m.column&&g.row===m.row},h.prototype.tryEditCell=function(g,m){this.isEditingCell(g)||this.isReadOnly||this.editCell(g,m)},h.prototype.editCell=function(g,m){this.commitPendingEdit(),this.dataSource.isValidCell(g)&&this._editingCell$.next({column:g.column,row:g.row,data:_.isNil(m)?this.dataSource.rows[g.row][g.column]:m})},h.prototype.setEditingData=function(g){var m,b,y,A=void 0===(b=(m=this._editingCell$.value||{}).row)?0:b,K=void 0===(y=m.column)?0:y;this._editingCell$.next({data:g,row:A,column:K})},h.prototype.commitPendingEdit=function(){var g=this._editingCell$.value;g&&(this.dataSource.setCellData(g,g.data),this._editingCell$.next(void 0))},h.prototype.cancelEditing=function(){this._editingCell$.value&&this._editingCell$.next(void 0)},h.\u0275fac=function(m){return new(m||h)(e.\u0275\u0275inject(S))},h.\u0275prov=e.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac}),h}(),q=p(14172),Z=p(57243),re=function(){function h(g){var m=this;this.dataStore=g,this.currentSelection$=new T.X(void 0),this._enforceSelectingColumn=!1,this.normalizedSelection$=this.currentSelection$.pipe((0,q.U)(function(b){return m.normalizeSelection(b)}),(0,Z.d)({bufferSize:1,refCount:!0})),this.selectedCell$=this.currentSelection$.pipe((0,q.U)(function(b){return b&&{column:b.start.column,row:b.start.row}}),(0,Z.d)({bufferSize:1,refCount:!0}))}return Object.defineProperty(h.prototype,"selectedCell",{get:function(){var m;return this.selectedCell$.pipe((0,F.q)(1)).subscribe(function(b){return m=b}),m},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"normalizedSelection",{get:function(){var m;return this.normalizedSelection$.pipe((0,F.q)(1)).subscribe(function(b){return m=b}),m},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"selection",{get:function(){return this.currentSelection$.value},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"enforceSelectingColumn",{set:function(m){this._enforceSelectingColumn=m},enumerable:!1,configurable:!0}),h.prototype.setSelection=function(g){g&&(this._enforceSelectingColumn&&(g.start={row:-1,column:g.start.column},g.end={row:-1,column:g.start.column}),g.start=this.normalizeCell(g.start),g.end=this.normalizeCell(g.end)),this.currentSelection$.next(g),this.clearFocus()},h.prototype.setFocus=function(g,m){this.ensureRowIsInVirtualScroll(g.row);var b=m.querySelector('[data-row="'.concat(g.row,'"][data-column="').concat(g.column,'"]'));b&&(b.focus(),this.focusedCell=g)},h.prototype.clearFocus=function(){this.focusedCell=void 0},h.prototype.ensureRowIsInVirtualScroll=function(g){var m=this.virtualScroll.getRenderedRange();g>=0&&(m.start>g||m.end<g)&&this.virtualScroll.scrollToIndex(g)},h.prototype.selectCell=function(g){g=this.normalizeCell(g),this.setSelection({start:g,end:g})},h.prototype.setSelectionStart=function(g){g=this.normalizeCell(g);var m=this.currentSelection$.value;this.setSelection({start:g,end:m?.end||g})},h.prototype.setSelectionEnd=function(g){g=this.normalizeCell(g);var m=this.currentSelection$.value;this.setSelection({start:m?.start||g,end:g})},h.prototype.selectAll=function(){this.selectCell({row:-1,column:-1})},h.prototype.normalizeCell=function(g){var m=this.dataStore.rows.length,b=this.dataStore.columns.length;return{row:_.isFinite(g?.row)?Math.max(-1,Math.min(g.row,m-1)):-1,column:_.isFinite(g?.column)?Math.max(-1,Math.min(g.column,b-1)):-1}},h.prototype.normalizeSelection=function(g){if(!_.isNil(g))return{start:{row:Math.min(g.start.row,g.end.row),column:Math.min(g.start.column,g.end.column)},end:{row:Math.max(g.start.row,g.end.row),column:Math.max(g.start.column,g.end.column)}}},h.\u0275fac=function(m){return new(m||h)(e.\u0275\u0275inject(S))},h.\u0275prov=e.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac}),h}(),ne=function(){function h(g,m,b){this.selectionService=g,this.dataSource=m,this.cellEditingService=b}return h.prototype.canCopyCurrentSelection=function(){return!!this.selectionService.normalizedSelection},h.prototype.copyCurrentSelection=function(g){return void 0===g&&(g=!1),(0,I.__awaiter)(this,void 0,void 0,function(){var m,ee;return(0,I.__generator)(this,function(me){switch(me.label){case 0:return(m=this.selectionService.normalizedSelection)?(ee=x({start:m.start||{row:0,column:0},end:m.end||{row:0,column:0}},this.dataSource.rows.length,this.dataSource.columns.length),[4,this.copy(ee.start,ee.end,!1,g)]):[2];case 1:return me.sent(),[2]}})})},h.prototype.copyAll=function(g){return(0,I.__awaiter)(this,void 0,void 0,function(){return(0,I.__generator)(this,function(K){switch(K.label){case 0:return[4,this.copy({row:0,column:0},{row:this.dataSource.rows.length-1,column:this.dataSource.columns.length-1},g)];case 1:return K.sent(),[2]}})})},h.prototype.copy=function(g,m,b,y){void 0===y&&(y=!1);var K=_.map(_.slice(this.dataSource.rows,g.row,m.row+1),function(pt){return _.slice(pt,g.column,m.column+1)}),ee=[];if(b){var me=_(this.dataSource.columns).map(function(pt){return pt.name}).slice(g.column,m.column+1).join("\t");ee.push(me)}for(var Pe=0,pe=K;Pe<pe.length;Pe++){var vt=_.join(pe[Pe].map(function(pt){return y?'"'+(pt??"").toString().trimStart().replace(/"/g,'""'):(pt??"").toString()}),"\t");ee.push(vt)}return navigator.clipboard.writeText(_.join(ee,"\r\n"))},h.prototype.pasteOverSelection=function(){return(0,I.__awaiter)(this,void 0,void 0,function(){var g,m,b,y,A,K;return(0,I.__generator)(this,function(ee){switch(ee.label){case 0:return!(g=this.selectionService.normalizedSelection)||this.cellEditingService.isReadOnly?[2]:[4,navigator.clipboard.readText()];case 1:return(m=ee.sent())?(0===(b=_.map(m.split(/\n|\r\n/),function(me){return me.split(/\t/)})).length||(y=this.dataSource.columns,(A=g.start||{row:0,column:0}).row=Math.max(0,A.row),A.column=Math.max(0,A.column),this.dataSource.ensureRows(A.row+b.length),K=(0,w.ZP)(this.dataSource.rows,function(me){for(var Pe=0;Pe<b.length;Pe++)for(var pe=A.column,Oe=0;pe<y.length&&Oe<b[Pe].length;pe++,Oe++){var vt=Y(b[Pe][Oe],y[pe].type);vt&&(me[A.row+Pe][pe]=vt)}}),this.dataSource.setRows(K),this.selectionService.setSelection({start:A,end:{row:A.row+b.length-1,column:A.column+b[0].length-1}})),[2]):[2]}})})},h.\u0275fac=function(m){return new(m||h)(e.\u0275\u0275inject(re),e.\u0275\u0275inject(S),e.\u0275\u0275inject(Q))},h.\u0275prov=e.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac}),h}(),he=function(h){return h.ArrowUp="ArrowUp",h.ArrowDown="ArrowDown",h.ArrowLeft="ArrowLeft",h.ArrowRight="ArrowRight",h}({}),_e=function(h){return h.Enter="Enter",h.Tab="Tab",h.Escape="Escape",h.Delete="Delete",h.Backspace="Backspace",h.F2="F2",h.Space=" ",h}({}),Ae=function(){function h(g,m,b,y){this.cellEditing=g,this.selectionService=m,this.dataSource=b,this.clipboardService=y}return h.prototype.keydown=function(g,m,b){var y=!1;"c"===g.key&&g.ctrlKey&&!this.cellEditing.isEditing()?(this.clipboardService.copyCurrentSelection(),y=!0):"v"===g.key&&g.ctrlKey&&!this.cellEditing.isEditing()?(this.clipboardService.pasteOverSelection(),y=!0):"a"===g.key&&g.ctrlKey&&!this.cellEditing.isEditing()?(this.selectionService.selectAll(),y=!0):g.key.match(/^[a-z0-9]$/i)?y=this.handleAlphaNumeric(g.key):g.key in he?y=g.altKey?this.handleColumnResize(g.key):this.handleArrowKey(g.key,(g.shiftKey||g.ctrlKey)&&b,m):g.key===_e.Enter?y=this.handleEnter(g):g.key===_e.Tab?y=this.handleTab():g.key===_e.Escape?y=this.handleEscape():g.key===_e.Delete||g.key===_e.Backspace?y=this.handleDelete():g.key===_e.F2?y=this.handleF2():g.key===_e.Space&&(y=this.handleSpace(g)),y&&(g.stopPropagation(),g.preventDefault())},h.prototype.handleF2=function(){var g=this.selectionService.selectedCell;return!(!g||this.cellEditing.isEditingCell(g)||this.cellEditing.isReadOnly||(this.cellEditing.tryEditCell(g),0))},h.prototype.handleAlphaNumeric=function(g){var m=this.selectionService.selectedCell;if(m&&!this.cellEditing.isEditingCell(m)&&!this.cellEditing.isReadOnly){var b=this.dataSource.columns[m.column];return this.cellEditing.tryEditCell(m,Y(g,b?.type)),!0}return!1},h.prototype.handleColumnResize=function(g){var m,b,y=null===(m=this.selectionService.focusedCell)||void 0===m?void 0:m.column;if(void 0!==y&&-1!==y){var A=null!==(b=this.dataSource.columns[y].width)&&void 0!==b?b:50,ee=this.dataSource.columns;switch(g){case he.ArrowLeft:ee[y].width=Math.max(A-1,45),this.dataSource.setColumns(ee);break;case he.ArrowRight:ee[y].width=A+1,this.dataSource.setColumns(ee)}}return!0},h.prototype.handleArrowKey=function(g,m,b){var y={row:-1,column:-1};if(this.selectionService.focusedCell)y={row:this.selectionService.focusedCell.row,column:this.selectionService.focusedCell.column};else{var A=this.selectionService.selection;A?.end&&m?y=(0,I.__assign)({},A.end):A?.start&&(y=(0,I.__assign)({},A.start))}switch(g){case he.ArrowUp:if(this.cellEditing.isEditing())return!1;y.row--;break;case he.ArrowDown:y.row++,this.cellEditing.isReadOnly||this.dataSource.ensureRows(y.row+1);break;case he.ArrowLeft:if(this.cellEditing.isEditing())return!1;y.column--;break;case he.ArrowRight:if(this.cellEditing.isEditing())return!1;y.column++}return m&&this.selectionService.setSelectionEnd(y),this.selectionService.setFocus(y,b),!0},h.prototype.handleTab=function(){return this.selectionService.clearFocus(),!1},h.prototype.handleEnter=function(g){var m,b,y=this.selectionService.focusedCell;if(y)return this.selectionService.selectCell(y),null===(m=g.target)||void 0===m||m.blur(),null===(b=g.currentTarget)||void 0===b||b.focus(),!0;var A=this.selectionService.selectedCell;if(A){if(this.cellEditing.isEditingCell(A)){var K={row:A.row+1,column:A.column};return this.dataSource.ensureRows(K.row+1),this.selectionService.selectCell(K),!0}if(!this.cellEditing.isReadOnly)return this.cellEditing.tryEditCell(A),!0}return!1},h.prototype.handleSpace=function(g){var m,b,y=this.selectionService.focusedCell;if(y)return this.selectionService.selectCell(y),null===(m=g.target)||void 0===m||m.blur(),null===(b=g.currentTarget)||void 0===b||b.focus(),!0;var A=this.selectionService.selectedCell;if(A){if(this.cellEditing.isEditingCell(A))return!1;if(!this.cellEditing.isReadOnly)return this.cellEditing.tryEditCell(A),!0}return!1},h.prototype.handleEscape=function(){return this.cellEditing.cancelEditing(),!0},h.prototype.handleDelete=function(){var g=this.selectionService.normalizedSelection;return!(!g||this.cellEditing.isEditing()||this.cellEditing.isReadOnly||(-1===g.start.column&&-1!==g.start.row?(this.dataSource.deleteRows(g.start.row,g.end.row-g.start.row+1),this.selectionService.selectCell({row:g.start.row,column:-1})):this.dataSource.emptyRange(g),0))},h.\u0275fac=function(m){return new(m||h)(e.\u0275\u0275inject(Q),e.\u0275\u0275inject(re),e.\u0275\u0275inject(S),e.\u0275\u0275inject(ne))},h.\u0275prov=e.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac}),h}(),ct=p(80786),Fe=function(){function h(g,m,b){this.cellEditing=g,this.selectionService=m,this.dataSource=b}return h.prototype.doubleClick=function(g,m){this.cellEditing.isEditingCell(m)||this.cellEditing.isReadOnly||(this.cellEditing.tryEditCell(m),g.preventDefault(),g.stopPropagation())},h.prototype.mouseDown=function(g,m,b){if(this._supportRightClickMenu&&g.button===ct.tc.Secondary)return g.preventDefault(),void g.stopPropagation();this.cellEditing.isEditingCell(m)||(g.preventDefault(),g.stopPropagation(),$(g.currentTarget).trigger("focus"),g.shiftKey&&b?this.selectionService.setSelectionEnd(m):this.selectionService.selectCell(m),this.isSelecting=!0)},h.prototype.mouseOver=function(g,m,b){this.isSelecting&&b&&(g.preventDefault(),g.stopPropagation(),this.selectionService.setSelectionEnd(m))},h.prototype.mouseLeave=function(g){this.isSelecting&&(this.isSelecting=!1,g.preventDefault(),g.stopPropagation())},h.prototype.mouseUpInCell=function(g,m){var b,y;if(this.showRightClickMenu=!1,m&&!this.cellEditing.isEditingCell(m)&&this._supportRightClickMenu&&g.button===ct.tc.Secondary){var A=null===(b=this.selectionService.normalizedSelection)||void 0===b?void 0:b.start,K=null===(y=this.selectionService.normalizedSelection)||void 0===y?void 0:y.end;if(!A||!K)return;return this.isInEffectiveRange(m,A,K)&&(this.showRightClickMenu=!0),g.preventDefault(),void g.stopPropagation()}},Object.defineProperty(h.prototype,"supportRightClickMenu",{set:function(m){this._supportRightClickMenu=m},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"showRightClickMenu",{get:function(){return this._showRightClickMenu},set:function(m){this._showRightClickMenu=m},enumerable:!1,configurable:!0}),h.prototype.isInEffectiveRange=function(g,m,b){var y,ee=(y=x({start:m||{row:0,column:0},end:b||{row:0,column:0}},this.dataSource.rows.length,this.dataSource.columns.length)).start,me=y.end;return g.row>=ee.row&&g.row<=me.row&&g.column>=ee.column&&g.column<=me.column},h.\u0275fac=function(m){return new(m||h)(e.\u0275\u0275inject(Q),e.\u0275\u0275inject(re),e.\u0275\u0275inject(S))},h.\u0275prov=e.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac}),h}(),dt=p(81900),it=p(77476),Ee=p(74913),Ge=function(){function h(){}return h.\u0275fac=function(m){return new(m||h)},h.\u0275cmp=e.\u0275\u0275defineComponent({type:h,selectors:[["tri-cell"]],inputs:{data:"data"},decls:1,vars:1,template:function(m,b){1&m&&e.\u0275\u0275text(0),2&m&&e.\u0275\u0275textInterpolate(b.data)},styles:["[_nghost-%COMP%]{cursor:default;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"],changeDetection:0}),h}(),et=p(33554),Ve=p(17174),Ze=["editor"],je=function(){function h(){this.onDestroy$=new et.t(1)}return h.prototype.ngOnInit=function(){var m,g=this;null===(m=this.focusEditor$)||void 0===m||m.pipe((0,D.R)(this.onDestroy$)).subscribe(function(){g.focusEditor()})},h.prototype.ngOnDestroy=function(){this.onDestroy$.next(),this.onDestroy$.complete()},h.prototype.ngOnChanges=function(g){if(g.data&&"Date"===this.column.type){var m=new Date(this.data);_.isFinite(m.getTime())&&(this.data=m.toISOString().slice(0,10))}if(g.column)switch(this.column.type){case"Date":this.type="date";break;case"Number":this.type="number";break;default:this.type="text"}},h.prototype.ngAfterViewInit=function(){this.focusEditor()},h.prototype.onDataChange=function(g){var m=Y(g,this.column.type);_.isNil(m)||this.dataChange(m)},h.prototype.focusEditor=function(){var g;null===(g=this.editor.nativeElement)||void 0===g||g.focus()},h.\u0275fac=function(m){return new(m||h)},h.\u0275cmp=e.\u0275\u0275defineComponent({type:h,selectors:[["tri-cell-editor"]],viewQuery:function(m,b){var y;(1&m&&e.\u0275\u0275viewQuery(Ze,5),2&m)&&(e.\u0275\u0275queryRefresh(y=e.\u0275\u0275loadQuery())&&(b.editor=y.first))},inputs:{column:"column",data:"data",focusEditor$:"focusEditor$",dataChange:"dataChange"},features:[e.\u0275\u0275NgOnChangesFeature],decls:2,vars:3,consts:[["autofocus","",3,"type","ngModel","ngModelChange"],["editor",""]],template:function(m,b){1&m&&(e.\u0275\u0275elementStart(0,"input",0,1),e.\u0275\u0275listener("ngModelChange",function(A){return b.onDataChange(A)}),e.\u0275\u0275elementEnd()),2&m&&(e.\u0275\u0275property("type",b.type)("ngModel",b.data),e.\u0275\u0275attribute("aria-label",b.data))},dependencies:[Ve.Fj,Ve.JJ,Ve.On],styles:["input[_ngcontent-%COMP%]{border:0;width:100%;background:transparent;padding:0;display:inline-flex;align-items:center}input[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:hover, input[_ngcontent-%COMP%]:active, input[_ngcontent-%COMP%]:active:hover, input[_ngcontent-%COMP%]:focus:hover{outline:none}[_ngcontent-%COMP%]::-webkit-outer-spin-button, [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-webkit-appearance:textfield;appearance:textfield;-moz-appearance:textfield}"],changeDetection:0}),h}(),We=function(){function h(){this.columnResized=new e.EventEmitter}return h.prototype.onMouseDown=function(g){var m,b,y;return this.isResizing=!0,this.pageX=g.pageX,this.initialWidth=null!==(y=null===(b=null===(m=g.target)||void 0===m?void 0:m.parentElement)||void 0===b?void 0:b.offsetWidth)&&void 0!==y?y:0,document.body.style.cursor="col-resize",g.stopPropagation(),!1},h.prototype.onDragStart=function(){return!1},h.prototype.onMouseMove=function(g){return!this.isResizing||(this.columnResized.emit(Math.max(0,this.initialWidth+g.pageX-this.pageX)),g.stopPropagation(),!1)},h.prototype.onMouseLeave=function(g){return!this.isResizing||(this.isResizing=!1,document.body.style.cursor="",g.stopPropagation(),!1)},h.\u0275fac=function(m){return new(m||h)},h.\u0275dir=e.\u0275\u0275defineDirective({type:h,selectors:[["","triResizeColumn",""]],hostBindings:function(m,b){1&m&&e.\u0275\u0275listener("mousedown",function(A){return b.onMouseDown(A)})("touchstart",function(A){return b.onMouseDown(A)})("dragstart",function(){return b.onDragStart()})("mousemove",function(A){return b.onMouseMove(A)},!1,e.\u0275\u0275resolveWindow)("touchmove",function(A){return b.onMouseMove(A)},!1,e.\u0275\u0275resolveWindow)("mouseup",function(A){return b.onMouseLeave(A)},!1,e.\u0275\u0275resolveWindow)("mouseleave",function(A){return b.onMouseLeave(A)},!1,e.\u0275\u0275resolveWindow)("touchend",function(A){return b.onMouseLeave(A)},!1,e.\u0275\u0275resolveWindow)},outputs:{columnResized:"columnResized"}}),h}(),Le=function(){function h(){}return h.prototype.transform=function(g,m,b){return!!g&&(-1===g.start.row||m>=g.start.row&&m<=g.end.row)&&(-1===g.start.column||b>=g.start.column&&b<=g.end.column)},h.\u0275fac=function(m){return new(m||h)},h.\u0275pipe=e.\u0275\u0275definePipe({name:"isSelected",type:h,pure:!0}),h}(),He=["headers"],xt=["table"],ut=["viewport"],yt=["cellEditor"];function It(h,g){if(1&h){var m=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275listener("focus",function(A){e.\u0275\u0275restoreView(m);var K=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(K.focusCell(A,{row:-1,column:-1}))}),e.\u0275\u0275element(1,"tri-svg-icon",12),e.\u0275\u0275elementEnd()}if(2&h){var b=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("tabindex",b.focusedCell?-1:0),e.\u0275\u0275attribute("data-row",-1)("data-column",-1),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","table_20_regular")}}var Ke=function(g){return{headerName:g}};function Ft(h,g){if(1&h){var m=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275listener("focus",function(me){var pe=e.\u0275\u0275restoreView(m).index,Oe=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(Oe.focusCell(me,{row:-1,column:pe}))}),e.\u0275\u0275pipe(1,"isSelected"),e.\u0275\u0275elementContainer(2,14),e.\u0275\u0275elementStart(3,"span",15),e.\u0275\u0275listener("columnResized",function(me){var pe=e.\u0275\u0275restoreView(m).index,Oe=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(Oe.onColumnResized(me,pe))}),e.\u0275\u0275elementEnd()()}if(2&h){var b=g.$implicit,y=g.index,A=e.\u0275\u0275nextContext(2),K=e.\u0275\u0275reference(9);e.\u0275\u0275styleProp("width",A.columnWidths[y]),e.\u0275\u0275classProp("selection-start",e.\u0275\u0275pipeBind3(1,9,A.selection,-1,y)),e.\u0275\u0275property("tabindex",A.focusedCell||A.rowHeaders||0!==y?-1:0),e.\u0275\u0275attribute("data-row",-1)("data-column",y),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",b.headerTemplate||K)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(13,Ke,b.name))}}function Pt(h,g){if(1&h){var m=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",23),e.\u0275\u0275listener("focus",function(K){e.\u0275\u0275restoreView(m);var ee=e.\u0275\u0275nextContext().index,me=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(me.focusCell(K,{row:ee,column:-1}))}),e.\u0275\u0275pipe(1,"isSelected"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()}if(2&h){var b=e.\u0275\u0275nextContext().index,y=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("selection-start",e.\u0275\u0275pipeBind3(1,5,y.selection,b,-1)),e.\u0275\u0275attribute("data-row",b)("data-column",-1),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",b+y.rowIndexDisplayOffset," ")}}var Ce=function(g,m,b,y){return{column:g,data:m,dataChange:b,focusEditor$:y}};function ge(h,g){if(1&h&&e.\u0275\u0275elementContainer(0,14,27),2&h){var m=e.\u0275\u0275nextContext().$implicit,b=e.\u0275\u0275nextContext(4),y=e.\u0275\u0275reference(5);e.\u0275\u0275property("ngTemplateOutlet",m.editTemplate||y)("ngTemplateOutletContext",e.\u0275\u0275pureFunction4(2,Ce,m,b.editingCell.data,b.onEditCellDataChange.bind(b),b.focusEditor$))}}var U=function(g,m){return{column:g,data:m}};function P(h,g){if(1&h&&e.\u0275\u0275elementContainer(0,14),2&h){var m=e.\u0275\u0275nextContext(),b=m.$implicit,y=m.index,A=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275nextContext(3);var K=e.\u0275\u0275reference(7);e.\u0275\u0275property("ngTemplateOutlet",b.template||K)("ngTemplateOutletContext",e.\u0275\u0275pureFunction2(2,U,b,A[y]))}}function O(h,g){if(1&h){var m=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",24),e.\u0275\u0275listener("focus",function(Pe){var Oe=e.\u0275\u0275restoreView(m).index,vt=e.\u0275\u0275nextContext().index,pt=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(pt.focusCell(Pe,{row:vt,column:Oe}))}),e.\u0275\u0275pipe(1,"isSelected"),e.\u0275\u0275template(2,ge,2,7,"ng-container",25),e.\u0275\u0275template(3,P,1,5,"ng-template",null,26,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()}if(2&h){var b=g.index,y=e.\u0275\u0275reference(4),A=e.\u0275\u0275nextContext().index;e.\u0275\u0275nextContext();var K=e.\u0275\u0275reference(1),ee=e.\u0275\u0275nextContext(2);e.\u0275\u0275styleProp("width",ee.columnWidths[b]),e.\u0275\u0275classProp("selected-top",A===(null==ee.selection||null==ee.selection.start?null:ee.selection.start.row)||0===A&&-1===(null==ee.selection||null==ee.selection.start?null:ee.selection.start.row))("selected-bottom",A===(null==ee.selection||null==ee.selection.end?null:ee.selection.end.row)&&-1!==(null==ee.selection||null==ee.selection.start?null:ee.selection.start.row)||A===ee.dataSource.rows.length-1&&-1===(null==ee.selection||null==ee.selection.end?null:ee.selection.end.row))("selected-left",b===(null==ee.selection||null==ee.selection.start?null:ee.selection.start.column)||0===b&&-1===(null==ee.selection||null==ee.selection.start?null:ee.selection.start.column))("selected-right",b===(null==ee.selection||null==ee.selection.end?null:ee.selection.end.column)&&-1!==(null==ee.selection||null==ee.selection.start?null:ee.selection.start.column)||b===ee.dataSource.columns.length-1&&-1===(null==ee.selection||null==ee.selection.start?null:ee.selection.start.column))("selected",e.\u0275\u0275pipeBind3(1,19,ee.selection,A,b))("selection-start",ee.selectedCell&&ee.selectedCell.row===A&&ee.selectedCell.column===b),e.\u0275\u0275attribute("data-row",A)("data-column",b)("aria-colindex",(K.getRenderedRange().start||0)+b+1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",ee.editingCell&&ee.editingCell.row===A&&ee.editingCell.column===b)("ngIfElse",y)}}function ue(h,g){if(1&h&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275template(1,Pt,3,9,"div",21),e.\u0275\u0275template(2,O,5,23,"div",22),e.\u0275\u0275elementEnd()),2&h){var m=g.index,b=e.\u0275\u0275nextContext(2).$implicit,y=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("aria-rowindex",m+1),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",y.rowHeaders),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",b)("ngForTrackBy",y.trackByColumn)}}function Te(h,g){if(1&h){var m=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275listener("mousedown",function(){e.\u0275\u0275restoreView(m);var y=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(y.appendRow(-1))})("focus",function(y){e.\u0275\u0275restoreView(m);var A=e.\u0275\u0275nextContext(2).$implicit,K=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(K.focusCell(y,{row:A.length,column:-1}))}),e.\u0275\u0275text(1,"+"),e.\u0275\u0275elementEnd()}}function $e(h,g){if(1&h){var m=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",32),e.\u0275\u0275listener("mousedown",function(){var ee=e.\u0275\u0275restoreView(m).index,me=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(me.appendRow(ee))})("focus",function(K){var me=e.\u0275\u0275restoreView(m).index,Pe=e.\u0275\u0275nextContext(2).$implicit,pe=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(pe.focusCell(K,{row:Pe.length,column:me}))}),e.\u0275\u0275elementEnd()}if(2&h){var b=g.index,y=e.\u0275\u0275nextContext(4);e.\u0275\u0275styleProp("width",y.columnWidths[b])}}function rt(h,g){if(1&h&&(e.\u0275\u0275elementStart(0,"div",28),e.\u0275\u0275template(1,Te,2,0,"div",29),e.\u0275\u0275template(2,$e,1,2,"div",30),e.\u0275\u0275elementEnd()),2&h){var m=e.\u0275\u0275nextContext(2).$implicit,b=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",b.rowHeaders),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",m)("ngForTrackBy",b.trackByColumn)}}function mt(h,g){if(1&h){var m=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cdk-virtual-scroll-viewport",16,17),e.\u0275\u0275listener("scroll",function(){e.\u0275\u0275restoreView(m);var K=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(K.scroll())}),e.\u0275\u0275template(2,ue,3,4,"div",18),e.\u0275\u0275template(3,rt,3,3,"div",19),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()}if(2&h){var b=g.$implicit,y=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("itemSize",y.rowHeight),e.\u0275\u0275advance(2),e.\u0275\u0275property("cdkVirtualForOf",b)("cdkVirtualForTrackBy",y.trackByColumn)("cdkVirtualForTemplateCacheSize",100),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",y.showAppendRow&&!1===e.\u0275\u0275pipeBind1(4,5,y.isReadOnly$))}}function Re(h,g){if(1&h&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",6,7),e.\u0275\u0275template(3,It,2,4,"div",8),e.\u0275\u0275template(4,Ft,4,15,"div",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,mt,5,7,"cdk-virtual-scroll-viewport",10),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementContainerEnd()),2&h){var m=g.$implicit,b=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",b.rowHeaders),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",m)("ngForTrackBy",b.trackByColumn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(6,4,b.rows$))}}function xe(h,g){if(1&h&&e.\u0275\u0275element(0,"tri-cell-editor",33),2&h){var b=g.data,y=g.dataChange,A=g.focusEditor$;e.\u0275\u0275property("column",g.column)("data",b)("dataChange",y)("focusEditor$",A)}}function be(h,g){1&h&&e.\u0275\u0275element(0,"tri-cell",34),2&h&&e.\u0275\u0275property("data",g.data)}function N(h,g){if(1&h&&(e.\u0275\u0275elementStart(0,"span",35),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&h){var m=g.headerName;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",m," ")}}var L=function(h){function g(m,b,y,A,K,ee,me,Pe){var pe=h.call(this)||this;return pe.changeDetector=m,pe.cellEditing=b,pe.dataSource=y,pe.selectionService=A,pe.mouseEventHandler=K,pe.keyboardEventHandler=ee,pe.clipboardService=me,pe.resizeService=Pe,pe.columnWidths=[],pe.focusEditor$=new R.xQ,pe.rowHeight=24,pe.isReadOnly$=pe.cellEditing.isReadOnly$,pe.rowHeaders=!0,pe.showAppendRow=!0,pe.isReadOnly=!1,pe.allowExpandSelection=!0,pe.enforceSelectingColumn=!1,pe.clearSelectionOnDataChange=!1,pe.rowIndexDisplayOffset=0,pe.supportRightClickMenu=!1,pe.rowsChange=new e.EventEmitter,pe.selectionChange=new e.EventEmitter,pe.columnWidthChange=new e.EventEmitter,pe.showRightClickMenu=new e.EventEmitter,pe.columns$=pe.dataSource.columns$,pe.rows$=pe.dataSource.rows$,pe}return(0,I.__extends)(g,h),g.prototype.releaseMouse=function(m){this.mouseEventHandler.mouseLeave(m)},g.prototype.ngOnInit=function(){var m=this;this.changes$("isReadOnly").subscribe(function(b){return m.cellEditing.setReadOnly(b)}),this.changes$("columns").subscribe(function(b){m.columnWidths=_.map(b,function(y){return(_.isFinite(y.width)?y.width:50)+"px"}),m.dataSource.setColumns(b),m.clearSelectionOnDataChangeHandler()}),this.changes$("rows").subscribe(function(b){m.dataSource.setRows(b),m.clearSelectionOnDataChangeHandler()}),this.dataSource.rows$.pipe((0,D.R)(this.onDestroy$)).subscribe(function(b){m.rows!==b&&m.rowsChange.emit(b)}),this.dataSource.columns$.pipe((0,D.R)(this.onDestroy$)).subscribe(function(b){m.columnWidths=_.map(b,function(y){return(_.isFinite(y.width)?y.width:50)+"px"})}),this.cellEditing.editingCell$.pipe((0,M.T)(1),(0,D.R)(this.onDestroy$),(0,X.b)(function(b){m.editingCell=b,m.changeDetector.markForCheck()}),(0,d.x)(function(b,y){return b?.row===y?.row&&b?.column===y?.column})).subscribe(function(){m.editingCell?setTimeout(function(){return m.focusEditor$.next()},0):setTimeout(function(){return m.table.nativeElement.focus()},0)}),this.selectionService.enforceSelectingColumn=this.enforceSelectingColumn,this.selectionService.selectedCell$.pipe((0,D.R)(this.onDestroy$),(0,X.b)(function(b){m.selectedCell=b,m.changeDetector.markForCheck()}),(0,B.h)(function(b){return!!b}),(0,d.x)(function(b,y){return b.row===y.row&&b.column===y.column})).subscribe(function(b){var y,A,K;m.cellEditing.isEditing()&&!m.cellEditing.isEditingCell(b)&&m.cellEditing.commitPendingEdit();var ee=(null===(y=m.viewport.nativeElement)||void 0===y?void 0:y.scrollTop)/m.rowHeight,me=ee+(null===(A=m.viewport.nativeElement)||void 0===A?void 0:A.offsetHeight)/m.rowHeight;b.row>=0&&(b.row<ee||b.row>=me)&&(null===(K=m.viewportComponent)||void 0===K||K.scrollToIndex(b.row))}),this.selectionService.normalizedSelection$.pipe((0,D.R)(this.onDestroy$)).subscribe(function(b){m.selection=b,m.selectionChange.emit(b),m.changeDetector.markForCheck()}),this.resizeService&&this.resizeService.resize$.pipe((0,D.R)(this.onDestroy$)).subscribe(function(){m.viewportComponent.checkViewportSize()}),this.mouseEventHandler.supportRightClickMenu=this.supportRightClickMenu},g.prototype.ngAfterViewInit=function(){var m=this;this.table.nativeElement.style.setProperty("--row-height",this.rowHeight+"px"),this.keyboardEventHandler.parentElement=this.table.nativeElement,setTimeout(function(){m.changes$("nextSelectionInput").subscribe(function(b){m.scrollToSelectedColumn(b),m.selectionService.setSelection(b)})},0),this.selectionService.virtualScroll=this.viewportComponent},g.prototype.scrollToSelectedColumn=function(m){var b=this;if(m){var y=0;if(this.nextSelectionInputChangedFromSelection(m)&&this.columns&&this.columnWidths)for(var A=0;A<this.columns.length&&A<=m.start.column-1;A++)y+=this.substractWidh(this.columnWidths[A]);setTimeout(function(){var K,ee;(null===(K=b.viewport)||void 0===K?void 0:K.nativeElement.clientWidth)<y&&(null===(ee=b.viewport)||void 0===ee||ee.nativeElement.scroll(y,0))},300)}},g.prototype.nextSelectionInputChangedFromSelection=function(m){var b,y,A,K,ee,me,Pe,pe;return m.end.column!==(null===(y=null===(b=this.selection)||void 0===b?void 0:b.end)||void 0===y?void 0:y.column)||m.end.row!==(null===(K=null===(A=this.selection)||void 0===A?void 0:A.end)||void 0===K?void 0:K.row)||m.start.row!==(null===(me=null===(ee=this.selection)||void 0===ee?void 0:ee.start)||void 0===me?void 0:me.row)||m.start.column!==(null===(pe=null===(Pe=this.selection)||void 0===Pe?void 0:Pe.start)||void 0===pe?void 0:pe.column)},g.prototype.substractWidh=function(m){var b,y=null===(b=m?.match(/\d+(\.\d+)?/g))||void 0===b?void 0:b.map(Number);return y?y[0]:0},g.prototype.flushPendingChanges=function(){var m;return this.cellEditing.commitPendingEdit(),this.rows$.pipe((0,F.q)(1)).subscribe(function(b){return m=b}),m},g.prototype.trackByColumn=function(m){return m},g.prototype.scroll=function(){this.headers.nativeElement.style.transform="translateX(".concat(-this.viewport.nativeElement.scrollLeft,"px)")},g.prototype.onColumnResized=function(m,b){this.columnWidths[b]=m+"px",this.columnWidthChange.emit({width:m,column:b})},g.prototype.onCellMouseDown=function(m){var b=this.getCell();b&&this.mouseEventHandler.mouseDown(m,b,this.allowExpandSelection)},g.prototype.onCellMouseUp=function(m){var b=this.getCell();this.mouseEventHandler.mouseUpInCell(m,b),this.mouseEventHandler.showRightClickMenu&&this.showRightClickMenu.emit({pageX:m.pageX,pageY:m.pageY})},g.prototype.onCellMouseOver=function(m){var b=this.getCell();b&&this.mouseEventHandler.mouseOver(m,b,this.allowExpandSelection)},g.prototype.onCellDoubleClick=function(m){var b=this.getCell();b&&this.mouseEventHandler.doubleClick(m,b)},g.prototype.onEditCellDataChange=function(m){this.cellEditing.setEditingData(m)},g.prototype.focusCell=function(m,b){this.selectionService.setFocus(b,this.table.nativeElement),this.scrollViewportHorizontally(m.target)},Object.defineProperty(g.prototype,"focusedCell",{get:function(){return this.selectionService.focusedCell},enumerable:!1,configurable:!0}),g.prototype.scrollViewportHorizontally=function(m){var b=this.viewport.nativeElement,y=m.offsetLeft;(b.scrollLeft+b.clientWidth<y||b.scrollLeft>y)&&(b.scrollLeft=y-(b.clientWidth-m.clientWidth)/2,this.viewport.nativeElement.scrollIntoView())},g.prototype.handleKeydown=function(m){this.keyboardEventHandler.keydown(m,this.table.nativeElement,this.allowExpandSelection)},g.prototype.getCell=function(){var m=$("[data-clickable]:hover").get(0);if(m){var b=m.getAttribute("data-row"),y=m.getAttribute("data-column");if(b&&y){var A=parseInt(b,10),K=parseInt(y,10);if(_.isFinite(A)&&_.isFinite(K))return{row:A,column:K}}}},g.prototype.appendRow=function(m){this.dataSource.appendRow(),this.selectionService.selectCell({row:this.dataSource.rows.length,column:m})},g.prototype.clearSelectionOnDataChangeHandler=function(){this.clearSelectionOnDataChange&&this.selectionService.setSelection(void 0)},g.\u0275fac=function(b){return new(b||g)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Q),e.\u0275\u0275directiveInject(S),e.\u0275\u0275directiveInject(re),e.\u0275\u0275directiveInject(Fe),e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(ne),e.\u0275\u0275directiveInject(dt.g,8))},g.\u0275cmp=e.\u0275\u0275defineComponent({type:g,selectors:[["tri-grid"]],viewQuery:function(b,y){if(1&b&&(e.\u0275\u0275viewQuery(He,5),e.\u0275\u0275viewQuery(xt,5),e.\u0275\u0275viewQuery(ut,5,e.ElementRef),e.\u0275\u0275viewQuery(se.N7,5),e.\u0275\u0275viewQuery(yt,5)),2&b){var A=void 0;e.\u0275\u0275queryRefresh(A=e.\u0275\u0275loadQuery())&&(y.headers=A.first),e.\u0275\u0275queryRefresh(A=e.\u0275\u0275loadQuery())&&(y.table=A.first),e.\u0275\u0275queryRefresh(A=e.\u0275\u0275loadQuery())&&(y.viewport=A.first),e.\u0275\u0275queryRefresh(A=e.\u0275\u0275loadQuery())&&(y.viewportComponent=A.first),e.\u0275\u0275queryRefresh(A=e.\u0275\u0275loadQuery())&&(y.cellEditor=A.first)}},hostBindings:function(b,y){1&b&&e.\u0275\u0275listener("mouseup",function(K){return y.releaseMouse(K)},!1,e.\u0275\u0275resolveWindow)("mouseleave",function(K){return y.releaseMouse(K)},!1,e.\u0275\u0275resolveWindow)},inputs:{columns:"columns",rows:"rows",rowHeaders:"rowHeaders",showAppendRow:"showAppendRow",isReadOnly:"isReadOnly",allowExpandSelection:"allowExpandSelection",enforceSelectingColumn:"enforceSelectingColumn",nextSelectionInput:"nextSelectionInput",clearSelectionOnDataChange:"clearSelectionOnDataChange",rowIndexDisplayOffset:"rowIndexDisplayOffset",supportRightClickMenu:"supportRightClickMenu"},outputs:{rowsChange:"rowsChange",selectionChange:"selectionChange",columnWidthChange:"columnWidthChange",showRightClickMenu:"showRightClickMenu"},features:[e.\u0275\u0275ProvidersFeature([re,Q,S,Fe,Ae,ne]),e.\u0275\u0275InheritDefinitionFeature],decls:10,vars:3,consts:[["tabindex","-1","role","table",1,"table",3,"keydown","mousedown","mouseover","mouseup","dblclick"],["table",""],[4,"ngIf"],["defaultCellEditor",""],["defaultViewCell",""],["defaultHeaderCell",""],["role","row",1,"headers"],["headers",""],["class","header selectable table-icon","role","columnheader","data-clickable","true",3,"tabindex","focus",4,"ngIf"],["class","header selectable","data-clickable","true","role","columnheader",3,"selection-start","tabindex","width","focus",4,"ngFor","ngForOf","ngForTrackBy"],[3,"itemSize","scroll",4,"ngIf"],["role","columnheader","data-clickable","true",1,"header","selectable","table-icon",3,"tabindex","focus"],["tri-svg-icon-20","",1,"table-svg-icon",3,"name"],["data-clickable","true","role","columnheader",1,"header","selectable",3,"tabindex","focus"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["triResizeColumn","",1,"resize-handle",3,"columnResized"],[3,"itemSize","scroll"],["viewport",""],["class","row","role","row",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy","cdkVirtualForTemplateCacheSize"],["class","row","role","row","tabindex","0",4,"ngIf"],["role","row",1,"row"],["class","cell row-header selectable","role","gridcell","tabindex","-1","data-clickable","true",3,"selection-start","focus",4,"ngIf"],["class","cell selectable","role","gridcell","tabindex","-1","data-clickable","true",3,"selected-top","selected-bottom","selected-left","selected-right","selected","selection-start","width","focus",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell","tabindex","-1","data-clickable","true",1,"cell","row-header","selectable",3,"focus"],["role","gridcell","tabindex","-1","data-clickable","true",1,"cell","selectable",3,"focus"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf","ngIfElse"],["viewCell",""],["cellEditor",""],["role","row","tabindex","0",1,"row"],["class","cell row-header","role","gridcell","tabindex","-1",3,"mousedown","focus",4,"ngIf"],["tabindex","-1","class","cell","role","gridcell",3,"width","mousedown","focus",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell","tabindex","-1",1,"cell","row-header",3,"mousedown","focus"],["tabindex","-1","role","gridcell",1,"cell",3,"mousedown","focus"],[3,"column","data","dataChange","focusEditor$"],[3,"data"],[1,"default-header-name"]],template:function(b,y){1&b&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275listener("keydown",function(K){return y.handleKeydown(K)})("mousedown",function(K){return y.onCellMouseDown(K)})("mouseover",function(K){return y.onCellMouseOver(K)})("mouseup",function(K){return y.onCellMouseUp(K)})("dblclick",function(K){return y.onCellDoubleClick(K)}),e.\u0275\u0275template(2,Re,7,6,"ng-container",2),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,xe,1,4,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(6,be,1,1,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(8,N,2,1,"ng-template",null,5,e.\u0275\u0275templateRefExtractor)),2&b&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,1,y.columns$)))},dependencies:[it.NgForOf,it.NgIf,it.NgTemplateOutlet,se.xd,se.x0,se.N7,Ee.M,Ge,je,We,it.AsyncPipe,Le],styles:['[_nghost-%COMP%]{height:100%;width:100%;display:flex;background:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);--row-height: $default-row-height}[_nghost-%COMP%]   *[_ngcontent-%COMP%]{box-sizing:border-box}[_nghost-%COMP%]   *[_ngcontent-%COMP%]:focus{outline:none}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{overflow-x:auto;height:calc(100% - var(--row-height));position:absolute;top:var(--row-height);bottom:0;width:100%;scrollbar-width:thin}[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;height:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border:1px solid var(--fluentThemeNeutralSecondaryAltColor, #767676);border-radius:20px;background-color:var(--fluentThemeNeutralSecondaryAltColor, #767676)}.table[_ngcontent-%COMP%]{height:100%;display:flex;position:relative;max-width:100%;overflow-x:hidden;width:max-content;padding-right:5px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]{text-align:start;display:flex;flex-wrap:nowrap;height:var(--row-height);width:100%;border-left:1px solid var(--colorNeutralStroke2)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:inline-flex;position:relative;min-width:45px;height:var(--row-height);line-height:12px;margin:0;padding:3px 6px;background:var(--colorNeutralBackground2);flex-shrink:0;flex-grow:0;overflow:hidden;border-top:solid 1px var(--colorNeutralStroke2);border-bottom:solid 1px var(--colorNeutralStroke2);border-right:solid 1px var(--colorNeutralStroke2);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .default-header-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;opacity:0;width:10px;cursor:col-resize}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.selection-start[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2Selected);border-bottom:2px solid var(--colorNeutralStrokeAccessibleSelected);color:var(--colorNeutralForeground1Selected);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600)}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.selection-start[_ngcontent-%COMP%]{border-bottom:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:focus{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:4px;padding:2px 4px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground2Hover);color:var(--colorNeutralForeground1Hover)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:active{background:var(--colorNeutralBackground2Pressed);color:var(--colorNeutralForeground1Pressed)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]:focus{padding:2px 5px 2px 4px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]   .table-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForeground2)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;border-left:solid 1px var(--colorNeutralStroke2)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .selectable[_ngcontent-%COMP%]:not(.selection-start):focus{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:4px;padding:1.5px 4px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{cursor:default;position:relative;display:inline-flex;flex-grow:0;min-width:45px;height:var(--row-height);padding:3.5px 6px;align-items:center;overflow:hidden;border-bottom:solid 1px var(--colorNeutralStroke2);border-right:solid 1px var(--colorNeutralStroke2);background:var(--colorSubtleBackground);outline:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.number-cell[_ngcontent-%COMP%]{text-align:right}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2);justify-content:center;padding:3px 0 0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header.selection-start[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2Selected);border-right:2px solid var(--colorNeutralStrokeAccessibleSelected);color:var(--colorNeutralForeground1Selected);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600)}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header.selection-start[_ngcontent-%COMP%]{border-right:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground2Hover);color:var(--colorNeutralForeground1Hover)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:active{background:var(--colorNeutralBackground2Pressed);color:var(--colorNeutralForeground1Pressed)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:focus{padding:1px 1px 0 0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected[_ngcontent-%COMP%]{background:var(--colorSubtleBackgroundSelected)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]:not(.selected-bottom){padding-bottom:5px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]:not(.selected-top){padding-top:5px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]{border-top:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-top:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]{border-top:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]:before{border-top:1px solid var(--colorNeutralStrokeFocus1);top:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]{border-bottom:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-bottom:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]{border-bottom:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]:before{border-bottom:1px solid var(--colorNeutralStrokeFocus1);bottom:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]{border-left:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-left:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]{border-left:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]:before{border-left:1px solid var(--colorNeutralStrokeFocus1);left:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]{border-right:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-right:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]{border-right:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]:before{border-right:1px solid var(--colorNeutralStrokeFocus1);right:0}'],changeDetection:0}),g}(k.w)},11962:function(De,J,p){p.d(J,{oY:function(){return D.o},V7:function(){return B}});var I=p(17174),e=p(77476),se=p(21661),R=p(78035),D=p(23873),M=p(17177),X=p(50423),B=function(){function k(){}return k.\u0275fac=function(w){return new(w||k)},k.\u0275mod=X.\u0275\u0275defineNgModule({type:k}),k.\u0275inj=X.\u0275\u0275defineInjector({imports:[e.CommonModule,I.u5,R.Y,se.Cl,M.T6]}),k}();p(81900)},81900:function(De,J,p){p.d(J,{g:function(){return e}});var e=new(p(50423).InjectionToken)("ResizeService")},13414:function(De,J,p){p.d(J,{t:function(){return ae}});var I=p(4437),e=p(50423),se=p(17174),R=p(51193),D=p(77476),M=["switchInput"];function X(x,Y){if(1&x&&(e.\u0275\u0275elementStart(0,"span",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&x){var S=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",S.label,"\n")}}function d(x,Y){1&x&&(e.\u0275\u0275elementStart(0,"span",11),e.\u0275\u0275projection(1,1),e.\u0275\u0275elementEnd())}function B(x,Y){if(1&x&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275element(1,"span",9),e.\u0275\u0275template(2,d,2,0,"span",10),e.\u0275\u0275elementEnd()),2&x){var S=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",S.compact)}}function F(x,Y){1&x&&(e.\u0275\u0275elementStart(0,"div",12),e.\u0275\u0275element(1,"span",13),e.\u0275\u0275elementEnd())}var k=[[["tri-switch-text"],["","tri-switch-text",""]],[["inline-toggle-content"],["","inline-toggle-content",""]]],T=["tri-switch-text, [tri-switch-text]","inline-toggle-content, [inline-toggle-content]"],w=0,W=function(){return function(Y,S){this.source=Y,this.checked=S}}(),ae=function(){function x(Y,S,Q){this.elementRef=Y,this.focusMonitor=S,this.changeDetectorRef=Q,this._disabled=!1,this._required=!1,this._compact=!1,this._checked=!1,this._indeterminate=!1,this.name=void 0,this._uniqueId="tri-switch-".concat(++w),this.id=this._uniqueId,this.ariaLabel=void 0,this.ariaLabelledby=void 0,this.ariaDescribedby="",this.label=void 0,this.listenValueChange=new e.EventEmitter,this.toggleChange=new e.EventEmitter,this.inputElement={},this.onChange=function(){},this.onTouched=function(){}}return Object.defineProperty(x.prototype,"disabled",{get:function(){return this._disabled},set:function(S){this._disabled=(0,I.Ig)(S),this.changeDetectorRef.markForCheck()},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"required",{get:function(){return this._required},set:function(S){this._required=(0,I.Ig)(S)},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"checked",{get:function(){return this._checked},set:function(S){this._checked=(0,I.Ig)(S),this.changeDetectorRef.markForCheck()},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"indeterminate",{get:function(){return this._indeterminate},set:function(S){this._indeterminate=(0,I.Ig)(S),this.changeDetectorRef.markForCheck()},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"compact",{get:function(){return this._compact},set:function(S){this._compact=(0,I.Ig)(S),this.changeDetectorRef.markForCheck()},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"inputId",{get:function(){return"".concat(this.id||this._uniqueId,"-input")},enumerable:!1,configurable:!0}),x.prototype.ngAfterContentInit=function(){var Y=this;this.focusMonitor.monitor(this.elementRef,!0).subscribe(function(S){"keyboard"===S||"program"===S?Y.inputElement.nativeElement.focus():S||Promise.resolve().then(function(){return Y.onTouched()})})},x.prototype.ngOnDestroy=function(){this.focusMonitor.stopMonitoring(this.elementRef)},x.prototype.onInputChange=function(Y,S){void 0===S&&(S=!1),Y.stopPropagation(),this.toggleChange.emit(),this.checked=S?!this.inputElement.nativeElement.checked:this.inputElement.nativeElement.checked,this.indeterminate=!S&&this.indeterminate,this.emitChangeEvent()},x.prototype.onInputClick=function(Y){Y.stopPropagation()},x.prototype.writeValue=function(Y){this.checked=!!Y},x.prototype.registerOnChange=function(Y){this.onChange=Y},x.prototype.registerOnTouched=function(Y){this.onTouched=Y},x.prototype.setDisabledState=function(Y){this.disabled=Y,this.changeDetectorRef.markForCheck()},x.prototype.focus=function(Y,S){S?this.focusMonitor.focusVia(this.inputElement,S,Y):this.inputElement.nativeElement.focus(Y)},x.prototype.emitChangeEvent=function(){this.onChange(this.checked),this.listenValueChange.emit(new W(this,this.checked))},x.\u0275fac=function(S){return new(S||x)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(R.tE),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},x.\u0275cmp=e.\u0275\u0275defineComponent({type:x,selectors:[["tri-switch"]],viewQuery:function(S,Q){var q;(1&S&&e.\u0275\u0275viewQuery(M,5),2&S)&&(e.\u0275\u0275queryRefresh(q=e.\u0275\u0275loadQuery())&&(Q.inputElement=q.first))},hostAttrs:[1,"tri-switch"],hostVars:10,hostBindings:function(S,Q){2&S&&(e.\u0275\u0275hostProperty("id",Q.id),e.\u0275\u0275attribute("tabindex",Q.disabled?null:-1)("aria-label",null)("aria-labelledby",null),e.\u0275\u0275classProp("compact",Q.compact)("checked",Q.checked)("disabled",Q.disabled))},inputs:{name:"name",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],label:"label",disabled:"disabled",required:"required",checked:"checked",indeterminate:"indeterminate",compact:"compact"},outputs:{listenValueChange:"listenValueChange",toggleChange:"toggleChange"},exportAs:["triSwitch"],features:[e.\u0275\u0275ProvidersFeature([{provide:se.JU,useExisting:(0,e.forwardRef)(function(){return x}),multi:!0}])],ngContentSelectors:T,decls:9,vars:17,consts:[["aria-hidden","true","class","tri-switch-label",4,"ngIf"],[1,"tri-switch-internal"],["type","checkbox","role","checkbox",1,"tri-switch-input","cdk-visually-hidden",3,"id","checked","indeterminate","disabled","required","change","click","keydown.enter"],["switchInput",""],["class","tri-switch-circle",4,"ngIf"],["class","tri-switch-rect",4,"ngIf"],["aria-hidden","true",1,"tri-switch-text"],["aria-hidden","true",1,"tri-switch-label"],[1,"tri-switch-circle"],["aria-hidden","true",1,"tri-switch-checkmark"],["class","tri-toggle-inner-text",4,"ngIf"],[1,"tri-toggle-inner-text"],[1,"tri-switch-rect"],["aria-hidden","true",1,"tri-switch-dash"]],template:function(S,Q){1&S&&(e.\u0275\u0275projectionDef(k),e.\u0275\u0275template(0,X,2,1,"span",0),e.\u0275\u0275elementStart(1,"label",1)(2,"input",2,3),e.\u0275\u0275listener("change",function(Z){return Q.onInputChange(Z,!1)})("click",function(Z){return Q.onInputClick(Z)})("keydown.enter",function(Z){return Q.onInputChange(Z,!0)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"section"),e.\u0275\u0275template(5,B,3,1,"div",4),e.\u0275\u0275template(6,F,2,0,"div",5),e.\u0275\u0275elementStart(7,"span",6),e.\u0275\u0275projection(8),e.\u0275\u0275elementEnd()()()),2&S&&(e.\u0275\u0275property("ngIf",Q.label),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("disabled",Q.disabled)("indeterminate",Q.indeterminate),e.\u0275\u0275attribute("for",Q.inputId),e.\u0275\u0275advance(1),e.\u0275\u0275property("id",Q.inputId)("checked",Q.checked&&!Q.indeterminate)("indeterminate",Q.indeterminate)("disabled",Q.disabled)("required",Q.required),e.\u0275\u0275attribute("name",Q.name)("aria-label",Q.ariaLabel||Q.label)("aria-labelledby",Q.ariaLabelledby)("aria-describedby",Q.ariaDescribedby),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!Q.indeterminate),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",Q.indeterminate))},dependencies:[D.NgIf],styles:['.compact[_nghost-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%], .compact[_nghost-%COMP%]   .tri-switch-rect[_ngcontent-%COMP%]{width:32px;height:16px}.compact[_nghost-%COMP%]   .tri-switch-label[_ngcontent-%COMP%]{font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:400;margin-bottom:8px}.compact[_nghost-%COMP%]   .tri-switch-text[_ngcontent-%COMP%]{font-size:var(--fontSizeBase200);line-height:16px}.compact[_nghost-%COMP%]   .tri-switch-checkmark[_ngcontent-%COMP%]{width:8px;height:8px}.compact[_nghost-%COMP%]   .tri-switch-dash[_ngcontent-%COMP%]{width:8px;height:2px}.compact[_nghost-%COMP%]   .tri-toggle-inner-text[_ngcontent-%COMP%]{display:flex;font-family:var(--fontFamilyBase);font-size:9px}.compact[_nghost-%COMP%]   .tri-switch-internal[_ngcontent-%COMP%]:not(.disabled)   .tri-switch-input[_ngcontent-%COMP%] + section[_ngcontent-%COMP%]   .tri-toggle-inner-text[_ngcontent-%COMP%]{color:var(--colorNeutralForeground3)}.compact[_nghost-%COMP%]   .tri-switch-internal[_ngcontent-%COMP%]:not(.disabled)   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-toggle-inner-text[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundOnBrand)}.compact[_nghost-%COMP%]   .tri-switch-internal[_ngcontent-%COMP%]:not(.disabled)   .tri-switch-rect[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundInverted)}.compact[_nghost-%COMP%]   .tri-switch-internal[_ngcontent-%COMP%]:hover   .tri-switch-input[_ngcontent-%COMP%]:not(:checked) + section[_ngcontent-%COMP%]   .tri-toggle-inner-text[_ngcontent-%COMP%]{color:var(--colorNeutralForeground3)}.compact[_nghost-%COMP%]   .tri-switch-internal[_ngcontent-%COMP%]:hover   .tri-switch-rect[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundInverted)}.compact[_nghost-%COMP%]   .tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-input[_ngcontent-%COMP%]:not(:checked) + section[_ngcontent-%COMP%]   .tri-toggle-inner-text[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.compact[_nghost-%COMP%]   .tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-rect[_ngcontent-%COMP%], .compact[_nghost-%COMP%]   .tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-text[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}  .tri-switch{display:inline-block;border:2px solid transparent}@media (forced-colors: active){  .tri-switch{border-color:transparent;forced-color-adjust:none}}  .tri-switch.cdk-keyboard-focused:focus-within{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:var(--borderRadiusMedium)}.tri-switch-internal[_ngcontent-%COMP%]{cursor:pointer;display:flex;position:relative;padding:8px 0}.tri-switch-internal[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{align-items:center;display:flex}.tri-switch-internal[_ngcontent-%COMP%]   input[type=checkbox].tri-switch-input[_ngcontent-%COMP%]{position:absolute;width:0;height:0;opacity:0}.tri-switch-internal.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled);cursor:default}.tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-label[_ngcontent-%COMP%]{cursor:default}.tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-checkmark[_ngcontent-%COMP%]{background-color:var(--colorNeutralForegroundDisabled)}.tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%]{border-color:var(--colorNeutralForegroundDisabled)}.tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-checkmark[_ngcontent-%COMP%]{background-color:var(--colorNeutralForegroundDisabled)}.tri-switch-internal.disabled[_ngcontent-%COMP%]   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackgroundDisabled);border-color:var(--colorNeutralBackgroundDisabled)}.tri-switch-internal[_ngcontent-%COMP%]:hover:not(.disabled)   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%]{border-color:transparent}.tri-switch-internal[_ngcontent-%COMP%]:hover:not(.disabled)   .tri-switch-checkmark[_ngcontent-%COMP%]{background-color:var(--colorNeutralForeground3Hover)}.tri-switch-internal[_ngcontent-%COMP%]:hover:not(.disabled)   .tri-switch-circle[_ngcontent-%COMP%]{border-color:var(--colorNeutralForeground3Hover)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled)   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-checkmark[_ngcontent-%COMP%]{background-color:var(--colorNeutralForegroundInverted)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled)   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%]{background-color:var(--colorCompoundBrandBackground);border-color:var(--colorCompoundBrandStroke)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled)   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-rect[_ngcontent-%COMP%]{background-color:var(--colorCompoundBrandBackground);border-color:var(--colorCompoundBrandStroke)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled)   .tri-switch-rect[_ngcontent-%COMP%]{background-color:var(--colorCompoundBrandBackground);border-color:var(--colorCompoundBrandStroke)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled):hover   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%]{background-color:var(--colorBrandBackgroundHover);border-color:var(--colorCompoundBrandStroke)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled):hover   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-rect[_ngcontent-%COMP%]{background-color:var(--colorBrandBackgroundHover);border-color:var(--colorCompoundBrandStroke)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled):active   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%]{background-color:var(--colorBrandBackgroundPressed);border-color:var(--colorBrandBackgroundPressed)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled):active   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-rect[_ngcontent-%COMP%]{background-color:var(--colorBrandBackgroundPressed);border-color:var(--colorBrandBackgroundPressed)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled):focus{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:var(--borderRadiusMedium)}.tri-switch-internal[_ngcontent-%COMP%]:not(.disabled):focus:after{border-radius:var(--borderRadiusSmall);border:1px solid var(--colorNeutralStrokeFocus1);content:"";display:block;height:calc(100% - 2px);width:calc(100% - 1px);position:absolute;left:0;bottom:0;top:0;right:0}.tri-switch-internal[_ngcontent-%COMP%]   .tri-switch-input[_ngcontent-%COMP%]:checked + section[_ngcontent-%COMP%]   .tri-switch-circle[_ngcontent-%COMP%]{flex-direction:row-reverse}.tri-switch-internal[_ngcontent-%COMP%]   .tri-switch-input[_ngcontent-%COMP%]{position:absolute}.tri-switch-circle[_ngcontent-%COMP%], .tri-switch-rect[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row;flex-shrink:0;justify-content:space-between;padding:2px 4px;width:40px;height:20px;border:1px solid var(--colorNeutralStrokeAccessible);border-radius:10px;box-sizing:border-box;transition-property:background,border,border-color;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,.23,1);overflow:hidden;background:var(--colorNeutralBackground1)}  html[data-focus-source=key] .tri-switch-input:focus+section{outline-offset:2px}.tri-switch-label[_ngcontent-%COMP%]{font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:400;display:block;margin-bottom:12px}.tri-switch-text[_ngcontent-%COMP%]{font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);color:var(--colorNeutralForeground1);line-height:20px;margin:0 0 0 12px}.tri-switch-checkmark[_ngcontent-%COMP%]{background-color:var(--colorNeutralForeground3);border-radius:50%;margin:2px 0;width:14px;height:14px}.tri-switch-dash[_ngcontent-%COMP%]{background-color:var(--colorNeutralForegroundInverted);border-radius:20%;margin:auto;width:14px;height:4px}'],changeDetection:0}),x}()},30651:function(De,J,p){p.d(J,{Jy:function(){return R}});var I=p(77476),e=p(17177),se=p(50423),R=function(){function D(){}return D.\u0275fac=function(X){return new(X||D)},D.\u0275mod=se.\u0275\u0275defineNgModule({type:D}),D.\u0275inj=se.\u0275\u0275defineInjector({imports:[I.CommonModule,e.T6]}),D}()},94908:function(De,J,p){p.d(J,{Mz:function(){return Ce},VI:function(){return mt},g8:function(){return Te},q5:function(){return U},zp:function(){return rt}});var Ee,Ge,et,Ve,Ze,je,We,I=p(62661),e=p(90341),se=p(37419),R=p(50423),D=p(48138),M=p(77476),X=p(21661),d=p(59051),B=p(51193),F=p(4437),k=p(10519),T=p(26124),w=p(34763),W=p(30794),ae=p(48636),x=p(63057),Y=p(59787),S=p(11547),Q=p(93247),q=p(22760),Z=p(17174),re=p(60733),ne=p(22318),he=p(81905),_e=p(48787),Ae=p(59973),ct=p(17653),Fe=p(70032),dt=p(14172),it=p(94130),Le=["panel"];function He(be,N){if(1&be){var L=R.\u0275\u0275getCurrentView();R.\u0275\u0275elementStart(0,"div",0,1),R.\u0275\u0275listener("@panelAnimation.done",function(b){R.\u0275\u0275restoreView(L);var y=R.\u0275\u0275nextContext();return R.\u0275\u0275resetView(y._animationDone.next(b))}),R.\u0275\u0275projection(2),R.\u0275\u0275elementEnd()}if(2&be){var h=N.id,g=R.\u0275\u0275nextContext();R.\u0275\u0275property("id",g.id)("ngClass",g._classList)("@panelAnimation",g.isOpen?"visible":"hidden"),R.\u0275\u0275attribute("aria-label",g.ariaLabel||null)("aria-labelledby",g._getPanelAriaLabelledby(h))}}var ut=(0,T.X$)("panelAnimation",[(0,T.SB)("void, hidden",(0,T.oB)({opacity:0,transform:"scaleY(0.8)"})),(0,T.eR)(":enter, hidden => visible",[(0,T.ru)([(0,T.jt)("0.03s linear",(0,T.oB)({opacity:1})),(0,T.jt)("0.12s cubic-bezier(0, 0, 0.2, 1)",(0,T.oB)({transform:"scaleY(1)"}))])]),(0,T.eR)(":leave, visible => hidden",[(0,T.jt)("0.075s linear",(0,T.oB)({opacity:0}))])]),yt=0,It=function(N,L){this.source=N,this.option=L},Ke=(0,D.Kr)(function(){return function(){}}()),Ft=new R.InjectionToken("mat-autocomplete-default-options",{providedIn:"root",factory:function(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}}),Ce=function(be){(0,se.Z)(L,be);var N=L.prototype;function L(h,g,m,b){var y;return(y=be.call(this)||this)._changeDetectorRef=h,y._elementRef=g,y._defaults=m,y._activeOptionChanges=w.w.EMPTY,y.showPanel=!1,y._isOpen=!1,y.displayWith=null,y.optionSelected=new R.EventEmitter,y.opened=new R.EventEmitter,y.closed=new R.EventEmitter,y.optionActivated=new R.EventEmitter,y._classList={},y.id="mat-autocomplete-"+yt++,y.inertGroups=b?.SAFARI||!1,y._autoActiveFirstOption=!!m.autoActiveFirstOption,y._autoSelectActiveOption=!!m.autoSelectActiveOption,y._requireSelection=!!m.requireSelection,y}return N._setColor=function(g){this._color=g,this._setThemeClasses(this._classList)},N.ngAfterContentInit=function(){var g=this;this._keyManager=new B.s1(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(function(m){g.isOpen&&g.optionActivated.emit({source:g,option:g.options.toArray()[m]||null})}),this._setVisibility()},N.ngOnDestroy=function(){var g;null==(g=this._keyManager)||g.destroy(),this._activeOptionChanges.unsubscribe()},N._setScrollTop=function(g){this.panel&&(this.panel.nativeElement.scrollTop=g)},N._getScrollTop=function(){return this.panel?this.panel.nativeElement.scrollTop:0},N._setVisibility=function(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()},N._emitSelectEvent=function(g){var m=new It(this,g);this.optionSelected.emit(m)},N._getPanelAriaLabelledby=function(g){return this.ariaLabel?null:this.ariaLabelledby?(g?g+" ":"")+this.ariaLabelledby:g},N._setVisibilityClasses=function(g){g[this._visibleClass]=this.showPanel,g[this._hiddenClass]=!this.showPanel},N._setThemeClasses=function(g){g["mat-primary"]="primary"===this._color,g["mat-warn"]="warn"===this._color,g["mat-accent"]="accent"===this._color},N._skipPredicate=function(g){return g.disabled},(0,e.Z)(L,[{key:"isOpen",get:function(){return this._isOpen&&this.showPanel}},{key:"autoActiveFirstOption",get:function(){return this._autoActiveFirstOption},set:function(g){this._autoActiveFirstOption=(0,F.Ig)(g)}},{key:"autoSelectActiveOption",get:function(){return this._autoSelectActiveOption},set:function(g){this._autoSelectActiveOption=(0,F.Ig)(g)}},{key:"requireSelection",get:function(){return this._requireSelection},set:function(g){this._requireSelection=(0,F.Ig)(g)}},{key:"classList",set:function(g){this._classList=g&&g.length?(0,F.du)(g).reduce(function(m,b){return m[b]=!0,m},{}):{},this._setVisibilityClasses(this._classList),this._setThemeClasses(this._classList),this._elementRef.nativeElement.className=""}}]),L}(Ke);(Ee=Ce).\u0275fac=function(N){return new(N||Ee)(R.\u0275\u0275directiveInject(R.ChangeDetectorRef),R.\u0275\u0275directiveInject(R.ElementRef),R.\u0275\u0275directiveInject(Ft),R.\u0275\u0275directiveInject(k.t4))},Ee.\u0275dir=R.\u0275\u0275defineDirective({type:Ee,viewQuery:function(N,L){var h;1&N&&(R.\u0275\u0275viewQuery(R.TemplateRef,7),R.\u0275\u0275viewQuery(Le,5)),2&N&&(R.\u0275\u0275queryRefresh(h=R.\u0275\u0275loadQuery())&&(L.template=h.first),R.\u0275\u0275queryRefresh(h=R.\u0275\u0275loadQuery())&&(L.panel=h.first))},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",autoSelectActiveOption:"autoSelectActiveOption",requireSelection:"requireSelection",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[R.\u0275\u0275InheritDefinitionFeature]});var ge=function(be){function N(){var h,g;return(g=be.apply(this,arguments)||this)._visibleClass="mat-mdc-autocomplete-visible",g._hiddenClass="mat-mdc-autocomplete-hidden",g._animationDone=new R.EventEmitter,g._hideSingleSelectionIndicator=null!=(h=g._defaults.hideSingleSelectionIndicator)&&h,g}(0,se.Z)(N,be);var L=N.prototype;return L._syncParentProperties=function(){if(this.options)for(var m,g=(0,I.Z)(this.options);!(m=g()).done;)m.value._changeDetectorRef.markForCheck()},L.ngOnDestroy=function(){be.prototype.ngOnDestroy.call(this),this._animationDone.complete()},L._skipPredicate=function(g){return!1},(0,e.Z)(N,[{key:"hideSingleSelectionIndicator",get:function(){return this._hideSingleSelectionIndicator},set:function(g){this._hideSingleSelectionIndicator=(0,F.Ig)(g),this._syncParentProperties()}}]),N}(Ce);(Ge=ge).\u0275fac=function(){var be;return function(L){return(be||(be=R.\u0275\u0275getInheritedFactory(Ge)))(L||Ge)}}(),Ge.\u0275cmp=R.\u0275\u0275defineComponent({type:Ge,selectors:[["mat-autocomplete"]],contentQueries:function(N,L,h){var g;1&N&&(R.\u0275\u0275contentQuery(h,D.K7,5),R.\u0275\u0275contentQuery(h,D.ey,5)),2&N&&(R.\u0275\u0275queryRefresh(g=R.\u0275\u0275loadQuery())&&(L.optionGroups=g),R.\u0275\u0275queryRefresh(g=R.\u0275\u0275loadQuery())&&(L.options=g))},hostAttrs:["ngSkipHydration","",1,"mat-mdc-autocomplete"],inputs:{disableRipple:"disableRipple",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matAutocomplete"],features:[R.\u0275\u0275ProvidersFeature([{provide:D.HF,useExisting:Ge}]),R.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:1,vars:0,consts:[["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id","ngClass"],["panel",""]],template:function(N,L){1&N&&(R.\u0275\u0275projectionDef(),R.\u0275\u0275template(0,He,3,5,"ng-template"))},dependencies:[M.NgClass],styles:["div.mat-mdc-autocomplete-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[ut]},changeDetection:0});var U=function(N){this.elementRef=N};(et=U).\u0275fac=function(N){return new(N||et)(R.\u0275\u0275directiveInject(R.ElementRef))},et.\u0275dir=R.\u0275\u0275defineDirective({type:et});var P=function(be){function N(){return be.apply(this,arguments)||this}return(0,se.Z)(N,be),N}(U);(Ve=P).\u0275fac=function(){var be;return function(L){return(be||(be=R.\u0275\u0275getInheritedFactory(Ve)))(L||Ve)}}(),Ve.\u0275dir=R.\u0275\u0275defineDirective({type:Ve,selectors:[["","matAutocompleteOrigin",""]],exportAs:["matAutocompleteOrigin"],features:[R.\u0275\u0275InheritDefinitionFeature]});var O={provide:Z.JU,useExisting:(0,R.forwardRef)(function(){return Re}),multi:!0},Te=new R.InjectionToken("mat-autocomplete-scroll-strategy"),rt={provide:Te,deps:[d.aV],useFactory:function(be){return function(){return be.scrollStrategies.reposition()}}},mt=function(){function be(L,h,g,m,b,y,A,K,ee,me,Pe){var pe=this;this._element=L,this._overlay=h,this._viewContainerRef=g,this._zone=m,this._changeDetectorRef=b,this._dir=A,this._formField=K,this._document=ee,this._viewportRuler=me,this._defaults=Pe,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=w.w.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new W.xQ,this._windowBlurHandler=function(){pe._canOpenOnNextFocus=pe._document.activeElement!==pe._element.nativeElement||pe.panelOpen},this._onChange=function(){},this._onTouched=function(){},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,ae.P)(function(){var Oe=pe.autocomplete?pe.autocomplete.options:null;return Oe?Oe.changes.pipe((0,ne.O)(Oe),(0,he.w)(function(){return x.T.apply(void 0,Oe.map(function(vt){return vt.onSelectionChange}))})):pe._zone.onStable.pipe((0,_e.q)(1),(0,he.w)(function(){return pe.optionSelections}))}),this._handlePanelKeydown=function(Oe){var vt;(Oe.keyCode===Q.hY&&!(0,Q.Vb)(Oe)||Oe.keyCode===Q.LH&&(0,Q.Vb)(Oe,"altKey"))&&(pe._pendingAutoselectedOption&&(pe._updateNativeInputValue(null!=(vt=pe._valueBeforeAutoSelection)?vt:""),pe._pendingAutoselectedOption=null),pe._closeKeyEventStream.next(),pe._resetActiveItem(),Oe.stopPropagation(),Oe.preventDefault())},this._trackedModal=null,this._scrollStrategy=y}var N=be.prototype;return N.ngAfterViewInit=function(){var h=this,g=this._getWindow();typeof g<"u"&&this._zone.runOutsideAngular(function(){return g.addEventListener("blur",h._windowBlurHandler)})},N.ngOnChanges=function(h){h.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())},N.ngOnDestroy=function(){var h=this._getWindow();typeof h<"u"&&h.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()},N.openPanel=function(){this._attachOverlay(),this._floatLabel(),this._trackedModal&&(0,B.Zf)(this._trackedModal,"aria-owns",this.autocomplete.id)},N.closePanel=function(){var h=this;this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(function(){h.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal)&&(0,B.iD)(this._trackedModal,"aria-owns",this.autocomplete.id)},N.updatePosition=function(){this._overlayAttached&&this._overlayRef.updatePosition()},N._getOutsideClickStream=function(){var h=this;return(0,x.T)((0,Y.R)(this._document,"click"),(0,Y.R)(this._document,"auxclick"),(0,Y.R)(this._document,"touchend")).pipe((0,Ae.h)(function(g){var m=(0,k.sA)(g),b=h._formField?h._formField._elementRef.nativeElement:null,y=h.connectedTo?h.connectedTo.elementRef.nativeElement:null;return h._overlayAttached&&m!==h._element.nativeElement&&h._document.activeElement!==h._element.nativeElement&&(!b||!b.contains(m))&&(!y||!y.contains(m))&&!!h._overlayRef&&!h._overlayRef.overlayElement.contains(m)}))},N.writeValue=function(h){var g=this;Promise.resolve(null).then(function(){return g._assignOptionValue(h)})},N.registerOnChange=function(h){this._onChange=h},N.registerOnTouched=function(h){this._onTouched=h},N.setDisabledState=function(h){this._element.nativeElement.disabled=h},N._handleKeydown=function(h){var g=h.keyCode,m=(0,Q.Vb)(h);if(g===Q.hY&&!m&&h.preventDefault(),this.activeOption&&g===Q.K5&&this.panelOpen&&!m)this.activeOption._selectViaInteraction(),this._resetActiveItem(),h.preventDefault();else if(this.autocomplete){var b=this.autocomplete._keyManager.activeItem,y=g===Q.LH||g===Q.JH;g===Q.Mf||y&&!m&&this.panelOpen?this.autocomplete._keyManager.onKeydown(h):y&&this._canOpen()&&this.openPanel(),(y||this.autocomplete._keyManager.activeItem!==b)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._element.nativeElement.value),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}},N._handleInput=function(h){var g=h.target,m=g.value;"number"===g.type&&(m=""==m?null:parseFloat(m)),this._previousValue!==m&&(this._previousValue=m,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(m),m||this._clearPreviousSelectedOption(null,!1),this._canOpen()&&this._document.activeElement===h.target&&this.openPanel())},N._handleFocus=function(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0},N._handleClick=function(){this._canOpen()&&!this.panelOpen&&this.openPanel()},N._floatLabel=function(h){void 0===h&&(h=!1),this._formField&&"auto"===this._formField.floatLabel&&(h?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)},N._resetLabel=function(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)},N._subscribeToClosingActions=function(){var h=this,g=this._zone.onStable.pipe((0,_e.q)(1)),m=this.autocomplete.options.changes.pipe((0,ct.b)(function(){return h._positionStrategy.reapplyLastPosition()}),(0,Fe.g)(0));return(0,x.T)(g,m).pipe((0,he.w)(function(){return h._zone.run(function(){var b=h.panelOpen;h._resetActiveItem(),h._updatePanelState(),h._changeDetectorRef.detectChanges(),h.panelOpen&&h._overlayRef.updatePosition(),b!==h.panelOpen&&(h.panelOpen?(h._captureValueOnAttach(),h._emitOpened()):h.autocomplete.closed.emit())}),h.panelClosingActions}),(0,_e.q)(1)).subscribe(function(b){return h._setValueAndClose(b)})},N._emitOpened=function(){this.autocomplete.opened.emit()},N._captureValueOnAttach=function(){this._valueOnAttach=this._element.nativeElement.value},N._destroyPanel=function(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)},N._assignOptionValue=function(h){var g=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(h):h;this._updateNativeInputValue(g??"")},N._updateNativeInputValue=function(h){this._formField?this._formField._control.value=h:this._element.nativeElement.value=h,this._previousValue=h},N._setValueAndClose=function(h){var g=this,m=this.autocomplete,b=h?h.source:this._pendingAutoselectedOption;b?(this._clearPreviousSelectedOption(b),this._assignOptionValue(b.value),this._onChange(b.value),m._emitSelectEvent(b),this._element.nativeElement.focus()):m.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),m._animationDone?m._animationDone.pipe((0,_e.q)(1)).subscribe(function(){return g._onChange(null)}):this._onChange(null)),this.closePanel()},N._clearPreviousSelectedOption=function(h,g){var m;null==(m=this.autocomplete)||null==(m=m.options)||m.forEach(function(b){b!==h&&b.selected&&b.deselect(g)})},N._attachOverlay=function(){var g,b,h=this,m=this._overlayRef;m?(this._positionStrategy.setOrigin(this._getConnectedElement()),m.updateSize({width:this._getPanelWidth()})):(this._portal=new q.UE(this.autocomplete.template,this._viewContainerRef,{id:null==(b=this._formField)?void 0:b.getLabelId()}),m=this._overlay.create(this._getOverlayConfig()),this._overlayRef=m,this._viewportSubscription=this._viewportRuler.change().subscribe(function(){h.panelOpen&&m&&m.updateSize({width:h._getPanelWidth()})})),m&&!m.hasAttached()&&(m.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());var y=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._setColor(null==(g=this._formField)?void 0:g.color),this._updatePanelState(),this._applyModalPanelOwnership(),this._captureValueOnAttach(),this.panelOpen&&y!==this.panelOpen&&this._emitOpened()},N._updatePanelState=function(){if(this.autocomplete._setVisibility(),this.panelOpen){var h=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=h.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=h.outsidePointerEvents().subscribe())}else{var g,m;null==(g=this._keydownSubscription)||g.unsubscribe(),null==(m=this._outsideClickSubscription)||m.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}},N._getOverlayConfig=function(){var h,g;return new d.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:null!=(h=this._dir)?h:void 0,panelClass:null==(g=this._defaults)?void 0:g.overlayPanelClass})},N._getOverlayPosition=function(){var h=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(h),this._positionStrategy=h,h},N._setStrategyPositions=function(h){var y,g=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],m=this._aboveClass,b=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:m},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:m}];y="above"===this.position?b:"below"===this.position?g:[].concat(g,b),h.withPositions(y)},N._getConnectedElement=function(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element},N._getPanelWidth=function(){return this.autocomplete.panelWidth||this._getHostWidth()},N._getHostWidth=function(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width},N._resetActiveItem=function(){var h=this.autocomplete;if(h.autoActiveFirstOption){for(var g=-1,m=0;m<h.options.length;m++)if(!h.options.get(m).disabled){g=m;break}h._keyManager.setActiveItem(g)}else h._keyManager.setActiveItem(-1)},N._canOpen=function(){var h=this._element.nativeElement;return!h.readOnly&&!h.disabled&&!this._autocompleteDisabled},N._getWindow=function(){var h;return(null==(h=this._document)?void 0:h.defaultView)||window},N._scrollToOption=function(h){var g=this.autocomplete,m=(0,D.CB)(h,g.options,g.optionGroups);if(0===h&&1===m)g._setScrollTop(0);else if(g.panel){var b=g.options.toArray()[h];if(b){var y=b._getHostElement(),A=(0,D.jH)(y.offsetTop,y.offsetHeight,g._getScrollTop(),g.panel.nativeElement.offsetHeight);g._setScrollTop(A)}}},N._applyModalPanelOwnership=function(){var h=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(h){var g=this.autocomplete.id;this._trackedModal&&(0,B.iD)(this._trackedModal,"aria-owns",g),(0,B.Zf)(h,"aria-owns",g),this._trackedModal=h}},N._clearFromModal=function(){this._trackedModal&&((0,B.iD)(this._trackedModal,"aria-owns",this.autocomplete.id),this._trackedModal=null)},(0,e.Z)(be,[{key:"autocompleteDisabled",get:function(){return this._autocompleteDisabled},set:function(h){this._autocompleteDisabled=(0,F.Ig)(h)}},{key:"panelOpen",get:function(){return this._overlayAttached&&this.autocomplete.showPanel}},{key:"panelClosingActions",get:function(){var h=this;return(0,x.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,Ae.h)(function(){return h._overlayAttached})),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,Ae.h)(function(){return h._overlayAttached})):(0,S.of)()).pipe((0,dt.U)(function(g){return g instanceof D.rN?g:null}))}},{key:"activeOption",get:function(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}}]),be}();(Ze=mt).\u0275fac=function(N){return new(N||Ze)(R.\u0275\u0275directiveInject(R.ElementRef),R.\u0275\u0275directiveInject(d.aV),R.\u0275\u0275directiveInject(R.ViewContainerRef),R.\u0275\u0275directiveInject(R.NgZone),R.\u0275\u0275directiveInject(R.ChangeDetectorRef),R.\u0275\u0275directiveInject(Te),R.\u0275\u0275directiveInject(it.Is,8),R.\u0275\u0275directiveInject(re.G_,9),R.\u0275\u0275directiveInject(M.DOCUMENT,8),R.\u0275\u0275directiveInject(X.rL),R.\u0275\u0275directiveInject(Ft,8))},Ze.\u0275dir=R.\u0275\u0275defineDirective({type:Ze,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[R.\u0275\u0275NgOnChangesFeature]});var Re=function(be){function N(){var L;return(L=be.apply(this,arguments)||this)._aboveClass="mat-mdc-autocomplete-panel-above",L}return(0,se.Z)(N,be),N}(mt);(je=Re).\u0275fac=function(){var be;return function(L){return(be||(be=R.\u0275\u0275getInheritedFactory(je)))(L||je)}}(),je.\u0275dir=R.\u0275\u0275defineDirective({type:je,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(N,L){1&N&&R.\u0275\u0275listener("focusin",function(){return L._handleFocus()})("blur",function(){return L._onTouched()})("input",function(g){return L._handleInput(g)})("keydown",function(g){return L._handleKeydown(g)})("click",function(){return L._handleClick()}),2&N&&R.\u0275\u0275attribute("autocomplete",L.autocompleteAttribute)("role",L.autocompleteDisabled?null:"combobox")("aria-autocomplete",L.autocompleteDisabled?null:"list")("aria-activedescendant",L.panelOpen&&L.activeOption?L.activeOption.id:null)("aria-expanded",L.autocompleteDisabled?null:L.panelOpen.toString())("aria-controls",L.autocompleteDisabled||!L.panelOpen||null==L.autocomplete?null:L.autocomplete.id)("aria-haspopup",L.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[R.\u0275\u0275ProvidersFeature([O]),R.\u0275\u0275InheritDefinitionFeature]}),(We=function(){}).\u0275fac=function(N){return new(N||We)},We.\u0275mod=R.\u0275\u0275defineNgModule({type:We}),We.\u0275inj=R.\u0275\u0275defineInjector({providers:[rt],imports:[d.U8,D.Ng,D.BQ,M.CommonModule,X.ZD,D.Ng,D.BQ]})},34895:function(De,J,p){p.d(J,{D8:function(){return q},QJ:function(){return S},VN:function(){return x}});var F,k,T,w,I=p(37419),e=p(50423),se=p(48138),R=p(33846),D=p(94908),M=p(77476),X=p(59051),d=p(21661),B=p(17174);function W(Z,re){if(1&Z&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275projection(2),e.\u0275\u0275elementEnd()),2&Z){var ne=re.id,he=e.\u0275\u0275nextContext();e.\u0275\u0275property("id",he.id)("ngClass",he._classList),e.\u0275\u0275attribute("aria-label",he.ariaLabel||null)("aria-labelledby",he._getPanelAriaLabelledby(ne))}}var x=function(Z){function re(){var ne;return(ne=Z.apply(this,arguments)||this)._visibleClass="mat-autocomplete-visible",ne._hiddenClass="mat-autocomplete-hidden",ne._animationDone=null,ne}return(0,I.Z)(re,Z),re}(D.Mz);(F=x).\u0275fac=function(){var Z;return function(ne){return(Z||(Z=e.\u0275\u0275getInheritedFactory(F)))(ne||F)}}(),F.\u0275cmp=e.\u0275\u0275defineComponent({type:F,selectors:[["mat-autocomplete"]],contentQueries:function(re,ne,he){var _e;1&re&&(e.\u0275\u0275contentQuery(he,se.K7,5),e.\u0275\u0275contentQuery(he,R.CK,5)),2&re&&(e.\u0275\u0275queryRefresh(_e=e.\u0275\u0275loadQuery())&&(ne.optionGroups=_e),e.\u0275\u0275queryRefresh(_e=e.\u0275\u0275loadQuery())&&(ne.options=_e))},hostAttrs:["ngSkipHydration","",1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[e.\u0275\u0275ProvidersFeature([{provide:se.HF,useExisting:F}]),e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(re,ne){1&re&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275template(0,W,3,4,"ng-template"))},dependencies:[M.NgClass],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}"],encapsulation:2,changeDetection:0});var Y={provide:B.JU,useExisting:(0,e.forwardRef)(function(){return S}),multi:!0},S=function(Z){function re(){var ne;return(ne=Z.apply(this,arguments)||this)._aboveClass="mat-autocomplete-panel-above",ne}return(0,I.Z)(re,Z),re}(D.VI);(k=S).\u0275fac=function(){var Z;return function(ne){return(Z||(Z=e.\u0275\u0275getInheritedFactory(k)))(ne||k)}}(),k.\u0275dir=e.\u0275\u0275defineDirective({type:k,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(re,ne){1&re&&e.\u0275\u0275listener("focusin",function(){return ne._handleFocus()})("blur",function(){return ne._onTouched()})("input",function(_e){return ne._handleInput(_e)})("keydown",function(_e){return ne._handleKeydown(_e)})("click",function(){return ne._handleClick()}),2&re&&e.\u0275\u0275attribute("autocomplete",ne.autocompleteAttribute)("role",ne.autocompleteDisabled?null:"combobox")("aria-autocomplete",ne.autocompleteDisabled?null:"list")("aria-activedescendant",ne.panelOpen&&ne.activeOption?ne.activeOption.id:null)("aria-expanded",ne.autocompleteDisabled?null:ne.panelOpen.toString())("aria-owns",ne.autocompleteDisabled||!ne.panelOpen||null==ne.autocomplete?null:ne.autocomplete.id)("aria-haspopup",ne.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[e.\u0275\u0275ProvidersFeature([Y]),e.\u0275\u0275InheritDefinitionFeature]});var Q=function(Z){function re(){return Z.apply(this,arguments)||this}return(0,I.Z)(re,Z),re}(D.q5);(T=Q).\u0275fac=function(){var Z;return function(ne){return(Z||(Z=e.\u0275\u0275getInheritedFactory(T)))(ne||T)}}(),T.\u0275dir=e.\u0275\u0275defineDirective({type:T,selectors:[["","matAutocompleteOrigin",""]],exportAs:["matAutocompleteOrigin"],features:[e.\u0275\u0275InheritDefinitionFeature]});var q=function(){};(w=q).\u0275fac=function(re){return new(re||w)},w.\u0275mod=e.\u0275\u0275defineNgModule({type:w}),w.\u0275inj=e.\u0275\u0275defineInjector({providers:[D.zp],imports:[X.U8,R.Uc,se.BQ,M.CommonModule,d.ZD,R.Uc,se.BQ]})},89075:function(De,J,p){p.d(J,{IP:function(){return Ke},Y6:function(){return We},ir:function(){return yt},lw:function(){return je},yD:function(){return Pt}});var q,Z,re,ne,he,_e,Ae,I=p(90341),e=p(76920),se=p(37419),R=p(93247),D=p(50423),M=p(48138),X=p(4437),d=p(10519),B=p(77476),F=p(30794),k=p(63057),T=p(48787),w=p(83317),W=p(22318),ae=p(51193),x=p(94130),Y=p(77445),S=p(17174),Q=p(60733),dt=new D.InjectionToken("MatChipRemove"),it=new D.InjectionToken("MatChipAvatar"),Ee=new D.InjectionToken("MatChipTrailingIcon"),et=(0,M.sb)((0,M.pj)((0,M.Kr)(function(ge){this._elementRef=ge}),"primary"),-1);(q=function(){}).\u0275fac=function(ge){return new(ge||q)},q.\u0275dir=D.\u0275\u0275defineDirective({type:q,selectors:[["mat-chip-avatar"],["","matChipAvatar",""]],hostAttrs:[1,"mat-chip-avatar"],features:[D.\u0275\u0275ProvidersFeature([{provide:it,useExisting:q}])]});(Z=function(){}).\u0275fac=function(ge){return new(ge||Z)},Z.\u0275dir=D.\u0275\u0275defineDirective({type:Z,selectors:[["mat-chip-trailing-icon"],["","matChipTrailingIcon",""]],hostAttrs:[1,"mat-chip-trailing-icon"],features:[D.\u0275\u0275ProvidersFeature([{provide:Ee,useExisting:Z}])]});var je=function(Ce){function ge(P,O,ue,Te,$e,rt,mt,Re){var xe;return(xe=Ce.call(this,P)||this)._ngZone=O,xe._changeDetectorRef=$e,xe._hasFocus=!1,xe.chipListSelectable=!0,xe._chipListMultiple=!1,xe._chipListDisabled=!1,xe.role="option",xe._selected=!1,xe._selectable=!0,xe._disabled=!1,xe._removable=!0,xe._onFocus=new F.xQ,xe._onBlur=new F.xQ,xe.selectionChange=new D.EventEmitter,xe.destroyed=new D.EventEmitter,xe.removed=new D.EventEmitter,xe._addHostClassName(),xe._chipRippleTarget=rt.createElement("div"),xe._chipRippleTarget.classList.add("mat-chip-ripple"),xe._elementRef.nativeElement.appendChild(xe._chipRippleTarget),xe._chipRipple=new M.IR((0,e.Z)(xe),O,xe._chipRippleTarget,ue),xe._chipRipple.setupTriggerEvents(P),xe.rippleConfig=Te||{},xe._animationsDisabled="NoopAnimations"===mt,xe.tabIndex=null!=Re&&parseInt(Re)||-1,xe}(0,se.Z)(ge,Ce);var U=ge.prototype;return U._addHostClassName=function(){var O="mat-basic-chip",ue=this._elementRef.nativeElement;ue.hasAttribute(O)||ue.tagName.toLowerCase()===O?ue.classList.add(O):ue.classList.add("mat-standard-chip")},U.ngOnDestroy=function(){this.destroyed.emit({chip:this}),this._chipRipple._removeTriggerEvents()},U.select=function(){this._selected||(this._selected=!0,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())},U.deselect=function(){this._selected&&(this._selected=!1,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())},U.selectViaInteraction=function(){this._selected||(this._selected=!0,this._dispatchSelectionChange(!0),this._changeDetectorRef.markForCheck())},U.toggleSelected=function(O){return void 0===O&&(O=!1),this._selected=!this.selected,this._dispatchSelectionChange(O),this._changeDetectorRef.markForCheck(),this.selected},U.focus=function(){this._hasFocus||(this._elementRef.nativeElement.focus(),this._onFocus.next({chip:this})),this._hasFocus=!0},U.remove=function(){this.removable&&this.removed.emit({chip:this})},U._handleClick=function(O){this.disabled&&O.preventDefault()},U._handleKeydown=function(O){if(!this.disabled)switch(O.keyCode){case R.yY:case R.ZH:this.remove(),O.preventDefault();break;case R.L_:this.selectable&&this.toggleSelected(!0),O.preventDefault()}},U._blur=function(){var O=this;this._ngZone.onStable.pipe((0,T.q)(1)).subscribe(function(){O._ngZone.run(function(){O._hasFocus=!1,O._onBlur.next({chip:O})})})},U._dispatchSelectionChange=function(O){void 0===O&&(O=!1),this.selectionChange.emit({source:this,isUserInput:O,selected:this._selected})},(0,I.Z)(ge,[{key:"rippleDisabled",get:function(){return this.disabled||this.disableRipple||this._animationsDisabled||!!this.rippleConfig.disabled}},{key:"selected",get:function(){return this._selected},set:function(O){var ue=(0,X.Ig)(O);ue!==this._selected&&(this._selected=ue,this._dispatchSelectionChange())}},{key:"value",get:function(){return void 0!==this._value?this._value:this._elementRef.nativeElement.textContent},set:function(O){this._value=O}},{key:"selectable",get:function(){return this._selectable&&this.chipListSelectable},set:function(O){this._selectable=(0,X.Ig)(O)}},{key:"disabled",get:function(){return this._chipListDisabled||this._disabled},set:function(O){this._disabled=(0,X.Ig)(O)}},{key:"removable",get:function(){return this._removable},set:function(O){this._removable=(0,X.Ig)(O)}},{key:"ariaSelected",get:function(){return this.selectable&&(this._chipListMultiple||this.selected)?this.selected.toString():null}}]),ge}(et);(re=je).\u0275fac=function(ge){return new(ge||re)(D.\u0275\u0275directiveInject(D.ElementRef),D.\u0275\u0275directiveInject(D.NgZone),D.\u0275\u0275directiveInject(d.t4),D.\u0275\u0275directiveInject(M.Y2,8),D.\u0275\u0275directiveInject(D.ChangeDetectorRef),D.\u0275\u0275directiveInject(B.DOCUMENT),D.\u0275\u0275directiveInject(D.ANIMATION_MODULE_TYPE,8),D.\u0275\u0275injectAttribute("tabindex"))},re.\u0275dir=D.\u0275\u0275defineDirective({type:re,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(ge,U,P){var O;1&ge&&(D.\u0275\u0275contentQuery(P,it,5),D.\u0275\u0275contentQuery(P,Ee,5),D.\u0275\u0275contentQuery(P,dt,5)),2&ge&&(D.\u0275\u0275queryRefresh(O=D.\u0275\u0275loadQuery())&&(U.avatar=O.first),D.\u0275\u0275queryRefresh(O=D.\u0275\u0275loadQuery())&&(U.trailingIcon=O.first),D.\u0275\u0275queryRefresh(O=D.\u0275\u0275loadQuery())&&(U.removeIcon=O.first))},hostAttrs:[1,"mat-chip","mat-focus-indicator"],hostVars:15,hostBindings:function(ge,U){1&ge&&D.\u0275\u0275listener("click",function(O){return U._handleClick(O)})("keydown",function(O){return U._handleKeydown(O)})("focus",function(){return U.focus()})("blur",function(){return U._blur()}),2&ge&&(D.\u0275\u0275attribute("tabindex",U.disabled?null:U.tabIndex)("role",U.role)("disabled",U.disabled||null)("aria-disabled",U.disabled.toString())("aria-selected",U.ariaSelected),D.\u0275\u0275classProp("mat-chip-selected",U.selected)("mat-chip-with-avatar",U.avatar)("mat-chip-with-trailing-icon",U.trailingIcon||U.removeIcon)("mat-chip-disabled",U.disabled)("_mat-animation-noopable",U._animationsDisabled))},inputs:{color:"color",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",selected:"selected",value:"value",selectable:"selectable",disabled:"disabled",removable:"removable"},outputs:{selectionChange:"selectionChange",destroyed:"destroyed",removed:"removed"},exportAs:["matChip"],features:[D.\u0275\u0275InheritDefinitionFeature]});var We=function(){function Ce(U,P){this._parentChip=U,"BUTTON"===P.nativeElement.nodeName&&P.nativeElement.setAttribute("type","button")}return Ce.prototype._handleClick=function(P){var O=this._parentChip;O.removable&&!O.disabled&&O.remove(),P.stopPropagation(),P.preventDefault()},Ce}();(ne=We).\u0275fac=function(ge){return new(ge||ne)(D.\u0275\u0275directiveInject(je),D.\u0275\u0275directiveInject(D.ElementRef))},ne.\u0275dir=D.\u0275\u0275defineDirective({type:ne,selectors:[["","matChipRemove",""]],hostAttrs:[1,"mat-chip-remove","mat-chip-trailing-icon"],hostBindings:function(ge,U){1&ge&&D.\u0275\u0275listener("click",function(O){return U._handleClick(O)})},features:[D.\u0275\u0275ProvidersFeature([{provide:dt,useExisting:ne}])]});var Le=new D.InjectionToken("mat-chips-default-options"),He=(0,M.FD)(function(){return function(ge,U,P,O){this._defaultErrorStateMatcher=ge,this._parentForm=U,this._parentFormGroup=P,this.ngControl=O,this.stateChanges=new F.xQ}}()),xt=0,ut=function(ge,U){this.source=ge,this.value=U},yt=function(Ce){function ge(P,O,ue,Te,$e,rt,mt){var Re;return(Re=Ce.call(this,rt,Te,$e,mt)||this)._elementRef=P,Re._changeDetectorRef=O,Re._dir=ue,Re.controlType="mat-chip-list",Re._lastDestroyedChipIndex=null,Re._destroyed=new F.xQ,Re._uid="mat-chip-list-"+xt++,Re._tabIndex=0,Re._userTabIndex=null,Re._onTouched=function(){},Re._onChange=function(){},Re._multiple=!1,Re._compareWith=function(xe,be){return xe===be},Re._disabled=!1,Re.ariaOrientation="horizontal",Re._selectable=!0,Re.change=new D.EventEmitter,Re.valueChange=new D.EventEmitter,Re.ngControl&&(Re.ngControl.valueAccessor=(0,e.Z)(Re)),Re}(0,se.Z)(ge,Ce);var U=ge.prototype;return U.ngAfterContentInit=function(){var O=this;this._keyManager=new ae.Em(this.chips).withWrap().withVerticalOrientation().withHomeAndEnd().withHorizontalOrientation(this._dir?this._dir.value:"ltr"),this._dir&&this._dir.change.pipe((0,w.R)(this._destroyed)).subscribe(function(ue){return O._keyManager.withHorizontalOrientation(ue)}),this._keyManager.tabOut.subscribe(function(){return O._allowFocusEscape()}),this.chips.changes.pipe((0,W.O)(null),(0,w.R)(this._destroyed)).subscribe(function(){(O.disabled||!O.selectable)&&Promise.resolve().then(function(){O._syncChipsState()}),O._resetChips(),O._initializeSelection(),O._updateTabIndex(),O._updateFocusForDestroyedChips(),O.stateChanges.next()})},U.ngOnInit=function(){this._selectionModel=new Y.Ov(this.multiple,void 0,!1),this.stateChanges.next()},U.ngDoCheck=function(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==this._disabled&&(this.disabled=!!this.ngControl.disabled))},U.ngOnDestroy=function(){var O;null==(O=this._keyManager)||O.destroy(),this._destroyed.next(),this._destroyed.complete(),this.stateChanges.complete(),this._dropSubscriptions()},U.registerInput=function(O){this._chipInput=O,this._elementRef.nativeElement.setAttribute("data-mat-chip-input",O.id)},U.setDescribedByIds=function(O){O.length?this._elementRef.nativeElement.setAttribute("aria-describedby",O.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")},U.writeValue=function(O){this.chips&&this._setSelectionByValue(O,!1)},U.registerOnChange=function(O){this._onChange=O},U.registerOnTouched=function(O){this._onTouched=O},U.setDisabledState=function(O){this.disabled=O,this.stateChanges.next()},U.onContainerClick=function(O){this._originatesFromChip(O)||this.focus()},U.focus=function(O){this.disabled||this._chipInput&&this._chipInput.focused||(this.chips.length>0?(this._keyManager.setFirstItemActive(),this.stateChanges.next()):(this._focusInput(O),this.stateChanges.next()))},U._focusInput=function(O){this._chipInput&&this._chipInput.focus(O)},U._keydown=function(O){var ue=O.target;ue&&ue.classList.contains("mat-chip")&&(this._keyManager.onKeydown(O),this.stateChanges.next())},U._updateTabIndex=function(){this._tabIndex=this._userTabIndex||(0===this.chips.length?-1:0)},U._updateFocusForDestroyedChips=function(){if(null!=this._lastDestroyedChipIndex)if(this.chips.length){var O=Math.min(this._lastDestroyedChipIndex,this.chips.length-1);this._keyManager.setActiveItem(O)}else this.focus();this._lastDestroyedChipIndex=null},U._isValidIndex=function(O){return O>=0&&O<this.chips.length},U._setSelectionByValue=function(O,ue){var Te=this;if(void 0===ue&&(ue=!0),this._clearSelection(),this.chips.forEach(function(rt){return rt.deselect()}),Array.isArray(O))O.forEach(function(rt){return Te._selectValue(rt,ue)}),this._sortValues();else{var $e=this._selectValue(O,ue);$e&&ue&&this._keyManager.setActiveItem($e)}},U._selectValue=function(O,ue){var Te=this;void 0===ue&&(ue=!0);var $e=this.chips.find(function(rt){return null!=rt.value&&Te._compareWith(rt.value,O)});return $e&&(ue?$e.selectViaInteraction():$e.select(),this._selectionModel.select($e)),$e},U._initializeSelection=function(){var O=this;Promise.resolve().then(function(){(O.ngControl||O._value)&&(O._setSelectionByValue(O.ngControl?O.ngControl.value:O._value,!1),O.stateChanges.next())})},U._clearSelection=function(O){this._selectionModel.clear(),this.chips.forEach(function(ue){ue!==O&&ue.deselect()}),this.stateChanges.next()},U._sortValues=function(){var O=this;this._multiple&&(this._selectionModel.clear(),this.chips.forEach(function(ue){ue.selected&&O._selectionModel.select(ue)}),this.stateChanges.next())},U._propagateChanges=function(O){var ue;ue=Array.isArray(this.selected)?this.selected.map(function(Te){return Te.value}):this.selected?this.selected.value:O,this._value=ue,this.change.emit(new ut(this,ue)),this.valueChange.emit(ue),this._onChange(ue),this._changeDetectorRef.markForCheck()},U._blur=function(){var O=this;this._hasFocusedChip()||this._keyManager.setActiveItem(-1),this.disabled||(this._chipInput?setTimeout(function(){O.focused||O._markAsTouched()}):this._markAsTouched())},U._markAsTouched=function(){this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next()},U._allowFocusEscape=function(){var O=this;-1!==this._tabIndex&&(this._tabIndex=-1,setTimeout(function(){O._tabIndex=O._userTabIndex||0,O._changeDetectorRef.markForCheck()}))},U._resetChips=function(){this._dropSubscriptions(),this._listenToChipsFocus(),this._listenToChipsSelection(),this._listenToChipsRemoved()},U._dropSubscriptions=function(){this._chipFocusSubscription&&(this._chipFocusSubscription.unsubscribe(),this._chipFocusSubscription=null),this._chipBlurSubscription&&(this._chipBlurSubscription.unsubscribe(),this._chipBlurSubscription=null),this._chipSelectionSubscription&&(this._chipSelectionSubscription.unsubscribe(),this._chipSelectionSubscription=null),this._chipRemoveSubscription&&(this._chipRemoveSubscription.unsubscribe(),this._chipRemoveSubscription=null)},U._listenToChipsSelection=function(){var O=this;this._chipSelectionSubscription=this.chipSelectionChanges.subscribe(function(ue){ue.source.selected?O._selectionModel.select(ue.source):O._selectionModel.deselect(ue.source),O.multiple||O.chips.forEach(function(Te){!O._selectionModel.isSelected(Te)&&Te.selected&&Te.deselect()}),ue.isUserInput&&O._propagateChanges()})},U._listenToChipsFocus=function(){var O=this;this._chipFocusSubscription=this.chipFocusChanges.subscribe(function(ue){var Te=O.chips.toArray().indexOf(ue.chip);O._isValidIndex(Te)&&O._keyManager.updateActiveItem(Te),O.stateChanges.next()}),this._chipBlurSubscription=this.chipBlurChanges.subscribe(function(){O._blur(),O.stateChanges.next()})},U._listenToChipsRemoved=function(){var O=this;this._chipRemoveSubscription=this.chipRemoveChanges.subscribe(function(ue){var Te=ue.chip,$e=O.chips.toArray().indexOf(ue.chip);O._isValidIndex($e)&&Te._hasFocus&&(O._lastDestroyedChipIndex=$e)})},U._originatesFromChip=function(O){for(var ue=O.target;ue&&ue!==this._elementRef.nativeElement;){if(ue.classList.contains("mat-chip"))return!0;ue=ue.parentElement}return!1},U._hasFocusedChip=function(){return this.chips&&this.chips.some(function(O){return O._hasFocus})},U._syncChipsState=function(){var O=this;this.chips&&this.chips.forEach(function(ue){ue._chipListDisabled=O._disabled,ue._chipListMultiple=O.multiple,ue.chipListSelectable=O._selectable})},(0,I.Z)(ge,[{key:"selected",get:function(){var O,ue;return this.multiple?(null==(O=this._selectionModel)?void 0:O.selected)||[]:null==(ue=this._selectionModel)?void 0:ue.selected[0]}},{key:"role",get:function(){return this._explicitRole?this._explicitRole:this.empty?null:"listbox"},set:function(O){this._explicitRole=O}},{key:"multiple",get:function(){return this._multiple},set:function(O){this._multiple=(0,X.Ig)(O),this._syncChipsState()}},{key:"compareWith",get:function(){return this._compareWith},set:function(O){this._compareWith=O,this._selectionModel&&this._initializeSelection()}},{key:"value",get:function(){return this._value},set:function(O){this.writeValue(O),this._value=O}},{key:"id",get:function(){return this._chipInput?this._chipInput.id:this._uid}},{key:"required",get:function(){var O,ue,Te;return null!=(O=null!=(ue=this._required)?ue:null==(Te=this.ngControl)||null==(Te=Te.control)?void 0:Te.hasValidator(S.kI.required))&&O},set:function(O){this._required=(0,X.Ig)(O),this.stateChanges.next()}},{key:"placeholder",get:function(){return this._chipInput?this._chipInput.placeholder:this._placeholder},set:function(O){this._placeholder=O,this.stateChanges.next()}},{key:"focused",get:function(){return this._chipInput&&this._chipInput.focused||this._hasFocusedChip()}},{key:"empty",get:function(){return(!this._chipInput||this._chipInput.empty)&&(!this.chips||0===this.chips.length)}},{key:"shouldLabelFloat",get:function(){return!this.empty||this.focused}},{key:"disabled",get:function(){return this.ngControl?!!this.ngControl.disabled:this._disabled},set:function(O){this._disabled=(0,X.Ig)(O),this._syncChipsState()}},{key:"selectable",get:function(){return this._selectable},set:function(O){this._selectable=(0,X.Ig)(O),this._syncChipsState()}},{key:"tabIndex",set:function(O){this._userTabIndex=O,this._tabIndex=O}},{key:"chipSelectionChanges",get:function(){return k.T.apply(void 0,this.chips.map(function(O){return O.selectionChange}))}},{key:"chipFocusChanges",get:function(){return k.T.apply(void 0,this.chips.map(function(O){return O._onFocus}))}},{key:"chipBlurChanges",get:function(){return k.T.apply(void 0,this.chips.map(function(O){return O._onBlur}))}},{key:"chipRemoveChanges",get:function(){return k.T.apply(void 0,this.chips.map(function(O){return O.destroyed}))}}]),ge}(He);(he=yt).\u0275fac=function(ge){return new(ge||he)(D.\u0275\u0275directiveInject(D.ElementRef),D.\u0275\u0275directiveInject(D.ChangeDetectorRef),D.\u0275\u0275directiveInject(x.Is,8),D.\u0275\u0275directiveInject(S.F,8),D.\u0275\u0275directiveInject(S.sg,8),D.\u0275\u0275directiveInject(M.rD),D.\u0275\u0275directiveInject(S.a5,10))},he.\u0275cmp=D.\u0275\u0275defineComponent({type:he,selectors:[["mat-chip-list"]],contentQueries:function(ge,U,P){var O;1&ge&&D.\u0275\u0275contentQuery(P,je,5),2&ge&&D.\u0275\u0275queryRefresh(O=D.\u0275\u0275loadQuery())&&(U.chips=O)},hostAttrs:["ngSkipHydration","",1,"mat-chip-list"],hostVars:14,hostBindings:function(ge,U){1&ge&&D.\u0275\u0275listener("focus",function(){return U.focus()})("blur",function(){return U._blur()})("keydown",function(O){return U._keydown(O)}),2&ge&&(D.\u0275\u0275hostProperty("id",U._uid),D.\u0275\u0275attribute("tabindex",U.disabled?null:U._tabIndex)("aria-required",U.role?U.required:null)("aria-disabled",U.disabled.toString())("aria-invalid",U.errorState)("aria-multiselectable",U.multiple)("role",U.role)("aria-orientation",U.ariaOrientation),D.\u0275\u0275classProp("mat-chip-list-disabled",U.disabled)("mat-chip-list-invalid",U.errorState)("mat-chip-list-required",U.required))},inputs:{role:"role",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],errorStateMatcher:"errorStateMatcher",multiple:"multiple",compareWith:"compareWith",value:"value",required:"required",placeholder:"placeholder",disabled:"disabled",ariaOrientation:["aria-orientation","ariaOrientation"],selectable:"selectable",tabIndex:"tabIndex"},outputs:{change:"change",valueChange:"valueChange"},exportAs:["matChipList"],features:[D.\u0275\u0275ProvidersFeature([{provide:Q.Eo,useExisting:he}]),D.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:2,vars:0,consts:[[1,"mat-chip-list-wrapper"]],template:function(ge,U){1&ge&&(D.\u0275\u0275projectionDef(),D.\u0275\u0275elementStart(0,"div",0),D.\u0275\u0275projection(1),D.\u0275\u0275elementEnd())},styles:['.mat-chip{position:relative;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);border:none;-webkit-appearance:none;-moz-appearance:none}.mat-chip::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}.mat-standard-chip._mat-animation-noopable{transition:none !important;animation:none !important}.mat-standard-chip .mat-chip-remove{border:none;-webkit-appearance:none;-moz-appearance:none;padding:0;background:none}.mat-standard-chip .mat-chip-remove.mat-icon,.mat-standard-chip .mat-chip-remove .mat-icon{width:18px;height:18px;font-size:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:"";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip.mat-chip-selected{outline-width:3px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit;overflow:hidden;transform:translateZ(0)}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}'],encapsulation:2,changeDetection:0});var It=0,Ke=function(){function Ce(U,P){this._elementRef=U,this.focused=!1,this._addOnBlur=!1,this.chipEnd=new D.EventEmitter,this.placeholder="",this.id="mat-chip-list-input-"+It++,this._disabled=!1,this.inputElement=this._elementRef.nativeElement,this.separatorKeyCodes=P.separatorKeyCodes}var ge=Ce.prototype;return ge.ngOnChanges=function(){this._chipList.stateChanges.next()},ge.ngOnDestroy=function(){this.chipEnd.complete()},ge.ngAfterContentInit=function(){this._focusLastChipOnBackspace=this.empty},ge._keydown=function(P){if(P){if(P.keyCode===R.Mf&&!(0,R.Vb)(P,"shiftKey")&&this._chipList._allowFocusEscape(),P.keyCode===R.ZH&&this._focusLastChipOnBackspace)return this._chipList._keyManager.setLastItemActive(),void P.preventDefault();this._focusLastChipOnBackspace=!1}this._emitChipEnd(P)},ge._keyup=function(P){!this._focusLastChipOnBackspace&&P.keyCode===R.ZH&&this.empty&&(this._focusLastChipOnBackspace=!0,P.preventDefault())},ge._blur=function(){this.addOnBlur&&this._emitChipEnd(),this.focused=!1,this._chipList.focused||this._chipList._blur(),this._chipList.stateChanges.next()},ge._focus=function(){this.focused=!0,this._focusLastChipOnBackspace=this.empty,this._chipList.stateChanges.next()},ge._emitChipEnd=function(P){!this.inputElement.value&&P&&this._chipList._keydown(P),(!P||this._isSeparatorKey(P))&&(this.chipEnd.emit({input:this.inputElement,value:this.inputElement.value,chipInput:this}),P?.preventDefault())},ge._onInput=function(){this._chipList.stateChanges.next()},ge.focus=function(P){this.inputElement.focus(P)},ge.clear=function(){this.inputElement.value="",this._focusLastChipOnBackspace=!0},ge._isSeparatorKey=function(P){return!(0,R.Vb)(P)&&new Set(this.separatorKeyCodes).has(P.keyCode)},(0,I.Z)(Ce,[{key:"chipList",set:function(P){P&&(this._chipList=P,this._chipList.registerInput(this))}},{key:"addOnBlur",get:function(){return this._addOnBlur},set:function(P){this._addOnBlur=(0,X.Ig)(P)}},{key:"disabled",get:function(){return this._disabled||this._chipList&&this._chipList.disabled},set:function(P){this._disabled=(0,X.Ig)(P)}},{key:"empty",get:function(){return!this.inputElement.value}}]),Ce}();(_e=Ke).\u0275fac=function(ge){return new(ge||_e)(D.\u0275\u0275directiveInject(D.ElementRef),D.\u0275\u0275directiveInject(Le))},_e.\u0275dir=D.\u0275\u0275defineDirective({type:_e,selectors:[["input","matChipInputFor",""]],hostAttrs:[1,"mat-chip-input","mat-input-element"],hostVars:5,hostBindings:function(ge,U){1&ge&&D.\u0275\u0275listener("keydown",function(O){return U._keydown(O)})("keyup",function(O){return U._keyup(O)})("blur",function(){return U._blur()})("focus",function(){return U._focus()})("input",function(){return U._onInput()}),2&ge&&(D.\u0275\u0275hostProperty("id",U.id),D.\u0275\u0275attribute("disabled",U.disabled||null)("placeholder",U.placeholder||null)("aria-invalid",U._chipList&&U._chipList.ngControl?U._chipList.ngControl.invalid:null)("aria-required",U._chipList&&U._chipList.required||null))},inputs:{chipList:["matChipInputFor","chipList"],addOnBlur:["matChipInputAddOnBlur","addOnBlur"],separatorKeyCodes:["matChipInputSeparatorKeyCodes","separatorKeyCodes"],placeholder:"placeholder",id:"id",disabled:"disabled"},outputs:{chipEnd:"matChipInputTokenEnd"},exportAs:["matChipInput","matChipInputFor"],features:[D.\u0275\u0275NgOnChangesFeature]});var Pt=function(){};(Ae=Pt).\u0275fac=function(ge){return new(ge||Ae)},Ae.\u0275mod=D.\u0275\u0275defineNgModule({type:Ae}),Ae.\u0275inj=D.\u0275\u0275defineInjector({providers:[M.rD,{provide:Le,useValue:{separatorKeyCodes:[R.K5]}}],imports:[M.BQ]})}}]);