"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["matrix"],{87914:function(Fe,me,E){E.d(me,{yv:function(){return U},zf:function(){return V}});var V=9,U=250},44102:function(Fe,me,E){E.d(me,{AT:function(){return o},Xg:function(){return ce},fw:function(){return te}});var V=E(81337),I=E(66232),U=E(62458),oe=E(87914),j=E(93340),le="unselectable";function te(S,l){if(S)for(var u=0,F=S;u<F.length;u++)(0,F[u])(l)}var G=function(){function S(l,u){this._owner=l,this._direction=u,this._timerHandle=void 0,this.createView();var F=this;this._element.addEventListener("mousedown",function(W){F.onMouseDown(W)}),$(this._element).addClass(le),$(this._svg).addClass(le),$(this._polygon).addClass(le)}return Object.defineProperty(S.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),S.prototype.createView=function(){var l="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(l,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",S.ARROW_COLOR),this._svg=document.createElementNS(l,"svg");var u=this._svg.style;u.position="absolute",u.left="0px",u.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=re.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},S.prototype.onMouseDown=function(l){var u=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){l.cancelBubble=!0;var F=this;this._mouseUpWrapper=function(W){F.onMouseUp(W)},re.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){u.onMouseDown(l)},100),l.preventDefault&&l.preventDefault()},S.prototype.onMouseUp=function(l){clearTimeout(this._timerHandle),re.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},S.prototype.arrange=function(l,u,F){var W=Math.min(l,u);this._polygon.setAttributeNS(null,"transform","translate("+(l-W)/2+", "+(u-W)/2+") scale("+W/16+") rotate("+F+",8,8)"),this._svg.setAttributeNS(null,"width",l+"px"),this._svg.setAttributeNS(null,"height",u+"px"),(0,j.Py)(this._element,l),(0,j.Iw)(this._element,u)},S.MIN_WIDTH=26,S.ARROW_COLOR="#404040",S}(),re=function(){function S(l,u,F,W){this.isModern=F,this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(l,u);var x=this;this._element.addEventListener("mousedown",function(D){x.onBackgroundMouseDown(D)}),this._element.addEventListener("pointerdown",function(D){(0,I.n)(D)}),this._element.addEventListener("dblclick",function(D){(0,I.n)(D)}),this._middleBar.addEventListener("mousedown",function(D){x.onMiddleBarMouseDown(D)}),this._middleBar.addEventListener("pointerdown",function(D){(0,I.n)(D)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(le),this.onScrollBehavior=W}return S.prototype.scrollBy=function(l,u){this.scrollTo(this.viewMin+l,u)},S.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},S.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},S.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},S.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(S.prototype,"width",{get:function(){return this._width},set:function(u){this._width=u,this._element.style.width=u,this.invalidateArrange()},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"height",{get:function(){return this._height},set:function(u){this._height=u,this._element.style.height=u,this.invalidateArrange()},enumerable:!1,configurable:!0}),S.prototype.refresh=function(){U.fF.assertFail("PureVirtualMethod: Scrollbar.refresh()")},Object.defineProperty(S.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!1,configurable:!0}),S.prototype._scrollSmallIncrement=function(l){this.scrollBy(this.smallIncrement*l)},Object.defineProperty(S.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!1,configurable:!0}),S.prototype.show=function(l){this._visible=l,this.element.style.visibility=l?"visible":"hidden",this.invalidateArrange()},S.prototype._getMouseOffset=function(l){return void 0!==l.offsetX?{x:l.offsetX,y:l.offsetY}:void 0!==l.layerX?{x:l.layerX,y:l.layerY}:{x:l.screenX,y:l.screenY}},S.prototype._getOffsetXDelta=function(l){return(l.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},S.prototype._getOffsetYDelta=function(l){return(l.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},S.prototype._getOffsetXTouchDelta=function(l){return this._getMouseOffset(l).x-this._offsetTouchPrevPos.x},S.prototype._getOffsetYTouchDelta=function(l){return this._getMouseOffset(l).y-this._offsetTouchPrevPos.y},S.prototype.onTouchStart=function(l){1===l.touches.length&&this.onTouchMouseDown(l.touches[0])},S.prototype.onTouchMove=function(l){1===l.touches.length&&(l.preventDefault&&l.preventDefault(),this.onTouchMouseMove(l.touches[0]))},S.prototype.onTouchEnd=function(l){this.onTouchMouseUp(1===l.touches.length?l.touches[0]:l,!0)},S.prototype.onTouchMouseDown=function(l){!this._allowMouseDrag&&l.pointerType===MSPointerEvent.MSPOINTER_TYPE_MOUSE||(this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},S.prototype._getOffsetTouchDelta=function(l){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetTouchDelta()"),null},S.prototype.onTouchMouseMove=function(l){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(l));var u=this._getOffsetTouchDelta(l);0!==u&&(this.scrollBy(-u/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(l)),l.preventDefault&&l.preventDefault(),l.cancelBubble=!0}},S.prototype.onTouchMouseUp=function(l,u){if(this._touchStarted&&this._offsetTouchStartPos){var F=this._getMouseOffset(l);!u&&(Math.abs(this._offsetTouchStartPos.x-F.x)>3||Math.abs(this._offsetTouchStartPos.y-F.y)>3)&&(l.preventDefault&&l.preventDefault(),l.cancelBubble=!0)}this._touchStarted=!1},S.prototype.createView=function(l,u){this._element=document.createElement("div"),this._element.className=S.className,this._element.setAttribute("drag-resize-disabled","true"),this._element.style.zIndex="2",this.isModern&&(this._element.style.setProperty("--background","white"),this._element.style.borderRadius=Math.ceil(oe.zf/2)+"px",this._element.style.setProperty("--opacity",".5"),this._element.style.setProperty("--opacity-hover",".6")),0===u&&l.appendChild(this._element),this.isModern||(this._minButton=new G(this,-1),this._maxButton=new G(this,1)),this._middleBar=document.createElement("div"),this._middleBar.className=S.barClassName,this.isModern&&(this._middleBar.style.setProperty("--bar-color","#605E5C"),this._middleBar.style.setProperty("--bar-color-hover","#605E5C"),this._middleBar.style.borderRadius=Math.ceil(oe.zf/2)+"px",this._middleBar.style.border="1px solid white",this._middleBar.style.boxSizing="border-box"),this._element.appendChild(this._middleBar)},S.prototype.scrollTo=function(l,u){var F=Math.min(this.max-this.viewSize,Math.max(this.min,l));(F=Math.max(this.min,F))!==this.viewMin&&(this.viewMin=F,u||te(this._onscroll,null)),this.onScrollBehavior&&this.onScrollBehavior()},S.prototype._scrollByPage=function(l){U.fF.assertFail("PureVirtualMethod: Scrollbar._scrollByPage()")},S.prototype._getRunningSize=function(l){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getRunningSize()"),null},S.prototype._getOffsetDelta=function(l){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetDelta()"),null},S.prototype.scroll=function(l){var u=this._getOffsetDelta(l)/this._getRunningSize(!0)*(this.max-this.min);if(u<0){if(this._getScreenMousePos(l)>=this._screenMaxMousePos)return}else if(u>0&&this._getScreenMousePos(l)<=this._screenMinMousePos)return;this.scrollBy(u)},Object.defineProperty(S.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"actualHeight",{get:function(){return void 0===this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"actualButtonWidth",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"actualButtonHeight",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight)},enumerable:!1,configurable:!0}),S.prototype.arrange=function(){(!this._actualWidth||!this._actualHeight)&&(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=-1,this._actualButtonHeight=-1,this.isModern||(this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition()))},S.prototype._calculateButtonWidth=function(){return U.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonWidth()"),null},S.prototype._calculateButtonHeight=function(){return U.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonHeight()"),null},S.prototype._getMinButtonAngle=function(){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getMinButtonAngle()"),null},S.prototype._getMaxButtonAngle=function(){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getMaxButtonAngle()"),null},S.prototype._setMaxButtonPosition=function(){U.fF.assertFail("PureVirtualMethod: Scrollbar._setMaxButtonPosition()")},S.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},S.prototype.onHoldBackgroundMouseDown=function(l){var u=this;this._timerHandle=setTimeout(function(){u.onBackgroundMouseDown(l)},this._timerHandle?S.ScrollbarBackgroundMousedownHoldDelay:S.ScrollbarBackgroundFirstTimeMousedownHoldDelay)},S.prototype.onBackgroundMouseDown=function(l){var u=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(l.cancelBubble=!0,this._backgroundMouseUpWrapper=function(F){u.onBackgroundMouseUp(F)},S.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(l),this.refresh(),this.onHoldBackgroundMouseDown(l),l.preventDefault&&l.preventDefault()},S.prototype.onBackgroundMouseUp=function(l){clearTimeout(this._timerHandle),this._timerHandle=void 0,S.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},S.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},S.prototype.onMiddleBarMouseDown=function(l){l.cancelBubble=!0,this._screenPrevMousePos={x:l.screenX,y:l.screenY},this.isModern?(this._screenMinMousePos=this._getScreenMousePos(l)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualLeft(this.element)),this._screenMaxMousePos=this._getScreenMousePos(l)+(this._getScreenContextualRight(this.element)-this._getScreenContextualRight(this._middleBar))):(this._screenMinMousePos=this._getScreenMousePos(l)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(l)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar))),this._screenToOffsetScale=(0,j.df)(this.element)*this.getPinchZoomY();var u=this;this._middleBarMouseMoveWrapper=function(F){u.onMiddleBarMouseMove(F)},S.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(F){u.onMiddleBarMouseUp(F)},S.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),l.preventDefault&&l.preventDefault()},S.prototype.onMiddleBarMouseMove=function(l){this._screenPrevMousePos&&(this.scroll(l),this.refresh(),this._screenPrevMousePos={x:l.screenX,y:l.screenY})},S.prototype.onMiddleBarMouseUp=function(l){this._screenPrevMousePos=void 0,S.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,S.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,l.preventDefault&&l.preventDefault()},S.prototype._getScreenContextualLeft=function(l){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualLeft()"),null},S.prototype._getScreenContextualRight=function(l){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualRight()"),null},S.prototype.onMouseWheel=function(l){l&&this.mouseWheel(l)},S.prototype.mouseWheel=function(l){this.visible&&(l<0?l=Math.min(-S.MouseWheelRange,l):l>0&&(l=Math.max(S.MouseWheelRange,l)),this.scrollBy(-l/S.MouseWheelRange*this.smallIncrement))},S.prototype._getScreenMousePos=function(l){return U.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenMousePos()"),null},S.addDocumentMouseUpEvent=function(l){document.addEventListener("mouseup",l)},S.removeDocumentMouseUpEvent=function(l){document.removeEventListener("mouseup",l)},S.addDocumentMouseMoveEvent=function(l){document.addEventListener("mousemove",l)},S.removeDocumentMouseMoveEvent=function(l){document.removeEventListener("mousemove",l)},S.DefaultScrollbarWidth="15px",S.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,S.ScrollbarBackgroundMousedownHoldDelay=50,S.MouseWheelRange=120,S.className="scroll-bar-div",S.barClassName="scroll-bar-part-bar",S.arrowClassName="scroll-bar-part-arrow",S}(),ce=function(S){function l(u,F,W,x){var D=S.call(this,u,F,W,x)||this;return D.height=re.DefaultScrollbarWidth,D}return(0,V.__extends)(l,S),l.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,G.MIN_WIDTH))},l.prototype._calculateButtonHeight=function(){return this.actualHeight},l.prototype._getMinButtonAngle=function(){return-180},l.prototype._getMaxButtonAngle=function(){return 0},l.prototype._setMaxButtonPosition=function(){(0,j.hn)(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},l.prototype.refresh=function(){this.arrange();var u=this.actualWidth-2*this.actualButtonWidth-2,F=this.viewSize/(this.max-this.min)*u;F<this.MIN_BAR_SIZE&&(u-=this.MIN_BAR_SIZE-F,F=this.MIN_BAR_SIZE),u<0&&(u=0,F=0),F=Math.min(F,u);var W=this.viewMin/(this.max-this.min)*u;(0,j.Py)(this.middleBar,F),(0,j.Iw)(this.middleBar,this.actualHeight);var x=this.actualButtonWidth+1+W;this.isModern?this.middleBar.style.transform="translateX(".concat(x,"px)"):(0,j.hn)(this.middleBar,x)},l.prototype.show=function(u){u!==this.visible&&(S.prototype.show.call(this,u),u?this.element.style.height=this.height:(0,j.Iw)(this.element,0))},l.prototype._scrollByPage=function(u){var F;if(this.isModern){var W=window.getComputedStyle(this.middleBar);F=new WebKitCSSMatrix(W.transform).m41}else F=this.middleBar.offsetLeft;var X=void 0===u.offsetX?u.layerX:u.offsetX;X>F+this.middleBar.offsetWidth?this.scrollPageDown():X<F&&this.scrollPageUp()},l.prototype._getRunningSize=function(u){var F=this.actualWidth;if(u){var x=(F-=2*(this.actualButtonWidth+1))*(this.viewSize/(this.max-this.min));x<this.MIN_BAR_SIZE&&(F-=this.MIN_BAR_SIZE-x)}return F},l.prototype._getOffsetDelta=function(u){return this._getOffsetXDelta(u)},l.prototype._getOffsetTouchDelta=function(u){return this._getOffsetXTouchDelta(u)},l.prototype._getScreenContextualLeft=function(u){return u.getBoundingClientRect().left},l.prototype._getScreenContextualRight=function(u){return u.getBoundingClientRect().right},l.prototype._getScreenMousePos=function(u){return u.screenX},l}(re),o=function(S){function l(u,F,W,x){var D=S.call(this,u,F,W,x)||this;return D.width=re.DefaultScrollbarWidth,D}return(0,V.__extends)(l,S),l.prototype._calculateButtonWidth=function(){return this.actualWidth},l.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,G.MIN_WIDTH))},l.prototype._getMinButtonAngle=function(){return-90},l.prototype._getMaxButtonAngle=function(){return 90},l.prototype._setMaxButtonPosition=function(){(0,j.FX)(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},l.prototype.refresh=function(){this.arrange();var u=this.actualHeight-2*this.actualButtonHeight-2,F=this.viewSize/(this.max-this.min)*u;F<this.MIN_BAR_SIZE&&(u-=this.MIN_BAR_SIZE-F,F=this.MIN_BAR_SIZE),u<0&&(u=0,F=0);var W=this.viewMin/(this.max-this.min)*u;(0,j.Py)(this.middleBar,this.actualWidth),(0,j.Iw)(this.middleBar,F);var x=this.actualButtonHeight+1+W;this.isModern?this.middleBar.style.transform="translateY(".concat(x,"px)"):(0,j.FX)(this.middleBar,x)},l.prototype.show=function(u){u!==this.visible&&(S.prototype.show.call(this,u),u?this.element.style.width=this.width:(0,j.Py)(this.element,0))},l.prototype._scrollByPage=function(u){var F;if(this.isModern){var W=window.getComputedStyle(this.middleBar);F=new WebKitCSSMatrix(W.transform).m42}else F=this.middleBar.offsetTop;var X=void 0===u.offsetY?u.layerY:u.offsetY;X>F+this.middleBar.offsetHeight?this.scrollPageDown():X<F&&this.scrollPageUp()},l.prototype._getRunningSize=function(u){var F=this.actualHeight;if(u){var x=(F-=2*(this.actualButtonHeight+1))*(this.viewSize/(this.max-this.min));x<this.MIN_BAR_SIZE&&(F-=this.MIN_BAR_SIZE-x)}return F},l.prototype._getOffsetDelta=function(u){return this._getOffsetYDelta(u)},l.prototype._getOffsetTouchDelta=function(u){return this._getOffsetYTouchDelta(u)},l.prototype._getScreenContextualLeft=function(u){return u.getBoundingClientRect().top},l.prototype._getScreenContextualRight=function(u){return u.getBoundingClientRect().bottom},l.prototype._getScreenMousePos=function(u){return u.screenY},l}(re)},73889:function(Fe,me,E){E.d(me,{Y:function(){return V}});var V=function(I){return I[I.Matrix=0]="Matrix",I[I.Table=1]="Table",I[I.PivotTable=2]="PivotTable",I[I.TableEx=3]="TableEx",I}({})},71090:function(Fe,me,E){E.d(me,{Ds:function(){return u},Ed:function(){return i},Eo:function(){return h},F2:function(){return e},Hw:function(){return S},JM:function(){return P},LU:function(){return d},Mh:function(){return te},NA:function(){return y},OM:function(){return de},P$:function(){return b},Pr:function(){return x},QM:function(){return J},R9:function(){return q},Sl:function(){return ce},TV:function(){return re},Vz:function(){return n},WA:function(){return D},YR:function(){return a},Yo:function(){return O},Zk:function(){return t},b:function(){return G},bn:function(){return oe},dG:function(){return r},dm:function(){return l},en:function(){return W},f:function(){return X},fG:function(){return C},iC:function(){return o},jv:function(){return ae},lN:function(){return m},mQ:function(){return K},qT:function(){return U},rJ:function(){return f},rx:function(){return g},rz:function(){return F},s$:function(){return z},s0:function(){return k},sR:function(){return I},uX:function(){return le},uZ:function(){return w},wH:function(){return B},wd:function(){return p},yF:function(){return j},ye:function(){return s},z7:function(){return Q},zq:function(){return L}});var V=E(38265),I=.8,U="TableTotalLabel",oe="Format_AddTotalLabel",j="Visual_LabelText_Value",le="Row_Selection",te="SelectRow",G="Row_Selected",re="Row_Unselected",ce="Additional_Conditional_Formatting",o="DecompositionTree_ScrollLevelUp_Tooltip",S="DecompositionTree_ScrollLevelDown_Tooltip",l="Scroll_Left",u="Scroll_Right",F="tablixDiv",W="tablixCellContentElement",x="tablixCellContentHost",D="tablixWrappingContainer",X="tablixHeader",K="tablixColumnHeaderLeaf",k="tablixValueNumeric",q="tablixValueTotal",y="powervisuals-glyph tablixUrlIconGlyph",d="tablixValueUrlIcon",i="tablixImageContainer",h="matrixRowHeaderLeaf",z="tableFooterCell",P="tableBodyCell",L="tableBodyCellBottom",Q="tablixAlignLeft",J="tablixAlignCenter",de="tablixAlignRight",ae="&nbsp;",B="px",g="tablixSortIconContainer",a=10,f=5,b=5,C=5,p=1,r=V.Wn.regular.css,e=V.Wn.regular.css,t=V.Wn.bold.css,n=V.Wn.glyphs.css,s="#333",m="#666",w=Number.POSITIVE_INFINITY,O=.71},16324:function(Fe,me,E){E.d(me,{Vz:function(){return g},dk:function(){return B}});var V=E(81337),I=E(62458),U=E(41640),oe=E(32041),j=E(64329),le=E(81671),te=E(93414),G=E(93340),re=function(){function r(e,t,n){this._scrollable=!1,this._presenter=e,this.extension=t,this._presenter.initialize(this),this._row=n,this.item=null,this.type=null,this._horizontalOffset=0,this._verticalOffset=0,this._colSpan=1,this._rowSpan=1,this._containerWidth=-1,this._containerHeight=-1,this.contentHeight=this.contentWidth=0,this.position=new G.ri}return r.prototype.unfixRowHeight=function(){this._row.unfixSize()},Object.defineProperty(r.prototype,"colSpan",{get:function(){return this._colSpan},set:function(t){this._colSpan!==t&&(this._presenter.onColumnSpanChanged(t),this._colSpan=t,this._presenter.onContainerWidthChanged(-1))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rowSpan",{get:function(){return this._rowSpan},set:function(t){this._rowSpan!==t&&(this._presenter.onRowSpanChanged(t),this._rowSpan=t,this._row.unfixSize())},enumerable:!1,configurable:!0}),r.prototype.getCellSpanningHeight=function(){return this._row.getCellSpanningHeight(this)},Object.defineProperty(r.prototype,"textAlign",{get:function(){return this._textAlign},set:function(t){t!==this._textAlign&&(this._presenter.onTextAlignChanged(t),this._textAlign=t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"horizontalOffset",{get:function(){return this._horizontalOffset},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"verticalOffset",{get:function(){return this._verticalOffset},enumerable:!1,configurable:!0}),r.prototype.isScrollable=function(){return this._scrollable},r.prototype.clear=function(){this.isScrollable()&&this.initializeScrolling(),this._presenter.onClear(),this.setContainerWidth(-1),this.setContainerHeight(-1),this.contentHeight=this.contentWidth=0},r.prototype.initializeScrolling=function(){this._presenter.onInitializeScrolling(),this._horizontalOffset=0,0!==this._verticalOffset&&(this._verticalOffset=0),1===this.colSpan&&this.setContainerWidth(-1),1===this.rowSpan&&this.setContainerHeight(-1)},r.prototype.prepare=function(e){this.isScrollable()&&this.initializeScrolling(),this._scrollable=e},r.prototype.scrollVertically=function(e,t){var n=Math.ceil(-e*t);this._verticalOffset=n,this.isScrollable()?(this._presenter.onVerticalScroll(e,n),this.setContainerHeight(e+n)):this.setContainerHeight(this._row.getCellSpanningHeight(this)+n)},r.prototype.scrollHorizontally=function(e,t){this.isScrollable()&&(this._presenter.onHorizontalScroll(e,t),this.setContainerWidth(e+t))},r.prototype.setContainerWidth=function(e){e!==this._containerWidth&&(this._containerWidth=e,this._presenter.onContainerWidthChanged(e))},Object.defineProperty(r.prototype,"containerWidth",{get:function(){return this._containerWidth},enumerable:!1,configurable:!0}),r.prototype.setContainerHeight=function(e){if(e<0&&(e=-1),e!==this._containerHeight){this._containerHeight=e;var t=this._row.owner.owner,n=t.getBinder();t.wordWrapRowHeaders&&null!=n.applyWordWrapping&&-1!==e&&1===this.type&&!this.position.column.isLast&&n.applyWordWrapping(this.item,this),this._presenter.onContinerHeightChanged(e)}},Object.defineProperty(r.prototype,"containerHeight",{get:function(){return this._containerHeight},enumerable:!1,configurable:!0}),r.prototype.applyStyle=function(e){e&&(e.applyStyle(this),this.contentHeight+=e.getExtraBottom()+e.getExtraTop(),this.contentWidth+=e.getExtraLeft()+e.getExtraRight())},r.prototype.enableHorizontalResize=function(e,t){this._presenter.enableHorizontalResize(e,t)},r.prototype.isColumnResizing=function(){return this._column&&this._column.isResizing()},r}(),ce=function(){function r(e,t){this._presenter=e,this._presenter.initialize(this),this._containerWidth=-1,this._width=-1,this._sizeFixed=!1,this._aligningWidth=-1,this._fixedToAligningWidth=!1,this._items=[],this._itemType=null,this._footerCell=null,this.isColumnResizing=!1}return r.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedColumnHeaders=[],this._realizedCornerCells=[],this._realizedBodyCells=[]},Object.defineProperty(r.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),r.prototype.getType=function(){return this._realizedCornerCells.length>0?0:2},r.prototype.getColumnHeadersOrCorners=function(){return this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders},r.prototype.columnHeadersOrCornersEqual=function(e,t,n){if(this._items.length!==t.length)return!1;for(var s=this._items.length,m=0;m<s;m++)if(!this.columnHeaderOrCornerEquals(this._itemType,this._items[m],e,t[m].item,n))return!1;return!0},Object.defineProperty(r.prototype,"itemType",{get:function(){return this._itemType},enumerable:!1,configurable:!0}),r.prototype.getLeafItem=function(){return 0===this._items.length?null:this._items[this._items.length-1]},r.prototype.columnHeaderOrCornerEquals=function(e,t,n,s,m){if(e!==n)return!1;if(0===e){if(!m.cornerCellItemEquals(t,s))return!1}else if(!m.headerItemEquals(t,s))return!1;return!0},r.prototype.OnLeafRealized=function(e){var t=this.getType(),n=this.getColumnHeadersOrCorners();if(this.columnHeadersOrCornersEqual(t,n,e))this.clearSpanningCellsWidth(this._realizedColumnHeaders);else{var s=n.length;this._items=[];for(var m=0;m<s;m++)this._items.push(n[m].item);this._itemType=t,this.clearSize()}},r.prototype.clearSpanningCellsWidth=function(e){for(var t=0,n=e;t<n.length;t++){var s=n[t];s.colSpan>1&&s.setContainerWidth(-1)}},r.prototype.addCornerCell=function(e){e._column=this,this._realizedCornerCells.push(e),e.setContainerWidth(this._containerWidth)},r.prototype.addRowHeader=function(e){e._column=this,this._realizedRowHeaders.push(e),e.setContainerWidth(this._containerWidth)},r.prototype.addColumnHeader=function(e,t){e._column=this,this._realizedColumnHeaders.push(e),t&&e.setContainerWidth(this._containerWidth)},r.prototype.addBodyCell=function(e){e._column=this,this._realizedBodyCells.push(e),e.setContainerWidth(this._containerWidth)},Object.defineProperty(r.prototype,"footer",{get:function(){return this._footerCell},set:function(t){this._footerCell=t,t._column=this,t.setContainerWidth(this._containerWidth)},enumerable:!1,configurable:!0}),r.prototype.isResizing=function(){return this.isColumnResizing},r.prototype.onResize=function(e){this.isColumnResizing=!0,e!==this.getContentContextualWidth()&&(this._containerWidth=e,this.setContainerWidth(this._containerWidth),this._sizeFixed=!0,this._fixedToAligningWidth=!1,this._aligningWidth=-1)},r.prototype.onResizeEnd=function(e){this.isColumnResizing=!1;var t=this.owner._presenter;t&&t.invokeColumnResizeEndCallback(this,e)},r.prototype.fixSize=function(){var e=-1!==this._aligningWidth;this._sizeFixed&&e===this._fixedToAligningWidth&&!e||(this.setContainerWidth(-1===this._aligningWidth?this._containerWidth:this._aligningWidth),this._sizeFixed=!0,this._fixedToAligningWidth=-1!==this._aligningWidth)},r.prototype.clearSize=function(){this._containerWidth=-1,this.setContainerWidth(this._containerWidth),this._sizeFixed=!1},r.prototype.getContentContextualWidth=function(){return this._containerWidth},r.prototype.getCellIContentContextualWidth=function(e){return this._presenter.getCellWidth(e)},r.prototype.getContextualWidth=function(){return(-1===this._width||-1===this._containerWidth)&&(this._width=this._presenter.getWidth()),this._width},r.prototype.calculateSize=function(){if(this._sizeFixed)return this._containerWidth;var e=0,t=this._presenter.getPersistedWidth();if(null!=t){e=t;for(var n=0,s=this._realizedColumnHeaders.length;n<s-1;n++)1===(m=this._realizedColumnHeaders[n]).colSpan&&(e=Math.max(e,this._presenter.getCellWidth(m)));return this._containerWidth=e}for(var w=0,O=this._realizedColumnHeaders;w<O.length;w++)1===(m=O[w]).colSpan&&(e=Math.max(e,this._presenter.getCellWidth(m)));for(var H=0,v=this._realizedRowHeaders;H<v.length;H++)1===(m=v[H]).colSpan&&(e=Math.max(e,this._presenter.getCellWidth(m)));for(var M=0,Y=this._realizedCornerCells;M<Y.length;M++){var m=Y[M];e=Math.max(e,this._presenter.getCellWidth(m))}for(var ie=0,ue=this._realizedBodyCells;ie<ue.length;ie++)m=ue[ie],e=Math.max(e,this._presenter.getCellWidth(m));return null!==this._footerCell&&1===this._footerCell.colSpan&&(e=Math.max(e,this._presenter.getCellWidth(this._footerCell))),this._containerWidth=e},r.prototype.setAligningContextualWidth=function(e){this._aligningWidth=e},r.prototype.getAligningContextualWidth=function(){return this._aligningWidth},r.prototype.setContainerWidth=function(e){for(var t=0,n=this._realizedColumnHeaders;t<n.length;t++)1===(s=n[t]).colSpan&&s.setContainerWidth(e);for(var m=0,w=this._realizedRowHeaders;m<w.length;m++)1===(s=w[m]).colSpan&&s.setContainerWidth(e);for(var O=0,H=this._realizedCornerCells;O<H.length;O++)(s=H[O]).setContainerWidth(e);for(var v=0,M=this._realizedBodyCells;v<M.length;v++){var s;(s=M[v]).setContainerWidth(e)}null!==this._footerCell&&1===this._footerCell.colSpan&&this._footerCell.setContainerWidth(e),this._width=e},r.prototype.getTablixCell=function(){var e=this._realizedColumnHeaders.length>0?this._realizedColumnHeaders:this._realizedCornerCells;return e[e.length-1]},r.prototype.getIndex=function(e){return e.realizedColumns.indexOf(this)},r.prototype.getHeaders=function(){return this._realizedColumnHeaders},r.prototype.getOtherDimensionHeaders=function(){return this._realizedRowHeaders},r.prototype.getCellContextualSpan=function(e){return e.colSpan},r.prototype.getOtherDimensionOwner=function(e){return e._row},r}(),o=function(){function r(e){this._containerHeight=-1,this._presenter=e,this._presenter.initialize(this),this._allocatedCells=[],this._heightFixed=!1,this._containerHeight=-1,this._height=-1}return r.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedBodyCells=[],this._realizedCornerCells=[],this._realizedColumnHeaders=[],this._realizedCellsCount=0},Object.defineProperty(r.prototype,"presenter",{get:function(){return this._presenter},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),r.prototype.releaseUnusedCells=function(e){this.releaseCells(e,this._realizedCellsCount)},r.prototype.releaseAllCells=function(e){this.releaseCells(e,0)},r.prototype.releaseCells=function(e,t){for(var n=this._allocatedCells,s=n.length,m=t;m<s;m++){var w=n[m];e._unbindCell(w),w.clear()}},r.prototype.moveScrollableCellsToEnd=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),n=t;n<t+e;n++){var s=this._allocatedCells[n];this._presenter.onRemoveCell(s),this._presenter.onAppendCell(s),this._allocatedCells.push(s)}this._allocatedCells.splice(t,e)},r.prototype.moveScrollableCellsToStart=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),n=t;n<t+e;n++){var s=this._allocatedCells.pop();this._presenter.onRemoveCell(s),this._presenter.onInsertCellBefore(s,this._allocatedCells[t]),this._allocatedCells.splice(t,0,s)}},r.prototype.getOrCreateCornerCell=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.addCornerCell(t),this._realizedCornerCells.push(t),t.setContainerHeight(this._containerHeight),t},r.prototype.getOrCreateRowHeader=function(e,t,n){var s=this.getOrCreateCell();return s.prepare(t),e.addRowHeader(s),this._realizedRowHeaders.push(s),n&&s.setContainerHeight(this._containerHeight),s},r.prototype.getOrCreateColumnHeader=function(e,t,n){var s=this.getOrCreateCell();return s.prepare(t),e.addColumnHeader(s,n),this._realizedColumnHeaders.push(s),s.setContainerHeight(this._containerHeight),s},r.prototype.getOrCreateBodyCell=function(e,t){var n=this.getOrCreateCell();return n.prepare(t),e.addBodyCell(n),this._realizedBodyCells.push(n),n.setContainerHeight(this._containerHeight),n},r.prototype.getOrCreateFooterRowHeader=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.footer=t,this._realizedRowHeaders.push(t),t.setContainerHeight(this._containerHeight),t},r.prototype.getOrCreateFooterBodyCell=function(e,t){var n=this.getOrCreateCell();return n.prepare(t),e.footer=n,this._realizedBodyCells.push(n),n.setContainerHeight(this._containerHeight),n},r.prototype.getRowHeaderLeafIndex=function(){for(var e=-1,t=this._allocatedCells.length,n=0;n<t&&1===this._allocatedCells[n].type;n++)e++;return e},r.prototype.getAllocatedCellAt=function(e){return this._allocatedCells[e]},r.prototype.moveCellsBy=function(e){if(0!==this._allocatedCells.length)if(e>0)for(var t=this._allocatedCells[0],n=0;n<e;n++){var s=this.createCell(this);this._presenter.onInsertCellBefore(s,t),this._allocatedCells.unshift(s),t=s}else{for(e=-e,n=0;n<e;n++)this._presenter.onRemoveCell(this._allocatedCells[n]);this._allocatedCells.splice(0,e)}},r.prototype.getRealizedCellCount=function(){return this._realizedCellsCount},r.prototype.getRealizedHeadersCount=function(){return this._realizedRowHeaders.length},r.prototype.getRealizedHeaderAt=function(e){return this._realizedRowHeaders[e]},r.prototype.getTablixCell=function(){var e;return(e=this._realizedRowHeaders.length>0?this._realizedRowHeaders:this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders)[e.length-1]},r.prototype.getOrCreateEmptySpaceCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e&&(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)),e},r.prototype.createCell=function(e){var t=this._presenter.createCellPresenter(this._owner.owner.layoutManager.getLayoutKind());return new re(t,t,this)},r.prototype.getOrCreateCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e?(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)):(e.colSpan=1,e.rowSpan=1),this._realizedCellsCount=this._realizedCellsCount+1,e},r.prototype.isResizing=function(){return!1},r.prototype.onResize=function(e){e!==this.getContentContextualWidth()&&(this._containerHeight=e,this.setContentHeight(),this._heightFixed=!0,this.setAligningContextualWidth(-1))},r.prototype.onResizeEnd=function(e){},r.prototype.fixSize=function(){this.setContentHeight(),this._heightFixed=!0},r.prototype.unfixSize=function(){this._heightFixed=!1,this._height=-1},r.prototype.getContentContextualWidth=function(){return this._containerHeight},r.prototype.getCellIContentContextualWidth=function(e){return this.presenter.getCellContentHeight(e)},r.prototype.getCellSpanningHeight=function(e){var t=this.getContextualWidth();if(e.rowSpan>1)for(var n=this.getIndex(this.owner),s=this.owner.realizedRows,m=1;m<e.rowSpan;m++)t+=s[m+n].getContextualWidth();return t},r.prototype.getContextualWidth=function(){return(-1===this._height||-1===this._containerHeight)&&(this._height=this._presenter.getHeight()),this._height},r.prototype.sizeFixed=function(){return this._heightFixed},r.prototype.calculateSize=function(){if(this._heightFixed)return this._containerHeight;for(var e=0,t=this._realizedRowHeaders.length,n=0;n<t;n++)1===(s=this._realizedRowHeaders[n]).rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(s)));for(t=this._realizedCornerCells.length,n=0;n<t;n++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedCornerCells[n]));for(t=this._realizedColumnHeaders.length,n=0;n<t;n++){var s;1===(s=this._realizedColumnHeaders[n]).rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(s)))}for(t=this._realizedBodyCells.length,n=0;n<t;n++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedBodyCells[n]));return this._containerHeight=e},r.prototype.setAligningContextualWidth=function(e){},r.prototype.getAligningContextualWidth=function(){return-1},r.prototype.setContentHeight=function(){for(var e=this._realizedRowHeaders.length,t=e-1;t>=0;t--)-1!==(n=this._realizedRowHeaders[t]).containerHeight&&n._row.sizeFixed()||(n.setContainerHeight(this._containerHeight),n.rowSpan>1&&n.setContainerHeight(this.getCellSpanningHeight(n)));for(var s=0,m=this._realizedCornerCells;s<m.length;s++)-1!==(n=m[s]).containerHeight&&n._row.sizeFixed()||n.setContainerHeight(this._containerHeight);for(var w=0,O=this._realizedColumnHeaders;w<O.length;w++)-1!==(n=O[w]).containerHeight&&n._row.sizeFixed()||(n.setContainerHeight(this._containerHeight),n.rowSpan>1&&n.setContainerHeight(this.getCellSpanningHeight(n)));e=this._realizedBodyCells.length;for(var H=0,v=this._realizedBodyCells;H<v.length;H++){var n;-1!==(n=v[H]).containerHeight&&n._row.sizeFixed()||n.setContainerHeight(this._containerHeight)}this._height=-1},r.prototype.getIndex=function(e){return e.realizedRows.indexOf(this)},r.prototype.getHeaders=function(){return this._realizedRowHeaders},r.prototype.getOtherDimensionHeaders=function(){return this._realizedColumnHeaders},r.prototype.getCellContextualSpan=function(e){return e.rowSpan},r.prototype.getOtherDimensionOwner=function(e){return e._column},r}(),S=function(){function r(e){this._presenter=e,this._footerRow=null}return r.prototype.initialize=function(e,t,n){this._owner=e,this._presenter.initialize(this,t,n,e),this.fillColumnsProportionally=!1,this._realizedRows=[],this._realizedColumns=[],this._emptySpaceHeaderCell=null,this._emptyFooterSpaceCell=null},Object.defineProperty(r.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillColumnsProportionally",{get:function(){return this._fillColumnsProportionally},set:function(t){this._fillColumnsProportionally!==t&&(this._fillColumnsProportionally=t,this._presenter.onFillColumnsProportionallyChanged(t))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"realizedColumns",{get:function(){return this._realizedColumns},set:function(t){this._realizedColumns=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"realizedRows",{get:function(){return this._realizedRows},set:function(t){this._realizedRows=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"footerRow",{get:function(){return this._footerRow},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"emptySpaceHeaderCell",{get:function(){return this._emptySpaceHeaderCell},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"emptySpaceFooterCell",{get:function(){return this._emptyFooterSpaceCell},enumerable:!1,configurable:!0}),r.prototype.ShowEmptySpaceCells=function(e,t){0!==this._realizedRows.length&&(0!==this._realizedRows.length&&!this._emptySpaceHeaderCell&&(this._emptySpaceHeaderCell=this._realizedRows[0].getOrCreateEmptySpaceCell(),this._emptySpaceHeaderCell.rowSpan=e,this._emptySpaceHeaderCell.colSpan=1,this._emptySpaceHeaderCell.setContainerWidth(t)),this._footerRow&&null===this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell=this._footerRow.getOrCreateEmptySpaceCell(),this._emptyFooterSpaceCell.rowSpan=1,this._emptyFooterSpaceCell.colSpan=1,this._emptyFooterSpaceCell.setContainerWidth(t)))},r.prototype.HideEmptySpaceCells=function(){this._emptySpaceHeaderCell&&(this._emptySpaceHeaderCell.clear(),this._emptySpaceHeaderCell=null),this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell.clear(),this._emptyFooterSpaceCell=null)},r.prototype.onStartRenderingSession=function(e){e&&(this.clearRows(),this.clearColumns())},r.prototype.onStartRenderingIteration=function(){this.initializeRows(),this.initializeColumns()},r.prototype.onEndRenderingIteration=function(){var e=this._rows;if(void 0!==e)for(var t=e.length,n=0;n<t;n++)e[n].releaseUnusedCells(this._owner);this._footerRow&&this._footerRow.releaseUnusedCells(this._owner)},r.prototype.getOrCreateRow=function(e){var t=this._rows[e];return void 0===t&&((t=new o(this._presenter.createRowPresenter())).initialize(this),this._presenter.onAppendRow(t),this._rows[e]=t),void 0===this._realizedRows[e]&&(this._realizedRows[e]=t),t},r.prototype.getOrCreateFootersRow=function(){return null===this._footerRow&&(this._footerRow=new o(this._presenter.createRowPresenter()),this._footerRow.initialize(this),this._presenter.onAddFooterRow(this._footerRow)),this._footerRow},r.prototype.moveRowsToEnd=function(e,t){for(var n=0;n<t;n++){var s=this._rows[n+e];I.fF.assertValue(s,"Invalid Row Index"),s.unfixSize(),this._presenter.onRemoveRow(s),this._presenter.onAppendRow(s),this._rows.push(s)}this._rows.splice(e,t)},r.prototype.moveRowsToStart=function(e,t){var n=this._rows[e];I.fF.assertValue(n,"Invalid Row Index");for(var s=0;s<t;s++){var m=this._rows.pop();m.unfixSize(),this._presenter.onRemoveRow(m),this._presenter.onInsertRowBefore(m,n),this._rows.splice(e+s,0,m)}},r.prototype.moveColumnsToEnd=function(e,t){for(var m=Math.max(this._columns[this._rows[0]._realizedCornerCells.length]._realizedColumnHeaders.length-1,0);m<this._rows.length;m++)this._rows[m].moveScrollableCellsToEnd(t);for(m=0;m<t;m++)this._columns.push(this._columns[m+e]);this._columns.splice(e,t)},r.prototype.moveColumnsToStart=function(e,t){for(var m=Math.max(this._columns[this._rows[0]._realizedCornerCells.length]._realizedColumnHeaders.length-1,0);m<this._rows.length;m++)this._rows[m].moveScrollableCellsToStart(t);for(m=0;m<t;m++){var w=this._columns.pop();this._columns.splice(e+m,0,w)}},r.prototype.getOrCreateColumn=function(e){var t=this._columns[e];return void 0===t&&((t=new ce(this._presenter.createColumnPresenter(e),e)).initialize(this),this._columns[e]=t),void 0===this._realizedColumns[e]&&(this._realizedColumns[e]=t),t},r.prototype.initializeColumns=function(){this._columns||(this._columns=[]);for(var e=this._columns.length,t=0;t<e;t++)this._columns[t].initialize(this);this._realizedColumns=[]},r.prototype.clearColumns=function(){this._columns=null,this._realizedColumns=null},r.prototype.initializeRows=function(){var e=this._owner.rowDimension.hasFooter()&&null!==this._footerRow;this._realizedRows=[],this._rows||(this._rows=[]);for(var t=this._rows,n=t.length,s=0;s<n;s++)t[s].initialize(this);e&&(this._footerRow||this.getOrCreateFootersRow(),this._footerRow.initialize(this))},r.prototype.clearRows=function(){var e=this._rows;if(e){for(var t=e.length,n=0;n<t;n++)e[n].releaseAllCells(this._owner);this._footerRow&&this._footerRow.releaseAllCells(this._owner),this._presenter.onClear(),this._footerRow=null,this._rows=null,this._realizedRows=null}},r.prototype.getWidth=function(){return this._presenter.getWidth()},r.prototype.getHeight=function(){return this._presenter.getHeight()},r}(),l=E(42737),u="unselectable",F=function(r){function e(t,n,s){var m=r.call(this,n,s)||this;return m._cell=t,m}return(0,V.__extends)(e,r),Object.defineProperty(e.prototype,"cell",{get:function(){return this._cell},enumerable:!1,configurable:!0}),e.prototype._hotSpot=function(t){return t.x>=this.element.getBoundingClientRect().right-l.A.resizeHandleSize},e}(l.A),W=function(){function r(e,t){this._tableCell=null,this._contentElement=(0,G.wC)(),this._contentHost=(0,G.wC)(),this.layoutKind=t,this._contentElement.appendChild(this._contentHost),this._resizer=null}return r.prototype.initialize=function(e){this._owner=e},Object.defineProperty(r.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),r.prototype.registerTableCell=function(e){this._tableCell=e,e.appendChild(this._contentElement)},Object.defineProperty(r.prototype,"tableCell",{get:function(){return this._tableCell},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"contentElement",{get:function(){return this._contentElement},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"contentHost",{get:function(){return this._contentHost},enumerable:!1,configurable:!0}),r.prototype.registerClickHandler=function(e){this._contentElement.onclick=e},r.prototype.unregisterClickHandler=function(){this._contentElement.onclick=null},r.prototype.onContainerWidthChanged=function(e){(0,G.Py)(this._contentElement,e)},r.prototype.onContinerHeightChanged=function(e){(0,G.Iw)(this._contentElement,e)},r.prototype.onColumnSpanChanged=function(e){this._tableCell.colSpan=e},r.prototype.onRowSpanChanged=function(e){this._tableCell.rowSpan=e},r.prototype.onTextAlignChanged=function(e){this._tableCell.style.textAlign=e},r.prototype.onClear=function(){this._contentHost.className="",this._tableCell.className=""},r.prototype.onHorizontalScroll=function(e,t){(0,G.hn)(this._contentHost,t),(0,G.Py)(this._contentHost,e)},r.prototype.onVerticalScroll=function(e,t){(0,G.FX)(this._contentHost,t),(0,G.Iw)(this._contentHost,e)},r.prototype.onInitializeScrolling=function(){(0,G.hn)(this._contentHost,0),(0,G.FX)(this._contentHost,0),(0,G.Py)(this._contentHost,-1),(0,G.Iw)(this._contentHost,-1)},r.prototype.enableHorizontalResize=function(e,t){e!==(null!==this._resizer)&&(e?(this._resizer=new F(this._owner,this._tableCell,t),this._resizer.initialize()):(this._resizer.uninitialize(),this._resizer=null))},r.prototype.disableDragResize=function(){this._tableCell.setAttribute(r._dragResizeDisabledAttributeName,"true")},r._dragResizeDisabledAttributeName="drag-resize-disabled",r}(),x=function(){function r(e){this._tableRow=null,this._fitProportionally=e}return r.prototype.initialize=function(e){this._row=e},r.prototype.createCellPresenter=function(e){return new W(this._fitProportionally,e)},r.prototype.registerRow=function(e){this._tableRow=e},r.prototype.onAppendCell=function(e){var t=e._presenter;if(null===t.tableCell){var n=this._tableRow.insertCell(-1);t.registerTableCell(n)}else this._tableRow.appendChild(t.tableCell)},r.prototype.onInsertCellBefore=function(e,t){I.fF.assertValue(t._presenter.tableCell,"refTableCell");var n=e._presenter;if(null===n.tableCell){var s=this._tableRow.insertCell(Math.max(0,t._presenter.tableCell.cellIndex-1));n.registerTableCell(s)}else this._tableRow.insertBefore(e._presenter.tableCell,t._presenter.tableCell)},r.prototype.onRemoveCell=function(e){this._tableRow.removeChild(e._presenter.tableCell)},r.prototype.getHeight=function(){return this.getCellHeight(this._row.getTablixCell())},r.prototype.getCellHeight=function(e){return I.fF.assertFail("PureVirtualMethod: TablixRowPresenter.getCellHeight"),-1},r.prototype.getCellContentHeight=function(e){return I.fF.assertFail("PureVirtualMethod: TablixRowPresenter.getCellHeight"),-1},Object.defineProperty(r.prototype,"tableRow",{get:function(){return this._tableRow},enumerable:!1,configurable:!0}),r}(),D=function(r){function e(t,n){return r.call(this,n)||this}return(0,V.__extends)(e,r),e.prototype.getCellHeight=function(t){return t.containerHeight},e.prototype.getCellContentHeight=function(t){return t.contentHeight},e}(x),X=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,V.__extends)(e,r),e.prototype.getCellHeight=function(t){return t.containerHeight},e.prototype.getCellContentHeight=function(t){return t.contentHeight},e}(x),K=function(){function r(){}return r.prototype.initialize=function(e){this._column=e},r.prototype.getWidth=function(){var e=this.getPersistedWidth();return null==e&&(e=this.getCellWidth(this._column.getTablixCell())),e},r.prototype.getPersistedWidth=function(){return I.fF.assertFail("PureVirtualMethod: TablixColumnPresenter.getPersistedWidth"),-1},r.prototype.getCellWidth=function(e){return I.fF.assertFail("PureVirtualMethod: TablixColumnPresenter.getCellWidth"),-1},r}(),k=function(r){function e(t){var n=r.call(this)||this;return n._gridPresenter=t,n}return(0,V.__extends)(e,r),e.prototype.getPersistedWidth=function(){return this._gridPresenter.sizeComputationManager.cellWidth},e.prototype.getCellWidth=function(t){return this._gridPresenter.sizeComputationManager.cellWidth},e}(K),q=function(r){function e(t,n){var s=r.call(this)||this;return s._gridPresenter=t,s}return(0,V.__extends)(e,r),e.prototype.getPersistedWidth=function(){return this._gridPresenter.getPersistedColumnWidth(this._column)},e.prototype.getCellWidth=function(t){return t._presenter?t.contentWidth:0},e}(K),y=function(){function r(e){this._table=(0,G.W_)(),this._table.className=u,this._footerTable=(0,G.W_)(),this._footerTable.className=u,this._columnWidthManager=e}return r.prototype.initialize=function(e,t,n,s){this._owner=e,t.appendChild(this._table),n.appendChild(this._footerTable)},r.prototype.getWidth=function(){return I.fF.assertFail("PureVirtualMethod: TablixGridPresenter.getWidth"),-1},r.prototype.getHeight=function(){return I.fF.assertFail("PureVirtualMethod: TablixGridPresenter.getHeight"),-1},r.prototype.getScreenToCssRatioX=function(){return 1},r.prototype.getScreenToCssRatioY=function(){return 1},r.prototype.createRowPresenter=function(){return I.fF.assertFail("PureVirtualMethod: TablixGridPresenter.createRowPresenter"),null},r.prototype.createColumnPresenter=function(e){return I.fF.assertFail("PureVirtualMethod: TablixGridPresenter.createColumnPresenter"),null},r.prototype.onAppendRow=function(e){var t=e.presenter;if(null===t.tableRow){var n=this._table.insertRow(-1);t.registerRow(n)}else this._table.tBodies[0].appendChild(e.presenter.tableRow)},r.prototype.onInsertRowBefore=function(e,t){I.fF.assertValue(t.presenter.tableRow,"refTableRow");var n=e.presenter;if(null===n.tableRow){var s=this._table.insertRow(Math.max(0,t.presenter.tableRow.rowIndex-1));n.registerRow(s)}else this._table.tBodies[0].insertBefore(e.presenter.tableRow,t.presenter.tableRow)},r.prototype.onRemoveRow=function(e){this._table.tBodies[0].removeChild(e.presenter.tableRow)},r.prototype.onAddFooterRow=function(e){var t=e.presenter;if(null===t.tableRow){var n=this._footerTable.insertRow(-1);t.registerRow(n)}else this._footerTable.tBodies[0].appendChild(e.presenter.tableRow)},r.prototype.onClear=function(){(0,G.D4)(this._table),(0,G.D4)(this._footerTable)},r.prototype.onFillColumnsProportionallyChanged=function(e){e?(this._table.style.width="100%",this._footerTable.style.width="100%"):(this._table.style.width="auto",this._footerTable.style.width="auto")},r.prototype.invokeColumnResizeEndCallback=function(e,t){this._columnWidthManager&&this._columnWidthManager.onColumnWidthChanged(le.K.getColumnQueryName(e),t)},r.prototype.getPersistedColumnWidth=function(e){if(this._columnWidthManager)return this._columnWidthManager.getPersistedColumnWidth(le.K.getColumnQueryName(e))},r}(),d=function(r){function e(t){var n=r.call(this)||this;return n._sizeComputationManager=t,n}return(0,V.__extends)(e,r),e.prototype.createRowPresenter=function(){return new D(this,this._owner.fillColumnsProportionally)},e.prototype.createColumnPresenter=function(t){return new k(this)},Object.defineProperty(e.prototype,"sizeComputationManager",{get:function(){return this._sizeComputationManager},enumerable:!1,configurable:!0}),e.prototype.getWidth=function(){return this._sizeComputationManager.gridWidth},e.prototype.getHeight=function(){return this._sizeComputationManager.gridHeight},e}(y),i=function(r){function e(t){return r.call(this,t)||this}return(0,V.__extends)(e,r),e.prototype.createRowPresenter=function(){return new X(this._owner.fillColumnsProportionally)},e.prototype.createColumnPresenter=function(t){return new q(this,t)},e.prototype.getWidth=function(){return(0,G.mx)(this._table)},e.prototype.getHeight=function(){return(0,G.Uy)(this._table)},e}(y),h=function(){function r(){}return Object.defineProperty(r.prototype,"visibleWidth",{get:function(){return this._viewport?this._viewport.width:0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"visibleHeight",{get:function(){return this._viewport?this._viewport.height:0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"gridWidth",{get:function(){return this.visibleWidth},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"gridHeight",{get:function(){return this.visibleHeight},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rowHeight",{get:function(){return this._cellHeight},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"cellWidth",{get:function(){return this._cellWidth},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"cellHeight",{get:function(){return this._cellHeight},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"contentWidth",{get:function(){return this._cellWidth},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"contentHeight",{get:function(){return this._cellHeight},enumerable:!1,configurable:!0}),r.prototype.updateColumnCount=function(e){this._columnCount=e},r.prototype.updateRowHeight=function(e){this._cellHeight=e},r.prototype.updateScalingFactor=function(e){this._scalingFactor=e,this._cellWidth=this.computeColumnWidth(this._columnCount)},r.prototype.updateViewport=function(e){this._viewport=e,this._cellWidth=this.computeColumnWidth(this._columnCount),this._cellHeight=this.computeColumnHeight()},r.prototype.computeColumnWidth=function(e){var t=this._scalingFactor;t||(t=1);var s=Math.floor(this._viewport.width/(t*r.TablixMinimumColumnWidth));return this.fitToColumnCount(s,e)},r.prototype.computeColumnHeight=function(){if(!this.hasImageContent)return this._cellHeight;var e=this._viewport.width;return e<=250?20:e<=510?51:e<=770?52:void I.fF.assertFail("Fixed size is only for viewport up to 770px width.")},r.prototype.fitToColumnCount=function(e,t){var n=Math.min(e,t);return Math.floor(this._viewport.width/n)},r.TablixMinimumColumnWidth=75,r}(),c=function(){function r(e,t,n){this._owner=e,this._grid=t,this._lastScrollOffset=null,this._isScrolling=!1,this._fixedSizeEnabled=!0,this._done=!1,this._realizationManager=n}return Object.defineProperty(r.prototype,"owner",{get:function(){return this._owner},set:function(t){this._owner=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"realizationManager",{get:function(){return this._realizationManager},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fixedSizeEnabled",{get:function(){return this._fixedSizeEnabled},set:function(t){this._fixedSizeEnabled=t},enumerable:!1,configurable:!0}),r.prototype.onCornerCellRealized=function(e,t,n){this._realizationManager.onCornerCellRealized(e,t)},r.prototype.onHeaderRealized=function(e,t,n){this._realizationManager.onHeaderRealized(e,t,n)},Object.defineProperty(r.prototype,"needsToRealize",{get:function(){return this._realizationManager.needsToRealize},enumerable:!1,configurable:!0}),r.prototype.getVisibleSizeRatio=function(){return 1-this.dimension.getFractionScrollOffset()},Object.defineProperty(r.prototype,"alignToEnd",{get:function(){return this._alignToEnd},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"done",{get:function(){return this._done},enumerable:!1,configurable:!0}),r.prototype._requiresMeasure=function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._requiresMeasure"),!0},r.prototype.startScrollingSession=function(){this._isScrolling=!0},r.prototype.endScrollingSession=function(){this._isScrolling=!1},r.prototype.isScrolling=function(){return this._isScrolling},r.prototype.isResizing=function(){return!1},r.prototype.getOtherHierarchyContextualHeight=function(){var t=this.dimension.otherDimension.getDepth(),n=0,s=this._getRealizedItems();if(s.length>0)for(var m=0;m<t;m++)n+=s[m].getContextualWidth();return n},r.prototype._isAutoSized=function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._isAutoSized"),!1},r.prototype.onStartRenderingSession=function(){this._measureEnabled=this._requiresMeasure(),this._gridOffset=this.dimension.otherDimension.getDepth()},r.prototype.onEndRenderingSession=function(){this._realizationManager.onEndRenderingSession(),this._alignToEnd=!1,this._done=!1,this._measureEnabled=!0,this._sendDimensionsToControl()},r.prototype._sendDimensionsToControl=function(){I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._sendDimensionsToControl")},Object.defineProperty(r.prototype,"measureEnabled",{get:function(){return this._measureEnabled},enumerable:!1,configurable:!0}),r.prototype.getFooterContextualWidth=function(){return 0},r.prototype.onStartRenderingIteration=function(e,t){this._measureEnabled&&!this._done&&(this._contextualWidthToFill=(t-this.otherScrollbarContextualWidth)*this.getGridScale()-this.getFooterContextualWidth()),this._realizationManager.onStartRenderingIteration(),e?this._lastScrollOffset=null:null!==this._lastScrollOffset&&this.swapElements()},Object.defineProperty(r.prototype,"allItemsRealized",{get:function(){return this.getRealizedItemsCount()-this._gridOffset===this.dimension.getItemsCount()||0===this.dimension.getItemsCount()},enumerable:!1,configurable:!0}),r.prototype.onEndRenderingIteration=function(){if(!this._done){if(!this._measureEnabled)return this._lastScrollOffset=this.dimension.scrollOffset,void(this._done=!0);var s,e=this.getGridContextualWidth(),t=(0,U.bA)(e,this._contextualWidthToFill,r._pixelPrecision),n=this.allItemsRealized;s=t?this.scrollForwardToAlignEnd(e):this.scrollBackwardToFill(e),this._realizationManager.onEndRenderingIteration(e,t);var m=this.dimension.scrollbar.visible;this.updateScrollbar(e),this._done=(t||n)&&this.dimension.scrollbar.visible===m&&(0,U.GG)(s,this.dimension.scrollOffset,r._scrollOffsetPrecision),this.dimension.scrollOffset=s,this._lastScrollOffset=this.dimension.scrollOffset}},r.prototype.getScrollDeltaWithinPage=function(){if(null!==this._lastScrollOffset){var e=this.dimension.getIntegerScrollOffset()-Math.floor(this._lastScrollOffset);if(Math.abs(e)<this.getRealizedItemsCount()-this.dimension.otherDimension.getDepth())return e}return null},r.prototype.swapElements=function(){var e=this.getScrollDeltaWithinPage();if(null!==e){var t=this.dimension.otherDimension.getDepth();Math.abs(e)<this.getRealizedItemsCount()-t&&(e>0?this._moveElementsToBottom(t,e):e<0&&this._moveElementsToTop(t,-e))}},r.prototype._getRealizedItems=function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._getRealizedItems"),null},r.prototype.getRealizedItemsCount=function(){return this._getRealizedItems().length},r.prototype._moveElementsToBottom=function(e,t){I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._moveElementsToBottom")},r.prototype._moveElementsToTop=function(e,t){I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._moveElementsToTop")},r.prototype.isScrollingWithinPage=function(){return null!==this.getScrollDeltaWithinPage()},r.prototype.getGridContextualWidth=function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.getGridContextualWidth"),0},r.prototype.updateScrollbar=function(e){var t=this.dimension.scrollbar;t.viewMin=this.dimension.scrollOffset,t.min=0,t.max=this.dimension.getItemsCount(),t.viewSize=this.getViewSize(e),this.dimension.scrollbar.show(this.canScroll(e))},r.prototype.getViewSize=function(e){var t=this.getRealizedItemsCount();if(0===t)return 0;for(var n=this._gridOffset,s=0,m=0,O=this._contextualWidthToFill-this.getOtherHierarchyContextualHeight(),H=this.getMeaurementError(e),v=n;v<t;v++){var M;M=v===n?this.getVisibleSizeRatio():1;var Y=this.getItemContextualWidthWithScrolling(v)*H;if(s+=M,(0,U.aP)(m+=Y,O,r._pixelPrecision)){s-=(m-O)/Y*M;break}}return s},r.prototype.isScrollableHeader=function(e,t,n){if(0!==n||0===this.dimension.getFractionScrollOffset())return!1;var s=this.dimension._hierarchyNavigator;if(s.isLeaf(e))return!0;var m=e,w=t;do{if(w=s.getChildren(m),void 0===(m=this.dimension.getFirstVisibleItem(s.getLevel(m)+1)))break;if(!s.isLastItem(m,w))return!1}while(!s.isLeaf(m));return!0},r.prototype.reachedEnd=function(){return this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},r.prototype.scrollBackwardToFill=function(e){var t=this.dimension.scrollOffset;if(this.reachedEnd()){var n=this._contextualWidthToFill-e;if(this.dimension.getItemsCount()>0){var s=e/(this.getRealizedItemsCount()-this.dimension.getFractionScrollOffset());t=this.dimension.getValidScrollOffset(Math.floor(this.dimension.scrollOffset-n/s))}this._alignToEnd=!(0,U.GG)(t,this.dimension.scrollOffset,r._scrollOffsetPrecision)}return t},r.prototype.getItemContextualWidth=function(e){var t=this._getRealizedItems();return e>=t.length?null:t[e].getContextualWidth()},r.prototype.getItemContextualWidthWithScrolling=function(e){return this.getSizeWithScrolling(this.getItemContextualWidth(e),e)},r.prototype.getSizeWithScrolling=function(e,t){return e*(this._gridOffset===t?this.getVisibleSizeRatio():1)},r.prototype.getGridContextualWidthFromItems=function(){for(var e=this.getRealizedItemsCount(),t=0,n=0;n<e;n++)t+=this.getItemContextualWidthWithScrolling(n);return t},r.prototype.getMeaurementError=function(e){return e/this.getGridContextualWidthFromItems()},r.prototype.scrollForwardToAlignEnd=function(e){var t=this.dimension.scrollOffset;if(this._alignToEnd){var n=(0,U.GG)(e,this._contextualWidthToFill,r._pixelPrecision);if(!n)for(var s=this.getRealizedItemsCount(),m=this._gridOffset,w=e-this._contextualWidthToFill,O=this.getMeaurementError(e),H=m;H<s;H++){var v=this.getItemContextualWidth(H)*O;if(!(0,U.Po)(v,w,r._pixelPrecision)){var M=m===H?1-this.dimension.getFractionScrollOffset():1;t=this.dimension.getValidScrollOffset(this.dimension.scrollOffset+(H-m)+w*M/v);break}w-=v}this._alignToEnd=!n}return t},Object.defineProperty(r.prototype,"dimension",{get:function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.dimension"),null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"otherLayoutManager",{get:function(){return this.dimension.otherDimension.layoutManager},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"contextualWidthToFill",{get:function(){return this._contextualWidthToFill},enumerable:!1,configurable:!0}),r.prototype.getGridScale=function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.getGridScale"),0},Object.defineProperty(r.prototype,"otherScrollbarContextualWidth",{get:function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.otherScrollbarContextualWidth"),0},enumerable:!1,configurable:!0}),r.prototype.getActualContextualWidth=function(e){return this._isAutoSized()&&!this.canScroll(e)?e:this._contextualWidthToFill},r.prototype.canScroll=function(e){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.canScroll"),!1},r.prototype.calculateSizes=function(){this.fixedSizeEnabled&&(this.calculateContextualWidths(),this.calculateSpans())},r.prototype._calculateSize=function(e){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager._calculateSize"),null},r.prototype.calculateContextualWidths=function(){for(var e=this._getRealizedItems(),t=e.length,n=0;n<t;n++){var s=e[n];this.measureEnabled&&s.setAligningContextualWidth(-1),this._calculateSize(s)}},r.prototype.calculateSpans=function(){this.measureEnabled&&(this.updateNonScrollableItemsSpans(),this.updateScrollableItemsSpans())},r.prototype.updateNonScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=e.length,s=this.dimension.getDepth();s<t;s++){var m=e[s];this.updateSpans(m,m.getHeaders(),!1)}},r.prototype.updateScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=Math.min(this.dimension.getDepth(),e.length),n=0;n<t;n++){var s=e[n];this.updateSpans(s,s.getOtherDimensionHeaders(),!0)}},r.prototype.fixSizes=function(){if(this.fixedSizeEnabled)for(var e=this._getRealizedItems(),n=e.length-1;n>=0;n--)e[n].fixSize()},r.prototype.updateSpans=function(e,t,n){for(var s=this._getRealizedItems(),m=t.length,w=0;w<m;w++){var O=t[w],H=e.getOtherDimensionOwner(O),v=H.getCellContextualSpan(O);if(v>1)for(var M=0,Y=H.getIndex(this._grid),ie=0;ie<v;ie++){var ue=s[ie+Y],ee=ue.getContentContextualWidth();n&&0===w&&0===ie&&(ee=Math.floor((1-this.dimension.getFractionScrollOffset())*ee)),M+=ee,ie===v-1&&this.updateLastChildSize(O,ue,M)}}},r.prototype.updateLastChildSize=function(e,t,n){var s=t.getCellIContentContextualWidth(e)-n;s>0&&t.setAligningContextualWidth(Math.max(t.getAligningContextualWidth(),s+t.getContentContextualWidth()))},r._pixelPrecision=1.0001,r._scrollOffsetPrecision=.01,r}(),z=function(){function r(e,t,n){this.column=e,this.item=e.getLeafItem(),this.itemType=e.itemType,this.startColumnWidth=t,this.resizingDelta=0,this.animationFrame=null,this.scale=n}return r.prototype.getNewSize=function(){return this.startColumnWidth+this.resizingDelta},r}(),P=function(r){function e(t,n,s){var m=r.call(this,t,n,s)||this;return s.owner=m,m.fillProportionally=!1,m._resizeState=null,m}return(0,V.__extends)(e,r),Object.defineProperty(e.prototype,"dimension",{get:function(){return this.owner.owner.columnDimension},enumerable:!1,configurable:!0}),e.prototype.isResizing=function(){return null!==this._resizeState},Object.defineProperty(e.prototype,"fillProportionally",{get:function(){return this._grid.fillColumnsProportionally},set:function(n){this._grid.fillColumnsProportionally=n},enumerable:!1,configurable:!0}),e.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioX()},Object.defineProperty(e.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?(0,G.mx)(this.dimension.otherDimension.scrollbar.element):0},enumerable:!1,configurable:!0}),e.prototype._getRealizedItems=function(){return this._grid.realizedColumns||(this._grid.realizedColumns=[]),this._grid.realizedColumns},e.prototype._moveElementsToBottom=function(t,n){this._grid.moveColumnsToEnd(t,n)},e.prototype._moveElementsToTop=function(t,n){this._grid.moveColumnsToStart(t,n)},e.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()||this.isScrolling()||this.isResizing()},e.prototype.getGridContextualWidth=function(){return this._grid.getWidth()},e.prototype.getFirstVisibleColumn=function(){return this._grid.realizedColumns[this._gridOffset]},e.prototype._isAutoSized=function(){return this.owner.owner.autoSizeWidth},e.prototype.applyScrolling=function(){var t=this.dimension.getFractionScrollOffset(),n=0,s=this.getFirstVisibleColumn();if(void 0!==s){n=s.getContextualWidth();var m=Math.ceil(-n*t);this.scroll(s,n,m)}},e.prototype.scroll=function(t,n,s){this.scrollCells(t._realizedColumnHeaders,n,s),this.scrollBodyCells(this._grid.realizedRows,n,s),null!==t.footer&&t.footer.scrollHorizontally(n,s)},e.prototype.scrollCells=function(t,n,s){for(var m=t.length,w=0;w<m;w++)t[w].scrollHorizontally(n,s)},e.prototype.scrollBodyCells=function(t,n,s){for(var w,O,m=t.length,H=0;H<m;H++)void 0!==(w=t[H]._realizedBodyCells)&&void 0!==(O=w[0])&&O.scrollHorizontally(n,s)},e.prototype.onStartResize=function(t,n,s){this._resizeState=new z(t._column,t._column.getContentContextualWidth(),(0,G.df)(this.owner.owner.container))},e.prototype.onResize=function(t,n,s){var m=this;this.isResizing()&&(this.owner.owner.wordWrapColumnHeaders&&t.unfixRowHeight(),this._resizeState.resizingDelta=Math.round(Math.max(n/this._resizeState.scale,e.minColumnWidth-this._resizeState.startColumnWidth)),null===this._resizeState.animationFrame&&(this._resizeState.animationFrame=requestAnimationFrame(function(){return m.performResizing()})))},e.prototype.onEndResize=function(t){this.isResizing()&&null!==this._resizeState.animationFrame&&this.performResizing(),this.endResizing(),this._resizeState=null},e.prototype.onReset=function(t){this.owner.owner.wordWrapColumnHeaders&&t.unfixRowHeight(),this._resizeState=new z(t._column,-1,1),t._column.clearSize(),this.endResizing(),this.owner.owner.refresh(!1),this._resizeState=null},e.prototype.updateItemToResizeState=function(t){if(null!==this._resizeState)for(var n=t.length,s=this.owner.owner.hierarchyNavigator,w=this.otherLayoutManager.dimension.getDepth();w<n;w++){var O=t[w];if(O.columnHeaderOrCornerEquals(this._resizeState.itemType,this._resizeState.item,O.itemType,O.getLeafItem(),s)&&O!==this._resizeState.column){this._resizeState.column=O,O.onResize(this._resizeState.getNewSize());break}}},e.prototype.performResizing=function(){if(null!==this._resizeState){this._resizeState.animationFrame=null;var t=this._resizeState.getNewSize();this._resizeState.column.onResize(t),this.owner.owner.refresh(!1)}},e.prototype.endResizing=function(){if(null!==this._resizeState){var t=this._resizeState.getNewSize();this._resizeState.column.onResizeEnd(t)}},e.prototype._sendDimensionsToControl=function(){var t=this.getGridContextualWidth(),n=this.getActualContextualWidth(t),s=this.getOtherHierarchyContextualHeight(),m=this.getGridScale();this.owner.owner.updateColumnDimensions(s/m,(n-s)/m,this.getViewSize(t))},e.prototype.getEstimatedHeaderWidth=function(t,n){return I.fF.assertFail("PureVirtualMethod: ColumnLayoutManager.getEstimatedHeaderWidth"),-1},e.prototype.getEstimatedBodyCellWidth=function(t){return I.fF.assertFail("PureVirtualMethod: ColumnLayoutManager.getEstimatedBodyCellWidth"),-1},e.minColumnWidth=10,e}(c),L=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,V.__extends)(e,r),e.prototype.getEstimatedHeaderWidth=function(t,n){return this.ignoreColumn(n)?0:this.owner.getCellWidth(void 0)},e.prototype.getEstimatedBodyCellWidth=function(t){return this.owner.getCellWidth(void 0)},e.prototype.canScroll=function(t){return!1},e.prototype._calculateSize=function(t){var n=t.getIndex(this._grid),s=0;return this.ignoreColumn(n)||(s=this.owner.getContentWidth(void 0)),t.onResize(s),t.onResizeEnd(s),s},e.prototype.ignoreColumn=function(t){return 0===t&&!this.owner.binder.hasRowGroups()},e}(P),A=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,V.__extends)(e,r),e.prototype.getEstimatedHeaderWidth=function(t,n){return this.owner.getEstimatedTextWidth(t)},e.prototype.getEstimatedBodyCellWidth=function(t){return this.owner.getEstimatedTextWidth(t)},e.prototype.calculateContextualWidths=function(){for(var t=this._getRealizedItems(),n=[],s=0,m=t.length;s<m;s++){var w=t[s];this.measureEnabled&&w.setAligningContextualWidth(-1);var O=le.K.getColumnQueryName(w);null!=O&&n.push({queryName:O,width:this._calculateSize(w),isFixed:!1})}this.owner.columnWidthsToPersist=n},e.prototype.canScroll=function(t){return!(0,U.GG)(this.dimension.scrollOffset,0,c._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||(0,U.aP)(t,this._contextualWidthToFill,c._pixelPrecision)},e.prototype._calculateSize=function(t){return t.calculateSize()},e}(P),Q=function(r){function e(t,n,s){var m=r.call(this,t,n,s)||this;return s.owner=m,m}return(0,V.__extends)(e,r),Object.defineProperty(e.prototype,"dimension",{get:function(){return this.owner.owner.rowDimension},enumerable:!1,configurable:!0}),e.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioY()},Object.defineProperty(e.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?(0,G.Uy)(this.dimension.otherDimension.scrollbar.element):0},enumerable:!1,configurable:!0}),e.prototype.startScrollingSession=function(){r.prototype.startScrollingSession.call(this)},e.prototype._getRealizedItems=function(){return this._grid.realizedRows||(this._grid.realizedRows=[]),this._grid.realizedRows},e.prototype._moveElementsToBottom=function(t,n){this._grid.moveRowsToEnd(t,n)},e.prototype._moveElementsToTop=function(t,n){this._grid.moveRowsToStart(t,n)},e.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()&&!this.otherLayoutManager.isResizing()||this.isScrolling()&&this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},e.prototype.getGridContextualWidth=function(){return this._grid.getHeight()},e.prototype.getFirstVisibleRow=function(){return this._grid.realizedRows[this._gridOffset]},e.prototype._isAutoSized=function(){return this.owner.owner.autoSizeHeight},e.prototype.applyScrolling=function(){var t=this.dimension.getFractionScrollOffset(),n=0,s=this.getFirstVisibleRow();s&&(n=s.getContextualWidth(),this.scroll(s,n,t))},e.prototype.scroll=function(t,n,s){this.scrollCells(t._realizedRowHeaders,n,s),this.scrollCells(t._realizedBodyCells,n,s)},e.prototype.scrollCells=function(t,n,s){for(var m=t.length,w=0;w<m;w++)t[w].scrollVertically(n,s)},e.prototype.getFooterContextualWidth=function(){return this.owner.owner.rowDimension.hasFooter()&&this.owner.grid.footerRow?this.owner.grid.footerRow.getContextualWidth():0},e.prototype.calculateContextualWidths=function(){if(r.prototype.calculateContextualWidths.call(this),this.fixedSizeEnabled){var t=this._grid.footerRow;t&&this._calculateSize(t)}},e.prototype.fixSizes=function(){r.prototype.fixSizes.call(this),this.fixedSizeEnabled&&this._grid.footerRow&&this._grid.footerRow.fixSize()},e.prototype._sendDimensionsToControl=function(){var t=this.getGridContextualWidth(),n=this.getActualContextualWidth(t),s=this.getOtherHierarchyContextualHeight(),m=this.getGridScale();this.owner.owner.updateRowDimensions(s/m,(n-s)/m,t/m,this.getViewSize(t),this._grid.footerRow?this._grid.footerRow.getContextualWidth()/m:0)},e.prototype.getEstimatedHeaderWidth=function(t,n){return I.fF.assertFail("PureVirtualMethod: RowLayoutManager.getEstimatedHeaderWidth"),-1},e}(c),J=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,V.__extends)(e,r),e.prototype.getEstimatedHeaderWidth=function(t,n){return this.getHeaderWidth(n)},e.prototype.canScroll=function(t){return!1},e.prototype._calculateSize=function(t){return t.calculateSize()},e.prototype.getHeaderWidth=function(t){return 0!==t||this.owner.binder.hasRowGroups()?this.owner.getEstimatedTextWidth(void 0):0},e}(Q),de=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,V.__extends)(e,r),e.prototype.getEstimatedHeaderWidth=function(t,n){return this.owner.getEstimatedTextWidth(t)},e.prototype.canScroll=function(t){return!(0,U.GG)(this.dimension.scrollOffset,0,c._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||(0,U.aP)(t,this._contextualWidthToFill,c._pixelPrecision)},e.prototype._calculateSize=function(t){return t.calculateSize()},e}(Q),ae=function(){function r(e,t,n,s){this._allowHeaderResize=!0,this._binder=e,this._grid=t,this._columnLayoutManager=n,this._rowLayoutManager=s,this._columnWidthsToPersist=[]}return r.prototype.initialize=function(e){this._owner=e,this._container=e.container,this._gridHost=e.contentHost,this._footersHost=e.footerHost,this._grid.initialize(e,this._gridHost,this._footersHost)},Object.defineProperty(r.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"binder",{get:function(){return this._binder},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"columnWidthsToPersist",{get:function(){return this._columnWidthsToPersist},set:function(t){this._columnWidthsToPersist=t},enumerable:!1,configurable:!0}),r.prototype.getTablixClassName=function(){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getTablixClassName"),null},r.prototype.getLayoutKind=function(){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getLayoutKind"),null},r.prototype.getOrCreateColumnHeader=function(e,t,n,s){var m=this.owner.hierarchyNavigator,w=this._grid.getOrCreateRow(n),O=this._grid.getOrCreateColumn(s+this._columnLayoutManager._gridOffset),H=m.isLeaf(e),v=w.getOrCreateColumnHeader(O,this._columnLayoutManager.isScrollableHeader(e,t,s),H),M=m.getLevel(e);v.position.row.index=v.position.row.indexInSiblings=M,v.position.row.isFirst=0===M,v.position.row.isLast=H;var Y=m.getIndex(e);return v.position.column.index=v.position.column.indexInSiblings=Y,v.position.column.isFirst=m.areAllParentsFirst(e,t),v.position.column.isLast=m.areAllParentsLast(e,t),this.enableCellHorizontalResize(H,v),v},r.prototype.getOrCreateRowHeader=function(e,t,n,s){var m=this.owner.hierarchyNavigator,w=this._grid.getOrCreateRow(n+this._rowLayoutManager._gridOffset),O=this._grid.getOrCreateColumn(s),H=m.isLeaf(e),v=this._rowLayoutManager.isScrollableHeader(e,t,n);0===w.getRealizedCellCount()&&this.alignRowHeaderCells(e,w);var M=w.getOrCreateRowHeader(O,v,m.isLeaf(e)),Y=m.getIndex(e);M.position.row.index=M.position.row.indexInSiblings=Y,M.position.row.isFirst=m.areAllParentsFirst(e,t),M.position.row.isLast=m.areAllParentsLast(e,t);var ie=m.getLevel(e);return M.position.column.index=M.position.column.indexInSiblings=ie,M.position.column.isFirst=0===ie,M.position.column.isLast=H,M.enableHorizontalResize(!1,this._columnLayoutManager),M},r.prototype.getOrCreateCornerCell=function(e,t,n){var s=this._grid.getOrCreateRow(n),m=this._grid.getOrCreateColumn(t),O=n===this._columnLayoutManager.dimension.getDepth()-1,H=s.getOrCreateCornerCell(m),v=n;H.position.row.index=H.position.row.indexInSiblings=v,H.position.row.isFirst=0===v,H.position.row.isLast=O;var M=t;return H.position.column.index=H.position.column.indexInSiblings=M,H.position.column.isFirst=0===M,H.position.column.isLast=M===this._rowLayoutManager.dimension.getDepth()-1,this.enableCellHorizontalResize(O,H),H},r.prototype.getOrCreateBodyCell=function(e,t,n,s,m){var w,O=this._grid.getOrCreateRow(s+this._rowLayoutManager._gridOffset),H=this._grid.getOrCreateColumn(m+this._columnLayoutManager._gridOffset);w=0===O._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset()||this._rowLayoutManager.isScrollableHeader(t,n,s);var v=O.getOrCreateBodyCell(H,w);return v.position=e.position,v.enableHorizontalResize(!1,this._columnLayoutManager),v},r.prototype.getOrCreateFooterBodyCell=function(e,t){var n,s=this._grid.getOrCreateFootersRow(),m=this._grid.getOrCreateColumn(t+this._columnLayoutManager._gridOffset);n=0===s._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset();var w=s.getOrCreateFooterBodyCell(m,n);return w.position=e.position,w.enableHorizontalResize(!1,this._columnLayoutManager),w},r.prototype.getOrCreateFooterRowHeader=function(e,t){var n=this._grid.getOrCreateFootersRow(),s=this._grid.getOrCreateColumn(0),m=n.getOrCreateFooterRowHeader(s);return m.position=void 0,m.enableHorizontalResize(!1,this._columnLayoutManager),m},r.prototype.getVisibleWidth=function(){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getVisibleWidth"),-1},r.prototype.getVisibleHeight=function(){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getVisibleHeight"),-1},r.prototype.updateColumnCount=function(e,t){I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.updateColumnCount")},r.prototype.updateViewport=function(e){I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.updateViewport")},r.prototype.getEstimatedRowHeight=function(){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getEstimatedRowHeight"),-1},r.prototype.getCellWidth=function(e){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getCellWidth"),-1},r.prototype.getContentWidth=function(e){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getContentWidth"),-1},r.prototype.adjustContentSize=function(e){},r.prototype.alignRowHeaderCells=function(e,t){var n=t.getRowHeaderLeafIndex();if(-1!==n){var m=this._owner.rowDimension.getFirstVisibleChildLeaf(e);this.owner.hierarchyNavigator.headerItemEquals(m,t.getAllocatedCellAt(n).item)&&t.moveCellsBy(this.owner.hierarchyNavigator.getLevel(m)-this.owner.hierarchyNavigator.getLevel(e)-n)}},Object.defineProperty(r.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rowLayoutManager",{get:function(){return this._rowLayoutManager},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"columnLayoutManager",{get:function(){return this._columnLayoutManager},enumerable:!1,configurable:!0}),r.prototype.showEmptySpaceHeader=function(){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.showEmptySpaceHeader"),!1},r.prototype.onStartRenderingSession=function(e,t,n){if(this.showEmptySpaceHeader()){var s=this._grid.emptySpaceHeaderCell;s&&this._binder.unbindEmptySpaceHeaderCell(s),(s=this._grid.emptySpaceFooterCell)&&this._binder.unbindEmptySpaceFooterCell(s),this._grid.HideEmptySpaceCells()}this._scrollingDimension=e,this._scrollingDimension&&this._scrollingDimension.layoutManager.startScrollingSession(),this._rowLayoutManager.onStartRenderingSession(),this._columnLayoutManager.onStartRenderingSession(),this._grid.onStartRenderingSession(n),(this._columnLayoutManager.measureEnabled||this._rowLayoutManager.measureEnabled)&&this.measureSampleText(t)},r.prototype.onEndRenderingSession=function(){if(this._rowLayoutManager.onEndRenderingSession(),this._columnLayoutManager.onEndRenderingSession(),this._scrollingDimension&&this._scrollingDimension.layoutManager.endScrollingSession(),this._scrollingDimension=null,this.showEmptySpaceHeader()){var e=this._columnLayoutManager.contextualWidthToFill-this._columnLayoutManager.getGridContextualWidth();if(e>0){this._grid.ShowEmptySpaceCells(this._owner.columnDimension.getDepth(),e);var t=this._grid.emptySpaceHeaderCell;t&&this._binder.bindEmptySpaceHeaderCell(t),(t=this._grid.emptySpaceFooterCell)&&this._binder.bindEmptySpaceFooterCell(t)}}},r.prototype.onStartRenderingIteration=function(e){this._rowLayoutManager.onStartRenderingIteration(e,this.getVisibleHeight()),this._columnLayoutManager.onStartRenderingIteration(e,this.getVisibleWidth()),this._grid.onStartRenderingIteration()},r.prototype.onEndRenderingIteration=function(){return this._grid.onEndRenderingIteration(),this._columnLayoutManager.calculateSizes(),this._rowLayoutManager.calculateSizes(),this._columnLayoutManager.fixSizes(),this._rowLayoutManager.fixSizes(),this._columnLayoutManager.updateItemToResizeState(this._grid.realizedColumns),this._columnLayoutManager.applyScrolling(),this._rowLayoutManager.applyScrolling(),this._columnLayoutManager.onEndRenderingIteration(),this._rowLayoutManager.onEndRenderingIteration(),this._columnLayoutManager.done&&this._rowLayoutManager.done},r.prototype.onCornerCellRealized=function(e,t){var n=this.owner.hierarchyNavigator.isColumnHierarchyLeaf(e),s=this.owner.hierarchyNavigator.isRowHierarchyLeaf(e);n&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onCornerCellRealized(e,t,n),this._rowLayoutManager.onCornerCellRealized(e,t,s)},r.prototype.onRowHeaderRealized=function(e,t){var s=this._owner.hierarchyNavigator.isLeaf(e);t.colSpan>1&&t.setContainerWidth(-1),this._rowLayoutManager.onHeaderRealized(e,t,s)},r.prototype.onRowHeaderFooterRealized=function(e,t){},r.prototype.onColumnHeaderRealized=function(e,t){var s=this._owner.hierarchyNavigator.isLeaf(e);s&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onHeaderRealized(e,t,s)},r.prototype.onBodyCellRealized=function(e,t){},r.prototype.onBodyCellFooterRealized=function(e,t){},r.prototype.setAllowHeaderResize=function(e){this._allowHeaderResize=e},r.prototype.enableCellHorizontalResize=function(e,t){t.enableHorizontalResize(e&&this._allowHeaderResize,this._columnLayoutManager)},r.prototype.getEstimatedTextWidth=function(e){return I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.getEstimatedTextWidth"),-1},r.prototype.measureSampleText=function(e){I.fF.assertFail("PureVirtualMethod: TablixLayoutManager.measureSampleText")},r}(),B=function(r){function e(t,n,s,m,w){var O=this,H=new L(null,s,w),v=new J(null,s,m);return O=r.call(this,t,s,H,v)||this,H.owner=O,v.owner=O,O._sizeComputationManager=n,O}return(0,V.__extends)(e,r),e.createLayoutManager=function(t){var n=new h;return new e(t,n,new S(new d(n)),new f(t),new b(t))},e.prototype.getTablixClassName=function(){return"tablixDashboard"},e.prototype.getLayoutKind=function(){return 1},e.prototype.showEmptySpaceHeader=function(){return!1},e.prototype.measureSampleText=function(t){var n=oe.b.getSvgMeasurementProperties(t);this._characterHeight=oe.b.estimateSvgTextHeight(n),this._sizeComputationManager.updateRowHeight(this._characterHeight);var s=j.FP.toPoint(parseFloat(n.fontSize));this._sizeComputationManager.updateScalingFactor((0,U.GW)(s/te.L,.05))},e.prototype.getVisibleWidth=function(){return this._sizeComputationManager.visibleWidth},e.prototype.getVisibleHeight=function(){return this._sizeComputationManager.visibleHeight},e.prototype.getCellWidth=function(t){return this._sizeComputationManager.cellWidth},e.prototype.getContentWidth=function(t){return this._sizeComputationManager.contentWidth},e.prototype.getEstimatedTextWidth=function(t){return this._sizeComputationManager.contentWidth},e.prototype.adjustContentSize=function(t){this._sizeComputationManager.hasImageContent=t},e.prototype.updateColumnCount=function(t,n){var w=(t?t.getDepth():0)+(n?n.getItemsCount():0);this.binder.hasRowGroups()||w--,this._sizeComputationManager.updateColumnCount(w)},e.prototype.updateViewport=function(t){this._sizeComputationManager.updateViewport(t)},e.prototype.getEstimatedRowHeight=function(){return this._characterHeight},e}(ae),g=function(r){function e(t,n,s,m){var w,O=new A(null,n,m),H=new de(null,n,s);return w=r.call(this,t,n,O,H)||this,O.owner=w,H.owner=w,w}return(0,V.__extends)(e,r),e.createLayoutManager=function(t,n){return new e(t,new S(new i(n)),new f(t),new b(t))},e.prototype.getTablixClassName=function(){return"tablixCanvas"},e.prototype.getLayoutKind=function(){return 0},e.prototype.measureSampleText=function(t){var n=(0,G.wC)();n.style.cssFloat="left",n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.lineHeight="normal",t.appendChild(n);var s=document.createTextNode("a");n.appendChild(s),this.characterWidth=(0,G.mx)(n),this.characterHeight=(0,G.Uy)(n),n.removeChild(s),t.removeChild(n)},e.prototype.showEmptySpaceHeader=function(){return!this._columnLayoutManager.fillProportionally},e.prototype.getVisibleWidth=function(){return this._columnLayoutManager.measureEnabled?this._owner.autoSizeWidth&&this._owner.maxWidth?this._owner.maxWidth:(0,G.mx)(this._container):-1},e.prototype.getVisibleHeight=function(){return this._rowLayoutManager.measureEnabled?this._owner.autoSizeHeight&&this._owner.maxHeight?this._owner.maxHeight:(0,G.Uy)(this._container):-1},e.prototype.getCellWidth=function(t){return t.containerWidth},e.prototype.getContentWidth=function(t){return t.contentWidth},e.prototype.getEstimatedTextWidth=function(t){return t?t.length*this.characterWidth:0},e.prototype.updateColumnCount=function(t,n){},e.prototype.updateViewport=function(t){},e.prototype.getEstimatedRowHeight=function(){return this.characterHeight},e}(ae),a=function(){function r(e){this._binder=e,this._adjustmentFactor=1}return r.prototype._getOwner=function(){return I.fF.assertFail("PureVirtualMethod: DimensionLayoutManager.getOwner"),null},Object.defineProperty(r.prototype,"binder",{get:function(){return this._binder},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"adjustmentFactor",{get:function(){return this._adjustmentFactor},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"itemsToRealizeCount",{get:function(){return this._itemsToRealizeCount},set:function(t){this._itemsToRealizeCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"itemsEstimatedContextualWidth",{get:function(){return this._itemsEstimatedContextualWidth},set:function(t){this._itemsEstimatedContextualWidth=t},enumerable:!1,configurable:!0}),r.prototype.onStartRenderingIteration=function(){var e=this._getOwner();e.measureEnabled&&!e.done&&this._getEstimatedItemsToRealizeCount(),this._realizedLeavesCount=0},r.prototype.onEndRenderingIteration=function(e,t){!t&&!this._getOwner().allItemsRealized&&(this._adjustmentFactor*=this._getSizeAdjustment(e))},r.prototype.onEndRenderingSession=function(){this._adjustmentFactor=1},r.prototype.onCornerCellRealized=function(e,t){},r.prototype.onHeaderRealized=function(e,t,n){n&&this._realizedLeavesCount++},Object.defineProperty(r.prototype,"needsToRealize",{get:function(){return this._realizedLeavesCount<this._itemsToRealizeCount},enumerable:!1,configurable:!0}),r.prototype._getEstimatedItemsToRealizeCount=function(){I.fF.assertFail("PureVirtualMethod: TablixDimensionRealizationManager._calculateItemsToRealize")},r.prototype._getSizeAdjustment=function(e){return I.fF.assertFail("PureVirtualMethod: TablixDimensionRealizationManager._getSizeAdjustment"),1},r}(),f=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,V.__extends)(e,r),Object.defineProperty(e.prototype,"owner",{set:function(n){this._owner=n},enumerable:!1,configurable:!0}),e.prototype._getOwner=function(){return this._owner},e.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateRowsToRealizeCount()},e.prototype.estimateRowsToRealizeCount=function(){I.fF.assertValue(this._owner,"_owner"),this.itemsToRealizeCount=this._owner.dimension.model?this._owner.alignToEnd?this._owner.dimension.getItemsCount()-this._owner.dimension.getIntegerScrollOffset()+1:Math.ceil(this._owner.contextualWidthToFill/(this._owner.owner.getEstimatedRowHeight()*this.adjustmentFactor)+this._owner.dimension.getFractionScrollOffset())-this._owner.otherLayoutManager.dimension.getDepth()+1:0},e.prototype.getEstimatedRowHierarchyWidth=function(){if(!this._owner.dimension.model||0===this._owner.dimension.getItemsCount())return 0;var t=new C;this.updateRowHiearchyEstimatedWidth(this._owner.dimension.model,this._owner.dimension._hierarchyNavigator.getIndex(this._owner.dimension.getFirstVisibleItem(0)),t);for(var n=t.items,s=n.length,m=0,w=0;w<s;w++){var O=n[w];m+=0!==O.maxNonLeafWidth?O.maxNonLeafWidth:O.maxLeafWidth}return m},e.prototype.updateRowHiearchyEstimatedWidth=function(t,n,s){if(!(n<0))for(var m=this._owner.owner.owner.hierarchyNavigator,w=this.binder,O=m.getCount(t),H=n;H<O;H++){if(s.leafCount===this.itemsToRealizeCount)return;var v=m.getAt(t,H),M=w.getHeaderLabel(v),Y=this._owner.getEstimatedHeaderWidth(M,n),ie=m.isLeaf(v),ue=m.getLevel(v),ee=s.items[ue];ee||(ee=new p,s.items[ue]=ee),ie?(ee.maxLeafWidth=Math.max(ee.maxLeafWidth,Y),s.leafCount=s.leafCount+1):(ee.maxNonLeafWidth=Math.max(ee.maxNonLeafWidth,Y),this.updateRowHiearchyEstimatedWidth(m.getChildren(v),this._owner.dimension.getFirstVisibleChildIndex(v),s))}},e.prototype._getSizeAdjustment=function(t){return t/((this._owner.getRealizedItemsCount()-this._owner.dimension.getFractionScrollOffset())*this._owner.owner.getEstimatedRowHeight())},e}(a),b=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return(0,V.__extends)(e,r),Object.defineProperty(e.prototype,"owner",{set:function(n){this._owner=n},enumerable:!1,configurable:!0}),e.prototype._getOwner=function(){return this._owner},e.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateColumnsToRealizeCount(this.getEstimatedRowHierarchyWidth())},Object.defineProperty(e.prototype,"rowRealizationManager",{get:function(){return this._owner.otherLayoutManager.realizationManager},enumerable:!1,configurable:!0}),e.prototype.getEstimatedRowHierarchyWidth=function(){return this._owner.otherLayoutManager.done?this._owner.getOtherHierarchyContextualHeight():this.rowRealizationManager.getEstimatedRowHierarchyWidth()*this.adjustmentFactor},e.prototype.estimateColumnsToRealizeCount=function(t){var n=this._owner.contextualWidthToFill-t;if(this._owner.dimension.model&&!(0,U.bl)(n,0,c._pixelPrecision)){var s=this.binder,m=this._owner.owner.owner.hierarchyNavigator,w=this._owner.dimension.getIntegerScrollOffset(),O=this._owner.dimension.getItemsCount(),H=O-w,v=this._owner.otherLayoutManager.dimension.getIntegerScrollOffset(),M=this._owner.otherLayoutManager.dimension.getItemsCount();if(this.itemsEstimatedContextualWidth=0,this._owner.alignToEnd)this.itemsToRealizeCount=H;else{for(var Y=w;Y<O;Y++){if((0,U.bA)(this.itemsEstimatedContextualWidth,n,c._pixelPrecision))return void(this.itemsToRealizeCount=Y-w);var ue,ie=0;ue=Y===w?this._owner.getVisibleSizeRatio():1;var ee=m.getLeafAt(this._owner.dimension.model,Y),se=s.getHeaderLabel(ee);ie=Math.max(ie,this._owner.getEstimatedHeaderWidth(se,Y));for(var pe=v;pe<M;pe++){var fe=m.getIntersection(m.getLeafAt(this._owner.otherLayoutManager.dimension.model,pe),ee);se=s.getCellContent(fe),ie=Math.max(ie,this._owner.getEstimatedBodyCellWidth(se))}this.itemsEstimatedContextualWidth+=ie*ue*this.adjustmentFactor}this.itemsToRealizeCount=H}}else this.itemsToRealizeCount=0},e.prototype._getSizeAdjustment=function(t){return t/(this.getEstimatedRowHierarchyWidth()+this.itemsEstimatedContextualWidth)},e}(a),C=function(){return function(){this.items=[],this.leafCount=0}}(),p=function(){return function(){this.maxLeafWidth=0,this.maxNonLeafWidth=0}}()},42737:function(Fe,me,E){E.d(me,{A:function(){return I}});var V=E(62458),I=function(){function U(oe,j){this._element=oe,this._handler=j,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return U.addDocumentMouseUpEvent=function(oe){document.addEventListener("mouseup",oe)},U.removeDocumentMouseUpEvent=function(oe){document.removeEventListener("mouseup",oe)},U.addDocumentMouseMoveEvent=function(oe){document.addEventListener("mousemove",oe)},U.removeDocumentMouseMoveEvent=function(oe){document.removeEventListener("mousemove",oe)},U.getMouseCoordinates=function(oe){return{x:oe.pageX,y:oe.pageY}},U.getMouseCoordinateDelta=function(oe,j){return{x:j.x-oe.x,y:j.y-oe.y}},U.prototype.initialize=function(){var oe=this;this._elementMouseDownWrapper=function(j){return oe.onElementMouseDown(j)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(j){return oe.onElementMouseMove(j)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(j){return oe.onElementMouseOut(j)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(j){return oe.onElementMouseDoubleClick(j)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},U.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(U.prototype,"cell",{get:function(){return V.fF.assertFail("PureVirtualMethod: TablixResizer.cell"),null},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),U.prototype._hotSpot=function(oe){return V.fF.assertFail("PureVirtualMethod: TablixResizer._hotSpot"),!1},U.prototype.onElementMouseDown=function(oe){var j=this,le=U.getMouseCoordinates(oe);this._hotSpot(le)&&(oe.cancelBubble=!0,this._startMousePosition=le,this._documentMouseMoveWrapper=function(te){return j.onDocumentMouseMove(te)},U.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(te){return j.onDocumentMouseUp(te)},U.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=U.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},U.prototype.onElementMouseMove=function(oe){this._startMousePosition||(this._hotSpot(U.getMouseCoordinates(oe))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=U.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},U.prototype.onElementMouseOut=function(oe){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},U.prototype.onElementMouseDoubleClick=function(oe){this._hotSpot(U.getMouseCoordinates(oe))&&this._handler.onReset(this.cell)},U.prototype.onDocumentMouseMove=function(oe){if(this._startMousePosition){var j=U.getMouseCoordinateDelta(this._startMousePosition,U.getMouseCoordinates(oe));this._handler.onResize(this.cell,j.x,j.y),oe.preventDefault()}},U.prototype.onDocumentMouseUp=function(oe){this._startMousePosition=null,U.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,U.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),oe.preventDefault&&oe.preventDefault(),this._handler.onEndResize(this.cell)},U.resizeHandleSize=4,U.resizeCursor="e-resize",U}()},93340:function(Fe,me,E){E.d(me,{AB:function(){return ae},Av:function(){return s},Ch:function(){return g},D4:function(){return S},D6:function(){return w},DM:function(){return de},FX:function(){return l},G9:function(){return Q},Hd:function(){return se},Hx:function(){return b},Iw:function(){return F},MN:function(){return p},Or:function(){return t},Pb:function(){return q},Py:function(){return W},R5:function(){return A},RP:function(){return r},Uy:function(){return D},W_:function(){return z},Y1:function(){return n},Y4:function(){return v},aP:function(){return J},df:function(){return K},ey:function(){return L},hn:function(){return u},jG:function(){return c},jT:function(){return pe},mx:function(){return x},om:function(){return y},pW:function(){return M},qZ:function(){return d},ri:function(){return h},ut:function(){return k},v4:function(){return B},vU:function(){return f},wC:function(){return P},wX:function(){return e},x7:function(){return m},xl:function(){return a}});var V=E(54522),I=E(91358),U=E(44977),oe=E(38308),j=E(62458),le=E(6444),te=E(64329),G=E(48066),re=E(28326),ce=E(42737),o=E(71090);function S(R){if(R)for(;R.hasChildNodes();)R.removeChild(R.firstChild)}function l(R,T){R.style.top=T+"px"}function u(R,T){R.style.left=T+"px"}function F(R,T){R.style.height=X(T)?"":T+"px"}function W(R,T){R.style.width=X(T)?"":T+"px"}function x(R){return R.offsetWidth}function D(R){return R.offsetHeight}function X(R){return-1===R}function K(R){var T=R.offsetWidth;return 0===T?1:R.getBoundingClientRect().width/T}function k(R,T){var N=R.getBoundingClientRect(),Z=K(R);return{x:(T.pageX-N.left)/Z,y:(T.pageY-N.top)/Z}}var q=function(R){return R[R.Outline=0]="Outline",R[R.Gridline=1]="Gridline",R}({}),y=function(){function R(T,N){this.applyParams(!0,T,N)}return R.prototype.applyParams=function(T,N,Z,ne){T?(this.weight=N??0,this.color=Z??"black",this.type=ne??q.Gridline):(this.weight=0,this.color="black",this.type=q.Gridline)},R.prototype.getCSS=function(){var T=[];return _.isNumber(this.weight)&&(T.push(this.weight+o.wH),this.color&&T.push(this.color),T.push("solid")),T.join(" ")},R.prototype.getPriority=function(T){return this===T.top||this===T.bottom?this.type===q.Outline?2:0:this===T.right||this===T.left?this.type===q.Outline?3:1:-1},R.prototype.getShadowCss=function(T,N){var ne=this.weight?this.weight+5:0,ye="inset ";if(this===T.left)ye+=ne+o.wH+" 0";else if(this===T.right)ye+="-"+Math.min(ne,N+5)+o.wH+" 0";else if(this===T.top)ye+="0 "+ne+o.wH;else{if(this!==T.bottom)return"";ye+="0 -"+ne+o.wH}return ye+" 0 -".concat(5,"px ")+this.color},R}(),d=function(){function R(T,N){void 0===T&&(T=o.YR),void 0===N&&(N=o.rJ),this.borders={},this.paddings={top:0,left:T,bottom:0,right:N},this.fontColor="",this.fontFamily="",this.backColor=""}return R.prototype.applyStyle=function(T){var Z=T.extension.contentHost.style;Z.fontFamily=this.fontFamily,Z.fontSize=this.fontSize?te.FP.toString(this.fontSize.px):void 0,Z.fontWeight=this.fontWeight,Z.fontStyle=this.fontStyle,Z.textDecoration=this.textDecoration,Z.color=this.fontColor,Z.backgroundColor=this.backColor,Z.boxShadow=this.getBoxShadow(),Z.border="none",Z.paddingTop=this.getPaddingTop(),Z.paddingRight=this.getPaddingRight(),Z.paddingBottom=this.getPaddingBottom(),Z.paddingLeft=this.getPaddingLeft(),Z.maxWidth=this.maxWidth},R.prototype.getPaddingTop=function(){return(this.paddings.top??0)+(null==this.borders.top?0:this.borders.top.weight)+o.wH},R.prototype.getPaddingBottom=function(){return(this.paddings.bottom??0)+(null==this.borders.bottom?0:this.borders.bottom.weight)+o.wH},R.prototype.getPaddingRight=function(){return(this.paddings.right??o.rJ)+(null==this.borders.right?0:this.borders.right.weight)+o.wH},R.prototype.getPaddingLeft=function(){return(this.paddings.left??o.YR)+(null==this.borders.left?0:this.borders.left.weight)+o.wH},R.prototype.getBoxShadow=function(T){var N,Z,ne,he,ye,Re,xe,Te,Pe=[];return(null===(N=this.borders.left)||void 0===N?void 0:N.type)===q.Outline&&0!==this.borders.left.weight&&Pe.push(this.borders.left.getShadowCss(this.borders)),(null===(Z=this.borders.right)||void 0===Z?void 0:Z.type)===q.Outline&&0!==this.borders.right.weight&&0!==T&&Pe.push(this.borders.right.getShadowCss(this.borders,T)),(null===(ne=this.borders.bottom)||void 0===ne?void 0:ne.type)===q.Outline&&0!==this.borders.bottom.weight&&Pe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(he=this.borders.top)||void 0===he?void 0:he.type)===q.Outline&&0!==this.borders.top.weight&&Pe.push(this.borders.top.getShadowCss(this.borders)),(null===(ye=this.borders.left)||void 0===ye?void 0:ye.type)===q.Gridline&&0!==this.borders.left.weight&&Pe.push(this.borders.left.getShadowCss(this.borders)),(null===(Re=this.borders.right)||void 0===Re?void 0:Re.type)===q.Gridline&&0!==this.borders.right.weight&&0!==T&&Pe.push(this.borders.right.getShadowCss(this.borders,T)),(null===(xe=this.borders.bottom)||void 0===xe?void 0:xe.type)===q.Gridline&&0!==this.borders.bottom.weight&&Pe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(Te=this.borders.top)||void 0===Te?void 0:Te.type)===q.Gridline&&0!==this.borders.top.weight&&Pe.push(this.borders.top.getShadowCss(this.borders)),Pe.join(", ")},R.prototype.setAttributes=function(T,N,Z,ne,he){if(T["padding-top"]=this.getPaddingTop(),T["padding-right"]=this.getPaddingRight(),T["padding-bottom"]=this.getPaddingBottom(),T["padding-left"]=this.getPaddingLeft(),_.isEmpty(this.fontFamily)||(T["font-family"]=this.fontFamily),null!=this.fontSize&&(T["font-size"]=te.FP.toString(this.fontSize.px)),null!=this.fontWeight&&(T["font-weight"]=this.fontWeight),_.isEmpty(this.fontStyle)||(T["font-style"]=this.fontStyle),_.isEmpty(this.textDecoration)||(T["text-decoration"]=this.textDecoration),_.isEmpty(this.fontColor)||(T.color=this.fontColor),_.isEmpty(this.backColor)||(T["background-color"]=this.backColor),ne||!N&&!Z){var ye=parseFloat(this.getPaddingLeft()),Re=parseFloat(this.getPaddingRight()),xe=this.getRightBorderMax(he,ye,Re),Te=this.getBoxShadow(xe);_.isEmpty(Te)||(T["box-shadow"]=Te)}_.isEmpty(this.maxWidth)||(T["max-width"]=this.maxWidth),(N||Z)&&(T["--outline-top"]=this.borders.top?this.borders.top.weight+1+"px":"1px",T["--outline-right"]=this.borders.right?this.borders.right.weight+1+"px":"1px",T["--outline-bottom"]=this.borders.bottom?this.borders.bottom.weight+1+"px":"1px",T["--outline-left"]=this.borders.left?this.borders.left.weight+1+"px":"1px")},R.prototype.getRightBorderMax=function(T,N,Z){if(null==T)return Z;var ne=Math.max(T-N,0);return Math.min(Z,ne)},R.prototype.getAttributes=function(T,N,Z,ne){var he={};return this.setAttributes(he,T,N,Z,ne),he},R.prototype.getExtraTop=function(){var T=0;return this.paddings.top&&(T+=this.paddings.top),this.borders.top&&(T+=this.borders.top.weight),T},R.prototype.getExtraBottom=function(){var T=0;return this.paddings.bottom&&(T+=this.paddings.bottom),this.borders.bottom&&(T+=this.borders.bottom.weight),T},R.prototype.getExtraRight=function(){var T=0;return this.paddings.right&&(T+=this.paddings.right),this.borders.right&&(T+=this.borders.right.weight),T},R.prototype.getExtraLeft=function(){var T=0;return this.paddings.left&&(T+=this.paddings.left),this.borders.left&&(T+=this.borders.left.weight),T},R}(),i=function(){return function(){}}(),h=function(){function R(){this.row=new i,this.column=new i}return R.prototype.isMatch=function(T){return this.column.index===T.column.index&&this.row.index===T.row.index},R}(),c=function(){function R(T,N,Z,ne,he,ye,Re,xe,Te,Pe,Ve){this.dataPoint=T,this.objects=N,this.isRowSubTotal=Z,this.isColumnSubTotal=ne,this.isRowGrandTotal=he,this.isColumnGrandTotal=ye,this.isBlankRow=Re,this.columnMetadata=xe,this.formatter=Te,this.tooltipFormatter=Pe,this.type=Ve,this.position=new h,this.cachedTextContent=Te?this.formatter.format(T,N):null!=this.dataPoint?T:""}return Object.defineProperty(R.prototype,"isTotal",{get:function(){return this.isSubtotal||this.isGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isSubtotal",{get:function(){return this.isColumnSubTotal||this.isRowSubTotal},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isGrandTotal",{get:function(){return this.isColumnGrandTotal||this.isRowGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isRowAndColumnGrandTotal",{get:function(){return this.isRowGrandTotal&&this.isColumnGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"textContent",{get:function(){return this.cachedTextContent},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"tooltipContent",{get:function(){return void 0===this.cachedTooltipContent&&(this.cachedTooltipContent=this.tooltipFormatter?this.tooltipFormatter.format(this.dataPoint,this.objects):this.textContent),this.cachedTooltipContent},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isKpi",{get:function(){return this.columnMetadata&&n(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"kpiContent",{get:function(){if(this.isKpi)return function(R,T){j.fF.assertValue(R,"kpi"),j.fF.assertValue(T,"kpiValue");var N=(0,I.sq)(R,T)||"";return(0,oe.hi)().addClass(N).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isNumeric",{get:function(){if(this.columnMetadata)return this.columnMetadata.type.numeric&&!this.columnMetadata.kpi},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isUrl",{get:function(){if(this.columnMetadata)return(0,V.cR)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isImage",{get:function(){if(this.columnMetadata)return(0,V.pt)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isValidUrl",{get:function(){return p(this.columnMetadata,this.textContent)!==G.av.NONE},enumerable:!1,configurable:!0}),R.prototype.isMatch=function(T){return this.position.isMatch(T.position)&&this.backColor===T.backColor},R}();function z(){return document.createElement("table")}function P(){var R=document.createElement("div");return R.className=o.rz,R}function L(R){R.extension.contentElement.className=o.rz+" "+o.en,R.extension.contentHost.className=o.rz+" "+o.Pr}function A(R,T){R.extension.contentHost.className+=" "+T}function Q(R){R.extension.contentHost.className="",R.extension.contentHost.style.cssText=""}function J(R){R.extension.contentHost.textContent="",R.extension.contentHost.removeAttribute("title"),R.contentHeight=R.contentWidth=0,S(R.extension.contentHost)}function de(R,T,N){ae(R,T),B(R,N||T)}function ae(R,T){T.textContent=(0,U.PC)(R)}function B(R,T){T.title=R}function g(R,T){var N=P();return R.appendChild(N),T&&(N.textContent=T),N}function a(R){var N=R.offsetX;return N>=0&&N<R.target.offsetWidth-ce.A.resizeHandleSize}function f(R,T,N){var Z=null;0===T.childElementCount?(Z=document.createElement("a"),T.appendChild(Z)):Z=T.children[0],Z.href=R,Z.target="_blank",Z.rel="noopener noreferrer",Z.title=R,null!=N?(Z.className=o.NA+" "+N,$(T).addClass(o.LU)):Z.innerText=R}function b(R,T,N){var Z=P(),ne=document.createElement("img");Z.style.height=N+"px",Z.style.width="100%",Z.style.textAlign="center",ne.src=R,ne.style.maxHeight="100%",ne.style.maxWidth="100%",Z.appendChild(ne),T.appendChild(Z),T.title=R}function p(R,T){return(0,V.cR)(R)?(0,G.MN)(T):G.av.NONE}function r(R){switch(R){case G.av.file:case G.av.ftp:return"page2";case G.av.mailto:return"mail";case G.av.news:return"link";case G.av.telnet:return"pc1";case G.av.http:case G.av.https:return"link";default:return null}}function e(R,T,N){return t(R,T)&&(0,G.gU)(N)}function t(R,T){return(0,V.pt)(T)&&!R.isSubtotal&&!!R.identity}function n(R,T){return!(!R||void 0===T||!(0,I.sq)(R,T))}function s(R,T){return{sortDescriptors:[{queryName:R,sortDirection:T}]}}function m(R){return 2===R?1:2}function w(R,T){var N=P();R?(N.appendChild(O(R,!0)),N.appendChild(O(m(R),!1))):N.appendChild(O(2,!1));var Z=P();return N.appendChild(Z),T.appendChild(N),Z}function O(R,T){var N=document.createElement("i");return N.className=o.rx+" "+(T?"sorted":"future")+" "+(1===R?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),N}function v(R){(function(R){for(var T=0,N=R.extension.contentElement.childElementCount;T<N;T++)if(R.extension.contentElement.children.item(T).classList.contains(o.rx))return!0;return!1})(R)&&$(R.extension.contentElement).find("."+o.rx).remove()}function M(R){return j.fF.assert(function(){return!(R instanceof Date)||(0,le.M4)(R)},"dates should implement DateWithEpochValue"),(0,le.M4)(R)&&(R=re.y3.fromDateWithEpochValue(R).toString()),String(R)}function se(R){return R+2}function pe(R){return R+2}},81671:function(Fe,me,E){E.d(me,{K:function(){return j}});var V=E(55007),I=E(62458),U=E(82755),oe=E(74304),j=function(){function le(te,G,re,ce){this.columnWidthObjects={},this.isMatrix=G,this.updateDataView(te,ce),this.hostPersistCallBack=re,this.visualObjectInstancesToPersist={merge:[],remove:[]}}return le.prototype.updateDataView=function(te,G){this.previousDataView=this.currentDataView,this.previousAutoColumnSizePropertyValue=this.previousDataView?V.FX.PropGeneralAutoSizeColumns.getValue(oe.U.getMetadataObjects(this.previousDataView)):void 0,this.currentDataView=te,this.currentAutoColumnSizePropertyValue=this.currentDataView?V.FX.PropGeneralAutoSizeColumns.getValue(oe.U.getMetadataObjects(this.currentDataView)):void 0,this.matrixLeafNodes=G,this.updateColumnsMetadata(),this.updateTablixColumnWidths()},le.prototype.updateColumnsMetadata=function(){this.columnWidthObjects={},this.isMatrix?this.updateMatrixColumnsMetadata():this.updateTableColumnsMetadata()},le.prototype.updateTableColumnsMetadata=function(){if(this.currentDataView&&this.currentDataView.table)for(var te=this.currentDataView.table.columns,G=0,re=te.length;G<re;G++){var ce=te[G].queryName;ce&&(this.columnWidthObjects[ce]={queryName:ce,width:void 0,isFixed:!1})}},le.prototype.updateMatrixColumnsMetadata=function(){if(this.currentDataView&&this.currentDataView.matrix&&this.currentDataView.matrix.rows)for(var te=0,G=this.currentDataView.matrix.rows.levels.length;te<G;te++){var re=this.currentDataView.matrix.rows.levels[te];1===re.sources.length&&(ce=re.sources[0].queryName)&&(this.columnWidthObjects[ce]={queryName:ce,width:void 0,isFixed:!1})}if(this.matrixLeafNodes)for(te=0,G=this.matrixLeafNodes.length;te<G;te++){var ce;(ce=this.matrixLeafNodes[te].queryName)&&(this.columnWidthObjects[ce]={queryName:ce,width:void 0,isFixed:!1})}},le.prototype.updateTablixColumnWidths=function(){var te=this.currentDataView&&this.currentDataView.metadata&&this.currentDataView.metadata.columns;if(te){if(this.shouldClearAllColumnWidths())return void this.autoSizeAllColumns();this.deserializeColumnsWidth(te)}},le.prototype.autoSizeAllColumns=function(){for(var te in this.columnWidthObjects)this.visualObjectInstancesToPersist.remove.push(this.generateColumnWidthObjectToPersist(te,void 0));this.callHostToPersist()},le.prototype.deserializeColumnsWidth=function(te){for(var G in this.columnWidthObjects)this.columnWidthObjects[G].isFixed=!this.currentAutoColumnSizePropertyValue,this.columnWidthObjects[G].width=void 0;for(var re=0,ce=te.length;re<ce;re++){var o=te[re],S=o.queryName,l=(0,U.NA)(o.objects,le.columnWidthProp);this.columnWidthObjects.hasOwnProperty(S)&&null!=l&&(this.columnWidthObjects[S].width=l,this.columnWidthObjects[S].isFixed=!0)}},le.prototype.shouldClearAllColumnWidths=function(){return null!=this.previousDataView&&!1===this.previousAutoColumnSizePropertyValue&&null!=this.currentDataView&&!0===this.currentAutoColumnSizePropertyValue},le.getColumnQueryName=function(te){var G=te.getTablixCell();switch(G.type){case 0:return null==G.item||null==G.item.metadata?void 0:G.item.metadata.queryName;case 2:return I.fF.assert(function(){return null!=G.item},"Tablix Column without a ColumnMetadata"),G.item.queryName;default:return void I.fF.assertFail("getColumnQueryName called with cellType: "+G.type)}},le.prototype.getColumnWidthObjects=function(){return this.columnWidthObjects},le.prototype.getFixedColumnWidthObjects=function(){var te={};for(var G in this.columnWidthObjects){var re=this.columnWidthObjects[G];re.isFixed&&(te[G]=re)}return te},le.prototype.getPersistedColumnWidth=function(te){var G=this.columnWidthObjects[te];return G&&G.width},le.prototype.callHostToPersist=function(){this.hostPersistCallBack&&this.hostPersistCallBack(this.visualObjectInstancesToPersist),this.visualObjectInstancesToPersist={merge:[],remove:[]}},le.prototype.onColumnWidthChanged=function(te,G){if(null!=te&&null!=this.columnWidthObjects[te]){var re=this.columnWidthObjects[te];-1===G?(re.width=void 0,re.isFixed=!this.currentAutoColumnSizePropertyValue,this.visualObjectInstancesToPersist.remove.push(this.generateColumnWidthObjectToPersist(re.queryName,void 0)),this.callHostToPersist()):(re.width=G,re.isFixed=!0,this.visualObjectInstancesToPersist.merge.push(this.generateColumnWidthObjectToPersist(te,G)),this.callHostToPersist())}},le.prototype.onColumnsRendered=function(te){for(var G={},re=0,ce=te.length;re<ce;re++){var S=te[re].width;null==G[o=te[re].queryName]?G[o]={queryName:o,width:S,isFixed:!1}:S>G[o].width&&(G[o].width=S)}var l=!1;for(var o in this.columnWidthObjects)if(G[o]){var u=this.columnWidthObjects[o];u.isFixed&&null==u.width&&(u.width=G[o].width,this.visualObjectInstancesToPersist.merge.push(this.generateColumnWidthObjectToPersist(o,u.width)),l=!0)}return l&&this.callHostToPersist(),l},le.prototype.generateColumnWidthObjectToPersist=function(te,G){return{selector:{metadata:te},objectName:"general",properties:{columnWidth:G}}},le.columnWidthProp={objectName:"general",propertyName:"columnWidth"},le}()},93414:function(Fe,me,E){E.d(me,{d:function(){return q},L:function(){return k}});var V=E(64329),I=E(93340),U=E(71090),oe=E(81337),j=E(62458),le=E(44102),te=function(){function y(d){this._scrollStep=.1,this._owner=d,this._hierarchyNavigator=d.hierarchyNavigator,this._binder=d.getBinder(),this._tablixLayoutManager=d.layoutManager,this.scrollOffset=0}return y.prototype._onStartRenderingIteration=function(){this.updateScrollPosition()},y.prototype._onEndRenderingIteration=function(){},y.prototype.getValidScrollOffset=function(d){return Math.min(Math.max(d,0),Math.max(this.getItemsCount()-this._scrollStep,0))},y.prototype.makeScrollOffsetValid=function(){this.scrollOffset=this.getValidScrollOffset(this.scrollOffset)},y.prototype.getIntegerScrollOffset=function(){return Math.floor(this.scrollOffset)},y.prototype.getFractionScrollOffset=function(){return this.scrollOffset-this.getIntegerScrollOffset()},Object.defineProperty(y.prototype,"scrollbar",{get:function(){return this._scrollbar},enumerable:!1,configurable:!0}),y.prototype.getFirstVisibleItem=function(d){return this._scrollItems[d]},y.prototype.getFirstVisibleChild=function(d){return this._hierarchyNavigator.getAt(this._hierarchyNavigator.getChildren(d),this.getFirstVisibleChildIndex(d))},y.prototype.getFirstVisibleChildIndex=function(d){var i=this.getFirstVisibleItem(this._hierarchyNavigator.getLevel(d)+1);return void 0===i||void 0!==i&&this._hierarchyNavigator.getParent(i)!==d?0:this._hierarchyNavigator.getIndex(i)},y.prototype._initializeScrollbar=function(d,i,h){var c=this;this._scrollbar=this._createScrollbar(d,h),this._scrollbar._onscroll.push(function(z){return c.onScroll()})},y.prototype.getItemsCount=function(){return this.model?this._hierarchyNavigator.getLeafCount(this.model):0},y.prototype.getDepth=function(){return this.modelDepth},y.prototype.onScroll=function(){this.scrollOffset=this._scrollbar.viewMin,this._owner._onScrollAsync(this)},Object.defineProperty(y.prototype,"otherDimension",{get:function(){return this._otherDimension},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"layoutManager",{get:function(){return this._layoutManager},enumerable:!1,configurable:!0}),y.prototype._createScrollbar=function(d,i){return j.fF.assertFail("PureVirtualMethod: TablixDimension._createScrollbar"),null},y.prototype.updateScrollPosition=function(){if(this._scrollItems=[],this.model){var d=this.getIntegerScrollOffset(),i=this._hierarchyNavigator.getLeafAt(this.model,d);if(i)do{this._scrollItems[this._hierarchyNavigator.getLevel(i)]=i,i=this._hierarchyNavigator.getParent(i)}while(null!==i)}},y}(),G=function(y){function d(i){var h=y.call(this,i)||this;return h._layoutManager=h._tablixLayoutManager.rowLayoutManager,h._footer=null,h}return(0,oe.__extends)(d,y),d.prototype.setFooter=function(i){this._footer=i,this._owner.updateFooterVisibility()},d.prototype.hasFooter=function(){return null!==this._footer},d.prototype._render=function(){var i=this.getFirstVisibleItem(0);this.hasFooter()&&(this.addFooterRowHeader(this._footer),this.addFooterBodyCells(this._footer)),void 0!==i&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(i))},d.prototype._createScrollbar=function(i,h){return new le.AT(i,h)},d.prototype.addNodes=function(i,h,c,z){for(var P=this._hierarchyNavigator.getCount(i),L=z;L<P;L++){if(!this._layoutManager.needsToRealize)return;var A=this._hierarchyNavigator.getAt(i,L);h+=this.addNode(A,i,h,c).rowSpan}},d.prototype.getFirstVisibleChildLeaf=function(i){for(var h=i;!this._hierarchyNavigator.isLeaf(h);)h=this.getFirstVisibleChild(h);return h},d.prototype.bindRowHeader=function(i,h){this._binder.bindRowHeader(i,h)},d.prototype.addNode=function(i,h,c,z){var P,L=this._tablixLayoutManager.getOrCreateRowHeader(i,h,c,this._hierarchyNavigator.getLevel(i)),A=this.rowHeaderMatch(i,L);return A||(this._owner._unbindCell(L),L.type=1,L.item=i),this._hierarchyNavigator.isLeaf(i)?(L.colSpan=z-this._hierarchyNavigator.getLevel(i),L.rowSpan=1,A||this.bindRowHeader(i,L),this._tablixLayoutManager.onRowHeaderRealized(i,L),this.addBodyCells(i,h,c)):(P=this._layoutManager.getRealizedItemsCount(),this.addNodes(this._hierarchyNavigator.getChildren(i),c,z,this.getFirstVisibleChildIndex(i)),L.colSpan=1,L.rowSpan=this._layoutManager.getRealizedItemsCount()-P+1,A||this.bindRowHeader(i,L),this._tablixLayoutManager.onRowHeaderRealized(i,L)),L},d.prototype.rowHeaderMatch=function(i,h){var c=h.item;return 1===h.type&&c&&this._hierarchyNavigator.headerItemEquals(i,c)},d.prototype.addBodyCells=function(i,h,c){for(var z=this._otherDimension.getIntegerScrollOffset(),P=this._otherDimension._layoutManager.getRealizedItemsCount()-this.getDepth(),L=this._hierarchyNavigator,A=this._otherDimension.model,Q=this._tablixLayoutManager,J=0;J<P;J++){var de=L.getIntersection(i,L.getLeafAt(A,z+J)),ae=Q.getOrCreateBodyCell(de,i,h,c,J);this.bindBodyCell(de,ae),Q.onBodyCellRealized(de,ae)}},d.prototype.bindBodyCell=function(i,h){this.bodyCelMatch(i,h)||(this._owner._unbindCell(h),h.type=3,h.item=i,this._binder.bindBodyCell(i,h))},d.prototype.addFooterRowHeader=function(i){var h=this._tablixLayoutManager.getOrCreateFooterRowHeader(i,this.model);h.colSpan=this.getDepth(),this.rowHeaderMatch(i,h)||(this._owner._unbindCell(h),h.type=1,h.item=i,this.bindRowHeader(i,h),this._tablixLayoutManager.onRowHeaderFooterRealized(i,h))},d.prototype.addFooterBodyCells=function(i){for(var h=this._otherDimension.getIntegerScrollOffset(),c=this._otherDimension.layoutManager.getRealizedItemsCount()-this.getDepth(),z=this._tablixLayoutManager,P=0;P<c;P++){var L=this._hierarchyNavigator.getLeafAt(this._otherDimension.model,h+P),A=this._hierarchyNavigator.getIntersection(i,L),Q=z.getOrCreateFooterBodyCell(A,P);this.bindBodyCell(A,Q),z.onBodyCellFooterRealized(A,Q)}},d.prototype.bodyCelMatch=function(i,h){var c=h.item;return 3===h.type&&c&&this._hierarchyNavigator.bodyCellItemEquals(i,c)},d}(te),re=function(y){function d(i){var h=y.call(this,i)||this;return h._layoutManager=h._tablixLayoutManager.columnLayoutManager,h}return(0,oe.__extends)(d,y),d.prototype._render=function(){var i=this.getFirstVisibleItem(0);void 0!==i&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(i))},d.prototype._createScrollbar=function(i,h){var c=new le.Xg(i,h);return c.smallIncrement=.2,c},d.prototype.addNodes=function(i,h,c,z){for(var P=this._hierarchyNavigator.getCount(i),L=z;L<P;L++){if(!this._layoutManager.needsToRealize)return;h+=this.addNode(this._hierarchyNavigator.getAt(i,L),i,h,c).colSpan}},d.prototype.addNode=function(i,h,c,z){var P=this._tablixLayoutManager.getOrCreateColumnHeader(i,h,this._hierarchyNavigator.getLevel(i),c),L=this.columnHeaderMatch(i,P);if(L||(this._owner._unbindCell(P),P.type=2,P.item=i),this._hierarchyNavigator.isLeaf(i))P.rowSpan=z-this._hierarchyNavigator.getLevel(i);else{var A=this._layoutManager.getRealizedItemsCount();this.addNodes(this._hierarchyNavigator.getChildren(i),c,z,this.getFirstVisibleChildIndex(i));var Q=this._hierarchyNavigator.getChildrenLevelDifference(i);P.rowSpan=Q===1/0?1:Q,P.colSpan=this._layoutManager.getRealizedItemsCount()-A+1}return L||this._binder.bindColumnHeader(i,P),this._tablixLayoutManager.onColumnHeaderRealized(i,P),P},d.prototype.columnHeaderMatch=function(i,h){var c=h.item;return!this._owner.wordWrapColumnHeaders&&2===h.type&&c&&this._hierarchyNavigator.headerItemEquals(i,c)},d}(te),ce=function(){function y(d,i){this.x=d||0,this.y=i||0}return y.prototype.offset=function(d,i){this.x+=d,this.y+=i},y}(),o=function(y){function d(i,h,c,z){var P=y.call(this,i,h)||this;return P.width=c||0,P.height=z||0,P}return(0,oe.__extends)(d,y),Object.defineProperty(d.prototype,"point",{get:function(){return new ce(this.x,this.y)},enumerable:!1,configurable:!0}),d.prototype.contains=function(i){return d.contains(this,i)},d.contains=function(i,h){return!(!h||d.isEmpty(i))&&i.x<=h.x&&h.x<i.x+i.width&&i.y<=h.y&&h.y<i.y+i.height},d.isEmpty=function(i){return!(void 0!==i&&i.width>=0&&i.height>=0)},d}(ce),S=function(y){return y[y.NoClick=0]="NoClick",y[y.LeftClick=1]="LeftClick",y[y.RightClick=2]="RightClick",y[y.CenterClick=3]="CenterClick",y}({}),l=function(){function y(d,i,h,c,z){this._x=d,this._y=i,this.isMouseButtonDown=h,this._dx=c||0,this._dy=z||0}return Object.defineProperty(y.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"dx",{get:function(){return this._dx},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"dy",{get:function(){return this._dy},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isMouseDown",{get:function(){return this.isMouseButtonDown},enumerable:!1,configurable:!0}),y}(),u=function(){function y(){this.touchList=[],this.swipeDirection=2,this.matchingDirectionCount=0,this.lockThreshold=!0,this.scrollThreshold=!0,this.lastTouchEvent=new l(0,0,!1)}return Object.defineProperty(y.prototype,"lastEvent",{get:function(){return this.lastTouchEvent},enumerable:!1,configurable:!0}),y.prototype.addTouchRegion=function(d,i,h){var c={lastPoint:new l(0,0,!1),handler:i,region:d,converter:h};this.touchList=this.touchList.concat([c])},y.prototype.upAllTouches=function(){var d,i;i=this.touchList.length;for(var h=0;h<i;h++)this.touchList[h].lastPoint.isMouseDown&&(d=this.touchList[h].converter.getPixelToItem(this.touchList[h].lastPoint.x,this.touchList[h].lastPoint.y,0,0,!1),this.touchList[h].handler.touchEvent(d)),this.touchList[h].lastPoint=new l(this.touchList[h].lastPoint.x,this.touchList[h].lastPoint.y,!1);this.lastTouchEvent=new l(0,0,!1)},y.prototype.touchEvent=function(d){var i,h,c=0,z=0,P=0,L=0,A=0,Q=null;i=this._getActive(),!this.lastTouchEvent.isMouseDown&&d.isMouseDown&&(i=this._findRegions(d)),this.lastTouchEvent=new l(d.x,d.y,d.isMouseDown,P=this.lastTouchEvent.x-d.x,L=this.lastTouchEvent.y-d.y),h=i.length;for(var J=0;J<h;J++)c=d.x-i[J].region.point.x,z=d.y-i[J].region.point.y,i[J].lastPoint.isMouseDown&&d.isMouseDown?(P=c-i[J].lastPoint.x,L=z-i[J].lastPoint.y,A=Math.abs(180/Math.PI*Math.atan(L/P)),this.scrollThreshold&&(this.lockThreshold&&this.matchingDirectionCount>5?1===this.swipeDirection?L=0:0===this.swipeDirection&&(P=0):A<20?(L=0,1===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=1)):(A=Math.abs(180/Math.PI*Math.atan(P/L)))<20?(P=0,0===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=0)):2===this.swipeDirection?this.matchingDirectionCount++:(this.swipeDirection=2,this.matchingDirectionCount=1))):(P=0,L=0,this.swipeDirection=2,this.matchingDirectionCount=0),i[J].lastPoint=new l(c,z,d.isMouseDown,P,L),Q=i[J].converter.getPixelToItem(c,z,P,L,d.isMouseDown),i[J].handler.touchEvent(Q)},y.prototype._findRegions=function(d){var h,i=[];h=this.touchList.length;for(var c=0;c<h;c++)this.touchList[c].region.contains(new ce(d.x,d.y))&&(i=i.concat([this.touchList[c]]));return i},y.prototype._getActive=function(){var i,d=[];i=this.touchList.length;for(var h=0;h<i;h++)this.touchList[h].lastPoint.isMouseDown&&(d=d.concat([this.touchList[h]]));return d},y}(),x=function(){function y(d){this.manager=d,this.touchPanel=null,this.scale=1,this.documentCallbacksWrapper=null,this.panelCallbacksWrapper=null,this.sliding=!1}return y.prototype.initTouch=function(d,i){d.style.setProperty("-ms-touch-action","pinch-zoom"),this.touchReferencePoint=i,this.touchPanel=d,this.startTouchPanelEvents()},y.prototype.startTouchPanelEvents=function(){var d=this;"ontouchmove"in this.touchPanel&&(this.panelCallbacksWrapper={startCallback:function(h){return d.onTouchStart(h)},endCallback:function(h){return d.onTouchEnd(h)}},this.touchPanel.addEventListener("touchstart",this.panelCallbacksWrapper.startCallback),this.touchPanel.addEventListener("touchend",this.panelCallbacksWrapper.endCallback))},y.prototype.clearTouchPanelEvents=function(){null!==this.panelCallbacksWrapper&&("ontouchmove"in this.touchPanel&&(this.touchPanel.removeEventListener("touchstart",this.panelCallbacksWrapper.startCallback),this.touchPanel.removeEventListener("touchend",this.panelCallbacksWrapper.endCallback)),this.panelCallbacksWrapper=null)},y.prototype.getXYByClient=function(d,i,h){var c=h.left,z=h.top;void 0!==window.scrollX&&(c+=window.scrollX,z+=window.scrollY);var P=new ce(0,0);return P.offset(d-c,i-z),P},y.prototype.onTouchStart=function(d){if(1===d.touches.length){d.cancelBubble=!0;var i=d.touches[0];this.touchStartTime=(new Date).getTime(),this.touchStartPageY=i.pageY,this.onTouchMouseDown(i)}},y.prototype.onTouchMove=function(d){if(1===d.touches.length){d.preventDefault&&d.preventDefault();var i=d.touches[0];this.touchLastPageY=i.pageY,this.touchLastPageX=i.pageX,this.sliding||this.onTouchMouseMove(i)}},y.prototype.onTouchEnd=function(d){this.clearTouchDocumentEvents();var i=this.getSwipeInfo();this.didUserSwipe(i)?this.startSlideAffect(i):this.sliding||this.upAllTouches()},y.prototype.onTouchMouseDown=function(d){this.scale=(0,I.df)(this.touchPanel),document.getSelection().removeAllRanges(),this.rect=(this.touchReferencePoint?this.touchReferencePoint:this.touchPanel).getBoundingClientRect(),this.startTouchDocumentEvents()},y.prototype.startTouchDocumentEvents=function(){var d=this;"ontouchmove"in this.touchPanel&&(this.documentCallbacksWrapper={moveCallback:function(h){return d.onTouchMove(h)},endCallback:function(h){return d.onTouchEnd(h)}},document.addEventListener("touchend",this.documentCallbacksWrapper.endCallback),document.addEventListener("touchmove",this.documentCallbacksWrapper.moveCallback))},y.prototype.onTouchMouseMove=function(d){var i,h,c=this.rect,z=null!==c&&d.which!==S.NoClick;!z||this.sliding||(h=this.getXYByClient(d.pageX,d.pageY,c),i=new l(h.x/this.scale,h.y/this.scale,z),this.manager.touchEvent(i),d.preventDefault?d.preventDefault():"returnValue"in d&&(d.returnValue=!1))},y.prototype.getSwipeInfo=function(){var d=(new Date).getTime(),h=this.touchLastPageY-this.touchStartPageY;return{direction:h<0?-1:1,distance:h,endTime:d,time:d-this.touchStartTime}},y.prototype.didUserSwipe=function(d){return d.time<600&&d.distance*d.direction>80},y.prototype.startSlideAffect=function(d){var i=this;if(!this.sliding&&null!==this.rect){this.sliding=!0;var h=this.getXYByClient(this.touchLastPageX,this.touchLastPageY,this.rect);this.slide(h,300,d),requestAnimationFrame(function(){i.didUserChangeDirection(d)||i.slide(h,200,d),i.clearSlide()})}},y.prototype.didUserChangeDirection=function(d){return!(this.touchStartTime<=d.endTime)&&(this.touchLastPageY-this.touchStartPageY<0?-1:1)!==d.direction},y.prototype.slide=function(d,i,h){d.y+=i*h.direction+(this.touchStartTime>h.endTime?this.touchLastPageY-this.touchStartPageY:0);var z=new l(d.x/this.scale,d.y/this.scale,!0);this.manager.touchEvent(z)},y.prototype.clearSlide=function(){this.sliding=!1,this.upAllTouches()},y.prototype.upAllTouches=function(){null===this.documentCallbacksWrapper&&(this.rect=null,this.manager.upAllTouches())},y.prototype.clearTouchDocumentEvents=function(){null!==this.documentCallbacksWrapper&&("ontouchmove"in this.touchPanel&&(document.removeEventListener("touchmove",this.documentCallbacksWrapper.moveCallback),document.removeEventListener("touchend",this.documentCallbacksWrapper.endCallback)),this.documentCallbacksWrapper=null)},y.prototype.clearAllTouchEvents=function(){this.clearTouchDocumentEvents(),this.clearTouchPanelEvents()},y}(),D=function(){function y(d){this.dim=d,this.averageSize=1,this.handlers=null,this.tablixControl=null}return Object.defineProperty(y.prototype,"dimension",{get:function(){return this.dim},enumerable:!1,configurable:!0}),y.prototype.setScrollDensity=function(d){this.averageSize=d},y.prototype.resize=function(d,i,h,c){this.dim.x=d,this.dim.y=i,this.dim.width=h,this.dim.height=c},y.prototype.getPixelToItem=function(d,i,h,c,z){return new l(d*this.averageSize,0,z,-h*this.averageSize,0)},y.prototype.touchEvent=function(d){var i=[];i[0]=this.tablixControl,i[1]=d.dx,i[2]=d.dy,this.handlers&&(0,le.fw)([this.handlers],i)},y.prototype.setHandler=function(d,i){this.handlers=i,this.tablixControl=d},y}(),X=function(){function y(d){this.dim=d,this.averageSize=30,this.handlers=null,this.tablixControl=null}return Object.defineProperty(y.prototype,"dimension",{get:function(){return this.dim},enumerable:!1,configurable:!0}),y.prototype.setScrollDensity=function(d){this.averageSize=d},y.prototype.resize=function(d,i,h,c){this.dim.x=d,this.dim.y=i,this.dim.width=h,this.dim.height=c},y.prototype.getPixelToItem=function(d,i,h,c,z){return new l(0,i*this.averageSize,z,0,-c*this.averageSize)},y.prototype.touchEvent=function(d){var i=[];i[0]=this.tablixControl,i[1]=d.dx,i[2]=d.dy,this.handlers&&(0,le.fw)([this.handlers],i)},y.prototype.setHandler=function(d,i){this.handlers=i,this.tablixControl=d},y}(),K=function(){function y(d){this.dim=d,this.averageSizeX=y.DefaultAverageSizeX,this.averageSizeY=y.DefaultAverageSizeY,this.handlers=null,this.tablixControl=null}return Object.defineProperty(y.prototype,"dimension",{get:function(){return this.dim},enumerable:!1,configurable:!0}),y.prototype.setScrollDensity=function(d,i){this.averageSizeX=d,this.averageSizeY=i},y.prototype.resize=function(d,i,h,c){var z=this.dim;z.x=d,z.y=i,z.width=h,z.height=c},y.prototype.getPixelToItem=function(d,i,h,c,z){return new l(d*this.averageSizeX,i*this.averageSizeY,z,-h*this.averageSizeX,-c*this.averageSizeY)},y.prototype.touchEvent=function(d){this.handlers&&(0,le.fw)([this.handlers],[this.tablixControl,d.dx,d.dy])},y.prototype.setHandler=function(d,i){this.handlers=i,this.tablixControl=d},y.DefaultAverageSizeX=30,y.DefaultAverageSizeY=30,y}(),k=V.Gj,q=function(){function y(d,i,h,c,z){var P=this;this.scrollBarElementWidth=9,this.options=z;var L=z.interactive;this.isTouchEnabled=L&&z.enableTouchSupport,this.mainDiv=(0,I.wC)(),this.mainDiv.classList.add(y.TablixTableAreaClassName),this.footerDiv=(0,I.wC)(),this.footerDiv.classList.add(y.TablixFooterClassName),this.gridDimensions={},this.containerElement=(0,I.wC)(),this.className=i.getTablixClassName(),this.autoSizeWidth=!1,this.autoSizeHeight=!1,this.fontFamily=U.dG,this.fontColor=U.ye,this.fontSize=z.fontSize,c.className=y.TablixContainerClassName,c.appendChild(this.containerElement),this.containerElement.addEventListener("wheel",function(A){P.onWheel(A)}),this.containerElement.appendChild(this.mainDiv),this.containerElement.appendChild(this.footerDiv),this.isTouchEnabled&&(this.InitializeTouchSupport(),this.bindTouchEvents()),this.controlLayoutManager=i,this.controlLayoutManager.initialize(this),this.hierarchyTablixNavigator=d,this.binder=h,this.columnDim=new re(this),this.rowDim=new G(this),this.columnDim._otherDimension=this.rowDimension,this.rowDim._otherDimension=this.columnDimension,this.InitializeScrollbars(),L||(this.scrollbarWidth=0),this.updateHorizontalPosition(),this.updateVerticalPosition(),this.updateFooterVisibility(),this.lastRenderingArgs={}}return y.prototype.InitializeTouchSupport=function(){this.isTouchEventsBound=!1,this.touchManager=new u,this.touchInterpreter=new x(this.touchManager),this.footerTouchInterpreter=new x(this.touchManager),this.columnTouchDelegate=new D(new o),this.rowTouchDelegate=new X(new o),this.bodyTouchDelegate=new K(new o),this.footerTouchDelegate=new D(new o),this.columnTouchDelegate.setHandler(this,this.onTouchEvent),this.rowTouchDelegate.setHandler(this,this.onTouchEvent),this.bodyTouchDelegate.setHandler(this,this.onTouchEvent),this.footerTouchDelegate.setHandler(this,this.onTouchEvent),this.touchManager.addTouchRegion(this.columnTouchDelegate.dimension,this.columnTouchDelegate,this.columnTouchDelegate),this.touchManager.addTouchRegion(this.rowTouchDelegate.dimension,this.rowTouchDelegate,this.rowTouchDelegate),this.touchManager.addTouchRegion(this.bodyTouchDelegate.dimension,this.bodyTouchDelegate,this.bodyTouchDelegate),this.touchManager.addTouchRegion(this.footerTouchDelegate.dimension,this.footerTouchDelegate,this.footerTouchDelegate)},y.prototype.unBindTouchEvents=function(){this.isTouchEventsBound&&(this.touchInterpreter.clearAllTouchEvents(),this.footerTouchInterpreter.clearAllTouchEvents(),this.isTouchEventsBound=!1)},y.prototype.bindTouchEvents=function(){this.isTouchEventsBound||(this.touchInterpreter.initTouch(this.mainDiv,null),this.footerTouchInterpreter.initTouch(this.footerDiv,this.mainDiv),this.isTouchEventsBound=!0)},y.prototype.InitializeScrollbars=function(){this.rowDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var d=this.rowDim.scrollbar.element.style;d.position="absolute",d.top="0"+y.UnitOfMeasurement,d.right="0"+y.UnitOfMeasurement,this.rowDim.scrollbar.width=this.scrollBarElementWidth+y.UnitOfMeasurement,this.rowDim.scrollbar.show(!0),this.columnDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var i=this.columnDim.scrollbar.element.style;i.position="absolute",i.left="0"+y.UnitOfMeasurement,i.bottom="0"+y.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+y.UnitOfMeasurement,this.columnDim.scrollbar.show(!1)},y.prototype.toggleTouchBindings=function(d){this.isTouchEnabled&&(d?this.bindTouchEvents():this.unBindTouchEvents())},Object.defineProperty(y.prototype,"container",{get:function(){return this.containerElement},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"contentHost",{get:function(){return this.mainDiv},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"footerHost",{get:function(){return this.footerDiv},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"className",{set:function(i){this.containerElement.className=i},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"hierarchyNavigator",{get:function(){return this.hierarchyTablixNavigator},enumerable:!1,configurable:!0}),y.prototype.getBinder=function(){return this.binder},Object.defineProperty(y.prototype,"autoSizeWidth",{get:function(){return this._autoSizeWidth},set:function(i){this._autoSizeWidth=i,i||(this.containerElement.style.minWidth=this.containerElement.style.maxWidth="none")},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"autoSizeHeight",{get:function(){return this._autoSizeHeight},set:function(i){i||(this.containerElement.style.minHeight=this.containerElement.style.maxHeight="none")},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"maxWidth",{get:function(){return this.maximumWidth},set:function(i){this.maximumWidth=i,this.containerElement.style.maxWidth=this.maximumWidth+y.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"viewport",{get:function(){return this.viewPort},set:function(i){this.viewPort=i,this.containerElement.style.width=this.viewPort.width+y.UnitOfMeasurement,this.containerElement.style.height=this.viewPort.height+y.UnitOfMeasurement,this.rowDim.scrollbar.invalidateArrange(),this.columnDim.scrollbar.invalidateArrange(),this.controlLayoutManager.updateViewport(this.viewPort)},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"maxHeight",{get:function(){return this.maximumHeight},set:function(i){this.maximumHeight=i,this.containerElement.style.maxHeight=this.maximumHeight+y.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"minWidth",{get:function(){return this.minimumWidth},set:function(i){this.minimumWidth=i,this.containerElement.style.minWidth=this.minimumWidth+y.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"minHeight",{get:function(){return this.minimumHeight},set:function(i){this.minimumHeight=i,this.containerElement.style.minHeight=this.minimumHeight+y.UnitOfMeasurement},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"fontSize",{get:function(){return this.textFontSize},set:function(i){this.textFontSize=i||y.DefaultFontSize,this.containerElement.style.fontSize=this.textFontSize},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"fontFamily",{get:function(){return this.textFontFamily},set:function(i){this.textFontFamily=i,this.containerElement.style.fontFamily=i},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"fontColor",{get:function(){return this.textFontColor},set:function(i){this.textFontColor=i,this.containerElement.style.color=i},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"scrollbarWidth",{set:function(i){this.scrollBarElementWidth=i,this.rowDim.scrollbar.width=this.scrollBarElementWidth+y.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+y.UnitOfMeasurement},enumerable:!1,configurable:!0}),y.prototype.getIsTouchEventsBound=function(){return!!this.isTouchEventsBound},y.prototype.updateModels=function(d,i,h){this.rowDim.model=i,this.rowDim.modelDepth=this.hierarchyNavigator.getRowHierarchyDepth(),this.columnDim.model=h,this.columnDim.modelDepth=this.hierarchyNavigator.getColumnHierarchyDepth(),d&&(this.rowDim.scrollOffset=0,this.columnDim.scrollOffset=0),this.layoutManager.updateColumnCount(this.rowDim,this.columnDim)},y.prototype.updateColumnDimensions=function(d,i,h){var c=this.gridDimensions;c.columnCount=h,c.rowHierarchyWidth=d,c.columnHierarchyWidth=i},y.prototype.updateRowDimensions=function(d,i,h,c,z){var P=this.gridDimensions;P.rowCount=c,P.rowHierarchyHeight=i,P.rowHierarchyContentHeight=h,P.columnHierarchyHeight=d,P.footerHeight=z},y.prototype.updateTouchDimensions=function(){var d=this.gridDimensions;this.columnTouchDelegate.resize(d.rowHierarchyWidth,0,d.columnHierarchyWidth,d.columnHierarchyHeight),this.columnTouchDelegate.setScrollDensity(d.columnCount/d.columnHierarchyWidth),this.rowTouchDelegate.resize(0,d.columnHierarchyHeight,d.rowHierarchyWidth,d.rowHierarchyHeight),this.rowTouchDelegate.setScrollDensity(d.rowCount/d.rowHierarchyHeight),this.bodyTouchDelegate.resize(d.rowHierarchyWidth,d.columnHierarchyHeight,d.columnHierarchyWidth,d.rowHierarchyHeight),this.bodyTouchDelegate.setScrollDensity(d.columnCount/d.columnHierarchyWidth,d.rowCount/d.rowHierarchyHeight),this.footerTouchDelegate.resize(d.rowHierarchyWidth,d.columnHierarchyHeight+d.rowHierarchyHeight,d.columnHierarchyWidth,d.footerHeight),this.footerTouchDelegate.setScrollDensity(d.columnCount/d.columnHierarchyWidth)},y.prototype.onWheel=function(d){this.determineDimensionToScroll(d,function(i,h){i.scrollbar.onMouseWheel(-1*h)}),0===this.options.layoutKind&&d.preventDefault()},y.prototype.determineDimensionToScroll=function(d,i){this.rowDim.scrollbar.visible?(d.deltaY&&i(this.rowDim,d.deltaY),d.deltaX&&this.columnDim.scrollbar.visible&&i(this.columnDim,d.deltaX)):this.columnDim.scrollbar.visible&&(d.deltaX?i(this.columnDim,d.deltaX):d.deltaY&&i(this.columnDim,d.deltaY))},Object.defineProperty(y.prototype,"layoutManager",{get:function(){return this.controlLayoutManager},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"columnDimension",{get:function(){return this.columnDim},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"rowDimension",{get:function(){return this.rowDim},enumerable:!1,configurable:!0}),y.prototype.refresh=function(d){this.render(d,null)},y.prototype._onScrollAsync=function(d){var i=this;requestAnimationFrame(function(){i.performPendingScroll(d)})},y.prototype.performPendingScroll=function(d){this.render(!1,d)},y.prototype.updateHorizontalPosition=function(){this.rowDim.scrollbar.visible?(this.columnDim.scrollbar.element.style.right=this.scrollBarElementWidth+y.UnitOfMeasurement,this.footerDiv.style.right=this.scrollBarElementWidth+y.UnitOfMeasurement,this.mainDiv.style.right=this.scrollBarElementWidth+y.UnitOfMeasurement):(this.columnDim.scrollbar.element.style.right="0"+y.UnitOfMeasurement,this.mainDiv.style.right="0"+y.UnitOfMeasurement,this.footerDiv.style.right="0"+y.UnitOfMeasurement)},y.prototype.updateFooterVisibility=function(){(this.rowDim.hasFooter()?"block"!==this.footerDiv.style.display:"none"!==this.footerDiv.style.display)&&(this.footerDiv.style.display=this.rowDim.hasFooter()?"block":"none")},y.prototype.updateVerticalPosition=function(){var d=this.rowDim.scrollbar.visible,i=1===this.controlLayoutManager.getLayoutKind();if(d||i){var c=this.footerDiv.offsetHeight,z=0,P=0;this.columnDim.scrollbar.visible&&(c+=this.scrollBarElementWidth,z+=this.scrollBarElementWidth,P=this.scrollBarElementWidth),this.mainDiv.style.bottom=c+y.UnitOfMeasurement,this.rowDim.scrollbar.element.style.bottom=P+y.UnitOfMeasurement,this.footerDiv.style.bottom=z+y.UnitOfMeasurement,this.footerDiv.style.removeProperty("top")}else this.footerDiv.style.top=this.gridDimensions.rowHierarchyContentHeight+y.UnitOfMeasurement,this.footerDiv.style.removeProperty("bottom"),this.mainDiv.style.removeProperty("bottom")},y.prototype.alreadyRendered=function(d){return!(d!==this.lastRenderingArgs.scrollingDimension||this.rowDimension.scrollOffset!==this.lastRenderingArgs.rowScrollOffset||this.columnDimension.scrollOffset!==this.lastRenderingArgs.columnScrollOffset)},y.prototype.render=function(d,i){if(this.columnDim.makeScrollOffsetValid(),this.rowDim.makeScrollOffsetValid(),d||null===i)this.lastRenderingArgs={};else if(this.alreadyRendered(i))return;var h=!1;this.renderIterationCount=0,this.controlLayoutManager.onStartRenderingSession(i,this.mainDiv,d);var c=this.binder;c.onStartRenderingSession();for(var z=this.gridDimensions.footerHeight,P=this.gridDimensions.rowHierarchyHeight,L=this.gridDimensions.rowHierarchyContentHeight;!h&&this.renderIterationCount<y.MaxRenderIterationCount;){var A=this.columnDim.scrollbar.visible,Q=this.rowDim.scrollbar.visible;this.columnDim._onStartRenderingIteration(),this.rowDim._onStartRenderingIteration(),this.controlLayoutManager.onStartRenderingIteration(d),this.renderCorner(),this.columnDim._render(),this.rowDim._render(),h=this.controlLayoutManager.onEndRenderingIteration(),this.columnDim._onEndRenderingIteration(),this.rowDim._onEndRenderingIteration(),A!==this.columnDim.scrollbar.visible&&this.updateVerticalPosition(),Q!==this.rowDim.scrollbar.visible&&this.updateHorizontalPosition(),this.renderIterationCount++}this.controlLayoutManager.onEndRenderingSession(),c.onEndRenderingSession(),this.isTouchEnabled&&this.updateTouchDimensions(),this.lastRenderingArgs.rowScrollOffset=this.rowDimension.scrollOffset,this.lastRenderingArgs.columnScrollOffset=this.columnDimension.scrollOffset,this.updateContainerDimensions();var J=this.lastRenderingArgs;J.rowScrollOffset=this.rowDimension.scrollOffset,J.columnScrollOffset=this.columnDimension.scrollOffset,J.scrollingDimension=i,(z!==this.gridDimensions.footerHeight||P!==this.gridDimensions.rowHierarchyHeight||L!==this.gridDimensions.rowHierarchyContentHeight)&&this.updateVerticalPosition(),this.options.interactive&&(this.columnDim.scrollbar.refresh(),this.rowDim.scrollbar.refresh())},y.prototype.updateContainerDimensions=function(){var d=this.gridDimensions;this._autoSizeWidth&&(this.containerElement.style.width=d.rowHierarchyWidth+d.columnHierarchyWidth+(this.rowDim.scrollbar.visible?this.scrollBarElementWidth:0)+y.UnitOfMeasurement),this._autoSizeHeight&&(this.containerElement.style.height=d.columnHierarchyHeight+d.rowHierarchyHeight+d.footerHeight+(this.columnDim.scrollbar.visible?this.scrollBarElementWidth:0)+y.UnitOfMeasurement)},y.prototype.cornerCellMatch=function(d,i){var h=i.item;return 0===i.type&&h&&this.hierarchyTablixNavigator.cornerCellItemEquals(d,h)},y.prototype.renderCorner=function(){for(var d=this.columnDim.getDepth(),i=this.rowDim.getDepth(),h=0;h<d;h++)for(var c=0;c<i;c++){var z=this.hierarchyTablixNavigator.getCorner(c,h),P=this.controlLayoutManager.getOrCreateCornerCell(z,c,h);this.cornerCellMatch(z,P)||(this._unbindCell(P),P.type=0,P.item=z,this.binder.bindCornerCell(z,P)),this.controlLayoutManager.onCornerCellRealized(z,P)}},y.prototype._unbindCell=function(d){switch(d.type){case 3:this.binder.unbindBodyCell(d.item,d);break;case 2:this.binder.unbindColumnHeader(d.item,d);break;case 1:this.binder.unbindRowHeader(d.item,d);break;case 0:this.binder.unbindCornerCell(d.item,d)}d.item=null,d.type=null},y.prototype.onTouchEvent=function(d){var i,h,c;d&&d.length>0&&"columnDim"in d[0]&&"rowDim"in d[0]&&(i=(c=d[0]).columnDim.scrollbar.visible?d[1]:0,h=c.rowDim.scrollbar.visible?d[2]:0,c.columnDim.scrollbar.viewMin=Math.max(0,c.columnDim.scrollbar.viewMin+i),c.columnDim.scrollOffset=Math.max(0,c.columnDim.scrollOffset+i),c.rowDim.scrollbar.viewMin=Math.max(0,c.rowDim.scrollbar.viewMin+h),c.rowDim.scrollOffset=Math.max(0,c.rowDim.scrollOffset+h),c._onScrollAsync(0===i?c.rowDim:0===h?c.columnDim:null))},y.UnitOfMeasurement="px",y.TablixContainerClassName="tablixContainer",y.TablixTableAreaClassName="tablixTableArea",y.TablixFooterClassName="tableFooterArea",y.DefaultFontSize=V.FP.fromPoint(k),y.MaxRenderIterationCount=10,y}()},74304:function(Fe,me,E){E.d(me,{U:function(){return de}});var V=E(81337),I=E(67016),U=E(60014),oe=E(85196),j=E(29324),le=E(54522),te=E(56707),G=E(85028),re=E(32105),ce=E(33024),o=E(55007),S=E(85308),l=E(62458),u=E(56578),F=E(64329),W=E(82755),x=E(76045),D=E(91059),X=E(96915),K=E(82386),k=E(86878),y=E(72489),d=E(71090),i=E(73889),h=E(66842),c=E(40845),z=10,de=function(){function B(g){this.tablixProperties=new o.FX(g)}return B.getMetadataObjects=function(g){return g&&g.metadata?g.metadata.objects:null},B.prototype.enumerateObjectRepetition=function(g,a,f,b){var C,p,r,e,t,n,s;l.fF.assertValue(g,"enumeration should be defined"),l.fF.assertValue(a,"dataView can't be undefined");var w,m=this.getSelectorData(f);switch(f){case i.Y.Table:case i.Y.TableEx:w=this.getTableColumnMetadata(a);break;case i.Y.Matrix:case i.Y.PivotTable:w=this.getMatrixValuesColumnMetadata(a);break;default:return void l.fF.assertNever(f)}if(w){w=_.uniq(w);for(var O=f===i.Y.PivotTable||f===i.Y.TableEx,H=0,v=w;H<v.length;H++){var M=v[H],Y=null===(s=M.type.misc)||void 0===s?void 0:s.sparkline;if(O){var ue={containerName:M.displayName,selector:this.getSelector(M.queryName,m),allowOverrideSubtotalMatching:!0,objects:(p={},p[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},p)};if(g.push(ue),!Y){var ee={containerName:M.displayName,selector:this.getSelector(M.queryName,m),allowOverrideSubtotalMatching:!0,objects:(r={},r[this.tablixProperties.PropValuesFontColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesFontColor.propertyName]},r)};g.push(ee)}if(M.type.numeric&&!Y){var se={containerName:M.displayName,selector:this.getSelector(M.queryName),objects:(e={},e[o.FX.PropColumnFormattingDataBars.objectName]={formattingProperties:[o.FX.PropColumnFormattingDataBars.propertyName]},e)};g.push(se)}var pe={containerName:M.displayName,selector:this.getSelector(M.queryName,m),altStaticSelector:this.getSelector(M.queryName),allowOverrideSubtotalMatching:!0,objects:(t={},t[o.FX.PropValuesIcon.objectName]={formattingProperties:[o.FX.PropValuesIcon.propertyName]},t)};if(g.push(pe),O&&b?.conditionalTablixWebURL&&!(0,le.cR)(M)&&!Y){var fe={containerName:M.displayName,selector:this.getSelector(M.queryName,m),allowOverrideSubtotalMatching:!0,objects:(n={},n[o.FX.PropValuesWebURL.objectName]={formattingProperties:[o.FX.PropValuesWebURL.propertyName]},n)};g.push(fe)}}else{if(!M.isMeasure||!M.type.numeric)continue;var ie={containerName:M.displayName,selector:this.getSelector(M.queryName,m),objects:(C={},C[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},C)};g.push(ie)}}}},B.prototype.getSelectorData=function(g){switch(g){case i.Y.Table:return[(0,D.Yp)(["Values"])];case i.Y.TableEx:return[(0,X.Ue)(1)];case i.Y.Matrix:return[(0,D.Yp)(["Rows","Columns"])];case i.Y.PivotTable:return[(0,X.Ue)(1)];default:return void l.fF.assertNever(g)}},B.prototype.getConditionalFormattingSelector=function(g,a,f){void 0===f&&(f=!0);var b=f?this.getSelectorData(g):void 0;return this.getSelector(a,b)},B.prototype.getSelector=function(g,a){var f={metadata:g};return a&&(f.data=a),f},B.prototype.getFormattingModel=function(g,a,f,b,C,p,r){void 0===C&&(C=!1),l.fF.assertValue(f,"dataView can't be undefined");var s,e=B.getMetadataObjects(f),t=a,n=a,m=this.getColumnsMetadata(f,b);s=b===i.Y.Table?this.shouldShowTableTotalsOption(f)&&o.FX.PropGeneralTableTotals.getValue(e):this.shouldShowColumnSubtotalsOption(f)&&o.FX.PropGeneralMatrixColumnSubtotals.getValue(e)||this.shouldShowRowSubtotalsOption(f)&&o.FX.PropGeneralMatrixRowSubtotals.getValue(e);var w=this.getTablixTextClassProperties(r),O=new u.Nq(this.getStylePresetCard(g,t,b,p),this.getGridCard(g,a,b,e,w,p),this.getBlankRowCard(g,t,b,p),this.getValueCard(g,a,b,e,p),this.getColumnHeadersCard(g,a,b,p),this.getRowHeadersCard(g,t,b,e,C,p),this.getTotalsCard(g,n,b,p),this.getColumnSubtotalCard(g,t,f,b,s,p),this.getRowSubTotalsCard(g,t,f,b,s,p),this.getColumnGrandTotalsCard(g,t,b),this.getRowGrandTotalsCard(g,t,b),this.getColumnFormattingCard(g,a,m,b),this.getCellColumnCard(g,b,f,p),this.getUrlIconCard(g,a,b),this.getImageSizeCard(g,a,b,p),this.getSparklinesCard(m,g,b)),H=this.getMatrixRowsColumnMetadata(f),v=this.getMatrixColumnsColumnMetadata(f),M=p.a11yShowAsMatrix?this.getAccessibilityCardNew(H,v,m,g,n,b):this.getAccessibilityCard(m,g,n,b);return M&&O.addCards(M),O.build()},B.prototype.getLayoutSlice=function(g,a){return new u.vi({uidBuilder:new u.IN(new u.SS(new u.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"layout"),control:new u.uY({descriptor:I.t.general.layout,value:g.general.layout}).build(),localize:a}).build()},B.prototype.getIndentationSlice=function(g,a){if(g.general.layout===h.t.Compact){var f=g.rowHeaders;return new u.vi({uidBuilder:new u.IN(new u.SS(new u.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"indentation"),control:this.getIndentationSliderBuilder(f,a).build(),localize:a}).build()}},B.prototype.getRepeatRowHeadersSlice=function(g,a){if(g.general.layout!==h.t.Compact)return new u.vi({uidBuilder:new u.IN(new u.SS(new u.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"repeatRowHeaders"),control:new u.bd({descriptor:I.t.rowHeaders.repeatRowHeaders,value:g.rowHeaders.repeatRowHeaders}).build(),localize:a}).build()},B.prototype.getStylePresetCard=function(g,a,f,b){var C=this,p="StylePresets";b.matrixLayouts&&f===i.Y.PivotTable&&(p="Layout_And_StylePresets");var r=function(n){return g.getLocalizedString(n)},e=new u.CQ(new u.lg("stylePreset"),p,[I.t.general.layout,I.t.rowHeaders.steppedLayoutIndentation,I.t.rowHeaders.repeatRowHeaders],r);return e.addGroup(void 0,function(t){if(t.addSlicePlaceholder((0,u.E0)("stylePreset")),b.matrixLayouts&&f===i.Y.PivotTable){var n=C.getLayoutSlice(a,r),s=C.getIndentationSlice(a,r),m=C.getRepeatRowHeadersSlice(a,r);t.addSlice(n),s&&t.addSlice(s),m&&t.addSlice(m)}}),e.build()},B.prototype.getBlankRowCard=function(g,a,f,b){if(b.matrixLayouts&&f===i.Y.PivotTable){var C=function(t){return g.getLocalizedString(t)},p=I.t.blankRows,r=new u.CQ(new u.lg("blankRows"),"Visual_Blank_Rows",p,C).addTopLevelToggle("blankRow",function(){return new u.bd({descriptor:p.showBlankRows,value:a.blankRows.showBlankRows}).build()});return r.addGroup("colors",function(e){e.withDisplayName("Generic_Color").addSimpleSlice("blankRowColor",function(){return new u.BT({descriptor:p.blankRowColor,value:{value:a.blankRows.blankRowColor}}).build()}).addSimpleSlice("blankRowTransparency",new u.JN({descriptor:p.blankRowTransparency,value:a.blankRows.blankRowTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:ce.t2},localize:C}).build(),function(t){return t.withCustomDisplayName("Transparency")})}),r.addGroup("border",function(e){e.withDisplayName("Visual_Border").addTopLevelToggle("blankRowBorder",function(){return new u.bd({descriptor:p.showBorder,value:a.blankRows.showBorder}).build()}).addSimpleSlice("blankRowBorderPosition",function(){return new u.uY({descriptor:p.borderPosition,value:a.blankRows.borderPosition}).build()}).addSimpleSlice("blankRowBorderColor",function(){return new u.BT({descriptor:p.borderColor,value:{value:a.blankRows.borderColor}}).build()}).addSimpleSlice("blankRowBorderTransparency",new u.JN({descriptor:p.borderTransparency,value:a.blankRows.borderTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:ce.t2},localize:C}).build(),function(t){return t.withCustomDisplayName("Transparency")}).addSimpleSlice("blankRowBorderWidth",new u.mu({descriptor:p.borderWidth,value:a.blankRows.borderWidth,options:{minValue:{type:0,value:0},maxValue:{type:1,value:z},unitSymbol:ce.e_}}).build(),function(t){return t.withCustomDisplayName("Visual_General_Properties_Width")})}),r.build()}},B.prototype.getGridCard=function(g,a,f,b,C,p){var r=function(N){return g.getLocalizedString(N)},e=f===i.Y.TableEx?U.Z.grid:I.t.grid,t=f===i.Y.TableEx?U.Z.values:I.t.values,n=t.outlineStyle,s=t.outlineWeight,m=t.outlineColor,w=f===i.Y.TableEx?U.Z.columnHeaders:I.t.columnHeaders,O=w.outlineStyle,H=w.outlineWeight,v=w.outlineColor,M=f===i.Y.TableEx?U.Z.total:I.t.total,Y=M.outlineStyle,ie=M.outlineWeight,ue=M.outlineColor,ee=I.t.rowHeaders,se=ee.outlineStyle,pe=ee.outlineWeight,fe=ee.outlineColor,He=e.outlineStyle,ve=(0,V.__rest)(e,["imageHeight","imageWidth","outline","outlineStyle"]);ve=(0,V.__assign)((0,V.__assign)({},ve),{outlineStyle:He,valuesOutlineStyle:n,valuesOutlineWeight:s,valuesOutlineColor:m,columnHeadersOutlineStyle:O,columnHeadersOutlineWeight:H,columnHeadersOutlineColor:v}),f===i.Y.TableEx&&(ve=(0,V.__assign)((0,V.__assign)({},ve),{totalsOutlineStyle:Y,totalsOutlineColor:ue,totalsOutlineWeight:ie})),f===i.Y.PivotTable&&(ve=(0,V.__assign)((0,V.__assign)({},ve),{rowHeaderOutlineStyle:se,rowHeaderOutlineWeight:pe,rowHeaderOutlineColor:fe}));var _e=a.grid,R=new u.CQ(new u.lg("grid"),"Visual_Grid",ve,r);return R.addGroup("gridHorizontal",function(T){T.withDisplayName("Visual_Gridline_Horizontal").addTopLevelToggle("gridHorizontal",function(){return new u.bd({descriptor:ve.gridHorizontal,value:_e.gridHorizontal}).build()}).addSimpleSlice("gridHorizontalColor",function(){return new u.BT({descriptor:ve.gridHorizontalColor,value:{value:_e.gridHorizontalColor}}).build()},function(N){return N.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridHorizontalWeight",new u.mu({descriptor:ve.gridHorizontalWeight,value:_e.gridHorizontalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:z}}}).build(),function(N){return N.withCustomDisplayName("Visual_General_Properties_Width")})}),R.addGroup("gridVertical",function(T){T.withDisplayName("Visual_Gridline_Vertical").addTopLevelToggle("gridVertical",function(){return new u.bd({descriptor:ve.gridVertical,value:_e.gridVertical}).build()}).addSimpleSlice("gridVerticalColor",function(){return new u.BT({descriptor:ve.gridVerticalColor,value:{value:_e.gridVerticalColor}}).build()},function(N){return N.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridVerticalWeight",new u.mu({descriptor:ve.gridVerticalWeight,value:_e.gridVerticalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:z}}}).build(),function(N){return N.withCustomDisplayName("Visual_General_Properties_Width")})}),R.addGroup("border",function(T){T.withDisplayName("Visual_Border").addContainer("outline",function(N){N.withDisplayName("Section"),N.addContainerItem("all",r("All"),function(Z){Z.addSimpleSlice("outlineStyle",function(){return new u.oM({descriptor:ve.outlineStyle,value:_e.outline}).build()},function(ne){return ne.withCustomDisplayName("Visual_Border_Position")}),Z.addSimpleSlice("outlineColor",function(){return new u.BT({descriptor:ve.outlineColor,value:{value:_e.outlineColor}}).build()},function(ne){return ne.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeight",new u.mu({descriptor:ve.outlineWeight,value:_e.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:z}}}).build(),function(ne){return ne.withCustomDisplayName("Visual_General_Properties_Width")})}).addContainerItem("columnHeaders",r("Visual_Tablix_ColumnHeader"),function(Z){var ne=a.columnHeaders;Z.addSimpleSlice("outlineStyleColumnHeaders",function(){return new u.oM({descriptor:O,value:ne.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}),Z.addSimpleSlice("outlineColorColumnHeaders",function(){return new u.BT({descriptor:v,value:{value:ne.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightColumnHeaders",new u.mu({descriptor:H,value:ne.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:z}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})}),f===i.Y.PivotTable&&N.addContainerItem("rowHeaders",r("Visual_Tablix_RowHeaders"),function(Z){var ne=a.rowHeaders;Z.addSimpleSlice("outlineStyleRowHeaders",function(){return new u.oM({descriptor:se,value:ne.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}),Z.addSimpleSlice("outlineColorRowHeaders",function(){return new u.BT({descriptor:fe,value:{value:ne.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightRowHeaders",new u.mu({descriptor:pe,value:ne.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:z}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})}),N.addContainerItem("values",r("Visual_Tablix_ValuesSection"),function(Z){var ne=a.values;Z.addSimpleSlice("outlineStyleValues",function(){return new u.oM({descriptor:n,value:ne.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorValues",function(){return new u.BT({descriptor:m,value:{value:ne.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightValues",new u.mu({descriptor:s,value:ne.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:z}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})}),f===i.Y.TableEx&&N.addContainerItem("outline-totals",r("Visual_Tablix_TotalsSection"),function(Z){var ne=a.total;Z.addSimpleSlice("outlineStyleTotals",function(){return new u.oM({descriptor:Y,value:ne.outline}).build()},function(he){return he.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorTotals",function(){return new u.BT({descriptor:ue,value:{value:ne.outlineColor}}).build()},function(he){return he.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightTotals",new u.mu({descriptor:ie,value:ne.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:z}}}).build(),function(he){return he.withCustomDisplayName("Visual_General_Properties_Width")})})})}),R.addGroup("options",function(T){T.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("rowPadding",new u.mu({descriptor:ve.rowPadding,value:_e.rowPadding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:20}}}).build()).addSimpleSlice("textSize",function(){return new u.mu({descriptor:ve.textSize,value:o.FX.PropGridPivotTableTextSize.setInstanceProperty(void 0,b,C.fontSizeOverrideFn,C.labelFontProperties.size&&C.labelFontProperties.size.pt),options:{minValue:{type:0,value:8},maxValue:{type:1,value:60}}}).build()},function(N){return N.withCustomDisplayName("Global_Font_Size")})}),R.build()},B.prototype.getValueCard=function(g,a,f,b,C){var H=(0,V.__rest)(f===i.Y.TableEx?U.Z.values:I.t.values,["webURL","urlIcon","icon","bandedRowHeaders","outlineStyle","outlineWeight","outlineColor"]),v=a.values,M=new u.CQ(new u.lg("values"),"Visual_Tablix_Values",H,function(ee){return g.getLocalizedString(ee)}),ie=(new u.UN).withFontFamily({descriptor:H.fontFamily,value:v.fontFamily}).withFontSizeProperties({descriptor:H.fontSize,value:v.fontSize.pt}).withBold({descriptor:H.bold,value:v.bold}).withItalic({descriptor:H.italic,value:v.italic}).withUnderline({descriptor:H.underline,value:v.underline}).build();return M.addGroup("values",function(ue){ue.withDisplayName("Visual_Tablix_Values"),(f===i.Y.PivotTable||f===i.Y.TableEx)&&ue.addCompositeSlice("font","Font",ie),ue.addSimpleSlice("fontColorPrimary",function(){return new u.BT({descriptor:H.fontColorPrimary,value:{value:v.fontColorPrimary}}).build()},function(ee){return ee.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColorPrimary",function(){return new u.BT({descriptor:H.backColorPrimary,value:{value:v.backColorPrimary}}).build()},function(ee){return ee.withCustomDisplayName("Background_Color")}).addSimpleSlice("fontColorSecondary",function(){return new u.BT({descriptor:H.fontColorSecondary,value:{value:v.fontColorSecondary}}).build()},function(ee){return ee.withCustomDisplayName("Visual_AlternateText_Color")}).addSimpleSlice("backColorSecondary",function(){return new u.BT({descriptor:H.backColorSecondary,value:{value:v.backColorSecondary}}).build()},function(ee){return ee.withCustomDisplayName("Visual_Tablix_BackColorSecondary")}).addSimpleSlice("textWrap",new u.bd({descriptor:H.wordWrap,value:v.wordWrap}).build(),function(ee){return ee.withCustomDisplayName("TextWrap")})}),f===i.Y.PivotTable&&M.addGroup("options",function(ue){ue.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("valuesOnRow",new u.bd({descriptor:H.valuesOnRow,value:o.FX.PropValuesOnRow.setInstanceProperty(void 0,b)}).build(),function(ee){return ee.withCustomDisplayName("Visual_PivotTable_ValuesSwitchToRows")})}),M.build()},B.prototype.getColumnHeadersCard=function(g,a,f,b){var s=(0,V.__rest)(f===i.Y.TableEx?U.Z.columnHeaders:I.t.columnHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor"]),m=a.columnHeaders,w=new u.CQ(new u.lg("columnHeaders"),"Visual_Tablix_ColumnHeaders",s,function(M){return g.getLocalizedString(M)}),H=(new u.UN).withFontFamily({descriptor:s.fontFamily,value:m.fontFamily}).withFontSizeProperties({descriptor:s.fontSize,value:m.fontSize.pt}).withBold({descriptor:s.bold,value:m.bold}).withItalic({descriptor:s.italic,value:m.italic}).withUnderline({descriptor:s.underline,value:m.underline}).build();return w.addGroup("text",function(v){v.withDisplayName("Text"),(f===i.Y.PivotTable||f===i.Y.TableEx)&&v.addCompositeSlice("font","Font",H),v.addSimpleSlice("fontColor",function(){return new u.BT({descriptor:s.fontColor,value:{value:m.fontColor}}).build()},function(Y){return Y.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:s.backColor,value:{value:m.backColor}}).build()},function(Y){return Y.withCustomDisplayName("Background_Color")}),(f===i.Y.Table||f===i.Y.TableEx||f===i.Y.PivotTable)&&v.addSimpleSlice("alignment",new u.Gp({descriptor:s.alignment,value:m.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build(),function(Y){return Y.withCustomDisplayName("Visual_TextAlignment_Header")}),f===i.Y.PivotTable&&v.addSimpleSlice("titleAlignment",new u.Gp({descriptor:s.titleAlignment,value:a.columnHeaders.titleAlignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()),(f===i.Y.Table||f===i.Y.TableEx||f===i.Y.PivotTable)&&v.addSimpleSlice("wordWrap",new u.bd({descriptor:s.wordWrap,value:m.wordWrap}).build(),function(Y){return Y.withCustomDisplayName("TextWrap")})}),(f===i.Y.PivotTable||f===i.Y.TableEx)&&w.addGroup("options",function(v){v.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("autoSizeColumnWidth",new u.bd({descriptor:s.autoSizeColumnWidth,value:a.general.autoSizeColumnWidth}).build(),function(M){return M.withCustomDisplayName("Visual_AutoSize_Width")})}),w.build()},B.prototype.getRowHeadersCard=function(g,a,f,b,C,p){var r=this;if(void 0===C&&(C=!1),f===i.Y.PivotTable){var e=function(se){return g.getLocalizedString(se)},H=(0,V.__rest)(I.t.rowHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor","legacyStyleDisabled"]),v=I.t.values.bandedRowHeaders;f===i.Y.PivotTable&&(H=(0,V.__assign)((0,V.__assign)({},H),{bandedRowHeaders:v}));var M=a.rowHeaders,Y=new u.CQ(new u.lg("rowHeaders"),"Visual_Tablix_RowHeaders",H,e),ue=(new u.UN).withFontFamily({descriptor:H.fontFamily,value:M.fontFamily}).withFontSizeProperties({descriptor:H.fontSize,value:M.fontSize.pt}).withBold({descriptor:H.bold,value:M.bold}).withItalic({descriptor:H.italic,value:M.italic}).withUnderline({descriptor:H.underline,value:M.underline}).build();return Y.addGroup("text",function(ee){ee.withDisplayName("Text"),(f===i.Y.PivotTable||f===i.Y.TableEx)&&ee.addCompositeSlice("font","Font",ue),ee.addSimpleSlice("fontColor",function(){return new u.BT({descriptor:H.fontColor,value:{value:M.fontColor}}).build()},function(se){return se.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:H.backColor,value:{value:M.backColor}}).build()},function(se){return se.withCustomDisplayName("Background_Color")}),f===i.Y.PivotTable&&ee.addSimpleSlice("bandedRowHeaders",new u.bd({descriptor:H.bandedRowHeaders,value:o.FX.PropValuesBandedRowHeaders.setInstanceProperty(void 0,b)}).build()),ee.addSimpleSlice("alignment",new u.Gp({descriptor:H.alignment,value:M.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()).addSimpleSlice("wordWrap",new u.bd({descriptor:H.wordWrap,value:M.wordWrap}).build(),function(se){return se.withCustomDisplayName("TextWrap")})}),f===i.Y.PivotTable&&C&&Y.addGroup("expandCollapseButtons",function(ee){ee.withDisplayName("Visual_PivotTable_ExpandCollapseButtons_Toggle"),ee.addTopLevelToggle("showExpandCollapseButtons",function(){return new u.bd({descriptor:H.showExpandCollapseButtons,value:M.showExpandCollapseButtons}).build()}).addSimpleSlice("expandCollapseButtonsColor",function(){return new u.BT({descriptor:H.expandCollapseButtonsColor,value:{value:M.expandCollapseButtonsColor}}).build()},function(se){return se.withCustomDisplayName("Generic_Color")}).addSimpleSlice("expandCollapseButtonsSize",new u.mu({descriptor:H.expandCollapseButtonsSize,value:M.expandCollapseButtonsSize.pt,options:{minValue:{type:0,value:8},maxValue:{type:1,value:60},unitSymbol:"Numeric_Pixel"}}).build(),function(se){return se.withCustomDisplayName("Visual_BubbleSize")})}),p.matrixLayouts||Y.addGroup("options",function(ee){ee.withDisplayName("Desktop_FileMenu_Options"),ee.addSimpleSlice("stepped",new u.bd({descriptor:H.stepped,value:M.steppedLayout}).build()).addSimpleSlice("steppedLayoutIndentation",r.getIndentationSliderBuilder(M,e).build())}),Y.build()}},B.prototype.getIndentationSliderBuilder=function(g,a){return new u.JN({descriptor:I.t.rowHeaders.steppedLayoutIndentation,value:g.steppedLayoutIndentation,localize:a,options:{minValue:{type:0,value:0},maxValue:{type:1,value:150}}})},B.prototype.getTotalsCard=function(g,a,f,b){if(f===i.Y.TableEx){var n=(0,V.__rest)(f===i.Y.TableEx?U.Z.total:I.t.total,["outlineStyle","outlineWeight","outlineColor"]),s=a.total,m=new u.CQ(new u.lg("totals"),"Visual_Totals",n,function(v){return g.getLocalizedString(v)}),O=(new u.UN).withFontFamily({descriptor:n.fontFamily,value:s.fontFamily}).withFontSizeProperties({descriptor:n.fontSize,value:s.fontSize.pt}).withBold({descriptor:n.bold,value:s.bold}).withItalic({descriptor:n.italic,value:s.italic}).withUnderline({descriptor:n.underline,value:s.underline}).build();return m.addGroup("values",function(H){var v;H.withDisplayName("Visual_Tablix_Values"),f===i.Y.TableEx?(H.addTopLevelToggle("gridVertical",function(){return new u.bd({descriptor:n.totals,value:a.general.totals}).build()}),v=a.general.totals):v=!0,v&&H.addSimpleSlice("totalLabel",new u.fq({descriptor:n.label,value:s.totalLabel,placeholder:""}).build()).addCompositeSlice("font","Font",O),H.addSimpleSlice("fontColor",function(){return new u.BT({descriptor:n.fontColor,value:{value:s.fontColor}}).build()},function(M){return M.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:n.backColor,value:{value:s.backColor}}).build()},function(M){return M.withCustomDisplayName("Background_Color")})}),m.build()}},B.prototype.getColumnGrandTotalsCard=function(g,a,f){if(f!==i.Y.TableEx){var e=(0,V.__rest)(I.t.columnTotal,["outlineStyle","outline"]),t=a.columnGrandTotal,n=new u.CQ(new u.lg("columnTotal"),"Visual_Tablix_Matrix_Column_TotalGrand",e,function(O){return g.getLocalizedString(O)}),m=(new u.UN).withFontFamily({descriptor:e.fontFamily,value:t.fontFamily}).withFontSizeProperties({descriptor:e.fontSize,value:t.fontSize.pt}).withBold({descriptor:e.bold,value:t.bold}).withItalic({descriptor:e.italic,value:t.italic}).withUnderline({descriptor:e.underline,value:t.underline}).build();return n.addGroup("values",function(w){w.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",m).addSimpleSlice("fontColor",function(){return new u.BT({descriptor:e.fontColor,value:{value:t.fontColor}}).build()},function(O){return O.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:e.backColor,value:{value:t.backColor}}).build()},function(O){return O.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new u.bd({descriptor:e.applyToHeaders,value:t.applyToHeaders}).build())}),n.build()}},B.prototype.getRowGrandTotalsCard=function(g,a,f){if(f!==i.Y.TableEx){var e=(0,V.__rest)(I.t.rowTotal,["outlineStyle","outline"]),t=a.rowGrandTotal,n=new u.CQ(new u.lg("rowTotal"),"Visual_Tablix_Matrix_Row_TotalGrand",e,function(O){return g.getLocalizedString(O)}),m=(new u.UN).withFontFamily({descriptor:e.fontFamily,value:t.fontFamily}).withFontSizeProperties({descriptor:e.fontSize,value:t.fontSize.pt}).withBold({descriptor:e.bold,value:t.bold}).withItalic({descriptor:e.italic,value:t.italic}).withUnderline({descriptor:e.underline,value:t.underline}).build();return n.addGroup("values",function(w){w.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",m).addSimpleSlice("fontColor",function(){return new u.BT({descriptor:e.fontColor,value:{value:t.fontColor}}).build()},function(O){return O.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new u.BT({descriptor:e.backColor,value:{value:t.backColor}}).build()},function(O){return O.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new u.bd({descriptor:e.applyToHeaders,value:t.applyToHeaders}).build())}),n.build()}},B.prototype.addAltTextGroup=function(g,a,f,b,C,p){_.isEmpty(b)||g.addGroup(a,function(r){r.withDisplayName("Visual_General_Properties_Description").withCollapsible(!1),r.addContainer("measure",function(e){e.withDisplayName(f);for(var t=function(O){var H;p===oe.r.rows||p===oe.r.columns?H={data:[(0,D.Yp)([p])]}:p===oe.r.values?H={data:[(0,X.Ue)(0)],metadata:O.queryName}:l.fF.assertFail("unexpected role"),e.addContainerItem(O.queryName,O.displayName,function(v){return v.addSimpleSlice("altTextColumns",new u.k0({descriptor:(0,V.__assign)((0,V.__assign)({},C.altTextColumns),{selector:H,instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},n=0,s=b;n<s.length;n++)t(s[n])})})},B.prototype.getAccessibilityCardNew=function(g,a,f,b,C,p){l.fF.assert(function(){return p===i.Y.TableEx||p===i.Y.PivotTable});var r=p===i.Y.TableEx?U.Z.accessibility:I.t.accessibility,e=_.filter(g,le.pt),t=_.filter(a,le.pt),n=_.filter(f,le.pt),s=_.filter(f,function(H){return H.type.text}).map(function(H){return{displayName:H.displayName,value:H.queryName}});if(!(_.isEmpty(e)&&_.isEmpty(t)&&_.isEmpty(n))||p!==i.Y.PivotTable&&!_.isEmpty(s)){var w=new u.CQ(new u.lg("accessibility"),"Accessibility",p===i.Y.TableEx?[r.altTextColumns,r.rowWithReferenceText]:[r.altTextColumns],function(v){return b.getLocalizedString(v)});if(this.addAltTextGroup(w,"AltTextRowHeaders","Image_Alt_Text_Row_Headers",e,r,oe.r.rows),this.addAltTextGroup(w,"AltTextColumnHeaders","Image_Alt_Text_Column_Headers",t,r,oe.r.columns),this.addAltTextGroup(w,"AltTextValues","Image_Alt_Text_Values",n,r,oe.r.values),p===i.Y.TableEx&&!_.isEmpty(s)){var O={displayName:b.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};s.unshift(O),w.addGroup("rowWithReferenceText",function(H){var v;H.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),H.addSimpleSlice("rowWithReferenceText",new u.uY({descriptor:(0,V.__assign)({},r.rowWithReferenceText),items:s,value:null!==(v=_.find(s,function(M){return M.value===C.rowWithReferenceText.rowWithReferenceText}))&&void 0!==v?v:s[0]}).build())})}return w.build()}},B.prototype.getAccessibilityCard=function(g,a,f,b){if(b===i.Y.TableEx){var C=U.Z.accessibility,p=_.filter(g,le.pt),r=_.filter(g,function(s){return s.type.text}).map(function(s){return{displayName:s.displayName,value:s.queryName}});if(!_.isEmpty(p)||!_.isEmpty(r)){var t=new u.CQ(new u.lg("accessibility"),"Accessibility",[C.altTextColumns,C.rowWithReferenceText],function(m){return a.getLocalizedString(m)});if(_.isEmpty(p)||t.addGroup("AltTextValues",function(s){s.withDisplayName("Visual_Tablix_Accessibility_Group_AltText_Label").withCollapsible(!1),s.addContainer("measure",function(m){m.withDisplayName("Image_Alt_Text_Values");for(var w=function(Y){m.addContainerItem(Y.queryName,Y.displayName,function(ie){return ie.addSimpleSlice("altTextColumns",new u.k0({descriptor:(0,V.__assign)((0,V.__assign)({},C.altTextColumns),{selector:{data:[(0,X.Ue)(0)],metadata:Y.queryName},instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},O=0,H=p;O<H.length;O++)w(H[O])})}),!_.isEmpty(r)){var n={displayName:a.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};r.unshift(n),t.addGroup("rowWithReferenceText",function(s){var m;s.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),s.addSimpleSlice("rowWithReferenceText",new u.uY({descriptor:(0,V.__assign)({},C.rowWithReferenceText),items:r,value:null!==(m=_.find(r,function(w){return w.value===f.rowWithReferenceText.rowWithReferenceText}))&&void 0!==m?m:r[0]}).build())})}return t.build()}}},B.prototype.getRowSubTotalsCard=function(g,a,f,b,C,p){var r=this;if(C||b===i.Y.PivotTable){var e=B.getMetadataObjects(f),t=o.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(void 0,e),n=function(v){return g.getLocalizedString(v)},s=I.t.subTotals,m=(0,V.__assign)((0,V.__assign)({},a.subtotals),a.rowSubtotals),w=new u.CQ(new u.lg("rowSubTotal"),"Visual_SubtotalRow",[s.rowSubtotalsLabel,s.rowSubtotals,s.rowSubtotalsPosition,s.perRowLevel,s.levelSubtotalEnabled,s.levelSubtotalLabel,s.fontColor,s.backColor,s.fontSize,s.fontFamily,s.bold,s.italic,s.underline,s.applyToHeaders],n);w.addTopLevelToggle("rowSubtotals",function(){return new u.bd({descriptor:s.rowSubtotals,value:a.general.rowSubtotals}).build()});var O=0;return w.addGroup("applySettingsTo",function(H){H.withContainerDisabled(!t).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perRowLevel",new u.bd({descriptor:s.perRowLevel,value:t}).build(),function(v){return v.withDisabled(!r.shouldShowRowSubtotalsOption(f)).withCustomDescriptionIf(function(){return!r.shouldShowRowSubtotalsOption(f)},"Visual_SubtotalRow_PerLevel_DisabledReason")}).addContainer("series",function(v){v.withDisplayName("Visual_Tablix_Row_Level"),v.addContainerItem("all",n("All"),function(fe){return r.getRowSubtotalContainers(a,fe,n,p,s,m,void 0,e)});for(var M=0,Y=f.matrix.rows.levels;M<Y.length;M++)for(var ue=function(ge){if(!ge.isMeasure){var Se={metadata:ge.queryName};v.addContainerItem(ge.displayName,ge.displayName,function(Me){return r.getRowSubtotalContainers(a,Me,n,p,s,m,Se,ge.objects,O)}),O++}},ee=0,se=Y[M].sources;ee<se.length;ee++)ue(se[ee])})}),w.build()}},B.prototype.getRowSubtotalContainers=function(g,a,f,b,C,p,r,e,t){var n=r?o.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(e,!0):o.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(e,!0),s=r?"":f(d.qT),m=r?C.levelSubtotalLabel:C.rowSubtotalsLabel;a.addGroup("rows",function(w){w.withDisplayName("Role_DisplayName_Rows"),w.addSimpleSlice("levelSubtotalEnabled",new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},C.levelSubtotalEnabled),{selector:r}),value:o.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,e)}).build(),function(O){return O.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!r)}).addSimpleSlice("rowSubtotalsLabel",new u.fq({descriptor:(0,V.__assign)((0,V.__assign)({},m),{selector:r}),value:n||s,placeholder:""}).build(),function(O){return O.withCustomDisplayName("Visual_Subtotal_Label")}).addSimpleSlice(r?"rowSubtotalsPositionSeries".concat(t):"rowSubtotalsPositionAll",new u.uY({descriptor:C.rowSubtotalsPosition,value:g.subtotals.rowSubtotalsPosition}).build(),function(O){return O.withCustomDisplayName("Visual_Position").withDisabled(!!r||b.matrixLayouts&&g.general.layout===h.t.Tabular)})}),a.addGroup("values",function(w){if(w.withDisplayName("Visual_Tablix_Values"),r)w.withDisabled(!0,"");else{var O={id:"Row"},v=(new u.UN).withFontFamily({descriptor:(0,V.__assign)((0,V.__assign)({},C.fontFamily),{selector:O}),value:p.fontFamily}).withFontSizeProperties({descriptor:(0,V.__assign)((0,V.__assign)({},C.fontSize),{selector:O}),value:p.fontSize.pt}).withBold({descriptor:(0,V.__assign)((0,V.__assign)({},C.bold),{selector:O}),value:p.bold}).withItalic({descriptor:(0,V.__assign)((0,V.__assign)({},C.italic),{selector:O}),value:p.italic}).withUnderline({descriptor:(0,V.__assign)((0,V.__assign)({},C.underline),{selector:O}),value:p.underline}).build();w.addCompositeSlice("font","Font",v).addSimpleSlice("fontColor",function(){var M={value:p.fontColor};return new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},C.fontColor),{selector:O}),value:M}).build()},function(M){return M.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var M={value:p.backColor};return new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},C.backColor),{selector:O}),value:M}).build()},function(M){return M.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},C.applyToHeaders),{selector:O}),value:p.applyToHeaders}).build())}})},B.prototype.getColumnSubtotalCard=function(g,a,f,b,C,p){var r=this;if(C||b===i.Y.PivotTable||this.shouldShowColumnSubtotalsOption(f)){var e=B.getMetadataObjects(f),t=o.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(e),n=function(H){return g.getLocalizedString(H)},s=I.t.subTotals,m=(0,V.__assign)((0,V.__assign)({},a.subtotals),a.columnSubtotals),w=new u.CQ(new u.lg("columnSubTotal"),"Visual_SubtotalColumn",[s.columnSubtotals,s.columnSubtotalsLabel,s.perColumnLevel,s.levelSubtotalEnabled,s.levelSubtotalLabel,s.fontColor,s.backColor,s.fontSize,s.fontFamily,s.bold,s.italic,s.underline,s.applyToHeaders],n);return w.addTopLevelToggle("columnSubtotals",function(){return new u.bd({descriptor:s.columnSubtotals,value:a.general.columnSubtotals}).build()}),w.addGroup("applySettingsTo",function(O){O.withContainerDisabled(!t).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perColumnLevel",new u.bd({descriptor:s.perColumnLevel,value:t}).build(),function(H){return H.withDisabled(!r.shouldShowColumnSubtotalsOption(f)).withCustomDescriptionIf(function(){return!r.shouldShowColumnSubtotalsOption(f)},"Visual_SubtotalColumn_PerLevel_DisabledReason")}).addContainer("series",function(H){H.withDisplayName("Visual_Tablix_Column_Level"),H.addContainerItem("all",n("All"),function(pe){return r.getColumnSubtotalContainers(pe,n,p,s,m,void 0,e)});for(var v=0,M=f.matrix.columns.levels;v<M.length;v++)for(var ie=function(fe){if(!fe.isMeasure){var ge={metadata:fe.queryName};H.addContainerItem(fe.displayName,fe.displayName,function(Se){return r.getColumnSubtotalContainers(Se,n,p,s,m,ge,fe.objects)})}},ue=0,ee=M[v].sources;ue<ee.length;ue++)ie(ee[ue])})}),w.build()}},B.prototype.getColumnSubtotalContainers=function(g,a,f,b,C,p,r){var e=a(d.qT),t=p?o.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(r,!0):o.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(r,!0),n=p?b.levelSubtotalLabel:b.columnSubtotalsLabel;g.addGroup("columns",function(s){s.withDisplayName("Role_DisplayName_Columns"),s.addSimpleSlice("levelSubtotalEnabled",new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},b.levelSubtotalEnabled),{selector:p}),value:o.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,r)}).build(),function(m){return m.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!p)}).addSimpleSlice("columnSubtotalsLabel",new u.fq({descriptor:(0,V.__assign)((0,V.__assign)({},n),{selector:p}),value:t||e,placeholder:""}).build(),function(m){return m.withCustomDisplayName("Visual_Subtotal_Label")})}),g.addGroup("values",function(s){if(s.withDisplayName("Visual_Tablix_Values"),p)s.withDisabled(!0,"");else{var m={id:"Column"},O=(new u.UN).withFontFamily({descriptor:(0,V.__assign)((0,V.__assign)({},b.fontFamily),{selector:m}),value:C.fontFamily}).withFontSizeProperties({descriptor:(0,V.__assign)((0,V.__assign)({},b.fontSize),{selector:m}),value:C.fontSize.pt}).withBold({descriptor:(0,V.__assign)((0,V.__assign)({},b.bold),{selector:m}),value:C.bold}).withItalic({descriptor:(0,V.__assign)((0,V.__assign)({},b.italic),{selector:m}),value:C.italic}).withUnderline({descriptor:(0,V.__assign)((0,V.__assign)({},b.underline),{selector:m}),value:C.underline}).build();s.addCompositeSlice("font","Font",O).addSimpleSlice("fontColor",function(){var H={value:C.fontColor};return new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},b.fontColor),{selector:m}),value:H}).build()},function(H){return H.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var H={value:C.backColor};return new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},b.backColor),{selector:m}),value:H}).build()},function(H){return H.withCustomDisplayName("Background_Color")}),s.addSimpleSlice("applyToHeaders",new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},b.applyToHeaders),{selector:m}),value:C.applyToHeaders}).build())}})},B.prototype.getColumnFormattingCard=function(g,a,f,b){if(!_.isEmpty(f)){var e=(0,V.__rest)(b===i.Y.TableEx?U.Z.columnFormatting:I.t.columnFormatting,["dataBars"]),t=a.columnFormatting,n=new u.CQ(new u.lg("columnFormatting"),"Visual_Tablix_Specific_Column",e,function(m){return g.getLocalizedString(m)});return n.withDescription("Visual_Matrix_SpecificColumn_Description"),n.addGroup("columns",function(s){s.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(m){m.withDisplayName("Series");for(var w=function(Y){var ie=Y&&Y.objects;m.addContainerItem(Y.queryName,Y.displayName,function(ue){ue.addSimpleSlice(e.styleHeader,new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},e.styleHeader),{selector:{metadata:Y.queryName}}),value:t[Y.queryName].styleHeader}).build()),b===i.Y.PivotTable&&ue.addSimpleSlice(e.styleSubtotals,new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},e.styleSubtotals),{selector:{metadata:Y.queryName}}),value:o.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(void 0,ie)}).build()),ue.addSimpleSlice(e.styleTotal,new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},e.styleTotal),{selector:{metadata:Y.queryName}}),value:t[Y.queryName].styleTotal}).build()).addSimpleSlice(e.styleValues,new u.bd({descriptor:(0,V.__assign)((0,V.__assign)({},e.styleValues),{selector:{metadata:Y.queryName}}),value:t[Y.queryName].styleValues}).build()),ue.addGroup("values",function(ee){if(ee.withDisplayName("Visual_Tablix_Values").addSimpleSlice("fontColor",function(){var pe={value:t[Y.queryName].fontColor};return new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},e.fontColor),{selector:{metadata:Y.queryName}}),value:pe}).build()},function(pe){return pe.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var pe={value:t[Y.queryName].backColor};return new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},e.backColor),{selector:{metadata:Y.queryName}}),value:pe}).build()},function(pe){return pe.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new u.Gp({descriptor:(0,V.__assign)((0,V.__assign)({},e.alignment),{selector:{metadata:Y.queryName}}),mode:"horizontalAlignment",supportsNoSelection:!0,value:t[Y.queryName].alignment}).build()),Y.type.numeric&&(b===i.Y.PivotTable||b===i.Y.TableEx)){var se=Y&&Y.objects;ee.addSimpleSlice("labelDisplayUnits",new u.uY({descriptor:(0,V.__assign)((0,V.__assign)({},e.labelDisplayUnits),{selector:{metadata:Y.queryName}}),value:o.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(void 0,se)}).build()).addSimpleSlice("labelPrecision",new u.mu({descriptor:(0,V.__assign)((0,V.__assign)({},e.labelPrecision),{selector:{metadata:Y.queryName}}),value:o.FX.PropColumnFormattingPrecision.setInstanceProperty(void 0,se),options:{minValue:{type:0,value:0},maxValue:{type:1,value:te.vo}}}).build())}})})},O=0,H=f;O<H.length;O++)w(H[O])})}),n.build()}},B.prototype.getCellColumnCard=function(g,a,f,b){var r=(0,U.k)().objects,e=[];return this.enumerateObjectRepetition(e,f,a,b),(0,j.Z)(e,function(n){return g.getLocalizedString(n)},r,"Cell_Elements","Visual_Matrix_CellElements_Description")},B.prototype.getUrlIconCard=function(g,a,f){var b=f===i.Y.TableEx?U.Z.values.urlIcon:I.t.values.urlIcon,C=a,p=I.t.columnHeaders.urlIcon,r=I.t.rowHeaders.urlIcon,t=new u.CQ(new u.lg("urlIcon"),"Visual_Tablix_UrlIcon",[b,p,r],function(s){return g.getLocalizedString(s)});return t.addGroup("urlIcon",function(n){(f===i.Y.Table||f===i.Y.TableEx||f===i.Y.PivotTable)&&n.addSimpleSlice("values",new u.bd({descriptor:b,value:a.values.urlIcon}).build(),function(s){return s.withCustomDisplayName("Visual_Tablix_Values")}),f===i.Y.PivotTable&&n.addSimpleSlice("columnheaders",new u.bd({descriptor:p,value:C.columnHeaders.urlIcon}).build(),function(s){return s.withCustomDisplayName("Visual_Tablix_ColumnHeaders")}).addSimpleSlice("rowheaders",new u.bd({descriptor:r,value:C.rowHeaders.urlIcon}).build(),function(s){return s.withCustomDisplayName("Visual_Tablix_RowHeaders")})}),t.build()},B.prototype.getImageSizeCard=function(g,a,f,b){var C=f===i.Y.TableEx?U.Z.grid.imageHeight:I.t.grid.imageHeight,p=f===i.Y.TableEx?U.Z.grid.imageWidth:I.t.grid.imageWidth,e=new u.CQ(new u.lg("imageHeight"),"Visual_Tablix_ImageSize",[C,p],function(n){return g.getLocalizedString(n)});return e.addGroup("imageHeight",function(t){t.addSimpleSlice("imageHeight",new u.mu({descriptor:C,value:a.grid.imageHeight,options:{minValue:{type:0,value:B.ImageSizeMin},maxValue:{type:1,value:B.ImageSizeMax},unitSymbol:ce.e_}}).build()),b.tablixImageWidth&&t.addSimpleSlice("imageWidth",new u.mu({descriptor:p,value:a.grid.imageWidth,options:{minValue:{type:0,value:B.ImageSizeMin},maxValue:{type:1,value:B.ImageSizeMax},unitSymbol:ce.e_}}).build())}),e.build()},B.prototype.getSparklinesCard=function(g,a,f){var b=this;if(!_.isEmpty(g)&&this.hasSparklines(g)){var C=function(e){return a.getLocalizedString(e)},p=f===i.Y.TableEx?U.Z.sparklines:I.t.sparklines;return new u.CQ(new u.lg("sparklines"),"Sparkline_Label",p,C).addGroup("columns",function(r){return r.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(e){var t;e.withDisplayName("Sparkline_Singular_Label");for(var n=function(H){if(!(null===(t=H.type.misc)||void 0===t?void 0:t.sparkline))return"continue";var M=H?.objects,Y={metadata:H.queryName};e.addContainerItem(H.queryName,H.displayName,function(ie){var ue=o.FX.PropSparklinesChartType.setInstanceProperty(void 0,M);ie.addGroup("sparklines",function(ee){return ee.withDisplayName("Sparkline_Singular_Label").addSimpleSlice("chartType",new u.uY({descriptor:(0,V.__assign)((0,V.__assign)({},p.chartType),{selector:Y}),value:ue}).build()).addSimpleSlice("dataColor",new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},p.dataColor),{selector:Y}),value:{value:b.tablixProperties.PropSparklinesDataColor.setInstanceProperty(void 0,M).solid.color}}).build()).addSimpleSlice("strokeWidth",new u.JN({descriptor:(0,V.__assign)((0,V.__assign)({},p.strokeWidth),{selector:Y}),value:o.FX.PropSparklinesStrokeWidth.setInstanceProperty(void 0,M),localize:C,options:{minValue:{type:0,value:1},maxValue:{type:1,value:4}}}).build(),function(se){return se.withHidden(ue!==S.U.line)})}),ue===S.U.line&&ie.addGroup("markers",function(ee){var se=o.FX.PropSparklinesMarkerType.getValue(M);ee.withDisplayName("Marker").addSimpleSlice("markers",new u.oM({descriptor:(0,V.__assign)((0,V.__assign)({},p.markers),{selector:Y}),value:se}).build()),null!=se&&0!==se&&ee.addSimpleSlice("markerColor",new u.BT({descriptor:(0,V.__assign)((0,V.__assign)({},p.markerColor),{selector:Y}),value:{value:b.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(void 0,M).solid.color}}).build()).addSimpleSlice("markerShape",new u.uY({descriptor:(0,V.__assign)((0,V.__assign)({},p.markerShape),{selector:Y}),value:o.FX.PropSparklinesMarkerShape.setInstanceProperty(void 0,M)}).build()).addSimpleSlice("markerSize",new u.JN({descriptor:(0,V.__assign)((0,V.__assign)({},p.markerSize),{selector:Y}),value:o.FX.PropSparklinesMarkerSize.setInstanceProperty(void 0,M),localize:C,options:{minValue:{type:0,value:3},maxValue:{type:1,value:5}}}).build())})})},s=0,m=g;s<m.length;s++)n(m[s])})}).build()}},B.prototype.hasSparklines=function(g){for(var a,f=0,b=g;f<b.length;f++)if(null===(a=b[f].type.misc)||void 0===a?void 0:a.sparkline)return!0;return!1},B.prototype.enumerateObjectInstances=function(g,a,f,b,C,p,r,e){void 0===p&&(p={}),void 0===r&&(r=!1),l.fF.assertValue(f,"dataView can't be undefined");var s,t=B.getMetadataObjects(f),n=this.getTablixTextClassProperties(e);switch(s=b===i.Y.Table?this.shouldShowTableTotalsOption(f)&&o.FX.PropGeneralTableTotals.getValue(t):this.shouldShowColumnSubtotalsOption(f)&&o.FX.PropGeneralMatrixColumnSubtotals.getValue(t)||this.shouldShowRowSubtotalsOption(f)&&o.FX.PropGeneralMatrixRowSubtotals.getValue(t),g.objectName){case o.FX.ObjectGeneral:this.enumerateGeneralOptions(a,t,b,f);break;case o.FX.ObjectGrid:this.enumerateGridOptions(a,t,b,n,p);break;case o.FX.ObjectColumnHeaders:this.enumerateColumnHeadersOptions(a,t,b,n,p);break;case o.FX.ObjectRowHeaders:this.enumerateRowHeadersOptions(a,t,b,r,n,p);break;case o.FX.ObjectValues:this.enumerateValuesOptions(a,t,b,n,p);break;case o.FX.ObjectTotal:b===i.Y.TableEx?this.enumerateTotalOptions(a,t,i.Y.TableEx,C,p,n):s&&(b===i.Y.Table?this.enumerateTotalOptions(a,t,i.Y.TableEx,C,p,n):this.enumerateGrandTotalOptions(a,t,b,n));break;case o.FX.ObjectColumnTotal:b===i.Y.PivotTable&&this.enumerateColumnGrandTotalOptions(a,t,n,p);break;case o.FX.ObjectRowTotal:b===i.Y.PivotTable&&this.enumerateRowGrandTotalOptions(a,t,n,p);break;case o.FX.ObjectSubTotals:(s||b===i.Y.PivotTable)&&this.enumerateSubTotalsOptions(a,t,b,f,C,p,n);break;case o.FX.ObjectColumnFormatting:this.enumerateColumnFormattingOptions(a,this.getColumnsMetadata(f,b),b);break;case o.FX.ObjectSparklines:this.enumerateSparklines(a,this.getColumnsMetadata(f,b))}},B.prototype.getColumnsMetadata=function(g,a){switch(a){case i.Y.Table:case i.Y.TableEx:return this.getTableColumnMetadata(g);case i.Y.Matrix:case i.Y.PivotTable:return this.getMatrixValuesColumnMetadata(g);default:return void l.fF.assertFail("TablixUtils.enumerateObjectInstances - Unexpected tablixType: "+a)}},B.prototype.getTableColumnMetadata=function(g){if(g&&g.table&&!_.isEmpty(g.table.columns))return g.table.columns},B.prototype.getMatrixRowsColumnMetadata=function(g){if(g&&g.matrix&&!_.isEmpty(g.matrix.rows)){for(var a=[],f=0,b=g.matrix.rows.levels;f<b.length;f++)for(var p=0,r=b[f].sources;p<r.length;p++)a.push(r[p]);return a}},B.prototype.getMatrixColumnsColumnMetadata=function(g){if(g&&g.matrix&&!_.isEmpty(g.matrix.columns)){for(var a=[],f=0,b=g.matrix.columns.levels;f<b.length;f++)for(var p=0,r=b[f].sources;p<r.length;p++)a.push(r[p]);return a}},B.prototype.getMatrixValuesColumnMetadata=function(g){if(g&&g.matrix&&!_.isEmpty(g.matrix.valueSources))return g.matrix.valueSources},B.prototype.createVisualObjectInstance=function(g,a,f){void 0===a&&(a=null);var b={selector:a,objectName:g,properties:{}};return null!=f&&(b.displayName=f),b},B.prototype.enumerateGeneralOptions=function(g,a,f,b){var C=this.createVisualObjectInstance(o.FX.ObjectGeneral);switch(f){case i.Y.Table:o.FX.PropGeneralAutoSizeColumns.setInstanceProperty(C,a),o.FX.PropGeneralTextSize.setInstanceProperty(C,a),this.shouldShowTableTotalsOption(b)&&o.FX.PropGeneralTableTotals.setInstanceProperty(C,a);break;case i.Y.Matrix:o.FX.PropGeneralAutoSizeColumns.setInstanceProperty(C,a),o.FX.PropGeneralTextSize.setInstanceProperty(C,a),this.shouldShowRowSubtotalsOption(b)&&o.FX.PropGeneralMatrixRowSubtotals.setInstanceProperty(C,a),this.shouldShowColumnSubtotalsOption(b)&&o.FX.PropGeneralMatrixColumnSubtotals.setInstanceProperty(C,a)}g.pushInstance(C)},B.prototype.enumerateGridOptions=function(g,a,f,b,C){var p=this.createVisualObjectInstance(o.FX.ObjectGrid),r=b.labelFontProperties.size&&b.labelFontProperties.size.pt,e=o.FX.PropGridVertical.getValue(a);o.FX.PropGridVertical.setInstanceProperty(p,a),e&&(this.tablixProperties.PropGridVerticalColor.setInstanceProperty(p,a),o.FX.PropGridVerticalWeight.setInstanceProperty(p,a));var t=f===i.Y.Table||f===i.Y.TableEx,n=(t?o.FX.PropGridHorizontalTable:o.FX.PropGridHorizontalMatrix).getValue(a);(t?o.FX.PropGridHorizontalTable:o.FX.PropGridHorizontalMatrix).setInstanceProperty(p,a),n&&(this.tablixProperties.PropGridHorizontalColor.setInstanceProperty(p,a),o.FX.PropGridHorizontalWeight.setInstanceProperty(p,a)),o.FX.PropGridRowPadding.setInstanceProperty(p,a),(f===i.Y.PivotTable||f===i.Y.TableEx)&&o.FX.PropGridOutlineStyle.setInstanceProperty(p,a,this.outlineOverrideFn,o.e9),this.tablixProperties.PropGridOutlineColor.setInstanceProperty(p,a),o.FX.PropGridOutlineWeight.setInstanceProperty(p,a),(f===i.Y.PivotTable||f===i.Y.TableEx)&&o.FX.PropGridPivotTableTextSize.setInstanceProperty(p,a,b.fontSizeOverrideFn,r),o.FX.PropGridImageHeight.setInstanceProperty(p,a),g.pushInstance(p)},B.prototype.enumerateColumnHeadersOptions=function(g,a,f,b,C){var p=this.createVisualObjectInstance(o.FX.ObjectColumnHeaders),r=b.labelFontProperties.size&&b.labelFontProperties.size.pt;if(this.tablixProperties.PropColumnsFontColor.setInstanceProperty(p,a,b.fontColorOverrideFn,b.labelFontProperties.color),this.tablixProperties.PropColumnsBackColor.setInstanceProperty(p,a),f===i.Y.PivotTable||f===i.Y.TableEx){var t=this.ensureOutline(o.FX.PropColumnsOutlineStyle.getValue(a),a,o.UR);o.FX.PropColumnsOutlineStyle.setInstanceProperty(p,a,this.outlineOverrideFn,t);var n=this.ensureOutlineWeight(o.FX.PropColumnsOutlineWeight.getValue(a),a);o.FX.PropColumnsOutlineWeight.setInstanceProperty(p,a,this.outlineOverrideFn,n);var s=this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(a),a);this.tablixProperties.PropColumnsOutlineColor.setInstanceProperty(p,a,this.outlineOverrideFn,s),o.FX.PropColumnPivotTableAutoSizeColumns.setInstanceProperty(p,a),o.FX.PropColumnsFontFamily.setInstanceProperty(p,a,b.fontFamilyOverrideFn,b.labelFontProperties.family),o.FX.PropColumnsFontSize.setInstanceProperty(p,a,b.fontSizeOverrideFn,r),o.FX.PropColumnsBold.setInstanceProperty(p,a),o.FX.PropColumnsItalic.setInstanceProperty(p,a),o.FX.PropColumnsUnderline.setInstanceProperty(p,a),o.FX.PropColumnsAlignment.setInstanceProperty(p,a)}else o.FX.PropColumnsOutline.setInstanceProperty(p,a);f===i.Y.PivotTable&&(o.FX.PropColumnsAlignmentTitle.setInstanceProperty(p,a),o.FX.PropColumnsUrlIcon.setInstanceProperty(p,a)),(f===i.Y.Table||f===i.Y.TableEx||f===i.Y.PivotTable)&&o.FX.PropColumnsWordWrap.setInstanceProperty(p,a),g.pushInstance(p)},B.prototype.enumerateRowHeadersOptions=function(g,a,f,b,C,p){void 0===b&&(b=!1);var r=this.createVisualObjectInstance(o.FX.ObjectRowHeaders),e=C.labelFontProperties.size&&C.labelFontProperties.size.pt;if(this.tablixProperties.PropRowsFontColor.setInstanceProperty(r,a,C.fontColorOverrideFn,C.labelFontProperties.color),this.tablixProperties.PropRowsBackColor.setInstanceProperty(r,a),f===i.Y.PivotTable||f===i.Y.TableEx){var n=this.ensureOutline(o.FX.PropRowsOutlineStyle.getValue(a),a,o.Pi);o.FX.PropRowsOutlineStyle.setInstanceProperty(r,a,this.outlineOverrideFn,n)}else o.FX.PropRowsOutline.setInstanceProperty(r,a);if(f===i.Y.PivotTable){var s=this.ensureOutlineWeight(o.FX.PropRowsOutlineWeight.getValue(a),a);o.FX.PropRowsOutlineWeight.setInstanceProperty(r,a,this.outlineOverrideFn,s);var m=this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(a),a);this.tablixProperties.PropRowsOutlineColor.setInstanceProperty(r,a,this.outlineOverrideFn,m),o.FX.PropRowsSteppedLayout.setInstanceProperty(r,a)&&o.FX.PropRowsSteppedLayoutIndentation.setInstanceProperty(r,a),o.FX.PropRowsUrlIcon.setInstanceProperty(r,a),o.FX.PropGeneralMatrixLayout.setInstanceProperty(r,a)!==h.t.Compact&&o.FX.PropRowsRepeatRowHeaders.setInstanceProperty(r,a)}(f===i.Y.Matrix||f===i.Y.PivotTable)&&o.FX.PropRowsWordWrap.setInstanceProperty(r,a),(f===i.Y.PivotTable||f===i.Y.TableEx)&&(o.FX.PropRowsFontFamily.setInstanceProperty(r,a,C.fontFamilyOverrideFn,C.labelFontProperties.family),o.FX.PropRowsFontSize.setInstanceProperty(r,a,C.fontSizeOverrideFn,e),o.FX.PropRowsBold.setInstanceProperty(r,a),o.FX.PropRowsItalic.setInstanceProperty(r,a),o.FX.PropRowsUnderline.setInstanceProperty(r,a),o.FX.PropRowsAlignment.setInstanceProperty(r,a)),f===i.Y.PivotTable&&b&&(o.FX.PropRowsShowExpandCollapseButtons.setInstanceProperty(r,a),o.FX.PropRowsShowExpandCollapseButtons.getValue(a)&&(this.tablixProperties.PropRowsExpandCollapseButtonsColor.setInstanceProperty(r,a),o.FX.PropRowsExpandCollapseButtonsSize.setInstanceProperty(r,a))),g.pushInstance(r)},B.prototype.enumerateValuesOptions=function(g,a,f,b,C){var p=this.createVisualObjectInstance(o.FX.ObjectValues),r=b.labelFontProperties.size&&b.labelFontProperties.size.pt;if(this.tablixProperties.PropValuesFontColorPrimary.setInstanceProperty(p,a,b.fontColorOverrideFn,b.labelFontProperties.color),this.tablixProperties.PropValuesBackColorPrimary.setInstanceProperty(p,a),this.tablixProperties.PropValuesFontColorSecondary.setInstanceProperty(p,a),this.tablixProperties.PropValuesBackColorSecondary.setInstanceProperty(p,a),f===i.Y.PivotTable&&(o.FX.PropValuesBandedRowHeaders.setInstanceProperty(p,a),o.FX.PropValuesOnRow.setInstanceProperty(p,a)),f===i.Y.PivotTable||f===i.Y.TableEx){var t=this.ensureOutline(o.FX.PropValuesOutlineStyle.getValue(a),a,o.IC);o.FX.PropValuesOutlineStyle.setInstanceProperty(p,a,this.outlineOverrideFn,t);var n=this.ensureOutlineWeight(o.FX.PropValuesOutlineWeight.getValue(a),a);o.FX.PropValuesOutlineWeight.setInstanceProperty(p,a,this.outlineOverrideFn,n);var s=this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(a),a);this.tablixProperties.PropValuesOutlineColor.setInstanceProperty(p,a,this.outlineOverrideFn,s)}else o.FX.PropValuesOutline.setInstanceProperty(p,a);(f===i.Y.Table||f===i.Y.TableEx||f===i.Y.PivotTable)&&o.FX.PropValuesUrlIcon.setInstanceProperty(p,a),(f===i.Y.PivotTable||f===i.Y.TableEx)&&(o.FX.PropValuesWordWrap.setInstanceProperty(p,a),o.FX.PropValuesFontFamily.setInstanceProperty(p,a,b.fontFamilyOverrideFn,b.labelFontProperties.family),o.FX.PropValuesFontSize.setInstanceProperty(p,a,b.fontSizeOverrideFn,r),o.FX.PropValuesBold.setInstanceProperty(p,a),o.FX.PropValuesItalic.setInstanceProperty(p,a),o.FX.PropValuesUnderline.setInstanceProperty(p,a)),g.pushInstance(p)},B.prototype.enumerateTotalOptions=function(g,a,f,b,C,p){var r=this.createVisualObjectInstance(o.FX.ObjectTotal),e=p.boldLabelFontProperties.size&&p.boldLabelFontProperties.size.pt;if(f!==i.Y.TableEx||o.FX.PropTotalTableExTotals.setInstanceProperty(r,a)){if(f===i.Y.TableEx){var n=o.FX.PropTotalTableExTotalLabel.getValue(a,!0)||b(d.qT);r.properties[o.FX.PropTotalTableExTotalLabel.propertyName]=n}if(this.tablixProperties.PropTotalFontColor.setInstanceProperty(r,a,p.fontColorOverrideFn,p.boldLabelFontProperties.color),this.tablixProperties.PropTotalBackColor.setInstanceProperty(r,a),f===i.Y.PivotTable||f===i.Y.TableEx){var m=this.ensureOutline(o.FX.PropTotalOutlineStyle.getValue(a),a,o.Sc);o.FX.PropTotalOutlineStyle.setInstanceProperty(r,a,this.outlineOverrideFn,m)}else o.FX.PropTotalOutline.setInstanceProperty(r,a);if(f===i.Y.TableEx){var w=this.ensureOutlineWeight(o.FX.PropTotalOutlineWeight.getValue(a),a);o.FX.PropTotalOutlineWeight.setInstanceProperty(r,a,this.outlineOverrideFn,w);var O=this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(a),a);this.tablixProperties.PropTotalOutlineColor.setInstanceProperty(r,a,this.outlineOverrideFn,O)}(f===i.Y.PivotTable||f===i.Y.TableEx)&&(o.FX.PropTotalFontFamily.setInstanceProperty(r,a,p.fontFamilyOverrideFn,p.boldLabelFontProperties.family),o.FX.PropTotalFontSize.setInstanceProperty(r,a,p.fontSizeOverrideFn,e),o.FX.PropTotalBold.setInstanceProperty(r,a),o.FX.PropTotalItalic.setInstanceProperty(r,a),o.FX.PropTotalUnderline.setInstanceProperty(r,a))}g.pushInstance(r)},B.prototype.enumerateGrandTotalOptions=function(g,a,f,b){if(f!==i.Y.PivotTable){var C=this.createVisualObjectInstance(o.FX.ObjectTotal),p=b.boldLabelFontProperties.size&&b.boldLabelFontProperties.size.pt;this.tablixProperties.PropGrandTotalFontColor.setInstanceProperty(C,a,b.fontColorOverrideFn,b.boldLabelFontProperties.color),o.FX.PropGrandTotalFontFamily.setInstanceProperty(C,a),this.tablixProperties.PropGrandTotalBackColor.setInstanceProperty(C,a),o.FX.PropGrandTotalApplyToHeaders.setInstanceProperty(C,a),f===i.Y.TableEx&&(o.FX.PropGrandTotalFontFamily.setInstanceProperty(C,a,b.fontFamilyOverrideFn,b.boldLabelFontProperties.family),o.FX.PropGrandTotalFontSize.setInstanceProperty(C,a,b.fontSizeOverrideFn,p),o.FX.PropGrandTotalBold.setInstanceProperty(C,a),o.FX.PropGrandTotalItalic.setInstanceProperty(C,a),o.FX.PropGrandTotalUnderline.setInstanceProperty(C,a)),g.pushInstance(C)}},B.prototype.enumerateColumnGrandTotalOptions=function(g,a,f,b){var C=this.createVisualObjectInstance(o.FX.ObjectColumnTotal),p=f.boldLabelFontProperties.size&&f.boldLabelFontProperties.size.pt;this.tablixProperties.PropColumnGrandTotalFontColor.setInstanceProperty(C,a,f.fontColorOverrideFn,f.boldLabelFontProperties.color),o.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(C,a),this.tablixProperties.PropColumnGrandTotalBackColor.setInstanceProperty(C,a),o.FX.PropColumnGrandTotalApplyToHeaders.setInstanceProperty(C,a),o.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(C,a,f.fontFamilyOverrideFn,f.boldLabelFontProperties.family),o.FX.PropColumnGrandTotalFontSize.setInstanceProperty(C,a,f.fontSizeOverrideFn,p),o.FX.PropColumnGrandTotalBold.setInstanceProperty(C,a),o.FX.PropColumnGrandTotalItalic.setInstanceProperty(C,a),o.FX.PropColumnGrandTotalUnderline.setInstanceProperty(C,a),g.pushInstance(C)},B.prototype.enumerateRowGrandTotalOptions=function(g,a,f,b){var C=this.createVisualObjectInstance(o.FX.ObjectRowTotal),p=f.boldLabelFontProperties.size&&f.boldLabelFontProperties.size.pt;this.tablixProperties.PropRowGrandTotalFontColor.setInstanceProperty(C,a,f.fontColorOverrideFn,f.boldLabelFontProperties.color),o.FX.PropRowGrandTotalFontFamily.setInstanceProperty(C,a),this.tablixProperties.PropRowGrandTotalBackColor.setInstanceProperty(C,a),o.FX.PropRowGrandTotalApplyToHeaders.setInstanceProperty(C,a),o.FX.PropRowGrandTotalFontFamily.setInstanceProperty(C,a,f.fontFamilyOverrideFn,f.boldLabelFontProperties.family),o.FX.PropRowGrandTotalFontSize.setInstanceProperty(C,a,f.fontSizeOverrideFn,p),o.FX.PropRowGrandTotalBold.setInstanceProperty(C,a),o.FX.PropRowGrandTotalItalic.setInstanceProperty(C,a),o.FX.PropRowGrandTotalUnderline.setInstanceProperty(C,a),g.pushInstance(C)},B.prototype.enumerateSubTotalsOptions=function(g,a,f,b,C,p,r){var n,s,m,e=!1,t=!1;if(f===i.Y.PivotTable){l.fF.assertValue(C,"enumerateSubTotalsOptions - localizer"),n=C(d.qT);var w=this.createVisualObjectInstance(o.FX.ObjectSubTotals);this.shouldShowRowSubtotalsOption(b)&&(e=o.FX.PropSubTotalsPivotTableRowSubtotals.setInstanceProperty(w,a)),e&&(s=o.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(a,!0)||n,w.properties[o.FX.PropSubTotalsPivotTableRowSubtotalsLabel.propertyName]=s),g.pushInstance(w)}if(this.enumerateSubtotalsFontProperties(g,a,r,p,f,"Row"),e){w=this.createVisualObjectInstance(o.FX.ObjectSubTotals),o.FX.PropSubTotalsPivotTableRowSubtotalsPosition.setInstanceProperty(w,a),g.pushInstance(w),w=this.createVisualObjectInstance(o.FX.ObjectSubTotals);var O=o.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(w,a);g.pushInstance(w,!1),O&&this.enumeratePerLevelSubtotals(g,b.matrix.rows.levels,s,C)}f===i.Y.PivotTable&&(w=this.createVisualObjectInstance(o.FX.ObjectSubTotals),this.shouldShowColumnSubtotalsOption(b)&&(t=o.FX.PropSubTotalsPivotTableColumnSubtotals.setInstanceProperty(w,a)),t&&(m=o.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(a,!0)||n,w.properties[o.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.propertyName]=m),g.pushInstance(w,!1)),this.enumerateSubtotalsFontProperties(g,a,r,p,f,"Column"),t&&(w=this.createVisualObjectInstance(o.FX.ObjectSubTotals),O=o.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.setInstanceProperty(w,a),g.pushInstance(w,!1),l.fF.assert(function(){return!_.isEmpty(b.matrix.columns.levels)},"enumerateSubTotalsOptions: Empty column levels"),O&&this.enumeratePerLevelSubtotals(g,b.matrix.columns.levels,m,C))},B.prototype.enumerateSubtotalsFontProperties=function(g,a,f,b,C,p){var e=this.createVisualObjectInstance(o.FX.ObjectSubTotals,p?{id:p}:void 0),t=f.boldLabelFontProperties.size&&f.boldLabelFontProperties.size.pt;this.tablixProperties.PropSubTotalsFontColor.setInstanceProperty(e,a,f.fontColorOverrideFn,f.boldLabelFontProperties.color,p),o.FX.PropSubTotalsFontFamily.setInstanceProperty(e,a,void 0,void 0,p),this.tablixProperties.PropSubTotalsBackColor.setInstanceProperty(e,a,void 0,void 0,p),C===i.Y.PivotTable&&(o.FX.PropSubTotalsFontFamily.setInstanceProperty(e,a,f.fontFamilyOverrideFn,f.boldLabelFontProperties.family,p),o.FX.PropSubTotalsFontSize.setInstanceProperty(e,a,f.fontSizeOverrideFn,t,p),o.FX.PropSubTotalsBold.setInstanceProperty(e,a,void 0,void 0,p),o.FX.PropSubTotalsItalic.setInstanceProperty(e,a,void 0,void 0,p),o.FX.PropSubTotalsUnderline.setInstanceProperty(e,a,void 0,void 0,p),o.FX.PropSubTotalsApplyToHeaders.setInstanceProperty(e,a,void 0,void 0,p)),g.pushInstance(e)},B.prototype.enumeratePerLevelSubtotals=function(g,a,f,b){l.fF.assert(function(){return!_.isEmpty(a)},"enumeratePerLevelSubtotals: Empty levels");for(var C=0,p=a;C<p.length;C++)for(var e=0,t=p[C].sources;e<t.length;e++){var n=t[e];if(!n.isMeasure){var s=this.createVisualObjectInstance(o.FX.ObjectSubTotals,{metadata:n.queryName},n.displayName);o.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(s,n.objects),g.pushInstance(s,!1),s=this.createVisualObjectInstance(o.FX.ObjectSubTotals,{metadata:n.queryName},b("Visual_PivotTable_TotalLabel",n.displayName));var m=o.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(n.objects,!0)||f;s.properties[o.FX.PropSubTotalsPivotTableLevelSubtotalLabel.propertyName]=m,g.pushInstance(s,!1)}}},B.prototype.enumerateColumnFormattingOptions=function(g,a,f){if(!_.isEmpty(a))for(var b=0,C=a;b<C.length;b++){var p=C[b];g.pushContainer({displayName:p.displayName});var r=p&&p.objects,e=this.createVisualObjectInstance(o.FX.ObjectColumnFormatting,{metadata:p.queryName});p.type.numeric&&(f===i.Y.PivotTable||f===i.Y.TableEx)&&(o.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(e,r),o.FX.PropColumnFormattingPrecision.setInstanceProperty(e,r),o.FX.PropColumnFormattingPrecision.setInstanceValidValues(e,{numberRange:{min:0,max:te.vo}})),this.tablixProperties.PropColumnFormattingFontColor.setInstanceProperty(e,r),this.tablixProperties.PropColumnFormattingBackColor.setInstanceProperty(e,r),(f===i.Y.PivotTable||f===i.Y.TableEx)&&o.FX.PropColumnFormattingAlignment.setInstanceProperty(e,r),o.FX.PropColumnFormattingStyleHeader.setInstanceProperty(e,r),o.FX.PropColumnFormattingStyleValues.setInstanceProperty(e,r),(f===i.Y.Matrix||f===i.Y.PivotTable)&&o.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(e,r),o.FX.PropColumnFormattingStyleTotal.setInstanceProperty(e,r),g.pushInstance(e),g.popContainer()}},B.prototype.enumerateSparklines=function(g,a){var f;if(!_.isEmpty(a))for(var b=0,C=a;b<C.length;b++){var p=C[b];if(null===(f=p.type.misc)||void 0===f?void 0:f.sparkline){g.pushContainer({displayName:p.displayName});var e=p&&p.objects,t=this.createVisualObjectInstance(o.FX.ObjectSparklines,{metadata:p.queryName});if(o.FX.PropSparklinesChartType.setInstanceProperty(t,e),this.tablixProperties.PropSparklinesDataColor.setInstanceProperty(t,e),o.FX.PropSparklinesChartType.getValue(e)===S.U.line){o.FX.PropSparklinesStrokeWidth.setInstanceProperty(t,e),o.FX.PropSparklinesStrokeWidth.setInstanceValidValues(t,{numberRange:{min:1,max:4}}),o.FX.PropSparklinesMarkerType.setInstanceProperty(t,e);var n=o.FX.PropSparklinesMarkerType.getValue(e);null!=n&&0!==n&&(this.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(t,e),o.FX.PropSparklinesMarkerSize.setInstanceProperty(t,e),o.FX.PropSparklinesMarkerSize.setInstanceValidValues(t,{numberRange:{min:3,max:5}}),o.FX.PropSparklinesMarkerShape.setInstanceProperty(t,e))}g.pushInstance(t),g.popContainer()}}},B.prototype.getTableObjects=function(g){var a=B.getMetadataObjects(g),f=o.FX.PropGeneralTextSize.getValue(a),b=null!=f?re.B.createFromPt(+f):void 0,C={general:{autoSizeColumnWidth:o.FX.PropGeneralAutoSizeColumns.getValue(a),textSize:b,totals:o.FX.PropGeneralTableTotals.getValue(a)}};C.grid={gridVertical:o.FX.PropGridVertical.getValue(a),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(a),gridVerticalWeight:o.FX.PropGridVerticalWeight.getValue(a),gridHorizontal:o.FX.PropGridHorizontalTable.getValue(a),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(a),gridHorizontalWeight:o.FX.PropGridHorizontalWeight.getValue(a),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(a),outlineWeight:o.FX.PropGridOutlineWeight.getValue(a),rowPadding:o.FX.PropGridRowPadding.getValue(a),imageHeight:o.FX.PropGridImageHeight.getValue(a)},C.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(a),backColor:this.tablixProperties.PropColumnsBackColor.getValue(a),outline:o.FX.PropColumnsOutline.getValue(a),wordWrap:o.FX.PropColumnsWordWrap.getValue(a)},C.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(a),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(a),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(a),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(a),outline:o.FX.PropValuesOutline.getValue(a),urlIcon:o.FX.PropValuesUrlIcon.getValue(a)},C.total={fontColor:this.tablixProperties.PropTotalFontColor.getValue(a),backColor:this.tablixProperties.PropTotalBackColor.getValue(a),outline:o.FX.PropTotalOutline.getValue(a)},C.columnFormatting={},C.formatters={};var p=this.getTableColumnMetadata(g);if(p)for(var r=0,e=p;r<e.length;r++){var t=e[r],n=t&&t.objects;C.columnFormatting[t.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(n),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(n),styleHeader:o.FX.PropColumnFormattingStyleHeader.getValue(n),styleValues:o.FX.PropColumnFormattingStyleValues.getValue(n),styleTotal:o.FX.PropColumnFormattingStyleTotal.getValue(n)},C.formatters[t.queryName]=new y.g({column:t,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!1})}return C},B.prototype.getMatrixObjects=function(g){var a=B.getMetadataObjects(g),f=o.FX.PropGeneralTextSize.getValue(a),b=null!=f?re.B.createFromPt(+f):void 0,C={general:{autoSizeColumnWidth:o.FX.PropGeneralAutoSizeColumns.getValue(a),textSize:b,rowSubtotals:o.FX.PropGeneralMatrixRowSubtotals.getValue(a),columnSubtotals:o.FX.PropGeneralMatrixColumnSubtotals.getValue(a),layout:o.FX.PropGeneralMatrixLayout.getValue(a)}};C.grid={gridVertical:o.FX.PropGridVertical.getValue(a),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(a),gridVerticalWeight:o.FX.PropGridVerticalWeight.getValue(a),gridHorizontal:o.FX.PropGridHorizontalMatrix.getValue(a),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(a),gridHorizontalWeight:o.FX.PropGridHorizontalWeight.getValue(a),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(a),outlineWeight:o.FX.PropGridOutlineWeight.getValue(a),rowPadding:o.FX.PropGridRowPadding.getValue(a),imageHeight:o.FX.PropGridImageHeight.getValue(a)},C.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(a),backColor:this.tablixProperties.PropColumnsBackColor.getValue(a),outline:o.FX.PropColumnsOutline.getValue(a)},C.rowHeaders={fontColor:this.tablixProperties.PropRowsFontColor.getValue(a),backColor:this.tablixProperties.PropRowsBackColor.getValue(a),outline:o.FX.PropRowsOutline.getValue(a),wordWrap:o.FX.PropRowsWordWrap.getValue(a),repeatRowHeaders:o.FX.PropRowsRepeatRowHeaders.getValue(a)},C.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(a),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(a),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(a),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(a),outline:o.FX.PropValuesOutline.getValue(a)},C.grandTotal={fontColor:this.tablixProperties.PropGrandTotalFontColor.getValue(a),backColor:this.tablixProperties.PropGrandTotalBackColor.getValue(a),applyToHeaders:o.FX.PropGrandTotalApplyToHeaders.getValue(a)},C.subtotals={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(a),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(a)},C.columnFormatting={},C.formatters={};var p=this.getMatrixValuesColumnMetadata(g);if(p)for(var r=0,e=p;r<e.length;r++){var t=e[r],n=t&&t.objects;C.columnFormatting[t.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(n),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(n),styleHeader:o.FX.PropColumnFormattingStyleHeader.getValue(n),styleValues:o.FX.PropColumnFormattingStyleValues.getValue(n),styleTotal:o.FX.PropColumnFormattingStyleTotal.getValue(n),styleSubTotals:o.FX.PropColumnFormattingStyleSubtotals.getValue(n)},C.formatters[t.queryName]=new y.g({column:t,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!1})}return this.addMatrixHierarchyColumnsFormatters(g.matrix.rows,C.formatters),this.addMatrixHierarchyColumnsFormatters(g.matrix.columns,C.formatters),C},B.prototype.addMatrixHierarchyColumnsFormatters=function(g,a,f){if(g){l.fF.assertValue(g.levels,"getMatrixHierarchyColumnsMetadata - hierarchy.levels");for(var b=0,C=g.levels;b<C.length;b++){var p=C[b];l.fF.assertValue(p.sources,"getMatrixHierarchyColumnsMetadata - level.sources");for(var r=0,e=p.sources;r<e.length;r++){var t=e[r];if(!t.isMeasure){var n=t.queryName;a[n]=new y.g({column:t,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!1}),f&&(f[n]=new y.g({column:t,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!0}))}}}}},B.prototype.addMatrixHierarchySubtotalLabels=function(g,a,f,b){if(g){l.fF.assertValue(g.levels,"getMatrixHierarchyColumnsProperties - hierarchy.levels");for(var C=0,p=g.levels;C<p.length;C++){var r=p[C];l.fF.assertValue(r.sources,"getMatrixHierarchyColumnsProperties - level.sources");for(var e=void 0,t=0,n=r.sources;t<n.length;t++){var s=n[t];s.isMeasure||(b&&(e=o.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(s.objects)),e||(e=f),a[s.queryName]={subtotalLabel:e})}}}},B.prototype.getPivotTableObjects=function(g,a,f,b,C,p){var r,e,t,n,s,m,w,O,H;void 0===p&&(p=!1);var v=B.getMetadataObjects(g),M=this.getTablixTextClassProperties(b),Y=M.labelFontProperties.size&&M.labelFontProperties.size.pt,ie=M.boldLabelFontProperties.size&&M.boldLabelFontProperties.size.pt,ue=o.FX.PropGridPivotTableTextSize.getValue(v,void 0,M.fontSizeOverrideFn,Y),ee=null!=ue?re.B.createFromPt(+ue):void 0,se=o.FX.PropColumnsFontSize.getValue(v,void 0,M.fontSizeOverrideFn,Y),pe=null!=se?re.B.createFromPt(+se):void 0,fe=o.FX.PropRowsFontSize.getValue(v,void 0,M.fontSizeOverrideFn,Y),ge=null!=fe?re.B.createFromPt(+fe):void 0,Se=o.FX.PropRowsExpandCollapseButtonsSize.getValue(v),Me=null!=Se?re.B.createFromPt(+Se):void 0,He=o.FX.PropRowsExpandCompositeHierarchy.getValue(v),ve=o.FX.PropValuesFontSize.getValue(v,void 0,M.fontSizeOverrideFn,Y),_e=null!=ve?re.B.createFromPt(+ve):void 0,R=o.FX.PropGrandTotalFontSize.getValue(v,void 0,M.fontSizeOverrideFn,ie),N=(null!=R&&re.B.createFromPt(+R),o.FX.PropColumnGrandTotalFontSize.getValue(v,void 0,M.fontSizeOverrideFn,ie,void 0,["Column"])),Z=null!=N?re.B.createFromPt(+N):void 0,ne=o.FX.PropRowGrandTotalFontSize.getValue(v,void 0,M.fontSizeOverrideFn,ie,void 0,["Row"]),he=null!=ne?re.B.createFromPt(+ne):void 0,ye=o.FX.PropSubTotalsFontSize.getValue(v,void 0,M.fontSizeOverrideFn,ie),xe=(null!=ye&&re.B.createFromPt(+ye),o.FX.PropSubTotalsFontSize.getValue(v,void 0,M.fontSizeOverrideFn,ie,"Row")),Te=null!=xe?re.B.createFromPt(+xe):void 0,Pe=o.FX.PropSubTotalsFontSize.getValue(v,void 0,M.fontSizeOverrideFn,ie,"Column"),Ve=null!=Pe?re.B.createFromPt(+Pe):void 0,Ne=a(d.qT),Xe=o.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(v)||Ne,ke=o.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(v)||Ne,Oe=o.FX.PropRowsSteppedLayout.getValue(v),We=o.FX.PropGeneralMatrixLayout.getValue(v)||(Oe?h.t.Compact:h.t.Outline);C.matrixLayouts&&(Oe=We===h.t.Compact);var Ye={showBlankRows:o.FX.PropBlankRowsShowBlankRows.getValue(v),blankRowColor:null!==(r=this.tablixProperties.PropBlankRowsBlankRowColor.getValue(v))&&void 0!==r?r:this.tablixProperties.PropValuesBackColorPrimary.getValue(v),blankRowTransparency:o.FX.PropBlankRowsTransparency.getValue(v),showBorder:o.FX.PropBlankRowsShowBorder.getValue(v),borderPosition:null!==(e=o.FX.PropBlankRowsBorderPosition.getValue(v))&&void 0!==e?e:"Top",borderColor:null!==(t=this.tablixProperties.PropBlankRowsBorderColor.getValue(v))&&void 0!==t?t:b.colorPalette.foregroundNeutralSecondary.value,borderTransparency:o.FX.PropBlankRowsBorderTransparency.getValue(v),borderWidth:o.FX.PropBlankRowsBorderWidth.getValue(v)},je={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(v,void 0,M.fontColorOverrideFn,M.boldLabelFontProperties.color,"Row"),fontFamily:o.FX.PropSubTotalsFontFamily.getValue(v,void 0,M.fontFamilyOverrideFn,M.boldLabelFontProperties.family,"Row"),fontSize:Te,bold:o.FX.PropSubTotalsBold.getValue(v,void 0,void 0,void 0,"Row"),italic:o.FX.PropSubTotalsItalic.getValue(v,void 0,void 0,void 0,"Row"),underline:o.FX.PropSubTotalsUnderline.getValue(v,void 0,void 0,void 0,"Row"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(v,void 0,void 0,void 0,"Row"),applyToHeaders:o.FX.PropSubTotalsApplyToHeaders.getValue(v,void 0,void 0,void 0,"Row")},Ke={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(v,void 0,M.fontColorOverrideFn,M.boldLabelFontProperties.color,"Column"),fontFamily:o.FX.PropSubTotalsFontFamily.getValue(v,void 0,M.fontFamilyOverrideFn,M.boldLabelFontProperties.family,"Column"),fontSize:Ve,bold:o.FX.PropSubTotalsBold.getValue(v,void 0,void 0,void 0,"Column"),italic:o.FX.PropSubTotalsItalic.getValue(v,void 0,void 0,void 0,"Column"),underline:o.FX.PropSubTotalsUnderline.getValue(v,void 0,void 0,void 0,"Column"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(v,void 0,void 0,void 0,"Column"),applyToHeaders:o.FX.PropSubTotalsApplyToHeaders.getValue(v,void 0,void 0,void 0,"Column")},Ze={fontColor:this.tablixProperties.PropColumnGrandTotalFontColor.getValue(v,void 0,M.fontColorOverrideFn,M.boldLabelFontProperties.color,void 0,["Column"]),fontFamily:o.FX.PropColumnGrandTotalFontFamily.getValue(v,void 0,M.fontFamilyOverrideFn,M.boldLabelFontProperties.family,void 0,["Column"]),fontSize:Z,bold:o.FX.PropColumnGrandTotalBold.getValue(v),italic:o.FX.PropColumnGrandTotalItalic.getValue(v),underline:o.FX.PropColumnGrandTotalUnderline.getValue(v),backColor:this.tablixProperties.PropColumnGrandTotalBackColor.getValue(v),applyToHeaders:o.FX.PropColumnGrandTotalApplyToHeaders.getValue(v)},Qe={fontColor:this.tablixProperties.PropRowGrandTotalFontColor.getValue(v,void 0,M.fontColorOverrideFn,M.boldLabelFontProperties.color,void 0,["Row"]),fontFamily:o.FX.PropRowGrandTotalFontFamily.getValue(v,void 0,M.fontFamilyOverrideFn,M.boldLabelFontProperties.family,void 0,["Row"]),fontSize:he,bold:o.FX.PropRowGrandTotalBold.getValue(v),italic:o.FX.PropRowGrandTotalItalic.getValue(v),underline:o.FX.PropRowGrandTotalUnderline.getValue(v),backColor:this.tablixProperties.PropRowGrandTotalBackColor.getValue(v),applyToHeaders:o.FX.PropRowGrandTotalApplyToHeaders.getValue(v)},Ce={general:{autoSizeColumnWidth:o.FX.PropColumnPivotTableAutoSizeColumns.getValue(v),textSize:ee,rowSubtotals:o.FX.PropSubTotalsPivotTableRowSubtotals.getValue(v),columnSubtotals:o.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(v),layout:We},grid:{gridVertical:o.FX.PropGridVertical.getValue(v),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(v),gridVerticalWeight:o.FX.PropGridVerticalWeight.getValue(v),gridHorizontal:o.FX.PropGridHorizontalMatrix.getValue(v),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(v),gridHorizontalWeight:o.FX.PropGridHorizontalWeight.getValue(v),outline:o.FX.PropGridOutlineStyle.getValue(v)||o.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(v),outlineWeight:o.FX.PropGridOutlineWeight.getValue(v),rowPadding:o.FX.PropGridRowPadding.getValue(v),imageHeight:o.FX.PropGridImageHeight.getValue(v),imageWidth:o.FX.PropGridImageWidth.getValue(v)},columnHeaders:{fontColor:this.tablixProperties.PropColumnsFontColor.getValue(v,void 0,M.fontColorOverrideFn,M.labelFontProperties.color),fontFamily:o.FX.PropColumnsFontFamily.getValue(v,void 0,M.fontFamilyOverrideFn,M.labelFontProperties.family),fontSize:pe,bold:o.FX.PropColumnsBold.getValue(v),italic:o.FX.PropColumnsItalic.getValue(v),underline:o.FX.PropColumnsUnderline.getValue(v),backColor:this.tablixProperties.PropColumnsBackColor.getValue(v),outline:this.ensureOutline(o.FX.PropColumnsOutlineStyle.getValue(v),v,o.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(v),v),outlineWeight:this.ensureOutlineWeight(o.FX.PropColumnsOutlineWeight.getValue(v),v),urlIcon:o.FX.PropColumnsUrlIcon.getValue(v),wordWrap:o.FX.PropColumnsWordWrap.getValue(v),alignment:o.FX.PropColumnsAlignment.getValue(v),titleAlignment:o.FX.PropColumnsAlignmentTitle.getValue(v)},rowHeaders:{fontColor:this.tablixProperties.PropRowsFontColor.getValue(v,void 0,M.fontColorOverrideFn,M.labelFontProperties.color),fontFamily:o.FX.PropRowsFontFamily.getValue(v,void 0,M.fontFamilyOverrideFn,M.labelFontProperties.family),fontSize:ge,bold:o.FX.PropRowsBold.getValue(v),italic:o.FX.PropRowsItalic.getValue(v),underline:o.FX.PropRowsUnderline.getValue(v),backColor:this.tablixProperties.PropRowsBackColor.getValue(v),outline:this.ensureOutline(o.FX.PropRowsOutlineStyle.getValue(v),v,o.Pi),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(v),v),outlineWeight:this.ensureOutlineWeight(o.FX.PropRowsOutlineWeight.getValue(v),v),steppedLayout:Oe,steppedLayoutIndentation:o.FX.PropRowsSteppedLayoutIndentation.getValue(v),urlIcon:o.FX.PropRowsUrlIcon.getValue(v),wordWrap:o.FX.PropRowsWordWrap.getValue(v),alignment:o.FX.PropRowsAlignment.getValue(v),showExpandCollapseButtons:!!f&&o.FX.PropRowsShowExpandCollapseButtons.getValue(v),expandCollapseButtonsColor:this.tablixProperties.PropRowsExpandCollapseButtonsColor.getValue(v),expandCollapseButtonsSize:Me,expandCompositeHierarchy:He,repeatRowHeaders:o.FX.PropRowsRepeatRowHeaders.getValue(v),legacyStyleDisabled:o.FX.PropRowsLegacyStyleDisabled.getValue(v)},values:{fontFamily:o.FX.PropValuesFontFamily.getValue(v,void 0,M.fontFamilyOverrideFn,M.labelFontProperties.family),fontSize:_e,bold:o.FX.PropValuesBold.getValue(v),italic:o.FX.PropValuesItalic.getValue(v),underline:o.FX.PropValuesUnderline.getValue(v),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(v,void 0,M.fontColorOverrideFn,M.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(v),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(v),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(v),bandedRowHeaders:o.FX.PropValuesBandedRowHeaders.getValue(v),outline:this.ensureOutline(o.FX.PropValuesOutlineStyle.getValue(v),v,o.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(v),v),outlineWeight:this.ensureOutlineWeight(o.FX.PropValuesOutlineWeight.getValue(v),v),urlIcon:o.FX.PropValuesUrlIcon.getValue(v),wordWrap:o.FX.PropValuesWordWrap.getValue(v),valuesOnRow:o.FX.PropValuesOnRow.getValue(v)},columnGrandTotal:Ze,rowGrandTotal:Qe,subtotals:{rowSubtotalsPosition:We===h.t.Tabular?c.I:o.FX.PropSubTotalsPivotTableRowSubtotalsPosition.getValue(v),rowSubtotalsLabel:Xe,columnSubtotalsLabel:ke},rowSubtotals:je,columnSubtotals:Ke,blankRows:Ye,columnFormatting:{},formatters:{},tooltipFormatters:{},sparklines:{}},Ae=this.getMatrixValuesColumnMetadata(g);if(Ae)for(var De=0,Ge=Ae;De<Ge.length;De++){var we=Ge[De],be=we&&we.objects;Ce.columnFormatting[we.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(be),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(be),alignment:o.FX.PropColumnFormattingAlignment.getValue(be),styleHeader:o.FX.PropColumnFormattingStyleHeader.getValue(be),styleValues:o.FX.PropColumnFormattingStyleValues.getValue(be),styleTotal:o.FX.PropColumnFormattingStyleTotal.getValue(be),styleSubTotals:o.FX.PropColumnFormattingStyleSubtotals.getValue(be),dataBarsSettings:o.FX.PropColumnFormattingDataBars.getValue(be),icon:o.FX.PropValuesIcon.getValue(be)};var Ee=void 0,Ie=void 0;if(we.type.numeric&&(Ee=o.FX.PropColumnFormattingDisplayUnits.getValue(be),Ie=o.FX.PropColumnFormattingPrecision.getValue(be)),Ce.formatters[we.queryName]=new y.g({column:we,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:Ee,precision:Ie,trailingZeroes:!0}),Ce.tooltipFormatters[we.queryName]=new y.g({column:we,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:Ee,precision:Ie,trailingZeroes:!0}),null!==(n=we.type.misc)&&void 0!==n&&n.sparkline){var Je=o.FX.PropSparklinesChartType.getValue(be),Ue=new ae(we.displayName,we.type,a);Ce.formatters[we.queryName]=Ue,Ce.tooltipFormatters[we.queryName]=Ue,Ce.sparklines[we.queryName]={chartType:Je,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(be).solid.color,strokeWidth:o.FX.PropSparklinesStrokeWidth.getValue(be),marker:{show:!0,typeFlags:o.FX.PropSparklinesMarkerType.getValue(be),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(be).solid.color,size:o.FX.PropSparklinesMarkerSize.getValue(be),shape:o.FX.PropSparklinesMarkerShape.getValue(be)}}}}p&&(Ce.annotationFormatting={columnHeaders:{}},_.forEach(null===(s=g.metadata)||void 0===s?void 0:s.columns,function(Le){var Be;if(null!==(Be=Le.objects)&&void 0!==Be&&Be.annotations){var ze=(0,W.NA)(Le.objects,I.t.annotations.highlights);ze&&(null!=ze.backColor||!0===ze.emphasizeText)&&(Ce.annotationFormatting.columnHeaders[Le.queryName]={backColor:ze.backColor,bold:ze.emphasizeText})}}),_.isEmpty(Ce.annotationFormatting.columnHeaders)&&(Ce.annotationFormatting=void 0));var $e=o.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(v),qe=o.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(v);return this.addMatrixHierarchySubtotalLabels(null===(m=g?.matrix)||void 0===m?void 0:m.rows,Ce.columnFormatting,Xe,$e),this.addMatrixHierarchySubtotalLabels(null===(w=g?.matrix)||void 0===w?void 0:w.columns,Ce.columnFormatting,ke,qe),this.addMatrixHierarchyColumnsFormatters(null===(O=g?.matrix)||void 0===O?void 0:O.rows,Ce.formatters,Ce.tooltipFormatters),this.addMatrixHierarchyColumnsFormatters(null===(H=g?.matrix)||void 0===H?void 0:H.columns,Ce.formatters,Ce.tooltipFormatters),Ce},B.prototype.getTableExObjects=function(g,a,f,b){var C,p=B.getMetadataObjects(g),r=this.getTablixTextClassProperties(f),e=r.labelFontProperties.size&&r.labelFontProperties.size.pt,t=r.boldLabelFontProperties.size&&r.boldLabelFontProperties.size.pt,n=o.FX.PropGridPivotTableTextSize.getValue(p),s=null!=n?re.B.createFromPt(+n):void 0,m=o.FX.PropColumnsFontSize.getValue(p,void 0,r.fontSizeOverrideFn,e),w=null!=m?re.B.createFromPt(+m):void 0,O=o.FX.PropValuesFontSize.getValue(p,void 0,r.fontSizeOverrideFn,e),H=null!=O?re.B.createFromPt(+O):void 0,v=o.FX.PropTotalFontSize.getValue(p,void 0,r.fontSizeOverrideFn,t),M=null!=v?re.B.createFromPt(+v):void 0,Y=o.FX.ProprowWithReferenceText.getValue(p),ie={general:{autoSizeColumnWidth:o.FX.PropColumnPivotTableAutoSizeColumns.getValue(p),textSize:s,totals:o.FX.PropTotalTableExTotals.getValue(p)}};ie.grid={gridVertical:o.FX.PropGridVertical.getValue(p),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(p),gridVerticalWeight:o.FX.PropGridVerticalWeight.getValue(p),gridHorizontal:o.FX.PropGridHorizontalTable.getValue(p),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(p),gridHorizontalWeight:o.FX.PropGridHorizontalWeight.getValue(p),outline:o.FX.PropGridOutlineStyle.getValue(p)||o.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(p),outlineWeight:o.FX.PropGridOutlineWeight.getValue(p),rowPadding:o.FX.PropGridRowPadding.getValue(p),imageHeight:o.FX.PropGridImageHeight.getValue(p),imageWidth:o.FX.PropGridImageWidth.getValue(p)},ie.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(p,void 0,r.fontColorOverrideFn,r.labelFontProperties.color),fontFamily:o.FX.PropColumnsFontFamily.getValue(p,void 0,r.fontFamilyOverrideFn,r.labelFontProperties.family),fontSize:w,bold:o.FX.PropColumnsBold.getValue(p),italic:o.FX.PropColumnsItalic.getValue(p),underline:o.FX.PropColumnsUnderline.getValue(p),backColor:this.tablixProperties.PropColumnsBackColor.getValue(p),outline:this.ensureOutline(o.FX.PropColumnsOutlineStyle.getValue(p),p,o.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(p),p),outlineWeight:this.ensureOutlineWeight(o.FX.PropColumnsOutlineWeight.getValue(p),p),wordWrap:o.FX.PropColumnsWordWrap.getValue(p),alignment:o.FX.PropColumnsAlignment.getValue(p)},ie.values={fontFamily:o.FX.PropValuesFontFamily.getValue(p,void 0,r.fontFamilyOverrideFn,r.labelFontProperties.family),fontSize:H,bold:o.FX.PropValuesBold.getValue(p),italic:o.FX.PropValuesItalic.getValue(p),underline:o.FX.PropValuesUnderline.getValue(p),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(p,void 0,r.fontColorOverrideFn,r.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(p),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(p),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(p),outline:this.ensureOutline(o.FX.PropValuesOutlineStyle.getValue(p),p,o.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(p),p),outlineWeight:this.ensureOutlineWeight(o.FX.PropValuesOutlineWeight.getValue(p),p),urlIcon:o.FX.PropValuesUrlIcon.getValue(p),wordWrap:o.FX.PropValuesWordWrap.getValue(p)};var ue=o.FX.PropTotalTableExTotalLabel.getValue(p);ie.total={totalLabel:ue||a(d.qT),totalPlaceholderLabel:a(d.bn),isDefaultTotalLabel:!ue,fontFamily:o.FX.PropTotalFontFamily.getValue(p,void 0,r.fontFamilyOverrideFn,r.boldLabelFontProperties.family),fontSize:M,bold:o.FX.PropTotalBold.getValue(p),italic:o.FX.PropTotalItalic.getValue(p),underline:o.FX.PropTotalUnderline.getValue(p),fontColor:this.tablixProperties.PropTotalFontColor.getValue(p,void 0,r.fontColorOverrideFn,r.boldLabelFontProperties.color),backColor:this.tablixProperties.PropTotalBackColor.getValue(p),outline:this.ensureOutline(o.FX.PropTotalOutlineStyle.getValue(p),p,o.Sc),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(p),p),outlineWeight:this.ensureOutlineWeight(o.FX.PropTotalOutlineWeight.getValue(p),p)},ie.columnFormatting={},ie.formatters={},ie.tooltipFormatters={},ie.sparklines={};var ee=this.getTableColumnMetadata(g);if(ee)for(var se=0,pe=ee;se<pe.length;se++){var fe=pe[se];if(fe){var ge=fe.objects,Se=fe.queryName;ie.columnFormatting[Se]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(ge),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(ge),alignment:o.FX.PropColumnFormattingAlignment.getValue(ge),styleHeader:o.FX.PropColumnFormattingStyleHeader.getValue(ge),styleValues:o.FX.PropColumnFormattingStyleValues.getValue(ge),styleTotal:o.FX.PropColumnFormattingStyleTotal.getValue(ge),dataBarsSettings:o.FX.PropColumnFormattingDataBars.getValue(ge),icon:o.FX.PropValuesIcon.getValue(ge)};var Me=void 0,He=void 0;if(fe.type.numeric&&(Me=o.FX.PropColumnFormattingDisplayUnits.getValue(ge),He=o.FX.PropColumnFormattingPrecision.getValue(ge)),ie.formatters[Se]=new y.g({column:fe,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:Me,precision:He,trailingZeroes:!0}),ie.tooltipFormatters[Se]=new y.g({column:fe,formatStringPropId:o.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:Me,precision:He,trailingZeroes:!0}),null!==(C=fe.type.misc)&&void 0!==C&&C.sparkline){var ve=o.FX.PropSparklinesChartType.getValue(ge),_e=new ae(fe.displayName,fe.type,a);ie.formatters[Se]=_e,ie.tooltipFormatters[Se]=_e,ie.sparklines[Se]={chartType:ve,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(ge).solid.color,strokeWidth:o.FX.PropSparklinesStrokeWidth.getValue(ge),marker:{show:!0,typeFlags:o.FX.PropSparklinesMarkerType.getValue(ge),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(ge).solid.color,size:o.FX.PropSparklinesMarkerSize.getValue(ge),shape:o.FX.PropSparklinesMarkerShape.getValue(ge)}}}}}return ie.rowWithReferenceText={rowWithReferenceText:Y},ie},B.prototype.ensureOutline=function(g,a,f){var b;return null!==(b=g??o.FX.PropGridOutlineStyle.getValue(a))&&void 0!==b?b:f},B.prototype.ensureOutlineWeight=function(g,a){return g??o.FX.PropGridOutlineWeight.getValue(a)},B.prototype.outlineOverrideFn=function(g,a){return!!(0,W.NA)(g,a)},B.prototype.ensureOutlineColor=function(g,a){return g??this.tablixProperties.PropGridOutlineColor.getValue(a)},B.getTextSizeInPx=function(g){return F.FP.toString(g.px)},B.prototype.shouldShowTableTotalsOption=function(g){return!(g&&g.table&&!_.isEmpty(g.table.columns)&&_.some(g.table.columns,function(f){return f.discourageAggregationAcrossGroups}))},B.prototype.shouldShowRowSubtotalsOption=function(g){return!(!g||(0,K.be)(g.matrix)<1||this.isDiscourageAggregationAcrossGroups(g.matrix.rows.levels))},B.prototype.shouldShowColumnSubtotalsOption=function(g){if(!g||!g.matrix||(0,K.pr)(g.matrix.columns)<1)return!1;var a=g.matrix.columns.levels;return g.matrix.valueSources.length>1&&(a=_.initial(a)),!this.isDiscourageAggregationAcrossGroups(a)},B.prototype.isDiscourageAggregationAcrossGroups=function(g){var a=_.last(g);return a&&_.some(a.sources,function(f){return f.discourageAggregationAcrossGroups})},B.prototype.getTablixTextClassProperties=function(g){return{fontSizeOverrideFn:this.fontSizeOverridePredicate(),fontFamilyOverrideFn:this.fontFamilyOverridePredicate(),fontColorOverrideFn:this.fontColorOverridePredicate(),labelFontProperties:(0,G.m)(g,"label"),boldLabelFontProperties:(0,G.m)(g,"boldLabel")}},B.prototype.fontSizeOverridePredicate=function(){var g=this;return function(a,f,b){var C=(0,W.RK)(a,f.objectName),p=(0,W.RK)(a,o.FX.ObjectGrid),r=(0,W.RK)(a,o.FX.ObjectValues),e=(0,W.RK)(a,o.FX.ObjectSubTotals),t=g.gridDependentObject(f.objectName),n=(0,x.N)(p,"textSize",void 0)&&!(0,x.N)(C,f.propertyName,void 0,b),s=g.valuesDependentObject(f.objectName),m=(0,x.N)(r,"fontSize",void 0)&&!(0,x.N)(C,f.propertyName,void 0,b),w=g.subTotalsDependentObject(f.objectName),O=g.getSubTotalsValue(f.objectName,e,"fontSize",void 0)&&!(0,x.N)(C,f.propertyName,void 0,b),v=!!(0,x.N)(C,f.objectName===o.FX.ObjectGrid?"textSize":"fontSize",void 0,b);return t&&n||s&&m||w&&O||v}},B.prototype.fontFamilyOverridePredicate=function(){var g=this;return function(a,f,b){var C=(0,W.RK)(a,f.objectName),p=(0,W.RK)(a,o.FX.ObjectValues),r=(0,W.RK)(a,o.FX.ObjectSubTotals),e=g.valuesDependentObject(f.objectName),t=(0,x.N)(p,"fontFamily",void 0)&&!(0,x.N)(C,f.propertyName,void 0),n=g.subTotalsDependentObject(f.objectName),s=g.getSubTotalsValue(f.objectName,r,"fontFamily",void 0)&&!(0,x.N)(C,f.propertyName,void 0,b),m=!!(0,x.N)(C,"fontFamily",void 0,b);return e&&t||n&&s||m}},B.prototype.fontColorOverridePredicate=function(){return function(g,a,f){var b=(0,W.RK)(g,a.objectName),C=a.objectName===o.FX.ObjectValues?"fontColorPrimary":"fontColor",p=(0,x.N)(b,C);return!!(0,x.N)(b,C,p,f)}},B.prototype.gridDependentObject=function(g){return this.valuesDependentObject(g)||g===o.FX.ObjectRowHeaders||g===o.FX.ObjectColumnHeaders||g===o.FX.ObjectValues},B.prototype.valuesDependentObject=function(g){return this.subTotalsDependentObject(g)||g===o.FX.ObjectSubTotals},B.prototype.subTotalsDependentObject=function(g){return g===o.FX.ObjectTotal||g===o.FX.ObjectRowTotal||g===o.FX.ObjectColumnTotal},B.prototype.getSubTotalsValue=function(g,a,f,b){var C=g===o.FX.ObjectRowTotal?"Row":g===o.FX.ObjectColumnTotal?"Column":void 0;return b=b??(0,x.N)(a,f),(0,x.N)(a,f,b,C)},B.ImageSizeMin=8,B.ImageSizeMax=512,B}(),ae=function(){function B(g,a,f){this.displayName=g,this.sparklineType=a,this.localizer=f}return B.prototype.format=function(g,a){var f=function(B,g,a){if(a){var f=a.points;if(f=_.filter(f,function(w){return null!=w.x&&null!=w.y}),!_.isEmpty(f)){var b=_.size(f);if(1===b)return{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[B,a.lowY]};var C=g.misc.sparkline.groupingType;if(C&&(C.numeric||C.dateTime||C.temporal)){var r=f[0].y,e=f[b-1].y;if(!_.some(f,function(w){return w.y!==r}))return{key:"Sparkline_Tooltip_ScalarNoChange",parameters:[B,r]};if((0,k.JM)(_.map(f,function(w){return w.x}),_.map(f,function(w){return w.y}),!0).rSquared>.5){var m,s="Sparkline_Tooltip_ScalarTrend";return s+=e>r?"Up":"Down",0!==r?(m=100*(e-r)/r,s+="Percent"):(m=e-r,s+="Value"),{key:s,parameters:[B,+Math.abs(m).toFixed(2)]}}return{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[B,a.lowY,a.highY]}}return a.lowY===a.highY?{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[B,a.lowY]}:{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[B,a.lowY,a.highY]}}}}(this.displayName,this.sparklineType,g);if(f)return this.localizer.apply(this,(0,V.__spreadArray)([f.key],f.parameters,!1))},B}()},93023:function(Fe,me,E){E.r(me),E.d(me,{Matrix:function(){return F}});var V=E(54522),I=E(28579),U=E(62458),oe=E(46135),j=E(99318),le=E(16324),te=E(93340),G=E(71090),re=E(73889),ce=E(81671),o=E(93414),S=E(74304),l=E(93568),u=E(13375),F=function(){function W(x){this.isTouchDisabled=x&&x.isTouchDisabled}return W.prototype.init=function(x){this.element=x.element,this.style=x.style,this.updateViewport(x.viewport),this.isInteractive=x.interactivity&&null!=x.interactivity.selection,this.hostServices=x.host,this.persistingObjects=!1,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1,this.tablixPropertyManager=new S.U(this.style)},W.getFormattingProperties=function(x,D){return U.fF.assertValue(x,"dataView"),D.getMatrixObjects(x)},W.prototype.onResizing=function(x){this.updateViewport(x)},W.prototype.getColumnWidthManager=function(){return this.columnWidthManager},W.prototype.onDataChanged=function(x){U.fF.assertValue(x,"options");var D=x.dataViews;if(D&&D.length>0){var X=this.dataView;this.dataView=D[0];var K=W.getFormattingProperties(this.dataView,this.tablixPropertyManager);this.formatters=K.formatters;var k=K.general.textSize;x.operationKind===oe.su.Append?(this.createOrUpdateHierarchyNavigator(X.matrix.rows.root!==this.dataView.matrix.rows.root),this.tablixControl.updateModels(!1,this.hierarchyNavigator.getRowHierarchy().root.children,this.hierarchyNavigator.getColumnHierarchy().root.children),this.refreshControl(!1)):(this.createOrUpdateHierarchyNavigator(!0),this.createColumnWidthManager(),this.createTablixControl(K),this.tablixControl.getBinder().onDataViewChanged(K),this.updateInternal(k,X))}this.waitingForData=!1,this.waitingForSort=!1},W.prototype.createColumnWidthManager=function(){var x=this,D=this.hierarchyNavigator.getColumnHierarchy();this.columnWidthManager?this.persistingObjects||this.columnWidthManager.updateDataView(this.dataView,D.leafNodes):this.columnWidthManager=new ce.K(this.dataView,!0,function(X){return x.persistColumnWidths(X)},D.leafNodes)},W.prototype.persistColumnWidths=function(x){this.persistingObjects=!0,this.hostServices.persistProperties(x)},W.prototype.updateViewport=function(x){this.currentViewport=x,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},W.prototype.refreshControl=function(x){(this.element.is(":visible")||1===this.getLayoutKind())&&this.tablixControl.refresh(x)},W.prototype.getLayoutKind=function(){return this.isInteractive?0:1},W.prototype.createOrUpdateHierarchyNavigator=function(x){var D=!this.dataView.metadata.segment;if(this.tablixControl)this.hierarchyNavigator.update(this.dataView.matrix,!1,!1,!1,D,x,this.formatters);else{var X=(0,u.aD)(this.dataView.matrix,D,this.formatters,this.hostServices.getLocalizedString("ListJoin_Separator"),this.tablixPropertyManager.tablixProperties,this.hostServices);this.hierarchyNavigator=X}},W.prototype.createTablixControl=function(x){this.tablixControl||(this.tablixControl=this.createControl(this.hierarchyNavigator,x.general.textSize)),this.tablixControl.wordWrapRowHeaders=x.rowHeaders.wordWrap},W.prototype.createControl=function(x,D){var X=this,K=this.getLayoutKind(),k={onBindRowHeader:function(c){X.onBindRowHeader(c)},totalLabel:this.hostServices.getLocalizedString(G.qT),onColumnHeaderClick:function(c,z){return X.onColumnHeaderClick(c,z)},showSortIcons:0===K,tablixProperties:this.tablixPropertyManager.tablixProperties},q=new l.$H(this.hierarchyNavigator,k),y=1===K?le.dk.createLayoutManager(q):le.Vz.createLayoutManager(q,this.columnWidthManager),d=document.createElement("div");this.element.append(d);var i={interactive:this.isInteractive,enableTouchSupport:!this.isTouchDisabled,layoutKind:K,fontSize:S.U.getTextSizeInPx(D)};return new o.d(x,y,q,d,i)},W.prototype.updateInternal=function(x,D){var X=this;1===this.getLayoutKind()&&this.tablixControl.layoutManager.adjustContentSize((0,V.Gr)(this.dataView)),this.tablixControl.fontSize=S.U.getTextSizeInPx(x),this.verifyHeaderResize(),this.tablixControl.updateModels(!this.persistingObjects,this.hierarchyNavigator.getRowHierarchy().root.children,this.hierarchyNavigator.getColumnHierarchy().root.children),this.tablixControl.viewport=this.currentViewport;var K=this.shouldClearControl(D,this.dataView);setTimeout(function(){X.refreshControl(K);var k=X.columnWidthManager.onColumnsRendered(X.tablixControl.layoutManager.columnWidthsToPersist);X.persistingObjects&&!k&&(X.persistingObjects=!1)},0)},W.prototype.shouldClearControl=function(x,D){return!(this.waitingForSort&&x&&D&&(0,j.C0)(x.metadata,D.metadata))},W.prototype.onBindRowHeader=function(x){this.needsMoreData(x)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},W.prototype.onColumnHeaderClick=function(x,D){this.waitingForSort=!0,this.hostServices.onCustomSort((0,te.Av)(x,D))},W.prototype.needsMoreData=function(x){if(this.waitingForData||!this.hierarchyNavigator.isLeaf(x)||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var X=this.tablixControl.rowDimension.getItemsCount()*G.sR;return this.hierarchyNavigator.getLeafIndex(x)>=X},W.prototype.enumerateObjectInstances=function(x){var D=new I.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(x,D,this.dataView,re.Y.Matrix),D.complete()},W.prototype.enumerateObjectRepetition=function(){var x=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(x,this.dataView,re.Y.Matrix),x},W.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},W.prototype.onViewModeChanged=function(x){this.tablixControl&&this.tablixControl.toggleTouchBindings(1!==x),this.updateViewport(this.currentViewport)},W.prototype.verifyHeaderResize=function(){var x=this.shouldAllowHeaderResize();x!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=x,this.tablixControl.layoutManager.setAllowHeaderResize(x))},W}()},93568:function(Fe,me,E){E.d(me,{$H:function(){return d},B0:function(){return F},aV:function(){return W},cP:function(){return x},qW:function(){return y}});var V=E(1521),I=E(79154),U=E(54522),oe=E(55007),j=E(40550),le=E(62458),te=E(32041),G=E(64329),re=E(48066),ce=E(66001),o=E(93340),S=E(71090),l=E(13375),u=E(64067);function F(i,h,c,z,P,L,A,Q){var J,de,ae,B,g;void 0===L&&(L=!1),void 0===A&&(A=!1);var a=P.grid,f=P.rowHeaders,b=P.values,C=P.columnHeaders,p=null!==(J=P.grandTotal)&&void 0!==J?J:P.rowGrandTotal,r=P.subtotals||{},e=P.rowSubtotals||{},t=null!==(de=f.outlineWeight)&&void 0!==de?de:a.outlineWeight,n=null!==(ae=f.outlineColor)&&void 0!==ae?ae:a.outlineColor;c.paddings.top=c.paddings.bottom=a.rowPadding;var s=l.hc.isNodeGrandTotal(h);c.borders.top=new o.om,(i.row.isFirst&&!z||z&&0===h.leafIndex)&&(c.borders.top.applyParams((0,j.yo)(f.outline),t,n,o.Pb.Outline),!(0,j.yo)(f.outline)&&(0,j.yo)(b.outline)&&(c.paddings.top+=t)),c.borders.bottom=new o.om,i.row.isLast&&(!z||z&&i.column.isLast&&!P.general.rowSubtotals)||z&&i.row.isFirst&&h.isSubtotal?(c.borders.bottom.applyParams((0,j.mv)(f.outline),t,n,o.Pb.Outline),!(0,j.mv)(f.outline)&&(0,j.mv)(b.outline)&&(c.paddings.bottom+=t)):c.borders.bottom.applyParams(a.gridHorizontal,a.gridHorizontalWeight,a.gridHorizontalColor,o.Pb.Gridline),c.borders.left=new o.om,(z||i.column.isFirst)&&(c.borders.left.applyParams((0,j.fs)(f.outline),t,n,o.Pb.Outline),!(0,j.fs)(f.outline)&&(0,j.fs)(C.outline)&&(c.paddings.left+=t)),c.borders.right=new o.om;var m=z||i.column.isLast;if(m?c.borders.right.applyParams((0,j.BK)(f.outline),t,n,o.Pb.Outline):c.borders.right.applyParams(a.gridVertical,a.gridVerticalWeight,a.gridVerticalColor,o.Pb.Gridline),h.isBlankRow&&X(c,P),p.applyToHeaders&&s)c.fontColor=p.fontColor||f.fontColor,c.backColor=p.backColor||f.backColor;else{var O=L&&(b.fontColorPrimary!==b.fontColorSecondary||b.backColorPrimary!==b.backColorSecondary)&&(A||m),H=null!==(B=e.fontColor)&&void 0!==B?B:r.fontColor,Y=O&&!(h.hasSubtotalStyle&&H)&&!(s&&p.fontColor),ie=null!==(g=e.backColor)&&void 0!==g?g:r.backColor,se=O&&!(h.hasSubtotalStyle&&ie)&&!(s&&p.backColor),pe=void 0;(Y||se)&&(pe=Q??K(h.position,P.general,ie)),c.fontColor=Y?k(pe,b):f.fontColor,c.backColor=h.isBlankRow?D(h.isBlankRow,P):se?q(pe,b):f.backColor}}function W(i,h,c,z){var P,L,A,Q,J,de=z.grid,ae=z.columnHeaders,B=z.values,g=null!==(P=z.grandTotal)&&void 0!==P?P:z.columnGrandTotal,a=null!==(L=ae.outlineWeight)&&void 0!==L?L:de.outlineWeight,f=null!==(A=ae.outlineColor)&&void 0!==A?A:de.outlineColor,b=z.columnFormatting[h.queryName],C=null===(J=null===(Q=z.annotationFormatting)||void 0===Q?void 0:Q.columnHeaders)||void 0===J?void 0:J[h.queryName],p=l.hc.isNodeGrandTotal(h);c.fontColor=b&&b.styleHeader&&b.fontColor?b.fontColor:g.applyToHeaders&&p&&g.fontColor||ae.fontColor,c.backColor=C&&C.backColor?C.backColor:b&&b.styleHeader&&b.backColor?b.backColor:g.applyToHeaders&&p&&g.backColor||ae.backColor,C&&C.bold&&(c.fontWeight=I.en),c.paddings.top=c.paddings.bottom=de.rowPadding,c.borders.top=new o.om,i.row.isFirst&&c.borders.top.applyParams((0,j.yo)(ae.outline),a,f,o.Pb.Outline),c.borders.bottom=new o.om,i.row.isLast?c.borders.bottom.applyParams((0,j.mv)(ae.outline),a,f,o.Pb.Outline):c.borders.bottom.applyParams(de.gridHorizontal,de.gridHorizontalWeight,de.gridHorizontalColor,o.Pb.Gridline),c.borders.left=new o.om,i.column.isFirst&&!(0,j.fs)(ae.outline)&&(0,j.fs)(B.outline)&&(c.paddings.left+=a),c.borders.right=new o.om,i.column.isLast?(c.borders.right.applyParams((0,j.BK)(ae.outline),a,f,o.Pb.Outline),!(0,j.BK)(ae.outline)&&(0,j.BK)(B.outline)&&(c.paddings.right+=a)):c.borders.right.applyParams(de.gridVertical,de.gridVerticalWeight,de.gridVerticalColor,o.Pb.Gridline)}function x(i,h,c,z,P,L){var A,Q,J,de,ae,B,g,a,f,b=P.grid,C=P.values,p=P.rowHeaders,r=P.columnHeaders,e=P.rowSubtotals||{},t=P.columnSubtotals||{},n=P.subtotals||{},s=null!==(A=C.outlineWeight)&&void 0!==A?A:b.outlineWeight,m=null!==(Q=C.outlineColor)&&void 0!==Q?Q:b.outlineColor;c.paddings.top=c.paddings.bottom=b.rowPadding,c.borders.top=new o.om,i.row.isFirst&&(c.borders.top.applyParams((0,j.yo)(C.outline),s,m,o.Pb.Outline),!(0,j.yo)(C.outline)&&(0,j.yo)(p.outline)&&(c.paddings.top+=s)),c.borders.bottom=new o.om,i.row.isLast&&(!z||z&&!P.general.rowSubtotals)||z&&h.isRowGrandTotal?(c.borders.bottom.applyParams((0,j.mv)(C.outline),s,m,o.Pb.Outline),!(0,j.mv)(C.outline)&&(0,j.mv)(p.outline)&&(c.paddings.bottom+=s)):c.borders.bottom.applyParams(b.gridHorizontal,b.gridHorizontalWeight,b.gridHorizontalColor),c.borders.left=new o.om,i.column.isFirst&&c.borders.left.applyParams((0,j.fs)(C.outline),s,m,o.Pb.Outline),c.borders.right=new o.om,i.column.isLast?(c.borders.right.applyParams((0,j.BK)(C.outline),s,m,o.Pb.Outline),!(0,j.BK)(C.outline)&&(0,j.BK)(r.outline)&&(c.paddings.right+=s)):c.borders.right.applyParams(b.gridVertical,b.gridVerticalWeight,b.gridVerticalColor,o.Pb.Gridline),null!==(J=h.rowItem)&&void 0!==J&&J.isBlankRow&&X(c,P);var O,H,v,M,w=h.columnMetadata&&P.columnFormatting[h.columnMetadata.queryName];w&&(h.isGrandTotal?(H=w.styleTotal&&w.fontColor,O=w.styleTotal&&w.backColor):h.hasSubtotalStyle?(H=w.styleSubTotals&&w.fontColor,O=w.styleSubTotals&&w.backColor):(H=w.styleValues&&w.fontColor,O=w.styleValues&&w.backColor)),h.hasColumnSubtotalStyle?(v=null!==(de=t.fontColor)&&void 0!==de?de:n.fontColor,M=null!==(ae=t.backColor)&&void 0!==ae?ae:n.backColor):h.hasRowSubtotalStyle?(v=null!==(B=e.fontColor)&&void 0!==B?B:n.fontColor,M=null!==(g=e.backColor)&&void 0!==g?g:n.backColor):(v=n.fontColor,M=n.backColor);var Y=L??K(h.position,P.general,M??e.backColor),ie=k(Y,C),ue=q(Y,C),ee=D(null===(a=h.rowItem)||void 0===a?void 0:a.isBlankRow,P);if(h.isGrandTotal){var se=null!==(f=P.grandTotal)&&void 0!==f?f:h.isColumnGrandTotal?P.columnGrandTotal:P.rowGrandTotal;c.fontColor=h.fontColor||H||se.fontColor||v||ie,c.backColor=h.backColor||O||se.backColor||M||ee||ue}else h.hasSubtotalStyle?(c.fontColor=h.fontColor||H||v||ie,c.backColor=h.backColor||O||M||ee||ue):(c.fontColor=h.fontColor||H||ie,c.backColor=h.backColor||O||ee||ue)}function D(i,h){var c,z,P;if(i){var L=null===(c=h.blankRows)||void 0===c?void 0:c.blankRowTransparency;P=null===(z=h.blankRows)||void 0===z?void 0:z.blankRowColor,null!=L&&(P=(0,V.Et)(P,(0,u.TD)(L)))}return P}function X(i,h){var c,z,P,L,A;if(null!==(c=h?.blankRows)&&void 0!==c&&c.showBorder){var Q=null===(z=h?.blankRows)||void 0===z?void 0:z.borderPosition,J=null===(P=h?.blankRows)||void 0===P?void 0:P.borderWidth,de=null===(L=h?.blankRows)||void 0===L?void 0:L.borderTransparency,ae=null===(A=h?.blankRows)||void 0===A?void 0:A.borderColor;null!=ae&&null!=de&&(ae=(0,V.Et)(ae,(0,u.TD)(de))),("Top"===Q||"TopAndBottom"===Q)&&(i.borders.top.color=ae,i.borders.top.weight=J),("Bottom"===Q||"TopAndBottom"===Q)&&(i.borders.bottom.color=ae,i.borders.bottom.weight=J)}}function K(i,h,c){var z;return(z=h.rowSubtotals&&c?i.row.indexInSiblings:i.row.index)<0||z%2==0}function k(i,h){return i?h.fontColorPrimary:h.fontColorSecondary}function q(i,h){return i?h.backColorPrimary:h.backColorSecondary}function y(i,h,c,z){var P,L,A=z.grid,Q=z.columnHeaders,J=z.rowHeaders,de=null!==(P=Q.outlineWeight)&&void 0!==P?P:A.outlineWeight,ae=null!==(L=Q.outlineColor)&&void 0!==L?L:A.outlineColor;h.fontColor=Q.fontColor||J.fontColor,h.backColor=Q.backColor||J.backColor,h.paddings.top=h.paddings.bottom=A.rowPadding,h.borders.top=new o.om,i.row.isFirst&&h.borders.top.applyParams((0,j.yo)(Q.outline),de,ae,o.Pb.Outline),h.borders.bottom=new o.om,i.row.isLast?h.borders.bottom.applyParams((0,j.mv)(Q.outline),de,ae,o.Pb.Outline):h.borders.bottom.applyParams(A.gridHorizontal,A.gridHorizontalWeight,A.gridHorizontalColor,o.Pb.Gridline),h.borders.left=new o.om,(i.column.isFirst||c)&&(h.borders.left.applyParams((0,j.fs)(Q.outline),de,ae,o.Pb.Outline),!(0,j.fs)(Q.outline)&&(0,j.fs)(J.outline)&&(h.paddings.left+=de)),h.borders.right=new o.om,h.borders.right.applyParams(A.gridVertical,A.gridVerticalWeight,A.gridVerticalColor,o.Pb.Gridline)}var d=function(){function i(h,c){this.hierarchyNavigator=h,this.options=c}return i.prototype.onDataViewChanged=function(h){this.formattingProperties=h,this.updateTextHeights()},i.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:S.F2,fontSize:G.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(te.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:S.dG,fontSize:G.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(te.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:S.Zk,fontSize:G.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(te.b.measureSvgTextHeight(this.textPropsTotal,"a"))},i.prototype.onStartRenderingSession=function(){},i.prototype.onEndRenderingSession=function(){},i.prototype.bindRowHeader=function(h,c){(0,o.ey)(c);var z=this.options.tablixProperties,P=new o.qZ;this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(h)&&((0,o.R5)(c,S.Eo),P.borders.right=new o.om(oe.FX.PropGridOutlineWeight.defaultValue,z.PropGridOutlineColor.getValue(null))),h.isSubtotal&&(P.paddings.left=S.P$),c.contentWidth=0,this.bindHeader(h,c,c.extension.contentHost,this.hierarchyNavigator.getRowHeaderMetadataColumn(h),P),c.contentWidth=Math.ceil(c.contentWidth),this.options.onBindRowHeader&&this.options.onBindRowHeader(h),F(c.position,h,P,!1,this.formattingProperties),c.applyStyle(P)},i.prototype.unbindRowHeader=function(h,c){(0,o.G9)(c),(0,o.aP)(c)},i.prototype.bindColumnHeader=function(h,c){(0,o.ey)(c);var z=new o.qZ,P=this.options.tablixProperties,L=!1,A=c.extension.contentHost;if((A=(0,o.Ch)(A)).classList.add(S.WA),c.contentWidth=0,this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(h)){if(z.borders.bottom=new o.om(oe.FX.PropGridOutlineWeight.defaultValue,P.PropGridOutlineColor.getValue(null)),(0,o.R5)(c,S.mQ),(0,o.R5)(c,S.s0),this.options.showSortIcons){var J=this.getSortableHeaderColumnMetadata(h);J&&(this.registerColumnHeaderClickHandler(J,c),A=(0,o.D6)(J.sort,A),J.sort&&(c.contentWidth=this.fontSizeHeader+S.fG))}h.isSubtotal&&h.parent&&h.parent.children.length>1&&h.parent.children[0].isSubtotal&&(L=!0)}c.extension.disableDragResize(),this.bindHeader(h,c,A,this.hierarchyNavigator.getColumnHeaderMetadataColumn(h),z,L),c.contentWidth=Math.ceil(c.contentWidth),W(c.position,h,z,this.formattingProperties),c.applyStyle(z)},i.prototype.unbindColumnHeader=function(h,c){(0,o.G9)(c),(0,o.aP)(c),this.getSortableHeaderColumnMetadata(h)&&this.unregisterColumnHeaderClickHandler(c),this.options.showSortIcons&&(0,o.Y4)(c)},i.prototype.bindHeader=function(h,c,z,P,L,A){(0,o.R5)(c,S.f),L.fontFamily=S.F2,L.fontColor=S.lN;var Q=this.formattingProperties.grid.imageHeight;if(c.contentHeight=(0,U.pt)(P)?Q:h.hasSubtotalStyle?this.textHeightTotal:this.textHeightValue,h.hasSubtotalStyle&&((0,o.R5)(c,S.R9),L.fontFamily=S.Zk),h.isSubtotal&&!A)return(0,o.DM)(this.options.totalLabel,z,c.extension.contentHost),void(c.contentWidth=te.b.measureSvgTextWidth(this.textPropsTotal,this.options.totalLabel));var J=this.getHeaderLabel(h);if(J)return(0,o.MN)(P,J)!==re.av.NONE?((0,o.vU)(J,z),void(c.contentWidth+=te.b.measureSvgTextWidth(this.textPropsHeader,J))):(0,U.pt)(P)&&(0,re.gU)(J)?((0,o.Hx)(h.valueFormatted,z,Q),void(c.contentWidth+=Q*S.wd)):((0,o.DM)(J,z,c.extension.contentHost),void(c.contentWidth+=te.b.measureSvgTextWidth(h.hasSubtotalStyle?this.textPropsTotal:this.textPropsHeader,J)));z.innerHTML=S.jv},i.prototype.applyWordWrapping=function(h,c){if(le.fF.assertValue(c,"applyWordWrapping - Undefined cell"),le.fF.assert(function(){return null!=c.containerWidth&&-1!==c.containerWidth},"applyWordWrapping - Undefined width"),le.fF.assert(function(){return null!=c.containerHeight&&-1!==c.containerHeight},"applyWordWrapping - Undefined height"),1===c.type){var z=this.hierarchyNavigator.getRowHeaderMetadataColumn(h);if(!(0,U.cR)(z)&&!(0,U.pt)(z)){var P=c.extension.contentHost;(0,o.D4)(P);var L=h.valueFormatted,A=new o.qZ;F(h.position,h,A,!1,this.formattingProperties);for(var Q=c.containerWidth-(A.getExtraRight()+A.getExtraLeft()),J=c.containerHeight-(A.getExtraTop()+A.getExtraBottom()),de=Math.floor(J/this.textHeightHeader),B=0,g=(0,ce.ql)(L,this.textPropsHeader,te.b.measureSvgTextWidth,Q,de,null,!0);B<g.length;B++)(0,o.Ch)(P,g[B])}}},i.prototype.registerColumnHeaderClickHandler=function(h,c){var z=this;this.options.onColumnHeaderClick&&c.extension.registerClickHandler(function(A){if((0,o.xl)(A)){var Q=(0,o.x7)(h.sort);z.options.onColumnHeaderClick(h.queryName?h.queryName:h.displayName,Q)}})},i.prototype.unregisterColumnHeaderClickHandler=function(h){this.options.onColumnHeaderClick&&h.extension.unregisterClickHandler()},i.prototype.bindBodyCell=function(h,c){(0,o.ey)(c);var z=new o.qZ;c.contentHeight=this.textHeightValue;var P=h.kpiContent;if(P)$(c.extension.contentHost).append(P),c.contentWidth=this.fontSizeValue;else{var L=this.textPropsValue;(0,o.R5)(c,S.s0),h.isTotal&&((0,o.R5)(c,S.R9),z.fontFamily=S.Zk,c.contentHeight=this.textHeightTotal,L=this.textPropsTotal);var A=h.textContent;A&&((0,o.DM)(A,c.extension.contentHost),c.contentWidth=te.b.measureSvgTextWidth(L,A))}c.contentWidth=Math.ceil(c.contentWidth),x(c.position,h,z,!1,this.formattingProperties),c.applyStyle(z)},i.prototype.unbindBodyCell=function(h,c){(0,o.G9)(c),(0,o.aP)(c)},i.prototype.bindCornerCell=function(h,c){(0,o.ey)(c);var z=this.options.tablixProperties,P=new o.qZ;P.fontFamily=S.F2,P.fontColor=S.lN,c.contentHeight=this.textHeightHeader,c.contentWidth=0;var L=c.extension.contentHost;if((L=(0,o.Ch)(L)).classList.add(S.WA),h.isColumnHeaderLeaf&&((0,o.R5)(c,S.mQ),P.borders.bottom=new o.om(oe.FX.PropGridOutlineWeight.defaultValue,z.PropGridOutlineColor.getValue(null)),this.options.showSortIcons)){var A=this.getSortableCornerColumnMetadata(h);A&&(this.registerColumnHeaderClickHandler(A,c),L=(0,o.D6)(A?A.sort:void 0,L),A.sort&&(c.contentWidth=this.fontSizeHeader+S.fG))}(0,o.DM)(h.displayName,L,c.extension.contentHost),c.contentWidth+=te.b.measureSvgTextWidth(this.textPropsHeader,h.displayName),c.contentWidth=Math.ceil(c.contentWidth),h.isRowHeaderLeaf&&(0,o.R5)(c,S.Eo),(0,o.R5)(c,S.f),y(c.position,P,!1,this.formattingProperties),c.applyStyle(P),c.extension.disableDragResize()},i.prototype.unbindCornerCell=function(h,c){(0,o.G9)(c),(0,o.aP)(c),this.options.showSortIcons&&(0,o.Y4)(c),h.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(c)},i.prototype.bindEmptySpaceHeaderCell=function(h){},i.prototype.unbindEmptySpaceHeaderCell=function(h){},i.prototype.bindEmptySpaceFooterCell=function(h){},i.prototype.unbindEmptySpaceFooterCell=function(h){},i.prototype.getHeaderLabel=function(h){return h.valueFormatted},i.prototype.getCellContent=function(h){return h.textContent||""},i.prototype.hasRowGroups=function(){var h=this.hierarchyNavigator.getRowHierarchy();return!(!h||!h.levels||0===h.levels.length)},i.prototype.getSortableCornerColumnMetadata=function(h){if(h.isColumnHeaderLeaf)return h.metadata},i.prototype.getSortableHeaderColumnMetadata=function(h){var c=this.hierarchyNavigator.getRowHierarchy();if(!c||!c.levels||0===c.levels.length)return null;var z=this.hierarchyNavigator.getValueSources(),P=z&&z.length>1,L=this.hierarchyNavigator.getColumnHierarchy(),A=L?L.levels.length:0;P?A--:1===A&&L.levels[0]&&L.levels[0].sources&&L.levels[0].sources[0]&&L.levels[0].sources[0].roles&&L.levels[0].sources[0].roles.Values&&(A=0);var Q=-1;return 0===A?Q=h.levelSourceIndex:h.isSubtotal&&(P?h.parent&&0===h.parent.level&&(Q=h.levelSourceIndex):0===h.level&&(Q=h.levelSourceIndex)),-1!==Q?z[Q=Q||0]:null},i}()},13375:function(Fe,me,E){E.d(me,{aD:function(){return ce},hc:function(){return o}});var V=E(81337),I=E(62458),U=E(39681),oe=E(38078),j=E(93340),le=E(29043),te=E(66842),G=E(40845),re=function(S){function l(u,F,W,x,D,X,K,k){var y,d,i,h,q=this;if(W)for(i=W;i.parent;)i=i.parent;if(x)for(h=x;h.parent;)h=h.parent;var c=h&&!!h.isSubtotal,z=!c&&x&&!!x.isSubtotal,P=i&&!!i.isSubtotal,L=!P&&W&&!!W.isSubtotal,A=W.isBlankRow;return _.isString(u)&&!(null===(d=null===(y=D?.type)||void 0===y?void 0:y.misc)||void 0===d)&&d.sparkline&&(u=(0,le.th)(u,X)),(q=S.call(this,u,F,L,z,P,c,A,D,K,k,0)||this).rowItem=W,q.columnItem=x,q.hasRowSubtotalStyle=W&&W.hasSubtotalStyle,q.hasColumnSubtotalStyle=x&&x.hasSubtotalStyle,q.hasSubtotalStyle=q.hasRowSubtotalStyle||q.hasColumnSubtotalStyle,q}return(0,V.__extends)(l,S),Object.defineProperty(l.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),l}(j.jG);function ce(S,l,u,F,W,x,D,X,K,k){void 0===D&&(D=!0);var q=new o(F,W,x,k,!0);return D&&q.update(S,!1,!1,!1,l,!0,u,X,K,void 0,void 0,!1),q}var o=function(){function S(l,u,F,W,x){this.tablixProperties=u,this.hostServices=F,this.expandCompositeHierarchy=W,this.modernRowHeaderStyle=x,this.compositeGroupSeparator=l}return S.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},S.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},S.prototype.getLeafCount=function(l){var u=this.getMatrixHierarchy(l);return u?u.leafNodes.length:0},S.prototype.getLeafAt=function(l,u){var F=this.getMatrixHierarchy(l);return F?F.leafNodes[u]:null},S.prototype.getLeafIndex=function(l){return I.fF.assertValue(l,"item"),l.leafIndex},S.prototype.getParent=function(l){return I.fF.assertValue(l,"item"),0===l.level?null:l.parent},S.prototype.getIndex=function(l){return I.fF.assertValue(l,"item"),l?l.index:-1},S.prototype.isLeaf=function(l){return I.fF.assertValue(l,"item"),!l.children||0===l.children.length},S.prototype.isRowHierarchyLeaf=function(l){return!0},S.prototype.isColumnHierarchyLeaf=function(l){return!1},S.prototype.isFirstItem=function(l,u){return l===_.head(u)},S.prototype.areAllParentsFirst=function(l,u){if(!l)return!1;var F=this.getParent(l);return F?this.isFirstItem(l,l.siblings)&&this.areAllParentsFirst(F,F.siblings):this.isFirstItem(l,l.siblings)},S.prototype.isLastItem=function(l,u){if(I.fF.assertValue(l,"item"),l!==_.last(u))return!1;if(!this.isItemRow(l)||this.isDataComplete)return!0;for(var F=l.parent;F;){if(F!==_.last(F.siblings))return!0;F=F.parent}return!1},S.prototype.isItemRow=function(l){if(!l)return!1;for(var u=l;u.parent;)u=u.parent;return u.siblings===this.rowHierarchy.root.children},S.prototype.areAllParentsLast=function(l,u){if(!l)return!1;var F=this.getParent(l);return F?this.isLastItem(l,l.siblings)&&this.areAllParentsLast(F,F.siblings):this.isLastItem(l,l.siblings)},S.prototype.getChildren=function(l){return I.fF.assertValue(l,"item"),l.children},S.prototype.getChildrenLevelDifference=function(l){var u=1/0,F=this.getChildren(l);if(!_.isEmpty(F))for(var W=0,x=F.length;W<x;W++)u=Math.min(u,F[W].level-l.level);return u},S.prototype.getCount=function(l){return I.fF.assertValue(l,"items"),l.length},S.prototype.getAt=function(l,u){return I.fF.assertValue(l,"items"),l[u]},S.prototype.getLevel=function(l){return I.fF.assertValue(l,"item"),l.level},S.prototype.getRowLeafIndex=function(l){return this.isSteppedLayout&&l.isSubtotal?l.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?l.parent.leafIndex:l.leafIndex:this.valuesOnRow?l.levelSourceIndex:-1:l.leafIndex},S.prototype.getIntersection=function(l,u){I.fF.assertValue(l,"rowItem"),I.fF.assertValue(u,"columnItem");var F,x,W=u.leafIndex;if(F=l.values?l.values[u.leafIndex]:void 0){var D=this.valueSources[F.valueSourceIndex||0],X=D.queryName;x=new re(F.value,F.objects,l,u,D,this.hostServices,this.formatters[X],this.tooltipFormatters[X])}else x=new re(void 0,void 0,l,u,void 0,this.hostServices,void 0,void 0);var q=this.getRowLeafIndex(l);return x.position.row.index=q,x.position.row.indexInSiblings=l.siblings.indexOf(l),x.position.row.isFirst=0===q,x.position.row.isLast=this.isDataComplete&&q===this.rowHierarchy.leafNodes.length-1,x.position.column.index=W,x.position.column.indexInSiblings=u.siblings.indexOf(u),x.position.column.isFirst=0===W,x.position.column.isLast=W===this.columnHierarchy.leafNodes.length-1,F&&F.objects&&(x.backColor=(0,oe.HZ)(this.tablixProperties.PropValuesBackColor.getValue(F.objects)),x.fontColor=(0,oe.HZ)(this.tablixProperties.PropValuesFontColor.getValue(F.objects))),x},S.prototype.getCorner=function(l,u){I.fF.assert(function(){return l>=0},"rowLevel"),I.fF.assert(function(){return u>=0},"columnLevel");var x,F=this.columnHierarchy.levels,W=this.rowHierarchy.levels;if((u===F.length-1||0===F.length)&&(x=W[l])){var D=l===W.length-1,X=this.valuesOnRow&&D;return{metadata:1===x.sources.length||x.sources.length>1&&X?x.sources[0]:null,displayName:X?"":_.map(x.sources,function(q){return q.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:D,position:this.calculateCornerCellPosition(l,u),rowLevel:l,columnLevel:u}}if(l===W.length-1&&(x=F[u])){var k=x.sources.filter(function(y){return!y.isMeasure});return{metadata:1===x.sources.length?x.sources[0]:null,displayName:_.map(k,function(y){return y.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(l,u),rowLevel:l,columnLevel:u}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(l,u),rowLevel:l,columnLevel:u}},S.prototype.calculateCornerCellPosition=function(l,u){var F=new j.ri,W=u;F.row.index=F.row.indexInSiblings=W,F.row.isFirst=0===W;var x=this.getColumnHierarchyDepth();F.row.isLast=u===x-1;var D=l;F.column.index=F.column.indexInSiblings=D,F.column.isFirst=0===D;var X=this.getRowHierarchyDepth();return F.column.isLast=D===X-1,F},S.prototype.headerItemEquals=function(l,u){return!(!l||!u)&&l===u},S.prototype.bodyCellItemEquals=function(l,u){return l.position.isMatch(u.position)},S.prototype.cornerCellItemEquals=function(l,u){return!(!l||!u)&&l.displayName===u.displayName&&l.isColumnHeaderLeaf===u.isColumnHeaderLeaf&&l.isRowHeaderLeaf===u.isRowHeaderLeaf&&l.metadata===u.metadata},S.prototype.getColumnHierarchy=function(){return this.columnHierarchy},S.prototype.getRowHierarchy=function(){return this.rowHierarchy},S.prototype.getValueSources=function(){return this.valueSources},S.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},S.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},S.prototype.update=function(l,u,F,W,x,D,X,K,k,q,y,d){var i=this;I.fF.assertValue(l,"matrix"),this.isSteppedLayout=u,this.valuesOnRow=F,this.areRowSubtotalsBefore=W,this.isDataComplete=x,this.valueSources=l.valueSources,this.formatters=X,this.tooltipFormatters=K||{},this.subtotalByColumn=k||{},this.multipleValueSources=l.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(l.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,d,q,y),(D=D||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(l.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,y,this.areRowSubtotalsBefore,function(h,c){return i.calculateRowHeaderPosition(h,c)}),D&&(this.updateHierarchy(this.columnHierarchy,!1,y,!1,function(h,c){return i.calculateColumnHeaderPosition(h,c)}),this.updateStaticColumnHeaders(this.columnHierarchy))},S.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},S.prototype.removeValueNodesFromColumnHierarchy=function(l){I.fF.assertValue(l,"nodes");for(var u=0,F=l;u<F.length;u++){var W=F[u];if(!W.parent&&this.isLeaf(W))return l.length=0,void l.push({level:0});this.isLeaf(W.children[0])?W.children=void 0:this.removeValueNodesFromColumnHierarchy(W.children)}},S.prototype.addValueNodesToRowHierarchy=function(l,u){for(var F=this.getRowHierarchyDepth(),W=this.valueSources.length,x=l.length,D=0;D<x;D++){var X=l[D];if(this.isLeaf(X)){var K=void 0,k=void 0,q=void 0;if(this.isSteppedLayout&&X.isSubtotal||!u?(l.splice(D,1),K=l,k=D,q=X.level,x=x-1+W,D=D-1+W):(X.children=[],K=X.children,k=0,q=F),!X.isBlankRow)for(var y=0;y<W;y++){var d=this.createRowValueNode(y,W,X,q);K.splice(k++,0,d)}X.values=null}else this.addValueNodesToRowHierarchy(X.children,u)}},S.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},S.prototype.createRowValueNode=function(l,u,F,W){var x={level:W,levelSourceIndex:l,isSubtotal:F.isSubtotal,hasSubtotalStyle:!!F.hasSubtotalStyle,values:{}},D=0,X=0;for(var K in F.values)D%u===l&&(x.values[X++]=F.values[D]),D++;return x},S.prototype.createBlankRowValueNode=function(l){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(l),function(F){return F.valueSourceIndex}).map(function(F){return{value:"",valueSourceIndex:F,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},S.prototype.needsBlankRow=function(l,u,F){return!l.isSubtotal||u===G.we&&F!==te.t.Compact},S.prototype.findValues=function(l){if(l.values)return l.values;var u=_.first(l.children);return u?this.findValues(u):void 0},S.prototype.wrapHierarchy=function(l,u,F,W,x,D){var K,X=this;return K={levels:this.wrapLevels(l.levels,u),root:{children:this.wrapNodes(l.root.children,l,u,F)}},W&&K.root.children.length>0&&(K.root.children=_.flatMap(K.root.children,function(k){return X.needsBlankRow(k,x,D)?[k,X.createBlankRowValueNode(k)]:[k]})),K.leafNodes=[],K},S.prototype.wrapLevels=function(l,u){if(l){for(var F=[],W=0,x=l;W<x.length;W++){var D=x[W],X=(0,U.ED)(D);if(F.push(X),D.sources.length>1&&u){for(var K=1;K<D.sources.length;K++)F.push({sources:[D.sources[K]]});X.sources.splice(1,X.sources.length-1)}}return F}},S.prototype.wrapNodes=function(l,u,F,W){if(l){for(var x=[],D=0,X=l;D<X.length;D++){var K=X[D],k=(0,U.ED)(K);if(K.isCollapsed&&!_.isEmpty(K.children)){var q=_.find(K.children,function(P){return P.isSubtotal});q&&(k.values=q.values),k.children=null,k.hasSubtotalStyle=!0}else{if(k.isSubtotal){var y=u.levels[k.level||0];if(1===y.sources.length&&!1===this.subtotalByColumn[y.sources[0].queryName])continue}k.hasSubtotalStyle=!!K.isSubtotal||W&&!_.isEmpty(K.children),k.children=this.wrapNodes(K.children,u,F,W)}if(!_.isEmpty(k.levelValues)&&k.levelValues.length>1&&F){for(var d=k.children,i=k,h=1;h<k.levelValues.length;h++){var c=(0,U.ED)(k),z=k.levelValues[h];z.levelSourceIndex=0,c.levelValues=[z],c.level+=h,c.isCollapsed=!0,c.children=void 0,i.isCollapsed=!1,i.children=[c],i=c}_.isEmpty(d)||(i.children=d,i.isCollapsed=!1),i.values=k.values,k.values=void 0,k.levelValues.splice(1,k.levelValues.length-1)}x.push(k)}return x}},S.prototype.updateHierarchy=function(l,u,F,W,x){l.leafNodes.length>0&&(l.leafNodes.length=0),l.root.children&&this.updateRecursive(l,l.root.children,null,l.leafNodes,u,F,W,x)},S.prototype.createEmptyNode=function(l){return void 0===l&&(l=0),{level:l,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},S.prototype.updateRecursive=function(l,u,F,W,x,D,X,K){for(var k,q=function(c,z){var P=u[c];if(P.siblings=u,l===y.rowHierarchy&&!P.isCollapsed&&!_.isEmpty(P.children)&&D===te.t.Outline&&!X&&P.children.unshift(y.createEmptyNode(P.children[0].level)),F&&(P.parent=F),k=l===y.rowHierarchy&&y.isSteppedLayout&&P.isSubtotal&&void 0!==P.levelSourceIndex?_.last(l.levels):l.levels[P.level],P.hierarchyLevel=k,k)if(P.levelValues){for(var L=[],A=[],Q=0,J=P.levelValues;Q<J.length;Q++){var de=J[Q],g=de.value;L.push(y.formatters[(ae=k.sources[de.levelSourceIndex||0]).queryName].format(g,null));var a=y.tooltipFormatters[ae.queryName];a&&A.push(a.format(g,null))}I.fF.assert(function(){return L.length===A.length||_.isEmpty(A)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),P.valueFormatted=L.join(y.compositeGroupSeparator),P.tooltipValueFormatted=_.isEmpty(A)?void 0:A.join(y.compositeGroupSeparator),P.queryName=1!==k.sources.length?void 0:k.sources[0].queryName}else{var ae;P.valueFormatted=(ae=k.sources[P.levelSourceIndex||0]).displayName,P.tooltipValueFormatted=ae.displayName,P.queryName=ae.queryName}P.index=c,_.isEmpty(P.children)?(!x||!P.isSubtotal||!X&&P.parent&&!P.parent.isSubtotal||y.valuesOnRow&&P.parent)&&(P.leafIndex=W.length,W.push(P)):(x&&(P.leafIndex=W.length,W.push(P)),y.updateRecursive(l,P.children,P,W,x,D,X,K),x&&(I.fF.assertAnyValue(_.every(P.children,function(f){return _.isEqual(f.hierarchyLevel,P.children[0].hierarchyLevel)}),"Children may come from different levels"),(!y.hasMultipleValueSources()||_.some(P.children,function(f){return _.some(f.hierarchyLevel.sources,function(b){return!b.isMeasure})}))&&(P.hasSubtotalStyle=!0))),P.position=K(P,u)},y=this,d=0,i=u.length;d<i;d++)q(d)},S.prototype.updateStaticColumnHeaders=function(l){var u=l.leafNodes;if(u&&u.length>0){if(!u[0].identity&&this.valuesOnRow&&1===u.length)return;for(var F=0,W=u.length;F<W;F++){var x=u[F];if(!x.identity&&_.isEmpty(x.levelValues)){var X=l.levels[x.level].sources[x.levelSourceIndex?x.levelSourceIndex:0];X&&(x.valueFormatted=X.displayName)}}}},S.prototype.getMatrixHierarchy=function(l){var u=this.rowHierarchy.root.children;if(u&&l===u)return this.rowHierarchy;var F=this.columnHierarchy.root.children;return F&&l===F?this.columnHierarchy:null},S.prototype.calculateRowHeaderPosition=function(l,u){var F=new j.ri;F.row.index=this.getRowLeafIndex(l),F.row.indexInSiblings=this.getIndex(l),F.row.isFirst=this.areAllParentsFirst(l,u),F.row.isLast=this.areAllParentsLast(l,u);var W=this.getLevel(l);return F.column.index=F.column.indexInSiblings=W,F.column.isFirst=0===W,F.column.isLast=this.isLeaf(l),F},S.prototype.calculateColumnHeaderPosition=function(l,u){var F=new j.ri,W=this.getLevel(l);F.row.index=F.row.indexInSiblings=W,F.row.isFirst=0===W,F.row.isLast=this.isLeaf(l);var x=this.getIndex(l);return F.column.index=F.column.indexInSiblings=x,F.column.isFirst=this.areAllParentsFirst(l,u),F.column.isLast=this.areAllParentsLast(l,u),F},S.prototype.getRowHeaderMetadataColumn=function(l){var u=this.getRowHeaderMetadataColumns(l);return u&&u[0]},S.prototype.getRowHeaderMetadataColumns=function(l){if(l&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,l.level)},S.prototype.getColumnHeaderMetadataColumn=function(l){var u=this.getColumnHeaderMetadataColumns(l);return u&&u[0]},S.prototype.getColumnHeaderMetadataColumns=function(l){if(l&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,l.level)},S.prototype.getHierarchyMetadataColumns=function(l,u){if(l&&l.levels&&!(l.levels.length<u)){var F=l.levels[u];if(F&&F.sources&&0!==F.sources.length)return F.sources}},S.isNodeGrandTotal=function(l){if(l){for(var u=l;u.parent;)u=u.parent;return u.isSubtotal}return!1},S}()},29043:function(Fe,me,E){E.d(me,{MV:function(){return l},th:function(){return o},wJ:function(){return S}});var V=E(53197),I=E(90120),U=E(51995),oe=E(85308),j=E(58520),le=E(45296),te=E(44783),G=E(62458),re=E(43286),ce=52;function o(D,X){var J,K={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(D)){var k;try{k=JSON.parse(D)}catch{return}var q=+k.yl,y=+k.yh,i=+k.xl,h=+k.xh,c=null!=k.md?+k.md:void 0;_.size(k.p)>ce&&X.setWarnings([new le.El]);for(var z=0,P=k.p;z<P.length;z++){var L=P[z];K.points.push({x:null!=L[0]?+L[0]:void 0,y:null!=L[1]?(J=+L[1],J*(y-q)/100+q):void 0})}return{points:_.filter(K.points,function(Q){return _.isFinite(Q.x)&&(null!=Q.y||_.isFinite(Q.y))}),lowX:i,highX:h,lowY:q,highY:y,minXDifference:c}}}function S(D,X,K){var k;G.fF.assertValue(D,"sparkline"),G.fF.assertValue(null===(k=X?.misc)||void 0===k?void 0:k.sparkline,"invalid type for sparkline"),G.fF.assertValue(K,"style");var q=X.misc.sparkline.groupingType;return{chartType:D.chartType,dataColor:K.isHighContrast?I.v.getThemeColor(K,te.fA):D.dataColor,strokeWidth:D.strokeWidth,marker:{show:!0,typeFlags:D.marker.typeFlags,color:K.isHighContrast?I.v.getThemeColor(K,te.fA):D.marker.color,size:D.marker.size,shape:D.marker.shape},isScalar:q&&!!(q.numeric||q.dateTime||q.temporal)}}function l(D,X,K,k,q,y,d,i){var h;if(null!=k){var A=y-K.getExtraLeft()-K.getExtraRight()-(i?i+5:0),Q=q-K.getExtraTop()-K.getExtraBottom();A-X.strokeWidth>1&&Q-X.strokeWidth>1&&(h=X.chartType===oe.U.line?function(D,X,K,k){var ae,y=D.dataColor,d=D.strokeWidth,i=D.marker,h=i.color,c=i.size,z=i.shape,P=i.typeFlags,L=D.isScalar,A=(0,re.Js)(P),Q=0===A||1===A&&(0,re.yE)(P,j.qC),J=Math.max(d,2)+(Q?0:Math.ceil(c/2)),de=k.points;ae=L?d3.scaleLinear().domain([k.lowX,k.highX]).range([J,X-J]):d3.scalePoint().domain(_.map(_.range(k.lowX,k.highX+1),function(n){return n.toString()})).range([J,X-J]);var C,p,B=d3.scaleLinear().domain(d3.extent(de,function(n){return n.y})).range([K-J,J]),g=d3.line().x(function(n){return ae(n.x)}).y(function(n){return B(n.y)}),a=_.filter(de,function(n){return null!=n.y}),b={tagName:"path",attributes:{d:g(a)},classNames:[],styleProperties:{stroke:y,"stroke-width":d.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},r=function(D,X){var K=X.marker.typeFlags,k=d3.extent(D,function(d){return d.y}),q=k[0],y=k[1];return _.filter(D,function(d,i){var h,c;return null!=d.y&&(!!(0,re.yE)(K,j.$6)||(0,re.yE)(K,j.Ps)&&0===i||(0,re.yE)(K,j.Z$)&&i===D.length-1||(0,re.yE)(K,j.pd)&&d.y<0||(0,re.yE)(K,j.Zc)&&d.y===y||(0,re.yE)(K,j.O3)&&d.y===q||(0,re.yE)(K,j.qC)&&null==(null===(h=D[i-1])||void 0===h?void 0:h.y)&&null==(null===(c=D[i+1])||void 0===c?void 0:c.y))})}(a,D);if(!_.isEmpty(r)){var e="markerKey".concat(c).concat(h).concat(z);C={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:e,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:c.toString(),markerWidth:c.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,U.F)(z).toString(),"stroke-opacity":"1",stroke:h,fill:h},attributes:{d:(0,U.Ar)(z)}}]}]},p={tagName:"path",attributes:{d:g(r)},classNames:[],styleProperties:{stroke:y,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(e,")"),"marker-mid":"url(#".concat(e,")"),"marker-end":"url(#".concat(e,")")}}}return{tagName:"svg",children:p?[C,b,p]:[b],classNames:[],styleProperties:{},attributes:{height:K+"px",width:X+"px"}}}(X,A,Q,k):function(D,X,K,k){var z,q=D.dataColor,y=D.isScalar,d=k.points,i=[k.lowX,k.highX],h=function(D,X,K,k,q){if(_.isEmpty(D))return 0;var i,h=k[k.length-1]-k[0];return q&&k&&k.length>1?(0!==h?(G.fF.assert(function(){return null!=X},"minXDifference cannot be null for scalar plotted as columns"),i=K*(X/(h+X))):i=K,i=Math.max(i,2)):i=K/(h+1),.8*i}(d,k.minXDifference,X,i,y),c=h/2;z=y?d3.scaleLinear().domain(i).range([c,X-c]):d3.scalePoint().domain(_.map(_.range(k.lowX,k.highX+1),function(J){return J.toString()})).range([c,X-c]);var P=d3.extent(d,function(J){return J.y});P[0]=Math.min(0,P[0]),P[1]=Math.max(0,P[1]);var L=d3.scaleLinear().domain(P).range([K,0]),A=L(0),Q=h.toString();return{tagName:"svg",children:_.chain(d).filter(function(J){return null!=J.y}).map(function(J){var de=(z(J.x)-c).toString(),ae=(A+(0,V.sc)(L,Math.max(0,J.y),0)).toString(),B=Math.abs((0,V.sc)(L,0,J.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:q},attributes:{x:de,y:ae,width:Q,height:B}}}).value(),classNames:[],styleProperties:{},attributes:{height:K+"px",width:X+"px"}}}(X,A,Q,k))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(d&&"Before"!==d.layout?[h,D]:[D,h],function(ae){return!!ae})}}}}]);