"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["extension-host-artifact-update"],{73582:function(et,T,a){a.r(T),a.d(T,{ExtensionHostArtifactUpdateModule:function(){return Q}});var P=a(77476),u=a(60756),r=a(85732),x=a(14172),W=a(77526),$=a(6663),k=a(17653),R=a(11105),h=a(73471),V=a(60397),H=a(17899),B=a(82618),S=(0,r.PH)("[Extension Host Artifact Update] Subscribe Artifact Update",(0,r.Ky)()),O=(0,r.PH)("[Extension Host Artifact Update] Unsubscribe Artifact Update",(0,r.Ky)()),G=a(8894),F="extensionHostArtifactUpdate",l=(0,G.H)({selectId:function(d){return d.subscriptionId}}),K={artifactUpdateSubscriptions:l.getInitialState()},N=(0,r.ZF)(F),X=(0,r.P1)(N,function(e){return l.getSelectors().selectAll(e.artifactUpdateSubscriptions)}),p=a(50423),Z=function(){function e(d,i,f){var o=this;this.actions$=d,this.messageBroker=i,this.store=f,this.onSubscribeArtifactUpdateReceived$=(0,H.Av)(this.actions$,this.messageBroker,h.Vm.subscribeArtifactUpdate,function(n){var s=n.iframeId,y=n.workspaceObjectId,j=(0,R.Z)();return o.store.dispatch(S({subscriptionId:j,iframeId:s,workspaceObjectId:y})),h.Vm.subscribeArtifactUpdate.resolve({subscriptionId:j})}),this.onUnsubscribeArtifactUpdateReceived$=(0,u.GW)(function(){return o.actions$.pipe((0,H.pR)(h.Vm.unsubscribeArtifactUpdate),(0,x.U)(function(n){return O({subscriptionId:n.subscriptionId})}))}),this.pushArtifactUpdate$=(0,u.GW)(function(){return o.store.select(B.Fe).pipe((0,W.x)(),(0,$.G)(),(0,u.IC)(function(){return o.store.select(X)}),(0,x.U)(function(n){for(var s=n[0],y=s[0],j=s[1],C=[],z=function(_,tt,b){var I=[],m=y[b],g=j[b];m&&g&&(g.forEach(function(t){var c=m.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&!c&&I.push({changeType:"add",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})}),m.forEach(function(t){var c=g.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&!c&&I.push({changeType:"remove",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})}),g.forEach(function(t){var c=m.find(function(v){return v.objectId===t.objectId});t.objectId&&t.artifactType&&t.lastUpdatedDate&&c&&c.objectId&&c.artifactType&&c.lastUpdatedDate&&c.lastUpdatedDate.getTime()!==t.lastUpdatedDate.getTime()&&I.push({changeType:"edit",workspaceObjectId:b,artifactObjectId:t.objectId,artifactType:t.artifactType})})),I.length>0&&C.push(h.Vm.onArtifactUpdate({subscriptionId:_,changes:I})(tt))},E=0,M=n[1];E<M.length;E++){var A=M[E];z(A.subscriptionId,A.iframeId,A.workspaceObjectId)}return C}),(0,k.b)(function(n){n.forEach(function(s){o.messageBroker.send(s)})}))},{dispatch:!1})}return e.\u0275fac=function(i){return new(i||e)(p.\u0275\u0275inject(u.eX),p.\u0275\u0275inject(V.u),p.\u0275\u0275inject(r.yh))},e.\u0275prov=p.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),D=a(36012);function L(e,d){return(0,r.Lq)(K,(0,D.P)(S,function(i,f){i.artifactUpdateSubscriptions=l.upsertOne({subscriptionId:f.subscriptionId,iframeId:f.iframeId,workspaceObjectId:f.workspaceObjectId},i.artifactUpdateSubscriptions)}),(0,D.P)(O,function(i,f){i.artifactUpdateSubscriptions=l.removeOne(f.subscriptionId,i.artifactUpdateSubscriptions)}))(e,d)}var Q=function(){function e(){}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=p.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=p.\u0275\u0275defineInjector({imports:[P.CommonModule,r.Aw.forFeature(F,L),u.sQ.forFeature([Z])]}),e}()}}]);