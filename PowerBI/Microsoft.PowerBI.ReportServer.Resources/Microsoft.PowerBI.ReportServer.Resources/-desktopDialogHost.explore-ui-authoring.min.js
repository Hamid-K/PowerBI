"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["explore-ui-authoring","explore-ui-authoring.0"],{26902:function(te,G,s){s.d(G,{L6:function(){return z},aI:function(){return p},ac:function(){return V},dw:function(){return Q},uz:function(){return I}});var h=s(40812),t=s(64067),P=s(62458),w=s(94419),C=s(59897),x=s(80777),L={totalMatchingOption:1,reverseDirection:!1,hideText:!1};function p(F,j){return P.fF.assertValue(F,"visual"),P.fF.assertValue(j,"repetition"),z(S(F.objects,j))}function z(F){if(!F)return L;var j,Z=F.minValue;Z&&(j=Z.value);var B,R=F.maxValue;R&&(B=R.value);var W=1,H=F.totalMatchingOption;return H&&(W=H.value),{minValue:j,maxValue:B,positiveColor:D(F.positiveColor),negativeColor:D(F.negativeColor),axisColor:D(F.axisColor),reverseDirection:F.reverseDirection.value,hideText:F.hideText.value,totalMatchingOption:W}}function D(F){var j=F.solid.color;return(0,t.A7)(j.value)?{solid:{color:j.value}}:null}function I(){return V(L,x.Ge.fromPrimitiveTypeAndCategory(12))}function V(F,j){var Z,B,R;return P.fF.assertValue(F,"dataBars"),P.fF.assertValue(j,"valueType"),void 0!==F.minValue&&(Z=U(F.minValue,j)),void 0!==F.maxValue&&(B=U(F.maxValue,j)),void 0!==F.totalMatchingOption&&(R=(0,w.cA)(F.totalMatchingOption)),{minValue:Z,maxValue:B,positiveColor:(0,C.EV)(F.positiveColor&&F.positiveColor.solid.color,"maxColor"),negativeColor:(0,C.EV)(F.negativeColor&&F.negativeColor.solid.color,"minColor"),axisColor:(0,C.EV)(F.axisColor&&F.axisColor.solid.color,"foreground"),reverseDirection:(0,w.O7)(F.reverseDirection),hideText:(0,w.O7)(F.hideText),totalMatchingOption:R}}function S(F,j){return P.fF.assertValue(j,"objectRepetition"),(0,h.OT)(F,j)}function Q(F,j){return P.fF.assertValue(j,"objectRepetition"),void 0!==S(F,j)}function U(F,j){if(P.fF.assert(function(){return j.integer||j.numeric},"databars only supports numeric SQExprs"),j.integer){var Z=Math.round(F);return(0,w.cA)(Z)}return 2===j.primitiveType?(0,w.gH)(F):(P.fF.assert(function(){return 259===j.extendedType},"Unexpected data type."),(0,w.tx)(F))}},41606:function(te,G,s){s.d(G,{x:function(){return t}});var h=s(47508),t=function(){function P(){}return P.getDefaultVisualPlugin=function(w){return w&&w.featureSwitches&&w.featureSwitches.pivotTableVisualEnabled?h.L.tableEx:h.L.table},P}()},55201:function(te,G,s){function h(t,P){if(!t&&!P)return!0;if(!!t!=!!P||t.length!==P.length)return!1;for(var w=0,C=t.length;w<C;w++)if(!t[w].equals(P[w]))return!1;return!0}s.d(G,{L:function(){return h}})},32441:function(te,G,s){s.d(G,{u:function(){return w}});var h=s(50423),t=s(18460),P=function(x,L,p,z,D){return{formattingSources:x,indicatorEnabled:L,mobileFormatting:p,disabledCards:z,disabledSlices:D}},w=function(){function C(){var x=this;this.mobileFormatting=!1,this.propertyChanged=new h.EventEmitter,this.outputArgs={propertyChanged:function(p){return x.propertyChanged.emit(p)}},this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="FormattingPaneComponentId"}return C.\u0275fac=function(L){return new(L||C)},C.\u0275cmp=h.\u0275\u0275defineComponent({type:C,selectors:[["formatting-pane-lazy"]],inputs:{formattingSources:"formattingSources",indicatorEnabled:"indicatorEnabled",mobileFormatting:"mobileFormatting",disabledCards:"disabledCards",disabledSlices:"disabledSlices"},outputs:{propertyChanged:"propertyChanged"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(L,p){1&L&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&L&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction5(4,P,p.formattingSources,p.indicatorEnabled,p.mobileFormatting,p.disabledCards,p.disabledSlices))("modulePath",p.modulePath)("outputArgs",p.outputArgs)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),C}()},78633:function(te,G,s){s.d(G,{a:function(){return w}});var h=s(50423),t=s(18460),P=function(x){return{colors:x}},w=function(){function C(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="GradientBarComponentId"}return C.\u0275fac=function(L){return new(L||C)},C.\u0275cmp=h.\u0275\u0275defineComponent({type:C,selectors:[["gradient-bar-lazy"]],inputs:{colors:"colors"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(L,p){1&L&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&L&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction1(3,P,p.colors))("modulePath",p.modulePath)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),C}()},71707:function(te,G,s){s.d(G,{I:function(){return w}});var h=s(50423),t=s(18460),P=function(x,L,p,z,D){return{toggle:x,ariaLabelledby:L,ariaDescribedby:p,toggleLabel:z,isDisabled:D}},w=function(){function C(){var x=this;this.onToggleChange=new h.EventEmitter,this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="ToggleSwitchModernComponentId",this.outputArgs={onToggleChange:function(p){return x.onToggleChange.emit(p)}}}return C.\u0275fac=function(L){return new(L||C)},C.\u0275cmp=h.\u0275\u0275defineComponent({type:C,selectors:[["toggle-switch-modern-lazy"]],inputs:{toggle:"toggle",ariaLabelledby:"ariaLabelledby",ariaDescribedby:"ariaDescribedby",toggleLabel:"toggleLabel",isDisabled:"isDisabled"},outputs:{onToggleChange:"onToggleChange"},decls:1,vars:10,consts:[[3,"inputArgs","modulePath","outputArgs","componentId"]],template:function(L,p){1&L&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&L&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction5(4,P,p.toggle,p.ariaLabelledby,p.ariaDescribedby,p.toggleLabel,p.isDisabled))("modulePath",p.modulePath)("outputArgs",p.outputArgs)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),C}()},90094:function(te,G,s){s.d(G,{l:function(){return w}});var h=s(50423),t=s(18460),P=function(x){return{warningMessage:x}},w=function(){function C(){this.modulePath="@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",this.componentId="WarningComponentId"}return C.\u0275fac=function(L){return new(L||C)},C.\u0275cmp=h.\u0275\u0275defineComponent({type:C,selectors:[["warning-eager"]],inputs:{warningMessage:"warningMessage"},decls:1,vars:5,consts:[[3,"inputArgs","modulePath","componentId"]],template:function(L,p){1&L&&h.\u0275\u0275element(0,"pbi-lazy-load",0),2&L&&h.\u0275\u0275property("inputArgs",h.\u0275\u0275pureFunction1(3,P,p.warningMessage))("modulePath",p.modulePath)("componentId",p.componentId)},dependencies:[t.R],encapsulation:2,changeDetection:0}),C}()},42101:function(te,G,s){s.d(G,{p:function(){return Q}});var h=s(9844),x=(s(32441),s(78633),s(71707),s(90094),s(77476)),L=s(9398),p=s(76072),z=s(82156),D=s(50423),I={loadChildren:function(){return Promise.all([s.e(5),s.e("pane-formatting")]).then(s.bind(s,53150)).then(function(F){return F.PaneFormattingModule})}};p.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/pane-formatting/pane-formatting.module#PaneFormattingModule",I.loadChildren);var V=[{path:"dummy-pane-formatting-lazy",loadChildren:I.loadChildren}],Q=function(){function U(){}return U.\u0275fac=function(j){return new(j||U)},U.\u0275mod=D.\u0275\u0275defineNgModule({type:U}),U.\u0275inj=D.\u0275\u0275defineInjector({imports:[x.CommonModule,h.j,z.N,L.Bz.forChild(V)]}),U}()},21302:function(te,G,s){s.d(G,{Ol:function(){return w},mF:function(){return P},sn:function(){return t}});var h=s(50423),t={type:3,name:"showFormatPane"},P={type:3,name:"showPageFormatPane"},w=new h.InjectionToken("PropertyChangeIndicatorService")},43626:function(te,G,s){s.d(G,{DS:function(){return I},E6:function(){return S},Vc:function(){return D},fI:function(){return V},tE:function(){return Q}});var h=s(76072),t={loadChildren:function(){return s.e("explore-ui-authoring.0").then(s.bind(s,43281)).then(function(F){return F.ExploreUIAuthoringModule})}};h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/explore-ui-authoring/explore-ui-authoring.module#ExploreUIAuthoringModule",t.loadChildren),h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/explore-formatting/explore-formatting.module#ExploreFormattingModule",function(){return Promise.all([s.e(5),s.e("explore-formatting")]).then(s.bind(s,39091)).then(function(F){return F.ExploreFormattingModule})});var w={loadChildren:function(){return s.e("selection-pane").then(s.bind(s,78656)).then(function(F){return F.SelectionPaneModule})}};h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/selection-pane/selection-pane.module#SelectionPaneModule",w.loadChildren);var C={loadChildren:function(){return s.e("bookmarks-pane").then(s.bind(s,6396)).then(function(F){return F.BookmarksPaneModule})}};h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUI/lazy-modules/bookmarks-pane/bookmarks-pane.module#BookmarksPaneModule",C.loadChildren);var x={loadChildren:function(){return s.e("field-well-view-model").then(s.bind(s,42611)).then(function(F){return F.FieldWellViewModelModule})}};h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/field-well-view-model/field-well-view-model.module#FieldWellViewModelModule",x.loadChildren);var L={loadChildren:function(){return s.e("visual-container-skittles-ui").then(s.bind(s,15250)).then(function(F){return F.VisualContainerSkittlesUIModule})}};h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/visual-container-skittles/visual-container-skittles-ui.module#VisualContainerSkittlesUIModule",L.loadChildren);var p={loadChildren:function(){return s.e("visual-calc-editor").then(s.bind(s,83269)).then(function(F){return F.VisualCalcEditorModule})}};h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/visual-calc-editor/visual-calc-editor.module#VisualCalcEditorModule",p.loadChildren),h.E.addLazyLoadForLegacyMapping("@powerbi/ExploreUIAuthoring/lazy-modules/visual-calc-flyout/visual-calc-flyout.module#VisualCalcFlyoutModule",function(){return s.e("visual-calc-flyout").then(s.bind(s,56137)).then(function(F){return F.VisualCalcFlyoutModule})});var D=[{path:"dummy-explore-ui-authoring-lazy",loadChildren:t.loadChildren},{path:"dummy-selection-pane-module",loadChildren:w.loadChildren},{path:"dummy-bookmarks-pane-module",loadChildren:C.loadChildren},{path:"field-well-view-model-module",loadChildren:x.loadChildren},{path:"visual-container-skittles-module",loadChildren:L.loadChildren},{path:"dummy-visual-calc-editor",loadChildren:p.loadChildren}],I="fieldWellBucketService",V=I,S="fieldWellFieldService",Q=S},43281:function(te,G,s){s.r(G),s.d(G,{ExploreUIAuthoringModule:function(){return sl}});var h=s(86286),t=s(50423),P=s(77476),w=s(89961);function C(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"section",1),t.\u0275\u0275element(1,"visual-types-container-modern",4),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("visualContainer",e.visualContainer)("visualPluginFilter",e.nonPersonalVisualPluginFilter)("disableMoreOptionsIcon",!0)("visualConversionSource",e.visualConversionSource)}}var x=function(){function r(){}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["all-visual-selector"]],inputs:{visualContainer:"visualContainer",visualPluginFilter:"visualPluginFilter",showNonPersonalVisualizationPane$:"showNonPersonalVisualizationPane$",nonPersonalVisualPluginFilter:"nonPersonalVisualPluginFilter",visualConversionSource:"visualConversionSource"},decls:5,vars:6,consts:[[1,"allVisualizationsPicker","explorationContainer","newPaneColors"],[1,"modern-format-pane"],[1,"compact-visual-types",3,"visualContainer","visualPluginFilter","visualConversionSource"],["class","modern-format-pane",4,"ngIf"],[1,"withTopDivider","compact-visual-types",3,"visualContainer","visualPluginFilter","disableMoreOptionsIcon","visualConversionSource"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"div",0)(1,"section",1),t.\u0275\u0275element(2,"visual-types-container-modern",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,C,2,4,"section",3),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(2),t.\u0275\u0275property("visualContainer",i.visualContainer)("visualPluginFilter",i.visualPluginFilter)("visualConversionSource",i.visualConversionSource),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(4,4,i.showNonPersonalVisualizationPane$)))},dependencies:[P.NgIf,w.r,P.AsyncPipe],styles:[".allVisualizationsPicker[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),r}(),L=function(){function r(n){this.visualSelectorInput=n,this.visualContainer=n.visualContainer,this.visualPluginFilter=n.visualPluginFilter,this.nonPersonalVisualPluginFilter=n.nonPersonalVisualPluginFilter,this.showNonPersonalVisualizationPane$=n.showNonPersonalVisualizationPane$}return r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275directiveInject(h.M))},r.\u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["all-visual-selector-flyout"]],decls:2,vars:4,consts:[[1,"allVisualSelectorContainer"],[1,"white-background",3,"visualContainer","visualPluginFilter","nonPersonalVisualPluginFilter","showNonPersonalVisualizationPane$"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275element(1,"all-visual-selector",1),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("visualContainer",i.visualContainer)("visualPluginFilter",i.visualPluginFilter)("nonPersonalVisualPluginFilter",i.nonPersonalVisualPluginFilter)("showNonPersonalVisualizationPane$",i.showNonPersonalVisualizationPane$))},dependencies:[x],styles:["[_nghost-%COMP%]{width:100%}.allVisualSelectorContainer[_ngcontent-%COMP%]{padding:3px 0;background:var(--fluent-theme-white-color);border:1px solid var(--gray-110);border-top:none}"]}),r}(),p=s(81337),z=s(35510),D=s(63057),I=s(83317),V=s(59973),S=s(48787),Q=s(33754),U=s(78778),F=s(73221),j=s(25512),Z=s(86940),B=s(8590),R=s(3579),W=s(60661),H=s(61903),ne=s(20590),J=s(47508),A=s(62458),Y=s(26898),de=s(29748),q=s(39503),oe=s(11494),ce=s(83008),Ve=s(66977),ae=s(9380),Se=s(28894),le=s(65181),gi=s(69071),he=s(29866),pe=s(66890),it=s(34518),hi=s(65188),nt=s(71707),ot=s(36858),je=s(85102),Ht=["visualPicker"],ht=["allVisualToggleButton"],fi=["suggestedVisualTypeElement"];function ft(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"label",8),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(e.label)}}var Kt=function(n,e){return{selected:n,notSelected:e}};function mt(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",14,15),t.\u0275\u0275listener("click",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.updateVisualType(d.type))})("keydown",function(u){var g=t.\u0275\u0275restoreView(e).index,v=t.\u0275\u0275nextContext(2).ngIf,f=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(f.onSuggestedVisualTypeKeydown(u,g,v.suggestions.length))}),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275element(3,"svg-use-symbol",16),t.\u0275\u0275elementEnd()}if(2&r){var i=n.$implicit,o=n.index,a=t.\u0275\u0275nextContext(2).ngIf,l=t.\u0275\u0275nextContext();t.\u0275\u0275property("tabindex",o===t.\u0275\u0275pipeBind1(2,8,l.suggestedVisualTypeFocusIndex$)?0:-1)("ngClass",t.\u0275\u0275pureFunction2(10,Kt,i.type===a.selectedInfo.type,i.type!==a.selectedInfo.type))("disabled",!l.allowChangeVisualType)("ngStyle",i.imageStyles)("pbiTooltip",i.tooltip),t.\u0275\u0275attribute("aria-colindex",o),t.\u0275\u0275advance(3),t.\u0275\u0275property("sheet",i.iconSheet)("symbolId",i.symbol)}}var Qt=function(n,e){return{"pbi-glyph-chevronupsmall":n,"pbi-glyph-chevrondownsmall":e}};function yt(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",17,18),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(a.toggleAllVisualState())}),t.\u0275\u0275pipe(2,"localize"),t.\u0275\u0275pipe(3,"localize"),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction2(9,Qt,i.showAllVisualizations,!i.showAllVisualizations))("pbiTooltip",t.\u0275\u0275pipeBind1(3,7,i.showAllVisualizations?"Chevron_CollapseDescription":"Chevron_ExpandDescription"))("disabled",!i.allowChangeVisualType),t.\u0275\u0275attribute("aria-expanded",i.showAllVisualizations)("aria-label",t.\u0275\u0275pipeBind1(2,5,"Show_All_Visual_Types"))}}var Xt=function(n){return{withAllVisualsSelector:n}};function Ct(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"div",9)(1,"div",10)(2,"div",11),t.\u0275\u0275template(3,mt,4,13,"button",12),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(4,yt,4,12,"button",13),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext().ngIf,i=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(4,Xt,i.showAllVisualizations&&!i.allVisualsPickerInFlyout||i.alwaysExpanded)),t.\u0275\u0275advance(1),t.\u0275\u0275attribute("aria-colcount",e.suggestions.length),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.suggestions),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.alwaysExpanded)}}function Zt(r,n){if(1&r&&t.\u0275\u0275element(0,"all-visual-selector",19),2&r){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("visualContainer",e.visualContainer)("visualPluginFilter",e.visualPluginFilter)("showNonPersonalVisualizationPane$",e.showNonPersonalVisualizationPane$)("nonPersonalVisualPluginFilter",e.nonPersonalVisualizationPaneFilter)("visualConversionSource",e.host)}}var bt=function(n){return{isDisabled:n}};function mi(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",20)(1,"toggle-switch-modern-lazy",21),t.\u0275\u0275listener("onToggleChange",function(l){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(c.updateAutoVisualState(l))}),t.\u0275\u0275elementEnd()()}if(2&r){var i=t.\u0275\u0275nextContext().ngIf,o=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(5,bt,!o.allowChangeVisualType)),t.\u0275\u0275advance(1),t.\u0275\u0275property("toggle",i.selectedInfo.isAutoVisual)("isDisabled",!o.allowChangeVisualType)("pbiTooltip",o.tooltip)("toggleLabel",o.autoModeToggleLabel)}}var Pt=function(n,e){return{disabledVisualPicker:n,withSuggestions:e}};function yi(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"div",1),t.\u0275\u0275template(1,ft,2,1,"label",2),t.\u0275\u0275elementStart(2,"div",3,4),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275template(5,Ct,5,6,"div",5),t.\u0275\u0275template(6,Zt,1,5,"all-visual-selector",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(7,mi,2,7,"div",7),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.label),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction2(7,Pt,t.\u0275\u0275pipeBind1(4,5,e.disabled$),!e.noSuggestions)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",!e.noSuggestions),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.showAllVisualizations&&!e.allVisualsPickerInFlyout||e.alwaysExpanded),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!e.noAutoToggleSwitch)}}var rt=function(r){function n(e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k){var O=r.call(this)||this;return O.conceptualSchemaProxy=e,O.contextActivityService=i,O.explorationNavigation=o,O.eventBridge=a,O.dataSources=l,O.featureSwitchService=c,O.injector=u,O.lazyScoped=d,O.localizationService=g,O.overlay=v,O.trustedVisual=f,O.visualAuthoring=m,O.visualPaneSettingsService=y,O.visualPluginOperationsService=M,O.visualPlugin=b,O.visualTypesService=k,O.numberOfSuggestionsToShow=5,O.onVisualTypeUpdated=new t.EventEmitter,O.showNonPersonalVisualizationPane$=new z.X(!1),O.isInitialized$=new z.X(!1),O.suggestedVisualTypeFocusIndex$=new z.X(void 0),O.visualViewModel$=new z.X(void 0),O.isInitialFocusSet=!1,O.visualPluginFilter=function(E,T,K){return!(O.withPerspectives&&O.visualPluginOperationsService.isQnaVisual(E.name)||_.isFunction(O.isVisualExcluded)&&O.isVisualExcluded(E.name))&&(0,H.CL)(E,T,K)},O.nonPersonalVisualizationPaneFilter=function(E,T,K){return!(0,H.CL)(E,T,K)},O}return(0,p.__extends)(n,r),Object.defineProperty(n.prototype,"_suggestedVisualTypeElementRefs",{set:function(i){this.suggestedVisualTypeElementRefs=i?.toArray()||[],!this.isInitialFocusSet&&null!=this.suggestedVisualTypeFocusIndex$.value&&this.setFocusAfterInitialization&&(this.setInitialFocus(),this.isInitialFocusSet=!0)},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var e=this;this.lazyScoped.get("authoringVisualRecommendationInterop").then(function(i){e.recommendationInterop=i,e.visualTypesService.initialize(),e.isInitialized$.next(!0)}),this.visualTypesService.availableVisualTypes$.pipe((0,I.R)(this.onDestroy$)).subscribe(function(i){e.availableVisualTypes=i}),this.allowChangeVisualType=this.visualContainer?this.visualPluginOperationsService.canConvertVisual(this.visualContainer):this.allowSelectVisualTypeWhenNoVisual,this.isInitialized$.pipe((0,I.R)(this.onDestroy$),(0,V.h)(function(i){return!!i})).subscribe(function(){e.updateVisualViewModel(),e.updateNonPersonalVisualState()}),(0,D.T)(this.changes$("visualContainer"),this.eventBridge.on(B.KD7),this.eventBridge.on(B.jCS),this.eventBridge.on(B.D1A),this.eventBridge.on(B.Udu)).pipe((0,I.R)(this.onDestroy$)).subscribe(function(){e.isInitialized$.value&&(e.updateVisualViewModel(),e.updateNonPersonalVisualState())})},n.prototype.onResize=function(){var e;null===(e=this.allVisualSelectorOverlayRef)||void 0===e||e.close()},n.prototype.toggleAllVisualState=function(){this.showAllVisualizations=!this.showAllVisualizations,this.allVisualsPickerInFlyout&&this.showHideVisualPickerFlyout(this.showAllVisualizations)},n.prototype.updateAutoVisualState=function(e){this.visualAuthoring.convert(this.visualContainer,this.dataSources.get(),e?void 0:(0,R.s)(this.visualContainer),this.explorationNavigation.getCurrentSection())},n.prototype.updateVisualType=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,o,l,c,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:if(!this.visualContainer)return[3,5];i=this.contextActivityService.createActivity({name:"SelectVisualRecommendation",visualName:this.visualContainer.name,data:{visualTypePicked:e,source:"Skittle",skittleType:"Build"}}),d.label=1;case 1:return d.trys.push([1,3,,4]),o=(0,W.II)(this.visualContainer),[4,this.visualAuthoring.convert(this.visualContainer,this.dataSources.get(),e,this.explorationNavigation.getCurrentSection(),o,"Skittle",i)];case 2:return d.sent()?(this.onVisualTypeUpdated.emit(e),i.resolve()):i.reject(new Error("cannot convert to recommended type")),[3,4];case 3:throw l=d.sent(),i.reject(l),l;case 4:return[3,6];case 5:this.allowSelectVisualTypeWhenNoVisual&&(c=this.visualPlugin.getPlugin(e))&&(u=_.find(this.availableVisualTypes.types,function(g){return g.plugin.name===c.name}))&&this.visualTypesService.performSelectVisualTypeAction(u,this.host),d.label=6;case 6:return[2]}})})},n.prototype.onSuggestedVisualTypeKeydown=function(e,i,o){"ArrowRight"===e.key||"ArrowDown"===e.key?i+1<o&&(this.suggestedVisualTypeFocusIndex$.next(i+1),this.suggestedVisualTypeElementRefs[i+1].nativeElement.focus()):("ArrowLeft"===e.key||"ArrowUp"===e.key)&&i-1>=0&&(this.suggestedVisualTypeFocusIndex$.next(i-1),this.suggestedVisualTypeElementRefs[i-1].nativeElement.focus())},n.prototype.showHideVisualPickerFlyout=function(e){e&&!this.allVisualSelectorOverlayRef&&this.showAllVisualFlyout(),!e&&this.allVisualSelectorOverlayRef&&(this.allVisualSelectorOverlayRef.close(),this.allVisualSelectorOverlayRef=void 0)},n.prototype.showAllVisualFlyout=function(){var e=this;this.allVisualSelectorOverlayRef=this.overlay.open({component:L,data:{visualContainer:this.visualContainer,visualPluginFilter:this.visualPluginFilter,showNonPersonalVisualizationPane$:this.showNonPersonalVisualizationPane$,nonPersonalVisualPluginFilter:this.nonPersonalVisualizationPaneFilter},options:{width:this.visualPickerRef.nativeElement.offsetWidth,positionStrategy:this.overlay.position().flexibleConnectedTo(this.visualPickerRef).withPositions([(0,j.Oq)()]).withFlexibleDimensions(!0).withGrowAfterOpen(!0),hasBackdrop:!0,backdropClass:Z.L,disposeOnNavigation:!0},injector:this.injector,closeOnBackdropClick:!0,forwardClickDisabledElements:[this.allVisualToggleButtonRef.nativeElement]}),this.allVisualSelectorOverlayRef.onClose.pipe((0,S.q)(1)).subscribe(function(){e.allVisualSelectorOverlayRef=void 0,e.showAllVisualizations=!1})},n.prototype.setInitialFocus=function(){var i,o,e=this;this.suggestedVisualTypeFocusIndex$.value>=0&&(A.fF.assert(function(){return e.suggestedVisualTypeFocusIndex$.value<_.size(e.suggestedVisualTypeElementRefs)},"suggested type elementRefs not updated yet"),null===(o=null===(i=this.suggestedVisualTypeElementRefs[this.suggestedVisualTypeFocusIndex$.value])||void 0===i?void 0:i.nativeElement)||void 0===o||o.focus())},n.prototype.updateVisualViewModel=function(){var e;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,o,a,l,c,u,d,g,v,f,m=this;return(0,p.__generator)(this,function(y){switch(y.label){case 0:return i=(0,W.Xf)(this.visualContainer),_.isEmpty(null===(e=i?.defn)||void 0===e?void 0:e.select())?[3,2]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:a=y.sent(),o=this.recommendationInterop.getRecommendedVisualTypes(this.visualContainer,a,this.numberOfSuggestionsToShow,this.isVisualExcluded),y.label=2;case 2:return _.isEmpty(o)&&(o=[J.L.columnChart.name,J.L.barChart.name,J.L.lineChart.name,J.L.tableEx.name,J.L.card.name]),(0,W.II)(this.visualContainer)||(l=(0,R.s)(this.visualContainer),(c=_.indexOf(o,l))>=0&&o.splice(c,1),o.unshift(l),_.size(o)>this.numberOfSuggestionsToShow&&o.pop()),u=_.map(o,function(M){var b=m.visualPlugin.getPlugin(M);if(b){var k=(0,ne.tl)(b,m.trustedVisual,m.localizationService,void 0);return{type:M,symbol:k.class,iconSheet:"visualizationPaneIcons",imageStyles:m.getVisualImageStyles(b),tooltip:k.title}}}),d=_.filter(u,function(M){return null!=M}),g=(0,R.s)(this.visualContainer),v=(0,W.II)(this.visualContainer),f={type:g,isAutoVisual:v},this.withPerspectives&&this.visualAuthoring.setPresentationChangesApplied(!0),this.visualViewModel$.next({selectedInfo:f,suggestions:d}),this.suggestedVisualTypeFocusIndex$.next(Math.min(0,d.length-1)),[2]}})})},n.prototype.getVisualImageStyles=function(e){return e.iconUrl&&(e.developerModeVisual||e.custom&&!this.trustedVisual.isAutomaticallyImportedVisual(e.name))?{"background-image":e.iconUrl,"background-repeat":"round","background-clip":"content-box",padding:"1px"}:null},n.prototype.updateNonPersonalVisualState=function(){var e=this;this.showNonPersonalVisualizationPane$.next(_.some(this.visualPlugin.getConvertibleVisuals(),function(i){return null!=i&&!(0,H.CL)(i,e.featureSwitchService,e.visualPaneSettingsService)}))},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(de.r),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(oe.J),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(t.Injector),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(le.o),t.\u0275\u0275directiveInject(Z._),t.\u0275\u0275directiveInject(gi.t),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(it.R),t.\u0275\u0275directiveInject(Ve.f),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(Q.V))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["auto-visual"]],viewQuery:function(i,o){if(1&i&&(t.\u0275\u0275viewQuery(Ht,5,t.ElementRef),t.\u0275\u0275viewQuery(ht,5,t.ElementRef),t.\u0275\u0275viewQuery(fi,5,t.ElementRef)),2&i){var a=void 0;t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(o.visualPickerRef=a.first),t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(o.allVisualToggleButtonRef=a.first),t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(o._suggestedVisualTypeElementRefs=a)}},hostBindings:function(i,o){1&i&&t.\u0275\u0275listener("resize",function(){return o.onResize()},!1,t.\u0275\u0275resolveWindow)},inputs:{visualContainer:"visualContainer",label:"label",autoModeToggleLabel:"autoModeToggleLabel",withPerspectives:"withPerspectives",tooltip:"tooltip",numberOfSuggestionsToShow:"numberOfSuggestionsToShow",setFocusAfterInitialization:"setFocusAfterInitialization",noAutoToggleSwitch:"noAutoToggleSwitch",noSuggestions:"noSuggestions",allVisualsPickerInFlyout:"allVisualsPickerInFlyout",disabled$:"disabled$",host:"host",alwaysExpanded:"alwaysExpanded",allowSelectVisualTypeWhenNoVisual:"allowSelectVisualTypeWhenNoVisual",isVisualExcluded:"isVisualExcluded"},outputs:{onVisualTypeUpdated:"onVisualTypeUpdated"},features:[t.\u0275\u0275ProvidersFeature([Q.V,{provide:Q.B,useValue:U.Ys}]),t.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["class","visualPickerContainer",4,"ngIf"],[1,"visualPickerContainer"],["id","visualPickerTitle",4,"ngIf"],[1,"visualPicker",3,"ngClass"],["visualPicker",""],["class","suggestionsContainer",3,"ngClass",4,"ngIf"],["class","allVisualSelector white-background",3,"visualContainer","visualPluginFilter","showNonPersonalVisualizationPane$","nonPersonalVisualPluginFilter","visualConversionSource",4,"ngIf"],["class","autoVisualContainer",3,"ngClass",4,"ngIf"],["id","visualPickerTitle"],[1,"suggestionsContainer",3,"ngClass"],["id","suggestedVisualTypesContainer","aria-labelledby","visualPickerTitle","role","grid","aria-rowcount","1",1,"suggestions"],["role","row",1,"suggestionsRow"],["class","visualSymbol","role","gridcell",3,"tabindex","ngClass","disabled","ngStyle","pbiTooltip","click","keydown",4,"ngFor","ngForOf"],["class","glyphicon glyph-mini toggleAllVisualsButton",3,"ngClass","pbiTooltip","disabled","click",4,"ngIf"],["role","gridcell",1,"visualSymbol",3,"tabindex","ngClass","disabled","ngStyle","pbiTooltip","click","keydown"],["suggestedVisualTypeElement",""],[3,"sheet","symbolId"],[1,"glyphicon","glyph-mini","toggleAllVisualsButton",3,"ngClass","pbiTooltip","disabled","click"],["allVisualToggleButton",""],[1,"allVisualSelector","white-background",3,"visualContainer","visualPluginFilter","showNonPersonalVisualizationPane$","nonPersonalVisualPluginFilter","visualConversionSource"],[1,"autoVisualContainer",3,"ngClass"],[3,"toggle","isDisabled","pbiTooltip","toggleLabel","onToggleChange"]],template:function(i,o){1&i&&(t.\u0275\u0275template(0,yi,8,10,"div",0),t.\u0275\u0275pipe(1,"async")),2&i&&t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(1,1,o.visualViewModel$))},dependencies:[P.NgClass,P.NgForOf,P.NgIf,P.NgStyle,hi.k,nt.I,ot.V,x,P.AsyncPipe,je.F],styles:['.visualPickerContainer[_ngcontent-%COMP%]{--visual-symbol-selected-background-color: var(--gray-40);--visual-symbol-selected-border-color: var(--gray-130)}  [data-legacy-theming=false] .visualPickerContainer{--visual-symbol-selected-background-color: var(--colorNeutralBackground1);--visual-symbol-selected-border-color: var(--colorNeutralStroke1)}.visualPickerContainer[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;display:block;margin-bottom:4px}.visualPickerContainer[_ngcontent-%COMP%]   .disabledVisualPicker[_ngcontent-%COMP%]{pointer-events:none;opacity:.4}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--fluent-theme-white-color, #FFF);padding:3px;border:1px solid var(--gray-110);border-radius:2px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsRow[_ngcontent-%COMP%]{display:flex;align-items:center}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer.withAllVisualsSelector[_ngcontent-%COMP%]{margin-bottom:3px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]{display:flex;flex:1}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]{height:24px;width:24px;padding:0;box-sizing:border-box;border:none;background-color:transparent;display:flex;align-items:center;justify-content:center}html:not([dir="rtl"])[_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]{margin-right:2px}html[dir="rtl"][_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]{margin-left:2px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol[_ngcontent-%COMP%]   svg-use-symbol[_ngcontent-%COMP%]{height:20px;width:20px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol.selected[_ngcontent-%COMP%]{background-color:var(--visual-symbol-selected-background-color);border:1px solid var(--visual-symbol-selected-border-color)}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .visualSymbol.notSelected[disabled][_ngcontent-%COMP%]{opacity:.4}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%]{border:none;background-color:transparent;border-left:1px solid var(--gray-110);width:24px;box-sizing:border-box}html:not([dir="rtl"])[_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%]{padding:0 2px 0 6px}html[dir="rtl"][_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .toggleAllVisualsButton[_ngcontent-%COMP%]{padding:0 6px 0 2px}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker.withSuggestions[_ngcontent-%COMP%]   all-visual-selector[_ngcontent-%COMP%]{padding-top:3px;border-top:1px solid var(--gray-110)}.visualPickerContainer[_ngcontent-%COMP%]   .visualPicker[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--gray-90)}.visualPickerContainer[_ngcontent-%COMP%]   .autoVisualContainer[_ngcontent-%COMP%]{margin-bottom:2px;margin-top:2px}']}),n}(F.w),Jt=s(64824),St=s(80649),Ci=s(73425),We=s(42587),at=s(76312),De=s(73795),ve=s(98665),lt=s(17653),be=s(74082),st=s(28199),Ue=s(13702),xt=s(5862),fe=s(72262),$e=s(50702),_t=s(48145),Ge=s(82214),bi=s(77919),Mt=s(1240);function Pi(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",10)(1,"div",11),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"toggle-switch-modern-lazy",12),t.\u0275\u0275listener("onToggleChange",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.crossReportDrillthroughAdapter.fn(a))}),t.\u0275\u0275elementEnd()()}if(2&r){var i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(i.viewModel.crossReportDrillthroughToggle.displayName),t.\u0275\u0275advance(1),t.\u0275\u0275property("ariaLabelledby","cross-report-toggle-id")("toggle",i.viewModel.crossReportDrillthroughToggle.value)("isDisabled",i.viewModel.crossReportDrillthroughToggle.isDisabled)}}function Ot(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",10)(1,"div",13),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"toggle-switch-modern-lazy",12),t.\u0275\u0275listener("onToggleChange",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.filterPassingModeAdapter.fn(a))}),t.\u0275\u0275elementEnd()()}if(2&r){var i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(i.viewModel.filterPassingModeToggle.displayName),t.\u0275\u0275advance(1),t.\u0275\u0275property("ariaLabelledby","keep-all-toggle-id")("toggle",i.viewModel.filterPassingModeToggle.value)("isDisabled",i.viewModel.filterPassingModeToggle.isDisabled)}}function Si(r,n){1&r&&t.\u0275\u0275element(0,"filter",14),2&r&&t.\u0275\u0275property("viewModel",n.$implicit)}function wt(r,n){1&r&&t.\u0275\u0275element(0,"filter",14),2&r&&t.\u0275\u0275property("viewModel",n.$implicit)}var xi=function(){function r(){}return r.prototype.transform=function(n){return n&&_.filter(n,function(e){return e&&e.contract&&!!e.contract.isTransient})},r.\u0275fac=function(e){return new(e||r)},r.\u0275pipe=t.\u0275\u0275definePipe({name:"isTransientFilter",type:r,pure:!1}),r}(),Ft=function(){function r(){}return r.prototype.transform=function(n){return n&&_.filter(n,function(e){return e&&e.contract&&!e.contract.isTransient})},r.\u0275fac=function(e){return new(e||r)},r.\u0275pipe=t.\u0275\u0275definePipe({name:"isNonTransientFilter",type:r,pure:!1}),r}(),Et=function(r){function n(e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k,O){var E=r.call(this)||this;return E.aggrOps=e,E.conceptualSchemaProxy=i,E.dataSources=o,E.displayNameService=a,E.dragDataService=l,E.elementRef=c,E.eventBridge=u,E.explorationCapabilities=d,E.explorationNavigation=g,E.featureSwitchService=v,E.lazyScoped=f,E.localizationService=m,E.scriptVisuals=y,E.selection=M,E.telemetryService=b,E.visualAuthoring=k,E.visualPlugin=O,E.useModernFormatPane=E.featureSwitchService.featureSwitches.useModernFormatPane,E.dropActionHandler=function(T){return E.getDropAction(T)},E}return(0,p.__extends)(n,r),n.prototype.ngOnInit=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o=this;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return e=this.explorationNavigation.getCurrentSection(),i=We.j(e?.type,this.localizationService),this.isDestroyed=!1,this.viewModel={drillthroughFilters:[],filterPassingModeToggle:{name:"keepAllFilters",displayName:i.keepAllFiltersLabel,value:!1,isDisabled:!1,tooltip:i.keepAllFiltersTooltip,type:{bool:!0},show:!0,placeholder:"",isValid:!0},crossReportDrillthroughToggle:{name:"crossReportDrillthrough",displayName:i.crossReportDrillthroughLabel,value:!1,isDisabled:!1,tooltip:i.crossReportDrillthroughTooltip,type:{bool:!0},show:!1,placeholder:"",isValid:!0},resources:i},this.filterPassingModeAdapter=this.createEventAdapter(),this.crossReportDrillthroughAdapter=this.createEventAdapter(),this.filterPassingModeAdapter.$.pipe((0,lt.b)(function(l){return o.viewModel.filterPassingModeToggle.value=l})).subscribe(function(){return o.onFilterPassingModeToggleChanged()}),this.crossReportDrillthroughAdapter.$.pipe((0,lt.b)(function(l){return o.viewModel.crossReportDrillthroughToggle.value=l})).subscribe(function(){return o.onCrossReportDrillthroughToggleChanged()}),this.dropConfig={accept:"field"},this.onDestroy$.subscribe(function(){o.subscriptionManager&&o.subscriptionManager.unsubscribeAll(),o.isDestroyed=!0}),[4,this.createDrillthroughFilters()];case 1:return a.sent(),this.isDestroyed||(this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(B.Tuj,function(l,c){return o.onFilterContainerChanged(c)}).subscribe(B.yVh,function(){return o.onSectionChanged()}).subscribe(B.CCe,function(){return o.onModelChanged()}).subscribe(B.wAN,function(){return o.onCanvasChanged()}).subscribe(B.LE3,function(){return o.onExplorationLoaded()}).subscribe(B.mke,function(l,c){return o.onSectionFiltersContainerChanged(c)}),this.checkAndSetToggle(),(0,at.$o)(this.elementRef.nativeElement,function(l,c){return o.dropDrillthroughFilterFromField(c)})),[2]}})})},n.prototype.getDropAction=function(e){var i=this.dragDataService.getDragContext();return i&&i.field&&this.isSupportedDrillthroughFilterExpr(i.field)?Promise.resolve(3):Promise.resolve(0)},n.prototype.dropDrillthroughFilter=function(){var e=this.dragDataService.getDragContext();!e||!e.field||this.dropDrillthroughFilterFromField(e.field)},n.prototype.dropDrillthroughFilterFromField=function(e){var i=this.explorationNavigation.getCurrentSection();A.fF.assertValue(i,"No section"),(0,De.uE)(1,i,!0,this.dataSources,e,this.visualAuthoring,!0),this.checkAndSetToggle()},n.prototype.getFilterPaneUtilServices=function(){return{aggrOps:this.aggrOps,conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,displayNameService:this.displayNameService,eventBridge:this.eventBridge,explorationCapabilities:this.explorationCapabilities,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,scriptVisuals:this.scriptVisuals,selection:this.selection,telemetryService:this.telemetryService,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin}},n.prototype.getKeepAllFiltersTooltipConfig=function(){var e=this.viewModel.filterPassingModeToggle;return{tooltipTitle:e.displayName,tooltipDescription:e.tooltip}},n.prototype.getCrossReportDrillthroughTooltipConfig=function(){var e=this.viewModel.crossReportDrillthroughToggle;return{tooltipTitle:e.displayName,tooltipDescription:e.tooltip}},n.prototype.getPaneTitleTooltipConfig=function(){var e=this.viewModel.resources;return{tooltipTitle:e.paneTitle,tooltipDescription:e.paneTitleTooltip}},n.prototype.onFilterPassingModeToggleChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return e=this.explorationNavigation.getCurrentSection(),i=this.explorationNavigation.getCurrentExploration(),[4,this.lazyScoped.get("explorationAuthoring")];case 1:return l.sent().setDrillthroughFilterPassingMode(i,e,this.viewModel.filterPassingModeToggle.value),[2]}})})},n.prototype.onCrossReportDrillthroughToggleChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return e=this.explorationNavigation.getCurrentSection(),i=this.explorationNavigation.getCurrentExploration(),[4,this.lazyScoped.get("explorationAuthoring")];case 1:return l.sent().setCrossReportDrillthrough(i,e,this.viewModel.crossReportDrillthroughToggle.value),[2]}})})},n.prototype.onSectionChanged=function(){var e=this.explorationNavigation.getCurrentSection();A.fF.assertValue(e,"section undefined in onSectionChanged"),this.viewModel.resources=We.j(e.type,this.localizationService),this.checkAndSetToggle()},n.prototype.onModelChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.createDrillthroughFilters()];case 1:return e.sent(),this.checkAndSetToggle(),[2]}})})},n.prototype.onCanvasChanged=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.createDrillthroughFilters()];case 1:return e.sent(),this.checkAndSetToggle(),[2]}})})},n.prototype.onExplorationLoaded=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.createDrillthroughFilters()];case 1:return e.sent(),this.checkAndSetToggle(),[2]}})})},n.prototype.onFilterContainerChanged=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,o,a,l;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return i=this.viewModel.drillthroughFilters,o=this.getFilterPaneUtilServices(),(0,De.Rh)(o,1,i,e),e.filter&&5===e.filter.howCreated?(a=this.explorationNavigation.getCurrentExploration(),[4,(0,De.PJ)(this.dataSources,this.conceptualSchemaProxy)]):[3,2];case 1:l=c.sent(),(0,De.Z)(e,i,a,o,l),c.label=2;case 2:return this.checkAndSetToggle(),[2]}})})},n.prototype.isSupportedDrillthroughFilterExpr=function(e){return(0,be.kb)(e)||(0,be.t3)(e)||(0,be.ez)(e)||(0,be.wD)(e)},n.prototype.onSectionFiltersContainerChanged=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){switch(i.label){case 0:return e.container!==this.explorationNavigation.getCurrentSection()?[3,2]:[4,this.createDrillthroughFilters()];case 1:i.sent(),this.checkAndSetToggle(),i.label=2;case 2:return[2]}})})},n.prototype.createDrillthroughFilters=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return e=this.getFilterPaneUtilServices(),i=this.viewModel,[4,(0,De.JN)(e,5)];case 1:return i.drillthroughFilters=o.sent(),[2]}})})},n.prototype.checkAndSetToggle=function(){var e,i=this.explorationNavigation.getCurrentSection(),o=this.explorationNavigation.getCurrentExploration(),l=We.F(o,i,this.viewModel.resources,!0),c=(e=this.viewModel).filterPassingModeToggle,u=e.crossReportDrillthroughToggle;c.isDisabled=l.keepAllFilters.disabled,c.value=l.keepAllFilters.value,c.tooltip=l.keepAllFilters.tooltip,u.show=l.crossReportDrillthrough.show,u.isDisabled=l.crossReportDrillthrough.disabled,u.value=l.crossReportDrillthrough.value},n.prototype.trackByFn=function(e,i){return i?.id},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(st.C),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(Ue.O),t.\u0275\u0275directiveInject($e.x),t.\u0275\u0275directiveInject(t.ElementRef),t.\u0275\u0275directiveInject(oe.J),t.\u0275\u0275directiveInject(_t.U),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(le.o),t.\u0275\u0275directiveInject(xt.k),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(he.D))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["drillthrough-pane"]],features:[t.\u0275\u0275InheritDefinitionFeature],decls:18,vars:19,consts:[[1,"sectionHeader","drillthroughSectionHeader"],[1,"sectionTitle","sidePaneTitle","unselectable","largeFontSize",3,"pbi-tooltip"],[1,"drillthroughPane","filterPane","filterPaneClassic","propertyPaneContents"],[3,"pbi-tooltip"],["class","toggle-container",4,"ngIf"],[1,"cards",3,"drop","dropAction","dropHandler"],[1,"linkFieldFilters"],["dataAutomationType","filterCard",3,"viewModel",4,"ngFor","ngForOf","ngForTrackBy"],[1,"transientFilters"],[1,"unselectable","trimmedTextWithEllipsis",3,"ngClass"],[1,"toggle-container"],["id","cross-report-toggle-id",1,"toggle-text"],[3,"ariaLabelledby","toggle","isDisabled","onToggleChange"],["id","keep-all-toggle-id",1,"toggle-text"],["dataAutomationType","filterCard",3,"viewModel"]],template:function(i,o){1&i&&(t.\u0275\u0275elementStart(0,"h3",0)(1,"span",1),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(3,"section",2)(4,"div")(5,"div",3),t.\u0275\u0275template(6,Pi,4,4,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",3),t.\u0275\u0275template(8,Ot,4,4,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"div",5),t.\u0275\u0275listener("dropHandler",function(){return o.dropDrillthroughFilter()}),t.\u0275\u0275elementStart(10,"ul",6),t.\u0275\u0275template(11,Si,1,1,"filter",7),t.\u0275\u0275pipe(12,"isNonTransientFilter"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(13,"ul",8),t.\u0275\u0275template(14,wt,1,1,"filter",7),t.\u0275\u0275pipe(15,"isTransientFilter"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(16,"div",9),t.\u0275\u0275text(17),t.\u0275\u0275elementEnd()()()()),2&i&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("pbi-tooltip",o.getPaneTitleTooltipConfig()),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",o.viewModel.resources.paneTitle," "),t.\u0275\u0275advance(3),t.\u0275\u0275property("pbi-tooltip",o.getCrossReportDrillthroughTooltipConfig()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",o.viewModel.crossReportDrillthroughToggle.show&&o.useModernFormatPane),t.\u0275\u0275advance(1),t.\u0275\u0275property("pbi-tooltip",o.getKeepAllFiltersTooltipConfig()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",o.useModernFormatPane),t.\u0275\u0275advance(1),t.\u0275\u0275property("drop",o.dropConfig)("dropAction",o.dropActionHandler),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(12,15,o.viewModel.drillthroughFilters))("ngForTrackBy",o.trackByFn),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(15,17,o.viewModel.drillthroughFilters))("ngForTrackBy",o.trackByFn),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngClass",0===o.viewModel.drillthroughFilters.length?"dropzone":"end-dropzone"),t.\u0275\u0275attribute("tabindex",0===o.viewModel.drillthroughFilters.length?0:-1),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",0===o.viewModel.drillthroughFilters.length?o.viewModel.resources.dropZoneText:""," "))},dependencies:[P.NgClass,P.NgForOf,P.NgIf,Ge.W,bi.z,nt.I,Mt.i,Ft,xi],styles:['.drillthroughPane[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:0 6px 4px 4px}.drillthroughPane[_ngcontent-%COMP%]   ul.transientFilters[_ngcontent-%COMP%]{font-style:italic}.modern[_nghost-%COMP%]   .drillthroughSectionHeader[_ngcontent-%COMP%]{padding:6px 4px 4px;font-size:unset;margin-left:8px}.modern[_nghost-%COMP%]   .drillthroughSectionHeader[_ngcontent-%COMP%]   .sectionTitle[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600);margin:0;line-height:16px}.modern[_nghost-%COMP%]   .toggle-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:5px 0;margin-left:8px}.modern[_nghost-%COMP%]   .filterPane[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{margin-top:5px}.filterPane[_ngcontent-%COMP%]{--field-well-title-color: var(--gray-180, #252423);--field-well-bucket-border-color: var(--gray-60, #C8C6C4);float:left;width:100%;box-sizing:border-box;padding:0 6px 4px 4px;overflow:visible}  [data-legacy-theming=false] .filterPane{--field-well-title-color: var(--colorNeutralForeground1);--field-well-bucket-border-color: var(--colorNeutralStroke1)}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]:focus{outline:none}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;margin:6px 5px 6px 0;box-sizing:border-box;font-weight:inherit}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{margin-left:12px;font-size:var(--sm-font-size, 12px)}.filterPane[_ngcontent-%COMP%]   .bucket[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]:focus{outline:none}.filterPane[_ngcontent-%COMP%]   .cards[_ngcontent-%COMP%]{float:left;width:100%;box-sizing:border-box;background-color:var(--fluent-theme-white-color, #FFF);border:1px dashed var(--field-well-bucket-border-color);border-radius:2px}.filterPane[_ngcontent-%COMP%]   .cards.append[_ngcontent-%COMP%]{border-color:var(--gray-130, #605E5C)}.filterPane[_ngcontent-%COMP%]   .dropzone[_ngcontent-%COMP%]{color:var(--field-well-title-color);padding:4px 8px}html[data-focus-source=key][_ngcontent-%COMP%]   .filterPane[_ngcontent-%COMP%]   .dropzone[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.filterPane[_ngcontent-%COMP%]   .end-dropzone[_ngcontent-%COMP%]{height:8px}']}),n}(F.w),Te=s(84431),ke=s(15580),me=s(21728),Yt=s(66794),ct=s(41606),_i=s(55201),ut=s(65302),Vt=s(5265),Dt=s(34763),Tt=s(37272),Le=s(81905),It=s(8082),Me=s(15393),At=s(23983),He=s(85677),Ke=s(88409),Ie=s(40702),we=s(14463);function Mi(r,n,e){return r?e.get(r):n.reject()}var Oi=s(12587),Fe=s(59017),X=s(14172),wi=s(57243),Qe=s(28149),Fi=s(77200),Ei=s(74913),Vi=s(79930),Bt=s(89839),On=s(37335),wn=s(47755),Di=s(54766),Xe=s(54834),kt=s(42342),Fn=s(50550),En=s(79602),Ti=s(19008),qt=s(80366),Ii=s(76001),Lt=s(94419),ze=s(45551),xe=s(45413),Ai=s(58295),Bi=s(58609),ei=s(54165),ti=s(67660),ii=s(62812),Vn=s(5467),zt=s(83309),Dn=s(53267),Ee=s(17174),ki=s(44581),Tn=s(24150),Li=s(45916);function In(r,n){if(1&r&&t.\u0275\u0275element(0,"div",13)(1,"div",14),2&r){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("textContent",e.viewModel.displayOptions.tooltipTitle),t.\u0275\u0275advance(1),t.\u0275\u0275property("textContent",e.viewModel.displayOptions.tooltipDescription)}}function An(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"i",15),t.\u0275\u0275listener("accessible-click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.editLabel())}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275element(2,"pbi-svg-use-symbol",16),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,3,i.editableLabelAriaLabel$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("sheet","fieldListPaneIcons")("symbolId","fieldListError")}}function Bn(r,n){1&r&&t.\u0275\u0275element(0,"tri-svg-icon",17)}function kn(r,n){if(1&r&&t.\u0275\u0275element(0,"i",18),2&r){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngClass",e.viewModel.displayOptions.glyph)}}function Ln(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"input",19),t.\u0275\u0275listener("ngModelChange",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(l.editableLabelName=a)}),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngModel",i.editableLabelName),t.\u0275\u0275attribute("maxlength",i.maxInputlength)}}function zn(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",20),t.\u0275\u0275listener("click",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(l.toggleHiddenProjection(a))}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275element(2,"tri-svg-icon",21),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,3,i.tooltipForHide$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("name",t.\u0275\u0275pipeBind1(3,5,i.iconNameForHide$))("pbiTooltip",t.\u0275\u0275pipeBind1(4,7,i.tooltipForHide$))}}function Nn(r,n){1&r&&t.\u0275\u0275element(0,"pbi-svg-use-symbol",24)}var Rn=function(n){return{"glyphicon glyph-mini pbi-glyph-chevrondownsmall":n}};function jn(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",22),t.\u0275\u0275listener("click",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(l.showMenu(a))}),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275template(2,Nn,1,0,"pbi-svg-use-symbol",23),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(5,Rn,i.newPaneColorsEnabled)),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,3,i.editableLabelAriaLabel$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!i.newPaneColorsEnabled)}}function Wn(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",25),t.\u0275\u0275listener("click",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(l.deleteFieldAndFocus(a))}),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",i.removeAriaLabel)}}function Un(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"li",28),t.\u0275\u0275element(1,"span",29),t.\u0275\u0275elementStart(2,"button",25),t.\u0275\u0275listener("click",function(l){var u=t.\u0275\u0275restoreView(e).index,d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.deleteFieldAndFocus(l,u))}),t.\u0275\u0275elementEnd()()}if(2&r){var i=n.$implicit,o=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(1),t.\u0275\u0275property("textContent",i.displayName),t.\u0275\u0275attribute("aria-label",i.displayName),t.\u0275\u0275advance(1),t.\u0275\u0275attribute("aria-label",o.removeAriaLabel)}}function $n(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"ol",26),t.\u0275\u0275template(1,Un,3,3,"li",27),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",e.viewModel.hierarchyLevels)}}var Gn=function(n,e){return{"can-prepend":n,"not-draggable":e}};function Hn(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"li",1),t.\u0275\u0275listener("dropHandler",function(l){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.drop(l.event,l.ui,l.dropAction))}),t.\u0275\u0275template(1,In,2,2,"ng-template",null,2,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementStart(3,"h2",3),t.\u0275\u0275listener("contextmenu",function(l){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.showMenu(l))}),t.\u0275\u0275template(4,An,3,5,"i",4),t.\u0275\u0275template(5,Bn,1,0,"tri-svg-icon",5),t.\u0275\u0275pipe(6,"async"),t.\u0275\u0275template(7,kn,1,1,"i",6),t.\u0275\u0275elementStart(8,"div",7),t.\u0275\u0275listener("dblclick",function(){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.editLabel())})("keydown.enter",function(){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.editLabel())})("keydown.space",function(){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.editLabel())})("click",function(){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.editVisualCalc())}),t.\u0275\u0275pipe(9,"async"),t.\u0275\u0275template(10,Ln,1,2,"input",8),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(11,zn,5,9,"button",9),t.\u0275\u0275pipe(12,"async"),t.\u0275\u0275template(13,jn,3,7,"button",10),t.\u0275\u0275template(14,Wn,1,1,"button",11),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(15,$n,2,1,"ol",12),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275reference(2),o=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction2(30,Gn,!o.viewModel.interactivityOptions.isReplaceable,!o.viewModel.interactivityOptions.isDraggableField))("drag","field")("dragDisabled",!o.viewModel.interactivityOptions.isDraggableField)("getDragContext",o.getDragContext)("drop",o.dropConfig)("dropAction",o.dropActionHandler)("dropContainerId",o.fieldDropUniqueId)("pbiTooltip",i)("pbiTooltipDisabled",o.isTooltipDisabled)("pbiTooltipHideDelay",100)("pbiTooltipMaxHeight","92vh")("pbiTooltipPosition","before"),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",!o.viewModel.valid),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(6,24,o.hasVisualCalcExpression$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",o.viewModel.displayOptions.glyph),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngStyle",t.\u0275\u0275pipeBind1(9,26,o.displayNameStyle$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("pbiEditableLabel",o.pbiEditableLabelOptions)("pbiEditableLabelValue",o.currentDisplayName)("pbiEditableLabelMode",o.viewModel.isEditingLabel)("pbiEditableLabelEditable",o.viewModel.isEditingLabel),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(12,28,o.showHideButton$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",o.viewModel.interactivityOptions.hasContextMenu),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",o.viewModel.interactivityOptions.isRemovableField),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",o.viewModel.hierarchyLevels)}}var zi=function(r){function n(e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k,O,E,T,K,ie,ee,se,ue,re,Ce){var N=r.call(this)||this;return N.changeDetection=e,N.conceptualSchemaProxy=i,N.contextActivityService=o,N.dataSources=a,N.dragDataService=l,N.element=c,N.eventBridge=u,N.explorationCapabilities=d,N.explorationNavigation=g,N.featureSwitchService=v,N.groupAuthoring=f,N.lazyScoped=m,N.localizationService=y,N.modelChangeHandler=M,N.pbiMenuService=b,N.promiseFactory=k,N.screenReaderService=O,N.selection=E,N.showValueAsService=T,N.sparklinesService=K,N.telemetryService=ie,N.themeService=ee,N.visibilityService=se,N.visualAuthoring=ue,N.visualCalcEagerService=re,N.visualPlugin=Ce,N.maxInputlength=100,N.getDragContext=function(){return{sourceIndex:N.viewModel.startIndex,sourceRole:N.viewModel.role,hierarchyLevelCount:N.viewModel.hierarchyLevels.length}},N.fieldDropUniqueId=_.uniqueId("fieldDropUniqueId"),N.element.nativeElement.id=N.fieldDropUniqueId,N.pbiEditableLabelOptions={disableClick:!0,customTooltip:!0,inputMatchLabelWidth:!1,onEdit:function(){return N.editLabel()},onBlur:function(){return N.rename()}},N.showFieldTooltip=N.localizationService.get("Visual_Calculation_Field_Well_Show_In_Visual"),N.hideFieldTooltip=N.localizationService.get("Visual_Calculation_Field_Well_Hide_From_Visual"),N.tooltipConfigManager={getTooltipConfig:function(){return{tooltipTitle:N.viewModel.displayOptions.tooltipTitle,tooltipDescription:N.viewModel.displayOptions.tooltipDescription}}},N.dropConfig={accept:"field",greedy:!1},N.removeAriaLabel=N.localizationService.get("FieldWell_Remove"),N.newPaneColorsEnabled=N.explorationCapabilities.getCapabilities().showFluentDesign||N.featureSwitchService.featureSwitches&&N.featureSwitchService.featureSwitches.paneColorRefresh,N}return(0,p.__extends)(n,r),Object.defineProperty(n.prototype,"currentDisplayName",{get:function(){return this.viewModel.displayOptions.displayName},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var e=this;this.core=new Ni({conceptualSchemaProxy:this.conceptualSchemaProxy,contextActivityService:this.contextActivityService,dataSources:this.dataSources,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,groupAuthoring:this.groupAuthoring,lazyScoped:this.lazyScoped,localizationService:this.localizationService,modelChangeHandler:this.modelChangeHandler,promiseFactory:this.promiseFactory,screenReaderService:this.screenReaderService,selection:this.selection,showValueAsService:this.showValueAsService,sparklinesService:this.sparklinesService,telemetryService:this.telemetryService,themeService:this.themeService,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin,visibilityService:this.visibilityService,visualCalcEagerService:this.visualCalcEagerService},function(){ut.IK.focus($(e.element.nativeElement).find(".fieldWellIcon.dropDown")[0])}),this.core.viewModel=this.viewModel,this.core.bucketDisplayName=this.bucketDisplayName;var o=this.element.nativeElement;o&&(0,at.$o)(o,function(l,c,u){return e.core.dropField(c,e.getFieldDropAction(u))},function(l){return e.getFieldDropAction(l)}),this.dropActionHandler=function(l){return Promise.resolve(e.getDropAction(l))},this.editableLabelName=this.currentDisplayName;var a=this.changes$("viewModel").pipe((0,wi.d)());this.hasVisualCalcExpression$=a.pipe((0,X.U)(function(l){var c=l.expr;return l.valid&&!!c&&(0,be.jX)(c)}),(0,I.R)(this.onDestroy$)),this.iconNameForHide$=a.pipe((0,X.U)(function(l){return l?.isHiddenInVisual?"eye_off_16_regular":"eye_16_regular"}),(0,I.R)(this.onDestroy$)),this.tooltipForHide$=a.pipe((0,X.U)(function(l){return l?.isHiddenInVisual?e.showFieldTooltip:e.hideFieldTooltip}),(0,I.R)(this.onDestroy$)),this.showHideButton$=(0,Fe.aj)([a,this.visibilityService.get$(16)]).pipe((0,X.U)(function(l){var c=l[0],u=l[1],d=c?.expr;return null!=d&&((0,Ai.k)(d)||(0,be.jX)(d))&&16===u?.visibility}),(0,I.R)(this.onDestroy$)),this.editableLabelAriaLabel$=a.pipe((0,X.U)(function(l){return e.getEditableLabelAriaLabel(l)})),this.displayNameStyle$=(0,Fe.aj)([a,this.visibilityService.get$(16)]).pipe((0,X.U)(function(l){var c=l[0],u=l[1];if(16===u?.visibility)return c.displayOptions.pbiStyle}),(0,I.R)(this.onDestroy$)),this.changeDetection.detectChanges()},Object.defineProperty(n.prototype,"isTooltipDisabled",{get:function(){var i=this.viewModel.displayOptions;return _.isEmpty(i.tooltipDescription)&&_.isEmpty(i.tooltipTitle)},enumerable:!1,configurable:!0}),n.prototype.onDestroy=function(){this.core.onDestroy()},n.prototype.getDropAction=function(e){var i=this.dragDataService.getDragContext(),o=this.viewModel.interactivityOptions,a=o.canAppend?3:2;if(i&&o.isDroppableField&&(o.canAppend||o.canPrepend)){var l=i.sourceRole;if(l){var c=i.hierarchyLevelCount||1,u=i.sourceIndex,d=!o.canPrepend||(0,kt.wc)(e);if(this.core.getTargetIndex(l,u,c,{role:this.viewModel.role,startIndex:this.viewModel.startIndex,hierarchyLevelsLength:this.viewModel.hierarchyLevels?this.viewModel.hierarchyLevels.length:0},d)<0)return 0}o.isReplaceable&&o.isReplaceOnly?a=1:(0,kt.W6)(e)&&o.canPrepend&&(a=2)}else a=0;return a},n.prototype.drop=function(e,i,o){var a=this.dragDataService.getDragContext();this.core.dropWithPayloadAndAction(a,o)},n.prototype.deleteField=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,this.core.deleteField(e)]})})},n.prototype.deleteFieldAndFocus=function(e,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(o){return[2,this.core.deleteFieldAndFocus(e,i)]})})},n.prototype.selectFieldMenuItem=function(e){this.core.selectFieldMenuItem(e)},n.prototype.showMenu=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a=this;return(0,p.__generator)(this,function(l){return e.preventDefault(),i={anchorElement:$(e.currentTarget)},this.pbiMenuService.open(On.p.getPbiMenuConfig(this.viewModel.interactivityOptions.dropDownItems,e.currentTarget,!1,!1,i)).onButtonClick$.pipe((0,S.q)(1)).subscribe(function(c){a.selectFieldMenuItem(c.id)}),e.keyCode===$.ui.keyCode.SPACE&&e.stopPropagation(),[2]})})},n.prototype.editLabel=function(){this.core.editLabel()},n.prototype.cancelRename=function(){this.core.cancelRename(),this.changeDetection.detectChanges()},n.prototype.rename=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.core.rename(this.editableLabelName)];case 1:return e.sent(),this.cancelRename(),[2]}})})},n.prototype.toggleHiddenProjection=function(e){return e.preventDefault(),this.toggleFieldHidden()},n.prototype.editVisualCalc=function(){var e;if(16===(null===(e=this.visibilityService.get(16))||void 0===e?void 0:e.visibility)){var o=this.viewModel.expr;null!==o&&(0,be.jX)(o)&&this.core.editVisualCalculation()}},n.prototype.toggleFieldHidden=function(){var e=this.viewModel.role,i=this.viewModel.startIndex,o=this.core.getSelectedVisual(),a=this.dataSources.get();return this.visualAuthoring.toggleFieldHidden(e,i,o,a)},n.prototype.getFieldDropAction=function(e){var i=this.viewModel.interactivityOptions;return i.isDroppableField&&(i.canAppend||i.canPrepend)?i.isReplaceable&&i.isReplaceOnly?1:(0,kt.W6)(e)&&i.canPrepend?2:(0,kt.wc)(e)&&i.canAppend?3:0:0},n.prototype.getEditableLabelAriaLabel=function(e){var i=e.displayOptions.displayName;return _.isString(e.displayOptions.tooltipTitle)&&(i=_.isString(i)?i.concat(". ",e.displayOptions.tooltipTitle):e.displayOptions.tooltipTitle),_.isString(e.displayOptions.tooltipDescription)&&(i=_.isString(i)?i.concat(". ",e.displayOptions.tooltipDescription):e.displayOptions.tooltipDescription),i},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(t.ChangeDetectorRef),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(de.r),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject($e.x),t.\u0275\u0275directiveInject(t.ElementRef),t.\u0275\u0275directiveInject(oe.J),t.\u0275\u0275directiveInject(_t.U),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Qe.RD),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(le.o),t.\u0275\u0275directiveInject(ei.x),t.\u0275\u0275directiveInject(Vn.o),t.\u0275\u0275directiveInject(we.t),t.\u0275\u0275directiveInject(zt.g),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(He.P),t.\u0275\u0275directiveInject(ii.s),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(ti.f),t.\u0275\u0275directiveInject(Me.w),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(Ke.w),t.\u0275\u0275directiveInject(he.D))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["field-well-field-modern"]],inputs:{bucketDisplayName:"bucketDisplayName",viewModel:"viewModel"},features:[t.\u0275\u0275ProvidersFeature([Vi.Wg]),t.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["role","listitem","class","fieldWellProperty","data-testid","field-well-property",3,"ngClass","drag","dragDisabled","getDragContext","drop","dropAction","dropContainerId","pbiTooltip","pbiTooltipDisabled","pbiTooltipHideDelay","pbiTooltipMaxHeight","pbiTooltipPosition","dropHandler",4,"ngIf"],["role","listitem","data-testid","field-well-property",1,"fieldWellProperty",3,"ngClass","drag","dragDisabled","getDragContext","drop","dropAction","dropContainerId","pbiTooltip","pbiTooltipDisabled","pbiTooltipHideDelay","pbiTooltipMaxHeight","pbiTooltipPosition","dropHandler"],["tooltipTemplateRef",""],[1,"flex","smallFontSize",3,"contextmenu"],["tabindex","0","role","button","class","errorIcon error item-auto",3,"accessible-click",4,"ngIf"],["class","fieldIcon","sprite","visual-calc-icons","name","data_histogram_function_20_regular",4,"ngIf"],["class","field-glyph glyphicon glyph-mini",3,"ngClass",4,"ngIf"],["tabindex","0",1,"item-fill","propertyText","propertyContent","caption","trimmedTextWithEllipsis","fieldWellFieldEditableLabel",3,"ngStyle","dblclick","keydown.enter","keydown.space","click"],[3,"ngModel","ngModelChange",4,"pbiEditableLabel","pbiEditableLabelValue","pbiEditableLabelMode","pbiEditableLabelEditable"],["role","button","class","actionButton",3,"click",4,"ngIf"],["role","button","aria-expanded","false","class","fieldWellIcon dropDown item-auto",3,"ngClass","click",4,"ngIf"],["class","delete glyphicon pbi-glyph-close glyph-micro",3,"click",4,"ngIf"],["class","hierarchyList",4,"ngIf"],[1,"tooltipTitle",3,"textContent"],[1,"fieldTooltipDescription",3,"textContent"],["tabindex","0","role","button",1,"errorIcon","error","item-auto",3,"accessible-click"],[3,"sheet","symbolId"],["sprite","visual-calc-icons","name","data_histogram_function_20_regular",1,"fieldIcon"],[1,"field-glyph","glyphicon","glyph-mini",3,"ngClass"],[3,"ngModel","ngModelChange"],["role","button",1,"actionButton",3,"click"],["tri-svg-icon-16","","sprite","fluentui-icons",1,"eyeIcon",3,"name","pbiTooltip"],["role","button","aria-expanded","false",1,"fieldWellIcon","dropDown","item-auto",3,"ngClass","click"],["sheet","fieldListPaneIcons","symbol-id","fieldListDropdown",4,"ngIf"],["sheet","fieldListPaneIcons","symbol-id","fieldListDropdown"],[1,"delete","glyphicon","pbi-glyph-close","glyph-micro",3,"click"],[1,"hierarchyList"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],["tabindex","0",1,"subcaption","trimmedTextWithEllipsis","item-fill",3,"textContent"]],template:function(i,o){1&i&&t.\u0275\u0275template(0,Hn,16,33,"li",0),2&i&&t.\u0275\u0275property("ngIf",o.core)},dependencies:[P.NgClass,P.NgForOf,P.NgIf,P.NgStyle,Dn.w,Ge.W,Ee.Fj,Ee.JJ,Ee.On,ki.t,Tn.D,Li.R,ot.V,Ei.M,P.AsyncPipe],styles:[".fieldWellFieldEditableLabel[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;border:none}.tooltipTitle[_ngcontent-%COMP%]{font-weight:700}.fieldTooltipDescription[_ngcontent-%COMP%]{max-width:240px;display:block;position:relative;word-break:break-word;white-space:pre-wrap}.fieldIcon[_ngcontent-%COMP%]{margin-right:4px}.actionButton[_ngcontent-%COMP%]{background:transparent;margin-right:4px;margin-top:-4px}.eyeIcon[_ngcontent-%COMP%]{--eye-icon-fill: var(--gray-140);fill:var(--eye-icon-fill)}  [data-legacy-theming=false] .eyeIcon{--eye-icon-fill: var(--colorNeutralForeground1)}"]}),n}(Oi.w),Ni=function(){function r(n,e,i){this.services=n,this.onContextMenuActionFailed=e,this.onLabelInEditingModeChanged=i}return r.prototype.onDestroy=function(){this.dataBarsDialogRef&&this.dataBarsDialogRef.close()},r.prototype.dropWithPayloadAndAction=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,a,l,c,u,d,g,v,f;return(0,p.__generator)(this,function(m){return o=n,a=this.viewModel,l=this.services.dataSources.get(),c=16===(null===(i=this.services.visibilityService.get(16))||void 0===i?void 0:i.visibility),(u=o.sourceRole)?[2,!((v=this.getTargetIndex(u,g=o.sourceIndex,d=o.hierarchyLevelCount||1,{role:this.viewModel.role,startIndex:this.viewModel.startIndex,hierarchyLevelsLength:this.viewModel.hierarchyLevels?this.viewModel.hierarchyLevels.length:0},3===e))<0)&&this.services.visualAuthoring.moveField(u,a.role,g,v,d,l,c)]:(f=n).field?[2,this.dropField(f.field,e)]:[2,!1]})})},r.prototype.dropField=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,a,l,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return o=this.services.dataSources.get(),a=_.size(this.viewModel.hierarchyLevels),l=this.getSelectedVisual(),this.viewModel.interactivityOptions.isReplaceable&&(this.viewModel.interactivityOptions.isReplaceOnly||1===e)?(this.viewModel.isInsideAutoVisualBucket||((0,W.PQ)(l).autoSelectVisualType=void 0),[4,this.checkToRestoreOrMergeLevelToHierarchy(n,o)]):[3,2];case 1:return d.sent()?[2,!0]:[2,this.services.visualAuthoring.replaceField(n,this.viewModel.role,this.viewModel.startIndex,l,o,a>0?a:void 0)];case 2:return u=16===(null===(i=this.services.visibilityService.get(16))||void 0===i?void 0:i.visibility),[2,this.services.visualAuthoring.addFieldInRole(n,this.viewModel.role,o,l,3===e?this.viewModel.startIndex+Math.max(a,1):this.viewModel.startIndex,void 0,void 0,u)]}})})},r.prototype.editLabel=function(){var n=this.viewModel;n.interactivityOptions.isEditableField&&(n.isEditingLabel=!0,this.onLabelInEditingModeChanged&&this.onLabelInEditingModeChanged(!0))},r.prototype.deleteField=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return null!==this.viewModel.expr&&(0,be.jX)(this.viewModel.expr)&&(e=this.getSelectedVisual(),i=(0,W.$Z)(e,this.viewModel.role,this.viewModel.startIndex),this.services.visualCalcEagerService.deleteVisualCalc(i)),[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 1:return o=a.sent(),this.services.visualAuthoring.removeFieldFromRole({role:this.viewModel.role,projOptions:{fieldIndex:this.viewModel.startIndex+(n||0)},count:_.isNumber(n)?1:this.viewModel.hierarchyLevels.length||1},o),this.logDeleteTelemetry(),[2]}})})},r.prototype.deleteFieldAndFocus=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i=this;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return n&&n.stopPropagation(),[4,this.deleteField(e)];case 1:return o.sent(),En.l.setTimeout(function(){i.services.eventBridge.publishToChannel(B.Ah$,i.bucketDisplayName)}),[2]}})})},r.prototype.cancelRename=function(){this.viewModel.isEditingLabel=!1,this.onLabelInEditingModeChanged&&this.onLabelInEditingModeChanged(!1)},r.prototype.rename=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o,a,l;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return n===(e=this.viewModel.displayOptions).displayName||null==(i=this.getSelectedVisual())?[2]:(o=i.config.singleVisual.query,a=i&&i.name,l=i&&i.config.singleVisual.visualType,i&&o&&o.projections&&o.projections[this.viewModel.role]&&this.viewModel.visualContainerName===a?(e.displayName=n,[4,this.services.visualAuthoring.setDisplayNameAlias(i,{fieldIndex:this.viewModel.startIndex},this.viewModel.role,n)]):(this.services.telemetryService.logEvent(Ie.jG,{originalVisualContainerName:this.viewModel.visualContainerName,originalVisualType:this.viewModel.visualType,currentVisualContainerName:a,currentVisualType:l}),[2]));case 1:return c.sent(),this.cancelRename(),[2]}})})},r.prototype.selectFieldMenuItem=function(n){switch(A.fF.assertValue(n,"Expected a menu item option."),n.action){case 32768:this.editLabel();break;case 1:this.deleteFieldAndFocus();break;case 4:this.setAggregate(this.viewModel,n.aggregate);break;case 2:this.removeAggregate(this.viewModel);break;case 8:this.toggleShowAll(this.viewModel);break;case 128:this.setVariation(this.viewModel,n.variationExpr);break;case 32:this.setShowValueAs(this.viewModel,n.showValueAs);break;case 64:this.showQuickCalcDialog();break;case 256:this.showGroupsDialog(this.viewModel,!0);break;case 512:this.showGroupsDialog(this.viewModel,!1);break;case 1024:this.showEditClusteringDialogAsync(this.viewModel);break;case 2048:this.restoreHierarchy();break;case 4096:this.setConditionalFormatting(n.conditionalFormattingOptions);break;case 16384:this.removeConditionalFormatting(n.conditionalFormattingOptions);break;case 8192:this.removeConditionalFormattingAll();break;case 65536:this.moveField(n.moveFieldPropertyOptions,!1);break;case 131072:this.moveField(n.moveFieldPropertyOptions,!0);break;case 262144:this.moveToBucket(n.moveFieldBucketOptions);break;case 2097152:this.showSparklinesDialog(!1);break;case 33554432:this.editVisualCalculation();break;case 4194304:this.showSparklinesDialog(!0);break;case 16777216:case 8388608:this.switchQueryParameter();break;default:A.fF.assertFail("Invalid action.")}},r.prototype.restoreHierarchy=function(){var n=this.getAuthoringContext();return n?this.services.visualAuthoring.expandHierarchy(n.dataSources,n.visual,this.viewModel.role,this.viewModel.startIndex,this.viewModel.hierarchyLevels.length):Promise.resolve(!1)},r.prototype.editVisualCalculation=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,e,i;return(0,p.__generator)(this,function(o){return n=this.getSelectedVisual(),e=(0,W.$Z)(n,this.viewModel.role,this.viewModel.startIndex),i=(0,Bi.hF)(this.services.contextActivityService,{name:"VisualAction",visualName:n.name,data:{action:"EditVisualCalculation",source:"ContextMenu",contextMenuType:"FieldWell"}}),[2,this.services.visualCalcEagerService.enterVisualCalcMode(n,e,i)]})})},r.prototype.getTargetIndex=function(n,e,i,o,a){var l=o.startIndex;if(a&&(l+=o.hierarchyLevelsLength||1),n===o.role){if(l===e||l===e+i)return-1;l>e&&(l=Math.max(l-i,0))}return l},r.prototype.getSelectedVisual=function(){return me.UP.getSelectedVisual(this.services.selection)},r.prototype.checkToRestoreOrMergeLevelToHierarchy=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,c,u,d,g,v,f,m,y,M,k=this;return(0,p.__generator)(this,function(O){switch(O.label){case 0:return o=this.viewModel.hierarchyLevels,_.size(o)>0?(c=null===(i=_.first(o))||void 0===i?void 0:i.expr,[4,this.services.conceptualSchemaProxy.get(e)]):[2,!1];case 1:return u=O.sent(),(0,be.t3)(n)&&(0,ze.K8)(u,n)&&(0,xe.fS)((0,ze.ZB)(c),n)?(f=(0,ze.wA)(u,n),_.size(f)===_.size(o)?[2,!0]:[4,this.restoreHierarchy()]):[3,3];case 2:if(O.sent())return[2,!0];O.label=3;case 3:return(0,be.y3)(n)?(d=!1,n.arg instanceof Lt.c7?(g=(0,ze.cH)(c),d=(0,xe.fS)(g,n.arg)):(v=(0,ze.uW)(c),d=(0,xe.fS)(v,n)),d?(f=(0,ze.wA)(u,n),_.size(f)===_.size(o)?[2,!0]:[4,this.restoreHierarchy()]):[3,5]):[3,5];case 4:if(O.sent())return[2,!0];O.label=5;case 5:return(0,be.ez)(n)?(f=(0,ze.wA)(u,this.viewModel.expr),_.isArray(f)&&_.find(f,function(E){return(0,xe.fS)(E,n)})?_.find(this.viewModel.hierarchyLevels,function(E){return(0,xe.fS)(E.expr,n)})?[2,!0]:(m=_.findIndex(f,function(E){return(0,xe.fS)(E,n)}),y=-1,_.findLast(f.slice(0,m),function(E){var T=_.findIndex(k.viewModel.hierarchyLevels,function(K){return(0,xe.fS)(K.expr,E)});if(-1!==T)return y=T,!0}),M=-1!==y?y+1:0,[4,this.services.visualAuthoring.addFieldInRole(n,this.viewModel.role,e,this.getSelectedVisual(),this.viewModel.startIndex+M)]):[3,7]):[3,7];case 6:if(O.sent())return[2,!0];O.label=7;case 7:return[2,!1]}})})},r.prototype.switchQueryParameter=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 1:return n=e.sent(),this.services.visualAuthoring.switchQueryParameter(n,this.viewModel.startIndex,this.viewModel.role),[2]}})})},r.prototype.setAggregate=function(n,e){A.fF.assertValue(e,"Must specify a new aggregate.");var i=this.getAuthoringContext();if(i){var o=(0,qt._L)((0,Ii.Q)(n.expr)),a=this.services.visualAuthoring.setAggregate(this.viewModel.role,this.viewModel.startIndex,e,i.visual,i.dataSources);return(0,Bt.l)(n,i.visual),this.services.telemetryService.logEvent(Ie.TS,{original:(0,Ti.b)(o),target:(0,Ti.b)(e),visualName:i.visual.name}),a}},r.prototype.setVariation=function(n,e){var i=this.getAuthoringContext();i&&this.services.visualAuthoring.setVariation(i.dataSources,i.visual,e,this.viewModel.role,this.viewModel.startIndex,this.viewModel.hierarchyLevels.length)},r.prototype.removeAggregate=function(n){var e=this.getAuthoringContext();e&&(this.services.visualAuthoring.removeAggregate(this.viewModel.role,this.viewModel.startIndex,e.visual,e.dataSources),(0,Bt.l)(n,e.visual))},r.prototype.toggleShowAll=function(n){var e=this.getAuthoringContext();e&&(this.services.visualAuthoring.toggleShowAll(n.role,e.visual),(0,Bt.l)(n,e.visual))},r.prototype.showQuickCalcDialog=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n,e,i,o;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return(n=this.getAuthoringContext())?(o=n.visual.config.singleVisual.query.tryGetExpr(e=this.viewModel.role,i=this.viewModel.startIndex),[4,this.services.lazyScoped.get("quickMeasures")]):[2];case 1:return a.sent().launchQuickMeasures(o,"FieldWell",void 0,{visualContainer:n.visual,index:i,role:e}),[2]}})})},r.prototype.showSparklinesDialog=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o,a,l,c,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return(e=this.getAuthoringContext())?(a=e.visual.config.singleVisual.query.tryGetExpr(i=this.viewModel.role,o=this.viewModel.startIndex),n?[3,2]:[4,this.services.sparklinesService.showCreateDialog(a)]):[2];case 1:return(l=d.sent())&&(c=Xe.ib.deserializeExpr(l.measure),u=Xe.ib.deserializeExpr(l.grouping),this.services.sparklinesService.addSparklinesToVisual(c,u,e.visual)),[3,4];case 2:return[4,this.services.sparklinesService.showEditDialog(a)];case 3:(l=d.sent())&&(c=Xe.ib.deserializeExpr(l.measure),u=Xe.ib.deserializeExpr(l.grouping),this.services.sparklinesService.updateSparklinesExpr(c,u,e.visual,i,o)),d.label=4;case 4:return[2]}})})},r.prototype.showGroupsDialog=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,o,a,l,c,u,d=this;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return i=this.services.dataSources.get(),[4,this.services.conceptualSchemaProxy.get(i)];case 1:o=g.sent(),a=n.expr.getTargetEntity(),l=n.expr.getConceptualProperty(o),c={schema:a.schema,entity:a.entity,name:e?null:l.name,sourcePropertyName:e?l.name:null,isNew:e},u=this.services.modelChangeHandler.register(function(v){return d.handleNewGroupsBins(a,n,v),d.services.promiseFactory.resolve()}),g.label=2;case 2:return g.trys.push([2,,4,5]),[4,this.services.groupAuthoring.openGroupDialog(c)];case 3:return g.sent(),[3,5];case 4:return u.stopHandling(),[7];case 5:return[2]}})})},r.prototype.handleNewGroupsBins=function(n,e,i){var o,a=_.find(i.changes,function(g){return g.newBins});a&&(o=(0,Lt.Oh)(n,a.newBins.name));var l=_.find(i.changes,function(g){return g.newGroups});if(l){var c=(0,wn.vB)(l.newGroups.definition);o=(0,Lt.Wp)(l.newGroups.name,n,[c.groupedColumns[0]])}if(o){var d=this.services.dataSources.get();this.services.visualAuthoring.replaceField(o,e.role,e.startIndex,this.getSelectedVisual(),d)}},r.prototype.showEditClusteringDialogAsync=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,this.services.lazyScoped.get("clustering")];case 1:return[4,i.sent().editClustering((0,Ii.Q)(n.expr),this.services.dataSources.get())];case 2:return i.sent(),[2]}})})},r.prototype.setShowValueAs=function(n,e){var i=this,o=this.getAuthoringContext();if(o){var a=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(a).then(function(l){var c={dataSources:a,roleIndex:i.viewModel.startIndex,visual:o.visual,visualDataRole:i.getVisualDataRole()},d=_.find(n.interactivityOptions.dropDownItems.items,function(v){return v.key&&16===v.key.action}),g=_.find(d.children,function(v){return v.checked});i.services.showValueAsService.applyShowValueAs(c,g.key.showValueAs,e),(0,Bt.l)(n,o.visual)})}},r.prototype.logDeleteTelemetry=function(){var n=Mi(this.services.dataSources.get(),this.services.promiseFactory,this.services.conceptualSchemaProxy),e=(0,R.s)(this.getSelectedVisual());this.services.groupAuthoring.telemetry.logGroupsUsageTelemetry(n,this.viewModel.expr,e,null,this.viewModel.role,"Delete")},r.prototype.moveField=function(n,e){var i=this.viewModel.hierarchyLevels.length||1,o=this.getTargetIndex(this.viewModel.role,this.viewModel.startIndex,i,n,e);o>=0&&this.services.visualAuthoring.moveField(this.viewModel.role,n.role,this.viewModel.startIndex,o,i,this.services.dataSources.get(),!1)},r.prototype.moveToBucket=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var o;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.services.visualAuthoring.moveField(this.viewModel.role,n.role,this.viewModel.startIndex,n.targetIndex,this.viewModel.hierarchyLevels.length||1,this.services.dataSources.get(),!1)];case 1:return a.sent()||(o=this.services.localizationService.format("Invalid_FieldWellBucket_Move",[this.viewModel.displayOptions.displayName,n.displayName]),this.services.screenReaderService.alert(o),this.onContextMenuActionFailed&&this.onContextMenuActionFailed()),[2]}})})},r.prototype.setConditionalFormatting=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o,a,l,c,u,d,g,v,f,m,y,b,k,O,T,K,ie;return(0,p.__generator)(this,function(ee){switch(ee.label){case 0:return e=this.getSelectedVisual(),i=this.services.dataSources.get(),o=this.viewModel,a=this.services.featureSwitchService.featureSwitches,l=a?.conditionalTablixWebURL,c=a?.dataBarsUpdate,[4,this.services.conceptualSchemaProxy.get(i)];case 1:return u=ee.sent(),g=(d=n.repetition).propertyDescriptor&&d.propertyDescriptor.type,v=d.propertyDescriptor&&d.propertyDescriptor.type.misc,f=this.services.explorationNavigation.getCurrentExploration().themeCollection,m=this.services.themeService.getVisualStyle(f),y=this.viewModel.displayOptions.displayName,g&&(g.fill||g.icon||l&&v&&v.webUrl||c&&g.dataBars)?[4,this.services.lazyScoped.get("conditionalFormattingDialogLauncherService")]:[3,4];case 2:return[4,ee.sent().show(e,y,o.expr,d,n.propertyDefinition,m)];case 3:return(b=ee.sent())&&(k=(0,Di.PU)(b.propertyDefinition,d.propertyDescriptor,!1),O=(0,Di.L1)(b.selector),this.services.visualAuthoring.setPropertyDefinition(e,d.propertyId,d.selector,k,O)),[3,8];case 4:return g&&g.dataBars?(T=o.expr.getMetadata(u).type,[4,this.services.lazyScoped.get("dataBarsDialogLauncherService")]):[3,7];case 5:return K=ee.sent(),ie=this,[4,K.show(e,y,d,m.colorPalette,T,!1)];case 6:return ie.dataBarsDialogRef=ee.sent(),[3,8];case 7:A.fF.assertFail("FieldWellFieldController.createConditionalFormatting - Invalid Conditional Formatting Type"),ee.label=8;case 8:return[2]}})})},r.prototype.removeConditionalFormatting=function(n){A.fF.assertValue(n.propertyDefinition,"removeConditionalFormatting called for missing property");var e=this.getSelectedVisual(),i=n.repetition,o=i.propertyDescriptor&&i.propertyDescriptor.type,a=i.propertyDescriptor&&i.propertyDescriptor.type.misc;o&&(o.fill||o.icon||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.conditionalTablixWebURL&&a&&a.webUrl)?this.services.visualAuthoring.removePropertyDefinition(e,i.propertyId,i.selector):o&&o.dataBars?this.services.visualAuthoring.removeDataBars(e,i):A.fF.assertFail("FieldWellFieldController.createConditionalFormatting - Invalid Conditional Formatting Type"),this.services.telemetryService.logEvent(Ie.Sd,{visualType:(0,R.s)(e),visualName:e.name})},r.prototype.removeConditionalFormattingAll=function(){var n=this.getSelectedVisual();this.services.visualAuthoring.removeConditionalFormattingAll(n,this.viewModel.conditionalFormattingRepetitions),this.services.telemetryService.logEvent(Ie.Sd,{visualType:(0,R.s)(n),visualName:n.name})},r.prototype.getAuthoringContext=function(){var n=this.getSelectedVisual();if(n){var e=this.services.dataSources.get();if(e)return{visual:n,dataSources:e}}},r.prototype.getVisualDataRole=function(){var n=(0,W.d$)(this.getSelectedVisual(),this.services.visualPlugin);if(!_.isEmpty(n))return(0,Fn.rC)(n,this.viewModel.role)},r}();function Qn(r,n){if(1&r&&(t.\u0275\u0275element(0,"i",8),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275pipe(2,"async")),2&r){var e=t.\u0275\u0275nextContext();t.\u0275\u0275classMapInterpolate1("warning glyphicon glyph-mini ng-scope ",e.viewModel.warning.glyph,""),t.\u0275\u0275property("pbiTooltip",t.\u0275\u0275pipeBind1(2,7,e.warningTooltip$)),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(1,5,e.tooltipDescription$))}}function Xn(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"tri-svg-icon",9),t.\u0275\u0275listener("mouseenter",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.infoIconName="info_20_filled")})("mouseleave",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.infoIconName="info_20_regular")}),t.\u0275\u0275elementEnd()}if(2&r){var i=t.\u0275\u0275nextContext();t.\u0275\u0275property("name",i.infoIconName)("pbiTooltip",i.bucketTooltip),t.\u0275\u0275attribute("aria-label",i.bucketTooltip)}}function Zn(r,n){if(1&r&&t.\u0275\u0275element(0,"field-well-field-modern",12),2&r){var e=n.$implicit,i=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("bucketDisplayName",i.viewModel.displayName)("viewModel",e)}}var Jn=function(n,e,i){return{dropzone:n,"end-dropzone":e,"supports-multiple-items":i}};function Yn(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,Zn,1,2,"field-well-field-modern",10),t.\u0275\u0275elementStart(2,"li",11),t.\u0275\u0275listener("dropHandler",function(l){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.drop(l.event,l.ui,l.dropAction))}),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275pipe(5,"async"),t.\u0275\u0275pipe(6,"async"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()}if(2&r){var i=n.ngIf,o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",i),t.\u0275\u0275advance(1),t.\u0275\u0275property("drop",o.dropConfig)("dropAction",o.dropActionHandler)("ngClass",t.\u0275\u0275pureFunction3(16,Jn,0===i.length,i.length>0,t.\u0275\u0275pipeBind1(3,8,o.supportsMultipleItems$)))("textContent",t.\u0275\u0275pipeBind1(4,10,o.dropzoneLocalize$))("title",t.\u0275\u0275pipeBind1(5,12,o.dropzoneLocalize$))("tabindex",t.\u0275\u0275pipeBind1(6,14,o.tabIndex$)),t.\u0275\u0275attribute("aria-label",o.addFieldsAriaLabel)}}var qn=function(n){return{disabled:n}},eo=function(n){return{border:n}},Ri=function(r){function n(e,i,o,a,l,c,u,d,g,v,f,m,y,M){var b=r.call(this)||this;return b.element=e,b.conceptualSchemaProxy=i,b.dataSources=o,b.dragDataService=a,b.eventBridge=l,b.featureSwitchService=c,b.groupAuthoring=u,b.localizationService=d,b.promiseFactory=g,b.selection=v,b.telemetryService=f,b.viewModeState=m,b.visibilityService=y,b.visualAuthoring=M,b.infoIconName="info_20_regular",b.core=new ji({conceptualSchemaProxy:b.conceptualSchemaProxy,dataSources:b.dataSources,eventBridge:b.eventBridge,featureSwitchService:b.featureSwitchService,groupAuthoring:b.groupAuthoring,promiseFactory:b.promiseFactory,selection:b.selection,telemetryService:b.telemetryService,visualAuthoring:b.visualAuthoring}),b.uniqueId=_.uniqueId("fieldWellId"),b.dropConfig=b.getDropConfig(),b.dropActionHandler=function(O){return Promise.resolve(b.getDropAction(O))},b.bucketTooltip=d.get("Visual_Calculation_Field_Bucket_Tooltip"),b.dropzoneText=b.localizationService.get("FieldDropZone_AddFields"),b}return(0,p.__extends)(n,r),Object.defineProperty(n.prototype,"viewModel",{get:function(){return this.core.viewModel},set:function(i){this.core.viewModel=i},enumerable:!1,configurable:!0}),n.prototype.ngOnInit=function(){var e=this;this.viewModel$=this.changes$("viewModel"),this.showTooltip$=(0,Fe.aj)([this.viewModel$,this.visibilityService.get$(16)]).pipe((0,X.U)(function(i){var a=i[1];return i[0].properties.filter(function(c){return c.isHiddenInVisual}).length>0&&16!==a?.visibility}),(0,I.R)(this.onDestroy$)),this.visibleFieldProperties$=(0,Fe.aj)([this.viewModel$,this.visibilityService.get$(16)]).pipe((0,X.U)(function(i){var o=i[0],a=i[1];return 16===a?.visibility?o.properties:_.filter(o.properties,function(l){return!l.isHiddenInVisual})}),(0,wi.d)(1),(0,I.R)(this.onDestroy$)),this.dropzoneLocalize$=this.visibleFieldProperties$.pipe((0,X.U)(function(i){return 0===i.length?e.dropzoneText:""})),this.tabIndex$=this.visibleFieldProperties$.pipe((0,X.U)(function(i){return 0===i.length?0:-1})),this.supportsMultipleItems$=(0,Fe.aj)([this.viewModel$,this.visibilityService.get$(16)]).pipe((0,X.U)(function(i){var o=i[0],a=i[1];return 16===a?.visibility||o.supportsMultipleItems}),(0,I.R)(this.onDestroy$)),this.addFieldsAriaLabel=this.getAddFieldsAriaLabel(),this.borderStyle$=(0,Fe.aj)([this.viewModel$,this.viewModeState.getMode$()]).pipe((0,X.U)(function(i){return e.getBorderStyle(i[0],i[1])}),(0,I.R)(this.onDestroy$)),this.fieldWellAriaLabel$=this.viewModel$.pipe((0,X.U)(function(i){return e.getFieldWellAriaLabel(i)})),this.tooltipDescription$=this.viewModel$.pipe((0,X.U)(function(i){return i.description||i.displayName})),this.warningTooltip$=this.viewModel$.pipe((0,X.U)(function(i){return e.getWarningTooltip(i)}))},n.prototype.ngAfterViewInit=function(){var e=this;this.viewModel$.pipe((0,I.R)(this.onDestroy$)).subscribe(function(i){i.disabled?(0,at.u3)(e.element.nativeElement):(0,at.$o)(e.element.nativeElement,function(o,a){return e.core.dropField(a)})})},n.prototype.drop=function(e,i,o){var a=this.dragDataService.getDragContext();this.core.dropWithPayload(a)},n.prototype.getDropAction=function(e){var i=this.dragDataService.getDragContext(),o=0;if(i){var a=this.viewModel;o=i.sourceRole===a.role&&_.last(a.properties).startIndex===i.sourceIndex?0:_.isEmpty(this.viewModel.properties)?1:2}return o},n.prototype.getDropConfig=function(){return{accept:"field",greedy:!1}},n.prototype.getAddFieldsAriaLabel=function(){var e=this.localizationService;return e.get("FieldDropZone_NoDataFields").concat(". ",e.get("FieldDropZone_AddFields"))},n.prototype.getBorderStyle=function(e,i){if(0===i&&0!==e.properties.length)return"none"},n.prototype.getFieldWellAriaLabel=function(e){var i=e.displayName;return _.isString(e.description)&&(i=_.isString(i)?i.concat(". ",e.description):e.description),i},n.prototype.getWarningTooltip=function(e){var i={tooltipTitle:"",tooltipDescription:""};return e.warning&&(i={tooltipTitle:e.warning.title,tooltipDescription:e.warning.description}),i.tooltipDescription||i.tooltipTitle},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(t.ElementRef),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject($e.x),t.\u0275\u0275directiveInject(oe.J),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Qe.RD),t.\u0275\u0275directiveInject(le.o),t.\u0275\u0275directiveInject(we.t),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(Fi.kc),t.\u0275\u0275directiveInject(Me.w),t.\u0275\u0275directiveInject(pe.$8))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["field-well-bucket-modern"]],inputs:{viewModel:"viewModel"},features:[t.\u0275\u0275InheritDefinitionFeature],decls:13,vars:23,consts:[[1,"bucket",3,"ngClass"],[1,"bucket-header"],[1,"caption","trimmedTextWithEllipsis","smallFontSize",3,"textContent","pbiTooltip"],["role","alert","tabindex","0",3,"class","pbiTooltip",4,"ngIf"],["role","tooltip","style","margin-left:4px","tabindex","0","tri-svg-icon-16","","sprite","fluentui-icons",3,"name","pbiTooltip","mouseenter","mouseleave",4,"ngIf"],[1,"properties",3,"ngStyle","drop"],["aria-hidden","true",1,"bucketTopBorder"],[4,"ngIf"],["role","alert","tabindex","0",3,"pbiTooltip"],["role","tooltip","tabindex","0","tri-svg-icon-16","","sprite","fluentui-icons",2,"margin-left","4px",3,"name","pbiTooltip","mouseenter","mouseleave"],[3,"bucketDisplayName","viewModel",4,"ngFor","ngForOf"],["data-testid","bucket-add-field",1,"trimmedTextWithEllipsis",3,"drop","dropAction","ngClass","textContent","title","tabindex","dropHandler"],[3,"bucketDisplayName","viewModel"]],template:function(i,o){1&i&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1),t.\u0275\u0275element(2,"h2",2),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275template(5,Qn,3,9,"i",3),t.\u0275\u0275template(6,Xn,1,3,"tri-svg-icon",4),t.\u0275\u0275pipe(7,"async"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"ol",5),t.\u0275\u0275pipe(9,"async"),t.\u0275\u0275element(10,"li",6),t.\u0275\u0275template(11,Yn,7,20,"ng-container",7),t.\u0275\u0275pipe(12,"async"),t.\u0275\u0275elementEnd()()),2&i&&(t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(19,qn,o.viewModel.disabled)),t.\u0275\u0275advance(2),t.\u0275\u0275property("textContent",o.viewModel.displayName)("pbiTooltip",t.\u0275\u0275pipeBind1(4,11,o.tooltipDescription$)),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(3,9,o.fieldWellAriaLabel$)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",o.viewModel.warning),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(7,13,o.showTooltip$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngStyle",t.\u0275\u0275pureFunction1(21,eo,t.\u0275\u0275pipeBind1(9,15,o.borderStyle$)))("drop",o.dropConfig),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(12,17,o.visibleFieldProperties$)))},dependencies:[P.NgClass,P.NgForOf,P.NgIf,P.NgStyle,Ge.W,ot.V,Ei.M,zi,P.AsyncPipe],styles:[".bucket.disabled[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;opacity:.5}"]}),n}(Oi.w),ji=function(){function r(n){this.services=n}return r.prototype.dropWithPayload=function(n){if(n&&!this.viewModel.disabled){var e=n,i=this.getSelectedVisual();if(e.sourceRole){A.fF.assert(function(){return $.isNumeric(e.sourceIndex)},"Unexpected drag source");var o=0;this.viewModel.properties.length>0&&(o=_.last(this.viewModel.properties).endIndex+1),e.sourceRole===this.viewModel.role&&(o=Math.max(o-(e.hierarchyLevelCount||1),0));var a=this.services.dataSources.get();this.services.visualAuthoring.moveField(e.sourceRole,this.viewModel.role,e.sourceIndex,o,e.hierarchyLevelCount||1,a,16===i?.visibility);var c=i?i.config.singleVisual.query.tryGetExpr(e.sourceRole,e.sourceIndex):null;return void this.logTelemetry(c,e.sourceRole,i)}n.field&&this.dropField(n.field)}},r.prototype.dropField=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return this.viewModel.disabled?[2,!1]:(i=this.getSelectedVisual())?(o=this.services.dataSources.get(),[4,this.services.visualAuthoring.addFieldInRole(n,this.viewModel.role,o,i,void 0,void 0,void 0,16===i?.visibility)]):[3,2];case 1:return e=l.sent(),[3,3];case 2:this.services.eventBridge.publishToChannel(B.Tyr,{expr:n,visualType:ct.x.getDefaultVisualPlugin(this.services.featureSwitchService).name,targetRole:this.viewModel.role,allowAggregate:!0,telemetrySource:3,startAuthoringAfterAddition:!1}),e=!0,l.label=3;case 3:return this.logTelemetry(n,null),[2,e]}})})},r.prototype.logTelemetry=function(n,e,i){if(n){var o="Create";e&&(o="Update",this.services.telemetryService.logEvent(Ie.V1,{sourceBucketRole:e,targetBucketRole:this.viewModel.role,visualName:i&&i.name}));var a=(0,R.s)(this.getSelectedVisual()),l=Mi(this.services.dataSources.get(),this.services.promiseFactory,this.services.conceptualSchemaProxy);this.services.groupAuthoring.telemetry.logGroupsUsageTelemetry(l,n,a,this.viewModel.role,e,o)}},r.prototype.getSelectedVisual=function(){return me.UP.getSelectedVisual(this.services.selection)},r}();function to(r,n){1&r&&t.\u0275\u0275element(0,"field-well-bucket-modern",3),2&r&&t.\u0275\u0275property("viewModel",n.$implicit)}function io(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"ol"),t.\u0275\u0275template(1,to,1,1,"field-well-bucket-modern",2),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",e.viewModel.buckets)}}var Wi={},ni=function(){function r(n,e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k){this.changeDetection=n,this.conceptualSchemaProxy=e,this.dataSources=i,this.displayNameService=o,this.eventBridge=a,this.explorationNavigation=l,this.groupingDesignStateService=c,this.featureSwitchService=u,this.lazyScoped=d,this.localizationService=g,this.runningVisualService=v,this.selectionService=f,this.showValueAsService=m,this.vcRef=y,this.visualPlugin=M,this.visibility=b,this.visualCalcEagerService=k}return r.prototype.ngOnInit=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return n={$element:$(this.vcRef.element.nativeElement),conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,explorationDisplayNameService:this.displayNameService,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,groupingDesignStateService:this.groupingDesignStateService,featureSwitchService:this.featureSwitchService,selection:this.selectionService,showValueAsService:this.showValueAsService,visualPlugin:this.visualPlugin,localizationService:this.localizationService,runningVisuals:this.runningVisualService,visibility:this.visibility,visualCalcEagerService:this.visualCalcEagerService,lazyScopedProvider:this.lazyScoped},this.core=new Ui(n,!1,this.updateViewModel.bind(this)),[4,this.core.onInit()];case 1:return e.sent(),[2]}})})},r.prototype.ngOnDestroy=function(){this.core.onDestroy()},r.prototype.updateViewModel=function(n){this.viewModel=n,this.changeDetection.detectChanges()},r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275directiveInject(t.ChangeDetectorRef),t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(Ue.O),t.\u0275\u0275directiveInject(oe.J),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(At.AA),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(Se.H),t.\u0275\u0275directiveInject(le.o),t.\u0275\u0275directiveInject(It.s),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(He.P),t.\u0275\u0275directiveInject(t.ViewContainerRef),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(Me.w),t.\u0275\u0275directiveInject(Ke.w))},r.\u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["field-well-modern"]],decls:2,vars:1,consts:[[1,"fieldWell","unselectable"],[4,"ngIf"],["class","field-well-bucket-element","data-testid","field-well-bucket-element","role","listitem",3,"viewModel",4,"ngFor","ngForOf"],["data-testid","field-well-bucket-element","role","listitem",1,"field-well-bucket-element",3,"viewModel"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"section",0),t.\u0275\u0275template(1,io,2,1,"ol",1),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.viewModel&&i.viewModel.buckets))},dependencies:[P.NgForOf,P.NgIf,Ri],styles:[".explorationContainer .fieldWell{overflow:auto}.explorationContainer .fieldWell .errorIcon{cursor:pointer;width:16px;height:16px;background-color:transparent;vertical-align:top}.explorationContainer .fieldWell .bucket{display:flex;flex-direction:column;padding-bottom:4px;color:var(--neutral-tertiary-alt-color, #C8C8C8);width:100%}.explorationContainer .fieldWell .bucket .bucket-header{display:flex;flex-direction:row;margin:6px 5px 6px 0;align-items:center}.explorationContainer .fieldWell .bucket .bucket-header .caption{box-sizing:border-box;margin-left:12px;font-weight:inherit;color:var(--white-color, #FFF)}.explorationContainer .fieldWell .bucket .bucket-header .caption:focus{outline:none}.explorationContainer .fieldWell .bucket .bucket-header .warning{flex:none;margin-top:auto;color:var(--data-color6, #8AD4EB);cursor:pointer}.explorationContainer .fieldWell .properties{float:left;min-height:28px;width:calc(100% - 10px);margin:0 4px;border:1px dashed var(--neutral-secondary-color, #666666);border-radius:4px;background-color:var(--neutral-primary-color-alt2, #4a4a4a);padding:1px 0}.explorationContainer .fieldWell .properties.dragover{border:1px dashed var(--theme-primary-color, #F2C811)!important}.explorationContainer .fieldWell .properties li:focus{outline:none}.explorationContainer .fieldWell .dropzone,.explorationContainer .fieldWell .end-dropzone{width:calc(100% - 4px);line-height:22px;padding-left:8px;margin:0 2px}.explorationContainer .fieldWell .end-dropzone.supports-multiple-items{height:7px;border-top:1px solid transparent}.explorationContainer .fieldWell .end-dropzone.supports-multiple-items.prepend{border-top-color:var(--theme-primary-color, #F2C811)!important}.explorationContainer .fieldWell .end-dropzone.supports-multiple-items:focus{outline:none}.explorationContainer .fieldWellProperty[drag]{position:relative;padding-left:4px;background:var(--neutral-primary-color, #333333);border-radius:3px;border:1px solid var(--neutral-dark-color, #212121);cursor:pointer}.explorationContainer .fieldWellProperty[drag].not-draggable,.explorationContainer .fieldWellProperty[drag].not-draggable .errorIcon,.explorationContainer .fieldWellProperty[drag].not-draggable .editableLabel .textLabel{cursor:default}.explorationContainer .fieldWellProperty[drag] .caption{color:var(--white-color, #FFF);line-height:21px}.explorationContainer .fieldWellProperty[drag] .field-glyph{float:left;margin:4px 4px 4px 2px}.explorationContainer .fieldWellProperty[drag] .error{float:left;width:16px;height:16px}.explorationContainer .fieldWellProperty[drag] .delete{width:16px;height:16px;color:var(--neutral-secondary-alt-color2, #888888);background:transparent}.explorationContainer .fieldWellProperty[drag] .hierarchyList{padding-left:8px;color:var(--white-color, #FFF)}.explorationContainer .fieldWellProperty[drag] .hierarchyList .subcaption{color:var(--white-color, #FFF);line-height:19px}.explorationContainer .fieldWellProperty[drag] .glyphicon{color:var(--white-color, #FFF)}.explorationContainer field-well-field-modern{border:solid var(--neutral-primary-color-alt2, #4a4a4a);display:block;border-width:1px 0;border-radius:3px;margin:0 2px}.explorationContainer field-well-field-modern.append{border-bottom-color:var(--theme-primary-color, #F2C811)!important}.explorationContainer field-well-field-modern.prepend{border-top-color:var(--theme-primary-color, #F2C811)!important}.explorationContainer field-well-field-modern .textInput{background:var(--neutral-tertiary-alt-color, #C8C8C8);color:var(--black-color, #000)}.explorationContainer field-well-field-modern .textInput::selection{background:var(--theme-primary-color, #F2C811)}.explorationContainer field-well-field-modern editable-label .textLabel{white-space:nowrap}.explorationContainer .fieldWellIcon{background-color:transparent}.explorationContainer .fieldWellIcon:hover,.explorationContainer .fieldWellIcon:focus,.explorationContainer .fieldWellIcon:active,.explorationContainer .fieldWellIcon:active:hover,.explorationContainer .fieldWellIcon:focus:hover{background-color:transparent}.explorationContainer .bucketTopBorder{border-bottom:1px solid transparent;border-radius:3px;margin:0 2px}.explorationContainer .bucketTopBorder.append{border-bottom-color:var(--theme-primary-color, #F2C811)}.newPaneColors.explorationContainer{--field-well-title-color: var(--gray-180, #252423);--field-well-background: var(--white-color, #FFF);--field-well-item-background: var(--gray-30, #EDEBE9);--field-well-item-border-color: var(--gray-60, #C8C6C4)}[data-legacy-theming=false] .newPaneColors.explorationContainer{--field-well-title-color: var(--colorNeutralForeground1);--field-well-background: var(--colorNeutralBackground3);--field-well-item-background: var(--colorNeutralBackground2);--field-well-item-border-color: var(--colorNeutralStroke1)}.newPaneColors.explorationContainer .fieldWell .bucket,.newPaneColors.explorationContainer .fieldWell .bucket .bucket-header .caption{color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWell .bucket .bucket-header .caption:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWell .properties{border-color:var(--field-well-item-border-color);background-color:var(--field-well-background);border-radius:2px}.newPaneColors.explorationContainer .fieldWell .properties.dragover{border-color:var(--gray-130, #605E5C)!important}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWell .properties li:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWell .errorIcon:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag]{background:var(--field-well-item-background);border-radius:2px;border-color:var(--field-well-item-border-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .caption{color:var(--field-well-title-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .caption input{background:var(--field-well-background);color:var(--field-well-title-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .delete{color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWellProperty[drag] .delete:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .hierarchyList,.newPaneColors.explorationContainer .fieldWellProperty[drag] .hierarchyList .subcaption{color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWellProperty[drag] .hierarchyList .subcaption:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .fieldWellProperty[drag] .glyphicon{color:var(--field-well-title-color)}.newPaneColors.explorationContainer field-well-field-modern{border-color:transparent;border-radius:2px}.newPaneColors.explorationContainer field-well-field-modern .textInput{background:var(--field-well-background);color:var(--field-well-title-color)}html[data-focus-source=key] .newPaneColors.explorationContainer field-well-field-modern editable-label:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=key] .newPaneColors.explorationContainer .fieldWellIcon:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer .bucketTopBorder{border-radius:2px}\n"],encapsulation:2}),r}(),Ui=function(){function r(n,e,i){this.services=n,this.disableHierarchyLevelGrouping=e,this.onViewModelChange=i,this.additionalSubscriptions=new Dt.w}return r.prototype.onInit=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return this.viewModel=new Te.KT([]),this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(B.CCe,function(){return n.requestModelAndUpdate(!0)}).subscribe(B.tRg,function(){return n.requestModelAndUpdate()}).subscribe(B.KD7,function(){return n.requestModelAndUpdate()}).subscribe(B.y5h,function(){return n.requestModelAndUpdate(!0)}).subscribe(B.jCS,function(){return n.requestModelAndUpdate(!0)}).subscribe(B.Ah$,function(i,o){return n.onFieldWellFieldRemoved(o)}).subscribe(B.D1A,function(){return n.requestModelAndUpdate(!0)}).subscribe(B.oRp,function(){return n.requestModelAndUpdate()}),this.additionalSubscriptions.add(this.services.visualCalcEagerService.onContextChange$().subscribe(function(){return n.requestModelAndUpdate()})),this.additionalSubscriptions.add(me.UP.getSelectedVisualContainer$(this.services.selection).pipe((0,V.h)(function(i){return!!i}),(0,Le.w)(function(i){return n.services.runningVisuals.getVisual$(i)}),(0,Le.w)(function(i){return i?i.getErrorInfo$():Tt.E})).subscribe(function(){return n.requestModelAndUpdate()})),[4,this.requestModelAndUpdate()];case 1:return[2,e.sent()]}})})},r.prototype.onDestroy=function(){this.subscriptionManager&&this.subscriptionManager.unsubscribeAll(),this.additionalSubscriptions.unsubscribe()},r.prototype.onFieldWellFieldRemoved=function(n){ut.IK.focus(_.find(this.services.$element.find(".field-well-bucket-element .bucket .bucket-header .caption"),function(e){return $(e).html()===n}),!1)},r.prototype.requestModelAndUpdate=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i=this;return(0,p.__generator)(this,function(o){return(e=this.services.dataSources.get())?[2,this.services.conceptualSchemaProxy.get(e).then(function(a){return i.update(a,n)})]:[2]})})},r.prototype.update=function(n,e){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,a,l,c,u,d,g,v=this;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,this.services.lazyScopedProvider.get("fieldWellViewModelService")];case 1:if(o=f.sent(),l=this.getSelectedVisual(),this.deferredCreateBuckets&&(this.deferredCreateBuckets.reject(Wi),this.deferredCreateBuckets=void 0),n){if(l)return u=[new no(this.services.explorationNavigation,this.services.localizationService)],d=16===(null===(i=this.services.visibility.get())||void 0===i?void 0:i.visibility),this.services.featureSwitchService.featureSwitches.cartesianMultiplesAuthoring||u.push(new oo(this.services.visualPlugin,l)),g=this.services.runningVisuals.getVisual(l),this.deferredCreateBuckets=o.createBuckets(g,l,n,this.services.groupingDesignStateService,this.services.showValueAsService,this.services.visualPlugin,this.services.explorationDisplayNameService,u,this.disableHierarchyLevelGrouping,d),[2,this.deferredCreateBuckets.promise.then(function(m){v.updateViewModel(m,e)},function(m){if(m!==Wi)throw m}).finally(function(){v.deferredCreateBuckets=void 0})];c=(0,W.x3)(ct.x.getDefaultVisualPlugin(this.services.featureSwitchService)),a=o.createEmptyBuckets(c,[]),this.updateViewModel(a,e)}else this.updateViewModel(a=null,e);return[2]}})})},r.prototype.updateViewModel=function(n,e){e&&(0,_i.L)(n,this.viewModel.buckets)||(this.viewModel.buckets=n,this.onViewModelChange&&this.onViewModelChange(this.viewModel))},r.prototype.getSelectedVisual=function(){return me.UP.getSelectedVisual(this.services.selection)},r}(),no=function(){function r(n,e){this.explorationNavigation=n,this.localizationService=e}return r.prototype.onBucketCreated=function(n,e,i,o,a,l,c){var u=e.config.singleVisual,d=l.capabilities(u.visualType),g=!d||!d.tooltips||void 0===d.tooltips.showByDefault||d.tooltips.showByDefault,v=(0,Vt.NA)(u.vcObjects,{objectName:"visualTooltip",propertyName:"show"},void 0);if((v||g)&&(!v||v.value)){var f=(0,Vt.NA)(u.vcObjects,{objectName:"visualTooltip",propertyName:"type"},void 0),m=(0,Vt.NA)(u.vcObjects,{objectName:"visualTooltip",propertyName:"section"},void 0),y=f&&f.value,b=m&&m.value;if((!y||y===ke.Xz)&&b&&b!==ke.pJ&&_.some(d.tooltips&&d.tooltips.roles,function(re){return re===n.role})){var E=m&&m.value,T=void 0;if(E===ke.pJ)T=c.get("ReportPage");else{var K=this.explorationNavigation.getAllSections(),ie=_.find(K,function(re){return re.name===E&&1===re.type});if(!ie)return;T=ie.displayName}var ee=new Te.DR(T,null,null,"pbi-glyph-canvas-tooltip"),se=new Te.Ct(null,!1,!1);se.disableInteractivity();var ue=new Te._d(void 0,n.role,-1,-1,!0,ee,se,void 0,void 0,void 0,void 0);n.properties.push(ue),n.warning=new Te.kh("pbi-glyph-info",void 0,this.localizationService.get("FieldWellBucket_Warning_CanvasTooltipDescription"))}}},r.prototype.shouldCreateBucketForRole=function(n){return!0},r}(),oo=function(){function r(n,e){this.visualPluginService=n,this.visual=e}return r.prototype.onBucketCreated=function(n,e,i,o,a,l,c){},r.prototype.shouldCreateBucketForRole=function(n){var e=this.visualPluginService.capabilities(this.visual.config.singleVisual.visualType);return(0,Yt.hQ)(n,this.visual.config.singleVisual,e)},r}();function ro(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"visual-types-container-modern",5),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("visualPluginFilter",e.visualPluginFilter)}}function ao(r,n){1&r&&t.\u0275\u0275element(0,"spinner")}function lo(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"section",6),t.\u0275\u0275template(1,ao,1,0,"spinner",2),t.\u0275\u0275elementStart(2,"visual-types-container-modern",7),t.\u0275\u0275listener("isFinishedLoading",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onVisualTypesContainerDoneLoading())}),t.\u0275\u0275elementEnd()()}if(2&r){var i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.isPersonalVisualTypesLoaded),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("hidden",!i.isPersonalVisualTypesLoaded),t.\u0275\u0275property("visualPluginFilter",i.nonPersonalVisualizationPaneFilter)("disableMoreOptionsIcon",!0)}}function so(r,n){1&r&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"field-well-modern"),t.\u0275\u0275elementEnd())}function co(r,n){1&r&&(t.\u0275\u0275elementStart(0,"section"),t.\u0275\u0275element(1,"drillthrough-pane",9),t.\u0275\u0275elementEnd())}var uo=function(){return{ignoreOverlay:!1,ignoreMobile:!1}};function po(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"div")(1,"div",8),t.\u0275\u0275template(2,so,2,0,"section",2),t.\u0275\u0275template(3,co,2,0,"section",2),t.\u0275\u0275elementEnd()()),2&r){var e=t.\u0275\u0275nextContext();t.\u0275\u0275classMap(e.fieldWellOrFiltersClass),t.\u0275\u0275advance(1),t.\u0275\u0275property("pbiScrollbar",t.\u0275\u0275pureFunction0(6,uo))("pbiScrollbarDisabled",e.disableScrollbar),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.showFieldWell),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.showDrillthroughPane)}}var oi,$i=function(){function r(){this.disableScrollbar=!1}return r.prototype.onVisualTypesContainerDoneLoading=function(){this.isPersonalVisualTypesLoaded=!0},Object.defineProperty(r.prototype,"fieldWellOrFiltersClass",{get:function(){return this.disableScrollbar?"fieldWellOrFilters disableScrollbar":"fieldWellOrFilters enableScrollbar"},enumerable:!1,configurable:!0}),r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["build-section"]],inputs:{showVisualTypes:"showVisualTypes",showFieldWell:"showFieldWell",showDrillthroughPane:"showDrillthroughPane",showFieldWellOrFilters:"showFieldWellOrFilters",populatePanes:"populatePanes",visualPluginFilter:"visualPluginFilter",nonPersonalVisualizationPaneFilter:"nonPersonalVisualizationPaneFilter",showNonPersonalVisuals:"showNonPersonalVisuals",disableScrollbar:"disableScrollbar"},decls:5,vars:3,consts:[["section-animation-slider","",1,"pane-contents-modern","modern-format-pane"],[1,"visualTypesContainer"],[4,"ngIf"],["class","nonPersonalVisualizationPane",4,"ngIf"],[3,"class",4,"ngIf"],[3,"visualPluginFilter"],[1,"nonPersonalVisualizationPane"],[3,"visualPluginFilter","disableMoreOptionsIcon","isFinishedLoading"],[1,"scroller",3,"pbiScrollbar","pbiScrollbarDisabled"],[1,"modern"]],template:function(e,i){1&e&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1),t.\u0275\u0275template(2,ro,2,1,"section",2),t.\u0275\u0275template(3,lo,3,5,"section",3),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(4,po,4,7,"div",4),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.showVisualTypes),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.showVisualTypes&&i.showNonPersonalVisuals),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.showFieldWellOrFilters))},dependencies:[P.NgIf,Jt.R,St.r,Ci.O,w.r,Et,ni],styles:['.pane-contents-modern[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;margin-top:2px}.hidden[_ngcontent-%COMP%]{display:none}.nonPersonalVisualizationPane[_ngcontent-%COMP%]{margin-top:4px;padding-top:4px;border-top:1px dashed var(--gray-40, #E1DFDD)}.fieldWellOrFilters[_ngcontent-%COMP%]{border-top:1px solid var(--gray-40, #E1DFDD);padding-top:2px;flex-basis:0;flex-grow:1}.disableScrollbar[_ngcontent-%COMP%]{overflow:unset;padding-right:"6px";padding-left:"6px"}.enableScrollbar[_ngcontent-%COMP%]{overflow:hidden}.visualTypesContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:2px 6px;margin-bottom:4px}']}),r}(),Ae=s(41887),Ne=s(80981);!function(r){function n(o,a,l,c,u,d){if(o&&function(o,a){var l=o.config.singleVisual,u=l.query;if(u)return a.capabilities(l.visualType).supportsSynchronizingFilterState&&u.hasProjections()}(o,a))return new vo(o,u,d,l,c)}r.create=n,r.createObservable=function(o,a,l,c,u,d,g,v){var f=this,m=new z.X(void 0);a.get(l.get()).then(function(k){return m.next(k)});var b,y=new z.X(me.UP.getSelectedVisual(c)),M=new z.X(g.getCurrentExploration());return o.subscribe(B.jCS,function(k,O){if(1!==O.visualContainerChangeType){var E=me.UP.getSelectedVisual(c);E&&O.affectContainer(E)&&y.next(E)}}).subscribe(B.tRg,function(){y.next(me.UP.getSelectedVisual(c))}).subscribe(B.UpY,function(){b=!0}).subscribe(B.t4l,function(){M.next(g.getCurrentExploration())}).subscribe(B.LE3,function(){M.next(g.getCurrentExploration())}).subscribeAsync(B.CCe,function(){return(0,p.__awaiter)(f,void 0,void 0,function(){var k;return(0,p.__generator)(this,function(O){switch(O.label){case 0:return[4,a.get(l.get())];case 1:return k=O.sent(),b=!1,m.next(k),[2]}})})}).subscribe(B.KD7,function(){return y.next(me.UP.getSelectedVisual(c))}).subscribe(B.TTT,function(){M.next(g.getCurrentExploration())}).subscribe(B.HGU,function(){M.next(g.getCurrentExploration())}),(0,Fe.aj)([m,y,M]).pipe((0,V.h)(function(){return!b}),(0,X.U)(function(k){var O=k[0],E=k[1],T=k[2];if(E&&O&&T)return n(E,u,v,d,T,O)}))}}(oi||(oi={}));var vo=function(){return function(n,e,i,o,a){this.sourceVisual=n,this.exploration=e,this.schema=i,this.localizationService=o,this.visualSyncService=a,this.pageSyncItems=[];var l=function(r,n,e,i,o){return r.syncGroup?function(r,n,e){var i=dt(r);A.fF.assertValue(i,"source visual should be in a group");for(var o=[],a={},l=0,c=n.sections;l<c.length;l++){for(var u=c[l],d=e.format("SyncGroupPane_SyncCheckboxLabel",[u.displayName]),g=e.format("SyncGroupPane_VisibleCheckboxLabel",[u.displayName]),v=void 0,f=[],m=[],y=0,M=u.visualContainers;y<M.length;y++){var k=(b=M[y]).config.singleVisual,O=dt(k);O?(a[O]=!0,k===r?v=b:O===i&&m.push(b)):Gi(r,k)&&f.push(b)}if(v)o.push({section:u,synced:!!i,visible:!(0,Ne.xj)(r),visualContainer:v,isSourceVisual:!0,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g});else if(_.some(m))o.push(1===m.length?{section:u,synced:!0,visible:!(0,Ne.xj)((b=m[0]).config.singleVisual),visualContainer:b,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g}:{disabledReason:1,section:u,synced:!0,visible:_.some(m,function(E){return!(0,Ne.xj)(E.config.singleVisual)}),visualContainer:m[0],syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g});else if(1===f.length){var b;o.push({section:u,synced:!1,visible:!(0,Ne.xj)((b=f[0]).config.singleVisual),visualContainer:b,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g})}else o.push({section:u,synced:!1,visible:!1,syncCheckboxAriaLabel:d,visibleCheckboxAriaLabel:g})}return A.fF.assert(function(){return o.length===n.sections.length},"expected a single sync group item for each section"),{state:0,items:o,activeSyncGroup:i}}(r,n,o):function(r,n,e,i,o){A.fF.assert(function(){return!r.syncGroup},"expected visual to be ungrouped");for(var d,a={},l={},c={},u=-1,g=[],v=0;v<n.sections.length;v++){var m=o.format("SyncGroupPane_SyncCheckboxLabel",[(f=n.sections[v]).displayName]),y=o.format("SyncGroupPane_VisibleCheckboxLabel",[f.displayName]);g[v]={};for(var M=void 0,b={},k=0,O=f.visualContainers;k<O.length;k++){var E=O[k],T=E.config.singleVisual,K=dt(T);if(T===r&&(M=d=E,u=v),K&&(a[K]=!0),Gi(r,T)){K&&(l[K]=!0,b[K]=!0,M&&(c[K]=!0));var ie=g[v][K];ie&&T!==r?M||(g[v][K]=K?{disabledReason:1,synced:!0,section:f,visible:ie.visible||!(0,Ne.xj)(T),syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}:{synced:!1,section:f,visible:!1,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}):g[v][K]={synced:!!K,section:f,visible:!(0,Ne.xj)(T),visualContainer:E,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}}}M&&(c=b)}for(var ee in c)delete l[ee];var se=Object.keys(l),ue=dt(null),re=1===se.length?se[0]:ue,Ce=[];for(v=0;v<n.sections.length;v++){var f;m=o.format("SyncGroupPane_SyncCheckboxLabel",[(f=n.sections[v]).displayName]),y=o.format("SyncGroupPane_VisibleCheckboxLabel",[f.displayName]),Ce.push(v===u?{section:f,synced:!!r.syncGroup,visible:!(0,Ne.xj)(r),visualContainer:d,isSourceVisual:!0,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y}:g[v][re]||g[v][ue]||{section:f,synced:!1,visible:!1,syncCheckboxAriaLabel:m,visibleCheckboxAriaLabel:y})}return A.fF.assert(function(){return Ce.length===n.sections.length},"expected a single sync group item for each section"),{state:0,items:Ce,activeSyncGroup:re||e.generateUniqueGroupName(i,r,a)}}(r,n,e,i,o)}(this.sourceVisual.config.singleVisual,this.exploration,this.visualSyncService,this.schema,this.localizationService),c=this.sourceVisual.config.singleVisual;this.pageSyncItems=l.items,this.syncFields=c.syncGroup&&c.syncGroup.fieldChanges,this.syncFilters=c.syncGroup&&c.syncGroup.filterChanges,this.sourceVisualSyncGroup=dt(c),this.activeSyncGroup=l.activeSyncGroup,this.status=l.state}}();function Gi(r,n){if(n.visualType!==r.visualType)return!1;var e=n.query&&n.query.defn&&n.query.defn.select(),i=r.query&&r.query.defn&&r.query.defn.select();return!_.isEmpty(i)&&!_.isEmpty(e)&&i.length===e.length&&(1===i.length?(0,xe.fS)(i[0].expr,e[0].expr):!_.differenceWith(i,e,function(a,l){return(0,xe.fS)(a.expr,l.expr)}).length)}function dt(r){return r&&r.syncGroup&&r.syncGroup.groupName||null}var Hi=s(64647),ri=s(69474),ai=s(8586),pt=s(84281),Nt=s(17328),Ki=s(21024),vt=s(27980),mo=s(64370),yo=s(59968),Co=s(50057),bo=s(54932),Qi=s(35756),Po=s(56011),So=s(86663),Xi=s(21023),Zi=s(24548);function xo(r,n){1&r&&(t.\u0275\u0275elementStart(0,"pbi-pane-section"),t.\u0275\u0275element(1,"legend",4),t.\u0275\u0275elementEnd()),2&r&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("id","syncGroupDescriptionLegend"))}function _o(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",10)(1,"div",21),t.\u0275\u0275listener("click",function(){var c=t.\u0275\u0275restoreView(e).$implicit,u=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(u.navigateAndSelectVisual(c))}),t.\u0275\u0275elementStart(2,"label",22),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",23)(5,"pbi-checkbox",24),t.\u0275\u0275listener("onChange",function(l){var u=t.\u0275\u0275restoreView(e).$implicit,d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.onSyncCheckChanged(u,l))}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(6,"div",23)(7,"pbi-checkbox",25),t.\u0275\u0275listener("onChange",function(l){var u=t.\u0275\u0275restoreView(e).$implicit,d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.onVisibleCheckChanged(u,l))}),t.\u0275\u0275elementEnd()()()}if(2&r){var i=n.$implicit,o=t.\u0275\u0275nextContext(3);t.\u0275\u0275classProp("navigatable",i.visualContainer)("currentPage",i.isSourceVisual),t.\u0275\u0275advance(2),t.\u0275\u0275attribute("title",i.section.displayName)("role",i.visualContainer?"button":null)("tabindex",i.visualContainer?0:null)("aria-label",i.visualContainer?o.ariaNavigateDescription:null),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",i.section.displayName," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("isCompact",!0)("ariaLabel",i.syncCheckboxAriaLabel)("checked",i.synced)("disabled",!!i.disabledReason),t.\u0275\u0275advance(2),t.\u0275\u0275property("isCompact",!0)("ariaLabel",i.visibleCheckboxAriaLabel)("disabled",!!i.disabledReason)("checked",i.visible)}}function Mo(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",26),t.\u0275\u0275element(1,"label",27),t.\u0275\u0275elementStart(2,"input",28),t.\u0275\u0275listener("ngModelChange",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(l.onSourceVisualSyncGroupChanged(a))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"pbi-checkbox",29),t.\u0275\u0275listener("onChange",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(l.onSyncFieldsCheckChanged(a))}),t.\u0275\u0275pipe(4,"localize"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"pbi-checkbox",29),t.\u0275\u0275listener("onChange",function(a){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(l.onSyncFiltersCheckChanged(a))}),t.\u0275\u0275pipe(6,"localize"),t.\u0275\u0275elementEnd()()}if(2&r){var i=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(2),t.\u0275\u0275property("ngModel",i.syncViewModel.sourceVisualSyncGroup),t.\u0275\u0275attribute("aria-label",i.ariaSyncGroupName),t.\u0275\u0275advance(1),t.\u0275\u0275property("isCompact",!0)("disabled",!i.syncViewModel.sourceVisualSyncGroup)("label",t.\u0275\u0275pipeBind1(4,12,"SyncGroupPane_SyncFieldsLabel"))("ariaLabel",i.ariaSyncFieldCheckbox)("checked",i.syncViewModel.syncFields),t.\u0275\u0275advance(2),t.\u0275\u0275property("isCompact",!0)("disabled",!i.syncViewModel.sourceVisualSyncGroup)("label",t.\u0275\u0275pipeBind1(6,14,"SyncGroupPane_SyncFiltersLabel"))("ariaLabel",i.ariaSyncFiltersCheckbox)("checked",i.syncViewModel.syncFilters)}}function Oo(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"pbi-pane-section",5)(1,"pbi-pane-section",6)(2,"legend",7)(3,"span",8),t.\u0275\u0275listener("accessible-click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.syncToAll())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",9)(5,"div",10),t.\u0275\u0275element(6,"div",11),t.\u0275\u0275elementStart(7,"div",12),t.\u0275\u0275element(8,"pbi-icon",13),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"div",12),t.\u0275\u0275element(10,"pbi-icon",14),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(11,_o,8,17,"div",15),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(12,"pbi-pane-section",16)(13,"div",17),t.\u0275\u0275listener("accessible-click",function(){t.\u0275\u0275restoreView(e);var a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.toggleShowAdvancedOptions())}),t.\u0275\u0275element(14,"pbi-icon",18)(15,"legend",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(16,Mo,7,16,"div",20),t.\u0275\u0275elementEnd()()}if(2&r){var i=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(8),t.\u0275\u0275attribute("aria-label",i.ariaSyncDescription),t.\u0275\u0275advance(2),t.\u0275\u0275attribute("aria-label",i.ariaVisibilityDescription),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",i.syncViewModel.pageSyncItems)("ngForTrackBy",i.trackPageSyncItemBy),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("expandedAdvancedOptions",i.showAdvancedOptions),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",i.showAdvancedOptions)}}function wo(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"pbi-pane",1),t.\u0275\u0275listener("onCollapse",function(){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.onPaneCollapsed())})("onToggle",function(){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.onTogglePane())}),t.\u0275\u0275template(1,xo,2,1,"pbi-pane-section",2),t.\u0275\u0275template(2,Oo,17,7,"pbi-pane-section",3),t.\u0275\u0275elementEnd()}if(2&r){var i=n.ngIf,o=t.\u0275\u0275nextContext();t.\u0275\u0275property("expanded",i.isPaneExpanded)("allowToggle",!o.onObject)("title",i.title)("optionsSetting",i.optionsSetting)("ariaDescribedBy","syncGroupDescriptionLegend")("showCollapse",o.onObject),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!o.syncViewModel||0!==o.syncViewModel.status),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",o.syncViewModel&&0===o.syncViewModel.status)}}var Ji=function(){function r(n,e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k,O,E,T){this.conceptualSchemaProxy=n,this.highContrastCssGenerationService=e,this.dataSources=i,this.eventBridge=o,this.explorationActivity=a,this.explorationCapabilities=l,this.explorationNavigation=c,this.explorationSerializer=u,this.featureSwitchService=d,this.telemetryService=g,this.formFactor=v,this.localizationService=f,this.panesVisibility=m,this.selection=y,this.undoRedo=M,this.visualAuthoring=b,this.visualAuthoringOperations=k,this.visualPlugin=O,this.visualSync=E,this.changeDetectorRef=T,this.paneViewModel$=this.panesVisibility.getPanes$().pipe((0,X.U)(function(K){return K.syncSlicers})),this.newPaneColorsEnabled=this.explorationCapabilities.getCapabilities().showFluentDesign||this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.paneColorRefresh,this.initializeHighContrastRules(),this.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1},this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager()}return r.prototype.ngOnInit=function(){var n=this;this.ariaSyncFieldCheckbox=this.localizationService.get("SyncGroupPane_SyncFieldsLabel"),this.ariaSyncFilterCheckbox=this.localizationService.get("SyncGroupPane_SyncFiltersLabel"),this.ariaSyncGroupName=this.localizationService.get("SyncGroupPane_GroupNameLabel"),this.ariaSyncDescription=this.localizationService.get("Sync"),this.ariaVisibilityDescription=this.localizationService.get("Visible"),this.ariaNavigateDescription=this.localizationService.get("SyncGroupPane_NavigateDescription");var e=oi.createObservable(this.subscriptionManager,this.conceptualSchemaProxy,this.dataSources,this.selection,this.visualPlugin,this.visualSync,this.explorationNavigation,this.localizationService);this.viewModelSubscription=e.subscribe(function(i){n.syncViewModel=i,n.changeDetectorRef.markForCheck()})},r.prototype.ngOnDestroy=function(){this.subscriptionManager.unsubscribeAll(),this.viewModelSubscription.unsubscribe()},Object.defineProperty(r.prototype,"onObject",{get:function(){return this.featureSwitchService.featureSwitches.onObject},enumerable:!1,configurable:!0}),r.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .advancedOptionsToggle:focus, .themeableElement .advancedOptionsToggle:focus-within, .themeableElement .advancedOptionsToggle:hover","{ color: @selectedForegroundColor !important; background-color: @selectedBackgroundColor !important; outline: none; }")},r.prototype.getVisibleCheckboxAriaLabel=function(n){return this.localizationService.format("SyncGroupPane_VisibleCheckboxLabel",[n.section.displayName])},r.prototype.syncToAll=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return this.undoRedo.register("SyncToAll",function(){for(var i=0,o=n.syncViewModel.pageSyncItems;i<o.length;i++){var a=o[i];!a.synced&&!a.disabledReason&&n.syncItem(a)}}),[4,this.visualSync.syncFilterState(this.syncViewModel.sourceVisual,!0)];case 1:return e.sent(),[2]}})})},r.prototype.onSyncCheckChanged=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var o=this;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return this.undoRedo.register("Sync changed",function(){e?o.syncItem(n):Yi(o.visualAuthoringOperations,o.eventBridge,n.visualContainer)}),e?[4,this.visualSync.syncFilterState(this.syncViewModel.sourceVisual.config.singleVisual.syncGroup?this.syncViewModel.sourceVisual:n.visualContainer,!0)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},r.prototype.onSyncFieldsCheckChanged=function(n){var e=this;this.undoRedo.register("Sync fields changed",function(){e.visualAuthoringOperations.assignSyncGroup(e.syncViewModel.sourceVisual,(0,p.__assign)((0,p.__assign)({},e.syncViewModel.sourceVisual.config.singleVisual.syncGroup),{fieldChanges:n}))})},r.prototype.onSyncFiltersCheckChanged=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return this.undoRedo.register("Sync fields changed",function(){e.visualAuthoringOperations.assignSyncGroup(e.syncViewModel.sourceVisual,(0,p.__assign)((0,p.__assign)({},e.syncViewModel.sourceVisual.config.singleVisual.syncGroup),{filterChanges:n}))}),n?[4,this.visualSync.syncVisualFiltersState(this.syncViewModel.sourceVisual)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},r.prototype.onVisibleCheckChanged=function(n,e){var i=this;this.undoRedo.register("Visible changed",function(){n.visualContainer?qi(i.visualAuthoringOperations,i.eventBridge,n.visualContainer,e):i.syncItem(n)})},r.prototype.onSourceVisualSyncGroupChanged=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i=this;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return e=!!n,this.undoRedo.register("Sync group changed",function(){e?li(i.visualAuthoringOperations,i.syncViewModel.sourceVisual,n):Yi(i.visualAuthoringOperations,i.eventBridge,i.syncViewModel.sourceVisual)}),e?[4,this.visualSync.syncFilterState(this.syncViewModel.sourceVisual,!0)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},r.prototype.onTogglePane=function(){this.panesVisibility.togglePaneExpansion("syncSlicers")},r.prototype.onPaneCollapsed=function(){this.panesVisibility.setPaneExpansion("syncSlicers",!1)},r.prototype.toggleShowAdvancedOptions=function(){this.showAdvancedOptions=!this.showAdvancedOptions},r.prototype.trackPageSyncItemBy=function(n,e){return e.section.name},r.prototype.navigateAndSelectVisual=function(n){var e=this;this.undoRedo.register("Navigate and select",function(){e.explorationActivity.doRootActivity(function(i){var o=e.syncViewModel.exploration.sections.indexOf(n.section);o<0||!n.visualContainer||(e.explorationNavigation.updateActiveSection({targetSectionIndex:o,parentActivity:i}),me.UP.selectCanvasItem(n.visualContainer,e.selection))},function(){return e.telemetryService.startChildActivity(void 0,Ie.Es)})})},r.prototype.syncItem=function(n){if(n.visualContainer)li(this.visualAuthoringOperations,n.visualContainer,this.syncViewModel.activeSyncGroup);else{var e=(0,Ae.Mt)(this.explorationSerializer.serializeVisualContainer(this.syncViewModel.sourceVisual),this.syncViewModel.exploration,n.section,this.explorationSerializer,this.formFactor,this.visualAuthoring);li(this.visualAuthoringOperations,e,this.syncViewModel.activeSyncGroup)}},r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275directiveInject(Y.i),t.\u0275\u0275directiveInject(Hi.g),t.\u0275\u0275directiveInject(ce.D),t.\u0275\u0275directiveInject(oe.J),t.\u0275\u0275directiveInject(ri.Z),t.\u0275\u0275directiveInject(_t.U),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(ai.L),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(Nt.F),t.\u0275\u0275directiveInject(le.o),t.\u0275\u0275directiveInject(Ki.r),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(pt.z),t.\u0275\u0275directiveInject(pe.$8),t.\u0275\u0275directiveInject(vt.Q),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(mo.M),t.\u0275\u0275directiveInject(t.ChangeDetectorRef))},r.\u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["sync-group-pane"]],decls:2,vars:3,consts:[["focus-nav-mode","Group","disableScroll","","noPadding","","pbiAutoFocus","","keyboard-shortcuts","ctrl-F6","focus-priority","8",3,"expanded","allowToggle","title","optionsSetting","ariaDescribedBy","showCollapse","onCollapse","onToggle",4,"ngIf"],["focus-nav-mode","Group","disableScroll","","noPadding","","pbiAutoFocus","","keyboard-shortcuts","ctrl-F6","focus-priority","8",3,"expanded","allowToggle","title","optionsSetting","ariaDescribedBy","showCollapse","onCollapse","onToggle"],[4,"ngIf"],["class","syncGroupPane","noPadding","",4,"ngIf"],["localize","SyncGroupPane_SelectSlicer",1,"selectionInstructions",3,"id"],["noPadding","",1,"syncGroupPane"],[1,"syncGroupSection"],["localize","SyncGroupPane_Description","localize-fragments","",1,"syncGroupDescription"],["tabindex","0","role","button","fragment-index","0","localize","SyncGroupPane_AddToAll",1,"syncAllButton",3,"accessible-click"],["data-testid","sync-group-table","role","table",1,"syncGroupTable"],["role","row",1,"row"],["role","columnheader","localize","PageName",1,"headerCell","columnPageName","trimmedTextWithEllipsis"],["role","columnheader",1,"headerCell","columnCheckbox"],["size","mini","role","img","name","filtersync","localize-tooltip","Sync"],["role","img","size","mini","name","show","localize-tooltip","Visible",1,"visibility"],["role","row","class","row",3,"navigatable","currentPage",4,"ngFor","ngForOf","ngForTrackBy"],["noPadding","",1,"advancedOptions"],["tabindex","0",1,"advancedOptionsToggle",3,"accessible-click"],["size","mini","name","chevrondownsmall",1,"advancedOptionsCaret"],["localize","AdvancedOptions",1,"advancedOptionsLabel"],["class","advancedOptionsContent",4,"ngIf"],["role","rowheader",1,"bodyCell","columnPageName",3,"click"],[1,"trimmedTextWithEllipsis"],["role","cell",1,"bodyCell","columnCheckbox"],["localize-tooltip","SyncGroupPane_SyncTooltip",3,"isCompact","ariaLabel","checked","disabled","onChange"],["localize-tooltip","SyncGroupPane_VisibleTooltip",3,"isCompact","ariaLabel","disabled","checked","onChange"],[1,"advancedOptionsContent"],["localize","SyncGroupPane_GroupNameLabel",1,"groupNameLabel"],["maxlength","250",1,"groupNameInput",3,"ngModel","ngModelChange"],[1,"syncFieldsCheckbox",3,"isCompact","disabled","label","ariaLabel","checked","onChange"]],template:function(e,i){1&e&&(t.\u0275\u0275template(0,wo,3,8,"pbi-pane",0),t.\u0275\u0275pipe(1,"async")),2&e&&t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(1,1,i.paneViewModel$))},dependencies:[P.NgForOf,P.NgIf,Ee.Fj,Ee.JJ,Ee.nD,Ee.On,yo.X,Co.r,ki.t,bo.r,Qi.q,Po.v,So._,Xi.VO,Zi.i,P.AsyncPipe,je.F],styles:["[_nghost-%COMP%]{display:flex;flex-grow:1;flex-direction:column}.syncGroupPane[_ngcontent-%COMP%]{--sync-slicers-link-color: var(--fluent-theme-link-color, #0078D4);--sync-slicers-link-hover-color: var(--fluent-theme-dark-color, #A98C0C);--sync-slicers-row-hover-background-color: var(--gray-30, #EDEBE9);--sync-slicers-advanced-pane-hover-background-color: var(--gray-30, #EDEBE9);--sync-slicers-input-border-color: var(--gray-120, #797775);--sync-slicers-input-background-color: var(--fluent-theme-white-color, #FFF);--sync-slicers-advanced-button-border-color: var(--gray-40, #E1DFDD);--sync-slicers-table-border-color: var(--gray-60, #C8C6C4);--sync-slicers-table-header-background: var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);--sync-slicers-table-header-border-color: var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4);flex-grow:1;overflow:auto}  [data-legacy-theming=false] .syncGroupPane{--sync-slicers-link-color: var(--colorBrandForegroundLink);--sync-slicers-link-hover-color: var(--colorBrandForegroundLinkHover);--sync-slicers-row-hover-background-color: var(--colorNeutralBackground1Hover);--sync-slicers-advanced-pane-hover-background-color: var(--colorNeutralBackground1Hover);--sync-slicers-input-border-color: var(--colorNeutralStroke1);--sync-slicers-input-background-color: var(--colorNeutralBackground1);--sync-slicers-advanced-button-border-color: var(--colorNeutralStroke1);--sync-slicers-table-border-color: var(--colorNeutralStroke1);--sync-slicers-table-header-background: var(--colorNeutralBackground1);--sync-slicers-table-header-border-color: var(--colorNeutralStroke1)}.syncGroupPane[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%], .syncGroupPane[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:default}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupSection[_ngcontent-%COMP%]{display:flex;flex-direction:column}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupDescription[_ngcontent-%COMP%]{margin-bottom:4px}.syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]{color:var(--sync-slicers-link-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:hover, .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus{cursor:pointer;text-decoration:underline}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=mouse][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus, html[data-focus-source=program][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]:focus{outline:none}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]{border:1px solid var(--sync-slicers-table-border-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:focus-within{background:var(--fluent-theme-neutral-secondary-color, #605E5C)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]:hover{background:var(--sync-slicers-row-hover-background-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{cursor:pointer;color:var(--sync-slicers-link-color)}html[data-focus-source][_ngcontent-%COMP%]:not([data-focus-source=key])   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:focus, html[data-focus-source][_ngcontent-%COMP%]:not([data-focus-source=key])   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]:focus{outline:none}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{color:var(--sync-slicers-link-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]:hover{color:var(--sync-slicers-link-hover-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell[_ngcontent-%COMP%]{height:20px;border-style:solid;border-width:0 0 1px 1px;background:var(--sync-slicers-table-header-background);border-color:var(--sync-slicers-table-header-border-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell.columnPageName[_ngcontent-%COMP%]{text-align:left;cursor:default}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell[_ngcontent-%COMP%]   pbi-icon.visibility[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{font-size:13px}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .bodyCell[_ngcontent-%COMP%]{border-left:1px solid var(--fluent-theme-neutral-secondary-color, #605E5C);padding:2px 0}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnCheckbox[_ngcontent-%COMP%], .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnVisible[_ngcontent-%COMP%]{width:24px;display:flex;align-items:center;justify-content:center;flex:0 0 auto}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;border-left:0;overflow:hidden;white-space:nowrap}.syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1;display:block;padding-left:2px}.syncGroupPane[_ngcontent-%COMP%]   pbi-checkbox[_ngcontent-%COMP%]{margin-bottom:0}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;margin-top:12px}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsContent[_ngcontent-%COMP%]{padding:8px}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsCaret[_ngcontent-%COMP%]{transform:rotate(-90deg);transition:transform .25s ease-out;display:flex}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]{height:36px;padding:4px 4px 4px 12px;display:flex;align-items:center;border:1px solid var(--sync-slicers-advanced-button-border-color);border-style:solid none;cursor:pointer}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:hover{background:var(--sync-slicers-advanced-pane-hover-background-color)}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html[data-focus-source=mouse][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus, html[data-focus-source=program][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus{outline:none}.syncGroupPane[_ngcontent-%COMP%]   .expandedAdvancedOptions[_ngcontent-%COMP%]   .advancedOptionsCaret[_ngcontent-%COMP%]{transform:rotate(0)}.syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsLabel[_ngcontent-%COMP%]{display:inline;margin-left:8px;cursor:pointer}.syncGroupPane[_ngcontent-%COMP%]   .groupNameLabel[_ngcontent-%COMP%]{white-space:normal}.syncGroupPane[_ngcontent-%COMP%]   .groupNameInput[_ngcontent-%COMP%]{display:block;width:100%;height:24px;margin-top:8px;padding-left:4px;border:1px solid var(--sync-slicers-input-border-color);background:var(--sync-slicers-input-background-color)}.syncGroupPane[_ngcontent-%COMP%]   .groupNameInput[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.syncGroupPane[_ngcontent-%COMP%]   .syncFieldsCheckbox[_ngcontent-%COMP%]{margin-top:8px}html[data-focus-source=key][_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncFieldsCheckbox[_ngcontent-%COMP%]:focus-within{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncAllButton[_ngcontent-%COMP%]{color:var(--fluent-theme-link-color, #0078D4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]{border-color:var(--gray-60, #C8C6C4)}html[data-focus-source=key][_ngcontent-%COMP%]   .newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:focus-within{background:var(--gray-30, #EDEBE9)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.navigatable[_ngcontent-%COMP%]:hover{background:var(--gray-30, #EDEBE9)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]{color:var(--fluent-theme-link-color, #0078D4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .row.currentPage[_ngcontent-%COMP%]   .columnPageName[_ngcontent-%COMP%]:hover{color:var(--fluent-theme-dark-color, #A98C0C)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .headerCell[_ngcontent-%COMP%]{background:var(--gray-40, #E1DFDD);border-color:var(--gray-60, #C8C6C4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .syncGroupTable[_ngcontent-%COMP%]   .bodyCell[_ngcontent-%COMP%]{border-color:var(--gray-60, #C8C6C4)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsContent[_ngcontent-%COMP%]{background:var(--gray-20, #F3F2F1)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]{border-color:var(--gray-40, #E1DFDD)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:hover, .newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus, .newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .advancedOptionsToggle[_ngcontent-%COMP%]:focus-within{background:var(--gray-30, #EDEBE9)}.newPaneColors.explorationContainer[_ngcontent-%COMP%]   .syncGroupPane[_ngcontent-%COMP%]   .groupNameInput[_ngcontent-%COMP%]{background:var(--fluent-theme-white-color, #FFF);border-color:var(--gray-60, #C8C6C4)}"],changeDetection:0}),r}();function Yi(r,n,e){r.clearSyncGroup(e),qi(r,n,e,!0)}function qi(r,n,e,i){r.setVisibility(e,!i,!0),r.notifyVisualContainers([e]),n.publishToChannel(B.cyb,{changedItems:[e]})}function li(r,n,e){var i=n.config.singleVisual.syncGroup;r.assignSyncGroup(n,i?(0,p.__assign)((0,p.__assign)({},i),{groupName:e}):{groupName:e,fieldChanges:!0,filterChanges:!0})}s(92160);var Eo=s(59787),en=s(22318),Ze=s(23558),Vo=s(77526),Do=s(6181),To=s(73805),ye=s(9215),Io=s(23224),Je=s(10556),tn=s(65195),Ao=s(9500),Bo=s(7475),ko=s(95281),Pe=s(85732);function nn(r){return me.UP.getSelectedCanvasItems(r)}function si(r,n){return!_.isEmpty(r)&&_.every(r,function(e){return(0,ye.Vz)(e)&&n.isQueryVisual((0,R.s)(e))})}function ci(r,n){return!_.isEmpty(r)&&_.every(r,function(e){return(0,ye.Vz)(e)&&n.canConvertVisual(e)})}function on(r){return!_.isEmpty(r)&&_.every(r,function(n){return(0,R.s)(n)===(0,R.s)(r[0])})}function rn(r,n){return!_.isEmpty(r)&&_.every(r,function(e){return(0,ye.Vz)(e)&&n.isSupportedVisual(e)})}var Be=function(n){return n.active},Lo=function(n){return n.alwaysPopulatePanes},an=function(n){return n.availableSectionTypes},zo=function(n){return n.isEditing},Rt=function(n){return n.selectedVisuals},ln=function(r){function n(e,i,o){var a=r.call(this)||this;return a.featureSwitchService=e,a.localizationService=i,a.visualPluginOps=o,a.updateState=a.updater(function(l,c){return(0,p.__assign)((0,p.__assign)({},l),c)}),a.getProperty=function(l){return(0,Pe.P1)(function(c){return c},function(c){return c[l]})},a.populatePanes=(0,Pe.P1)(zo,Lo,function(l,c){return l||c}),a.header=(0,Pe.P1)(a.populatePanes,Rt,function(l,c){var u,d,g=(u=(0,ye.rQ)(c))[0],v=u[1];if(l&&!_.isEmpty(g)&&_.isEmpty(v)){var f=(0,R.s)(g[0]),m=on(g)?f:null;m&&(m===J.L.basicShape.name||m===J.L.shape.name?d="VisualizationPane_Shape":m===J.L.image.name?d="VisualizationPane_Image":m===J.L.textbox.name?d="VisualizationPane_Text_Box":m===J.L.actionButton.name?d="VisualizationPane_Action_Button":(m===J.L.pageNavigator.name||m===J.L.bookmarkNavigator.name)&&(d="VisualizationPane_Navigator"))}return d??(a.featureSwitchService.featureSwitches.onObject?"Format":"VisualizationPane_Title")}),a.showVisualTypes=(0,Pe.P1)(a.populatePanes,Rt,Be,function(l,c,u){var d,g;if(_.isEmpty(c))g=l&&0===u;else{var v=(d=(0,ye.rQ)(c))[0];g=l&&(!_.isEmpty(d[1])||ci(v,a.visualPluginOps))&&0===u}return g}),a.sections=(0,Pe.P1)(an,function(l){return a.loadSectionDetails(l)}),a.showFieldWellOrFilters=(0,Pe.P1)(Be,function(l){return 0===l}),a.showFieldWell=(0,Pe.P1)(a.populatePanes,Be,function(l,c){return l&&0===c}),a.showPropertyPane=(0,Pe.P1)(a.populatePanes,Be,Rt,function(l,c,u){return!_.isEmpty(u)&&l&&1===c}),a.showPagePropertyPane=(0,Pe.P1)(a.populatePanes,Be,Rt,function(l,c,u){return _.isEmpty(u)&&l&&3===c}),a.showAnalyticsPane=(0,Pe.P1)(a.populatePanes,Be,function(l,c){return l&&2===c}),a.showDrillthroughPane=(0,Pe.P1)(a.showFieldWellOrFilters,function(l){return l}),a.showBuildSection=(0,Pe.P1)(a.showVisualTypes,a.showFieldWellOrFilters,function(l,c){return!a.featureSwitchService.featureSwitches.onObject&&(l||c)}),a.activeSectionIndex=(0,Pe.P1)(Be,an,function(l,c){return c.findIndex(function(u){return u===l})}),a}return(0,p.__extends)(n,r),n.prototype.setVisualizationPaneViewModelState=function(e){this.setState(e)},n.prototype.select$=function(e){return this.select(this.getProperty(e))},n.prototype.loadSectionDetails=function(e){var i=this;return e.map(function(a){return i.getSectionDetails(a)})},n.prototype.getSectionDetails=function(e){var i,o="_paneColorRefresh";switch(e){case 0:i={sectionType:e,displayName:this.localizationService.get("VisualizationPane_Section_Fields"),cssClass:"fields",normalSvg:"",styledSvg:""};break;case 1:i={sectionType:e,displayName:this.localizationService.get("Format"),cssClass:"format",normalSvg:"",styledSvg:""};break;case 2:i={sectionType:e,displayName:this.localizationService.get("VisualizationPane_Section_Analytics"),cssClass:"analytics",normalSvg:"",styledSvg:""};break;case 3:i={sectionType:e,displayName:this.localizationService.get("Page"),cssClass:"page",normalSvg:"",styledSvg:""};break;default:A.fF.assertNever(e)}return i.normalSvg="visualizationPane".concat(_.upperFirst(i.cssClass),"Modern").concat(o),i.styledSvg="visualizationPane".concat(_.upperFirst(i.cssClass),"ModernSelected").concat(o),i},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(le.o),t.\u0275\u0275inject(Ve.f))},n.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(ko.m1),sn=s(21302),No=s(94130),Ro=s(22885),jo=s(43025),Wo=s(84144),Uo=s(43859),$o=s(32441),Go=s(53240),Ho=s(64713),Ko=s(2380),Qo=s(11991),Xo=s(26124),Zo=function(r){function n(e,i){return r.call(this,e,i)||this}return(0,p.__extends)(n,r),n.prototype.ngOnInit=function(){var e=this;this.changes$("pbiEmphasisOpacity").pipe((0,Le.w)(function(o){return o||Tt.E})).subscribe(function(){var o=e.getAnimation("opacity",1);e.emphasize(o)})},n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(Xo._j,8),t.\u0275\u0275directiveInject(t.ElementRef))},n.\u0275dir=t.\u0275\u0275defineDirective({type:n,selectors:[["","pbiEmphasisOpacity",""]],inputs:{pbiEmphasisOpacity:"pbiEmphasisOpacity"},features:[t.\u0275\u0275InheritDefinitionFeature]}),n}(Qo.A),Jo=s(47808),Yo=d3.easeCubic,qo=d3.select,er=["svgPathElement"];function tr(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"div",10),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"localize"),t.\u0275\u0275elementEnd()),2&r){var e=n.ngIf;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,1,e)," ")}}var ir=function(n,e){return{currentSection:n,sections:e,rootAttribute:"focus-pivot-root",pivotAttribute:"focus-pivot"}};function nr(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"pbi-button-toggle",11),t.\u0275\u0275listener("pointerenter",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.styledSvg,!0,!0))})("pointerleave",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.styledSvg,!1,!0))})("onFocus",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.normalSvg,!0,!1))})("onBlur",function(){var d=t.\u0275\u0275restoreView(e).$implicit,g=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(g.toggleEffectClasses(d.normalSvg,!1,!1))})("valueChanged",function(u){var g=t.\u0275\u0275restoreView(e).$implicit,v=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(v.sectionSelectEvent.fn({value:g.sectionType,checked:u}))})("onActiveSection",function(u){t.\u0275\u0275restoreView(e);var d=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(d.sectionSelectEvent.fn({value:u.nextSection.sectionType,checked:!0}))}),t.\u0275\u0275elementStart(2,"div",12)(3,"div",13),t.\u0275\u0275element(4,"pbi-svg-use-symbol",14)(5,"pbi-svg-use-symbol",15),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementContainerEnd()}if(2&r){var i=n.$implicit,o=n.ngForOf,a=t.\u0275\u0275nextContext(2).ngIf,l=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("role","tab")("checked",i.sectionType===a.active)("value",i.sectionType)("aria-label",l.ariaLabels[i.sectionType])("buttonTabIndex",i.sectionType===a.active?0:-1)("pivot-tab-key-handler",t.\u0275\u0275pureFunction2(15,ir,i,o)),t.\u0275\u0275attribute("data-testid","visualization-pane-tab-"+i.sectionType),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("selected",i.sectionType===a.active),t.\u0275\u0275property("pbiTooltip",l.tooltips[i.sectionType]),t.\u0275\u0275attribute("data-unique-id",i.sectionType),t.\u0275\u0275advance(2),t.\u0275\u0275property("sheet",l.sectionIconSheetName)("symbolId",i.normalSvg),t.\u0275\u0275advance(1),t.\u0275\u0275property("sheet",l.sectionIconSheetName)("symbolId",i.styledSvg)}}function or(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"div",16,17)(2,"div",18),t.\u0275\u0275namespaceSVG(),t.\u0275\u0275elementStart(3,"svg",19,20),t.\u0275\u0275pipe(5,"async"),t.\u0275\u0275element(6,"path",21,22),t.\u0275\u0275elementEnd(),t.\u0275\u0275namespaceHTML(),t.\u0275\u0275elementStart(8,"div",23),t.\u0275\u0275element(9,"div",24)(10,"div",25),t.\u0275\u0275elementEnd()()()),2&r){var e=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(3),t.\u0275\u0275attribute("transform",t.\u0275\u0275pipeBind1(5,1,e.isRTL$)?"scale(-1, 1)":null)}}function rr(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"pbi-pane-divider"),t.\u0275\u0275template(1,tr,3,3,"div",6),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275elementStart(3,"pbi-button-toggle-group",7),t.\u0275\u0275template(4,nr,6,18,"ng-container",8),t.\u0275\u0275pipe(5,"async"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(6,or,11,3,"div",9),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext().ngIf,i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(2,4,i.sectionTitle$)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(5,6,i.sections$))("ngForTrackBy",i.trackBySectionTypeFn),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.showIndicator(e.availableSectionTypes))}}function ar(r,n){if(1&r&&(t.\u0275\u0275element(0,"build-section",29),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275pipe(3,"async"),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275pipe(5,"async")),2&r){var e=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("disableScrollbar",e.isWholePaneScrollable)("showVisualTypes",t.\u0275\u0275pipeBind1(1,9,e.showVisualTypes$))("showFieldWell",t.\u0275\u0275pipeBind1(2,11,e.showFieldWell$))("showDrillthroughPane",t.\u0275\u0275pipeBind1(3,13,e.showDrillthroughPane$))("showFieldWellOrFilters",t.\u0275\u0275pipeBind1(4,15,e.showFieldWellOrFilters$))("populatePanes",t.\u0275\u0275pipeBind1(5,17,e.populatePanes$))("visualPluginFilter",e.paneViewModel.visualPluginFilter)("nonPersonalVisualizationPaneFilter",e.paneViewModel.nonPersonalVisualizationPaneFilter)("showNonPersonalVisuals",e.showNonPersonalVisualizationPane())}}function lr(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"section",30),t.\u0275\u0275element(1,"formatting-pane-lazy",31),t.\u0275\u0275elementEnd()),2&r){var e=n.ngIf,i=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("id","toggle-group-tab-panel3"),t.\u0275\u0275advance(1),t.\u0275\u0275property("formattingSources",e.formattingSources)("disableScrollbar",i.isWholePaneScrollable)}}function sr(r,n){if(1&r&&(t.\u0275\u0275elementStart(0,"pbi-pane-section",26),t.\u0275\u0275template(1,ar,6,19,"build-section",27),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275template(3,lr,2,3,"section",28),t.\u0275\u0275pipe(4,"async"),t.\u0275\u0275elementEnd()),2&r){var e=t.\u0275\u0275nextContext().ngIf,i=t.\u0275\u0275nextContext();t.\u0275\u0275property("hidden",!e.isPaneExpanded),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(2,3,i.showBuildSection$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(4,5,i.formattingPaneModel$))}}function cr(r,n){if(1&r){var e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",2),t.\u0275\u0275listener("resizing",function(l){t.\u0275\u0275restoreView(e);var c=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(c.onResizing(l))}),t.\u0275\u0275elementStart(1,"pbi-pane",3),t.\u0275\u0275listener("onToggle",function(){var c=t.\u0275\u0275restoreView(e).ngIf,u=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(u.onPaneExpanded.emit(!c.isPaneExpanded))})("onCollapse",function(){t.\u0275\u0275restoreView(e);var l=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(l.onPaneCollapsed())}),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275template(3,rr,7,8,"pbi-pane-divider",4),t.\u0275\u0275template(4,sr,5,7,"pbi-pane-section",5),t.\u0275\u0275elementEnd()()}if(2&r){var i=n.ngIf,o=t.\u0275\u0275nextContext();t.\u0275\u0275classProp("isCollapsed",!i.isPaneExpanded),t.\u0275\u0275property("pbiEmphasisBackground",o.emphasize$)("pbiEmphasisBackgroundColor","var(--globalColorBrand160)"),t.\u0275\u0275advance(1),t.\u0275\u0275property("expanded",i.isPaneExpanded)("title",t.\u0275\u0275pipeBind1(2,12,o.header$))("allowToggle",!o.onObject)("optionsSetting",o.paneViewModel.optionsSetting)("disableScroll",!o.isWholePaneScrollable)("showCollapse",o.onObject),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!o.onObjectOn&&i.isPaneExpanded),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isPaneExpanded)}}var ur=["M0 8.5H16L24 1L32 8.5H180","M0 8.5H82L90 1L98 8.5H180","M0 8.5H148L156 1L164 8.5H180"],dn=function(r){function n(e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k,O,E){var T=r.call(this)||this;return T.promiseFactory=e,T.directionality=i,T.eventBridge=o,T.explorationNavigation=a,T.favoriteVisualLoader=l,T.featureSwitchService=c,T.globalEventBridge=u,T.highContrastCssGenerationService=d,T.localizationService=g,T.paneVisibilityService=v,T.selection=f,T.svgProviderService=m,T.telemetryService=y,T.viewModeState=M,T.visualizationPaneService=b,T.visualPaneSettingsService=k,T.visualPlugin=O,T.visualPluginOps=E,T.onPaneExpanded=new t.EventEmitter,T.isWholePaneScrollable=window.innerWidth<640||window.innerHeight<360,T.preparePersonalVisualizationPane(),T.initializeHighContrastRules(),T.onObjectOn=T.featureSwitchService.featureSwitches.onObject,T.channelSubscriptions=o.createChannelSubscriptionManager(),T.channelSubscriptions.subscribe(sn.sn,function(){T.visualizationPaneService.updateState({isPaneExpanded:!0,active:1}),T.paneVisibilityService.isPaneExpanded("format")||T.paneVisibilityService.togglePaneExpansion("format")}),T.channelSubscriptions.subscribe(sn.mF,function(){T.selection.clearSelection(),T.visualizationPaneService.updateState({isPaneExpanded:!0,active:3}),T.paneVisibilityService.isPaneExpanded("format")||T.paneVisibilityService.togglePaneExpansion("format")}),T.onDestroy$.subscribe(function(K){K&&T.channelSubscriptions.unsubscribeAll()}),T}return(0,p.__extends)(n,r),n.prototype.ngOnInit=function(){var e=this;this.setInitialState(),this.initSelectors(),this.initExpansionHandler(),this.initEventHandlers(),this.ariaLabels=this.buildAriaLabels(),this.tooltips=this.buildTooltips();var i=this.isEditing$.pipe((0,X.U)(function(v){return{isEditing:v}})),o=this.alwaysPopulatePanes$.pipe((0,X.U)(function(v){return{alwaysPopulatePanes:v}})),a=this.mergeSelectedVisualType$.pipe((0,X.U)(function(v){return{selectedVisuals:v.selectedVisuals,visualType:v.visualType}})),l=this.availableSectionTypes$.pipe((0,X.U)(function(v){return{availableSectionTypes:v}})),c=this.active$.pipe((0,X.U)(function(v){return{active:v.active,previous:v.previous}})),u=this.isPaneExpanded$.pipe((0,X.U)(function(v){return{isPaneExpanded:v}})),d=this.isPaneVisible$.pipe((0,X.U)(function(v){return{isPaneVisible:v}})),g=(0,D.T)(i,o,a,l,c,u,d);this.visualizationPaneService.updateState(g),this.isRTL$=this.directionality.change.pipe((0,en.O)(this.directionality.value),(0,X.U)(function(v){return"rtl"===v})),this.emphasize$=this.paneVisibilityService.getPaneEmphasis$("format"),(0,Eo.R)(window,"resize").subscribe(function(v){var f=window.innerWidth,m=window.innerHeight;e.isWholePaneScrollable=f<640||m<360})},n.prototype.ngAfterViewInit=function(){var e=this;this.svgPathElement$=this.svgPathElements.changes.pipe((0,X.U)(function(o){return o.first}),(0,en.O)(this.svgPathElements.first),(0,X.U)(function(o){return o&&qo(o.nativeElement)}));var i=this.svgPathElement$.pipe((0,Le.w)(function(o){return o?e.activeSectionIndex$:Tt.E}));(0,D.T)(i,this.svgPathElement$.pipe((0,V.h)(function(o){return!!o}))).pipe((0,Ze.M)(i,this.svgPathElement$),(0,Vo.x)()).subscribe(function(o){return e.changePath(o[2],o[1])}),this.svgProviderService.toggleCssClasses(!0,"active",this.sectionIconSheetName,this.defaultSectionSelectedSVG)},Object.defineProperty(n.prototype,"onObject",{get:function(){return this.featureSwitchService.featureSwitches.onObject},enumerable:!1,configurable:!0}),n.prototype.onPaneCollapsed=function(){this.paneVisibilityService.setPaneExpansion("format",!1)},n.prototype.showNonPersonalVisualizationPane=function(){var e=this;return _.some(this.visualPlugin.getConvertibleVisuals(),function(i){if(!i)return!1;var o=!1,a=e.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.custom&&e.visualPaneSettingsService.isFavoritePublicCustomVisual(i.name),l=e.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.custom&&i.favoriteId||a,c=e.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.custom&&!i.favoriteId&&!a,u=e.featureSwitchService.featureSwitches.tenantOutOfBoxVisualsEnabled&&i.custom&&i.isOutOfBox,d=e.featureSwitchService.featureSwitches.personalVisualizationPaneEnabled&&e.visualPaneSettingsService.isUnpinnedVisual(i.name);return(i.custom&&!u&&c||d&&!l)&&(o=!0),o})},n.prototype.preparePersonalVisualizationPaneServices=function(){var e=this,i=[];return this.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&i.push(this.favoriteVisualLoader.ensureFavoriteVisualResources(this.visualPlugin)),this.featureSwitchService.featureSwitches.tenantOutOfBoxVisualsEnabled&&i.push(this.favoriteVisualLoader.ensureOutOfBoxVisuals(this.visualPlugin)),this.promiseFactory.allSettled(i).finally(function(){if(e.featureSwitchService.featureSwitches.personalVisualizationPaneEnabled)return e.visualPaneSettingsService.updateVisuals()})},n.prototype.preparePersonalVisualizationPane=function(){var e=this;this.preparePersonalVisualizationPaneServices().finally(function(){e.eventBridge.publishToChannel(B.Udu)})},n.prototype.initSelectors=function(){var e=this.visualizationPaneService;this.activeSectionIndex$=e.select(e.activeSectionIndex),this.populatePanes$=e.select(e.populatePanes),this.showFieldWell$=e.select(e.showFieldWell),this.showAnalyticsPane$=e.select(e.showAnalyticsPane),this.showDrillthroughPane$=e.select(e.showDrillthroughPane),this.showPropertyPane$=e.select(e.showPropertyPane),this.showPagePropertyPane$=e.select(e.showPagePropertyPane),this.showVisualTypes$=e.select(e.showVisualTypes),this.showFieldWellOrFilters$=e.select(e.showFieldWellOrFilters),this.showBuildSection$=e.select(e.showBuildSection),this.header$=e.select(e.header),this.sections$=e.select(e.sections),this.sectionTitle$=e.select(Be).pipe((0,X.U)(function(l){switch(l){case 3:return"Format_Page";case 1:return"Format_Visual";case 0:return"Build_Visual";case 2:return"VisualizationPane_Section_Analytics";default:return void A.fF.assertNever(l)}}));var i=this.showAnalyticsPane$.pipe((0,X.U)(function(l){return l?{formattingSources:["Analytics"]}:void 0})),o=this.showPagePropertyPane$.pipe((0,X.U)(function(l){return l?{formattingSources:["Page"]}:void 0})),a=this.showPropertyPane$.pipe((0,X.U)(function(l){return l?{formattingSources:["Visual","Format_Label_General"]}:void 0}));this.formattingPaneModel$=(0,Fe.aj)([i,o,a]).pipe((0,X.U)(function(l){return l.find(function(c){return!_.isUndefined(c)})}))},n.prototype.initEventHandlers=function(){var e=this,i=this.visualizationPaneService,o=i.select$("selectedVisuals"),a=i.select$("active"),l=i.select$("availableSectionTypes");this.isEditing$=this.viewModeState.getMode$().pipe((0,I.R)(this.onDestroy$),(0,X.U)(function(v){return 1===v})),this.isEditing$.pipe((0,I.R)(this.onDestroy$)).subscribe(function(v){v&&e.updateExplorationVisuals()}),this.alwaysPopulatePanes$=this.viewModeState.getConfig$().pipe((0,Do.j)("alwaysPopulatePanes"),(0,I.R)(this.onDestroy$),(0,X.U)(function(v){return v})),this.mergeSelectedVisualType$=(0,D.T)(this.eventBridge.on(B.tRg),this.eventBridge.on(B.KD7)).pipe((0,I.R)(this.onDestroy$),(0,X.U)(function(v){var f,m=nn(e.selection),y=null,M=(f=(0,ye.rQ)(m))[0],b=f[1];if(!_.isEmpty(M)&&_.isEmpty(b)){var k=(0,R.s)(M[0]);on(M)&&(y=k)}return{selectedVisuals:m,visualType:y}}));var c=this.globalEventBridge.on(Io.U.SignInStatusChangedEvent);c.pipe((0,I.R)(this.onDestroy$)).subscribe(function(v){e.favoriteVisualLoader.reset(e.visualPlugin),e.visualPaneSettingsService.reset()}),(0,D.T)(this.eventBridge.on(Bo.nR),c).pipe((0,I.R)(this.onDestroy$)).subscribe(function(v){e.preparePersonalVisualizationPane()}),this.availableSectionTypes$=this.mergeSelectedVisualType$.pipe((0,Ze.M)(o),(0,X.U)(function(v){var f,y=v[1],M=[];if(_.isEmpty(y))e.featureSwitchService.featureSwitches.onObject||M.push(0),M.push(3);else{var b=(f=(0,ye.rQ)(y))[0],k=f[1],O=ci(y,e.visualPluginOps);(si(y,e.visualPluginOps)||O||!_.isEmpty(k))&&(e.featureSwitchService.featureSwitches.onObject||M.push(0),_.every(b,function(K){return e.visualPluginOps.canFormatVisual(K)})&&(M.push(1),e.featureSwitchService.featureSwitches.onObject||M.push(2)))}return M})),this.sectionSelectEvent=this.createEventAdapter();var u=this.sectionSelectEvent.$.pipe((0,V.h)(function(v){return v.checked}),(0,Ze.M)(l),(0,X.U)(function(v){var f=v[0];return v[1].find(function(y){return y===f.value})})),d=(0,D.T)(this.eventBridge.on(B.cY_),this.eventBridge.on(B.x4H)).pipe((0,Ze.M)(o),(0,V.h)(function(v){return si(v[1],e.visualPluginOps)}),(0,To.h)(this.featureSwitchService.featureSwitches.onObject?1:2)),g=this.mergeSelectedVisualType$.pipe((0,Ze.M)(o,a),(0,X.U)(function(v){var b,y=v[1],M=v[2],k=e.featureSwitchService.featureSwitches.onObject?3:0;if(_.isEmpty(y))b=k;else{var E=(0,ye.rQ)(y)[1],T=si(y,e.visualPluginOps),K=ci(y,e.visualPluginOps);b=!_.isEmpty(E)||T||K?3===M?1:M:rn(y,e.visualPluginOps)?1:k}return b}));this.active$=(0,D.T)(u,d,g).pipe((0,Ze.M)(a),(0,X.U)(function(v){return{active:v[0],previous:v[1]}})),(0,Fe.aj)([this.active$,this.sections$]).subscribe(function(v){var f=v[0],m=v[1],y=f.active,M=f.previous,b=m.find(function(O){return O.sectionType===y}),k=m.find(function(O){return O.sectionType===M});k&&(e.svgProviderService.toggleCssClasses(!1,"active",e.sectionIconSheetName,k.styledSvg),e.svgProviderService.toggleCssClasses(!1,"focus",e.sectionIconSheetName,k.normalSvg)),b&&e.svgProviderService.toggleCssClasses(!0,"active",e.sectionIconSheetName,b.styledSvg)})},n.prototype.initExpansionHandler=function(){var e=this,i=this.paneVisibilityService.getPanes$().pipe((0,X.U)(function(a){var l;return null===(l=a.format)||void 0===l?void 0:l.isPaneExpanded})),o=this.onPaneExpanded.asObservable();this.isPaneExpanded$=(0,D.T)(o,i),this.isPaneVisible$=this.paneVisibilityService.getPanes$().pipe((0,X.U)(function(a){var l;return null===(l=a.format)||void 0===l?void 0:l.isPaneVisible})),o.pipe((0,I.R)(this.onDestroy$)).subscribe(function(a){e.telemetryService.logEvent(Je.vLR,{paneType:"Visualization",expanded:a,viewMode:(0,Ao.ku)(e.viewModeState.getMode())}),e.paneVisibilityService.togglePaneExpansion("format")})},n.prototype.setInitialState=function(){this.sectionIconSheetName="visualizationPaneIcons_paneColorRefresh",this.defaultSectionSelectedSVG="visualizationPaneFieldsModernSelected_paneColorRefresh",this.viewModelStore$=this.visualizationPaneService.state$,this.svgProviderService.loadSheet(this.sectionIconSheetName);var e=nn(this.selection),i=_.isEmpty(e)?[3]:[1],o=0,a=rn(e,this.visualPluginOps);this.featureSwitchService.featureSwitches.onObject?o=a?1:3:(i.unshift(0),a&&i.push(2)),this.visualizationPaneService.setVisualizationPaneViewModelState({active:o,previous:o,availableSectionTypes:i,isPaneVisible:this.paneVisibilityService.isPaneVisible("format"),isPaneExpanded:this.paneVisibilityService.isPaneExpanded("format"),selectedVisuals:e})},n.prototype.changePath=function(e,i){i>=0&&i<=2&&e.transition().duration(200).ease(Yo).attr("d",ur[i])},n.prototype.updateExplorationVisuals=function(){this.visualPaneSettingsService.resetExplorationVisuals();var e=this.explorationNavigation.getCurrentExploration();if(e)for(var i=0,o=e.sections;i<o.length;i++)for(var l=0,c=o[i].visualContainers;l<c.length;l++)this.visualPaneSettingsService.addExplorationVisual(c[l].config.singleVisual.visualType)},n.prototype.showIndicator=function(e){return!!(e&&e.length>0)},n.prototype.buildAriaLabels=function(){var e;return(e={})[0]=this.localizationService.get("Build_Visual"),e[1]=this.localizationService.get("Format_Visual"),e[2]=this.localizationService.get("VisualizationPane_Section_Analytics"),e[3]=this.localizationService.get("Format_Page"),e},n.prototype.buildTooltips=function(){var e;return(e={})[0]=this.localizationService.get("VisualizationPane_Section_Build_Visual_Description"),e[1]=this.localizationService.get("VisualizationPane_Section_Format_Visual_Description"),e[2]=this.localizationService.get("VisualizationPane_Section_Analytics_Button_Description"),e[3]=this.localizationService.get("VisualizationPane_Section_Format_Page_Description"),e},n.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".visualization-pane pbi-button-toggle-group .outer.selected","{ background-color: @selectedBackgroundColor !important; }")},n.prototype.toggleEffectClasses=function(e,i,o){this.svgProviderService.toggleCssClasses(i,o?tn.Cj:tn.PG,this.sectionIconSheetName,e)},n.prototype.trackBySectionTypeFn=function(e,i){return i.sectionType},Object.defineProperty(n.prototype,"paneSectionClass",{get:function(){return this.isWholePaneScrollable?"pane-section paneScrollable":"pane-section paneNotScrollable"},enumerable:!1,configurable:!0}),n.\u0275fac=function(i){return new(i||n)(t.\u0275\u0275directiveInject(we.t),t.\u0275\u0275directiveInject(No.Is),t.\u0275\u0275directiveInject(oe.J),t.\u0275\u0275directiveInject(q.z),t.\u0275\u0275directiveInject(Ro.W),t.\u0275\u0275directiveInject(ae.vZ),t.\u0275\u0275directiveInject(jo.Z),t.\u0275\u0275directiveInject(Hi.g),t.\u0275\u0275directiveInject(le.o),t.\u0275\u0275directiveInject(Ki.r),t.\u0275\u0275directiveInject(fe.z),t.\u0275\u0275directiveInject(Wo.g),t.\u0275\u0275directiveInject(ve.y0),t.\u0275\u0275directiveInject(Fi.kc),t.\u0275\u0275directiveInject(ln),t.\u0275\u0275directiveInject(it.R),t.\u0275\u0275directiveInject(he.D),t.\u0275\u0275directiveInject(Ve.f))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["visualization-pane-modern"]],viewQuery:function(i,o){var a;(1&i&&t.\u0275\u0275viewQuery(er,5),2&i)&&(t.\u0275\u0275queryRefresh(a=t.\u0275\u0275loadQuery())&&(o.svgPathElements=a))},hostVars:2,hostBindings:function(i,o){2&i&&t.\u0275\u0275attribute("data-automation-type","visualizationPane")("data-testid","visualization-pane")},inputs:{paneViewModel:"paneViewModel"},outputs:{onPaneExpanded:"onPaneExpanded"},features:[t.\u0275\u0275ProvidersFeature([ln,{provide:Bi.yk,useValue:{source:"Pane",paneType:"format"}}]),t.\u0275\u0275InheritDefinitionFeature],decls:3,vars:4,consts:[["class","visualization-pane","data-automation-type","visualizationPaneGroup","keyboard-shortcuts","ctrl-F6","focus-priority","12","focus-nav-mode","Group",3,"isCollapsed","pbiEmphasisBackground","pbiEmphasisBackgroundColor","resizing",4,"ngIf"],[1,"emphasis-border",3,"pbiEmphasisOpacity"],["data-automation-type","visualizationPaneGroup","keyboard-shortcuts","ctrl-F6","focus-priority","12","focus-nav-mode","Group",1,"visualization-pane",3,"pbiEmphasisBackground","pbiEmphasisBackgroundColor","resizing"],["role","region","overlayScrollbar","","noPadding","",3,"expanded","title","allowToggle","optionsSetting","disableScroll","showCollapse","onToggle","onCollapse"],[4,"ngIf"],["class","pane-section","noPadding","",3,"hidden",4,"ngIf"],["class","section-title",4,"ngIf"],["role","tablist","focus-pivot-root",""],[4,"ngFor","ngForOf","ngForTrackBy"],["class","select-button-indicator",4,"ngIf"],[1,"section-title"],["pbiTooltipCheckChildren","true","focus-pivot","",3,"role","checked","value","aria-label","buttonTabIndex","pivot-tab-key-handler","pointerenter","pointerleave","onFocus","onBlur","valueChanged","onActiveSection"],[1,"outer",3,"pbiTooltip"],[1,"content"],[1,"normal-svg",3,"sheet","symbolId"],[1,"styled-svg",3,"sheet","symbolId"],[1,"select-button-indicator"],["custom",""],[1,"divider-component"],["width","180","height","9","viewBox","0 0 180 9","fill","none","xmlns","http://www.w3.org/2000/svg",1,"select-indicator-bar"],["svgElement",""],["d","M0 8.5H16L24 1L32 8.5H180"],["svgPathElement",""],[1,"filler"],[1,"space"],[1,"line"],["noPadding","",1,"pane-section",3,"hidden"],["class","pane-content",3,"disableScrollbar","showVisualTypes","showFieldWell","showDrillthroughPane","showFieldWellOrFilters","populatePanes","visualPluginFilter","nonPersonalVisualizationPaneFilter","showNonPersonalVisuals",4,"ngIf"],["class","pane-content","role","tabpanel","section-animation-slider","",3,"id",4,"ngIf"],[1,"pane-content",3,"disableScrollbar","showVisualTypes","showFieldWell","showDrillthroughPane","showFieldWellOrFilters","populatePanes","visualPluginFilter","nonPersonalVisualizationPaneFilter","showNonPersonalVisuals"],["role","tabpanel","section-animation-slider","",1,"pane-content",3,"id"],["data-testid","formatting-pane-lazy",3,"formattingSources","disableScrollbar"]],template:function(i,o){1&i&&(t.\u0275\u0275template(0,cr,5,14,"div",0),t.\u0275\u0275pipe(1,"async"),t.\u0275\u0275element(2,"div",1)),2&i&&(t.\u0275\u0275property("ngIf",t.\u0275\u0275pipeBind1(1,2,o.viewModelStore$)),t.\u0275\u0275advance(2),t.\u0275\u0275property("pbiEmphasisOpacity",o.emphasize$))},dependencies:[P.NgForOf,P.NgIf,Jt.R,Uo.H,$o.u,Qi.q,Go.I,Ho.J,Ko.O,Zo,Xi.VO,Jo.P,Zi.i,Li.R,ot.V,$i,P.AsyncPipe,je.F],styles:['[_nghost-%COMP%]{display:flex;height:100%}.emphasis-border[_ngcontent-%COMP%]{border:1px solid var(--globalColorBrand80);position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;opacity:0;pointer-events:none}.visualization-pane[_ngcontent-%COMP%]{--viz-pane-selected-button-background: var(--gray-50, #D2D0CE);--viz-pane-button-hover-background: var(--gray-40, #E1DFDD);--viz-pane-button-hover-outline-color: var(--gray-110, #8A8886);--viz-pane-selected-svg-line-color: var(--gray-110, #8A8886);--viz-pane-selected-line-color: var(--gray-70, #BEBBB8);--icon-fill-color: var(--theme-primary-color);--icon-stroke-color: #252423;overflow:hidden;flex-grow:1}  [data-legacy-theming=false] .visualization-pane{--viz-pane-selected-button-background: var(--colorNeutralBackground1);--viz-pane-button-hover-background: var(--colorNeutralBackground1Hover);--viz-pane-button-hover-outline-color: var(--colorNeutralStroke1Hover);--viz-pane-selected-svg-line-color: var(--colorNeutralStroke1);--viz-pane-selected-line-color: var(--colorNeutralStroke1);--icon-fill-color: var(--colorCompoundBrandStroke);--icon-stroke-color: var(--colorNeutralStrokeAccessible)}.visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-ms-user-select:none;user-select:none}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-right:8px}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]{display:flex;padding:4px 0}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{cursor:pointer;border-radius:2px;border:none;padding:4px}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]   .normal-svg[_ngcontent-%COMP%]{display:block}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]   .styled-svg[_ngcontent-%COMP%]{display:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer.selected[_ngcontent-%COMP%]{background:var(--viz-pane-selected-button-background)}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer.selected[_ngcontent-%COMP%]   .normal-svg[_ngcontent-%COMP%]{display:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer.selected[_ngcontent-%COMP%]   .styled-svg[_ngcontent-%COMP%]{display:block}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:hover{outline:var(--focus-outline-definition, 2.5px solid) var(--viz-pane-button-hover-outline-color);background:var(--viz-pane-button-hover-background)}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:hover   .normal-svg[_ngcontent-%COMP%]{display:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:hover   .styled-svg[_ngcontent-%COMP%]{display:block}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]:focus{outline:none}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle-group[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{height:24px;width:24px;display:flex;justify-content:center}.visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]{flex:none}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]{margin-right:34px}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]{margin-left:34px}html[data-focus-source="key"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:focus-within   .content[_ngcontent-%COMP%], html[data-focus-source="key"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:focus-within   .content[_ngcontent-%COMP%]{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child, html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child, html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:first-child{margin-right:8px}html:not([dir="rtl"])[_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child, html:not([dir="rtl"])   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child{margin-right:0}html[dir="rtl"][_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child, html[dir="rtl"]   [_nghost-%COMP%]   .visualization-pane[_ngcontent-%COMP%]   pbi-button-toggle[_ngcontent-%COMP%]:last-child{margin-left:0}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]{display:block;padding-bottom:4px}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]{display:flex;width:100%}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .select-indicator-bar[_ngcontent-%COMP%]{flex:none}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .select-indicator-bar[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{stroke:var(--viz-pane-selected-svg-line-color)}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .filler[_ngcontent-%COMP%]{height:9px;display:flex;flex-direction:column;flex-grow:1}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .filler[_ngcontent-%COMP%]   .space[_ngcontent-%COMP%]{height:8px}.visualization-pane[_ngcontent-%COMP%]   .select-button-indicator[_ngcontent-%COMP%]   .divider-component[_ngcontent-%COMP%]   .filler[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{height:1px;background:var(--viz-pane-selected-line-color)}.visualization-pane[_ngcontent-%COMP%]   .pane-section[_ngcontent-%COMP%], .visualization-pane[_ngcontent-%COMP%]   .pane-section[_ngcontent-%COMP%]   .pane-content[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.visualization-pane[_ngcontent-%COMP%]   .pane-section[_ngcontent-%COMP%]   .pane-content[_ngcontent-%COMP%]   formatting-pane-lazy[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.visualization-pane[_ngcontent-%COMP%]   .paneScrollable[_ngcontent-%COMP%]{height:"100%"}.visualization-pane[_ngcontent-%COMP%]   .paneNotScrollable[_ngcontent-%COMP%]{height:unset}']}),n}(F.w),dr=s(49080),pr=s(17966),vr=s(19276),ge=s(49702),Re=s(23306),pn=s(35497),gr={provide:"bookmarkAuthoringService",useFactory:function(r,n,e,i,o,a,l,c,u,d,g){return new fr(r,n,e,i,o,l,c,u,a,d,g)},deps:[pr.F,Y.i,ce.D,oe.J,vr.j,dr.J,le.o,zt.g,fe.z,ve.y0,pt.z]},fr=function(){function r(n,e,i,o,a,l,c,u,d,g,v){this.bookmarkService=n,this.conceptualSchemaProxy=e,this.dataSources=i,this.eventBridge=o,this.explorationStateApplier=a,this.localizationService=l,this.screenReaderService=c,this.selection=u,this.stateManager=d,this.telemetryService=g,this.undoRedoService=v}return r.prototype.create=function(n,e,i,o){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,l,c,u,d,g;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return a=f.sent(),e?[3,3]:(l={captureAllSections:!1,suppressDataSourceVariables:!0,capturePresentation:!1},_.assign(l,o),[4,this.stateManager.capture(a,l)]);case 2:e=f.sent(),f.label=3;case 3:return c=this.bookmarkService.getBookmarks(),u=c?c.length+1:1,d=n||this.localizationService.get("Generic_Bookmark")+" ".concat(u),g=this.generateBookmarkName(),i||(i=this.updateTargetVisualsOptions({})),[2,{displayName:d,name:g,explorationState:e,options:i}]}})})},r.prototype.add=function(n,e,i,o){return void 0===o&&(o=!0),(0,p.__awaiter)(this,void 0,void 0,function(){var a,l,c=this;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return[4,this.create(n,e,i)];case 1:return a=u.sent(),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 2:return l=u.sent(),this.undoRedoService.register(ge.U.Add,function(){c.bookmarkService.setBookmarks((0,Re.IH)(c.bookmarkService.getBookmarks(),a)),o&&(c.bookmarkService.setActiveBookmark(a),e&&c.applyBookmarkState(a,l)),c.telemetryService.logEvent(Je.Dbt)}),this.screenReaderService.alertPolite(this.localizationService.format("CreatedItem",a.displayName)),[2,a]}})})},r.prototype.remove=function(n){var e=this,i=this.getBookmark(n);A.fF.assert(function(){return ge.J.isValidBookmark(i)},"Invalid bookmark"),this.undoRedoService.register(ge.U.Remove,function(){var o=(0,Re.Od)(i,e.bookmarkService.getBookmarks());e.bookmarkService.setBookmarks(o);var a=e.bookmarkService.getActiveBookmark();a&&i.name===a.name&&e.bookmarkService.setActiveBookmark(null),e.telemetryService.logEvent(Je.FQA)})},r.prototype.move=function(n,e,i,o){var a=this;void 0===i&&(i=!1),"number"==typeof n&&"number"==typeof e&&(i=n<e);var l=this.getBookmark(n),c=this.getBookmark(e);A.fF.assert(function(){return ge.J.isValidBookmark(l)},"Invalid source bookmark"),A.fF.assert(function(){return ge.J.isValidBookmark(c)},"Invalid target bookmark"),this.undoRedoService.register(ge.U.Move,function(){a.bookmarkService.setBookmarks((0,Re.pB)([l],c,a.bookmarkService.getBookmarks(),i))})},r.prototype.rename=function(n,e){var i=this,o=this.getBookmark(n);A.fF.assert(function(){return ge.J.isValidBookmark(o)},"Invalid bookmark"),A.fF.assert(function(){return!_.isEmpty(e)},"Bookmark name can't be empty"),this.undoRedoService.register(ge.U.Rename,function(){o.displayName=e,i.bookmarkService.emitUpdatedBookmarks()})},r.prototype.update=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o,a=this;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return e=this.getBookmark(n),A.fF.assert(function(){return ge.J.isValidBookmark(e)},"Invalid bookmark"),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return i=l.sent(),[4,this.stateManager.capture(i,{captureAllSections:!1})];case 2:return o=l.sent(),this.undoRedoService.register(ge.U.Update,function(){a.bookmarkService.setActiveBookmark(e),e.explorationState=o,e.options=a.updateTargetVisualsOptions(e.options),a.telemetryService.logEvent(Je.m_M)}),[2]}})})},r.prototype.ungroup=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return A.fF.assert(function(){return ge.J.isValidBookmark(n)},"Invalid bookmark"),[4,this.undoRedoService.register(ge.U.Ungroup,function(){e.bookmarkService.setBookmarks((0,Re.Z8)(n,e.bookmarkService.getBookmarks()))})];case 1:return i.sent(),[2]}})})},r.prototype.group=function(n){var e=this;A.fF.assert(function(){return!_.isEmpty(n)},"Bookmarks to group should not be empty");var i=this.createBookmarkGroup(n);this.undoRedoService.register(ge.U.Group,function(){e.bookmarkService.setBookmarks((0,Re.ru)(i,e.bookmarkService.getBookmarks()))})},r.prototype.getBookmark=function(n){return"number"==typeof n?this.bookmarkService.getBookmarks()[n]:n},r.prototype.generateBookmarkName=function(){var n={};return _.each(this.bookmarkService.getBookmarks(),function(e){n[e.name]=!0}),pn.q.generateUniqueId(n)},r.prototype.createBookmarkGroup=function(n){var e=_.filter(this.bookmarkService.getBookmarks(),function(c){return ge.J.isBookmarkGroup(c)}),i=e?e.length+1:1;return{displayName:this.localizationService.get("Group")+" ".concat(i),name:this.generateBookmarkName(),children:n}},r.prototype.updateTargetVisualsOptions=function(n){n||(n={});for(var e=me.UP.getSelectedCanvasItems(this.selection),i=[],o=[],a=0,l=e;a<l.length;a++){var c=l[a];i.push(c.name),(0,ye.q4)(c)&&o.push(c)}return _.isEmpty(o)||(0,ye.Iw)(o,function(u){return i.push(u.name)}),n.targetVisualNames=_.uniq(i),n},r.prototype.applyBookmarkState=function(n,e,i){A.fF.assertValue(n,"bookmark");var o={clearUnmatchedData:!0,suppressDataSourceVariables:!0};if(_.assign(o,i),!ge.J.isBookmarkGroup(n)){var a=this.explorationStateApplier.createApplyBookmarkActivity("AddReportBookmark");try{n.options&&(o.suppressData=n.options.suppressData,o.suppressActiveSection=n.options.suppressActiveSection,o.suppressDisplay=n.options.suppressDisplay,n.options.applyOnlyToTargetVisuals&&(o.targetVisualNames=n.options.targetVisualNames));var l=this.applyState(a,n.explorationState,e,o);return this.eventBridge.publishToChannel(B.gG5,{bookmarkName:n.name}),this.telemetryService.logEvent(Je.LPp,{bookmarkName:n.name}),a.resolve(),l}catch(c){a.reject(c)}}},r.prototype.applyState=function(n,e,i,o){return this.explorationStateApplier.applyDirty(e,i,o,n)},r}(),ui=s(40033),gt=s(80),br={provide:"canvasListOrderingService",useFactory:function(r,n,e,i){return new Promise(function(o){o(new Pr(r,n,e,i))})},deps:[ui.F,pe.$8,vt.Q,Nt.F]},Pr=function(){function r(n,e,i,o){this.canvasListOrderNormalizeService=n,this.visualAuthoring=e,this.visualAuthoringOperations=i,this.formFactor=o}return r.prototype.getListOrderPropertyFunction=function(n,e){var i=this.formFactor.getCurrentLayout();return n.layouts.withId(i).position[e]},r.prototype.insertAtMinMagnitude=function(n,e,i,o,a,l){var c=this;if(!_.isEmpty(e)){var u=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(v){return c.getListOrderPropertyFunction(v,o)});this.insertAtMinMagnitudeInternal(e,u,i,o,a,l);var d=_.concat(n,e);if(u=this.canvasListOrderNormalizeService.getContainerListOrders(d,function(v){return c.getListOrderPropertyFunction(v,o)}),this.canvasListOrderNormalizeService.shouldNormalizeListOrder(u,i)){var g=this.canvasListOrderNormalizeService.normalizeListOrder(u,i);a?this.visualAuthoringOperations.updateContainerListOrders(d,g,o):this.visualAuthoring.updateContainerListOrders(d,g,o)}}},r.prototype.insertAtMinMagnitudeInternal=function(n,e,i,o,a,l){var v,c=this,u=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(y){return c.getListOrderPropertyFunction(y,o)}),d=this.canvasListOrderNormalizeService.getSortedContainerNames(u,l?!i:i),g=this.canvasListOrderNormalizeService.getSortedContainerNames(e,i);v=g.length?e[_.head(g)]:i?gt.RT:gt.Wp;var f=this.convertsMagnitude(gt.oZ,!i),m={};this.canvasListOrderNormalizeService.settingListOrder(m,d,v+=f,f),a?this.visualAuthoringOperations.updateContainerListOrders(n,m,o):this.visualAuthoring.updateContainerListOrders(n,m,o)},r.prototype.convertsMagnitude=function(n,e){return e?n:-n},r.prototype.bringToFront=function(n,e,i,o,a){var l=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(d){return l.getListOrderPropertyFunction(d,o)});this.moveAfterIndexInternal(n,n.length-1,c,e,i,o,a)}},r.prototype.bringForward=function(n,e,i,o,a){var l=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return l.getListOrderPropertyFunction(u,o)});this.groupSequentialContainers(n,e,c,function(u,d,g){var v=g+1;return _.map(u,function(f){return{afterContainerIndex:v,containerName:f}})},i,o,a)}},r.prototype.sendToBack=function(n,e,i,o,a){var l=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return l.getListOrderPropertyFunction(u,o)});this.moveBeforeIndexInternal(n,0,c,e,i,o,a)}},r.prototype.sendBackward=function(n,e,i,o,a){var l=this;if(!_.isEmpty(e)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return l.getListOrderPropertyFunction(u,o)});this.groupSequentialContainers(n,e,c,function(u,d,g){var v=d-1;return _.map(u,function(f){return{beforeContainerIndex:v,containerName:f}})},i,o,a)}},r.prototype.moveAfter=function(n,e,i,o,a){var l=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return l.getListOrderPropertyFunction(g,a)}),u=this.findContainerIndex(e,c,o),d=_.union(n,i);this.moveAfterIndexInternal(d,u,c,i,o,a)}},r.prototype.moveAfterIndex=function(n,e,i,o,a){var l=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return l.getListOrderPropertyFunction(u,a)});this.moveAfterIndexInternal(n,e,c,i,o,a)}},r.prototype.shouldNormalize=function(n,e,i){var o=this,a=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return o.getListOrderPropertyFunction(g,i)}),l=this.canvasListOrderNormalizeService.shouldNormalizeListOrder(a,e);if(!l)for(var c=0,u=n;c<u.length;c++){var d=u[c];if((0,ye.q4)(d)&&(l=this.shouldNormalize(d.children,e,i)))break}return l},r.prototype.normalize=function(n,e,i){var o=this,a=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return o.getListOrderPropertyFunction(g,i)}),l=this.canvasListOrderNormalizeService.normalizeListOrder(a,e);this.visualAuthoringOperations.updateContainerListOrders(n,l,i);for(var c=0,u=n;c<u.length;c++){var d=u[c];(0,ye.q4)(d)&&this.normalize(d.children,e,i)}},r.prototype.moveAfterIndexInternal=function(n,e,i,o,a,l,c){var u=this.buildOperations(o,i,a,function(d){return{containerName:d.name,afterContainerIndex:e}});this.movecanvasItems(n,u,i,a,l,c)},r.prototype.moveBefore=function(n,e,i,o,a){var l=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(g){return l.getListOrderPropertyFunction(g,a)}),u=this.findContainerIndex(e,c,o),d=_.union(n,i);this.moveBeforeIndexInternal(d,u,c,i,o,a)}},r.prototype.moveBeforeIndex=function(n,e,i,o,a){var l=this;if(!_.isEmpty(i)){var c=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(u){return l.getListOrderPropertyFunction(u,a)});this.moveBeforeIndexInternal(n,e,c,i,o,a)}},r.prototype.moveBeforeIndexInternal=function(n,e,i,o,a,l,c){var u=this.buildOperations(o,i,a,function(d){return{containerName:d.name,beforeContainerIndex:e}});this.movecanvasItems(n,u,i,a,l,c)},r.prototype.findContainerIndex=function(n,e,i){var o=this.canvasListOrderNormalizeService.getSortedContainerNames(e,i);return _.findIndex(o,function(a){return a===n.name})},r.prototype.movecanvasItems=function(n,e,i,o,a,l){for(var c=this.canvasListOrderNormalizeService.getSortedContainerNames(i,o),u=[],d={},g={},v=gt.oZ,f=function(E){var T=E.containerName;A.fF.assert(function(){return!d[T]},"VisualContainer is used in multiple operations");var K=void 0,ie=void 0,ee=void 0;!function(r){return null!=r.afterContainerIndex}(E)?function(r){return null!=r.beforeContainerIndex}(E)?(K=(ie=Math.max(E.beforeContainerIndex,0))-1,ee=m.convertsMagnitude(v,!o)):A.fF.assertFail("Unknown operation type"):(ie=(K=Math.min(E.afterContainerIndex,c.length-1))+1,ee=m.convertsMagnitude(v,o));var se=m.getAfterContainerListOrderPropertyNumber(u,c,i,K),ue=m.getBeforeContainerListOrderPropertyNumber(c,i,ie),re=null!=se,Ce=null!=ue;(!re||!Ce)&&(!re&&Ce?se=ue+ee:re&&!Ce?ue=se+ee:A.fF.assertFail("Could not find afterListOrderNumber and beforeListOrderNumber"));var N=(ue+se)/2;A.fF.assert(function(){return o?se<N:N<se},"afterListOrderNumber is not less than insertionListOrderNumber if range is positive, insertionListOrderNumber is not less than afterListOrderNumber if range is negative"),A.fF.assert(function(){return o?ue>N:N>ue},"beforeListOrderNumber is not greater than insertionListOrderNumber if range is positive, insertionListOrderNumber is not greater than beforePrderNumber if range is negative"),u[K]=N,g[T]=N},m=this,y=0,M=e;y<M.length;y++)f(M[y]);var k=_.extend({},i,g);this.canvasListOrderNormalizeService.shouldNormalizeListOrder(k,o)&&(k=this.canvasListOrderNormalizeService.normalizeListOrder(k,o)),l?this.visualAuthoringOperations.updateContainerListOrders(n,k,a):this.visualAuthoring.updateContainerListOrders(n,k,a)},r.prototype.getAfterContainerListOrderPropertyNumber=function(n,e,i,o){var a=n[o];if(null==a){var l=e[o];l&&(a=i[l])}return a},r.prototype.getBeforeContainerListOrderPropertyNumber=function(n,e,i){return e[n[i]]},r.prototype.groupSequentialContainers=function(n,e,i,o,a,l,c){for(var M,u=this,d=this.canvasListOrderNormalizeService.getSortedContainerNames(i,a),g=_.zipObject(_.map(e,function(E){return E.name}),_.map(e,function(){return!0})),v=e.length,f=0,m=0,y=0,b=0;b<d.length;b++){var k=d[b];if(g[k]){if(M?M.push(k):(M=[k],m=b),++f===v){y=b;break}}else if(M){var O=o(M,m,y=b-1);this.movecanvasItems(n,O,i,a,l),i=this.canvasListOrderNormalizeService.getContainerListOrders(n,function(E){return u.getListOrderPropertyFunction(E,l)}),M=null}}M&&(O=o(M,m,y),this.movecanvasItems(n,O,i,a,l,c))},r.prototype.buildOperations=function(n,e,i,o){var a=i?"asc":"desc";return _.chain(n).map(o).orderBy(function(l){return e[l.containerName]},a).value()},r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275inject(ui.F),t.\u0275\u0275inject(pe.$8),t.\u0275\u0275inject(vt.Q),t.\u0275\u0275inject(Nt.F))},r.\u0275prov=t.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),vn=s(26902),Sr=s(25740),gn=s(58938),_r={provide:"dataBarsDialogLauncherService",useFactory:function(r,n,e,i){return new Mr(r,n,e,i)},deps:[gn.x,le.o,ve.y0,pe.$8]},Mr=function(){function r(n,e,i,o){this.dialogService=n,this.localizationService=e,this.telemetryService=i,this.visualAuthoring=o}return r.prototype.show=function(n,e,i,o,a,l){return(0,p.__awaiter)(this,void 0,void 0,function(){var c,u,d,g,f,m=this;return(0,p.__generator)(this,function(y){switch(y.label){case 0:return c=(0,vn.aI)(n.config.singleVisual,i),u={dataBarsSettings:c,colorPalette:(0,Sr.NO)(o)},d=this.localizationService.get("Visual_ConditionalFormatting_DataBars"),g={title:"".concat(d," - ").concat(e),input:u,hideOkButton:!1,hideCancelButton:!1},[4,this.dialogService.showTemplateDialog("DataBarsDialog",g,{height:"668px",width:"426px"})];case 1:return(f=y.sent()).afterClosed().subscribe(function(M){M&&m.setDataBars(M.dataBars,n,i,a,l)}),[2,f]}})})},r.prototype.setDataBars=function(n,e,i,o,a){var l=(0,vn.ac)(n,o);this.visualAuthoring.addDataBars(e,i,l),this.telemetryService.logEvent(Je.QBi,{visualType:(0,R.s)(e),userValueSpecified:void 0!==n.minValue||void 0!==n.maxValue,fromPropertyPane:a,visualName:e.name})},r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275inject(gn.x),t.\u0275\u0275inject(le.o),t.\u0275\u0275inject(ve.y0),t.\u0275\u0275inject(pe.$8))},r.\u0275prov=t.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),hn=s(52298),fn=s(57871),_e=s(78417),Or=s(83400),wr=s(71216),jt=s(43286),Fr={provide:"explorationAuthoring",useFactory:function(r,n,e,i,o,a,l,c,u,d){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(g){return[2,new Vr(r,n,e,i,o,a,l,c,u,d)]})})},deps:[oe.J,ri.Z,q.z,ai.L,ae.vZ,hn.e,le.o,we.t,ve.y0,pt.z]},Vr=function(){function r(n,e,i,o,a,l,c,u,d,g){this.eventBridge=n,this.explorationNavigation=i,this.featureSwitchService=a,this.linguisticSchemaProxy=l,this.promiseFactory=u,this.undoRedo=g,this.explorationAuthoringOps=new Dr(e,i,o,c,d)}return r.prototype.renameSection=function(n,e,i){var o=this,a=n.exploration.contract,l=a.sections[i].name;this.undoRedo.register("RenameNavigationTab",function(){o.explorationAuthoringOps.renameSection(n,e,i),(0,_e.D6)(a,l,e,o.linguisticSchemaProxy,!1).then(function(){o.eventBridge.publishToChannel(B.TTT,{sectionName:e,sectionIndex:i})})})},r.prototype.createSection=function(n,e,i,o,a){var l=this;this.undoRedo.register("CreateSection",function(){l.explorationAuthoringOps.createSection(n,e,i,o,a)})},r.prototype.duplicateSection=function(n,e){var i=this;this.undoRedo.register("DuplicateSection",function(){var o=i.explorationAuthoringOps.duplicateSection(n,e);(0,_e.bx)(n.exploration.contract,o,e,i.linguisticSchemaProxy,i.promiseFactory).then(function(){i.explorationAuthoringOps.insertSection(n,o)})})},r.prototype.deleteSection=function(n,e,i){var o=this,a=function(){var c=n.exploration.contract;(0,_e.Og)(c,c.sections[e].name,o.linguisticSchemaProxy).then(function(){o.explorationAuthoringOps.deleteSection(n,e),o.eventBridge.publishToChannel(B.HGU,{sectionIndex:e})})};i?this.undoRedo.register("DeleteSection",function(){a()}):a()},r.prototype.insertSection=function(n,e){var i=this;this.undoRedo.register("InsertSection",function(){i.explorationAuthoringOps.insertSection(n,e)})},r.prototype.setSectionVisibility=function(n,e){var i=this;this.undoRedo.register("SetSectionVisibility",function(){i.explorationAuthoringOps.setSectionVisibility(n,e)})},r.prototype.reorderSection=function(n,e,i){var o=this;this.undoRedo.register("ReorderSection",function(){o.explorationAuthoringOps.reorderSection(n,e,i)})},r.prototype.setSectionType=function(n,e,i,o){var a=this,l=function(){0===i?a.explorationAuthoringOps.clearSectionType(e,~i):a.explorationAuthoringOps.setSectionType(e,i),(0,_e.TJ)(n,e.name,(0,_e.wj)(e,a.featureSwitchService.featureSwitches.onObject))};o?l():this.undoRedo.register("SetSectionType",l)},r.prototype.clearSectionType=function(n,e,i){var o=this;0!==i?this.undoRedo.register("ClearSectionType",function(){o.explorationAuthoringOps.clearSectionType(e,i),(0,_e.TJ)(n,e.name,(0,_e.wj)(e,o.featureSwitchService.featureSwitches.onObject))}):A.fF.assertFail('Can not clear a "Regular" default section state')},r.prototype.setDrillthroughFilterPassingMode=function(n,e,i){var o=this;this.undoRedo.register("setDrillthroughFilterPassingMode",function(){o.explorationAuthoringOps.setDrillthroughFilterPassingMode(n,e,i)})},r.prototype.setCrossReportDrillthrough=function(n,e,i,o){var a=this;void 0===o&&(o=!0),o?this.undoRedo.register("setCrossReportDrillthrough",function(){a.explorationAuthoringOps.setCrossReportDrillthrough(n,e,i)}):this.explorationAuthoringOps.setCrossReportDrillthrough(n,e,i)},r.prototype.setDataSourceVariables=function(n,e){var i=this;void 0===e&&(e=this.explorationNavigation.getCurrentExploration()),A.fF.assertValue(e,"contract"),this.undoRedo.register("setDataSourceVariables",function(){i.explorationAuthoringOps.setDataSourceVariables(e,n),i.eventBridge.publishToChannel(B.jCS,{affectContainer:_.stubTrue})})},r.prototype.setCanvasDisplay=function(n){this.eventBridge.publishToChannel(B.Pkb,n)},(0,p.__decorate)([(0,p.__param)(7,(0,t.Inject)(we.t)),(0,p.__metadata)("design:paramtypes",[oe.J,ri.Z,q.z,ai.L,ae.vZ,hn.e,le.o,Object,ve.y0,pt.z])],r)}(),Dr=function(){function r(n,e,i,o,a){this.explorationActivity=n,this.explorationNavigation=e,this.explorationSerializer=i,this.localization=o,this.telemetryService=a}return r.prototype.renameSection=function(n,e,i){var o=n.exploration;o.contract.sections[i].displayName=e;var a=o.sections;a[i].displayName=e,a[i].isTabEditable=!1,this.explorationNavigation.emitUpdatedSections()},r.prototype.duplicateSection=function(n,e){var i=n.exploration.contract;A.fF.assert(function(){return e<=i.sections.length},"Expected target index should be less than or equals sections length.");var o=this.explorationSerializer.serializePage(i.sections[e],1),a=this.explorationSerializer.deserializePage(o,{enableVisualContainerGrouping:i.settings&&i.settings.useStylableVisualContainerHeader});return a.name=mn(i),(0,Or.gs)(a,n.exploration.contract.sections),a.displayName=this.localization.format("DuplicateSectionName_StartingText",[a.displayName]),a},r.prototype.insertSection=function(n,e){var i=this;this.explorationActivity.doRootActivity(function(o){e.id=void 0,e.objectId=void 0;var l=n.exploration.contract.sections;l.push(e),n.exploration.sections.push((0,H.Iu)(e,i.localization));var u=l.length-1;i.explorationNavigation.updateActiveSection({targetSectionIndex:u,forceUpdate:n.sectionStatus.currentSectionNumber===u,parentActivity:o}),i.explorationNavigation.emitUpdatedSections()},function(){return i.telemetryService.startChildActivity(void 0,Ie.$0)})},r.prototype.deleteSection=function(n,e){var i=this;this.explorationActivity.doRootActivity(function(o){var a=n.exploration.contract;if(e>-1&&a&&e<a.sections.length){var l=a.sections[e];a.sections.splice(e,1);var c=n.exploration.sections,u=c[e];u&&u.contract===l&&c.splice(e,1);var d=n.sectionStatus.currentSectionNumber;if(d===e){var g=e;g>=a.sections.length&&(g=a.sections.length-1),i.explorationNavigation.updateActiveSection({targetSectionIndex:g,forceUpdate:d===g,suppressHistory:!0,parentActivity:o})}else{var f=e>d?d:d-1;n.sectionStatus.currentSectionNumber=f,a.activeSectionIndex=f}}i.explorationNavigation.emitUpdatedSections()},function(){return i.telemetryService.startChildActivity(void 0,Ie.yw)})},r.prototype.createSection=function(n,e,i,o,a){var l=n.exploration.contract;i||(i={displayOption:1,width:fn.$z,height:fn.az});var c={name:mn(l),displayName:a||(0,wr.Vk)(l.sections,this.localization),size:i,objects:o,visualContainers:[],visualContainerGroups:[],filters:[],acceptsAllFiltersWhenLinked:void 0,howCreated:e??"Default",isNew:!0};this.insertSection(n,c),this.explorationNavigation.emitUpdatedSections()},r.prototype.reorderSection=function(n,e,i){if(e<0||i<0)return!1;var o=!1,a=n.exploration.contract.sections,l=a[e];a.splice(e,1),a.splice(i,0,l);var c=n.exploration.sections,u=c[e];u&&u.contract===l&&(c.splice(e,1),c.splice(i,0,u),o=!0);for(var d=c.length-1;d>=0;--d)if(c[d].selected){n.sectionStatus.currentSectionNumber=d;break}return this.explorationNavigation.emitUpdatedSections(),o},r.prototype.setSectionVisibility=function(n,e){n.visibility=e,this.explorationNavigation.emitUpdatedSections()},r.prototype.setSectionType=function(n,e){A.fF.assert(function(){return!((0,jt.yE)(e,2)&&(0,jt.yE)(e,1))},"Tooltip and Drillthrough types cannot co-exist!"),(0,jt.yE)(e,2)&&this.clearSectionType(n,1),(0,jt.yE)(e,1)&&this.clearSectionType(n,2),n.type|=e,this.explorationNavigation.emitUpdatedSections()},r.prototype.clearSectionType=function(n,e){n.type&=~e,this.explorationNavigation.emitUpdatedSections()},r.prototype.setDrillthroughFilterPassingMode=function(n,e,i){(0,_e.rF)(n,e.name,(0,_e.Js)(i))},r.prototype.setCrossReportDrillthrough=function(n,e,i){(0,_e.kt)(n,e.name,(0,_e.zO)(i))},r.prototype.setDataSourceVariables=function(n,e){n.dataSourceVariables=e},r}();function mn(r){var n=_.map(r.sections,function(i){return i.name}),e=_.zipObject(n,_.map(n,function(){return!0}));return pn.q.generateUniqueId(e)}var Tr=s(49092),Ir=s(88565),Ar=s(77435),Br=s(93658),kr=s(28107),Lr=s(33163),zr=function(){function r(){}return r.prototype.exportToExcel=function(n,e){A.fF.assertValue(n,"exportToExcelRequest"),A.fF.assertValue(e,"requestOptions"),A.fF.assertFail("ExportToExcelProxy code path should only be through webExploration")},r.\u0275prov=t.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac=function(e){return new(e||r)},providedIn:"root"}),r}(),Nr=s(73875),Rr=s(82755),yn=s(28326),Wt=s(80777),di='"',pi=",",jr="yyyy-MM-dd HH:mm:ss",Wr="'";function Ur(r,n,e){var i,o=r.table;if(!o)return"";var a=o.columns;A.fF.assertValue(a,"columns metadata is null");var l="",c=0;(null==e||e>o.rows.length)&&(e=o.rows.length);for(var u=0;u<e;u++){var d=o.rows[u],g=[];d.length>c&&(c=d.length);for(var v=0,f=d.length;v<f;v++){var m=a[v],y=m&&m.type,M=(0,Rr.NA)(null===(i=d.objects)||void 0===i?void 0:i[v],n);g.push(Gr(d[v],y,M||m&&m.format))}g.length>0&&(l+=g.join(pi)+"\r\n")}return l=function(r,n){(n<=0||n>r.length)&&(n=r.length);for(var e=[],i=0;i<n;i++)e.push(Cn(r[i].displayName));return e.join(pi)}(a,c)+"\r\n"+l,l}function Gr(r,n,e){return null==r?"":(n||(n=function(r){return A.fF.assertValue(r,"value"),_.isDate(r)?Wt.Ge.fromPrimitiveTypeAndCategory(6):_.isBoolean(r)?Wt.Ge.fromPrimitiveTypeAndCategory(5):_.isNumber(r)?Wt.Ge.fromPrimitiveTypeAndCategory(3):Wt.Ge.fromPrimitiveTypeAndCategory(1)}(r)),Cn(n.dateTime?yn.dx.formatValue(r,jr):n.bool||n.numeric&&!e?r.toString():n.numeric?yn.dx.formatValue(r,function(r){return A.fF.assertValue(r,"format"),r.replace(/(\r\n|\n|\r|,)/g,"")}(e)):function(r){return("="===r.charAt(0)||"-"===r.charAt(0)||"+"===r.charAt(0)||"@"===r.charAt(0))&&(r=Wr.concat(r)),r}(r.toString())))}function Cn(r){return null==r?"":(r=r.replace(/\"/g,'""'),_.includes(r,"\n")||_.includes(r,di)||_.includes(r,pi)||_.includes(r,"\r")||0===r.length?di+r+di:r)}var bn=s(42220),Xr=s(74593),Zr=s(48706),Jr=s(13479),Pn=s(74804),Sn=s(29169),Yr=s(11077),vi=s(89522),Ye=s(94853),xn=s(53497),qr=s(16699),ea=s(14599),ta=s(48708),_n=s(38078),Ut=s(71813),ia=s(39317),na=s(25992),oa=s(5361),ra=s(8679),aa={provide:"exportVisualData",useFactory:function(r,n,e,i,o,a,l,c,u,d,g,v,f,m,y){var M=(0,Yt.Vz)(r,a,o,l,y,c),b=m.create();return new ua(M,r,n,e,i,c,u,d,l,g,v,f,y,b)},deps:[he.D,Ir.S,Tr.d,Y.i,st.C,Ar.q,ae.vZ,Ue.O,le.o,ra.z,zr,Nr.O,vt.Q,Br.P,kr.Q]},$t=1e6,ua=function(){function r(n,e,i,o,a,l,c,u,d,g,v,f,m,y){this.visualAuthoringCore=n,this.visualPluginService=e,this.visualQueryGenerator=i,this.dataProxy=o,this.conceptualSchemaProxy=a,this.displayNameService=l,this.localizationService=c,this.localeProviderService=u,this.featureSwitchService=d,this.exportToExcelProxy=g,this.httpService=v,this.visualAuthoringOperations=f,this.visualAuthoringCustomizeOperations=m,this.visualParameterService=y,A.fF.assertValue(n,"visualAuthoring"),A.fF.assertValue(e,"visualPluginService"),A.fF.assertValue(i,"visualQueryGenerator"),A.fF.assertValue(o,"dataProxy"),A.fF.assertValue(a,"conceptualSchemaProxy"),A.fF.assertValue(l,"displayNameService"),A.fF.assertValue(c,"localizationService"),A.fF.assertValue(u,"localeProviderService"),A.fF.assertValue(f,"visualAuthoringOperations")}return r.prototype.exportToCsv=function(n,e,i,o,a,l){return(0,p.__awaiter)(this,void 0,void 0,function(){var c,u,d,g,v,f,m,y,M,k=this;return(0,p.__generator)(this,function(O){switch(O.label){case 0:return A.fF.assertAnyValue(n,"visualTitle"),A.fF.assertAnyValue(e,"visualData"),A.fF.assertValue(i,"dataSources"),A.fF.assertValue(o,"visualContainer"),A.fF.assertAnyValue(a,"additionalFilters"),u=(c=e&&e.data)&&c.dataViewSource,c&&(d=c.isFirstSegment),g=e&&e.dataTransforms,null==i||null==g||null==u||(0,vi.e6)(o)?[3,2]:[4,this.exportDataViewSourceToCSV(u,g,null!=l,n,this.featureSwitchService.featureSwitches,d,l)];case 1:if(null!=(v=O.sent()))return[2,Promise.resolve(v)];O.label=2;case 2:return[4,this.getConceptualSchema(i)];case 3:return f=O.sent(),[4,this.getGeneratedQuery(f,o,i,a,g?.selects)];case 4:return(m=O.sent())&&m.result&&!m.result.error?(this.overrideDataReduction((y=m.result).options.query.command,l=l??$t,!1),y&&y.options&&y.options.query&&(y.options.query.cacheResponseOnClient=!1),M=y.transforms,[2,this.queryData(y.options,function(T){return k.exportDataViewSourceToCSV(T,M,!0,n,k.featureSwitchService.featureSwitches,void 0,l)})]):[2,Promise.resolve({blob:null,errorDetails:{errorType:0}})]}})})},r.prototype.getConceptualSchema=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.conceptualSchemaProxy.get(n)];case 1:return e=o.sent(),[3,3];case 2:return o.sent(),[2,Promise.reject({blob:null,errorDetails:{errorType:3}})];case 3:return[2,e]}})})},r.prototype.exportToExcel=function(n,e,i,o,a,l,c,u){var d;return(0,p.__awaiter)(this,void 0,void 0,function(){var g,v,m,y,M,b,O,E,T,K,ie,ee,se,ue=this;return(0,p.__generator)(this,function(re){switch(re.label){case 0:return A.fF.assertAnyValue(n,"visualTitle"),A.fF.assertValue(i,"dataSources"),A.fF.assertValue(o,"visualContainer"),A.fF.assertAnyValue(a,"additionalFilters"),A.fF.assertAnyValue(l,"filtersDescription"),A.fF.assertAnyValue(c,"exportType"),[4,this.getConceptualSchema(i)];case 1:return g=re.sent(),2!==c?[3,2]:(v=this.getGeneratedQueryMatrixDataLayout(g,o,i,a),[3,4]);case 2:return[4,this.getGeneratedQuery(g,o,i,a,null===(d=e?.dataTransforms)||void 0===d?void 0:d.selects)];case 3:v=re.sent(),re.label=4;case 4:return v&&v.result&&!v.result.error?(y=(m=v.result).options.query.command,M=o.config.singleVisual,A.fF.assert(function(){return!_.isEmpty(y.Commands)},"query command should contains Commands"),A.fF.assertValue(y.Commands[0].SemanticQueryDataShapeCommand,"The first command must be a SemanticQuery command"),2===c?(b=this.generateExportVisualLayoutDataCommand(g,y.Commands[0].SemanticQueryDataShapeCommand.Query,M,m.transforms,l),y.Commands.push(b),this.overrideDataReduction(y,$t,this.featureSwitchService.featureSwitches.useWindowWhenExporting)):(O=this.generateExportDataCommand(g,y.Commands[0].SemanticQueryDataShapeCommand.Query,l,M,m.transforms,v.selectsWithDisplayName),y.Commands.push(O),this.clearDataQuerySubtotal(y),3===c&&this.setConnectedExportRowLimit(o.config.singleVisual.query,y.Commands[0].SemanticQueryDataShapeCommand.Query),this.overrideDataReduction(y,$t,!1)),(E=this.httpService.powerbiRequestOptions()).responseType="blob",E.retryCount=0,T=(0,Jr.xV)([y],(0,Pn.kB)((0,Pn.$$)(i,M.query&&M.query.defn))),K=(0,bn.u5)(T,this.localeProviderService),3===c&&(0,bn.K4)(K)?[2,Promise.reject({blob:null,errorDetails:{errorType:7}})]:(ie={exportDataType:c,executeSemanticQueryRequest:K,artifactId:u},ee=1,[2,(se=function(){return(0,p.__awaiter)(ue,void 0,void 0,function(){var N,Oe,qe,Gt,et;return(0,p.__generator)(this,function(tt){switch(tt.label){case 0:return tt.trys.push([0,2,,3]),[4,this.exportToExcelProxy.exportToExcel(ie,E)];case 1:return N=tt.sent(),[3,3];case 2:return Oe=tt.sent(),ee>0&&0===Oe?.status&&"NetworkConnectionIssue"===(null===(et=Oe.error)||void 0===et?void 0:et.code)?(ee--,[2,se()]):[2,this.handleExportToExcelErrorResult(Oe)];case 3:return N.headers&&(qe=N.headers("requestId")),0===N.data.size?[2,Promise.reject({blob:null,requestId:qe,errorDetails:{errorType:1}})]:(Gt={blob:N.data,requestId:qe,isPartialResult:!1,format:1,fileName:r.getFileName(n,1)},[2,Promise.resolve(Gt)])}})})})()])):[2,Promise.reject({blob:null,errorDetails:{errorType:0}})]}})})},r.prototype.handleExportToExcelErrorResult=function(n){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,i,o,a,l,c,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:if(n.headers&&(e=n.headers("requestId")),!(n.data&&n.data instanceof Blob&&_.startsWith(n.data.type,"application/json")))return[3,9];o=new FileReader,a=void 0,d.label=1;case 1:return d.trys.push([1,3,,5]),[4,this.readAsText(n.data,o)];case 2:return a=d.sent(),[3,5];case 3:return l=d.sent(),[4,this.getDefaultQueryErrorExportDataResult(l,e)];case 4:return u=d.sent(),[2,Promise.reject(u)];case 5:return(c=JSON.parse(a))&&c.error&&(i=(0,Ye.GB)(c.error)),i?[2,Promise.reject(this.getTelemetryErrorExportDataResult(i,e))]:[3,6];case 6:return[4,this.getDefaultQueryErrorExportDataResult(a,e)];case 7:return u=d.sent(),[2,Promise.reject(u)];case 8:return[3,12];case 9:return n.error||n.data&&n.data.error?(i=(0,Ye.GB)(n.error?n.error:n.data.error),[2,Promise.reject(this.getTelemetryErrorExportDataResult(i,e,n.status))]):[3,10];case 10:return[4,this.getDefaultQueryErrorExportDataResult(n.data,e)];case 11:return u=d.sent(),[2,Promise.reject(u)];case 12:return[2]}})})},r.prototype.getCustomizedVisualArgs=function(n,e){if(A.fF.assertValue(n,"hostVisualContainer is undefined"),n){if(!this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(n))return{customizedVisualContainer:n,mergedFilters:e};var i=_n.b$.generateGuid(),o={singleVisual:(0,ke.d9)(n.config.singleVisual)},a=this.visualAuthoringOperations.buildVisualContainerFromConfig(i,o,"Default");return a.name=n.name,this.visualAuthoringCustomizeOperations.customizeConvert(a),{customizedVisualContainer:a,mergedFilters:this.mergeCustomizedFilters(a.filters,e)}}},r.prototype.readAsText=function(n,e){if(void 0!==n)return new Promise(function(i,o){e.onload=function(){i(e.result)},e.onerror=function(){o(e.error)},e.readAsText(n)})},r.prototype.getDefaultQueryErrorExportDataResult=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,o,a,c;return(0,p.__generator)(this,function(u){switch(u.label){case 0:if(i=n.toString(),!(n instanceof Blob))return[3,5];o=new FileReader,a=void 0,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.readAsText(n,o)];case 2:return a=u.sent(),[3,4];case 3:return u.sent(),[2,Promise.resolve({blob:null,requestId:e,errorDetails:{errorType:2,errorMessage:i,errorSource:(0,Ye.oG)("System")}})];case 4:return i=a,(c=JSON.stringify(a))&&c.length>2&&(i=c),[2,Promise.resolve({blob:null,requestId:e,errorDetails:{errorType:2,errorMessage:i,errorSource:(0,Ye.oG)("System")}})];case 5:return"object"==typeof n&&(c=JSON.stringify(n))&&c.length>2&&(i=c),[2,Promise.resolve({blob:null,requestId:e,errorDetails:{errorType:2,errorMessage:i,errorSource:(0,Ye.oG)("System")}})]}})})},r.prototype.getTelemetryErrorExportDataResult=function(n,e,i){return{blob:null,requestId:e,errorDetails:{errorType:n.errorCode===xn._h?6:2,errorCode:n.errorCode,errorSource:n.errorCode===xn._h?(0,Ye.oG)("User"):n.errorSource,errorMessage:n.errorCode,status:i}}},r.prototype.mergeCustomizedFilters=function(n,e){var i=new Yr.ME;if(e&&!_.isEmpty(e.dataFiltersUnmerged))for(var o=0,a=e.dataFiltersUnmerged;o<a.length;o++)i.addVisualFilter(a[o]);for(var u=0,d=_.isEmpty(n)?[]:_.chain(n).filter(function(v){return v.filter}).map(function(v){return v.filter}).value();u<d.length;u++)i.addVisualFilter({filter:d[u]});return i.getFilters(!1)},r.prototype.resolveQueryParameters=function(n,e,i,o){return this.visualParameterService.resolve({dataSources:e,schema:n,additionalFilters:i,config:o.config.singleVisual,visual:o})},r.prototype.getGeneratedQuery=function(n,e,i,o,a){return(0,p.__awaiter)(this,void 0,void 0,function(){var l,u,d,g,v,f,m,y,M,b,k,O,E,T,K,ie,ee,ue,re,Ce;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return l=(0,ke.d9)(e.config.singleVisual),this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(e)&&(u=this.getCustomizedVisualArgs(e,o),l=u.customizedVisualContainer.config.singleVisual,o=u.mergedFilters),l=this.replaceSparklineDataWithMeasure(n,l),d=this.getPercentRoleSelectIndexToDisplayNameMapping(l,n),this.rewritePercentRoleRefs(l,o),g=this.mapSelectIndexWithExprs(l,d),this.clearConversionContextWithPercentRole(l),this.clearVisualConfigObjects(l),[4,this.visualPluginService.ensureBuiltInPlugins()];case 1:return N.sent(),v=this.visualPluginService.getPlugin(J.L.tableEx.name),e.config.singleVisual.visualType===v.name?[3,3]:(f=this.visualAuthoringCore.convert({schema:n,source:l,target:v.name}),(m=_.clone(e)).config=_.clone(m.config),m.config.singleVisual=l,[4,this.resolveQueryParameters(n,i,o,m)]);case 2:if(N.sent(),!f)return[2];N.label=3;case 3:if(M=(y=l.query).projections,b=this.visualPluginService.capabilities(J.L.tableEx.name),!_.isEmpty(a))for(k=0,O=a;k<O.length;k++)E=O[k],!_.isEmpty(E.relatedSelects)&&E.expr&&y.add(E.expr,b.dataRoles[0].name);for(T=function(qe){var Gt=_.find(y.defn.select(),function(tt){return(0,xe.fS)(tt.expr,qe.expr)}),et=K.getQueryProjectionForSelect(Gt,M);et&&(et.displayName=qe.name)},K=this,ie=0,ee=g;ie<ee.length;ie++)T(ee[ie]);return(ue=_.cloneDeep(b.dataViewMappings))[0].table.rows.dataReductionAlgorithm={top:{count:$t}},re=(0,Sn.c)(i),Ce=re&&re.getDataSourceVariables(),[2,{result:this.visualQueryGenerator.execute({dataSources:i,config:l,schema:n,additionalFilters:o,dataViewMappingsOverride:ue,dataSourceVariables:Ce}),selectsWithDisplayName:g}]}})})},r.prototype.getGeneratedQueryMatrixDataLayout=function(n,e,i,o){var a=(0,ke.d9)(e.config.singleVisual);a=this.replaceSparklineDataWithMeasure(n,a);var l=(0,Sn.c)(i),u=l&&l.getDataSourceVariables();return{result:this.visualQueryGenerator.execute({dataSources:i,config:a,schema:n,additionalFilters:o,dataViewMappingsOverride:void 0,dataSourceVariables:u}),selectsWithDisplayName:void 0}},r.prototype.replaceSparklineDataWithMeasure=function(n,e){var i={name:"vc",config:{singleVisual:e}};return(0,vi.e6)(i)?((0,vi.Gy)(n,i,this.visualAuthoringOperations),i.config.singleVisual):e},r.prototype.queryData=function(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.dataProxy.execute(n)];case 1:return i=l.sent(),[3,3];case 2:return l.sent(),[2,Promise.reject({blob:null,errorDetails:{errorType:2}})];case 3:return[4,e(i.dataViewSource)];case 4:return[2,null!=(a=l.sent())?Promise.resolve(a):Promise.reject({blob:null,errorDetails:{errorType:1}})]}})})},r.prototype.exportDataViewSourceToCSV=function(n,e,i,o,a,l,c){return(0,p.__awaiter)(this,void 0,void 0,function(){var u,d,g,f,m,y;return(0,p.__generator)(this,function(M){switch(M.label){case 0:return A.fF.assertValue(n,"dataViewSource"),A.fF.assertValue(e,"transformActions"),(u=r.readDataViewSource(n,a))&&(g=(d=u.dataView)&&d.table)?_.filter(g.columns,function(b){return null!=b.index&&!_.find(g.columns,function(k){return k.formatSource&&k.formatSource.formatString===b})}).length!==e.selects.length||(f=r.isPartialResult(u,l))&&!i?[2]:[4,this.visualPluginService.ensureBuiltInPlugins()]:[2];case 1:return M.sent(),m=this.visualPluginService.capabilities(J.L.table.name),y=(0,na.nn)({transforms:e,dataRoles:m.dataRoles,objectDescriptors:m.objects,prototype:d,colorAllocatorFactory:(0,ia.V)(),dataViewMappings:m.dataViewMappings,visualStyle:(0,ta.Ue)(),featureSwitches:this.featureSwitchService.featureSwitches}).dataViews,_.isEmpty(y)||null!=c&&void 0!==l&&r.isRowsBelowLimit(y[0],c)?[2]:f||null==c||!(f=r.isRowsAboveLimit(y[0],c))||i?[2,{isPartialResult:f,blob:Ur(y[0],ea.e0.formatString,c),format:0,fileName:r.getFileName(o,0)}]:[2]}})})},r.isRowsAboveLimit=function(n,e){var i=n.table;return!!i&&i.rows.length>e},r.isRowsBelowLimit=function(n,e){var i=n.table;return!!i&&i.rows.length<e},r.readDataViewSource=function(n,e){var i;try{i=(0,Zr.ij)(31,n.data,(0,qr.u)(e))}catch(o){return}return i},r.isPartialResult=function(n,e){if(!n)return!1;var i=_.some(n.warnings,function(o){return o instanceof Xr.x});return!!n.restartToken||i||void 0!==e},r.getFileName=function(n,e){var i="data";if(!_.isEmpty(n)){var o=(0,_n.k4)(n);_.isEmpty(o)||(i=o)}switch(e){case 0:return i+".csv";case 1:return i+".xlsx";default:A.fF.assertFail("Unknown format type")}},r.prototype.generateExportDataCommand=function(n,e,i,o,a,l){var c=this,u=Xe.ib.deserializeQuery(e),d={includeVariationSource:!0,includeDefaultAggregate:!0,includeHierarchyName:!0},g=this.visualPluginService.capabilities(o.visualType),v=_.map(u.select(),function(m){var y=_.find(l,function(M){return(0,xe.fS)(m.expr,M.expr)});return{queryName:m.name,displayName:y?y.name:c.displayNameService.getDisplayName(m.expr,n,g,m.name,o.columnProperties,d),qualifiedDisplayName:y?y.name:c.displayNameService.getQualifiedDisplayName(m.expr,n,g,d)}});return r.ensureUniqueName(v,i),{ExportDataCommand:{Columns:_.map(v,function(m){return{QueryName:m.queryName,Name:m.useQualified?m.qualifiedDisplayName:m.displayName}}),Ordering:this.getTableOrderingFromTransforms(a)||this.getDefaultTableOrdering(u.select().length),FiltersDescription:this.generateFiltersDescriptionString(i)}}},r.prototype.generateExportVisualLayoutDataCommand=function(n,e,i,o,a){var l=this,c=Xe.ib.deserializeQuery(e),u={includeVariationSource:!0,includeDefaultAggregate:!1,includeHierarchyName:!0},d=this.visualPluginService.capabilities(i.visualType);return{ExportDataCommand:{Columns:_.map(c.select(),function(y){var M=l.displayNameService.getDisplayName(y.expr,n,d,y.name,i.columnProperties,u);return{QueryName:y.name,Name:M}}),Ordering:this.getTableOrderingFromTransforms(o)||[],FiltersDescription:this.generateFiltersDescriptionString(a)}}},r.prototype.getTableOrderingFromTransforms=function(n){if(n.roles&&n.roles.ordering)return n.roles.ordering[Lr.xP.ValuesRoleName]},r.prototype.getDefaultTableOrdering=function(n){return _.range(n)},r.ensureUniqueName=function(n,e){var i={},o={};A.fF.assertValue(n,"selectsNames"),A.fF.assertValue(e,"filtersDescription");for(var c=[],u=0,d=n.concat(e.filtersNamesAndRestatements||[]);u<d.length;u++)if((g=d[u]).displayName){c.push(g);var v=g.displayName.toLowerCase(),f=g.qualifiedDisplayName.toLowerCase();v in i&&i[v]!==f&&(o[v]=!0),i[v]=f}else g.useQualified=!0;for(var m=0,y=c;m<y.length;m++){var g;(g=y[m]).useQualified=o[g.displayName.toLowerCase()]}},r.prototype.generateFiltersDescriptionString=function(n){if(null==n.filtersNamesAndRestatements)return"";if(0===n.filtersNamesAndRestatements.length)return this.localizationService.get("ExportData_NoAppliedFiltersText");for(var e="",i=0,o=n.filtersNamesAndRestatements;i<o.length;i++){var a=o[i];e=e.concat(this.localizationService.format("ExportData_SingleFilterText",["\n",a.useQualified?a.qualifiedDisplayName:a.displayName,a.restatement]))}return this.localizationService.format("ExportData_AppliedFiltersText",[e])},r.prototype.overrideDataReduction=function(n,e,i,o){o=o||100,n.Commands[0].SemanticQueryDataShapeCommand.Binding.DataReduction=i?{Primary:(0,Ut.P)({window:{count:e}},void 0),Secondary:(0,Ut.P)({top:{count:o}},void 0)}:{Primary:(0,Ut.P)({top:{count:e}},void 0),Secondary:(0,Ut.P)({top:{count:o}},void 0)}},r.prototype.clearDataQuerySubtotal=function(n){for(var e=0,i=n.Commands[0].SemanticQueryDataShapeCommand.Binding.Primary.Groupings;e<i.length;e++){var o=i[e];null!=o.Subtotal&&(o.Subtotal=0)}},r.prototype.clearVisualConfigObjects=function(n){n.objects=void 0,n.vcObjects=void 0},r.prototype.getPercentRoleSelectIndexToDisplayNameMapping=function(n,e){for(var i=this.visualPluginService.capabilities(n.visualType),a=n.query.defn.select(),l=[],c=0;c<a.length;c++){var u=a[c];if((0,qt.fv)(u.expr)){var d=this.displayNameService.getDisplayName(u.expr,e,i,u.name,n.columnProperties);l.push({selectIndex:c,displayName:d})}}return l},r.prototype.rewritePercentRoleRefs=function(n,e){var i=n.query,o=i.defn.select(),l=new da(o,i.projections);i.defn=i.defn.rewrite(l),e&&e.dataFilter&&(e.dataFilter=e.dataFilter.rewrite(l))},r.prototype.mapSelectIndexWithExprs=function(n,e){for(var i=n.query.defn.select(),o=[],a=0,l=e;a<l.length;a++){var c=l[a];o.push({expr:i[c.selectIndex].expr,name:c.displayName})}return o},r.prototype.clearConversionContextWithPercentRole=function(n){if(n.conversionSourceContext&&n.conversionSourceContext.query)for(var o=0,a=n.conversionSourceContext.query.defn.select();o<a.length;o++)if((0,qt.fv)(a[o].expr)){n.conversionSourceContext=void 0;break}},r.prototype.getQueryProjectionForSelect=function(n,e){for(var i in e){var o=e[i].all(),a=_.find(o,function(l){return l.queryRef===n.name});if(a)return a}},r.prototype.setConnectedExportRowLimit=function(n,e){var i=5e5;!n||this.checkQueryForAllMeasures(n)||(null==e.Top||e.Top>i)&&(e.Top=i)},r.prototype.checkQueryForAllMeasures=function(n){return _.every(n.defn.select(),function(e){return(0,Ai.k)(e.expr)})},r}(),da=function(r){function n(e,i){var o=r.call(this)||this;return o.selects=e,o.projections=i,o}return(0,p.__extends)(n,r),n.prototype.visitScopedEval=function(e){for(var i=this,o=[],a=!1,l=0,c=e.scope;l<c.length;l++){var u=c[l];if((0,be.yL)(u)){a=!0;var d=this.projections[u.role];if(d){var g=d.all();o.push.apply(o,_.map(g,function(v){return i.selects.withName(v.queryRef).expr}))}}else o.push(u)}return a?new Lt.kC(e.expression,o):e},n}(oa.b),Mn=s(43626),va={provide:Mn.DS,useFactory:function(r,n,e,i,o,a,l,c,u){return new ga(r,n,e,i,o,l,a,c,u)},deps:[Y.i,ce.D,oe.J,ae.vZ,Qe.RD,we.t,fe.z,ve.y0,pe.$8]},ga=function(){function r(n,e,i,o,a,l,c,u,d){this.conceptualSchemaProxy=n,this.dataSources=e,this.eventBridge=i,this.featureSwitchService=o,this.groupAuthoring=a,this.selection=l,this.promiseFactory=c,this.telemetryService=u,this.visualAuthoring=d}return r.prototype.createFieldWellBucketCore=function(){return new ji({conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,eventBridge:this.eventBridge,featureSwitchService:this.featureSwitchService,groupAuthoring:this.groupAuthoring,promiseFactory:this.promiseFactory,selection:this.selection,telemetryService:this.telemetryService,visualAuthoring:this.visualAuthoring})},r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275inject(Y.i),t.\u0275\u0275inject(ce.D),t.\u0275\u0275inject(oe.J),t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(Qe.RD),t.\u0275\u0275inject(fe.z),t.\u0275\u0275inject(we.t),t.\u0275\u0275inject(ve.y0),t.\u0275\u0275inject(pe.$8))},r.\u0275prov=t.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),fa={provide:Mn.E6,useFactory:function(r,n,e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k,O,E,T){return new ma(r,n,e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k,O,E,T)},deps:[Y.i,ce.D,oe.J,q.z,ae.vZ,Qe.RD,Se.H,le.o,ei.x,we.t,zt.g,fe.z,He.P,ii.s,ti.f,ve.y0,pe.$8,Ke.w,he.D,Me.w,de.r]},ma=function(){function r(n,e,i,o,a,l,c,u,d,g,v,f,m,y,M,b,k,O,E,T,K){this.conceptualSchemaProxy=n,this.dataSources=e,this.eventBridge=i,this.explorationNavigation=o,this.featureSwitchService=a,this.groupAuthoring=l,this.lazyScoped=c,this.localizationService=u,this.modelChangeHandler=d,this.promiseFactory=g,this.screenReaderService=v,this.selection=f,this.showValueAsService=m,this.sparklinesService=y,this.themeService=M,this.telemetryService=b,this.visualAuthoring=k,this.visualCalcEagerService=O,this.visualPlugin=E,this.visibilityService=T,this.contextActivityService=K}return r.prototype.createFieldWellFieldCore=function(n,e){return new Ni({conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,groupAuthoring:this.groupAuthoring,lazyScoped:this.lazyScoped,localizationService:this.localizationService,modelChangeHandler:this.modelChangeHandler,promiseFactory:this.promiseFactory,screenReaderService:this.screenReaderService,selection:this.selection,showValueAsService:this.showValueAsService,sparklinesService:this.sparklinesService,telemetryService:this.telemetryService,themeService:this.themeService,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin,visibilityService:this.visibilityService,visualCalcEagerService:this.visualCalcEagerService,contextActivityService:this.contextActivityService},n,e)},r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275inject(Y.i),t.\u0275\u0275inject(ce.D),t.\u0275\u0275inject(oe.J),t.\u0275\u0275inject(q.z),t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(Qe.RD),t.\u0275\u0275inject(Se.H),t.\u0275\u0275inject(le.o),t.\u0275\u0275inject(ei.x),t.\u0275\u0275inject(we.t),t.\u0275\u0275inject(zt.g),t.\u0275\u0275inject(fe.z),t.\u0275\u0275inject(He.P),t.\u0275\u0275inject(ii.s),t.\u0275\u0275inject(ti.f),t.\u0275\u0275inject(ve.y0),t.\u0275\u0275inject(pe.$8),t.\u0275\u0275inject(Ke.w),t.\u0275\u0275inject(he.D),t.\u0275\u0275inject(Me.w),t.\u0275\u0275inject(de.r))},r.\u0275prov=t.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Ca={provide:"fieldWellModernService",useFactory:function(r,n,e,i,o,a,l,c,u,d,g,v,f,m,y){return new ba(r,n,e,i,o,a,l,c,u,d,g,v,f,m,y)},deps:[Y.i,ce.D,oe.J,Ue.O,q.z,ae.vZ,At.AA,Se.H,le.o,It.s,fe.z,He.P,Me.w,Ke.w,he.D]},ba=function(){function r(n,e,i,o,a,l,c,u,d,g,v,f,m,y,M){this.conceptualSchemaProxy=n,this.dataSources=e,this.eventBridge=i,this.explorationDisplayNameService=o,this.explorationNavigation=a,this.featureSwitchService=l,this.groupingDesignStateService=c,this.lazyScopedProvider=u,this.localizationService=d,this.runningVisuals=g,this.selection=v,this.showValueAsService=f,this.visibility=m,this.visualCalcEagerService=y,this.visualPlugin=M}return r.prototype.createFieldWellCore=function(n,e,i){return new Ui({$element:n,conceptualSchemaProxy:this.conceptualSchemaProxy,dataSources:this.dataSources,eventBridge:this.eventBridge,explorationDisplayNameService:this.explorationDisplayNameService,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,groupingDesignStateService:this.groupingDesignStateService,lazyScopedProvider:this.lazyScopedProvider,localizationService:this.localizationService,runningVisuals:this.runningVisuals,selection:this.selection,showValueAsService:this.showValueAsService,visibility:this.visibility,visualCalcEagerService:this.visualCalcEagerService,visualPlugin:this.visualPlugin},e,i)},r.\u0275fac=function(e){return new(e||r)(t.\u0275\u0275inject(Y.i),t.\u0275\u0275inject(ce.D),t.\u0275\u0275inject(oe.J),t.\u0275\u0275inject(Ue.O),t.\u0275\u0275inject(q.z),t.\u0275\u0275inject(ae.vZ),t.\u0275\u0275inject(At.AA),t.\u0275\u0275inject(Se.H),t.\u0275\u0275inject(le.o),t.\u0275\u0275inject(It.s),t.\u0275\u0275inject(fe.z),t.\u0275\u0275inject(He.P),t.\u0275\u0275inject(Me.w),t.\u0275\u0275inject(Ke.w),t.\u0275\u0275inject(he.D))},r.\u0275prov=t.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac}),r}(),Pa={provide:"tabOrderService",useFactory:function(r,n,e,i,o){return(0,p.__awaiter)(this,void 0,void 0,function(){var a;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return[4,e.get("canvasListOrderingService")];case 1:return a=l.sent(),[2,new xa(a,r,n,i,o)]}})})},deps:[ui.F,Nt.F,Se.H,pt.z,vt.Q]},xa=function(){function r(n,e,i,o,a){this.canvasListOrderingService=n,this.canvasListOrderNormalizeService=e,this.formFactor=i,this.undoRedoService=o,this.visualAuthoringOperations=a,this.tabOrderPropertyName="tabOrder"}return r.prototype.changeSection=function(n,e,i,o,a){this.canvasListOrderingService.insertAtMinMagnitude(n,e,i,this.tabOrderPropertyName,o,a)},r.prototype.bringForward=function(n,e,i,o){this.canvasListOrderingService.bringForward(n,e,i,this.tabOrderPropertyName,o)},r.prototype.sendBackward=function(n,e,i,o){this.canvasListOrderingService.sendBackward(n,e,i,this.tabOrderPropertyName,o)},r.prototype.moveAfter=function(n,e,i,o){this.canvasListOrderingService.moveAfter(n,e,i,o,this.tabOrderPropertyName)},r.prototype.moveAfterIndex=function(n,e,i,o){this.canvasListOrderingService.moveAfterIndex(n,e,i,o,this.tabOrderPropertyName)},r.prototype.moveBefore=function(n,e,i,o){this.canvasListOrderingService.moveBefore(n,e,i,o,this.tabOrderPropertyName)},r.prototype.moveBeforeIndex=function(n,e,i,o){this.canvasListOrderingService.moveBeforeIndex(n,e,i,o,this.tabOrderPropertyName)},r.prototype.shouldNormalize=function(n,e){return this.canvasListOrderingService.shouldNormalize(n,e,this.tabOrderPropertyName)},r.prototype.normalize=function(n,e){this.canvasListOrderingService.normalize(n,e,this.tabOrderPropertyName)},r.prototype.normalizeHierarchy=function(n){var e=this,i=_.partition(n,function(y){var M=(0,Ae.bt)(y,0).tabOrder;return void 0===M||M>=0}),a=i[1],l=this.canvasListOrderNormalizeService.getContainerListOrders(i[0],function(y){return e.canvasListOrderingService.getListOrderPropertyFunction(y,"tabOrder")}),c=this.canvasListOrderNormalizeService.getContainerListOrders(a,function(y){return e.canvasListOrderingService.getListOrderPropertyFunction(y,"tabOrder")}),u=this.canvasListOrderNormalizeService.normalizeListOrder(l,!0),d=this.canvasListOrderNormalizeService.normalizeListOrder(c,!1),g=(0,p.__assign)((0,p.__assign)({},u),d);this.visualAuthoringOperations.updateContainerListOrders(n,g,"tabOrder");for(var v=0,f=n;v<f.length;v++){var m=f[v];(0,ye.q4)(m)&&this.normalizeHierarchy(m.children)}},r.prototype.sendTabOrderCommandsByLevel=function(n,e,i){var o=this;this.undoRedoService.register("Update Visual Containers for tabOrder",function(){o.sendTabOrderCommandsByLevelImpl(n,e,i)})},r.prototype.sendTabOrderCommandsByLevelImpl=function(n,e,i){var o=(0,Ae.Dg)(n);for(var a in o){var l=o[a],c=(0,Re.E8)(l[0],e);switch(i){case 0:this.bringForwardHierarchy(c,l,!0,!0);break;case 1:this.sendBackwardHierarchy(c,l,!0,!0)}}},r.prototype.bringForwardHierarchy=function(n,e,i,o){var a=(0,Ae.cV)(n,!0);this.canvasListOrderingService.bringForward(a,e,i,this.tabOrderPropertyName,o)},r.prototype.sendBackwardHierarchy=function(n,e,i,o){var a=(0,Ae.cV)(n,!0);this.canvasListOrderingService.sendBackward(a,e,i,this.tabOrderPropertyName,o)},r.prototype.orderByPosition=function(n){var e=this;this.undoRedoService.register("Update Visual Containers for tabOrder",function(){e.orderByPositionImpl(n)})},r.prototype.orderByPositionImpl=function(n){for(var e=this,a=(0,Ae.cV)(n,!0).map(function(d){return(0,Ae.bt)(d,e.formFactor.getCurrentLayout())}).sort(function(d,g){var v=Math.round(g.x)-Math.round(d.x),f=Math.round(g.y)-Math.round(d.y);return 0===Math.abs(f)?v:f}),l=0;l<a.length;l++){a[l].tabOrder=l*gt.R$;var u=n[l];(0,ye.q4)(u)&&this.orderByPositionImpl(u.children)}},r}(),_a={provide:"zIndexService",useFactory:function(r){return(0,p.__awaiter)(this,void 0,void 0,function(){var n;return(0,p.__generator)(this,function(e){switch(e.label){case 0:return[4,r.get("canvasListOrderingService")];case 1:return n=e.sent(),[2,new Oa(n)]}})})},deps:[Se.H]},Oa=function(){function r(n){this.canvasListOrderingService=n,this.zIndexPropertyName="z"}return r.prototype.bringForward=function(n,e,i){this.canvasListOrderingService.bringForward(n,e,!0,this.zIndexPropertyName,i)},r.prototype.bringToFront=function(n,e,i){this.canvasListOrderingService.bringToFront(n,e,!0,this.zIndexPropertyName,i)},r.prototype.sendBackward=function(n,e,i){this.canvasListOrderingService.sendBackward(n,e,!0,this.zIndexPropertyName,i)},r.prototype.sendToBack=function(n,e,i){this.canvasListOrderingService.sendToBack(n,e,!0,this.zIndexPropertyName,i)},r.prototype.moveAfter=function(n,e,i){this.canvasListOrderingService.moveAfter(n,e,i,!0,this.zIndexPropertyName)},r.prototype.moveAfterIndex=function(n,e,i){this.canvasListOrderingService.moveAfterIndex(n,e,i,!0,this.zIndexPropertyName)},r.prototype.moveBefore=function(n,e,i){this.canvasListOrderingService.moveBefore(n,e,i,!0,this.zIndexPropertyName)},r.prototype.moveBeforeIndex=function(n,e,i){this.canvasListOrderingService.moveBeforeIndex(n,e,i,!0,this.zIndexPropertyName)},r.prototype.shouldNormalize=function(n){return this.canvasListOrderingService.shouldNormalize(n,!0,this.zIndexPropertyName)},r.prototype.normalize=function(n){this.canvasListOrderingService.normalize(n,!0,this.zIndexPropertyName)},r.prototype.sendZIndexCommandsByLevel=function(n,e,i){var o=(0,Ae.Dg)(n);for(var a in o){var l=o[a],c=(0,Re.E8)(l[0],e);switch(i){case 3:this.bringForward(c,l,!0);break;case 4:this.sendBackward(c,l,!0);break;case 1:this.bringToFront(c,l,!0);break;case 2:this.sendToBack(c,l,!0)}}},r}(),wa=s(44408),Fa=s(67659),Ea=s(52910),Va=s(31109),Da=s(32208),Ta=s(91280),Ia=s(42101),Aa=s(17269),Ba=s(82156),ka=s(79061),La=s(22180),za=s(13316),Na=s(94770),Ra=s(72359),ja=s(3741),Wa=s(56545),Ua=s(45925),$a=s(52040),Ga=s(91382),Ha=s(53935),Ka=s(47913),Qa=s(6015),Xa=s(76433),Za=s(47542),Ja=s(93367),Ya=s(94841),qa=s(13254),el=s(39433),tl=s(55533),il=s(79725),nl=s(16095),ol=s(6618),rl=s(27037),al=s(17177),ll=[{type:Ji,componentId:"SyncGroupPaneComponentId"},{type:dn,componentId:"VisualizationPaneModernComponentId"},{type:ni,componentId:"FieldWellModernComponentId"},{type:Et,componentId:"DrillthroughPaneComponentId"},{type:rt,componentId:"AutoVisualComponentId"}],sl=function(){function r(){}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=t.\u0275\u0275defineInjector({providers:[gr,br,Vi.EY,_r,Fr,aa,va,fa,Ca,Pa,_a],imports:[P.CommonModule,Ea.O,za._,Va.F,Da.J,Ua.e,Ee.u5,Aa.InsightsUIModule,Ba.N.withManifests(ll),ka.v,wa.Ps,$a.x,Ga.d,Ia.p,Fa._,Ha.e,Ka.V,Qa.C,Na.f,Xa.d,Za.d,Ja.U,Ya.b,qa.x,Ra.K,el.t,tl.q,il.j,nl.Z,La.m,Ee.UX,ol.J,rl.b,ja.z,al.T6,Wa.g,Ta.Q]}),r}()},79930:function(te,G,s){s.d(G,{EY:function(){return U},Wg:function(){return F}});var h=s(81337),t=s(8082),P=s(40823),w=s(83008),C=s(77616),x=s(54766),L=s(54834),p=s(74082),z=s(25740),D=s(65181),I=s(58938),V=s(4877),S=s(50423),U={provide:"conditionalFormattingDialogLauncherService",useFactory:function(j,Z,B,R,W,H){return new F(j,Z,B,R,W,H)},deps:[D.o,I.x,V.a,w.D,t.s,P._]},F=function(){function j(Z,B,R,W,H,ne){this.localizationService=Z,this.dialogService=B,this.itemPickerService=R,this.dataSourcesService=W,this.runningVisuals=H,this.dataSourcesSerializer=ne}return j.prototype.show=function(Z,B,R,W,H,ne){return(0,h.__awaiter)(this,void 0,void 0,function(){var J;return(0,h.__generator)(this,function(Y){switch(Y.label){case 0:return J=R&&(0,p.tO)(R)?R.measure:R,[4,this.showModernConditionaFormattingDialog(Z,B,J,W,H,ne)];case 1:return[2,Y.sent().afterClosed().toPromise()]}})})},j.prototype.showModernConditionaFormattingDialog=function(Z,B,R,W,H,ne){var J,A;return(0,h.__awaiter)(this,void 0,void 0,function(){var Y,de,q,oe,ce;return(0,h.__generator)(this,function(ae){return Y=this.dataSourcesSerializer.serializeDataSources(this.dataSourcesService.get()),de=W.propertyDescriptor,q=this.runningVisuals.getVisual(Z),oe={colorPalette:(0,z.NO)(ne.colorPalette),icons:null===(J=this.itemPickerService)||void 0===J?void 0:J.getIcons(),iconSets:null===(A=this.itemPickerService)||void 0===A?void 0:A.getIconSets(),inDataSources:Y,propertySelector:W.selector&&(0,x.UZ)(W.selector),allowOverrideTotalMatching:W.allowOverrideSubtotalMatching,propertyDefinition:H&&(0,x.W7)(H,de),propertyDescriptor:(0,C.m8)(de,this.localizationService),targetFieldDisplayName:B,targetFieldExpr:R&&L.ib.serializeExpr(R),visualType:q.getType(),hasGrouping:!!W.selector&&this.hasGroupingColumn(q)},ce={title:"".concat(oe.propertyDescriptor.displayName," - ").concat(oe.targetFieldDisplayName),input:oe,hideOkButton:!1,hideCancelButton:!1,focusInitialCloseButton:!0,footerLink:{text:this.localizationService.get("ConditionalFormattingDialog_LearnMore"),url:"https://go.microsoft.com/fwlink/?linkid=874399",type:"external"}},[2,this.dialogService.showTemplateDialog("ConditionalFormattingDialog",ce,{minWidth:"940px",height:"665px",autoFocus:!0})]})})},j.prototype.hasGroupingColumn=function(Z){if(!Z)return!1;var B=Z.getDataViews()[0];if(B.metadata&&B.metadata.columns)for(var R=0,W=B.metadata.columns;R<W.length;R++)if(!W[R].isMeasure)return!0;return!1},j.\u0275fac=function(B){return new(B||j)(S.\u0275\u0275inject(D.o),S.\u0275\u0275inject(I.x),S.\u0275\u0275inject(V.a),S.\u0275\u0275inject(w.D),S.\u0275\u0275inject(t.s),S.\u0275\u0275inject(P._))},j.\u0275prov=S.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac}),j}()},42587:function(te,G,s){s.d(G,{F:function(){return P},j:function(){return t}});var h=s(78417);function t(w,C,x){return void 0===x&&(x=!1),1===w?{paneTitle:C.get("Tooltip"),paneTitleTooltip:C.get("Drillthrough_TooltipTitleTooltip"),linkFieldsDropZoneTitle:C.get(x?"PagePropertyPane_LinkFieldsDropZoneTitle_Tooltip":"DrillthroughLinks_Tooltip_Fields"),dropZoneText:C.get("FieldDropZone_TooltipLink_Watermark"),keepAllFiltersLabel:C.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:C.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip"),keepAllFiltersToggleForcedOnTooltip:C.format("Drillthrough_KeepAllFiltersForcedOnForTooltip_Tooltip",[C.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip")]),crossReportDrillthroughLabel:C.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:C.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:C.get("DrillthroughLinks_LinkTypeGroup_Tooltip")}:{paneTitle:C.get("Drillthrough"),paneTitleTooltip:C.get("Drillthrough_DrillthroughTitleTooltip"),linkFieldsDropZoneTitle:C.get(x?"PagePropertyPane_LinkFieldsDropZoneTitle_Drillthrough":"DrillthroughLinks_Drillthrough_Fields"),dropZoneText:C.get("FieldDropZone_DrillthroughLink_Watermark"),keepAllFiltersLabel:C.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:C.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip"),keepAllFiltersToggleForcedOnTooltip:C.format("Drillthrough_KeepAllFiltersForcedOnForDrillthrough_Tooltip",[C.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip")]),crossReportDrillthroughLabel:C.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:C.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:C.get("DrillthroughLinks_LinkTypeGroup_Drillthrough")}}function P(w,C,x,L){var p=(0,h.Dt)(w,C),z=(0,h.LM)(w,C)||p,D=!C||p,U=!!C&&2===C.type||L&&!!C&&(void 0===C.type||0===C.type);return{keepAllFilters:{disabled:D,value:z,tooltip:D&&z?x.keepAllFiltersToggleForcedOnTooltip:x.keepAllFiltersTooltip},crossReportDrillthrough:{show:U,disabled:!C,value:!!U&&(0,h.aQ)(w,C),tooltip:x.crossReportDrillthroughTooltip},linkFieldsDropZoneTitle:x.linkFieldsDropZoneTitle,linkFieldsLinkTypeGroupTitle:x.linkFieldsLinkTypeGroupTitle}}},89839:function(te,G,s){s.d(G,{l:function(){return C}});var h=s(62458),t=s(76001),P=s(80366),w=s(94419);function C(z,D){var I=(0,P._L)((0,t.Q)(z.expr)),V=void 0!==I,S=z.interactivityOptions.dropDownItems;if(S)for(var Q=0,U=S.items;Q<U.length;Q++){var F=U[Q],j=F.key;if(j)switch(j.action){case 4:F.checked=V&&j.aggregate===I;break;case 2:F.checked=!V;break;case 8:var Z=D.config.singleVisual.query.projections[z.role];F.checked=!(!Z||!Z.showAll);break;case 128:F.checked=x(z,F.text);break;case 16:for(var B=0,R=F.children;B<R.length;B++){var W=R[B];W.checked=p(z,W.key.showValueAs)}break;case 2048:F.checked=!1;break;default:F.checked=void 0}}}function x(z,D){var I=function(z){if(!_.isEmpty(z.hierarchyLevels)){var I=z.hierarchyLevels[0].expr;return h.fF.assert(function(){return I.arg instanceof w.jE},"hierarchyLevelExpr.arg should be instanceof powerbi.data.SQHierarchyExpr"),I.arg}}(z);if(I)return I.hierarchy===D;var V=(0,t.Q)(z.expr);return!!V&&(V.columnAggr?V.columnAggr.name===D:V.groupingColumnAggr?V.groupingColumnAggr.name===D:V.column?V.column.name===D:!!V.groupingColumn&&V.groupingColumn.name===D)}function p(z,D){var I=(0,t.Q)(z.expr);if(!I||!D)return!1;switch(D.kind){case void 0:return!I.percentOfGrandTotal&&!I.percentOfRoleTotal;case 0:return!!I.percentOfGrandTotal;case 1:var V=D;return!(!I.percentOfRoleTotal||!_.every(I.percentOfRoleTotal.roles,function(S){return _.includes(V.roles,S)}));default:return!1}}},40702:function(te,G,s){s.d(G,{$0:function(){return I},Es:function(){return Kt},G5:function(){return C},Lo:function(){return Ht},Sd:function(){return Ve},TS:function(){return oe},V1:function(){return de},Y$:function(){return j},Yu:function(){return pe},_Z:function(){return U},_m:function(){return Xt},cF:function(){return P},gW:function(){return Zt},jG:function(){return Qt},lG:function(){return L},rU:function(){return z},yw:function(){return S}});var h=s(41114),t="PBI.ExploreUIAuthoring.ContextMenuButtonClicked",P=h.cx[t]=(0,h.b1)(t),w="PBI.ExploreUIAuthoring.RevertToDefaultClicked",C=h.cx[w]=(0,h.b1)(w),x="PBI.ExploreUIAuthoring.ExpansionButtonClicked",L=h.cx[x]=(0,h.b1)(x),p="PBI.ExploreUIAuthoring.FormattingPaneSearch",z=h.cx[p]=(0,h.b1)(p),D="PBI.ExploreUIAuthoring.InsertSection",I=h.cx[D]=(0,h.b1)(D),V="PBI.ExploreUIAuthoring.DeleteSection",S=h.cx[V]=(0,h.b1)(V),Q="PBI.ExploreUIAuthoring.VisualSession",U=h.cx[Q]=(0,h.b1)(Q,{logExpAssignment:!0}),F="PBI.ExploreUIAuthoring.ReorderTabOrderByPosition",j=h.cx[F]=(0,h.b1)(F),Z="PBI.ReportCreationCopilot.RunSuggestQueries",R=(h.cx[Z]=(0,h.b1)(Z),"PBI.AuthoringCopilotCreatePage.RunSuggestQueries"),H=(h.cx[R]=(0,h.b1)(R),"PBI.ReportCreationCopilot.PageValidation"),J=(h.cx[H]=(0,h.b1)(H),"PBI.ReportCreationCopilot.VisualValidation"),Y=(h.cx[J]=(0,h.b1)(J),"PBI.EX.ChangeFieldWell"),de=h.cx[Y]=(0,h.b1)(Y),q="PBI.EX.ChangeAggregation",oe=h.cx[q]=(0,h.b1)(q),ce="PBI.EX.RemoveConditionalFormatting",Ve=h.cx[ce]=(0,h.b1)(ce),ae="PBI.EX.RemoveDataBars",le=(h.cx[ae]=(0,h.b1)(ae),"PBI.EX.AnalyticsPane.Open"),he=(h.cx[le]=(0,h.b1)(le),"PBI.EX.AnalyticsPane.AddInstance"),pe=h.cx[he]=(0,h.b1)(he),it="PBI.EX.AnalyticsPane.RemoveInstance",nt=(h.cx[it]=(0,h.b1)(it),"PBI.EX.AnalyticsPane.ForecastParameterUpdated"),je=(h.cx[nt]=(0,h.b1)(nt),"PBI.EX.PropertyPane.OnValueChanged"),Ht=h.cx[je]=(0,h.b1)(je),ht="PBI.EX.DrillthroughPane.ChangeLink",ft=(h.cx[ht]=(0,h.b1)(ht),"PBI.EX.NavigateAndSelectVisual"),Kt=h.cx[ft]=(0,h.b1)(ft),mt="PBI.EX.FieldWellAbnormalRename",Qt=h.cx[mt]=(0,h.b1)(mt),yt="PBI.EX.LaunchChangeDetectionDialog",Xt=h.cx[yt]=(0,h.b1)(yt),Ct="PBI.EX.PersonalizeVisual.ChangePerspective",Zt=h.cx[Ct]=(0,h.b1)(Ct),bt="PBI.ReportCreationCopilot.FeedbackLoop.UserResponse",Pt=(h.cx[bt]=(0,h.b1)(bt),"PBI.ReportCreationCopilot.FeedbackLoop"),rt=(h.cx[Pt]=(0,h.b1)(Pt),"PBI.ReportCreationCopilot.UserResponse"),St=(h.cx[rt]=(0,h.b1)(rt),"PBI.ReportCreationCopilot.StageCompleted"),We=(h.cx[St]=(0,h.b1)(St),"PBI.ReportCreationCopilot.TerminalAPIError"),De=(h.cx[We]=(0,h.b1)(We),"PBI.ReportCreationCopilot.TerminalAgentError"),lt=(h.cx[De]=(0,h.b1)(De),"PBI.ReportCreationCopilot.EnsureComplete"),st=(h.cx[lt]=(0,h.b1)(lt),"PBI.CopilotReportAuthoring.Authoring"),xt=(h.cx[st]=(0,h.b1)(st),"PBI.CopilotReportAuthoring.CreatePage"),$e=(h.cx[xt]=(0,h.b1)(xt),"PBI.Copilot.PageCreationTool"),Ge=(h.cx[$e]=(0,h.b1)($e),"PBI.CopilotReportAuthoring.SuggestTopics"),Mt=(h.cx[Ge]=(0,h.b1)(Ge),"PBI.CopilotReportAuthoring.SummarizeDataset"),Ot=(h.cx[Mt]=(0,h.b1)(Mt),"PBI.CopilotReportAuthoring.CloseButtonClicked"),wt=(h.cx[Ot]=(0,h.b1)(Ot),"PBI.CopilotReportAuthoring.ValidateVisual"),Ft=(h.cx[wt]=(0,h.b1)(wt),"PBI.CopilotReportAuthoring.ValidateVisualAdHocQuery"),Te=(h.cx[Ft]=(0,h.b1)(Ft),"PBI.CopilotScenario.Summary.Generated"),me=(h.cx[Te]=(0,h.b1)(Te),"PBI.CopilotScenario.Answer.Generated"),ct=(h.cx[me]=(0,h.b1)(me),"PBI.CopilotScenario.Forecast.Generated"),ut=(h.cx[ct]=(0,h.b1)(ct),"PBI.CopilotReportAuthoring.ValidateField"),Dt=(h.cx[ut]=(0,h.b1)(ut),"PBI.ExploreCopilot.CopilotReferenceClicked"),Le=(h.cx[Dt]=(0,h.b1)(Dt),"PBI.ExploreCopilot.CopilotReferenceHovered"),Me=(h.cx[Le]=(0,h.b1)(Le),"PBI.Copilot.OpenCopilotPaneEditModeFS");h.cx[Me]=(0,h.b1)(Me)},43859:function(te,G,s){s.d(G,{H:function(){return w}});var h=s(50423),t=s(57470),P=s(62458),w=function(){function C(){this.onActiveSection=new h.EventEmitter,this.observedTargetsMap=new Map}return C.prototype.onKeyDown=function(x){var D,L=this.options,p=this.options.sections,z=p.length;switch(x.keyCode){case 37:case 38:D=p.findIndex(function(U){return U===L.currentSection}),this.switchTab(p[(D-1+z)%z],x,!0);break;case 39:case 40:D=p.findIndex(function(U){return U===L.currentSection}),this.switchTab(p[(D+1)%z],x)}},C.prototype.switchTab=function(x,L,p){var z=this;void 0===p&&(p=void 0);var D=L.target,I=new MutationObserver(function(S){for(var Q=function(W){if("attributes"===W.type&&"tabindex"===W.attributeName&&document.activeElement===D){var H=t.M.getFirstMatchingAncestor(D,function(J){return J.hasAttribute(z.options.rootAttribute)}),ne=void 0;ne=p?t.M.getPrevTabbableMatchingSibling(D,function(J){return!!t.M.getFirstMatchingAncestor(J,function(A){return A.hasAttribute(z.options.pivotAttribute)},H,!0)},H):t.M.getNextTabbableMatchingSibling(D,function(J){return!!t.M.getFirstMatchingAncestor(J,function(A){return A.hasAttribute(z.options.pivotAttribute)},H,!0)},H),ne?.focus()}},U=0,F=S;U<F.length;U++)Q(F[U]);var Z=z.observedTargetsMap.has(D);Z||P.fF.assertFail("PivotTabKeyHandler does not have the correct observed target on mutation observer callback - possibly detached early"),I.disconnect();var B=z.observedTargetsMap.get(D);B>1?z.observedTargetsMap.set(D,B-1):Z&&z.observedTargetsMap.delete(D)});I.observe(D,{attributes:!0,attributeFilter:["tabindex"]});var V=this.observedTargetsMap.get(D);this.observedTargetsMap.set(D,V?V+1:1),this.onActiveSection.emit({nextSection:x}),L.stopPropagation()},C.\u0275fac=function(L){return new(L||C)},C.\u0275dir=h.\u0275\u0275defineDirective({type:C,selectors:[["","pivot-tab-key-handler",""]],hostBindings:function(L,p){1&L&&h.\u0275\u0275listener("keydown",function(D){return p.onKeyDown(D)})},inputs:{options:["pivot-tab-key-handler","options"]},outputs:{onActiveSection:"onActiveSection"}}),C}()},64824:function(te,G,s){s.d(G,{R:function(){return P}});var h=s(50423),P=function(){function w(C){this.elementRef=C}return w.prototype.ngOnChanges=function(C){if(C.sectionNumber&&!C.sectionNumber.isFirstChange()){var x=C.sectionNumber.currentValue;null!=x&&this.animateSectionSlide(x,C.sectionNumber.previousValue)}},w.prototype.animateElement=function(C,x,L){C.css(x).animate(L,200)},w.prototype.animateSectionSlide=function(C,x){this.doNotAnimateSection||(C<x?this.animateElement($(this.elementRef.nativeElement),{right:"200%"},{right:0}):C>x&&this.animateElement($(this.elementRef.nativeElement),{"margin-left":"200%"},{"margin-left":0}));var L=$(".".concat(this.navMarkerParent," .navMarker"));if(this.autoWidth){var p=0===C?"margin-left":"margin-right",z=0===C?"margin-right":"margin-left",D={};D[p]="".concat(L.width(),"px"),D[z]="auto";var I={};I[p]="0",this.animateElement(L,D,I)}else this.animateElement(L,{},{"margin-left":L.width()*C+"px"})},w.\u0275fac=function(x){return new(x||w)(h.\u0275\u0275directiveInject(h.ElementRef))},w.\u0275dir=h.\u0275\u0275defineDirective({type:w,selectors:[["","section-animation-slider",""]],inputs:{sectionNumber:"sectionNumber",navMarkerParent:"navMarkerParent",autoWidth:"autoWidth",doNotAnimateSection:"doNotAnimateSection"},features:[h.\u0275\u0275NgOnChangesFeature]}),w}()},84431:function(te,G,s){s.d(G,{Ct:function(){return L},DR:function(){return x},KT:function(){return I},OB:function(){return z},_d:function(){return C},aT:function(){return p},kh:function(){return D}});var h=s(55201),t=s(40812),P=s(50550),w=s(45413),C=function(){function V(S,Q,U,F,j,Z,B,R,W,H,ne,J,A){this.expr=S,this.role=Q,this.startIndex=U,this.endIndex=F,this.valid=j,this.displayOptions=Z,this.interactivityOptions=B,this.hierarchyLevels=R,this.conditionalFormattingRepetitions=W,this.supportedOperations=67108863,this.visualContainerName=H,this.visualType=ne,this.isHiddenInVisual=J,this.supportedOperations=A}return V.prototype.equals=function(S){return this.role===S.role&&(0,w.fS)(this.expr,S.expr)&&this.startIndex===S.startIndex&&this.endIndex===S.endIndex&&this.isEditingLabel===S.isEditingLabel&&this.valid===S.valid&&(this.displayOptions===S.displayOptions||!!(this.displayOptions&&S.displayOptions&&this.displayOptions.equals&&this.displayOptions.equals(S.displayOptions)))&&(this.interactivityOptions===S.interactivityOptions||!!(this.interactivityOptions&&S.interactivityOptions&&this.interactivityOptions.equals&&this.interactivityOptions.equals(S.interactivityOptions)))&&(0,P.NF)(this.conditionalFormattingRepetitions,S.conditionalFormattingRepetitions,t.u9)&&(0,h.L)(this.hierarchyLevels,S.hierarchyLevels)&&this.visualContainerName===S.visualContainerName&&this.visualType===S.visualType&&this.isHiddenInVisual===S.isHiddenInVisual&&this.supportedOperations===S.supportedOperations},V}(),x=function(){function V(S,Q,U,F,j){this.displayName=S,this.tooltipTitle=Q,this.tooltipDescription=U,this.glyph=F,this.pbiStyle=j}return V.prototype.equals=function(S){return this.displayName===S.displayName&&this.tooltipTitle===S.tooltipTitle&&this.tooltipDescription===S.tooltipDescription&&this.glyph===S.glyph&&this.pbiStyle===S.pbiStyle},V}(),L=function(){function V(S,Q,U){this.dropDownItems=S,this.isReplaceable=Q,this.isEditableField=U,this.canAppend=!0,this.canPrepend=!0,this.hasContextMenu=!0,this.isDraggableField=!0,this.isDroppableField=!0,this.isRemovableField=!0}return V.prototype.disableInteractivity=function(){this.canAppend=!1,this.canPrepend=!1,this.hasContextMenu=!1,this.isDraggableField=!1,this.isDroppableField=!1,this.isEditableField=!1,this.isRemovableField=!1},V.prototype.equals=function(S){return this.canAppend===S.canAppend&&this.canPrepend===S.canPrepend&&_.isEqual(this.dropDownItems,S.dropDownItems)&&this.hasContextMenu===S.hasContextMenu&&this.isDraggableField===S.isDraggableField&&this.isDroppableField===S.isDroppableField&&this.isEditableField===S.isEditableField&&this.isRemovableField===S.isRemovableField&&this.isReplaceable===S.isReplaceable},V}(),p=function(){function V(S,Q,U){this.expr=S,this.displayName=Q,this.tooltipTitle=U}return V.prototype.equals=function(S){return(0,w.fS)(this.expr,S.expr)&&this.displayName===S.displayName&&this.tooltipTitle===S.tooltipTitle},V}(),z=function(){function V(S,Q,U,F,j){this.role=S,this.displayName=Q,this.properties=U,this.supportsMultipleItems=F,this.description=j}return V.prototype.equals=function(S){return this.role===S.role&&this.displayName===S.displayName&&(0,h.L)(this.properties,S.properties)&&this.supportsMultipleItems===S.supportsMultipleItems&&this.description===S.description&&(this.warning===S.warning||!!(this.warning&&S.warning&&this.warning.equals&&this.warning.equals(S.warning)))&&this.disabled===S.disabled},V}(),D=function(){function V(S,Q,U){this.glyph=S,this.title=Q,this.description=U}return V.prototype.equals=function(S){return this.glyph===S.glyph&&this.title===S.title&&this.description===S.description},V}(),I=function(){return function(S){this.buckets=S}}()},45925:function(te,G,s){s.d(G,{e:function(){return C}});var h=s(6015),t=s(77476),P=s(17174),w=s(50423),C=function(){function x(){}return x.\u0275fac=function(p){return new(p||x)},x.\u0275mod=w.\u0275\u0275defineNgModule({type:x}),x.\u0275inj=w.\u0275\u0275defineInjector({imports:[t.CommonModule,P.u5,h.C,P.UX]}),x}()},64713:function(te,G,s){s.d(G,{J:function(){return p}});var h=s(81337),t=s(42900),P=s(4437),w=s(73221),C=s(14172),x=s(50423),L=["*"],p=function(z){function D(I){var V=z.call(this)||this;return V.pbiButtonToggleService=I,V}return(0,h.__extends)(D,z),D.prototype.ngOnInit=function(){var I=this;this.changes$("disabled").pipe((0,C.U)(function(V){return(0,P.Ig)(V)})).subscribe(function(V){return I.pbiButtonToggleService.setDisabled(V)}),this.changes$("multiple").pipe((0,C.U)(function(V){return(0,P.Ig)(V)})).subscribe(function(V){return I.pbiButtonToggleService.setMultiple(V)})},D.\u0275fac=function(V){return new(V||D)(x.\u0275\u0275directiveInject(t.r))},D.\u0275cmp=x.\u0275\u0275defineComponent({type:D,selectors:[["pbi-button-toggle-group"]],hostAttrs:["role","group"],hostVars:4,hostBindings:function(V,S){2&V&&x.\u0275\u0275classProp("multiple",S.multiple)("disabled",S.disabled)},inputs:{disabled:"disabled",multiple:"multiple"},features:[x.\u0275\u0275ProvidersFeature([t.r]),x.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:L,decls:1,vars:0,template:function(V,S){1&V&&(x.\u0275\u0275projectionDef(),x.\u0275\u0275projection(0))},encapsulation:2,changeDetection:0}),D}(w.w)},53935:function(te,G,s){s.d(G,{e:function(){return P}});var h=s(77476),t=s(50423),P=function(){function w(){}return w.\u0275fac=function(x){return new(x||w)},w.\u0275mod=t.\u0275\u0275defineNgModule({type:w}),w.\u0275inj=t.\u0275\u0275defineInjector({imports:[h.CommonModule]}),w}()},42900:function(te,G,s){s.d(G,{r:function(){return P}});var h=s(33554),t=s(50423),P=function(){function w(){this.selected$=new h.t(1),this.disabled$=new h.t(1),this.multiple$=new h.t(1)}return w.prototype.select=function(C){this.selected$.next(C)},w.prototype.setDisabled=function(C){this.disabled$.next(C)},w.prototype.setMultiple=function(C){this.multiple$.next(C)},w.\u0275prov=t.\u0275\u0275defineInjectable({token:w,factory:w.\u0275fac=function(x){return new(x||w)}}),w}()},53240:function(te,G,s){s.d(G,{I:function(){return j}});var h=s(81337),t=s(4437),P=s(50423),w=s(17174),C=s(72065),x=s(63057),L=s(14172),p=s(22318),z=s(23558),D=s(83317),I=s(59973),V=s(73805),S=s(57243),Q=s(42900),U=s(77476),F=["*"],j=function(Z){function B(R){var W=Z.call(this)||this;return W.pbiButtonToggleService=R,W.checked=!1,W.supportsNoSelection=!1,W.role="button",W.ariaControls=null,W.id=null,W.valueChanged=new P.EventEmitter,W.onFocus=new P.EventEmitter,W.onBlur=new P.EventEmitter,W}return(0,h.__extends)(B,Z),B.prototype.ngOnInit=function(){this.isDisabled$=(0,x.T)(this.pbiButtonToggleService.disabled$,this.mergePropertyInputsAndFormControl(this.changes$("disabled").pipe((0,L.U)(function(R){return(0,t.Ig)(R)})),this.disabled$,"disabled",this.onDestroy$)).pipe((0,p.O)((0,t.Ig)(this.disabled))),this.setCheckedObservable()},B.prototype.setCheckedObservable=function(){var R=this,W=this.pbiButtonToggleService.multiple$.pipe((0,p.O)(!1)),H=this.mergePropertyInputsAndFormControl(this.changes$("checked"),this.value$,"checked",this.onDestroy$);H.subscribe(function(Y){return R.checked=Y});var ne=this.pbiButtonToggleService.selected$.pipe((0,z.M)(W),(0,D.R)(this.onDestroy$),(0,I.h)(function(Y){return!Y[1]&&R.value!==Y[0]}),(0,V.h)(!1));this.onButtonClicked=this.createEventAdapter();var J=this.onButtonClicked.$.pipe((0,z.M)(W),(0,L.U)(function(Y){var q=Y[1];return Y[0].stopPropagation(),!q&&!R.supportsNoSelection||!R.checked})),A=(0,x.T)(ne,J).pipe((0,S.d)(1));this.checked$=(0,x.T)(H,A),A.pipe((0,z.M)(this.isDisabled$),(0,I.h)(function(Y){return!Y[1]})).subscribe(function(Y){var de=Y[0];de&&R.pbiButtonToggleService.select(R.value),R.checked=de,R.valueChanged.emit(R.checked),R.onValueChange(R.checked),R.onTouched()})},B.\u0275fac=function(W){return new(W||B)(P.\u0275\u0275directiveInject(Q.r))},B.\u0275cmp=P.\u0275\u0275defineComponent({type:B,selectors:[["pbi-button-toggle"]],hostVars:2,hostBindings:function(W,H){2&W&&P.\u0275\u0275classProp("checked",H.checked)},inputs:{value:"value",disabled:"disabled",checked:"checked",supportsNoSelection:"supportsNoSelection",role:"role",ariaControls:"ariaControls",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],buttonTabIndex:"buttonTabIndex"},outputs:{valueChanged:"valueChanged",onFocus:"onFocus",onBlur:"onBlur"},features:[P.\u0275\u0275ProvidersFeature([{provide:w.JU,useExisting:(0,P.forwardRef)(function(){return B}),multi:!0}]),P.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:F,decls:5,vars:17,consts:[["type","button",3,"disabled","tabindex","click","focus","blur"]],template:function(W,H){1&W&&(P.\u0275\u0275projectionDef(),P.\u0275\u0275elementStart(0,"button",0),P.\u0275\u0275listener("click",function(J){return H.onButtonClicked.fn(J)})("focus",function(){return H.onFocus.emit()})("blur",function(){return H.onBlur.emit()}),P.\u0275\u0275pipe(1,"async"),P.\u0275\u0275pipe(2,"async"),P.\u0275\u0275pipe(3,"async"),P.\u0275\u0275projection(4),P.\u0275\u0275elementEnd()),2&W&&(P.\u0275\u0275property("disabled",P.\u0275\u0275pipeBind1(1,11,H.isDisabled$)||null)("tabindex",H.buttonTabIndex),P.\u0275\u0275attribute("value",H.value)("role",H.role)("aria-controls",H.ariaControls)("id",H.id)("aria-pressed","button"===H.role?P.\u0275\u0275pipeBind1(2,13,H.checked$):null)("aria-selected","button"!==H.role?P.\u0275\u0275pipeBind1(3,15,H.checked$):null)("aria-label",H.ariaLabel)("aria-labelledby",H.ariaLabelledby)("aria-describedby",H.ariaDescribedby))},dependencies:[U.AsyncPipe],styles:["button[_ngcontent-%COMP%]{background:transparent;overflow:hidden;border:none;margin:0;padding:0}button[_ngcontent-%COMP%]:focus{outline:none}"],changeDetection:0}),B}(C.N)},2380:function(te,G,s){s.d(G,{O:function(){return z}});var h=s(81337),t=s(11991),P=s(37272),w=s(81905),C=s(23558),x=s(50423),L=s(26124),z=function(D){function I(V,S){return D.call(this,V,S)||this}return(0,h.__extends)(I,D),I.prototype.ngOnInit=function(){var V=this;this.changes$("pbiEmphasisBackground").pipe((0,w.w)(function(Q){return Q||P.E})).pipe((0,C.M)(this.changes$("pbiEmphasisBackgroundColor",!0))).subscribe(function(Q){var j=V.getAnimation("backgroundColor",Q[1]??"var(--globalColorBrand160)");V.emphasize(j)})},I.\u0275fac=function(S){return new(S||I)(x.\u0275\u0275directiveInject(L._j,8),x.\u0275\u0275directiveInject(x.ElementRef))},I.\u0275dir=x.\u0275\u0275defineDirective({type:I,selectors:[["","pbiEmphasisBackground",""]],inputs:{pbiEmphasisBackground:"pbiEmphasisBackground",pbiEmphasisBackgroundColor:"pbiEmphasisBackgroundColor"},features:[x.\u0275\u0275InheritDefinitionFeature]}),I}(t.A)},11991:function(te,G,s){s.d(G,{A:function(){return w}});var h=s(81337),t=s(26124),w=function(C){function x(L,p){var z=C.call(this)||this;return z.animationBuilder=L,z.element=p,z}return(0,h.__extends)(x,C),x.prototype.emphasize=function(L){var p=this;if(this.animationBuilder){var z=function(){var I=p.animationBuilder.build(L),V=p.currentPlayer=I.create(p.element.nativeElement);V.onDestroy(function(){return p.currentPlayer=void 0}),V.play()};this.currentPlayer?(this.currentPlayer.finish(),this.currentPlayer.destroy(),this.requestedAnimationFrameId&&window.cancelAnimationFrame(this.requestedAnimationFrameId),this.requestedAnimationFrameId=window.requestAnimationFrame(function(){z(),p.requestedAnimationFrameId=void 0})):z()}},x.prototype.getAnimation=function(L,p){var z,D,I;return[(0,t.oB)((z={},z[L]="*",z)),(0,t.jt)("100ms ease-out",(0,t.oB)((D={},D[L]=p,D))),(0,t.jt)("500ms ease-out",(0,t.oB)((I={},I[L]="*",I)))]},x}(s(73221).w)},76433:function(te,G,s){s.d(G,{d:function(){return P}});var h=s(77476),t=s(50423),P=function(){function w(){}return w.\u0275fac=function(x){return new(x||w)},w.\u0275mod=t.\u0275\u0275defineNgModule({type:w}),w.\u0275inj=t.\u0275\u0275defineInjector({imports:[h.CommonModule]}),w}()}}]);