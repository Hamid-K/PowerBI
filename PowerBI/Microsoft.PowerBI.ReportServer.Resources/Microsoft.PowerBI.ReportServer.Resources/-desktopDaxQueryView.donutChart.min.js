"use strict";(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["donutChart"],{58668:function(Me,ce,P){P.r(ce),P.d(ce,{DonutChart:function(){return ye},DonutChartConverter:function(){return at},DonutChartWebBehavior:function(){return pt},WebDonutChartAnimator:function(){return ft},animationDurationMs:function(){return Ue},donutChartProps:function(){return ae},ease:function(){return Ge}});var B=P(81337),G=P(94478),k=P(26314),j=P(60066),F=P(32554),u=P(90120),f=P(54522),y=P(5381),I=P(46769),w=P(21181),M=P(33777),z=P(49203),L=P(80065),x=P(51660),W=P(86900),Z=P(38400),X=P(33024),ue=P(51129),te=P(86727),K=P(79811),ee=P(77686),fe=P(70569),ie=P(72902),rt=P(40739),Xe=P(11305),Ve=P(30431),Se=P(82030),O=P(6916),Qe=P(45296),Q=P(62458),Ze=P(41640),Je=P(34644),nt=P(39681),Fe=P(59107),se=P(56578),xe=P(43286),oe=P(10389),Le=P(46135),Ie=P(32379),be=P(82755),J=P(72489),ze=P(26543),q=P(56707),le=P(70188),$e=P(18664),st=P(63972),Oe=P(54086),He=P(32041),pe=P(79154),V={ChartClass:(0,pe.CH)("donutChart"),LegendClass:(0,pe.CH)("donutLegend"),LegendArrowClass:(0,pe.CH)("donutLegendArrow"),SliceClass:(0,pe.CH)("slice"),SliceContainerClass:(0,pe.CH)("slices"),SliceHighlightClass:(0,pe.CH)("slice-highlight"),SubSelectionSlicesClassAndSelector:(0,pe.CH)("sub-selection-slices"),SubSelectionSliceClassAndSelector:(0,pe.CH)("sub-selection-slice"),DefaultStrokeColorName:"foregroundLight",isSingleColor:function(e){if(e.length>1){var t=e.length-1;e[t].data.isLastInDonut=e[t].data.color===e[0].data.color}},UpdateCurrentArcElementFunc:function(e){this._current=e},ArcDescriptorKeyFunc:function(e){return e.data.identity.getKey()}};function Ne(r,e){var t=e.explode;return Math.sin(r)*t}function Te(r,e){var t=e.explode;return-Math.cos(r)*t}function qe(r,e,t,a,i,n,s){void 0===a&&(a=0),void 0===i&&(i=0),void 0===n&&(n=0);var l,h,d,o=.8/.9*1.025;if(a){var c=a,p=e.labelRadius;h=[Math.cos(c)*p,Math.sin(c)*p],d=[Math.cos(c)*p,Math.sin(c)*p]}else h=e.labelArc.centroid(r),d=e.labelArc.centroid(r);s?.pieChartMarginBetweenSlices&&(h[0]=h[0]-i,h[1]=h[1]-n,d[0]=d[0]-i,d[1]=d[1]-n);var g=t.x,C=q.wh/2;return l=[g+=g<0?-C:C,t.y],d[0]*=o,d[1]*=o,[d,h,l]}function _e(r){return r&&r.length>2?[{width:Math.abs(r[1][0]-r[0][0]),height:Math.abs(r[1][1]-r[0][1])},{width:Math.abs(r[2][0]-r[1][0]),height:q.Pd}]:null}function je(r){return r+(r<0?-q.wh:q.wh)}function Ye(r,e){return e.width/2-Math.abs(r)-q.wh}function dt(r,e,t){for(var a=t.left,i=t.left+t.width,n=t.top,s=t.top+t.height,l=0,h=[{x:a,y:n},{x:a,y:s},{x:i,y:n},{x:i,y:s}];l<h.length;l++)if(!ut(r,e,h[l]))return!1;return!0}function ut(r,e,t){var a=Math.sqrt(t.x*t.x+t.y*t.y);if(a<e.innerRadius||a>e.outerRadius)return!1;var i=function(r){if(Q.fF.assertValue(r,"DonutLabelUtils.getAngleFromPoint received a null point"),r){var e=r.x,t=-r.y;Q.fF.assertValue(e,"DonutLabelUtils.getAngleFromPoint received a point containing null"),Q.fF.assertValue(t,"DonutLabelUtils.getAngleFromPoint received a point containing null"),Q.fF.assert(function(){return 0!==e||0!==t},"DonutLabelUtils.getAngleFromPoint received the point (0,0)");var a=Math.atan2(e,t);return a<0&&(a+=2*Math.PI),a}}(t);return!(i<r.startAngle||i>r.endAngle)}var et=[O._q,O.f3,O.ev,O.qv],vt=[0,1,2,3,4],gt=function(){function r(e){this.donutChartProperties=e,this.center={x:e.viewport.width/2,y:e.viewport.height/2},this.labelRadius=this.donutChartProperties.labelRadius;var t=(0,$e.qk)(e.dataLabelsSettings.fontProperties);this.additionalParenthesesWidth=He.b.measureSvgTextWidth(t,"()"),this.additionalSpaceWidth=He.b.measureSvgTextWidth(t," "),this.ellipsisWidth=He.b.measureSvgTextWidth(t,"\u2026")}return r.prototype.layout=function(e,t,a){for(var i=[],n=0,s=e;n<s.length;n++){var o=s[n];i.push({labelDataPoint:o,hasBeenRendered:!1,labelSize:o.textSize})}for(var l=[],h=[],p=new st.qC([{labelDataPoints:i,maxNumberOfLabels:e.length}],this.donutChartProperties.viewport),g=i.length-1;g>=0;g--)i[g].labelDataPoint.isPreferred&&(h=i.splice(g,1).concat(h));if(h.length>0&&(l=this.positionLabels(h,p,t,a)),e.length>0){var m=this.positionLabels(i,p,t,a);l=l.concat(m)}return _.filter(l,function(S){return S.isVisible})},r.prototype.positionLabels=function(e,t,a,i){var n=this,o=[],l=!1,h=function(m){for(var S=0,N=e;S<N.length;S++){var b=N[S];if(!b.hasBeenRendered){var R=m(b,t);if(R){var D=R.label;D&&(R.overflows&&(l=!0),b.hasBeenRendered=!0,o.push(D))}}}},d=function(){h(function(m,S){return{label:n.tryOutsidePositionForDonut(m,S,a,i),overflows:!0}})},c=function(){h(function(m,S){if(_.includes(et,n.donutChartProperties.dataLabelsSettings.labelStyle)){var N=n.splitDonutDataPoint(m,n.donutChartProperties.dataLabelsSettings.labelStyle);return n.tryInsidePositionForDonut(N,n.donutChartProperties,S,a)}return n.tryInsidePositionForDonut(m,n.donutChartProperties,S,a)})};switch(a.position??Se.SX){case Se.SX:d();break;case Se.Od:c();break;case Se.gC:d(),c();break;case Se.UX:c(),d()}if(l&&a.enableBackgroundWithAuto===Ve.d7)for(var p=0,g=o;p<g.length;p++){var C=g[p];C.outside||(C.hasBackground=!0)}return o},r.prototype.tryOutsidePositionForDonut=function(e,t,a,i){var s=e.labelDataPoint.parentShape;if(!_.isEmpty(s.validPositions)&&0!==s.validPositions[0]){var o=s.validPositions[0],l=this.tryAllOutsidePositions(e,t,o,i);if(l&&0===l.score)return this.buildLabel(l,t,!0,a);if(_.includes(et,this.donutChartProperties.dataLabelsSettings.labelStyle)){var h=this.splitDonutDataPoint(e,this.donutChartProperties.dataLabelsSettings.labelStyle),d=this.tryAllOutsidePositions(h,t,o,i);if(d&&(!l||d.score<l.score))return this.buildLabel(d,t,!0,a)}if(l)return this.buildLabel(l,t,!0,a)}},r.prototype.tryInsidePositionForDonut=function(e,t,a,i){var n=this.tryAllInsidePositions(e,t,a,i.overflow);if(n)return{label:this.buildLabel(n,a,!1,i),overflows:n.overflows}},r.prototype.generateCandidate=function(e,t,a,i){var n=e.labelDataPoint,s=r.generateCandidateAngleForPosition(n.donutArcDescriptor,t),o=this.getPointPositionForAngle(s),l=o.point,h=this.score(n,l),d=(n.donutArcDescriptor.startAngle+n.donutArcDescriptor.endAngle)/2,c=Ne(d,this.donutChartProperties),p=Te(d,this.donutChartProperties),g=qe(n.donutArcDescriptor,this.donutChartProperties,l,s,c,p,i),C=_e(g),v=_.clone(n);return v.parentShape=o,v.leaderLinePoints=g,v.linesSize=C,{point:o,score:h,labelRects:r.tryPositionPoint(a,o.validPositions[0],v,this.center,this.donutChartProperties.viewport,0,i),donutLabelDataPointLayoutInfo:{labelDataPoint:v,hasBeenRendered:e.hasBeenRendered,labelSize:e.labelSize},renderLeaderLines:!0,overflows:!1}},r.prototype.tryAllOutsidePositions=function(e,t,a,i){var n=e.labelDataPoint,o=r.tryPositionPoint(t,a,n,this.center,this.donutChartProperties.viewport,this.donutChartProperties.explode,i),l=n.parentShape,h={point:l,score:this.score(n,l.point),labelRects:o,donutLabelDataPointLayoutInfo:e,renderLeaderLines:!0,overflows:!1};if(o&&o.textRect&&0===h.score)return h;var c,d=[];o&&o.textRect?(d=r.getLabelPointPositions(n.parentShape,!0),c=h):d=r.getLabelPointPositions(n.parentShape,!1);for(var p=0,g=d;p<g.length;p++){var v=this.generateCandidate(e,g[p],t,i);if(v.labelRects&&v.labelRects.textRect&&(null==c||v.score<c.score)&&0===(c=v).score)return c}return c},r.prototype.tryAllInsidePositions=function(e,t,a,i){for(var h,d,c,p,n=e.labelDataPoint.angle,s=(t.innerRadius+t.outerRadius)/2,o=Ne(n,t),l=Te(n,t),g=0,C=vt;g<C.length;g++){var R,m=this.getInsidePosition(e,t,n,s,C[g]),S=this.score(e.labelDataPoint,m),N={point:m,radius:0,validPositions:[256]},b=(0,Oe.c)(e.labelDataPoint.textSize,N,256,0);R=0===t.explode?{left:b.left+this.center.x,top:b.top+this.center.y,width:b.width,height:b.height}:{left:b.left+this.center.x+o,top:b.top+this.center.y+l,width:b.width,height:b.height};var D=!dt(e.labelDataPoint.donutArcDescriptor,t,b);(null==c||S>c)&&!a.hasConflict(R)&&(i||!D)&&(h=N,d=R,c=S,p=D)}if(h)return{point:h,score:0,labelRects:{textRect:d,diagonalLineRect:null,horizontalLineRect:null},donutLabelDataPointLayoutInfo:e,renderLeaderLines:!1,overflows:p}},r.prototype.getInsidePosition=function(e,t,a,i,n){var o=i,h=a;switch(n){case 0:break;case 1:o=i+.25*(t.outerRadius-t.innerRadius);break;case 2:o=i-.25*(t.outerRadius-t.innerRadius);break;case 3:h=a+.25*(e.labelDataPoint.donutArcDescriptor.endAngle-e.labelDataPoint.donutArcDescriptor.startAngle);break;case 4:h=a-.25*(e.labelDataPoint.donutArcDescriptor.endAngle-e.labelDataPoint.donutArcDescriptor.startAngle);break;default:Q.fF.assertNever(n)}return function(r,e){var a;return Q.fF.assert(function(){return r<=2*Math.PI&&r>=0},"DonutLabelUtils got an angle that was not betweeen 0 and 2 PI in radians (inclusive)"),a=e*Math.sin(r-Math.PI/2),{x:e*Math.cos(r-Math.PI/2),y:a}}(h,o)},r.prototype.buildLabel=function(e,t,a,i){var d,n=e.labelRects.textRect,s=e.labelRects.horizontalLineRect,o=e.labelRects.diagonalLineRect,h=e.donutLabelDataPointLayoutInfo.labelDataPoint;(null!=h.categoryLabel||null!=h.dataLabel||null!=h.percentLabel)&&(d=!0),t.add(n),s&&t.add(s),o&&t.add(o);var g,c=n.top-this.center.y,p=n.left-this.center.x;switch(a&&(p<0?p+=n.width/2:p-=n.width/2),e.point.validPositions[0]){case 8:g="start";break;case 4:g="end";break;case 256:g="middle";break;default:Q.fF.assertFail("DonutLabelLayout.buildLabel received a shape with an unknown valid position")}var N,b,R,D,C={left:p,top:c,height:n.height,width:n.width},v=(0,le.RC)(this.donutChartProperties.dataLabelsSettings.labelStyle),m=Ye(h.parentShape.point.x,this.donutChartProperties.viewport),S=m,T=w.Gv;if(v===O.YK.categoryAndDataAndPercent?null==h.secondRowText?S=m/=3:S/=2:v===O.YK.categoryAndData?null==h.secondRowText&&(S=m/=2):(v===O.YK.categoryAndPercent||v===O.YK.dataAndPercent)&&null==h.secondRowText&&(S=m/=2),(0,xe.yE)(v,O.nO)){var E=void 0;(E=v!==O.YK.categoryAndDataAndPercent&&v!==O.YK.categoryAndData||null!=h.secondRowText?S:S-this.additionalSpaceWidth)<this.ellipsisWidth&&(d=!1),N=T({label:h.dataLabel,maxWidth:E,fontProperties:h.fontProperties})}if((0,xe.yE)(v,O.mA)&&(m<this.ellipsisWidth&&(d=!1),b=T({label:h.categoryLabel,maxWidth:m,fontProperties:h.fontProperties})),(0,xe.yE)(v,O.tG)){switch(E=void 0,v){case O.YK.categoryAndDataAndPercent:E=S-this.additionalParenthesesWidth-this.additionalSpaceWidth;break;case O.YK.dataAndPercent:E=null==h.secondRowText?S-this.additionalParenthesesWidth-this.additionalSpaceWidth:S-this.additionalParenthesesWidth;break;case O.YK.categoryAndPercent:E=S-this.additionalSpaceWidth;break;case O.YK.percent:E=S;break;default:Q.fF.assertFail("Unexpected labelStyle: "+v),E=S}E<this.ellipsisWidth&&(d=!1),R=T({label:h.percentLabel,maxWidth:E,fontProperties:h.fontProperties})}switch(N&&"\u2026"!==N||b&&"\u2026"!==b||R&&"\u2026"!==R||(d=!1),v){case O.YK.categoryAndDataAndPercent:R=R?"(".concat(R,")"):null,null==h.secondRowText?D=(0,le.Ej)([b,N,R]," "):(D=(0,le.Ej)([N,R]," "),h.secondRowText=b);break;case O.YK.categoryAndData:null==h.secondRowText?D=(0,le.Ej)([b,N]," "):(D=N,h.secondRowText=b);break;case O.YK.categoryAndPercent:null==h.secondRowText?D=(0,le.Ej)([b,R]," "):(D=R,h.secondRowText=b);break;case O.YK.dataAndPercent:R=R?"(".concat(R,")"):null,null==h.secondRowText?D=(0,le.Ej)([N,R]," "):(D=R,h.secondRowText=N);break;case O.YK.data:D=N;break;case O.YK.percent:D=R;break;case O.YK.category:D=b;break;default:Q.fF.assertFail("Unexpected labelStyle: "+v),D=b}return h.textSize.width=Math.min(h.textSize.width,v===O.YK.categoryAndDataAndPercent&&null==h.secondRowText?m+S+S:v===O.YK.categoryAndData||v===O.YK.categoryAndPercent?m+S:v===O.YK.dataAndPercent?S+S:m),{boundingBox:C,text:D,tooltip:a?h.tooltip:null,isVisible:d,identity:h.identity,fontProperties:(0,$e.ED)(h.fontProperties,{color:a?h.outsideFill:h.insideFill}),selected:!1,textAnchor:g,leaderLinePoints:e.renderLeaderLines?h.leaderLinePoints:void 0,hasBackground:!a&&i.enableBackgroundWithAuto===Ve.on,secondRowText:h.secondRowText,backgroundColor:h.backgroundColor,backgroundTransparency:h.backgroundTransparency,outside:a}},r.tryPositionPoint=function(e,t,a,i,n,s,o){void 0===s&&(s=0);var h,l=a.parentShape;h=o?.pieChartMarginBetweenSlices?q.ki-s<q.ki?q.ki:q.ki-s:q.ki;var d=_.clone(a.textSize);d.width=Math.min(d.width,Ye(l.point.x,n));var c=(0,Oe.c)(d,l,t,h),g=(0,Oe.c)(a.linesSize[0],{point:{x:a.leaderLinePoints[0][0],y:a.leaderLinePoints[0][1]<0?a.leaderLinePoints[1][1]:a.leaderLinePoints[0][1]},radius:0,validPositions:null},t,h),v=(0,Oe.c)(a.linesSize[1],{point:{x:a.leaderLinePoints[1][0],y:a.leaderLinePoints[1][1]},radius:0,validPositions:null},t,h);if(c&&g&&v){c.left+=i.x,c.top+=i.y;var m=i.x-c.width/2;if(g.left+=m,g.top+=i.y,v.left+=m,v.top+=i.y,!e.hasConflict(c)&&!e.hasConflict(g)&&!e.hasConflict(v))return{textRect:c,diagonalLineRect:g,horizontalLineRect:v}}},r.getLabelPointPositions=function(e,t){var a=e.validPositions[0];return t?e.point.y<0?8===a?[64]:[128]:8===a?[16]:[32]:4===a?[128,32]:[16,64]},r.prototype.splitDonutDataPoint=function(e,t){var s,a=e.labelDataPoint,i=a.categoryLabelSize?a.categoryLabelSize.width:0,n=a.dataLabelSize?a.dataLabelSize.width:0;s=a.percentLabelSize?t===O.qv?a.percentLabelSize.width+this.additionalParenthesesWidth:t===O._q?a.percentLabelSize.width+this.additionalParenthesesWidth+this.additionalSpaceWidth:a.percentLabelSize.width:0;var o=a.categoryLabelSize?a.categoryLabelSize.height:0,l=a.dataLabelSize?a.dataLabelSize.height:0,h=a.percentLabelSize?a.percentLabelSize.height:0,d={width:t===O.qv?Math.max(n,s):Math.max(i,n+s),height:2*Math.max(o,Math.max(l,h))},c=_.clone(a);return c.textSize=d,c.secondRowText=t===O.qv?a.dataLabel:a.categoryLabel,{labelDataPoint:c,hasBeenRendered:e.hasBeenRendered,labelSize:e.labelSize}},r.generateCandidateAngleForPosition=function(e,t){var a=e.startAngle+(e.endAngle-e.startAngle)/2;switch(t){case 64:case 32:return(e.startAngle+a-Math.PI)/2;case 128:case 16:return(a+e.endAngle-Math.PI)/2;default:Q.fF.assertFail("Unsupported label position")}},r.prototype.getPointPositionForAngle=function(e){var t=je(Math.cos(e)*this.labelRadius);return{point:{x:t,y:Math.sin(e)*this.labelRadius},validPositions:[t<0?4:8],radius:0}},r.prototype.score=function(e,t){var i,a=Ye(t.x,this.donutChartProperties.viewport),n=this.donutChartProperties.dataLabelsSettings.labelStyle,s=e.categoryLabelSize?e.categoryLabelSize.width:0,o=e.dataLabelSize?e.dataLabelSize.width:0,l=e.percentLabelSize?e.percentLabelSize.width:0;if(n===O._q){if(null!=e.secondRowText){var h=Math.max(s-a,0),d=Math.max(Math.max(o,l+this.additionalParenthesesWidth+this.additionalSpaceWidth)-a/2,0);return Math.max(h,d)}i=Math.max(s,o+this.additionalSpaceWidth,l+this.additionalParenthesesWidth+this.additionalSpaceWidth),a/=3}else n===O.f3&&null==e.secondRowText?(i=Math.max(s,o+this.additionalSpaceWidth),a/=2):n===O.ev&&null==e.secondRowText?(i=Math.max(s,l+this.additionalSpaceWidth),a/=2):n===O.qv?(i=null==e.secondRowText?Math.max(o,l+this.additionalParenthesesWidth+this.additionalSpaceWidth):Math.max(o,l+this.additionalParenthesesWidth),a/=2):i=e.textSize.width;return Math.max(i-a,0)},r}(),ft=function(r){function e(t){return r.call(this,t)||this}return(0,B.__extends)(e,r),e.prototype.animate=function(t){var a,i,s,o,n=this;if(t.viewModel.highlightsOverflow||!this.previousViewModel||this.previousViewModel.highlightsOverflow)return this.previousViewModel=t.viewModel,e.FailedResult;var l=null===(s=this.previousViewModel)||void 0===s?void 0:s.hasHighlights,h=t.viewModel.hasHighlights,d=h&&!l?0:h&&l?1:!h&&l?2:void 0;if(null==d)return this.previousViewModel=t.viewModel,e.FailedResult;var c=function(D){return D.style("fill",function(T){var E;return null!==(E=T.data.color)&&void 0!==E?E:t.colors.getNewColorScale().getColor(T.data.identity.getKey()).value}).style("stroke",u.v.getThemeColor(t.style,V.DefaultStrokeColorName)).style("stroke-width",function(T){return T.data.strokeWidth})},p=function(D,T){return D.style("fill-opacity",T).style("stroke-opacity",T)},g=function(D){return D.transition().duration(n.animationDuration)},C=function(D,T){V.isSingleColor(D);var E=t.graphicsContext.select(V.SliceContainerClass.selector).selectAll(T.selector).data(D,V.ArcDescriptorKeyFunc);return{updated:E.enter().insert("path").classed(T.class,!0).each(V.UpdateCurrentArcElementFunc).merge(E),removed:E.exit()}},v=(a=C(t.viewModel.dataPoints,V.SliceClass)).updated,m=a.removed;c(v),p(v,2===d?function(R){return(0,j.eR)(R.data.selected,!1,R.data.selected,!R.data.selected)}:function(R){return(0,j.eR)(R.data.selected,!1,!1,t.viewModel.hasHighlights)});var S=g(v).attrs(t.layout.shapeLayout.attrs).styles(t.layout.shapeLayout.styles);2===d&&p(S=S.transition().duration(0),function(R){var D;return(0,j.eR)(R.data.selected,!1,null===(D=t.interactivityService)||void 0===D?void 0:D.hasSelection(),!1)}),m.remove();var N=(i=C(t.viewModel.dataPoints.filter(function(R){return null!=R.data.highlightRatio}),V.SliceHighlightClass)).updated,b=i.removed;return 2===d?(c(b),p(b,function(){return(0,j.eR)(!1,!0,!1,!0)}),g(b).attrTween("d",t.layout.highlightShapeTween(d)).styles(null!==(o=t.interactivityService)&&void 0!==o&&o.hasSelection()?t.layout.zeroShapeLayout.styles:t.layout.shapeLayout.styles).remove()):(c(N),p(N,function(R){var D;return(0,j.eR)(R.data.selected,!0,null===(D=t.interactivityService)||void 0===D?void 0:D.hasSelection(),t.viewModel.hasHighlights)}),0===d&&N.attrs(t.layout.shapeLayout.attrs).styles(t.layout.shapeLayout.styles),g(N).attrTween("d",t.layout.highlightShapeTween(d)).styles(t.layout.highlightShapeLayout.styles),b.remove()),(0,y.gm)({labelContext:t.labelGraphicsContext,backgroundContext:t.labelBackgroundContext,dataLabels:t.labels,hasTooltip:!0,numeric:!1,twoRows:!0,formatMode:t.formatMode,onObject:t.onObject}),(0,y.z8)(t.labelGraphicsContext,t.labels),this.previousViewModel=t.viewModel,{failed:!1,shapes:v,highlightShapes:N}},e.FailedResult={failed:!0,shapes:null,highlightShapes:null},e}(G.r5),he=P(30237),pt=function(){function r(){}return r.prototype.bindEvents=function(e,t,a,i){this.root=e.root,this.slices=e.slices,this.highlightSlices=e.highlightSlices,this.hasHighlights=e.hasHighlights,this.visualInstanceId=e.visualInstanceId;var n=e.clearCatcher;if(i)(0,he.FO)(this.slices),this.highlightSlices&&(0,he.FO)(this.highlightSlices),(0,he.to)(this.root),(0,he.Jv)(this.root),(0,he.BV)(this.root),(0,he.wf)(this.slices),n.on("click",null);else{if((0,he.a0)(this.slices,t),this.highlightSlices&&(0,he.a0)(this.highlightSlices,t),a){var s=a.dataPointNavigationManager,o=a.pointSourceKey;s.isEmpty(o)||((0,he.lt)(this.root,t),(0,he.zV)(this.root,this.visualInstanceId,o),(0,he.W3)(this.root,s,o),(0,he.I8)(this.slices,s,o))}n.on("click",function(){var l=d3.event;Fe.M.isCtrlOrMeta(l)||t.handleClearSelection()})}},r.prototype.renderFocus=function(e){var t="".concat(j.aY,"-").concat(this.visualInstanceId);this.root.select("#"+t).attr("id",null),e&&(e.setAttribute("id",t),Fe.M.focus(e))},r.prototype.renderSelection=function(e){var t=this.hasHighlights;this.slices.style("fill-opacity",function(a){return(0,j.eR)(a.data.selected,!1,e,t)}).style("stroke-opacity",function(a){return(0,j.eR)(a.data.selected,!1,e,t)}).attr("aria-selected",function(a){return a.data.selected}),this.highlightSlices&&this.highlightSlices.style("fill-opacity",function(a){return(0,j.eR)(a.data.selected,!0,e,t)}).style("stroke-opacity",function(a){return(0,j.eR)(a.data.selected,!0,e,t)})},r}(),Ue=500,Ge="cubic-in-out",ae={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"},labelColor:{objectName:"legend",propertyName:"labelColor"}},slices:{innerRadiusRatio:{objectName:"slices",propertyName:"innerRadiusRatio"},startAngle:{objectName:"slices",propertyName:"startAngle"},borderWidth:{objectName:"slices",propertyName:"borderWidth"},borderColor:{objectName:"slices",propertyName:"borderColor"},explode:{objectName:"slices",propertyName:"explode"}},labels:{position:{objectName:"labels",propertyName:"position"},overflow:{objectName:"labels",propertyName:"overflow"},background:{objectName:"labels",propertyName:"background"}}},ye=function(){function r(e){this.featureSwitches={},e&&(this.isDonutChart=0!==e.sliceWidthRatio,this.animator=e.animator,this.isScrollable=!!e.isScrollable&&e.isScrollable,this.disableGeometricCulling=!!e.disableGeometricCulling&&e.disableGeometricCulling,this.behavior=e.behavior,this.tooltipsEnabled=e.tooltipsEnabled,e.smallViewPortProperties&&(this.maxHeightToScaleDonutLegend=e.smallViewPortProperties.maxHeightToScaleDonutLegend))}return Object.defineProperty(r.prototype,"showPlaceholders",{get:function(){var t;return(null===(t=this.featureSwitches)||void 0===t?void 0:t.onObject)&&1===this.viewMode&&this.isSelected},enumerable:!1,configurable:!0}),r.getDefaultDonutLabelSettings=function(e){return(0,B.__assign)((0,B.__assign)({},r.getDefaultLabelSettings(e)),{labelStyle:O.W3,percentagePrecision:q.Qc,position:Se.SX,overflow:!0,enableBackgroundWithAuto:Ve.d7,bold:!1,italic:!1,underline:!1})},r.converter=function(e,t,a,i,n,s,o,l,h){void 0===l&&(l=!0);var d=new at(e,t,a,l);d.convert();var C,c=d.startAngle*(Math.PI/r.OnePiRadianInDegree),p=c+2*Math.PI,g=d3.pie().startAngle(c).endAngle(p).sort(null).value(function(S){return S.percentage});o&&(C=!d.hasCategoryData&&d.hasSeriesData?ie.jN.SeriesOnly:d.hasCategoryData&&d.hasSeriesData?ie.jN.CategoryFirst:ie.jN.CategoryOnly,o.applySelectionStateToData(d.dataPoints),o.applySelectionStateToData(d.legendData.dataPoints));var m,v=!s&&n?r.cullDataByViewport(d.dataPoints,d.maxValue,n,t.isHighContrast,d.borderWidth,h):d.dataPoints;return h&&h.onObject&&i&&(m=this.getSubSelectionArcDescriptors({dataView:e,dataPoints:v,hasCategoryData:d.hasCategoryData,hasDynamicSeries:d.hasDynamicSeries,startAngle:c,endAngle:p})),{dataPointsToDeprecate:v,dataPoints:g(v),unCulledDataPoints:d.dataPoints,dataPointsToEnumerate:d.legendData.dataPoints,legendData:d.legendData,hasHighlights:d.hasHighlights,highlightsOverflow:d.highlightsOverflow,dataLabelsSettings:d.dataLabelsSettings,legendObjectProperties:d.legendObjectProperties,maxValue:d.maxValue,visibleGeometryCulled:d.dataPoints.length!==v.length,hasNegativeValues:d.hasNegativeValues,allValuesAreNegative:d.allValuesAreNegative,donutInnerRadiusRatio:d.donutInnerRadiusRatio,startAngle:d.startAngle,navigationStrategy:C,explode:d.explode,borderWidth:d.borderWidth,borderColor:d.borderColor,hasDynamicSeries:d.hasDynamicSeries,hasSeriesData:d.hasSeriesData,hasCategoryData:d.hasCategoryData,subSelectionDataPoints:m}},r.getSubSelectionArcDescriptors=function(e){for(var a=e.endAngle,i=e.hasCategoryData,n=e.hasDynamicSeries,s=e.startAngle,o={},l=0,h=e.dataPoints;l<h.length;l++){var d=h[l],c=d.categoryIndex,p=d.seriesIndex,g=d.percentage,C=i||!n,v=C?c:p,m=o[v];m||(o[v]=m={displayName:C?d.categoryLabel:d.label,percentage:0,categoryIndex:C?c:void 0,seriesIndex:C?void 0:p}),m.percentage+=g}var N=_.values(o);return d3.pie().startAngle(s).endAngle(a).sort(null).value(function(R){return R.percentage})(N)},r.prototype.getFirstElement=function(){var e=this.flattenViewModel();return _.isEmpty(e)?{element:null}:{element:this.findHTMLElement(e[0].categoryIndex,e[0].seriesIndex)}},r.prototype.getNextDataPoint=function(e,t,a){var i=this.flattenViewModel(),n=(0,z.R)(i,e,t,this.data.navigationStrategy,a);return{element:this.findHTMLElement(n.categoryIndex,n.seriesIndex)}},r.prototype.findHTMLElement=function(e,t){return this.mainGraphicsContext.selectAll(V.SliceClass.selector).filter(function(a){return a.data.categoryIndex===e&&a.data.seriesIndex===t}).node()},r.prototype.flattenViewModel=function(){return this.data.dataPoints.map(function(e){return{categoryIndex:e.data.categoryIndex,seriesIndex:e.data.seriesIndex}})},r.prototype.getDefaultDonutData=function(){return{dataPointsToDeprecate:[],dataPointsToEnumerate:[],dataPoints:[],unCulledDataPoints:[],legendData:(0,K.Fe)(this.style),hasHighlights:!1,highlightsOverflow:!1,dataLabelsSettings:r.getDefaultDonutLabelSettings(this.style),hasDynamicSeries:!1,hasNegativeValues:!1,allValuesAreNegative:!1,donutInnerRadiusRatio:this.isDonutChart?r.DefaultDonutInnerRadiusRatio:0,startAngle:r.DefaultStartAngleDegrees,navigationStrategy:null,explode:r.DefaultExplode,borderWidth:r.DefaultBorderWidth,borderColor:V.DefaultStrokeColorName,hasCategoryData:!1,hasSeriesData:!1}},r.prototype.init=function(e){var a,i,t=this;this.options=e,this.featureSwitches=e.featureSwitches||{};var n=e.element;if(n.empty(),this.parentViewport=e.viewport,this.viewMode=e.host.getViewMode(),this.currentViewport={height:e.viewport.height,width:e.viewport.width,scale:e.viewport.scale},this.style=e.style,this.colors=this.style.colorPalette.dataColors,this.data=this.getDefaultDonutData(),this.radius=0,this.maxOffset=0,this.mobileInteractiveLegend=!(null===(a=e.interactivity)||void 0===a||!a.mobileTileInteractive),this.hostService=e.host,this.behavior&&(this.interactivityService=(0,ie.ub)(this.hostService,this.featureSwitches)),this.legend=(0,fe.OG)(n,this.mobileInteractiveLegend,this.interactivityService,this.isScrollable,void 0,this.style,this.hostService),this.tooltipService=(0,rt.r)(this.hostService),this.mobileInteractiveLegend&&(this.legendContainer=d3.select(n.get(0)).append("div").classed(V.LegendClass.class,!0),this.interactivityState={interactiveLegend:new yt(this,this.legendContainer,this.colors,e),valueToAngleFactor:0,sliceAngles:[],currentRotate:0,interactiveChosenSliceFinishedSetting:!1,lastChosenInteractiveSliceIndex:0,totalDragAngleDifference:0,currentIndexDrag:0,previousIndexDrag:0,previousDragAngle:0,donutCenter:{x:0,y:0}}),this.featureSwitches.onObject){var o=(null===(i=this.hostService)||void 0===i?void 0:i.getSubSelectionService())??W.D.createWithDefaultHost();this.subSelectionHelper=x.O5.createHtmlSubselectionHelper({selectorCallback:function(d){return t.getSelectorsByColumnSubSelection(d)},customOutlineCallback:function(d){return t.getCustomSubSelectionOutlines(d)},hostElement:n.get(0),hostServices:this.hostService,renderer:o,targetSource:"format",scale:function(){return t.currentViewport.scale}})}if(this.svg=d3.select(n.get(0)).append("svg").style("position","absolute").classed(V.ChartClass.class,!0),this.behavior&&(this.clearCatcher=(0,ie.EX)(this.svg)),this.mainGraphicsContext=this.svg.append("g"),this.mainGraphicsContext.append("g").classed(V.SliceContainerClass.class,!0),this.interactivityService){var l=Fe.M.isInternetExplorerOrEdge();this.mainGraphicsContext.attr("tabindex",0).attr("focusable",!0).attr("aria-label",this.hostService.getLocalizedString("Visual_Plot")).attr("aria-multiselectable",!0).attr("role","listbox").classed(j.Pg,!l)}this.labelBackgroundGraphicsContext=this.svg.append("g").classed(q.u9.class,!0),this.labelGraphicsContext=this.svg.append("g").classed(q.ZL.class,!0),this.pie=d3.pie().sort(null).value(function(h){return h.percentage})},r.prototype.onViewModeChanged=function(e){this.ensurePlaceholders(e,this.isSelected)},r.prototype.onSelectionStateChanged=function(e){this.ensurePlaceholders(this.viewMode,e)},r.prototype.ensurePlaceholders=function(e,t){var a=this.showPlaceholders;this.isSelected=t,this.viewMode=e,a!==this.showPlaceholders&&!this.mobileInteractiveLegend&&this.data&&this.legend&&this.renderLegend(this.formatMode)},r.prototype.update=function(e){var t,a;Q.fF.assertValue(e,"updateOptions");var i=e.dataViews,n=e.formatMode,s=e.subSelections,o=e.suppressAnimations,l=e.type,h=e.viewport;if(this.formatMode=n,this.parentViewport=h,this.featureSwitches.onObject&&(this.subSelectionHelper.setFormatMode(n),null===(t=this.interactivityService)||void 0===t||t.setFormatMode(n)),l===Le.EP.Resize||l===Le.EP.ResizeEnd||(this.dataViews=i,this.data=(null===(a=this.dataViews)||void 0===a?void 0:a.length)>0&&this.dataViews[0].categorical?r.converter(this.dataViews[0],this.style,this.isDonutChart,n,this.parentViewport,this.disableGeometricCulling,this.interactivityService,this.tooltipsEnabled,this.featureSwitches):this.getDefaultDonutData()),this.mobileInteractiveLegend||this.renderLegend(n),this.initViewportDependantProperties(),this.updateDonutProperties(),this.updateInternal(this.data,o,n),this.dataViews){var c=(0,M.b)(this.dataViews,!1,!1,!1,["Tooltips"]);this.data.allValuesAreNegative?c.push(new Qe.fi):this.data.hasNegativeValues&&c.push(new Qe.v3),this.hostService.setWarnings(c)}if(this.subSelectionHelper&&(l&Le.EP.Data||l&Le.EP.Resize||l&Le.EP.FormattingSubSelectionChange)&&(this.subSelectionHelper.updateOutlinesFromSubSelections(s,!0),this.hostService.alertScreenReader&&l&Le.EP.FormattingSubSelectionChange)){var C=this.subSelectionHelper.getLabelsFromSubSelections(s,["aria-label"]),v=C?.length&&C.join(" ");v&&this.hostService.alertScreenReader(v)}},r.prototype.getLegendCard=function(){return(0,te.ZF)({legendData:this.data.legendData},this.hostService,this.featureSwitches)},r.prototype.getSlicesCard=function(){var e=this;if(this.data){var t=k.V9.slices,a=function(l){return e.hostService.getLocalizedString(l)},i=[k.V9.dataPoint.fill,t.innerRadiusRatio,t.borderColor,t.borderWidth,t.explode],n=new se.CQ(new se.lg("slices"),"Role_DisplayName_Slices",i,a),s=(0,te.l3)(this.data.legendData);return s.length>0&&n.addGroup("colors",function(o){o.withDisplayName("Visual_Colors"),(0,F.y0)({groupBuilder:o,dataPoints:s,seriesColorProps:k.V9.dataPoint,localize:a,featureSwitches:e.featureSwitches})}),this.featureSwitches.pieChartMarginBetweenSlices?(0!==this.maxOffset&&this.data.explode>this.maxOffset&&(this.data.explode=this.maxOffset),n.addGroup("border",function(o){o.withDisplayName("Visual_Border").addSimpleSlice("borderColor",new se.BT({descriptor:t.borderColor,value:{value:e.data.borderColor}}).build()).addSimpleSlice("borderWidth",new se.JN({descriptor:k.V9.slices.borderWidth,value:e.data.borderWidth,localize:a}).build())}),n.addGroup("spacing",function(o){o.withDisplayName("Visual_Spacing").addSimpleSlice("innerRadius",new se.JN({descriptor:t.innerRadiusRatio,value:Math.round(100*e.data.donutInnerRadiusRatio/r.OuterRadiusRatio),localize:a,options:{minValue:{type:0,value:0},maxValue:{type:1,value:99},unitSymbol:X.t2}}).build()).addSimpleSlice("explode",new se.JN({descriptor:t.explode,value:e.data.explode,localize:a}).build())})):this.isDonutChart&&n.addGroup("spacing",function(o){o.withDisplayName("Visual_Spacing").addSimpleSlice("innerRadius",new se.JN({descriptor:t.innerRadiusRatio,value:Math.round(100*e.data.donutInnerRadiusRatio/r.OuterRadiusRatio),localize:a,options:{minValue:{type:0,value:0},maxValue:{type:1,value:99},unitSymbol:X.t2}}).build())}),n.build()}},r.prototype.getDetailLabelsCard=function(){var t,a,e=this,i=(0,B.__assign)((0,B.__assign)({},(0,w.kL)("labels")),{position:k.V9.labels.position,overflow:k.V9.labels.overflow,background:k.V9.labels.background}),n=new se.CQ(new se.lg("labels"),"Visual_DetailLabels",i,function(s){return e.hostService.getLocalizedString(s)});return(0,w.XQ)({cardBuilder:n,dataLabelsProps:i,featureSwitches:this.featureSwitches,hostServices:this.hostService,options:{dataLabelsSettings:null!==(a=null===(t=this.data)||void 0===t?void 0:t.dataLabelsSettings)&&void 0!==a?a:r.getDefaultDonutLabelSettings(this.style),show:!0,displayUnits:!0,precision:!0,percentagePrecision:!0,fontSize:!0,fontFamily:!0,labelStyle:!0,style:this.style,bold:!0,italic:!0,underline:!0},omitDescription:!0,individualSelector:this.getLabelIndividualSelector()})},r.prototype.getRotationCard=function(){var e=this;if(this.data){var t=function(i){return e.hostService.getLocalizedString(i)};return new se.CQ(new se.lg("rotation"),"Visual_BasicShape_Rotate",[k.V9.slices.startAngle],t).addGroup("default",function(a){return a.addSimpleSlice("rotation",new se.JN({descriptor:k.V9.slices.startAngle,value:e.data.startAngle,options:{minValue:{type:0,value:0},maxValue:{type:1,value:360},unitSymbol:X.g},localize:t}).build(),function(i){return i.withCustomDisplayName("Visual_BasicShape_Rotate")})}).build()}},r.prototype.getFormattingModel=function(){var e=this;if(this.data)return new se.Nq(function(){return e.getLegendCard()},function(){return e.getSlicesCard()},function(){return e.getDetailLabelsCard()},function(){return e.getRotationCard()}).build()},r.prototype.setInteractiveChosenSlice=function(e,t){var a=this;if(0!==this.interactivityState.sliceAngles.length){this.interactivityState.lastChosenInteractiveSliceIndex=e,this.interactivityState.interactiveChosenSliceFinishedSetting=!1;var i=this.currentViewport,n=e%this.data.dataPoints.length,s=this.interactivityState.sliceAngles[n],o=this.svg.select("g");o.transition().duration(t??Ue).ease((0,Je.Ad)(Ge)).attr("transform",(0,oe.I2)(i.width/2,i.height/2,0,0,s)).on("end",function(){a.interactivityState.interactiveChosenSliceFinishedSetting=!0}),this.interactivityState.currentRotate=s,this.interactivityState.interactiveLegend.updateLegend(n),this.svg.selectAll(V.SliceClass.selector).attr("opacity",function(l,h){return(0,j.eR)(h===n,!1,!0,!1)}),(0,oe.bL)(this.options,o)}},r.prototype.calculateRadius=function(){var e,t=this.currentViewport;if(!this.mobileInteractiveLegend&&null!==(e=this.data)&&void 0!==e&&e.dataLabelsSettings.show){var i=2+1/(1+Math.exp(-5*(t.height/t.width-1)));return Math.min(t.height,t.width)/i}return Math.min(t.height,t.width)/2},r.prototype.getScaleForLegendArrow=function(){return this.maxHeightToScaleDonutLegend&&this.currentViewport.height<this.maxHeightToScaleDonutLegend?this.currentViewport.height/this.maxHeightToScaleDonutLegend:1},r.prototype.initViewportDependantProperties=function(e){var t=this;void 0===e&&(e=0),this.currentViewport.height=this.parentViewport.height,this.currentViewport.width=this.parentViewport.width,this.currentViewport.scale=this.parentViewport.scale;var a=this.currentViewport;if(this.mobileInteractiveLegend)a.height-=r.InteractiveLegendContainerHeight;else{var i=this.legend.getMargins();a.height-=i.height,a.width-=i.width}this.svg.attr("width",a.width).attr("height",a.height),this.mobileInteractiveLegend?(this.legendContainer.style("width","100%").style("height",r.InteractiveLegendContainerHeight+"px").style("overflow","hidden").style("top",0),this.svg.style("top",r.InteractiveLegendContainerHeight)):(0,ee.xz)(this.svg,this.legend),this.previousRadius=this.radius,this.radius=this.calculateRadius();var n=this.radius*r.LabelRadiusRatio;this.outerArc=d3.arc(),this.labelArc=d3.arc().innerRadius(n).outerRadius(n-this.data.explode);var s=function(l){(t.mobileInteractiveLegend?l:l.transition().duration(e)).attr("transform",(0,oe.Iu)(a.width/2,a.height/2))};s(this.mainGraphicsContext),s(this.labelGraphicsContext),s(this.labelBackgroundGraphicsContext),(0,oe.bL)(this.options,this.mainGraphicsContext,this.labelGraphicsContext,this.labelBackgroundGraphicsContext)},r.prototype.updateDonutProperties=function(){var i,e=this.radius*r.LabelRadiusRatio,t=this.radius*r.OuterRadiusRatio-this.data.explode,a=this.radius*this.data.donutInnerRadiusRatio;2*t+5<Math.min(this.currentViewport.height,this.currentViewport.width)&&(i=Math.round(this.radius*r.OuterRadiusRatio-(this.data.explode+1)),i=Math.min(50,Math.max(0,i))),(Math.round(t-a)<r.MinDonutThickness||this.radius*r.OuterRadiusRatio+this.data.explode>e)&&(this.data.explode=0),this.donutProperties={viewport:this.currentViewport,outerArc:this.outerArc.innerRadius(0).outerRadius(a),labelArc:this.labelArc,dataLabelsSettings:this.data.dataLabelsSettings,innerRadius:a,outerRadius:t,labelRadius:e,startAngle:this.data.startAngle,explode:this.data.explode,maxOffset:i}},r.prototype.mergeDatasets=function(e,t){for(var a={},i=0,n=t;i<n.length;i++){var s=n[i],o=s.identity?s.identity.getKey():s.data.identity.getKey();a[o]=null}var l=_.filter(e,function(d){return!((d.identity?d.identity.getKey():d.data.identity.getKey())in a)}),h=_.map(l,function(d){var c=(0,nt.ED)(d);return void 0===c.percentage?c.data.percentage=0:c.percentage=0,c});return(0,B.__spreadArray)((0,B.__spreadArray)([],t,!0),h,!0)},r.prototype.updateInternal=function(e,t,a){var i;if(this.animator){var n=this.getDonutLayout(e),s=null!==(i=e.dataLabelsSettings)&&void 0!==i&&i.show?this.createLabels():[],o=void 0,l=void 0,h=void 0;if(t||(l=(o=this.animator.animate({viewModel:e,colors:this.colors,graphicsContext:this.mainGraphicsContext,labelGraphicsContext:this.labelGraphicsContext,labelBackgroundContext:this.labelBackgroundGraphicsContext,interactivityService:this.interactivityService,layout:n,radius:this.radius,donutProperties:this.donutProperties,viewport:this.currentViewport,labels:s,style:this.style,formatMode:a,onObject:this.featureSwitches.onObject})).shapes,h=o.highlightShapes),t||o.failed){l=this.drawDefaultShapes(e,n,a),h=this.drawDefaultHighlightShapes(e,n),(0,y.gm)({labelContext:this.labelGraphicsContext,dataLabels:s,numeric:!1,backgroundContext:this.labelBackgroundGraphicsContext,twoRows:!0,hasTooltip:!0,formatMode:a,onObject:this.featureSwitches.onObject});var d=(0,I.sW)(this.style);s.map(function(p){p.leaderLine=(0,B.__assign)((0,B.__assign)({},d),{strokeTransparency:50,strokeShow:!0})}),(0,y.z8)(this.labelGraphicsContext,s)}this.assignInteractions(l,h,e,a)}else{var c=(0,G.Mb)(this.animator,t);this.updateInternalToMove(e,c,this.style,a)}(0,oe.bL)(this.options)},r.prototype.createLabels=function(){return new gt(this.donutProperties).layout(this.createLabelDataPoints(),this.data.dataLabelsSettings,this.featureSwitches)},r.prototype.createLabelDataPoints=function(){var e=this.data,t=[],a=(0,w.fI)(),i=null;0===e.dataLabelsSettings.displayUnits&&(i=d3.max(e.dataPoints,function(o){return Math.abs(o.data.measure)}));for(var n=0;n<this.data.dataPoints.length;n++){var s=this.createLabelDataPoint(e.dataPoints[n],i,a,this.featureSwitches);t.push(s)}return t},r.prototype.createLabelDataPoint=function(e,t,a,i){var n,s,o,l,g,C,h=this.labelArc.centroid(e),d=(e.startAngle+e.endAngle)/2,c=Ne(d,this.donutProperties),p=Te(d,this.donutProperties);i?.pieChartMarginBetweenSlices?(g=je(h[0])-c,C=h[1]-p):(g=je(h[0]),C=h[1]);var T,E,A,Y,U,re,de,v=this.data.dataLabelsSettings,S={point:{x:g,y:C},validPositions:[g<0?4:8],radius:0},N=u.v.getThemeColor(this.style,q.uQ),b=u.v.getThemeColor(this.style,q.pl),R=null!==(s=null!==(n=e.data.detailLabelFill)&&void 0!==n?n:N)&&void 0!==s?s:v.fontProperties.color,D=null!==(l=null!==(o=e.data.insideDetailLabelFill)&&void 0!==o?o:b)&&void 0!==l?l:v.fontProperties.color,ge=(0,le.RC)(v.labelStyle),ne=v.fontProperties,H="",We=this.data.hasHighlights,Ae=this.data.highlightsOverflow;if((0,xe.yE)(ge,O.nO)){var Pe=void 0,we=void 0;We&&!Ae?(Pe=e.data.originalHighlightValue,we=a.getOrCreate(e.data.highlightFormat,v,t)):(Pe=e.data.originalMeasure,we=a.getOrCreate(e.data.measureFormat,v,t)),T=null!=Pe?we.format(Pe):null,E=(0,w.y3)(T,ne)}if((0,xe.yE)(ge,O.mA)&&(Y=(0,w.y3)(A=e.data.label,ne)),(0,xe.yE)(ge,O.tG)){var De=(0,J.Z)("Percentage"),me=We&&!Ae?e.data.highlightPercentage:e.data.percentage,Re=_.clone(v),ve=Re.percentagePrecision;if(Re.displayUnits=0,_.isFinite(ve)){var Ke=a.getOrCreate(De,Re,null,Re.percentagePrecision);U=null!=me?Ke.format(me):null}else U=(0,J.WU)(me,De);re=(0,w.y3)(U,ne)}switch(ge){case O.YK.categoryAndDataAndPercent:H=A,T&&(H=(0,le.Ej)([H,T]," ")),U&&(H=(0,le.Ej)([H,"(".concat(U,")")]," ")),de=(0,w.y3)(H,ne);break;case O.YK.categoryAndData:H=A,T&&(H=(0,le.Ej)([H,T]," ")),de=(0,w.y3)(H,ne);break;case O.YK.categoryAndPercent:H=A,U&&(H=(0,le.Ej)([H,U]," ")),de=(0,w.y3)(H,ne);break;case O.YK.dataAndPercent:H=T,U&&(H=(0,le.Ej)([H,"(".concat(U,")")]," ")),de=(0,w.y3)(H,ne);break;case O.YK.data:de=_.clone(E),H=T;break;case O.YK.percent:de=_.clone(re),H=U;break;case O.YK.category:de=_.clone(Y),H=A;break;default:Q.fF.assertFail("Unexpected labelStyle: "+ge),de=_.clone(Y),H=A}var Ce=qe(e,this.donutProperties,S.point,0,c,p,this.featureSwitches),Be=_e(Ce);return{isPreferred:!0,text:"",tooltip:H,textSize:de,outsideFill:R,insideFill:D,fontProperties:ne,identity:e.data.identity,parentShape:S,parentType:0,alternativeScale:t,donutArcDescriptor:e,angle:(e.endAngle+e.startAngle)/2,dataLabel:T,dataLabelSize:E,categoryLabel:A,categoryLabelSize:Y,percentLabel:U,percentLabelSize:re,leaderLinePoints:Ce,linesSize:Be,backgroundColor:v.backgroundColor,backgroundTransparency:v.backgroundTransparency}},r.prototype.renderLegend=function(e){if(!this.mobileInteractiveLegend){var t=this.data.legendObjectProperties?this.data.legendData:(0,K.Fe)(this.style);null!=t.position&&this.legend.setPosition(t.position),this.legend.drawLegend({data:t,parentViewport:this.parentViewport,formatMode:e,onObject:this.featureSwitches.onObject,showTitlePlaceholder:this.showPlaceholders,titleSliceUid:"".concat("legend","-").concat("title","-titleText")}),this.featureSwitches.onObject&&this.subSelectionHelper.addDirectEditPlaceholderOutlines()}},r.prototype.getSelectorsByColumnSubSelection=function(e){if("slices"===d3.select(e).attr(x.Ez)){var a=d3.select(e).datum();return this.getSelectorFromArcDescriptor(a)}return{}},r.prototype.getSelectorFromArcDescriptor=function(e){var t,a,i=(t=e.data).categoryIndex,s=(a=this.data).legendData,h=a.hasCategoryData||!a.hasDynamicSeries?i:t.seriesIndex,d=s.dataPoints;if(!_.isEmpty(d))return d[h].identity.getSelectorsByColumn()},r.prototype.getCustomSubSelectionOutlines=function(e){var t=this,i=_.reduce(e.visualObjects,function(n,s){var l;return"slices"===s.objectName&&(l=t.getSliceSubSelectionOutlines(s)),_.isEmpty(l)||n.push.apply(n,l),n},[]);return _.isEmpty(i)?void 0:i},r.prototype.getSliceSubSelectionOutlines=function(e){var t,a,i,n=this,s=e.selectorsByColumn,l=this.data.subSelectionDataPoints.find(function(U){return(0,Ie.Ic)(n.getSelectorFromArcDescriptor(U),s)});if(l){var h=(t=this.donutProperties).innerRadius,c=l.startAngle,p=l.endAngle,g=(a=l.data).categoryIndex,C=a.seriesIndex,v=this.parentViewport.scale,m=h*v,S=t.outerRadius*v,A={x:(i=this.mainGraphicsContext.node().getBoundingClientRect()).left+i.width/2,y:i.top+i.height/2};return[{id:"category".concat(g??-1,"-series").concat(C??-1),outline:{type:4,center:A,innerRadius:m,outerRadius:S,startAngle:c,endAngle:p}}]}Q.fF.assertFail("Unable to find data point for sub-selected slice")},r.prototype.getSubSelectionStyles=function(e){if(this.featureSwitches.onObject){var t=_.first(e),a=t.visualObjects;Q.fF.assert(function(){return 1===a.length},"Expected 1 visual");var i=a[0];switch(Q.fF.assert(function(){return 1===e.length||e.every(function(n){return _.isEqual(n.visualObjects,[i])},"Expected 1 sub-selection or matching objects")}),i.objectName){case"legend-title":return(0,te.aJ)();case"legend-items":return(0,te.Gh)(this.hostService);case"data-labels":return(0,L.Jf)({hostServices:this.hostService,omitSelectorForSingleSeries:!0,individualSelector:this.getLabelIndividualSelector(),selector:void 0,repetitionSelector:void 0,subSelectionStylesOptions:{precision:{defaultPrecision:(0,J.h1)(void 0,(0,J.Z)("Percentage"))}}},{fontFamilyReference:k.V9.labels.fontFamily,fontSizeReference:k.V9.labels.fontSize,boldReference:k.V9.labels.bold,italicReference:k.V9.labels.italic,underlineReference:k.V9.labels.underline,fontColorReference:k.V9.labels.color,displayUnitsReference:k.V9.labels.labelDisplayUnits,precisionReference:k.V9.labels.labelPrecision});case"slices":return this.getSliceSubSelectionStyles(t)}}},r.prototype.getLabelIndividualSelector=function(){return(0,w.WD)({featureSwitches:this.featureSwitches,hasCategories:this.data.hasCategoryData&&null!=_.first(this.data.legendData.dataPoints),hasDynamicSeries:this.data.hasDynamicSeries,hasSeriesSelector:!1})},r.prototype.getSliceSubSelectionStyles=function(e){var t=e.visualObjects;Q.fF.assert(function(){return 1===t.length},"Expected 1 visualObject");var a=(0,Ie.fd)((0,Ie.tV)(t[0].selectorsByColumn));return{type:3,fill:{label:this.hostService.getLocalizedString("Visual_Fill"),reference:(0,B.__assign)((0,B.__assign)({},k.V9.dataPoint.fill),{selector:a})}}},r.prototype.getSubSelectionShortcuts=function(e,t){if(this.featureSwitches.onObject&&!t){var i=_.first(e).visualObjects;Q.fF.assert(function(){return 1===i.length},"Expected 1 visual");var n=i[0];switch(Q.fF.assert(function(){return 1===e.length||e.every(function(s){return _.isEqual(s.visualObjects,[n])},"Expected 1 sub-selection or matching objects")}),n.objectName){case"legend-title":return(0,te.tV)(this.hostService);case"legend-items":return(0,te.tY)({hostServices:this.hostService,showSort:!0});case"data-labels":return this.getDetailLabelShortcuts();case"slices":return this.getSliceShortcuts(e)}}},r.prototype.getSubSelectables=function(e){return this.subSelectionHelper.getAllSubSelectables(e)},r.prototype.getNextSubSelectable=function(e,t){return this.subSelectionHelper.getNextSubSelectable(e,t)},r.prototype.getDetailLabelShortcuts=function(){var e=this,t="".concat("Visual","-").concat("labels"),a=function(n){return e.hostService.getLocalizedString(n)};return[{type:0},(0,B.__assign)((0,B.__assign)({type:3},k.V9.labels.labelStyle),{label:a("Visual_LabelContents")}),(0,B.__assign)((0,B.__assign)({type:3},k.V9.labels.position),{label:a("Visual_Position")}),{type:1,destinationInfo:{cardUid:t},label:a("Format_Detail_Labels")}]},r.prototype.getSliceShortcuts=function(e){var t=this,a="".concat("Visual","-").concat("slices"),i=function(l){return t.hostService.getLocalizedString(l)},n=_.first(e).visualObjects;Q.fF.assert(function(){return 1===n.length},"Expected 1 visualObject");var s=(0,Ie.fd)((0,Ie.tV)(n[0].selectorsByColumn));return[{type:0,relatedResetFormattingIds:[(0,B.__assign)((0,B.__assign)({},k.V9.dataPoint.fill),{selector:s})]},(0,B.__assign)((0,B.__assign)({type:2},k.V9.labels.show),{enabledLabel:i("Format_AddDetailLabels")}),{type:1,destinationInfo:{cardUid:a},label:i("Format_Slices")}]},r.prototype.addInteractiveLegendArrow=function(){if(this.data&&this.data.dataPoints&&0!==this.data.dataPoints.length){if(!this.interactiveLegendArrow){var a=this.svg.append("g");a.append("path").classed(V.LegendArrowClass.class,!0).attr("d","M1.5,2.6C0.65,1.15,1.85,0,3,0l27,0c1.65,0,2.35,1.15,1.5,2.6L18,26.45c-0.8,1.45-2.15,1.45-2.95,0L1.95,2.6z"),this.interactiveLegendArrow=a}var i=this.getScaleForLegendArrow();this.interactiveLegendArrow.attr("transform",(0,oe.aI)(this.currentViewport.width/2-16.5*i,(this.currentViewport.height-2*this.radius)/2+11*i,i))}},r.prototype.calculateSliceAngles=function(){var e=[],t=this.data.dataPoints;if(0===t.length)return this.interactivityState.valueToAngleFactor=0,void(this.interactivityState.sliceAngles=[]);for(var a=0,i=0,n=t.length;i<n;i++)a+=t[i].data.percentage;Q.fF.assert(function(){return 0!==a},"sum of slices values cannot be zero"),this.interactivityState.valueToAngleFactor=360/a;var s=0;for(i=0,n=t.length;i<n;i++){var o=t[i].data.percentage*this.interactivityState.valueToAngleFactor;e.push(o/2-(s+=o))}this.interactivityState.sliceAngles=e},r.prototype.assignInteractions=function(e,t,a,i){if(this.mobileInteractiveLegend)this.assignInteractiveChartInteractions(e);else if(this.interactivityService){var n=a.dataPoints.map(function(h){return h.data}),s={root:this.mainGraphicsContext,clearCatcher:this.clearCatcher,slices:e,highlightSlices:t,visual:this,hasHighlights:a.hasHighlights,visualInstanceId:this.hostService.instanceId};e.attr("tabindex",0).attr("focusable",!0),this.interactivityService.bind(n,this.behavior,s,{navigationOptions:{navigationStrategy:this.data.navigationStrategy,helper:this},pointSourceKey:"donut"}),this.featureSwitches.onObject&&this.interactivityService.setFormatMode(i)}this.tooltipsEnabled&&this.addTooltips(e,t)},r.prototype.assignInteractiveChartInteractions=function(e){var t=this,a=this.svg.node().getBoundingClientRect();this.interactivityState.donutCenter={x:a.left+a.width/2,y:a.top+a.height/2},this.interactivityState.totalDragAngleDifference=0,this.interactivityState.currentRotate=0,this.interactivityState.interactiveChosenSliceFinishedSetting=!0,this.calculateSliceAngles(),e.on("click",function(n,s){d3.event.defaultPrevented||t.setInteractiveChosenSlice(s)});var i=d3.drag().on("start",this.interactiveDragStart).on("drag",this.interactiveDragMove).on("end",this.interactiveDragEnd);this.svg.style("touch-action","none").call(i)},r.prototype.getAngleFromDragEvent=function(){var t,a,e=this.interactivityState,i=d3.event.sourceEvent;if(-1!==i.type.toLowerCase().indexOf("touch")){if(1!==i.touches.length)return null;var n=i.touches[0];t=n.pageX,a=n.pageY}else t=i.pageX,a=i.pageY;var s={x:t-e.donutCenter.x,y:-a+e.donutCenter.y};return 180*Math.atan2(s.y,s.x)/Math.PI},r.prototype.interactiveDragStart=function(){this.interactivityState.totalDragAngleDifference=0,this.interactivityState.previousDragAngle=this.getAngleFromDragEvent()},r.prototype.interactiveDragMove=function(){var e=this.data.dataPoints,t=this.interactivityState;if(!0===t.interactiveChosenSliceFinishedSetting){var a=this.getAngleFromDragEvent();if(!a)return;var i=t.previousDragAngle-a;t.totalDragAngleDifference+=i,t.previousDragAngle=a,t.currentRotate+=i,this.svg.select("g").attr("transform",(0,oe.I2)(this.currentViewport.width/2,this.currentViewport.height/2,0,0,this.interactivityState.currentRotate));var n=e[0].data.percentage*t.valueToAngleFactor,s=t.currentRotate<=0?-1*t.currentRotate%360:360-t.currentRotate%360;t.currentIndexDrag=0;for(var o=e.length;t.currentIndexDrag<o&&s>n;)t.currentIndexDrag<o-1&&(n+=e[t.currentIndexDrag+1].data.percentage*t.valueToAngleFactor),t.currentIndexDrag++;t.currentIndexDrag!==t.previousIndexDrag&&(t.interactiveLegend.updateLegend(t.currentIndexDrag),this.svg.selectAll(V.SliceClass.selector).attr("opacity",function(l,h){return(0,j.eR)(h===t.currentIndexDrag,!1,!0,!1)}),t.previousIndexDrag=t.currentIndexDrag)}},r.prototype.interactiveDragEnd=function(){0!==this.interactivityState.totalDragAngleDifference&&(this.setInteractiveChosenSlice(this.interactivityState.currentIndexDrag),d3.event.sourceEvent.stopPropagation())},r.prototype.updateInternalToMove=function(e,t,a,i){var n=this.svg,s=this.pie,o=this.key,l=this.outerArc,h=this.radius,d=this.previousRadius,c=e.borderColor,p=this.donutProperties,g=this.svg.select(V.SliceContainerClass.selector).selectAll("path"+V.SliceClass.selector).data().map(function(A){return A.data});0===g.length&&(g=e.dataPointsToDeprecate);var C=this.mergeDatasets(g,e.dataPointsToDeprecate),v=n.select(V.SliceContainerClass.selector).selectAll("path"+V.SliceClass.selector).data(s(e.dataPointsToDeprecate),o);v.enter().insert("path").classed(V.SliceClass.class,!0).each(V.UpdateCurrentArcElementFunc),v=n.select(V.SliceContainerClass.selector).selectAll("path"+V.SliceClass.selector).data(s(C),o);var b,R,m=this.donutProperties.innerRadius;if(V.isSingleColor(e.dataPoints),l.innerRadius(m),a.isHighContrast||v.style("stroke-opacity",function(A){return(0,j.eR)(A.data.selected,!1,!1,e.hasHighlights)}).style("stroke-dasharray",function(A){return r.drawStrokeForDonutChart(A,p)}),v.style("fill",function(A){return A.data.color}).style("fill-opacity",function(A){return(0,j.eR)(A.data.selected,!1,!1,e.hasHighlights)}).style("stroke",c).style("stroke-width",function(A){return A.data.strokeWidth}).transition().duration(t).attrTween("d",function(A){var Y=d3.interpolateObject(this._current,A),U=d3.interpolateNumber(d*r.OuterRadiusRatio,h*r.OuterRadiusRatio);return this._current=Y(0),function(re){return l.outerRadius(U(re))(Y(re))}}),(v=n.select(V.SliceContainerClass.selector).selectAll("path"+V.SliceClass.selector).data(s(e.dataPointsToDeprecate),o)).exit().transition().delay(t).duration(0).remove(),!this.mobileInteractiveLegend){var S=e.dataLabelsSettings,N=[];S&&S.show&&(N=this.createLabels()),(0,y.gm)({labelContext:this.labelGraphicsContext,dataLabels:N,numeric:!1,backgroundContext:this.labelBackgroundGraphicsContext,formatMode:i,onObject:this.featureSwitches.onObject}),(0,y.z8)(this.labelGraphicsContext,N)}if(e.hasHighlights){var D=n.select(V.SliceContainerClass.selector).selectAll("path"+V.SliceHighlightClass.selector).data(s(e.dataPointsToDeprecate),o);b=D.enter().insert("path").classed(V.SliceHighlightClass.class,!0).each(V.UpdateCurrentArcElementFunc).merge(D),V.isSingleColor(e.dataPoints),a.isHighContrast||b.style("stroke-opacity",1).style("stroke-dasharray",function(A){return r.drawStrokeForDonutChart(A,p,A.data.highlightRatio)});var T=this;b.style("fill",function(A){return A.data.color}).style("fill-opacity",1).style("stroke",c).style("stroke-width",function(A){return 0===A.data.highlightRatio?0:A.data.strokeWidth}).transition().duration(t).attrTween("d",function(A){var Y=d3.interpolateObject(this._current,A),U=d3.interpolateNumber(d*r.OuterRadiusRatio,T.getHighlightRadius(A));return this._current=Y(0),function(re){return l.outerRadius(U(re))(Y(re))}}),R=D.exit().transition().delay(t).duration(0).remove()}else n.selectAll("path"+V.SliceHighlightClass.selector).transition().delay(t).duration(0).remove();this.assignInteractions(v,b,e,i),(0,oe.bL)(this.options,v,v.exit(),b,R),this.mobileInteractiveLegend&&(this.addInteractiveLegendArrow(),this.interactivityState.interactiveLegend.drawLegend(this.data.dataPointsToDeprecate),this.setInteractiveChosenSlice(this.interactivityState.lastChosenInteractiveSliceIndex?this.interactivityState.lastChosenInteractiveSliceIndex:0,t))},r.prototype.addTooltips=function(e,t){this.tooltipService.addTooltip(e,function(a){var i;return null===(i=a.data)||void 0===i?void 0:i.data.tooltipInfo},function(a){var i;return(null===(i=a.data)||void 0===i?void 0:i.data.identity)&&[a.data.data.identity]}),t&&this.tooltipService.addTooltip(t,function(a){var i;return null===(i=a.data)||void 0===i?void 0:i.data.tooltipInfo},function(a){var i;return(null===(i=a.data)||void 0===i?void 0:i.data.identity)&&[a.data.data.identity]})},r.prototype.drawDefaultShapes=function(e,t,a){var i,n=this.svg.select(V.SliceContainerClass.selector).selectAll("path"+V.SliceClass.selector).data(e.dataPoints,V.ArcDescriptorKeyFunc),s=null===(i=this.interactivityService)||void 0===i?void 0:i.hasSelection(),o=n.enter().insert("path").attr("class",V.SliceClass.class).merge(n);return V.isSingleColor(e.dataPoints),this.interactivityService&&o.attr("tabindex",function(l){return null!=l.data.measure?0:null}).attr("focusable",function(l){return null!=l.data.measure||null}).attr("aria-label",function(l){return l.data.formattedTooltip}).attr("role","option").classed(j.Pg,!Fe.M.isInternetExplorerOrEdge()),o.style("fill",function(l){return l.data.color}).style("fill-opacity",function(l){return(0,j.eR)(l.data.selected,!1,s,e.hasHighlights)}).style("stroke-opacity",function(l){return(0,j.eR)(l.data.selected,!1,s,e.hasHighlights)}).style("stroke",e.borderColor).style("stroke-width",function(l){return l.data.strokeWidth}).attrs(t.shapeLayout.attrs).styles(t.shapeLayout.styles),n.exit().remove(),this.featureSwitches.onObject&&r.drawSubSelectionShapes(this.mainGraphicsContext,e,t,this.hostService,a),o},r.drawSubSelectionShapes=function(e,t,a,i,n){var s,o=e.selectAll(V.SubSelectionSlicesClassAndSelector.selector).data(n&&t.subSelectionDataPoints?[{subSelectionDataPoints:t.subSelectionDataPoints}]:[]),l=o.enter().append("g").attr("class",V.SubSelectionSlicesClassAndSelector.class).merge(o);o.exit().remove();var h=l.selectAll("path".concat(V.SubSelectionSliceClassAndSelector.selector)).data(function(c){return c.subSelectionDataPoints}),d=h.enter().append("path").classed(V.SubSelectionSliceClassAndSelector.class,!0).merge(h);d.classed(x.cy,n).style("pointer-events","all").style("fill-opacity",0).attrs((s={},s[x.Ez]="slices",s[x.QZ]=3,s)).attrs(a.subSelectionShapeLayout.attrs),d.each(function(c){x.O5.setDataForElement(this,{getDisplayName:function(){return i.getLocalizedString("MiniToolbar_Slice",c.data.displayName)}})}),h.exit().remove()},r.prototype.drawDefaultHighlightShapes=function(e,t){var a=this.svg.select(V.SliceContainerClass.selector).selectAll("path"+V.SliceHighlightClass.selector).data(e.dataPoints.filter(function(n){return null!=n.data.highlightRatio}),V.ArcDescriptorKeyFunc),i=a.enter().insert("path").classed(V.SliceHighlightClass.class,!0).each(V.UpdateCurrentArcElementFunc).merge(a);return V.isSingleColor(e.dataPoints),i.style("fill",function(n){return n.data.color}).style("fill-opacity",function(n){return(0,j.eR)(n.data.selected,!0,!1,e.hasHighlights)}).style("stroke-opacity",function(n){return(0,j.eR)(n.data.selected,!0,!1,e.hasHighlights)}).style("stroke",u.v.getThemeColor(this.style,V.DefaultStrokeColorName)).style("stroke-width",function(n){return 0===n.data.highlightRatio?0:n.data.strokeWidth}).attrs(t.highlightShapeLayout.attrs).styles(t.highlightShapeLayout.styles),a.exit().remove(),i},r.drawStrokeForDonutChart=function(e,t,a){void 0===a&&(a=1);var o,l,i=t.outerRadius*a,n=t.innerRadius,s=(e.endAngle-e.startAngle)*i;if(n>0){var h=t.outerRadius-n,d=(e.endAngle-e.startAngle)*n;if(e.data.highlightRatio&&(s=(e.endAngle-e.startAngle)*(h+n)),e.data.isLastInDonut)return"0 "+s+" "+h+" "+d+" "+h;o=s+h+d,l=h}else e.data.isLastInDonut?(o=s,l=2*i):(o=s+i,l=i);return"0 "+o+" "+l},r.prototype.onClearSelection=function(){var e;null===(e=this.interactivityService)||void 0===e||e.clearSelection()},r.prototype.onRestoreSelection=function(e){var t,a;return null!==(a=null===(t=this.interactivityService)||void 0===t?void 0:t.restoreSelection(e.selection))&&void 0!==a&&a},r.prototype.getDonutLayout=function(e){var t=this,a=this.donutProperties,i=a.innerRadius,n=a.outerRadius,s=i||r.EffectiveZeroValue,o=d3.arc().innerRadius(i),l=d3.arc().innerRadius(i).outerRadius(n-e.explode),h=d3.arc().innerRadius(i).outerRadius(s),d=this;return{shapeLayout:{attrs:r.getStandardShapeLayoutAttrs(this.featureSwitches,l,a),styles:{"stroke-dasharray":this.featureSwitches.pieChartMarginBetweenSlices||this.style.isHighContrast?void 0:function(c){return r.drawStrokeForDonutChart(c,a)}}},highlightShapeLayout:{attrs:{d:function(p){return o.outerRadius(t.getHighlightRadius(p))(p)}},styles:{"stroke-dasharray":this.style.isHighContrast?void 0:function(c){return r.drawStrokeForDonutChart(c,a,c.data.highlightRatio)}}},subSelectionShapeLayout:{attrs:r.getStandardShapeLayoutAttrs(this.featureSwitches,l,a)},highlightShapeTween:function(p){return function(g){var C=0===p?n:d.getHighlightRadius(this._current),v=2===p?n:d.getHighlightRadius(g),m=d3.interpolateObject(this._current,g),S=d3.interpolateNumber(C,v);return this._current=m(0),function(N){return o.outerRadius(S(N))(m(N))}}},zeroShapeLayout:{attrs:{d:function(p){return h(p)}},styles:{"stroke-dasharray":this.style.isHighContrast?void 0:function(c){return r.drawStrokeForDonutChart(c,a,s)}}}}},r.getStandardShapeLayoutAttrs=function(e,t,a){return{d:function(n){return t(n)},transform:e.pieChartMarginBetweenSlices?function(i){var n=(i.startAngle+i.endAngle)/2;return"translate("+Ne(n,a)+", "+Te(n,a)+")"}:function(){return"translate(0, 0)"}}},r.prototype.getHighlightRadius=function(e){var t,a,i=this.donutProperties.innerRadius,n=this.donutProperties.outerRadius,s=null!==(a=null===(t=e.data)||void 0===t?void 0:t.highlightRatio)&&void 0!==a?a:1;return Math.sqrt(s*(n*n-i*i)+i*i)},r.prototype.getArcArea=function(e,t){var a=this.donutProperties.innerRadius,i=t?this.getHighlightRadius(e):this.donutProperties.outerRadius;return(e.endAngle-e.startAngle)*(i*i-a*a)},r.cullDataByViewport=function(e,t,a,i,n,s){var o=2*Math.PI,h=0;if(e.length>72){var d=Math.min(a.width,a.height)/2;h=r.InvisibleArcLengthInPixels/(d*o)*t}for(var g,p=[],C=0,v=e;C<v.length;C++){var m=v[C];m.measure>h&&(n=n===r.DefaultBorderWidth?i||g===m.color?1:0:n,m.strokeWidth=s?.pieChartMarginBetweenSlices?n:i||g===m.color?1:0,g=m.color,p.push(m))}return p},r.getDefaultLabelSettings=function(e){return{show:!0,position:0,displayUnits:0,precision:q.NZ,fontProperties:(0,w.bT)({style:e,textClassName:"smallLightLabel",noColor:!0}).fontProperties,enableBackground:!0,backgroundColor:u.v.getThemeColor(e,q.lp),backgroundTransparency:.5}},r.OuterRadiusRatio=.8,r.LabelRadiusRatio=.9,r.DefaultDonutInnerRadiusRatio=.48,r.DefaultStartAngleDegrees=0,r.OnePiRadianInDegree=180,r.DefaultExplode=0,r.DefaultBorderWidth=0,r.MinDonutThickness=5,r.InvisibleArcLengthInPixels=1,r.InteractiveLegendContainerHeight=71,r.EffectiveZeroValue=1e-9,r}(),yt=function(){function r(e,t,a,i){this.maxLegendItemWidth=15,this.legendContainerParent=t,this.donutChart=e,this.visualInitOptions=i,this.legendItemsPositions=[]}return r.prototype.drawLegend=function(e){var t=this;this.data=e,this.currentNumberOfLegendItems=e.length,this.currentIndex=0,this.leftMostIndex=0,this.rightMostIndex=e.length-1,this.legendContainerParent.select(r.LegendContainerSelector).empty()&&(this.legendContainer=this.legendContainerParent.append("div").classed(r.LegendContainerClassName,!0));var a=this.legendContainer.selectAll(r.LegendItemSelector).data(e),i=this.legendContainerWidth=this.legendContainer.node().getBoundingClientRect().width,n=i/2-.4*i/2+r.ItemMargin,s=n;this.currentXOffset=n,a.enter().insert("div").classed(r.LegendItemClassName,!0).each(function(l){!function(h,d){h.attr("data-legend-index",d.index).css({position:"absolute",left:s});var c=(0,J.WU)(d.label),p=(0,J.WU)(d.originalMeasure,d.measureFormat),g=(0,J.WU)(d.percentage,"0.00 %;-0.00 %;0.00 %"),C=d.color,v=r.createBasicLegendItemSpan(r.LegendItemValueClassName,p,11),m=r.createBasicLegendItemSpan(r.LegendItemCategoryClassName,c,11),S=r.createBasicLegendItemSpan(r.LegendItemPercentageClassName,g,20),N=r.spanWidth(v),b=r.spanWidth(m),R=r.spanWidth(S),D=r.legendBoxSize(N,b,R);h.css("width",D),t.maxLegendItemWidth=Math.max(t.maxLegendItemWidth,D);var T=function(re){return D-re>0?(D-re)/2:0},E=T(N),A=T(b),Y=T(R);r.createLegendItemSpan(m,A),r.createLegendItemSpan(v,E),r.createLegendItemSpan(S,Y).css("color",C),h.append(m),h.append(S),h.append(v),t.legendItemsPositions.push({startX:s,boxWidth:D}),s+=D+r.ItemMargin}($(this),l)}),a.exit().remove(),this.assignInteractions()},r.prototype.updateLegend=function(e){var a,i,t=this,n=this.legendContainerWidth;this.currentIndex=e,this.updateLabelBlocks(e);var s=-1*(this.legendItemsPositions[e].startX+this.legendItemsPositions[e].boxWidth/2-n/2);this.legendContainer.transition().styleTween("-webkit-transform",function(){return d3.interpolate((0,oe.O7)(t.currentXOffset,0),(0,oe.O7)(s,0))}).styleTween("transform",function(){return d3.interpolate((0,oe.O7)(t.currentXOffset,0),(0,oe.O7)(s,0))}).duration(Ue).ease((0,Je.Ad)(Ge)).on("end",function(){t.currentXOffset=s});var o=this.legendContainer.selectAll(r.LegendItemSelector),h=o.filter(function(d){return d.index===t.currentIndex}).data()[0].formattedTooltip;h&&(null===(i=null===(a=this.visualInitOptions)||void 0===a?void 0:a.host)||void 0===i||i.alertScreenReader(h)),o.exit(),(0,oe.bL)(this.visualInitOptions,this.legendContainer)},r.prototype.assignInteractions=function(){var e=this,t=0,n=d3.drag().on("start",function(){t=0}).on("drag",function(){t+=d3.event.dx,Math.abs(t)<e.maxLegendItemWidth||(e.dragLegend(t<0),t=0)});this.legendContainer.style("touch-action","none").style("cursor","pointer").call(n)},r.prototype.dragLegend=function(e){this.currentNumberOfLegendItems>r.MinimumItemsInLegendForCycled-1?this.currentIndex=this.getCyclingCurrentIndex(e):this.shouldChangeIndexInNonCycling(e)&&(e?this.currentIndex++:this.currentIndex--),this.donutChart.setInteractiveChosenSlice(this.currentIndex)},r.prototype.shouldChangeIndexInNonCycling=function(e){return!(0===this.currentIndex&&!e||this.currentIndex===this.currentNumberOfLegendItems-1&&e)},r.prototype.getCyclingCurrentIndex=function(e){var t=this.data.length,i=(this.currentIndex+(e?1:-1))%(t||1);return i<0?i+t:i},r.prototype.updateLegendItemsBlocks=function(e,t){var a=$(this.legendContainer.node());if(e){var i=a.find("[data-legend-index="+this.leftMostIndex+"]");i.remove().insertAfter(a.find("[data-legend-index="+this.rightMostIndex+"]")),this.legendItemsPositions[this.leftMostIndex].startX=n=this.legendItemsPositions[this.rightMostIndex].startX+this.legendItemsPositions[this.rightMostIndex].boxWidth+r.ItemMargin,i.css("left",n),this.rightMostIndex=this.leftMostIndex,this.leftMostIndex=(this.leftMostIndex+1)%this.data.length}else{var n,s=a.find("[data-legend-index="+this.rightMostIndex+"]");s.remove().insertBefore(a.find("[data-legend-index="+this.leftMostIndex+"]")),this.legendItemsPositions[this.rightMostIndex].startX=n=this.legendItemsPositions[this.leftMostIndex].startX-this.legendItemsPositions[this.rightMostIndex].boxWidth-r.ItemMargin,s.css("left",n),this.leftMostIndex=this.rightMostIndex,this.rightMostIndex=this.rightMostIndex-1==-1?this.legendItemsPositions.length-1:this.rightMostIndex-1}t-1!=0&&this.updateLegendItemsBlocks(e,t-1)},r.prototype.updateLabelBlocks=function(e){this.currentNumberOfLegendItems>r.MinimumItemsInLegendForCycled?(this.rightMostIndex===e&&this.updateLegendItemsBlocks(!0,2),this.leftMostIndex===e&&this.updateLegendItemsBlocks(!1,2),(this.rightMostIndex===e+1||0===this.rightMostIndex&&e===this.currentNumberOfLegendItems-1)&&this.updateLegendItemsBlocks(!0,1),(this.leftMostIndex===e-1||this.leftMostIndex===this.currentNumberOfLegendItems-1&&0===e)&&this.updateLegendItemsBlocks(!1,1)):this.currentNumberOfLegendItems===r.MinimumItemsInLegendForCycled&&(this.rightMostIndex===e&&this.updateLegendItemsBlocks(!0,1),this.leftMostIndex===e&&this.updateLegendItemsBlocks(!1,1))},r.createBasicLegendItemSpan=function(e,t,a){return $("<span></span>").addClass(e).css({"white-space":"nowrap","font-size":a+"px"}).text(t)},r.createLegendItemSpan=function(e,t){return e.css({overflow:"hidden","text-overflow":"ellipsis",display:"inline-block",width:"100%","margin-left":t}),e},r.legendBoxSize=function(e,t,a){var i=e>t?e:t;return(i=i>a?i:a)>r.MaxLegendItemBoxSize?r.MaxLegendItemBoxSize:i+2},r.spanWidth=function(e){var t;return null!==(t=this.FakeElementSpan)&&void 0!==t||(this.FakeElementSpan=$("<span>").hide().appendTo(document.body)),this.FakeElementSpan.empty(),this.FakeElementSpan.append(e),this.FakeElementSpan.width()},r.LegendContainerClassName="legend-container",r.LegendContainerSelector=".legend-container",r.LegendItemClassName="legend-item",r.LegendItemSelector=".legend-item",r.LegendItemCategoryClassName="category",r.LegendItemPercentageClassName="percentage",r.LegendItemValueClassName="value",r.MaxLegendItemBoxSize=160,r.ItemMargin=30,r.MinimumItemsInLegendForCycled=3,r}(),at=function(){function r(e,t,a,i){void 0===i&&(i=!0);var n,s=this.reader=(0,ue.G)(e,{staticSeriesRoleNames:["Y"],colorOptions:{valueRole:"Y",visualStyle:t},formatStringProp:ae.general.formatString}),o=s.data;this.dataView=e;var l=e.categorical;if(this.dataViewMetadata=e.metadata,this.tooltipsEnabled=i,this.maxValue=0,this.hasNegativeValues=!1,this.allValuesAreNegative=!1,this.style=t,(null===(n=l.categories)||void 0===n?void 0:n.length)>0){var h=l.categories[0];this.categoryValues=h.values,this.categoryFormatString=(0,J.EO)(h.source,ae.general.formatString)}this.hasDynamicSeries=s.columns.hasDynamicSeries(),this.hasSeriesData=o.hasSeries(),this.hasCategoryData=o.hasCategories(),this.highlightsOverflow=!1,this.total=0,this.highlightTotal=0,this.dataPoints=[],this.dataLabelsSettings=null;var d=0,c=u.v.create(t);if(this.borderColor=c.getColorForProperty(s.objects.getStaticObjects(),ae.slices.borderColor,V.DefaultStrokeColorName),this.explode=(0,be.NA)(s.objects.getStaticObjects(),ae.slices.explode,ye.DefaultExplode),this.borderWidth=(0,be.NA)(s.objects.getStaticObjects(),ae.slices.borderWidth,ye.DefaultBorderWidth),null==(d=(0,be.NA)(s.objects.getStaticObjects(),ae.slices.innerRadiusRatio))?d=a?ye.DefaultDonutInnerRadiusRatio:0:d/=100/ye.OuterRadiusRatio,this.startAngle=(0,be.NA)(s.objects.getStaticObjects(),ae.slices.startAngle,ye.DefaultStartAngleDegrees),this.donutInnerRadiusRatio=d,o.hasValues("Y")){var p=this.seriesCount=o.getSeriesCount();this.hasHighlights=o.hasHighlights();var g=o.getCategoryCount()||1;this.allValuesAreNegative=void 0;for(var C=0;C<g;C++)for(var v=0;v<p;v++){var m=o.getValue("Y",C,v),S=void 0;this.hasHighlights&&null==(S=o.getHighlight("Y",C,v))&&(S=0),this.allValuesAreNegative=void 0===this.allValuesAreNegative?(!this.hasHighlights||S<=0)&&m<=0:this.allValuesAreNegative&&(!this.hasHighlights||S<=0)&&m<=0,this.hasNegativeValues||(this.hasNegativeValues=m<0||!!this.hasHighlights&&S<0)}for(this.allValuesAreNegative=!!this.allValuesAreNegative,C=0;C<g;C++)for(v=0;v<p;v++)m=o.getValue("Y",C,v),m=r.normalizedValue(m,this.allValuesAreNegative),this.total+=m,this.hasHighlights&&(S=o.getHighlight("Y",C,v),S=r.normalizedValue(S,this.allValuesAreNegative),this.highlightTotal+=S,!this.highlightsOverflow&&(0,Ze.aP)(S,m,(0,Ze.p8)(Math.min(S,m)))&&(this.highlightsOverflow=!0))}}return r.normalizedValue=function(e,t){return null==e||isNaN(e)?0:e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:t?Math.abs(e):e<0?0:e},r.prototype.convert=function(){var t,a,i,n,s,o,e=this,l=this.reader,h=this.reader.data,d=0===e.total?[]:e.categoryValues?e.convertCategoricalWithSlicing():e.hasDynamicSeries?e.convertSeries():e.convertMeasures();this.dataLabelsSettings=this.convertDataLabelSettings(),null!==(t=this.dataViewMetadata)&&void 0!==t&&t.objects&&(this.legendObjectProperties=null===(a=this.dataViewMetadata)||void 0===a?void 0:a.objects.legend);var c=_.isEmpty(this.dataView.categorical.categories)?null:this.dataView.categorical.categories[0];this.dataPoints=[];for(var C,p=ae.general.formatString,g=(0,J.Z)("Percentage"),v=null!==(i=this.dataLabelsSettings.fontProperties.color)&&void 0!==i?i:u.v.getThemeColor(this.style,q.uQ),m=null!==(n=this.dataLabelsSettings.fontProperties.color)&&void 0!==n?n:u.v.getThemeColor(this.style,q.pl),S=0,N=d.length;S<N;S++){var b=d[S],R=b.measure,D=r.normalizedValue(b.measure,this.allValuesAreNegative),T=b.highlightMeasure,E=r.normalizedValue(b.highlightMeasure,this.allValuesAreNegative),A=this.total>0?D/this.total:0,Y=void 0,U=void 0;D>this.maxValue&&(this.maxValue=D),E>this.maxValue&&(this.maxValue=E),this.hasHighlights&&(this.highlightsOverflow?(R=T,D=E,A=this.highlightTotal>0?E/this.highlightTotal:0,Y=1):Y=0!==D?E/D:0,Y||(Y=ye.EffectiveZeroValue),U=A*Y);var re=b.categoryLabel,de=this.dataView.categorical,ne=l.columns.getValueMetadataColumn("Y",null!=b.seriesIndex?b.seriesIndex:S),H=this.hasHighlights&&this.highlightsOverflow?T:R,We=b.measureFormat||(0,J.EO)(ne,p),Ae=this.hasHighlights&&!this.highlightsOverflow?T:void 0,Pe=b.highlightMeasureFormat||(0,J.EO)(ne,p),we=(0,J.WU)(A,g),De=void 0;null!=H&&null!=we&&(De=(0,J.WU)(H,We)+" ("+we+")");var me=void 0;if(null!=Ae&&null!=U){var Re=(0,J.WU)(U,g);me=(0,J.WU)(Ae,Pe)+" ("+Re+")"}var ve=void 0;this.tooltipsEnabled&&(ve=[],c&&ve.push({displayName:c.source.displayName,value:re}),this.hasDynamicSeries&&(!c||c.source!==de.values.source)&&ve.push({displayName:de.values.source.displayName,value:b.label}),null!=De&&ve.push({displayName:ne.displayName,value:De}),null!=me&&ve.push({displayName:Xe.I6.localizationOptions.highlightedValueDisplayName,value:me}),(0,Xe.VT)(l,ve,this.categoryValues?b.categoryIndex:0,this.hasDynamicSeries?b.seriesIndex:void 0,p));var Ke=this.style.isHighContrast||C===b.color&&A&&A>0?1:0;C=A&&A>0?b.color:C;var Ce=(0,I.t$)({defaultColor:v,categoricalDataReader:l,categoryIndex:b.categoryIndex,seriesIndex:b.seriesIndex}),Be=(0,I.t$)({defaultColor:m,categoricalDataReader:l,categoryIndex:b.categoryIndex,seriesIndex:b.seriesIndex}),it=(0,I.B8)(Ce)?Ce.color:void 0;it&&(this.dataLabelsSettings.fontProperties=(0,I.Vv)(it,this.dataLabelsSettings.fontProperties));var ke=this.hasHighlights&&!this.highlightsOverflow;this.dataPoints.push({identity:b.identity,measure:D,originalMeasure:R,measureFormat:null!==(s=b.measureFormat)&&void 0!==s?s:ne.format,percentage:A,index:b.index,label:b.label,highlightRatio:Y,highlightValue:ke?E:void 0,originalHighlightValue:ke?T:void 0,highlightFormat:ke?null!==(o=b.highlightMeasureFormat)&&void 0!==o?o:ne.format:void 0,highlightPercentage:ke?U:void 0,selected:!1,tooltipInfo:ve,formattedTooltip:(0,Z.X)(ve),color:b.color,strokeWidth:Ke,seriesIndex:b.seriesIndex?b.seriesIndex:0,categoryIndex:b.categoryIndex?b.categoryIndex:0,detailLabelFill:Ce.color?Ce.color:void 0,insideDetailLabelFill:Be.color?Be.color:void 0,categoryLabel:b.categoryLabel})}this.legendData=h.hasCategoryWithRole("Category")?(0,K.xw)({dataView:this.dataView,categoryRole:"Category",style:this.style,valueRole:"Y",showByDefault:!1}):(0,K.pq)({dataView:this.dataView,staticSeriesRoleNames:["Y"],style:this.style,showByDefault:!1})},r.prototype.convertCategoricalWithSlicing=function(){for(var e,t,a=this.reader,i=this.reader.data,n=this.dataView.categorical,s=ae.general.formatString,o=[],l=0,h=this.categoryValues.length;l<h;l++)for(var d=this.categoryValues[l],c=a.colors.createByCategory(l),p=(0,J.WU)(d,this.categoryFormatString),g=0;g<this.seriesCount;g++){var C=i.getValue("Y",l,g),v=i.getFormatString("Y",l,g),m=this.hasHighlights?i.getHighlight("Y",l,g):void 0,S=this.hasHighlights?i.getHighlightFormatString("Y",l,g):void 0;if(null!=C||null!=m){var N=a.columns.getValueColumn("Y",g),R=n.values.grouped()[g],D=p;(this.hasDynamicSeries||i.getSeriesCount()>1)&&(D=(0,f.TO)(N.source,n.values,s));var T=N.source.queryName,E=ze.dw.builder().withCategory([n.categories[0]],l,null===(t=null===(e=n.categories[0])||void 0===e?void 0:e.source)||void 0===t?void 0:t.queryName,!0).withSeries(n.values,this.hasDynamicSeries?R:void 0,!0).withMeasure(T,N,l).createSelectionId(),A=(0,J.EO)(N.source,s,!0);o.push({identity:E,measureFormat:v||A,measure:C,highlightMeasureFormat:S??A,highlightMeasure:m,index:o.length,label:D,categoryLabel:p,color:c,categoryIndex:l,seriesIndex:g})}}return o},r.prototype.convertMeasures=function(){for(var e=this.reader,t=[],a=ae.general.formatString,i=0;i<this.seriesCount;i++){var n=e.data.getValue("Y",0,i),s=e.data.getFormatString("Y",0,i),o=this.hasHighlights?e.data.getHighlight("Y",0,i):void 0,l=this.hasHighlights?e.data.getHighlightFormatString("Y",0,i):void 0,h=e.columns.getValueColumn("Y",i),d=(0,J.EO)(h.source,a,!0),c=h.source.displayName,p=ze.l0.createWithMeasure(h.source.queryName),g=e.colors.createBySeries(i);t.push({identity:p,measureFormat:s||d,measure:n,highlightMeasure:o,highlightMeasureFormat:l||d,index:i,label:c,categoryLabel:c,color:g,categoryIndex:i,seriesIndex:null})}return t},r.prototype.convertSeries=function(){for(var e=this.reader,t=this.dataView.categorical,a=[],i=ae.general.formatString,n=0;n<this.seriesCount;n++){var s=e.data.getValue("Y",0,n),o=e.data.getFormatString("Y",0,n),l=this.hasHighlights?e.data.getHighlight("Y",0,n):void 0,h=this.hasHighlights?e.data.getHighlightFormatString("Y",0,n):void 0,d=e.columns.getValueColumn("Y",n),c=t.values.grouped()[n],p=(0,J.EO)(d.source,i,!0),g=(0,f.TO)(d.source,t.values,i),C=(new ze.dw).withSeries(t.values,c,!0).withMeasure(d.source.queryName,d,0).createSelectionId(),v=e.colors.createBySeries(n);a.push({identity:C,measureFormat:o||p,measure:s,highlightMeasure:l,highlightMeasureFormat:h??p,index:n,label:g,categoryLabel:g,color:v,categoryIndex:0,seriesIndex:n})}return a},r.prototype.convertDataLabelSettings=function(){var e=this.dataViewMetadata,t=ye.getDefaultDonutLabelSettings(this.style);if(e){var a=e.objects;if(a){var i=a.labels;i&&(0,w.ww)(i,t,void 0,this.style)}t.position=(0,be.NA)(a,ae.labels.position,Se.SX),t.overflow=(0,be.NA)(a,ae.labels.overflow,!0),t.enableBackgroundWithAuto=(0,be.NA)(a,ae.labels.background,Ve.d7)}return t},r}()},79476:function(Me,ce,P){P.d(ce,{ao:function(){return z},fS:function(){return k},oY:function(){return M}});var B=P(19377);function k(L,x){return null!=L&&null!=x&&L.x===x.x&&L.y===x.y}function M(L,x,W){var Z=(x.y-L.y)*(W.x-x.x)-(x.x-L.x)*(W.y-x.y);return 0===Z?B.i.Colinear:Z>0?B.i.Clockwise:B.i.Counterclockwise}function z(L,x,W){return W.x<=Math.max(L.x,x.x)&&W.x>=Math.min(L.x,x.x)&&W.y<=Math.max(L.y,x.y)&&W.y>=Math.min(L.y,x.y)}},92379:function(Me,ce,P){P.d(ce,{m:function(){return j}});var B=P(19377),G=P(79476),k=P(80758),j=function(){function F(u){u&&(this.polygonPoints=this.convertArrayPathToPoints(u))}return F.fromPolygonPoints=function(u){var f=new F(null);return f.polygonPoints=u,f},F.prototype.absoluteCentroid=function(){return null==this._absoluteCentroid&&(this._absoluteCentroid=this.calculatePolygonCentroid()),this._absoluteCentroid},F.prototype.absoluteBoundingRect=function(){return null==this._absoluteBoundingRect&&(this._absoluteBoundingRect=this.calculateBoundingRect()),this._absoluteBoundingRect},F.prototype.contains=function(u){var y={x:u.left+u.width,y:u.top},I={x:u.left,y:u.top+u.height},w={x:u.left+u.width,y:u.top+u.height};return this.inside({x:u.left,y:u.top})&&this.inside(y)&&this.inside(I)&&this.inside(w)},F.prototype.conflicts=function(u){if(!this.isConflictWithBoundingBox(u))return!1;var y={x:u.left+u.width/2,y:u.top},I={x:u.left+u.width,y:u.top},w={x:u.left,y:u.top+u.height},M={x:u.left+u.width/2,y:u.top+u.height},z={x:u.left+u.width,y:u.top+u.height},L={x:u.left,y:u.top+u.height/2},x={x:u.left+u.width,y:u.top+u.height/2};return this.inside({x:u.left,y:u.top})||this.inside(y)||this.inside(I)||this.inside(w)||this.inside(M)||this.inside(z)||this.inside(L)||this.inside(x)},F.prototype.lineIntersectionPoint=function(u,f){for(var y=0;y<this.polygonPoints.length;y++){var M=this.getLineIntersection(u,f,this.polygonPoints[y],y===this.polygonPoints.length-1?this.polygonPoints[0]:this.polygonPoints[y+1]);if(null!==M)return M}return null},F.calculateAbsolutePolygonArea=function(u){var f,y=1,I=0;for(f=0;f<u.length;f++)I+=u[f].x*u[y].y-u[y].x*u[f].y,y=(y+1)%u.length;return.5*I},F.prototype.overlapPath=function(u){if(this.inside({x:u[0],y:u[1]}))return!0;var f=new F(u);if(f.inside(this.polygonPoints[0]))return!0;for(var y=0;y<this.polygonPoints.length;y++)if(f.lineIntersectionPoint(this.polygonPoints[y],this.polygonPoints[(y+1)%this.polygonPoints.length]))return!0;return!1},F.prototype.inside=function(u){for(var f=u.x,y=u.y,I=!1,w=0,M=this.polygonPoints.length-1;w<this.polygonPoints.length;M=w++){var z=this.polygonPoints[w].x,L=this.polygonPoints[w].y,W=this.polygonPoints[M].y;L>y!=W>y&&f<(this.polygonPoints[M].x-z)*(y-L)/(W-L)+z&&(I=!I)}return I},F.translateX=function(u,f){for(var y=new Float64Array(2*u.polygonPoints.length),I=0;I<u.polygonPoints.length;I++)y[2*I]=u.polygonPoints[I].x+f,y[2*I+1]=u.polygonPoints[I].y;return new F(y)},F.polygonBoundsOverlap=function(u,f){var y=(0,k.WN)(F.getPolyBoundLeft(u),F.getPolyBoundRight(u),F.getPolyBoundLeft(f),F.getPolyBoundRight(f)),I=(0,k.WN)(F.getPolyBoundLower(u),F.getPolyBoundUpper(u),F.getPolyBoundLower(f),F.getPolyBoundUpper(f));return y&&I},F.circleRectangleOverlap=function(u,f,y){var I=Math.max(u.left,Math.min(f.x,u.right)),w=Math.min(u.bottom,Math.max(f.y,u.top)),M=I-f.x,z=w-f.y;return M*M+z*z<=y*y},F.linesIntersect=function(u,f,y,I,w){void 0===w&&(w=!0);var M=(0,G.oY)(u,f,y),z=(0,G.oY)(u,f,I),L=(0,G.oY)(y,I,u),x=(0,G.oY)(y,I,f);return M!==z&&L!==x||!!w&&!!(M===B.i.Colinear&&(0,G.ao)(u,f,y)||z===B.i.Colinear&&(0,G.ao)(u,f,I)||L===B.i.Colinear&&(0,G.ao)(y,I,u)||x===B.i.Colinear&&(0,G.ao)(y,I,f))},F.resize=function(u,f){if(0===f)return u;for(var y=F.calculateAbsolutePolygonArea(u.polygonPoints)>0,w=_.clone(f>0&&!0===y||f<0&&!1===y?u.polygonPoints.reverse():u.polygonPoints),M=u.absoluteCentroid(),z=[],L=0;L<w.length;L++){var x=w[L],W=w[(L+1)%w.length],Z=W.y-x.y,X=void 0;0!==Z&&(X=-(W.x-x.x)/Z);var ue=0;_.isUndefined(X)||(ue=(x.y<W.y?-1:1)*Math.sqrt(f*f/(1+X*X)));var te=0;0===ue?te=(x.x>W.x?-1:1)*f:_.isUndefined(X)||(te=X*ue);var K={x:x.x+ue,y:x.y+te},ee={x:0,y:0};0===X?(ee.x=K.x,ee.y=K.y+10):_.isUndefined(X)||(ee.x=K.x+10,ee.y=K.y-10/X);var fe=(K.x-ee.x)*(M.y-x.y)-(K.y-ee.y)*(M.x-x.x);if(0!==fe){var ie={x:((K.x*ee.y-K.y*ee.x)*(M.x-x.x)-(K.x-ee.x)*(M.x*x.y-M.y*x.x))/fe,y:((K.x*ee.y-K.y*ee.x)*(M.y-x.y)-(K.y-ee.y)*(M.x*x.y-M.y*x.x))/fe};isFinite(ie.x)&&isFinite(ie.y)&&z.push(ie)}}return F.fromPolygonPoints(z)},F.getPolyBoundLeft=function(u){var f;return null===(f=_.minBy(u.polygonPoints,function(y){return y.x}))||void 0===f?void 0:f.x},F.getPolyBoundRight=function(u){var f;return null===(f=_.maxBy(u.polygonPoints,function(y){return y.x}))||void 0===f?void 0:f.x},F.getPolyBoundUpper=function(u){var f;return null===(f=_.maxBy(u.polygonPoints,function(y){return y.y}))||void 0===f?void 0:f.y},F.getPolyBoundLower=function(u){var f;return null===(f=_.minBy(u.polygonPoints,function(y){return y.y}))||void 0===f?void 0:f.y},F.prototype.isConflictWithBoundingBox=function(u){return(0,k.HL)(this.absoluteBoundingRect(),u)},F.prototype.calculatePolygonCentroid=function(){var u,f,y,I,w,M;for(u=F.calculateAbsolutePolygonArea(this.polygonPoints),y=I=0,M=1,w=0;w<this.polygonPoints.length;w++)y+=(this.polygonPoints[w].x+this.polygonPoints[M].x)*(f=this.polygonPoints[w].x*this.polygonPoints[M].y-this.polygonPoints[M].x*this.polygonPoints[w].y),I+=(this.polygonPoints[w].y+this.polygonPoints[M].y)*f,M=(M+1)%this.polygonPoints.length;return{x:y/=6*u,y:I/=6*u}},F.prototype.calculateBoundingRect=function(){for(var u=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,I=Number.NEGATIVE_INFINITY,w=0,M=this.polygonPoints;w<M.length;w++){var z=M[w];z.x<u?u=z.x:z.x>y&&(y=z.x),z.y<f?f=z.y:z.y>I&&(I=z.y)}return{left:u,top:f,width:y-u,height:I-f}},F.prototype.getLineIntersection=function(u,f,y,I){var w=u.x,M=u.y,x=y.x,W=y.y,ue=f.x-w,te=f.y-M,K=I.x-x,ee=I.y-W,fe=(-te*(w-x)+ue*(M-W))/(-K*te+ue*ee),ie=(K*(M-W)-ee*(w-x))/(-K*te+ue*ee);return fe>=0&&fe<=1&&ie>=0&&ie<=1?{x:w+ie*ue,y:M+ie*te}:null},F.prototype.convertArrayPathToPoints=function(u){for(var f=[],y=0;y<u.length;y+=2)f.push({x:u[y],y:u[y+1]});return f},F}()},34644:function(Me,ce,P){P.d(ce,{Ad:function(){return G},LL:function(){return j},_9:function(){return k}});var B=P(62458);function G(F){switch(F){case"linear":return d3.easeLinear;case"cubic-in-out":return d3.easeCubicInOut;case"cubic-out":return d3.easeCubicOut;case"back":return d3.easeBack;default:B.fF.assertNever(F)}return d3.easeCubicInOut}function k(F){return!!F.bandwidth}function j(F,u){var f=F.selectAll(_.map(u,function(y){return y.selector}).join(", ")).nodes();f.sort(function(y,I){for(var w=0,M=0;M<u.length;M++)w+=+d3.select(y).classed(u[M].class)*M,w-=+d3.select(I).classed(u[M].class)*M;return w}),d3.selectAll(f).order()}},19377:function(Me,ce,P){P.d(ce,{i:function(){return B}});var B=function(G){return G[G.Clockwise=0]="Clockwise",G[G.Counterclockwise=1]="Counterclockwise",G[G.Colinear=2]="Colinear",G}({})}}]);