"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["field-list"],{94165:function(et,I,r){r.r(I),r.d(I,{FieldListModule:function(){return Ge}});var a=r(81337),K=r(22346),A=r(58286),n=r(50423),G=r(40290),p=r(8590),T=r(21728),Q=r(87879),X=r(94419),m=r(9738),d=r(70863),Y=r(58295),Z=r(44529),w=r(88315),q=r(9380),C=r(11494),_=r(83008),ee=r(39503),x=r(72262),te=r(28199),b=r(93215),ie=r(23983),ne=r(66890),y=function(){function t(e,i,o,s,l,v,g,f,S,M,L){var u=this;this.featureSwitchService=e,this.eventBridge=i,this.aggrOpsService=o,this.dataSourcesService=s,this.modelService=l,this.groupingDesignStateService=v,this.visualAuthoringService=g,this.explorationNavigationService=f,this.selectionService=S,this.fieldListCheckedService=M,this.modelingSelectionService=L,this.subscriptionManager=i.createChannelSubscriptionManager(),this.subscriptionManager.subscribe(p.oRp,function(){return u.updateFieldListCheckFromSelectedVisual()}),this.subscriptionManager.subscribe(p.jCS,function(){return u.updateFieldListCheckFromSelectedVisual()}),this.modelService.modelChange$.subscribe(function(){return u.updateFieldListCheckFromSelectedVisual()}),this.subscriptionManager.subscribe(p.OPn,function(){return u.modelingSelectionService.clear()}),this.subscriptionManager.subscribe(p.tRg,function(){u.modelingSelectionService.clear(),u.updateFieldListCheckFromSelectedVisual()}),this.subscriptionManager.subscribe(p.KD7,function(){u.modelingSelectionService.clear(),u.updateFieldListCheckFromSelectedVisual()})}return t.prototype.updateFieldListCheckFromSelectedVisual=function(){this.fieldListCheckedService.selectAll(this.getModelItemsFromSelectedVisual(this.modelService.model),!0)},t.prototype.addFieldToVisual=function(e){return(0,a.__awaiter)(this,void 0,void 0,function(){var i,o,s;return(0,a.__generator)(this,function(l){switch(l.label){case 0:return i=this.getFieldExpr(e),(o=T.UP.getSelectedVisual(this.selectionService))?(s=16===o.visibility,[4,this.visualAuthoringService.addFieldToVisual(i,this.dataSourcesService.get(),o,"CheckboxTickedInFieldList",s)]):[3,2];case 1:return[2,l.sent()];case 2:return this.eventBridge.publishToChannel(p.Tyr,{expr:i,allowAggregate:!0,telemetrySource:0}),[2,!0]}})})},t.prototype.removeField=function(e){this.visualAuthoringService.removeFieldFromAllRoles(this.dataSourcesService.get(),this.getFieldExpr(e))},t.prototype.addToDrillTrhough=function(e){this.visualAuthoringService.addDrillthroughFilter(this.getFieldExpr(e),{container:this.explorationNavigationService.getCurrentSection(),scopeType:1},this.dataSourcesService.get(),!0)},t.prototype.canAddToFilter=function(e){return!(0,d.kb)(e)||!this.castToConceptualItem(e).schema.capabilities.limitMultiColumnFiltersToQueryGroupColumns},t.prototype.addReportLevelFilter=function(e){this.visualAuthoringService.addFilter(this.getFieldExpr(e),{container:this.explorationNavigationService.getCurrentExploration(),scopeType:2},this.dataSourcesService.get())},t.prototype.addPageLevelFilter=function(e){this.visualAuthoringService.addFilter(this.getFieldExpr(e),{container:this.explorationNavigationService.getCurrentSection(),scopeType:1},this.dataSourcesService.get())},t.prototype.addVisualLevelFilter=function(e,i){this.visualAuthoringService.addFilter(this.getFieldExpr(e),{container:i,scopeType:0},this.dataSourcesService.get())},t.prototype.getTopNVisualFilters=function(e){return this.visualAuthoringService.createVisualFilters(this.explorationNavigationService.getCurrentSection(),e,this.dataSourcesService.get(),this.modelService.schema).filter(function(i){return i.contract&&i.contract.type===G.vA.TopN})},t.prototype.addToTopNFilterValue=function(e,i){var o=this.getFieldExpr(e),s=(0,Y.k)(o)?o:(0,X.m_)(o,this.aggrOpsService.defaultAggregate(o,this.modelService.schema,!0));this.eventBridge.publishToChannel(Q.d,{filterViewModel:i,orderByField:s})},t.prototype.getModelItemsFromSelectedVisual=function(e){if(!e)return[];var i=[],o=T.UP.getSelectedVisual(this.selectionService);if(o&&o.config.singleVisual&&o.config.singleVisual.query&&o.config.singleVisual.query.defn)if(this.featureSwitchService.featureSwitches.fieldParameters)for(var l=0,v=o.config.singleVisual.query.getUniqueQueryFields();l<v.length;l++)i.push.apply(i,e.findItems(v[l].expr));else for(var f=0,S=o.config.singleVisual.query.defn.select();f<S.length;f++)i.push.apply(i,e.findItems(S[f].expr));return i},t.prototype.getFieldExpr=function(e){return(0,Z.Sd)(this.castToConceptualItem(e),this.groupingDesignStateService)},t.prototype.castToConceptualItem=function(e){if(e instanceof w.Xx)return e;throw Error("invalid type passed to toConceptualItem")},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275inject(q.vZ),n.\u0275\u0275inject(C.J),n.\u0275\u0275inject(te.C),n.\u0275\u0275inject(_.D),n.\u0275\u0275inject(b.b),n.\u0275\u0275inject(ie.AA),n.\u0275\u0275inject(ne.$8),n.\u0275\u0275inject(ee.z),n.\u0275\u0275inject(x.z),n.\u0275\u0275inject(m.fc),n.\u0275\u0275inject(m.W6))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),j=function(){function t(e){this.fieldListReportAuthoringService=e}return t.prototype.check=function(e){return(0,a.__awaiter)(this,void 0,void 0,function(){var i;return(0,a.__generator)(this,function(o){switch(o.label){case 0:return e.checked?(i=e.flatNode.node,[4,this.fieldListReportAuthoringService.addFieldToVisual(e.flatNode.node.data)]):[3,2];case 1:return i.checked=o.sent(),[3,3];case 2:e.flatNode.node.checked=!1,this.fieldListReportAuthoringService.removeField(e.flatNode.node.data),o.label=3;case 3:return[2]}})})},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275inject(y))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),c=r(64560),V=function(t){return t.AddToDrillthrough="FieldListMenuItem_AddToDrillthrough",t}({}),oe={items:[{id:V.AddToDrillthrough,type:c.iB.Button,text:"FieldListMenuItem_AddToDrillthrough",tooltip:"FieldListMenuItem_AddToDrillthrough"}]},N=function(){function t(e){this.fieldListReportAuthoringService=e}return t.prototype.getHandler=function(e){var i=this;return[V.AddToDrillthrough,{execute:function(){return i.fieldListReportAuthoringService.addToDrillTrhough(e)}}]},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275inject(y))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),h=function(t){return t.AddToFilters="FieldListMenuItem_AddToFilters",t.AddToReportLevelFilters="FieldListMenuItem_ReportLevelFilters",t.AddToPageLevelFilters="FieldListMenuItem_PageLevelFilters",t.AddToVisualLevelFilters="FieldListMenuItem_VisualLevelFilters",t}({}),ce={items:[{id:h.AddToFilters,type:c.iB.SubMenu,text:"FieldListMenuItem_AddToFilters",tooltip:"FieldListMenuItem_AddToFilters",menu:{items:[{id:h.AddToVisualLevelFilters,type:c.iB.Button,text:"FieldListMenuItem_VisualLevelFilters",tooltip:"FieldListMenuItem_VisualLevelFilters"},{id:h.AddToPageLevelFilters,type:c.iB.Button,text:"FieldListMenuItem_PageLevelFilters",tooltip:"FieldListMenuItem_PageLevelFilters"},{id:h.AddToReportLevelFilters,type:c.iB.Button,text:"FieldListMenuItem_ReportLevelFilters",tooltip:"FieldListMenuItem_ReportLevelFilters"}]}}]},F=function(t){return t.AddToTopNFilters="FieldListMenuItem_AddToTopNByValue",t.AddToTopNFilter="AddToTopNFilter",t}({}),he={items:[{id:F.AddToTopNFilters,type:c.iB.SubMenu,text:"FieldListMenuItem_AddToTopNByValue",tooltip:"FieldListMenuItem_AddToTopNByValue"}]},H=function(){function t(e,i){this.selectionService=e,this.fieldListReportAuthoringService=i}return t.prototype.getHandlers=function(e){var i=this;if(!this.fieldListReportAuthoringService.canAddToFilter(e))return[];var o=[[h.AddToFilters,{execute:void 0}],[h.AddToReportLevelFilters,{execute:function(){return i.fieldListReportAuthoringService.addReportLevelFilter(e)}}],[h.AddToPageLevelFilters,{execute:function(){return i.fieldListReportAuthoringService.addPageLevelFilter(e)}}]],s=T.UP.getSelectedVisual(this.selectionService);return s&&(o.push([h.AddToVisualLevelFilters,{execute:function(){return i.fieldListReportAuthoringService.addVisualLevelFilter(e,s)}}]),o.push([F.AddToTopNFilters,{getSubItems:function(){return i.getTopNVisualFiltersMenuItems(s)},execute:void 0}]),o.push([F.AddToTopNFilter,{execute:function(v){i.fieldListReportAuthoringService.addToTopNFilterValue(e,v.menuItem.data)}}])),o},t.prototype.getTopNVisualFiltersMenuItems=function(e){return this.fieldListReportAuthoringService.getTopNVisualFilters(e).sort(function(i,o){return i.displayName.localeCompare(o.displayName)}).map(function(i){return{id:F.AddToTopNFilter,type:c.iB.Button,text:i.displayName,tooltip:i.displayName,data:i}})},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275inject(x.z),n.\u0275\u0275inject(y))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),R=function(t){return t.AddToField="FieldListMenuItem_AddToField",t}({}),ve={id:R.AddToField,type:c.iB.Button,text:"FieldListMenuItem_AddToField",tooltip:"FieldListMenuItem_AddToField"},B=function(t){return t.Select="Select",t}({}),ge={items:[ve,{id:B.Select,type:c.iB.Button,text:"Select",tooltip:"Select",checkable:!1}]},D=r(81141),k=function(){function t(e,i){this.fieldListReportAuthoringService=e,this.checkSettingStrategy=i}return t.prototype.getHandlers=function(e){var i=this;return this.canAddToField(e)?[[R.AddToField,{execute:function(s){return i.fieldListReportAuthoringService.addFieldToVisual(e)}}]]:[]},t.prototype.canAddToField=function(e){return!!this.checkSettingStrategy&&((0,d.t3)(e)||(0,d.kb)(e)||(0,d.y3)(e),this.checkSettingStrategy.isCheckable(e))},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275inject(y),n.\u0275\u0275inject(D.x,8))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),Se=[H,N,k,function(){function t(e){this.modelingSelectionService=e}return t.prototype.getHandlers=function(e){var i=this;return[[B.Select,{execute:function(s){return i.modelingSelectionService.select(s.flatNode.node.data,!0)}}]]},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275inject(m.W6))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),A.H,j,y],me=r(19129),ye=r(72038),P=r(66444),Fe=[ge,me.qd,ce,oe,he],O=function(){function t(e,i,o,s,l){this.menuFactory=e,this.expandCollapseMenuItemHandlers=i,this.checkMenuItemHandler=o,this.addToFiltersMenuItemHandler=s,this.addToDrillthroughItemHandler=l,this.menuMode=c.Kb.Compact,this.activeContextMenuRef=void 0}return t.prototype.menuClick=function(e){},t.prototype.menuOpen=function(e){this.activeContextMenuRef=e.menuRef},t.prototype.menuClose=function(e){this.activeContextMenuRef=void 0},t.prototype.closeActiveMenu=function(){void 0!==this.activeContextMenuRef&&this.activeContextMenuRef.close()},t.prototype.getMenu=function(e){var i;return this.menuFactory.getMenu(e,Fe,this.getItemMenuHandlers(null===(i=e.flatNode)||void 0===i?void 0:i.node.data))},t.prototype.menuItemClick=function(e){var i,o,s=this.getItemMenuHandlers(null===(i=e.flatNode)||void 0===i?void 0:i.node.data).get(e.menuItem.id);s.execute?s.execute(e):s.executeMany&&s.executeMany([null===(o=e.flatNode)||void 0===o?void 0:o.node.data],e)},t.prototype.getItemMenuHandlers=function(e){var i=[];return i.push.apply(i,this.expandCollapseMenuItemHandlers.getHandlers()),e&&(((0,d.t3)(e)||(0,d.kb)(e)||(0,d.y3)(e)||(0,d.ez)(e))&&i.push.apply(i,this.checkMenuItemHandler.getHandlers(e)),((0,d.t3)(e)||(0,d.kb)(e)||(0,d.ez)(e))&&(i.push.apply(i,this.addToFiltersMenuItemHandler.getHandlers(e)),i.push(this.addToDrillthroughItemHandler.getHandler(e)))),new Map(i)},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275inject(ye.E),n.\u0275\u0275inject(P.T),n.\u0275\u0275inject(k),n.\u0275\u0275inject(H),n.\u0275\u0275inject(N))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t}(),E=r(90166),z=r(75096),Te=r(7779),Me=r(59725),Le=r(34763),U=r(14172),Ie=r(8538),Ae=r(29834),Ce=r(50998),xe=r(29524),be=r(88023),$=r(72193),je=r(72525),Ve=r(412),Ne=r(66014),He=r(65005),Re=r(56213),J=r(77476),W=function(){function t(e,i,o,s,l,v,g,f,S,M,L,u,Qe,Xe,Ye,Ze,we,qe,_e){this.modelService=i,this.modelingSelectionService=o,this.modelingCheckingService=s,this.modelChangeSelectionSynchronizer=l,this.schemaItemActivationServiceSynchronizer=v,this.captionSetting=g,this.draggableSetting=f,this.hiddenSetting=S,this.inlineItemsSetting=M,this.checkableSetting=L,this.fieldListTreeService=u,this.clickStrategy=Qe,this.menuStrategy=Xe,this.checkStrategy=Ye,this.dragDropStrategy=Ze,this.keyboardStrategy=we,this.tooltipStrategy=qe,this.gettingStartedService=_e,this.fieldListTree$=this.fieldListTreeService.fieldListTree$,this.fieldListOptions={click:this.clickStrategy,check:this.checkStrategy,menu:this.menuStrategy,dragDrop:this.dragDropStrategy,keyboard:this.keyboardStrategy,tooltip:this.tooltipStrategy},this.pbiTreeNodeSettingOptions={captionSetting:this.captionSetting,draggableSetting:this.draggableSetting,inlineItemsSetting:this.inlineItemsSetting,checkableSetting:this.checkableSetting,hiddenSetting:this.hiddenSetting},this.checkMode=Me.kH.Multi,this.subscription=new Le.w,this.fieldListTreeService.modelToPbiTreeConverterOptions=this.pbiTreeNodeSettingOptions,this.subscriptionManager=e.createChannelSubscriptionManager()}return t.prototype.ngOnInit=function(){var e=this;this.subscriptionManager.subscribe(p.LE3,function(){return e.modelService.update(void 0)}),this.subscription.add(this.modelService.modelChange$.subscribe(function(i){return e.onModelChange(i)})),this.subscription.add(this.modelingSelectionService.selectionChanged.subscribe(function(i){return e.updateSelection(i)})),this.subscription.add(this.modelingCheckingService.selectionChanged.subscribe(function(i){return e.fieldListTreeService.updateChecked(i)})),this.loading$=this.gettingStartedService.currentState$.pipe((0,U.U)(function(i){return 1===i})),this.emptyModel$=this.gettingStartedService.currentState$.pipe((0,U.U)(function(i){return 0===i})),this.schemaItemActivationServiceSynchronizer.initialize(),this.modelService.update(void 0)},t.prototype.ngOnDestroy=function(){this.subscriptionManager.unsubscribeAll(),this.subscription.unsubscribe()},t.prototype.updateSelection=function(e){this.closeActiveMenus(),this.fieldListTreeService.updateSelected(e)},t.prototype.closeActiveMenus=function(){this.menuStrategy&&this.menuStrategy.closeActiveMenu()},t.prototype.onModelChange=function(e){this.modelChangeSelectionSynchronizer.update(e.model,e.appliedChanges),this.fieldListTreeService.setOrUpdateFieldListTreeModel(e.model,this.modelingSelectionService.selection,this.modelingCheckingService.selection)},t.\u0275fac=function(i){return new(i||t)(n.\u0275\u0275directiveInject(C.J),n.\u0275\u0275directiveInject(b.b),n.\u0275\u0275directiveInject(m.W6),n.\u0275\u0275directiveInject(m.fc),n.\u0275\u0275directiveInject(Ce.O),n.\u0275\u0275directiveInject(Ie.h),n.\u0275\u0275directiveInject(xe.B),n.\u0275\u0275directiveInject(be.F),n.\u0275\u0275directiveInject($.J),n.\u0275\u0275directiveInject(je.wt),n.\u0275\u0275directiveInject(D.x),n.\u0275\u0275directiveInject(z.p),n.\u0275\u0275directiveInject(E.Y),n.\u0275\u0275directiveInject(O),n.\u0275\u0275directiveInject(j),n.\u0275\u0275directiveInject(A.H),n.\u0275\u0275directiveInject(Ve.W),n.\u0275\u0275directiveInject(Ne.Z),n.\u0275\u0275directiveInject(Ae.c))},t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["field-list-container"]],features:[n.\u0275\u0275ProvidersFeature((0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],Se,!0),Te.r,!0),[E.Y,O,P.T,z.p],!1))],decls:6,vars:11,consts:[[1,"container",3,"click"],["focus-nav-mode","Browser","fluent","true",3,"fieldListTree","scrollSelectedItemIntoViewOnInit","checkMode","options","loading"],[1,"pbi-field-list-watermark"]],template:function(i,o){1&i&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275listener("click",function(l){return l.stopPropagation()}),n.\u0275\u0275elementStart(1,"pbi-field-list",1),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275pipe(3,"async"),n.\u0275\u0275pipe(4,"async"),n.\u0275\u0275element(5,"field-list-watermark",2),n.\u0275\u0275elementEnd()()),2&i&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("fieldListTree",n.\u0275\u0275pipeBind1(2,5,o.emptyModel$)?null:n.\u0275\u0275pipeBind1(3,7,o.fieldListTree$))("scrollSelectedItemIntoViewOnInit",!0)("checkMode",o.checkMode)("options",o.fieldListOptions)("loading",n.\u0275\u0275pipeBind1(4,9,o.loading$)))},dependencies:[He.l,Re.s,J.AsyncPipe],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}pbi-field-list[_ngcontent-%COMP%]{flex:1;padding:0 4px}pbi-field-list[_ngcontent-%COMP%]     pbi-tree{margin-top:8px;padding-top:0!important}"],changeDetection:0}),t}(),Be=r(52910),De=r(82156),ke=r(79061),Pe=r(34256),Oe=r(69792),Ee=r(41920),ze=r(97930),Ue=r(72359),$e=r(90938),Je=r(63654),We=r(94841),Ke=[{type:W,componentId:"FieldListContainerComponentId"}],Ge=function(){function t(){}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({providers:(0,a.__spreadArray)((0,a.__spreadArray)((0,a.__spreadArray)([],Pe.q,!0),Ee.U,!0),[$.J],!1),imports:[J.CommonModule,Be.O,K.J,De.N.withManifests(Ke),ke.v,We.b,Ue.K,$e.g,Je.X,ze.g,Oe.v]}),t}()}}]);