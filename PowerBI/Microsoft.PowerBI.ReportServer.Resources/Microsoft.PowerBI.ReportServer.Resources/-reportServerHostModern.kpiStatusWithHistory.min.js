"use strict";(self.webpackChunkreportServerHostModern=self.webpackChunkreportServerHostModern||[]).push([["kpiStatusWithHistory"],{3352:function(De,nt,g){g.r(nt),g.d(nt,{KPIStatusWithHistory:function(){return b}});var F=g(81337),$=g(14599),i=g(47895),f=g(90120),q=g(21181),it=g(56707),W=g(18664),U=g(32105),lt=g(33024),k=g(18765),V=g(92374),H=g(44027),M=g(97878),R=g(20486),bt=g(45296),G=g(44783),c=g(79154),w=g(62458),tt=g(38265),B=g(32041),l=g(56578),L=g(64329),st=g(58098),Y=g(38958),s=g(82755),et=g(72489),ct="powervisuals-glyph",at="foregroundNeutralDark",dt="foregroundNeutralSecondary",xt=(0,c.CH)("kpiVisual"),_t=(0,c.CH)("kpiGraphicsContext"),b=function(){function e(t){t&&(this.interactivityEnabled=t.interactivityEnabled)}return e.prototype.init=function(t){this.host=t.host,this.style=t.style,e.getLocalizedString=t.host.getLocalizedString.bind(t.host),this.rootElement=d3.select(t.element.get(0)).append("div").classed(xt.class,!0),this.svg=this.rootElement.append("svg").classed(_t.class,!0),this.interactivityEnabled&&this.svg.attr("tabindex",0).attr("focusable",!0);var o=this.svg.append("g");this.areaFill=o.append("path"),this.lastTrendAxisPointSummaryContainer=this.rootElement.append("div").classed("lastTrendAxisPointSummaryContainer",!0),this.indicatorContainer=this.lastTrendAxisPointSummaryContainer.append("div").classed("indicatorContainer",!0),this.indicatorText=this.indicatorContainer.append("div").classed("indicatorText",!0),this.indicatorIcon=this.indicatorContainer.append("div").classed("powervisuals-glyph",!0),this.goalText=this.lastTrendAxisPointSummaryContainer.append("div").classed("goalText",!0).style("color",f.v.getThemeColor(this.style,G.fA)),this.distanceText=this.lastTrendAxisPointSummaryContainer.append("div").classed("distanceText",!0),this.lastDateText=this.lastTrendAxisPointSummaryContainer.append("div").classed("lastDateText",!0),e.initDefaultLabelSettings(this.style)},e.prototype.update=function(t){if(t.dataViews&&t.dataViews[0]){var o=this.dataView=t.dataViews[0],r=t.viewport;if((!o.categorical||!o.categorical.values||o.categorical.values.length<1)&&(!o.categorical||!o.categorical.categories||o.categorical.categories.length<1))return this.svg.attr("visibility","hidden"),void this.lastTrendAxisPointSummaryContainer.attr("style","display:none");this.svg.attr("visibility","visible");var a=e.converter(o,r,e.getPropKPIDirection(o),this.style,this.host);if(this.hasGoal=!_.isEmpty(a.goals),this.interactivityEnabled){var n=""===a.formattedGoalString?"":" ".concat(a.formattedGoalString,"."),d="".concat(e.getLocalizedString("KpiValueFieldListDisplayName")," ").concat(a.formattedValue,".").concat(n);this.svg.attr("aria-label",d)}this.render(a,r)}},e.calculateHeight=function(t,o,r,a,n,d,u,m,h,S,p){var P=L.FP.fromPoint(t.indicatorFont.size.pt),v=B.b.measureSvgTextHeight({fontFamily:d,fontSize:P},o);if(t.indicatorIconShowIcon&&p){var I=L.FP.fromPoint(t.indicatorIconSize),y=B.b.measureSvgGlyphHeight(I,ct,p);v=Math.max(v,y)}var C=0,A=L.FP.fromPoint(t.distanceFont.size.pt);t.showDistanceFromGoal&&(C=B.b.measureSvgTextHeight({fontFamily:m,fontSize:A},a));var D=0,z=L.FP.fromPoint(t.goalFont.size.pt);if(t.showGoal&&(D=B.b.measureSvgTextHeight({fontFamily:u,fontSize:z},r)),S){var T=L.FP.fromPoint(t.lastDateFont.size.pt);v+=B.b.measureSvgTextHeight({fontFamily:h,fontSize:T},t.lastDateValue)}return t.showGoal&&t.showDistanceFromGoal?B.b.measureSvgTextWidth({fontFamily:u,fontSize:z},r)+B.b.measureSvgTextWidth({fontFamily:m,fontSize:A},a)>n?v=v+C+D:v+=D>C?D:C:(t.showGoal&&(v+=D),t.showDistanceFromGoal&&(v+=C)),v},e.prototype.render=function(t,o){if(this.setShowDataMissingWarning(!(t.indicatorExists&&t.trendExists)),0===t.dataPoints.length||!t.indicatorExists||!t.trendExists)return this.areaFill.attr("visibility","hidden"),this.svg.attr("visibility","hidden"),void this.lastTrendAxisPointSummaryContainer.attr("style","display:none");this.svg.attr("height",o.height).attr("width",o.width);var r=e.status.NOGOAL,a=null;t.targetExists&&t.indicatorExists&&t.trendExists&&(r=function(e,t,o){if(!t||0===t.length)return b.status.NOGOAL;var r,a;if(2===t.length){if(r=Math.max.apply(Math,t),e>=(a=Math.min.apply(Math,t))&&e<=r)return b.status.IN_BETWEEN}else r=t[0],a=t[0];switch(o){case H.i1:if(e<a)return b.status.DROP;break;case H.pd:if(e>r)return b.status.DROP}return b.status.INCREASE}(t.actual,t.goals,t.directionType));for(var h,n=t.formattedValue,d=t.showLastDate,u=t.showGoal?t.formattedGoalString+" ":"",m=t.showDistanceFromGoal?t.formattedDistanceString:"",S=0,p=e.indicatorIconContent;S<p.length;S++)if(r===(P=p[S]).status){h=P.hexCode,a=P.textId;break}var C,v=e.calculateHeight(t,n,u,m,o.width,t.indicatorFont.family,t.goalFont.family,t.distanceFont.family,t.lastDateFont.family,d,h),I="",y="";if(t.horizontalAlignment===V.D.center&&(I+="width: "+o.width+"px; text-align: center;",y+="justify-content: center"),t.horizontalAlignment===V.D.left&&(I+="left: 8px; text-align: left;",y+="justify-content: flex-start"),t.horizontalAlignment===V.D.right&&(I+="right: 5px; text-align: right;",y+="justify-content: flex-end"),t.verticalAlignment===k.Q4.middle&&(I+="top:"+(o.height-v)/2+"px"),t.verticalAlignment===k.Q4.top&&(I+="top: 5px;"),t.verticalAlignment===k.Q4.bottom&&(I+="bottom: 5px;"),this.lastTrendAxisPointSummaryContainer.attr("style",I),this.indicatorContainer.attr("style",y),C=r===e.status.NOGOAL?t.indicatorFont.color:function(e,t){switch(e){case b.status.NOGOAL:return w.fF.assertFail("should not call this function without a goal (for `callout` textClass color theme reasons)"),t.textGrey;case b.status.INCREASE:return t.good;case b.status.IN_BETWEEN:return t.neutral;case b.status.DROP:return t.bad}}(r,t.colors),this.indicatorText.styles((0,W.wB)(t.indicatorFont)).text(n),this.indicatorText.style("color",C),t.indicatorIconShowIcon&&!this.indicatorIcon?this.indicatorIcon=this.indicatorContainer.append("div").classed(ct,!0):!t.indicatorIconShowIcon&&this.indicatorIcon&&(this.indicatorIcon.remove(),this.indicatorIcon=null),this.indicatorIcon){for(var A=0,D=e.indicatorIconContent;A<D.length;A++){var P;this.indicatorIcon.classed((P=D[A]).class,r===P.status)}this.indicatorIcon.styles((0,W.wB)({size:U.B.createFromPt(t.indicatorIconSize)})),this.indicatorIcon.style("color",C),r!==e.status.NOGOAL&&this.indicatorIcon.attr("role","img").attr("aria-label",e.getLocalizedString(a))}this.goalText.styles((0,W.wB)(t.goalFont)).text(u),this.distanceText.styles((0,W.wB)(t.distanceFont)).text(" "+m);var z="";if(t.showLastDate&&(z=t.lastDateValue),this.lastDateText.styles((0,W.wB)(t.lastDateFont)).text(z),t.showTrendLine&&t.historyExists){var E=d3.area().x(function(N){return N.x}).y0(o.height).y1(function(N){return N.y}),T=function(e,t){switch(e){case b.status.NOGOAL:return t.graphGrey;case b.status.INCREASE:return t.good;case b.status.IN_BETWEEN:return t.neutral;case b.status.DROP:return t.bad}}(r,t.colors);this.areaFill.attr("d",E(t.dataPoints)).attr("stroke","none").attr("visibility","visible").attr("fill-opacity",t.indicatorTransparency/100).style("color",T).style("fill",T)}else this.areaFill.attr("visibility","hidden")},e.prototype.setShowDataMissingWarning=function(t){this.host.setWarnings(t?[new bt.EY]:[])},e.getDefaultFormatSettings=function(t){var o=(0,q.bT)({show:!0,fontSize:45,labelColor:f.v.getThemeColor(t,at),fontFamily:tt.Wn.lightSecondary.family,style:t,textClassName:"callout",bold:"normal",italic:"normal",underline:"none"}),r=(0,q.bT)({show:!0,fontSize:8,labelColor:f.v.getThemeColor(t,"foreground"),fontFamily:tt.Wn.semibold.family,style:t,textClassName:"largeLabel"}),a=(0,q.bT)({show:!0,fontSize:9,labelColor:f.v.getThemeColor(t,"foreground"),fontFamily:tt.Wn.regular.family,style:t,textClassName:"smallLabel"}),n={family:r.fontProperties.family,size:r.fontProperties.size,color:r.fontProperties.color,weight:c.AI,style:c.AI,textDecoration:c.zu},d={family:r.fontProperties.family,size:r.fontProperties.size,color:r.fontProperties.color,weight:c.AI,style:c.AI,textDecoration:c.zu},u={family:a.fontProperties.family,size:a.fontProperties.size,color:a.fontProperties.color,weight:c.AI,style:c.AI,textDecoration:c.zu};return{labelSettings:o,indicatorIconSize:U.B.createFromPx(12).pt,indicatorIconShowIcon:!0,indicatorTransparency:20,goalFont:n,distanceLabel:R.aQ,distancePrecision:2,distanceFont:d,lastDateFont:u,wordWrap:!1,horizontalAlignment:"center",verticalAlignment:"middle",bold:!1,italic:!1,underline:!1}},e.getFormatString=function(t){return w.fF.assertAnyValue(t,"column"),(0,et.EO)(t,$.e0.formatString)},e.getPropShowKPIGoal=function(t){return!t||!t.metadata||(0,s.NA)(t.metadata.objects,i.xg.showKPIGoal,!0)},e.getPropShowKPITrendLine=function(t){return!t||!t.metadata||(0,s.NA)(t.metadata.objects,i.xg.showKPITrendLine,!0)},e.getPropShowKPILastDate=function(t){return!(!t||!t.metadata)&&(0,s.NA)(t.metadata.objects,i.xg.showKPILastDate,!1)},e.getPropShowKPIDistance=function(t){return!t||!t.metadata||(0,s.NA)(t.metadata.objects,i.xg.showKPIDistance,!0)},e.getPropKPIDirection=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.directionTypeStringProp,H.i1):H.i1},e.getPropGoodColor=function(t,o){var r=f.v.getSentimentColor(o,"good",G.fA);return t&&t.metadata?f.v.create(o).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.goodColorProp,r):r},e.getPropNeutralColor=function(t,o){var r=f.v.getSentimentColor(o,"neutral",G.fA);return t&&t.metadata?f.v.create(o).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.neutralColorProp,r):r},e.getPropBadColor=function(t,o){var r=f.v.getSentimentColor(o,"bad",G.fA);return t&&t.metadata?f.v.create(o).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.badColorProp,r):r},e.getPropIndicatorDisplayUnits=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorDisplayUnitsProp,e.defaultLabelSettings.displayUnits):e.defaultLabelSettings.displayUnits},e.getPropIndicatorHorizontalAlignment=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorHorizontalAlignmentProp,e.defaultCardFormatSetting.horizontalAlignment):e.defaultCardFormatSetting.horizontalAlignment},e.getPropIndicatorVerticalAlignment=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorVerticalAlignmentProp,e.defaultCardFormatSetting.verticalAlignment):e.defaultCardFormatSetting.verticalAlignment},e.getPropIndicatorPrecision=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorPrecisionProp,e.defaultLabelSettings.precision):e.defaultLabelSettings.precision},e.getPropIndicatorFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorFontSizeProp,e.defaultCardFormatSetting.labelSettings.fontProperties.size.pt):e.defaultCardFormatSetting.labelSettings.fontProperties.size.pt},e.getPropIndicatorFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorFontFamilyProp,e.defaultCardFormatSetting.labelSettings.fontProperties.family):e.defaultCardFormatSetting.labelSettings.fontProperties.family},e.getPropIndicatorFontColor=function(t,o){var r=e.defaultCardFormatSetting.labelSettings.fontProperties.color;return t&&t.metadata?f.v.create(o).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.indicatorFontColorProp,r):r},e.getPropIndicatorIconSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorIconSizeProp,e.defaultCardFormatSetting.indicatorIconSize):e.defaultCardFormatSetting.indicatorIconSize},e.getPropIndicatorShowIcon=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorIconShowIconProp,!0):e.defaultCardFormatSetting.indicatorIconShowIcon},e.getPropIndicatorTransparency=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorTransparencyProp,e.defaultCardFormatSetting.indicatorTransparency):e.defaultCardFormatSetting.indicatorTransparency},e.getPropIndicatorBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getPropIndicatorItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getPropIndicatorUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.indicatorUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropGoalFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalFontSizeProp,e.defaultCardFormatSetting.goalFont.size.pt):e.defaultCardFormatSetting.goalFont.size.pt},e.getPropGoalBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getPropGoalItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getPropGoalUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropGoalFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalFontFamilyProp,e.defaultCardFormatSetting.goalFont.family):e.defaultCardFormatSetting.goalFont.family},e.getPropGoalFontColor=function(t,o){var r=e.defaultCardFormatSetting.goalFont.color;return t&&t.metadata?f.v.create(o).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.goalFontColorProp,r):r},e.getPropGoalText=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.goalTextProp,e.getLocalizedString("Visual_KPI_Goal_Title")):e.getLocalizedString("Visual_KPI_Goal_Title")},e.getPropDistanceLabel=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceLabelProp,e.defaultCardFormatSetting.distanceLabel):e.defaultCardFormatSetting.distanceLabel},e.getPropDistancePrecision=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distancePrecisionProp,e.defaultCardFormatSetting.distancePrecision):e.defaultCardFormatSetting.distancePrecision},e.getPropDistanceFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceFontSizeProp,this.getPropGoalFontSize(t)):e.defaultCardFormatSetting.distanceFont.size.pt},e.getPropDistanceBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getPropDistanceItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getPropDistanceUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropDistanceFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.distanceFontFamilyProp,this.getPropGoalFontFamily(t)):e.defaultCardFormatSetting.distanceFont.family},e.getPropDistanceFontColor=function(t,o){var r=this.getPropGoalFontColor(t,o);return t&&t.metadata?f.v.create(o).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.distanceFontColorProp,r):r},e.getPropDistanceDirection=function(t){var o;return t&&t.metadata?(o=this.getPropKPIDirection(t)===H.i1?M.i1:M.pd,(0,s.NA)(t.metadata.objects,i.xg.distanceDirectionTypeStringProp,o)):M.i1},e.getPropLastDateFontSize=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateFontSizeProp,e.defaultCardFormatSetting.lastDateFont.size.pt):e.defaultCardFormatSetting.lastDateFont.size.pt},e.getProplastDateBold=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateBoldProp,e.defaultCardFormatSetting.bold):e.defaultCardFormatSetting.bold},e.getProplastDateItalic=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateItalicProp,e.defaultCardFormatSetting.italic):e.defaultCardFormatSetting.italic},e.getProplastDateUnderline=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateUnderlineProp,e.defaultCardFormatSetting.underline):e.defaultCardFormatSetting.underline},e.getPropLastDateFontFamily=function(t){return t&&t.metadata?(0,s.NA)(t.metadata.objects,i.xg.lastDateFontFamilyProp,e.defaultCardFormatSetting.lastDateFont.family):e.defaultCardFormatSetting.lastDateFont.family},e.getPropLastDateFontColor=function(t,o){var r=e.defaultCardFormatSetting.lastDateFont.color;return t&&t.metadata?f.v.create(o).getColorForPropertyWithDefaultColor(t.metadata.objects,i.xg.lastDateFontColorProp,r):r},e.initDefaultLabelSettings=function(t){e.defaultCardFormatSetting=e.getDefaultFormatSettings(t),e.defaultLabelSettings=e.defaultCardFormatSetting.labelSettings},e.getFormattedValue=function(t,o,r,a,n){var d;void 0===n&&(n=st.V.WholeUnits),w.fF.assertValue(o,"theValue");var u=0===a;return(0,et.Ue)({format:null!==(d=o.formatString)&&void 0!==d?d:e.getFormatString(t),value:a,precision:r,displayUnitSystemType:n,formatSingleValues:!!u,allowFormatBeautification:!0,columnType:t?t.type:void 0}).format(o.value)},e.getFormattedLastDate=function(t,o){return(0,et.Ue)({format:e.getFormatString(t),allowFormatBeautification:!0,columnType:t?t.type:void 0}).format(o)},e.getFormattedGoalString=function(t,o,r,a,n){if(!o||0===o.length)return"";var d=e.getPropGoalText(n)+": "+e.getFormattedValue(t,o[0],r,a);return 2===o.length&&(d+=", "+e.getFormattedValue(t,o[1],r,a)),d},e.getFormattedDistanceString=function(t,o,r,a,n,d,u,m){if(!r||1!==r.length||0===r[0].value)return"";var h="+",S=o.value,p=r[0].value;switch(u){case M.i1:S<p&&(h="-");break;case M.pd:S>p&&(h="-")}var P=Math.abs(S-p),v=Math.abs(p),I=Number((100*P/v).toFixed(a)),y="",C=m.getLocalizedString("PercentFormat",h+I),D=e.getFormattedValue(t,{value:P,formatString:o.formatString},a,n);switch(d){case R.aQ:y="("+C+")";break;case R.S3:y="("+h+D+")";break;case R.Hk:y="("+h+D+" "+C+")";break;default:w.fF.assertFail("unknown kpiDistanceLabel type: ".concat(d))}return y},e.converter=function(t,o,r,a,n){var d,u,X,K,Z,m=[],h=t.categorical,S=null,p=null,P=null,v="",I="",y="",C="",A=!1,D=!1,z=!1,E=!0;t.categorical.categories||(E=!1);for(var T=h.values,Q=0,J=t.metadata.columns;Q<J.length;Q++){var j=J[Q];(0,Y.nu)(j,"Indicator")&&(D=!0,S=j),(0,Y.nu)(j,"TrendLine")&&(z=!0,P=j),(0,Y.nu)(j,"Goal")&&(A=!0,p=j)}if(e.initDefaultLabelSettings(a),!(D&&z&&T&&0!==T.length&&T[0].values&&t.categorical.values))return{dataPoints:m,directionType:r,actual:0,indicatorFont:e.defaultCardFormatSetting.labelSettings.fontProperties,indicatorIconSize:e.defaultCardFormatSetting.indicatorIconSize,indicatorIconShowIcon:e.defaultCardFormatSetting.indicatorIconShowIcon,indicatorTransparency:e.defaultCardFormatSetting.indicatorTransparency,goalFont:e.defaultCardFormatSetting.goalFont,distanceLabel:e.defaultCardFormatSetting.distanceLabel,distancePrecision:e.defaultCardFormatSetting.distancePrecision,distanceFont:e.defaultCardFormatSetting.distanceFont,distanceDirection:e.defaultCardFormatSetting.distanceDirection,lastDateFont:e.defaultCardFormatSetting.lastDateFont,goals:[],formattedGoalString:v,formattedDistanceString:I,targetExists:A,historyExists:E,indicatorExists:D,trendExists:z,formattedValue:y,lastDateValue:C,showGoal:!1,showDistanceFromGoal:!1,showTrendLine:!1,showLastDate:!1,colors:{good:f.v.getSentimentColor(a,"good",G.fA),neutral:f.v.getSentimentColor(a,"neutral",G.fA),bad:f.v.getSentimentColor(a,"bad",G.fA),graphGrey:f.v.getThemeColor(a,dt),textGrey:f.v.getThemeColor(a,at)},horizontalAlignment:e.defaultCardFormatSetting.horizontalAlignment,verticalAlignment:e.defaultCardFormatSetting.verticalAlignment};E&&(X=h.categories[0].values);for(var ft,Pt,O=[],gt=[],mt=[],pt=e.getColumnsByRole(T,"Indicator"),Lt=e.getColumnsByRole(T,"Goal"),x=0,Gt=T[0].values.length;x<Gt;x++){ft=pt[0].values[x],Pt=(0,s.NA)(null===(d=pt[0].objects)||void 0===d?void 0:d[x],$.e0.formatString);for(var vt=[],rt=0,ht=Lt;rt<ht.length;rt++){var Ft=ht[rt];vt.push({value:Ft.values[x],formatString:(0,s.NA)(null===(u=Ft.objects)||void 0===u?void 0:u[x],$.e0.formatString)})}mt.push(vt),O.push(ft),gt.push(Pt)}var Bt=Math.max.apply(Math,O),St=Math.min.apply(Math,O),Nt=1*o.height,Ct=e.getPropIndicatorPrecision(t),ot=e.getPropIndicatorDisplayUnits(t),Ot=e.getPropIndicatorFontSize(t),Kt=e.getPropIndicatorFontFamily(t),Ut=e.getPropIndicatorFontColor(t,a),Rt=+e.getPropIndicatorIconSize(t),jt=e.getPropIndicatorShowIcon(t),Wt=e.getPropIndicatorTransparency(t),Ht=e.getPropIndicatorHorizontalAlignment(t),Mt=e.getPropIndicatorVerticalAlignment(t),Qt=e.getPropIndicatorBold(t)?c.en:c.AI,wt=e.getPropIndicatorItalic(t)?c.BF:c.AI,Yt=e.getPropIndicatorUnderline(t)?c.f0:c.zu,Jt=e.getPropGoalFontSize(t),Xt=e.getPropGoalFontFamily(t),Zt=e.getPropGoalFontColor(t,a),$t=e.getPropGoalBold(t)?c.en:c.AI,qt=e.getPropGoalItalic(t)?c.BF:c.AI,kt=e.getPropGoalUnderline(t)?c.f0:c.zu,Dt=e.getPropDistanceLabel(t),It=e.getPropDistancePrecision(t),Vt=e.getPropDistanceFontSize(t),te=e.getPropDistanceFontFamily(t),ee=e.getPropDistanceFontColor(t,a),yt=e.getPropDistanceDirection(t),ae=e.getPropDistanceBold(t)?c.en:c.AI,re=e.getPropDistanceItalic(t)?c.BF:c.AI,oe=e.getPropDistanceUnderline(t)?c.f0:c.zu,ne=e.getPropLastDateFontSize(t),ie=e.getPropLastDateFontFamily(t),le=e.getPropLastDateFontColor(t,a),se=e.getProplastDateBold(t)?c.en:c.AI,ce=e.getProplastDateItalic(t)?c.BF:c.AI,de=e.getProplastDateUnderline(t)?c.f0:c.zu;for(x=0;x<O.length;x++)m.push({x:x*o.width/(O.length-1),y:o.height-Nt*(O[x]-St)/(Bt-St),actual:{value:O[x],formatString:gt[x]},goals:mt[x]});m.length>0&&(K=m[m.length-1].actual,Z=m[m.length-1].goals),1===m.length&&(E=!1),y=K&&e.getFormattedValue(S,K,Ct,ot,st.V.DataLabels),v=e.getFormattedGoalString(p,Z,Ct,ot,t),I=e.getFormattedDistanceString(S,K,Z,It,ot,Dt,yt,n),X.length>0&&(C=e.getFormattedLastDate(P,X[X.length-1]));var ge=e.getPropShowKPIGoal(t),me=e.getPropShowKPIDistance(t),pe=e.getPropShowKPITrendLine(t),fe=e.getPropShowKPILastDate(t),Pe={good:e.getPropGoodColor(t,a),neutral:e.getPropNeutralColor(t,a),bad:e.getPropBadColor(t,a),graphGrey:f.v.getThemeColor(a,dt),textGrey:f.v.getThemeColor(a,at)},ve={size:U.B.createFromPt(+Jt),family:Xt,color:Zt,weight:$t,style:qt,textDecoration:kt},he={size:U.B.createFromPt(+Vt),family:te,color:ee,weight:ae,style:re,textDecoration:oe},Fe={size:U.B.createFromPt(+Ot),family:Kt,color:Ut,weight:Qt,style:wt,textDecoration:Yt},Se={size:U.B.createFromPt(+ne),family:ie,color:le,weight:se,style:ce,textDecoration:de};return{dataPoints:m,directionType:r,actual:K?.value,goals:_.map(Z,function(Ce){return Ce.value}),formattedGoalString:v,formattedDistanceString:I,indicatorFont:Fe,targetExists:A,historyExists:E,indicatorExists:D,trendExists:z,formattedValue:y,showGoal:ge,indicatorIconSize:Rt,indicatorIconShowIcon:jt,indicatorTransparency:Wt,goalFont:ve,showDistanceFromGoal:me,distanceLabel:Dt,distancePrecision:It,distanceFont:he,distanceDirection:yt,lastDateFont:Se,showTrendLine:pe,showLastDate:fe,lastDateValue:C,colors:Pe,horizontalAlignment:Ht,verticalAlignment:Mt}},e.getColumnsByRole=function(t,o){for(var r=[],a=0,n=t;a<n.length;a++){var d=n[a];(0,Y.nu)(d.source,o)&&r.push(d)}return r},e.prototype.enumerateGoalsProperties=function(){var t=this.dataView,o=e.getPropDistanceLabel(t);return{showGoal:e.getPropShowKPIGoal(t),goalText:e.getPropGoalText(t),goalFontColor:e.getPropGoalFontColor(t,this.style),goalFontFamily:e.getPropGoalFontFamily(t),fontSize:e.getPropGoalFontSize(t),bold:e.getPropGoalBold(t),italic:e.getPropGoalItalic(t),underline:e.getPropGoalUnderline(t),showDistance:e.getPropShowKPIDistance(t),distanceLabel:e.getPropDistanceLabel(t),distanceFontColor:e.getPropDistanceFontColor(t,this.style),distanceFontFamily:e.getPropDistanceFontFamily(t),titleBold:e.getPropDistanceBold(t),titleItalic:e.getPropDistanceItalic(t),titleUnderline:e.getPropDistanceUnderline(t),titleFontSize:e.getPropDistanceFontSize(t),direction:e.getPropDistanceDirection(t),labelPrecision:o!==R.aQ?e.getPropDistancePrecision(t):void 0}},e.prototype.enumerateIndicatorProperties=function(){var t={indicatorDisplayUnits:e.getPropIndicatorDisplayUnits(this.dataView),indicatorPrecision:e.getPropIndicatorPrecision(this.dataView),fontSize:e.getPropIndicatorFontSize(this.dataView),bold:e.getPropIndicatorBold(this.dataView),italic:e.getPropIndicatorItalic(this.dataView),underline:e.getPropIndicatorUnderline(this.dataView),fontColor:e.getPropIndicatorFontColor(this.dataView,this.style),fontFamily:e.getPropIndicatorFontFamily(this.dataView),horizontalAlignment:e.getPropIndicatorHorizontalAlignment(this.dataView),verticalAlignment:e.getPropIndicatorVerticalAlignment(this.dataView)};return this.hasGoal&&delete t.fontColor,t.showIcon=e.getPropIndicatorShowIcon(this.dataView),t.showIcon&&(t.iconSize=+e.getPropIndicatorIconSize(this.dataView)),t},e.prototype.getFormattingModel=function(){var t=this,o={minValue:{type:0,value:0},maxValue:{type:1,value:it.vo}},r={minValue:{type:0,value:L.Gj},maxValue:{type:1,value:L.PR},unitSymbol:lt.tQ};return new l.Nq(function(){return t.getIndicatorCard(o)},function(){return t.getIconCard(r)},function(){return t.getTrendAxisCard()},function(){return t.getTargetLabelCard(o)},function(){return t.getDateCard()}).build()},e.prototype.getIndicatorCard=function(t){var o=this,u=(0,F._T)(i.Te.indicator,["showIcon","iconSize"]),m=new l.CQ(new l.lg("calloutValue"),"Visual_Gauge_CalloutValue",u,function(P){return o.host.getLocalizedString(P)});m.withDescription("Role_DisplayName_KPI_IndicatorDescription");var S=(new l.UN).withFontFamily({descriptor:u.fontFamily,value:e.getPropIndicatorFontFamily(this.dataView)}).withFontSizeProperties({descriptor:u.fontSize,value:e.getPropIndicatorFontSize(this.dataView)}).withBold({descriptor:u.bold,value:e.getPropIndicatorBold(this.dataView)}).withItalic({descriptor:u.italic,value:e.getPropIndicatorItalic(this.dataView)}).withUnderline({descriptor:u.underline,value:e.getPropIndicatorUnderline(this.dataView)}).build();return m.addGroup("values",function(p){p.addCompositeSlice("font","Font",S),o.hasGoal||p.addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.pi)((0,F.pi)({},u.fontColor),{instanceKind:3}),value:{value:e.getPropIndicatorFontColor(o.dataView,o.style)}}).build()),p.addSimpleSlice("horizontalAlignment",new l.Gp({descriptor:u.horizontalAlignment,value:e.getPropIndicatorHorizontalAlignment(o.dataView),mode:"horizontalAlignment"}).build()).addSimpleSlice("verticalAlignment",new l.Gp({descriptor:u.verticalAlignment,value:e.getPropIndicatorVerticalAlignment(o.dataView),mode:"verticalAlignment"}).build()).addSimpleSlice("indicatorDisplayUnits",new l.uY({descriptor:u.indicatorDisplayUnits,value:e.getPropIndicatorDisplayUnits(o.dataView)}).build()).addSimpleSlice("indicatorPrecision",new l.mu({descriptor:u.indicatorPrecision,value:e.getPropIndicatorPrecision(o.dataView),options:t}).build())}),m.build()},e.prototype.getIconCard=function(t){var o=this,a=new l.CQ(new l.lg("icons"),"Visual_Tablix_Icons",[i.Te.indicator.showIcon,i.Te.indicator.iconSize],function(d){return o.host.getLocalizedString(d)});return a.addTopLevelToggle("showIcon",function(){return new l.bd({descriptor:i.Te.indicator.showIcon,value:e.getPropIndicatorShowIcon(o.dataView)}).build()}).addGroup("icons",function(n){n.withDisplayName("Visual_Tablix_Icons"),n.addSimpleSlice("iconSize",new l.mu({descriptor:i.Te.indicator.iconSize,value:e.getPropIndicatorIconSize(o.dataView),options:t}).build())}),a.build()},e.prototype.getTrendAxisCard=function(){var t=this,o=function(u){return t.host.getLocalizedString(u)},r=(0,F.pi)((0,F.pi)({},i.Te.trendline),i.Te.status),a=this.dataView,n=new l.CQ(new l.lg("trendAxis"),"Role_DisplayName_KPI_TrendLine",r,o);return n.withDescription("Role_DisplayName_KPI_Trendline_Description").addTopLevelToggle("show",function(){return new l.bd({descriptor:r.show,value:e.getPropShowKPITrendLine(a)}).build()}).addGroup("trendAxis",function(d){d.addSimpleSlice("direction",new l.uY({descriptor:r.direction,value:e.getPropKPIDirection(a)}).build()).addSimpleSlice("goodColor",new l.BT({descriptor:(0,F.pi)((0,F.pi)({},r.goodColor),{instanceKind:3}),value:{value:e.getPropGoodColor(a,t.style)}}).build()).addSimpleSlice("neutralColor",new l.BT({descriptor:(0,F.pi)((0,F.pi)({},r.neutralColor),{instanceKind:3}),value:{value:e.getPropNeutralColor(a,t.style)}}).build()).addSimpleSlice("badColor",new l.BT({descriptor:(0,F.pi)((0,F.pi)({},r.badColor),{instanceKind:3}),value:{value:e.getPropBadColor(a,t.style)}}).build()).addSimpleSlice("transparency",l.JN.getTransparencySliderBuilder({descriptor:r.transparency,value:e.getPropIndicatorTransparency(a),localize:o}).build())}),n.build()},e.prototype.getTargetLabelCard=function(t){var o=this,a=i.Te.goals,n=this.dataView,d=new l.CQ(new l.lg("targetLabel"),"Visual_Gauge_Axis_TargetLabel",a,function(P){return o.host.getLocalizedString(P)}),u=(new l.UN).withFontFamily({descriptor:a.goalFontFamily,value:e.getPropGoalFontFamily(n)}).withFontSizeProperties({descriptor:a.fontSize,value:e.getPropGoalFontSize(n)}).withBold({descriptor:a.bold,value:e.getPropGoalBold(n)}).withItalic({descriptor:a.italic,value:e.getPropGoalItalic(n)}).withUnderline({descriptor:a.underline,value:e.getPropGoalUnderline(n)}),m=(new l.UN).withFontFamily({descriptor:a.distanceFontFamily,value:e.getPropDistanceFontFamily(n)}).withFontSizeProperties({descriptor:a.titleFontSize,value:e.getPropDistanceFontSize(n)}).withBold({descriptor:a.titleBold,value:e.getPropDistanceBold(n)}).withItalic({descriptor:a.titleItalic,value:e.getPropDistanceItalic(n)}).withUnderline({descriptor:a.titleUnderline,value:e.getPropDistanceUnderline(n)}),h=u.build(),S=m.build();return d.addTopLevelToggle("showGoal",function(){return new l.bd({descriptor:a.showGoal,value:e.getPropShowKPIGoal(n)}).build()}).addGroup("values",function(p){p.withDisplayName("Role_DisplayName_Values").addCompositeSlice("font","Font",h).addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.pi)((0,F.pi)({},a.goalFontColor),{instanceKind:3}),value:{value:e.getPropGoalFontColor(n,o.style)}}).build()).addSimpleSlice("goalText",new l.fq({descriptor:a.goalText,value:e.getPropGoalText(n),placeholder:""}).build())}).addGroup("distance",function(p){p.withDisplayName("Visual_KPI_DistanceToGoal").addTopLevelToggle("showDistance",function(){return new l.bd({descriptor:a.showDistance,value:e.getPropShowKPIDistance(n)}).build()});var P=e.getPropDistanceLabel(n);p.addSimpleSlice("style",new l.uY({descriptor:a.distanceLabel,value:P}).build(),function(v){return v.withCustomDisplayName("Style")}),P!==R.aQ&&p.addSimpleSlice("labelPrecision",new l.mu({descriptor:a.labelPrecision,value:e.getPropDistancePrecision(n),options:t}).build()),p.addSimpleSlice("direction",new l.uY({descriptor:a.direction,value:e.getPropDistanceDirection(n)}).build()).addCompositeSlice("font","Font",S).addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.pi)((0,F.pi)({},a.distanceFontColor),{instanceKind:3}),value:{value:e.getPropDistanceFontColor(n,o.style)}}).build())}),d.build()},e.prototype.getDateCard=function(){var t=this,r=i.Te.lastDate,a=this.dataView,n=new l.CQ(new l.lg("date"),"Date",r,function(h){return t.host.getLocalizedString(h)}),u=(new l.UN).withFontFamily({descriptor:r.lastDateFontFamily,value:e.getPropLastDateFontFamily(a)}).withFontSizeProperties({descriptor:r.fontSize,value:e.getPropLastDateFontSize(a)}).withBold({descriptor:r.bold,value:e.getProplastDateBold(a)}).withItalic({descriptor:r.italic,value:e.getProplastDateItalic(a)}).withUnderline({descriptor:r.underline,value:e.getProplastDateUnderline(a)}).build();return n.withDescription("Role_DisplayName_KPI_Date_Description").addTopLevelToggle("show",function(){return new l.bd({descriptor:r.show,value:e.getPropShowKPILastDate(a)}).build()}).addGroup("date",function(m){m.addCompositeSlice("font","Font",u).addSimpleSlice("fontColor",new l.BT({descriptor:(0,F.pi)((0,F.pi)({},r.lastDateFontColor),{instanceKind:3}),value:{value:e.getPropLastDateFontColor(a,t.style)}}).build())}),n.build()},e.prototype.enumerateObjectInstances=function(t){var o=[],r=this.dataView,a={numberRange:{min:0,max:it.vo}},n={numberRange:{min:L.Gj,max:L.PR},unitSymbol:lt.tQ};switch(t.objectName){case"indicator":o.push({selector:null,objectName:"indicator",properties:this.enumerateIndicatorProperties(),validValues:{indicatorPrecision:a,iconSize:n},propertyInstanceKind:{fontColor:3}});break;case"trendline":o.push({selector:null,objectName:"trendline",properties:{show:e.getPropShowKPITrendLine(r),transparency:e.getPropIndicatorTransparency(r)}});break;case"goals":o.push({selector:null,objectName:"goals",properties:this.enumerateGoalsProperties(),validValues:{labelPrecision:a},propertyInstanceKind:{goalFontColor:3,distanceFontColor:3}});break;case"status":o.push({selector:null,objectName:"status",properties:{direction:e.getPropKPIDirection(r),goodColor:e.getPropGoodColor(r,this.style),neutralColor:e.getPropNeutralColor(r,this.style),badColor:e.getPropBadColor(r,this.style)},propertyInstanceKind:{goodColor:3,neutralColor:3,badColor:3}});break;case"lastDate":o.push({selector:null,objectName:"lastDate",properties:{show:e.getPropShowKPILastDate(r),lastDateFontColor:e.getPropLastDateFontColor(r,this.style),lastDateFontFamily:e.getPropLastDateFontFamily(r),fontSize:e.getPropLastDateFontSize(r),bold:e.getProplastDateBold(r),italic:e.getProplastDateItalic(r),underline:e.getProplastDateUnderline(r)},propertyInstanceKind:{lastDateFontColor:3}})}return o},e.prototype.destroy=function(){this.svg=null},e.status={INCREASE:"increase",DROP:"drop",IN_BETWEEN:"in-between",NOGOAL:"no-goal"},e.statusBandingType={Below:"BELOW",Above:"ABOVE"},e.actualTextConsts={VERTICAL_OFFSET_FROM_HALF_HEIGHT:20,FONT_WIDTH_FACTOR:14,RIGHT_MARGIN:10},e.indicatorIconContent=[{class:"checkmark",textId:"Visual_KPI_TargetMet",hexCode:"\ue718",status:e.status.INCREASE},{class:"circle-small",textId:"Visual_KPI_TargetBetween",hexCode:"\ue712",status:e.status.IN_BETWEEN},{class:"exclamation",textId:"Visual_KPI_TargetNotMet",hexCode:"\ue715",status:e.status.DROP}],e}()}}]);