"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["field-well-view-model"],{55201:function(Y,b,l){function I(T,C){if(!T&&!C)return!0;if(!!T!=!!C||T.length!==C.length)return!1;for(var D=0,L=T.length;D<L;D++)if(!T[D].equals(C[D]))return!1;return!0}l.d(b,{L:function(){return I}})},89839:function(Y,b,l){l.d(b,{l:function(){return L}});var I=l(62458),T=l(76001),C=l(80366),D=l(94419);function L(i,p){var E=(0,C._L)((0,T.Q)(i.expr)),c=void 0!==E,t=i.interactivityOptions.dropDownItems;if(t)for(var M=0,O=t.items;M<O.length;M++){var P=O[M],B=P.key;if(B)switch(B.action){case 4:P.checked=c&&B.aggregate===E;break;case 2:P.checked=!c;break;case 8:var k=p.config.singleVisual.query.projections[i.role];P.checked=!(!k||!k.showAll);break;case 128:P.checked=j(i,P.text);break;case 16:for(var R=0,U=P.children;R<U.length;R++){var z=U[R];z.checked=q(i,z.key.showValueAs)}break;case 2048:P.checked=!1;break;default:P.checked=void 0}}}function j(i,p){var E=function(i){if(!_.isEmpty(i.hierarchyLevels)){var E=i.hierarchyLevels[0].expr;return I.fF.assert(function(){return E.arg instanceof D.jE},"hierarchyLevelExpr.arg should be instanceof powerbi.data.SQHierarchyExpr"),E.arg}}(i);if(E)return E.hierarchy===p;var c=(0,T.Q)(i.expr);return!!c&&(c.columnAggr?c.columnAggr.name===p:c.groupingColumnAggr?c.groupingColumnAggr.name===p:c.column?c.column.name===p:!!c.groupingColumn&&c.groupingColumn.name===p)}function q(i,p){var E=(0,T.Q)(i.expr);if(!E||!p)return!1;switch(p.kind){case void 0:return!E.percentOfGrandTotal&&!E.percentOfRoleTotal;case 0:return!!E.percentOfGrandTotal;case 1:var c=p;return!(!E.percentOfRoleTotal||!_.every(E.percentOfRoleTotal.roles,function(t){return _.includes(c.roles,t)}));default:return!1}}},42611:function(Y,b,l){l.r(b),l.d(b,{FieldWellViewModelModule:function(){return Ee}});var I=l(84431),T=l(42614),C=l(60661),D=l(62458),L=l(74082),j=l(45334),Q=l(18503),q=l(6911),i=l(42649),p=l(50423),E=l(28199),c=l(9380),t=l(66977),M=l(8082),O=l(88409),P=l(65181),R=function(){function o(e,r,n,a,d,s){this.aggrOps=e,this.featureSwitchService=r,this.pluginOps=n,this.visualCalcEagerService=a,this.localizationService=d,this.runningVisualService=s}return o.prototype.createProperty=function(e,r){var n=this.computeValidity(e),a=e.visual&&(0,C.cj)(e.visual,r),d=this.createChildFieldWellProperties(e,a),s=e.group.isFieldParameter,v=this.computeSupportedOperations(e,a),u=this.computeDisplayName(e,a),h=this.computePbiStyle(e);return new I._d(e.group.expr,e.roleName,e.group.selectQueryIndex,e.group.selectQueryIndex+(e.group.children?e.group.children.length-1:0),n.valid,new I.DR(u,this.getTooltipTitleForFieldWellProperty(e.group.expr,e.schema,n,a,e.displayNameService),this.getTooltipDescriptionForFieldWellProperty(e.group.expr,e.schema,n,e.displayNameService),this.getGlyphForFieldWellProperty(e.group.expr,n),h),new I.Ct(null,!1,_.isEmpty(d)&&!s),d,e.objectRepetitions,e.visualContainerName,e.visualType,e.isHiddenInVisual,v)},o.prototype.createChildFieldWellProperties=function(e,r){var n=[];if(e.group.children)for(var a=0,d=e.group.children.length;a<d;a++){var s=j.m.validate(e.group.children[a],e.schema,this.aggrOps),v={valid:_.isEmpty(s),errorsText:this.localizationService.get("Invalid_FieldWellProperty_Tooltip")},u=e.group.children[a],h=this.getTooltipTitleForFieldWellHierarchyLevel(u,e.schema,v,r,e.displayNameService);n.push(new I.aT(u,e.displayNameService.getDisplayName(u,e.schema,r),h))}return n},o.prototype.getTooltipTitleForFieldWellProperty=function(e,r,n,a,d){var v=n.errorsText;return n.valid?d.getQualifiedDisplayName(e,r,a,{includeDefaultAggregate:!0}):v},o.prototype.getTooltipTitleForFieldWellHierarchyLevel=function(e,r,n,a,d){var v=n.errorsText;return n.valid?d.getQualifiedDisplayName(e,r,a,{includeDefaultAggregate:!0,includeVariationSource:!0,includeHierarchyName:!0}):v},o.prototype.getTooltipDescriptionForFieldWellProperty=function(e,r,n,a){if(n.valid)return a.getDescription(e,r)},o.prototype.getGlyphForFieldWellProperty=function(e,r){if(r.valid&&(0,L.tO)(e))return"pbi-glyph-trending"},o.prototype.computeSupportedOperations=function(e,r){var a;if(e.group.isFieldParameter)a=50294779;else{var d=e.schema,s=void 0;(0,L.iV)(e.group.expr)&&(s=e.group.expr.arg.getTargetColumnRef(d)),s||(s=e.group.expr),a=j.m.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,d,s,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!T.l.supportsFilterOutput(r),this.pluginOps.isAnalysisVisual(e.visualType))?58720255:41943039}return a},o.prototype.computeDisplayName=function(e,r){var n=e.useNativeReferenceNames,a=e.displayNameService,d=e.queryName,s=e.visual&&e.visual.config.singleVisual;if(D.fF.assert(function(){return!!s},"single visual should be defined at this point when computing the display name"),n){var v=s?.query;if(!v)return void D.fF.assertFail("query should be defined at this point when computing the display name");var u=v.defn.select().withName(d);return D.fF.assert(function(){return!!u.nativeReferenceName},"Native Reference Name should be defined when computing the display name"),u.nativeReferenceName}return a.getDisplayName(e.group.expr,e.schema,r,d,s?.columnProperties)},o.prototype.computePbiStyle=function(e){var r,n,a=null===(r=this.visualCalcEagerService.getCurrentEditingContext())||void 0===r?void 0:r.queryName;if(a&&e.queryName===a&&16===(null===(n=e.visual)||void 0===n?void 0:n.visibility))return{"font-style":"italic"}},o.prototype.computeValidity=function(e){var r,n=j.m.validate(e.group.expr,e.schema,this.aggrOps),a=_.isEmpty(n);if(!a)return{valid:!1,errorsText:this.localizationService.get("Invalid_FieldWellProperty_Tooltip")};if(e.group.children)for(var d=0,s=e.group.children.length;a&&d<s;d++){var v=j.m.validate(e.group.children[d],e.schema,this.aggrOps);if(!(a=a&&_.isEmpty(v)))return{valid:!1,errorsText:this.localizationService.get("Invalid_FieldWellProperty_Tooltip")}}var u=this.runningVisualService.getVisual(e.visual),h=u?.getErrorInfo();if(_.isEmpty(h)||_.isEmpty(h?.additionalErrorMessages))return{valid:!0};for(var y=0,S=h.additionalErrorMessages;y<S.length;y++){var x=S[y],f=x.AffectedItems,g=x.Code;switch(g){case i.dd.NativeVisualCalculationError:case i.dd.NativeVisualCalculationUnexpectedEndOfUserInput:case i.dd.InvalidExtensionDax_UnclosedBracketIdentifier:case i.dd.InvalidExtensionDax_UnexpectedCloseParenthesis:case i.dd.QueryExtensionMeasureUnexpectedEndOfUserInput:case i.dd.QueryExtensionMeasureError:case i.dd.ExtensionMeasureEmptyExpression:case i.dd.ExtensionMeasureNameNotUniqueModel:case i.dd.ExtensionMeasureNameNotUnique:case i.dd.InvalidExtensionDax_UnclosedMultiLineComment:case i.dd.InvalidExtensionDax_UnclosedParenthesis:case i.dd.InvalidExtensionDax_UnclosedQuoteIdentifier:case i.dd.InvalidExtensionDax_UnclosedStringLiteral:for(var m=0,A=f;m<A.length;m++){var N=A[m],w={};if(q.O(N,w)){var H=w.propertyName,W=e.group.expr.getConceptualProperty(e.schema);if(W?.measure&&W?.name===H)return{valid:!1,errorsText:(0,Q.UX)(h.details,"").message}}var G=e.visual.config.singleVisual.query,X=null===(r=G?.defn.select().withName(e.queryName))||void 0===r?void 0:r.nativeReferenceName;if(!_.isEmpty(X)&&N===X)return{valid:!1,errorsText:(0,Q.UX)(h.details,"").message}}case i.dd.ComplexSlicerNotAllowedWithMeasures:case i.dd.ComplexHighlightsNotAllowed:case i.dd.ExclusivePercentileOutOfRange:case i.dd.InvalidDataShapeNoOutputData:case i.dd.InvalidFilterComparisonIncompatibleExpressions:case i.dd.InvalidFilterConditionIncompatibleDataType:case i.dd.InvalidUnconstrainedJoin:case i.dd.ModelUnavailable:case i.dd.OverlappingKeysOnOppositeHierarchies:case i.dd.rsQueryMemoryLimitExceeded:case i.dd.rsQueryTimeoutExceeded:case i.dd.CouldNotResolveModelReferencesInSemanticQuery:case i.dd.rsAccessDenied:case i.dd.NoUniqueKeyForDetailTable:case i.dd.IsRelatedToManyNotSupportedForDetailTable:case i.dd.ModelMeasuresNotSupportedForDetailTable:case i.dd.UnsupportedDateTimeLiteral:case i.dd.CouldNotResolveModelReferencesInQueryExtensionSchema:case i.dd.UnsupportedDataSourceVariables:case i.dd.DataExtensionMissingResultSet:case i.dd.ProxyModelChainLimitExceeded:case i.dd.AA_PowerBIScriptPayloadTooLargeError:case i.dd.AA_PowerBIScriptResultTooLargeError:case i.dd.AA_PowerBIScriptReturnedNoImageError:case i.dd.AA_PowerBIScriptRuntimeErrorError:case i.dd.AA_PowerBIScriptTimeoutError:case i.dd.AA_PowerBIRequestsQueueOverflowError:case i.dd.AA_PowerBIScriptRuntimeMaxMemoryError:case i.dd.AA_PowerBIScriptRuntimeMaxDiskIOError:case i.dd.AA_PowerBIScriptMissingDependencyError:case i.dd.AA_PowerBIScriptSpecificPackageWithMissingDependencyError:case i.dd.AA_PowerBIScriptSpecificPackageMissingSpecificDependencyError:case i.dd.AA_PowerBIScriptMissingSpecificPackageError:case i.dd.FabricThrottled:case i.dd.CannotUseMultiColumnFilteringWithMappedColumns:case i.dd.DifferentMappingsWithinSubqueries:case i.dd.FilterIncompatibleWithParameter:case i.dd.FoundMultipleTargetsWithAtLeastOneMapping:case i.dd.FoundParameterMappingOnUnsupportedFilter:case i.dd.InTableConditionNotSupportedWithMappedParameters:case i.dd.InvalidMappedParameterValueExpression:case i.dd.MappedTargetMustMatchMappedCondition:case i.dd.MixOfAssignedAndUnassignedColumnsWithinORExpression:case i.dd.MultipleParameterAssignmentsWithinORUnsupported:case i.dd.MultipleParameterMappingsUnsupported:case i.dd.ParameterMappingFilterConflict:case i.dd.ParameterMappingsFoundWithinFilteredEvalExpressionFilter:case i.dd.ParameterMappingsNotSupportedOnHighlights:case i.dd.SingleValueParameterWithMultipleValues:continue;default:D.fF.assertNever(g);continue}}return{valid:!0}},o.\u0275fac=function(r){return new(r||o)(p.\u0275\u0275inject(E.C),p.\u0275\u0275inject(c.vZ),p.\u0275\u0275inject(t.f),p.\u0275\u0275inject(O.w),p.\u0275\u0275inject(P.o),p.\u0275\u0275inject(M.s))},o.\u0275prov=p.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),U=l(81337),z=l(89839),ee=l(14463),ie=l(15580),te=l(44257),re=l(67290),le=l(20590),ue=l(40812),ve=l(50550),ae=l(46135),fe=l(96653),he=l(77435),ye=l(48145),oe=function(){function o(e,r,n,a,d,s,v,u){this.aggrOps=e,this.featureSwitch=r,this.geoTagging=n,this.localizationService=a,this.promiseFactory=d,this.fieldWellPropertyViewModelFactory=s,this.visualCalcEagerService=v,this.explorationCapabilitiesService=u}return o.prototype.createBuckets=function(e,r,n,a,d,s,v,u,h,F,y,S){var x=this;void 0===y&&(y=!1),void 0===S&&(S=!1);var f=this.promiseFactory.defer(),g=(0,C.d$)(r,s);return _.isEmpty(g)?f.resolve([]):(null!=g[0].displayOrder&&(D.fF.assert(function(){return g.every(function(m){return null!=m.displayOrder})},"Not all data roles have `displayOrder`"),g=_.sortBy(g,function(m){return m.displayOrder})),(0,ie.y5)(e,this.promiseFactory).then(function(m){return x.createBucketsCore(r,n,g,m,f,a,d,s,v,u,h,F,y)},function(m){return x.createBucketsCore(r,n,g,[],f,a,d,s,v,u,h,F,y)}).then(function(m){if((0,C.II)(r)&&!S){var A=[new I.OB(void 0,x.localizationService.get("Data"),_.flatten(_.map(m,function(N){return N.properties.forEach(function(w){return w.isInsideAutoVisualBucket=!0}),N.properties})),!0)];f.resolve(A)}else f.resolve(m)})),f},o.prototype.createEmptyBuckets=function(e,r){if(!e)return[];for(var n=[],a=0,d=e;a<d.length;a++){var s=d[a];this.shouldCreateBucketForRole(s)&&this.shouldCreateBucketForRoleFromExtensions(s,r)&&n.push(new I.OB(s.name,s.displayName?(0,le.Gf)(s.displayName,this.localizationService):s.name,[],!1,(0,le.Gf)(s.description,this.localizationService)))}return n},o.prototype.createBucketsCore=function(e,r,n,a,d,s,v,u,h,F,y,S,x){return(0,U.__awaiter)(this,void 0,void 0,function(){var f,g,m,A,N,w;return(0,U.__generator)(this,function(W){switch(W.label){case 0:if(f=this.createEmptyBuckets(n,F),a=a||[],!_.isEmpty(F))for(g=0,m=f;g<m.length;g++)for(A=m[g],N=0,w=F;N<w.length;N++)w[N].onBucketCreated(A,e,r,s,v,u,this.localizationService);return[4,this.populateBuckets(f,e,a,r,n,s,v,u,h,y,S,x)];case 1:return W.sent(),[2,f]}})})},o.prototype.shouldCreateBucketForRole=function(e){D.fF.assertValue(e,"dataRole");var r=e.kind;return r===ae.DW.Measure||r===ae.DW.Grouping||r===ae.DW.GroupingOrMeasure},o.prototype.shouldCreateBucketForRoleFromExtensions=function(e,r){if(!_.isEmpty(r))for(var n=0,a=r;n<a.length;n++)if(!a[n].shouldCreateBucketForRole(e))return!1;return!0},o.prototype.populateBuckets=function(e,r,n,a,d,s,v,u,h,F,y,S){var x;return(0,U.__awaiter)(this,void 0,void 0,function(){var f,g,m,A,N,w,H,W,G,X,K,J,ne;return(0,U.__generator)(this,function(Me){if(!(f=r.config.singleVisual.query)||!f.defn)return[2];for(w in g=f.projections,m=this.getRoleNamesToBuckets(e),A=u.capabilities(r.config.singleVisual.visualType),N=(0,ue.sd)(n,A.objects),g)if(H=m[w])for(W=this.featureSwitch.featureSwitches&&this.featureSwitch.featureSwitches.fieldParameters?f.tryGetFieldExprs(w):f.tryGetExprs(w),G=(0,fe.q)(a,W,{disableHierarchyLevelGrouping:F,useNativeReferenceNames:y}),X=function(se){var Z=r.config.singleVisual.query.defn.selectNameOf(se.expr),ce=[],Fe=K.featureSwitch.featureSwitches&&K.featureSwitch.featureSwitches.fieldParameters?null===(x=_.find(W,function(V){return V.queryName===Z}))||void 0===x?void 0:x.isHidden:void 0,xe=K.featureSwitch.featureSwitches&&K.featureSwitch.featureSwitches.conditionalTablixWebURL;!_.isEmpty(N)&&!_.isEmpty(Z)&&!se.children&&(ce=_.filter(N,function(V){var pe=V&&V.propertyDescriptor&&V.propertyDescriptor.type.misc,$=V&&V.propertyDescriptor&&V.propertyDescriptor.type;return V&&V.selector&&V.selector.metadata===Z&&V.propertyDescriptor&&$&&($.fill||$.dataBars||$.icon||pe&&pe.webUrl&&xe)})),H.properties.push(K.fieldWellPropertyViewModelFactory.createProperty({group:se,schema:a,displayNameService:h,roleName:w,visual:r,objectRepetitions:ce,queryName:Z,visualContainerName:r.name,visualType:r.config.singleVisual.visualType,useNativeReferenceNames:y,isHiddenInVisual:Fe},u))},K=this,J=0,ne=G;J<ne.length;J++)X(ne[J]);return this.updateBucketCardinality(e,r,u,S),this.createDropDownItems(e,r,a,d,s,v),[2]})})},o.prototype.createDropDownItems=function(e,r,n,a,d,s){for(var v=(0,C.II)(r),u=0,h=e;u<h.length;u++)for(var F=h[u],y=0,S=F.properties;y<S.length;y++){var x=S[y],f=x.interactivityOptions;f.hasContextMenu&&(f.dropDownItems=(0,re.op)(x,F,e,(0,ve.rC)(a,F.role),v,n,this.aggrOps,r.config.singleVisual,this.featureSwitch,d,s,this.localizationService,r,this.visualCalcEagerService,this.explorationCapabilitiesService),(0,z.l)(x,r))}},o.prototype.updateBucketCardinality=function(e,r,n,a){for(var d=n.capabilities(r.config.singleVisual.visualType),s=(0,C.Xf)(r),v=(0,te.WO)(d,!!s?.isDrillDisabled),u=(0,C.ps)(r,n,this.geoTagging),h=0,F=e;h<F.length;h++){var y=F[h],S=u&&u[y.role];y.supportsMultipleItems=_.includes(v,y.role)||!S||null==S.max||S.max>1||16===r.visibility;for(var x=!y.supportsMultipleItems,f=0,g=y.properties;f<g.length;f++){var m=g[f];m.interactivityOptions.isReplaceable=x||!!a,m.interactivityOptions.isReplaceOnly=x}}},o.prototype.getRoleNamesToBuckets=function(e){for(var r={},n=0,a=e;n<a.length;n++){var d=a[n];r[d.role]=d}return r},o.\u0275fac=function(r){return new(r||o)(p.\u0275\u0275inject(E.C),p.\u0275\u0275inject(c.vZ),p.\u0275\u0275inject(he.q),p.\u0275\u0275inject(P.o),p.\u0275\u0275inject(ee.t),p.\u0275\u0275inject(R),p.\u0275\u0275inject(O.w),p.\u0275\u0275inject(ye.U))},o.\u0275prov=p.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac}),o}(),me={provide:"fieldWellViewModelService",useFactory:function(o){return Promise.resolve(o)},deps:[oe]},Ee=function(){function o(){}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=p.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=p.\u0275\u0275defineInjector({providers:[oe,R,{provide:"fieldWellPropertyViewModelService",useExisting:R},me]}),o}()},84431:function(Y,b,l){l.d(b,{Ct:function(){return Q},DR:function(){return j},KT:function(){return E},OB:function(){return i},_d:function(){return L},aT:function(){return q},kh:function(){return p}});var I=l(55201),T=l(40812),C=l(50550),D=l(45413),L=function(){function c(t,M,O,P,B,k,R,U,z,ee,ie,te,re){this.expr=t,this.role=M,this.startIndex=O,this.endIndex=P,this.valid=B,this.displayOptions=k,this.interactivityOptions=R,this.hierarchyLevels=U,this.conditionalFormattingRepetitions=z,this.supportedOperations=67108863,this.visualContainerName=ee,this.visualType=ie,this.isHiddenInVisual=te,this.supportedOperations=re}return c.prototype.equals=function(t){return this.role===t.role&&(0,D.fS)(this.expr,t.expr)&&this.startIndex===t.startIndex&&this.endIndex===t.endIndex&&this.isEditingLabel===t.isEditingLabel&&this.valid===t.valid&&(this.displayOptions===t.displayOptions||!!(this.displayOptions&&t.displayOptions&&this.displayOptions.equals&&this.displayOptions.equals(t.displayOptions)))&&(this.interactivityOptions===t.interactivityOptions||!!(this.interactivityOptions&&t.interactivityOptions&&this.interactivityOptions.equals&&this.interactivityOptions.equals(t.interactivityOptions)))&&(0,C.NF)(this.conditionalFormattingRepetitions,t.conditionalFormattingRepetitions,T.u9)&&(0,I.L)(this.hierarchyLevels,t.hierarchyLevels)&&this.visualContainerName===t.visualContainerName&&this.visualType===t.visualType&&this.isHiddenInVisual===t.isHiddenInVisual&&this.supportedOperations===t.supportedOperations},c}(),j=function(){function c(t,M,O,P,B){this.displayName=t,this.tooltipTitle=M,this.tooltipDescription=O,this.glyph=P,this.pbiStyle=B}return c.prototype.equals=function(t){return this.displayName===t.displayName&&this.tooltipTitle===t.tooltipTitle&&this.tooltipDescription===t.tooltipDescription&&this.glyph===t.glyph&&this.pbiStyle===t.pbiStyle},c}(),Q=function(){function c(t,M,O){this.dropDownItems=t,this.isReplaceable=M,this.isEditableField=O,this.canAppend=!0,this.canPrepend=!0,this.hasContextMenu=!0,this.isDraggableField=!0,this.isDroppableField=!0,this.isRemovableField=!0}return c.prototype.disableInteractivity=function(){this.canAppend=!1,this.canPrepend=!1,this.hasContextMenu=!1,this.isDraggableField=!1,this.isDroppableField=!1,this.isEditableField=!1,this.isRemovableField=!1},c.prototype.equals=function(t){return this.canAppend===t.canAppend&&this.canPrepend===t.canPrepend&&_.isEqual(this.dropDownItems,t.dropDownItems)&&this.hasContextMenu===t.hasContextMenu&&this.isDraggableField===t.isDraggableField&&this.isDroppableField===t.isDroppableField&&this.isEditableField===t.isEditableField&&this.isRemovableField===t.isRemovableField&&this.isReplaceable===t.isReplaceable},c}(),q=function(){function c(t,M,O){this.expr=t,this.displayName=M,this.tooltipTitle=O}return c.prototype.equals=function(t){return(0,D.fS)(this.expr,t.expr)&&this.displayName===t.displayName&&this.tooltipTitle===t.tooltipTitle},c}(),i=function(){function c(t,M,O,P,B){this.role=t,this.displayName=M,this.properties=O,this.supportsMultipleItems=P,this.description=B}return c.prototype.equals=function(t){return this.role===t.role&&this.displayName===t.displayName&&(0,I.L)(this.properties,t.properties)&&this.supportsMultipleItems===t.supportsMultipleItems&&this.description===t.description&&(this.warning===t.warning||!!(this.warning&&t.warning&&this.warning.equals&&this.warning.equals(t.warning)))&&this.disabled===t.disabled},c}(),p=function(){function c(t,M,O){this.glyph=t,this.title=M,this.description=O}return c.prototype.equals=function(t){return this.glyph===t.glyph&&this.title===t.title&&this.description===t.description},c}(),E=function(){return function(t){this.buckets=t}}()}}]);