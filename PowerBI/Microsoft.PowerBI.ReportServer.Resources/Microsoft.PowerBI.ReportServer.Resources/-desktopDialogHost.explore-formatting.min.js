(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["explore-formatting"],{84631:function(st,Le,C){"use strict";C.d(Le,{CZ:function(){return H},IA:function(){return qe},MM:function(){return Ce},QZ:function(){return pe},XB:function(){return ze},_1:function(){return Te},vX:function(){return K},xK:function(){return Z},yY:function(){return we},zB:function(){return re}});var x=C(52083),p=C(62458),b=C(94419),S=C(4829);function K(ie){return{solid:{color:Z(ie,(0,x.d9)())}}}function Z(ie,j){p.fF.assertValue(j,"gradientSettings");var te,ge,ye,k={color:(0,b.$_)(j.minColor,"minColor")},de=j.minValue;if(null!=de&&(te=(0,b.tx)(de)),j.diverging){ge={color:(0,b.$_)(j.midColor,"midColor")};var he=j.midValue;null!=he&&(ye=(0,b.tx)(he))}var mt,pt={color:(0,b.$_)(j.maxColor,"maxColor")},wt=j.maxValue;null!=wt&&(mt=(0,b.tx)(wt));var tt,Ge=j.nullStrategy,Q=j.nullColor,Ze={};return tt=j.diverging?Ze.linearGradient3={min:k,mid:ge,max:pt}:Ze.linearGradient2={min:k,max:pt},te&&(tt.min.value=te),ye&&(tt.mid.value=ye),mt&&(tt.max.value=mt),Ge&&(tt.nullColoringStrategy={strategy:(0,b.fL)(Ge)},Ge===S.Sx&&(tt.nullColoringStrategy.color=(0,b.$_)(Q,"nullColor"))),(0,b.x5)(ie,Ze)}function we(ie,j,k){var te;switch(k){case"number":te={condition:(0,b.qu)(3,ie,(0,b.tx)(0)),value:(0,b.fL)(j)};break;case"text":te={condition:(0,b.qu)(0,ie,(0,b.fL)("")),value:(0,b.fL)(j)};break;default:p.fF.assertNever(k)}return{solid:{color:(0,b.u7)([te])}}}var re="CircleHigh",qe="Before",pe="Top";function ze(ie,j){switch(void 0===j&&(j="number"),j){case"number":return{kind:"Icon",value:(0,b.u7)([H(ie,67,100,!0,(0,b.fL)("CircleHigh")),H(ie,33,67,!1,(0,b.fL)("SignMedium")),H(ie,0,33,!1,(0,b.fL)("SignLow"))]),layout:(0,b.fL)(qe),verticalAlignment:(0,b.fL)(pe)};case"text":return{kind:"Icon",value:(0,b.u7)([Te(ie,(0,b.fL)("CircleHigh")),Te(ie,(0,b.fL)("SignMedium")),Te(ie,(0,b.fL)("SignLow"))]),layout:(0,b.fL)(qe),verticalAlignment:(0,b.fL)(pe)};default:p.fF.assertNever(j)}}function H(ie,j,k,te,de){var ge,ye;return j>0&&(ge=(0,b.qu)(2,ie,b.LE.overRangeOf(ie,j/100))),k<100&&(ye=(0,b.qu)(te?4:3,ie,b.LE.overRangeOf(ie,k/100))),{condition:ge&&ye?(0,b.xD)(ge,ye):ge||ye,value:de}}function Te(ie,j){return{condition:(0,b.qu)(0,ie,(0,b.fL)("")),value:j}}function Ce(ie,j,k,te,de){var ge,ye;return null!==j&&(ge=(0,b.qu)(2,ie,(0,b.tx)(j))),null!==k&&(ye=(0,b.qu)(te?4:3,ie,(0,b.tx)(k))),{condition:ge&&ye?(0,b.xD)(ge,ye):ge||ye,value:de}}},26902:function(st,Le,C){"use strict";C.d(Le,{L6:function(){return qe},aI:function(){return re},ac:function(){return H},dw:function(){return Ce},uz:function(){return ze}});var x=C(40812),p=C(64067),b=C(62458),S=C(94419),K=C(59897),Z=C(80777),we={totalMatchingOption:1,reverseDirection:!1,hideText:!1};function re(j,k){return b.fF.assertValue(j,"visual"),b.fF.assertValue(k,"repetition"),qe(Te(j.objects,k))}function qe(j){if(!j)return we;var k,te=j.minValue;te&&(k=te.value);var de,ge=j.maxValue;ge&&(de=ge.value);var ye=1,he=j.totalMatchingOption;return he&&(ye=he.value),{minValue:k,maxValue:de,positiveColor:pe(j.positiveColor),negativeColor:pe(j.negativeColor),axisColor:pe(j.axisColor),reverseDirection:j.reverseDirection.value,hideText:j.hideText.value,totalMatchingOption:ye}}function pe(j){var k=j.solid.color;return(0,p.A7)(k.value)?{solid:{color:k.value}}:null}function ze(){return H(we,Z.Ge.fromPrimitiveTypeAndCategory(12))}function H(j,k){var te,de,ge;return b.fF.assertValue(j,"dataBars"),b.fF.assertValue(k,"valueType"),void 0!==j.minValue&&(te=ie(j.minValue,k)),void 0!==j.maxValue&&(de=ie(j.maxValue,k)),void 0!==j.totalMatchingOption&&(ge=(0,S.cA)(j.totalMatchingOption)),{minValue:te,maxValue:de,positiveColor:(0,K.EV)(j.positiveColor&&j.positiveColor.solid.color,"maxColor"),negativeColor:(0,K.EV)(j.negativeColor&&j.negativeColor.solid.color,"minColor"),axisColor:(0,K.EV)(j.axisColor&&j.axisColor.solid.color,"foreground"),reverseDirection:(0,S.O7)(j.reverseDirection),hideText:(0,S.O7)(j.hideText),totalMatchingOption:ge}}function Te(j,k){return b.fF.assertValue(k,"objectRepetition"),(0,x.OT)(j,k)}function Ce(j,k){return b.fF.assertValue(k,"objectRepetition"),void 0!==Te(j,k)}function ie(j,k){if(b.fF.assert(function(){return k.integer||k.numeric},"databars only supports numeric SQExprs"),k.integer){var te=Math.round(j);return(0,S.cA)(te)}return 2===k.primitiveType?(0,S.gH)(j):(b.fF.assert(function(){return 259===k.extendedType},"Unexpected data type."),(0,S.tx)(j))}},66609:function(st,Le,C){"use strict";C.d(Le,{Iq:function(){return pe},MO:function(){return Ce},Y9:function(){return H},b:function(){return qe},p$:function(){return ze}});var re,x=C(81337),p=C(57871),b=C(9480),S=C(78417),K=C(72489),Z=C(20590),we=C(64466),qe=((re={})[b.t.Dynamic]={displayOption:0,width:p.Z9,height:p.LU},re[b.t.Standard]={displayOption:1,width:p.Z9,height:p.LU},re[b.t.Widescreen]={displayOption:1,width:p.$z,height:p.az},re[b.t.Cortana]={displayOption:3,width:p.yL,height:p.QZ},re[b.t.Letter]={displayOption:1,width:p.lr,height:p.to},re[b.t.Tooltip]={displayOption:1,width:p.R6,height:p.h8},re[b.t.Custom]={displayOption:3,width:p.Z9,height:p.LU},re);function pe(j,k){for(var te=[],de=0,ge=j;de<ge.length;de++){var ye=ge[de];te.push((0,x.__assign)((0,x.__assign)({},ye),{value:"".concat(ye.value),displayName:(0,Z.Gf)(ye.displayName,k),label:ye.label?(0,Z.Gf)(ye.label,k):null}))}return te}function ze(j){void 0===j&&(j=!1);for(var te=[],de=0,ge=(0,K.p$)(j);de<ge.length;de++){var ye=ge[de];te.push({displayName:ye.title,value:ye.value.toString()})}return te}function H(j,k){return function(j,k,te){if(0===j.displayOption)return b.t.Dynamic;if(j.width===p.Z9&&j.height===p.LU)return b.t.Standard;if(j.width===p.$z&&j.height===p.az)return b.t.Widescreen;if(we.s.isCortanaPageSize(j)){var de=(0,S.Ae)(k,te.name);return-1!==de&&k.pods[de].cortanaEnabled?b.t.Cortana:b.t.Custom}return j.width===p.lr&&j.height===p.to?b.t.Letter:function(j){return j.width===p.R6&&j.height===p.h8}(j)?b.t.Tooltip:b.t.Custom}(j,k.getCurrentExploration(),k.getCurrentSection())}function Ce(j){return qe[j]}},87644:function(st,Le,C){"use strict";C.d(Le,{VO:function(){return b},Vj:function(){return S},ub:function(){return p}});var p="formattingService",b="formattingUIService",S=b},92755:function(st,Le,C){"use strict";C.d(Le,{cY:function(){return qe},ks:function(){return we}});var x=C(81337),p=C(11547),b=C(59017),S=C(14172),K=C(32379),Z=C(61617);function we(pe,ze,H,Te,Ce,ie,j){return{objectName:ze.objectName,uid:H,formattingSource:Te,hasDynamicExpressionSupport:j?.isSet,canvasItems:Ce,propertySlice:{name:ze.propertyName,value:pe,type:ze.type,selector:ze.selector,altConstantValueSelector:ze.altConstantValueSelector},conditionalFormatting:!!j,visualUpdateSource:ie}}function qe(pe,ze,H){void 0===H&&(H=[]);for(var Te=[],Ce=function(de){var ge=(0,p.of)([]),ye=(0,p.of)([]),he=de;he&&H.some(function(Ge){return Ge.objectName===he.objectName&&(0,K.fS)(Ge.selector,he.selector)&&Ge.propertyName===he.propertyName})||!he||(ge=pe.selectTopLevelToggle(de).pipe((0,S.U)(function(Ge){return Ge?[(0,x.__assign)((0,x.__assign)({},Ge.control.properties.descriptor),{originSource:Ge.originSource})]:[]})),ye=pe.selectSlice(de).pipe((0,S.U)(function(Ge){return Ge?(0,Z.i6)(Ge).map(function(tt){return(0,x.__assign)((0,x.__assign)({},tt),{originSource:Ge.originSource})}):[]}))),Te.push((0,b.aj)([ge,ye]).pipe((0,S.U)(function(Ge){var Q;return null!==(Q=_.find(Ge,function(Ze){return!_.isEmpty(Ze)}))&&void 0!==Q?Q:[]})))},ie=0,j=ze;ie<j.length;ie++)Ce(j[ie]);return(0,b.aj)(Te).pipe((0,S.U)(function(te){return _.flatten(te)}))}},78432:function(st,Le,C){"use strict";C.d(Le,{An:function(){return H},Aw:function(){return de},D1:function(){return te},H8:function(){return mt},Ky:function(){return fe},LF:function(){return Ce},N6:function(){return tt},UV:function(){return ie},Wx:function(){return ge},ce:function(){return gt},hy:function(){return ye},m7:function(){return Ge},nB:function(){return ze},nH:function(){return wt},so:function(){return rt},um:function(){return k},w7:function(){return j},wW:function(){return pt},zS:function(){return Q},zh:function(){return Te}});var x=C(81337),p=C(9215),b=C(61617),S=C(50550),K=C(62458),Z=C(32379),we=C(10746),re=C(5265),qe=C(80981),pe="___",ze="container-object-name";function H(I,M){switch(I){case"VisualizationPane_Section_Analytics":return"VisualizationPane_Section_Analytics";case"Button":return"Button";case"Format_Label_General":return M.featureSwitches.onObject?"Properties":"Format_Label_General";case"Group":return"Group";case"Image":return"Image";case"Page":return"Page";case"BasicShape_ToolTip":return"BasicShape_ToolTip";case"Visual":return"Visual";default:K.fF.assertNever(I)}}function Te(I){var M="".concat(pe).concat(I.objectName).concat(pe).concat(I.propertyName);return(0,b.$Q)(M,I.selector)}function Ce(I,M){return"".concat(M,"-").concat(I)}function ie(I,M){return I.substring(M.length+1)}function j(I,M){var X=M[I.objectName],Y=X?.properties[I.propertyName];return Y}function k(I,M){var X=null;if(I){if((0,p.q4)(I))return H("Group",M);X=I.config.singleVisual.visualType}switch(X){case"actionButton":return H("Button",M);case"image":return H("Image",M);case"shape":return H("BasicShape_ToolTip",M);default:return H("Visual",M)}}function te(I){var M=I?.config.singleVisual;return!M||(0,qe.xj)(M)}function de(I,M,X){void 0===X&&(X=!1);for(var Y=0,Se=M;Y<Se.length;Y++){var ae=Se[Y],Ie=I[ae.objectName],be=!0,ke=ae.selector;if(Ie){for(var nt=0,$e=Ie;nt<$e.length;nt++){var Oe=$e[nt];(ke&&((0,Z.fS)(Oe.selector,ke)||_.has(ae,"altConstantValueSelector")&&(0,Z.fS)(Oe.selector,ae.altConstantValueSelector))||X&&Oe.selector||!ke&&!X)&&delete Oe.properties[ae.propertyName],be=be&&_.isEmpty(Oe.properties)}be&&delete I[ae.objectName]}}}function ge(I){var M={},X={};I.forEach(function(ae){ae.canvasItems.forEach(function(Ie){var be=Ie.name;X[be]=Ie,M[be]||(M[be]=[]),M[be].push(ae)})});var Y=[];for(var Se in M)Y.push({canvasItem:X[Se],descriptors:M[Se].map(function(ae){return(0,x.__assign)((0,x.__assign)({},ae),{canvasItems:void 0})})});return Y}function ye(I,M,X,Y){return I===M&&(0,Z.fS)(X,Y)}function pt(I,M,X,Y){if(!I||!M)return!1;for(var Se=function($e){var Oe=M[$e.objectName];if(Oe)for(var xe=0,yt=Oe;xe<yt.length;xe++){var Nt=yt[xe];if(Y){if(!Nt.properties[$e.propertyName])continue;if(!$e.selector||(0,Z.fS)(Nt.selector,$e.selector)||(0,Z.fS)(Nt.selector,$e.altConstantValueSelector))return{value:!0}}else if(Nt.properties[$e.propertyName])return{value:!0}}if(X&&_.find(X.changes,function(Je){return Je.objectName===$e.objectName&&Je.propertySlice.name===$e.propertyName}))return{value:!0}},ae=0,Ie=I;ae<Ie.length;ae++){var ke=Se(Ie[ae]);if("object"==typeof ke)return ke.value}return!1}function mt(I){return{objectName:I.objectName,propertyName:I.propertySlice.name,propertyValue:I.propertySlice.value,propertyType:I.propertySlice.type,altConstantValueSelector:I.propertySlice.altConstantValueSelector,selector:I.propertySlice.selector}}function wt(I,M){var Y={objectName:M.objectName,propertySlice:{name:M.propertyName,value:M.propertyValue,type:M.propertyType,altConstantValueSelector:M.altConstantValueSelector,selector:M.selector},hasDynamicExpressionSupport:!1};return Y.hasDynamicExpressionSupport=function(I,M){var X=I.config.singleVisual.query,Se=(0,re.NA)(I.config.singleVisual.objects,{objectName:M.objectName,propertyName:M.propertySlice.name},M.propertySlice.selector);return!(!Se||!(0,we.oA)(Se,M.propertySlice.selector,X?X.defn.select():(0,S.bv)()).length)}(I,Y),Y}function Ge(I,M,X,Y){var Se=Y.visualPlugin&&Y.visualPlugin.capabilities(X);if(Se&&Se.supportsSynchronizingFilterState){var ae=Se.objects[I];if(ae){var Ie=ae.properties[M];if(Ie&&Ie.filterState)return!0}}return!1}function Q(I,M){I&&I.syncFilterState(M)}function tt(I){return void 0!==I.reference}function fe(I){return I.isTopLevelToggle}function rt(I){var M=I.visualObjects,X=_.some(M,function(Y){return"visual-area"===Y.objectName});return X&&M.length>1&&K.fF.assertFail("Visual area sub selectable should only have one visual object"),X}function gt(I){var M=[],X=I.control.type;switch(X){case"MarginPadding":var Y=I.control.properties,Se=Pt(I);M=[Dt(Y.top,Se),Dt(Y.bottom,Se),Dt(Y.left,Se),Dt(Y.right,Se)];break;case"FontControl":var ae=I.control.properties,Ie=Pt(I);ae.fontSize&&M.push(Dt(ae.fontSize,Ie)),ae.fontFamily&&M.push(function(I,M){return(0,x.__assign)((0,x.__assign)({},M),{control:{type:"FontPicker",properties:I},uid:Te(I.descriptor)})}(ae.fontFamily,Ie)),ae.bold&&M.push(Ft(ae.bold,Ie)),ae.italic&&M.push(Ft(ae.italic,Ie)),ae.underline&&M.push(Ft(ae.underline,Ie));break;default:K.fF.assertNever(X)}return M}function Pt(I){return{aliasNames:[],description:"",displayName:"",conditionalFormattingObjects:void 0,conditionalFormattingWarning:void 0,control:void 0,disabled:I.disabled,hidden:I.hidden,disabledReason:I.disabledReason,groupUid:I.groupUid,infoIconText:void 0,originSource:I.originSource,pivotSource:I.pivotSource,placeHolderText:void 0,saveCallback:void 0,showChangeIndicator:I.showChangeIndicator,suppressDisplayName:I.suppressDisplayName,uid:void 0,warningMessage:void 0}}function Dt(I,M){return(0,x.__assign)((0,x.__assign)({},M),{control:{type:"NumUpDown",properties:I},uid:Te(I.descriptor)})}function Ft(I,M){return(0,x.__assign)((0,x.__assign)({},M),{control:{type:"ToggleSwitch",properties:I},uid:Te(I.descriptor)})}},24408:function(st,Le,C){"use strict";C.d(Le,{BT:function(){return wt},Cc:function(){return fe},Ke:function(){return Pt},OR:function(){return de},OY:function(){return tt},QI:function(){return rt},TW:function(){return te},WN:function(){return Ft},X_:function(){return k},Yb:function(){return ie},Yl:function(){return j},cn:function(){return Dt},ht:function(){return ye},mI:function(){return gt},oE:function(){return Q},qb:function(){return mt},sH:function(){return Ge},vw:function(){return ge},yp:function(){return Ze}});var x=C(81337),p=C(67746),b=C(66609),S=C(61903),K=C(60637),Z=C(93187),we=C(33024),re=C(62458),qe=C(64329),pe=C(32379),ze=C(36998),H=C(28488),Te=C(58702),Ce=C(80777);function ie(W,I){return W?W+"-"+I:I}function j(W,I){return re.fF.assertValue(I,"containerIndex"),(0,S.g4)([W,I.toString()])}function k(W){if(re.fF.assertValue(W,"invalid slice"),W.numericValueOptions)return W.numericValueOptions;var I=te(W);if(I===p.iR||I===p.Y4)switch(W.name){case"weight":return{unitSymbol:we.tQ,minValue:0,maxValue:50};case"angle":case"startAngle":return{unitSymbol:we.g,minValue:0,maxValue:360};case"textSize":case"fontSize":case"categoryLabelFontSize":case"dataLabelFontSize":case"levelSubtitleFontSize":case"levelTitleFontSize":case"titleFontSize":case"secFontSize":case"secTitleFontSize":case"expandCollapseButtonsSize":case"headerFontSize":case"cardFontSize":case"questionFontSize":case"restatementFontSize":return{unitSymbol:we.tQ,minValue:qe.Gj,maxValue:qe.PR};case"outlineWeight":case"gridVerticalWeight":case"gridHorizontalWeight":case"barWeight":return{unitSymbol:"",minValue:1,maxValue:10};case"rowPadding":case"cardPadding":return{unitSymbol:"",minValue:0,maxValue:20};case"gridPadding":case"columnPaddingInner":case"columnPaddingOuter":case"rowPaddingInner":case"rowPaddingOuter":case"steppedLayoutIndentation":return{unitSymbol:"",minValue:0,maxValue:40};case"imageHeight":return{unitSymbol:"",minValue:24,maxValue:150};case"borderThickness":case"markerShapeSize":return{unitSymbol:"",minValue:0,maxValue:10};case"preferredCategoryWidth":return{unitSymbol:"",minValue:20,maxValue:180};case"strokeWidth":return{unitSymbol:"",minValue:0,maxValue:12};case"gridlineThickness":return{unitSymbol:"",minValue:1,maxValue:4};case"markerSize":return{unitSymbol:"",minValue:5,maxValue:20};case"innerRadiusRatio":return{unitSymbol:"",minValue:0,maxValue:95};case"borderWidth":case"radius":return{unitSymbol:we.e_,minValue:0,maxValue:30};case"explode":return{unitSymbol:we.t2,minValue:0,maxValue:50};case"bubbleSize":return{unitSymbol:"",minValue:-25,maxValue:100};case"dataBarWidthPercent":return{unitSymbol:we.t2,minValue:50,maxValue:150};case"shadowSpread":case"shadowBlur":case"shadowDistance":return{unitSymbol:we.e_,minValue:0,maxValue:100};default:return{unitSymbol:we.t2,minValue:0,maxValue:100}}}function te(W){if(null==W.type&&null==W.save&&_.isFunction(W.value))return"linkButton";if(null==W.type)return null;var I=function(W){re.fF.assertValue(W,"sliceType");var I=Ce.Ge.fromDescriptor(W);if(0!==I.extendedType){var M=I.formatting||I.misc;if(M)return function(W){for(var I in W)if(!0===W[I])return I;return null}(M)}return Object.keys(W)[0]}(W.type);switch(I){case"alignment":return"alignment";case"numericUnitSelection":return"numericUnitSelection";case"fontSize":case"titleFontSize":case"secFontSize":case"secTitleFontSize":return p.Y4;case"fontFamily":return"fontPicker";case"altText":return p.Kx;case"webUrl":return"text"}if(W.selectionOptions)return W.selectionOptions.some(function(M){return M.icon})?"propertyPaneSelection":"flagsEnumeration"===I?p.k8:p.Y1;switch(W.name){case"lineTransparency":case"transparency":case"angle":case"shapeAngle":case"textAngle":case"imageHeight":case"steppedLayoutIndentation":case"percentile":case"preferredCategoryWidth":case"maxMarginFactor":case"innerPadding":case"labelDensity":case"bubbleSize":case"backgroundTransparency":case"innerRadiusRatio":case"startAngle":case"borderWidth":case"explode":case"radius":case"dataBarWidthPercent":case"barsPerLevel":case"shadowBlur":case"shadowSpread":case"shadowDistance":case"markerShapeSize":case K.DQ.bubbleRadius:case K.DQ.minBubbleRadius:case K.DQ.maxRadius:case K.DQ.mapTransparency:case K.DQ.strokeTransparency:case K.DQ.blur:case K.DQ.unselectedTransparency:case K.DQ.bubbleStrokeWidth:case K.DQ.height:case K.DQ.thickness:case"gridLineWidth":case"gridPadding":case"columnPaddingInner":case"columnPaddingOuter":case"rowPaddingInner":case"rowPaddingOuter":case"shadeTransparency":case Z.Mn.arrowheadSize:case Z.Mn.speechBubbleHeight:case Z.Mn.speechBubbleTailAngle:case Z.Mn.chevronAngle:case Z.Mn.hexagonSlant:case Z.Mn.octagonSnipSize:case Z.Mn.parallelogramSlant:case Z.Mn.rectangleRoundedCurve:case Z.Mn.shapeRounding:case Z.Mn.arrowStemWidth:case Z.Mn.tabCutCornerSnipSizeTopRight:case Z.Mn.tabCutCornerSnipSizeTop:case Z.Mn.tabCutCornerSnipSizeBottom:case Z.Mn.tabRoundCornerTopRight:case Z.Mn.tabRoundCornerTop:case Z.Mn.tabRoundCornerBottom:case Z.Mn.trapezoidSlant:case Z.Mn.isocelesTriangleTipPosition:return p.iR;case"gradientBar":return"gradientBar";case"expander":return"container";case"weight":case"textSize":case"outlineWeight":case"gridVerticalWeight":case"gridHorizontalWeight":case"rowPadding":case"barWeight":case"cardPadding":case"borderThickness":case"strokeWidth":case"gridlineThickness":case"markerSize":return p.Y4}return W.numericValueOptions?p.Y4:I}function de(W){var I=te(W);return I===p.iR||"fill"===I}function ge(W,I){if(null!=I&&_.isNumber(I))for(var M=I.toString(),X=0,Y=W;X<Y.length;X++){var Se=Y[X];if(Se.value===I)break;if(Se.value===M)return M}return I}function ye(W,I){if(W.selectedContainers)if(_.isEmpty(I.containers))W.selectedContainers[I.name]=void 0;else{var X,M=W.selectedContainers[I.name];X=M?_.find(I.containers,function(Y){return Y.value===M}):_.head(I.containers),I.selectedContainer=X}}function mt(W,I,M){if(W instanceof ze.L){var X=W;return M?{title:X.getTitle(I),message:null,detail:null}:{title:X.getMessage(I),message:null,detail:null}}return W.getMessages(I)}function wt(W,I,M){for(var X=0,Y=W;X<Y.length;X++){var Se=Y[X];if(Se&&Se.warnings)for(var ae=0,Ie=Se.warnings;ae<Ie.length;ae++){var be=Ie[ae];if(be instanceof ze.L&&be.propertyId.propertyName===M&&(!be.selector&&!be.selector||(0,pe.fS)(be.selector,I)))return be}}}function Ge(W,I){var M=Ce.Ge.fromDescriptor(W);if(!M.variant)return W;re.fF.assertValue(I,"propertyTypes");for(var X=Ce.Ge.fromDescriptor(I),Y=0,Se=M.variant;Y<Se.length;Y++)if(X.isCompatibleFrom(Se[Y]))return I}function Q(W){return _.map(W,function(M){return{displayName:M.displayName,value:M.name}})}function Ze(W){return _.map(W,function(M){return{displayName:M.displayName,value:M.name}})}function tt(W){return _.map(W,function(M){return{displayName:M.displayName,value:M.name}})}function fe(W,I){var M=W.validValues;return M&&M[I]}function rt(W){return!_.isArray(W)}function gt(W,I,M){var X;return(0,x.__awaiter)(this,void 0,void 0,function(){var Y,Se,ae;return(0,x.__generator)(this,function(be){switch(be.label){case 0:Y={displayName:M.get("PersonalizeVisual_DefaultPerspective"),value:""},Se=W.get().map(function(ke){var $e=ke.dsr;return{type:ke.type,objectId:$e?.dbName}}),be.label=1;case 1:return be.trys.push([1,3,,4]),[4,I.get(Se).toPromise()];case 2:return ae=(null===(X=be.sent())||void 0===X?void 0:X.perspectiveIds)||[],[3,4];case 3:return be.sent(),ae=[],[3,4];case 4:return[2,(0,x.__spreadArray)([Y],ae.map(function(ke){return{displayName:ke,value:ke}}),!0)]}})})}function Pt(W){return!!W&&(0!==Ce.Ge.fromDescriptor(W.type).extendedType||(0,Te.JY)(W.type))}function Dt(W){return(0,x.__awaiter)(this,void 0,void 0,function(){var I,M,X,Y,Se,ae,Ie,be,ke,nt,$e,Oe,xe,yt,Nt,Je,jt,Ht;return(0,x.__generator)(this,function(vr){switch(vr.label){case 0:return M=W.instance,X=W.propertyName,Se=W.visualType,(Y=W.paneServices)||(Y={}),ae=Y.bookmarkService,Ie=Y.dataSourcesService,be=Y.explorationNavigation,ke=Y.localizationService,nt=Y.perspectivesService,$e=Y.visualStylePresetService,re.fF.assertValue(I=W.propertyType,"propertyType"),re.fF.assertValue(M,"instance"),(Oe=I.enum||I.flagsEnum)?[3,7]:((xe=I.formatting)&&(xe.labelDisplayUnits?Oe=(0,H.i)((0,b.p$)()):xe.displayUnitsWithoutAuto?Oe=(0,H.i)((0,b.p$)(!0)):xe.stylePreset&&(Oe=$e.getEnumFromName(Se,M.properties.name))),(yt=I.reference)?yt.bookmark?(re.fF.assertValue(ae,"bookmarks not implemented here"),re.fF.assertValue(ke,"localizationService is missing"),ae&&(Oe=(0,H.i)(Q(ae.getAllBookmarks()))),[3,7]):[3,1]:[3,7]);case 1:return yt.bookmarkGroup?(re.fF.assertValue(ae,"bookmarks not implemented here"),re.fF.assertValue(ke,"localizationService is missing"),ae&&(Oe=(0,H.i)(Ze(ae.getBookmarkGroups()))),[3,7]):[3,2];case 2:return yt.section?(re.fF.assertValue(be,"explorationNavigation not implemented here"),re.fF.assertValue(ke,"localizationService is missing"),be&&(Oe=(0,H.i)(tt(be.getAllSections()))),[3,7]):[3,3];case 3:return yt.perspective?(re.fF.assertValue(Ie,"dataSourcesService is missing"),re.fF.assertValue(nt,"perspectivesService is missing"),re.fF.assertValue(ke,"localizationService is missing"),Ie&&nt&&ke?(Nt=H.i,[4,gt(Ie,nt,ke)]):[3,5]):[3,6];case 4:Oe=Nt.apply(void 0,[vr.sent()]),vr.label=5;case 5:return[3,7];case 6:re.fF.assertFail("Unknown refType"),vr.label=7;case 7:return Oe?((Je=fe(M,X))&&(jt=void 0,rt(Je)?(jt=Je.filterValues,Je.mergeValues&&(Ht=(0,x.__spreadArray)((0,x.__spreadArray)([],Je.mergeValues||[],!0),Oe.members()||[],!0),Oe=(0,H.i)(Ht))):jt=Je,jt&&(Oe=(0,H.i)(Oe.members(jt)))),[2,(0,b.Iq)(Oe.members(),ke)]):[2]}})})}function Ft(W){return!!W.items}},2863:function(st,Le,C){"use strict";C.d(Le,{v:function(){return b}});var x=C(3579);function b(S,K,Z){var we=(0,x.s)(S);return K.isCustomVisual(we)||Z.isTrustedVisual(we)}},89535:function(st,Le,C){"use strict";C.d(Le,{Kj:function(){return S},YR:function(){return Z},lD:function(){return b},r4:function(){return K},y5:function(){return we}});var x=C(19650),p=C(50423),b=function(){return function(ze,H){this.value=ze,this.equals=H}}(),S=new p.InjectionToken("SliceCustomizationService"),K=6,Z=60,we={left:x.H.left,center:x.H.center,right:x.H.right,Auto:x.H.auto}},39091:function(st,Le,C){"use strict";C.r(Le),C.d(Le,{ExploreFormattingModule:function(){return Gs}});var Ce,ie,x=C(77476),p=C(81337),b=C(62458),S=C(56578),K=C(48708),Z=C(47998),we=C(61193),re=C(66123),qe=C(33024),pe=C(2241),ze=C(51490),H=C(80822),Te=C(90120),j=((Ce={}).anomalyDetection={objectName:"anomalyDetection",maxInstances:1,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_AnomalyDetection"},Ce.forecast={objectName:"forecast",maxInstances:1,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Forecast"},Ce.plotAreaShading={objectName:"plotAreaShading",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Scatter_SymmetryShading"},Ce.ratioLine={objectName:"ratioLine",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Scatter_RatioLine"},Ce.referenceLine={objectName:"referenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line"},Ce.trend={objectName:"trend",maxInstances:1,supportsUserDefinedInstances:!1,displayNameBaseKey:"Visual_Trend_Line"},Ce.xAxisReferenceLine={objectName:"xAxisReferenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line_X"},Ce.y1AxisReferenceLine={objectName:"y1AxisReferenceLine",maxInstances:null,supportsUserDefinedInstances:!0,displayNameBaseKey:"Visual_Reference_Line_Y"},Ce),k="show",te="referenceLine",de="measure",ge="type",ye="percentile",he="unknown",pt=((ie={}).Min=te+"-minLine",ie.Max=te+"-maxLine",ie.Average=te+"-averageLine",ie.Median=te+"-medianLine",ie.Percentile=te+"-percentileLine",ie),wt={units:"Unit",forecastLength:"ForecastLength",ignoreLast:"IgnoreLast",confidenceInterval:"ConfidenceLevel",seasonality:"MaxSeasonality"},Ge={sensitivity:H.DM,explainBy:H.Bx},Q=C(60661),Ze=C(28579),tt=C(47006),fe=C(5265),rt=C(74082),gt=C(45413),Pt=C(45334),Dt=C(58295);function Ft(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return n?(r={objectName:e},n.enumerateObjectInstancesAsync?[4,n.enumerateObjectInstancesAsync(r)]:[3,2]):[2];case 1:return t=i.sent(),[3,3];case 2:n.enumerateObjectInstances&&(t=n.enumerateObjectInstances(r)),i.label=3;case 3:return[2,Ze.G.normalize(t)]}})})}function W(n){var e;return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return n.getFormattingModelAsync?[4,n.getFormattingModelAsync()]:[3,2];case 1:return r=a.sent(),[3,3];case 2:r=null===(e=n.getFormattingModel)||void 0===e?void 0:e.call(n),a.label=3;case 3:return(t=r)?(i=_.filter(t.cards,function(o){return o.analyticsPane}),b.fF.assert(function(){return _.every(i,function(o){return!(0,S.Qu)(o)})},"Analytics pane does not support Placeholder cards."),[2,i]):[2]}})})}function I(n,e,t,r){var i,a=null===(i=n?.config)||void 0===i?void 0:i.singleVisual;if(!a?.query)return[];var o=r.capabilities(a.visualType);if(!o||!o.objects)return[];var s=[];o.objects[tt.Dk]&&s.push(1),o.objects[tt.XC]&&s.push(0);for(var l=[],u=(0,Q.d$)(n,r)||[],c=a.query.defn.select(),d=function(g){if(_.some(s,function(N){return N===g.cartesianKind}))for(var w=function(T){if(!(0,Dt.k)(T))return"continue";var P=_.find(c,function(E){return(0,gt.fS)(T,E.expr)}),O=t.getDisplayName(T,e,o,P.name,a.columnProperties);l.push({displayName:O,value:P.name,selectExpr:P})},V=0,q=a.query.tryGetExprs(g.name)||[];V<q.length;V++)w(q[V])},v=0,h=u;v<h.length;v++)d(h[v]);return l}function X(n,e,t,r,i,a,o,s){var l;return(0,p.__awaiter)(this,void 0,void 0,function(){var u,c,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return null!==(l=i.objects)&&void 0!==l&&l[n]?(b.fF.assert(function(){var g;return 1===(null===(g=_.find(j,function(y){return y.objectName===n}))||void 0===g?void 0:g.maxInstances)},"Expect this be called only for cards that support maximum 1 instance"),[4,Ft(r,n)]):[2];case 1:return u=m.sent(),_.isEmpty(u?.instances)?[2]:(c=s??k,b.fF.assert(function(){return 1===u.instances.length},n+" supports maximum 1 instance but there are "+u.instances.length),v=(d=u.instances[0]).properties[c],(h=new S.CQ(new S.lg(e),t,o,a)).addTopLevelToggle("show",function(){return new S.bd({descriptor:{objectName:n,propertyName:c,selector:d.selector},value:v}).build()}),f=!1,_.isEmpty(d.disabledReason)||(h.withDisabledLocalized(!0,d.disabledReason),f=!0),[2,{cardBuilder:h,objectInstance:d,disableCard:f}])}})})}function Y(n,e,t,r,i,a){if(r.objects[e])for(var o={objectName:e,selector:t.selector,altConstantValueSelector:t.altConstantValueSelector,propertyName:void 0,propertyTypes:void 0},s=function(v){var h=v.propertyName;if(!_.has(r.objects[e].properties,h)||!_.has(t.properties,h))return"continue";var f=(0,p.__assign)((0,p.__assign)({},o),{propertyName:h,propertyTypes:t.propertyTypes?t.propertyTypes[h]:void 0}),m=v.customDisplayNameKey?function(N){N.withCustomDisplayName(v.customDisplayNameKey)}:void 0,g=t.properties[h];if("color"===v.type)n.addSimpleSlice(v.sliceName,function(){var N,P={value:null===(N=g.solid)||void 0===N?void 0:N.color};return new S.BT({descriptor:f,value:P}).build()},m);else if("enumeration"===v.type)n.addSimpleSlice(v.sliceName,function(){return new S.uY({descriptor:f,value:g}).build()},m);else if("toggle"===v.type)n.addSimpleSlice(v.sliceName,function(){return new S.bd({descriptor:f,value:g}).build()});else if("slider"===v.type||"transparency"===v.type){var y,w,V;if("transparency"===v.type)y=qe.t2,w={type:0,value:0},V={type:1,value:100};else if("slider"===v.type){var q=v.options;y=q?.unitSymbol,w=null!=q?.min?{type:0,value:q.min}:void 0,V=null!=q?.max?{type:1,value:q.max}:void 0}n.addSimpleSlice(v.sliceName,function(){return new S.JN({descriptor:f,value:g,options:{unitSymbol:y,minValue:w,maxValue:V},localize:i}).build()},m)}else if("numUpDown"===v.type){var F=v?.options;n.addSimpleSlice(v.sliceName,function(){return new S.mu({descriptor:f,value:g,options:{unitSymbol:F.unitSymbol,unitSymbolAfterInput:F.unitSymbolAfterInput,minValue:null!=F?.min?{type:0,value:F.min}:void 0,maxValue:null!=F?.max?{type:1,value:F.max}:void 0},placeholderText:i(F.placeholderTextKey)}).build()})}},l=0,u=a;l<u.length;l++)s(u[l])}function Se(n,e,t,r){var i=function(n,e){var t,r,i,a,o,s=null!==(i=null===(r=null===(t=e.config)||void 0===t?void 0:t.singleVisual)||void 0===r?void 0:r.objects)&&void 0!==i?i:{};if(null===(a=j[n])||void 0===a||!a.supportsUserDefinedInstances)return null;for(var u=0,c=0,d=s[n]??[];c<d.length;c++){var h=null===(o=d[c].selector)||void 0===o?void 0:o.id,f=null!=h?parseInt(h,10):0;u=Math.max(u,f)}return{id:(u+1).toString()}}(n,t),a={merge:[{objectName:n,selector:i,properties:{show:!0}}]};if(null!=e){var o=Oe(n,t,e,r);a.merge[0].properties.displayName=o}return a}function ae(n,e,t,r){return Se(n,r.get(e),t,r)}function Ie(n,e){return{objectName:n,selector:e,properties:{}}}function be(n,e,t,r){var i={removeObject:[]};i.removeObject.push(Ie(n,e)),r.persistProperties(i,t,!0)}function ke(n,e){var t;if(n){var r=null===(t=e.config)||void 0===t?void 0:t.singleVisual;if(r){var i=(0,fe.NA)(r.objects,{objectName:n.objectName,propertyName:"transform"},n.selector);return i?.parameters&&(i.parameters=_.filter(i.parameters,function(a){return!!a})),i}}}function nt(n,e){if(e){var t=_.find(e.parameters,function(r){return r.name===n});if(!t)return;if((0,rt.S9)(t.expr))return t.expr.value;b.fF.assertFail("Expect this only be called for parameters of analytics transforms that has SQConstant expressions with numeric value type")}}function Oe(n,e,t,r){var i,l,a=null!==(i=e.config.singleVisual.objects)&&void 0!==i?i:{},s=_.map(a[n],function(c){var d=c.properties.displayName;if(d)return Pt.m.getPrimitiveValuesFromSQConstantExpr(d)}).filter(function(c){return!!c}),u=1;do{l=r.format("AnalyticsPane_New_Instance_Default_Format",[t,u]),u++}while(_.includes(s,l));return l}var xe=C(40702),yt=C(92194),Nt=C(22733),Je=C(47508),jt=C(64869),De=C(94419),Lt=C(98665),D=C(50423),zt=C(26898),Vt=C(83008),vt=C(66890),lt=C(9380),ot=C(65181),It=C(8082),qt=C(29866),Xe=H.xn,$i={numeric:!0},dr=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSources=t,this.featureSwitchService=r,this.localizationService=i,this.runningVisualService=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return n.prototype.enumerateAnomalyCard=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,v,h,f,m,g,y,w,V,q,F=this;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return this.featureSwitchService.featureSwitches.daxTransformEnabled&&r.objects[Xe]?[4,this.conceptualSchemaProxy.get(this.dataSources.get())]:[2];case 1:return i=N.sent(),(a=function(e,t,r){var i=(0,Q.Xf)(e);if(!i)return{shouldInclude:!1};if((0,Q.iv)(e))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_Disabled_For_VC")};if((0,Q.tL)(e))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_Disabled_For_Hidden")};var o=(0,Q.oJ)(e);if(!_.every(o,function(v){return Pt.m.isExprValidForAnalysisTransform(v.expr)}))return{shouldInclude:!1};if(!_.every(t.schemas,function(e){return _.some(e.capabilities.transformCapabilities.supportedTransforms,function(t){return t===yt.Xp})&&!e.isMultiDimensionalModel}))return{shouldInclude:!0,warningText:r.get("Visual_AnomalyDetection_ErrorMessage_NotSupport")};var l=function(n){if(n===Je.L.lineChart.name)return Nt.x.category;b.fF.assertFail("Unsupported visual type for anomalies: "+n)}(e.config.singleVisual.visualType),u=i.tryGetExprs(l);if(!(0,H.h_)(u,t)&&!(0,jt._T)(t,i.defn,i.projections,l)){var c=r.get("Role_DisplayName_Axis");return{shouldInclude:!0,warningText:r.format("Visual_AnomalyDetection_WarningMessage_CategoryNotDateTime",c)}}return{shouldInclude:!0}}(e,i,this.localizationService)).shouldInclude?(o=(0,p.__spreadArray)((0,p.__spreadArray)([k,H.DM,H.Bx],Object.values(re.m6),!0),[H.MA.confidenceBandShow,H.MA.confidenceBandColor,H.MA.confidenceBandStyle,H.MA.transparency],!1),[4,X(Xe,"anomaly","Insights_TitleKey",t,r,s=function(P){return F.localizationService.get(P)},_.map(o,function(T){return{objectName:Xe,propertyName:T}}))]):[2];case 2:return(l=N.sent())?(u=l.cardBuilder,l.disableCard?((c=u.build()).analyticsPane=!0,[2,c]):_.isEmpty(a.warningText)?(h=l.objectInstance,f=(0,K.Ue)(),q=(0,ze.yF)(h.properties,(0,ze.EL)(f),Te.v.create(f)),m=q.marker,g=q.band,y=function(P){return{objectName:Xe,selector:h.selector,altConstantValueSelector:h.altConstantValueSelector,propertyName:P,propertyTypes:h.propertyTypes?h.propertyTypes[P]:void 0}},w=this.featureSwitchService.featureSwitches.newMarkerProperties,u.addGroup("options",function(T){var P;return T.withDisplayName("Desktop_FileMenu_Options").withDelaySaveSlices().addSimpleSlice("sensitivity",function(){return S.JN.getTransparencySliderBuilder({descriptor:{objectName:Xe,propertyName:H.DM},value:Yi(ke(h,e)),localize:s}).build()},function(O){return O.withCustomDisplayName("Visual_AnomalyDetection_Sensitivity")}).addSimpleSlice("explainBy",new S.k0({descriptor:{objectName:Xe,propertyName:H.Bx},value:{newExpr:_.map(null===(P=Xi(h,e))||void 0===P?void 0:P.exprs,function(O){return{expr:O}})},validators:{field:{kind:0}},allowMultipleValues:!0}).build(),function(O){return O.withCustomDisplayName("Role_DisplayName_ExplainBy")})}).addGroup("markers",function(T){w&&T.addTopLevelToggle("markerShow",function(){return new S.bd({descriptor:y(re.m6.show),value:m.show}).build()}),T.withDisplayName("Visual_Shape").addSimpleSlice("markerShape",new S.uY({descriptor:y(re.m6.shape),value:m.shape}).build()).addSimpleSlice("markerSize",new S.mu({descriptor:y(re.m6.size),value:m.size,options:{minValue:{type:0,value:0},maxValue:{type:1,value:10},unitSymbol:qe.e_}}).build()).addSimpleSlice("markerRotation",S.JN.getRotationSliderBuilder({descriptor:y(re.m6.rotation),value:m.rotation,localize:s}).build(),function(P){return P.withHidden(!w||!(0,we.Cd)(m.shape))})}).addGroup("colors",function(T){return T.withDisabled(!m.show).withDisplayName("Generic_Color").addSimpleSlice("markerColor",new S.BT({descriptor:y(re.m6.color),value:{value:m.color}}).build()).addSimpleSlice("markerTransparency",S.JN.getTransparencySliderBuilder({descriptor:y(re.m6.transparency),value:m.transparency,localize:s}).build(),function(P){return P.withHidden(!w)})}),w&&u.addGroup("border",function(T){return T.withDisplayName("Visual_Border").withDisabled(!(0,we.nK)(m.shape)||!m.show).addSlices((0,pe.Iq)({containerItemBuilder:T,descriptors:{strokeShow:y(re.m6.strokeShow),strokeColorMatch:y(re.m6.strokeColorMatch),strokeColor:y(re.m6.strokeColor),strokeTransparency:y(re.m6.strokeTransparency),strokeWidth:y(re.m6.strokeWidth)},strokeData:m.stroke,selector:h.selector,featureSwitches:F.featureSwitchService.featureSwitches,localize:s}).map(function(P){return P.build()}))}),u.addGroup("expectedrange",function(T){T.withDisplayName("Visual_AnomalyDetection_ExpectedRange"),w&&T.addTopLevelToggle("markerBorderShow",function(){return new S.bd({descriptor:y(H.MA.confidenceBandShow),value:g.show}).build()}),T.addSimpleSlice("confidenceBandStyle",new S.uY({descriptor:y(H.MA.confidenceBandStyle),value:g.style,filterValues:w?[Z.X$.fill,Z.X$.line]:[Z.X$.fill,Z.X$.line,"none"]}).build()).addSimpleSlice("confidenceBandColor",new S.BT({descriptor:y(H.MA.confidenceBandColor),value:{value:g.color}}).build()).addSimpleSlice("confidenceBandTransparency",S.JN.getTransparencySliderBuilder({descriptor:y(H.MA.transparency),value:g.transparency,localize:s}).build())}),(V=u.build()).analyticsPane=!0,[2,V]):(u.withDisabledLocalized(!0,a.warningText),(v=u.build()).analyticsPane=!0,[2,v])):[2]}})})},n.prototype.checkAddRemoveInstance=function(e,t,r){return e===Xe&&t.name===k&&(t.value?this.addInstance(r):be(e,t.selector,r,this.visualAuthoringService),!0)},n.prototype.saveGroupSlices=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return e!==this.localizationService.get("Desktop_FileMenu_Options")?[2,!1]:[4,this.getSaveParameterValuesChange(Xe,t,r)];case 1:return(i=a.sent())&&this.visualAuthoringService.persistProperties(i,r,!0),[2,!!i]}})})},n.prototype.hasParameterWithNonDefaultValue=function(e){var t=_.first(e[Xe]);if(!t)return!1;var r=t.properties.transform;if(!r)return!1;if(!_.isEmpty(r.parameters)){var i=r.parameters,a=hr().expr;if(_.some(i,function(o){return o.name===H.DM&&!(0,gt.fS)(o.expr,a)}))return!0}return!1},n.prototype.revertAnomalyDetectionSpecialDefinitions=function(e,t,r){if(t){var i=_.first(t[Xe]);if(i){if(_.some(r,function(d){return d.objectName===Xe&&d.propertyName===k}))return void be(Xe,i.selector,e,this.visualAuthoringService);for(var a=i.properties.transform,o=H.DM,s=0,l=r;s<l.length;s++)if(l[s].propertyName===o){var c=_.findIndex(a?.parameters,function(d){return d.name===o});c>=0&&(a.parameters[c]=hr())}}}},n.prototype.getObjectDefinitions=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r],o=a.properties[H.Bx];if(o&&_.isEmpty(o.exprs)){var s=(0,p.__assign)({},a.properties);delete s[H.Bx],t.push((0,p.__assign)((0,p.__assign)({},a),{properties:s}))}else t.push(a)}return t},n.prototype.addInstance=function(e){var t=ae(Xe,j.anomalyDetection.displayNameBaseKey,e,this.localizationService);b.fF.assert(function(){var s;return 1===(null===(s=t?.merge)||void 0===s?void 0:s.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item");var r=t.merge[0],i=r.selector;b.fF.assertValue(i,"forecast addInstance merge change should have a defined selector"),i.metadata=this.getBoundMeasure(e),b.fF.assertValue(i.metadata,"new anomaly detecton instance selector should have metadata");var a=hr();r.properties.transform={algorithm:H.vb,parameters:[a]},r.properties[H.Bx]={exprs:[]},this.telemetryService.logEvent(xe.Yu,{objectName:Xe}),this.visualAuthoringService.persistProperties(t,e,!0)},n.prototype.getSaveParameterValuesChange=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return _.isEmpty(t)?[2]:_.every(t,function(c){return _.includes(Ge,c.propertySlice.name)})?[4,Ft(this.runningVisualService.getVisual(r).getAdapter(),e)]:[2];case 1:return o=u.sent(),_.isEmpty(o?.instances)?[2]:(b.fF.assert(function(){return 1===o.instances.length},e+" supports maximum 1 instance but there are "+o.instances.length),s=o.instances[0],b.fF.assert(function(){return _.size(t)<=2},"At most 2 slice changes since there are only 2 slices in the Apply group"),l={merge:[]},_.forEach(t,function(c){var d=c.propertySlice;if(d.name===H.DM){var v=ke(s,r);if(v){var h=function(n){return n/100}(d.value),f=Dr(h);l.merge.push({objectName:Xe,selector:s.selector,properties:{transform:{algorithm:v.algorithm,parameters:[f]}}})}}else if(d.name===H.Bx){var m=d.value,g=m?.newExpr;l.merge.push({objectName:H.xn,properties:{explainBy:{exprs:_.map(g,function(y){return y.expr}),kind:"ExprList"}},selector:s.selector})}}),[2,l])}})})},n.prototype.getBoundMeasure=function(e){var t=(0,Q.Xf)(e);b.fF.assertValue(t,"visualContainer should have a query");for(var i=0,a=(0,Q.d$)(e,this.visualPluginService)??[];i<a.length;i++){var o=a[i];if(1===o.cartesianKind){var s=t.getQueryRefByProjectionIndex(o.name,0);if(s)return s}}},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Lt.y0),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function Xi(n,e){var t;if(n){var r=null===(t=e.config)||void 0===t?void 0:t.singleVisual;if(r)return(0,fe.NA)(r.objects,H.XZ,n.selector)}}function hr(){return Dr(H.z$)}function Yi(n){var e=nt(H.DM,n);return null==e&&(e=H.z$),function(n){if(null!=n)return Math.round(100*n)}(e)}function Dr(n){var e=(0,fe.Lo)(n,$i);return b.fF.assert(function(){return e instanceof De.Il&&(0,rt.VC)(e)},"encoded value for transform sensitivity parameter should be a constant"),{name:H.DM,expr:e}}var Ot,Qt,$t,fr,n,Rr=C(20114),Kt=C(40253),Ne=C(21571),He=C(14599),li=C(17772),Fr=C(69871),Be=C(82173),ue=wt,Ur=((Ot={})[ue.units]=Kt.xm,Ot[ue.forecastLength]=10,Ot[ue.ignoreLast]=0,Ot[ue.confidenceInterval]=Rr.s$,Ot[ue.seasonality]=void 0,Ot),Nr=((Qt={})[ue.units]={enumeration:Kt.dt},Qt[ue.forecastLength]={numeric:!0},Qt[ue.ignoreLast]={numeric:!0},Qt[ue.confidenceInterval]={enumeration:Rr.dt},Qt[ue.seasonality]={numeric:!0},Qt),kr=(($t={})[ue.forecastLength]=1,$t[ue.ignoreLast]=0,$t[ue.seasonality]=1,$t),mr=((fr={})[ue.forecastLength]=2e9,fr[ue.ignoreLast]=500,fr[ue.seasonality]=2e9,fr),ar={units:{objectName:Be.Po,propertyName:ue.units},forecastLength:{objectName:Be.Po,propertyName:ue.forecastLength},ignoreLast:{objectName:Be.Po,propertyName:ue.ignoreLast},seasonality:{objectName:Be.Po,propertyName:ue.seasonality},confidenceInterval:{objectName:Be.Po,propertyName:ue.confidenceInterval}},Gr=_.map(ar,function(n){return n.propertyName}),ui=(n={},_.forEach(Kt.dt.members(),function(e,t){n[e.value]=t}),n),gr=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSources=t,this.featureSwitchService=r,this.localizationService=i,this.runningVisualService=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return n.prototype.enumerateForecastCard=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h,f=this;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return r.objects[Be.Po]?[4,this.querySupportsForecasting(e)]:[2];case 1:return m.sent()?[4,X(Be.Po,"forecast","Visual_Forecast",t,r,a=function(y){return f.localizationService.get(y)},(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],Object.values((0,He.pN)(Be.Po,He.ZB)),!0),Object.values((0,He.pN)(Be.Po,He.PK)),!0),_.map((0,p.__spreadArray)([ue.units,ue.forecastLength,ue.ignoreLast,ue.seasonality,ue.confidenceInterval,"displayName","matchSeriesInterpolation","interpolation","interpolationStep","interpolationSmooth","interpolationSmoothParam"],Object.keys(He.iQ),!0),function(g){return{objectName:Be.Po,propertyName:g}}),!0),"show")]:[2];case 2:return(o=m.sent())?((0,Q.iv)(e)?o.cardBuilder.withDisabled(!0,"Visual_Forecast_Disabled_For_VC"):(0,Q.tL)(e)&&o.cardBuilder.withDisabled(!0,"Visual_Forecast_Disabled_For_Hidden"),s=o.cardBuilder,o.disableCard?((l=s.build()).analyticsPane=!0,[2,l]):(u=o.objectInstance,[4,this.conceptualSchemaProxy.get(this.dataSources.get())])):[2];case 3:return c=m.sent(),d=ke(u,e),v=Vr(ue.units,d),s.addGroup("options",function(g){g.withDisplayName("Desktop_FileMenu_Options").withDelaySaveSlices().addSimpleSlice("units",function(){var y=f.getPossibleUnits(e,c);return new S.uY({items:y,descriptor:ar.units,value:_.find(y,function(w){return w.value===v})}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_Units").withInfoIconText(f.localizationService.format("AnalyticsPane_Forecast_Units_Apply_To_Properties_InfoText",[f.localizationService.get("Visual_Forecast_Parameter_ForecastLength"),f.localizationService.get("Visual_Forecast_Parameter_IgnoreLength")]))}).addSimpleSlice("forecastLength",function(){var y=Vr(ue.forecastLength,d);return new S.mu({descriptor:ar.forecastLength,value:y,options:{minValue:{type:0,value:kr[ue.forecastLength]},maxValue:{type:1,value:mr[ue.forecastLength]}}}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_ForecastLength")}).addSimpleSlice("ignoreLast",function(){var y=Vr(ue.ignoreLast,d);return new S.mu({descriptor:ar.ignoreLast,value:y,options:{minValue:{type:0,value:kr[ue.ignoreLast]},maxValue:{type:1,value:mr[ue.ignoreLast]}}}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_IgnoreLength")}).addSimpleSlice("seasonality",function(){var y=Vr(ue.seasonality,d);return new S.mu({descriptor:ar.seasonality,value:y,options:{unitSymbol:"Visual_Forecast_Units_Point",unitSymbolAfterInput:!0,minValue:{type:0,value:kr[ue.seasonality]},maxValue:{type:1,value:mr[ue.seasonality]}},placeholderText:f.localizationService.get("Visual_Auto")}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_Seasonality")}).addSimpleSlice("confidenceInterval",function(){var y=Vr(ue.confidenceInterval,d),w=pi(Rr.dt.members(),f.localizationService);return new S.uY({items:w,descriptor:ar.confidenceInterval,value:_.find(w,function(V){return V.value===y})}).build()},function(y){y.withCustomDisplayName("Visual_Forecast_Parameter_ConfidenceInterval")})}).addGroup("forecastline",function(g){return g.withDisplayName("Visual_Forecast_Line").addSlices((0,pe.Iq)({containerItemBuilder:g,descriptors:(0,p.__assign)((0,p.__assign)({},(0,He.pN)(Be.Po,He.ZB)),{strokeShow:null}),strokeData:(0,pe.AF)(u.properties,He.ZB,{}),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:a,isSVGStroke:!0}).map(function(y){return y.build()})).addSimpleSlice("matchSeriesInterpolation",new S.bd({descriptor:(0,p.__assign)((0,p.__assign)({},Fr.qn.forecast.matchSeriesInterpolation),{selector:u.selector}),value:u.properties.matchSeriesInterpolation}).build()).addSlices((0,li.Ie)({containerItemBuilder:g,descriptors:Fr.qn.forecast,interpData:(0,li.Bs)(u.properties,{}),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:a}).map(function(y){return y.withDisabled(!0===u.properties.matchSeriesInterpolation).build()}))}),s.addGroup("confidenceLine",function(g){return g.withDisplayName("Visual_Forecast_Confidence_Lines").addSlices((0,pe.Iq)({containerItemBuilder:g,descriptors:(0,He.pN)(Be.Po,He.PK),strokeData:(0,pe.AF)(u.properties,He.PK,{},void 0,u.properties.lineColor.solid.color),selector:u.selector,featureSwitches:f.featureSwitchService.featureSwitches,localize:a,isSVGStroke:!0}).map(function(y){return y.build()}))}).addGroup("confidenceArea",function(g){g.withDisplayName("Visual_Forecast_Confidence_Shade").addTopLevelToggle("bandAreaShow",function(){return new S.bd({descriptor:{objectName:Be.Po,propertyName:"bandAreaShow",selector:u.selector},value:u.properties.bandAreaShow}).build()}),Y(g,Be.Po,u,r,a,[{type:"toggle",sliceName:"bandAreaMatchColor",propertyName:"bandAreaMatchColor"},{type:"color",sliceName:"bandAreaColor",propertyName:"bandAreaColor"},{type:"transparency",sliceName:"bandAreaTransparency",propertyName:"bandAreaTransparency"}])}),s.addGroup("tooltipTitle",function(g){g.withDisplayName("Visual_Forecast_Tooltip_Title").addSimpleSlice("titleText",new S.fq({descriptor:{objectName:Be.Po,propertyName:"displayName",selector:u.selector},value:u.properties.displayName,placeholder:""}).build(),function(y){return y.withCustomDisplayName("Visual_Title_Text")})}),(h=s.build()).analyticsPane=!0,[2,h]}})})},n.prototype.checkAddRemoveInstance=function(e,t,r){return e===Be.Po&&"show"===t.name&&(t.value?this.addInstance(r):be(e,t.selector,r,this.visualAuthoringService),!0)},n.prototype.saveGroupSlices=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return _.some(t,function(o){return o.objectName!==Be.Po})||e!==this.localizationService.get("Desktop_FileMenu_Options")?[2,!1]:[4,this.getSaveParameterValuesChange(Be.Po,t,r)];case 1:return i=a.sent(),t&&this.visualAuthoringService.persistProperties(i,r,!0),[2,!!t]}})})},n.prototype.hasParameterWithNonDefaultValue=function(e){var t=_.first(e[Be.Po]);if(!t)return!1;var r=t.properties.transform;if(!r)return!1;if(!_.isEmpty(r.parameters))for(var i=r.parameters,a=ci(),o=function(v){var h=_.find(a,function(f){return f.name===v.name});return b.fF.assertValue(h||v.name===ue.seasonality,"every forecast parameter should have a matching default value"),h?(0,gt.fS)(v.expr,h.expr)?void 0:{value:!0}:{value:v.name===ue.seasonality&&!!v.expr}},s=0,l=i||[];s<l.length;s++){var c=o(l[s]);if("object"==typeof c)return c.value}return!1},n.prototype.revertForecastSpecialDefinitions=function(e,t,r){if(t){var i=_.first(t[Be.Po]);if(i){if(_.some(r,function(c){return c.objectName===Be.Po&&"show"===c.propertyName}))return void be(Be.Po,i.selector,e,this.visualAuthoringService);for(var a=i.properties.transform,o=function(d){var v=d.propertyName;if(_.includes(Gr,v)){var h=_.findIndex(a?.parameters,function(m){return m.name===v});if(h>=0){var f=a.parameters[h];a.parameters[h]=Ji(f.name),(!a.parameters[h]||!f.expr)&&a.parameters.splice(h)}}},s=0,l=r;s<l.length;s++)o(l[s])}}},n.prototype.querySupportsForecasting=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return(0,Q.Xf)(e)?(t=this.getForecastBoundMeasure(e),_.isEmpty(t)?[2,!1]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())]):[2,!1];case 1:return r=a.sent(),i=(0,Q.oJ)(e),[2,_.every(i,function(o){return Pt.m.isExprValidForAnalysisTransform(o.expr)&&!o.expr.hasGroupOnKeys(r)})]}})})},n.prototype.addInstance=function(e){var t=ae(Be.Po,j.forecast.displayNameBaseKey,e,this.localizationService);b.fF.assert(function(){var o;return 1===(null===(o=t?.merge)||void 0===o?void 0:o.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item");var r=t.merge[0],i=r.selector;b.fF.assertValue(i,"forecast addInstance merge change should have a defined selector"),i.metadata=this.getForecastBoundMeasure(e);var a=ci();r.properties.transform={algorithm:"Forecast",parameters:a},this.telemetryService.logEvent(xe.Yu,{objectName:Be.Po}),this.visualAuthoringService.persistProperties(t,e,!0)},n.prototype.getSaveParameterValuesChange=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return _.isEmpty(t)?[2]:_.every(t,function(v){return _.includes(wt,v.propertySlice.name)})?[4,Ft(this.runningVisualService.getVisual(r).getAdapter(),e)]:[2];case 1:return o=d.sent(),_.isEmpty(o?.instances)?[2]:(b.fF.assert(function(){return 1===o.instances.length},e+" supports maximum 1 instance. If there is object enumeration, it should contain exactly 1 instance"),(l=ke(s=o.instances[0],r))?(u=[],_.forEach(_.values(wt),function(v){var h=_.find(t,function(y){return y.propertySlice.name===v}),f=h?function(n,e){return b.fF.assertValue(e,"sliceValue must be defined"),n===ue.units?ea(e):n===ue.confidenceInterval?ta(e):e}(v,h.propertySlice.value):nt(v,l);if(null!=f){var g=(0,fe.Lo)(f,Nr[v]);b.fF.assert(function(){return g instanceof De.Il&&(0,rt.VC)(g)},"encoded value for transform parameter should be a constant"),u.push({name:v,expr:g})}}),[2,{merge:[{objectName:Be.Po,selector:s.selector,properties:{transform:{algorithm:l.algorithm,parameters:u}}}]}]):[2])}})})},n.prototype.getPossibleUnits=function(e,t){var r=e.config.singleVisual,i=this.visualPluginService.capabilities(r.visualType),a=_.find(i.dataRoles,function(w){return 0===w.cartesianKind}),o=!1,s=!1;if(a){var l=r.query.defn,u=r.query.projections,c=a.name;if(!u[c])return;for(var v=function(V){var q=_.find(l.select(),function(N){return V.queryRef===N.name});b.fF.assertValue(q,"select in projections should be present in query");var F=q.expr.getMetadata(t);o=o||F.type.dateTime},h=0,f=u[c].all();h<f.length;h++)v(f[h]);s=(0,jt._T)(t,l,u,c)}var g=Kt.dt.members();if(o||s)return pi(g,this.localizationService);var y=_.find(g,function(w){return w.value===Kt.xm});return b.fF.assertValue(y,'"point" should be an available unit'),pi([y],this.localizationService)},n.prototype.getForecastBoundMeasure=function(e){var t,r,i=null===(r=null===(t=e.config)||void 0===t?void 0:t.singleVisual)||void 0===r?void 0:r.query;if(!i)return"";for(var o=function(v){if(1===v.cartesianKind){var h=i.defn.select(),f=i.tryGetExprs(v.name)||[];if(1!==_.size(f))return{value:""};var m=_.find(h,function(g){return(0,gt.fS)(f[0],g.expr)});if(m)return{value:m.name}}},s=0,l=(0,Q.d$)(e,this.visualPluginService)||[];s<l.length;s++){var c=o(l[s]);if("object"==typeof c)return c.value}return""},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Lt.y0),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function ci(){var n=_.map(Ur,function(e,t){return Ji(t)});return _.filter(n,function(e){return!!e})}function Ji(n){var e=Ur[n],t=e;if(null!=t){n===ue.units?t=ea(e):n===ue.confidenceInterval&&(t=ta(e));var i=(0,fe.Lo)(t,Nr[n]);return b.fF.assert(function(){return i instanceof De.Il&&(0,rt.VC)(i)},"encoded value for transform parameter should be a constant"),{name:n,expr:i}}}function Vr(n,e){var t=nt(n,e);return null==t?Ur[n]:n===ue.units?function(n){return _.findKey(ui,function(e){return e===n})}(t):n===ue.confidenceInterval?function(n){return 100*n+"%"}(t):t}function ea(n){return ui[n]}function ta(n){return parseFloat(n)/100}function pi(n,e){return _.map(n,function(t){return{value:t.value,displayName:(0,Ne.G)(t.displayName,e)}})}var _e,Me,Ee=C(57871);!function(n){n.MinContainerWidth=Ee.A6,n.MinContainerHeight=Ee.Q$,n.MaxPrecision=15,n.SliceNameAxisStart="axisStart",n.SliceNameAxisEnd="axisEnd",n.SliceNameStart="start",n.SliceNameEnd="end",n.SliceNameInvertAxis="invertAxis",n.SliceNameSecStart="secStart",n.SliceNameSecEnd="secEnd",n.SliceNameSecInvertAxis="secInvertAxis",n.PlotAreaCardName="plotArea",n.ImageSliceName="image",n.MapSliceName="map",n.ImageFitSliceName="scaling",n.TransparencySliceName="transparency"}(_e||(_e={})),function(n){n.DisplayAreaName="displayArea",n.PageRefreshCardName="pageRefresh",n.PageSizeCardName="pageSize",n.PageSizeTypeName="pageSizeTypes",n.PageSizeWidthName="pageSizeWidth",n.PageSizeHeightName="pageSizeHeight",n.PageBackgroundColor="color",n.PageInformationCardName="pageInformation",n.PageInformationName="pageInformationName",n.PageInformationQnaPodEnabled="pageInformationQnaPodEnabled",n.PageInformationAltName="pageInformationAltName",n.PageInformationType="pageInformationType",n.PageBackgroundImage="image",n.PageBackgroundTransparency="transparency",n.PageBackgroundRevertToDefault="revertToDefault",n.PageBackgroundCardName="background",n.OutspaceBackgroundCardName="outspace",n.OutspacePaneCardName="outspacePane",n.FilterCardName="filterCard",n.PageSizeUnits={Pixels:"px"},n.PersonalizeVisual="personalizeVisual"}(Me||(Me={}));var nr,or,vi=C(3579),se=C(2529),yr=C(57521),ra=C(32379),Wr=C(13702),Bt=["Min","Max","Average","Median","Percentile"],Hr=["ConstantX","ConstantY1"],ia=((nr={}).Min=function(n){return(0,De.m_)(n,3)},nr.Max=function(n){return(0,De.m_)(n,4)},nr.Average=function(n){return(0,De.m_)(n,1)},nr.Median=function(n){return(0,De.m_)(n,6)},nr.Percentile=function(n,e){var t=parseFloat(e);return t=_.isNaN(t)?0:Math.min(Math.max(0,t),100),(0,De.Pe)(n,t/100,!1)},nr),Dn=[se.tZ,se.KZ,se.oB,se.FK,se.yl,se.Zs,se.nR,se.G5,se.UD,se.XI,se.pw],aa=((or={}).Min="Visual_Min_Reference_Line",or.Max="Visual_Max_Reference_Line",or.Average="Visual_Average_Reference_Line",or.Median="Visual_Median_Reference_Line",or.Percentile="Visual_Percentile_Reference_Line",or),Et=te,Kr=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSourcesService=t,this.displayNameService=r,this.featureSwitchService=i,this.localizationService=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l,this.visualToUserUnknownLineInstancesMap={}}return n.prototype.getReferenceLineInstancesInfo=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getReferenceAndConstantLinesInfo(e,t,r,!1)];case 1:return[2,a.sent()]}})})},n.prototype.getReferenceAndConstantLinesInfo=function(e,t,r,i){var a;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,V,q,F,T,P,O,E,L,B,A;return(0,p.__generator)(this,function(z){switch(z.label){case 0:return r.objects?(o=(0,Q.GQ)(e),s=(0,Q.oJ)(e),l=!1,u={},v=!1,h=!1,r.objects[Et]?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:[3,3]):[2];case 1:return f=z.sent(),d=I(e,f,this.displayNameService,this.visualPluginService),_.isEmpty(d)?[3,3]:[4,ua(t,Et)];case 2:c=z.sent(),(l=!_.isEmpty(c))&&(m=function(n,e){for(var t=!1,r=!1,i=0,a=e||[];i<a.length;i++){var s=a[i].selectExpr.expr.getTargetSchemaName(),l=n.schema(s),u=l?.capabilities;if(u?.supportsMedian&&(t=!0),u?.supportsPercentile&&(r=!0),t&&r)break}return{supportsMedian:t,supportsPercentile:r}}(f,d),v=m.supportsMedian,h=m.supportsPercentile,u=null!==(a=_.chain(c).map(function(R){return oa(R,!R.properties[se.$Z],o,s)}).groupBy(function(R){return R.type}).value())&&void 0!==a?a:{}),z.label=3;case 3:g=!1,y=!1,V=function(G){var ne,oe,ee;return(0,p.__generator)(this,function(le){switch(le.label){case 0:return ne=Mt(G),r.objects[ne]?[4,ua(t,ne)]:[3,2];case 1:oe=le.sent(),ee=!_.isEmpty(oe),"ConstantX"===G?g=ee:y=ee,ee&&(u[G]=_.map(oe,function(Fe){return{visualObjectInstance:Fe,isDefaultInstance:!Fe.properties[se.$Z],type:G}})),le.label=2;case 2:return[2]}})},q=0,F=i?Hr:[],z.label=4;case 4:return q<F.length?[5,V(F[q])]:[3,7];case 5:z.sent(),z.label=6;case 6:return q++,[3,4];case 7:if(!l&&!g&&!y)return[2];for(T=[],O=0,E=(0,p.__spreadArray)((0,p.__spreadArray)([],Hr,!0),Bt,!0);O<E.length;O++)("ConstantX"!==(L=E[O])||g)&&("ConstantY1"===L&&!y||_.includes(Bt,L)&&!l||"Median"===L&&!v||"Percentile"===L&&!h||(B=u[L],_.isEmpty(B)&&_.includes(Bt,L)&&(P||(P=_.find(u[he],function(R){return R.isDefaultInstance})),P||(P=oa(c[0],!0,o,s)),(A=_.cloneDeep(P)).type=L,B=[A]),T.push([L,B])));return b.fF.assert(function(){return _.every(T,function(R){return _.size(R[1])>=1})},"We should return at least 1 instance for each of the supported reference or constant reference line types, if no real instance, then return a default one."),[2,{groupedInstances:T,validMeasures:d}]}})})},n.prototype.createReferenceLineCard=function(e,t,r,i,a,o){var s=this,l=new S.lg(e),u=function(h){return s.localizationService.get(h)},c=[],d=new S.CQ(l,t,void 0,u,!1).addGroup(void 0,function(v){for(var h={uid:e+"-container",containerItems:[],displayName:s.localizationService.get("Apply_Settings_To"),isEditable:!0},f=0,m=r??[];f<m.length;f++){var g=m[f],y=g.type,w=la(y),V=na(g),q=g.visualObjectInstance.selector,F={displayName:V,groups:[],uid:"".concat(y,"-").concat(q?.id||he)};h.containerItems.push(F);var N={objectName:Mt(y),propertyName:void 0,propertyTypes:void 0,selector:q,altConstantValueSelector:g.visualObjectInstance.altConstantValueSelector},T=q?.id.includes(he),P=T||g.isDefaultInstance;if(o){var O={value:he,displayName:s.localizationService.get("Choose_A_Type")},E=Nn(l,w,y,O,o,N,u);P&&!T&&(E.group.disabled=!0),F.groups.push(E.group),c.push.apply(c,E.descriptors)}var L=Vn(l,y,g,a,N,w,u);L&&(P&&(L.group.disabled=!0),F.groups.push(L.group),c.push.apply(c,L.descriptors));var B=Tn.call(s,l,y,g,i,N,w,u);P&&(B.group.disabled=!0),F.groups.push(B.group),c.push.apply(c,B.descriptors);var A=Pn(l,y,g,i,N,s.localizationService,u);A&&(P&&(A.group.disabled=!0),F.groups.push(A.group),c.push.apply(c,A.descriptors));var z=In(l,g,i,N,u);P&&(z.group.disabled=!0),F.groups.push(z.group),c.push.apply(c,z.descriptors)}v.withContainer(h)}).build();return d.analyticsPane=!0,d.revertToDefaultDescriptors=c,d},n.prototype.enumerateReferenceAndConstantLineCards=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getReferenceAndConstantLinesInfo(e,t,r,!0)];case 1:return i=a.sent(),_.isEmpty(i?.groupedInstances)?[2]:this.featureSwitchService.featureSwitches.onObject?[4,this.enumerateReferenceAndConstantLineCardsV2(e,i,r)]:[3,3];case 2:case 4:return[2,a.sent()];case 3:return[4,this.enumerateReferenceAndConstantLineCardsV1(e,i,r)]}})})},n.prototype.checkAddRemoveRenameInstance=function(e,t,r){var i,a,o;return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,c,d,v,h,f,m,y,w,V,q,F,N;return(0,p.__generator)(this,function(T){switch(T.label){case 0:if("editable-container-object-name"!==e)return[2,!1];if(l=t.value,b.fF.assert(function(){var P,O,E;return(_.isEmpty(null===(P=l.itemUpdates)||void 0===P?void 0:P.adds)?0:_.size(l.itemUpdates.adds))+(_.isEmpty(null===(O=l.itemUpdates)||void 0===O?void 0:O.deletes)?0:_.size(l.itemUpdates.deletes))+(_.isEmpty(null===(E=l.itemUpdates)||void 0===E?void 0:E.renames)?0:_.size(l.itemUpdates.renames))<=1},"Expect only one add/delete/rename at a time"),_.isEmpty(null===(i=l.itemUpdates)||void 0===i?void 0:i.adds))return[3,2];if(u=void 0,(c=_.findKey(pt,function(P){return _.includes(t.name,P)}))?u=c:_.includes(t.name,j.xAxisReferenceLine.objectName)?u="ConstantX":_.includes(t.name,j.y1AxisReferenceLine.objectName)&&(u="ConstantY1"),null==u){V=this.visualToUserUnknownLineInstancesMap[d=r.name]||[],v=_.map(V,function(P){return P.displayName}),h=0,f=void 0;do{h++,f=this.localizationService.format("UserUnknown_Line_Format",[h])}while(_.includes(v,f));return m={id:"".concat(he,"-").concat(h)},V.push({displayName:f,selector:m}),this.visualToUserUnknownLineInstancesMap[d]=V,[2,!0]}return[4,this.addLineInstance(u,r)];case 1:return T.sent(),[2,!0];case 2:return(y=_.first(null===(a=l.itemUpdates)||void 0===a?void 0:a.deletes))?(s=ca(y))===he?(this.removeUserUnknownLine(r.name,y.displayName),[2,!0]):(N=Mt(s),[2,this.deleteInstance(N,r,y.displayName)]):(w=_.first(null===(o=l.itemUpdates)||void 0===o?void 0:o.renames))?(s=ca(w.item))===he?(V=this.visualToUserUnknownLineInstancesMap[r.name],q=_.find(V,function(P){return P.displayName===w.item.displayName}),F=(0,Ne.G)(w.newDisplayName,this.localizationService),q.displayName=F,[2,!0]):(N=Mt(s),[2,this.renameInstance(N,r,w)]):[2,!1]}})})},n.prototype.tryHandleReferenceLineSpecialSave=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,s,l;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return e===j.xAxisReferenceLine.objectName&&t.name===se.rS&&_.isBoolean(t.value)?(void 0,i=t.value?_.find(yr.dt.members(),function(c){return c.value!==yr.YP}).value:yr.YP,(s={objectName:e,selector:t.selector,properties:{}}).properties[t.name]=i,[2,{isHandled:!0,persistChanges:{merge:[s]}}]):(a=_.findKey(pt,function(c){return c===e}))&&(t.name===de||t.name===ye)&&t.selector?(s=function(n,e,t){var r=e.name===de,i=e.name===ye;if(b.fF.assert(function(){return r||i},"Expect the given slice to be for changing measure selection or changing percentile value"),r||i){var o,a=r?e.value:e.selector.metadata;if(b.fF.assertValue(a,"The slice is for measure or percentile, in either case it should have an associated measure"),i)o=e.value;else if("Percentile"===n&&r){var s=(0,Q.GQ)(t),l=_.find(s[te],function(u){return(0,ra.fS)(u.selector,e.selector)});b.fF.assertValue(l,"It is changing measure selection of a percentile line, expect the given visual has a matching percentile object"),o=l?(100*l.properties.value.k).toString():"90"}return sa(n,e.selector,r,a,o,t)}}(a,t,r),[2,{isHandled:!0,persistChanges:{merge:[s]}}]):t.name!==ge?[3,2]:[4,this.tryGetLineTypeChange(e,t,r)];case 1:return l=u.sent(),[2,{isHandled:!0,persistChanges:l?.persistChanges,newPropertyChanges:l?.newPropertyChanges}];case 2:return[2,{isHandled:!1}]}})})},n.prototype.tryGetLineTypeChange=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,c,d,v,h,f,m,g,y,w,V;return(0,p.__generator)(this,function(F){switch(F.label){case 0:return t.selector.id.startsWith(he)?(i=_.find(this.visualToUserUnknownLineInstancesMap[r.name],function(N){return N.selector.id===t.selector.id}),this.removeUserUnknownLine(r.name,a=i.displayName),o=this.localizationService.get("UserUnknown_Line_Format"),s=new RegExp("^".concat(o," \\d+$")).test(a),[4,this.getAddLineInstanceChanges(t.value,r,s?void 0:a)]):[3,2];case 1:return[2,{persistChanges:{merge:F.sent()}}];case 2:return"xAxisReferenceLine"===e?c="ConstantX":"y1AxisReferenceLine"===e?c="ConstantY1":(d=_.findKey(pt,function(N){return _.includes(e,N)}),c=d),(v=t.value)===c?[2,{}]:(h=(0,Q.GQ)(r),f=Mt(c),m=_.find(h[f],function(N){return N.selector.id===t.selector.id}),g=this.checkDefaultDisplayName(c,m,r),y=_.includes(Hr,c),w=_.includes(Hr,v),y||w?[4,this.getModifyCrossObjectLineTypeChange(m,r,c,v,g)]:[3,4]);case 3:return[2,{persistChanges:(V=F.sent()).persistChanges,newPropertyChanges:V.newPropertyChanges}];case 4:return[2,{persistChanges:{merge:[this.getModifyReferenceLineTypeChange(t.selector,v,g,r)]}}]}})})},n.prototype.getModifyReferenceLineTypeChange=function(e,t,r,i){b.fF.assertValue(e,"Expect selector to be defined");var a=e.metadata;b.fF.assertValue(a,"Expect measureName to be defined");var o={objectName:Et,selector:e,properties:{}},s="Percentile"===t?"90":void 0,u=(0,ia[t])((0,De.xA)(a),s);if(o.properties.value=u,r){var c=this.getLineDisplayName(t,i);o.properties.displayName=Oe(Mt(t),i,c,this.localizationService)}return o},n.prototype.getModifyCrossObjectLineTypeChange=function(e,t,r,i,a){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return o=Mt(r),s=Qr(e),l=Ie(o,e.selector),[4,this.getAddLineInstanceChanges(i,t,a?void 0:s)];case 1:return u=m.sent(),d=e.properties,v=[],_.forEach(Object.keys(d),function(g){Dn.includes(g)&&v.push({propertyName:g,value:d[g]})}),h={merge:u,removeObject:[l]},_.isEmpty(v)?[2,{persistChanges:h}]:(f={objectName:Mt(i),selector:u[0].selector,properties:{}},_.forEach(v,function(g){f.properties[g.propertyName]=g.value}),[2,{persistChanges:h,newPropertyChanges:f}])}})})},n.prototype.getAddLineInstanceChanges=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return i=Mt(e),a=this.getLineDisplayName(e,t),o=Se(i,a,t,this.localizationService),b.fF.assert(function(){var v;return 1===(null===(v=o?.merge)||void 0===v?void 0:v.length)},"getAddInstanceChangeBase should return a changes that contains one and only one merge item"),r&&(o.merge[0].properties.displayName=r),_.includes(Bt,e)?(b.fF.assertValue(s=o.merge[0].selector,"referenceLine addInstance merge change should have a defined selector"),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:l=d.sent(),u=I(t,l,this.displayNameService,this.visualPluginService),_.isEmpty(u)||(c=sa(e,s,!0,u[0].value,"Percentile"===e?"90":void 0,t))&&o.merge.push(c),d.label=2;case 2:return this.telemetryService.logEvent(xe.Yu,{objectName:e}),[2,o.merge]}})})},n.prototype.removeUserUnknownLine=function(e,t){var r=this.visualToUserUnknownLineInstancesMap[e];r=_.filter(r,function(i){return i.displayName!==t}),this.visualToUserUnknownLineInstancesMap[e]=r},n.prototype.addLineInstance=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,this.getAddLineInstanceChanges(e,t)];case 1:return r=i.sent(),this.visualAuthoringService.persistProperties({merge:r},t,!0),[2]}})})},n.prototype.deleteInstance=function(e,t,r){var i=(0,Q.GQ)(t),a=_.find(i[e],function(o){return Qr(o)===r});return!!a&&(be(e,a.selector,t,this.visualAuthoringService),!0)},n.prototype.renameInstance=function(e,t,r){var i=(0,Q.GQ)(t),a=_.find(i[e],function(l){return Qr(l)===r.item.displayName});return!!a&&(this.visualAuthoringService.persistProperties({merge:[{objectName:e,selector:a.selector,properties:{displayName:r.newDisplayName}}]},t,!0),!0)},n.prototype.enumerateReferenceAndConstantLineCardsV2=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f,m,g,V=this;return(0,p.__generator)(this,function(q){return _.isEmpty(t?.groupedInstances)?[2]:(i=_.map(t.groupedInstances,function(F){return F[0]}),a=_.map(i,function(F){return{value:F,displayName:V.getLineDisplayName(F,e)}}),o=this.localizationService.get("ReferenceLine"),s=[],_.forEach(t.groupedInstances,function(F){return s.push.apply(s,F[1])}),l=_.filter(s,function(F){return!F.isDefaultInstance}),u=this.visualToUserUnknownLineInstancesMap[e.name],c=_.size(l),d=_.size(u),v=c+d,h=_.sortBy(l,function(F){return na(F)}),f=[],_.forEach(u,function(F){var N,T={visualObjectInstance:{objectName:"referenceLine",properties:(N={},N[se.ss]=F.displayName,N),selector:F.selector},isDefaultInstance:!1,type:he};f.push(T)}),h.push.apply(h,_.sortBy(f,function(F){return F.visualObjectInstance.properties.displayName})),0===v&&((m=(0,p.__assign)({},s[0])).type=he,h.push(m)),g=v>0?this.localizationService.format("NamePattern_Bracket",[o,v]):o,[2,[this.createReferenceLineCard("referenceLine",g,h,r,t.validMeasures,a)]])})})},n.prototype.enumerateReferenceAndConstantLineCardsV1=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f;return(0,p.__generator)(this,function(m){for(i=[],a=0,o=t.groupedInstances;a<o.length;a++)l=(s=o[a])[0],u=s[1],!_.isEmpty(u)&&(c=this.getLineDisplayName(l,e),d=_.size(_.filter(u,function(g){return!g.isDefaultInstance})),v=d>0?this.localizationService.format("NamePattern_Bracket",[c,d]):c,h=An(l),f=this.createReferenceLineCard(h,v,u,r,t.validMeasures),i.push(f));return[2,i]})})},n.prototype.getLineDisplayName=function(e,t){var r;if("ConstantX"===e||"ConstantY1"===e){var i=Mt(e),a=(0,vi.s)(t),o=this.visualPluginService.capabilities(a);return(null===(r=o.objects[i])||void 0===r?void 0:r.displayName)?(0,Ne.G)(o.objects[i].displayName,this.localizationService):this.localizationService.get("ConstantX"===e?"Visual_Reference_Line_X":"Visual_Reference_Line_Y")}if(_.includes(Bt,e))return this.localizationService.get(aa[e]);b.fF.assertFail("should always return a displayName key")},n.prototype.checkDefaultDisplayName=function(e,t,r){var i=Qr(t).toLocaleLowerCase(),a=this.getLineDisplayName(e,r).toLocaleLowerCase();return new RegExp("^".concat(a," \\d+$")).test(i)},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(Wr.O),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(Lt.y0),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function Qr(n){return De.jz.getTextValue(n.properties[se.ss])}function na(n){return n.visualObjectInstance.properties.displayName}function hi(n){return la(n)}function Nn(n,e,t,r,i,a,o){return{group:new S.mQ(new S.SS(n,"type"),o).addSimpleSlice(ge,function(){var l=t!==he?_.find(i,function(u){return u.value===t}):r;return new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},a),{objectName:e,propertyName:ge}),items:i,value:l}).build()},function(l){l.withCustomDisplayName("Type")}).build(),descriptors:[{objectName:e,propertyName:ge}]}}function Vn(n,e,t,r,i,a,o){if(_.includes(Bt,e)){var s=t.visualObjectInstance.propertyTypes;return{group:new S.mQ(new S.SS(n,"measure"),o).withDisplayName("Series").addSimpleSlice(de,function(){var u=t.isDefaultInstance?r[0]:_.find(r,function(c){return c.value===t.measureName});return new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},i),{objectName:a,propertyTypes:s?s[de]:void 0,propertyName:de}),items:r,value:u}).build()},function(u){u.withCustomDisplayName("Series")}).build(),descriptors:[{objectName:a,propertyName:de}]}}}function Tn(n,e,t,r,i,a,o){var s,l,u=[],c=t.visualObjectInstance,d=c.propertyTypes,v=new S.mQ(new S.SS(n,"line"),o).withDisplayName("Visual_Shape_Line");!t.isDefaultInstance&&"Percentile"===e&&v.addSimpleSlice(ye,function(){return b.fF.assert(function(){return null!=t.percentileValue},"percentileValue should be calculated already"),S.JN.getTransparencySliderBuilder({descriptor:(0,p.__assign)((0,p.__assign)({},i),{objectName:a,propertyTypes:d?d[de]:void 0,propertyName:ye}),value:t.percentileValue,localize:o}).build()},function(V){V.withCustomDisplayName("Visual_Reference_Line_Percentile")}),u.push({objectName:a,propertyName:ye});var h=se.S3,f=(0,p.__assign)((0,p.__assign)({},i),{propertyTypes:d?d[h]:void 0,propertyName:se.S3,instanceKind:c.propertyInstanceKind&&c.propertyInstanceKind[se.S3]});"ConstantX"===e&&(v.addSimpleSlice(se.S3,function(){return d&&d[h]&&d[h].dateTime?new S.hz({descriptor:f,value:c.properties[h],placeholder:""}).build():new S.fq({descriptor:f,value:c.properties[h],placeholder:""}).build()}),u.push({objectName:f.objectName,propertyName:f.propertyName})),"ConstantY1"===e&&(v.addSimpleSlice(se.S3,function(){return new S.fq({descriptor:f,value:c.properties[se.S3],placeholder:""}).build()}),u.push({objectName:f.objectName,propertyName:f.propertyName}));var m=c.objectName;if(r.objects[m]){var g=(0,He.pN)(c.objectName,He.vi),y=(0,pe.Iq)({containerItemBuilder:v,descriptors:g,strokeData:(0,pe.AF)(c.properties,He.vi,tt.xs,null===(l=null===(s=c.properties.lineColor)||void 0===s?void 0:s.solid)||void 0===l?void 0:l.color),selector:c.selector,featureSwitches:this.featureSwitchService.featureSwitches,localize:o,isSVGStroke:!0});v.addSlices(y.map(function(V){return V.build()})),u.push.apply(u,Object.values(g));var w=[{type:"enumeration",sliceName:"position",propertyName:se.FK}];Y(v,m,c,r,o,w),u.push.apply(u,_.map(w,function(V){return{objectName:m,propertyName:V.propertyName}}))}return{group:v.build(),descriptors:u}}function Pn(n,e,t,r,i,a,o){var s,l=t.visualObjectInstance;if("ConstantX"===e&&l.properties.hasOwnProperty(se.rS)&&_.has(r.objects[i.objectName].properties,se.rS)){var u=new S.mQ(new S.SS(n,"shadeArea"),o),c=_.find(yr.dt.members(),function(y){return y.value===yr.YP}),v=l.properties[se.rS]!==c.value;u.withDisplayName("Visual_Shapes_ShadeArea").addTopLevelToggle("shadeAreaShow",function(){return new S.bd({descriptor:(0,p.__assign)((0,p.__assign)({},i),{propertyName:se.rS}),value:v}).build()});var h=_.chain(yr.dt.members()).filter(function(y){return y.value!==c.value}).map(function(y){return{value:y.value,displayName:(0,Ne.G)(y.displayName,a)}}).value(),f=l;v||((f=(0,p.__assign)({},l)).properties=(0,p.__assign)({},l.properties),f.properties[se.rS]=null===(s=_.first(h))||void 0===s?void 0:s.value,_.has(f.properties,se.HO)||(f.properties[se.HO]={solid:{color:"#000"}}),_.has(f.properties,se.af)||(f.properties[se.af]=0));var m=f.properties[se.rS];u.addSimpleSlice("shadePosition",function(){return new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},i),{propertyName:se.rS}),items:h,value:_.find(h,function(y){return y.value===m})}).build()},function(y){y.withCustomDisplayName("Visual_Position")}),Y(u,f.objectName,f,r,o,[{type:"color",sliceName:"shadeColor",propertyName:se.HO,customDisplayNameKey:"Generic_Color"},{type:"transparency",sliceName:"shadeTransparency",propertyName:se.af,customDisplayNameKey:"Transparency"}]);var g=[];return g.push({objectName:i.objectName,propertyName:se.rS}),g.push({objectName:l.objectName,propertyName:se.HO}),g.push({objectName:l.objectName,propertyName:se.af}),{group:u.build(),descriptors:g}}}function In(n,e,t,r,i){var a=[],o=new S.mQ(new S.SS(n,"dataLabel"),i),s=e.visualObjectInstance,l=s.properties.dataLabelShow;o.withDisplayName("Visual_Reference_Line_Data_Label").addTopLevelToggle("dataLabelShow",function(){return new S.bd({descriptor:(0,p.__assign)((0,p.__assign)({},r),{propertyName:se.yl}),value:l}).build()}),a.push({objectName:r.objectName,propertyName:se.yl});var u=[{type:"enumeration",sliceName:"dataLabelHorizontalPosition",propertyName:se.nR},{type:"enumeration",sliceName:"dataLabelVerticalPosition",propertyName:se.G5},{type:"enumeration",sliceName:"dataLabelText",propertyName:se.Zs,customDisplayNameKey:"Style"},{type:"color",sliceName:"dataLabelColor",propertyName:se.UD},{type:"enumeration",sliceName:"dataLabelDisplayUnits",propertyName:se.XI},{type:"numUpDown",sliceName:"dataLabelDecimalPoints",propertyName:se.pw,options:{min:0,max:_e.MaxPrecision,placeholderTextKey:"Visual_Auto"}}],c=s.objectName;l?Y(o,c,s,t,i,u):o.addSimpleSlice("dataLabelNotAvailableMessage",function(){return new S.G_({descriptor:{objectName:c,selector:s.selector,propertyName:void 0},value:i("AnalyticsPane_DataLabelGroup_NotAvailable_Message")}).build()}),a.push.apply(a,_.map(u,function(v){return{objectName:c,propertyName:v.propertyName}}));var d=o.build();return l||(d.slices[0].disabled=!0),{group:d,descriptors:a}}function oa(n,e,t,r){b.fF.assertValue(n,"instance must be defined");var i=(0,fe.NA)(t,{objectName:Et,propertyName:se.S3},n.selector),a=n;e&&((a=_.cloneDeep(n)).properties||(a.properties={}),a.properties[se.$Z]=!1,a.properties[se.ss]="",a.properties[se.yl]=!1,a.selector=null);var o=i;if(!o||!(0,rt.iV)(o)&&!(0,rt.T5)(o))return{visualObjectInstance:a,isDefaultInstance:e,type:void 0};var s=o.arg;if(!s)return{visualObjectInstance:a,isDefaultInstance:e,type:void 0};var c,d,l=r.withName(s.expressionName),u=l?l.name:void 0;return!e&&(0,rt.T5)(o)?(c=100*o.k,d="Percentile"):(0,rt.X5)(o)?d="Min":(0,rt.lg)(o)?d="Max":(0,rt.Xx)(o)?d="Median":(0,rt.Ny)(o)&&(d="Average"),{visualObjectInstance:a,isDefaultInstance:e,type:d,measureName:u,percentileValue:c}}function sa(n,e,t,r,i,a){b.fF.assert(function(){return null!=n},"Expect referenceLineType to be defined"),b.fF.assertValue(e,"Expect selector to be defined"),b.fF.assertValue(r,"Expect measureName to be defined"),b.fF.assertAnyValue(i,"");var o={objectName:Et,selector:e,properties:{}};if(!t||o.selector.metadata!==r){if(o.selector.metadata!==r){var s=(0,Q.GQ)(a);s&&(0,fe.xl)(s,Et,o.selector,{id:o.selector.id,metadata:r}),o.selector.metadata=r}var u=(0,ia[n])((0,De.xA)(r),i);return o.properties.value=u,o}}function Mt(n){return"ConstantX"===n?j.xAxisReferenceLine.objectName:"ConstantY1"===n?j.y1AxisReferenceLine.objectName:_.includes(Bt,n)?Et:n===he?Et+"-default":void b.fF.assertFail("should always return an objectName")}function la(n){return"ConstantX"===n?j.xAxisReferenceLine.objectName:"ConstantY1"===n?j.y1AxisReferenceLine.objectName:_.includes(Bt,n)?pt[n]:n===he?Et+"-default":void b.fF.assertFail("should always return an objectName")}function An(n){if("ConstantX"===n)return"xAxisReferenceLine";if("ConstantY1"===n)return"y1AxisReferenceLine";if(_.includes(Bt,n)){if("Min"===n)return"referenceLine-minLine";if("Max"===n)return"referenceLine-maxLine";if("Average"===n)return"referenceLine-averageLine";if("Median"===n)return"referenceLine-medianLine";if("Percentile"===n)return"referenceLine-percentileLine"}b.fF.assertFail("should always return card name")}function ua(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,Ft(n,e)];case 1:return(t=i.sent())?(r=Ze.G.normalize(t),[2,r?.instances]):[2]}})})}function ca(n){return n.uid.split("-")[0]}var J=C(9215),fi=C(92783),mi=new D.InjectionToken("FormattingObjectDefinitionsService"),jn=C(6426),sr=C(93599),ce=C(78432),Ve=C(24408),ut=C(50550),Xt=C(28488),St=C(80777),$r=C(54766),U=C(67746),pa=C(84631),va=C(26902),Ae=C(20590),gi=C(40812),yi=C(10746),Si=function(){function n(e,t,r){this.conceptualSchemaProxy=e,this.featureSwitchService=t,this.localizationService=r}return n.prototype.populateConditionalFormattingCard=function(e,t){b.fF.assertValue(t,"populateConditionaFormattingCard: empty options"),b.fF.assertValue(t.enumerateObjectRepetition,"populateConditionaFormattingCard: null options.enumerateObjectRepetition");var r=t.enumerateObjectRepetition();if(!_.isEmpty(r)){var i=U.T9,a=(0,Ae.Gf)((0,Ne.V)("PropertyPane_ConditionalFormatting_CardTitle"),this.localizationService),o=e.cards.withName(i);o||(o={name:i,id:Ve.Yb(t.visualType,i),index:t.cardIndexCounter,displayName:a,slices:(0,ut.bv)(),footer:[],mainShow:null,isDirty:!1},this.addConditionalFormattingContainers(o,r,t).then(function(){Ve.ht(t,o),e.cards.push(o)}))}},n.prototype.addConditionalFormattingContainers=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l;return(0,p.__generator)(this,function(c){switch(c.label){case 0:b.fF.assertValue(e,"populateConditionalFormattingContainers: card"),b.fF.assertNonEmpty(t,"populateConditionalFormattingContainers: repetitions"),b.fF.assertValue(r,"populateConditionalFormattingContainers: options"),b.fF.assertValue(r.objectDescriptors,"populateConditionalFormattingContainers: options.objectDescriptors"),i=(0,gi.sd)(t,r.objectDescriptors),a=function(v){var h,f,m,g,y;return(0,p.__generator)(this,function(w){switch(w.label){case 0:return h=v.selector,(f=v.containerName)?(e.containers||(e.containers=(0,ut.bv)()),(m=_.find(e.containers,function(V){return V.displayName===f}))||(y=Ve.Yl(e.name,g=e.containers.length),m={name:y,displayName:f,value:y,selector:h,containerIndex:g,isDisabled:!1,slices:(0,ut.bv)()},e.containers.push(m)),[4,o.addConditionalFormattingSlices(r,m,v)]):[2,"continue"];case 1:return w.sent(),[2]}})},o=this,s=0,l=i,c.label=1;case 1:return s<l.length?[5,a(l[s])]:[3,4];case 2:c.sent(),c.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},n.prototype.addConditionalFormattingSlices=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return[4,this.getConditionalFormattingSliceProperties({conceptualSchemaProxy:this.conceptualSchemaProxy,conditionalFormattingDialogLauncherFactory:e.conditionalFormattingDialogLauncherFactory,dataBarsDialogLauncherFactory:e.dataBarsDialogLauncherFactory,dataSourcesService:e.dataSourcesService,featureSwitchService:this.featureSwitchService,visualAuthoring:e.visualAuthoring},e.visualContainer,e.objectDefinitions,t.displayName,e.visualStyle,r)];case 1:return a=u.sent(),s=a.isApplied,t.slices.push({name:r.propertyId.propertyName,displayName:(o=a.toggleButton).displayName,description:o.description,type:{bool:!0},selector:r.selector,value:o.value,show:!0,placeholder:o.description,isValid:!0,isDisabled:!1,save:function(d,v,h,f,m,g,y){return o.saveCallback(d,v,h,m,g,y)},suppressUndoRedoRegister:!0}),s&&t.slices.push({name:"dialogLauncher",displayName:s.displayName,type:void 0,value:s.value,show:!0,placeholder:s.placeholder,isValid:!0,isDisabled:!1,save:void 0}),[2]}})})},n.prototype.getConditionalFormattingSliceProperties=function(e,t,r,i,a,o){var s=this;b.fF.assertValue(e,"getConditionalFormattingSliceProperties: services"),b.fF.assertValue(o,"getConditionalFormattingSliceProperties: repetitionMetadata");var l=o.selector;b.fF.assertValue(l,"getConditionalFormattingSliceProperties: selector"),b.fF.assertValue(l.metadata,"getConditionalFormattingSliceProperties: selector.metadata"),b.fF.assertValue(o.propertyId,"getConditionalFormattingSliceProperties: propertyId");var u=o.propertyDescriptor;b.fF.assertValue(o.propertyDescriptor,"getConditionalFormattingSliceProperties: propertyDescriptor");var c=e.conceptualSchemaProxy,d=e.dataSourcesService;b.fF.assertValue(c,"getConditionalFormattingSliceProperties: conceptualSchemaProxy"),b.fF.assertValue(d,"getConditionalFormattingSliceProperties: dataSourcesService");var v=t&&t.config&&t.config.singleVisual&&t.config.singleVisual.query;b.fF.assertValue(v,"getConditionalFormattingSliceProperties: non-query Visual");var h=v.defn.select().withName(l.metadata);if(h){var f,T,P,E,m=e.featureSwitchService.featureSwitches,g=u.type,y=g.fill,w=g.icon,V=u.type.misc,q=m?.conditionalTablixWebURL,F=q&&!!V&&V.webUrl,N=g.dataBars&&m?.dataBarsUpdate;if(y||w||F||N){var O=(0,gi.OT)(r,o);f=void 0!==O,P=function(){return(0,p.__awaiter)(s,void 0,void 0,function(){var B,A,z,R;return(0,p.__generator)(this,function(G){switch(G.label){case 0:return[4,e.conditionalFormattingDialogLauncherFactory()];case 1:return B=G.sent(),[4,this.showConditionalFormattingDialog(t,B,i,h.expr,o,O,a)];case 2:return(A=G.sent())&&(z=(0,$r.PU)(A.propertyDefinition,o.propertyDescriptor,!1),R=(0,$r.L1)(A.selector),e.visualAuthoring.setPropertyDefinition(t,o.propertyId,o.selector,z,R)),[2]}})})},T=function(B,A,z){return(0,p.__awaiter)(s,void 0,void 0,function(){var R,G,ne,oe,ee,le;return(0,p.__generator)(this,function(Fe){switch(Fe.label){case 0:return(0,J.Vz)(z)?(R=e.featureSwitchService.featureSwitches.useModernFormatPane,G=A.value,ne=d.get(),[4,c.get(ne)]):[2];case 1:return oe=Fe.sent(),ee=h.expr.getMetadata(oe),le=ee&&1===ee.kind&&ee.type.numeric,N?(this.toggleDataBars(z,A.value,o,e),[2]):(!1===G||(y||w)&&le?this.toggleConditionalFormatting(z,G,o,e.visualAuthoring):P().then(function(){void 0===(0,gi.OT)(r,o)&&!R&&(A.value=!1)}),[2])}})})}}else{if(!g.dataBars)return void b.fF.assertFail("addConditionalFormattingSlices: Unexpected property type ("+JSON.stringify(g)+")");f=(0,va.dw)(r,o),T=function(B,A,z){(0,J.Vz)(z)&&s.toggleDataBars(z,A.value,o,e)},P=function(){return(0,p.__awaiter)(s,void 0,void 0,function(){var B,A,z;return(0,p.__generator)(this,function(R){switch(R.label){case 0:return B=d.get(),[4,c.get(B)];case 1:return A=R.sent(),[4,e.dataBarsDialogLauncherFactory()];case 2:return z=R.sent(),this.showDataBarsDialog(a,z,i,t,o,h.expr,A),[2]}})})}}return E={toggleButton:{displayName:(0,Ae.Gf)(u.displayName,this.localizationService),description:(0,Ae.Gf)(u.description,this.localizationService),placeholder:(0,Ae.Gf)(u.placeHolderText,this.localizationService),value:!!f,saveCallback:T}},f&&(E.isApplied={displayName:(0,Ae.Gf)((0,Ne.V)("PropertyPane_ConditionalFormatting_DialogLauncherSliceTitle"),this.localizationService),placeholder:(0,Ae.Gf)(u.placeHolderText,this.localizationService),value:P}),E}},n.prototype.addDialogLauncherToSlice=function(e,t,r,i,a,o,s,l,u){var c=this;l.linkButtonAction=function(){return(0,p.__awaiter)(c,void 0,void 0,function(){var h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,t()];case 1:return h=f.sent(),[4,this.showConditionalFormattingDialogForSliceAndSave(e,l,h,r,a,o,s.displayName,l.name,i,u)];case 2:return f.sent(),[2]}})})},l.linkButtonDisplayName=(0,Ae.Gf)((0,Ne.V)("PropertyPane_ConditionalFormatting_DialogLauncherSliceTitle"),this.localizationService)},n.prototype.toggleConditionalFormatting=function(e,t,r,i){b.fF.assertValue(e,"toggleConditionalFormatting: visualContainer"),b.fF.assertValue(r,"toggleConditionalFormatting: repetition"),b.fF.assertValue(r.selector,"toggleConditionalFormatting: repetition.selector"),b.fF.assertValue(r.selector.metadata,"toggleConditionalFormatting: repetition.selector.metadata");var a=r.propertyDescriptor.type,o=r.propertyDescriptor.type.misc;b.fF.assertValue(a,"toggleConditionalFormatting - propertyType");var l,s=(0,De.xA)(r.selector.metadata);a.fill?l=(0,pa.vX)(s):a.icon?l=(0,pa.XB)(s):o&&o.webUrl?l=(0,De.IF)():b.fF.assertFail("Attempt to toggle Conditional Formatting for an unsupported type: "+JSON.stringify(a)),t?i.setPropertyDefinition(e,r.propertyId,r.selector,l):i.removePropertyDefinition(e,r.propertyId,r.selector)},n.prototype.showConditionalFormattingDialogForSliceAndSave=function(e,t,r,i,a,o,s,l,u,c){return(0,p.__awaiter)(this,void 0,void 0,function(){var d;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return[4,this.getConditionalFormattingDialogResult(r,i,a,o,s,l,u,c)];case 1:return(d=v.sent())?(e.undoRedo.register("Save conditional formatting",function(){t.dynamicExpressionSupport&&(t.dynamicExpressionSupport.isSet=!0),t.value=(0,$r.PU)(d.propertyDefinition,d.repetition.propertyDescriptor,!1),t.save(d.repetition.propertyId.objectName,t,i,e),e.visualAuthoring.raiseVisualContainerChanged(i)}),[2]):[2]}})})},n.prototype.getConditionalFormattingDialogResult=function(e,t,r,i,a,o,s,l){return(0,p.__awaiter)(this,void 0,void 0,function(){var u,v,h,f,m,g,y;return(0,p.__generator)(this,function(w){switch(w.label){case 0:return u=s.propertyId?s:{selector:(y=s).selector,propertyDescriptor:i,propertyId:{objectName:y.objectName,propertyName:o}},b.fF.assert(function(){return!u.allowOverrideSubtotalMatching},"Conditional formatting dialog shwon from Slices does not support customizing Total matching"),f=t&&t.config.singleVisual.query,(v=u.selector)&&v.metadata?(m=f.defn.select().withName(v.metadata),h=m?m.expr:f.defn.select()[0].expr):f&&!_.isEmpty(f.defn.select())&&(h=f.defn.select()[0].expr),[4,this.showConditionalFormattingDialog(t,e,a,h,u,r,l)];case 1:return(g=w.sent())?[2,(0,p.__assign)({repetition:u},g)]:[2]}})})},n.prototype.showConditionalFormattingDialog=function(e,t,r,i,a,o,s){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(l){return b.fF.assertValue(e,"showConditionalFormattingDialog: visualContainer"),b.fF.assertValue(t,"showConditionalFormattingDialog: dialogLauncher"),b.fF.assertValue(a,"repetition"),[2,t.show(e,r,i,a,o,s)]})})},n.prototype.toggleDataBars=function(e,t,r,i){b.fF.assertValue(e,"toggleDataBars: visualContainer"),b.fF.assertValue(r,"toggleDataBars: repetition"),b.fF.assertValue(r.propertyId,"toggleDataBars: propertyId"),b.fF.assertValue(r.selector,"toggleDataBars: selector"),b.fF.assertValue(r.selector.metadata,"toggleDataBars: selector.metadata"),b.fF.assertValue(i,"toggleDataBars: services"),b.fF.assertValue(i.visualAuthoring,"toggleDataBars: services.visualAuthoring");var a=i.visualAuthoring;if(t){var o=(0,va.uz)();a.addDataBars(e,r,o)}else a.removeDataBars(e,r)},n.prototype.showDataBarsDialog=function(e,t,r,i,a,o,s){b.fF.assertValue(t,"showDataBarsDialog: dialogLauncher");var l=o.getMetadata(s).type;t.show(i,r,a,e.colorPalette,l,!0)},n.prototype.updateDynamicExpressionSupportForSlice=function(e,t,r,i,a,o,s,l,u,c,d){var h,f,v=this;b.fF.assertValue(e,"generateDynamicExpressionSupportForSlice() missing instance");var m=3===(null===(h=e.propertyInstanceKind)||void 0===h?void 0:h[t]);if(b.fF.assert(function(){return m},"only to be called if slice needs dynamicExpressionSupport"),m){var g=_.clone(i);g.type=r;var y=null===(f=u.visualContainer)||void 0===f?void 0:f.config.singleVisual.query,w=!1,V=(0,fe.NA)(a,{objectName:e.objectName,propertyName:t},e.selector);if(V&&(0,yi.oA)(V,e.selector,y?y.defn.select():(0,ut.bv)()).length){w=!0;var F=Ve.BT(l,o.selector,t);F&&(o.isValid=!1,o.warningMessage=Ve.qb(F,s,!1))}var N=(0,K.Ue)();u.themeService&&u.explorationNavigation&&(N=u.themeService.getVisualStyle(u.explorationNavigation.getCurrentExploration().themeCollection)),o.dynamicExpressionSupport={isSet:w,instance:e,propertyDescriptor:g,objectDisplayName:c,edit:function(){return(0,p.__awaiter)(v,void 0,void 0,function(){return(0,p.__generator)(this,function(P){switch(P.label){case 0:return u.conditionalFormattingDialogLauncher?[4,this.showConditionalFormattingDialogForSliceAndSave(u,o,u.conditionalFormattingDialogLauncher,u.visualContainer,V,g,d??c,o.name,e,N)]:[2];case 1:return P.sent(),[2]}})})}}}},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(ot.o))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),Sr=C(28894),Xr=C(59897);function On(n){if((0,Xr.Gl)(n.type))return(0,Xr.AG)(n.type.fill.solid.color)}function dt(n,e){return{objectName:e,propertyName:n.name,selector:n.selector,propertyTypes:n.type,instanceKind:n.dynamicExpressionSupport?3:void 0,altConstantValueSelector:n.altConstantValueSelector}}function _i(n,e){var t,r,i,a,o,s,l,u,c,d,v,h,f,m,g;if(n){var y=function(n){var e=Ve.TW(n);switch(e){case"alignment":return"AlignmentGroup";case"fill":return"ColorPicker";case"fontPicker":return"FontPicker";case"image":return"ImageUpload";case"numeric":case"numericSelection":case"numericUnitSelection":return"NumUpDown";case"selection":case"propertyPaneSelection":return"Dropdown";case"slider":return"Slider";case"bool":return"ToggleSwitch";case"geoJson":return"ShapeMapSelector";case"gradientBar":return"GradientBar";case"duration":return"DurationPicker";case"dateTime":return"DatePicker";case"text":return"TextInput";case"textarea":return"TextArea";case"readOnlyText":return"ReadOnlyText";case"linkButton":return"Link";case"flagsSelection":return"FlagsSelection";default:b.fF.assertNever(e)}}(n),w={displayName:n.displayName,description:n.description,uid:e+"-"+n.name};switch(n.showLinkButtonOnly&&(y="Link",w=(0,p.__assign)((0,p.__assign)({},w),{displayName:n.linkButtonDisplayName})),y){case"ColorPicker":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"ColorPicker",properties:{descriptor:dt(n,e),value:n.value,isNoFillItemSupported:On(n)}}});case"Dropdown":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"Dropdown",properties:{descriptor:dt(n,e),items:n.selectionOptions,value:null!==(t=_.find(n.selectionOptions,function(O){return O.value===n.value}))&&void 0!==t?t:n.selectionOptions[0]}}});case"DurationPicker":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"DurationPicker",properties:{descriptor:dt(n,e),value:n.value,validators:n.validators}}});case"GradientBar":return(0,p.__assign)((0,p.__assign)({},w),{suppressDisplayName:!0,control:{type:"GradientBar",properties:{descriptor:dt(n,e),value:n.value}}});case"Slider":case"NumUpDown":var V=null!==(i=null===(r=n.numericValueOptions)||void 0===r?void 0:r.minValue)&&void 0!==i?i:null===(a=n.validators)||void 0===a?void 0:a.min,q=null!==(s=null===(o=n.numericValueOptions)||void 0===o?void 0:o.maxValue)&&void 0!==s?s:null===(l=n.validators)||void 0===l?void 0:l.max;return b.fF.assert(function(){return _.isUndefined(V)||_.isNumber(V)},"minValue must be a number"),b.fF.assert(function(){return _.isUndefined(q)||_.isNumber(q)},"maxValue must be a number"),(0,p.__assign)((0,p.__assign)({},w),{control:{type:y,properties:{descriptor:dt(n,e),value:n.value,options:{unitSymbol:null===(u=n.numericValueOptions)||void 0===u?void 0:u.unitSymbol,minValue:{type:0,value:V},maxValue:{type:1,value:q}},placeholderText:n.placeholder}}});case"TextArea":case"TextInput":var F={};return!(null===(c=n.validators)||void 0===c)&&c.required&&(F.required={type:2}),!(null===(d=n.validators)||void 0===d)&&d.pattern&&(F.pattern={type:3,regex:n.validators.pattern}),!(null===(v=n.validators)||void 0===v)&&v.dashArray&&(F.dashArray={type:4}),!(null===(h=n.validators)||void 0===h)&&h.maxLength&&(F.maxLength={type:5,value:n.validators.maxLength}),(0,p.__assign)((0,p.__assign)({},w),{control:{type:y,properties:{descriptor:dt(n,e),value:n.value,placeholder:null!==(f=n.placeholder)&&void 0!==f?f:"",validators:F}}});case"ToggleSwitch":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"ToggleSwitch",properties:{descriptor:dt(n,e),value:n.value}}});case"AlignmentGroup":var N=void 0;switch(n.name){default:b.fF.assertFail('Unexpected alignment group name "'.concat(n.name,'"'));case"horizontalAlignment":N="horizontalAlignment";break;case"verticalAlignment":N="verticalAlignment"}return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"AlignmentGroup",properties:{descriptor:dt(n,e),mode:N,value:n.value}}});case"ImageUpload":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"ImageUpload",properties:{descriptor:dt(n,e),value:n.value}}});case"ShapeMapSelector":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"ShapeMapSelector",properties:{descriptor:dt(n,e),value:{type:n.value.type,name:n.value.name,content:n.value.content}}}});case"DatePicker":var T=null===(m=n.validators)||void 0===m?void 0:m.min,P=null===(g=n.validators)||void 0===g?void 0:g.max;return b.fF.assert(function(){return _.isUndefined(T)||_.isDate(T)},"minValue must be a Date"),b.fF.assert(function(){return _.isUndefined(P)||_.isDate(P)},"maxValue must be a Date"),(0,p.__assign)((0,p.__assign)({},w),{control:{type:"DatePicker",properties:{descriptor:dt(n,e),value:n.value,validators:{min:{type:0,value:T},max:{type:1,value:P}},placeholder:n.placeholder}}});case"FontPicker":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"FontPicker",properties:{descriptor:dt(n,e),value:n.value}}});case"ReadOnlyText":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"ReadOnlyText",properties:{descriptor:dt(n,e),value:n.value}}});case"Link":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"Link",properties:{descriptor:dt(n,e),value:n.linkButtonAction}},suppressDisplayName:n.showLinkButtonOnly});case"FlagsSelection":return(0,p.__assign)((0,p.__assign)({},w),{control:{type:"FlagsSelection",properties:{descriptor:dt(n,e),items:n.selectionOptions,value:n.value}}});default:b.fF.assertNever(y)}}}var je=C(40474),da=C(82834);function Tr(n,e,t,r){if(b.fF.assertValue(n,"formatPainter.copyFormatObjects - sourceDescriptors should exist"),b.fF.assertValue(e,"formatPainter.copyFormatObjects - destinationDescriptors should exist"),b.fF.assertAnyValue(t,"formatPainter.copyFormatObjects - sourceObjects can be undefined"),b.fF.assertAnyValue(r,"formatPainter.copyFormatObjects - destinationObjects can be undefined"),t===r)return r;for(var i in r=r||{},n){var a=n[i],o=e[i];if(o&&!a.suppressFormatPainterCopy&&!o.suppressFormatPainterCopy){var s=t&&t[i],l=r&&r[i];for(var u in a.properties){var c=a.properties[u],d=o.properties[u];if(d&&!c.suppressFormatPainterCopy&&!d.suppressFormatPainterCopy&&_.isEqual(c.type,d.type)){if(l)for(var v=0,h=l;v<h.length;v++)(0,da.Ow)(f=h[v],u);if(s)for(var m=0,g=s;m<g.length;m++){var f;(f=g[m]).properties[u]&&((0,fe.zx)(r,i,f.selector).properties[u]=f.properties[u])}}}}}return(0,fe.u4)(r)}var _r=C(52083),Mn=C(48066),ga=C(52967),Yr=C(18231);function Zr(n,e,t,r,i){var a,o,s,l,u,c;if(e.name!==U.tV)if(e.name!==U.Kp)if((0,da.e4)(e.name)){var q,V=e.type;q=(0,fe.e4)(e.value)?e.value:V.image?function(n,e,t,r,i,a){if(!n||_.isEmpty(n.name))return{name:(0,De.fL)(""),url:(0,De.fL)("")};var o,s=!0;if(n.scaling){var l=(0,fe.NA)(i,{objectName:e,propertyName:t},r);s=!l||(0,gt.fS)(l.name,(0,De.fL)(""))||(0,gt.fS)(l.scaling,(0,De.fL)(n.scaling))}if(s&&a)o=a.add(n.name,1,Yr.Ut.Image,{content:n.url});else{var u=(0,fe.NA)(i,{objectName:e,propertyName:t},r);u&&(o=u.url)}var c={name:(0,De.fL)(n.name),url:o};return n.scaling&&(c.scaling=(0,De.fL)(n.scaling)),c}(e.value,n,e.name,e.selector,t,r.resourceRegistration):V.geoJson?function(n,e){if(n){var t;if(n.type===ga.c1)e.add(n.name,2,Yr.Ut.ShapeMap),t=(0,De.nF)(Yr.IG,2,n.name);else if(n.type===ga.BD&&n.content){var r=(0,Mn.wo)(n.content);t=e.add(n.name,1,Yr.Ut.ShapeMap,{content:r})}else t=n.content?(0,De.fL)(n.content):(0,De.IF)();return{name:(0,De.fL)(n.name),type:(0,De.fL)(n.type),content:t}}}(e.value,r.resourceRegistration):V.filter&&null===e.value?null:(0,fe.Lo)(e.value,V),!St.Ge.fromDescriptor(e.type).text&&""===q&&(q=null);var N=e.selector;void 0!==e.altConstantValueSelector&&(null==e.value?i||(N=e.altConstantValueSelector):(0,yi.oA)(q,N,(0,ut.bv)()).length?(0,fe.E2)(t,n,e.altConstantValueSelector,e.name):N=e.altConstantValueSelector),function(n,e,t,r,i){if(null!=n){if(null!=r?.order){var a=(0,fe.GQ)(i,e,r,{skipOrder:!0});if(a.length){b.fF.assert(function(){return 1===a.length},"expected one match when updating order");var o=_.first(a).selector;o.order!==r.order&&((0,fe.xl)(i,e,o,r),(0,fe.dM)(i,{objectName:e,propertyName:t},r))}}(function(n,e,t,r){n===U.De&&e===U.di&&((0,fe.zx)(t,n,null).properties[U.Ll]=r)})(e,t,i,n),(0,fe.zx)(i,e,r).properties[t]=n}else(0,fe.E2)(i,e,r,t)}(q,n,e.name,N,t)}else b.fF.assertFail("Invalid property name");else for(var d=t[n],v=null!==(l=null===(s=r.explorationNavigation)||void 0===s?void 0:s.getAllSections())&&void 0!==l?l:[],h=null===(u=r.explorationNavigation)||void 0===u?void 0:u.getCurrentSection(),f=je.C7,m=0,g=v;m<g.length;m++){var y=g[m];if(y!==h){var w=y.objects=null!==(c=y.objects)&&void 0!==c?c:{};d?Tr(((a={})[n]=f[n],a),f,((o={})[n]=d,o),w):delete w[n]}}else delete t[n]}var wi=function(e,t,r,i,a,o,s){if((0,J.Vz)(r)){var l=r.config.singleVisual.visualType;if(i.telemetryService&&function(n,e,t,r){var i,a,o,s,l,u,c,d,v,h=e.name;if(n===U.jA&&h===U.di&&r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t}),n===U.LG&&h===U.di&&r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t}),n===U.hz&&h===U.i$&&r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t}),n===U.$l&&h===U.ns&&r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t}),n===U.Rz&&h===U.Il){var f=null===(o=null===(a=null===(i=e.value)||void 0===i?void 0:i.solid)||void 0===a?void 0:a.color)||void 0===o?void 0:o.rule;_.isEmpty(f)||r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t})}n===U.jA&&h===U.Il&&(f=null===(u=null===(l=null===(s=e.value)||void 0===s?void 0:s.solid)||void 0===l?void 0:l.color)||void 0===u?void 0:u.rule,_.isEmpty(f)||r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t})),n===U.e4&&h===U.Il&&(f=null===(v=null===(d=null===(c=e.value)||void 0===c?void 0:c.solid)||void 0===d?void 0:d.color)||void 0===v?void 0:v.rule,_.isEmpty(f)||r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t})),(n===U.Rz||n===U.ve)&&h===U.xh&&r.logEvent(xe.Lo,{objectName:n,propertyName:h,newValue:e.value,visualType:t}),(n===U.Rz||n===U.ve)&&h===U.es&&r.logEvent(xe.Lo,{objectName:n,propertyName:h,visualType:t})}(e,t,l,i.telemetryService),e===U.ph)!function(n,e){var t=e.config.singleVisual.objects;t||(e.config.singleVisual.objects=t={}),(0,_r._8)(n.name,n.value,t)}(t,r);else{var u=r.config.singleVisual.objects;if(u||(r.config.singleVisual.objects=u={}),s){var c=i.visualPlugin&&i.visualPlugin.capabilities(l);if(c&&c.supportsSynchronizingFilterState){var d=c.objects[e];if(d){var v=d.properties[t.name];if(v&&v.filterState){var h=i.visualSync;h&&h.syncFilterState(r)}}}}Zr(e,t,u,i,o),r.config.singleVisual.autoSelectVisualType=void 0}}},Wn=C(35598),ya=C(21728),Jr=C(55133),Hn=C(1521),Kn=C(29324),Qn=C(96915),qi=C(17966),Yt=C(39503),Di=C(17328),ei=C(84281),Sa=C(4877),Pr=C(67660),Ir=C(72262),xr=C(69866),$n=[_e.SliceNameAxisStart,_e.SliceNameAxisEnd,_e.SliceNameStart,_e.SliceNameEnd,_e.SliceNameSecStart,_e.SliceNameSecEnd],Fi=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w){this.bookmarkService=e,this.conceptualSchemaProxy=t,this.conditionalFormattingUtilsService=r,this.dataSources=i,this.explorationNavigation=a,this.featureSwitchService=o,this.formFactor=s,this.itemPicker=l,this.lazyScoped=u,this.localizationService=c,this.runningVisuals=d,this.selectionService=v,this.telemetryService=h,this.themeService=f,this.undoRedo=m,this.visualAuthoring=g,this.visualPlugin=y,this.visualStylePresetService=w,this.hasServicesLoaded=this.loadServices()}return n.prototype.loadServices=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,p.__generator)(this,function(r){switch(r.label){case 0:return this.conditionalFormattingDialogLauncher?[3,2]:(e=this,[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")]);case 1:e.conditionalFormattingDialogLauncher=r.sent(),r.label=2;case 2:return this.dataBarsDialogLauncher?[3,4]:(t=this,[4,this.lazyScoped.get("dataBarsDialogLauncherService")]);case 3:t.dataBarsDialogLauncher=r.sent(),r.label=4;case 4:return[2]}})})},n.prototype.getFormattingModel=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,p.__generator)(this,function(r){return[2,this.hasServicesLoaded.then(function(){return(0,p.__awaiter)(t,void 0,void 0,function(){var i,a;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return[4,this.getPropertyPaneViewModel(e)];case 1:return i=o.sent(),a={cards:[]},e&&i&&(a.cards=this.createCards(i,e.config.singleVisual.visualType)),[2,a]}})})})]})})},n.prototype.convertLegacyToModernCards=function(e,t){var r=this;return e.reduce(function(i,a){var o,s;if(a.name===U.T9)s=r.getConditionalFormattingCard();else{var l=r.createNormalGroup(a);s={displayName:a.displayName,uid:a.id,description:a.description,disabled:!1,groups:0!==l.slices.length||l.container?[l]:[],topLevelToggle:r.getTopLevelToggle(a),revertToDefaultDescriptors:null!==(o=a.customRevertToDefaultDescriptors)&&void 0!==o?o:r.getRevertToDefaultDescriptor(a.name,t),analyticsPane:a.analyticsPane}}return s&&i.push(s),i},[])},n.prototype.createCards=function(e,t){var r=this.visualPlugin.capabilities(t).objects;return this.convertLegacyToModernCards(e.cards,r)},n.prototype.getConditionalFormattingCard=function(){var e=this,t=ya.UP.getDefaultSelectedVisualInSingleOrMultiCase(this.selectionService);if((0,J.Vz)(t)){var r=this.runningVisuals.getVisual(t);if(r&&r.getAdapter()){var i=r.getAdapter(),a=i.enumerateObjectRepetition&&i.enumerateObjectRepetition();if(!a)return;var u=this.visualPlugin.capabilities(t.config.singleVisual.visualType).objects;return(0,Kn.Z)(a,function(v){return e.localizationService.get(v)},u,"FieldWell_ConditionalFormatting","")}}},n.prototype.getRevertToDefaultDescriptor=function(e,t){var r,i=null===(r=t[e])||void 0===r?void 0:r.properties;if(i)return Object.keys(i).map(function(a){return{objectName:e,propertyName:a}})},n.prototype.getTopLevelToggle=function(e){var t=e?_i(e.mainShow,e.name):void 0;return t&&(t.displayName=void 0,t.description=void 0,t.suppressDisplayName=!0),t},n.prototype.createNormalGroup=function(e){for(var t,r={displayName:void 0,uid:e.id+"-group",slices:[],disabled:!1},i={},a=0,o=e.slices;a<o.length;a++){var s=o[a],l=_i(s,null!==(t=s.customObjectName)&&void 0!==t?t:e.name);void 0===i[s.name]?i[s.name]=0:(i[s.name]++,l.uid="".concat(l.uid,"-").concat(i[s.name])),l&&r.slices.push(l)}return r.container=e.containers?this.createContainers(e,r.uid):void 0,r},n.prototype.createContainers=function(e,t){var r=t+"-container";return{displayName:e.containersLabel,description:e.containersTooltip,containerItems:e.containers.map(function(a){return{displayName:a.displayName,slices:a.slices.reduce(function(o,s){var l,u=_i(s,null!==(l=s.customObjectName)&&void 0!==l?l:e.name);return u&&o.push(u),o},[]),disabled:a.isDisabled,uid:r+a.displayName}}),isEditable:e.containersEditable,uid:r}},n.prototype.getPropertyPaneViewModel=function(e,t,r,i,a){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,w,V,q,F,T;return(0,p.__generator)(this,function(P){switch(P.label){case 0:return e?(s=this.formFactor.getCurrentLayout(),l={height:Jr.aW,width:Jr.Co},u=e.layouts.withId(s).position,c=(0,Q.hP)(u,s,e.parentGroup),d={x:Math.round(c.x),y:Math.round(c.y),width:Math.round(c.width),height:Math.round(c.height)},v=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),h=1===s?l:this.explorationNavigation.getCurrentSection().size,(f=this.runningVisuals.getVisual(e))&&f.getAdapter()?(g=(m=e.config.singleVisual).visualType,y=f.getAdapter(),w=m.objects,(V=this.visualPlugin.capabilities(g))&&V.objects?(q=m.evaluatedObjects&&m.evaluatedObjects.title,F=function(n,e){if(e&&e.config&&e.config.singleVisual){var t=e.config.singleVisual,r=n.capabilities(e.config.singleVisual.visualType),i=(0,_r.Zn)(r.objects);if(i&&i.inputRole){var a=void 0;return null!=t&&null!=(a=t.query)&&null!=a.projections&&null!=a.projections[i.inputRole]&&(0,Wn.mx)(i.conditions,a.projections,(0,Q.i1)(a))}return!1}}(this.visualPlugin,e),T={visual:y,dataBarsDialogLauncher:this.dataBarsDialogLauncher,conditionalFormattingDialogLauncher:this.conditionalFormattingDialogLauncher,capabilities:V,visualConfig:m,visualContainer:e,visualTitle:q,visualObjectDefns:w,visualContainerPosition:d,showGradientCard:F,selectedContainers:t,selectedVisualType:g,shouldIncludeObject:function(E){return!E||1===E},localizationService:this.localizationService,dataSourcesService:this.dataSources,visualAuthoring:this.visualAuthoring,visualStyle:v,runningVisual:this.runningVisuals.getVisual(e),sectionSize:h,canvasLayout:s,excludeObjectRepetition:r,disabledSliceTypes:a,excludeConditionalFormattingCard:i},f&&y===f.getAdapter()?[4,this.createViewModelForVisual(T)]:[3,2]):[3,2]):[3,2]):[3,3];case 1:o=P.sent(),P.label=2;case 2:return[3,4];case 3:o=this.createEmptyViewModel(),P.label=4;case 4:return[2,o]}})})},n.prototype.createViewModelForVisual=function(e){var t=this.createEmptyViewModel();return this.populatePaneForVisual(t,e)},n.prototype.createEmptyViewModel=function(){return{selectedVisualType:null,cards:(0,ut.bv)()}},n.prototype.populatePaneForVisual=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return r=function(n){var e=this;return{dataBarsDialogLauncherFactory:function(){return(0,p.__awaiter)(e,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,n.dataBarsDialogLauncher]})})},conditionalFormattingDialogLauncherFactory:function(){return(0,p.__awaiter)(e,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,n.conditionalFormattingDialogLauncher]})})},objectDescriptors:n.capabilities.objects,objectDefinitions:n.visualObjectDefns,shouldIncludeObject:n.shouldIncludeObject,dataSourcesService:n.dataSourcesService,enumerateObjectInstances:function(i){return(0,p.__awaiter)(e,void 0,void 0,function(){var a,o;return(0,p.__generator)(this,function(s){return n.visual?(o={objectName:i},(a=n.visual).enumerateObjectInstancesAsync?[2,a.enumerateObjectInstancesAsync(o)]:a.enumerateObjectInstances?[2,a.enumerateObjectInstances(o)]:[2]):[2]})})},enumerateObjectRepetition:function(){if(n.visual&&n.visual.enumerateObjectRepetition)return n.visual.enumerateObjectRepetition()},showGradientCard:n.showGradientCard,selectedContainers:n.selectedContainers,save:wi,visualType:n.visualConfig.visualType,visualContainer:n.visualContainer,visualWarningCollection:n.runningVisual&&n.runningVisual.getWarnings(),localizationService:n.localizationService,visualStyle:n.visualStyle,cardIndexCounter:0,disabledSliceTypes:n.disabledSliceTypes,excludeConditionalFormattingCard:n.excludeConditionalFormattingCard}}(t),[4,this.populatePane(e,r)];case 1:return i.sent(),e.cards=(0,ut.z8)(_.sortBy(e.cards,function(a){return a.index})),e.selectedVisualType=t.selectedVisualType,this.addValidation(e,t.sectionSize),[2,e]}})})},n.prototype.populatePane=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a=this;return(0,p.__generator)(this,function(o){for(i in b.fF.assertValue(e,"model"),b.fF.assertValue(t,"options"),b.fF.assertValue(t.objectDescriptors,"options.objectDescriptors"),e.selectedContainers=t.selectedContainers,r=[],t.objectDescriptors)r.push(this.populateCard(e,t,i,t.cardIndexCounter++));return[2,Promise.allSettled(r).then(function(){t.showGradientCard&&!e.cards.withName(U.ph)&&a.populateGradientCard(e,t.objectDefinitions,!1,t,t.cardIndexCounter++),t.enumerateObjectRepetition&&!t.excludeConditionalFormattingCard&&(a.conditionalFormattingUtilsService.populateConditionalFormattingCard(e,t),t.cardIndexCounter++);var s=e.cards.withName(U.LQ);s&&(s.index=-2);var l=e.cards.withName(U.H);return l&&(l.index=-1),e})]})})},n.prototype.populateCard=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return(a=t.objectDescriptors[r])?t.shouldIncludeObject&&!t.shouldIncludeObject(a.objectCategory)?[2]:[4,t.enumerateObjectInstances(r)]:[2];case 1:return o=c.sent(),!(s=Ze.G.normalize(o))||_.isEmpty(s.instances)?(t.showGradientCard&&"dataPoint"===r&&this.populateGradientCard(e,t.objectDefinitions,!1,t,i),[2]):((l=e.cards.withName(r))||(u=!!(t.objectDefinitions&&t.objectDefinitions[r]&&t.objectDefinitions[r].length>0),l={name:r,id:Ve.Yb(t.visualType,r),index:i,displayName:(0,Ae.Gf)(a.displayName,this.localizationService)||r,description:(0,Ae.Gf)(a.description,this.localizationService),slices:(0,ut.bv)(),footer:[],mainShow:null,isDirty:u},e.cards.push(l)),[4,this.addSlices(l,s,a,t)]);case 2:return c.sent(),Ve.ht(t,l),l.name!==U.LQ&&this.addFooterSlicesToCard(l,t),[2]}})})},n.prototype.addFooterSlicesToCard=function(e,t){var r=U.tV;if(!_.some(e.footer,function(o){return o.name===r})){if(e.name===U.Z0){var i={applyToAllPages:!0};e.footer.push({value:e.isDirty,name:U.Kp,displayName:"",type:i,show:!0,placeholder:"",isValid:!0,isDisabled:this.isSliceDisabled(e,U.Kp,i,t.disabledSliceTypes),save:t.save})}var a={revertToDefault:!0};e.footer.push({value:e.isDirty,name:r,displayName:"",type:a,show:!0,placeholder:"",isValid:!0,isDisabled:this.isSliceDisabled(e,r,a,t.disabledSliceTypes),save:t.save})}},n.prototype.getShowSliceValue=function(e,t,r){if(e.name===_e.PlotAreaCardName&&r){var i=r.properties[_e.ImageSliceName];if(i&&(t===_e.ImageFitSliceName||t===_e.TransparencySliceName))return null!=i.url}return!0},n.prototype.populateGradientCard=function(e,t,r,i,a){var o=(0,_r.Vn)(t);if(o){var s=this.createGradientCard(e,o,r,i,a);e.cards.push(s),this.addFooterSlicesToCard(s,i)}},n.prototype.addSlices=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:b.fF.assertValue(e,"propertyPaneCard"),b.fF.assertValue(t,"enumeration"),b.fF.assertValue(r,"objectDescriptor"),a=i.isDisabled,t.containerInfo&&!_.isEmpty(t.containers)&&(e.containersLabel=(0,Ae.Gf)(t.containerInfo.containersLabel,this.localizationService),e.containersTooltip=(0,Ae.Gf)(t.containerInfo.containersTooltip,this.localizationService)),o=0,s=t.instances,f.label=1;case 1:return o<s.length?(u=r.properties,c=(l=s[o]).properties,null==l.containerIdx?[3,3]:(d=Ze.G.getContainerForInstance(t,l),v=Ve.Yl(e.name,l.containerIdx),h={name:v,displayName:(0,Ae.Gf)(d.displayName,this.localizationService),value:v,selector:l.selector,containerIndex:l.containerIdx,isDisabled:!1,slices:(0,ut.bv)()},e.containers||(e.containers=(0,ut.bv)()),[4,this.createSlices(l,u,i,c,e,a,h.slices,h.displayName)])):[3,6];case 2:return f.sent(),e.containers.push(h),[3,5];case 3:return[4,this.createSlices(l,u,i,c,e,a,e.slices)];case 4:f.sent(),f.label=5;case 5:return o++,[3,1];case 6:return[2]}})})},n.prototype.createSlices=function(e,t,r,i,a,o,s,l){return(0,p.__awaiter)(this,void 0,void 0,function(){var u,c,d,v,h,f,m,g,y;return(0,p.__generator)(this,function(V){switch(V.label){case 0:for(g in d=this.getPropertyWarning(c=(u=r.visualWarningCollection&&r.visualWarningCollection.visualObjectWarnings)&&u[a.name]||[]),v=function(F){var N,T,P,O,E,L,B,z,G,ne,oe,Fe,Ye,We,Re,bt;return(0,p.__generator)(this,function(ft){switch(ft.label){case 0:return Ve.Ke(N=t[F])?(T=e.selector?e.displayName:void 0,P=(0,Ae.Gf)(N.displayName,h.localizationService),O=(0,Ae.Gf)(N.description,h.localizationService),E=(0,Ae.Gf)(N.placeHolderText,h.localizationService),L=F===_e.ImageSliceName||F===_e.MapSliceName?"":T||P||F,B=St.Ge.fromDescriptor(N.type),[4,Ve.cn({propertyType:B,instance:e,propertyName:F,paneServices:{bookmarkService:h.bookmarkService,dataSourcesService:h.dataSources,explorationNavigation:h.explorationNavigation,localizationService:h.localizationService,visualStylePresetService:h.visualStylePresetService},visualType:r.visualType})]):[2,"continue"];case 1:return z=ft.sent(),G=h.getPropertyDescriptorType(N.type,e.propertyTypes&&e.propertyTypes[F]),ne=h.getPropertyValue(i[F],z,G,F,r),"strictSingleSelect"===(oe={name:F,displayName:L,description:O,type:G,selector:e.selector,altConstantValueSelector:e.altConstantValueSelector,value:ne,show:h.getShowSliceValue(a,F,e),placeholder:E,isValid:!0,isDisabled:o||h.isSliceDisabled(a,F,G,r.disabledSliceTypes),containerIndex:e.containerIdx,save:r.save,selectionOptions:z}).name&&h.shouldDisableStrictSelectionDueToMappedColumn(r.visualContainer,oe),e.propertyInstanceKind&&3===e.propertyInstanceKind[F]&&h.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(e,F,G,N,r.objectDefinitions,oe,r.localizationService,c,{featureSwitchService:h.featureSwitchService,visualStylePresetService:h.visualStylePresetService,telemetryService:h.telemetryService,visualAuthoring:h.visualAuthoring,undoRedo:h.undoRedo,explorationNavigation:h.explorationNavigation,visualContainer:r.visualContainer,conditionalFormattingDialogLauncher:h.conditionalFormattingDialogLauncher},a.displayName,oe.selector?l:void 0),(Fe=h.getNumericValueOptionsFromValidValues(e,oe)||Ve.X_(oe))&&(oe.numericValueOptions=Fe),h.configureValidators(e,oe),F===U.di?(d&&(oe.warningMessage=Ve.qb(d,r.localizationService,!0)),a.mainShow=oe):s.push(oe),(!!(Ye=(0,fe.NA)(r.objectDefinitions,{objectName:"dataPoint",propertyName:"fill"},{data:[(0,Qn.Ue)(1)]}))||h.featureSwitchService&&h.featureSwitchService.featureSwitches.cartesianConditionalFormatting)&&e.propertyInstanceKind&&e.propertyInstanceKind[F]&&(1&(We=e.propertyInstanceKind[F])||(oe.showLinkButtonOnly=!0),2===We&&r.conditionalFormattingDialogLauncherFactory&&(b.fF.assert(function(){return!(2===We&&void 0!==e.altConstantValueSelector)},"Rule-only property kind with alt selector is not supported."),Re={featureSwitchService:h.featureSwitchService,visualStylePresetService:h.visualStylePresetService,telemetryService:h.telemetryService,visualAuthoring:h.visualAuthoring,undoRedo:h.undoRedo,explorationNavigation:h.explorationNavigation},bt=h.themeService.getVisualStyle(h.explorationNavigation.getCurrentExploration().themeCollection),h.conditionalFormattingUtilsService.addDialogLauncherToSlice(Re,r.conditionalFormattingDialogLauncherFactory,r.visualContainer,e,Ye,N,a,oe,bt))),[2]}})},h=this,m=[],f=i)m.push(g);y=0,V.label=1;case 1:return y<m.length?(g=m[y])in f?[5,v(g)]:[3,3]:[3,4];case 2:V.sent(),V.label=3;case 3:return y++,[3,1];case 4:return d&&!a.mainShow&&(a.mainShow=this.createWarningPlaceHolderSlice(Ve.qb(d,r.localizationService,!0),e,r,o)),[2]}})})},n.prototype.configureValidators=function(e,t){var r,i=St.Ge.fromDescriptor(t.type);i.numeric?(r=this.getVisualObjectValidationOptionsFromValidValues(e,t.name))&&(t.validators=r.numberRange):i.duration&&(r=this.getDurationPickerValidationOptionsFromValidValues(e,t.name))&&(t.validators=r.durationRange)},n.prototype.shouldDisableStrictSelectionDueToMappedColumn=function(e,t){var r,i,a,o;return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,d;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return s=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(s)];case 1:return(l=v.sent())?(!(u=null===(o=null===(a=null===(i=null===(r=e?.config)||void 0===r?void 0:r.singleVisual)||void 0===i?void 0:i.query)||void 0===a?void 0:a.defn)||void 0===o?void 0:o.select())&&u?.length>1||(d=Pt.m.getConceptualParameterMetadata(u[0].expr,l),1===d?.kind&&!d?.supportsMultipleValues&&(t.isDisabled=!0)),[2]):[2]}})})},n.prototype.getVisualObjectValidationOptionsFromValidValues=function(e,t){var r=e.validValues;if(r&&r[t]&&!_.isArray(r[t])){var i=r[t];if(i.numberRange&&_.isNumber(i.numberRange.max)&&_.isNumber(i.numberRange.min))return i}},n.prototype.getDurationPickerValidationOptionsFromValidValues=function(e,t){var r=e.validValues;if(r&&r[t]&&!_.isArray(r[t])){var i=r[t];if(i.durationRange)return i}},n.prototype.getNumericValueOptionsFromValidValues=function(e,t){var r=St.Ge.fromDescriptor(t.type);if(r.integer||r.formatting&&r.formatting.fontSize){var i=this.getVisualObjectValidationOptionsFromValidValues(e,t.name);if(i&&i.numberRange)return{minValue:i.numberRange.min,maxValue:i.numberRange.max,unitSymbol:i.unitSymbol||""}}},n.prototype.getPropertyDescriptorType=function(e,t){var r=St.Ge.fromDescriptor(e);if(!r.variant)return e;b.fF.assertValue(t,"propertyTypes");for(var i=St.Ge.fromDescriptor(t),a=0,o=r.variant;a<o.length;a++)if(i.isCompatibleFrom(o[a]))return t},n.prototype.getPropertyValue=function(e,t,r,i,a){if(null==e)return e;if(t)return Ve.vw(t,e);if(!r.numeric||_.isFinite(parseFloat(e))){if(this.isFillProperty(r)){var o=e&&e.solid?e.solid.color:e;e={value:(0,Hn.SW)(o&&o.toString())}}return r.formatting&&r.formatting.stylePreset&&(b.fF.assertValue(a.visualType,"propertyPaneViewModelFactory.getPropertyValue - visualType should exist to set a stylePreset"),e={visualType:a.visualType,stylePresetName:e}),e}},n.prototype.getPropertyWarning=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.warnings)for(var a=0,o=i.warnings;a<o.length;a++)return o[a]}},n.prototype.createWarningPlaceHolderSlice=function(e,t,r,i){var a="warningPlaceHolder";return{name:a,displayName:"",type:null,selector:t.selector,value:"",show:!0,placeholder:a,isValid:!0,isDisabled:i,containerIndex:t.containerIdx,save:r.save,warningMessage:e}},n.prototype.createGradientCard=function(e,t,r,i,a){var o=e.cards.withName(U.ph);o||(o={name:U.ph,id:Ve.Yb(i.visualType,U.ph),index:a,displayName:(0,Ae.Gf)((0,Ne.V)("Visual_DataPoint"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_DataPointDescription"),this.localizationService),slices:(0,ut.bv)(),footer:[],mainShow:null,isDirty:r});var s=this.itemPicker.getDataColors().getGradientColors(),l=(0,_r.Ym)(t),u="diverging",c={bool:!0};return o.slices.push({value:l.diverging,name:u,displayName:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_Diverging"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_DivergingDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),u="gradientBar",c={none:!0},o.slices.push({value:(0,_r.Kj)(l,s),name:u,displayName:"gradientBar",type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),c={fill:{solid:{color:!0}}},o.slices.push({value:{value:l.minColor||s.minColor.value},name:u="minColor",displayName:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MinColor"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MinColorDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o.slices.push({value:{value:l.midColor||s.midColor.value},name:u="midColor",displayName:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MidColor"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MidColorDescription"),this.localizationService),type:{fill:{solid:{color:!0}}},show:l.diverging,placeholder:"",isValid:!0,save:i.save,isDisabled:!l.diverging}),c={fill:{solid:{color:!0}}},o.slices.push({value:{value:l.maxColor||s.maxColor.value},name:u="maxColor",displayName:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MaxColor"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MaxColorDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),c={numeric:!0},o.slices.push({value:l.minValue,name:u="minValue",displayName:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MinValue"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MinValueDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o.slices.push({value:l.midValue,name:u="midValue",displayName:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MidValue"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MidValueDescription"),this.localizationService),type:{numeric:!0},show:l.diverging,placeholder:"",isValid:!0,save:i.save,isDisabled:!l.diverging}),c={numeric:!0},o.slices.push({value:l.maxValue,name:u="maxValue",displayName:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MaxValue"),this.localizationService),description:(0,Ae.Gf)((0,Ne.V)("Visual_Gradient_MaxValueDescription"),this.localizationService),type:c,show:!0,placeholder:"",isValid:!0,save:i.save,isDisabled:this.isSliceDisabled(o,u,c,i.disabledSliceTypes)}),o},n.prototype.isFillProperty=function(e){return null!=e.fill},n.prototype.isSliceDisabled=function(e,t,r,i){return null!=e.mainShow&&!1===e.mainShow.value&&!this.isSliceAlwaysEnabled(t)||!!i?.some(function(a){return!!r[a]})},n.prototype.isSliceAlwaysEnabled=function(e){switch(e){case U.di:case U.b4:case U.tV:case _e.SliceNameStart:case _e.SliceNameEnd:case _e.SliceNameInvertAxis:case _e.SliceNameSecStart:case _e.SliceNameSecEnd:case _e.SliceNameSecInvertAxis:case U.V1:case U.jv:case U.Kp:return!0;default:return!1}},n.prototype.addValidation=function(e,t){for(var r=0,i=e.cards;r<i.length;r++){var a=i[r];switch(a.name){case U.rR:case U.$l:case U.mn:this.setAxisValidationLimitations(a);break;case U.LQ:this.setGeneralValidationLimitations(a,t);break;default:for(var o=0,s=a.slices;o<s.length;o++)this.setSliceValidation(s[o])}if(!_.isEmpty(a.containers))for(var u=0,c=a.containers;u<c.length;u++)for(var v=0,h=c[u].slices;v<h.length;v++)this.setSliceValidation(h[v])}return e},n.prototype.setSliceValidation=function(e){var t=St.Ge.fromDescriptor(e.type);t.misc&&t.misc.webUrl&&(e.validators||(e.validators={}),e.validators.url=!0),(t.numeric||t.integer||t.dateTime)&&"indicatorPrecision"===e.name&&(e.validators={max:_e.MaxPrecision})},n.prototype.setGeneralValidationLimitations=function(e,t){for(var r=0,i=e.slices;r<i.length;r++){var a=i[r],o=a.name;switch(a.validators={},o){case U.Lu:var s=e.slices.withName(U.X),l=parseFloat(s.value);a.validators.max=t.width-l,a.validators.min=_e.MinContainerWidth,a.validators.integer=!0,a.validators.required=!0;break;case U.oU:var u=e.slices.withName(U.Y),c=parseFloat(u.value);a.validators.max=t.height-c,a.validators.min=_e.MinContainerHeight,a.validators.integer=!0,a.validators.required=!0;break;case U.X:var d=e.slices.withName(U.Lu),v=parseFloat(d.value);a.validators.max=t.width-v,a.validators.min=0,a.validators.integer=!0,a.validators.required=!0;break;case U.Y:var h=e.slices.withName(U.oU),f=parseFloat(h.value);a.validators.max=t.height-f,a.validators.min=0,a.validators.integer=!0,a.validators.required=!0}}},n.prototype.setAxisValidationLimitations=function(e){for(var t=0,r=e.slices;t<r.length;t++){var i=r[t],a=i.name;if(_.includes($n,a)){var o=St.Ge.fromDescriptor(i.type);i.validators={};for(var s=0,l=e.slices;s<l.length;s++){var u=l[s];if(a===_e.SliceNameStart&&u.name===_e.SliceNameEnd||a===_e.SliceNameSecStart&&u.name===_e.SliceNameSecEnd||a===_e.SliceNameAxisStart&&u.name===_e.SliceNameAxisEnd)if(o.dateTime)i.validators.max=u.value;else{var c=parseFloat(u.value);i.validators.max=_.isFinite(c)?c:void 0,i.validators.decimal=!0}else(a===_e.SliceNameEnd&&u.name===_e.SliceNameStart||a===_e.SliceNameSecEnd&&u.name===_e.SliceNameSecStart||a===_e.SliceNameAxisEnd&&u.name===_e.SliceNameAxisStart)&&(o.dateTime?i.validators.min=u.value:(c=parseFloat(u.value),i.validators.min=_.isFinite(c)?c:void 0,i.validators.decimal=!0))}}else this.setSliceValidation(i)}},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(qi.F),D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(Si),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(Di.F),D.\u0275\u0275inject(Sa.a),D.\u0275\u0275inject(Sr.H),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Ir.z),D.\u0275\u0275inject(Lt.y0),D.\u0275\u0275inject(Pr.f),D.\u0275\u0275inject(ei.z),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D),D.\u0275\u0275inject(xr.A))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Ni=function(){function n(e,t,r,i,a,o,s,l,u){this.conditionalFormattingUtilsService=e,this.featureSwitchService=t,this.lazyScoped=r,this.legacyVisualFormattingService=i,this.localizationService=a,this.referenceLineHelper=o,this.undoRedoService=s,this.visualAuthoring=l,this.visualPluginService=u}return n.prototype.getFormattingCards=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s=this;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return[4,this.buildAnalyticsCards(e,i,t,r)];case 1:return a=l.sent(),_.isEmpty(a)?[2]:(o=_.map(a,function(u,c){return s.convertToPropertyPaneCard(u,c)}),[2,this.legacyVisualFormattingService.convertLegacyToModernCards(o,i.objects)])}})})},n.prototype.getPropertyDisplayName=function(e,t){if(b.fF.assertValue(e,"propertyName must be defined"),b.fF.assertAnyValue(t,"propertyDescriptor is allowed to have any value"),t){var r=(0,Ne.G)(t.displayName,this.localizationService);return _.isEmpty(r)?e:r}},n.prototype.getNonReferenceCardDisplayName=function(e,t,r){var a=1!==Vi(e)&&r>0,o=_.find(j,function(l){return l.objectName===e}),s=o?this.localizationService.get(o.displayNameBaseKey):this.getObjectDisplayName(e,t);return a?this.localizationService.format("NamePattern_Bracket",[s,r]):s},n.prototype.getObjectDisplayName=function(e,t){var r=(0,Ne.G)(t.displayName,this.localizationService);return _.isEmpty(r)?e:r},n.prototype.getTargetAnalyticsObjects=function(e){var t={};for(var r in e.objects||{})2===e.objects[r].objectCategory&&!_.includes(["forecast","anomalyDetection"],r)&&(t[r]=e.objects[r]);return t},n.prototype.buildAnalyticsCards=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:if(a=this.getTargetAnalyticsObjects(t),_.isEmpty(a))return[2];for(u in o=[],l=[],s=a)l.push(u);c=0,f.label=1;case 1:return c<l.length?(u=l[c])in s?(d=u)!==te?[3,3]:[4,this.buildReferenceLineCards(e,t,i,r)]:[3,5]:[3,6];case 2:return v=f.sent(),o.push.apply(o,v??[]),[3,5];case 3:return[4,this.buildNonReferenceLineCard(d,t.objects[d],e,i,r)];case 4:(h=f.sent())&&o.push(h),f.label=5;case 5:return c++,[3,1];case 6:return[2,o]}})})},n.prototype.buildReferenceLineCards=function(e,t,r,i){var a;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return(o=null===(a=t.objects)||void 0===a?void 0:a[te])?[4,this.referenceLineHelper.getReferenceLineInstancesInfo(e,r,t)]:[2];case 1:if(s=g.sent(),_.isEmpty(s?.groupedInstances))return[2];l=s.validMeasures,u=[],c=0,d=s.groupedInstances,g.label=2;case 2:return c<d.length?[4,this.buildReferenceLineCard((v=d[c])[0],v[1],l,o,e,i)]:[3,5];case 3:m=g.sent(),u.push(m),g.label=4;case 4:return c++,[3,2];case 5:return[2,u]}})})},n.prototype.buildReferenceLineCard=function(e,t,r,i,a,o){return(0,p.__awaiter)(this,void 0,void 0,function(){var s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return b.fF.assert(function(){return!_.isEmpty(t)},"Expect the given typedLineInstances NOT to be empty"),b.fF.assert(function(){return!_.isEmpty(r)},"Expect the given validMeasures NOT to be empty"),b.fF.assertValue(i,"Expect the given objectDescriptor to be defined"),[4,this.buildAnalyticsCard(te,i,{type:e,instances:t,validMeasures:r},a,o)];case 1:return s=l.sent(),b.fF.assertValue(s,"No undefined legacy reference line card should be created"),[2,s]}})})},n.prototype.buildNonReferenceLineCard=function(e,t,r,i,a){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return[4,Ft(i,e)];case 1:return o=l.sent(),s=Ze.G.normalize(o),_.isEmpty(s?.instances)?[2]:[4,this.buildAnalyticsCard(e,t,{instances:s.instances},r,a)];case 2:return[2,l.sent()]}})})},n.prototype.buildAnalyticsCard=function(e,t,r,i,a){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,u,c,d,v,h,f,m,g,y,w,V,q,N,T,P;return(0,p.__generator)(this,function(O){switch(O.label){case 0:return _.isEmpty(r.instances)?[2]:(function(n){return n.hasOwnProperty("validMeasures")}(r)?(u=r.validMeasures,o=hi(l=r.type),c=this.localizationService.get(aa[l]),d=_.size(_.filter(r.instances,function(E){return!E.isDefaultInstance})),s=d>0?this.localizationService.format("NamePattern_Bracket",[c,d]):c):(o=e,d=_.size(_.filter(r.instances,function(E){return!!E.properties[k]})),s=this.getNonReferenceCardDisplayName(e,t,d)),v=t.properties,h={objectName:e,id:o,displayName:s,description:(0,Ne.G)(t.description,this.localizationService),instances:[],defaultInstance:null,maxInstances:Vi(e),supportsUserDefinedInstances:Jn(e)},f=i.config.singleVisual,[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")]);case 1:m=O.sent(),g={conditionalFormattingDialogLauncher:m,conditionalFormattingUtilsService:this.conditionalFormattingUtilsService,featureSwitchService:this.featureSwitchService,localizationService:this.localizationService,objectDefinitions:f.objects,visualAuthoring:this.visualAuthoring,visualContainer:i,visualPlugin:this.visualPluginService,visualWarningCollection:a.getWarnings(),undoRedo:this.undoRedoService},y=function(L){var B,A,z,R;return(0,p.__generator)(this,function(G){switch(G.label){case 0:return B=void 0,A=void 0,_a(L)?(A=L.visualObjectInstance,z=L.isDefaultInstance,B={instance:L,validMeasures:u}):(z=!(A=L).properties[k],B=L),b.fF.assert(function(){return!z||!h.defaultInstance},'Each object should NOT have multiple instances with "show" property being false'),R=A.disabledReason,_.isEmpty(R)?[4,w.addInstanceToCard(h,B,l,z,e,v,g)]:(h.readOnly=!0,h.warningText=R,[2,{value:h}]);case 1:return G.sent(),[2]}})},w=this,V=0,q=r.instances,O.label=2;case 2:return V<q.length?[5,y(q[V])]:[3,5];case 3:if("object"==typeof(N=O.sent()))return[2,N.value];O.label=4;case 4:return V++,[3,2];case 5:return h.defaultInstance?[3,7]:(P=_a(T=r.instances[0])?{instance:T,validMeasures:u}:T,[4,this.addInstanceToCard(h,P,l,!0,e,v,g)]);case 6:O.sent(),O.label=7;case 7:return[2,h]}})})},n.prototype.addInstanceToCard=function(e,t,r,i,a,o,s){return(0,p.__awaiter)(this,void 0,void 0,function(){var l,u,c,d,v,h,f,m,g,y,w,V,q;return(0,p.__generator)(this,function(F){switch(F.label){case 0:for(m in l=ba(t)?t.instance.visualObjectInstance:t,c=i?null:l.selector,d=(u=l.properties).displayName,v={slices:[],displayName:_.isString(d)&&!_.isEmpty(d)?d:e.displayName,selector:c,type:r},ba(t)&&this.buildReferenceLineSpecialSlices(e,v,t,i),f=[],h=u)f.push(m);g=0,F.label=1;case 1:return g<f.length?(m=f[g])in h?(w=u[y=m],function(n,e,t){var r=["displayName","type",k];return n===te&&r.push("value"),!_.includes(r,e)&&Ve.Ke(t)}(a,y,V=o[y])?[4,this.buildSlice(a,y,V,w,v.displayName,l,i,s)]:[3,3]):[3,3]:[3,4];case 2:q=F.sent(),v.slices.push(q),F.label=3;case 3:return g++,[3,1];case 4:return i?e.defaultInstance=v:e.instances.push(v),[2]}})})},n.prototype.buildSlice=function(e,t,r,i,a,o,s,l){var u,c,d;return(0,p.__awaiter)(this,void 0,void 0,function(){var v,h,f,m,g,w,V,q;return(0,p.__generator)(this,function(F){switch(F.label){case 0:return v=this.getSliceDisplayName(t,r,o),h=this.getPropertyTypeDescriptor(t,r,o),[4,this.getSliceValue(t,r,i,o)];case 1:return q=F.sent(),f=q.value,m=q.selectionOptions,g={name:t,displayName:v,description:(0,Ne.G)(r.description,this.localizationService),type:h,selector:o.selector,value:f,show:!0,placeholder:(0,Ne.G)(r.placeHolderText,this.localizationService),isValid:!0,isDisabled:s,containerIndex:o.containerIdx,selectionOptions:m},h.fill&&(g.value={value:g.value}),3===(null===(u=o.propertyInstanceKind)||void 0===u?void 0:u[t])&&(w=(null===(d=null===(c=l.visualWarningCollection)||void 0===c?void 0:c.visualObjectWarnings)||void 0===d?void 0:d[e])||[],l.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(o,t,h,r,l.objectDefinitions,g,l.localizationService,w,l,a)),(V=Ve.X_(g))&&(g.numericValueOptions=V),g.isPropertyTitleWidthStretch=Ve.OR(g),function(n){n.name===se.pw&&(n.validators={max:_e.MaxPrecision})}(g),[2,g]}})})},n.prototype.buildReferenceLineSpecialSlices=function(e,t,r,i){if(!i){var a=r.instance,o={displayName:this.localizationService.get("Series"),name:"measure",customObjectName:hi(t.type),show:!0,isDisabled:i,isValid:!0,placeholder:this.localizationService.get("Visual_Reference_Line_Measure_Default"),selectionOptions:r.validMeasures,value:a.measureName,selector:a.visualObjectInstance.selector,type:{enumeration:(0,Xt.i)([])}};t.slices.push(o);var s=a.percentileValue;if(null!=s){var l={displayName:this.localizationService.get("Visual_Reference_Line_Percentile"),name:"percentile",customObjectName:hi(t.type),show:!0,isDisabled:!1,isValid:!0,placeholder:void 0,value:s,selector:a.visualObjectInstance.selector,type:{numeric:!0}};l.numericValueOptions=Ve.X_(l),l.isPropertyTitleWidthStretch=Ve.OR(l),t.slices.push(l)}}},n.prototype.getSliceDisplayName=function(e,t,r){var i=r.selector?r.displayName:void 0;return _.isEmpty(i)?this.getPropertyDisplayName(e,t):i},n.prototype.getSliceValue=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return a=r,[4,Ve.cn({propertyType:St.Ge.fromDescriptor(t.type),instance:i,propertyName:e})];case 1:return(o=l.sent())&&(a=Ve.vw(o,r)),s=a,"color"!==e&&a?.solid&&t.type.fill&&(s=r.solid.color),[2,{value:s,selectionOptions:o}]}})})},n.prototype.getPropertyTypeDescriptor=function(e,t,r){var i,a=null===(i=r.propertyTypes)||void 0===i?void 0:i[e],o=Ve.sH(t.type,a),s=t.type.variant;return s&&(o=(0,p.__assign)((0,p.__assign)({},o),{variant:s})),o},n.prototype.convertToPropertyPaneCard=function(e,t){var r={name:e.objectName,displayName:e.displayName,description:e.description,id:e.id,slices:(0,ut.z8)([]),footer:[],mainShow:void 0,isDirty:!1,index:t,analyticsPane:!0,customRevertToDefaultDescriptors:[]},i=_.size(e.instances);if(1===e.maxInstances){var a=1===i?e.instances[0]:e.defaultInstance;b.fF.assertValue(a,"If maxInstances===1, one instance must be found to show the UI, be it a default instance or a real instance");var o=(0,ut.z8)(a?.slices||[]);r.slices=o,r.mainShow={displayName:void 0,isDisabled:!!e.readOnly,isValid:!0,name:k,save:_.noop,show:!0,type:{bool:!0},value:a!==e.defaultInstance,placeholder:null},_.forEach(o,function(u){var c;r.customRevertToDefaultDescriptors.push({objectName:null!==(c=u.customObjectName)&&void 0!==c?c:e.objectName,propertyName:u.name})}),r.customRevertToDefaultDescriptors.push({objectName:e.objectName,propertyName:k})}else{var s=[];_.forEach(i>0?e.instances:[e.defaultInstance],function(u,c){var d={name:void 0,displayName:u===e.defaultInstance?void 0:u.displayName,value:void 0,isDisabled:u===e.defaultInstance,slices:(0,ut.z8)(u.slices||[]),selector:u.selector,containerIndex:c};s.push(d),_.forEach(d.slices,function(v){var h;r.customRevertToDefaultDescriptors.push({objectName:null!==(h=v.customObjectName)&&void 0!==h?h:e.objectName,propertyName:v.name})})}),r.containersLabel=this.localizationService.get("Apply_Settings_To"),r.containersTooltip=null,r.containersEditable=!0,r.containers=(0,ut.z8)(s),r.selectedContainer=_.first(r.containers)}return r},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(Si),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(Sr.H),D.\u0275\u0275inject(Fi),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(Kr),D.\u0275\u0275inject(ei.z),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function Vi(n){var e=_.find(j,function(t){return t.objectName===n});return e?e.maxInstances:1}function Jn(n){var e=_.find(j,function(t){return t.objectName===n});return!!e&&e.supportsUserDefinedInstances}function _a(n){return n.hasOwnProperty("visualObjectInstance")}function ba(n){return n.hasOwnProperty("validMeasures")}var io=C(58702),Ca=function(){function n(e,t,r,i,a,o,s,l){this.anomalyDetectionHelper=e,this.forecastHelper=t,this.legacyAnalyticsFormattingService=r,this.localizationService=i,this.referenceLineHelper=a,this.telemetryService=o,this.visualAuthoringService=s,this.visualPluginService=l}return n.prototype.saveChangedSlicesToDefinition=function(e,t,r){return void 0===r&&(r=!1),(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return(0,J.Vz)(t)?(i=e[0].groupDisplayName,_.isEmpty(i)?[3,2]:(a=e[0].objectName,b.fF.assert(function(){return e.every(function(u){return u.objectName===a})},"all the changes should have same object"),b.fF.assert(function(){return e.every(function(u){return u.groupDisplayName===i})},"all the changes should have same groupDisplayName"),[4,this.handleGroupSlicesSave(a,i,e,t)])):[2,!1];case 1:return[2,l.sent()];case 2:return b.fF.assert(function(){return 1===_.size(e)},"Expect saveObject to have 1 single change when it is not from a grouped save"),(o=e[0]).propertySlice.type.errorRange?[2,this.saveSliceExpression(o.objectName,o.propertySlice,t)]:[2,this.saveSliceValue(o.objectName,o.propertySlice,t,!!r)];case 3:return[2]}})})},n.prototype.saveSliceExpression=function(e,t,r){var i=t.value;b.fF.assert(function(){return void 0===i||i instanceof De.Il||(0,io.hl)(i)},"Slice value is not a valid expression");var a={objectName:e,propertyName:t.name},o=t.selector;return void 0===i?this.visualAuthoringService.removePropertyDefinition(r,a,o,!0):this.visualAuthoringService.setPropertyDefinition(r,a,o,i,void 0,!0),!0},n.prototype.saveSliceValue=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u,c,d,v,h=this;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return[4,this.checkAddRemoveRenameInstance(e,t,r,i)];case 1:return f.sent()?[2,!0]:"editable-container-object-name"===e?[2,!1]:[4,this.referenceLineHelper.tryHandleReferenceLineSpecialSave(e,t,r)];case 2:return(s=f.sent()).isHandled?(a=s.persistChanges,o=s.newPropertyChanges):(a={merge:[],remove:[]},l={objectName:e,selector:t.selector,properties:{}},c=St.Ge.fromDescriptor(u=t.type),d=t.value,!c.text&&""===d&&(d=null),null==d||d instanceof De.jz&&null==d.value?(l.properties[t.name]=d,a.remove.push(l)):(u.variant&&!(d instanceof De.Il)&&(d=(0,fe.Lo)(d,u)),l.properties[t.name]=d,a.merge.push(l))),(v=!(_.isEmpty(a?.merge)&&_.isEmpty(a?.replace)&&_.isEmpty(a?.remove)&&_.isEmpty(a?.removeObject)))&&this.visualAuthoringService.persistProperties(a,r,!0),o&&_.forEach(o.properties,function(m,g){h.visualAuthoringService.setPropertyDefinition(r,{objectName:o.objectName,propertyName:g},o.selector,m,void 0,!0)}),[2,v]}})})},n.prototype.handleGroupSlicesSave=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return e!==Be.Po?[3,2]:[4,this.forecastHelper.saveGroupSlices(t,r,i)];case 1:case 3:return[2,a.sent()];case 2:return e!==Xe?[3,4]:[4,this.anomalyDetectionHelper.saveGroupSlices(t,r,i)];case 4:return[2,!1]}})})},n.prototype.checkAddRemoveRenameInstance=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.referenceLineHelper.checkAddRemoveRenameInstance(e,t,r)];case 1:return a.sent()||this.forecastHelper.checkAddRemoveInstance(e,t,r)||this.anomalyDetectionHelper.checkAddRemoveInstance(e,t,r)||this.checkAddRemoveNormalInstance(e,t,r,i)?[2,!0]:[2,!1]}})})},n.prototype.checkAddRemoveNormalInstance=function(e,t,r,i){if(i||j[e])return 1===(i?Vi(e):j[e].maxInstances)&&t.name===k&&(t.value?this.addNormalInstance(e,r,i):be(e,t.selector,r,this.visualAuthoringService),!0)},n.prototype.addNormalInstance=function(e,t,r){var i;if(b.fF.assert(function(){return e!==te&&e!==Be.Po&&e!==Xe},"Expect this NOT be called for reference line or forecast"),r){var a=this.visualPluginService.capabilities(t.config.singleVisual.visualType),s=this.legacyAnalyticsFormattingService.getPropertyDisplayName(e,a.objects[e].properties.displayName);i=Se(e,s,t,this.localizationService)}else{var l=_.find(j,function(u){return u.objectName===e}).displayNameBaseKey;i=ae(e,l,t,this.localizationService)}this.telemetryService.logEvent(xe.Yu,{objectName:e}),this.visualAuthoringService.persistProperties(i,t,!0)},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(dr),D.\u0275\u0275inject(gr),D.\u0275\u0275inject(Ni),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(Kr),D.\u0275\u0275inject(Lt.y0),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),xt=C(66609),wa=C(36998),Ti=function(){function n(e,t,r,i,a,o,s,l){this.conceptualSchemaProxy=e,this.dataSourcesService=t,this.featureSwitchService=r,this.lazyScoped=i,this.conditionalFormattingUtilService=a,this.explorationNavigation=o,this.themeService=s,this.visualAuthoring=l}return n.prototype.getDynamicExpressionSupportObjectForSlice=function(e){var t=this,r=e.containerSliceDisplayName,i=e.descriptor,a=e.objectDefinitions,o=e.objectDisplayName,s=e.propertyDescriptor,l=e.propertyTypeDescriptor,u=e.warning,c=e.canvasItem;if(!c||!(0,J.Vz)(c))return b.fF.assertFail("visualContainer should exist"),{dynamicExpressionSupport:void 0,warningMessage:void 0};var f,d=i.objectName,v=i.propertyName,h=i.selector,g=_.clone(s);g.type=l;var w=c.config.singleVisual.query,V=!1,q=(0,fe.NA)(a,{objectName:d,propertyName:v},h);return q&&(0,yi.oA)(q,h,w?w.defn.select():(0,ut.bv)()).length&&(V=!0,u&&(f=this.getDataBoundExprWarning(u,i))),{warningMessage:f,dynamicExpressionSupport:{isSet:V,showDialog:function(){return t.showConditionalFormattingDialogForSlice(c,q,g,r??o,v,i)}}}},n.prototype.getDataBoundExprWarning=function(e,t){if(e instanceof wa.L&&e.propertyId.propertyName===t.propertyName&&(!e.selector&&!t.selector||(0,ra.fS)(e.selector,t.selector)))return e},n.prototype.getConditionalFormattingSliceProperties=function(e,t,r){var i=this;if(r&&(0,J.Vz)(r)){var a=r.config.singleVisual.objects,o=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),l=this.conditionalFormattingUtilService.getConditionalFormattingSliceProperties({conceptualSchemaProxy:this.conceptualSchemaProxy,conditionalFormattingDialogLauncherFactory:function(){return i.lazyScoped.get("conditionalFormattingDialogLauncherService")},dataBarsDialogLauncherFactory:function(){return i.lazyScoped.get("dataBarsDialogLauncherService")},dataSourcesService:this.dataSourcesService,featureSwitchService:this.featureSwitchService,visualAuthoring:this.visualAuthoring},r,a,e,o,t);if(l)return(0,p.__assign)((0,p.__assign)({},l),{toggleButton:(0,p.__assign)((0,p.__assign)({},l.toggleButton),{saveCallback:function(d){return i.saveConditionalFormattingControlProperties(d,l.toggleButton.saveCallback,[r])}})})}else b.fF.assertFail("visualContainer should exist")},n.prototype.saveConditionalFormattingControlProperties=function(e,t,r){b.fF.assert(function(){return 1===_.size(e.changes)},"Expect this NOT be called when there are multiple changes in the save object");for(var i=e.changes[0].objectName,a=e.changes[0].propertySlice,o=0,s=r;o<s.length;o++)t(i,a,s[o])},n.prototype.showConditionalFormattingDialogForSlice=function(e,t,r,i,a,o){return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,c;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return s=this.explorationNavigation.getCurrentExploration(),l=this.themeService.getVisualStyle(s.themeCollection),[4,this.lazyScoped.get("conditionalFormattingDialogLauncherService")];case 1:return u=v.sent(),[4,this.conditionalFormattingUtilService.getConditionalFormattingDialogResult(u,e,t,r,i,a,o,l)];case 2:return!(c=v.sent())||_.isUndefined(c.propertyDefinition)?[2,{value:void 0,shouldSave:!1}]:[2,{value:(0,$r.PU)(c.propertyDefinition,c.repetition.propertyDescriptor,!1),shouldSave:!0}]}})})},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(Sr.H),D.\u0275\u0275inject(Si),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(Pr.f),D.\u0275\u0275inject(vt.$8))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),qa=C(58938),Da=function(){function n(){this._fieldPickerAllStaticSeriesValue=new Map}return n.prototype.cleanFieldPickerStaticSeries=function(e,t){if("FieldPicker"===e.control.type){var r=e.control.properties;if(!r.dataLabelPickerType)return;var a=r.dataLabelPickerType.dataLabelRole;!r.value&&2===r.dataLabelPickerType.seriesType&&t&&(0,J.Vz)(t)&&this.clearAllStaticSeriesValue(a,t.name)}},n.prototype.updateFieldPickerControlValue=function(e,t,r,i){var s=(0,fe.NA)(r,{objectName:t.objectName,propertyName:t.propertyName},t.selector);e.splitValuesIntoInstances?this.splitFieldPickerPropsIntoInstances(t,r,e):e.unwrapExprOnGet&&this.wrapPropertyValueForFieldPicker(e,s),i&&(0,J.Vz)(i)&&this.updateFieldPickerControlFallbackExpression(e,s,i),this.setFallbackExpressionAsDisplayedValue(e)},n.prototype.wrapPropertyValueForFieldPicker=function(e,t){e.value=t?{newExpr:{expr:t}}:void 0},n.prototype.splitFieldPickerPropsIntoInstances=function(e,t,r){var o=(0,fe.hz)(t,{objectName:e.objectName,propertyName:e.propertyName},e.selector);if(o){for(var s=_.sortBy(Object.keys(o),function(v){var h;return null===(h=o[v].selector)||void 0===h?void 0:h.order}),l=[],u=0,c=s;u<c.length;u++){var d=c[u];l.push({expr:o[d].value,metadata:d})}b.fF.assert(function(){return!!l.length},"expect at least one expr to add"),r.value={newExpr:l}}else r.value=void 0},n.prototype.updateFieldPickerControlFallbackExpression=function(e,t,r){if(e.dataLabelPickerType&&[2,3].includes(e.dataLabelPickerType.seriesType)){var a=r.name,o=e.dataLabelPickerType.seriesType,s=e.dataLabelPickerType.dataLabelRole;if(2===o)return void(e.value?this.setAllStaticSeriesValue(s,t,a):this.clearAllStaticSeriesValue(s,a));3===o&&(e.fallbackExpr=this.allStaticSeriesHasValueForRole(s,a)?this.getAllStaticSeriesValue(s,a):e.fallbackExpr)}},n.prototype.setFallbackExpressionAsDisplayedValue=function(e){var t;!e.value&&e.fallbackExpr?(e.value={newExpr:{expr:e.fallbackExpr}},e.allowClear=null!==(t=e.allowClear)&&void 0!==t&&t):e.fallbackExpr&&(e.allowClear=!0)},n.prototype.allStaticSeriesHasValueForRole=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);return this._fieldPickerAllStaticSeriesValue.has(r)},n.prototype.getAllStaticSeriesValue=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);return this._fieldPickerAllStaticSeriesValue.get(r)},n.prototype.setAllStaticSeriesValue=function(e,t,r){var i=this.createFieldPickerSeriesValueKey(e,r);this._fieldPickerAllStaticSeriesValue.set(i,t)},n.prototype.clearAllStaticSeriesValue=function(e,t){var r=this.createFieldPickerSeriesValueKey(e,t);this._fieldPickerAllStaticSeriesValue.delete(r)},n.prototype.createFieldPickerSeriesValueKey=function(e,t){return"".concat(e,"-").concat(t)},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac=function(t){return new(t||n)}}),n}();function ti(n,e,t){return(0,p.__assign)((0,p.__assign)({},Ve.qb(n,e,!!t)),{source:n})}var jr=function(){function n(e,t,r,i,a,o,s,l){this.bookmarkService=e,this.conditionalFormattingService=t,this.dialogService=r,this.explorationNavigationService=i,this.fieldPickerTransformationService=a,this.localizationService=o,this.visualAuthoringService=s,this.visualStylePresetService=l}return n.prototype.transformFormattingSlice=function(e){var r=e.objectDescriptors,i=e.visualType,o=e.dynamicExpressionSupportOptions,s=this.applyBasicTransformation(e.formattingSlice,e.visualObjects,r,o);return this.applyControlSpecificTransformation(s,r,i,o?.canvasItem)},n.prototype.applyBasicTransformation=function(e,t,r,i){if(!(0,S.IW)(e)){var o=ce.w7(e.control.properties.descriptor,r),s=e.displayName,l=e.description;!s&&!e.suppressDisplayName&&o&&(s=(0,Ne.G)(o.displayName,this.localizationService)),!l&&o&&o.description&&(l=(0,Ne.G)(o.description,this.localizationService));var u=void 0;o&&o.placeHolderText&&(u=(0,Ne.G)(o.placeHolderText,this.localizationService));var c=this.getDynamicExpressionSupportObjectsForSlice(e,i),d=c?.warningMessage,v=void 0;d&&(v=ti(d,this.localizationService));var h=(e=this.fillRuleOnlySliceValue(e,t,i?.canvasItem)).aliasNames;return c&&(h=(0,p.__spreadArray)((0,p.__spreadArray)([],h=h??[],!0),[this.localizationService.get("FieldWell_ConditionalFormatting")],!1)),(0,p.__assign)((0,p.__assign)({},e),{displayName:s,placeHolderText:u,description:l,conditionalFormattingWarning:v,conditionalFormattingObjects:c?c.dynamicExpressionSupport:void 0,aliasNames:h})}return e},n.prototype.fillRuleOnlySliceValue=function(e,t,r){if("ConditionalFormattingControl"===e.control.type||(0,S.IW)(e))return e;var i=e.control.properties.descriptor;if(2!==i.instanceKind)return e;b.fF.assert(function(){return void 0===e.control.properties.value},"A RuleOnly Slice shouldn't have a value in Formatting Model");var s=(0,fe.NA)(t,{objectName:i.objectName,propertyName:i.propertyName},i.selector);if(""===s?.value){if("FieldPicker"===e.control.type){var l=e.control.properties,u=l?.fallbackExpr;l.value=u?{newExpr:{expr:u}}:l.value,this.fieldPickerTransformationService.cleanFieldPickerStaticSeries(e,r)}return e}var c=(0,p.__assign)((0,p.__assign)({},e),{control:(0,p.__assign)((0,p.__assign)({},e.control),{properties:(0,p.__assign)((0,p.__assign)({},e.control.properties),{value:s})})}),d=c.control;return"FieldPicker"===d.type&&this.fieldPickerTransformationService.updateFieldPickerControlValue(d.properties,i,t,r),c},n.prototype.transformConditionalFormattingControl=function(e,t){var r=this,i=e.control;if("ConditionalFormattingControl"!==i.type)return b.fF.assertFail("Unexpected slice type"),e;var a=this.conditionalFormattingService.getConditionalFormattingSliceProperties(e.displayName,i.properties.value,t);if(a){var o=a.toggleButton,s=a.isApplied,l={isSet:!1,isDisabled:!s,showDialog:function(){return(0,p.__awaiter)(r,void 0,void 0,function(){return(0,p.__generator)(this,function(c){return[2,s&&s.value()]})})}};return(0,p.__assign)((0,p.__assign)({},e),{displayName:o.displayName,description:o.description,control:{type:"ToggleSwitch",properties:{descriptor:e.control.properties.descriptor,value:o.value}},conditionalFormattingObjects:l,saveCallback:o.saveCallback})}},n.prototype.getDynamicExpressionSupportObjectsForSlice=function(e,t){if(t){var r=t.formattingDescriptor;if("ErrorRangeControl"!==e.control.type&&"FieldPicker"!==e.control.type&&(3===r.instanceKind||2===r.instanceKind)){var s=t.formattingModelWarnings;return this.conditionalFormattingService.getDynamicExpressionSupportObjectForSlice({containerSliceDisplayName:t.containerSliceDisplayName,descriptor:r,objectDefinitions:t.formattingObjectOptions.objectDefinitions,objectDisplayName:t.conditionalFormattingDisplayName,propertyDescriptor:t.propertyDescriptor,propertyTypeDescriptor:t.type,warning:s&&s[r.objectName],canvasItem:t.canvasItem})}}},n.prototype.applyControlSpecificTransformation=function(e,t,r,i){switch(e.control.type){case"Dropdown":return this.transformDropdowns(e,t,r);case"FlagsSelection":return this.transformFlagsSelection(e,t,r);case"MarginPadding":case"NumUpDown":case"Slider":return this.transformControlsWithUnit(e);case"ConditionalFormattingControl":return this.transformConditionalFormattingControl(e,i);case"SeriesDialogLink":return this.transformSeriesDialogLink(e,i);case"ColorPicker":case"FontControl":return this.transformControlWithAliasNames(e);default:return e}},n.prototype.transformSeriesDialogLink=function(e,t){var r=this,i=e.control;if("SeriesDialogLink"!==i.type)return e;var a=i.properties,o=this.localizationService;return(0,p.__assign)((0,p.__assign)({},e),{control:(0,p.__assign)((0,p.__assign)({},i),{type:"Link",properties:(0,p.__assign)((0,p.__assign)({},i.properties),{value:function(){return(0,p.__awaiter)(r,void 0,void 0,function(){var c;return(0,p.__generator)(this,function(h){switch(h.label){case 0:return[4,this.dialogService.showConfirmationDialog({title:o.get("Enable_This_Setting"),message:o.get("Format_Series_Toggle_Upgrade"),okButtonText:o.get("Restore_And_Enable"),cancelButtonText:o.get("Discard_And_Enable")},{maxWidth:450,maxHeight:225}).afterClosed().toPromise()];case 1:return 1===(c=h.sent())?[2,!0]:2===c?(a.resetToDefaultDescriptors&&t&&(0,J.Vz)(t)&&(ce.Aw(t.config.singleVisual.objects,a.resetToDefaultDescriptors,!0),this.visualAuthoringService.raiseCanvasItemChanged(t)),[2,!0]):[2,!1]}})})}})})})},n.prototype.transformControlsWithUnit=function(e){if(this.localizationService.currentLanguageLocale.startsWith("en-"))return e;switch(e.control.type){case"NumUpDown":case"Slider":return this.transformNumUpDownControl(e);case"MarginPadding":return this.transformMarginPaddingControl(e);default:return e}},n.prototype.transformControlWithAliasNames=function(e){var t,i=null!==(t=e.aliasNames)&&void 0!==t?t:[];switch(e.control.type){case"ColorPicker":var a=this.localizationService.get("Generic_Color");return i.push(a),(0,p.__assign)((0,p.__assign)({},e),{aliasNames:i});case"FontControl":var o=this.localizationService.get("Role_DisplayName_Size");return i.push(o),(0,p.__assign)((0,p.__assign)({},e),{aliasNames:i});default:return e}},n.prototype.transformNumUpDownControl=function(e){var t,r=e.control;if("Slider"!==r.type&&"NumUpDown"!==r.type)return e;var i=null===(t=r.properties.options)||void 0===t?void 0:t.unitSymbol;if(!i)return e;var a=this.localizationService.format("DisplayName_With_Unit",[e.displayName,this.localizationService.get(i)]);return(0,p.__assign)((0,p.__assign)({},e),{displayName:a,control:(0,p.__assign)((0,p.__assign)({},r),{properties:(0,p.__assign)((0,p.__assign)({},r.properties),{options:(0,p.__assign)((0,p.__assign)({},r.properties.options),{unitSymbol:void 0})})})})},n.prototype.transformMarginPaddingControl=function(e){var t,r,i=e.control;if("MarginPadding"!==i.type)return e;var a=i.properties,o=null===(r=null===(t=a.top)||void 0===t?void 0:t.options)||void 0===r?void 0:r.unitSymbol;if(!o)return e;var s=this.localizationService.format("DisplayName_With_Unit",[e.displayName,this.localizationService.get(o)]),l={},u=function(v){var h=v,f=a[h];if(!f)return"continue";b.fF.assert(function(){return o===f.options.unitSymbol},"MarginPadding, all dimensions should have same unit"),l[h]=(0,p.__assign)((0,p.__assign)({},f),{options:(0,p.__assign)((0,p.__assign)({},f.options),{unitSymbol:void 0})})};for(var c in a)u(c);return(0,p.__assign)((0,p.__assign)({},e),{displayName:s,control:(0,p.__assign)((0,p.__assign)({},i),{properties:l})})},n.prototype.transformDropdowns=function(e,t,r){var i,a,o=e.control;if("Dropdown"!==o.type)return e;var s=o.properties;if(Ve.WN(s))return e;var l=s.descriptor,u=s.filterValues,c=s.mergeValues,d=s.value,v=ce.w7(l,t);b.fF.assertValue(v,"Need property descriptor to resolve EnumDropdown");var h=St.Ge.fromDescriptor(v.type),f={objectName:l.objectName,properties:(i={},i[l.propertyName]=d,i),selector:l.selector};(u||c)&&(f.validValues=((a={})[l.propertyName]={filterValues:u,mergeValues:c},a));var g=this.getSelectionOptions({propertyType:h,instance:f,propertyName:l.propertyName,visualType:r}),y="".concat(d),w=g?.find(function(N){return N.value===d||N.value===y});b.fF.assertValue(w,"selectedEnum");var V=(0,p.__assign)((0,p.__assign)({},s),{items:g,value:w}),q=V;q.filterValues=void 0,q.mergeValues=void 0;var F={type:"Dropdown",properties:V};return(0,p.__assign)((0,p.__assign)({},e),{control:F})},n.prototype.transformFlagsSelection=function(e,t,r){var i,a=e.control;if("FlagsSelection"!==a.type)return e;var o=a.properties;if(function(n){return!!n.items}(o))return e;var s=o.descriptor,l=o.value,u=ce.w7(s,t);b.fF.assertValue(u,"Need property descriptor to resolve EnumFlagsSelection");var c=St.Ge.fromDescriptor(u.type),d={objectName:s.objectName,properties:(i={},i[s.propertyName]=l,i),selector:s.selector},h=this.getSelectionOptions({propertyType:c,instance:d,propertyName:s.propertyName,visualType:r}),f="".concat(l),g={type:"FlagsSelection",properties:(0,p.__assign)((0,p.__assign)({},o),{items:h,value:f})};return(0,p.__assign)((0,p.__assign)({},e),{control:g})},n.prototype.getSelectionOptions=function(e){var t=e.propertyType,r=e.instance,i=e.propertyName,a=e.visualType,o=this.bookmarkService,s=this.explorationNavigationService,l=this.localizationService,u=this.visualStylePresetService;b.fF.assertValue(t,"propertyType"),b.fF.assertValue(r,"instance");var c=t.enum||t.flagsEnum;if(!c){var d=t.formatting;d&&(d.labelDisplayUnits?c=(0,Xt.i)((0,xt.p$)()):d.displayUnitsWithoutAuto?c=(0,Xt.i)((0,xt.p$)(!0)):d.stylePreset&&(c=u.getEnumFromName(a,r.properties.name)));var v=t.reference;v&&(v.bookmark?(b.fF.assertValue(o,"bookmarks not implemented here"),b.fF.assertValue(l,"localizationService is missing"),o&&(c=(0,Xt.i)(Ve.oE(o.getAllBookmarks())))):v.bookmarkGroup?(b.fF.assertValue(o,"bookmarks not implemented here"),b.fF.assertValue(l,"localizationService is missing"),o&&(c=(0,Xt.i)(Ve.yp(o.getBookmarkGroups())))):v.section?(b.fF.assertValue(s,"explorationNavigation not implemented here"),b.fF.assertValue(l,"localizationService is missing"),s&&(c=(0,Xt.i)(Ve.OY(s.getAllSections())))):b.fF.assertFail(v.perspective?"Perspectives must be set directly in `values`":"Unknown refType"))}if(c){var h=Ve.Cc(r,i);if(h){var f=void 0;if(Ve.QI(h)){if(f=h.filterValues,h.mergeValues){var m=(0,p.__spreadArray)((0,p.__spreadArray)([],h.mergeValues||[],!0),c.members()||[],!0);c=(0,Xt.i)(m)}}else f=h;f&&(c=(0,Xt.i)(c.members(f)))}return(0,xt.Iq)(c.members(),l)}},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(qi.F),D.\u0275\u0275inject(Ti),D.\u0275\u0275inject(qa.x),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(Da),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(xr.A))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),ri=C(66977),ii_propertyNames_upperShadingColor="upperShadingColor",ii_propertyNames_lowerShadingColor="lowerShadingColor",ii_propertyNames_transparency="transparency",Pi=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f){this.analyticsPaneSaveService=e,this.anomalyDetectionHelper=t,this.featureSwitchService=r,this.forecastHelper=i,this.formattingSliceTransformerService=a,this.legacyAnalyticsFormattingService=o,this.localizationService=s,this.referenceLineHelper=l,this.runningVisualService=u,this.selectionService=c,this.visualAuthoring=d,this.visualPluginService=v,this.visualPluginOperationsService=h,this.formattingObjectDefinitionsService=f}return n.prototype.getFormattingModel=function(e){var t;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w;return(0,p.__generator)(this,function(V){switch(V.label){case 0:return r=[],i={cards:[]},e?(0,J.q4)(e)||(0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e)||ce.D1(e)?[2,i]:(o=this.visualPluginService.capabilities((a=e.config.singleVisual).visualType))?(s=this.runningVisualService.getVisual(e))&&(s.getHasPendingChanges()||s.getErrorInfo())?[2,i]:(l=s?.getAdapter(),l?this.visualPluginService.isCustomVisual(a.visualType)?[4,W(l)]:[3,4]:[2,i]):[2,i]:[2,{cards:r}];case 1:return(u=V.sent())?[3,3]:[4,this.legacyAnalyticsFormattingService.getFormattingCards(e,s,l,o)];case 2:u=V.sent(),V.label=3;case 3:return r.push.apply(r,u??[]),[3,10];case 4:return[4,this.enumerateTrendLineCard(l,o)];case 5:return(c=V.sent())&&r.push(c),[4,this.referenceLineHelper.enumerateReferenceAndConstantLineCards(e,l,o)];case 6:return(d=V.sent())&&r.push.apply(r,d||[]),[4,this.enumerateSymmetricShadingCard(l,o)];case 7:return(v=V.sent())&&r.push(v),[4,this.enumerateRatioLineCard(l,o)];case 8:return(h=V.sent())&&r.push(h),m=(f=r.push).apply,g=[r],[4,W(l)];case 9:m.apply(f,g.concat([null!==(t=V.sent())&&void 0!==t?t:[]])),V.label=10;case 10:return[4,this.forecastHelper.enumerateForecastCard(e,l,o)];case 11:return(y=V.sent())&&r.push(y),[4,this.anomalyDetectionHelper.enumerateAnomalyCard(e,l,o)];case 12:return(w=V.sent())&&r.push(w),[2,_.isEmpty(r)?i:{cards:r.map(function(q){return(0,p.__assign)((0,p.__assign)({},q),{analyticsPane:!0})})}]}})})},n.prototype.getObjectDescriptors=function(e){if((0,J.q4)(e))return{};var r=this.visualPluginService.capabilities(e.config.singleVisual.visualType);return r?_.pickBy(r.objects,function(i,a){return 2===i.objectCategory}):{}},n.prototype.getObjectDefinitions=function(e,t){var i,r=this;if((0,J.q4)(e))return{};var s,a=e.config.singleVisual,o=null===(i=this.visualPluginService.capabilities(a.visualType))||void 0===i?void 0:i.objects;if(!o)return{};s=t&&this.formattingObjectDefinitionsService?this.formattingObjectDefinitionsService.getObjectDefinitions(e):a.objects;var l={};return _.forEach(s,function(u,c){var d;2===(null===(d=o[c])||void 0===d?void 0:d.objectCategory)&&(l[c]=c!==Xe?u:r.anomalyDetectionHelper.getObjectDefinitions(u))}),l},n.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"VisualizationPane_Section_Analytics",itemTypeDisplayName:(0,ce.um)(e,this.featureSwitchService)}},n.prototype.getFormatPaneSliceTransform=function(e){var t=this,r=(0,vi.s)(e),i=(0,J.Vz)(e)?(0,Q.GQ)(e):void 0;return function(a,o,s){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:a,objectDescriptors:o,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:s})}},n.prototype.saveProperties=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return(0,J.q4)(t)?(b.fF.assertFail("Analytics pane does not support VisualContainerGroup"),[3,3]):[3,1];case 1:return i=!1,a=e[0].objectName,b.fF.assert(function(){return e.every(function(l){return l.objectName===a})},"all the changes should have same object"),this.visualPluginService.isCustomVisual(t.config.singleVisual.visualType)&&a!==Be.Po&&a!==Xe&&(i=!0),[4,this.analyticsPaneSaveService.saveChangedSlicesToDefinition(e,t,i)];case 2:s.sent()&&this.visualAuthoring.raiseVisualContainerChanged(t,{parentContextActivity:r}),s.label=3;case 3:return[2]}})})},n.prototype.getRevertToDefaultEnabled=function(e,t,r){var i=this.getObjectDefinitions(e);return!!i&&!!((0,ce.wW)(t,i,r)||this.forecastHelper.hasParameterWithNonDefaultValue(i)||this.anomalyDetectionHelper.hasParameterWithNonDefaultValue(i))},n.prototype.getModelUnavailableInformation=function(e){if(e&&(0,J.Vz)(e)){var t=this.runningVisualService.getVisual(e);if(t?.getHasPendingChanges())return{messageKey:"AnalyticsPane_Disabled_Paused"}}return{messageKey:"AnalyticsPane_Unavailable",learnMoreLink:"https://go.microsoft.com/fwlink/?LinkID=825117",imageName:"".concat((0,jn.Xr)(),"/images/RecommendedCharts.svg")}},n.prototype.revertVisualSlicesToDefinitions=function(e,t){for(var r=[],a=0,o=(0,ce.Wx)(e);a<o.length;a++){var s=o[a],l=s.canvasItem;r.push(l);var u=s.descriptors;if((0,J.Vz)(l)){var c=l.config.singleVisual,d=c.objects;if(!d){c.objects={};continue}this.forecastHelper.revertForecastSpecialDefinitions(l,d,u),this.anomalyDetectionHelper.revertAnomalyDetectionSpecialDefinitions(l,d,u),(0,ce.Aw)(d,u)}}this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t})},n.prototype.shouldShowGroupChangeIndicator=function(){return!1},n.prototype.shouldShowSliceChangeIndicator=function(){return!1},n.prototype.enumerateTrendLineCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v=this;return(0,p.__generator)(this,function(h){switch(h.label){case 0:return i=function(m){return v.localizationService.get(m)},a=[],o=[{type:"toggle",sliceName:"combineSeries",propertyName:fi.Kx},{type:"toggle",sliceName:"useHighlightValues",propertyName:fi.$B}],s=(0,He.pN)(r=fi.s4,He.vi),a.push.apply(a,Object.values(s)),a.push.apply(a,_.map(o,function(f){return{objectName:r,propertyName:f.propertyName}})),[4,X(r,"trendLine","Visual_Trend_Line",e,t,i,a,"show")];case 1:return(l=h.sent())?(u=l.objectInstance,(c=l.cardBuilder).addGroup(void 0,function(f){var m,g;f.addSlices((0,pe.Iq)({containerItemBuilder:f,descriptors:s,strokeData:(0,pe.AF)(u.properties,He.vi,{},null===(g=null===(m=u.properties.lineColor)||void 0===m?void 0:m.solid)||void 0===g?void 0:g.color),selector:u.selector,featureSwitches:v.featureSwitchService.featureSwitches,localize:i,isSVGStroke:!0}).map(function(y){return y.build()})),Y(f,r,u,t,i,o)}),(d=c.build()).analyticsPane=!0,[2,d]):[2]}})})},n.prototype.enumerateSymmetricShadingCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,lo(e,t,"plotAreaShading","plotAreaShading","Visual_Scatter_SymmetryShading",[{type:"color",sliceName:"upperShadingColor",propertyName:ii_propertyNames_upperShadingColor},{type:"color",sliceName:"lowerShadingColor",propertyName:ii_propertyNames_lowerShadingColor},{type:"transparency",sliceName:"transparency",propertyName:ii_propertyNames_transparency}],this.localizationService)];case 1:return[2,a.sent()]}})})},n.prototype.enumerateRatioLineCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d=this;return(0,p.__generator)(this,function(v){switch(v.label){case 0:return i=function(f){return d.localizationService.get(f)},a=[],o=(0,He.pN)("ratioLine",He.vi),a.push.apply(a,Object.values(o)),[4,X("ratioLine","ratioLine","Visual_Scatter_RatioLine",e,t,i,a,"show")];case 1:return(s=v.sent())?(l=s.objectInstance,(u=s.cardBuilder).addGroup(void 0,function(h){var f,m;return h.addSlices((0,pe.Iq)({containerItemBuilder:h,descriptors:o,strokeData:(0,pe.AF)(l.properties,He.vi,{},null===(m=null===(f=l.properties.lineColor)||void 0===f?void 0:f.solid)||void 0===m?void 0:m.color),selector:l.selector,featureSwitches:d.featureSwitchService.featureSwitches,localize:i,isSVGStroke:!0}).map(function(g){return g.build()}))}),(c=u.build()).analyticsPane=!0,[2,c]):[2]}})})},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(Ca),D.\u0275\u0275inject(dr),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(gr),D.\u0275\u0275inject(jr),D.\u0275\u0275inject(Ni),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(Kr),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Ir.z),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D),D.\u0275\u0275inject(ri.f),D.\u0275\u0275inject(mi,8))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function lo(n,e,t,r,i,a,o,s){return(0,p.__awaiter)(this,void 0,void 0,function(){var l,u,c,d,v,h;return(0,p.__generator)(this,function(f){switch(f.label){case 0:return l=function(g){return o.get(g)},(u=_.map(a,function(m){return{objectName:t,propertyName:m.propertyName}})).push({objectName:t,propertyName:s||k}),[4,X(t,r,i,n,e,l,u,s)];case 1:return(c=f.sent())?(d=c.objectInstance,(v=c.cardBuilder).addGroup(void 0,function(m){Y(m,t,d,e,l,a)}),(h=v.build()).analyticsPane=!0,[2,h]):[2]}})})}var At=C(15580),ve=C(80981),Fa=C(21002),uo=C(92129),Na=C(84668),co=C(68082),Ii=C(90006),Va=C(4285),po=C(98776),vo=C(61561),ho=C(87498),Ta=C(16920),fo=C(91836),Pa=function(){function n(e,t){this.formatInformationParserService=e,this.formatInformationService=t,this.cache=new Map}return n.prototype.getFormatInformation=function(e,t){var r,i;return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return a=this.cache.get(e.name),o=a?.get(t),s=null===(r=(0,Q.PQ)(e))||void 0===r?void 0:r.columnProperties,l=null===(i=s?.[t])||void 0===i?void 0:i.formatString,(u=null!=o)&&!Ia(o.formatStringDotNet,l)&&(u=!1),u?[2,o]:[3,1];case 1:return[4,this.updateCacheInternal(e,t,l)];case 2:return[2,d.sent()]}})})},n.prototype.updateCache=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){return[2,this.updateCacheInternal(e,t,r,i)]})})},n.prototype.updateCacheFromFormatInformation=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.updateCacheInternal(e,t,r?.formatString,r)];case 1:return[2,a.sent().formatStringVBA]}})})},n.prototype.updateCacheInternal=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return a=this.cache.get(e.name),_.isEmpty(r)&&null==i?(a&&a.delete(t),[2]):(null==a&&this.cache.set(e.name,a=new Map),[4,this.formatInformationService.convertDotNetToVBA(r)]);case 1:return o=c.sent(),null==i?[3,2]:(l=i,[3,4]);case 2:return[4,this.formatInformationParserService.tryParseVBAFormatString(o)];case 3:l=c.sent(),c.label=4;case 4:return s=l,b.fF.assert(function(){return Ia(r,s.formatString)},"after .NET->VBA->FormatInformation conversion, original .NET string is changed"),a.set(t,u={formatStringVBA:o,formatStringDotNet:r,formatInformation:s}),[2,u]}})})},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(fo.Z),D.\u0275\u0275inject(Ta.f))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function Ia(n,e){return(n??"")===(e??"")}var mo=C(27980),it="visualLevelFormat",br="customFormatString",xi="formatOptions",Ai="currencyFormats",ji="percentageOn",zi="thousandSeparatorOn",Oi="decimalPoints",zr="visualFieldDataType",yo=[{type:"General",displayLabelKey:"Format_Label_General"},{type:"CurrencyGeneral",displayLabelKey:"Format_Label_Currency"},{type:"DateTimeGeneralPattern",displayLabelKey:"Format_Label_DateTime"},{type:"NumberDecimal",displayLabelKey:"DataType_Label_Number"},{type:"NumberWhole",displayLabelKey:"DataType_Label_WholeNumber"},{type:"Percentage",displayLabelKey:"Format_Label_Percentage"},{type:"Scientific",displayLabelKey:"Format_Label_Scientific"},{type:"Text",displayLabelKey:"Text"},{type:"Boolean",displayLabelKey:"DataType_Label_Boolean"},{type:"Binary",displayLabelKey:"DataType_Binary"}],So=[{type:"WholeNumber",displayLabelKey:"DataType_Label_WholeNumber"},{type:"Number",displayLabelKey:"DataType_Label_Number"},{type:"Currency",displayLabelKey:"DataType_Label_Currency"},{type:"DateTime",displayLabelKey:"DataType_Label_Date_Time"},{type:"Date",displayLabelKey:"DaxTemplates_DateField"},{type:"Time",displayLabelKey:"DataType_Label_Time"},{type:"Text",displayLabelKey:"Text"},{type:"Boolean",displayLabelKey:"DataType_Label_Boolean"},{type:"Binary",displayLabelKey:"DataType_Binary"}],_o=[{objectName:it,propertyName:br},{objectName:it,propertyName:xi},{objectName:it,propertyName:Ai},{objectName:it,propertyName:ji},{objectName:it,propertyName:zi},{objectName:it,propertyName:Oi},{objectName:it,propertyName:zr}],Aa=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h){this.conceptualSchemaProxy=e,this.currencyFormatService=t,this.dateTimeFormatService=r,this.dataSourcesService=i,this.displayNameService=a,this.featureSwitchService=o,this.formatInformationCacheService=s,this.formatInformationService=l,this.lazyScoped=u,this.localizationService=c,this.visualAuthoringService=d,this.visualAuthoringOperationsService=v,this.dataModelService=h}return n.prototype.getVisualLevelFormatStringCard=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,v,h,f,m,g,y,w,V=this;return(0,p.__generator)(this,function(q){switch(q.label){case 0:i=new S.lg("visualLevelFieldsFormat"),a=new S.CQ(i,"Visual_Level_Fields_Formatting",_o,function(F){return V.localizationService.get(F)},!0),o=function(n){var e=(0,Q.oJ)(n),t=(0,Q.Ml)(n),r=[];_.isEmpty(e)||_.forEach(t,function(a,o){_.forEach(a.all(),function(s){var l=(0,ut.rC)(e,s.queryRef);l&&r.push({select:l,isHidden:s.hidden})})});var i=_.groupBy(r,function(a){return a.select.name});return b.fF.assert(function(){return _.every(i,function(a){if(_.size(a)<=1)return!0;var o=a[0].isHidden;return _.every(a,function(s){return s.isHidden===o})})},"We expect all projections corresponding to the same select has the same isHidden value. Now some projections of the same select has different isHidden values. Either the assumption is changed, or there is a bug."),_.uniqBy(r,function(a){return a.select.name})}(e),s=[],l=0,u=o,q.label=1;case 1:return l<u.length?[4,this.formatInformationCacheService.getFormatInformation(e,u[l].select.name)]:[3,4];case 2:v=q.sent(),s.push(v),q.label=3;case 3:return l++,[3,1];case 4:return h=[],_.find(s,function(F){var N;return Li(null===(N=F?.formatInformation)||void 0===N?void 0:N.format)})?[4,this.currencyFormatService.getCommonSupportedCurrencyFormats()]:[3,7];case 5:return f=q.sent(),[4,this.currencyFormatService.getAllSupportedCurrencyFormats()];case 6:m=q.sent(),g=_.uniqBy((0,p.__spreadArray)((0,p.__spreadArray)([],f??[],!0),m??[],!0),ja),h.push.apply(h,g),q.label=7;case 7:return y=null===(r=(0,Q.PQ)(e))||void 0===r?void 0:r.columnProperties,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 8:return w=q.sent(),a.addGroup("visualSelects",function(F){F.withDisplayName("Apply_Settings_To").withCollapsible(!1),F.addContainer("visual-fields-container",function(N){_.forEach(o,function(T,P){var O=T.select.name,E=T.select.expr,L=V.displayNameService.getDisplayName(E,w,t,O,y,{includeHierarchyName:!0,includeVariationSource:!0});N.addContainerItem(O,L,function(B){T.isHidden&&B.withIcon("hide3"),B.withGroups([V.getSingleFieldFormatGroup(i,e,O,E,s[P],w,h)])})})})}),[2,a.build()]}})})},n.prototype.saveSlice=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return e!==it?[2]:(0,J.Vz)(r)?t.name===br?[2,this.saveVisualLevelFormatStringSlice(t,r)]:t.name===xi?[2,this.saveVisualLevelFormatOptionsSlice(t,r)]:t.name===Ai?[2,this.saveVisualLevelCurrencyFormatOptionsSlice(t,r)]:t.name===zi?[2,this.saveVisualLevelThousandSeparatorSlice(t,r)]:t.name===ji?[2,this.saveVisualLevelPercentageSlice(t,r)]:t.name===Oi?[2,this.saveVisualLevelDecimalPointsSlice(t,r)]:t.name===zr?[2,this.saveVisualLevelFieldDataTypeSlice(t,r)]:[2]:(b.fF.assertFail("Expect visualLevelFormatStringFormattingHelper.saveSlice to be called only for a visual container"),[2])})})},n.prototype.resetProperty=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return t!==br?[3,1]:(this.visualAuthoringOperationsService.removeAllVisualLevelFormatStrings(e),[3,3]);case 1:return t!==zr?[3,3]:[4,this.visualAuthoringService.getVisualCalcDaxParserServiceContext(e)];case 2:r=i.sent(),this.visualAuthoringOperationsService.removeAllVisualLevelUserSetDataTypes(e,r),i.label=3;case 3:return[2]}})})},n.prototype.saveVisualLevelFieldDataTypeSlice=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,l=this;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return i=null===(r=e.selector)||void 0===r?void 0:r.metadata,_.isEmpty(i)?(b.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):(o=(0,Ii.F)(a=e.value),[4,this.visualAuthoringService.updateVisualCalculationDataType(t,i,o)]);case 1:return u.sent()?[2,this.saveSliceWithFormatInformationUpdate(e,t,function(c){return l.formatInformationService.updateFormatUponDataTypeChange((0,Ii.F)(a),c.formatInformation)})]:[2]}})})},n.prototype.saveVisualLevelFormatStringSlice=function(e,t){var r,i;return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u,c;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return a=null===(r=e.selector)||void 0===r?void 0:r.metadata,_.isEmpty(a)?(b.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):(o=e.value,[4,this.getFieldTypeAndFormatInfo(t,a)]);case 1:return s=d.sent(),l=s?.formatInformation,u="Custom"===l?.format&&"Custom"===(null===(i=l?.dateTimeCustomFormat)||void 0===i?void 0:i.formatGroup),c=u?function(n){var e=za(n);return(0,p.__assign)((0,p.__assign)({},e),{dateTimeCustomFormat:{culture:null,formatGroup:"Custom",formatString:e.formatString}})}(o):za(o),this.formatInformationCacheService.updateCache(t,a,o,c),this.visualAuthoringService.setVisualLevelFormatString(t,a,o,!0),[2]}})})},n.prototype.saveVisualLevelFormatOptionsSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){var o,s,c,l=JSON.parse(e.value),u=l.formatType;return c=function(n){var e=n.formatType;return"DateTimeGeneralPattern"===e||"DateTimeCustom"===e||"Custom"===e&&"Custom"===n.dateTimePattern}(l)?r.formatInformationService.setDateTimeFormat(a.valueType.primitiveType,a.formatInformation,u,l.dateTimePattern,null!==(o=l.formatString)&&void 0!==o?o:null===(s=a.formatInformation)||void 0===s?void 0:s.formatString):r.formatInformationService.changeFormat(a.valueType.primitiveType,a.formatInformation,u),c})]})})},n.prototype.saveVisualLevelCurrencyFormatOptionsSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){var o=JSON.parse(e.value);return r.formatInformationService.setCurrencyFormat(a.valueType.primitiveType,a.formatInformation,o.formatType,o.culture,o.symbol,o.positivePattern,o.negativePattern)})]})})},n.prototype.saveVisualLevelThousandSeparatorSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){return r.formatInformationService.setThousandsSeparator(a.valueType.primitiveType,a.formatInformation,e.value)})]})})},n.prototype.saveVisualLevelPercentageSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){var o=JSON.parse(e.value);return r.formatInformationService.changeFormat(a.valueType.primitiveType,a.formatInformation,o?"Percentage":"General")})]})})},n.prototype.saveVisualLevelDecimalPointsSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,p.__generator)(this,function(i){return[2,this.saveSliceWithFormatInformationUpdate(e,t,function(a){return r.formatInformationService.setAccuracy(a.valueType.primitiveType,a.formatInformation,e.value)})]})})},n.prototype.saveSliceWithFormatInformationUpdate=function(e,t,r){var i;return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return a=null===(i=e.selector)||void 0===i?void 0:i.metadata,_.isEmpty(a)?(b.fF.assertFail("Expect the slice.selector.metadata to be defined, it should correspond to a queryName"),[2]):[4,this.getFieldTypeAndFormatInfo(t,a)];case 1:return o=l.sent(),b.fF.assert(function(){return null!=o&&null!=o?.valueType},"Expect the matching field has data type and format info"),o&&null!=o?.valueType?(s=r(o),[4,this.formatInformationCacheService.updateCacheFromFormatInformation(t,a,s)]):[2];case 2:return l.sent(),this.visualAuthoringService.setVisualLevelFormatString(t,a,s?.formatString,!0),[2]}})})},n.prototype.getSingleFieldFormatGroup=function(e,t,r,i,a,o,s){var u,l=this,c=new S.mQ(new S.SS(e,"singleFieldVisualLevelFormatGroup"),function(f){return l.localizationService.get(f)});c.withDisplayName("Format_Options");var d=null===(u=i.getMetadata(o))||void 0===u?void 0:u.type;if(b.fF.assert(function(){return null!=d},"Expect the field ".concat(r," to have a data type")),this.featureSwitchService.featureSwitches.visualLevelFormatStringFullSupport){var v=(0,Ii.m)(d?.primitiveType)||"Number";this.checkToAddDataTypesDropdown(c,i,r,v);var h=a?.formatInformation;this.addFormatsDropdown(c,r,v,h),this.checkToAddCurrencyFormats(c,r,h,s),this.checkToAddNumericFormatControls(c,r,v,h),"Custom"===h?.format&&this.addCustomFormatStringSlices(c,t,r,d,"Visual_FormatCode")}else this.addCustomFormatStringSlices(c,t,r,d,"Format");return c.build()},n.prototype.addCustomFormatStringSlices=function(e,t,r,i,a){var s,l,o=this,u=function(n){var e;return n?.bool||n?.text||!(null===(e=n?.misc)||void 0===e||!e.sparkline)}(i);b.fF.assert(function(){return!u||!o.featureSwitchService.featureSwitches.visualLevelFormatStringFullSupport},"If the field does not support custom format string, we do not expect this function to be called when visualLevelFormatStringFullSupport is on"),u&&e.addSimpleSlice("noCustomFormatSupportMessage",function(){return new S.G_({descriptor:{objectName:it,selector:{metadata:r},propertyName:void 0},value:o.localizationService.get("CustomFormatString_Disabled_For_CertainTypedFields")}).build()});var c=null===(s=(0,Q.PQ)(t))||void 0===s?void 0:s.columnProperties;e.addSimpleSlice("singleFieldVisualLevelFormatString",new S.fq({descriptor:{objectName:it,propertyName:br,selector:{metadata:r}},value:null===(l=c?.[r])||void 0===l?void 0:l.formatString,placeholder:"Auto",validators:{maxLength:{type:5,value:255}}}).build(),function(d){d.withCustomDisplayName(a),u&&d.withDisabled(!0)}),function(n,e){n.addSimpleSlice("singleFieldVisualLevelFormatStringLearnMoreLink",new S.Vc({descriptor:{objectName:it,selector:{metadata:e},propertyName:void 0},value:function(){window.open("https://go.microsoft.com/fwlink/p/?LinkId=2099021","_blank")}}).build(),function(t){return t.withCustomDisplayName("LearnMore").withSuppressDisplayName(!0)})}(e,r)},n.prototype.checkToAddDataTypesDropdown=function(e,t,r,i){if((0,rt.jX)(t)){var a=this.getDataTypeDropdownItems(),o=_.find(a,function(s){return s.value===i});e.addSimpleSlice("dataTypeOptions",function(){return new S.uY({items:a,descriptor:{objectName:it,propertyName:zr,selector:{metadata:r}},value:o}).build()},function(s){s.withCustomDisplayName("DataType_Title")})}},n.prototype.addFormatsDropdown=function(e,t,r,i){var a=this.getFieldFormatOptions(r),o=_.map(a,function(u){return{value:JSON.stringify(u),displayName:u.displayLabel,label:u.displayLabel}}),s=_.findIndex(a,function(u){return function(n,e){return b.fF.assert(function(){return null!=e},"the given formatOption comes from the main format options dropdown and should never be null"),null!=n&&(b.fF.assert(function(){return"CurrencyCustom"!==e.formatString},"We do not expect the main format options dropdown to have CurrencyCustom"),(Li(n.format)?"CurrencyGeneral":n.format)===e.formatType&&(!n.dateTimeCustomFormat||("Custom"===n.format?"Custom"===e.formatType:n.dateTimeCustomFormat.formatGroup===e.dateTimePattern&&n.dateTimeCustomFormat.formatString===e.formatString)))}(i,u)}),l=-1!==s?o[s]:null;e.addSimpleSlice("formatOptions",function(){return new S.uY({items:o,descriptor:{objectName:it,propertyName:xi,selector:{metadata:t}},value:l}).build()},function(u){u.withCustomDisplayName("Format")})},n.prototype.checkToAddCurrencyFormats=function(e,t,r,i){var a=r?.format;if(Li(a)){var o=_.map(i,function(u){return{value:JSON.stringify(u),displayName:u.displayLabel,label:u.displayLabel}}),s=function(n){return"".concat(Rt(n.culture),"-").concat(Rt(n.currencySymbol),"-").concat(Rt(n.negativePattern),"-").concat(Rt(n.positivePattern))}(r?.currencyFormat),l=_.findIndex(i,function(u){return ja(u)===s});e.addSimpleSlice("currencyFormats",function(){return new S.uY({items:o,descriptor:{objectName:it,propertyName:Ai,selector:{metadata:t}},value:o[l]}).build()},function(u){u.withCustomDisplayName("Properties_Currency_Format")})}},n.prototype.checkToAddNumericFormatControls=function(e,t,r,i){return(0,p.__awaiter)(this,void 0,void 0,function(){var a=this;return(0,p.__generator)(this,function(o){return(0,po.R)(r,i,this.dateTimeFormatService)?(e.addSimpleSlice("percentageFormat",function(){return new S.bd({descriptor:Mi(t,ji),value:"Percentage"===i?.format}).build()},function(s){s.withCustomDisplayName("Properties_Percentage_Format")}),e.addSimpleSlice("thousandSeparatorFormat",function(){return new S.bd({descriptor:Mi(t,zi),value:i?.thousandSeparator}).build()},function(s){s.withCustomDisplayName("Properties_Thousands_Separator")}),e.addSimpleSlice("decimalPoints",function(){return new S.mu({descriptor:Mi(t,Oi),value:i?.accuracy,options:{minValue:{type:0,value:0},maxValue:{type:1,value:15}},placeholderText:a.localizationService.get("Visual_Auto")}).build()},function(s){s.withCustomDisplayName("Properties_Decimal_Places")}),[2]):[2]})})},n.prototype.getFieldFormatOptions=function(e){var o,t=this,r={formatType:"Custom",displayLabel:this.localizationService.get("Custom")},i={formatType:"Custom",displayLabel:this.localizationService.get("Custom"),dateTimePattern:"Custom"},a=!function(n){return"Text"===n||"Boolean"===n}(e);if((0,Va.E)(e)){var s=this.dateTimeFormatService.getApplicableCommonDateTimeFormats(e),l=this.dateTimeFormatService.getApplicableDateTimeFormats(e),u=(0,p.__spreadArray)((0,p.__spreadArray)([],s,!0),l,!0);b.fF.assert(function(){return null==_.find(u,function(v){return"Dynamic"===v.formatType})},"We do not expect a dateTime format item is in type Dynamic"),o=function(n){return _.map(n,function(e){return{formatType:e.formatType,displayLabel:e.displayLabel,formatString:e.formatString,dateTimePattern:e.pattern}})}(u),a&&(_.remove(o,function(v){return"Custom"===v.formatType}),o.unshift(i))}else{var c=this.dataModelService.getCompatibleFormats([e]);c=_.filter(c,function(v){return"Dynamic"!==v}),o=_.compact(_.map(c,function(v){var h=_.find(yo,function(f){return f.type===v});if(b.fF.assert(function(){return null!=h||"Custom"===v},"We expect to haven an entry for format type ".concat(v)),h)return{formatType:v,displayLabel:t.localizationService.get(h.displayLabelKey)}})),a&&o.push(r)}a||_.remove(o,function(v){return"Custom"===v.formatType});var d=_.uniqBy(o,function(v){return function(n){return"".concat(n.formatType,"-").concat(Rt(n.formatString))}(v)});return d},n.prototype.getFieldTypeAndFormatInfo=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return i=(0,Q.oJ)(e),(a=_.find(i,function(c){return c.name===t}))?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:[2];case 1:return o=u.sent(),s=null===(r=a.expr.getMetadata(o))||void 0===r?void 0:r.type,b.fF.assert(function(){return null!=s},"We expect the valueType of the field matching the given givenName to be defined"),[4,this.formatInformationCacheService.getFormatInformation(e,t)];case 2:return l=u.sent(),[2,{valueType:s,formatInformation:l?.formatInformation}]}})})},n.prototype.getDataTypeDropdownItems=function(){var e=this;return this.dataTypeDropdownItems||(this.dataTypeDropdownItems=_.map(So,function(t){return{value:t.type,displayName:e.localizationService.get(t.displayLabelKey),label:t.displayLabelKey}})),this.dataTypeDropdownItems},n.prototype.getVisualCalcService=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e;return(0,p.__generator)(this,function(t){switch(t.label){case 0:return null!=this.visualCalcServiceInternal?[3,2]:(e=this,[4,this.lazyScoped.get(vo.w)]);case 1:e.visualCalcServiceInternal=t.sent(),t.label=2;case 2:return[2,this.visualCalcServiceInternal]}})})},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(ho.D),D.\u0275\u0275inject(Va.u),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(Wr.O),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(Pa),D.\u0275\u0275inject(Ta.f),D.\u0275\u0275inject(Sr.H),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(mo.Q),D.\u0275\u0275inject(co.n))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function ja(n){return"".concat(Rt(n.culture),"-").concat(Rt(n.symbol),"-").concat(Rt(n.negativePattern),"-").concat(Rt(n.positivePattern))}function Mi(n,e){return{objectName:it,propertyName:e,selector:{metadata:n}}}function Li(n){return"CurrencyGeneral"===n||"CurrencyCustom"===n}function za(n){return{formatString:_.isEmpty(n)?void 0:n,format:"Custom",thousandSeparator:!1,currencyFormat:null,dateTimeCustomFormat:null}}function Rt(n){return n??""}var xo=[U.X,U.Y,U.Lu,U.oU,U.f4,U.Zp];function Oa(n,e,t,r){var i=e.layouts.withId(r),a=_.cloneDeep(i.position);b.fF.assertValue(a,"VisualContainer.position");var o=parseInt(n.value,10);if(!isNaN(o)&&null!=o){if(n.name===U.X)if(1!==r){var s=(0,Q.P4)((0,p.__assign)((0,p.__assign)({},a),{x:o}),e);a.x=s.x}else a.x=o;else n.name===U.Y?1!==r?(s=(0,Q.P4)((0,p.__assign)((0,p.__assign)({},a),{y:o}),e),a.y=s.y):a.y=o:n.name===U.Lu?a.width=o:n.name===U.oU&&(a.height=o);t.layoutAuthoring?t.layoutAuthoring.moveCanvasItemFromContract(e,a):b.fF.assertFail("layoutAuthoring should be provided for saving General slice")}}function Ma(n){return n.queryOptions||(n.queryOptions={}),n.queryOptions}function La(n,e){void 0===e&&(e=!0);var t=n.getCurrentSection();return _.chain(n.getAllSections()).filter(function(i){return!(!(1&i.type)||e&&i.name===t.name)}).map(function(i){return i.name}).value()}var ko=[U.X,U.Y,U.Lu,U.oU];function Ba(n){if(n)return Ea(n&&n.getWarnings())}function Ea(n){var e=n&&n.visualObjectWarnings;if(e){var t=_.reduce(e,function(r,i,a){var o=_.first(i),s=o&&_.first(o.warnings);return s&&(r[a]=s),r},{});return _.isEmpty(t)?void 0:t}}var Ra=C(18659),Ua=C(28340),ka=C(42145),Ga=C(18664),Bi=C(45545),Wa=C(34021),Ha=C(92374),Ho=C(47316),Cr=C(79154),Ei=C(48145),Ko=C(77200),Ka=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w,V,q){this.bookmarkService=e,this.conceptualSchemaProxy=t,this.dataSourcesService=r,this.displayNameService=i,this.explorationCapabilitiesService=a,this.explorationNavigationService=o,this.featureSwitchService=s,this.formattingSliceTransformerService=l,this.formFactorService=u,this.lazyScopedProvider=c,this.localizationService=d,this.runningVisualService=v,this.themeService=h,this.viewModeStateService=f,this.visualAuthoring=m,this.visualPluginOperationsService=g,this.visualPluginService=y,this.visualStylePresetService=w,this.visualLevelFormatStringHelperService=V,this.formattingObjectDefinitionsService=q}return n.prototype.getCardBuildingOptions=function(e,t){var r=this.explorationNavigationService.getCurrentExploration(),i=this.explorationCapabilitiesService.getCapabilities();if((0,J.Vz)(e)){var a=ve.XW,o=e.config.singleVisual.evaluatedObjects,s=ve.fU,l=e.config.singleVisual,u=l.visualType,c=this.visualPluginService.capabilities(l.visualType),v=this.visualPluginOperationsService,h={isScriptVisual:this.visualPluginService.isScriptVisual(u),isAnalysisVisual:v.isAnalysisVisual(u),isQueryVisual:v.isQueryVisual(u),isQnaVisual:v.isQnaVisual(u)},f=this.themeService.getVisualStyle(r.themeCollection);return{allowConditionalFormatting:!(h.isScriptVisual||h.isAnalysisVisual||h.isQnaVisual),capabilities:c,container:e,descriptors:a,exploration:r,evaluatedObjects:o,explorationCapabilities:i,featureSwitches:t,props:s,visualKind:h,visualStyle:f,isQueryVisualWithoutData:(0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e)}}return{allowConditionalFormatting:!1,container:e,descriptors:a=ve.XW,exploration:r,evaluatedObjects:o=e.evaluatedObjects,explorationCapabilities:i,featureSwitches:t,props:s=Ra.fU}},n.prototype.getModelUnavailableInformation=function(e){if(!e)return{messageKey:"PropertyPane_Unavailable"};if((0,J.q4)(e))return{messageKey:void 0};if((0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))return{messageKey:"Add_Data_To_Visual"};if((0,ce.D1)(e))return{messageKey:"UnhideVisual"};var t=this.runningVisualService.getVisual(e);return null==(t&&t.getAdapter())?{messageKey:"PropertyPane_VisualErrorMessage"}:t.getHasPendingChanges()?{messageKey:"Formatting_Pane_Disabled_Paused"}:{messageKey:"PropertyPane_Unavailable"}},n.prototype.getFormattingModel=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,a,s,l,u,c,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return e?[4,this.featureSwitchService.getFeatureSwitches()]:[2,{cards:[]}];case 1:if(t=m.sent(),r=this.getCardBuildingOptions(e,t),i=(0,J.Vz)(e),(0,J.Vz)(e)){if((a=r.isQueryVisualWithoutData)&&!t.onObject||(0,ce.D1)(e))return[2,{cards:[]}];if(null==((f=this.runningVisualService.getVisual(e))&&f.getAdapter())&&!a||f&&f.getHasPendingChanges()||f&&f.getErrorInfo())return[2,{cards:[]}]}return l=S.Nq.bind,(u=!t.onObject)?[4,this.getPropertiesCard(r)]:[3,3];case 2:u=m.sent(),m.label=3;case 3:return c=[void 0,u],(d=!t.onObject&&i)?[4,this.getTitleCard(r,t)]:[3,5];case 4:d=m.sent(),m.label=5;case 5:return c=c.concat([d,!t.onObject&&this.getEffectsCard(r)]),(v=t.visualLevelFormatStringConsumption&&t.visualLevelFormatStringAuthoring&&t.visualCalculationsAuthoring)?[4,this.getVisualLevelFormattingCard(r)]:[3,7];case 6:v=m.sent(),m.label=7;case 7:return c=c.concat([v,this.getHeaderIconsCard(r),this.getTooltipsCard(r),this.getAltTextCard(r)]),(h=t.onObject)?[4,this.getAdvancedOptionsCard(r)]:[3,9];case 8:h=m.sent(),m.label=9;case 9:return s=new(l.apply(S.Nq,c.concat([h]))),i&&(f=this.runningVisualService.getVisual(e),s.withWarnings(Ba(f))),[2,s.build()]}})})},n.prototype.getObjectDefinitions=function(e,t){if(e)return(0,J.Vz)(e)?function(n,e){var t,r;return(0,Q.jt)([e])||(0,Q.Wu)([e])?(0,p.__assign)((0,p.__assign)({},n??{}),((t={})[it]=[{properties:(r={},r[br]={},r[zr]={},r)}],t)):n}(t&&this.formattingObjectDefinitionsService?this.formattingObjectDefinitionsService.getVcObjectDefinitions(e):e.config.singleVisual.vcObjects,e):e.objects},n.prototype.getObjectDescriptors=function(e){return(0,J.Vz)(e)?ve.XW:Ra.C7},n.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"Formatting",itemTypeDisplayName:(0,ce.um)(e,this.featureSwitchService)}},n.prototype.saveProperties=function(e,t,r,i){var a=this,o=this.formFactorService.getCurrentLayout();if((0,J.Vz)(r)){if(this.featureSwitchService.featureSwitches.onObject){var s=this.runningVisualService.getVisual(r);b.fF.assert(function(){return _.every(e,function(f){return null!=f.visualUpdateSource})},"All changes should have a visual update source");var l=[],u=_.groupBy(e,function(f){return f.visualUpdateSource});for(var c in u){var v=u[c].map(function(f){return(0,ce.H8)(f)});l.push.apply(l,s.onDataViewObjectChanged(v,+c,!1))}b.fF.assertNonEmpty(l,"There should be at least one visual object change"),l.map(function(f){return(0,ce.nH)(r,f)}).forEach(function(f){return a.saveVisualContainerProperties(f.objectName,t,r,f.propertySlice,o)})}else e.forEach(function(f){a.saveVisualContainerProperties(f.objectName,t,r,f.propertySlice,o)});t.visualAuthoring.raiseVisualContainerChanged(r,{parentContextActivity:i})}else e.forEach(function(f){a.saveVisualContainerGroupProperties(f.objectName,t,r,f.propertySlice,o)}),t.visualAuthoring.raiseVisualContainerGroupChanged(r)},n.prototype.saveVisualContainerProperties=function(e,t,r,i,a){!function(n,e,t,r,i,a){if((0,J.Vz)(t)){var o=t.config.singleVisual;r.telemetryService&&function(n,e,t,r){var i=e.name;if(n!==U.LQ||i!==U.f4&&i!==U.Zp)if(n===U.yD){var s=void 0;"type"===i?s=""+e.value:"section"===i&&(s=e.value===At.pJ?At.pJ:"custom"),r.logEvent(xe.Lo,{objectName:n,propertyName:i,newValue:s,visualType:t})}else n===it&&i===br&&r.logEvent(xe.Lo,{objectName:n,propertyName:i,newValue:"Custom",visualType:t});else r.logEvent(xe.Lo,{objectName:n,propertyName:i,newValue:e.value,visualType:t})}(n,e,o.visualType,r.telemetryService),n===U.H&&function(n,e){var t,r=e.visualStylePresetService,i=e.themeService;if(r&&i){var a=null===(t=n.evaluatedObjects)||void 0===t?void 0:t.stylePreset,s=r.getStylePreset(n.visualType,a&&a.name);if(s){var l=i.getVisualStyle({}),u=s.evaluate(l);(0,fe.Gc)(n.objects,u),(0,fe.Gc)(n.vcObjects,u)}}}(o,r),n===U.TY&&function(n){if(n.evaluatedObjects){var e=n.evaluatedObjects.dropShadow;if(e&&e.preset&&e.preset!==ve.$g){var t=(0,Fa.X2)(e.preset,e.position);if(t){var r=(0,De.cA)(t.angle),i=(0,De.cA)(t.shadowDistance),a=(0,De.cA)(t.shadowBlur),o=(0,De.cA)(t.shadowSpread),s=(0,De.cA)(t.transparency);(0,fe.sO)(n.vcObjects,{objectName:U.TY,propertyName:"angle"},null,r),(0,fe.sO)(n.vcObjects,{objectName:U.TY,propertyName:"shadowDistance"},null,i),(0,fe.sO)(n.vcObjects,{objectName:U.TY,propertyName:"shadowBlur"},null,a),(0,fe.sO)(n.vcObjects,{objectName:U.TY,propertyName:"shadowSpread"},null,o),(0,fe.sO)(n.vcObjects,{objectName:U.TY,propertyName:"transparency"},null,s)}}}}(o),n===it?a.saveSlice(n,e,t):n===U.LQ&&function(n){return _.includes(xo,n.name)}(e)?function(n,e,t,r){var i=e.config.singleVisual;n.name===U.f4?Ma(i).allowBinnedLineSample=!!n.value:n.name===U.Zp?Ma(i).allowOverlappingPointsSample=!!n.value:Oa(n,e,t,r)}(e,t,r,i):(o.vcObjects=o.vcObjects||{},Zr(n,e,o.vcObjects,r),o.autoSelectVisualType=void 0)}}(e,i,r,t,a,this.visualLevelFormatStringHelperService)},n.prototype.saveVisualContainerGroupProperties=function(e,t,r,i,a){!function(n,e,t,r,i){(0,J.q4)(t)&&(n===U.LQ&&function(n){return _.includes(ko,n.name)}(e)?Oa(e,t,r,i):(t.objects=t.objects||{},Zr(n,e,t.objects,r)))}(e,i,r,t,a)},n.prototype.revertVisualSlicesToDefinitions=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d;return(0,p.__generator)(this,function(v){switch(v.label){case 0:r=[],i=(0,ce.Wx)(e),a=0,o=i,v.label=1;case 1:return a<o.length?(r.push(l=(s=o[a]).canvasItem),u=s.descriptors,c=void 0,(0,J.Vz)(l)?((c=(d=l.config.singleVisual).vcObjects)||(d.vcObjects=c={}),[4,this.resetVisualProperty(l,u)]):[3,3]):[3,6];case 2:return v.sent(),[3,4];case 3:(c=l.objects)||(l.objects=c={}),v.label=4;case 4:(0,ce.Aw)(c,u),v.label=5;case 5:return a++,[3,1];case 6:return this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t}),[2]}})})},n.prototype.resetVisualProperty=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a;return(0,p.__generator)(this,function(o){switch(o.label){case 0:r=0,i=t,o.label=1;case 1:return r<i.length?(a=i[r]).objectName!==it?[3,3]:[4,this.visualLevelFormatStringHelperService.resetProperty(e,a.propertyName)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},n.prototype.resolvePlaceholder=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,a;return(0,p.__generator)(this,function(s){switch(s.label){case 0:if(!(0,S.Xo)(e))return[3,9];switch(e.name){case"actions":return[3,1];case"title":return[3,3];case"sizeAndStyle":return[3,5]}return[3,7];case 1:return[4,this.resolveActionCardPlaceholder(t,e.suppressDefaultValue)];case 2:return r=s.sent(),[3,8];case 3:return[4,this.resolveTitleCardPlaceholder(t)];case 4:return r=s.sent(),[3,8];case 5:return[4,this.resolveVisualSizeAndStyleCardPlaceholder(t)];case 6:return r=s.sent(),[3,8];case 7:b.fF.assertNever(e.name),s.label=8;case 8:return b.fF.assert(function(){return!!r||e.suppressDefaultValue},"Expected either a placeholder or default value being suppressed"),[2,r];case 9:return(0,S.G8)(e)?(b.fF.assertNever(e.name),[3,15]):[3,10];case 10:return(0,S.Kw)(e)?"stylePreset"===(a=void 0,e.name)?[3,11]:[3,13]:[3,15];case 11:return[4,this.resolveStylePresetSlicePlaceholder(t)];case 12:return a=s.sent(),[3,14];case 13:b.fF.assertNever(e.name),s.label=14;case 14:return[2,a];case 15:return b.fF.assertFail("Unexpected host placeholder"),[2]}})})},n.prototype.resolveActionCardPlaceholder=function(e,t){var r,i;return(0,p.__awaiter)(this,void 0,void 0,function(){var a,o,s,l,u,d,v,h,f,m,g,y,w=this;return(0,p.__generator)(this,function(V){switch(V.label){case 0:return(0,J.q4)(e)?[2,this.resolveActionCardPlaceholderDefault(t)]:[4,this.featureSwitchService.getFeatureSwitches()];case 1:return a=V.sent(),o=e.config.singleVisual.evaluatedObjects,s=ve.fU.visualLink,u=(l=e.config.singleVisual).visualType,this.visualPluginService.capabilities(l.visualType).supportsVisualLink?(d=ve.eJ,v=null!==(r=o?.visualLink)&&void 0!==r?r:{show:!1,type:d},h=null!==(i=v.type)&&void 0!==i?i:d,f=ve.Dy.members().map(function(q){return q.value}),a.applyAllSlicersButton||(h!==ve.cy&&_.remove(f,function(q){return q===ve.cy}),h!==ve.WM&&_.remove(f,function(q){return q===ve.WM})),h!==ve.d8&&h!==ve.Ol&&(!a.drillthroughButtonGA&&(u===Je.L.basicShape.name||u===Je.L.image.name)&&_.remove(f,function(q){return q===ve.d8}),!a.navAndDrillthroughActionTypes&&u===Je.L.actionButton.name&&_.remove(f,function(q){return q===ve.d8||q===ve.Ol})),(u===Je.L.basicShape.name||u===Je.L.image.name)&&_.remove(f,function(q){return q===ve.Ol}),(g=v.type===ve.Ol)?[4,this.lazyScopedProvider.get("drillthrough")]:[3,3]):[2,this.resolveActionCardPlaceholderDefault(t)];case 2:g=V.sent(),V.label=3;case 3:return m=g,[2,{item:y=new S.CQ(new S.lg("action"),"Visual_VisualLink",[s.show,s.type,s.bookmark,s.navigationSection,s.drillthroughSection,s.webUrl,s.suppressDefaultTooltip,s.showDefaultTooltip,s.tooltip,s.enabledTooltip,s.disabledTooltip],function(q){return w.localizationService.get(q)}).addTopLevelToggle("show",function(){return new S.bd({descriptor:s.show,value:!!v.show}).build()}).addGroup("action",function(q){var F,N;q.withDisplayName("Visual_VisualLink").addSimpleSlice("type",new S.uY({descriptor:s.type,value:h,filterValues:f}).build());var P,T=[{displayName:function(Re){return Re.get("None")},value:ve.Qi}],O=v.type===ve.rp,E=ve.Qi;if(O){var L=w.bookmarkService.getAllBookmarks(),B=_.map(L,function(Pe){return Pe.name});P=(0,p.__spreadArray)((0,p.__spreadArray)([],_.map(T,function(Pe){return Pe.value}),!0),B||[],!0);var A=v.bookmark;A&&-1!==P.indexOf(A)&&(E=A)}q.addSimpleSlice("bookmark",new S.uY({descriptor:s.bookmark,value:E,mergeValues:T,filterValues:P}).build(),function(Pe){return Pe.withDisabled(!O)});var z={displayName:function(Re){return Re.get("None")},value:ve.z1};if(v.type===ve.d8||v.type===ve.Ol){var R=[z],G=w.explorationNavigationService,ne=G.getAllSections(),oe=G.getCurrentSection();if(v.type===ve.d8){var ee=_.map(ne,function(Pe){return Pe.name}),le=(0,p.__spreadArray)((0,p.__spreadArray)([],_.map(R,function(Pe){return Pe.value}),!0),_.filter(ee,function(Pe){return Pe!==oe.name}),!0),Fe=null!==(F=v.navigationSection)&&void 0!==F?F:z.value;q.addSimpleSlice("pageNavigationDestination",new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},s.navigationSection),{instanceKind:a.drillthroughButtonGA?3:1}),value:Fe,filterValues:le,mergeValues:R}).build())}else if(v.type===ve.Ol){var Ye=_.filter(ne,function(Re){return m&&!_.isEmpty(m.getDrillthroughParameters(Re.name))}),et=_.map(Ye,function(Re){return Re.name}),We=(le=(0,p.__spreadArray)((0,p.__spreadArray)([],_.map(R,function(Re){return Re.value}),!0),_.filter(et,function(Re){return Re!==oe.name}),!0),null!==(N=v.drillthroughSection)&&void 0!==N?N:z.value);q.addSimpleSlice("drillthroughDestination",new S.uY({descriptor:(0,p.__assign)((0,p.__assign)({},s.drillthroughSection),{instanceKind:a.drillthroughButtonGA?3:1}),value:We,filterValues:le,mergeValues:R}).build())}}else q.addSimpleSlice("defaultDestination",new S.uY({descriptor:s.drillthroughSection,value:(0,p.__assign)((0,p.__assign)({},z),{displayName:w.localizationService.get("None")}),items:[z]}).build(),function(Pe){return Pe.withDisabled(!0)});q.addSimpleSlice("webUrl",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.webUrl),{instanceKind:3}),value:v.webUrl,placeholder:""}).build(),function(Pe){return Pe.withDisabled(v.type!==ve.ZS)})}).addGroup("tooltip",function(q){var F;q.withDisplayName("Tooltip");var N=null===(F=v.showDefaultTooltip)||void 0===F||F,T=a.showDefaultTooltip?!N:!!v.suppressDefaultTooltip;a.suppressDefaultTooltip&&(a.showDefaultTooltip?q.addTopLevelToggle("showDefaultTooltip",function(){return new S.bd({descriptor:s.showDefaultTooltip,value:N}).build()}):q.addSimpleSlice("suppressDefaultTooltip",new S.bd({descriptor:s.suppressDefaultTooltip,value:!!v.suppressDefaultTooltip}).build())),v.type!==ve.Ol?q.addSimpleSlice("text",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.tooltip),{instanceKind:3}),value:v.tooltip,placeholder:v.tooltipPlaceholderText}).build(),function(P){return P.withCustomDisplayName("Text").withDisabled(T)}):q.addSimpleSlice("enabledText",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.enabledTooltip),{instanceKind:a.drillthroughButtonGA?3:1}),value:v.enabledTooltip,placeholder:""}).build(),function(P){return P.withCustomDisplayName("Enabled_Text").withDisabled(T)}).addSimpleSlice("disabledText",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},s.disabledTooltip),{instanceKind:a.drillthroughButtonGA?3:1}),value:v.disabledTooltip,placeholder:""}).build(),function(P){return P.withCustomDisplayName("Disabled_Text").withDisabled(T)})}).build(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:y.revertToDefaultDescriptors}]}})})},n.prototype.resolveTitleCardPlaceholder=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return(0,J.q4)(e)?[2]:[4,this.featureSwitchService.getFeatureSwitches()];case 1:return t=a.sent(),r=this.getCardBuildingOptions(e,t),b.fF.assert(function(){return!1===r.isQueryVisualWithoutData},"Expected query visual to have data"),[4,this.getTitleCard(r,t)];case 2:return[2,{item:i=a.sent(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:i.revertToDefaultDescriptors}]}})})},n.prototype.resolveVisualSizeAndStyleCardPlaceholder=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i;return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return t=a.sent(),r=this.getCardBuildingOptions(e,t),[4,this.getVisualSizeAndStyleCard(r)];case 2:return[2,{item:i=a.sent(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:i.revertToDefaultDescriptors}]}})})},n.prototype.resolveStylePresetSlicePlaceholder=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,i,a,s,l,c=this;return(0,p.__generator)(this,function(d){return(0,J.Vz)(e)&&(s=this.visualStylePresetService.getStylePreset((t=e.config.singleVisual).visualType,(a=(i=t.evaluatedObjects)&&i.stylePreset)&&a.name))?(l=ve.fU.stylePreset,[2,{item:new S.vi({uidBuilder:new S.IN(new S.SS(new S.lg("stylePreset"),"style"),"layout"),control:new S.uY({descriptor:l.name,value:s.name}).build(),localize:function(h){return c.localizationService.get(h)}}).build(),objectDescriptors:this.getObjectDescriptors(e),revertToDefaultDescriptors:[l.name]}]):[2]})})},n.prototype.resolveActionCardPlaceholderDefault=function(e){var t,r,i=this;if(!e){var a={objectName:"defaultVisualLinkObject",propertyName:"defaultVisualLinkProperty"},o=((t={})[a.objectName]={properties:(r={},r[a.propertyName]={type:{bool:!0}},r)},t);return{item:new S.CQ(new S.lg("action"),"Visual_VisualLink",[a],function(s){return i.localizationService.get(s)}).addTopLevelToggle("show",function(){return new S.bd({descriptor:a,value:!1}).build()}).withDisabled(!0,"Visual_VisualLink_DisabledReason").build(),objectDescriptors:o,revertToDefaultDescriptors:[a]}}},n.prototype.addAdvancedOptionsGroup=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,s,l,u,c,d,v,h,f,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return a=e.evaluatedObjects,s=ve.fU.general,(0,J.Vz)(i=e.container)?(u=(l=e).capabilities,c=a,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:d=g.sent(),v=d.schema(void 0).capabilities,h=i.config.singleVisual,(f=v.supportsBinnedLineSample)&&(f=function(n,e,t,r){if(!n?.query||!e||!e.dataViewMappings)return!1;var i=n.query,a=(0,Q.i1)(i),o=(0,uo.Lo)(i.projections,e.dataViewMappings,a,r,e.objects,n.objects,i.defn.select(),t);return _.some(o.supportedMappings,function(s){var l=!1;return(0,Na.oF)(s,{visitRole:function(c){},visitReduction:function(c){l=l||!!c.binnedLineSample}}),l})}(h,u,d,e.featureSwitches)),(m=v.supportsOverlappingPointsSample)&&(m=function(n){return!(!n||!n.dataViewMappings)&&_.some(n.dataViewMappings,function(e){var t=!1;return(0,Na.oF)(e,{visitRole:function(i){},visitReduction:function(i){t=t||!!i.overlappingPointsSample}}),t})}(u)),t.addGroup("advancedOptions",function(y){var w=c&&c.general;y.withDisplayName(r).addSlicePlaceholder((0,S.Q)("responsive")).addSimpleSlice("keepLayerOrder",new S.bd({descriptor:s.keepLayerOrder,value:!(!w||!w.keepLayerOrder)}).build()),f?y.addSimpleSlice("highDensitySampling",new S.bd({descriptor:s.allowBinnedLineSample,value:!(h.queryOptions&&!1===h.queryOptions.allowBinnedLineSample)}).build(),function(V){l.isQueryVisualWithoutData&&V.withDisabled(!0,"Add_Data_To_Format")}):m&&y.addSimpleSlice("overlappingPointSampling",new S.bd({descriptor:s.allowOverlappingPointsSample,value:!(!m||h.queryOptions&&!1===h.queryOptions.allowOverlappingPointsSample)}).build(),function(V){l.isQueryVisualWithoutData&&V.withDisabled(!0,"Add_Data_To_Format")}),l.isQueryVisualWithoutData||y.addSlicePlaceholder((0,S.Q)("dataVolume"))}),g.label=2;case 2:return[2]}})})},n.prototype.addSizeSlices=function(e,t,r,i){var o=t.evaluatedObjects,s=t.props,l=s.general,u={x:i&&i.x,y:i&&i.y,width:i&&i.width,height:i&&i.height};e.addSimpleSlice("height",function(){return new S.mu({descriptor:l.height,value:u.height,options:{minValue:{type:0,value:_e.MinContainerHeight},maxValue:{type:1,value:r.height-u.y},required:{type:2}}}).build()}).addSimpleSlice("width",function(){return new S.mu({descriptor:l.width,value:u.width,options:{minValue:{type:0,value:_e.MinContainerWidth},maxValue:{type:1,value:r.width-u.x},required:{type:2}}}).build()}).addSimpleSlice("lockAspect",function(){var d=o&&o[s.lockAspect.show.objectName];return new S.bd({descriptor:s.lockAspect.show,value:!(!d||!d.show)}).build()},function(c){return c.withCustomDisplayName("VisualContainer_Properties_LockAspect")})},n.prototype.addPositionSlices=function(e,t,r,i){var s=t.props.general,l={x:i&&i.x,y:i&&i.y,width:i&&i.width,height:i&&i.height};e.addSimpleSlice("horizontal",function(){return new S.mu({descriptor:s.x,value:l.x,options:{minValue:{type:0,value:0},maxValue:{type:1,value:r.width-l.width},required:{type:2}}}).build()},function(u){return u.withCustomDisplayName("Slicer_Orientation_Horizontal")}).addSimpleSlice("vertical",function(){return new S.mu({descriptor:s.y,value:l.y,options:{minValue:{type:0,value:0},maxValue:{type:1,value:r.height-l.height},required:{type:2}}}).build()},function(u){return u.withCustomDisplayName("Slicer_Orientation_Vertical")})},n.prototype.addPaddingSlice=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,s,l,u,c,d,v,h,f,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return r=(m=t).evaluatedObjects,a=m.container,s=m.props.padding,u=(i=m.capabilities).suppressDefaultTitle,!1!==(l=r?.title||{}).show||null==l.text?(c=a.config.singleVisual,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]):[3,2];case 1:d=g.sent(),l=this.displayNameService.getVisualTitle(c,d,i,l),g.label=2;case 2:return v=!!l.text&&(l.show||!(0,At.xj)(l,u)),h=(0,Q.hp)(r?.padding,i,v),f={minValue:{type:0,value:0},maxValue:{type:1,value:20},unitSymbol:qe.e_},e.addCompositeSlice("padding","Visual_Padding",(new S.uM).withTop({descriptor:s.top,value:h.top,options:f}).withBottom({descriptor:s.bottom,value:h.bottom,options:f}).withLeft({descriptor:s.left,value:h.left,options:f}).withRight({descriptor:s.right,value:h.right,options:f}).build(),function(y){return y.withSuppressDisplayName(!0)}),[2]}})})},n.prototype.addGeneralSizeGroups=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,s,l,c,d,h,f=this;return(0,p.__generator)(this,function(m){return r=e.container,i=e.featureSwitches,a=this.formFactorService.getCurrentLayout(),o=r.layouts.withId(a).position,s=(0,Q.hP)(o,a,r.parentGroup),l={x:Math.floor(s.x),y:Math.floor(s.y),width:Math.floor(s.width),height:Math.floor(s.height)},1===this.formFactorService.getCurrentLayout()?c={height:Jr.aW,width:Jr.Co}:(d=this.explorationNavigationService.getCurrentSection(),c=d.size),e.featureSwitches.onObject?t.addGroup("sizeAndPosition",function(g){g.withDisplayName("Visual_Size_And_Position"),f.addSizeSlices(g,e,c,l),f.addPositionSlices(g,e,c,l)}):t.addGroup("size",function(g){g.withDisplayName("Visual_BubbleSize"),f.addSizeSlices(g,e,c,l)}).addGroup("position",function(g){g.withDisplayName("Visual_Position"),f.addPositionSlices(g,e,c,l)}),i.vcPadding&&(0,J.Vz)(r)&&(h=e.isQueryVisualWithoutData,t.addGroup("padding",function(g){return(0,p.__awaiter)(f,void 0,void 0,function(){return(0,p.__generator)(this,function(y){switch(y.label){case 0:return g.withDisplayName("Visual_Padding"),h?[3,2]:[4,this.addPaddingSlice(g,e)];case 1:return y.sent(),[3,3];case 2:g.withDisabled(!0,"Add_Data_To_Format"),y.label=3;case 3:return[2]}})})})),[2]})})},n.prototype.addGeneralStyleGroups=function(e,t){var r,i=this,a=e.allowConditionalFormatting,o=e.container,s=e.evaluatedObjects,u=e.props.background,c=ve.fU.border,d=ve.fU.dropShadow,v=function(y){return i.localizationService.get(y)};if(t.addGroup("background",function(g){var y=s&&s[u.show.objectName];g.withDisplayName("Visual_Background"),(0,J.Vz)(o)&&e.isQueryVisualWithoutData?g.withDisabled(!0,"Add_Data_To_Format"):g.addTopLevelToggle("show",function(){return new S.bd({descriptor:u.show,value:y&&null!=y.show?y.show:(0,Bi.kB)()}).build()}).addSimpleSlice("color",function(){var q,N={value:null===(q=(y&&null!=y.color?y.color:(0,Bi.WO)()).solid)||void 0===q?void 0:q.color};return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},u.color),{instanceKind:a&&3}),value:N}).build()}).addSimpleSlice("transparency",function(){var q=y&&null!=y.transparency?y.transparency:(0,Bi.x6)();return S.JN.getTransparencySliderBuilder({descriptor:u.transparency,value:q,localize:v}).build()})}),(0,J.Vz)(o)){var h=(r=e).evaluatedObjects,f=r.visualStyle,m=r.isQueryVisualWithoutData;t.addGroup("visualBorder",function(g){var y,w,V=h&&h.border||{},q=(0,Wa.O4)();g.withDisplayName("VisualBorder"),m?g.withDisabled(!0,"Add_Data_To_Format"):(g.addTopLevelToggle("show",function(){var F;return new S.bd({descriptor:c.show,value:null!==(F=V.show)&&void 0!==F?F:q.show}).build()}).addSimpleSlice("color",function(){var F,N=null!==(F=V.color)&&void 0!==F?F:q.color,T=N&&N.solid&&N.solid.color;return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},c.color),{instanceKind:a&&3}),value:void 0!==T?{value:T}:void 0}).build()}).addSimpleSlice("roundedCorners",new S.JN({descriptor:c.radius,value:null!==(y=V.radius)&&void 0!==y?y:q.radius,options:{minValue:{type:0,value:0},maxValue:{type:1,value:30},unitSymbol:qe.e_},localize:v}).build(),function(F){return F.withCustomDisplayName("VisualContainer_Border_RoundedCorners")}),i.featureSwitchService.featureSwitches.visualBorderWidth&&g.addSimpleSlice("width",new S.mu({descriptor:c.width,value:null!==(w=V.width)&&void 0!==w?w:Wa.GC,options:{minValue:{type:0,value:1},maxValue:{type:1,value:99},unitSymbol:qe.e_}}).build(),function(F){return F.withCustomDisplayName("Visual_General_Properties_Width")}))}).addGroup("shadow",function(g){var y,w,V,q,F,N,T,P,O=h&&h.dropShadow||{},E=(0,Fa.O4)(O,f);g.withDisplayName("Visual_DropShadow"),m?g.withDisabled(!0,"Add_Data_To_Format"):(g.addTopLevelToggle("show",function(){var B;return new S.bd({descriptor:d.show,value:null!==(B=O.show)&&void 0!==B?B:E.show}).build()}).addSimpleSlice("color",function(){var B,A=null!==(B=O.color)&&void 0!==B?B:E.color,z=A&&A.solid&&A.solid.color;return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},d.color),{instanceKind:a&&3}),value:void 0!==z?{value:z}:void 0}).build()}).addSimpleSlice("offset",new S.uY({descriptor:d.position,value:null!==(y=O.position)&&void 0!==y?y:E.position}).build(),function(B){return B.withCustomDisplayName("Offset")}).addSimpleSlice("position",new S.uY({descriptor:d.preset,value:null!==(w=O.preset)&&void 0!==w?w:E.preset}).build(),function(B){return B.withCustomDisplayName("Visual_Position")}),(null!==(V=O.preset)&&void 0!==V?V:E.preset)===ve.$g&&g.addSimpleSlice("size",new S.JN({descriptor:d.shadowSpread,value:null!==(q=O.shadowSpread)&&void 0!==q?q:E.shadowSpread,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:qe.e_},localize:v}).build()).addSimpleSlice("blur",new S.JN({descriptor:d.shadowBlur,value:null!==(F=O.shadowBlur)&&void 0!==F?F:E.shadowBlur,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:qe.e_},localize:v}).build()).addSimpleSlice("angle",S.JN.getRotationSliderBuilder({descriptor:d.angle,value:null!==(N=O.angle)&&void 0!==N?N:E.angle,localize:v}).build()).addSimpleSlice("distance",new S.JN({descriptor:d.shadowDistance,value:null!==(T=O.shadowDistance)&&void 0!==T?T:E.shadowDistance,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:qe.e_},localize:v}).build()).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:d.transparency,value:null!==(P=O.transparency)&&void 0!==P?P:E.transparency,localize:v}).build()))})}},n.prototype.getPropertiesCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,a,o,s,l,u=this;return(0,p.__generator)(this,function(c){switch(c.label){case 0:return s=[(r=(t=e.props).general).height,r.width,t.lockAspect.show,r.x,r.y,(o=(i=ve.fU).padding).top,o.bottom,o.left,o.right,(a=i.general).keepLayerOrder,a.allowBinnedLineSample,a.allowOverlappingPointsSample],l=new S.CQ(new S.lg("properties"),"Properties",s,function(d){return u.localizationService.get(d)}),[4,this.addGeneralSizeGroups(e,l)];case 1:return c.sent(),[4,this.addAdvancedOptionsGroup(e,l,"AdvancedOptions")];case 2:return c.sent(),[2,l.build()]}})})},n.prototype.getAdvancedOptionsCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o=this;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return i=[(r=ve.fU.general).keepLayerOrder,r.allowBinnedLineSample,r.allowOverlappingPointsSample],a=new S.CQ(new S.lg("advancedOptions"),"AdvancedOptions",i,function(l){return o.localizationService.get(l)}),[4,this.addAdvancedOptionsGroup(e,a)];case 1:return s.sent(),[2,a.build()]}})})},n.prototype.getTitleCard=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w,V,q,F,N,T,P=this;return(0,p.__generator)(this,function(O){switch(O.label){case 0:return r=e.allowConditionalFormatting,(0,J.q4)(i=e.container)||(a=e).isQueryVisualWithoutData?[2]:(u=a.visualStyle,c=(o=a.props).title,d=o.divider,v=o.subTitle,h=o.spacing,f=(l=a.evaluatedObjects)&&l.title||{},m=l&&l.subTitle||{},g=i.config.singleVisual,y=(s=a.capabilities).suppressDefaultTitle,[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]);case 1:return w=O.sent(),null==f.text&&(f=this.displayNameService.getVisualTitle(g,w,s,f)),t.vcPadding&&null==m.text&&(m=this.displayNameService.getVisualSubTitle(g,w,s,m))&&f?.isGeneratedText&&m?.isGeneratedText&&(f.text=f.titleComponents.title,m.text=m.titleComponents.subtitle),V=Te.v.create(u),q=(0,Ga.Zi)(f,{size:"fontSize",family:"fontFamily",color:"fontColor"},V,u,void 0,Q.Hf,Q.o8),F=(new S.UN).withFontFamily({descriptor:c.fontFamily,value:q.family}).withFontSizeProperties({descriptor:c.fontSize,value:q.size.pt}).withBold({descriptor:c.bold,value:f.bold||!1}).withItalic({descriptor:c.italic,value:f.italic||!1}).withUnderline({descriptor:c.underline,value:f.underline||!1}),N=F.build(),(T=new S.CQ(new S.lg("title"),"Title",[c.show,c.text,c.heading,c.fontFamily,c.fontSize,c.bold,c.italic,c.underline,c.fontColor,c.background,c.alignment,c.titleWrap,v.show,v.text,v.heading,v.fontFamily,v.fontSize,v.bold,v.italic,v.underline,v.fontColor,v.alignment,v.titleWrap,d.show,d.ignorePadding,d.color,d.width,d.style,h.customizeSpacing,h.spaceBelowSubTitle,h.spaceBelowTitle,h.spaceBelowTitleArea,h.verticalSpacing],function(E){return P.localizationService.get(E)})).withDescription("Visual_TitleDescription").addTopLevelToggle("show",function(){return new S.bd({descriptor:c.show,value:f.show||!(0,At.xj)(f,y)}).build()},function(E){return E.withNoDefaultImpact(y)}),T.addGroup("text",function(E){t.vcPadding&&E.withDisplayName("Title"),E.addSimpleSlice("text",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},c.text),{instanceKind:r&&3}),placeholder:"",value:f.text||""}).build(),function(L){return L.withCustomDisplayName("Text")}).addSimpleSlice("heading",new S.uY({descriptor:c.heading,value:f.heading||Q.PY}).build(),function(L){return L.withCustomDisplayName("Visual_AzureMapsHeading")}).addCompositeSlice("font","Font",N).addSimpleSlice("textColor",new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},c.fontColor),{instanceKind:r&&3}),value:{value:q.color}}).build(),function(L){return L.withCustomDisplayName("Text_Color")}).addSimpleSlice("backgroundColor",function(){var L,B,A=null===(B=null===(L=f.background)||void 0===L?void 0:L.solid)||void 0===B?void 0:B.color;return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},c.background),{instanceKind:r&&3}),value:{value:A},isNoFillItemSupported:!0}).build()},function(L){return L.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new S.Gp({descriptor:c.alignment,value:f.alignment||Ha.D.left,mode:"horizontalAlignment"}).build(),function(L){return L.withCustomDisplayName("Visual_Alignment_Horizontal")}).addSimpleSlice("wrapText",new S.bd({descriptor:c.titleWrap,value:!!f.titleWrap}).build(),function(L){return L.withCustomDisplayName("TextWrap")})}),t.vcPadding?[4,this.getSubTitleGroup(e,t,T,m)]:[3,3];case 2:O.sent(),this.getDividerGroup(e,T),this.getSpacingGroup(e,T),O.label=3;case 3:return[2,T.build()]}})})},n.prototype.getSubTitleGroup=function(e,t,r,i){var a;return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l,c,d,v,h,f,m,g,y,w,V;return(0,p.__generator)(this,function(q){switch(q.label){case 0:return o=e.allowConditionalFormatting,(0,J.q4)(s=e.container)?[2]:(c=(l=e).capabilities,d=l.evaluatedObjects,v=l.visualStyle,h=l.props.subTitle,i?[3,2]:(f=s.config.singleVisual,null!=(i=d&&d.subTitle||{}).text?[3,2]:[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]));case 1:m=q.sent(),(i=this.displayNameService.getVisualTitle(f,m,c,i))&&(i.text=null===(a=i?.titleComponents)||void 0===a?void 0:a.subtitle),q.label=2;case 2:return g=Te.v.create(v),y=(0,Ga.Zi)(i,{size:"fontSize",family:"fontFamily",color:"fontColor"},g,v,Q.uz,Q.Zq,Q.o8),w=(new S.UN).withFontFamily({descriptor:h.fontFamily,value:y.family}).withFontSizeProperties({descriptor:h.fontSize,value:y.size.pt}).withBold({descriptor:h.bold,value:i.bold||!1}).withItalic({descriptor:h.italic,value:i.italic||!1}).withUnderline({descriptor:h.underline,value:i.underline||!1}),V=w.build(),r.addGroup("subtitle",function(F){F.withDisplayName("Visual_SubTitle").addTopLevelToggle("show",function(){return new S.bd({descriptor:h.show,value:i.show||!1}).build()}).addSimpleSlice("text",new S.fq({descriptor:(0,p.__assign)((0,p.__assign)({},h.text),{instanceKind:o&&3}),placeholder:"",value:i.text||""}).build(),function(N){return N.withCustomDisplayName("Text")}).addSimpleSlice("heading",new S.uY({descriptor:h.heading,value:i.heading||Q.AS}).build(),function(N){return N.withCustomDisplayName("Visual_AzureMapsHeading")}).addCompositeSlice("font","Font",V).addSimpleSlice("textColor",new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},h.fontColor),{instanceKind:o&&3}),value:{value:y.color}}).build(),function(N){return N.withCustomDisplayName("Text_Color")}).addSimpleSlice("alignment",new S.Gp({descriptor:h.alignment,value:i.alignment||Ha.D.left,mode:"horizontalAlignment"}).build(),function(N){return N.withCustomDisplayName("Visual_Alignment_Horizontal")}).addSimpleSlice("wrapText",new S.bd({descriptor:h.titleWrap,value:!!i.titleWrap}).build(),function(N){return N.withCustomDisplayName("TextWrap")})}),[2]}})})},n.prototype.getDividerGroup=function(e,t){var r,i=(r=e).allowConditionalFormatting,a=r.visualStyle,l=e.evaluatedObjects,u=e.props.divider,c=l&&l.divider||{};t.addGroup("divider",function(d){d.withDisplayName("Visual_Divider").addTopLevelToggle("show",function(){return new S.bd({descriptor:u.show,value:c.show||!1}).build()}).addSimpleSlice("color",function(){var v,h=void 0!==c.color?{value:null===(v=c.color.solid)||void 0===v?void 0:v.color}:{value:a.colorPalette.foregroundNeutralSecondary.value};return new S.BT({descriptor:(0,p.__assign)((0,p.__assign)({},u.color),{instanceKind:i&&3}),value:h}).build()}).addSimpleSlice("style",new S.uY({descriptor:u.style,value:c.style||Ho.Dv.solid}).build()).addSimpleSlice("width",function(){return new S.mu({descriptor:u.width,value:c.width||1,options:{minValue:{type:0,value:1},maxValue:{type:1,value:10},required:{type:2},unitSymbol:qe.e_}}).build()}).addSimpleSlice("ignorePadding",new S.bd({descriptor:u.ignorePadding,value:!1!==c.ignorePadding}).build())})},n.prototype.getSpacingGroup=function(e,t){var a=e.evaluatedObjects,o=e.props.spacing,s=a&&a.subTitle||{},l=a&&a.divider||{},u=a&&a.spacing||{},h={minValue:{type:0,value:0},maxValue:{type:1,value:10},required:{type:2},unitSymbol:qe.e_};t.addGroup("spacing",function(f){f.withDisplayName("Visual_Spacing").addSimpleSlice("customizeSpacing",function(){var m;return new S.bd({descriptor:o.customizeSpacing,value:null!==(m=u.customizeSpacing)&&void 0!==m&&m}).build()}),u.customizeSpacing?(f.addSimpleSlice("spaceBelowTitle",function(){return new S.mu({descriptor:o.spaceBelowTitle,value:(0,Q.h4)(Q.hs.Title,u),options:h}).build()}),s.show&&f.addSimpleSlice("spaceBelowSubTitle",function(){return new S.mu({descriptor:o.spaceBelowSubTitle,value:(0,Q.h4)(Q.hs.SubTitle,u),options:h}).build()}),l.show&&f.addSimpleSlice("spaceBelowTitleArea",function(){return new S.mu({descriptor:o.spaceBelowTitleArea,value:(0,Q.h4)(Q.hs.Divider,u),options:h}).build()})):f.addSimpleSlice("verticalSpacing",function(){var m;return new S.mu({descriptor:o.verticalSpacing,value:null!==(m=u.verticalSpacing)&&void 0!==m?m:5,options:h}).build()})})},n.prototype.getVisualSizeAndStyleCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,a,o,s,l,u,c=this;return(0,p.__generator)(this,function(d){switch(d.label){case 0:return r=(t=e.props).general,i=t.background,a=ve.fU.padding,o=ve.fU.border,s=ve.fU.dropShadow,l=function(h){return c.localizationService.get(h)},u=new S.CQ(new S.lg("sizeAndStyle"),"Visual_Size_And_Style",[r.height,r.width,t.lockAspect.show,r.x,r.y,a.top,a.bottom,a.left,a.right,i.show,i.color,i.transparency,o.show,o.color,o.radius,o.width,s.show,s.color,s.transparency,s.position,s.preset,s.shadowSpread,s.shadowBlur,s.angle,s.shadowDistance],l),[4,this.addGeneralSizeGroups(e,u)];case 1:return d.sent(),this.addGeneralStyleGroups(e,u),[2,u.build()]}})})},n.prototype.getEffectsCard=function(e){var t=this,r=e.props.background,i=ve.fU.border,a=ve.fU.dropShadow,s=new S.CQ(new S.lg("effects"),"VisualFormatting_Effects",[r.show,r.color,r.transparency,i.show,i.color,i.radius,i.width,a.show,a.color,a.transparency,a.position,a.preset,a.shadowSpread,a.shadowBlur,a.angle,a.shadowDistance],function(u){return t.localizationService.get(u)});return this.addGeneralStyleGroups(e,s),s.build()},n.prototype.getHeaderIconsCard=function(e){var r,i,t=this,o=e.evaluatedObjects,s=e.exploration,l=e.explorationCapabilities,u=e.featureSwitches;if(!(0,J.q4)(e.container)){var c=e,d=c.props,v=d.visualHeader,h=d.visualHeaderTooltip,f=o,m=f&&f.visualHeader||{},y=l.visualContainerOptions.useStylableHeader,w=s.settings,V=null!==(r=w?.useEnhancedTooltips)&&void 0!==r?r:u?.forceEnhancedTooltips,q=function(O){return t.localizationService.get(O)},F=new S.CQ(new S.lg("headerIcons"),"VisualContainer_HeaderIcons",[v.show,v.background,v.border,v.foreground,v.transparency,v.showVisualInformationButton,v.showVisualWarningButton,v.showVisualErrorButton,v.showDrillRoleSelector,v.showDrillUpButton,v.showDrillToggleButton,v.showDrillDownLevelButton,v.showDrillDownExpandButton,v.showPinButton,v.showFocusModeButton,v.showSeeDataLayoutToggleButton,v.showOptionsMenu,v.showFilterRestatementButton,v.showTooltipButton,v.showCommentButton,v.showPersonalizeVisualButton,v.showCopyVisualImageButton,v.showSmartNarrativeButton,v.showSetAlertButton,v.showFollowVisualButton,h.type,h.section,h.text,h.fontFamily,h.fontSize,h.bold,h.italic,h.underline,V?h.themedTitleFontColor:h.titleFontColor,V?h.themedBackground:h.background,h.transparency],q),N={show:!0,background:{solid:{color:"#FFF"}},border:{solid:{color:"#FFF"}},transparency:0,foreground:{solid:{color:"#333"}},showVisualInformationButton:!0,showVisualWarningButton:!0,showVisualErrorButton:!0,showDrillRoleSelector:!0,showDrillUpButton:!0,showDrillToggleButton:!0,showDrillDownLevelButton:!0,showDrillDownExpandButton:!0,showPinButton:!0,showFocusModeButton:!0,showSeeDataLayoutToggleButton:!0,showOptionsMenu:!0,showTooltipButton:!1,showFilterRestatementButton:!0,showCommentButton:!0,showPersonalizeVisualButton:!0,showCopyVisualImageButton:!0,showSmartNarrativeButton:!1,showSetAlertButton:!0,showFollowVisualButton:!1};if(F.withDescription("VisualHeader_Toggle_Description").addTopLevelToggle("show",function(){var P;return new S.bd({descriptor:v.show,value:null!==(P=m.show)&&void 0!==P?P:N.show}).build()}),y){var T=null!==(i=m.showTooltipButton)&&void 0!==i?i:N.showTooltipButton;F.addGroup("colors",function(P){var O,E,L=null!==(O=m.background)&&void 0!==O?O:N.background;P.withDisplayName("Visual_Colors").addSimpleSlice("background",function(){var B,z={value:null===(B=L.solid)||void 0===B?void 0:B.color};return new S.BT({descriptor:v.background,value:z}).build()},function(B){return B.withCustomDisplayName("Visual_Background")}).addSimpleSlice("border",function(){var B,A,z=m.border;void 0===z&&(z=m.background),void 0===z&&(z=N.border);var G={value:null===(A=(null!==(B=m.border)&&void 0!==B?B:N.border).solid)||void 0===A?void 0:A.color};return new S.BT({descriptor:v.border,value:G}).build()}).addSimpleSlice("icon",function(){var B,A,R={value:null===(A=(null!==(B=m.foreground)&&void 0!==B?B:N.foreground).solid)||void 0===A?void 0:A.color};return new S.BT({descriptor:v.foreground,value:R}).build()},function(B){return B.withCustomDisplayName("Icon")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:v.transparency,value:null!==(E=m.transparency)&&void 0!==E?E:N.transparency,localize:q}).build()).build()}).addGroup("icons",function(P){var O,E,L,B,A,z,R,G,ne,oe,ee,le,Fe,Ye,et,We,Pe,Re,bt,ft;P.withDisplayName("Visual_Tablix_Icons").addSimpleSlice("showVisualInformationButton",new S.bd({descriptor:v.showVisualInformationButton,value:null!==(E=m.showVisualInformationButton)&&void 0!==E?E:N.showVisualInformationButton}).build(),function(Ue){return Ue.withCustomDisplayName("VisualHeader_ShowVisualInformationButtonLabel")}).addSimpleSlice("showVisualWarningButton",new S.bd({descriptor:v.showVisualWarningButton,value:null!==(L=m.showVisualWarningButton)&&void 0!==L?L:N.showVisualWarningButton}).build(),function(Ue){return Ue.withCustomDisplayName("VisualHeader_ShowVisualWarningButtonLabel")}).addSimpleSlice("showVisualErrorButton",new S.bd({descriptor:v.showVisualErrorButton,value:null!==(B=m.showVisualErrorButton)&&void 0!==B?B:N.showVisualErrorButton}).build(),function(Ue){return Ue.withCustomDisplayName("VisualHeader_ShowVisualErrorButtonLabel")}).addSimpleSlice("showDrillRoleSelector",new S.bd({descriptor:v.showDrillRoleSelector,value:null!==(A=m.showDrillRoleSelector)&&void 0!==A?A:N.showDrillRoleSelector}).build()).addSimpleSlice("showDrillUpButton",new S.bd({descriptor:v.showDrillUpButton,value:null!==(z=m.showDrillUpButton)&&void 0!==z?z:N.showDrillUpButton}).build(),function(Ue){return Ue.withCustomDisplayName("DrillUp")}).addSimpleSlice("showDrillToggleButton",new S.bd({descriptor:v.showDrillToggleButton,value:null!==(R=m.showDrillToggleButton)&&void 0!==R?R:N.showDrillToggleButton}).build(),function(Ue){return Ue.withCustomDisplayName("DrillDown")}).addSimpleSlice("showDrillDownLevelButton",new S.bd({descriptor:v.showDrillDownLevelButton,value:null!==(G=m.showDrillDownLevelButton)&&void 0!==G?G:N.showDrillDownLevelButton}).build(),function(Ue){return Ue.withCustomDisplayName("DrillDownLevel")}).addSimpleSlice("showDrillDownExpandButton",new S.bd({descriptor:v.showDrillDownExpandButton,value:null!==(ne=m.showDrillDownExpandButton)&&void 0!==ne?ne:N.showDrillDownExpandButton}).build(),function(Ue){return Ue.withCustomDisplayName("DrillDownLevelGrouped")}).addSimpleSlice("showPinButton",new S.bd({descriptor:v.showPinButton,value:null!==(oe=m.showPinButton)&&void 0!==oe?oe:N.showPinButton}).build(),function(Ue){return Ue.withCustomDisplayName("ReportContainer_Pin")}).addSimpleSlice("showFocusModeButton",new S.bd({descriptor:v.showFocusModeButton,value:null!==(ee=m.showFocusModeButton)&&void 0!==ee?ee:N.showFocusModeButton}).build(),function(Ue){return Ue.withCustomDisplayName("FocusModeVisual_ToolTip")}).addSimpleSlice("showSeeDataLayoutToggleButton",new S.bd({descriptor:v.showSeeDataLayoutToggleButton,value:null!==(le=m.showSeeDataLayoutToggleButton)&&void 0!==le?le:N.showSeeDataLayoutToggleButton}).build(),function(Ue){return Ue.withCustomDisplayName("VisualHeader_ShowSeeDataLayoutToggleButtonLabel")}).addSimpleSlice("showOptionsMenu",new S.bd({descriptor:v.showOptionsMenu,value:null!==(Fe=m.showOptionsMenu)&&void 0!==Fe?Fe:N.showOptionsMenu}).build(),function(Ue){return Ue.withCustomDisplayName("Options_Menu")}).addSimpleSlice("showFilterRestatementButton",new S.bd({descriptor:v.showFilterRestatementButton,value:null!==(Ye=m.showFilterRestatementButton)&&void 0!==Ye?Ye:N.showFilterRestatementButton}).build(),function(Ue){return Ue.withCustomDisplayName("Filter")}).addSimpleSlice("showTooltipButton",new S.bd({descriptor:v.showTooltipButton,value:T}).build(),function(Ue){return Ue.withCustomDisplayName("VisualContainer_HelpTooltip")}),l.annotationsEnabled&&P.addSimpleSlice("showCommentButton",new S.bd({descriptor:v.showCommentButton,value:null!==(et=m.showCommentButton)&&void 0!==et?et:N.showCommentButton}).build());var Ct=(O=c.visualKind).isQueryVisual,si=function(n,e,t,r){return!!(n&&e&&t&&t.settings)&&!e.disableInlineExplore&&t.settings.allowInlineExploration&&r}(u,l,s,Ct||O.isQnaVisual);si&&P.addSimpleSlice("showPersonalizeVisualButton",new S.bd({descriptor:v.showPersonalizeVisualButton,value:null!==(We=m.showPersonalizeVisualButton)&&void 0!==We?We:N.showPersonalizeVisualButton}).build()),u.copyVisualImage&&u.exportVisualImageTenantEnabled&&P.addSimpleSlice("showCopyVisualImageButton",new S.bd({descriptor:v.showCopyVisualImageButton,value:null!==(Pe=m.showCopyVisualImageButton)&&void 0!==Pe?Pe:N.showCopyVisualImageButton}).build()),u.smartNarrativeVisualContainterButton&&P.addSimpleSlice("showSmartNarrativeButton",new S.bd({descriptor:v.showSmartNarrativeButton,value:null!==(Re=m.showSmartNarrativeButton)&&void 0!==Re?Re:N.showSmartNarrativeButton}).build()),u.reflexPBIVisualToolbarEntry&&P.addSimpleSlice("showSetAlertButton",new S.bd({descriptor:v.showSetAlertButton,value:null!==(bt=m.showSetAlertButton)&&void 0!==bt?bt:N.showSetAlertButton}).build()),u.reflexPBIFollowVisual&&P.addSimpleSlice("showFollowVisualButton",new S.bd({descriptor:v.showFollowVisualButton,value:null!==(ft=m.showFollowVisualButton)&&void 0!==ft?ft:N.showFollowVisualButton}).build())}),T&&F.addGroup("helpTooltip",function(P){var O=(0,p.__assign)({type:Ua.xv,show:!0,text:void 0,section:ve.F},f&&f.visualHeaderTooltip||{}),E=c.visualStyle,L=t.viewModeStateService.getConfig().displayOptions.enableMobileTooltipActions,B=(0,ka.UM)(E,V,L,O);P.withDisplayName("VisualContainer_HelpTooltip");var A=B.titleFontProperties,z=[{displayName:function(le){return le.get("None")},value:ve.F}],R=La(t.explorationNavigationService)||[],G=(0,p.__spreadArray)((0,p.__spreadArray)([],R,!0),_.map(z,function(ee){return ee.value}),!0),ne=0===R.length;P.addSimpleSlice("type",new S.uY({descriptor:h.type,value:O.type}).build()).addSimpleSlice("section",new S.uY({descriptor:h.section,value:O.section,mergeValues:z,filterValues:G}).build(),function(ee){return ee.withDisabled(ne||O.type!==Ua.Xz)});var oe=(new S.UN).withFontFamily({descriptor:h.fontFamily,value:A.family}).withFontSizeProperties({descriptor:h.fontSize,value:A.size.pt}).withBold({descriptor:h.bold,value:A.weight===Cr.en}).withItalic({descriptor:h.italic,value:A.style===Cr.BF}).withUnderline({descriptor:h.underline,value:A.textDecoration===Cr.f0});P.addSimpleSlice("tooltipText",new S.Jr({descriptor:h.text,placeholder:"VisualContainer_HelpTooltip_TextPlaceholder",value:O.text,localize:function(le){return t.localizationService.get(le)}}).build()).addCompositeSlice("font","Font",oe.build()).addSimpleSlice("textColor",function(){return new S.BT({descriptor:V?h.themedTitleFontColor:h.titleFontColor,value:{value:A.color}}).build()}).addSimpleSlice("background",function(){var le=B.background;return new S.BT({descriptor:V?h.themedBackground:h.background,value:{value:le&&le.solid&&le.solid.color},isNoFillItemSupported:!0}).build()},function(ee){return ee.withCustomDisplayName("Background_Color")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:h.transparency,value:B.transparency,localize:q}).build())})}return F.build()}},n.prototype.getTooltipsCard=function(e){var r,t=this,a=e.evaluatedObjects,o=e.exploration,s=e.featureSwitches;if(!(0,J.q4)(e.container)){var l=e;if(!l.isQueryVisualWithoutData){var c=l.capabilities.tooltips;if(c){var V,v=l.props.visualTooltip,f=a&&a.visualTooltip,m=o.settings,g=null!==(r=m?.useEnhancedTooltips)&&void 0!==r?r:s?.forceEnhancedTooltips,y=function(z){return t.localizationService.get(z)},w=new S.CQ(new S.lg("tooltips"),"Role_DisplayName_Tooltips",[v.show,v.type,v.section,v.fontFamily,v.fontSize,v.bold,v.italic,v.underline,g?v.themedTitleFontColor:v.titleFontColor,g?v.themedValueFontColor:v.valueFontColor,v.actionFontColor,g?v.themedBackground:v.background,v.transparency],y);V=f&&void 0!==f.show?!!f.show:void 0===c.showByDefault||!!c.showByDefault,w.addTopLevelToggle("show",function(){return new S.bd({descriptor:v.show,value:V}).build()});var q=c.supportedTypes;if(null!=q){var F=l.visualStyle,N=this.viewModeStateService.getConfig().displayOptions.enableMobileTooltipActions,T=(0,ka.UM)(F,g,N,f),P=T.titleFontProperties,O=T.valueFontProperties,E=T.actionFontProperties;w.addGroup("options",function(A){var z,G=(z=function(n,e,t,r){var a,i=[];for(var o in n)if(n[o]){var l=e[o];i.push(l),l===t&&(a=l)}return b.fF.assert(function(){return!_.isEmpty(i)},"No valid values were found"),void 0===a&&(a=r,b.fF.assert(function(){return _.some(i,function(u){return u===r})},"Default value is not supported")),{selectedValue:a,validValues:i}}(q,{default:At.gA,canvas:At.Xz},f&&f.type,q.canvas?At.Xz:At.gA),z.selectedValue),ne=z.validValues,oe=[{displayName:function(Ye){return Ye.get("Visual_Auto")},value:At.pJ}],ee=(0,p.__spreadArray)((0,p.__spreadArray)([],La(t.explorationNavigationService)||[],!0),_.map(oe,function(Fe){return Fe.value}),!0),le=f&&f.section||At.pJ;A.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("type",new S.uY({descriptor:v.type,value:G,filterValues:ne}).build()).addSimpleSlice("section",new S.uY({descriptor:v.section,value:le,mergeValues:oe,filterValues:ee}).build(),function(Fe){return Fe.withDisabled(G!==At.Xz)})});var B=(new S.UN).withFontFamily({descriptor:v.fontFamily,value:P.family}).withFontSizeProperties({descriptor:v.fontSize,value:P.size.pt}).withBold({descriptor:v.bold,value:P.weight===Cr.en}).withItalic({descriptor:v.italic,value:P.style===Cr.BF}).withUnderline({descriptor:v.underline,value:P.textDecoration===Cr.f0}).build();return s.defaultTooltipFormatting&&w.addGroup("text",function(A){A.withDisplayName("Text").addCompositeSlice("font","Font",B).addSimpleSlice("labelColor",function(){return new S.BT({descriptor:g?v.themedTitleFontColor:v.titleFontColor,value:{value:P.color}}).build()},function(z){return z.withCustomDisplayName("Role_DisplayName_LabelColor")}).addSimpleSlice("valueColor",function(){return new S.BT({descriptor:g?v.themedValueFontColor:v.valueFontColor,value:{value:O.color}}).build()},function(z){return z.withCustomDisplayName("Value_Color")}),g&&A.addSimpleSlice("drillTextAndIconColor",new S.BT({descriptor:v.actionFontColor,value:{value:E.color}}).build(),function(z){return z.withCustomDisplayName("Visual_Action_FontColor")})}).addGroup("background",function(A){A.withDisplayName("Visual_Background").addSimpleSlice("color",function(){var R=T.background;return new S.BT({descriptor:g?v.themedBackground:v.background,value:{value:R&&R.solid&&R.solid.color},isNoFillItemSupported:!0}).build()},function(z){return z.withCustomDisplayName("Generic_Color")}).addSimpleSlice("transparency",S.JN.getTransparencySliderBuilder({descriptor:v.transparency,value:T.transparency,localize:y}).build())}),w.build()}}}}},n.prototype.getAltTextCard=function(e){var t=this,r=e.allowConditionalFormatting,i=e.evaluatedObjects,o=e.props.general,s=new S.CQ(new S.lg("altText"),"Visual_General_Properties_Description",[o.altText],function(l){return t.localizationService.get(l)});return s.addGroup(void 0,function(l){l.addSimpleSlice("altText",function(){var u=i&&i[o.altText.objectName],c=u&&u.altText||"";return new S.Jr({descriptor:(0,p.__assign)((0,p.__assign)({},o.altText),{instanceKind:r&&3}),value:c,placeholder:"Visual_General_Properties_Description_Placeholder",localize:function(v){return t.localizationService.get(v)}}).build()})}),s.build()},n.prototype.getVisualLevelFormattingCard=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,p.__generator)(this,function(a){return(0,J.q4)(t=e.container)||!(r=e).visualKind.isQueryVisual||r.isQueryVisualWithoutData?[2]:[2,this.visualLevelFormatStringHelperService.getVisualLevelFormatStringCard(t,r.capabilities)]})})},n.prototype.getFormatPaneSliceTransform=function(e){var r,i,t=this;if((0,J.Vz)(e)){var a=e.config.singleVisual;r=a.visualType,i=a.objects}return function(o,s,l){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:o,objectDescriptors:s,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:l})}},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(qi.F),D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(Wr.O),D.\u0275\u0275inject(Ei.U),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(jr),D.\u0275\u0275inject(Di.F),D.\u0275\u0275inject(Sr.H),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Pr.f),D.\u0275\u0275inject(Ko.kc),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(ri.f),D.\u0275\u0275inject(qt.D),D.\u0275\u0275inject(xr.A),D.\u0275\u0275inject(Aa),D.\u0275\u0275inject(mi,8))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),ai=C(30794),me=C(14172),lr=C(61617),wr=C(89535),Qo=C(2863),$o=C(21302),Xo=C(78778),Qa=C(29804),$a=C(22921),ni=[{objectName:ve.fU.stylePreset.name.objectName,descriptor:ve.XW.stylePreset}],Xa=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m){this.analyticsFormattingService=e,this.dataSources=t,this.explorationNavigation=r,this.featureSwitchService=i,this.formattingSliceTransformerService=a,this.formFactor=o,this.legacyVisualFormattingService=s,this.localizationService=l,this.modernDialogService=u,this.runningVisualService=c,this.selectionService=d,this.visualAuthoring=v,this.visualPluginOperationsService=h,this.visualPluginService=f,this.formattingObjectDefinitionsService=m}return n.prototype.getFormattingModel=function(e){var t;return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return(0,J.q4)(e)?(i={cards:[]},this.featureSwitchService.featureSwitches.onObject&&(r=this.getVisualSizeAndStylePlaceholder(),i.cards.push(r)),[2,i]):[3,1];case 1:return[4,this.getVisualFormatPaneViewModel(e)];case 2:return i=s.sent(),!this.featureSwitchService.featureSwitches.onObject||this.isInMobileFormatting()?[2,i]:[3,3];case 3:return[4,this.analyticsFormattingService.getFormattingModel(e)];case 4:return a=s.sent(),[2,(0,p.__assign)((0,p.__assign)({},i),{cards:(0,p.__spreadArray)((0,p.__spreadArray)([],i.cards,!0),null!==(t=a?.cards)&&void 0!==t?t:[],!0)})]}})})},n.prototype.getPivotDisplayName=function(e){return ce.um(e,this.featureSwitchService)},n.prototype.getRevertToDefaultMetadata=function(e){return{formattingSettingsString:"Formatting",itemTypeDisplayName:this.getPivotDisplayName(e)}},n.prototype.saveProperties=function(e,t,r,i){if((0,J.q4)(r))b.fF.assertFail("Visual pivot does not support VisualContainerGroup");else{this.formFactor.getCurrentLayout();if(this.featureSwitchService&&this.featureSwitchService.featureSwitches.updateFormattingPaneObjects){var o=(0,Qa.z)(),s=this.runningVisualService.getVisual(r),l=r.config.singleVisual.visualType,u=[];b.fF.assert(function(){return _.every(e,function(y){return null!=y.visualUpdateSource})},"All changes should have a visual update source");var c=_.groupBy(e,function(y){return y.visualUpdateSource});for(var d in c){var h=c[d].map(function(y){return ce.H8(y)});u.push.apply(u,s.onDataViewObjectChanged(h,+d,!0))}b.fF.assertNonEmpty(u,"There should be at least one visual object change");var m,f=u.map(function(y){return ce.nH(r,y)});_.forEach(f,function(y){m||(m=ce.m7(y.objectName,y.propertySlice.name,l,t)),wi(y.objectName,y.propertySlice,r,t,0,y.hasDynamicExpressionSupport)}),m&&ce.zS(t.visualSync,r);var g=(0,Qa.z)();b.fF.assert(function(){return g-o<50},"Updating multiple object definitions should not take more than 50 milliseconds")}else _.forEach(e,function(y){wi(y.objectName,y.propertySlice,r,t,0,y.hasDynamicExpressionSupport,!0)});t.visualAuthoring.raiseVisualContainerChanged(r,{parentContextActivity:i})}},n.prototype.revertVisualSlicesToDefinitions=function(e,t){this.revertVisualBasedSlicesToDefinitions(e,t),this.featureSwitchService.featureSwitches.onObject&&!this.isInMobileFormatting()&&this.analyticsFormattingService.revertVisualSlicesToDefinitions(e,t)},n.prototype.revertVisualBasedSlicesToDefinitions=function(e,t){for(var r=[],a=0,o=(0,ce.Wx)(e);a<o.length;a++){var s=o[a],l=s.canvasItem;r.push(l);var u=s.descriptors,c=void 0;if((0,J.Vz)(l)){var d=l.config.singleVisual;(c=d.objects)||(d.objects=c={});var v=d.vcObjects;if(v){for(var h=[],f=function(q){var F=u.findIndex(function(T){return T.objectName===q.objectName});if(-1===F)return"continue";var N=u.splice(F,1)[0];h.push(N)},m=0,g=ni;m<g.length;m++)f(g[m]);_.isEmpty(h)||ce.Aw(v,h)}}else(c=l.objects)||(l.objects=c={});if((0,J.Vz)(l)){if(l.config.singleVisual.visualType===Je.L.shapeMap.name){var w=u.findIndex(function(V){return V.objectName===$a.L.dataPoint.fillRule.objectName&&V.propertyName===$a.L.dataPoint.fillRule.propertyName});w>-1&&(u.splice(w,1),(0,_r._8)("revertToDefault",!1,c))}ce.Aw(c,u)}else ce.Aw(c,u)}this.visualAuthoring.raiseCanvasItemsChanged(r,{parentContextActivity:t})},n.prototype.getObjectDescriptors=function(e){var t=this.getVisualObjectDescriptors(e);if(!this.featureSwitchService.featureSwitches.onObject||this.isInMobileFormatting())return t;var r=this.analyticsFormattingService.getObjectDescriptors(e);return(0,p.__assign)((0,p.__assign)({},t),r)},n.prototype.getVisualObjectDescriptors=function(e){if((0,J.q4)(e))return{};for(var a=(0,p.__assign)({},this.visualPluginService.capabilities(e.config.singleVisual.visualType).objects),o=function(d){b.fF.assert(function(){return!a[d.objectName]},"Existing descriptor"),a[d.objectName]=d.descriptor},s=0,l=ni;s<l.length;s++)o(l[s]);return a},n.prototype.getObjectDefinitions=function(e,t){var i,r=this.getVisualObjectDefinitions(e,t);return this.featureSwitchService.featureSwitches.onObject&&!this.isInMobileFormatting()&&(i=this.analyticsFormattingService.getObjectDefinitions(e,t)),r&&i?(0,p.__assign)((0,p.__assign)({},r),i):r||i||void 0},n.prototype.getVisualObjectDefinitions=function(e,t){if(!(0,J.q4)(e)){var r=void 0,i=void 0;if(t&&this.formattingObjectDefinitionsService)r=this.formattingObjectDefinitionsService.getObjectDefinitions(e),i=this.formattingObjectDefinitionsService.getVcObjectDefinitions(e);else{var a=e.config.singleVisual;r=a.objects,i=a.vcObjects}if(i){for(var o=!1,s=(0,p.__assign)({},r||{}),l=0,u=ni;l<u.length;l++){var d=u[l].objectName,v=i[d];v&&(o=!0,s[d]=v)}if(o)return s}return r}},n.prototype.getFormatPaneSliceTransform=function(e){var r,i,t=this;if((0,J.Vz)(e)){var a=e.config.singleVisual;r=a.visualType,i=a.objects}return function(o,s,l){return t.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:o,objectDescriptors:s,visualType:r,visualObjects:i,dynamicExpressionSupportOptions:l})}},n.prototype.resolvePlaceholder=function(e,t){if(!(0,J.q4)(t)){var r=this.runningVisualService.getVisual(t),i=this.getVisualAdapter(r),a=i&&i.resolveFormattingPlaceholder&&i.resolveFormattingPlaceholder(e);return a?(0,p.__assign)((0,p.__assign)({},a),{objectDescriptors:this.getObjectDescriptors(t)}):e.suppressDefaultValue?void b.fF.assertFail("Expected either a placeholder or default value being suppressed"):this.resolvePlaceholderDefault(e)}b.fF.assertFail("Unexpected placeholder")},n.prototype.resolvePlaceholderDefault=function(e){if((0,S.ie)(e))b.fF.assertNever(e.name);else if((0,S.LY)(e))b.fF.assertNever(e.name);else if((0,S.n$)(e))switch(e.name){case"responsive":return this.resolveResponsivePlaceholder();case"dataVolume":return;default:b.fF.assertNever(e.name)}else b.fF.assertFail("Unexpected placeholder type")},n.prototype.resolveResponsivePlaceholder=function(){var e=this,t=Nt.p.general.responsive,r={general:{properties:{responsive:He.iD.responsive}}};return{item:new S.vi({uidBuilder:new S.IN(new S.SS(new S.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new S.bd({descriptor:t,value:!1}).build(),localize:function(a){return e.localizationService.get(a)}}).withDisabled(!0).build(),objectDescriptors:r,revertToDefaultDescriptors:[t]}},n.prototype.getVisualAdapter=function(e){return e&&e.getAdapter()},n.prototype.getModelUnavailableInformation=function(e){if(!e)return{messageKey:"PropertyPane_Unavailable"};if((0,J.q4)(e))return{messageKey:void 0};if((0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))return{messageKey:"Add_Data_To_Visual"};if(ce.D1(e))return{messageKey:"UnhideVisual"};var t=this.runningVisualService.getVisual(e);return null==(t&&t.getAdapter())?{messageKey:"PropertyPane_VisualErrorMessage"}:t.getHasPendingChanges()?{messageKey:"Formatting_Pane_Disabled_Paused"}:{messageKey:"PropertyPane_Unavailable"}},n.prototype.getVisualFormatPaneViewModel=function(e){var t,r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,u,c,d,v,h,f;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return ce.D1(e)?[2,{cards:[]}]:(o=(0,sr.LR)(this.visualPluginService,this.visualPluginOperationsService,e))?[3,6]:(a=this.runningVisualService.getVisual(e),null==(s=this.getVisualAdapter(a))||a.getHasPendingChanges()||a.getErrorInfo()?[2,{cards:[]}]:a&&a.getType()===e.config.singleVisual.visualType?s.getFormattingModelAsync?[4,s.getFormattingModelAsync()]:[3,2]:[3,5]);case 1:return u=m.sent(),[3,3];case 2:u=null===(t=s.getFormattingModel)||void 0===t?void 0:t.call(s),m.label=3;case 3:return(i=u)?[3,5]:[4,this.legacyVisualFormattingService.getFormattingModel(e)];case 4:i=m.sent(),m.label=5;case 5:i=this.filterOutAnalyticsCards(i),m.label=6;case 6:if(this.featureSwitchService.featureSwitches.onObject)c=this.getTitlePlaceholder(),d=this.getVisualSizeAndStylePlaceholder(),i=(0,p.__assign)((0,p.__assign)({},i||{}),{cards:(0,p.__spreadArray)((0,p.__spreadArray)([d],o?[]:[c],!0),null!==(r=i?.cards)&&void 0!==r?r:[],!0)});else if(!i||0===i.cards.length)return[2,{cards:[]}];return o||(v=this.getFormattingModelMessage(e),h=Ba(a),f=a&&a.getWarnings$().pipe((0,me.U)(function(g){return Ea(g)})),(v||h)&&(i=(0,p.__assign)((0,p.__assign)({},i),{warnings:h,warnings$:f}))),[2,i]}})})},n.prototype.getTitlePlaceholder=function(){return(0,S.UH)("title")},n.prototype.isInMobileFormatting=function(){return 1===this.formFactor.getCurrentLayout()},n.prototype.getVisualSizeAndStylePlaceholder=function(){return(0,S.UH)("sizeAndStyle")},n.prototype.filterOutAnalyticsCards=function(e){if(e){var t=e.cards.filter(function(r){return!r.analyticsPane});return(0,p.__assign)((0,p.__assign)({},e),{cards:t})}},n.prototype.getFormattingModelMessage=function(e){if(!(0,J.q4)(e)){var t=e.config.singleVisual.visualType,r=this.featureSwitchService.featureSwitches.shapeVisual,i=this.formFactor.getCurrentLayout();if("basicShape"===t&&r&&1!==i){var a=this.createShowDialogServices();return{messageKey:"ConvertShape_PropPaneMessage",action:{key:"Convert",fn:function(){return n.showDialog(t,a,Xo.al)}}}}}},n.prototype.createShowDialogServices=function(){return{dataSources:this.dataSources,explorationNavigation:this.explorationNavigation,localizationService:this.localizationService,modernDialogService:this.modernDialogService,selection:this.selectionService,visualAuthoring:this.visualAuthoring}},n.showDialog=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,g,y,w,V,q,F;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return"basicShape"===(s=[],l=[],e)&&(i="ConvertShape_DialogConvertAll",a="ConvertShape_DialogTitle",o="ConvertShape_DialogMessage",s=t.explorationNavigation.getAllVisualContainers(e),l.push("basicShape"),u="shape",c="340px"),d={convertAll:{label:i}},v=t.localizationService.get("Undo"),h={titleText:a,messageTemplate:t.localizationService.format(o,"<b>"+v+"</b>"),okButtonText:"Convert",cancelButtonText:"Cancel_ButtonText",checkboxes:d},[4,t.modernDialogService.openHostDialog({dialogName:"CheckboxDialog",componentName:r,bindings:h,config:{panelClass:["checkbox-dialog"],width:c,autoFocus:!0}})];case 1:return[4,N.sent().afterClosed().toPromise()];case 2:if(!(g=N.sent())||0!==g.result)return[2];if(y=[],g.checkboxes.convertAll)y=s;else for(w=ya.UP.getSelectedCanvasItems(t.selection),V=0,q=w;V<q.length;V++)(0,J.Vz)(F=q[V])&&l.includes(F.config.singleVisual.visualType)&&y.push(F);return t.visualAuthoring.convertMultiple(y,t.dataSources.get(),u),[2]}})})},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(Pi),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(jr),D.\u0275\u0275inject(Di.F),D.\u0275\u0275inject(Fi),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(qa.x),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Ir.z),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(ri.f),D.\u0275\u0275inject(qt.D),D.\u0275\u0275inject(mi,8))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Ya=C(63387),Za=C(64370),Ja=C(29748),en=C(42587),Jo=C(75570),tn=C(2911);function es(n,e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,m,g,w,V,q,T,P,O,E=this;return(0,p.__generator)(this,function(L){switch(L.label){case 0:return r=[],i=n.dataSourcesService,a=n.conceptualSchemaProxy,o=n.localizationService,s=n.changeDetectionMeasure,l=n.telemetryService,b.fF.assert(function(){return!!i},"options.dataSourcesService should not be null or undefined for CDM propertypane card"),b.fF.assert(function(){return!!a},"options.conceptualSchemaProxy should not be null or undefined for CDM propertypane card"),b.fF.assert(function(){return!!s},"options.changeDetectionMeasure should not be null or undefined for CDM propertypane card"),u=i.get(),[4,a.get(u)];case 1:if(!(c=L.sent()))return[2,[]];for(d=!1,v=0,h=c.schemas;v<h.length;v++)for(m=0,g=h[v].entities;m<g.length;m++)for(w=function(A){if(A.measure&&A.measure.changeDetectionMetadata){var z=(0,tn.bW)(A.measure.changeDetectionMetadata.refreshInterval),R=(0,tn.ei)(z);b.fF.assert(function(){return 1===R.length}," Expecting only 1 ISODurationString");var G=(0,Jo.u6)(R[0],o);return r=r.concat(t.getMeasureAndCheckEverySlices(A.name,G,o,e)),d=!0,"break"}},V=0,q=g[m].properties;V<q.length&&"break"!==w(q[V]);V++);return n.explorationCapabilities.getCapabilities().disableChangeDetectionDialog||(T=function(){return(0,p.__awaiter)(E,void 0,void 0,function(){return(0,p.__generator)(this,function(A){return l.logEvent(xe._m,{launchPoint:"PropertyPane"}),s.showDialog(),[2]})})},P=(0,Ae.Gf)((0,Ne.V)(d?"ChangeDetectionEditLink":"ChangeDetectionAddLink"),n.localizationService),O=o.get(d?"Link_Button_Edit_Aria_Value":"Link_Button_Add_Aria_Value"),r.push(t.getAddCDMDialogSlice(P,e,T,O))),[2,r]}})})}function ts(n,e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(r){switch(r.label){case 0:return[4,es(n,e,{getAddCDMDialogSlice:rs,getMeasureAndCheckEverySlices:is})];case 1:return[2,r.sent()]}})})}function rs(n,e,t,r){var i=je.js.pageRefresh.dialogLauncher;return(new S.q6).withDisplayName(n,void 0,!0).withUid(i).withDisabled(e).withControlProperties(new S.Vc({descriptor:i,value:t,ariaLabel:r}).build()).build()}function is(n,e,t,r){var i=je.js.pageRefresh.measure,a=(new S.q6).withDisplayName(t.get("NewMeasureName")).withUid(i).withDisabled(r).withControlProperties(new S.G_({descriptor:i,value:n}).build()).build(),o=je.js.pageRefresh.checkEvery;return[a,(new S.q6).withDisplayName(t.get("CheckEvery")).withUid(o).withDisabled(r).withControlProperties(new S.G_({descriptor:o,value:e}).build()).build()]}var as=C(14463),Ut=C(6236),ns=C(68507),Qe=C(9480),Ke=C(8590),Or=C(78417),Ri=C(73795),Zt=C(64329),Mr=C(49977),os=C(28199),rn=C(41114),an="PBI.Data.GetPerspectives",nn=rn.cx[an]=(0,rn.b1)(an),ss=C(80688),ls=C(60225),Ui=C(48787),us=C(17653),qr=C(57243),cs=C(81213),ps=function(){function n(e,t,r,i){this.errorService=e,this.localizationService=t,this.perspectivesReader=r,this.telemetryService=i,this.perspectivesCache={}}return n.prototype.get=function(e){var t=this,i=e.filter(function(u){return"dsr"===u.type})[0];if(!i){this.telemetryService.startEvent(nn,{dataSourceObjectId:""}).reject({errorMessage:this.localizationService.get("Perspectives_NoValidDataSourceProvided"),errorCode:"NoValidDataSourceProvided",errorSource:"PowerBI"});var a={message:this.localizationService.get("Perspectives_NoValidDataSourceProvided"),code:"NoValidDataSourceProvided",details:{source:"PowerBI"}};return(0,ls._)(a)}var o=this.telemetryService.startEvent(nn,{dataSourceObjectId:i.objectId}),s=this.perspectivesCache[i.objectId];if(s)return s;var l=this.perspectivesReader.get(i).pipe((0,Ui.q)(1),(0,us.b)(function(){return o.resolve()},function(u){t.perspectivesCache[i.objectId]=void 0,o.reject({errorMessage:u.message,errorCode:u.code,errorSource:"PowerBI"}),t.errorService.error(u.message,u.code,u.details)}),(0,qr.d)(1));return this.perspectivesCache[i.objectId]=l,l},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(cs.T),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(ss.c),D.\u0275\u0275inject(Lt.y0))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(),vs=C(84669),ds=C(28016),on=C(11494),hs=C(52298),sn=C(16524),ln=C(52121),un=C(69071),oi="linkType-",vn=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w,V,q,F,N,T,P,O,E,L,B){var A=this;this.promiseFactory=e,this.aggrOps=t,this.canvasScale=r,this.changeDetectionMeasure=i,this.conceptualSchemaProxy=a,this.contextActivityService=o,this.dataSources=s,this.displayNameService=l,this.eventBridge=u,this.explorationCapabilities=c,this.explorationNavigation=d,this.featureSwitchService=v,this.formattingSliceTransformerService=h,this.layoutAuthoring=f,this.lazyScoped=m,this.linguisticSchemaProxy=g,this.localizationService=y,this.perspectivesService=w,this.resourceLoader=V,this.resourceRegistration=q,this.telemetryService=F,this.themeService=N,this.undoRedo=T,this.visualAuthoring=P,this.visualPlugin=O,this.visualStylePresetService=E,this.visualSync=L,this.trustedVisualService=B,this.eventsSubscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(Ke.yVh,function(){A.previousSizeType=void 0,A.sectionCustomWidth=void 0,A.sectionCustomHeight=void 0;var z=A.explorationNavigation.getCurrentSection();A.isCustomPageSize=(0,xt.Y9)(z.size,A.explorationNavigation)===Qe.t.Custom}),this.linkFieldTypeAsCategorized={value:"categorized",displayName:this.localizationService.get("LinkField_AsAggregationDisabledText")},this.linkFieldTypeAsSummarized={value:"summarized",displayName:this.localizationService.get("LinkField_AsAggregationEnabledText")},this.pageTypeOptions=[{displayName:this.localizationService.get("Standard"),value:0},{displayName:this.localizationService.get("Tooltip"),value:1},{displayName:this.localizationService.get("Drillthrough_OneWord"),value:2}]}return n.prototype.ngOnDestroy=function(){this.eventsSubscriptionManager.unsubscribeAll()},n.prototype.getFormattingModel=function(){return(0,p.__awaiter)(this,void 0,void 0,function(){var e,t,r,i,a,o,s,l,c,v,h,f,m,g;return(0,p.__generator)(this,function(y){switch(y.label){case 0:return t={cards:e=[]},r=this.explorationNavigation.getCurrentSection(),i=this.dataSources.get(),r&&i?[4,this.conceptualSchemaProxy.get(i)]:[3,6];case 1:return a=y.sent(),o=_.map(a.schemas,function(w){return w.capabilities}).filter(function(w){return!!w}),l=(s=e).push,[4,this.populatePageInformation(r)];case 2:return l.apply(s,[y.sent()]),e.push(this.populateCanvasSettings(r)),e.push(this.populateCanvasBackground(r)),e.push(this.populateWallpaper(r)),e.push(this.populateFilterPane(r)),e.push(this.populateFilterCard(r)),this.explorationCapabilities.getCapabilities().disableInlineExplore?[3,4]:(c=this.explorationNavigation.getCurrentExploration())&&c.settings&&c.settings.allowInlineExploration?(h=(v=e).push,[4,this.populatePersonalizeVisual(r)]):[3,4];case 3:h.apply(v,[y.sent()]),y.label=4;case 4:return this.featureSwitchService.featureSwitches.realTimeRefresh&&!this.featureSwitchService.featureSwitches.realTimeRefreshDisabled&&_.some(o,function(w){return w.supportsFastRefresh})?(f=_.some(o,function(w){return w.supportChangeDetectionMeasureRefresh}),g=(m=e).push,[4,this.populatePageRefresh(r,f)]):[3,6];case 5:g.apply(m,[y.sent()]),y.label=6;case 6:return[2,t]}})})},n.prototype.getObjectDescriptors=function(){return je.C7},n.prototype.saveProperties=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,m,g,y,w,V,q,F,T,P,O,E,L,B,z,R;return(0,p.__generator)(this,function(ee){switch(ee.label){case 0:return b.fF.assert(function(){return 1===_.size(e)},"We do not support saving multiple property changes to the page right now. Add your support if need."),1!==_.size(e)?[2]:(i=e[0].objectName,a=e[0].propertySlice,o=this.getPagePropertyPaneSaveServices(),s=this.explorationNavigation.getCurrentExploration(),l=this.explorationNavigation.getCurrentSection(),a.name!==Me.PageSizeTypeName?[3,2]:(u=a.value,V=this.savePageProperties(a,i,t,o),this.isCustomPageSize=u===Qe.t.Custom,u!==Qe.t.Tooltip&&(this.previousSizeType=u),this.isCustomPageSize&&(this.sectionCustomWidth=l.size.width,this.sectionCustomHeight=l.size.height),c=this.checkIfPageInformationTypeNeedsUpdate(u,l),d=void 0,c&&(v=!this.featureSwitchService.featureSwitches.onObject||(null===(r=_.find(this.pageTypeOptions,function(le){return 1===le.value}))||void 0===r?void 0:r.value),h=(0,p.__assign)((0,p.__assign)({},a),{name:Me.PageInformationType,value:v}),d=this.savePageProperties(h,Me.PageInformationCardName,t,o)),[4,Promise.all([d,V])]));case 1:return[2,(B=ee.sent()).every(function(le){return le})];case 2:return a.name===Me.PageInformationType&&_.isEmpty(l.visualContainers)?(m=void 0,this.featureSwitchService.featureSwitches.onObject?(g=a.value,b.fF.assert(function(){return null!=g},"propertyPaneSlice.value for page type cannot be null"),m=1===g):m=a.value,y=this.savePageProperties(a,i,t,o),w=(0,xt.Y9)(l.size,this.explorationNavigation),m?(this.isCustomPageSize=!1,null==this.previousSizeType&&(this.previousSizeType=w),w===Qe.t.Custom&&(this.sectionCustomWidth=l.size.width,this.sectionCustomHeight=l.size.height)):this.isCustomPageSize=this.previousSizeType?this.previousSizeType===Qe.t.Custom:w===Qe.t.Custom,V=void 0,q=void 0,F=void 0,this.checkIfSizeTypeNeedsUpdate(this.previousSizeType,m,l,o)?(T=m?Qe.t.Tooltip:this.previousSizeType,P=(0,p.__assign)((0,p.__assign)({},a),{name:Me.PageSizeTypeName,value:T}),[4,this.savePageProperties(P,O=Me.PageSizeCardName,t,o)]):[3,4]):[3,6];case 3:V=ee.sent(),!m&&this.previousSizeType===Qe.t.Custom&&(null!=this.sectionCustomWidth&&l.size.width!==this.sectionCustomWidth&&(E=(0,p.__assign)((0,p.__assign)({},a),{name:Me.PageSizeWidthName,value:this.sectionCustomWidth}),q=this.savePageProperties(E,O,t,o)),null!=this.sectionCustomHeight&&l.size.height!==this.sectionCustomHeight&&(L=(0,p.__assign)((0,p.__assign)({},a),{name:Me.PageSizeHeightName,value:this.sectionCustomHeight}),F=this.savePageProperties(L,O,t,o))),ee.label=4;case 4:return[4,Promise.all([y,q,F])];case 5:return B=ee.sent(),[2,V&&B.every(function(le){return le})];case 6:return a.name===Me.PageSizeWidthName&&(z=a.value,(null==this.sectionCustomWidth||z!==this.sectionCustomWidth)&&(this.sectionCustomWidth=z)),a.name===Me.PageSizeHeightName&&(R=a.value,(null==this.sectionCustomHeight||R!==this.sectionCustomHeight)&&(this.sectionCustomHeight=R)),a.name!==je.js.pageInformation.pageInformationDrillthroughKeepAllFilters.propertyName?[3,8]:[4,this.saveDrillthroughFilterPassingModeUpdate(a.value,s,l)];case 7:return ee.sent(),[2,!0];case 8:return a.name!==je.js.pageInformation.pageInformationDrillthroughCrossReportEnabled.propertyName?[3,10]:[4,this.saveDrillthroughCrossReportModeUpdate(a.value,s,l)];case 9:return ee.sent(),[2,!0];case 10:return a.name!==je.js.pageInformation.pageInformationDrillthroughFields.propertyName?[3,12]:[4,this.saveDrillthroughFieldsUpdate(a.value,l)];case 11:return[2,ee.sent()];case 12:return e[0].uid.includes(oi)?(this.saveLinkFieldLinkTypeUpdate(l,e[0]),[2,!0]):[4,this.savePageProperties(a,i,t,o)];case 13:return[2,ee.sent()]}})})},n.prototype.saveDrillthroughFilterPassingModeUpdate=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.lazyScoped.get(Mr.Sz)];case 1:return a.sent().setDrillthroughFilterPassingMode(t,r,e),[2]}})})},n.prototype.saveDrillthroughCrossReportModeUpdate=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return[4,this.lazyScoped.get(Mr.Sz)];case 1:return a.sent().setCrossReportDrillthrough(t,r,e),[2]}})})},n.prototype.saveDrillthroughFieldsUpdate=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a;return(0,p.__generator)(this,function(o){return(r=e.fromUpdate)?"add"===r.type?[2,!0]:(i=!1,"delete"===r.type?(a=r.deleted.metadata.boundFilter,_.isEmpty(a)||(i=(0,Ri.ku)(a,1,t,this.visualAuthoring)),[2,i]):[2,!1]):[2]})})},n.prototype.saveLinkFieldLinkTypeUpdate=function(e,t){var r=t.uid,i=r.lastIndexOf(oi),a=r.substring(i+9),o=_.find(e.filters,function(u){return u.name===a});o&&this.visualAuthoring.setLinkFieldAsAggregation(o,{scopeType:1,container:e},t.propertySlice.value===this.linkFieldTypeAsSummarized.value)},n.prototype.checkIfSizeTypeNeedsUpdate=function(e,t,r,i){if(!_.isEmpty(r.visualContainers))return!1;var o=void 0!==e,s=(0,xt.Y9)(r.size,i.explorationNavigation);return!!(t&&s!==Qe.t.Tooltip||!t&&o&&s!==e)},n.prototype.checkIfPageInformationTypeNeedsUpdate=function(e,t){return!(e!==Qe.t.Tooltip||1===t.type)},n.prototype.revertPageSliceDefinitions=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,a,o,s;return(0,p.__generator)(this,function(l){switch(l.label){case 0:return t=this.explorationNavigation.getCurrentExploration(),r=this.explorationNavigation.getCurrentSection(),(0,ce.Aw)(i=r.objects||{},e),r.objects=i,[4,this.lazyScoped.get(Mr.Sz)];case 1:return a=l.sent(),o=je.js.pageInformation.pageInformationType,s=je.js.pageSize.pageSizeTypes,e&&e.some(function(u){return u.objectName===o.objectName})?[4,this.setPageInformationDefaultValues(t,r,a)]:[3,3];case 2:l.sent(),l.label=3;case 3:return e&&e.some(function(u){return u.objectName===s.objectName})?[4,this.setPageSizeDefaultValues(t,r,a)]:[3,5];case 4:l.sent(),l.label=5;case 5:return this.eventBridge.publishToChannel(Ke.H8N,r),[2]}})})},n.prototype.setPageInformationDefaultValues=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(a){switch(a.label){case 0:return 0===t.type?[3,2]:(hn(0,r,e,t,this.featureSwitchService.featureSwitches.onObject),this.checkIfSizeTypeNeedsUpdate(this.previousSizeType,!1,t,this.getPagePropertyPaneSaveServices())?[4,this.setPageSizeDefaultValues(e,t,r)]:[3,2]);case 1:a.sent(),a.label=2;case 2:return e&&e.pods?[4,(0,Or.QU)(e,t.name,this.linguisticSchemaProxy)]:[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}})})},n.prototype.setPageSizeDefaultValues=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return dn(Qe.t.Widescreen,t.size,this.eventBridge,r,this.canvasScale.getDisplayOption()),this.isCustomPageSize=!1,this.previousSizeType=i=Qe.t.Widescreen,this.checkIfPageInformationTypeNeedsUpdate(i,t)?[4,this.setPageInformationDefaultValues(e,t,r)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},n.prototype.getObjectDefinitions=function(){var e=this.explorationNavigation.getCurrentSection();return e?.objects},n.prototype.getRevertToDefaultMetadata=function(){return{formattingSettingsString:"Formatting",itemTypeDisplayName:(0,ce.An)("Page",this.featureSwitchService)}},n.prototype.isPageInformationDefaultValuesChanged=function(){var e=this.explorationNavigation.getCurrentSection();if(1&e.type||2&e.type)return!0;var t=this.explorationNavigation.getCurrentExploration();return!(!t||!t.pods)},n.prototype.isPageSizeDefaultValuesChanged=function(){var e=this.explorationNavigation.getCurrentSection(),t=(0,xt.Y9)(e.size,this.explorationNavigation),r=(0,xt.MO)(Qe.t.Widescreen);return!(!this.isCustomPageSize&&t===Qe.t.Widescreen&&e.size.width===r.width&&e.size.height===r.height)},n.prototype.getRevertToDefaultEnabled=function(e,t){var r=this.getObjectDefinitions();if((0,ce.wW)(e,r,t))return!0;var i=je.js.pageInformation.pageInformationType;if(e&&e.some(function(l){return l.objectName===i.objectName})&&this.isPageInformationDefaultValuesChanged())return!0;var o=je.js.pageSize.pageSizeTypes;return!(!e||!e.some(function(l){return l.objectName===o.objectName})||!this.isPageSizeDefaultValuesChanged())},n.prototype.populatePageInformation=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){var t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w,V,q,F=this;return(0,p.__generator)(this,function(N){switch(N.label){case 0:return t=function(P){return F.localizationService.get(P)},l=[i=(r=je.js.pageInformation).pageInformationName,a=r.pageInformationType,o=r.pageInformationQnaPodEnabled,s=r.pageInformationAltName],this.featureSwitchService.featureSwitches.onObject&&l.push.apply(l,[r.pageInformationDrillthroughKeepAllFilters,r.pageInformationDrillthroughCrossReportEnabled,r.pageInformationDrillthroughFields,r.pageInformationDrillthroughLinkFieldsLinkTypes]),u=new S.lg("pageInformation"),c=new S.CQ(u,"PagePropertyPane_PageInformation",l,t).build(),d=this.explorationNavigation.getCurrentExploration(),[4,(0,Or._3)(d,e.name,this.linguisticSchemaProxy,this.promiseFactory)];case 1:return v=N.sent(),h=new S.mQ(new S.SS(u,"pageInformation"),t).addSimpleSlice(i.propertyName,new S.fq({descriptor:i,value:e.displayName,placeholder:"",validators:{required:{type:2}}}).build(),function(T){return T.withCustomDisplayName("Name")}),this.featureSwitchService.featureSwitches.onObject||(h.addSimpleSlice(a.propertyName,new S.bd({descriptor:a,value:!!(1&e.type)}).build(),function(T){return T.withCustomDisplayName("Allow_As_Tooltip").withCustomDescription("PagePropertyPane_PageInformation_Tooltip_Description")}),h.addSimpleSlice(o.propertyName,new S.bd({descriptor:o,value:!!v}).build(),function(T){return T.withCustomDisplayName("Allow_Qna").withCustomDescription("PagePropertyPane_PageInformation_PodEnabled_Description")}),v&&h.addSimpleSlice(s.propertyName,new S.Jr({descriptor:s,value:v.altNames?v.altNames.join(", "):"",placeholder:"Page_Synonyms_Placeholder",localize:t}).build(),function(T){return T.withCustomDisplayName("Page_Synonyms")}),c.groups.push(h.build())),this.featureSwitchService.featureSwitches.onObject?(f=function(n,e){for(var t,r=1===e.type?2:1,i=[],a=0,o=null!==(t=n.pods)&&void 0!==t?t:[];a<o.length;a++){var s=o[a];if(s.type===r&&s.boundSection===e.name)for(var l=0,u=s.parameters;l<u.length;l++){var c=u[l];c.fieldExpr&&i.push(c)}}return i}(d,e),[4,this.getLinkParameterFilterDisplayNameMappings(f,e)]):[3,5];case 2:return m=N.sent(),g=this.getDrillthroughTooltipControlSettings(d,e),this.addDefaultGroupDrillthroughRelatedSlices(e,f,g,h),c.groups.push(h.build()),w=null==(y=e.type)||0===y,b.fF.assert(function(){return!(w&&!_.isEmpty(f))},"A section in null/Regular type and has drillthrough content should've been upgraded to Drillthrough type already!"),1===y||2===y?[4,this.getLinkFieldsLinkTypeGroup(f,m,g,u,t)]:[3,4];case 3:V=N.sent(),c.groups.push(V),N.label=4;case 4:q=this.getQnaGroup(v,u,t),c.groups.push(q),N.label=5;case 5:return[2,c]}})})},n.prototype.addDefaultGroupDrillthroughRelatedSlices=function(e,t,r,i){var a=this;if(this.featureSwitchService.featureSwitches.onObject){var o=null!=e.type?e.type:0,s=je.js.pageInformation,l=s.pageInformationType,u=s.pageInformationDrillthroughKeepAllFilters,c=s.pageInformationDrillthroughCrossReportEnabled,d=s.pageInformationDrillthroughFields;if(i.addSimpleSlice(l.propertyName,new S.uY({descriptor:l,items:this.pageTypeOptions,value:_.find(this.pageTypeOptions,function(f){return f.value===o})}).build(),function(f){return f.withCustomDisplayName("PagePropertyPane_PageType").withCustomDescription("PagePropertyPane_PageType_Tooltip")}),1===o||2===o){i.addSimpleSlice(u.propertyName,new S.bd({descriptor:u,value:r.keepAllFilters.value}).build(),function(f){return f.withCustomDisplayName("Drillthrough_KeepAllFilters").withCustomDescription(r.keepAllFilters.tooltip,!1).withDisabled(r.keepAllFilters.disabled)}),2===o&&i.addSimpleSlice(c.propertyName,new S.bd({descriptor:c,value:r.crossReportDrillthrough.value}).build(),function(f){return f.withCustomDisplayName("Drillthrough_CrossReportDrillthrough").withCustomDescription(r.crossReportDrillthrough.tooltip,!1)});var h={control:{type:"FieldPicker",properties:{descriptor:d,value:{newExpr:_.map(t,function(f){return{expr:f.fieldExpr,metadata:{boundFilter:f.boundFilter}}}),fromUpdate:{type:"initialize"}},validators:void 0,allowMultipleValues:!0,disallowReplaceItems:!0,getDropExprStrategy:{getDropExpr:function(m,g){return(0,p.__awaiter)(a,void 0,void 0,function(){return(0,p.__generator)(this,function(y){switch(y.label){case 0:return[4,this.tryCreateDrillthroughFilter(e,m)];case 1:return[2,y.sent()]}})})},getDroppedExprChildren:function(m,g,y,w){}}}},displayName:r.linkFieldsDropZoneTitle,uid:i.uidBuilder.withSlice(d.propertyName).build()};i.addSlice(h)}}},n.prototype.getLinkParameterFilterDisplayNameMappings=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a=this;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return _.isEmpty(e)?[2,{}]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return r=o.sent(),i={},_.forEach(e,function(s){var l=_.find(t.filters,function(c){return c.name===s.boundFilter}),u=(0,Ri.eW)(l,{scopeType:1,container:t},r,a.aggrOps,a.displayNameService,a.localizationService,a.visualPlugin);i[s.name]=u}),[2,i]}})})},n.prototype.getLinkFieldsLinkTypeGroup=function(e,t,r,i,a){return(0,p.__awaiter)(this,void 0,void 0,function(){var o,s,l=this;return(0,p.__generator)(this,function(u){switch(u.label){case 0:return o=new S.mQ(new S.SS(i,"pageInformationDrillthroughLinkFieldsLinkTypes"),a).withDisplayName(r.linkFieldsLinkTypeGroupTitle,!1),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return s=u.sent(),_.forEach(e,function(c){var h,d=!0,v=!0,f=c.fieldExpr;(0,rt.kb)(f)?(h=!0,d=!1):Pt.m.discourageAggregation(f,s)?(h=!1,v=!1):h=c.asAggregation;var m=[];d&&m.push(l.linkFieldTypeAsCategorized),v&&m.push(l.linkFieldTypeAsSummarized),o.addSimpleSlice(oi+c.boundFilter,new S.uY({descriptor:je.js.pageInformation.pageInformationDrillthroughLinkFieldsLinkTypes,items:m,value:h?l.linkFieldTypeAsSummarized:l.linkFieldTypeAsCategorized}).build(),function(w){b.fF.assert(function(){return!_.isEmpty(t[c.name])},"there should be a corresponding filter display name for parameter "+c.name);var q=l.localizationService.format("PagePropertyPane_LinkField_LinkType_FieldName",t[c.name]);w.withCustomDisplayName(q,!1)})}),_.isEmpty(e)&&o.withDisabled(!0,void 0),[2,o.build()]}})})},n.prototype.getQnaGroup=function(e,t,r){var i=je.js.pageInformation,a=i.pageInformationQnaPodEnabled,o=i.pageInformationAltName;return new S.mQ(new S.SS(t,"pageInformationQnaPodEnabled"),r).withDisplayName("Allow_Qna").addTopLevelToggle(a.propertyName,function(){return new S.bd({descriptor:a,value:!!e}).build()}).addSimpleSlice(o.propertyName,new S.Jr({descriptor:o,value:e?.altNames?e.altNames.join(", "):"",placeholder:"Page_Synonyms_Placeholder",localize:r}).build(),function(l){return l.withDisabled(!e).withCustomDisplayName("Page_Synonyms")}).build()},n.prototype.populateCanvasSettings=function(e){var t,r=this,i=function(g){return r.localizationService.get(g)},a=(t=je.js.pageSize).pageSizeTypes,o=t.pageSizeHeight,s=t.pageSizeWidth,l=je.js.displayArea.verticalAlignment,u=new S.CQ(new S.lg("pageSize"),"Canvas_Settings",[a,o,s,l],i),c=this.isCustomPageSize?Qe.t.Custom:(0,xt.Y9)(e.size,this.explorationNavigation),d=(0,xt.Iq)(Qe.D.members(),this.localizationService);c===Qe.t.Dynamic&&d.unshift({value:Qe.t.Dynamic,displayName:i("PagePropertyPane_PageSizeType_Dynamic")});var v=this.explorationNavigation.getCurrentExploration(),h=e.evaluatedObjects&&e.evaluatedObjects.displayArea,f=h&&h.verticalAlignment;return void 0===f&&(f=v&&v.evaluatedObjects&&v.evaluatedObjects.section&&v.evaluatedObjects.section.verticalAlignment),void 0===f&&(f=ns.XN),u.addGroup("pageSize",function(m){m.addSimpleSlice(a.propertyName,new S.uY({descriptor:a,items:d,value:d.find(function(g){return g.value===c})}).build(),function(g){return g.withCustomDisplayName("Type")}).addSimpleSlice(o.propertyName,new S.mu({descriptor:o,value:e.size.height,options:{maxValue:{type:1,value:9999},minValue:{type:0,value:1},unitSymbol:"Numeric_Pixel"}}).build(),function(g){return g.withCustomDisplayName("PagePropertyPane_PageSizeHeight").withDisabled(c!==Qe.t.Custom)}).addSimpleSlice(s.propertyName,new S.mu({descriptor:s,value:e.size.width,options:{maxValue:{type:1,value:9999},minValue:{type:0,value:1},unitSymbol:"Numeric_Pixel"}}).build(),function(g){return g.withCustomDisplayName("PagePropertyPane_PageSizeWidth").withDisabled(c!==Qe.t.Custom)}).addSimpleSlice(l.propertyName,new S.uY({descriptor:l,value:f}).build(),function(g){return g.withCustomDisplayName("Visual_Alignment_Vertical")})}).build()},n.prototype.populateCanvasBackground=function(e){var t=this,r=function(f){return t.localizationService.get(f)},i=e.evaluatedObjects&&e.evaluatedObjects[Me.PageBackgroundCardName],a=Ee.tb,o=Ee.nW,s=(0,Xr.Gl)(i?.color)?i.color.solid.color:a,l=je.js.background,u=l.color,c=l.image,d=l.transparency;return new S.CQ(new S.lg("background"),"Canvas_Background",[u,c,d],r).withDescription("Area_Beneath_Visual").addGroup("background",function(h){var f;h.addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:s}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")}).addSimpleSlice(c.propertyName,new S.bD({descriptor:c,value:i&&i.image}).build(),function(m){return m.withCustomDisplayName("Image")}).addSimpleSlice(d.propertyName,S.JN.getTransparencySliderBuilder({descriptor:d,value:null!==(f=i?.transparency)&&void 0!==f?f:o,localize:r}).build(),function(m){return m.withCustomDisplayName("Transparency")})}).build()},n.prototype.populateWallpaper=function(e){var t=this,r=function(f){return t.localizationService.get(f)},i=e.evaluatedObjects&&e.evaluatedObjects[Me.OutspaceBackgroundCardName],a=Ee.hH,o=Ee.Dd,s=(0,Xr.Gl)(i?.color)?i.color.solid.color:a,l=je.js.outspace,u=l.color,c=l.image,d=l.transparency;return new S.CQ(new S.lg("outspace"),"PagePropertyPane_Outspace",[u,c,d],r).withDescription("Area_Behind_Canvas").addGroup("outspace",function(h){var f;h.addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:s}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")}).addSimpleSlice(c.propertyName,new S.bD({descriptor:c,value:i&&i.image}).build(),function(m){return m.withCustomDisplayName("Image")}).addSimpleSlice(d.propertyName,S.JN.getTransparencySliderBuilder({descriptor:d,value:null!==(f=i?.transparency)&&void 0!==f?f:o,localize:r}).build(),function(m){return m.withCustomDisplayName("Transparency")})}).build()},n.prototype.populatePageRefresh=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w,q=this;return(0,p.__generator)(this,function(F){switch(F.label){case 0:return r=function(T){return q.localizationService.get(T)},a=(i=e.evaluatedObjects&&e.evaluatedObjects.pageRefresh||{show:!1,duration:Ee.oK,refreshType:Ut.wO}).show||!1,s=(o=je.js.pageRefresh).show,l=o.refreshType,u=o.duration,c=o.dialogLauncher,d=o.measure,v=o.checkEvery,h=new S.CQ(new S.lg("pageRefresh"),"PageRefresh",[s,l,u,c,d,v],r),f=i.duration||Ee.oK,m=i.refreshType||Ut.wO,t||(m=Ut.wO),y=t?[Ut.wO,Ut.kj]:[Ut.wO],(g=this.featureSwitchService.featureSwitches.changeDetection)&&m===Ut.kj?[4,ts({localizationService:this.localizationService,dataSourcesService:this.dataSources,changeDetectionMeasure:this.changeDetectionMeasure,conceptualSchemaProxy:this.conceptualSchemaProxy,explorationCapabilities:this.explorationCapabilities,telemetryService:this.telemetryService},!a)]:[3,2];case 1:w=F.sent(),F.label=2;case 2:return[2,h.addTopLevelToggle(s.propertyName,function(){return new S.bd({descriptor:s,value:a}).build()}).addGroup("pageRefresh",function(N){g?m===Ut.wO?(q.createRefreshTypeSlice(N,l,"".concat(m),y),q.createDurationSlice(N,u,f)):q.createRefreshTypeSlice(N,l,"".concat(m),y):q.createDurationSlice(N,u,f),g&&m===Ut.kj&&N.addSlices(w)}).build()]}})})},n.prototype.createDurationSlice=function(e,t,r){e.addSimpleSlice(t.propertyName,new S.Cv({descriptor:t,value:r,validators:{min:"PT1S",max:"P24D",integer:!0}}).build(),function(i){return i.withCustomDisplayName("AutoPageRefreshInterval")})},n.prototype.createRefreshTypeSlice=function(e,t,r,i){e.addSimpleSlice(t.propertyName,new S.uY({descriptor:t,value:r,filterValues:i}).build(),function(a){return a.withCustomDisplayName("AutoPageRefreshType")})},n.prototype.populatePersonalizeVisual=function(e){var t,r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f=this;return(0,p.__generator)(this,function(m){switch(m.label){case 0:return i=function(y){return f.localizationService.get(y)},o=(a=je.js.personalizeVisual).show,s=a.perspectiveRef,l=a.applyToAllPages,u=new S.CQ(new S.lg("personalizeVisual"),"VisualHeader_ShowPersonalizeVisualButton",[o,s,l],i),c=null===(r=null===(t=e.evaluatedObjects)||void 0===t?void 0:t.personalizeVisual)||void 0===r?void 0:r.perspectiveRef,[4,(0,Ve.mI)(this.dataSources,this.perspectivesService,this.localizationService)];case 1:return d=m.sent(),v=null!=c&&_.find(d,function(g){return g.value===c}),h=v?.value||"",[2,u.addTopLevelToggle(o.propertyName,function(){var g,y,w;return new S.bd({descriptor:o,value:null===(w=null===(y=null===(g=e?.evaluatedObjects)||void 0===g?void 0:g.personalizeVisual)||void 0===y?void 0:y.show)||void 0===w||w}).build()}).addGroup("personalizeVisual",function(g){g.addSimpleSlice(s.propertyName,new S.uY({descriptor:s,items:d,value:_.find(d,function(y){return y.value===h})}).build(),function(y){return y.withCustomDisplayName("PersonalizeVisual_PerspectivePropertyName")}).addSimpleSlice(l.propertyName,new S.Vc({descriptor:l,value:function(){return f.onApplyToAllPages(l)}}).build(),function(y){return y.withCustomDisplayName("PagePropertyPane_ApplyToAllPages").withSuppressDisplayName(!0)})}).build()]}})})},n.prototype.onApplyToAllPages=function(e){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(r){return this.saveProperties([{objectName:e.objectName,uid:"applyToAllPagesUid",propertySlice:{name:e.propertyName,type:{applyToAllPages:!0},value:!1},hasDynamicExpressionSupport:!1,formattingSource:"Page",visualUpdateSource:0}],{contextActivityService:this.contextActivityService,explorationNavigation:this.explorationNavigation,featureSwitchService:this.featureSwitchService,layoutAuthoring:this.layoutAuthoring,localizationService:this.localizationService,resourceLoader:this.resourceLoader,resourceRegistration:this.resourceRegistration,telemetryService:this.telemetryService,themeService:this.themeService,undoRedo:this.undoRedo,visualAuthoring:this.visualAuthoring,visualPlugin:this.visualPlugin,visualStylePresetService:this.visualStylePresetService,visualSync:this.visualSync,trustedVisualService:this.trustedVisualService}),[2]})})},n.prototype.populateFilterPane=function(e){var t=this,r=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),i=e.evaluatedObjects&&e.evaluatedObjects.outspacePane,a=function(F){return t.localizationService.get(F)},o=je.js.outspacePane,s=o.fontFamily,l=o.titleSize,u=o.foregroundColor,c=o.inputBoxColor,d=o.headerSize,v=o.searchTextSize,h=o.border,f=o.borderColor,m=o.backgroundColor,g=o.transparency,y=o.width,w=o.checkboxAndApplyColor;return new S.CQ(new S.lg("outspacePane"),"Exploration_FilterPane",[s,l,u,c,d,v,h,f,m,g,y,w],a).addGroup("text",function(q){var F=i&&null!=i.foregroundColor?i.foregroundColor.solid.color:r.colorPalette.foreground.value;q.withDisplayName("Text").addCompositeSlice(s.propertyName,"Font",(new S.UN).withFontFamily({descriptor:s,value:i&&null!=i.fontFamily?"".concat(i.fontFamily):Ee.h9}).withFontSizeProperties({descriptor:l,value:i&&null!=i.titleSize?i.titleSize:Ee.Db,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj}}}).build()).addSimpleSlice(u.propertyName,new S.BT({descriptor:u,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("Text_And_IconsColor")})}).addGroup("input",function(q){var F=i&&null!=i.inputBoxColor?i.inputBoxColor.solid.color:i&&null!=i.backgroundColor?i.backgroundColor.solid.color:Ee.$U;q.withDisplayName("Input").addSimpleSlice(c.propertyName,new S.BT({descriptor:c,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("PagePropertyPane_FilterCards_InputBoxColor")})}).addGroup("header",function(q){q.withDisplayName("ThemeDialog_SubSection_Header").addSimpleSlice(d.propertyName,new S.mu({descriptor:d,value:i&&null!=i.headerSize?i.headerSize:Ee.SC,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj},unitSymbol:"Slider_Weight"}}).build(),function(F){return F.withCustomDisplayName("PagePropertyPane_OutspacePane_HeaderSize")})}).addGroup("searchbox",function(q){q.withDisplayName("SearchBox").addSimpleSlice(v.propertyName,new S.mu({descriptor:v,value:i&&null!=i.searchTextSize?i.searchTextSize:Ee.D6,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj},unitSymbol:"Slider_Weight"}}).build(),function(F){return F.withCustomDisplayName("PagePropertyPane_OutspacePane_SearchTextSize")})}).addGroup("border",function(q){var F=i&&null!=i.borderColor?i.borderColor.solid.color:Ee.JW;q.withDisplayName("Visual_Border").addTopLevelToggle(h.propertyName,function(){return new S.bd({descriptor:h,value:i&&null!=i.border?i.border:Ee.zH}).build()}).addSimpleSlice(f.propertyName,new S.BT({descriptor:f,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("Generic_Color")})}).addGroup("background",function(q){var F,N=i&&null!=i.backgroundColor?i.backgroundColor.solid.color:r.colorPalette.background.value;q.withDisplayName("Visual_Background").addSimpleSlice(m.propertyName,new S.BT({descriptor:m,value:{value:N}}).build(),function(T){return T.withCustomDisplayName("Generic_Color")}).addSimpleSlice(g.propertyName,S.JN.getTransparencySliderBuilder({descriptor:g,value:null!==(F=i?.transparency)&&void 0!==F?F:Ee.yX,localize:a}).build(),function(T){return T.withCustomDisplayName("Transparency")})}).addGroup("options",function(q){var F=i&&null!=i.checkboxAndApplyColor?i.checkboxAndApplyColor.solid.color:Ee.mC;q.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice(y.propertyName,new S.mu({descriptor:y,value:i&&null!=i.width?i.width:Ee.vg,options:{maxValue:{type:1,value:Ee.Xj},minValue:{type:0,value:Ee.AA},unitSymbol:"Numeric_Pixel"}}).build(),function(N){return N.withCustomDisplayName("Pane_Width")}).addSimpleSlice(w.propertyName,new S.BT({descriptor:w,value:{value:F}}).build(),function(N){return N.withCustomDisplayName("Apply_And_Checkboxes").withCustomDescription("Apply_And_Checkboxes_Tooltip")})}).build()},n.prototype.populateFilterCard=function(e){var t=this,r=function(s){return t.localizationService.get(s)},i=je.js.filterCard;return new S.CQ(new S.lg("filterCard"),"PagePropertyPane_FilterCards",[i.fontFamily,i.textSize,i.foregroundColor,i.inputBoxColor,i.border,i.borderColor,i.backgroundColor,i.transparency],r).addGroup("applySettingsTo",function(o){o.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("state",function(s){s.withDisplayName("State").addContainerItem("default",r("Default"),function(l){return t.generateFilterCardContainerItemBuilder(l,e,!1)}).addContainerItem("applied",r("PagePropertyPane_FilterCards_Applied"),function(l){return t.generateFilterCardContainerItemBuilder(l,e,!0)})})}).build()},n.prototype.generateFilterCardContainerItemBuilder=function(e,t,r){var i=this,a=this.themeService.getVisualStyle(this.explorationNavigation.getCurrentExploration().themeCollection),o=function(v){return i.localizationService.get(v)},s=t.evaluatedObjects&&t.evaluatedObjects.filterCard,l=r?Ee.ZF:Ee.Kc,u={id:l},c=s&&s.$instances&&s.$instances[l];e.addGroup("text",function(d){var v=(0,p.__assign)((0,p.__assign)({},je.js.filterCard.fontFamily),{selector:u}),h=c&&null!=c.foregroundColor?c.foregroundColor.solid.color:a.colorPalette.foreground.value,f=(0,p.__assign)((0,p.__assign)({},je.js.filterCard.foregroundColor),{selector:u});d.withDisplayName("Text").addCompositeSlice(v.propertyName,"Font",(new S.UN).withFontFamily({descriptor:v,value:c&&null!=c.fontFamily?"".concat(c.fontFamily):Ee.h9}).withFontSizeProperties({descriptor:(0,p.__assign)((0,p.__assign)({},je.js.filterCard.textSize),{selector:u}),value:c&&null!=c.textSize?c.textSize:Ee.JM,options:{maxValue:{type:1,value:Zt.PR},minValue:{type:0,value:Zt.Gj}}}).build()).addSimpleSlice(f.propertyName,new S.BT({descriptor:f,value:{value:h}}).build(),function(m){return m.withCustomDisplayName("Text_And_IconsColor")})}).addGroup("input",function(d){var v=(0,p.__assign)((0,p.__assign)({},je.js.filterCard.inputBoxColor),{selector:u}),h=c&&null!=c.inputBoxColor?c.inputBoxColor.solid.color:Ee.NC;d.withDisplayName("Input").addSimpleSlice(v.propertyName,new S.BT({descriptor:v,value:{value:h}}).build(),function(f){return f.withCustomDisplayName("PagePropertyPane_FilterCards_InputBoxColor")})}).addGroup("border",function(d){var v=(0,p.__assign)((0,p.__assign)({},je.js.filterCard.border),{selector:u}),h=(0,p.__assign)((0,p.__assign)({},je.js.filterCard.borderColor),{selector:u}),f=c&&null!=c.borderColor?c.borderColor.solid.color:Ee.bm;d.withDisplayName("Visual_Border").addTopLevelToggle(v.propertyName,function(){return new S.bd({descriptor:v,value:c&&null!=c.border?c.border:Ee.HX}).build()}).addSimpleSlice(h.propertyName,new S.BT({descriptor:h,value:{value:f}}).build(),function(m){return m.withCustomDisplayName("Generic_Color")})}).addGroup("background",function(d){var v,h=(0,p.__assign)((0,p.__assign)({},je.js.filterCard.backgroundColor),{selector:u}),f=c&&null!=c.backgroundColor?c.backgroundColor.solid.color:a.colorPalette.background.value,m=(0,p.__assign)((0,p.__assign)({},je.js.filterCard.transparency),{selector:u});d.withDisplayName("Visual_Background").addSimpleSlice(h.propertyName,new S.BT({descriptor:h,value:{value:f}}).build(),function(g){return g.withCustomDisplayName("Generic_Color")}).addSimpleSlice(m.propertyName,S.JN.getTransparencySliderBuilder({descriptor:m,value:null!==(v=c?.transparency)&&void 0!==v?v:Ee.$V,localize:o}).build(),function(g){return g.withCustomDisplayName("Transparency")})})},n.prototype.getFormatPaneSliceTransform=function(){var e=this;return function(t,r,i){return e.formattingSliceTransformerService.transformFormattingSlice({formattingSlice:t,objectDescriptors:r,visualType:void 0,visualObjects:void 0,dynamicExpressionSupportOptions:i})}},n.prototype.getPagePropertyPaneSaveServices=function(){return{canvasScale:this.canvasScale,eventBridge:this.eventBridge,explorationNavigation:this.explorationNavigation,lazyScoped:this.lazyScoped,linguisticSchemaProxy:this.linguisticSchemaProxy,promiseFactory:this.promiseFactory,telemetryService:this.telemetryService,undoRedo:this.undoRedo}},n.prototype.getDrillthroughTooltipControlSettings=function(e,t){return en.F(e,t,en.j(t.type,this.localizationService,!0),!1)},n.prototype.tryCreateDrillthroughFilter=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return[4,(0,Ri.uE)(1,e,!0,this.dataSources,t,this.visualAuthoring,!1)];case 1:return r=i.sent(),_.isEmpty(r)?[2]:[2,{expr:t,metadata:{boundFilter:r}}]}})})},n.prototype.savePageProperties=function(e,t,r,i){var a,o;return(0,p.__awaiter)(this,void 0,void 0,function(){var s,l,u,c,d,v,h,f,m,y,w,V;return(0,p.__generator)(this,function(q){return s=i.explorationNavigation.getCurrentExploration(),l=i.explorationNavigation.getCurrentSection(),u=l.size,c=i.canvasScale.getDisplayOption(),d=i.promiseFactory.defer(),e.name===Me.PageInformationName?(e.value?(v={sectionNewName:e.value,sectionIndex:_.indexOf(s.sections,l)},i.eventBridge.publishToChannel(Ke.HOc,v)):e.value=l.displayName,d.resolve(!1)):e.name===Me.PageInformationQnaPodEnabled?e.value?i.undoRedo.register("ReportPagePodEnabled",function(){(0,Or.k9)(s,l,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})}):i.undoRedo.register("ReportPagePodDisabled",function(){(0,Or.QU)(s,l.name,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})}):e.name===Me.PageInformationAltName?(h=e.value.split(/[,\n]/).map(function(F){return F.trim()}).filter(function(F){return!_.isEmpty(F)}),i.undoRedo.register("UpdateLinguisticAltNames",function(){(0,Or.XY)(s,l,h,i.linguisticSchemaProxy).then(function(){return d.resolve(!0)})})):e.name===Me.PageInformationType?((f=r.featureSwitchService.featureSwitches.onObject)?(m=e.value,b.fF.assert(function(){return null!=m},"propertyPaneSlice.value for page type cannot be null")):m=e.value?1:0,i.lazyScoped.get(Mr.Sz).then(function(F){var N;hn(m,F,s,l,f),0===m?N="regular":2===m?N="drillthrough":1===m?N="tooltip":b.fF.assertFail("unhandled type "+m),i.telemetryService.logEvent(xe.Lo,{objectName:Me.PageInformationCardName,propertyName:e.name,newValue:N,visualType:"page"}),d.resolve(!1)})):e.name===Me.PageSizeTypeName?i.lazyScoped.get(Mr.Sz).then(function(F){dn(e.value,u,i.eventBridge,F,c),d.resolve(!1)}):e.name===Me.PageSizeWidthName?(y=r.featureSwitchService.featureSwitches.useModernFormatPane?e.value:e.value.value,i.eventBridge.publishToChannel(Ke.qHu,{width:parseInt(y,10),height:u.height,displayOption:c}),d.resolve(!1)):e.name===Me.PageSizeHeightName?(y=r.featureSwitchService.featureSwitches.useModernFormatPane?e.value:e.value.value,i.eventBridge.publishToChannel(Ke.qHu,{width:u.width,height:parseInt(y,10),displayOption:c}),d.resolve(!1)):t===Me.PageBackgroundCardName?(ur("UpdateCanvasBackground",t,e,r,i),d.resolve(!0)):t===Me.OutspaceBackgroundCardName?(ur("UpdateOutspaceBackground",t,e,r,i),d.resolve(!0)):t===Me.OutspacePaneCardName?(ur("UpdateOutspacePaneBackground",t,e,r,i),d.resolve(!0)):t===Me.FilterCardName?(ur("UpdateFilterCard",t,e,r,i),d.resolve(!0)):t===Me.DisplayAreaName?(ur("UpdateDisplayAreaAlignment",t,e,r,i),d.resolve(!0)):t===Me.PageRefreshCardName?(ur("UpdatePageRefresh",t,e,r,i),(y=e.value)&&i.telemetryService.logEvent(xe.Lo,{objectName:Me.PageRefreshCardName,propertyName:e.name,newValue:y.toString(),visualType:"page"}),d.resolve(!0)):t===Me.PersonalizeVisual&&(ur("UpdatePersonalizeVisual",t,e,r,i),w="applyToAllPages"in e.type&&!(null===(a=e.type)||void 0===a||!a.applyToAllPages),V=!w&&("reference"in e.type&&null!==(o=e.type.reference)&&void 0!==o&&o.perspective?""===e.value:!(!("revertToDefault"in e.type)||!e.type.revertToDefault)||void 0),i.telemetryService.logEvent(xe.gW,{isDefault:V,isApplyToAllPages:w}),d.resolve(!0)),[2,d.promise]})})},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(as.t),D.\u0275\u0275inject(os.C),D.\u0275\u0275inject(vs.Z),D.\u0275\u0275inject(ds.C),D.\u0275\u0275inject(zt.i),D.\u0275\u0275inject(Ja.r),D.\u0275\u0275inject(Vt.D),D.\u0275\u0275inject(Wr.O),D.\u0275\u0275inject(on.J),D.\u0275\u0275inject(Ei.U),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(jr),D.\u0275\u0275inject(Ya.U),D.\u0275\u0275inject(Sr.H),D.\u0275\u0275inject(hs.e),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(ps),D.\u0275\u0275inject(ln.l6),D.\u0275\u0275inject(sn.j),D.\u0275\u0275inject(Lt.y0),D.\u0275\u0275inject(Pr.f),D.\u0275\u0275inject(ei.z),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D),D.\u0275\u0275inject(xr.A),D.\u0275\u0275inject(Za.M),D.\u0275\u0275inject(un.t))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function ur(n,e,t,r,i){var a=i.explorationNavigation.getCurrentSection();i.undoRedo.register(n,function(){var o=a.objects||{};Zr(e,t,o,r),a.objects=o}),i.eventBridge.publishToChannel(Ke.H8N,a)}function dn(n,e,t,r,i){var a=(0,xt.MO)(n);n===Qe.t.Custom&&0!==i&&(a=e),t.publishToChannel(Ke.qHu,a);var o=n===Qe.t.Tooltip;!o&&(1===i||n===Qe.t.Custom)||r.setCanvasDisplay(o?3:1)}function hn(n,e,t,r,i){e.setSectionType(t,r,n),(i?2===n:null==n||0===n)||e.setCrossReportDrillthrough(t,r,!1,!1)}var ki="editable-container-object-name",ms=function(){function n(){this.referencedDescriptors=[],this.revertToDefaultDescriptors=[],this.revertToDefaultProperties=new Set}return n.prototype.addDescriptors=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(_.isEmpty(t))return this;(e=this.revertToDefaultDescriptors).push.apply(e,t||[]);for(var i=0,a=t;i<a.length;i++){var s=this.getDescriptorString(a[i]);this.revertToDefaultProperties.add(s)}return this},n.prototype.getDescriptors=function(){return this.revertToDefaultDescriptors},n.prototype.getDescriptorString=function(e){return"".concat(e.objectName,"-").concat(e.propertyName)},n.prototype.hasDescriptor=function(e){var t=this.getDescriptorString(e);return this.revertToDefaultProperties.has(t)},n.prototype.hasDescriptors=function(){return!_.isEmpty(this.revertToDefaultDescriptors)},n.prototype.addReferencedDescriptor=function(e){this.referencedDescriptors.push(e)},n.prototype.validateRevertToDefaultDescriptors=function(){if(this.hasDescriptors())for(var t=0,r=this.referencedDescriptors;t<r.length;t++){var i=r[t];this.hasDescriptor(i)||b.fF.assertFail("Descriptor '".concat(this.getDescriptorString(i),"' is missing from RevertToDefault"))}},n}(),fn=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v,h,f,m,g,y,w,V,q,F){this.propertyChangeIndicatorService=e,this.analyticsFormattingService=i,this.canvasItemFormattingService=a,this.conditionalFormattingService=o,this.contextActivityService=s,this.featureSwitchService=l,this.localizationService=u,this.pageFormattingService=c,this.visualFormattingService=d,this.containerSelectionChangedSubject=new ai.xQ,this.selectedContainerItems=new Map,this.selectedListEditorItems=new Map,this.saveServices={contextActivityService:s,explorationNavigation:t,featureSwitchService:l,layoutAuthoring:r,localizationService:u,resourceLoader:v,resourceRegistration:h,telemetryService:f,themeService:m,undoRedo:y,visualAuthoring:w,visualPlugin:V,visualStylePresetService:q,visualSync:F,trustedVisualService:g}}return n.prototype.getFormattingOptions=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,s,l;return(0,p.__generator)(this,function(c){switch(c.label){case 0:switch(t){case"Visual":return[3,1];case"Format_Label_General":return[3,3];case"Page":return[3,5];case"Analytics":return[3,7]}return[3,9];case 1:return[4,this.visualFormattingService.getFormattingModel(e)];case 2:return r=c.sent(),i=this.visualFormattingService.getObjectDescriptors(e),a=this.visualFormattingService.getFormatPaneSliceTransform(e),[3,10];case 3:return[4,this.canvasItemFormattingService.getFormattingModel(e)];case 4:return r=c.sent(),i=this.canvasItemFormattingService.getObjectDescriptors(e),a=this.canvasItemFormattingService.getFormatPaneSliceTransform(e),[3,10];case 5:return[4,this.pageFormattingService.getFormattingModel()];case 6:return r=c.sent(),i=this.pageFormattingService.getObjectDescriptors(),a=this.pageFormattingService.getFormatPaneSliceTransform(),[3,10];case 7:return[4,this.analyticsFormattingService.getFormattingModel(e)];case 8:return r=c.sent(),i=this.analyticsFormattingService.getObjectDescriptors(e),a=this.analyticsFormattingService.getFormatPaneSliceTransform(e),[3,10];case 9:b.fF.assertNever(t),c.label=10;case 10:return s={cards:{},groups:{},slices:{},revertToDefaultDescriptors:[],canvasItem:e?new wr.lD(e,function(d){return d===e||d&&e&&e.name===d.name}):void 0},r?(l=this.getObjectDefinitions(t,e),[4,this.updateFormattingContract(e,{objectDefinitions:l,objectDescriptors:i,originSource:t},r,a,s,t)]):[2,s];case 11:return c.sent(),[2,s]}})})},n.prototype.getRevertToDefaultMetadata=function(e,t){if(!t)return{formattingSettingsString:void 0,itemTypeDisplayName:void 0};switch(t){case"Visual":return this.visualFormattingService.getRevertToDefaultMetadata(e);case"Format_Label_General":return this.canvasItemFormattingService.getRevertToDefaultMetadata(e);case"Page":return this.pageFormattingService.getRevertToDefaultMetadata();case"Analytics":return this.analyticsFormattingService.getRevertToDefaultMetadata(e);default:b.fF.assertNever(t)}},n.prototype.getContainerChanged$=function(){return this.containerSelectionChangedSubject.asObservable()},n.prototype.updateFormattingContract=function(e,t,r,i,a,o){var s;return(0,p.__awaiter)(this,void 0,void 0,function(){var l,u,c,d,v,h,f,m,g,w=this;return(0,p.__generator)(this,function(V){switch(V.label){case 0:l=[],u=i,c=o,d=[],v=0,h=function(F){var N,T,P,O,E,L,B,A,z,G,ne,oe,ee,le,Fe,Ye;return(0,p.__generator)(this,function(et){switch(et.label){case 0:return T=t,P=new ms,(0,S.Qu)(F)?[4,f.resolvePlaceholder(F,e)]:[3,2];case 1:if(!(O=et.sent()))return[2,"continue"];if(N=O.item,T={objectDescriptors:O.objectDescriptors,objectDefinitions:f.getObjectDefinitions(E=O.originSource,e),originSource:E},L=O.revertToDefaultDescriptors){for(B=[],A=0,z=L;A<z.length;A++)B.push((0,p.__assign)((0,p.__assign)({},z[A]),{originSource:E}));P.addDescriptors.apply(P,B)}return[3,3];case 2:(N=F).analyticsPane&&(T=(0,p.__assign)((0,p.__assign)({},T),{originSource:"Analytics"})),P.addDescriptors.apply(P,(null!==(s=N.revertToDefaultDescriptors)&&void 0!==s?s:[]).map(function(We){return(0,p.__assign)((0,p.__assign)({},We),{originSource:T.originSource})})),et.label=3;case 3:return G=ce.LF(N.uid,c),ne=r.warnings,oe=r.warnings$,[4,f.getFormattingGroupsContract(e,T,N.groups,f.getDisabledState(N.topLevelToggle),G,N.displayName,i,void 0,void 0,P,ne,o,[])];case 4:return ee=et.sent(),le=N.topLevelToggle?f.getSimpleFormattingSlice(e,T,N.topLevelToggle,!!N.disabled,N.displayName,u,void 0,P,ne):void 0,Fe=P.getDescriptors(),d.push.apply(d,Fe),Ye=(0,p.__assign)((0,p.__assign)({},N),{pivotSource:c,uid:G,warningMessage:f.getCardWarning(ne,N,ee,le),warningMessage$:oe&&oe.pipe((0,me.U)(function(We){return w.getCardWarning(We,N,ee,le)})),topLevelToggle:le?(0,p.__assign)((0,p.__assign)({},le),{isTopLevelToggle:!0,originSource:T.originSource}):void 0,revertToDefaultDescriptors:Fe,originSource:T.originSource,index:v++,groupUids:ee.map(function(We){return We.uid}),groups:ee}),l.push(Ye),P.validateRevertToDefaultDescriptors(),[2]}})},f=this,m=0,g=r.cards,V.label=1;case 1:return m<g.length?[5,h(g[m])]:[3,4];case 2:V.sent(),V.label=3;case 3:return m++,[3,1];case 4:return this.normalize(l,a),a.revertToDefaultDescriptors=d,[2]}})})},n.prototype.normalize=function(e,t){for(var r,i,a=0,o=0,s=e;o<s.length;o++){var l=s[o];t.cards[l.uid]=l;for(var u=l.originSource,c=function(m){for(var y=[],w=0,V=m.slices?(0,p.__spreadArray)([],m.slices,!0):[];w<V.length;w++){var q=V[w],F=(0,lr.O7)(q),N=(0,lr.$Q)(q.uid,F);t.slices[N]&&(q.uid="".concat(q.uid,"___").concat(a++,"___"),N=(0,lr.$Q)(q.uid,F));var T=(0,p.__assign)((0,p.__assign)({},q),{groupUid:m.uid,originSource:null!==(r=q.originSource)&&void 0!==r?r:u});t.slices[N]=T;for(var O=0,E=(0,S.IW)(T)?ce.ce(T):[T];O<E.length;O++){var L=E[O],B=ce.zh(L.control.properties.descriptor);t.slices[B]=L}y.push({uid:T.uid,selector:F})}delete m.slices,b.fF.assert(function(){return!t.groups[m.uid]},"duplicate group uid ".concat(m.uid)),t.groups[m.uid]=(0,p.__assign)((0,p.__assign)({},m),{originSource:null!==(i=m.originSource)&&void 0!==i?i:u,sliceIds:y})},d=0,v=l.groups;d<v.length;d++)c(v[d]);delete l.groups}},n.prototype.getModelUnavailableInformation=function(e,t){switch(e){case"Visual":return this.visualFormattingService.getModelUnavailableInformation(t);case"Format_Label_General":return this.canvasItemFormattingService.getModelUnavailableInformation(t);case"Page":return{messageKey:void 0};case"Analytics":return this.analyticsFormattingService.getModelUnavailableInformation(t);default:b.fF.assertNever(e)}},n.prototype.getFormattingModelMessage=function(e,t){switch(e){case"Visual":return this.visualFormattingService.getFormattingModelMessage(t);case"Format_Label_General":case"Page":case"Analytics":return;default:b.fF.assertNever(e)}},n.prototype.getObjectDefinitions=function(e,t,r){switch(e){case"Visual":return this.visualFormattingService.getObjectDefinitions(t,r);case"Format_Label_General":return this.canvasItemFormattingService.getObjectDefinitions(t,r);case"Page":return this.pageFormattingService.getObjectDefinitions();case"Analytics":return this.analyticsFormattingService.getObjectDefinitions(t,r);default:b.fF.assertNever(e)}},n.prototype.getRevertToDefaultEnabled=function(e,t,r){if(_.isEmpty(t))return!1;var i=_.groupBy(t,function(u){return u.originSource}),a=!1;for(var o in i){var s=o;switch(s){case"Visual":case"Format_Label_General":var l=this.getObjectDefinitions(s,e,!0);a=ce.wW(t,l,r,this.featureSwitchService.featureSwitches.onObject);break;case"Page":a=this.pageFormattingService.getRevertToDefaultEnabled(t,r);break;case"Analytics":a=this.analyticsFormattingService.getRevertToDefaultEnabled(e,t??[],r);break;default:b.fF.assertNever(s)}if(a)break}return a},n.prototype.getSliceShowChangeIndicator=function(e,t,r){var i=t.originSource;switch(i){case"Visual":case"Format_Label_General":case"Page":return this.shouldShowSliceChangeIndicator(e,t,r);case"Analytics":return this.analyticsFormattingService.shouldShowSliceChangeIndicator();default:b.fF.assertNever(i)}},n.prototype.shouldShowSliceChangeIndicator=function(e,t,r){var a=this.getObjectDefinitions(t.originSource,e,!0);return this.propertyChangeIndicatorService&&this.propertyChangeIndicatorService.shouldShowSliceChangeIndicator(r,a)},n.prototype.getCardWarning=function(e,t,r,i){var a;if(e){var o=e[t.uid];o&&!(o instanceof wa.L)&&(a=o)}if(i&&i.warningMessage&&(a=i.warningMessage.source),!a){var s=r.find(function(l){return!!l.warningMessage});s&&s.warningMessage&&(a=s.warningMessage.source)}if(a)return ti(a,this.localizationService,!0)},n.prototype.getGroupWarning=function(e,t){var r;if(t&&t.warningMessage&&(r=t.warningMessage.source),!r){var i=e.find(function(a){return!!a.warningMessage});i&&(r=i.warningMessage.source)}if(r)return ti(r,this.localizationService,!0)},n.prototype.getSliceWarning=function(e,t,r){if(e.conditionalFormattingWarning)return e.conditionalFormattingWarning;var i=this.getWarningForDescriptor(r,t);return i?ti(i,this.localizationService):void 0},n.prototype.resolvePlaceholder=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r;return(0,p.__generator)(this,function(i){switch(i.label){case 0:return(0,S.Dw)(e)?[4,this.canvasItemFormattingService.resolvePlaceholder(e,t)]:[3,2];case 1:return[2,(r=i.sent())?(0,p.__assign)((0,p.__assign)({},r),{originSource:"Format_Label_General"}):void 0];case 2:if((0,S.d5)(e))return[2,(r=this.visualFormattingService.resolvePlaceholder(e,t))?(0,p.__assign)((0,p.__assign)({},r),{originSource:"Visual"}):void 0];b.fF.assertFail("Unexpected placeholder type"),i.label=3;case 3:return[2]}})})},n.prototype.getFormattingGroupsContract=function(e,t,r,i,a,o,s,l,u,c,d,v,h){var f;return(0,p.__awaiter)(this,void 0,void 0,function(){var m,g,y,w,V,q,F,N;return(0,p.__generator)(this,function(P){switch(P.label){case 0:m=[],g=s,y=_.cloneDeep(h),V=function(E){var L,B,A,z,R,G,ne,oe,ee,Fe,Ye,et,We,Pe,Re,bt,ft,rr,Ct,Tt,si;return(0,p.__generator)(this,function(ir){switch(ir.label){case 0:return B=t,(0,S.Qu)(E)?[4,q.resolvePlaceholder(E,e)]:[3,2];case 1:if(!(A=ir.sent()))return[2,"continue"];if(L=A.item,z=A.originSource,R=A.objectDescriptors,G=A.revertToDefaultDescriptors){for(ne=[],oe=0,ee=G;oe<ee.length;oe++)ne.push((0,p.__assign)((0,p.__assign)({},ee[oe]),{originSource:z}));c.addDescriptors.apply(c,ne)}return B={objectDescriptors:R,objectDefinitions:q.getObjectDefinitions(z,e),originSource:z},[3,3];case 2:L=E,ir.label=3;case 3:return w=L.displayName?"".concat(o," - ").concat(L.displayName):"".concat(o),Fe=[],Ye=[],et=null===(f=L.inheritDisabled)||void 0===f||f,We=et&&i||L.disabled,Pe=B.originSource,Re=L.topLevelToggle?q.getSimpleFormattingSlice(e,B,L.topLevelToggle,We,w,g,void 0,c,d):void 0,L.topLevelToggle=Re,L.container&&L.container.containerItems.length>0?[4,q.convertFormattingContainers(e,B,L.container,a,L.uid,We||q.getDisabledState(L.topLevelToggle),s,w,L.containerDisabled,c,d,v,h)]:[3,5];case 4:bt=ir.sent(),Fe=bt.slices,Ye=bt.groups,ir.label=5;case 5:return L.container=void 0,[4,q.getFormattingSliceContracts(e,B,L.slices,We||q.getDisabledState(L.topLevelToggle),w,s,u,c,d,L.uid,v)];case 6:return ft=ir.sent(),rr=!!L.displayName&&(!!_.isUndefined(L.collapsible)||L.collapsible),Ct=_.concat(ft,Fe),Tt=q.getGroupWarning(Ct,Re),si=(0,p.__assign)((0,p.__assign)({},L),{collapsible:rr,disableInteractivity:l?.disableInteractivity,warningMessage:Tt,disabled:We,originSource:Pe,cardUid:a,pivotSource:v,sliceIds:Ct.map(function(Ue){return{uid:Ue.uid,selector:(0,lr.O7)(Ue)}}),slices:Ct,parentContainers:y,topLevelToggle:Re?(0,p.__assign)((0,p.__assign)({},Re),{isTopLevelToggle:!0,originSource:Pe}):void 0}),m.push(si),m=_.concat(m,Ye),b.fF.assert(function(){return L.sliceWithContainer||!(ft.length>0&&Fe.length>0)},"we don't have proper UI for supporting containers and slices in same group"),[2]}})},q=this,F=0,N=r,P.label=1;case 1:return F<N.length?[5,V(N[F])]:[3,4];case 2:P.sent(),P.label=3;case 3:return F++,[3,1];case 4:return[2,m]}})})},n.prototype.convertFormattingContainers=function(e,t,r,i,a,o,s,l,u,c,d,v,h){return(0,p.__awaiter)(this,void 0,void 0,function(){var f,m,g,y,w,V,q,F,N,T,P,O,E,L,B,A;return(0,p.__generator)(this,function(z){switch(z.label){case 0:if(r.containerItems.length<=0)return[2];f=[],m=this.getContainerDropdownDescriptor(i,r.uid,r.isEditable),g=m.propertyName,r.isEditable?(T=r.containerItems.map(function(R,G){return{displayName:R.displayName,value:G,uid:R.uid}}),y=this.getSelectedListEditorItemIndex(g),T=_.filter(T,function(R){return!_.isEmpty(R.displayName)}),_.isEmpty(T)&&(y=0),w={displayName:r.displayName,disabled:o,control:{type:"ListEditor",properties:{descriptor:(0,p.__assign)((0,p.__assign)({},m),{type:{}}),value:{items:T,selectedItem:T[y]}}},uid:(0,S.bP)(m.objectName,m.propertyName),originSource:void 0,pivotSource:v,groupUid:a},f.push(w)):(V=this.getSelectedContainerItemName(g),T=r.containerItems.map(function(R,G){var ne={displayName:R.displayName,value:R.displayName,icon:R.icon?{glyph:R.icon}:void 0};return 0===G&&(F=ne,N=0),R.defaultSelected&&(F=ne,N=G),(0===G&&null===V||V===R.displayName)&&(q=ne),ne}),(y=_.findIndex(r.containerItems,function(R){return R.displayName===V}))<0&&(y=N,q=F),P={displayName:r.displayName,disabled:o||!!u,control:{type:"Dropdown",properties:{descriptor:(0,p.__assign)((0,p.__assign)({},m),{type:{}}),items:T,value:q}},uid:(0,S.bP)(m.objectName,m.propertyName),originSource:void 0,groupUid:a,pivotSource:v},f.push(P)),O=[],E=this.featureSwitchService.featureSwitches.onObject,L=function(G){var ne,oe,le,Fe,Ye,et,We,Pe,Re,bt,ft,rr;return(0,p.__generator)(this,function(Ct){switch(Ct.label){case 0:return E||G===y?(oe=G!==y,le=(ne=r.containerItems[G]).disabled,Fe=o||le,Ye=(0,p.__spreadArray)((0,p.__spreadArray)([],h,!0),[{containerName:g,value:ne.displayName}],!1),et={groups:[],slices:[]},ne.container?[4,B.convertFormattingContainers(e,t,ne.container,i,ne.container.uid,o,s,l,u,c,d,v,Ye)]:[3,2]):[2,"continue"];case 1:et=Ct.sent(),Ct.label=2;case 2:return(We=ne.slices)?[4,B.getFormattingSliceContracts(e,t,We,Fe,l,s,r.displayName,c,d,a,v)]:[3,4];case 3:return Re=Ct.sent(),[3,5];case 4:Re=[],Ct.label=5;case 5:return Pe=(Pe=Re).concat(et.slices),f=_.concat(f,_.map(Pe,function(Tt){return(0,p.__assign)((0,p.__assign)({},Tt),{hidden:Tt.hidden||oe})})),(bt=ne.groups)?[4,B.getFormattingGroupsContract(e,t,bt,Fe,i,l,s,le?{disableInteractivity:!0,collapsed:!0}:void 0,r.displayName,c,d,v,Ye)]:[3,7];case 6:return rr=Ct.sent(),[3,8];case 7:rr=[],Ct.label=8;case 8:return ft=(ft=rr).concat(et.groups),O=_.concat(O,_.map(ft,function(Tt){return(0,p.__assign)((0,p.__assign)({},Tt),{uid:E?(0,lr.aO)(Tt.uid,G):Tt.uid,hidden:oe||Tt.hidden})})),[2]}})},B=this,A=0,z.label=1;case 1:return A<r.containerItems.length?[5,L(A)]:[3,4];case 2:z.sent(),z.label=3;case 3:return A++,[3,1];case 4:return[2,{slices:f,groups:O}]}})})},n.prototype.getSelectedContainerItemName=function(e){return this.selectedContainerItems.has(e)||this.selectedContainerItems.set(e,null),this.selectedContainerItems.get(e)},n.prototype.getSelectedListEditorItemIndex=function(e){return this.selectedListEditorItems.has(e)||this.selectedListEditorItems.set(e,0),this.selectedListEditorItems.get(e)},n.prototype.getContainerDropdownDescriptor=function(e,t,r){return{objectName:r?ki:ce.nB,propertyName:e+"-"+t+"-container"}},n.prototype.getFormattingSliceContracts=function(e,t,r,i,a,o,s,l,u,c,d){return(0,p.__awaiter)(this,void 0,void 0,function(){var v,h,f,m,g,y,w,V,q,F,N,T,O;return(0,p.__generator)(this,function(E){switch(E.label){case 0:if(!r)return[2,[]];v=[],h=0,f=r,E.label=1;case 1:return h<f.length?(g=void 0,y=t,(0,S.Qu)(m=f[h])?[4,this.resolvePlaceholder(m,e)]:[3,3]):[3,6];case 2:if(!(w=E.sent()))return[3,5];if(g=w.item,y={objectDescriptors:w.objectDescriptors,objectDefinitions:this.getObjectDefinitions(V=w.originSource,e),originSource:w.originSource},q=w.revertToDefaultDescriptors){for(F=[],N=0,T=q;N<T.length;N++)F.push((0,p.__assign)((0,p.__assign)({},T[N]),{originSource:V}));l.addDescriptors.apply(l,F)}return[3,4];case 3:g=m,E.label=4;case 4:(O=this.getFormattingSliceContract(e,y,g,i,a,o,s,l,u,c,d))&&v.push(O),E.label=5;case 5:return h++,[3,1];case 6:return[2,v]}})})},n.prototype.getDisabledState=function(e){return!!e&&!e.control.properties.value},n.prototype.getFormattingSliceContract=function(e,t,r,i,a,o,s,l,u,c,d){var v;if((0,S.IW)(r)){var f=this.getCompositeFormattingSlice(e,t,r,i,o,l,u);f&&(v=(0,p.__assign)((0,p.__assign)({},f),{pivotSource:d,groupUid:c}))}else{var g=this.getSimpleFormattingSlice(e,t,r,i,a,o,s,l,u);g&&(v=(0,p.__assign)((0,p.__assign)({},g),{pivotSource:d,groupUid:c}))}return v},n.prototype.getSimpleFormattingSlice=function(e,t,r,i,a,o,s,l,u){var c=t.objectDescriptors,d=t.originSource,v=r.control.properties.descriptor;_.isEmpty(v.propertyName)||l.addReferencedDescriptor((0,p.__assign)((0,p.__assign)({},v),{originSource:d}));var h=ce.w7(v,c),f=this.getTypeFromObjectDescriptor(v,h),g=o(r,c,{conditionalFormattingDisplayName:a,containerSliceDisplayName:s,formattingDescriptor:v,formattingModelWarnings:u,formattingObjectOptions:t,propertyDescriptor:h,type:f,canvasItem:e});if(g){var y=this.getSliceShowChangeIndicator(e,t,v),w=this.getFormattingDescriptorContract({formattingDescriptor:v,type:f}),V=this.getSliceWarning(g,v,u),q=g.control,F=(0,p.__assign)((0,p.__assign)({},q),{properties:(0,p.__assign)((0,p.__assign)({},q.properties),{descriptor:w})});return(0,p.__assign)((0,p.__assign)({},g),{disabled:i||g.disabled,control:F,warningMessage:V,showChangeIndicator:y,originSource:d})}},n.prototype.getCompositeFormattingSlice=function(e,t,r,i,a,o,s){var l=t.objectDescriptors,u=t.originSource;if(r=a(r,l,void 0)){var c=r.control;b.fF.assertValue(r.displayName,"Composite controls must specify a display name");var d,v=!1,h=c.properties,f={};for(var m in h){var g=m,y=h[g];if(y){var w=y.descriptor;_.isEmpty(w.propertyName)||o.addReferencedDescriptor((0,p.__assign)((0,p.__assign)({},w),{originSource:u}));var V=ce.w7(y.descriptor,l),q=y.descriptor;!v&&this.getSliceShowChangeIndicator(e,t,q)&&(v=!0);var F=this.getTypeFromObjectDescriptor(q,V),N=this.getFormattingDescriptorContract({formattingDescriptor:q,type:F});d=d||this.getSliceWarning(r,q,s),f[g]=(0,p.__assign)((0,p.__assign)({},y),{descriptor:N})}}var T=(0,p.__assign)((0,p.__assign)({},c),{properties:f});return(0,p.__assign)((0,p.__assign)({},r),{disabled:i||r.disabled,control:T,warningMessage:d,showChangeIndicator:v,originSource:u})}},n.prototype.getWarningForDescriptor=function(e,t){if(e){var r=e[t.objectName];if(r){var i=this.conditionalFormattingService.getDataBoundExprWarning(r,t);if(i)return i;if(this.featureSwitchService.featureSwitches.onObject){var a=r.propertyName;if(a&&a===t.propertyName)return r}}}},n.prototype.getFormattingDescriptorContract=function(e){var r=e.type;return(0,p.__assign)((0,p.__assign)({},e.formattingDescriptor),{type:r})},n.prototype.getTypeFromObjectDescriptor=function(e,t){var r,i=(0,Ve.sH)(t?.type||{},e.propertyTypes),a=null===(r=t?.type)||void 0===r?void 0:r.variant;return a&&(i=(0,p.__assign)((0,p.__assign)({},i),{variant:a})),i},n.prototype.createSaveFormattingSlicesActivity=function(e){return this.contextActivityService.createActivity((0,p.__assign)({name:"Save Formatting Slices"},e))},n.prototype.createChangeFormatActivity=function(e,t,r,i,a,o,s){return s.createChildActivity({name:"Change Format",data:(0,p.__assign)({propertyName:a,objectName:i},o),visualName:e,visualType:t,uid:r})},n.prototype.revertToDefault=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d,v,h,f;return(0,p.__generator)(this,function(g){switch(g.label){case 0:if(t)for(i=0,a=Array.from(this.selectedContainerItems.keys());i<a.length;i++)(o=a[i]).startsWith(t)&&this.selectedContainerItems.delete(o);else this.selectedContainerItems.clear();for(c in s=_.groupBy(e,function(y){return y.originSource}),u=[],l=s)u.push(c);d=0,g.label=1;case 1:if(!(d<u.length))return[3,10];if(!((c=u[d])in l))return[3,9];switch(f=s[v=c],h=v){case"Page":return[3,2];case"Analytics":return[3,4];case"Visual":return[3,5];case"Format_Label_General":return[3,6]}return[3,8];case 2:return[4,this.pageFormattingService.revertPageSliceDefinitions(f)];case 3:return g.sent(),[3,9];case 4:return this.analyticsFormattingService.revertVisualSlicesToDefinitions(f,r),[3,9];case 5:return this.visualFormattingService.revertVisualSlicesToDefinitions(f,r),[3,9];case 6:return[4,this.canvasItemFormattingService.revertVisualSlicesToDefinitions(f,r)];case 7:return g.sent(),[3,9];case 8:b.fF.assertNever(h),g.label=9;case 9:return d++,[3,1];case 10:return[2]}})})},n.prototype.changeContainerDropdownValue=function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];this.selectedContainerItems.set(a.containerName,a.value)}this.containerSelectionChangedSubject.next({canvasItems:t})},n.prototype.saveFormattingSlicesValue=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,c,d,v,h,f,m,g,y;return(0,p.__generator)(this,function(w){switch(w.label){case 0:i=this.createSaveFormattingSlicesActivity(t),w.label=1;case 1:return w.trys.push([1,7,,8]),a=[],"No Telemetry"!==t.source&&((o=null===(r=e[0].canvasItems)||void 0===r?void 0:r[0])?(0,Qo.v)(o,this.saveServices.visualPlugin,this.saveServices.trustedVisualService)||(a=this.createChangeFormatContextActivitiesFromChanges(e,t,i,o)):"Pane"===t.source&&(a=this.createChangeFormatContextActivitiesFromChanges(e,t,i,o))),1===_.size(e)&&e[0].objectName===ce.nB?(this.changeContainerDropdownValue([{containerName:(d=(c=e[0]).propertySlice).name,value:d.value}],v=c.canvasItems),[2]):1===_.size(e)&&e[0].objectName===ki?(d=(c=e[0]).propertySlice,v=c.canvasItems,this.isEditableContainerWithSelectionChangeOnly(e)&&this.containerSelectionChangedSubject.next({canvasItems:v}),h=d.value,f=_.filter(h.items,function(V){var q;return!_.find(null===(q=h.itemUpdates)||void 0===q?void 0:q.deletes,function(F){return F.displayName===V.displayName})}),m=_.isEmpty(f)?0:_.findIndex(f,function(V){return _.isEqual(V.value,h.selectedItem.value)}),b.fF.assert(function(){return m>=0},"Expect the selected index of EditableContainer always >=0"),[4,this.saveProperties(e,i)]):[3,3];case 2:return w.sent(),m>=0&&this.selectedListEditorItems.get(d.name)!==m&&this.selectedListEditorItems.set(d.name,m),[2];case 3:return w.trys.push([3,5,,6]),[4,this.saveProperties(e,i)];case 4:return w.sent(),a.forEach(function(V){return V.resolve()}),[3,6];case 5:throw g=w.sent(),a.forEach(function(V){return V.reject(g)}),g;case 6:return i.resolve(),[3,8];case 7:throw y=w.sent(),i.reject(y),y;case 8:return[2]}})})},n.prototype.createChangeFormatContextActivitiesFromChanges=function(e,t,r,i){var a=this;return e.map(function(o){var s,l,u=o.objectName,c=null===(s=o.propertySlice)||void 0===s?void 0:s.name,d=null!==(l=i?.name)&&void 0!==l?l:void 0,v=i&&(0,vi.s)(i);return a.createChangeFormatActivity(d,v,o.uid,u,c,t,r)})},n.prototype.isEditableContainerWithSelectionChangeOnly=function(e){var t,r,i;if(_.size(e)>1||e[0].objectName!==ki)return!1;var a=e[0].propertySlice,o=a.value;return!!(_.isEmpty(null===(t=o.itemUpdates)||void 0===t?void 0:t.adds)&&_.isEmpty(null===(r=o.itemUpdates)||void 0===r?void 0:r.deletes)&&_.isEmpty(null===(i=o.itemUpdates)||void 0===i?void 0:i.renames))&&this.selectedListEditorItems.get(a.name)!==_.findIndex(o.items,function(u){return _.isEqual(u.value,o.selectedItem.value)})},n.prototype.saveProperties=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a,o;return(0,p.__generator)(this,function(s){switch(s.label){case 0:return o=_.partition(e,function(l){return"Page"===l.formattingSource}),r=o[0],i=o[1],_.isEmpty(r)?[3,2]:[4,this.pageFormattingService.saveProperties(r,this.saveServices)];case 1:s.sent(),s.label=2;case 2:return _.isEmpty(i)?[3,4]:(a=i.map(function(l){var u=_.some(ni,function(c){return l.objectName===c.objectName});return(0,p.__assign)((0,p.__assign)({},l),{formattingSource:u?"Format_Label_General":l.formattingSource})}),[4,this.saveCanvasProperties(a,t)]);case 3:s.sent(),s.label=4;case 4:return[2]}})})},n.prototype.saveCanvasProperties=function(e,t){return(0,p.__awaiter)(this,void 0,void 0,function(){var r,i,a=this;return(0,p.__generator)(this,function(o){switch(o.label){case 0:return r=_.groupBy(e,function(s){return s.formattingSource}),i=[],this.saveServices.undoRedo.register("SaveFormattingValues",function(){for(var s in r)for(var c=0,d=a.getChangesPerCanvasItem(r[s]);c<d.length;c++){var v=d[c];switch(s){case"Format_Label_General":a.canvasItemFormattingService.saveProperties(v.changes,a.saveServices,v.canvasItem,t);break;case"Visual":a.visualFormattingService.saveProperties(v.changes,a.saveServices,v.canvasItem,t);break;case"Analytics":i.push(a.analyticsFormattingService.saveProperties(v.changes,v.canvasItem,t))}}}),[4,Promise.all(i)];case 1:return o.sent(),[2]}})})},n.prototype.getChangesPerCanvasItem=function(e){var t={},r={};e.forEach(function(o){o.canvasItems.forEach(function(s){var l=s.name;r[l]=s,t[l]||(t[l]=[]);var u=(0,p.__assign)({},o);t[l]=(0,p.__spreadArray)((0,p.__spreadArray)([],t[l],!0),[u],!1)})});var i=[];for(var a in t)i.push({canvasItem:r[a],changes:t[a].map(function(o){return(0,p.__assign)((0,p.__assign)({},o),{canvasItems:void 0})})});return i},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject($o.Ol,8),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(Ya.U),D.\u0275\u0275inject(Pi),D.\u0275\u0275inject(Ka),D.\u0275\u0275inject(Ti),D.\u0275\u0275inject(Ja.r),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(vn),D.\u0275\u0275inject(Xa),D.\u0275\u0275inject(ln.l6),D.\u0275\u0275inject(sn.j),D.\u0275\u0275inject(Lt.y0),D.\u0275\u0275inject(Pr.f),D.\u0275\u0275inject(un.t),D.\u0275\u0275inject(ei.z),D.\u0275\u0275inject(vt.$8),D.\u0275\u0275inject(qt.D),D.\u0275\u0275inject(xr.A),D.\u0275\u0275inject(Za.M))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Jt=C(63057),gs=C(37272),cr=C(82762),Gi=C(38860),_t=C(11547),kt=C(59973),er=C(83317),Lr=C(23558),mn=C(22318),ys=C(6663),at=C(81905),Ss=C(73805),_s=C(91615),bs=C(95281),tr=C(85732),Gt=C(77526),Wt=function(e){return e},gn=function(){function n(){}return n.prototype.create=function(){return new Ns},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac=function(t){return new(t||n)}}),n}(),Ns=function(n){function e(){var t=n.call(this)||this;return t.setState({cards:void 0,groups:void 0,slices:void 0,revertToDefaultDescriptors:[],canvasItem:void 0}),t.state$.pipe((0,Ui.q)(1)).subscribe(function(r){b.fF.assert(function(){return void 0===r.cards&&void 0===r.groups&&void 0===r.slices},"FormattingStore: state should be empty")}),t}return(0,p.__extends)(e,n),e.prototype.getViewModel$=function(){return this.select(Wt).pipe((0,kt.h)(function(t){return!(void 0===t.cards&&void 0===t.groups&&void 0===t.slices)}))},e.prototype.selectAllCards=function(){return this.select((0,tr.P1)(Wt,function(e){return e.cards}))},e.prototype.selectTopLevelToggle=function(t,r){return this.select(function(e,t){return(0,tr.P1)(Wt,function(r){var i,a=function(s){return(ce.hy(s.uid,e,(0,lr.O7)(s),t)||ce.zh(s.control.properties.descriptor)===e)&&(i=s,!0)};return r.cards&&Object.keys(r.cards).forEach(function(o){var l=r.cards[o].topLevelToggle;l&&a(l)&&(i=l)}),i||r.groups&&Object.keys(r.groups).forEach(function(o){var l=r.groups[o].topLevelToggle;l&&a(l)&&(i=l)}),i})}(t,r)).pipe((0,Gt.x)(_.isEqual))},e.prototype.selectGroup=function(t){return this.select(function(e){return(0,tr.P1)(Wt,function(t){return t.groups&&t.groups[e]})}(t)).pipe((0,Gt.x)(_.isEqual))},e.prototype.selectSlice=function(t,r){return this.select(function(e,t){return(0,tr.P1)(Wt,function(r){var i=(0,lr.$Q)(e,t);return r.slices&&r.slices[i]})}(t,r)).pipe((0,Gt.x)(_.isEqual))},e.prototype.selectCard=function(t){return this.select(function(e){return(0,tr.P1)(Wt,function(t){return t.cards&&t.cards[e]})}(t)).pipe((0,Gt.x)(_.isEqual))},e.prototype.getChartElementsContract$=function(){var t=this,r=(0,tr.P1)(Wt,function(i){return t.getChartElementsFormatContract(i)});return this.select(r).pipe((0,Gt.x)(_.isEqual))},e.prototype.getCanvasItem$=function(){var t=(0,tr.P1)(Wt,function(r){return r.canvasItem});return this.select(t).pipe((0,Gt.x)())},e.prototype.getChartElementsFormatContract=function(t){var r=[];return function(o){for(var s in o){var l=o[s];l.topLevelToggle&&"Visual"===l.pivotSource&&r.push({formattingSource:l.originSource,displayName:l.displayName,description:l.description,checked:l.topLevelToggle.control.properties.value,uid:l.topLevelToggle.uid,descriptor:l.topLevelToggle.control.properties.descriptor,disabled:l.disabled,disabledReason:l.disabledReason,isAnalyticsPane:l.analyticsPane,warningMessage$:l.warningMessage$})}}(t.cards),_.isEmpty(r)?void 0:{items:r}},e.prototype.getCardTopLevelToggleUids$=function(){var t=this,r=(0,tr.P1)(Wt,function(i){return t.getCardTopLevelToggleUids(i)});return this.select(r).pipe((0,Gt.x)(_.isEqual))},e.prototype.getCardTopLevelToggleUids=function(t){var r=new Set;return function(o){for(var s in o){var l=o[s];l.topLevelToggle&&r.add(l.topLevelToggle.uid)}}(t.cards),r},e}(bs.m1),Vs=C(3307),Ts=C(21024),Ps=C(56083),yn=function(){function n(e,t,r){var i=this;this.localizationService=e,this.paneVisibilityService=t,this.tutorialPopupService=r,this.localCache={},this.destroy$=new ai.xQ,this.paneVisibilityService.getPanes$().pipe((0,Vs.T)(1),(0,kt.h)(function(a){return _.every(Object.values(a),function(o){return!o.isPaneVisible})}),(0,er.R)(this.destroy$)).subscribe(function(){i.startFormattingTutorial("PaneMoveTutorial")})}return n.prototype.startFormattingTutorial=function(e,t){switch(e){case"AnalyticsPaneMoveTutorial":this.localCache.AnalyticsPaneMoveTutorial||this.tutorialPopupService.startTutorial(this.getAnalyticsPaneMoveTutorial(t));break;case"FieldPickerTutorial":this.localCache.FieldPickerTutorial||this.tutorialPopupService.startTutorial(this.getFieldPickerTutorial());break;case"DrillthroughTutorial":this.localCache.DrillthroughTutorial||this.tutorialPopupService.startTutorial(this.getDrillthroughPaneMoveTutorial());break;case"PaneMoveTutorial":this.localCache.PaneMoveTutorial||this.tutorialPopupService.startTutorial(this.getPaneMoveTutorial());break;default:b.fF.assertFail("Unknown formatting tutorial type")}this.localCache[e]=!0},n.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},n.prototype.getPaneMoveTutorial=function(){var e,t="onObjectPaneMoveTutorial",r='ribbon [data-unique-id="view"]';return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_DataPaneMoveTutorial_Title"),text:this.localizationService.get("TutorialPopup_DataPaneMoveTutorial_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},n.prototype.getAnalyticsPaneMoveTutorial=function(e){var t;b.fF.assertAnyValue(!!e,"options should be provided in the case of AnalyticsPaneMoveTutorial");var r="onObjectAnalyticsFormattingTutorial",i=e.selector;return{itemKeys:[r],items:(t={},t[r]={title:this.localizationService.get("TutorialPopup_AnalyticsFormatting_Title"),text:this.localizationService.get("TutorialPopup_AnalyticsFormatting_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:r,canShow:function(){return!!$(i)},attachTo:function(){return $(i)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,offset:e.offset,arrowOffset:e.arrowOffset,closeOnBackdropClick:!0},t),isSequentialTutorial:!1}},n.prototype.getFieldPickerTutorial=function(){var e,t="onObjectFieldPickerTutorial",r="build-field-well field-picker-modern pbi-drag-drop-picker span div.selfAndChildrenContent";return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_FieldWell_Title"),text:this.localizationService.get("TutorialPopup_FieldWell_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r).first()},attachTo:function(){return $(r).first()},customClass:"trident no-icon big-popup",modalButtonClassOverride:"hidden",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},n.prototype.getDrillthroughPaneMoveTutorial=function(){var e,t="onObjectDrillthroughTutorial",r='[data-unique-id="Page-pageInformation"] [data-testid="formatting-card-button"]';return{itemKeys:[t],items:(e={},e[t]={title:this.localizationService.get("TutorialPopup_DrillthroughFormatting_Title"),text:this.localizationService.get("TutorialPopup_DrillthroughFormatting_Content"),buttonLabel:this.localizationService.get("OK_ButtonText"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},customClass:"trident no-icon big-popup",modalButtonClassOverride:"ok-btn white-btn",preferredOrientation:"right",hasCloseBtn:!0,overrideCancelWithClose:!0,closeOnBackdropClick:!0},e),isSequentialTutorial:!1}},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(Ts.r),D.\u0275\u0275inject(Ps.yU))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}();function Wi(n){return void 0!==n?_.omit(n,"deferredStatus"):void 0}function xs(n,e){return void 0!==n?(0,p.__assign)((0,p.__assign)({},n),{deferredStatus:e}):void 0}var Hi="page",Ki=function(){function n(e,t,r,i,a,o,s,l,u,c,d,v){this.sliceCustomizationService=e,this.eventBridge=t,this.explorationNavigationService=r,this.explorationCapabilities=i,this.featureSwitchService=a,this.formattingModelService=o,this.formattingStoreFactory=s,this.formattingTutorialService=l,this.runningVisual=u,this.selectionService=c,this.visualPluginOperationsService=d,this.visualPluginService=v,this.updateCounter=0,this.currentUpdateIds=new Map,this.formattingStores=new Map,this.destroy$=new ai.xQ;var h=this.selectionService.selectedElements$.pipe((0,me.U)(function(f){var m;return null!==(m=f?.reduce(function(g,y){var w=y.canvasItem;return w&&g.push(w),g},[]))&&void 0!==m?m:[]}),(0,qr.d)(1));this.initUpdateHandlers(h),this.initPauseHandlers(h)}return n.prototype.initUpdateHandlers=function(e){var h,t=this,r=function(){t.updateStateInt(t.getNonVisualUpdateSources(),void 0)},a=function(z){z.forEach(function(R){return function(z){t.updateStateInt(t.getVisualUpdateSources(),z)}(R)})},o=this.formattingModelService.getContainerChanged$().pipe((0,me.U)(function(A){return A.canvasItems})),s=this.eventBridge.on(Ke.wAN),l=this.eventBridge.on(Ke.WJC).pipe((0,kt.h)(function(A){return!!A.allowInlineExplorationChanged})),u=this.eventBridge.on(Ke.TTT),c=this.eventBridge.on(Ke.jsX),d=this.explorationNavigationService.sections$,v=this.eventBridge.on(_s.kx);(0,Jt.T)(s,l,u,c,d,v,o.pipe((0,kt.h)(function(A){return _.isEmpty(A)}))).pipe((0,er.R)(this.destroy$)).subscribe(function(){void 0===h&&(h=setTimeout(function(){r(),clearTimeout(h),h=void 0},100))});var P,m=this.eventBridge.on(Ke.Of1).pipe((0,Lr.M)(e),(0,me.U)(function(A){var z=A[0];return A[1].filter(function(G){return(0,J.Vz)(G)&&z.affectContainer(G)})})),g=this.eventBridge.on(Ke.jCS).pipe((0,Lr.M)(e),(0,me.U)(function(A){var z=A[0];return A[1].filter(function(G){return(0,J.Vz)(G)&&z.affectContainer(G)&&(0,sr.LR)(t.visualPluginService,t.visualPluginOperationsService,G)})})),y=(0,Jt.T)(g,m),w=this.eventBridge.on(Ke.D1A),V=this.eventBridge.on(Ke.DSN),q=(0,Jt.T)(w,V).pipe((0,er.R)(this.destroy$),(0,me.U)(function(A){return[A]})),F=this.eventBridge.on(Ke.KD7).pipe((0,me.U)(function(A){return A.changedItems})),N=e.pipe((0,er.R)(this.destroy$),(0,mn.O)([]),(0,ys.G)(),(0,me.U)(function(A){var G=_.difference(A[1],A[0]);return _.isEmpty(G)?[]:G})),T=new Map;(0,Jt.T)(y,F,o,N,q).pipe((0,er.R)(this.destroy$),(0,kt.h)(function(A){return!_.isEmpty(A)})).subscribe(function(A){A.forEach(function(z){T.set(z.name,z)}),void 0===P&&(P=setTimeout(function(){a(Array.from(T.values())),T.clear(),clearTimeout(P),P=void 0},100))}),this.destroy$.subscribe(function(){void 0!==P&&(clearTimeout(P),P=void 0),void 0!==h&&(clearTimeout(h),h=void 0)});var E=this.eventBridge.on(Ke.CCe),L=this.eventBridge.on(Ke.$$f);(0,Jt.T)(E,L).pipe((0,er.R)(this.destroy$)).pipe((0,Lr.M)(e)).subscribe(function(A){var R=A[1];r(),a(R)})},n.prototype.initPauseHandlers=function(e){var t=this,r=e.pipe((0,me.U)(function(o){return o.reduce(function(s,l){return s.push(l.name),s},[])})),i=this.eventBridge.on(Ke.KD7).pipe((0,er.R)(this.destroy$)),a=this.eventBridge.on(Ke.D1A).pipe((0,er.R)(this.destroy$));i.pipe((0,Lr.M)(r)).subscribe(function(o){var l=o[1],c=o[0].changedItems.filter(function(v){return!(0,sr.LR)(t.visualPluginService,t.visualPluginOperationsService,v)}).map(function(v){return v.name}),d=_.intersection(l,c);_.isEmpty(d)||t.pauseUpdatesForVisualContainers(d)}),a.subscribe(function(o){t.pauseUpdatesPromise&&t.resumeUpdateForVisualContainers([o.name])}),r.subscribe(function(o){var s=new Set(o);if(Array.from(t.formattingStores.keys()).forEach(function(f){if(!s.has(f)&&f!==Hi){var m=t.formattingStores.get(f);t.formattingStores.delete(f),m.ngOnDestroy()}}),t.pauseUpdatesPromise){for(var c=[],d=0,v=Array.from(t.pausedContainerNames.values());d<v.length;d++){var h=v[d];s.has(h)||c.push(h)}t.resumeUpdateForVisualContainers(c)}})},n.prototype.pauseUpdatesForVisualContainers=function(e){var t=this,r=this.pausedContainerNames=this.pausedContainerNames||new Set;e.forEach(function(i){return r.add(i)}),this.pauseUpdatesPromise||(this.pauseUpdatesPromise=new Promise(function(i){return t.pauseUpdatesResolver=i}))},n.prototype.resumeUpdateForVisualContainers=function(e){var t=this.pausedContainerNames;b.fF.assertValue(t,"pausedContainers"),e.forEach(function(r){return t.delete(r)}),0===t.size&&(this.pauseUpdatesResolver(),this.pauseUpdatesResolver=void 0,this.pauseUpdatesPromise=void 0,this.pausedContainerNames=void 0)},n.prototype.getViewModelIntl=function(e){return this.getStore$(e).pipe((0,at.w)(function(t){return t.getViewModel$()}))},n.prototype.selectAllCardsIntl=function(e){return this.getStore$(e).pipe((0,at.w)(function(t){return t.selectAllCards()}))},n.prototype.selectTopLevelToggleIntl=function(e,t,r){return this.getStore$(r).pipe((0,at.w)(function(i){return i.selectTopLevelToggle(e,t)}))},n.prototype.selectGroupIntl=function(e,t){return this.getStore$(t).pipe((0,at.w)(function(r){return r.selectGroup(e).pipe((0,me.U)(function(i){return Wi(i)}))}))},n.prototype.selectSliceIntl=function(e,t,r){return this.getStore$(r).pipe((0,at.w)(function(i){return i.selectSlice(e,t).pipe((0,me.U)(function(a){return Wi(a)}))}))},n.prototype.selectCardIntl=function(e,t){return this.getStore$(t).pipe((0,at.w)(function(r){return r.selectCard(e).pipe((0,me.U)(function(i){return Wi(i)}))}))},n.prototype.getChartElementsContractIntl=function(e){return this.getStore$(e).pipe((0,at.w)(function(t){return t.getChartElementsContract$()}))},n.prototype.getCardTopLevelToggleUidsIntl=function(e){return this.getStore$(e).pipe((0,at.w)(function(t){return t.getCardTopLevelToggleUids$()}))},n.prototype.getSubSelectablesIntl=function(e){var t=this;return e.pipe((0,at.w)(function(r){if(1===r.type)return gs.E;var i=r.canvasItem,a=(0,Jt.T)(t.eventBridge.on(Ke.D1A),t.eventBridge.on(Ke.DSN)).pipe((0,kt.h)(function(u){return u.name===i.name})),o=t.eventBridge.on(Ke.KD7).pipe((0,kt.h)(function(u){return _.some(u.changedItems,function(c){return c.name===i.name})})),s=t.eventBridge.on(Ke.jCS).pipe((0,kt.h)(function(u){return(0,J.Vz)(i)&&u.affectContainer(i)}));return(0,Jt.T)(o,a,s).pipe((0,mn.O)({}),(0,Ss.h)({})).pipe((0,at.w)(function(u){return(0,J.Vz)(i)?t.runningVisual.getVisual$(i).pipe((0,at.w)(function(d){return d?(0,cr.D)(d.getSubSelectables()):[]})):[]}))}),(0,qr.d)({bufferSize:1,refCount:!0}))},n.prototype.getFor=function(e){var t=this,r=(0,Gi.b)(e)?e:(0,_t.of)(e);return{getCardTopLevelToggleUids$:function(){return t.getCardTopLevelToggleUidsIntl(r)},getChartElementsContract$:function(){return t.getChartElementsContractIntl(r)},getViewModel$:function(){return t.getViewModelIntl(r)},selectAllCards:function(){return t.selectAllCardsIntl(r)},selectCard:function(a){return t.selectCardIntl(a,r)},selectGroup:function(a){return t.selectGroupIntl(a,r)},selectSlice:function(a){var o=ce.zh(a);return t.selectSliceIntl(o,void 0,r)},selectTopLevelToggle:function(a){var o=ce.zh(a);return t.selectTopLevelToggleIntl(o,void 0,r)},getSubSelectables$:function(){return t.getSubSelectablesIntl(r)}}},n.prototype.getRevertToDefaultMetadata=function(e,t){return this.formattingModelService.getRevertToDefaultMetadata(e,t)},n.prototype.changeContainerDropdownValue=function(e,t){this.formattingModelService.changeContainerDropdownValue(e,t)},n.prototype.getFormattingStoreForCanvasItem=function(e){var t;return this.formattingStores.has(t=1===e.type?Hi:e.canvasItem.name)||this.formattingStores.set(t,this.formattingStoreFactory.create()),this.formattingStores.get(t)},n.prototype.getStore$=function(e){var t=this;return e.pipe((0,me.U)(function(r){return t.getFormattingStoreForCanvasItem(r)}))},n.prototype.updateStateInt=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u,c,d;return(0,p.__generator)(this,function(h){switch(h.label){case 0:return _.isEmpty(e)?[2]:(i=1===e.length&&"Page"===e[0]?Hi:t.name,a=this.updateCounter++,this.currentUpdateIds.set(i,a),this.pauseUpdatesPromise?[4,this.pauseUpdatesPromise]:[3,2]);case 1:if(h.sent(),this.currentUpdateIds.get(i)!==a)return[2];h.label=2;case 2:o={cards:{},groups:{},slices:{},revertToDefaultDescriptors:[],canvasItem:t?new wr.lD(t,function(f){return f===t||f&&t&&t.name===f.name}):void 0},s=this.featureSwitchService.featureSwitches.onObject,l=function(m){var g,y,w,V,q,F,N,T,P,O,E,B;return(0,p.__generator)(this,function(A){switch(A.label){case 0:return b.fF.assert(function(){return!s||"Analytics"!==m},"Should not be asking for Analytics with OnObject (it is part of Visuals)"),g=function(R,G){for(var ne={},oe=0,ee=Object.keys(R);oe<ee.length;oe++){var le=ee[oe];ne[le]=xs(R[le],G)}return ne},[4,u.formattingModelService.getFormattingOptions(t,m)];case 1:for(B=A.sent(),y=B.cards,w=B.groups,V=B.slices,q=B.revertToDefaultDescriptors,u.featureSwitchService.featureSwitches.interactiveMobileCanvas&&(null===(r=u.sliceCustomizationService)||void 0===r||r.customizeSliceOptions(V)),F=g(y,1),N=g(w,1),T=g(V,1),P=0,O=Object.keys(F);P<O.length;P++)F[E=O[P]]=(0,p.__assign)((0,p.__assign)({},y[E]),{deferredStatus:1});return b.fF.assert(function(){return _.isEmpty(_.intersection(_.keys(o.cards),_.keys(F)))},"Expected no cards to have duplicate uids"),b.fF.assert(function(){return _.isEmpty(_.intersection(_.keys(o.groups),_.keys(N)))},"Expected no groups to have duplicate uids"),o.cards=(0,p.__assign)((0,p.__assign)({},o.cards),F),o.groups=(0,p.__assign)((0,p.__assign)({},o.groups),N),o.slices=(0,p.__assign)((0,p.__assign)({},o.slices),T),o.revertToDefaultDescriptors=(0,p.__spreadArray)((0,p.__spreadArray)([],o.revertToDefaultDescriptors,!0),q,!0),[2]}})},u=this,c=0,d=e,h.label=3;case 3:return c<d.length?[5,l(d[c])]:[3,6];case 4:h.sent(),h.label=5;case 5:return c++,[3,3];case 6:return this.currentUpdateIds.get(i)!==a||(this.updateFormattingContract(o,t),this.currentUpdateIds.delete(i)),[2]}})})},n.prototype.getVisualUpdateSources=function(){var e=["Format_Label_General","Visual"];return this.featureSwitchService.featureSwitches.onObject||e.push("Analytics"),e},n.prototype.getNonVisualUpdateSources=function(){return["Page"]},n.prototype.updateFormattingContract=function(e,t){var r=this.getFormattingOptions(t);this.getFormattingStoreForCanvasItem(r).setState(e)},n.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},n.prototype.saveValues=function(e,t){var r;return(0,p.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,l,u;return(0,p.__generator)(this,function(d){switch(d.label){case 0:i=e.changes.some(function(v){return"Page"===v.formattingSource}),a=[],o=function(h){var f,m;return(0,p.__generator)(this,function(g){switch(g.label){case 0:return h.conditionalFormatting?(b.fF.assert(function(){return!h.canvasItems||1===h.canvasItems.length},"Conditional formatting is only supported for single canvas item or page formatting"),f=s.getFormattingOptions(null===(r=h.canvasItems)||void 0===r?void 0:r[0]),[4,s.getFor(f).selectSlice({objectName:h.objectName,propertyName:h.propertySlice.name,selector:h.propertySlice.selector}).pipe((0,Ui.q)(1)).toPromise()]):[3,2];case 1:if((m=g.sent())&&m.saveCallback)return m.saveCallback(e),[2,"continue"];g.label=2;case 2:return a.push(h),[2]}})},s=this,l=0,u=e.changes,d.label=1;case 1:return l<u.length?[5,o(u[l])]:[3,4];case 2:d.sent(),d.label=3;case 3:return l++,[3,1];case 4:return _.isEmpty(a)?[2]:(e.changes=a,[4,this.formattingModelService.saveFormattingSlicesValue(e.changes,t)]);case 5:return d.sent(),i&&this.updateStateInt(["Page"],void 0),[2]}})})},n.prototype.isEditableContainerWithSelectionChangeOnly=function(e){return this.formattingModelService.isEditableContainerWithSelectionChangeOnly(e.changes)},n.prototype.revertToDefault=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){return(0,p.__generator)(this,function(i){return[2,this.formattingModelService.revertToDefault(e,t,r)]})})},n.prototype.getRevertToDefaultEnabled=function(e,t,r){return this.formattingModelService.getRevertToDefaultEnabled(e,t,r)},n.prototype.getModelUnavailableInformation=function(e,t){return this.formattingModelService.getModelUnavailableInformation(e,t)},n.prototype.getFormattingModelMessage=function(e,t){return this.formattingModelService.getFormattingModelMessage(e,t)},n.prototype.startFormattingTutorial=function(e,t){this.explorationCapabilities.getCapabilities().disableFormattingTutorial||this.formattingTutorialService.startFormattingTutorial(e,t)},n.prototype.getFormattingOptions=function(e){return e?{type:0,canvasItem:e}:{type:1}},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(wr.Kj,8),D.\u0275\u0275inject(on.J),D.\u0275\u0275inject(Yt.z),D.\u0275\u0275inject(Ei.U),D.\u0275\u0275inject(lt.vZ),D.\u0275\u0275inject(fn),D.\u0275\u0275inject(gn),D.\u0275\u0275inject(yn),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Ir.z),D.\u0275\u0275inject(ri.f),D.\u0275\u0275inject(qt.D))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),As={provide:"formattingService",useFactory:function(n){return Promise.resolve(n)},deps:[Ki]},ct=C(59017),ht=C(64560),zs=C(5838),Os=C(44104),Ms=C(19650),pr=C(92755);function Sn(n){return n.flatMap(function(e){return function(n){var e=[];switch(n.type){case 8:e.push.apply(e,Sn(n.shortcuts));break;case 0:n.relatedResetFormattingIds&&e.push.apply(e,n.relatedResetFormattingIds);break;case 2:n.relatedToggledFormattingIds&&e.push.apply(e,n.relatedToggledFormattingIds);case 3:case 6:e.push(n);break;case 9:e.push.apply(e,n.referencesAndValues);break;case 4:case 1:case 5:case 7:case 10:break;default:b.fF.assertNever(n)}return e}(e)})}var Es=C(86940),_n=function(){function n(e,t,r,i,a,o,s){this.formattingService=e,this.injector=t,this.itemPickerService=r,this.localizationService=i,this.overlay=a,this.runningVisual=o,this.selectionService=s,this.destroy$=new ai.xQ}return n.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},n.prototype.openColorPicker=function(e,t,r,i){var a=this;if(e){var o=e&&e.properties,s=o&&o.conditionalFormattingObjects,l=e.resolvedValue;return(0,Os.Z)({itemPickerService:this.itemPickerService,localizationService:this.localizationService,overlay:this.overlay,injector:this.injector,connectedTo:t,isNoFillItemSupported:!1,backDropClass:"invisible-backdrop",conditionalFormattingOptions:!!s&&{showDialog:function(){(0,cr.D)(s.showDialog()).subscribe(function(h){h&&h.shouldSave&&a.saveChanges([h.value],e.instances,i)})},isSet:s.isSet},setColor:function(h){if(h&&(h.value!==l?.value||s?.isSet)){var f=[];s?.isSet&&f.push(null),f.push(h),a.saveChanges(f,e.instances,i)}},closed:r,color:l,defaultColor:void 0,overlayHeight:s?400:362,overlayWidth:310})}},n.prototype.onControlClicked=function(e,t,r){var i=t.key;switch(i){case"horizontalAlignment":var a=e.horizontalAlignment;if(!a)return;var o=this.getAlignmentSaveValue(t.value,a.instances);return this.saveChanges([o],a.instances,r);case"increaseFontSize":return this.adjustFontSize(1,e,r);case"decreaseFontSize":return this.adjustFontSize(-1,e,r);case"decreaseDecimal":return this.adjustDecimal(-1,e,r);case"increaseDecimal":return this.adjustDecimal(1,e,r);case"background":case"fill":case"fontColor":case"stroke":case"border":case"grid":b.fF.assertFail("".concat(i," should not be handled here"));break;case"height":case"width":case"displayUnits":case"wordWrap":case"bold":case"italic":case"fontSize":case"underline":case"fontFamily":return(s=e[i])?this.saveChanges([t.value],s.instances,r):void 0;case"shadow":var s;return(s=e[i])?this.saveShadowChanges(t.value,e,r):void 0;default:b.fF.assertNever(i)}},n.prototype.adjustDecimal=function(e,t,r){var i=t.precision,a=i&&i.properties;if(a){var o=_.compact(_.map(i.instances,function(s){var l;if(!s.disabled||s.overrideDisabled){var u=_.isNumber(i.resolvedValue)?i.resolvedValue:null!==(l=a.defaultPrecision)&&void 0!==l?l:0,c=Math.max(0,u+=e);return(0,pr.ks)(c,s.descriptor,s.uid,s.formattingSource,[s.canvasItem],1)}}));if(!_.isEmpty(o))return this.formattingService.saveValues({changes:o},r)}},n.prototype.adjustFontSize=function(e,t,r){var i,a,o,s,l=t.fontSize,u=l&&l.properties;if(u){var c=null==(null===(a=null===(i=u.options)||void 0===i?void 0:i.minValue)||void 0===a?void 0:a.value)?wr.r4:u.options.minValue.value,d=null==(null===(s=null===(o=u.options)||void 0===o?void 0:o.maxValue)||void 0===s?void 0:s.value)?wr.YR:u.options.maxValue.value,v=_.map(l.instances,function(h){if(!h.disabled||h.overrideDisabled){var f=h.currentValue,m=Math.min(Math.max(f+e,c),d);if(m!==f)return(0,pr.ks)(m,h.descriptor,h.uid,h.formattingSource,[h.canvasItem],1)}});if(v=_.compact(v),!_.isEmpty(v))return this.formattingService.saveValues({changes:v},r)}},n.prototype.saveChanges=function(e,t,r){return(0,p.__awaiter)(this,void 0,void 0,function(){var i;return(0,p.__generator)(this,function(a){return i=_.flatten(_.map(e,function(o){return _.compact(_.map(t,function(s){return s.disabled&&!s.overrideDisabled?void 0:(0,pr.ks)(o,s.descriptor,s.uid,s.formattingSource,[s.canvasItem],1)}))})),_.isEmpty(i)?[2]:[2,this.formattingService.saveValues({changes:i},r)]})})},n.prototype.getAlignmentSaveValue=function(e,t){var r=t[0].descriptor.type;if(b.fF.assert(function(){return _.every(t,function(a){return a.descriptor.type===r})},"MiniToolbar alignment - expected all the descriptors to have same property type"),St.Ge.isValueTypeDescriptor(r)){var i=St.Ge.fromDescriptor(r);if(i.enum===Ms.K)return wr.y5[e];if(i.formatting.alignment)return e;b.fF.assertFail("MiniToolbar alignment - unexpected descriptor property type")}else b.fF.assertFail("MiniToolbar alignment - not a value type descriptor")},n.prototype.saveShadowChanges=function(e,t,r){var s=t.shadowPreset.instances,l=t.shadowPosition.instances,u=t.shadow.instances;b.fF.assert(function(){return s.length===l.length&&s.length===u.length},"shadow - expected all the instances to have same length");for(var c=[],d=function(f){if(u[f].disabled)return"continue";var m=u[f],g=s[f],y=l[f],w=e.shadowPreset,V=e.shadowPosition,q=e.shadow,F=g.descriptor,N=y.descriptor,T=m.descriptor,P=g.uid,O=y.uid,E=m.uid,L=g.formattingSource,B=y.formattingSource,A=m.formattingSource,z=m.canvasItem;b.fF.assert(function(){return z===g.canvasItem&&z===y.canvasItem},"shadow - expected all the instances to have same canvasItem");var R=(0,pr.ks)(w,F,P,L,[z],1),G=(0,pr.ks)(V,N,O,B,[z],1),ne=(0,pr.ks)(q,T,E,A,[z],1);c.push(ne,G,R)},v=0;v<u.length;v++)d(v);if(!_.isEmpty(c))return this.formattingService.saveValues({changes:c},r)},n.prototype.getSubSelectionStyleShortcutsForNonCanvasItems$=function(e){return this.getMenuItems$(e,void 0,void 0,void 0).pipe((0,me.U)(function(r){return{items:_.flatten(r)}}))},n.prototype.getSubSelectionStyleShortcutsForCanvasItems$=function(e){var t=this;return((0,Gi.b)(e)?e:(0,_t.of)(e)).pipe((0,at.w)(function(i){var a,o=(a=(0,J.rQ)(i))[0],s=a[1];if(_.isEmpty(o)||!_.isEmpty(s))return(0,_t.of)({items:[]});var l=_.map(o,function(u){var c=t.runningVisual.getVisual$(u),v=t.getActiveSubSelectables$(t.formattingService.getFor({type:0,canvasItem:u}),u);return(0,ct.aj)([c,v]).pipe((0,at.w)(function(h){var f=h[0],m=h[1],g=(0,ct.aj)(_.compact(_.map(m,function(w){return f&&(0,cr.D)(f.getSubSelectionStyles([w]))}))),y=(0,ct.aj)(_.compact(_.map(m,function(w){return f&&(0,cr.D)(f.getSubSelectionShortcuts([w],void 0))})));return(0,ct.aj)([g,y]).pipe((0,me.U)(function(w){var q=w[1];return{canvasItem:u,visual:f,subSelectionStyles:_.compact(w[0]),subSelectionShortcuts:_.compact(_.flatten(q))}}))}))});return(0,ct.aj)(l).pipe((0,at.w)(function(u){var c=_.map(u,function(d){return t.getMenuItems$(d.subSelectionShortcuts,d.canvasItem,d.subSelectionStyles,d.visual)});return(0,ct.aj)(c).pipe((0,me.U)(function(d){return{items:_.flatten(d)}}))}))}),(0,qr.d)({bufferSize:1,refCount:!0}))},n.prototype.getSubSelectionStylesSlices$=function(e){var t=(0,Gi.b)(e)?e:(0,_t.of)(e);return this.getSubSelectionStylesForMultipleVisuals$(t)},n.prototype.getSubSelectionStylesForMultipleVisuals$=function(e){var t=this;return e.pipe((0,at.w)(function(r){var i,a=(i=(0,J.rQ)(r))[0],o=i[1];if(_.isEmpty(a)||!_.isEmpty(o))return(0,_t.of)({});if(1===a.length)return t.getVisualSubSelectionStylesSlicesForSingleVisual$(a[0]);var s=_.map(a,function(l){return{canvasItem:l,subSelectionStyles$:t.getVisualAreaSubSelectionStyles$(l)}});return t.getSubSelectionSlicesFromStyles$(s)}),(0,qr.d)({bufferSize:1,refCount:!0}),(0,Gt.x)(function(r,i){return _.isEqual(r,i)}))},n.prototype.getActiveSubSelectables$=function(e,t){var r=e.getSubSelectables$().pipe((0,me.U)(function(o){return o.find(function(s){return(0,ce.so)(s)})})),i=this.selectionService.getSubSelections$(t).pipe((0,me.U)(function(o){return _.map(o,function(s){return s.visualSubSelection})}));return(0,ct.aj)([r,i]).pipe((0,me.U)(function(o){var s=o[0],l=o[1];return _.isEmpty(l)?s?[s]:[]:l}))},n.prototype.getVisualSubSelectionStylesSlicesForSingleVisual$=function(e){var t=this,i=this.getActiveSubSelectables$(this.formattingService.getFor({type:0,canvasItem:e}),e),a=this.runningVisual.getVisual$(e),o=(0,ct.aj)([i,a]).pipe((0,at.w)(function(s){var l=s[0],u=s[1];if(!u)return(0,_t.of)([]);var c=_.map(l,function(d){return(0,ce.so)(d)?t.getVisualAreaSubSelectionStyles$(e):(0,cr.D)(u.getSubSelectionStyles([d]))});return(0,ct.aj)(c).pipe((0,me.U)(function(d){return _.compact(_.flatten(d))}))}));return this.getSubSelectionSlicesFromStyles$([{subSelectionStyles$:o,canvasItem:e}])},n.prototype.getVisualAreaSubSelectionStyles$=function(e){var t=this.runningVisual.getVisual$(e),i=this.formattingService.getFor({type:0,canvasItem:e}).getSubSelectables$();return(0,ct.aj)([i,t]).pipe((0,at.w)(function(a){var o=a[0],s=a[1];if(!s)return(0,_t.of)([]);var l=_.map(o,function(u){return(0,cr.D)(s.getSubSelectionStyles([u])).pipe((0,me.U)(function(c){if(c){if((0,ce.so)(u))return c;if(1===c.type||2===c.type)return{fontColor:"fontColor"in c?c.fontColor:void 0,fontFamily:"fontFamily"in c?c.fontFamily:void 0,fontSize:"fontSize"in c?c.fontSize:void 0,bold:"bold"in c?c.bold:void 0,italic:"italic"in c?c.italic:void 0,underline:"underline"in c?c.underline:void 0,type:c.type}}}))});return(0,ct.aj)(l).pipe((0,me.U)(function(u){return _.compact(u)}))}))},n.prototype.getSubSelectionSlicesFromStyles$=function(e){var t=this,r=_.map(e,function(i){var a=i.canvasItem;return i.subSelectionStyles$.pipe((0,me.U)(function(s){return _.map(s,function(l){return{subSelectionStyle:l,canvasItem:a}})}))});return(0,ct.aj)(r).pipe((0,at.w)(function(i){for(var a=(0,_t.of)({}),s=function(f,m){a=a.pipe((0,at.w)(function(g){return t.getBoundSubSelectionStylesSlices$(f,g,m)}))},l=0,u=_.flatten(i);l<u.length;l++){var c=u[l];s(c.subSelectionStyle,c.canvasItem)}return a}))},n.prototype.getBoundSubSelectionStylesSlices$=function(e,t,r){var i=this,a={type:0,canvasItem:r},o=e??{},s=_.map(Object.keys(o),function(l){var u=o[l];if("type"!==l&&u&&(0,ce.N6)(u)){var c=u.reference;return c?i.mergeSliceAndTopLevelToggle(i.formattingService.getFor(a),c).pipe((0,me.U)(function(d){if(d)return i.getSubSelectionStylesSlices(d,u,l,t,r)})):(0,_t.of)(void 0)}return(0,_t.of)(void 0)});return(0,ct.aj)(s).pipe((0,me.U)(function(l){return l.reduce(function(u,c){return c&&(u=(0,p.__assign)((0,p.__assign)({},u),c)),u},t)}),(0,qr.d)({bufferSize:1,refCount:!0}))},n.prototype.getSubSelectionStylesSlices=function(e,t,r,i,a){var o,s,l,u,c,d,v,h={};switch(r){case"background":case"color":case"fill":case"fontColor":case"stroke":var f=!0,m=this.resolveBaseProperties(e,t,null===(o=i[r])||void 0===o?void 0:o.properties,f);h[r]=this.getStylesForColorPicker(e,m,i[r],a,f);break;case"horizontalAlignment":m=this.resolveBaseProperties(e,t,null===(s=i[r])||void 0===s?void 0:s.properties),h[r]=this.getStylesForAlignmentGroup(e,m,i[r],a);break;case"fontSize":case"height":case"width":case"precision":m=this.resolveBaseProperties(e,t,null===(l=i[r])||void 0===l?void 0:l.properties),h[r]=this.getStylesForNumUpDown(e,m,t,i[r],a);break;case"fontFamily":m=this.resolveBaseProperties(e,t,null===(u=i[r])||void 0===u?void 0:u.properties),h[r]=this.getStylesForFontFamily(e,m,i,a);break;case"shadowPreset":case"shadowPosition":case"style":case"displayUnits":m=this.resolveBaseProperties(e,t,null===(c=i[r])||void 0===c?void 0:c.properties),h[r]=this.getStylesForDropdown(e,m,i[r],a);break;case"bold":case"italic":case"underline":case"shadow":case"grid":case"wordWrap":m=this.resolveBaseProperties(e,t,null===(d=i[r])||void 0===d?void 0:d.properties),h[r]=this.getStylesForToggleSwitch(e,m,i[r],a);break;case"border":m=this.resolveBaseProperties(e,t,null===(v=i[r])||void 0===v?void 0:v.properties),h[r]=this.getStylesForFlagsSelection(e,m,i[r],a);break;default:b.fF.assertNever(r)}return h},n.prototype.getIdentifierForSlice=function(e,t,r,i,a){return{currentValue:t,descriptor:r,formattingSource:e.originSource,uid:e.uid,canvasItem:i,disabled:e.disabled,overrideDisabled:a}},n.prototype.resolveBaseProperties=function(e,t,r,i){return void 0===i&&(i=!1),{disabled:e.disabled&&(!r||r.disabled)&&!i,label:t.label}},n.prototype.getStylesForColorPicker=function(e,t,r,i,a){var o=e.control;if("ColorPicker"!==o.type||(0,S.IW)(e)||ce.Ky(e))return b.fF.assertFail("Expected a ColorPicker type to get color properties."),r;var s=this.resolveInstances(this.getIdentifierForSlice(e,o.properties.value,e.control.properties.descriptor,i,a),r?.instances),l=this.resolveValue(o.properties.value,r?.resolvedValue);return{instances:s,properties:(0,p.__assign)((0,p.__assign)({},t),{conditionalFormattingObjects:r?void 0:e.conditionalFormattingObjects}),resolvedValue:l}},n.prototype.getStylesForNumUpDown=function(e,t,r,i,a){var o=e.control;if("NumUpDown"===o.type&&!(0,S.IW)(e)){var s=this.resolveInstances(this.getIdentifierForSlice(e,o.properties.value,e.control.properties.descriptor,a),i?.instances),l=this.resolveValue(o.properties.value,i?.resolvedValue);return{instances:s,properties:(0,p.__assign)((0,p.__assign)({},t),{options:o.properties.options,defaultPrecision:r.defaultPrecision}),resolvedValue:l}}b.fF.assertFail("Expected a NumUpDown type to get spin button properties")},n.prototype.getStylesForAlignmentGroup=function(e,t,r,i){var a=e.control;if("AlignmentGroup"!==a.type||(0,S.IW)(e))return b.fF.assertFail("Expected a AlignmentGroup type to get alignment properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=r?r.resolvedValue===a.properties.value?a.properties.value:void 0:a.properties.value;return{instances:o,properties:(0,p.__assign)({},t),resolvedValue:s}},n.prototype.getStylesForDropdown=function(e,t,r,i){var a=e.control;if("Dropdown"!==a.type||(0,S.IW)(e)||!(0,Ve.WN)(a.properties))return b.fF.assertFail("Expected a Dropdown type to get Dropdown properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(a.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.__assign)((0,p.__assign)({},t),{items:a.properties.items}),resolvedValue:s}},n.prototype.getStylesForFlagsSelection=function(e,t,r,i){var a=e.control;if("FlagsSelection"!==a.type||(0,S.IW)(e))return b.fF.assertFail("Expected a FlagsSelection type to get FlagsSelection properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(a.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.__assign)({},t),resolvedValue:s}},n.prototype.getStylesForToggleSwitch=function(e,t,r,i){var a=e.control;if("ToggleSwitch"!==a.type||(0,S.IW)(e))return b.fF.assertFail("Expected a ToggleSwitch type to get toggle button properties"),r;var o=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),r?.instances),s=this.resolveValue(a.properties.value,r?.resolvedValue);return{instances:o,properties:(0,p.__assign)({},t),resolvedValue:s}},n.prototype.getStylesForFontFamily=function(e,t,r,i){var a=e.control;if("FontPicker"!==a.type||(0,S.IW)(e))return b.fF.assertFail("Expected a FontPicker type to get Font Family properties"),r.fontFamily;var o=r.fontFamily,s=this.resolveInstances(this.getIdentifierForSlice(e,a.properties.value,e.control.properties.descriptor,i),o?.instances),l=this.resolveValue(a.properties.value,o?.resolvedValue);return{instances:s,properties:(0,p.__assign)({},t),resolvedValue:l}},n.prototype.resolveValue=function(e,t){return void 0!==t?_.isEqual(t,e)?e:null:e},n.prototype.resolveInstances=function(e,t){return t?(0,p.__spreadArray)((0,p.__spreadArray)([],t,!0),[e],!1):[e]},n.prototype.mergeSliceAndTopLevelToggle=function(e,t){var r=e.selectSlice(t),i=e.selectTopLevelToggle(t).pipe((0,kt.h)(function(a){return!!a}));return(0,Jt.T)(r,i)},n.prototype.getMenuItems$=function(e,t,r,i){for(var a=this.formattingService.getFor(t?{type:0,canvasItem:t}:{type:1}),o=[],s=!1,l=0,u=e??[];l<u.length;l++){var c=u[l];if(!c.suppressOnUI){var d=void 0;switch(c.type){case 0:case 10:d=this.getResetShortcut$(c,e.some(function(v){return 4===v.type}),t,e,r,a);break;case 1:d=this.getNavigateShortcut$(c,t,a);break;case 2:d=this.getToggleShortcut$(c,t,a);break;case 3:d=this.getPickerShortcut$(c,t,a);break;case 5:d=this.getCustomActionShortcut$(c,t);break;case 4:s||(s=!0,d=this.getSortShortcut$(c,t,e,i));break;case 6:d=this.getConditionalFormattingShortcut$(c,t,a);break;case 7:d=this.getDivider$();break;case 8:d=this.getSubMenuShortcut$(c,t,a);break;case 9:d=this.getSetValueShortcut$(c,t)}d&&o.push(d)}}return(0,ct.aj)(o).pipe((0,me.U)(function(v){return _.flatten(v).filter(function(h){return!!h})}),(0,Gt.x)(function(v,h){return _.isEqual(v,h)}))},n.prototype.getResetShortcut$=function(e,t,r,i,a,o){var d,s=this,l=this.isResetSortDisabled(t,r),c=Sn(i);return a&&_.forEach(a,function(v){c.push.apply(c,function(n){var e=[];switch(n.type){case 2:n.displayUnits&&e.push(n.displayUnits.reference),n.precision&&e.push(n.precision.reference);case 1:n.background&&e.push(n.background.reference),n.horizontalAlignment&&e.push(n.horizontalAlignment.reference),n.wordWrap&&e.push(n.wordWrap.reference),"fontSize"in n&&n.fontSize&&e.push(n.fontSize.reference),"fontFamily"in n&&n.fontFamily&&e.push(n.fontFamily.reference),"bold"in n&&n.bold&&e.push(n.bold.reference),"italic"in n&&n.italic&&e.push(n.italic.reference),"underline"in n&&n.underline&&e.push(n.underline.reference),e.push(n.fontColor.reference);break;case 3:n.color&&e.push(n.color.reference),n.fill&&e.push(n.fill.reference),n.stroke&&e.push(n.stroke.reference),n.style&&e.push(n.style.reference),n.width&&e.push(n.width.reference);break;default:b.fF.assertNever(n)}return e}(v))}),(d=0===e.type?pr.cY(o,c,e.excludedResetFormattingIds):o.getViewModel$().pipe((0,me.U)(function(v){return v.revertToDefaultDescriptors}))).pipe((0,me.U)(function(v){return s.formattingService.getRevertToDefaultEnabled(r,v)})).pipe((0,Lr.M)(d),(0,me.U)(function(v){var h=v[0];return{type:ht.iB.Button,data:{type:0,revertToDefaultDescriptors:v[1],canvasItem:r},text:s.localizationService.get("Reset_To_Default"),disabled:!h&&l,icon:{type:0,glyph:"glyphicon pbi-glyph-reset"}}}))},n.prototype.isResetSortDisabled=function(e,t){var r=!0;if(e){var i=t.config.singleVisual,a=i.query;if(a){var o=a.defn.orderBy(),s=(0,Q.II)(t),l=i.hasDefaultSort;r=s&&void 0===l||l||_.isEmpty(o)}}return r},n.prototype.getNavigateShortcut$=function(e,t,r){return r.selectAllCards().pipe((0,me.U)(function(a){return _.isEmpty(a)})).pipe((0,me.U)(function(a){return{type:ht.iB.Button,data:{type:1,shortcut:e,canvasItem:t},text:e.label,disabled:a,icon:{type:2,name:zs.z.ChartStylesGallery_20}}}))},n.prototype.getToggleSwitch$=function(e,t){return this.mergeSliceAndTopLevelToggle(t,e).pipe((0,me.U)(function(r){return r?.control.properties}))},n.prototype.getToggleShortcut$=function(e,t,r){var i=this,a=e.relatedToggledFormattingIds,o=e.selector,s=this.getToggleSwitch$(e,r),l=(0,ct.aj)((0,p.__spreadArray)([s],(a??[]).map(function(u){return i.getToggleSwitch$(u,r)}),!0)).pipe((0,me.U)(function(u){return u.every(function(c){return c?.value})}));return(0,ct.aj)([s,l]).pipe((0,me.U)(function(u){var d=u[1];if(u[0]){var v=d?e.disabledLabel:e.enabledLabel;if(v){var h=a?a.map(function(g){return(0,p.__assign)((0,p.__assign)({},g),{nextValue:!d,selector:g.selector})}):[],m=(0,p.__assign)((0,p.__assign)({type:2,nextValue:!d},{objectName:e.objectName,propertyName:e.propertyName}),{selector:o,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"},relatedToggledFormattingIds:h});return{type:ht.iB.Button,data:{type:2,shortcut:m,canvasItem:t},text:v}}}}))},n.prototype.getConditionalFormattingShortcut$=function(e,t,r){var i=e.objectName,a=e.propertyName,o=e.selector,s=e.label;return r.selectSlice(e).pipe((0,me.U)(function(u){if(u)return{type:ht.iB.Button,data:{type:6,shortcut:{type:6,nextValue:!u.control.properties.value,objectName:i,propertyName:a,selector:o,telemetrySource:{source:"ContextMenu",contextMenuType:"Visual"}},canvasItem:t},text:s}}))},n.prototype.getPickerShortcut$=function(e,t,r){var i=this;return r.selectSlice(e).pipe((0,me.U)(function(o){return o&&o.control.properties})).pipe((0,me.U)(function(o){if(o&&!_.isEmpty(o.items))return{type:ht.iB.SubMenu,text:e.label,menu:{items:_.map(o.items,function(l,u){return function(u,c){return{type:ht.iB.Button,data:{type:3,shortcut:e,index:c,canvasItem:t},text:(0,Ne.G)(u.displayName,i.localizationService),checkable:!0,checked:_.isEqual(u,o.value)}}(l,u)})}}}))},n.prototype.getSubMenuShortcut$=function(e,t,r){var i=this,o=_.map(e.shortcuts,function(s){return function(l){switch(l.type){case 1:return i.getNavigateShortcut$(l,t,r);case 2:return i.getToggleShortcut$(l,t,r).pipe((0,me.U)(function(d){var v;if(d)return(0,p.__assign)((0,p.__assign)({},d),{checkable:!0,checked:d.data&&!(null!==(v=d.data)&&void 0!==v&&v.shortcut.nextValue)})}));case 6:return i.getConditionalFormattingShortcut$(l,t,r).pipe((0,me.U)(function(d){var v;if(d)return(0,p.__assign)((0,p.__assign)({},d),{checkable:!0,checked:d.data&&!(null!==(v=d.data)&&void 0!==v&&v.shortcut.nextValue)})}));case 7:return i.getDivider$()}}(s)});return(0,ct.aj)(o).pipe((0,me.U)(function(s){return{type:ht.iB.SubMenu,text:e.label,menu:{items:s.filter(function(l){return!!l})}}}))},n.prototype.getSortShortcut$=function(e,t,r,i){var o,s,a=this;return(!_.isEmpty(r)&&i?.sortServices?(0,cr.D)(i.sortServices.getSortableGroups()):(0,_t.of)([])).pipe((0,me.U)(function(c){var d=c.find(function(F){return F.key===e.key}),v=[];if(d){(s=d.fields.find(function(F){return F.active}))&&(o=d);for(var h=0,f=d.fields;h<f.length;h++){var m=f[h];v.push({type:ht.iB.Button,data:{type:4,sortGroup:d,sortField:m,sortDirection:s&&s.sortDirection?s.sortDirection:m.sortDirection?m.sortDirection:2,isSortField:!0,canvasItem:t},text:a.localizationService.format("Sort_SortBy",m.displayName),checkable:!0,checked:m.active})}}if(!_.isEmpty(v)){var g=v.length>1&&!s,y=void 0,w=void 0;if(1!==v.length||s)y=o,w=s;else{var V=v[0].data;y=V.sortGroup,w=V.sortField}var q=[{type:ht.iB.Button,data:{type:4,sortGroup:y,sortField:w,sortDirection:2,isSortField:!1,canvasItem:t},text:a.localizationService.get("Sort_Desc"),checkable:!0,checked:2===s?.sortDirection,disabled:g},{type:ht.iB.Button,data:{type:4,sortGroup:y,sortField:w,sortDirection:1,isSortField:!1,canvasItem:t},text:a.localizationService.get("Sort_Asc"),checkable:!0,checked:1===s?.sortDirection,disabled:g}];return{type:ht.iB.SubMenu,text:e.label,menu:{items:(0,p.__spreadArray)((0,p.__spreadArray)((0,p.__spreadArray)([],v,!0),[{type:ht.iB.Divider}],!1),q,!0)}}}}))},n.prototype.getCustomActionShortcut$=function(e,t){return(0,_t.of)({type:ht.iB.Button,data:{type:5,shortcut:e,canvasItem:t},text:e.label,icon:{type:2,name:e.icon},disabled:e.disabled})},n.prototype.getSetValueShortcut$=function(e,t){return(0,_t.of)({type:ht.iB.Button,data:{type:9,shortcut:e,canvasItem:t},text:e.label,icon:{type:2,name:e.icon}})},n.prototype.getDivider$=function(){return(0,_t.of)({type:ht.iB.Divider})},n.\u0275fac=function(t){return new(t||n)(D.\u0275\u0275inject(Ki),D.\u0275\u0275inject(D.Injector),D.\u0275\u0275inject(Sa.a),D.\u0275\u0275inject(ot.o),D.\u0275\u0275inject(Es._),D.\u0275\u0275inject(It.s),D.\u0275\u0275inject(Ir.z))},n.\u0275prov=D.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n}(),Us={provide:C(87644).VO,useFactory:function(n){return Promise.resolve(n)},deps:[_n]},Gs=function(){function n(){}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=D.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=D.\u0275\u0275defineInjector({providers:[dr,gr,Kr,Pi,Ca,Ka,Ti,Da,fn,Ki,As,jr,gn,yn,_n,Us,Ni,Fi,vn,Xa,Pa,Aa],imports:[x.CommonModule]}),n}()},42587:function(st,Le,C){"use strict";C.d(Le,{F:function(){return b},j:function(){return p}});var x=C(78417);function p(S,K,Z){return void 0===Z&&(Z=!1),1===S?{paneTitle:K.get("Tooltip"),paneTitleTooltip:K.get("Drillthrough_TooltipTitleTooltip"),linkFieldsDropZoneTitle:K.get(Z?"PagePropertyPane_LinkFieldsDropZoneTitle_Tooltip":"DrillthroughLinks_Tooltip_Fields"),dropZoneText:K.get("FieldDropZone_TooltipLink_Watermark"),keepAllFiltersLabel:K.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:K.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip"),keepAllFiltersToggleForcedOnTooltip:K.format("Drillthrough_KeepAllFiltersForcedOnForTooltip_Tooltip",[K.get("Drillthrough_KeepAllFiltersForTooltip_Tooltip")]),crossReportDrillthroughLabel:K.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:K.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:K.get("DrillthroughLinks_LinkTypeGroup_Tooltip")}:{paneTitle:K.get("Drillthrough"),paneTitleTooltip:K.get("Drillthrough_DrillthroughTitleTooltip"),linkFieldsDropZoneTitle:K.get(Z?"PagePropertyPane_LinkFieldsDropZoneTitle_Drillthrough":"DrillthroughLinks_Drillthrough_Fields"),dropZoneText:K.get("FieldDropZone_DrillthroughLink_Watermark"),keepAllFiltersLabel:K.get("Drillthrough_KeepAllFilters"),keepAllFiltersTooltip:K.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip"),keepAllFiltersToggleForcedOnTooltip:K.format("Drillthrough_KeepAllFiltersForcedOnForDrillthrough_Tooltip",[K.get("Drillthrough_KeepAllFiltersForDrillthrough_Tooltip")]),crossReportDrillthroughLabel:K.get("Drillthrough_CrossReportDrillthrough"),crossReportDrillthroughTooltip:K.get("Drillthrough_CrossReportDrillthrough_Tooltip"),linkFieldsLinkTypeGroupTitle:K.get("DrillthroughLinks_LinkTypeGroup_Drillthrough")}}function b(S,K,Z,we){var re=(0,x.Dt)(S,K),qe=(0,x.LM)(S,K)||re,pe=!K||re,ie=!!K&&2===K.type||we&&!!K&&(void 0===K.type||0===K.type);return{keepAllFilters:{disabled:pe,value:qe,tooltip:pe&&qe?Z.keepAllFiltersToggleForcedOnTooltip:Z.keepAllFiltersTooltip},crossReportDrillthrough:{show:ie,disabled:!K,value:!!ie&&(0,x.aQ)(S,K),tooltip:Z.crossReportDrillthroughTooltip},linkFieldsDropZoneTitle:Z.linkFieldsDropZoneTitle,linkFieldsLinkTypeGroupTitle:Z.linkFieldsLinkTypeGroupTitle}}},40702:function(st,Le,C){"use strict";C.d(Le,{$0:function(){return ze},Es:function(){return $e},G5:function(){return K},Lo:function(){return Ie},Sd:function(){return rt},TS:function(){return tt},V1:function(){return Q},Y$:function(){return k},Yu:function(){return I},_Z:function(){return ie},_m:function(){return Nt},cF:function(){return b},gW:function(){return jt},jG:function(){return xe},lG:function(){return we},rU:function(){return qe},yw:function(){return Te}});var x=C(41114),p="PBI.ExploreUIAuthoring.ContextMenuButtonClicked",b=x.cx[p]=(0,x.b1)(p),S="PBI.ExploreUIAuthoring.RevertToDefaultClicked",K=x.cx[S]=(0,x.b1)(S),Z="PBI.ExploreUIAuthoring.ExpansionButtonClicked",we=x.cx[Z]=(0,x.b1)(Z),re="PBI.ExploreUIAuthoring.FormattingPaneSearch",qe=x.cx[re]=(0,x.b1)(re),pe="PBI.ExploreUIAuthoring.InsertSection",ze=x.cx[pe]=(0,x.b1)(pe),H="PBI.ExploreUIAuthoring.DeleteSection",Te=x.cx[H]=(0,x.b1)(H),Ce="PBI.ExploreUIAuthoring.VisualSession",ie=x.cx[Ce]=(0,x.b1)(Ce,{logExpAssignment:!0}),j="PBI.ExploreUIAuthoring.ReorderTabOrderByPosition",k=x.cx[j]=(0,x.b1)(j),te="PBI.ReportCreationCopilot.RunSuggestQueries",ge=(x.cx[te]=(0,x.b1)(te),"PBI.AuthoringCopilotCreatePage.RunSuggestQueries"),he=(x.cx[ge]=(0,x.b1)(ge),"PBI.ReportCreationCopilot.PageValidation"),mt=(x.cx[he]=(0,x.b1)(he),"PBI.ReportCreationCopilot.VisualValidation"),Ge=(x.cx[mt]=(0,x.b1)(mt),"PBI.EX.ChangeFieldWell"),Q=x.cx[Ge]=(0,x.b1)(Ge),Ze="PBI.EX.ChangeAggregation",tt=x.cx[Ze]=(0,x.b1)(Ze),fe="PBI.EX.RemoveConditionalFormatting",rt=x.cx[fe]=(0,x.b1)(fe),gt="PBI.EX.RemoveDataBars",Dt=(x.cx[gt]=(0,x.b1)(gt),"PBI.EX.AnalyticsPane.Open"),W=(x.cx[Dt]=(0,x.b1)(Dt),"PBI.EX.AnalyticsPane.AddInstance"),I=x.cx[W]=(0,x.b1)(W),M="PBI.EX.AnalyticsPane.RemoveInstance",Y=(x.cx[M]=(0,x.b1)(M),"PBI.EX.AnalyticsPane.ForecastParameterUpdated"),ae=(x.cx[Y]=(0,x.b1)(Y),"PBI.EX.PropertyPane.OnValueChanged"),Ie=x.cx[ae]=(0,x.b1)(ae),be="PBI.EX.DrillthroughPane.ChangeLink",nt=(x.cx[be]=(0,x.b1)(be),"PBI.EX.NavigateAndSelectVisual"),$e=x.cx[nt]=(0,x.b1)(nt),Oe="PBI.EX.FieldWellAbnormalRename",xe=x.cx[Oe]=(0,x.b1)(Oe),yt="PBI.EX.LaunchChangeDetectionDialog",Nt=x.cx[yt]=(0,x.b1)(yt),Je="PBI.EX.PersonalizeVisual.ChangePerspective",jt=x.cx[Je]=(0,x.b1)(Je),Ht="PBI.ReportCreationCopilot.FeedbackLoop.UserResponse",Br=(x.cx[Ht]=(0,x.b1)(Ht),"PBI.ReportCreationCopilot.FeedbackLoop"),De=(x.cx[Br]=(0,x.b1)(Br),"PBI.ReportCreationCopilot.UserResponse"),D=(x.cx[De]=(0,x.b1)(De),"PBI.ReportCreationCopilot.StageCompleted"),Vt=(x.cx[D]=(0,x.b1)(D),"PBI.ReportCreationCopilot.TerminalAPIError"),lt=(x.cx[Vt]=(0,x.b1)(Vt),"PBI.ReportCreationCopilot.TerminalAgentError"),It=(x.cx[lt]=(0,x.b1)(lt),"PBI.ReportCreationCopilot.EnsureComplete"),Xe=(x.cx[It]=(0,x.b1)(It),"PBI.CopilotReportAuthoring.Authoring"),dr=(x.cx[Xe]=(0,x.b1)(Xe),"PBI.CopilotReportAuthoring.CreatePage"),hr=(x.cx[dr]=(0,x.b1)(dr),"PBI.Copilot.PageCreationTool"),Er=(x.cx[hr]=(0,x.b1)(hr),"PBI.CopilotReportAuthoring.SuggestTopics"),Dr=(x.cx[Er]=(0,x.b1)(Er),"PBI.CopilotReportAuthoring.SummarizeDataset"),Kt=(x.cx[Dr]=(0,x.b1)(Dr),"PBI.CopilotReportAuthoring.CloseButtonClicked"),He=(x.cx[Kt]=(0,x.b1)(Kt),"PBI.CopilotReportAuthoring.ValidateVisual"),Fr=(x.cx[He]=(0,x.b1)(He),"PBI.CopilotReportAuthoring.ValidateVisualAdHocQuery"),Ot=(x.cx[Fr]=(0,x.b1)(Fr),"PBI.CopilotScenario.Summary.Generated"),$t=(x.cx[Ot]=(0,x.b1)(Ot),"PBI.CopilotScenario.Answer.Generated"),ue=(x.cx[$t]=(0,x.b1)($t),"PBI.CopilotScenario.Forecast.Generated"),Nr=(x.cx[ue]=(0,x.b1)(ue),"PBI.CopilotReportAuthoring.ValidateField"),mr=(x.cx[Nr]=(0,x.b1)(Nr),"PBI.ExploreCopilot.CopilotReferenceClicked"),Gr=(x.cx[mr]=(0,x.b1)(mr),"PBI.ExploreCopilot.CopilotReferenceHovered"),gr=(x.cx[Gr]=(0,x.b1)(Gr),"PBI.Copilot.OpenCopilotPaneEditModeFS");x.cx[gr]=(0,x.b1)(gr)},90617:function(){window.onObjectSprite={icons:[{type:"svg",id:"PBIData_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1741 410 v 1228 q 0 64 -56 120 q -57 56 -154 98 q -97 42 -228 66 q -131 24 -279 24 q -149 0 -279 -24 q -131 -24 -228 -66 q -97 -42 -153 -98 q -57 -56 -57 -120 v -1228 q 0 -64 57 -120 q 56 -56 153 -98 q 97 -42 228 -66 q 130 -24 279 -24 q 148 0 279 24 q 131 24 228 66 q 97 42 154 98 q 56 56 56 120 m -717 -205 q -143 0 -256 22 q -114 22 -193 53 q -80 32 -122 67 q -43 36 -43 63 q 0 27 43 62 q 42 36 122 67 q 79 32 193 53 q 113 22 256 22 q 143 0 257 -22 q 113 -21 193 -53 q 79 -31 122 -67 q 42 -35 42 -62 q 0 -27 -42 -63 q -43 -35 -122 -67 q -80 -31 -193 -53 q -114 -22 -257 -22 m 0 1638 q 143 0 257 -22 q 113 -22 193 -54 q 79 -31 122 -67 q 42 -35 42 -62 v -1071 q -47 34 -112 61 q -65 28 -144 47 q -79 20 -169 31 q -91 11 -189 11 q -98 0 -188 -11 q -91 -11 -170 -31 q -79 -19 -144 -47 q -65 -27 -112 -61 v 1071 q 0 27 43 62 q 42 36 122 67 q 79 32 193 54 q 113 22 256 22 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1894 q -110 0 -202 -14 q -92 -14 -166 -37 q -74 -22 -129 -49 q -56 -27 -93 -53 q -38 -26 -57 -48 q -19 -21 -19 -33 v -1250 q 0 -45 49 -91 q 49 -46 137 -83 q 88 -36 211 -59 q 122 -23 269 -23 q 147 0 270 23 q 122 23 210 59 q 88 37 137 83 q 49 46 49 91 v 1250 q 0 12 -19 33 q -19 22 -56 48 q -38 26 -93 53 q -56 27 -130 49 q -74 23 -166 37 q -92 14 -202 14 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1741 410 v 1228 q 0 64 -56 120 q -57 56 -154 98 q -97 42 -228 66 q -131 24 -279 24 q -149 0 -279 -24 q -131 -24 -228 -66 q -97 -42 -153 -98 q -57 -56 -57 -120 v -1228 q 0 -64 57 -120 q 56 -56 153 -98 q 97 -42 228 -66 q 130 -24 279 -24 q 148 0 279 24 q 131 24 228 66 q 97 42 154 98 q 56 56 56 120 m -717 -205 q -143 0 -256 22 q -114 22 -193 53 q -80 32 -122 67 q -43 36 -43 63 q 0 27 43 62 q 42 36 122 67 q 79 32 193 53 q 113 22 256 22 q 143 0 257 -22 q 113 -21 193 -53 q 79 -31 122 -67 q 42 -35 42 -62 q 0 -27 -42 -63 q -43 -35 -122 -67 q -80 -31 -193 -53 q -114 -22 -257 -22 m 0 1638 q 143 0 257 -22 q 113 -22 193 -54 q 79 -31 122 -67 q 42 -35 42 -62 v -1071 q -47 34 -112 61 q -65 28 -144 47 q -79 20 -169 31 q -91 11 -189 11 q -98 0 -188 -11 q -91 -11 -170 -31 q -79 -19 -144 -47 q -65 -27 -112 -61 v 1071 q 0 27 43 62 q 42 36 122 67 q 79 32 193 54 q 113 22 256 22 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIFormat_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -39 39 -85 83 q -46 44 -88 81 q 1 6 1 12 q 0 6 0 12 q 0 75 -39 138 q -39 64 -102 110 q -64 47 -145 74 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -24 q 57 -19 113 -57 q 55 -37 96 -100 q 24 -43 48 -81 q 24 -38 55 -66 q 31 -28 73 -44 q 41 -16 101 -16 q 38 -42 84 -91 q 45 -49 87 -91 q 20 -20 53 -54 q 32 -34 74 -77 q 42 -42 90 -90 q 48 -47 99 -94 q 51 -46 102 -89 q 51 -42 99 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 m -1104 1210 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 9 -45 29 q -22 21 -45 55 q -24 35 -53 87 q -45 68 -106 109 q -61 42 -125 65 q 56 16 114 25 q 58 10 109 15 m 417 -380 q 31 -29 67 -64 q 36 -35 65 -64 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -96 q 26 -44 37 -75 q -29 15 -86 59 q -57 44 -143 122 q -87 78 -202 192 q -116 114 -260 270 q 61 28 95 88 m -625 -644 h -410 v 757 l -102 -10 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1999 763 l -45 121 q -20 52 -61 118 q -41 66 -96 138 q -55 72 -118 145 q -63 73 -126 140 q -63 68 -121 125 q -59 58 -104 97 q -17 -62 -58 -103 q -41 -40 -102 -56 q 22 -25 50 -56 q 28 -30 59 -61 q 30 -31 60 -62 q 30 -30 55 -56 q 175 -178 297 -287 q 122 -109 194 -145 m -1627 853 v -804 h 512 v -716 h 512 v 409 h 512 v 66 q -68 39 -147 103 q -79 64 -170 149 q -92 86 -195 192 q -104 106 -219 229 q -72 9 -126 39 q -54 31 -93 72 q -40 41 -68 86 q -29 46 -51 85 l -6 11 q -24 33 -61 52 q -38 20 -77 29 q -39 10 -73 12 q -35 3 -52 3 q -13 0 -20 -1 q -8 0 -9 0 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 205 1669 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 v -673 h -410 v 757 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -24 24 -50 50 q -27 26 -54 51 q -27 26 -53 49 q -26 24 -48 43 q -4 -62 -29 -111 q 16 -15 36 -34 q 20 -19 42 -40 q 22 -20 44 -41 q 21 -21 40 -40 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -97 q 26 -44 37 -74 q -29 15 -88 60 q -59 46 -148 127 q -90 82 -209 201 q -120 119 -271 281 q -49 -25 -110 -28 q 19 -22 43 -49 q 23 -26 49 -53 q 25 -27 51 -54 q 26 -27 50 -51 q 20 -20 53 -54 q 33 -34 75 -77 q 41 -42 90 -90 q 48 -47 99 -94 q 50 -46 102 -89 q 51 -42 98 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 921 1997 q -56 -5 -116 -16 q -60 -10 -116 -26 l -155 -43 l 151 -54 q 68 -24 119 -63 q 51 -39 86 -91 l 12 -21 q 24 -43 46 -77 q 21 -33 45 -56 q 23 -23 53 -36 q 29 -12 70 -12 q 94 0 146 52 q 52 52 52 146 q 0 38 -15 74 q -15 36 -41 69 q -27 33 -63 61 q -37 28 -80 48 q -43 21 -91 33 q -48 12 -98 12 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1116 1451 q 58 0 106 17 q 48 17 82 49 q 33 32 52 78 q 18 47 18 105 q 0 74 -39 137 q -39 64 -102 111 q -64 47 -145 73 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -25 q 57 -19 113 -56 q 55 -37 97 -101 q 22 -40 46 -77 q 23 -37 52 -66 q 29 -28 68 -46 q 38 -17 92 -17 m -191 495 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 8 -43 26 q -21 19 -41 48 q -21 30 -45 73 q -28 43 -57 75 q -30 32 -61 55 q -31 24 -63 40 q -32 16 -64 28 q 56 16 114 25 q 58 10 109 15 z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"AudioBookmark_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1536 102 v 1844 l -563 -410 l -563 410 v -1844 m 1024 103 h -922 v 1539 l 461 -335 l 461 335 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 973 1473 l -512 372 v -1691 h 1024 v 1691 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1536 102 v 1844 l -563 -410 l -563 410 v -1844 m 1024 103 h -922 v 1539 l 461 -335 l 461 335 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LaunchSelectionPane_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 922 h 922 v 102 h -819 v 819 h 819 v 103 h -922 m 922 -1526 v 399 h -307 v -717 h 1229 v 1127 h -12 m -265 307 l 185 399 l -243 113 l -187 -400 l -298 298 v -1229 l 922 819 m -540 -102 h 271 l -550 -489 v 753 l 226 -226 l 214 440 l 49 -27 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 154 1894 v -921 h 870 v 921 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 1946 h -922 v -1024 h 922 v 102 h -819 v 819 h 819 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 1024 819 h -256 v -665 h 1126 v 1024 h -18 l -852 -758 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1843 205 h -1024 v 614 h -102 v -717 h 1229 v 1127 h -12 l -116 -103 h 25 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1440 1560 l -262 262 v -991 l 735 654 h -325 l 198 425 l -150 70 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1669 1536 l 185 399 l -243 113 l -187 -400 l -298 298 v -1229 l 922 819 m -540 -102 h 271 l -550 -489 v 753 l 226 -226 l 214 440 l 49 -27 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIPerformanceAnalyzer_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1895 1249 q 70 63 112 149 q 41 87 41 189 q 0 96 -36 180 q -36 84 -98 146 q -63 63 -147 99 q -84 36 -180 36 q -95 0 -179 -36 q -84 -36 -146 -99 q -63 -62 -99 -146 q -37 -84 -37 -180 q 0 -89 32 -168 q 31 -78 87 -139 q 55 -61 130 -100 q 75 -39 161 -48 v -108 h -205 v -102 h 512 v 102 h -205 v 108 q 48 5 91 19 q 43 15 83 37 l 149 -149 l 72 72 m -1004 732 q 13 27 28 53 q 15 26 32 50 h -782 v -1844 h 1434 v 717 h -103 v -614 h -1228 v 1638 m 1177 103 q 74 0 140 -28 q 65 -28 114 -77 q 48 -49 77 -115 q 28 -65 28 -139 q 0 -74 -28 -139 q -29 -65 -77 -114 q -49 -49 -114 -77 q -66 -28 -140 -28 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 q 0 74 28 139 q 28 66 77 115 q 49 49 114 77 q 65 28 139 28 m -614 -359 q 0 13 1 25 q 0 13 1 26 h -361 v -716 h 308 v -512 h 409 v 409 h -102 v -307 h -205 v 833 q -24 56 -37 116 q -14 61 -14 126 m -256 -563 v 512 h 205 v -512 m 921 512 v 102 h -307 v -307 h 102 v 205 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 973 1587 q 0 85 22 162 q 21 77 61 145 h -698 v -1740 h 1332 v 665 h -461 v 270 q -58 42 -105 96 q -48 54 -81 118 q -34 64 -52 135 q -18 72 -18 149 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 973 1587 q 0 13 1 25 q 0 13 1 26 h -361 v -716 h 308 v -512 h 409 v 409 h -102 v -307 h -205 v 833 q -24 56 -37 116 q -14 61 -14 126 m -256 -563 v 512 h 205 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1029 1843 q 13 27 28 53 q 15 26 32 50 h -782 v -1844 h 1434 v 717 h -103 v -614 h -1228 v 1638 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1587 1997 q -85 0 -159 -33 q -75 -32 -130 -88 q -56 -55 -88 -130 q -32 -74 -32 -159 q 0 -85 32 -160 q 32 -74 88 -130 q 55 -55 130 -87 q 74 -32 159 -32 q 85 0 160 32 q 74 32 130 87 q 55 56 88 130 q 32 75 32 160 q 0 85 -32 159 q -33 75 -88 130 q -56 56 -130 88 q -75 33 -160 33 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1843 1536 v 102 h -307 v -307 h 102 v 205 m 257 -287 q 70 63 112 149 q 41 87 41 189 q 0 96 -36 180 q -36 84 -98 146 q -63 63 -147 99 q -84 36 -180 36 q -95 0 -179 -36 q -84 -36 -146 -99 q -63 -62 -99 -146 q -37 -84 -37 -180 q 0 -89 32 -168 q 31 -78 87 -139 q 55 -61 130 -100 q 75 -39 161 -48 v -108 h -205 v -102 h 512 v 102 h -205 v 108 q 48 5 91 19 q 43 15 83 37 l 149 -149 l 72 72 m -446 835 q 74 0 140 -28 q 65 -28 114 -77 q 48 -49 77 -115 q 28 -65 28 -139 q 0 -74 -28 -139 q -29 -65 -77 -114 q -49 -49 -114 -77 q -66 -28 -140 -28 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 q 0 74 28 139 q 28 66 77 115 q 49 49 114 77 q 65 28 139 28 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBISyncSlicer_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1024 v 256 l -307 256 v 512 h -410 v -512 l -307 -256 v -167 q 48 -41 89 -89 m 833 102 h -820 v 106 l 308 256 v 458 h 204 v -458 l 308 -256 m -820 -1232 v 410 h -409 v -103 h 226 q -31 -46 -72 -84 q -41 -38 -89 -65 q -49 -27 -104 -42 q -55 -14 -115 -14 q -89 0 -167 31 q -79 32 -139 87 q -61 56 -100 131 q -40 75 -49 161 h -105 q 9 -108 57 -202 q 47 -93 123 -162 q 75 -69 173 -109 q 97 -39 207 -39 q 72 0 139 17 q 66 17 125 48 q 59 32 109 76 q 50 45 88 100 v -241 m 100 614 q -10 108 -57 201 q -48 94 -123 163 q -75 69 -173 108 q -98 40 -208 40 q -72 0 -138 -17 q -67 -17 -126 -49 q -59 -31 -109 -76 q -50 -44 -88 -98 v 240 h -102 v -409 h 410 v 102 h -226 q 31 46 72 84 q 40 38 89 65 q 48 27 103 41 q 55 15 115 15 q 89 0 168 -32 q 78 -31 139 -87 q 61 -55 100 -130 q 39 -75 49 -161 m 927 -512 v 820 h -103 v -410 h -564 l 1 -51 v -51 h 563 v -205 h -563 v -103 m -1075 1741 h 1024 v 103 h -1127 v -666 h 103 m 888 256 l 124 102 h -807 v -375 q 77 17 153 17 q 72 0 139 -13 q 66 -13 129 -38 h 91 v 102 h -410 v 205 m 1126 -819 v 205 h -102 v -103 h -303 q 18 -49 30 -102 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 922 1395 l 307 254 v 245 h -1075 v -614 h 102 v -70 q 145 70 307 70 q 99 0 189 -25 q 90 -25 170 -71 m 358 -723 h 614 v 461 h -710 q 38 -66 62 -140 q 23 -73 31 -154 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1894 154 v 307 h -614 v -307 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1093 1536 l 124 102 h -807 v -375 q 77 17 153 17 q 72 0 139 -13 q 66 -13 129 -38 h 91 v 102 h -410 v 205 m 1126 -819 v 205 h -102 v -103 h -303 q 18 -49 30 -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 102 v 820 h -103 v -410 h -564 l 1 -51 v -51 h 563 v -205 h -563 v -103 m -1075 1741 h 1024 v 103 h -1127 v -666 h 103 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1997 1075 v 181 l -307 256 v 485 h -308 v -485 l -307 -256 v -181 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 1024 v 256 l -307 256 v 512 h -410 v -512 l -307 -256 v -167 q 48 -41 89 -89 m 833 102 h -820 v 106 l 308 256 v 458 h 204 v -458 l 308 -256 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1126 0 v 410 h -409 v -103 h 226 q -31 -46 -72 -84 q -41 -38 -89 -65 q -49 -27 -104 -42 q -55 -14 -115 -14 q -89 0 -167 31 q -79 32 -139 87 q -61 56 -100 131 q -40 75 -49 161 h -105 q 9 -108 57 -202 q 47 -93 123 -162 q 75 -69 173 -109 q 97 -39 207 -39 q 72 0 139 17 q 66 17 125 48 q 59 32 109 76 q 50 45 88 100 v -241 m 100 614 q -10 108 -57 201 q -48 94 -123 163 q -75 69 -173 108 q -98 40 -208 40 q -72 0 -138 -17 q -67 -17 -126 -49 q -59 -31 -109 -76 q -50 -44 -88 -98 v 240 h -102 v -409 h 410 v 102 h -226 q 31 46 72 84 q 40 38 89 65 q 48 27 103 41 q 55 15 115 15 q 89 0 168 -32 q 78 -31 139 -87 q 61 -55 100 -130 q 39 -75 49 -161 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIBuild_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1843 746v-234h-512v-410h-614v717h-512v1127h819v-103h-205v-1638h410v574q47-18 102-31v-134h410v113q30 4 59 10 22 4 43 9z m-1536 176h410v921h-410v-921z m1280-103q96 0 180 16 84 16 147 44 62 28 98 66 36 37 36 79v870q0 32-36 60-36 28-98 49-63 21-147 33-84 12-180 12-95 0-179-12-84-12-146-33-63-21-99-49-37-28-37-60v-870q0-42 37-79 36-38 99-66 62-28 146-44 84-16 179-16z m0 103q-84 0-149 12-66 12-111 29-45 16-70 33-25 17-28 26 3 11 28 29 25 17 70 34 45 17 111 29 65 12 149 12 84 0 150-12 65-12 111-28 45-17 70-34 25-17 28-26-3-11-28-28-25-18-70-35-46-17-111-29-66-12-150-12z m0 1024q73 0 133-7 60-7 106-17 45-11 76-23 30-13 44-23v-725q-64 35-156 57-93 21-203 21-109 0-202-21-93-22-156-57v725q13 10 44 23 30 12 76 23 45 10 105 17 60 7 133 7z"},{type:"path",className:"OfficeIconColors_m20",d:"M1792 736v-173h-512v-409h-512v716h-512v1024h768v-945l3-13q12-39 59-78 47-39 121-70 74-32 172-51 96-20 208-20 111 0 205 19z"},{type:"path",className:"OfficeIconColors_m22",d:"M1843 746v-234h-512v-410h-614v717h-512v1127h819v-103h-205v-1638h410v574q47-18 102-31v-134h410v113q30 4 59 10 22 4 43 9z m-1536 176h410v921h-410v-921z"},{type:"path",className:"OfficeIconColors_m20",d:"M1452 1989q62 8 135 8 73 0 136-7 62-8 112-20 50-13 86-28 36-16 55-32l21-17v-860l-2-9q-8-28-41-55-34-28-87-50-54-22-125-35-71-14-155-14-81 0-151 14-71 13-125 35-54 21-88 48-34 27-43 54l-2 9v863l20 17q19 16 55 32 35 15 86 27 50 12 113 20z"},{type:"path",className:"OfficeIconColors_m210",d:"M1587 819q96 0 180 16 84 16 147 44 62 28 98 66 36 37 36 79v870q0 32-36 60-36 28-98 49-63 21-147 33-84 12-180 12-95 0-179-12-84-12-146-33-63-21-99-49-37-28-37-60v-870q0-42 37-79 36-38 99-66 62-28 146-44 84-16 179-16z m0 103q-84 0-149 12-66 12-111 29-45 16-70 33-25 17-28 26 3 11 28 29 25 17 70 34 45 17 111 29 65 12 149 12 84 0 150-12 65-12 111-28 45-17 70-34 25-17 28-26-3-11-28-28-25-18-70-35-46-17-111-29-66-12-150-12z m0 1024q73 0 133-7 60-7 106-17 45-11 76-23 30-13 44-23v-725q-64 35-156 57-93 21-203 21-109 0-202-21-93-22-156-57v725q13 10 44 23 30 12 76 23 45 10 105 17 60 7 133 7z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PBIAddToChart_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1843 295q0-37-21-58-21-21-56-21-47 0-112 33-66 33-140 86-74 52-149 116-76 64-144 126-68 62-121 115-54 52-83 81-54 54-103 107-45 48-86 95-10-1-20 0-60 0-104 20-44 19-77 52-33 33-58 75-26 42-51 87l-9 16q-27 41-62 73-35 32-73 56-38 23-77 40-40 16-77 26-87 26-179 29 23 47 73 80 49 32 110 53 60 21 125 33 65 11 121 17 55 5 94 6 38 1 45 1 80 0 165-27 84-27 153-77 69-50 113-122 44-72 44-161 0-12-1-24 10-9 26-22 29-26 60-54 31-28 61-56l138-138q53-54 115-121 62-67 126-142 64-76 116-149 52-73 85-138 33-66 33-113z m-835 754q-31-31-74-50 32-36 68-73 37-41 82-86 160-161 276-261 116-100 195-157 78-57 124-79 46-23 67-29-4 14-14 38-10 24-32 62-23 37-60 89-37 51-94 120-58 68-138 156-81 87-190 195-21 21-46 45-25 24-49 48-23 22-48 46l-15 13q-19-46-52-77z m-398 495q-38 0-80-2-42-3-85-8-43-6-85-14-42-9-80-20 40-13 82-33 42-20 82-47 40-27 77-62 37-36 67-81l14-25q26-46 48-80 21-35 44-57 22-23 49-34 27-11 65-11 88 0 135 47 46 46 46 135 0 57-31 110-31 53-83 94-53 40-121 64-69 24-144 24z m870-64h-354v111h354v355h111v-355h355v-111h-355v-354h-111v354z"},{type:"path",className:"OfficeIconColors_m26",d:"M754 1520q-69 24-144 24-38 0-80-2-42-3-85-8-43-6-85-14-42-9-80-20 40-13 82-33 42-20 82-47 40-27 77-62 37-36 67-81l14-25q26-46 48-80 21-35 44-57 22-23 49-34 27-11 65-11 88 0 135 47 46 46 46 135 0 57-31 110-31 53-83 94-53 40-121 64z"},{type:"path",className:"OfficeIconColors_m25",d:"M808 975q62 0 113 19 51 19 87 55 36 35 56 87 20 51 20 116 0 89-44 161-44 72-113 122-69 50-153 77-85 27-165 27-7 0-45-1-39-1-94-6-56-6-121-17-65-12-125-33-61-21-110-53-50-33-73-80 92-3 179-29 37-10 77-26 39-17 77-40 38-24 73-56 35-32 62-73l9-16q25-45 51-87 25-42 58-75 33-33 77-52 44-20 104-20z m-198 569q75 0 144-24 68-24 121-64 52-41 83-94 31-53 31-110 0-89-46-135-47-47-135-47-38 0-65 11-27 11-49 34-23 22-44 57-22 34-48 80l-14 25q-30 45-67 81-37 35-77 62-40 27-82 47-42 20-82 33 38 11 80 20 42 8 85 14 43 5 85 8 42 2 80 2z"},{type:"path",className:"OfficeIconColors_m20",d:"M1060 1126l15-13q25-24 48-46 24-24 49-48 25-24 46-45 109-108 190-195 80-88 138-156 57-69 94-120 37-52 60-89 22-38 32-62 10-24 14-38-21 6-67 29-46 22-124 79-79 57-195 157-116 100-276 261-45 45-82 86-36 38-68 73 43 18 74 50 33 32 52 77z"},{type:"path",className:"OfficeIconColors_m22",d:"M1843 295q0-37-21-58-21-21-56-21-47 0-112 33-66 33-140 86-74 52-149 116-76 64-144 126-68 62-121 115-54 52-83 81-54 54-103 107-45 48-86 95 50 3 93 19 7 3 13 5 32-36 68-73 37-41 82-86 160-161 276-261 116-100 195-157 78-57 124-79 46-23 67-29-4 14-14 38-10 24-32 62-23 37-60 89-37 51-94 120-58 68-138 156-81 87-190 195-21 21-46 45-25 24-49 48-23 22-48 46 0 0-1 0-10 9-14 13 2 5 4 10 16 42 19 92 10-9 26-22 29-26 60-54 31-28 61-56l138-138q53-54 115-121 62-67 126-142 64-76 116-149 52-73 85-138 33-66 33-113z"},{type:"path",className:"OfficeIconColors_m27",d:"M1126 1480h354v-354h111v354h355v111h-355v355h-111v-355h-354v-111z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PBIAnomalyExplain_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M11.721,18l1.082,1H1V1h1v7.283l5.5-5.488l5,5l5.645-5.645l0.713,0.703L12.5,9.211l-5-5\r\n\tL2,9.709V18H11.721z M16,14c0.551,0,1,0.449,1,1s-0.449,1-1,1s-1-0.449-1-1S15.449,14,16,14 M16,13c-1.105,0-2,0.895-2,2\r\n\ts0.895,2,2,2s2-0.895,2-2S17.105,13,16,13L16,13z M16,11.993c0.56,0,1.098,0.152,1.554,0.438c0.816,0.512,1.322,1.305,1.427,2.232\r\n\tc0.103,0.913-0.21,1.808-0.859,2.457c-0.231,0.231-0.648,0.559-1.051,0.877c-0.369,0.291-0.748,0.59-1.071,0.878\r\n\tc-0.323-0.288-0.702-0.587-1.071-0.878c-0.403-0.318-0.82-0.646-1.051-0.877c-0.649-0.649-0.962-1.544-0.859-2.457\r\n\tc0.104-0.927,0.611-1.719,1.427-2.232C14.902,12.144,15.44,11.993,16,11.993 M16,10.993c-0.729,0-1.458,0.197-2.086,0.591\r\n\tc-2.274,1.428-2.522,4.465-0.743,6.243c0.545,0.545,1.708,1.346,2.36,1.976c0.131,0.127,0.3,0.19,0.468,0.19s0.337-0.063,0.469-0.19\r\n\tc0.652-0.63,1.815-1.431,2.36-1.976c1.779-1.778,1.532-4.815-0.743-6.243C17.458,11.19,16.729,10.993,16,10.993L16,10.993z"},{type:"path",className:"OfficeIconColors_m22",d:"M11.721,18l1.082,1H1V1h1v7.283l5.5-5.488l5,5l5.645-5.645l0.713,0.703L12.5,9.211l-5-5L2,9.709V18H11.721z"},{type:"path",className:"OfficeIconColors_m26",d:"M17.819,12.007c-1.072-0.672-2.566-0.672-3.639,0c-0.948,0.596-1.537,1.519-1.659,2.6\r\n\tc-0.119,1.065,0.246,2.11,1.004,2.866c0.252,0.252,0.68,0.59,1.094,0.916c0.361,0.285,0.732,0.577,1.048,0.858L16,19.544\r\n\tl0.333-0.297c0.315-0.281,0.687-0.573,1.048-0.858c0.414-0.326,0.842-0.664,1.094-0.916c0.758-0.756,1.123-1.801,1.004-2.866\r\n\tC19.356,13.525,18.768,12.603,17.819,12.007z"},{type:"path",className:"OfficeIconColors_m20",d:"M16,13.5c0.828,0,1.5,0.672,1.5,1.5s-0.672,1.5-1.5,1.5c-0.828,0-1.5-0.672-1.5-1.5S15.172,13.5,16,13.5z"},{type:"path",className:"OfficeIconColors_m25",d:"M16,14c0.551,0,1,0.449,1,1s-0.449,1-1,1s-1-0.449-1-1S15.449,14,16,14 M16,13c-1.105,0-2,0.895-2,2\r\n\ts0.895,2,2,2s2-0.895,2-2S17.105,13,16,13L16,13z M16,11.993c0.56,0,1.098,0.152,1.554,0.438c0.816,0.512,1.322,1.305,1.427,2.232\r\n\tc0.103,0.913-0.21,1.808-0.859,2.457c-0.231,0.231-0.648,0.559-1.051,0.877c-0.369,0.291-0.748,0.59-1.071,0.878\r\n\tc-0.323-0.288-0.702-0.587-1.071-0.878c-0.403-0.318-0.82-0.646-1.051-0.877c-0.649-0.649-0.962-1.544-0.859-2.457\r\n\tc0.104-0.927,0.611-1.719,1.427-2.232C14.902,12.144,15.44,11.993,16,11.993 M16,10.993c-0.729,0-1.458,0.197-2.086,0.591\r\n\tc-2.274,1.428-2.522,4.465-0.743,6.243c0.545,0.545,1.708,1.346,2.36,1.976c0.131,0.127,0.3,0.19,0.468,0.19s0.337-0.063,0.469-0.19\r\n\tc0.652-0.63,1.815-1.431,2.36-1.976c1.779-1.778,1.532-4.815-0.743-6.243C17.458,11.19,16.729,10.993,16,10.993L16,10.993z"}],viewBox:"0 0 20 20"},{type:"svg",id:"PBINewQuickMeasure_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 614 410 h 205 l -614 819 h -205 l 205 -615 h -205 l 307 -614 h 615 m 819 102 v 1844 h -1434 v -615 h 13 l 90 -118 v 630 h 1228 v -1638 h -676 l 76 -103 m -424 410 h -204 l 307 -410 h -347 l -204 410 h 181 l -205 614 h 12 m 1280 -716 v 307 h -649 l 78 -103 h 468 v -102 h -391 l 78 -102 m 416 921 h -205 v -205 h 205 m 0 -102 h -205 v -205 h 205 m -615 512 h -205 v -205 h 205 m 307 205 h -204 v -205 h 204 m 308 512 h -205 v -204 h 205 m -308 -410 h -204 v -205 h 204 m -307 819 h -205 v -204 h 205 m 307 204 h -204 v -204 h 204 m -418 -615 h 111 v 205 h -205 v -82 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1690 154 v 1740 h -1332 v -614 l 738 -973 h -210 l 114 -153 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1382 461 v 205 h -558 l 155 -205 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1434 410 v 307 h -649 l 78 -103 h 468 v -102 h -391 l 78 -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1434 1024 h -205 v -205 h 205 m 0 512 h -205 v -205 h 205 m -615 205 h -205 v -205 h 205 m 307 205 h -204 v -205 h 204 m 308 512 h -205 v -204 h 205 m -308 -410 h -204 v -205 h 204 m -307 819 h -205 v -204 h 205 m 307 204 h -204 v -204 h 204 m -418 -615 h 111 v 205 h -205 v -82 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1741 102 v 1844 h -1434 v -615 h 13 l 90 -118 v 630 h 1228 v -1638 h -676 l 76 -103 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 71 1178 l 205 -615 h -193 l 256 -512 h 480 l -307 410 h 205 l -538 717 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 614 410 h 205 l -614 819 h -205 l 205 -615 h -205 l 307 -614 h 615 m -308 512 h -204 l 307 -410 h -347 l -204 410 h 181 l -205 614 h 12 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PBIPageVisuals_20",children:[{type:"path",className:"OfficeIconColors_m20",d:"M17.5 7V5.49805H12.5V1.50391H7.5V8.49609H2.5V18.4961H10V8C10 7.44772 10.4477 7 11 7H17.5Z"},{type:"path",className:"OfficeIconColors_m22",d:"M17.998 7V5H12.998V0.996094H7.00195V7.99805H2.00195V19.0039H10V17.998H7.99805V2.00195H12.002V7H12.998V5.99609H17.002V7H17.998ZM2.99805 9.00391H7.00195V17.998H2.99805V9.00391Z"},{type:"path",className:"OfficeIconColors_m25",d:"M18 9H12V19H18V9ZM12 8H18C18.5523 8 19 8.44772 19 9V19C19 19.5523 18.5523 20 18 20H12C11.4477 20 11 19.5523 11 19V9C11 8.44772 11.4477 8 12 8Z"},{type:"path",className:"OfficeIconColors_m20",d:"M18 9H12V19H18V9Z"},{type:"path",className:"OfficeIconColors_m25",d:"M16 18H14V17H16V18Z"}],viewBox:"0 0 20 20"},{type:"svg",id:"addchartplaceholder_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 205 1331 h 205 v 103 h -308 v -308 h 103 m -103 -1024 h 308 v 103 h -205 v 205 h -103 m 103 614 h -103 v -205 h 103 m 0 -102 h -103 v -205 h 103 m 512 -307 h -205 v -103 h 205 m 307 103 h -205 v -103 h 205 m 307 103 h -205 v -103 h 308 v 205 h -103 m 615 410 v 1229 h -1332 v -820 h 410 v -716 h 512 v 307 m -512 512 h -307 v 614 h 307 m 410 -1331 h -308 v 1331 h 308 m 409 -1024 h -307 v 1024 h 307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 512 1434 h -410 v -1332 h 1332 v 205 h -512 v 717 h -410 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 102 1434 v -308 h 103 v 205 h 205 v 103 m -308 -1332 h 308 v 103 h -205 v 205 h -103 m 103 614 h -103 v -205 h 103 m 0 -102 h -103 v -205 h 103 m 307 -307 v -103 h 205 v 103 m 102 0 v -103 h 205 v 103 m 307 0 h -205 v -103 h 308 v 205 h -103 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 1075 1894 h -409 v -716 h 409 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1126 1126 v 820 h -512 v -820 m 410 103 h -307 v 614 h 307 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1485 768 h 409 v 1126 h -409 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1946 717 v 1229 h -512 v -1229 m 409 102 h -307 v 1024 h 307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1485 1894 h -410 v -1433 h 410 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1536 410 v 1536 h -512 v -1536 m 410 102 h -308 v 1331 h 308 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Paste_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 410 1842 q 0 1 1 1 h 613 v 103 h -717 v -1639 h 466 q 9 -44 32 -82 q 23 -37 56 -65 q 33 -27 75 -43 q 41 -15 88 -15 q 46 0 88 15 q 42 16 75 43 q 33 28 56 65 q 23 38 32 82 h 466 v 410 h -103 v -307 h -204 v 307 h -820 v -307 h -204 m 307 204 h 614 v -204 h -153 v -52 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -60 -12 q -32 0 -60 12 q -28 12 -49 33 q -21 21 -33 49 q -12 28 -12 59 v 52 h -153 m 1331 409 v 1229 h -922 v -1229 m 820 103 h -717 v 1024 h 717 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1894 h -666 v -1536 h 457 l 8 -41 q 7 -36 26 -66 q 18 -29 45 -51 q 26 -22 60 -34 q 33 -12 70 -12 q 41 0 75 13 q 34 14 60 37 q 25 24 42 55 q 17 32 25 67 l 7 32 h 457 v 359 h -666 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 666 512 h -154 v 1229 h 512 v 153 h -666 v -1536 h 308 m 1024 0 v 359 h -154 v -205 h -154 v -154 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1024 1946 h -717 v -1639 h 359 v 103 h -256 v 1432 q 0 1 1 1 h 613 m 614 -1433 h -256 v -103 h 359 v 410 h -103 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1434 307 v 410 h -820 v -410 h 159 q 9 -44 32 -82 q 23 -37 56 -65 q 33 -27 75 -43 q 41 -15 88 -15 q 46 0 88 15 q 42 16 75 43 q 33 28 56 65 q 23 38 32 82 m 56 307 v -204 h -153 v -52 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -60 -12 q -32 0 -60 12 q -28 12 -49 33 q -21 21 -33 49 q -12 28 -12 59 v 52 h -153 v 204 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1178 1997 v -1127 h 819 v 1127 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 819 v 1229 h -922 v -1229 m 820 103 h -717 v 1024 h 717 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CustomFieldGraphicalIndicatorGreenPlus_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"powermap_newtour_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 1843 1024 h -819 v 819 h -102 v -819 h -820 v -102 h 820 v -820 h 102 v 820 h 819 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"suggestLightningBolt_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M614 410l308-410h-615l-307 614h205l-205 615h205l614-819h-205z m0 102l-460 614h-12l205-614h-181l204-410h347l-307 410h204z m-409 1434v-615h51l51-67v579h410v-921h-154l77-103h77v-102l102-136v1262h410v-1638h-333l77-103h358v410h512v1434h-1638z m1126-1332v1229h410v-1229h-410z"},{type:"path",className:"OfficeIconColors_m20",d:"M205 1331h0v615h0v-615z m1638 615h0v-1434h0v1434z m-512-1434v-410h0v410h0z m-435-307l-77 103h205l-205 273v1262h410v-1638h-333z m-179 512l0 0v102h0v-102z m-154 205l-256 342v579h410v-921h-154z m768-308h410v1229h-410v-1229z"},{type:"path",className:"OfficeIconColors_m22",d:"M205 1331h51l51-67v579h410v-921h-154l77-103h77v-102l102-136v1262h410v-1638h-333l77-103h358v410h512v1434h-1638v-615z m1536-717h-410v1229h410v-1229z"},{type:"path",className:"OfficeIconColors_m212",d:"M614 512l-460 614h-12l205-614h-181l204-410h347l-307 410h204z"},{type:"path",className:"OfficeIconColors_m211",d:"M922 0l-308 410h205l-614 819h-205l205-615h-205l307-614h615z m-768 1126l460-614h-204l307-410h-347l-204 410h181l-205 614h12z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"GrowFont_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1229 1638 l -145 -386 h -642 l -140 386 h -148 l 546 -1433 h 134 l 543 1433 m -612 -1283 h -4 q -5 26 -12 51 q -7 25 -16 50 l -246 675 h 552 l -247 -675 q -18 -55 -27 -101 m 1108 157 l -189 -189 l -189 189 l -72 -72 l 261 -262 l 262 261 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1229 1638 l -145 -386 h -642 l -140 386 h -148 l 546 -1433 h 134 l 543 1433 m -612 -1283 h -4 q -5 26 -12 51 q -7 25 -16 50 l -246 675 h 552 l -247 -675 q -18 -55 -27 -101 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1873 512 l -189 -189 l -189 189 l -72 -72 l 261 -262 l 262 261 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ShrinkFont_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1951 278 l -261 261 l -262 -262 l 73 -72 l 189 189 l 188 -189 m -507 1433 h -146 l -110 -289 h -496 l -103 289 h -146 l 430 -1126 h 137 m 134 717 l -185 -504 q -4 -9 -8 -28 q -4 -19 -10 -48 h -4 q -6 47 -17 76 l -184 504 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1371 1638 h -146 l -110 -289 h -496 l -103 289 h -146 l 430 -1126 h 137 m 134 717 l -185 -504 q -4 -9 -8 -28 q -4 -19 -10 -48 h -4 q -6 47 -17 76 l -184 504 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1951 278 l -261 261 l -262 -262 l 73 -72 l 189 189 l 188 -189 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Bold_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1563 1213 q 0 97 -36 175 q -36 79 -104 134 q -68 56 -165 86 q -97 30 -218 30 h -528 v -1433 h 499 q 120 0 212 23 q 92 23 155 66 q 63 44 96 107 q 32 64 32 145 q 0 55 -20 106 q -20 51 -56 93 q -37 43 -88 75 q -51 32 -113 48 v 4 q 73 9 134 38 q 61 29 106 73 q 44 45 69 103 q 25 59 25 127 m -374 -607 q 0 -39 -15 -75 q -15 -35 -44 -62 q -29 -27 -73 -43 q -45 -16 -103 -16 h -135 v 409 h 156 q 25 0 62 -13 q 36 -12 70 -38 q 33 -26 58 -66 q 24 -40 24 -96 m 59 620 q 0 -94 -61 -148 q -62 -54 -178 -54 h -190 v 410 h 188 q 52 0 96 -12 q 44 -11 76 -37 q 32 -25 50 -64 q 18 -39 19 -95 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1563 1213 q 0 97 -36 175 q -36 79 -104 134 q -68 56 -165 86 q -97 30 -218 30 h -528 v -1433 h 499 q 120 0 212 23 q 92 23 155 66 q 63 44 96 107 q 32 64 32 145 q 0 55 -20 106 q -20 51 -56 93 q -37 43 -88 75 q -51 32 -113 48 v 4 q 73 9 134 38 q 61 29 106 73 q 44 45 69 103 q 25 59 25 127 m -374 -607 q 0 -39 -15 -75 q -15 -35 -44 -62 q -29 -27 -73 -43 q -45 -16 -103 -16 h -135 v 409 h 156 q 25 0 62 -13 q 36 -12 70 -38 q 33 -26 58 -66 q 24 -40 24 -96 m 59 620 q 0 -94 -61 -148 q -62 -54 -178 -54 h -190 v 410 h 188 q 52 0 96 -12 q 44 -11 76 -37 q 32 -25 50 -64 q 18 -39 19 -95 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Italic_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1398 307 h -158 l -261 1229 h 234 l -102 102 h -563 l 102 -102 h 166 l 259 -1229 h -240 l 102 -102 h 563 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1398 307 h -158 l -261 1229 h 234 l -102 102 h -563 l 102 -102 h 166 l 259 -1229 h -240 l 102 -102 h 563 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Underline_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 410 1843 h 1228 v 103 h -1228 m 1126 -922 q 0 581 -523 581 q -501 0 -501 -559 v -841 h 161 v 832 q 0 422 358 422 q 344 0 344 -409 v -845 h 161 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 410 1843 h 1228 v 103 h -1228 m 1126 -922 q 0 581 -523 581 q -501 0 -501 -559 v -841 h 161 v 832 q 0 422 358 422 q 344 0 344 -409 v -845 h 161 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FillColorSplitDropdown_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 234 -614 l 585 -587 v -181 q 0 -68 42 -111 q 41 -43 112 -43 q 35 0 63 11 q 28 12 48 32 q 20 20 31 48 q 11 29 11 63 v 563 h -102 v -563 q 0 -21 -15 -37 q -16 -15 -36 -15 q -21 0 -36 15 q -15 16 -15 37 v 79 v 144 l -543 545 l 440 441 l 546 -544 l -136 -136 v -145 l 58 59 q 15 -12 38 -28 q 22 -16 50 -30 q 27 -13 58 -23 q 30 -9 62 -9 q 11 0 21 1 q 9 2 20 4 q 69 18 113 63 q 43 45 67 105 q 24 60 33 128 q 9 69 9 135 q 0 55 -4 103 q -4 48 -8 83 q -5 48 -20 97 q -16 49 -33 89 q -19 47 -42 90 q -19 -74 -37 -144 q -8 -30 -15 -62 q -8 -32 -14 -63 q -7 -31 -12 -60 q -6 -29 -9 -52 q -11 -70 -20 -111 q -9 -41 -17 -62 q -9 -25 -17 -32 l -691 689 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 51 1997 v -410 h 1946 v 410 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1946 102 h -1844 v 308 h 1844 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 269 921 l 644 -644 l 542 542 l -644 644 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1331 652 q 27 -25 58 -44 q 26 -17 60 -31 q 33 -14 68 -14 q 18 0 33 4 q 55 14 90 50 q 34 37 54 85 q 19 48 26 103 q 7 55 7 107 q 0 44 -3 82 q -3 38 -6 65 q -5 39 -16 78 q -12 39 -26 71 q -16 37 -34 72 q -16 -59 -30 -115 q -12 -48 -23 -100 q -12 -52 -17 -89 q -8 -57 -15 -89 q -8 -32 -14 -49 q -7 -19 -14 -26 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1536 512 q 69 18 112 63 q 43 45 68 105 q 24 60 33 129 q 8 69 8 134 q 0 55 -3 103 q -4 48 -8 83 q -5 48 -20 97 q -16 49 -33 89 q -19 47 -42 90 q -20 -75 -38 -145 q -8 -30 -15 -62 q -8 -32 -14 -63 q -7 -31 -12 -60 q -6 -28 -9 -51 q -11 -70 -20 -111 q -9 -41 -17 -62 q -9 -25 -17 -32 l -127 -103 q 23 -10 45 -14 q 21 -3 40 -3 q 7 0 17 0 q 10 1 21 2 q 10 1 20 4 q 9 3 15 7 l 31 25 q 10 8 21 20 q 10 13 21 35 q 11 23 22 59 q 10 37 19 93 q 0 -298 -143 -333 q -10 -2 -16 -2 q -15 0 -31 4 q -16 5 -31 13 q -20 6 -46 19 q -26 14 -55 31 l -71 -57 q 34 -31 73 -56 q 33 -21 75 -39 q 41 -17 86 -17 q 18 0 41 5 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1510 819 l -691 689 l -585 -586 l 585 -587 v -181 q 0 -68 42 -111 q 41 -43 112 -43 q 35 0 63 11 q 28 12 48 32 q 20 20 31 48 q 11 29 11 63 v 563 h -102 v -563 q 0 -21 -15 -37 q -16 -15 -36 -15 q -21 0 -36 15 q -15 16 -15 37 v 223 l -543 545 l 440 441 l 546 -544 l -136 -136 v -145 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FontColorNoPreview_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 2048 h -2048 v -512 h 2048 m -589 -102 l -147 -410 h -571 l -143 410 h -137 l 507 -1332 h 124 l 504 1332 m -569 -1169 h -4 l -240 658 h 487 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 51 1997 v -410 h 1946 v 410 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1946 102 h -1844 v 308 h 1844 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1459 1434 l -147 -410 h -571 l -143 410 h -137 l 507 -1332 h 124 l 504 1332 m -569 -1169 h -4 l -240 658 h 487 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Centered_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 102 h 1844 v 103 h -1844 m 0 1536 h 1844 v 102 h -1844 m 205 -1331 h 1434 v 102 h -1434 m -205 308 h 1844 v 102 h -1844 m 205 307 h 1434 v 103 h -1434 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 102 h 1844 v 103 h -1844 m 0 1536 h 1844 v 102 h -1844 m 205 -1331 h 1434 v 102 h -1434 m -205 308 h 1844 v 102 h -1844 m 205 307 h 1434 v 103 h -1434 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"RightAlign_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 205 v -103 h 1844 v 103 m -1434 307 h 1434 v 102 h -1434 m 0 717 h 1434 v 103 h -1434 m -410 -512 h 1844 v 102 h -1844 m 0 717 h 1844 v 102 h -1844 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 205 v -103 h 1844 v 103 m -1434 307 h 1434 v 102 h -1434 m 0 717 h 1434 v 103 h -1434 m -410 -512 h 1844 v 102 h -1844 m 0 717 h 1844 v 102 h -1844 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LeftAlign_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 102 205 v -103 h 1844 v 103 m -410 307 v 102 h -1434 v -102 m 1434 819 v 103 h -1434 v -103 m 1844 -409 v 102 h -1844 v -102 m 1844 819 v 102 h -1844 v -102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 102 205 v -103 h 1844 v 103 m -410 307 v 102 h -1434 v -102 m 1434 819 v 103 h -1434 v -103 m 1844 -409 v 102 h -1844 v -102 m 1844 819 v 102 h -1844 v -102 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"WrapText_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1931 1126 q 7 25 11 50 q 4 26 4 53 q 0 83 -31 156 q -32 74 -86 129 q -54 56 -126 89 q -73 33 -156 35 h -327 l 235 235 l -72 73 l -359 -359 l 359 -358 l 72 72 l -235 235 h 316 q 63 0 119 -24 q 56 -24 98 -66 q 42 -42 66 -98 q 24 -56 24 -119 q 0 -27 -5 -53 q -5 -26 -13 -50 m -1241 -697 q 235 0 235 248 v 433 h -107 v -104 h -2 q -71 120 -205 120 q -49 0 -88 -14 q -39 -13 -66 -38 q -28 -25 -43 -61 q -15 -35 -15 -79 q 0 -186 220 -217 l 199 -28 q 0 -170 -137 -170 q -120 0 -217 82 v -109 q 99 -63 226 -63 m 128 345 l -160 22 q -36 5 -64 13 q -28 9 -47 23 q -19 15 -29 37 q -10 23 -10 57 q 0 49 35 79 q 35 31 93 31 q 39 0 73 -15 q 33 -14 58 -40 q 24 -26 38 -62 q 13 -36 13 -79 m 853 -321 q 73 88 73 239 q 0 83 -21 151 q -21 68 -60 116 q -39 48 -95 74 q -57 27 -128 27 q -132 0 -199 -112 h -3 v 96 h -106 v -985 h 106 v 437 h 3 q 78 -133 230 -133 q 128 0 200 90 m -91 443 q 55 -75 55 -206 q 0 -54 -13 -98 q -14 -44 -38 -75 q -25 -31 -60 -48 q -36 -16 -80 -16 q -47 0 -85 17 q -38 18 -65 48 q -27 31 -41 72 q -15 42 -15 90 v 93 q 0 41 14 76 q 14 36 40 63 q 25 27 60 42 q 35 16 76 16 q 97 0 152 -74 m -1082 376 q 93 -100 251 -100 q 87 0 155 33 v 109 q -73 -52 -159 -52 q -51 0 -94 19 q -43 20 -73 55 q -31 35 -48 84 q -17 49 -17 107 q 0 59 16 105 q 16 47 45 79 q 29 33 71 50 q 42 18 94 18 q 87 0 164 -58 v 102 q -77 46 -182 46 q -71 0 -129 -25 q -59 -24 -101 -68 q -42 -44 -65 -105 q -23 -61 -23 -135 q 0 -163 95 -264 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 584 429 q 235 0 235 248 v 433 h -107 v -104 h -2 q -71 120 -205 120 q -49 0 -88 -14 q -39 -13 -66 -38 q -28 -25 -43 -61 q -15 -35 -15 -79 q 0 -186 220 -217 l 199 -28 q 0 -170 -137 -170 q -120 0 -217 82 v -109 q 99 -63 226 -63 m 128 345 l -160 22 q -36 5 -64 13 q -28 9 -47 23 q -19 15 -29 37 q -10 23 -10 57 q 0 49 35 79 q 35 31 93 31 q 39 0 73 -15 q 33 -14 58 -40 q 24 -26 38 -62 q 13 -36 13 -79 m 853 -321 q 73 88 73 239 q 0 83 -21 151 q -21 68 -60 116 q -39 48 -95 74 q -57 27 -128 27 q -132 0 -199 -112 h -3 v 96 h -106 v -985 h 106 v 437 h 3 q 78 -133 230 -133 q 128 0 200 90 m -91 443 q 55 -75 55 -206 q 0 -54 -13 -98 q -14 -44 -38 -75 q -25 -31 -60 -48 q -36 -16 -80 -16 q -47 0 -85 17 q -38 18 -65 48 q -27 31 -41 72 q -15 42 -15 90 v 93 q 0 41 14 76 q 14 36 40 63 q 25 27 60 42 q 35 16 76 16 q 97 0 152 -74 m -1082 376 q 93 -100 251 -100 q 87 0 155 33 v 109 q -73 -52 -159 -52 q -51 0 -94 19 q -43 20 -73 55 q -31 35 -48 84 q -17 49 -17 107 q 0 59 16 105 q 16 47 45 79 q 29 33 71 50 q 42 18 94 18 q 87 0 164 -58 v 102 q -77 46 -182 46 q -71 0 -129 -25 q -59 -24 -101 -68 q -42 -44 -65 -105 q -23 -61 -23 -135 q 0 -163 95 -264 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1931 1126 q 7 25 11 50 q 4 26 4 53 q 0 83 -31 156 q -32 74 -86 129 q -54 56 -126 89 q -73 33 -156 35 h -327 l 235 235 l -72 73 l -359 -359 l 359 -358 l 72 72 l -235 235 h 316 q 63 0 119 -24 q 56 -24 98 -66 q 42 -42 66 -98 q 24 -56 24 -119 q 0 -27 -5 -53 q -5 -26 -13 -50 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"IncreaseDecimal_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 563 205 l 73 72 l -235 235 h 828 v 102 h -828 l 235 235 l -73 73 l -358 -359 m 1024 297 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 m -624 1022 q 0 26 -18 44 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -44 q 0 -25 17 -44 q 17 -18 43 -18 q 25 0 44 18 q 18 19 18 44 m 1341 -1374 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -9 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 563 205 l 73 72 l -235 235 h 828 v 102 h -828 l 235 235 l -73 73 l -358 -359 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 508 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -9 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1229 860 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 m -624 1022 q 0 26 -18 44 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -44 q 0 -25 17 -44 q 17 -18 43 -18 q 25 0 44 18 q 18 19 18 44 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"DecreaseDecimal_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1126 1587 l -358 359 l -72 -73 l 234 -235 h -828 v -102 h 828 l -234 -235 l 72 -72 m 1178 -721 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -1033 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 m -625 343 q 0 25 -18 43 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -43 q 0 -26 18 -45 q 18 -18 42 -18 q 25 0 44 18 q 18 19 18 45 m 615 1024 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1126 1587 l -358 359 l -72 -73 l 234 -235 h -828 v -102 h 828 l -234 -235 l 72 -72 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1946 508 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m 93 1015 q 0 98 -17 175 q -18 77 -52 130 q -34 53 -83 81 q -49 28 -112 28 q -119 0 -183 -103 q -65 -102 -65 -291 q 0 -206 67 -316 q 67 -110 197 -110 q 248 0 248 406 m -93 9 q 0 -338 -159 -338 q -168 0 -168 344 q 0 321 165 321 q 162 0 162 -327 m -522 -1033 q 0 98 -17 175 q -18 77 -51 130 q -34 53 -83 81 q -50 28 -113 28 q -117 0 -182 -102 q -66 -101 -66 -292 q 0 -206 67 -316 q 67 -110 198 -110 q 247 0 247 406 m -92 9 q 0 -338 -159 -338 q -169 0 -169 344 q 0 321 165 321 q 163 0 163 -327 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 614 860 q 0 25 -18 43 q -18 19 -44 19 q -25 0 -42 -19 q -18 -18 -18 -43 q 0 -26 18 -45 q 18 -18 42 -18 q 25 0 44 18 q 18 19 18 45 m 615 1024 q 0 23 -18 42 q -18 20 -44 20 q -26 0 -43 -20 q -18 -19 -18 -42 q 0 -26 19 -45 q 18 -18 42 -18 q 25 0 44 19 q 18 19 18 44 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TableBorderColorSplitDropdown_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 80 -85 v -1280 h 1376 l -84 85 h -1207 v 1109 h 412 l -27 86 m 272 -444 l 761 -775 q 32 -31 73 -46 q 41 -15 84 -15 q 46 0 87 17 q 41 17 72 46 q 30 30 48 69 q 17 39 17 84 q 0 45 -17 84 q -17 40 -49 72 l -760 774 l -454 134 m 914 -1115 l 195 190 l 46 -44 q 19 -18 30 -43 q 10 -25 10 -52 q 0 -28 -11 -52 q -12 -24 -31 -42 q -19 -18 -44 -28 q -25 -10 -53 -10 q -26 0 -52 9 q -26 10 -46 29 m -709 724 q 70 22 122 72 q 51 50 73 119 l 605 -622 l -196 -191 m -485 856 q -13 -60 -57 -103 q -45 -43 -107 -56 l -77 239 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 43 2005 v -426 h 1962 v 426 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1963 85 h -1878 v 342 h 1878 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 577 1365 l -27 86 h -470 v -1280 h 1376 l -84 85 h -1207 v 1109 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1863 263 q 26 26 40 59 q 13 33 13 67 q 0 35 -13 67 q -14 32 -40 58 l -759 768 q -6 -19 -12 -41 q -7 -21 -16 -44 q -9 -22 -23 -45 q -14 -22 -36 -43 q -14 -13 -34 -25 q -20 -11 -43 -21 q -23 -10 -47 -19 q -24 -8 -44 -14 l 694 -703 q 26 -34 58 -60 q 27 -23 62 -42 q 35 -19 77 -19 q 29 0 60 12 q 31 13 63 45 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 853 1031 q 10 2 35 13 q 24 11 50 25 q 30 16 64 36 q 45 43 70 89 q 25 47 37 88 l -358 98 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1898 232 q 32 32 49 71 q 17 40 17 84 q 0 45 -17 84 q -17 40 -49 72 l -760 774 l -454 134 l 138 -444 l 761 -775 q 32 -31 73 -46 q 41 -15 84 -15 q 44 0 85 15 q 41 15 73 46 m -965 785 q 70 22 122 72 q 51 50 73 119 l 605 -622 l -196 -191 m -726 936 l 241 -80 q -13 -60 -57 -103 q -45 -43 -107 -56 m 951 -610 q 19 -19 30 -44 q 10 -24 10 -51 q 0 -28 -11 -52 q -12 -24 -31 -42 q -19 -18 -44 -28 q -25 -10 -53 -10 q -26 0 -52 9 q -26 10 -46 29 l -44 43 l 195 190 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FillColorSplitDropdown_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1536 v 512 h -2048 v -512 m 285 -683 l 483 -488 v -194 q 0 -35 14 -66 q 13 -31 36 -55 q 23 -23 55 -37 q 31 -13 66 -13 q 35 0 66 13 q 31 14 54 37 q 23 24 37 55 q 13 31 13 66 v 512 h -85 v -512 q 0 -18 -6 -34 q -7 -15 -18 -27 q -12 -11 -27 -18 q -16 -7 -34 -7 q -18 0 -33 7 q -16 7 -27 18 q -12 12 -19 27 q -7 16 -7 34 v 228 l -447 454 l 444 451 l 542 -536 l -197 -196 v -121 l 26 27 q 11 -12 32 -32 q 21 -20 49 -39 q 28 -19 62 -33 q 34 -13 70 -13 q 7 0 14 0 q 6 1 13 2 q 59 10 101 41 q 41 32 68 77 q 27 46 43 101 q 15 56 23 112 q 7 57 9 111 q 2 54 2 97 v 37 q 0 41 -7 88 q -8 48 -19 96 q -11 48 -24 92 q -14 45 -25 79 q -11 34 -19 54 q -8 21 -9 21 q -13 -147 -25 -268 q -6 -52 -12 -103 q -6 -51 -12 -95 q -7 -43 -13 -74 q -7 -31 -14 -42 q -3 -5 -7 -10 q -4 -5 -8 -9 l -663 657 z"},{type:"path",className:"OfficeIconColors_m227",d:"M 43 2005 v -426 h 1962 v 426 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 2048 1536 v 512 h -2048 v -512 m 1963 85 h -1878 v 342 h 1878 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 2048 1536 v 512 h -2048 v -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 316 853 l 623 -622 l 537 537 l -623 622 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 1237 498 q 25 -30 56 -55 q 26 -20 61 -38 q 34 -17 73 -17 q 5 0 11 0 q 5 1 11 2 q 49 8 84 34 q 34 27 57 65 q 23 39 37 85 q 13 47 20 94 q 6 48 8 93 q 2 46 2 82 v 54 q 0 49 -5 92 q -6 44 -13 76 q -8 39 -18 71 q -12 -89 -23 -165 q -5 -32 -11 -65 q -6 -32 -12 -60 q -6 -27 -11 -48 q -6 -21 -12 -30 q -8 -12 -24 -22 q -17 -9 -34 -16 q -20 -8 -42 -14 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1461 363 q 58 10 99 41 q 40 31 67 76 q 27 45 43 99 q 16 55 24 111 q 8 57 10 110 q 2 54 2 97 v 33 q 0 41 -7 89 q -7 48 -18 97 q -11 49 -23 94 q -13 46 -24 81 q -12 35 -20 56 q -8 22 -10 22 q -13 -147 -25 -268 q -6 -52 -12 -103 q -6 -51 -12 -95 q -7 -43 -13 -74 q -7 -31 -14 -42 q -9 -14 -19 -22 q -11 -8 -21 -12 q -11 -4 -23 -5 l -45 -46 q 30 -16 53 -21 q 23 -5 40 -5 q 14 0 30 8 q 15 8 30 22 q 14 14 26 33 q 11 19 16 40 q -4 -63 -14 -123 q -11 -60 -32 -107 q -21 -46 -54 -75 q -33 -28 -81 -28 q -26 0 -53 14 q -27 14 -50 31 l 3 3 q -25 22 -59 62 l -65 -66 q 31 -36 67 -65 q 31 -24 71 -45 q 40 -20 86 -20 q 13 0 27 3 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1513 768 l -663 657 l -565 -572 l 483 -488 v -194 q 0 -35 14 -66 q 13 -31 36 -55 q 23 -23 55 -37 q 31 -13 66 -13 q 35 0 66 13 q 31 14 54 37 q 23 24 37 55 q 13 31 13 66 v 512 h -85 v -512 q 0 -18 -6 -34 q -7 -15 -18 -27 q -12 -11 -27 -18 q -16 -7 -34 -7 q -18 0 -33 7 q -16 7 -27 18 q -12 12 -19 27 q -7 16 -7 34 v 228 l -447 454 l 444 451 l 542 -536 l -197 -196 v -121 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CommonControlChevronDown_12",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"GridCard_24",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 85 85 h 1878 v 1878 h -1878 m 1195 -1792 h -512 v 512 h 512 m 0 85 h -512 v 512 h 512 m -1109 -1109 v 512 h 512 v -512 m -512 597 v 512 h 512 v -512 m -512 1109 h 512 v -512 h -512 m 597 512 h 512 v -512 h -512 m 1109 512 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1920 h -1792 v -1792 h 1792 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 85 85 h 1878 v 1878 h -1878 m 1195 -1792 h -512 v 512 h 512 m 0 85 h -512 v 512 h 512 m -1109 -1109 v 512 h 512 v -512 m -512 597 v 512 h 512 v -512 m -512 1109 h 512 v -512 h -512 m 597 512 h 512 v -512 h -512 m 1109 512 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 m 512 -597 v -512 h -512 v 512 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BorderDrawToolGrid_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1988 674 q 30 30 45 68 q 15 38 15 77 q 0 40 -15 77 q -15 38 -45 68 l -917 910 l -454 167 l 183 -468 l 898 -899 q 30 -30 68 -45 q 38 -14 77 -14 q 39 0 77 15 q 38 15 68 44 m -1005 1124 q -43 -76 -119 -119 l -71 188 m 1034 -887 l -144 -145 l -760 760 q 92 54 145 144 m 848 -847 q 15 -15 23 -34 q 7 -18 7 -38 q 0 -21 -8 -40 q -8 -18 -22 -33 q -15 -14 -33 -22 q -19 -8 -40 -8 q -20 0 -38 7 q -19 8 -34 23 l -16 16 l 145 144 m -1695 834 h 365 l -40 102 h -428 v -1741 h 1741 v 359 q -26 0 -51 4 q -26 5 -51 12 v -272 h -717 v 717 h 210 l -102 102 h -108 v 108 l -102 102 v -210 h -717 m 0 -819 v 717 h 717 v -717 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 819 1634 q 240 -270 448 -482 q 59 -60 119 -120 q 60 -59 118 -113 q 57 -53 111 -99 q 53 -46 99 -80 q 46 -33 83 -52 q 36 -19 60 -19 q 8 0 12 1 q 41 11 68 28 q 26 17 41 37 q 15 20 21 41 q 6 22 6 42 q 0 17 -3 32 q -3 16 -7 27 q -4 13 -9 25 l -958 950 m -478 -60 h -396 v -1638 h 1638 v 312 q -58 8 -109 33 q -51 25 -93 67 l -921 921 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 922 1024 h -768 v -102 h 768 v -768 h 102 v 768 h 210 l -102 102 h -108 v 108 l -102 102 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 530 1843 h -428 v -1741 h 1741 v 359 q -26 0 -51 4 q -26 5 -51 12 v -272 h -1536 v 1536 h 365 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 836 1609 q 77 27 134 84 q 56 57 83 133 l -362 145 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 1988 674 q 30 30 45 68 q 15 38 15 77 q 0 40 -15 77 q -15 38 -45 68 l -917 910 l -454 167 l 183 -468 l 898 -899 q 30 -30 68 -45 q 38 -14 77 -14 q 39 0 77 15 q 38 15 68 44 m -1065 921 q 92 54 145 144 l 759 -759 l -144 -145 m -890 1032 l 190 -69 q -43 -76 -119 -119 m 1052 -787 q 15 -15 23 -34 q 7 -18 7 -38 q 0 -21 -8 -40 q -8 -18 -22 -33 q -15 -14 -33 -22 q -19 -8 -40 -8 q -20 0 -38 7 q -19 8 -34 23 l -16 16 l 145 144 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesNone_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 128 v 128 h -128 m 1024 0 h -128 v -128 h 128 m -1024 1792 h 128 v 128 h -128 m 0 -1024 h 128 v 128 h -128 m 1920 -1024 v 128 h -128 v -128 m -448 768 q 119 0 224 45 q 105 46 183 124 q 78 78 124 183 q 45 105 45 224 q 0 119 -45 224 q -46 105 -124 183 q -78 78 -183 123 q -105 46 -224 46 q -119 0 -224 -46 q -105 -45 -183 -123 q -78 -78 -123 -183 q -46 -105 -46 -224 q 0 -119 46 -224 q 45 -105 123 -183 q 78 -78 183 -124 q 105 -45 224 -45 m -448 576 q 0 93 36 174 q 35 82 96 142 q 60 61 142 96 q 81 36 174 36 q 75 0 143 -24 q 68 -23 125 -65 l -627 -627 q -42 57 -65 125 q -24 68 -24 143 m 807 268 q 42 -57 66 -125 q 23 -68 23 -143 q 0 -93 -35 -175 q -36 -81 -96 -142 q -61 -60 -142 -96 q -82 -35 -175 -35 q -75 0 -143 23 q -68 24 -125 66 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 0 h 1920 v 1920 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 128 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1664 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesVertical_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 1920 v -1920 h 128 v 1920 m 1664 0 v -1920 h 128 v 1920 m -1024 0 v -1920 h 128 v 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1856 0 v 1920 h -1792 v -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1152 1792 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1152 -896 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 896 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 0 1920 v -1920 h 128 v 1920 m 1664 0 v -1920 h 128 v 1920 m -1024 0 v -1920 h 128 v 1920 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesHorizontal_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -128 h 1920 m 0 -1664 h -1920 v -128 h 1920 m 0 1024 h -1920 v -128 h 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 64 h 1920 v 1792 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 0 1536 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -896 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1920 h -1920 v -128 h 1920 m 0 -1664 h -1920 v -128 h 1920 m 0 1024 h -1920 v -128 h 1920 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessGridlinesBoth_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -1920 h 1920 m -896 128 v 768 h 768 v -768 m -1664 768 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 0 v -768 h -768 v 768 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 0 v 1920 h -1920 v -1920 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1920 h -1920 v -1920 h 1920 m -896 128 v 768 h 768 v -768 m -1664 768 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 0 v -768 h -768 v 768 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TopBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 128 1024 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 0 -768 h -1920 v -128 h 1920 m -1792 1920 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 64 h 1920 v 1856 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 0 128 v -128 h 1920 v 128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"TopAndThickBottomBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 128 1024 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 0 -768 h -1920 v -128 h 1920 m 0 1920 h -1920 v -256 h 1920 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1792 h -1920 v -1728 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m -1792 -896 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 896 -896 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 382 h -128 v -126 h 128 m 0 384 h -128 v -126 h 128 m 0 382 h -128 v -128 h 128 m 512 -256 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 m -384 0 v -128 h 128 v 128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1664 v 256 h -1920 v -256 m 1920 -1664 v 128 h -1920 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BottomBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 v -128 h 1920 m -1792 -768 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m -1792 -768 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 m 896 128 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1920 1856 h -1920 v -1856 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m -256 128 h -128 v -128 h 128 m 1792 256 v 128 h -128 v -128 m 0 256 h 128 v 128 h -128 m 128 256 h -128 v -128 h 128 m -128 256 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m -1792 -1408 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 128 256 h -128 v -128 h 128 m -128 256 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 1024 -1280 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m -128 256 h 128 v 126 h -128 m 0 132 h 128 v 126 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 640 -768 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -128 0 h -128 v -128 h 128 m -384 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 1792 v 128 h -1920 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BoxBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -1664 v 1664 h 1664 m -768 -768 h -128 v -128 h 128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 384 h -128 v -128 h 128 m 0 384 h -128 v -128 h 128 m 0 382 h -128 v -126 h 128 m -128 258 h 128 v 126 h -128 m 0 128 h 128 v 128 h -128 m 0 128 h 128 v 128 h -128 m 768 -768 v 128 h -128 v -128 m -256 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 m -128 0 h -128 v -128 h 128 m -384 0 h 128 v 128 h -128 m -256 -128 h 128 v 128 h -128 z"},{type:"path",className:"OfficeIconColors_m2251",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 1792 v -1664 h -1664 v 1664 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"NoBorder_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 128 v 128 h -128 m 1024 0 h -128 v -128 h 128 m -1024 1792 h 128 v 128 h -128 m 0 -1024 h 128 v 128 h -128 m 1920 -1024 v 128 h -128 v -128 m -448 768 q 119 0 224 45 q 105 46 183 124 q 78 78 124 183 q 45 105 45 224 q 0 119 -45 224 q -46 105 -124 183 q -78 78 -183 123 q -105 46 -224 46 q -119 0 -224 -46 q -105 -45 -183 -123 q -78 -78 -123 -183 q -46 -105 -46 -224 q 0 -119 46 -224 q 45 -105 123 -183 q 78 -78 183 -124 q 105 -45 224 -45 m -448 576 q 0 93 36 174 q 35 82 96 142 q 60 61 142 96 q 81 36 174 36 q 75 0 143 -24 q 68 -23 125 -65 l -627 -627 q -42 57 -65 125 q -24 68 -24 143 m 807 268 q 42 -57 66 -125 q 23 -68 23 -143 q 0 -93 -35 -175 q -36 -81 -96 -142 q -61 -60 -142 -96 q -82 -35 -175 -35 q -75 0 -143 23 q -68 24 -125 66 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 0 0 h 1920 v 1920 h -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 128 128 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1664 1920 h -128 v -128 h 128 m 256 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m -1792 -256 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 1792 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -896 1152 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m 0 -382 h 128 v 126 h -128 m 0 -384 h 128 v 126 h -128 m 0 -382 h 128 v 128 h -128 m 0 -384 h 128 v 128 h -128 m -512 512 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 m 384 0 v 128 h -128 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"WebGetLink_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"},{type:"path",className:"OfficeIconColors_m233",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CreateCustomAction_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 69 -128 h 116 l -14 25 h 493 l -424 717 h 61 l 891 -921 h -530 l 363 -717 h -358 l -55 102 h -117 l 110 -205 h 587 l -363 717 m -1136 -409 h 410 v -410 h 128 v 410 h 409 v 128 h -409 v 409 h -128 v -409 h -410 z"},{type:"path",className:"OfficeIconColors_m212",d:"M 1620 870 l -990 1024 h -173 l 424 -716 h -488 l 41 -77 h 257 v -410 h 410 v -384 h -240 l 82 -153 h 472 l -363 716 z"},{type:"path",className:"OfficeIconColors_m211",d:"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 69 -128 h 116 l -14 25 h 493 l -424 717 h 61 l 891 -921 h -530 l 363 -717 h -358 l -55 102 h -117 l 110 -205 h 587 l -363 717 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 0 410 h 410 v -410 h 128 v 410 h 409 v 128 h -409 v 409 h -128 v -409 h -410 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"List_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1434 410 h -615 v -103 h 615 m 0 717 h -615 v -102 h 615 m 0 716 h -615 v -102 h 615 m -1332 -1434 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 1126 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 -717 h 512 v 512 h -512 m 103 -103 h 307 v -307 h -307 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 154 154 h 409 v 409 h -409 m 0 819 h 409 v 410 h -409 m 0 -1024 h 409 v 410 h -409 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1434 410 h -615 v -103 h 615 m 0 717 h -615 v -102 h 615 m 0 716 h -615 v -102 h 615 m -1332 -1434 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 1126 h 512 v 512 h -512 m 103 -102 h 307 v -307 h -307 m -103 -717 h 512 v 512 h -512 m 103 -103 h 307 v -307 h -307 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ChartStylesGallery_20",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -39 39 -85 83 q -46 44 -88 81 q 1 6 1 12 q 0 6 0 12 q 0 75 -39 138 q -39 64 -102 110 q -64 47 -145 74 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -24 q 57 -19 113 -57 q 55 -37 96 -100 q 24 -43 48 -81 q 24 -38 55 -66 q 31 -28 73 -44 q 41 -16 101 -16 q 38 -42 84 -91 q 45 -49 87 -91 q 20 -20 53 -54 q 32 -34 74 -77 q 42 -42 90 -90 q 48 -47 99 -94 q 51 -46 102 -89 q 51 -42 99 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 m -1104 1210 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 9 -45 29 q -22 21 -45 55 q -24 35 -53 87 q -45 68 -106 109 q -61 42 -125 65 q 56 16 114 25 q 58 10 109 15 m 417 -380 q 31 -29 67 -64 q 36 -35 65 -64 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -96 q 26 -44 37 -75 q -29 15 -86 59 q -57 44 -143 122 q -87 78 -202 192 q -116 114 -260 270 q 61 28 95 88 m -625 -644 h -410 v 757 l -102 -10 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1999 763 l -45 121 q -20 52 -61 118 q -41 66 -96 138 q -55 72 -118 145 q -63 73 -126 140 q -63 68 -121 125 q -59 58 -104 97 q -17 -62 -58 -103 q -41 -40 -102 -56 q 22 -25 50 -56 q 28 -30 59 -61 q 30 -31 60 -62 q 30 -30 55 -56 q 175 -178 297 -287 q 122 -109 194 -145 m -1627 853 v -804 h 512 v -716 h 512 v 409 h 512 v 66 q -68 39 -147 103 q -79 64 -170 149 q -92 86 -195 192 q -104 106 -219 229 q -72 9 -126 39 q -54 31 -93 72 q -40 41 -68 86 q -29 46 -51 85 l -6 11 q -24 33 -61 52 q -38 20 -77 29 q -39 10 -73 12 q -35 3 -52 3 q -13 0 -20 -1 q -8 0 -9 0 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 205 1669 v -850 h 512 v -717 h 614 v 410 h 512 v 89 q -24 11 -50 26 q -26 16 -52 34 v -47 h -410 v 409 q -24 26 -49 51 q -26 26 -53 53 v -922 h -410 v 1234 q -31 36 -55 75 q -24 39 -47 81 v -673 h -410 v 757 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2029 736 q 19 19 19 53 q 0 45 -29 108 q -30 64 -77 135 q -47 71 -104 145 q -58 74 -114 139 q -56 65 -103 116 q -48 52 -75 79 q -24 24 -50 50 q -27 26 -54 51 q -27 26 -53 49 q -26 24 -48 43 q -4 -62 -29 -111 q 16 -15 36 -34 q 20 -19 42 -40 q 22 -20 44 -41 q 21 -21 40 -40 q 45 -45 94 -99 q 48 -53 96 -110 q 48 -57 93 -114 q 44 -57 81 -109 q 37 -52 63 -97 q 26 -44 37 -74 q -29 15 -88 60 q -59 46 -148 127 q -90 82 -209 201 q -120 119 -271 281 q -49 -25 -110 -28 q 19 -22 43 -49 q 23 -26 49 -53 q 25 -27 51 -54 q 26 -27 50 -51 q 20 -20 53 -54 q 33 -34 75 -77 q 41 -42 90 -90 q 48 -47 99 -94 q 50 -46 102 -89 q 51 -42 98 -75 q 47 -32 89 -52 q 41 -19 72 -19 q 29 0 46 17 z"},{type:"path",className:"OfficeIconColors_m26",d:"M 921 1997 q -56 -5 -116 -16 q -60 -10 -116 -26 l -155 -43 l 151 -54 q 68 -24 119 -63 q 51 -39 86 -91 l 12 -21 q 24 -43 46 -77 q 21 -33 45 -56 q 23 -23 53 -36 q 29 -12 70 -12 q 94 0 146 52 q 52 52 52 146 q 0 38 -15 74 q -15 36 -41 69 q -27 33 -63 61 q -37 28 -80 48 q -43 21 -91 33 q -48 12 -98 12 z"},{type:"path",className:"OfficeIconColors_m25",d:"M 1116 1451 q 58 0 106 17 q 48 17 82 49 q 33 32 52 78 q 18 47 18 105 q 0 74 -39 137 q -39 64 -102 111 q -64 47 -145 73 q -81 27 -166 27 q -120 -11 -223 -37 q -44 -11 -88 -27 q -45 -15 -84 -36 q -39 -20 -70 -46 q -31 -26 -47 -59 q 5 1 12 1 q 6 1 14 1 q 7 0 18 0 q 34 0 86 -6 q 51 -5 108 -25 q 57 -19 113 -56 q 55 -37 97 -101 q 22 -40 46 -77 q 23 -37 52 -66 q 29 -28 68 -46 q 38 -17 92 -17 m -191 495 q 64 -1 127 -22 q 62 -21 111 -56 q 49 -34 79 -78 q 30 -43 30 -90 q 0 -41 -10 -69 q -11 -28 -30 -46 q -19 -17 -45 -25 q -27 -7 -60 -7 q -29 0 -51 8 q -23 8 -43 26 q -21 19 -41 48 q -21 30 -45 73 q -28 43 -57 75 q -30 32 -61 55 q -31 24 -63 40 q -32 16 -64 28 q 56 16 114 25 q 58 10 109 15 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Gear_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1024 640 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 m 0 640 q 53 0 100 -20 q 46 -20 81 -55 q 35 -35 55 -82 q 20 -46 20 -99 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 q 0 53 20 99 q 20 47 55 82 q 35 35 82 55 q 46 20 99 20 m 1024 -96 l -313 131 q -44 107 -119 198 l 34 337 l -282 152 l -263 -214 q -20 2 -40 3 q -21 1 -41 1 q -26 0 -51 -2 q -26 -2 -52 -6 l -270 207 l -277 -160 l 43 -337 q -64 -83 -104 -179 l -313 -131 v -320 l 313 -130 q 44 -107 119 -199 l -34 -337 l 282 -152 l 263 214 q 20 -2 41 -3 q 20 -1 40 -1 q 26 0 52 2 q 25 2 51 6 l 270 -207 l 277 160 l -43 337 q 64 84 104 180 l 313 130 m -427 405 l 17 -47 l 282 -119 v -158 l -282 -119 l -16 -47 q -17 -38 -38 -77 q -21 -38 -49 -73 l -32 -40 l 40 -307 l -137 -79 l -246 188 l -50 -7 q -42 -6 -86 -6 q -17 1 -34 1 q -17 0 -34 2 l -50 6 l -240 -195 l -139 75 l 31 307 l -32 39 q -61 74 -99 166 l -17 47 l -282 119 v 158 l 282 119 l 16 47 q 17 40 38 77 q 21 38 49 73 l 32 40 l -40 307 l 137 79 l 245 -188 l 51 7 q 42 6 86 6 q 35 0 68 -3 l 50 -5 l 240 194 l 138 -75 l -30 -307 l 32 -39 q 62 -75 99 -166 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1984 907 v 234 l -298 125 l -11 24 q -20 51 -47 95 q -28 45 -61 87 l -17 21 l 32 321 l -207 111 l -250 -204 l -27 3 q -18 2 -36 3 q -19 1 -38 1 q -24 0 -47 -2 q -24 -1 -47 -5 l -26 -4 l -258 197 l -203 -117 l 41 -321 l -16 -22 q -61 -77 -95 -164 l -11 -24 l -298 -125 v -234 l 298 -125 l 11 -24 q 20 -51 48 -96 q 27 -44 60 -86 l 17 -21 l -32 -321 l 207 -111 l 250 204 l 27 -3 q 18 -2 37 -3 q 18 -1 37 -1 q 24 1 48 2 q 23 1 46 5 l 26 4 l 258 -197 l 203 117 l -41 321 l 16 22 q 61 77 95 164 l 11 24 m -662 562 q 66 0 125 -25 q 58 -25 102 -69 q 43 -43 68 -102 q 25 -58 25 -124 q 0 -66 -25 -125 q -25 -58 -68 -102 q -44 -43 -102 -68 q -59 -25 -125 -25 q -66 0 -124 25 q -59 25 -102 68 q -44 44 -69 102 q -25 59 -25 125 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1024 640 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 m 0 640 q 53 0 100 -20 q 46 -20 81 -55 q 35 -35 55 -82 q 20 -46 20 -99 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 q 0 53 20 99 q 20 47 55 82 q 35 35 82 55 q 46 20 99 20 m 1024 -96 l -313 131 q -44 107 -119 198 l 34 337 l -282 152 l -263 -214 q -20 2 -40 3 q -21 1 -41 1 q -26 0 -51 -2 q -26 -2 -52 -6 l -270 207 l -277 -160 l 43 -337 q -64 -83 -104 -179 l -313 -131 v -320 l 313 -130 q 44 -107 119 -199 l -34 -337 l 282 -152 l 263 214 q 20 -2 41 -3 q 20 -1 40 -1 q 26 0 52 2 q 25 2 51 6 l 270 -207 l 277 160 l -43 337 q 64 84 104 180 l 313 130 m -427 405 l 17 -47 l 282 -119 v -158 l -282 -119 l -16 -47 q -17 -38 -38 -77 q -21 -38 -49 -73 l -32 -40 l 40 -307 l -137 -79 l -246 188 l -50 -7 q -42 -6 -86 -6 q -17 1 -34 1 q -17 0 -34 2 l -50 6 l -240 -195 l -139 75 l 31 307 l -32 39 q -61 74 -99 166 l -17 47 l -282 119 v 158 l 282 119 l 16 47 q 17 40 38 77 q 21 38 49 73 l 32 40 l -40 307 l 137 79 l 245 -188 l 51 7 q 42 6 86 6 q 35 0 68 -3 l 50 -5 l 240 194 l 138 -75 l -30 -307 l 32 -39 q 62 -75 99 -166 z"}],viewBox:"0,0,2048,2048"},{type:"png",id:"Copilot_80",base64String:"iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABeASURBVHgB7VxdjF3XVV5rn3tnxjOOPaakTdIEXxcaoFXJ5IEf04DHlahUHshEpVJURGwjiiIQSioVib7gMVLVF0qcFlQqHjxWgxrUBk8eKiGB6nFpQgWq6jwUqUCZm5akIW3iGzfxnbn3nL1Zv/ucO048d+yZvHS2fXz+/77zrbW+tfa+Bthtu2237bbdttt2227bbT+ODWEb2+Gn0wJAOkZXnaMLd1JKst1m2pL8tX8AIu30h5DjZH8aPXbDNap+CS8//QJc+sYPYfjyGh2DvLsXEC+0WmH5tacOn4U3qW0LgHP/NJzHIp1BwI5saICUGijothqJvNgAanQ52SMmAlp3lr0BPHf2P9Owtw5IN+QbyJwOCwFlQsSVooATvZXDXdjhdsMA/vyX1x4KAKeb25h5I6wDxQJtbryU2yffgHpefYJttjlPFYH3g7//L2DwdA+BRniFIqQQEoYQaAWTYFjg6kQrvu+Ff9xZEFtwA+0d5147OVyrFkc2vg7bGhhlkHw970+NdajBFg7bNV/5l+eJgQoes04Zx8wTEGW5IDtGmtP+Q/R6Z+jgo7CD7boZeMffXT5OD3nGLxCTX9A9GI4AaFs2mGpS28smWj/QRt8YXx1C77Fv5yOKQsw10bwBJM15u6ALMm+10tHu8i+uwA6162LgLWcudaph9cjG7Q6UsIneMxIqiCOwjbhA+ovJTJF2jH7MJmtpWvu3/+NDkrCNgBIACbyCmFeEhv9jUGXOx9F2QApssAI71K4LwKpM5ypIs+ah0LDQv0lBkUUnGdSxwbbrIp+fInsscZt6uu9FO5dmgwTr3+7JxyA/R6wDNAayyaaihajmKz4wszEFeaxjdLWHYYfalk149q9fPE4vcCYm8UMMAUalD1rQlBcXBiaHVc+lEwRgWZZJgLZgkYGVk/mgii5IGED5ncswfPpFMdlWCxU8ChytQphI/o+ZaYASuEnAk7AsINL1jnYfe88K7EDbMgNTqk6WJSp91M0ZCwGy8xNGJRSdIdQSNpFPihhHozPGRlCROR9bRREofA8GsfzvHzFAYq7q94iBDKT6QDNlOo+OiQVKaE5CQwWSLjQPO2TGWwJw32e+fzLF1GEaQeQPKxFS7dXILGYYfSUHEoKOlqIGjegbdb9ZASp7Y9R1onjkrVdKgB/0GTBiV0ISyuL/sgnzvGVsI1YmApNAS8BzdCbiEdihFrZ0dKyOM7X0JStGhDcSggxPhbzu2wTaWLEh8x9CQ5c13jLCcg6ArfP1+BqCHC0Tl2SKL/YtYDBwxMBCIzAHCjbn0AqJo0iiZZtombhOaEcC26b5zsOrs7ADbWwG3vTpVQIvdnjZImMyL+9sS4GA9KgqAGGWy6wtkh4bJS6r71PXieIYzVeyz5KPAHKX4fNXJDBopKUA4tHVWMgbIoFKoMlyKsxsCzdhdgshrVUVR+Ml2OY2NoAEz8mco1rwyAFAIIyqWKTpTsEFJVaABo8kqx6Xg7kARFPMdhxineMNnhtYlGUWEhTELAMPGazIQaNVqOkyiMFB1DmDGAN7jhab8RJscxsrCs9+ZnWeXvUr6tcZAWWRoYKYk62kbk+iih1Tg+bBRuKEA0qMyxHIABcvyW34vQj9r1ZQkJmy72u3OHjoMvk9FPMU89UpEkOhFQxYFOaB+kRm5aW9U9U7uouHerCNbSwGtsOVY8kiKmi8EJMzk5RjFCTPHpxtYCmrm3rSAoAlbxp7UH0o1h8ATTWuP8dRN4DqPjVhE8sElkXabLrEQjFd1G1qxkRV+5QBD1yO7YfoJqdgG9umDOw88s3Ztal4Se1KQbGga+tRWeVEcsYZGDCyXDNTVbPJFSskqJt0NgP88IlpwH6AVpsm1n1tlCgMFhygXUDFkZfZKEwsZDn7wsJY6ZEZ8JU0ke7uffzWLmxT25yBM1cWJtzygoMYc3BAZxfmioCBaaC5L1RgsAmkJydi0gacZzPrL7QhvRZEMEt9wFI44a+BIldQJqbkphtMyjAjNTrrF+LEOOAs3eX87CcvHe19/EAXtqFtCmAIa/cW7EtStARh1CRHmGY0xI0gB9vvZqumayastZrg1+ND6HaXvztlFRfwHFeRFrPUcoxEWmWcmy9pGzdhkzbGRHmwwIzEgwT96k2femmJUr9TvY/eGJDXNOG5M+dm+zB1SUOlpxmjJmkma6LaQnPeBpBNUkK2RmpsXKfJWAArjpKM+e4Tt1PpaorNt9duFcsUdS8UE6lHZtsjAQglf3qaMwVKmeu2d04Vsx9stY7twzA3EUJHPnVAfyKde+ijW3ZiuLgvQa+GArtVjM/Sp1k5vHjTCmzSrsnAqogLbVhTO0uxAUh+6RHJYdEWG6bsCYY8NTFRIrhcz7WfnpvUMer1Bj9qw/pLkyyUH52ZnljsLt89VuT894+tnkzD9HAclrPM6WS2oMtBJHr24nmCudeSfjl7Ei9GnvznP3mlG6t46v1/eWAJrgfANg7vTfbd5BmEeQqGO3+oHwXrqqj6uzDCQNSgAZnNFpfMt1pVho+5/PwM7158+Su/cuplGK997Y/+4/za2vo82St/agIrSL5TgxegCaquS+4Iyb2HKAIVU1oLSh269JnlB186svA3bzkBWwWwFfrzUIOEnq6OyBKBQgMIFjWgSf2a1bfUNQpgeLX5ZxFuJZ0rL0wtXf7q4VMwLni/941HYn9wRBLEVNDVFKzKQIsyFcZABzRmgP2tLLPF0YKaqIbjj//uC8/c//lbTm+89xv6wHu+8Nl54sT5/K58LYnCVilgxgRlzIhcyRc1fSjmEBUcbJi/lw8J+WC1Q16v1gt46tEjh9a+Pl5fxr/ef75Thsn/EYAYNK75yHJhLKQpCivRj6EIkyp5mgD6eXXZXosXUVJ0C3RqKbG3Z7B+6L7lUSH+hgxstdeOuUXWmQaM+jw0887rIMUEAVBQySbf1IS1ksnpnl6flUbcE5fHBU8eiMproVzjUEu3oTSPQFIEKFQTcNy7RN4ceV0+pJozCtvoeFmXK7kpI7h5JdQCr5pPnO2HcBw2dKC9IYBtXJt3f2rgWBhOkAVwliGuYMyU8z64Kno3ZQ96wPFlLZM9CVto7eFgHoVZ/OEqqh9Svid+kNgs3lA6AoiZ7H+l2krHuU8UD69lkJxHWRbf8OHBTJnOODIWgAvnFjvrsN4ZNU0FK2MKmX3GyhF5oymeOz81Eqs7GKDWX8maGGphgSRTVmDM9q0PnZsbxOpgAV4D0lJ4mWVRod8QCi9UAEsBBjGIn6Qqm4AVmLM5E/cwDK5N6WNo7wDctfEZXp+Bxdp8W0EyEAwozTik0wPk1vwxk4sD1Afkm0d/DNF0GMwFNkWEoKoPGOy6tHjhzAc+14UxG32iIwFLLgBK7Vofs6RYVtRcAv+m5P1oD7FSwKNgw3TnvmR+EwDP9C2v0jtg03IY8kNjAVgUa/e2vICCKjnrl8+Mc1HscgSCmWw2ez5efHNMNcCuwmpA62i8NfMtYLig7Kr8u2hkD9ofU1l44LSRKomplGjPzCu05Mtfn6Ox4OS+UJ/Gi+n+Ph6RxwJwBgdzzOwAdTrbkCweHJogCJuwGYldvqD168iLJetwchbrPcBiIeW3KzBmW73/C51BVc37C1aq2ziX04+FLrOS+jyat4R5SbQfszFqJJaQkmQwg1PFjNiCibmvRr3zGgB+5MvH5wKuH8yByKKmOlQ1W0Rnkn6vYMGgLkXZNmyatvlPO9frEug+BnF18f1fughjtqoazgd5An6FCtTdFOILmZV6TzFZFNMVEwxSCyIGCoyVemUBUf2fshAtJ9J6b7Y0fuDepgDua5WdmCrM2UVD26F/BWaOVli00OE+zGVp/vrSE+fdnNgAFzzgYGY0XoAttBZW94pYppChtlbIC1fCwigyRgMZaz1NdyJoBGbfx9xHYRy/SbQMXtior+tFN4sn+k7w7KYATobBXdIdJoEec4RtgCi4GQisrbOMMXP39drXhca6RWPJ7xV/FNOO8SxsCcByvhJJUoj7EJ+XI69TO3I5BqQLm4AK0rGKJt091Ws6o5BVLeRxJynrDjqyuymAe4H8X0hNQKAGxOYhuSm7T4ORIAMujEGlCvf+WoBWfxjVeGqf2Pv937iwAmO279//2Xky21mV7Ro8NE3UwlslwLFuK5L1H/I90eSKpnoMJ1hsBVWL0EgLXEMkq3OA5ioXNwVwGgedpN8mS4DMHM3mEmSbjPwOkntn81R9mh8lyFOmzEJI9r2NwVLng7gl86VazbGYWCcUaE5ewJOeVImpDE6RBDjJjIKApm8VIPvCbL4c6WqlqrYBWOOoPpCOfGYMANc7YH7LzrfesyTFTYCGL9MDajniTBTD1GMKzMOsEP0ffikzCzOaLcqXOI+h4u8nPk+GEHFQYGiwEPmSrK6ooUNzYgVMQZbAoembgBUBs2LcGG9V0fD7F13YDMCpMNifovq2nFUos7wqlTMKzYUbfi9HVjd1gCxb6kqbeR1jLu+L4w+7ePXDn5irUtWRWwahjgQMNVBjHQRRdxyFteoiICbxeynY9wzZfJkuBTTrTZh9oA124vyle/cXP7C5CU/CwM2t9oEqO1weqbsNyUex1ccq6OI3NEhk/ziSJAHkyhwfceF9R7/VhTFbVbTmQ4zMJVChXEhZgP2ediIUmreScGZ20l7Zl0AzDulckccJqgPFR4t2SI3+RWgkI1ooQnxdiXUVgHtwWPuq/NJ1ghPMBMEGsWmwUCxFPtRRpE7dMOWharVWNH+KYRm20EKr/C3u2OBRIUXUao76vUKUVMiD6zyIaLFAsw9UCWP2E2QshbyVqUZL2pLIhFxUUCzTk2MBOAXDLn2rg5BTOBwtWYGZKmSfCI2UrBF09Mu5GzDhPJrq0cXLABdgzNZ/cLFTlfGo6V8ewcmuUEAM7A9DRFcfXPtLZjRa8q4sB+aHtuqLJHbZdjSZTCaqnTHmnqri9d3M1QwM6xfptM5o9BV2iRQJ7vzrIoPrae27AS88pFqmQO0KUOWNa6zuu977/PjZB8C8Jg1RewcsTTNSCfPIupNG2STDk4KWroRh4gudfV5M9Sdj+dCoF9moO9QqTXr2zscf6I4HIJYrdIkFMHPQvMJ0YdM0PX0DYxV6xLcAgQZs7T9z6qYvK3RcgS00bKV7mXU8iMsuLAO80OeqOXlcR0JhnASRFEzCNEDL6ZsWFKRPBqy0i7Wn9qzqjZ/zKgCLMp5tt8tFepD96qeg+V2wGQhypQJGzNYzlWZAUZ8XkglqC/Bh/GEW5+fmO1UcLBShDdJxjCpB5QWjyybaU7Ffo5KWxH2pTQtIlXYMWwcEm3Clvk+A2+ik6jfmNTrnLIwL4N1Hu73vPPXW0/SdFkMwPzZ6aWVUrNWSs8oZlwsHvr2u7ko1ifcRIx59y+FXuzBmu+W2t51sTdLJMap84SFXksLaqE0veaJVnchsMUaFIkZLZYNkqSkFU1jBhViq7SJlL61dNfDK2x//wxUYF0BuP/3eF089/7WfOERmcAwbyqih89i/uf6zgfhJRhCA9X0psDXAIZu1DNG4ODGxZxHGbE/9wj0nZ2anj3PYFZuS5EFCpVaW+XYMVlRbkPDOj8FyLKqpohb9OEtlwePFAzD50ijnZ6qYn8ZrqoQ37BO57Z6Xj1/6+sw36es9TJftuDqpA4MLTAAYLW+h13ZDFvSerouBnyp+OS4CrMNmbXV+frbXr86sDWBh3803iW4xime2Sc4h4EiWgeKooxdTCK4Q1Zn5GCgjsCVnGlBis5xvUsbcX4Br+2mEMdprTxcL7VY4giV1NIc0m02Z/ymnO1Dt6djglnx3qRcwkDJ6l1KgQfsifO+Os/DS/p6U79aoDFXynK+hyyVt6/dbs2uDarY/gCP9PiwQeLM4NQN33vNu6cvQ6gBqjh91XX4mwIUoKTMHCdIaKYIQk3Wgu3AfoWeuOgsV9Jq7BMYgrou3V1f6Bw4sL/ZuCMDNWjr3oTkowkP0NsegpCcZ0p2HhOCQnn7A6zLXbXk9gsz5WFlOabiesE/EXJMppf46IgEI+25/G9z2rp/SZFABZHapnmewom23ESTJljWshiTDsUV1SQ+W2WxOQGU0AuQiHDTV2fK+z//pfdd69xv6rZw3vO+LrOVOpCd++xli1yNS6lXZrzS0LMSzt0bI88nqHzLYMtXCSNmx//b9ar6NPj79LRjqUH1hu3aEoMwBvIImLjmgAVYpQhhSdnYaKBpzA5XvE+OmRY6tjdLfDMgPfuk0seqEAFhFVr4y4B7ywH07cAREz7ERTKvb+FWd2tMTsPet0wKgTC2KqAxmPSWeoKjsGLohL+tx1BGSt6V8fCtfiyYCtfA5HdfSCVolVjDcNM3cVgAFxN/5hyUy47PyMyMBMdkvGZIxBTZMtfRnAgmJMoApzdw8DfzCDpgEBQUTkUuCBBQ4mLSucweVQawUsFZeRgGLJjvWrk/ElvNBP0YrLh1YWtx0VNi2mPBVraTe+5geEBBlwEDSfh8JKIqUmGwONKJnGW+RbsmGGrKt7rvjJgVNfZVHYPFr+hMVz0TUS4iqkREcWnWReqr7w2CBI1lWnixRj2D6XutHoJWys+O86rYzUB7oD5YvwoA6YIb0hCWhVBoLK2eigSqmrb6IwUv1YQJkRSv7Du4VU3OzQ2OfTK3KWENI87Iyh9ftuMrYxcfRl2MWGhv1WpUeZ9uTbBdz7+75q8WVcd51RwCUVsVlYVuZ1OGXBqAzsAZPKcfVFGWh9A7xrr137BX2caml6bfcTGmfvHAK7P8cRPNnLfWJWIOP6Of7toZ/rMGWaXHc19w5ANeqJ0WiOIjqE7kKaiZt+yr+RRipGHr+qtKEgknLQO47OFO/aGgEjZb5t7bMDZAqBwxjKtagUyrZ1oCiYMlxqQYyZabSvtU9n/rkWObLbWd8ILf1qYtQ9F8hpu0nAB24JL7Q19ls6ZmrkkgnAJLQIN/OQPI0/fZJBSOozlM/p4VOT+lQf2sMOixVfaQcn9BGYqDJJLB+YPuJow3rruskYN3/8OmtvOaOMRAXl3swqFZI1qAwkE24BDRTRmdfIvAkESFwSgaPwK0IjD23TsHEbFBGsYmGhrkFM0fzhTnyjvpJaDBSuo+hjrj5/GSSh1lK+1anP/EXp7fynjvHQG4V5ZEV1/AYuKiRWKWN+MRkpssJSUm4lLxOePD8J39uWnyf/ucHIFUYqQFIYS9aloFJB1EYD7m4EhFzpLXoazWsJN3FlsopL7EhnFk3hz+HLbad84HcrgzPCgOHFokZRGGgmC4OyUcOiH3DIW0eEhMpnWM28m879r9zUnRd9mmm/7KjD+IXzQ9qAEhB/F5yNtaRmL6Y+USZ2sbeZkAJ8MyePzu9BFtsOwognl7pEWAXc37M4FmezEANS60j8HzATKyUfXt/ZgpaM8kAS7UcoSk0nL9G4godPA4UyaNtEJnD5zfMvKrNfCQaV70JDPddzzvurAlzK9MyTXMm8JKYLflCAW2o07CsJ2birb8+remVjGmXTiGNwjqIQP9DAf7tv1S3glaeC+kx11EA1GuH1mNPekiGfuUuXvsZc6rL0FwF+yh+7HQXrqPtPIBX4FGS9cf5vwoguYKZcQ3gBmbCvLz/PZM4OVtoWYmfTkrIUctYwSKrdOhWmjUUMjpD/KD9ojQl78tRtHWQXtJefMg/VbHiW8JT7T/+3BJcZ9uWctZmbfDhX50jNM4PyzTLkmXADKzU9wmQ5Pt4DjMF/uwDB2ByNnjnLFgVx6otoGmcBYZc3kouVdDTN7D6IJiM0fJX0sEGNmSGZsXDEw/+7aNwA+1NAZBb//75Tn+9Ok8+rpN9H9cAS8QB+UacKeBOBm//BrdcF5kwa7rKI61Wn7WSo4aZZJSQR1+9gkdh/UWiXLNL559of2RpBW6wvWkAevvf3/y148MBHCMA7yImHgh7C9j/7km4+ZemoTWFr/eEqdGflTeCAZN/NWssTDE0zdN+4yMdSs9GDmgJzrZOPLal0RC7bbfttt2223bbbtttu223bWz/D8F4Mx2kB0G2AAAAAElFTkSuQmCC"}]}},5838:function(st,Le,C){"use strict";C.d(Le,{$:function(){return pt},z:function(){return ye()}}),C(90617),C(52601);var b=C(25834),S=C.n(b),K=C(59215),Z=C.n(K),we=C(51269),re=C.n(we),qe=C(53581),pe=C.n(qe),ze=C(76902),H=C.n(ze),Te=C(9382),Ce=C.n(Te),ie=C(59419),j=C.n(ie),k={};k.styleTagTransform=Ce(),k.setAttributes=pe(),k.insert=re().bind(null,"head"),k.domAPI=Z(),k.insertStyleElement=H(),S()(j(),k),j()&&j().locals&&j();var ge=C(3013),ye=C.n(ge),he="onObjectSprite",pt={name:he,sprite:window[he]}},3013:function(st){st.exports={PBIData_20:"PBIData_20",PBIFormat_20:"PBIFormat_20",AudioBookmark_20:"AudioBookmark_20",LaunchSelectionPane_20:"LaunchSelectionPane_20",PBIPerformanceAnalyzer_20:"PBIPerformanceAnalyzer_20",PBISyncSlicer_20:"PBISyncSlicer_20",PBIBuild_20:"PBIBuild_20",PBIAddToChart_20:"PBIAddToChart_20",PBIAnomalyExplain_20:"PBIAnomalyExplain_20",PBINewQuickMeasure_20:"PBINewQuickMeasure_20",PBIPageVisuals_20:"PBIPageVisuals_20",addchartplaceholder_20:"addchartplaceholder_20",Paste_20:"Paste_20",CustomFieldGraphicalIndicatorGreenPlus_20:"CustomFieldGraphicalIndicatorGreenPlus_20",powermap_newtour_20:"powermap_newtour_20",suggestLightningBolt_20:"suggestLightningBolt_20",GrowFont_20:"GrowFont_20",ShrinkFont_20:"ShrinkFont_20",Bold_20:"Bold_20",Italic_20:"Italic_20",Underline_20:"Underline_20",FillColorSplitDropdown_20:"FillColorSplitDropdown_20",FontColorNoPreview_20:"FontColorNoPreview_20",Centered_20:"Centered_20",RightAlign_20:"RightAlign_20",LeftAlign_20:"LeftAlign_20",WrapText_20:"WrapText_20",IncreaseDecimal_20:"IncreaseDecimal_20",DecreaseDecimal_20:"DecreaseDecimal_20",TableBorderColorSplitDropdown_24:"TableBorderColorSplitDropdown_24",FillColorSplitDropdown_24:"FillColorSplitDropdown_24",CommonControlChevronDown_12:"CommonControlChevronDown_12",GridCard_24:"GridCard_24",BorderDrawToolGrid_20:"BorderDrawToolGrid_20",AccessGridlinesNone_16:"AccessGridlinesNone_16",AccessGridlinesVertical_16:"AccessGridlinesVertical_16",AccessGridlinesHorizontal_16:"AccessGridlinesHorizontal_16",AccessGridlinesBoth_16:"AccessGridlinesBoth_16",TopBorder_16:"TopBorder_16",TopAndThickBottomBorder_16:"TopAndThickBottomBorder_16",BottomBorder_16:"BottomBorder_16",BoxBorder_16:"BoxBorder_16",NoBorder_16:"NoBorder_16",WebGetLink_16:"WebGetLink_16",CreateCustomAction_20:"CreateCustomAction_20",List_20:"List_20",ChartStylesGallery_20:"ChartStylesGallery_20",Gear_16:"Gear_16",Copilot_80:"Copilot_80"}},59419:function(st,Le,C){var x=C(51968),b=C(20806)(x);b.push([st.id,"",""]),st.exports=b}}]);