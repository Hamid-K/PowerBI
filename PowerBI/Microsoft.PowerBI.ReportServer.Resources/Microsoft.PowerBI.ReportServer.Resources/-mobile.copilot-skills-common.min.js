"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["copilot-skills-common"],{46333:function(w,E,t){t.d(E,{w:function(){return C}});var g=t(81337),e=t(50423),P=t(35510),M=t(18503),D=t(40713),O=t(81213),I=t(65181),h=t(2851),f=t(77476),x=t(98885),u=t(46101),S=t(91781),y=t(74913),V=t(55490),T=t(59968),l=t(85102),A=["visualHostContainer"];function B(o,n){if(1&o&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(i.title)}}function U(o,n){if(1&o&&e.\u0275\u0275element(0,"tri-svg-icon",10),2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("triTooltip",i.componentConfig.titleTooltip)}}function L(o,n){1&o&&e.\u0275\u0275element(0,"tri-spinner",14),2&o&&e.\u0275\u0275property("delay",0)}function R(o,n){if(1&o&&e.\u0275\u0275element(0,"single-visual-host",15),2&o){var i=e.\u0275\u0275nextContext().ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("visual",a.visualContainer)("config",a.singleVisualHostConfig)("themeCollection",a.theme.themeCollection)("visualViewport",i)("useOnPushChangeDetection",!0)}}function z(o,n){if(1&o){var i=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"canvas-visual-error-overlay",16),e.\u0275\u0275listener("showErrorDetails",function(){e.\u0275\u0275restoreView(i);var b=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(b.showErrorDetails())}),e.\u0275\u0275elementEnd()}if(2&o){var a=e.\u0275\u0275nextContext().ngIf,d=e.\u0275\u0275nextContext();e.\u0275\u0275property("errorInfo",d.error)("viewport",a)}}function W(o,n){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,L,1,1,"tri-spinner",11),e.\u0275\u0275template(2,R,1,5,"single-visual-host",12),e.\u0275\u0275template(3,z,1,2,"canvas-visual-error-overlay",13),e.\u0275\u0275elementContainerEnd()),2&o){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.loading),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.error&&i.singleVisualHostConfig),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.error&&!i.loading)}}function F(o,n){if(1&o){var i=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(i);var d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.onAddToPage.emit())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",18)(3,"span",19),e.\u0275\u0275elementEnd()}2&o&&e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(1,1,"Insights_ExploreAddToPage"))}function K(o,n){1&o&&e.\u0275\u0275element(0,"span",23)}var j=function(n){return{withText:n}};function m(o,n){if(1&o){var i=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",20),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(i);var H=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(H.onExpand.emit())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",21),e.\u0275\u0275template(3,K,1,0,"span",22),e.\u0275\u0275elementEnd()}if(2&o){var a=e.\u0275\u0275nextContext();e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(1,3,"ExpandView"))("ngClass",e.\u0275\u0275pureFunction1(5,j,!a.componentConfig.supportsAddToPage)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!a.componentConfig.supportsAddToPage)}}function r(o,n){if(1&o){var i=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(i);var d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.onExplore.emit())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",24)(3,"span",25),e.\u0275\u0275elementEnd()}2&o&&e.\u0275\u0275property("triTooltip",e.\u0275\u0275pipeBind1(1,1,"Explore_This_Visual"))}var s=function(n){return{height:n}},c=function(n){return{"background-color":n}},p=function(n,i,a){return{color:n,fill:i,"justify-content":a}},v=function(n){return{alignRight:n}},C=function(){function o(n,i,a,d){this.changeDetectionRef=n,this.errorService=i,this.localizationService=a,this.singleVisualHostConfigBuilder=d,this.onAddToPage=new e.EventEmitter,this.onExpand=new e.EventEmitter,this.onExplore=new e.EventEmitter,this.viewport$=new P.X(void 0),this.loading=!0}return o.prototype.ngOnInit=function(){return(0,g.mG)(this,void 0,void 0,function(){var n,i=this;return(0,g.Jh)(this,function(a){switch(a.label){case 0:return[4,this.singleVisualHostConfigBuilder.getSingleVisualHostConfig(this.visualContainer)];case 1:return(n=a.sent()).notifyEnd=function(){return i.handleDoneLoading()},n.handleQueryErrors=function(d){return i.handleQueryErrors(d)},this.singleVisualHostConfig=n,this.changeDetectionRef.markForCheck(),[2]}})})},o.prototype.ngAfterViewInit=function(){var n=this;setTimeout(function(){n.viewport$.next({width:n.visualHostContainerElement.nativeElement.clientWidth,height:n.visualHostContainerElement.nativeElement.clientHeight,scale:1})})},o.prototype.ngOnChanges=function(n){this.changeDetectionRef.detectChanges()},o.prototype.showErrorDetails=function(){(0,D.aZ)(this.error,this.errorService,this.localizationService)},o.prototype.handleDoneLoading=function(){this.loading=!1,this.changeDetectionRef.markForCheck()},o.prototype.handleQueryErrors=function(n){if(!n.ignorable){var i=n.getDetails(this.localizationService),a=(0,M.fe)(n.code);this.error={details:i,code:n.code,fixableError:0,hideSeeDetails:(0,M.O6)(n.code),overlayType:a,requestId:n.requestId,source:i?.source||n.source||"PowerBI"},this.changeDetectionRef.markForCheck()}},o.\u0275fac=function(i){return new(i||o)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(O.T),e.\u0275\u0275directiveInject(I.o),e.\u0275\u0275directiveInject(h.k))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["copilot-visual-common"]],viewQuery:function(i,a){var d;(1&i&&e.\u0275\u0275viewQuery(A,5,e.ElementRef),2&i)&&(e.\u0275\u0275queryRefresh(d=e.\u0275\u0275loadQuery())&&(a.visualHostContainerElement=d.first))},inputs:{title:"title",theme:"theme",visualContainer:"visualContainer",componentConfig:"componentConfig",height:"height"},outputs:{onAddToPage:"onAddToPage",onExpand:"onExpand",onExplore:"onExplore"},features:[e.\u0275\u0275NgOnChangesFeature],decls:13,vars:23,consts:[[1,"copilotVisualCommon",3,"ngStyle"],[1,"visualHostAndTitleContainer",3,"ngStyle"],[1,"visualTitle",3,"ngStyle","triTooltip"],[4,"ngIf"],["name","info_20_regular",3,"triTooltip",4,"ngIf"],[1,"visualHostContainer"],["visualHostContainer",""],[1,"actionBar",3,"ngClass"],["tri-button","","size","small","class","pbi-fluent-button",3,"triTooltip","click",4,"ngIf"],["tri-button","","size","small","class","expandButton pbi-fluent-button",3,"triTooltip","ngClass","click",4,"ngIf"],["name","info_20_regular",3,"triTooltip"],["size","small",3,"delay",4,"ngIf"],[3,"visual","config","themeCollection","visualViewport","useOnPushChangeDetection",4,"ngIf"],[3,"errorInfo","viewport","showErrorDetails",4,"ngIf"],["size","small",3,"delay"],[3,"visual","config","themeCollection","visualViewport","useOnPushChangeDetection"],[3,"errorInfo","viewport","showErrorDetails"],["tri-button","","size","small",1,"pbi-fluent-button",3,"triTooltip","click"],["name","add_16_regular"],["localize","Insights_ExploreAddToPage",1,"tri-font-12-r"],["tri-button","","size","small",1,"expandButton","pbi-fluent-button",3,"triTooltip","ngClass","click"],["name","expand_up_right_16_regular"],["class","tri-font-12-r","localize","ExpandView",4,"ngIf"],["localize","ExpandView",1,"tri-font-12-r"],["sprite","trident-icons","name","binoculars_20_regular"],["localize","Explore_This_Visual",1,"tri-font-12-r"]],template:function(i,a){1&i&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"section",2),e.\u0275\u0275template(3,B,2,1,"span",3),e.\u0275\u0275template(4,U,1,1,"tri-svg-icon",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"section",5,6),e.\u0275\u0275template(7,W,4,3,"ng-container",3),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"section",7),e.\u0275\u0275template(10,F,4,3,"button",8),e.\u0275\u0275template(11,m,4,7,"button",9),e.\u0275\u0275template(12,r,4,3,"button",8),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(13,s,a.height+"px")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(15,c,a.theme.background)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction3(17,p,a.theme.foreground,a.theme.foreground,a.title?"space-between":"flex-end"))("triTooltip",a.title),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.title),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.componentConfig.titleTooltip),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,11,a.viewport$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(21,v,"right"===a.componentConfig.actionAlignment)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.componentConfig.supportsAddToPage),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.componentConfig.supportsExpand),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.componentConfig.supportsExplore))},dependencies:[f.NgClass,f.NgIf,f.NgStyle,x.f,u.v,S.O,y.M,V.Z,T.X,f.AsyncPipe,l.F],styles:['.copilotVisualCommon[_ngcontent-%COMP%]{display:flex;flex-direction:column}.copilotVisualCommon[_ngcontent-%COMP%]   .visualHostAndTitleContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:solid 1px var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);padding:var(--spacingVerticalS) var(--spacingHorizontalS);margin:0 0 var(--spacingVerticalM) 0;box-sizing:border-box;width:100%;flex:1}.copilotVisualCommon[_ngcontent-%COMP%]   .visualHostAndTitleContainer[_ngcontent-%COMP%]   .visualTitle[_ngcontent-%COMP%]{width:100%;display:flex;gap:8px}.copilotVisualCommon[_ngcontent-%COMP%]   .visualHostAndTitleContainer[_ngcontent-%COMP%]   .visualTitle[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600);flex:1}.copilotVisualCommon[_ngcontent-%COMP%]   .visualHostAndTitleContainer[_ngcontent-%COMP%]   .visualHostContainer[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden}.copilotVisualCommon[_ngcontent-%COMP%]   .visualHostAndTitleContainer[_ngcontent-%COMP%]   .visualHostContainer[_ngcontent-%COMP%]   tri-spinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%}.copilotVisualCommon[_ngcontent-%COMP%]   .visualHostAndTitleContainer[_ngcontent-%COMP%]   .visualHostContainer[_ngcontent-%COMP%]   single-visual-host[_ngcontent-%COMP%]{flex:1;display:block}.copilotVisualCommon[_ngcontent-%COMP%]   .actionBar[_ngcontent-%COMP%]{display:flex;gap:8px}.copilotVisualCommon[_ngcontent-%COMP%]   .actionBar.alignRight[_ngcontent-%COMP%]{justify-content:right}.copilotVisualCommon[_ngcontent-%COMP%]   .actionBar[_ngcontent-%COMP%]   .expandButton[_ngcontent-%COMP%]:not(.withText){padding:2px}']}),o}()},13531:function(w,E,t){t.r(E),t.d(E,{CopilotSkillsCommonModule:function(){return m}});var g=t(77476),e=t(76966),P=t(32288),M=t(33783),D=t(17177),O=t(8816),I=t(95859),h=t(81337),f=t(35510),x=t(66205),u=t(88940),S=t(14463),y=t(67489),V=t(4954),T=t(2851),l=t(50423),A=t(83008),B=t(40823),U=t(3404),L=t(52121),R=t(67660),z=t(96777),W=t(46333);function F(r,s){if(1&r){var c=l.\u0275\u0275getCurrentView();l.\u0275\u0275elementStart(0,"copilot-visual-common",2),l.\u0275\u0275listener("onAddToPage",function(){l.\u0275\u0275restoreView(c);var C=l.\u0275\u0275nextContext();return l.\u0275\u0275resetView(C.addToPage())}),l.\u0275\u0275pipe(1,"async"),l.\u0275\u0275elementEnd()}if(2&r){var p=l.\u0275\u0275nextContext();l.\u0275\u0275property("title",p.title)("theme",l.\u0275\u0275pipeBind1(1,5,p.theme$))("visualContainer",p.visualContainer)("height",456)("componentConfig",p.visualComponentConfig)}}var K=function(){function r(s,c,p,v,C,o,n){this.dataSourcesService=s,this.dataSourceSerializer=c,this.explorationSerializer=p,this.resourceLoader=v,this.templateDialogPayload=C,this.themeService=o,this.promiseFactory=n}return r.prototype.ngOnInit=function(){var s=this.templateDialogPayload.input;this.title=s.visualTitle,this.visualContainer=this.explorationSerializer.deserializeCanvasItem(s.visualContainer),this.visualComponentConfig={supportsAddToPage:s.supportsAddToPage,supportsExpand:!1,actionAlignment:"right",supportsExplore:!1};var c=this.dataSourceSerializer.deserializeDataSources(s.dataSources);this.dataSourcesService.set(c),V.P.loadThemeAndBaseTheme(this.promiseFactory,this.resourceLoader,this.themeService,s.resourcePackages,s.theme.themeCollection),this.theme$=new f.X(s.theme)},r.prototype.addToPage=function(){this.templateDialogPayload.closeDialogFromConsumer({closedWithAddAction:!0})},r.\u0275fac=function(c){return new(c||r)(l.\u0275\u0275directiveInject(A.D),l.\u0275\u0275directiveInject(B._),l.\u0275\u0275directiveInject(U.L),l.\u0275\u0275directiveInject(L.l6),l.\u0275\u0275directiveInject(y.x),l.\u0275\u0275directiveInject(R.f),l.\u0275\u0275directiveInject(S.t))},r.\u0275cmp=l.\u0275\u0275defineComponent({type:r,selectors:[["copilot-visual-dialog"]],features:[l.\u0275\u0275ProvidersFeature((0,h.ev)((0,h.ev)((0,h.ev)([],x.K,!0),u.H,!0),[T.k,y.x],!1))],decls:3,vars:3,consts:[[2,"height","auto"],[3,"title","theme","visualContainer","height","componentConfig","onAddToPage",4,"ngIf"],[3,"title","theme","visualContainer","height","componentConfig","onAddToPage"]],template:function(c,p){1&c&&(l.\u0275\u0275elementStart(0,"template-dialog",0),l.\u0275\u0275template(1,F,2,7,"copilot-visual-common",1),l.\u0275\u0275pipe(2,"async"),l.\u0275\u0275elementEnd()),2&c&&(l.\u0275\u0275advance(1),l.\u0275\u0275property("ngIf",p.visualContainer&&l.\u0275\u0275pipeBind1(2,1,p.theme$)))},dependencies:[g.NgIf,z.J,W.w,g.AsyncPipe],encapsulation:2}),r}(),j=t(35889),m=function(){function r(){}return r.\u0275fac=function(c){return new(c||r)},r.\u0275mod=l.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=l.\u0275\u0275defineInjector({providers:[T.k],imports:[g.CommonModule,e.c.withManifest([{componentIdentifier:j.Tx,componentType:K}]),P.J,M.F,D.T6,O.w,I.v]}),r}()},2851:function(w,E,t){t.d(E,{k:function(){return j}});var g=t(81337),e=t(47245),P=t(40713),M=t(2142),D=t(11077),O=t(33567),I=t(39681),h=t(14463),f=t(8590),x=t(80318),u=t(50423),S=t(26898),y=t(83008),V=t(11494),T=t(79006),l=t(40956),A=t(58991),B=t(65181),U=t(2330),L=t(906),R=t(84281),z=t(27980),W=t(29866),F=t(80277),K=t(1599),j=function(){function m(r,s,c,p,v,C,o,n,i,a,d,H,b,Q,N,G,J){this.conceptualSchemaProxy=r,this.dataSources=s,this.eventBridge=c,this.expandCollapse=p,this.geocoder=v,this.geolocationService=C,this.localizationService=o,this.moduleLoader=n,this.sortService=i,this.undoRedoService=a,this.visualAuthoringOpService=d,this.visualPlugin=H,this.azureMapTokenCache=b,this.azureMapsEndpoint=Q,this.geocoderIndexedDB=N,this.promiseFactory=G,this.visualHostTooltipServiceFactory=J}return m.prototype.getSingleVisualHostConfig=function(r){return(0,g.mG)(this,void 0,void 0,function(){var s,c,p,v=this;return(0,g.Jh)(this,function(C){switch(C.label){case 0:return s=_.find(this.dataSources.get(),function(o){return o.type===M.nKy}),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return c=C.sent(),p=s&&c&&c.schema(s.name).capabilities,[2,{notifyStart:_.noop,notifyEnd:_.noop,clearQueryErrors:_.noop,handleQueryErrors:_.noop,handleQueryWarnings:_.noop,queryVisualHostServices:{getFilters:function(){return v.createVisualContainerFilters(r)},getDataSourceVariables:function(){},disableAnchorTime:!0},visualHostServices:(0,I.ED)((0,e.q)({geocoder:this.geocoder,geolocation:this.geolocationService,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.createFromVisualContract(r),getAzureMapToken:function(){return v.azureMapTokenCache.getAzureMapToken()},azureMapsEndpoint:this.azureMapsEndpoint,geocoderIndexedDB:this.geocoderIndexedDB}),function(o){o.getLocalizedString=function(n){return v.localizationService.get(n)},o.onCustomSort=function(n){return v.onCustomSort(r,n.sortDescriptors)},o.canExpandCollapse=function(n){var i;return null!==(i=p?.supportsInstanceFilters)&&void 0!==i&&i},o.setNodeExpansionState=function(n){n.isCollapse?v.expandCollapse.collapseNode(r,n.dataRoles,n.data):v.expandCollapse.expandNode(r,n.dataRoles,n.data),v.eventBridge.publishToChannel(f.jCS,{affectContainer:function(a){return a.name===r.name}})}}),interactivityOptions:{selection:!0},additionalObjectUpdates:void 0,disableQueryCacheUpdates:!1,noLoadMore:!1}]}})})},m.prototype.createVisualContainerFilters=function(r){var s=new D.ME;_.forEach(r.filters,function(p){var v=p.filter;v&&s.addVisualFilter({filter:v})});var c=s.getFilters(!1);return{dataFilter:c.dataFilter,dataFiltersUnmerged:c.dataFiltersUnmerged,highlightFilter:void 0,highlightFiltersUnmerged:void 0}},m.prototype.onCustomSort=function(r,s){return(0,g.mG)(this,void 0,void 0,function(){var c;return(0,g.Jh)(this,function(p){switch(p.label){case 0:return[4,(0,P.Vq)(r,this.conceptualSchemaProxy,this.dataSources,this.sortService,this.undoRedoService,this.visualAuthoringOpService,this.visualPlugin)];case 1:return c=p.sent(),(0,P.fI)(r,c,s),[2]}})})},m.\u0275fac=function(s){return new(s||m)(u.\u0275\u0275inject(S.i),u.\u0275\u0275inject(y.D),u.\u0275\u0275inject(V.J),u.\u0275\u0275inject(T.v),u.\u0275\u0275inject(l.i),u.\u0275\u0275inject(O._1),u.\u0275\u0275inject(B.o),u.\u0275\u0275inject(U.m),u.\u0275\u0275inject(L.K),u.\u0275\u0275inject(R.z),u.\u0275\u0275inject(z.Q),u.\u0275\u0275inject(W.D),u.\u0275\u0275inject(F.o),u.\u0275\u0275inject(A.A),u.\u0275\u0275inject(K.W),u.\u0275\u0275inject(h.t),u.\u0275\u0275inject(x.A))},m.\u0275prov=u.\u0275\u0275defineInjectable({token:m,factory:m.\u0275fac}),m}()}}]);