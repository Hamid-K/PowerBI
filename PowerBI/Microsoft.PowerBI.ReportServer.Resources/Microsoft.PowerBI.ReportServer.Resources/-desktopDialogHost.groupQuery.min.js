"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["groupQuery"],{3942:function(b,f,e){e.r(f),e.d(f,{GroupQueryModule:function(){return M}});var l=e(81337),x=e(38823),C=e(26898),F=e(94717),G=e(88565),m=e(45114),w=e(98306),p=e(98330),h=e(47508),g=e(62458),Q=e(95462),P=e(14463),D=e(29866),E={provide:"groupQueryService",useFactory:function(r,a,s,n,i,t){return new V(r,a,s,n,i,t)},deps:[x.U,F.r,C.i,G.S,P.t,D.D]},V=function(){function r(a,s,n,i,t,o){this.singleExecutableDataProxyFactory=a,this.filterGenerator=s,this.conceptualSchemaProxy=n,this.visualQueryGenerator=i,this.promiseFactory=t,this.visualPluginService=o,this.reset()}return r.prototype.getValuesForColumn=function(a,s,n){return(0,l.__awaiter)(this,void 0,void 0,function(){var i,t,o,v;return(0,l.__generator)(this,function(u){switch(u.label){case 0:g.fF.assertValue(a,"expr"),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this.conceptualSchemaProxy.get(s)];case 2:return i=u.sent(),(t=new m.g(Q.vQ.create(),{},[])).add(a,"Values"),[4,this.runQueryImpl({dataSources:s,schema:i,config:{visualType:h.L.table.name,query:t},hostServices:(0,p.E)(),visualQueryGenerator:this.visualQueryGenerator,executionType:n?1:0,preferCurrentData:!n,allowResultFromClientCache:!1,isInitialLoad:!n})];case 3:return o=u.sent(),this.lastResult=o?{table:o.dataReaderResult.dataView.table,canLoadMore:this.dataProxy.canLoadMore()}:this.lastResult,[3,5];case 4:throw v=u.sent(),new Error(v.errorCode);case 5:return[2,this.lastResult]}})})},r.prototype.getAggregatesForColumn=function(a,s){return(0,l.__awaiter)(this,void 0,void 0,function(){var n,i,t,o,v,u,d,y,S;return(0,l.__generator)(this,function(c){switch(c.label){case 0:g.fF.assertValue(a,"expr"),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.conceptualSchemaProxy.get(s)];case 2:return i=c.sent(),t=new m.g(Q.vQ.create(),{},[]),g.fF.assert(function(){return 1===h.L.multiRowCard.capabilities.dataRoles.length},"Expecting MultiRowCard.capabilities has only 1 data role."),t.add(a,o=h.L.multiRowCard.capabilities.dataRoles[0].name),t.setAggregate(o,0,3),t.add(a,o),t.setAggregate(o,1,4),t.add(a,o),t.setAggregate(o,2,5),[4,this.runQueryImpl({dataSources:s,schema:i,config:{visualType:h.L.multiRowCard.name,query:t},hostServices:(0,p.E)(),visualQueryGenerator:this.visualQueryGenerator,executionType:0,preferCurrentData:!1,allowResultFromClientCache:!1})];case 3:return v=c.sent(),(d=(u=v.dataReaderResult.dataView.table)&&u.rows)&&d.length>0&&(n=(y=d[0])?{min:{formatString:u.columns[0].format,value:y[0]},max:{formatString:u.columns[1].format,value:y[1]},count:y[2]}:void 0),[3,5];case 4:throw S=c.sent(),new Error(S.clientError);case 5:return[2,n]}})})},r.prototype.reset=function(){this.conceptualSchemaProxy.clearCache(),this.dataProxy=(0,w.nW)(this.singleExecutableDataProxyFactory.create(),this.filterGenerator,this.promiseFactory,this.visualPluginService)},r.prototype.runQueryImpl=function(a){return(0,l.__awaiter)(this,void 0,void 0,function(){return(0,l.__generator)(this,function(s){switch(s.label){case 0:return[4,this.dataProxy.runQuery(a)];case 1:return[2,s.sent()]}})})},r}(),R=e(50423),M=function(){function r(){}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=R.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=R.\u0275\u0275defineInjector({providers:[E]}),r}()}}]);