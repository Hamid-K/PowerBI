(self.webpackChunkdesktopDaxQueryView=self.webpackChunkdesktopDaxQueryView||[]).push([["shapeMap"],{43174:function(te,_t,K){var Nt,Xt;!function(){var ne={version:"1.6.19",mesh:function(P){return Ut(P,Ht.apply(this,arguments))},meshArcs:Ht,merge:function(P){return Ut(P,tn.apply(this,arguments))},mergeArcs:tn,feature:function(L,P){return"GeometryCollection"===P.type?{type:"FeatureCollection",features:P.geometries.map(function(z){return Sn(L,z)})}:Sn(L,P)},neighbors:function(L){var P={},z=L.map(function(){return[]});function b(T,Q){T.forEach(function(vt){vt<0&&(vt=~vt);var ct=P[vt];ct?ct.push(Q):P[vt]=[Q]})}function O(T,Q){T.forEach(function(vt){b(vt,Q)})}var x={LineString:b,MultiLineString:O,Polygon:O,MultiPolygon:function(Q,vt){Q.forEach(function(ct){O(ct,vt)})}};for(var A in L.forEach(function H(T,Q){"GeometryCollection"===T.type?T.geometries.forEach(function(vt){H(vt,Q)}):T.type in x&&x[T.type](T.arcs,Q)}),P)for(var X=P[A],C=X.length,F=0;F<C;++F)for(var R=F+1;R<C;++R){var V,D=X[F],m=X[R];(V=z[D])[A=nn(V,m)]!==m&&V.splice(A,0,m),(V=z[m])[A=nn(V,D)]!==D&&V.splice(A,0,D)}return z},presimplify:function(L,P){var z=wn(L.transform),b=function(L){if(!L)return it;var P,z,b=L.scale[0],O=L.scale[1],H=L.translate[0],x=L.translate[1];return function(A,X){X||(P=z=0);var C=(A[0]-H)/b|0,F=(A[1]-x)/O|0;A[0]=C-P,A[1]=F-z,P=C,z=F}}(L.transform),O=function(){var L={},P=[],z=0;function b(H,x){for(;x>0;){var A=(x+1>>1)-1,X=P[A];if(E(H,X)>=0)break;P[X._=x]=X,P[H._=x=A]=H}}function O(H,x){for(;;){var A=x+1<<1,X=A-1,C=x,F=P[C];if(X<z&&E(P[X],F)<0&&(F=P[C=X]),A<z&&E(P[A],F)<0&&(F=P[C=A]),C===x)break;P[F._=x]=F,P[H._=x=C]=H}}return L.push=function(H){return b(P[H._=z]=H,z++),z},L.pop=function(){if(!(z<=0)){var x,H=P[0];return--z>0&&O(P[(x=P[z])._=0]=x,0),H}},L.remove=function(H){var A,x=H._;if(P[x]===H)return x!==--z&&(E(A=P[z],H)<0?b:O)(P[A._=x]=A,x),x},L}();function H(x){O.remove(x),x[1][2]=P(x),O.push(x)}return P||(P=ae),L.arcs.forEach(function(x){for(var C,D,A=[],X=0,F=0,R=x.length;F<R;++F)z(x[F]=[(D=x[F])[0],D[1],1/0],F);for(F=1,R=x.length-1;F<R;++F)(C=x.slice(F-1,F+2))[1][2]=P(C),A.push(C),O.push(C);for(F=0,R=A.length;F<R;++F)(C=A[F]).previous=A[F-1],C.next=A[F+1];for(;C=O.pop();){var m=C.previous,V=C.next;C[1][2]<X?C[1][2]=X:X=C[1][2],m&&(m.next=V,m[2]=C[2],H(m)),V&&(V.previous=m,V[0]=C[0],H(V))}x.forEach(b)}),L}};function Yt(L,P){var z={},b={},O={},H=[],x=-1;function X(C,F){for(var R in C){var D=C[R];delete F[D.start],delete D.start,delete D.end,D.forEach(function(m){z[m<0?~m:m]=1}),H.push(D)}}return P.forEach(function(C,F){var D,R=L.arcs[C<0?~C:C];R.length<3&&!R[1][0]&&!R[1][1]&&(D=P[++x],P[x]=C,P[F]=D)}),P.forEach(function(C){var m,V,F=function(C){var D,F=L.arcs[C<0?~C:C],R=F[0];return L.transform?(D=[0,0],F.forEach(function(m){D[0]+=m[0],D[1]+=m[1]})):D=F[F.length-1],C<0?[D,R]:[R,D]}(C),R=F[0],D=F[1];if(m=O[R])if(delete O[m.end],m.push(C),m.end=D,V=b[D]){delete b[V.start];var T=V===m?m:m.concat(V);b[T.start=m.start]=O[T.end=V.end]=T}else b[m.start]=O[m.end]=m;else if(m=b[D])if(delete b[m.start],m.unshift(C),m.start=R,V=O[R]){delete O[V.end];var Q=V===m?m:V.concat(m);b[Q.start=V.start]=O[Q.end=m.end]=Q}else b[m.start]=O[m.end]=m;else b[(m=[C]).start=R]=O[m.end=D]=m}),X(O,b),X(b,O),P.forEach(function(C){z[C<0?~C:C]||H.push([C])}),H}function Ht(L,P,z){var b=[];if(arguments.length>1){var C,O=function(V){var T=V<0?~V:V;(X[T]||(X[T]=[])).push({i:V,g:C})},H=function(V){V.forEach(O)},x=function(V){V.forEach(H)},X=[],F={LineString:H,MultiLineString:x,Polygon:x,MultiPolygon:function(V){V.forEach(x)}};(function m(V){"GeometryCollection"===V.type?V.geometries.forEach(m):V.type in F&&(C=V,F[V.type](V.arcs))})(P),X.forEach(arguments.length<3?function(m){b.push(m[0].i)}:function(m){z(m[0].g,m[m.length-1].g)&&b.push(m[0].i)})}else for(var R=0,D=L.arcs.length;R<D;++R)b.push(R);return{type:"MultiLineString",arcs:Yt(L,b)}}function tn(L,P){var z={},b=[],O=[];function H(A){A.forEach(function(X){X.forEach(function(C){(z[C=C<0?~C:C]||(z[C]=[])).push(A)})}),b.push(A)}function x(A){return function(L){for(var b,P=-1,z=L.length,O=L[z-1],H=0;++P<z;)H+=(b=O)[0]*(O=L[P])[1]-b[1]*O[0];return.5*H}(Ut(L,{type:"Polygon",arcs:[A]}).coordinates[0])>0}return P.forEach(function(A){"Polygon"===A.type?H(A.arcs):"MultiPolygon"===A.type&&A.arcs.forEach(H)}),b.forEach(function(A){if(!A._){var X=[],C=[A];for(A._=1,O.push(X);A=C.pop();)X.push(A),A.forEach(function(F){F.forEach(function(R){z[R<0?~R:R].forEach(function(D){D._||(D._=1,C.push(D))})})})}}),b.forEach(function(A){delete A._}),{type:"MultiPolygon",arcs:O.map(function(A){var X=[];if(A.forEach(function(D){D.forEach(function(m){m.forEach(function(V){z[V<0?~V:V].length<2&&X.push(V)})})}),X=Yt(L,X),(n=X.length)>1)for(var R,C=x(A[0][0]),F=0;F<n;++F)if(C===x(X[F])){R=X[0],X[0]=X[F],X[F]=R;break}return X})}}function Sn(L,P){var z={type:"Feature",id:P.id,properties:P.properties||{},geometry:Ut(L,P)};return null==P.id&&delete z.id,z}function Ut(L,P){var z=wn(L.transform),b=L.arcs;function O(R,D){D.length&&D.pop();for(var Q,m=b[R<0?~R:R],V=0,T=m.length;V<T;++V)D.push(Q=m[V].slice()),z(Q,V);R<0&&function(L,P){for(var z,b=L.length,O=b-P;O<--b;)z=L[O],L[O++]=L[b],L[b]=z}(D,T)}function H(R){return R=R.slice(),z(R,0),R}function x(R){for(var D=[],m=0,V=R.length;m<V;++m)O(R[m],D);return D.length<2&&D.push(D[0].slice()),D}function A(R){for(var D=x(R);D.length<4;)D.push(D[0].slice());return D}function X(R){return R.map(A)}var F={Point:function(D){return H(D.coordinates)},MultiPoint:function(D){return D.coordinates.map(H)},LineString:function(D){return x(D.arcs)},MultiLineString:function(D){return D.arcs.map(x)},Polygon:function(D){return X(D.arcs)},MultiPolygon:function(D){return D.arcs.map(X)}};return function C(R){var D=R.type;return"GeometryCollection"===D?{type:D,geometries:R.geometries.map(C)}:D in F?{type:D,coordinates:F[D](R)}:null}(P)}function nn(L,P){for(var z=0,b=L.length;z<b;){var O=z+b>>>1;L[O]<P?z=O+1:b=O}return z}function ae(L){var P=L[0],z=L[1],b=L[2];return Math.abs((P[0]-b[0])*(z[1]-P[1])-(P[0]-z[0])*(b[1]-P[1]))}function E(L,P){return L[1][2]-P[1][2]}function wn(L){if(!L)return it;var P,z,b=L.scale[0],O=L.scale[1],H=L.translate[0],x=L.translate[1];return function(A,X){X||(P=z=0),A[0]=(P+=A[0])*b+H,A[1]=(z+=A[1])*O+x}}function it(){}void 0!==(Xt="function"==typeof(Nt=ne)?Nt.call(_t,K,_t,te):Nt)&&(te.exports=Xt)}()},19145:function(te,_t,K){"use strict";K.r(_t),K.d(_t,{Matcher:function(){return yr},ShapeMap:function(){return zo},ShapeMapBehavior:function(){return Ro}});var Nt=K(22921),Xt=K(32554),ne=K(90120),Yt=K(60066),Ht=K(54522),tn=K(52083),ee=K(28579),Sn=K(51129),Ut=K(79811),ie=K(70569),nn=K(86727),re=K(77686),yn=K(72902),oe=K(40739),ae=K(11305),E=K(22091),pt=K(20792),wn=K(45296),ue=K(62458),it=K(56578),L=K(38958),P=K(82755),z=K(26543),b=K(52967),O=K(66232),H=K(30237),x=K(38400),A=K(59107),X=function(){function e(){}return e.prototype.onClick=function(t,i){var r=this.shapeMap.getDataPointFromShape(t);r?(0,H.c8)({identity:r.categoryIdentity,selected:r.selected},i):i.handleClearSelection()},e.prototype.bindEvents=function(t,i,r){var o=this;t.clearCatcher.on("click",function(){var a=d3.event;A.M.isCtrlOrMeta(a)||i.handleClearSelection(),o.shapeMap.zoomOnClick()}),this.shapes=t.shapes,this.shapes.on("click",function(a,u){o.onClick(a,i),o.shapeMap.zoomOnClick(a)}),this.shapes.on("focus",function(){var a=d3.event,s=d3.select(a.target),c=s.datum();if(c){var p=o.shapeMap.getDataPointFromShape(c);p&&s.attr("aria-label",(0,x.X)(p.tooltipInfo))}}),this.shapes.on("contextmenu",function(){var a=d3.event;if(!A.M.isCtrlOrMeta(a)){a.preventDefault(),(0,O.n)(a);var s=d3.select(a.target).datum();if(s){var c=o.shapeMap.getDataPointFromShape(s);if(c){var p=(0,H.bt)();i.handleContextMenu(c,p)}}}}),this.shapes.on("keydown.select",function(a){var s=d3.event.keyCode;(32===s||13===s)&&o.onClick(a,i)})},e.prototype.renderSelection=function(t){var i=this;this.shapes.attr("aria-selected",function(r){var o=i.shapeMap.getDataPointFromShape(r);return t&&o&&o.selected}).transition().duration(600).style("opacity",function(r){var o=i.shapeMap.getDataPointFromShape(r);return(0,Yt.eR)(o&&o.selected,!1,t,!1)})},e}();function C(){return new F}function F(){this.reset()}F.prototype={constructor:F,reset:function(){this.s=this.t=0},add:function(t){D(R,t,this.t),D(this,R.s,this.s),this.s?this.t+=R.t:this.s=R.t},valueOf:function(){return this.s}};var R=new F;function D(e,t,i){var r=e.s=t+i,o=r-t;e.t=t-(r-o)+(i-o)}var m=1e-6,V=1e-12,T=Math.PI,Q=T/2,vt=T/4,ct=2*T,lt=180/T,U=T/180,nt=Math.abs,en=Math.atan,Dt=Math.atan2,W=Math.cos,Ue=(Math,Math.exp),qe=(Math,Math.log),G=(Math,Math.sin),wr=Math.sign||function(e){return e>0?1:e<0?-1:0},dt=Math.sqrt,Ie=Math.tan;function Ke(e){return e>1?0:e<-1?T:Math.acos(e)}function Mt(e){return e>1?Q:e<-1?-Q:Math.asin(e)}function rt(){}function Mn(e,t){e&&Je.hasOwnProperty(e.type)&&Je[e.type](e,t)}var Qe={Feature:function(t,i){Mn(t.geometry,i)},FeatureCollection:function(t,i){for(var r=t.features,o=-1,a=r.length;++o<a;)Mn(r[o].geometry,i)}},Je={Sphere:function(t,i){i.sphere()},Point:function(t,i){i.point((t=t.coordinates)[0],t[1],t[2])},MultiPoint:function(t,i){for(var r=t.coordinates,o=-1,a=r.length;++o<a;)i.point((t=r[o])[0],t[1],t[2])},LineString:function(t,i){le(t.coordinates,i,0)},MultiLineString:function(t,i){for(var r=t.coordinates,o=-1,a=r.length;++o<a;)le(r[o],i,0)},Polygon:function(t,i){$e(t.coordinates,i)},MultiPolygon:function(t,i){for(var r=t.coordinates,o=-1,a=r.length;++o<a;)$e(r[o],i)},GeometryCollection:function(t,i){for(var r=t.geometries,o=-1,a=r.length;++o<a;)Mn(r[o],i)}};function le(e,t,i){var a,r=-1,o=e.length-i;for(t.lineStart();++r<o;)t.point((a=e[r])[0],a[1],a[2]);t.lineEnd()}function $e(e,t){var i=-1,r=e.length;for(t.polygonStart();++i<r;)le(e[i],t,1);t.polygonEnd()}function Tt(e,t){e&&Qe.hasOwnProperty(e.type)?Qe[e.type](e,t):Mn(e,t)}function Cn(e){return[Dt(e[1],e[0]),Mt(e[2])]}function Bt(e){var t=e[0],i=e[1],r=W(i);return[r*W(t),r*G(t),G(i)]}function Nn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function qt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function he(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Dn(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function jn(e){var t=dt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}C(),C(),C();var on,Ln,An,Rn,Fn,Zn,zn,Vn,ve,de,ge,si,ci,St,yt,wt,jt={sphere:rt,point:me,lineStart:fi,lineEnd:hi,polygonStart:function(){jt.lineStart=Ar,jt.lineEnd=Rr},polygonEnd:function(){jt.lineStart=fi,jt.lineEnd=hi}};function me(e,t){e*=U;var i=W(t*=U);an(i*W(e),i*G(e),G(t))}function an(e,t,i){++on,An+=(e-An)/on,Rn+=(t-Rn)/on,Fn+=(i-Fn)/on}function fi(){jt.point=jr}function jr(e,t){e*=U;var i=W(t*=U);St=i*W(e),yt=i*G(e),wt=G(t),jt.point=Lr,an(St,yt,wt)}function Lr(e,t){e*=U;var i=W(t*=U),r=i*W(e),o=i*G(e),a=G(t),u=Dt(dt((u=yt*a-wt*o)*u+(u=wt*r-St*a)*u+(u=St*o-yt*r)*u),St*r+yt*o+wt*a);Ln+=u,Zn+=u*(St+(St=r)),zn+=u*(yt+(yt=o)),Vn+=u*(wt+(wt=a)),an(St,yt,wt)}function hi(){jt.point=me}function Ar(){jt.point=Fr}function Rr(){pi(si,ci),jt.point=me}function Fr(e,t){si=e,ci=t,e*=U,t*=U,jt.point=pi;var i=W(t);St=i*W(e),yt=i*G(e),wt=G(t),an(St,yt,wt)}function pi(e,t){e*=U;var i=W(t*=U),r=i*W(e),o=i*G(e),a=G(t),u=yt*a-wt*o,s=wt*r-St*a,c=St*o-yt*r,p=dt(u*u+s*s+c*c),l=Mt(p),h=p&&-l/p;ve+=h*u,de+=h*s,ge+=h*c,Ln+=l,Zn+=l*(St+(St=r)),zn+=l*(yt+(yt=o)),Vn+=l*(wt+(wt=a)),an(St,yt,wt)}function Se(e,t){function i(r,o){return r=e(r,o),t(r[0],r[1])}return e.invert&&t.invert&&(i.invert=function(r,o){return(r=t.invert(r,o))&&e.invert(r[0],r[1])}),i}function ye(e,t){return[e>T?e-ct:e<-T?e+ct:e,t]}function vi(e,t,i){return(e%=ct)?t||i?Se(gi(e),mi(t,i)):gi(e):t||i?mi(t,i):ye}function di(e){return function(t,i){return[(t+=e)>T?t-ct:t<-T?t+ct:t,i]}}function gi(e){var t=di(e);return t.invert=di(-e),t}function mi(e,t){var i=W(e),r=G(e),o=W(t),a=G(t);function u(s,c){var p=W(c),l=W(s)*p,h=G(s)*p,f=G(c),v=f*i+l*r;return[Dt(h*o-v*a,l*i-f*r),Mt(v*o+h*a)]}return u.invert=function(s,c){var p=W(c),l=W(s)*p,h=G(s)*p,f=G(c),v=f*o-h*a;return[Dt(h*o+f*a,l*i+v*r),Mt(v*i-l*r)]},u}function yi(e,t){(t=Bt(t))[0]-=e,jn(t);var i=Ke(-t[1]);return((-t[2]<0?-i:i)+ct-m)%ct}function wi(){var t,e=[];return{point:function(r,o){t.push([r,o])},lineStart:function(){e.push(t=[])},lineEnd:rt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var r=e;return e=[],t=null,r}}}function xn(e,t){return nt(e[0]-t[0])<m&&nt(e[1]-t[1])<m}function Tn(e,t,i,r){this.x=e,this.z=t,this.o=i,this.e=r,this.v=!1,this.n=this.p=null}function Mi(e,t,i,r,o){var s,c,a=[],u=[];if(e.forEach(function(d){if(!((w=d.length-1)<=0)){var w,Z,y=d[0],M=d[w];if(xn(y,M)){for(o.lineStart(),s=0;s<w;++s)o.point((y=d[s])[0],y[1]);return void o.lineEnd()}a.push(Z=new Tn(y,d,null,!0)),u.push(Z.o=new Tn(y,null,Z,!1)),a.push(Z=new Tn(M,d,null,!1)),u.push(Z.o=new Tn(M,null,Z,!0))}}),a.length){for(u.sort(t),Ei(a),Ei(u),s=0,c=u.length;s<c;++s)u[s].e=i=!i;for(var l,h,p=a[0];;){for(var f=p,v=!0;f.v;)if((f=f.n)===p)return;l=f.z,o.lineStart();do{if(f.v=f.o.v=!0,f.e){if(v)for(s=0,c=l.length;s<c;++s)o.point((h=l[s])[0],h[1]);else r(f.x,f.n.x,1,o);f=f.n}else{if(v)for(s=(l=f.p.z).length-1;s>=0;--s)o.point((h=l[s])[0],h[1]);else r(f.x,f.p.x,-1,o);f=f.p}l=(f=f.o).z,v=!v}while(!f.v);o.lineEnd()}}}function Ei(e){if(t=e.length){for(var t,o,i=0,r=e[0];++i<t;)r.n=o=e[i],o.p=r,r=o;r.n=o=e[0],o.p=r}}ye.invert=ye;var e,we=C();function Ci(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ji(e){for(var i,a,u,t=e.length,r=-1,o=0;++r<t;)o+=e[r].length;for(a=new Array(o);--t>=0;)for(i=(u=e[t]).length;--i>=0;)a[--o]=u[i];return a}function Li(e,t,i,r){return function(o){var p,l,h,a=t(o),u=wi(),s=t(u),c=!1,f={point:v,lineStart:w,lineEnd:y,polygonStart:function(){f.point=M,f.lineStart=Z,f.lineEnd=S,l=[],p=[]},polygonEnd:function(){f.point=v,f.lineStart=w,f.lineEnd=y,l=ji(l);var N=function(e,t){var i=t[0],r=t[1],o=G(r),a=[G(i),-W(i),0],u=0,s=0;we.reset(),1===o?r=Q+m:-1===o&&(r=-Q-m);for(var c=0,p=e.length;c<p;++c)if(h=(l=e[c]).length)for(var l,h,f=l[h-1],v=f[0],d=f[1]/2+vt,w=G(d),y=W(d),M=0;M<h;++M,v=S,w=N,y=Y,f=Z){var Z=l[M],S=Z[0],g=Z[1]/2+vt,N=G(g),Y=W(g),k=S-v,I=k>=0?1:-1,B=I*k,et=B>T,$=w*N;if(we.add(Dt($*I*G(B),y*Y+$*W(B))),u+=et?k+I*ct:k,et^v>=i^S>=i){var ot=qt(Bt(f),Bt(Z));jn(ot);var j=qt(a,ot);jn(j);var q=(et^k>=0?-1:1)*Mt(j[2]);(r>q||r===q&&(ot[0]||ot[1]))&&(s+=et^k>=0?1:-1)}}return(u<-m||u<m&&we<-m)^1&s}(p,r);l.length?(c||(o.polygonStart(),c=!0),Mi(l,br,N,i,o)):N&&(c||(o.polygonStart(),c=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),c&&(o.polygonEnd(),c=!1),l=p=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function v(g,N){e(g,N)&&o.point(g,N)}function d(g,N){a.point(g,N)}function w(){f.point=d,a.lineStart()}function y(){f.point=v,a.lineEnd()}function M(g,N){h.push([g,N]),s.point(g,N)}function Z(){s.lineStart(),h=[]}function S(){M(h[0][0],h[0][1]),s.lineEnd();var Y,I,B,et,g=s.clean(),N=u.result(),k=N.length;if(h.pop(),p.push(h),h=null,k){if(1&g){if((I=(B=N[0]).length-1)>0){for(c||(o.polygonStart(),c=!0),o.lineStart(),Y=0;Y<I;++Y)o.point((et=B[Y])[0],et[1]);o.lineEnd()}return}k>1&&2&g&&N.push(N.pop().concat(N.shift())),l.push(N.filter(Gr))}}return f}}function Gr(e){return e.length>1}function br(e,t){return((e=e.x)[0]<0?e[1]-Q-m:Q-e[1])-((t=t.x)[0]<0?t[1]-Q-m:Q-t[1])}1===(e=Ci).length&&(e=function(e){return function(t,i){return Ci(e(t),i)}}(e)),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var Ai=Li(function(){return!0},function(e){var o,t=NaN,i=NaN,r=NaN;return{lineStart:function(){e.lineStart(),o=1},point:function(u,s){var c=u>0?T:-T,p=nt(u-t);nt(p-T)<m?(e.point(t,i=(i+s)/2>0?Q:-Q),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(c,i),e.point(u,i),o=0):r!==c&&p>=T&&(nt(t-r)<m&&(t-=r*m),nt(u-c)<m&&(u-=c*m),i=function(e,t,i,r){var o,a,u=G(e-i);return nt(u)>m?en((G(t)*(a=W(r))*G(i)-G(r)*(o=W(t))*G(e))/(o*a*u)):(t+r)/2}(t,i,u,s),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(c,i),o=0),e.point(t=u,i=s),r=c},lineEnd:function(){e.lineEnd(),t=i=NaN},clean:function(){return 2-o}}},function(e,t,i,r){var o;if(null==e)r.point(-T,o=i*Q),r.point(0,o),r.point(T,o),r.point(T,0),r.point(T,-o),r.point(0,-o),r.point(-T,-o),r.point(-T,0),r.point(-T,o);else if(nt(e[0]-t[0])>m){var a=e[0]<t[0]?T:-T;r.point(-a,o=i*a/2),r.point(0,o),r.point(a,o)}else r.point(t[0],t[1])},[-T,-Q]),un=1e9,Gn=-un;function je(e){return e}C();var bi,Bi,Re,Fe,Le=C(),Ae=C(),bt={point:rt,lineStart:rt,lineEnd:rt,polygonStart:function(){bt.lineStart=_r,bt.lineEnd=no},polygonEnd:function(){bt.lineStart=bt.lineEnd=bt.point=rt,Le.add(nt(Ae)),Ae.reset()},result:function(){var t=Le/2;return Le.reset(),t}};function _r(){bt.point=to}function to(e,t){bt.point=Oi,bi=Re=e,Bi=Fe=t}function Oi(e,t){Ae.add(Fe*e-Re*t),Re=e,Fe=t}function no(){Oi(bi,Bi)}var ki,Xi,Ft,Zt,Wi=bt,Qt=1/0,kn=Qt,ln=-Qt,Xn=ln,eo={point:function(e,t){e<Qt&&(Qt=e),e>ln&&(ln=e),t<kn&&(kn=t),t>Xn&&(Xn=t)},lineStart:rt,lineEnd:rt,polygonStart:rt,polygonEnd:rt,result:function(){var t=[[Qt,kn],[ln,Xn]];return ln=Xn=-(kn=Qt=1/0),t}},Yn=eo,Ze=0,ze=0,sn=0,Hn=0,Un=0,Jt=0,Ve=0,xe=0,cn=0,Lt={point:Wt,lineStart:Yi,lineEnd:Hi,polygonStart:function(){Lt.lineStart=ao,Lt.lineEnd=uo},polygonEnd:function(){Lt.point=Wt,Lt.lineStart=Yi,Lt.lineEnd=Hi},result:function(){var t=cn?[Ve/cn,xe/cn]:Jt?[Hn/Jt,Un/Jt]:sn?[Ze/sn,ze/sn]:[NaN,NaN];return Ze=ze=sn=Hn=Un=Jt=Ve=xe=cn=0,t}};function Wt(e,t){Ze+=e,ze+=t,++sn}function Yi(){Lt.point=ro}function ro(e,t){Lt.point=oo,Wt(Ft=e,Zt=t)}function oo(e,t){var i=e-Ft,r=t-Zt,o=dt(i*i+r*r);Hn+=o*(Ft+e)/2,Un+=o*(Zt+t)/2,Jt+=o,Wt(Ft=e,Zt=t)}function Hi(){Lt.point=Wt}function ao(){Lt.point=lo}function uo(){Ui(ki,Xi)}function lo(e,t){Lt.point=Ui,Wt(ki=Ft=e,Xi=Zt=t)}function Ui(e,t){var i=e-Ft,r=t-Zt,o=dt(i*i+r*r);Hn+=o*(Ft+e)/2,Un+=o*(Zt+t)/2,Jt+=o,Ve+=(o=Zt*e-Ft*t)*(Ft+e),xe+=o*(Zt+t),cn+=3*o,Wt(Ft=e,Zt=t)}var qi=Lt;function Ii(e){this._context=e}Ii.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,i){switch(this._point){case 0:this._context.moveTo(t,i),this._point=1;break;case 1:this._context.lineTo(t,i);break;default:this._context.moveTo(t+this._radius,i),this._context.arc(t,i,this._radius,0,ct)}},result:rt};var Ge,Ki,Qi,fn,hn,Te=C(),qn={point:rt,lineStart:function(){qn.point=so},lineEnd:function(){Ge&&Ji(Ki,Qi),qn.point=rt},polygonStart:function(){Ge=!0},polygonEnd:function(){Ge=null},result:function(){var t=+Te;return Te.reset(),t}};function so(e,t){qn.point=Ji,Ki=fn=e,Qi=hn=t}function Ji(e,t){Te.add(dt((fn-=e)*fn+(hn-=t)*hn)),fn=e,hn=t}var $i=qn;function _i(){this._string=[]}function tr(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function be(e,t){var r,o,i=4.5;function a(u){return u&&("function"==typeof i&&o.pointRadius(+i.apply(this,arguments)),Tt(u,r(o))),o.result()}return a.area=function(u){return Tt(u,r(Wi)),Wi.result()},a.measure=function(u){return Tt(u,r($i)),$i.result()},a.bounds=function(u){return Tt(u,r(Yn)),Yn.result()},a.centroid=function(u){return Tt(u,r(qi)),qi.result()},a.projection=function(u){return arguments.length?(r=null==u?(e=null,je):(e=u).stream,a):e},a.context=function(u){return arguments.length?(o=null==u?(t=null,new _i):new Ii(t=u),"function"!=typeof i&&o.pointRadius(i),a):t},a.pointRadius=function(u){return arguments.length?(i="function"==typeof u?u:(o.pointRadius(+u),+u),a):i},a.projection(e).context(t)}function In(e){return function(t){var i=new Be;for(var r in e)i[r]=e[r];return i.stream=t,i}}function Be(){}function Oe(e,t,i){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),Tt(i,e.stream(Yn)),t(Yn.result()),null!=r&&e.clipExtent(r),e}function We(e,t,i){return Oe(e,function(r){var o=t[1][0]-t[0][0],a=t[1][1]-t[0][1],u=Math.min(o/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),s=+t[0][0]+(o-u*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(a-u*(r[1][1]+r[0][1]))/2;e.scale(150*u).translate([s,c])},i)}function nr(e,t,i){return We(e,[[0,0],t],i)}function er(e,t,i){return Oe(e,function(r){var o=+t,a=o/(r[1][0]-r[0][0]),u=(o-a*(r[1][0]+r[0][0]))/2,s=-a*r[0][1];e.scale(150*a).translate([u,s])},i)}function ir(e,t,i){return Oe(e,function(r){var o=+t,a=o/(r[1][1]-r[0][1]),u=-a*r[0][0],s=(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([u,s])},i)}_i.prototype={_radius:4.5,_circle:tr(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,i){switch(this._point){case 0:this._string.push("M",t,",",i),this._point=1;break;case 1:this._string.push("L",t,",",i);break;default:null==this._circle&&(this._circle=tr(this._radius)),this._string.push("M",t,",",i,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Be.prototype={constructor:Be,point:function(t,i){this.stream.point(t,i)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var rr=16,co=W(30*U);function or(e,t){return+t?function(e,t){function i(r,o,a,u,s,c,p,l,h,f,v,d,w,y){var M=p-r,Z=l-o,S=M*M+Z*Z;if(S>4*t&&w--){var g=u+f,N=s+v,Y=c+d,k=dt(g*g+N*N+Y*Y),I=Mt(Y/=k),B=nt(nt(Y)-1)<m||nt(a-h)<m?(a+h)/2:Dt(N,g),et=e(B,I),$=et[0],ot=et[1],j=$-r,q=ot-o,J=Z*j-M*q;(J*J/S>t||nt((M*j+Z*q)/S-.5)>.3||u*f+s*v+c*d<co)&&(i(r,o,a,u,s,c,$,ot,B,g/=k,N/=k,Y,w,y),y.point($,ot),i($,ot,B,g,N,Y,p,l,h,f,v,d,w,y))}}return function(r){var o,a,u,s,c,p,l,h,f,v,d,w,y={point:M,lineStart:Z,lineEnd:g,polygonStart:function(){r.polygonStart(),y.lineStart=N},polygonEnd:function(){r.polygonEnd(),y.lineStart=Z}};function M(I,B){I=e(I,B),r.point(I[0],I[1])}function Z(){h=NaN,y.point=S,r.lineStart()}function S(I,B){var et=Bt([I,B]),$=e(I,B);i(h,f,l,v,d,w,h=$[0],f=$[1],l=I,v=et[0],d=et[1],w=et[2],rr,r),r.point(h,f)}function g(){y.point=M,r.lineEnd()}function N(){Z(),y.point=Y,y.lineEnd=k}function Y(I,B){S(o=I,B),a=h,u=f,s=v,c=d,p=w,y.point=S}function k(){i(h,f,l,v,d,w,a,u,o,s,c,p,rr,r),y.lineEnd=g,g()}return y}}(e,t):function(e){return In({point:function(i,r){i=e(i,r),this.stream.point(i[0],i[1])}})}(e)}var po=In({point:function(t,i){this.stream.point(t*U,i*U)}});function go(e,t,i){function r(o,a){return[t+e*o,i-e*a]}return r.invert=function(o,a){return[(o-t)/e,(i-a)/e]},r}function ar(e,t,i,r){var o=W(r),a=G(r),u=o*e,s=a*e,c=o/e,p=a/e,l=(a*i-o*t)/e,h=(a*t+o*i)/e;function f(v,d){return[u*v-s*d+t,i-s*v-u*d]}return f.invert=function(v,d){return[c*v-p*d+l,h-p*v-c*d]},f}function ke(e){return ur(function(){return e})()}function ur(e){var t,l,w,y,M,g,N,Y,k,I,i=150,r=480,o=250,a=0,u=0,s=0,c=0,p=0,h=0,f=null,v=Ai,d=null,Z=je,S=.5;function B(j){return Y(j[0]*U,j[1]*U)}function et(j){return(j=Y.invert(j[0],j[1]))&&[j[0]*lt,j[1]*lt]}function $(){var j=ar(i,0,0,h).apply(null,t(a,u)),q=(h?ar:go)(i,r-j[0],o-j[1],h);return l=vi(s,c,p),N=Se(t,q),Y=Se(l,N),g=or(N,S),ot()}function ot(){return k=I=null,B}return B.stream=function(j){return k&&I===j?k:k=po(function(e){return In({point:function(i,r){var o=e(i,r);return this.stream.point(o[0],o[1])}})}(l)(v(g(Z(I=j)))))},B.preclip=function(j){return arguments.length?(v=j,f=void 0,ot()):v},B.postclip=function(j){return arguments.length?(Z=j,d=w=y=M=null,ot()):Z},B.clipAngle=function(j){return arguments.length?(v=+j?function(e){var t=W(e),i=6*U,r=t>0,o=nt(t)>m;function u(l,h){return W(l)*W(h)>t}function c(l,h,f){var w=[1,0,0],y=qt(Bt(l),Bt(h)),M=Nn(y,y),Z=y[0],S=M-Z*Z;if(!S)return!f&&l;var g=t*M/S,N=-t*Z/S,Y=qt(w,y),k=Dn(w,g);he(k,Dn(y,N));var B=Y,et=Nn(k,B),$=Nn(B,B),ot=et*et-$*(Nn(k,k)-1);if(!(ot<0)){var j=dt(ot),q=Dn(B,(-et-j)/$);if(he(q,k),q=Cn(q),!f)return q;var mt,J=l[0],tt=h[0],st=l[1],ft=h[1];tt<J&&(mt=J,J=tt,tt=mt);var At=tt-J,ht=nt(At-T)<m;if(!ht&&ft<st&&(mt=st,st=ft,ft=mt),ht||At<m?ht?st+ft>0^q[1]<(nt(q[0]-J)<m?st:ft):st<=q[1]&&q[1]<=ft:At>T^(J<=q[0]&&q[0]<=tt)){var xt=Dn(B,(-et+j)/$);return he(xt,k),[q,Cn(xt)]}}}function p(l,h){var f=r?e:T-e,v=0;return l<-f?v|=1:l>f&&(v|=2),h<-f?v|=4:h>f&&(v|=8),v}return Li(u,function(l){var h,f,v,d,w;return{lineStart:function(){d=v=!1,w=1},point:function(M,Z){var g,S=[M,Z],N=u(M,Z),Y=r?N?0:p(M,Z):N?p(M+(M<0?T:-T),Z):0;if(!h&&(d=v=N)&&l.lineStart(),N!==v&&(!(g=c(h,S))||xn(h,g)||xn(S,g))&&(S[0]+=m,S[1]+=m,N=u(S[0],S[1])),N!==v)w=0,N?(l.lineStart(),g=c(S,h),l.point(g[0],g[1])):(g=c(h,S),l.point(g[0],g[1]),l.lineEnd()),h=g;else if(o&&h&&r^N){var k;!(Y&f)&&(k=c(S,h,!0))&&(w=0,r?(l.lineStart(),l.point(k[0][0],k[0][1]),l.point(k[1][0],k[1][1]),l.lineEnd()):(l.point(k[1][0],k[1][1]),l.lineEnd(),l.lineStart(),l.point(k[0][0],k[0][1])))}N&&(!h||!xn(h,S))&&l.point(S[0],S[1]),h=S,v=N,f=Y},lineEnd:function(){v&&l.lineEnd(),h=null},clean:function(){return w|(d&&v)<<1}}},function(l,h,f,v){!function(e,t,i,r,o,a){if(i){var u=W(t),s=G(t),c=r*i;null==o?(o=t+r*ct,a=t-c/2):(o=yi(u,o),a=yi(u,a),(r>0?o<a:o>a)&&(o+=r*ct));for(var p,l=o;r>0?l>a:l<a;l-=c)p=Cn([u,-s*W(l),-s*G(l)]),e.point(p[0],p[1])}}(v,e,i,f,l,h)},r?[0,-e]:[-T,e-T])}(f=j*U):(f=null,Ai),ot()):f*lt},B.clipExtent=function(j){return arguments.length?(Z=null==j?(d=w=y=M=null,je):function(e,t,i,r){function o(p,l){return e<=p&&p<=i&&t<=l&&l<=r}function a(p,l,h,f){var v=0,d=0;if(null==p||(v=u(p,h))!==(d=u(l,h))||c(p,l)<0^h>0)do{f.point(0===v||3===v?e:i,v>1?r:t)}while((v=(v+h+4)%4)!==d);else f.point(l[0],l[1])}function u(p,l){return nt(p[0]-e)<m?l>0?0:3:nt(p[0]-i)<m?l>0?2:1:nt(p[1]-t)<m?l>0?1:0:l>0?3:2}function s(p,l){return c(p.x,l.x)}function c(p,l){var h=u(p,1),f=u(l,1);return h!==f?h-f:0===h?l[1]-p[1]:1===h?p[0]-l[0]:2===h?p[1]-l[1]:l[0]-p[0]}return function(p){var f,v,d,w,y,M,Z,S,g,N,Y,l=p,h=wi(),k={point:I,lineStart:function(){k.point=q,v&&v.push(d=[]),N=!0,g=!1,Z=S=NaN},lineEnd:function(){f&&(q(w,y),M&&g&&h.rejoin(),f.push(h.result())),k.point=I,g&&l.lineEnd()},polygonStart:function(){l=h,f=[],v=[],Y=!0},polygonEnd:function(){var J=function(){for(var J=0,tt=0,st=v.length;tt<st;++tt)for(var kt,xt,ft=v[tt],mt=1,At=ft.length,ht=ft[0],_n=ht[0],$t=ht[1];mt<At;++mt)kt=_n,xt=$t,_n=(ht=ft[mt])[0],$t=ht[1],xt<=r?$t>r&&(_n-kt)*(r-xt)>($t-xt)*(e-kt)&&++J:$t<=r&&(_n-kt)*(r-xt)<($t-xt)*(e-kt)&&--J;return J}(),tt=Y&&J,st=(f=ji(f)).length;(tt||st)&&(p.polygonStart(),tt&&(p.lineStart(),a(null,null,1,p),p.lineEnd()),st&&Mi(f,s,J,a,p),p.polygonEnd()),l=p,f=v=d=null}};function I(J,tt){o(J,tt)&&l.point(J,tt)}function q(J,tt){var st=o(J,tt);if(v&&d.push([J,tt]),N)w=J,y=tt,M=st,N=!1,st&&(l.lineStart(),l.point(J,tt));else if(st&&g)l.point(J,tt);else{var ft=[Z=Math.max(Gn,Math.min(un,Z)),S=Math.max(Gn,Math.min(un,S))],mt=[J=Math.max(Gn,Math.min(un,J)),tt=Math.max(Gn,Math.min(un,tt))];!function(e,t,i,r,o,a){var d,u=e[0],s=e[1],l=0,h=1,f=t[0]-u,v=t[1]-s;if(d=i-u,f||!(d>0)){if(d/=f,f<0){if(d<l)return;d<h&&(h=d)}else if(f>0){if(d>h)return;d>l&&(l=d)}if(d=o-u,f||!(d<0)){if(d/=f,f<0){if(d>h)return;d>l&&(l=d)}else if(f>0){if(d<l)return;d<h&&(h=d)}if(d=r-s,v||!(d>0)){if(d/=v,v<0){if(d<l)return;d<h&&(h=d)}else if(v>0){if(d>h)return;d>l&&(l=d)}if(d=a-s,v||!(d<0)){if(d/=v,v<0){if(d>h)return;d>l&&(l=d)}else if(v>0){if(d<l)return;d<h&&(h=d)}return l>0&&(e[0]=u+l*f,e[1]=s+l*v),h<1&&(t[0]=u+h*f,t[1]=s+h*v),!0}}}}}(ft,mt,e,t,i,r)?st&&(l.lineStart(),l.point(J,tt),Y=!1):(g||(l.lineStart(),l.point(ft[0],ft[1])),l.point(mt[0],mt[1]),st||l.lineEnd(),Y=!1)}Z=J,S=tt,g=st}return k}}(d=+j[0][0],w=+j[0][1],y=+j[1][0],M=+j[1][1]),ot()):null==d?null:[[d,w],[y,M]]},B.scale=function(j){return arguments.length?(i=+j,$()):i},B.translate=function(j){return arguments.length?(r=+j[0],o=+j[1],$()):[r,o]},B.center=function(j){return arguments.length?(a=j[0]%360*U,u=j[1]%360*U,$()):[a*lt,u*lt]},B.rotate=function(j){return arguments.length?(s=j[0]%360*U,c=j[1]%360*U,p=j.length>2?j[2]%360*U:0,$()):[s*lt,c*lt,p*lt]},B.angle=function(j){return arguments.length?(h=j%360*U,$()):h*lt},B.precision=function(j){return arguments.length?(g=or(N,S=j*j),ot()):dt(S)},B.fitExtent=function(j,q){return We(B,j,q)},B.fitSize=function(j,q){return nr(B,j,q)},B.fitWidth=function(j,q){return er(B,j,q)},B.fitHeight=function(j,q){return ir(B,j,q)},function(){return t=e.apply(this,arguments),B.invert=t.invert&&et,$()}}function yo(e,t){var i=G(e),r=(i+G(t))/2;if(nt(r)<m)return function(e){var t=W(e);function i(r,o){return[r*t,G(o)/t]}return i.invert=function(r,o){return[r/t,Mt(o*t)]},i}(e);var o=1+i*(2*r-i),a=dt(o)/r;function u(s,c){var p=dt(o-2*r*G(c))/r;return[p*G(s*=r),a-p*W(s)]}return u.invert=function(s,c){var p=a-c;return[Dt(s,nt(p))/r*wr(p),Mt((o-(s*s+p*p)*r*r)/(2*r))]},u}function Xe(){return function(e){var t=0,i=T/3,r=ur(e),o=r(t,i);return o.parallels=function(a){return arguments.length?r(t=a[0]*U,i=a[1]*U):[t*lt,i*lt]},o}(yo).scale(155.424).center([0,33.6442])}function lr(e){return function(t,i){var r=W(t),o=W(i),a=e(r*o);return[a*o*G(t),a*G(i)]}}function pn(e){return function(t,i){var r=dt(t*t+i*i),o=e(r),a=G(o),u=W(o);return[Dt(t*a,r*u),Mt(r&&i*a/r)]}}var sr=lr(function(e){return dt(2/(1+e))});sr.invert=pn(function(e){return 2*Mt(e/2)});var cr=lr(function(e){return(e=Ke(e))&&e/G(e)});function Ye(e,t){return[e,qe(Ie((Q+t)/2))]}function He(e,t){return[e,t]}cr.invert=pn(function(e){return e}),Ye.invert=function(e,t){return[e,2*en(Ue(t))-Q]},He.invert=He;dt(3);function vr(e,t){return[W(t)*G(e),G(t)]}function dr(){return ke(vr).scale(249.5).clipAngle(90+m)}pn(en),vr.invert=pn(Mt),pn(function(e){return 2*en(e)});var gt,Ao=K(43174),Ro=X,Sr=((gt={})[pt.fC]={projections:[E.Lu,E.hD,E.s6]},gt[pt.M4]={projections:[E.Lu,E.hD,E.s6]},gt[pt.p8]={projections:[E.s6,E.hD,E.Lu]},gt[pt.S9]={projections:[E.s6,E.hD,E.Lu]},gt[pt.G]={projections:[E.s6,E.hD,E.Lu]},gt[pt.r5]={projections:[E.s6,E.hD,E.Lu]},gt[pt.Bo]={projections:[E.s6,E.hD,E.Lu]},gt[pt.S$]={projections:[E.s6,E.hD,E.Lu]},gt[pt.sp]={projections:[E.s6,E.hD,E.Lu]},gt[pt.Ss]={projections:[E.Lu,E.hD,E.s6]},gt[pt.Xl]={projections:[E.s6,E.hD,E.Lu]},gt[pt.ei]={projections:[E.Lu,E.hD,E.s6]},gt[pt.Wl]={projections:[E.s6,E.hD,E.Lu]},gt[pt.X9]={projections:[E.rU,E.hD,E.Lu,E.s6]},gt),$n=[E.Lu,E.hD,E.s6],zo=function(){function e(t){this.resetToDefault=!1,t&&(this.behavior=t.behavior,this.behavior&&(this.behavior.shapeMap=this),this.tooltipsEnabled=t.tooltipsEnabled)}return e.prototype.init=function(t){this.root=t.element,this.hostServices=t.host,this.tooltipService=(0,oe.r)(t.host),this.viewport=t.viewport,this.featureSwitches=t.featureSwitches,this.svg=d3.select(this.root.get(0)).append("svg").attr("focus-nav-mode","Hierarchy").attr("tabindex","0").attr("aria-label",this.hostServices.getLocalizedString("Visual_Plot")).attr("class","shapeMap").attr("width",this.viewport.width).attr("height",this.viewport.height).attr("drag-resize-disabled","true").style("position","absolute"),this.behavior&&(this.clearCatcher=(0,yn.EX)(this.svg),this.interactivityService=(0,yn.ub)(this.hostServices,this.featureSwitches)),this.mapG=this.svg.append("g"),this.style=t.style,this.legend=(0,ie.OG)(this.root,t.interactivity&&t.interactivity.mobileTileInteractive,this.interactivityService,!0,void 0,this.style,this.hostServices)},e.prototype.update=function(t){if(this.viewport=t.viewport,!_.isEmpty(t.dataViews)&&t.dataViews[0]){var i=this.dataView=t.dataViews[0];this.viewModel=e.converter(i,this.style,this.interactivityService,this.tooltipsEnabled),this.render(t.suppressAnimations)}},e.prototype.enumerateObjectInstances=function(t){if(this.viewModel){var i=new ee.G;switch(t.objectName){case"shape":i.pushInstance(this.viewModel.shapeMap?{objectName:"shape",selector:null,properties:{map:_.clone(this.viewModel.shapeMap),projectionEnum:this.viewModel.projectionEnum},validValues:{projectionEnum:e.validProjectionsForShapeMap(this.viewModel.shapeMap)}}:{objectName:"shape",selector:null,properties:{map:{}},validValues:{projectionEnum:$n}});break;case"defaultColors":i.pushInstance({objectName:"defaultColors",selector:null,properties:{defaultShow:this.viewModel.defaultShow,defaultColor:this.viewModel.defaultShow?this.viewModel.defaultColor:null,borderColor:this.viewModel.borderColor,borderThickness:this.viewModel.borderThickness}})}return i.complete()}},e.prototype.getFormattingModel=function(){return new it.Nq(this.getMapSettingsCard(),this.getLegendCard(),this.getFillColorsCard()).build()},e.prototype.getMapSettingsCard=function(){var t=this,i=Nt.L.shape,r=Nt.L.zoom,o=new it.CQ(new it.lg("mapSettings"),"Visual_AzureMapsMapSettings",[i.map,i.projectionEnum,r.autoZoom,r.selectionZoom,r.manualZoom],function(s){return t.hostServices.getLocalizedString(s)}),a=this.viewModel,u=a.shapeMap;return o.addGroup("options",function(s){s.withDisplayName("Visual_AzureMapsMapSettings").addSimpleSlice("shapeMapSelector",new it.vX({descriptor:i.map,value:u?_.clone(u):void 0}).build()).addSimpleSlice("projection",new it.uY({descriptor:i.projectionEnum,value:u&&a.projectionEnum,filterValues:u?e.validProjectionsForShapeMap(u):$n}).build())}).addGroup("zoom",function(s){s.withDisplayName("Visual_ShapeMap_Zoom").addSimpleSlice("autoZoom",new it.bd({descriptor:r.autoZoom,value:a.autoZoom}).build()).addSimpleSlice("selectionZoom",new it.bd({descriptor:r.selectionZoom,value:a.selectionZoom}).build()).addSimpleSlice("manualZoom",new it.bd({descriptor:r.manualZoom,value:a.manualZoom}).build())}),o.build()},e.prototype.getLegendCard=function(){var t=this.viewModel;return(0,nn.ZF)({legendData:t.legendData},this.hostServices,this.featureSwitches,!t.hasDynamicSeries)},e.prototype.getFillColorsCard=function(){var t=this,i=this.viewModel,r=this.dataView,o=Nt.L.dataPoint,a=Nt.L.defaultColors,u=function(g){return t.hostServices.getLocalizedString(g)},s={objectName:"gradient",propertyName:"diverging"},c={objectName:"gradient",propertyName:"gradientBar"},p={objectName:"gradient",propertyName:"minColor"},l={objectName:"gradient",propertyName:"midColor"},h={objectName:"gradient",propertyName:"maxColor"},f={objectName:"gradient",propertyName:"minValue"},v={objectName:"gradient",propertyName:"midValue"},d={objectName:"gradient",propertyName:"maxValue"},w=new it.CQ(new it.lg("fillColors"),"Visual_FillColors",[o.fill,o.fillRule,o.showAllDataPoints,a.defaultShow,a.defaultColor,a.borderColor,a.borderThickness,s,c,p,l,h,f,v,d],function(S){return t.hostServices.getLocalizedString(S)});if(e.shouldEnumerateDataPoints(r))w.addGroup("colors",function(S){if(S.withDisplayName("Visual_Colors"),i.hasDynamicSeries){var g={groupBuilder:S,dataPoints:(0,nn.l3)(i.legendData),seriesColorProps:o,localize:u,featureSwitches:t.featureSwitches};(0,Xt.y0)(g)}else{var N={groupBuilder:S,colorProps:o,featureSwitches:t.featureSwitches,hostService:t.hostServices,options:{dataView:r,style:t.style,categories:_.map(i.dataPoints,function(Y){return{displayName:Y.location,color:Y.color,identity:Y.identity}}),fillInstanceKind:3}};(0,Xt.jN)(N)}});else{var y=(0,P.NA)(this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects,{objectName:"dataPoint",propertyName:"fillRule"},null),M=(0,tn.Wt)(y),Z=this.style.colorPalette.dataColors.getGradientColors();w.addGroup("colors",function(S){S.withDisplayName("Visual_Colors").addSimpleSlice("diverging",new it.bd({descriptor:s,value:M.diverging}).build(),function(g){return g.withCustomDisplayName("ConditionalFormattingDialogModern_Mode_ColorScale").withCustomDescription("Visual_Gradient_DivergingDescription")}).addSimpleSlice("gradientBar",new it._m({descriptor:c,value:(0,tn.Kj)(M,Z)}).build()).addSimpleSlice("minColor",new it.BT({descriptor:p,value:{value:M.minColor||Z.minColor.value}}).build(),function(g){return g.withCustomDisplayName("Aggregate_Min").withCustomDescription("Visual_Gradient_MinColorDescription")}),M.diverging&&S.addSimpleSlice("midColor",new it.BT({descriptor:l,value:{value:M.midColor||Z.midColor.value}}).build(),function(g){return g.withCustomDisplayName("ConditionalFormattingDialog_CenterHeader").withCustomDescription("Visual_Gradient_MidColorDescription")}),S.addSimpleSlice("maxColor",new it.BT({descriptor:h,value:{value:M.maxColor||Z.maxColor.value}}).build(),function(g){return g.withCustomDisplayName("Aggregate_Max").withCustomDescription("Visual_Gradient_MaxColorDescription")}).addSimpleSlice("minValue",new it.mu({descriptor:f,value:M.minValue}).build(),function(g){return g.withCustomDisplayName("Aggregate_Min").withCustomDescription("Visual_Gradient_MinValueDescription")}),M.diverging&&S.addSimpleSlice("midValue",new it.mu({descriptor:v,value:M.midValue}).build(),function(g){return g.withCustomDisplayName("ConditionalFormattingDialog_CenterHeader").withCustomDescription("Visual_Gradient_MidValueDescription")}),S.addSimpleSlice("maxValue",new it.mu({descriptor:d,value:M.maxValue}).build(),function(g){return g.withCustomDisplayName("Aggregate_Max").withCustomDescription("Visual_Gradient_MaxValueDescription")})})}return w.addGroup("blankAreas",function(S){S.withDisplayName("Visual_ShapeMap_BlankAreas").addSimpleSlice("showBlankAreas",new it.bd({descriptor:a.defaultShow,value:i.defaultShow}).build(),function(g){return g.withCustomDisplayName("Visual_ShapeMap_BlankAreasShow")}).addSimpleSlice("color",new it.BT({descriptor:a.defaultColor,value:{value:i.defaultColor}}).build(),function(g){return g.withDisabled(!i.defaultShow)})}).addGroup("border",function(S){S.withDisplayName("Visual_Border").addSimpleSlice("color",new it.BT({descriptor:a.borderColor,value:{value:i.borderColor}}).build(),function(g){return g.withCustomDisplayName("Generic_Color")}).addSimpleSlice("thickness",new it.mu({descriptor:a.borderThickness,value:i.borderThickness,options:{minValue:{type:0,value:0},maxValue:{type:1,value:10}}}).build(),function(g){return g.withCustomDisplayName("Visual_General_Properties_Width")})}),w.build()},e.getStandardGeoJsonFiles=function(){return _.clone(Sr)},e.validProjectionsForShapeMap=function(t){if(!t||!t.name)return $n;var i=Sr[t.name];return!i||_.isEmpty(i.projections)?$n:i.projections},e.shouldEnumerateDataPoints=function(t){return!!(0,L.c5)(t,E.ac)||!(0,L.c5)(t,E.S3)},e.prototype.getDataPointFromShape=function(t){return this.matcher.getDataPointFromShape(t)},e.getObjectProperties=function(t,i){var r=t&&t.metadata&&t.metadata.objects?t.metadata.objects:{},o=Nt.L,a=(0,P.NA)(r,o.shape.map,null),u=e.validProjectionsForShapeMap(a),s=u[0],c=(0,P.NA)(r,o.shape.projectionEnum,s);_.includes(u,c)||(c=s);var p=ne.v.create(i);return{map:a,projectionEnum:c,autoZoom:(0,P.NA)(r,o.zoom.autoZoom,!1),selectionZoom:(0,P.NA)(r,o.zoom.selectionZoom,!1),manualZoom:(0,P.NA)(r,o.zoom.manualZoom,!1),defaultShow:(0,P.NA)(r,o.defaultColors.defaultShow,!0),defaultColor:p.getColorForProperty(r,o.defaultColors.defaultColor,"backgroundNeutral"),borderColor:p.getColorForProperty(r,o.defaultColors.borderColor,"foregroundNeutralSecondaryAlt2"),borderThickness:(0,P.NA)(r,o.defaultColors.borderThickness,1)}},e.converter=function(t,i,r,o){var a,u,s;void 0===o&&(o=!0);var p,l,h,f,c=[],v=0,d=Nt.L.general.formatString;t&&(h=(p=(0,Sn.G)(t,{colorOptions:{valueRole:E.S3,visualStyle:i},formatStringProp:d})).columns,f=(l=p.data).getCategoryDisplayName(E.W3));var w=!1,y=!1,M=!1;p&&(w=h.hasDynamicSeries(),y=l.hasValues(E.S3),M=l.hasCategoryWithRole(E.W3),l.getValueQueryName(E.S3));var S=t&&p&&l.hasCategories();if(S){v=l.getSeriesCount();for(var g=0;g<l.getCategoryCount();g++){var N=l.getValue(E.S3,g),Y=l.getFormatString(E.S3,g),k=void 0,I=void 0,B=void 0,et=void 0;M&&(k=l.getCategoryValue(E.W3,g),I={displayName:l.getCategoryDisplayName(E.W3),value:(0,Ht.xq)(k,h.getCategoryMetadataColumn(E.W3),d)}),v=l.getSeriesCount(),l.hasValues(E.S3)||(v=1);for(var $=h.getCategoryColumn(E.W3),j=(new z.dw).withCategory([$],g,null===(a=$?.source)||void 0===a?void 0:a.queryName,!0).withMeasure(l.getValueQueryName(E.S3)).createSelectionId(),q=0;q<v;q++){var J,tt=null===(u=t.categorical.values)||void 0===u?void 0:u.grouped(),st=tt&&tt[q];J=p.colors.createBySeries(q,g);var ft=h.getCategoryColumn(M?E.W3:E.S3),mt=(new z.dw).withCategory([ft],g,null===(s=ft?.source)||void 0===s?void 0:s.queryName,!0).withMeasure(l.getValueQueryName(E.S3),h.getValueColumn(E.S3,q),g);w&&(mt=mt.withSeries(h.getSeriesValueColumns(),st,!0),B={displayName:l.getSeriesDisplayName(),value:(0,Ht.xq)(l.getSeriesName(q),h.getSeriesMetadataColumn(),d)}),y&&(N=l.getValue(E.S3,g,q),Y=l.getFormatString(E.S3,g,q),et={displayName:l.getValueDisplayName(E.S3),value:(0,Ht.xq)(N,h.getValueMetadataColumn(E.S3,q),d,!1,Y)});var At=[];o&&(I&&At.push(I),B&&At.push(B),et&&At.push(et),(0,ae.VT)(p,At,g,q,d)),(null!=N||!y)&&c.push({location:k,identity:mt.createSelectionId(),value:N,selected:!1,tooltipInfo:At,color:J,categoryIdentity:j})}}}r&&r.applySelectionStateToData(c);var ht=e.getObjectProperties(t,i);return{shapeMap:ht.map,projectionEnum:ht.projectionEnum,autoZoom:ht.autoZoom,selectionZoom:ht.selectionZoom,manualZoom:ht.manualZoom,defaultShow:ht.defaultShow,defaultColor:ht.defaultColor,borderColor:ht.borderColor,borderThickness:ht.borderThickness,dataPoints:c,categoryName:f,dataAvailable:S,hasDynamicSeries:w,seriesCount:v,legendData:(0,Ut.pq)({dataView:t,showByDefault:!0,style:i})}},e.createProjection=function(t){var i;switch(t){case E.rU:i=function(){var e,t,r,a,s,c,i=Xe().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7]),o=Xe().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Xe().rotate([157,0]).center([-3,19.9]).parallels([8,18]),p={point:function(v,d){c=[v,d]}};function l(f){var v=f[0],d=f[1];return c=null,r.point(v,d),c||(a.point(v,d),c)||(s.point(v,d),c)}function h(){return e=t=null,l}return l.invert=function(f){var v=i.scale(),d=i.translate(),w=(f[0]-d[0])/v,y=(f[1]-d[1])/v;return(y>=.12&&y<.234&&w>=-.425&&w<-.214?o:y>=.166&&y<.234&&w>=-.214&&w<-.115?u:i).invert(f)},l.stream=function(f){return e&&t===f?e:e=function(e){var t=e.length;return{point:function(r,o){for(var a=-1;++a<t;)e[a].point(r,o)},sphere:function(){for(var r=-1;++r<t;)e[r].sphere()},lineStart:function(){for(var r=-1;++r<t;)e[r].lineStart()},lineEnd:function(){for(var r=-1;++r<t;)e[r].lineEnd()},polygonStart:function(){for(var r=-1;++r<t;)e[r].polygonStart()},polygonEnd:function(){for(var r=-1;++r<t;)e[r].polygonEnd()}}}([i.stream(t=f),o.stream(f),u.stream(f)])},l.precision=function(f){return arguments.length?(i.precision(f),o.precision(f),u.precision(f),h()):i.precision()},l.scale=function(f){return arguments.length?(i.scale(f),o.scale(.35*f),u.scale(f),l.translate(i.translate())):i.scale()},l.translate=function(f){if(!arguments.length)return i.translate();var v=i.scale(),d=+f[0],w=+f[1];return r=i.translate(f).clipExtent([[d-.455*v,w-.238*v],[d+.455*v,w+.238*v]]).stream(p),a=o.translate([d-.307*v,w+.201*v]).clipExtent([[d-.425*v+m,w+.12*v+m],[d-.214*v-m,w+.234*v-m]]).stream(p),s=u.translate([d-.205*v,w+.212*v]).clipExtent([[d-.214*v+m,w+.166*v+m],[d-.115*v-m,w+.234*v-m]]).stream(p),h()},l.fitExtent=function(f,v){return We(l,f,v)},l.fitSize=function(f,v){return nr(l,f,v)},l.fitWidth=function(f,v){return er(l,f,v)},l.fitHeight=function(f,v){return ir(l,f,v)},l.scale(1070)}();break;case E.hD:i=ke(He).scale(152.63);break;case E.Lu:i=function(e){var s,c,p,t=ke(e),i=t.center,r=t.scale,o=t.translate,a=t.clipExtent,u=null;function l(){var h=T*r(),f=t(function(e){function t(i){return(i=e(i[0]*U,i[1]*U))[0]*=lt,i[1]*=lt,i}return e=vi(e[0]*U,e[1]*U,e.length>2?e[2]*U:0),t.invert=function(i){return(i=e.invert(i[0]*U,i[1]*U))[0]*=lt,i[1]*=lt,i},t}(t.rotate()).invert([0,0]));return a(null==u?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:e===Ye?[[Math.max(f[0]-h,u),s],[Math.min(f[0]+h,c),p]]:[[u,Math.max(f[1]-h,s)],[c,Math.min(f[1]+h,p)]])}return t.scale=function(h){return arguments.length?(r(h),l()):r()},t.translate=function(h){return arguments.length?(o(h),l()):o()},t.center=function(h){return arguments.length?(i(h),l()):i()},t.clipExtent=function(h){return arguments.length?(null==h?u=s=c=p=null:(u=+h[0][0],s=+h[0][1],c=+h[1][0],p=+h[1][1]),l()):null==u?null:[[u,s],[c,p]]},l()}(Ye).scale(961/ct);break;case E.s6:i=dr();break;default:ue.fF.assertFail("undefined projection"),i=dr()}return t===E.s6&&i.clipAngle(90),i},e.adjustProjection=function(t,i,r,o,a,u,s){if(void 0===s&&(s=1),t.scale(1),t.translate([0,0]),i>0){var c=function(e){on=Ln=An=Rn=Fn=Zn=zn=Vn=ve=de=ge=0,Tt(e,jt);var t=ve,i=de,r=ge,o=t*t+i*i+r*r;return o<V&&(t=Zn,i=zn,r=Vn,Ln<m&&(t=An,i=Rn,r=Fn),(o=t*t+i*i+r*r)<V)?[NaN,NaN]:[Dt(i,t)*lt,Mt(r/dt(o))*lt]}(a);t.rotate(c.map(function(S,g){return g<i?-S:0}))}var p;try{p=be().projection(t).bounds(a)}catch(S){if(S instanceof TypeError)return void u.setWarnings([new wn.pi]);throw S}var l=p[0][0],h=p[1][0],f=p[0][1],v=p[1][1],d=Math.abs(h-l),w=Math.abs(v-f),y=Math.min(r/d,o/w);t.scale(y*=s),t.translate([(r-y*(h+l))/2,(o-y*(v+f))/2])},e.prototype.createGetColorFunction=function(){var t=this;return function(i){var r=t.matcher.getDataPointFromShape(i);return r&&null!=r.color?r.color:t.viewModel.defaultColor}},e.rotationAxes=function(t){switch(t){case E.rU:return 0;case E.Lu:case E.hD:return 1;case E.s6:return 2;default:return 0}},e.prototype.zoomOnClick=function(t){!this.viewModel||!this.viewModel.selectionZoom||(this.selectionZoomShape=!t&&this.selectionZoomShape||t&&t.id&&this.selectionZoomShape&&this.selectionZoomShape.id&&this.selectionZoomShape.id===t.id?null:t,this.render(!1,!0))},e.prototype.resetToDefaultMap=function(){var t={type:b.c1,name:pt.X9,content:void 0};this.hostServices.persistProperties([{objectName:"shape",selector:null,properties:{map:t,projectionEnum:E.rU},validValues:{projectionEnum:e.validProjectionsForShapeMap(t)}}])},e.loadFeatureCollection=function(t){if(_.isEmpty(t.objects))return{features:[],type:"FeatureCollection"};for(var i in t.objects)return Ao.feature(t,t.objects[i])},e.prototype.featuresToZoomTo=function(t,i){var r=this;if(i&&this.selectionZoomShape)return{type:"FeatureCollection",features:[this.selectionZoomShape]};if(this.viewModel.autoZoom){var o={type:"FeatureCollection",features:t.features.filter(function(a){return!!r.getDataPointFromShape(a)})};if(o.features.length>0)return o}return t},e.prototype.render=function(t,i){var r=this;if(this.viewModel.shapeMap&&this.viewModel.shapeMap.content){this.resetToDefault=!1,this.mapG.interrupt(),this.shapes&&this.shapes.interrupt(),this.shapesExit&&this.shapesExit.interrupt(),this.manualZoomDisconnect(),this.viewModel.projectionEnum!==this.projectionEnum&&(this.projection=null),this.projectionEnum=this.viewModel.projectionEnum,this.renderLegend(),(0,re.xz)(this.svg,this.legend);var o=this.getMapViewport();this.svg.attr("width",o.width).attr("height",o.height);var a=JSON.parse(this.viewModel.shapeMap.content),u=e.loadFeatureCollection(a);this.matcher=new yr(u.features,this.viewModel.dataPoints,this.viewModel.categoryName);var p,s=this.featuresToZoomTo(u,i),c=this.projection&&!this.viewModel.autoZoom&&!this.viewModel.selectionZoom&&this.prevAutoZoom===this.viewModel.autoZoom&&this.prevManualZoom===this.viewModel.manualZoom&&this.prevSelectionZoom===this.viewModel.selectionZoom&&this.prevShapeMapName===this.viewModel.shapeMap.name&&this.prevMapViewportWidth===o.width&&this.prevMapViewportHeight===o.height;if(this.prevAutoZoom=this.viewModel.autoZoom,this.prevManualZoom=this.viewModel.manualZoom,this.prevSelectionZoom=this.viewModel.selectionZoom,this.prevShapeMapName=this.viewModel.shapeMap.name,this.prevMapViewportWidth=o.width,this.prevMapViewportHeight=o.height,c)p=this.projection;else{p=e.createProjection(this.viewModel.projectionEnum);var l=e.rotationAxes(this.viewModel.projectionEnum);e.adjustProjection(p,l,o.width,o.height,s,this.hostServices,.9)}var f=this.createGetColorFunction();this.mapG.style("stroke-width",this.viewModel.borderThickness/2).style("stroke",this.viewModel.borderColor).style("fill",this.viewModel.defaultColor);var v=this.mapG.selectAll("path").data(this.visibleFeatures(u),this.shapeKeyFunction(u));this.shapesExit=void 0;var d=!1;if(this.interactivityService&&(d=this.interactivityService.hasSelection()),!this.projection||t)this.projection=p,this.path=be().projection(this.projection),this.shapes=v.enter().append("path").merge(v),this.shapes.attr("d",this.path).style("fill",f).style("opacity",function(g){var N=r.getDataPointFromShape(g);return(0,Yt.eR)(N&&N.selected,!1,d,!1)}),this.setAccessibilityAttributes(this.shapes,d),v.exit().remove(),this.manualZoomConnect();else if(this.path=be().projection(this.projection),this.shapes=v.enter().append("path").style("fill",f).style("opacity",0).attr("d",this.path).merge(v),this.setAccessibilityAttributes(this.shapes,d),this.shapes.transition().duration(600).style("fill",f).style("opacity",function(g){var N=r.getDataPointFromShape(g);return(0,Yt.eR)(N&&N.selected,!1,d,!1)}),this.shapesExit=v.exit(),this.shapesExit.transition().duration(600).style("fill",f).style("opacity",0).remove(),e.projectionsEqual(this.projection,p))this.projection=p,this.shapes.attr("d",this.path),this.shapesExit.attr("d",this.path),this.manualZoomConnect();else{var y=this.projection,M=p;this.mapG.transition().duration(600).tween("projection transition",function(){var g=y.scale&&d3.interpolate(y.scale(),M.scale()),N=y.translate&&d3.interpolate(y.translate(),M.translate()),Y=y.rotate&&d3.interpolate(y.rotate(),M.rotate());return y=null,M=null,function(k){g&&r.projection.scale(g(k)),N&&r.projection.translate(N(k)),Y&&r.projection.rotate(Y(k)),r.shapes.attr("d",r.path),r.shapesExit.attr("d",r.path)}}).on("end",function(){return r.manualZoomConnect()})}if(this.tooltipsEnabled){var Z=[];this.viewModel.dataAvailable||(Z=this.matcher.shapeProps.map(function(g){return g.propName}).sort()),this.tooltipService.addTooltip(this.shapes,function(g){if(r.viewModel.dataAvailable){if(!g.data)return;var N=r.matcher.getDataPointFromShape(g.data);return N?N.tooltipInfo:[{displayName:r.viewModel.categoryName,value:""+r.matcher.getShapeProp(g.data,r.matcher.shapePropName)||""}]}return Z.map(function(Y){return{displayName:Y||"ID",value:""+r.matcher.getShapeProp(g.data,Y)}})},function(g){var N=g.data&&r.matcher.getDataPointFromShape(g.data);if(N)return N.identity&&[N.identity]})}this.behavior&&this.interactivityService&&this.interactivityService.bind(this.viewModel.dataPoints,this.behavior,{shapes:this.shapes,clearCatcher:this.clearCatcher},{pointSourceKey:"shape-map"})}else this.resetToDefault||(this.resetToDefault=!0,this.resetToDefaultMap())},e.prototype.setAccessibilityAttributes=function(t,i){var r=this;t.attr("tabindex",function(o){return r.getDataPointFromShape(o)?"0":void 0}).attr("aria-selected",function(o){var a=r.getDataPointFromShape(o);if(a)return i&&a.selected})},e.prototype.visibleFeatures=function(t){var i=this;return this.viewModel.defaultShow?t.features:t.features.filter(function(r){return!!i.getDataPointFromShape(r)})},e.prototype.shapeKeyFunction=function(t){return t.features[0]&&null!=t.features[0].id?function(i){return i.id}:null},e.projectionsEqual=function(t,i){return!(t.scale&&!_.isEqual(t.scale(),i.scale())||t.rotate&&!_.isEqual(t.rotate(),i.rotate())||t.translate&&!_.isEqual(t.translate(),i.translate()))},e.prototype.manualZoomConnect=function(){var t,i=this;if(!this.zoom&&this.viewModel.manualZoom){var a=this.projection.scale(),u=[a/4,16*a];this.zoom=d3.zoom().scaleExtent(u).on("zoom",function(){var s=d3.event.transform;i.projection.translate([s.x,s.y]).scale(s.k),i.shapes.attr("d",i.path)}),this.svg.call(this.zoom).call(this.zoom.transform,(t=d3.zoomIdentity).translate.apply(t,this.projection.translate()).scale(a))}},e.prototype.manualZoomDisconnect=function(){this.zoom&&this.zoom.on("zoom",null),this.zoom=null},e.prototype.getMapViewport=function(){var t=this.viewport,i=this.legend.getMargins();return{width:t.width-i.width,height:t.height-i.height}},e.prototype.renderLegend=function(){var t=this.viewModel.legendData;null!=t.position&&this.legend.setPosition(t.position),1===t.dataPoints.length&&!t.grouped&&!this.viewModel.hasDynamicSeries&&(t.dataPoints=[]),this.legend.drawLegend({data:t,parentViewport:this.viewport})},e.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},e.prototype.onRestoreSelection=function(t){return!!this.interactivityService&&this.interactivityService.restoreSelection(t.selection)},e}(),yr=function(){function e(t,i,r){this.shapes=t,this.dataPoints=i,this.categoryName=r,this.shapeProps=this.countShapeProps(this.shapes),this.shapeProps=this.shapeProps.sort(this.getShapePropCompareFunction(this.categoryName)),this.buildMappings()}return e.prototype.getDataPointFromShape=function(t){var i=this.getShapeProp(t,this.shapePropName);return i||0===i?this.shapeToData[i]:null},e.prototype.getShapeFromDataPoint=function(t){return this.dataToShape[t.location]},e.prototype.countShapeProps=function(t){for(var i={},r=0,o=t.length,a=0;a<o;a++){var u=t[a];for(var s in u.hasOwnProperty("id")&&r++,u.properties)i.hasOwnProperty(s)?i[s]++:i[s]=1}var c=[];for(var s in i)i.hasOwnProperty(s)&&c.push({propName:s,count:i[s]});return r>0&&c.push({propName:"",count:r}),c},e.prototype.getShapePropCompareFunction=function(t){return function(i,r){if(i.count!==r.count)return r.count-i.count;if(t){if(i.propName===t)return-1;if(r.propName===t)return 1;if(t=t.toLowerCase().trim(),i.propName.toLowerCase().trim()===t)return-1;if(r.propName.toLowerCase().trim()===t)return 1}return 0}},e.prototype.getShapeProp=function(t,i){return""===i?t.id:t.properties[i]},e.prototype.removeAtIndex=function(t,i){return t.slice(0,i).concat(t.slice(i+1))},e.prototype.buildMappings=function(){var t=0;t:for(var i=0,r=this.shapeProps;i<r.length;i++){var o=r[i];if(t>o.count)break t;for(var a=0,u={},s={},c=this.shapes,p=this.dataPoints,l=c.length-1;l>=0;l--){var h=c[l],f=this.getShapeProp(h,o.propName);if(f||0===f){n:for(var v=0;v<p.length;v++){var d=p[v],w=d.location;if(null!=w&&(w===f||w.toLowerCase&&f.toLowerCase&&w.toLowerCase()===f.toLowerCase())){u[w]=h,s[f]=d,c=this.removeAtIndex(c,l),p=this.removeAtIndex(p,v),a++;break n}}if(0===c.length||0===p.length){t=a,this.shapePropName=o.propName,this.shapeToData=s,this.dataToShape=u;break t}}}a>t&&(t=a,this.shapePropName=o.propName,this.shapeToData=s,this.dataToShape=u)}},e}()}}]);