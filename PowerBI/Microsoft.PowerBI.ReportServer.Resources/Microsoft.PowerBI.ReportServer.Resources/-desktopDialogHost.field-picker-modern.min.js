"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["field-picker-modern"],{13941:function(Me,re,g){function y(V){return"add"===V.type}function u(V){return"delete"===V.type}function q(V){return"reorder"===V.type}function t(V){return"replace"===V.type}function N(V){return"rename"===V.type}function T(V){return"initialize"===V.type}g.d(re,{H2:function(){return u},JB:function(){return y},V5:function(){return T},cA:function(){return t},cS:function(){return q},y$:function(){return N}})},30324:function(Me,re,g){g.r(re),g.d(re,{FieldPickerModernModule:function(){return Pn}});var y=g(81337),u=g(77476),q=g(17174),t=g(83008),N=g(11494),T=g(82156),V=g(79061),ee=g(41920),te=g(56598),H=g(6015),J=g(63654),ae=g(94841),j=g(66972),G=g(16748),ge=g(16095),Q=g(35284),ne=g(17177),W=g(35510),se=g(14463),ce=function(){function l(){this.visibility$=new W.X(!1)}return l.prototype.setVisibility=function(r){this.visibility$.next(r)},l.prototype.getVisibility$=function(){return this.visibility$.asObservable()},l}(),K={provide:"fieldPickerFlyoutService",useFactory:function(l){var r=new ce;return l.resolve(r)},deps:[se.t]},e=g(50423),pe=g(82762),ue=g(59017),_e=g(14172),Le=g(77526),Ve=g(81905),Be=g(48787),Ae=g(83317),Y=g(4722),Ce=g(67290),Re=g(74804),P=g(62458),B=g(50550),k=g(45413),I=g(45551),U=g(44529),Z=g(88315),oe=g(98209),Oe=g(94419),we=g(74082),ve=g(25512),ke=g(64560),at=g(8590),Ne=g(86940),lt=g(88819),Ke=g(59725),st=g(68509),je=g(73221),ze=g(54834),ct=g(95862),Qe=g(45334),dt=g(80777),Ze=g(46135),Xe=g(81141),Ge=g(75096),He=g(72525),pt=g(65534),Je=g(66014),We=g(78963),Fe=g(23983),Ee=g(86286),gt=g(70863);function Ye(l){var c,n=l.allowSelectEntities,i=l.groupingDesignStateService,s=l.flatNode.node.data;if(P.fF.assertValue(s,"flatNode.node.data"),!(0,gt.Ov)(s)){if(s instanceof Z.e){if(!n)return;c=(0,Oe.nw)(s.contractSchema.name,s.contract.name)}else s instanceof Z.Xx?c=(0,U.Sd)(s,i):P.fF.assertFail("Expect flatNode to be either FieldListConceptualEntity or FieldListConceptualItem");return{newSelection:c,action:0}}}var qe=function(){function l(r,n){this.overlayData=r,this.groupingDesignStateService=n}return l.prototype.check=function(r){var n=Ye({flatNode:r.flatNode,allowSelectEntities:this.overlayData.allowSelectEntities,groupingDesignStateService:this.groupingDesignStateService});n&&(r.checked?(r.flatNode.node.checked=!0,this.overlayData.handleCheckedField(n)):(r.flatNode.node.checked=!1,this.overlayData.handleUncheckedField(n)))},l.\u0275fac=function(n){return new(n||l)(e.\u0275\u0275inject(Ee.M),e.\u0275\u0275inject(Fe.AA))},l.\u0275prov=e.\u0275\u0275defineInjectable({token:l,factory:l.\u0275fac}),l}(),et=g(13702),tt=g(65181),ut=g(59968),vt=g(50057),nt=g(76492),mt=g(58679),ft=g(42189),Ue=g(9529),$e=g(36858),be=g(65005),it=g(74913),d=g(85102),a=["fieldListDropdown"];function o(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.createVisualCalc())}),e.\u0275\u0275element(1,"tri-svg-icon",12),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("localizeTooltip",i.visualCalcCreationInfo.tooltip)}}function v(l,r){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",15),e.\u0275\u0275element(2,"span",16),e.\u0275\u0275elementStart(3,"p",17),e.\u0275\u0275element(4,"span",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("innerHtml",n.perspectiveDoesNotExistsDescriptionHtml,e.\u0275\u0275sanitizeHtml)}}function m(l,r){if(1&l&&(e.\u0275\u0275element(0,"span",19),e.\u0275\u0275elementStart(1,"p",17),e.\u0275\u0275element(2,"span",18),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("innerHtml",n.perspectiveExistsDescriptionHtml,e.\u0275\u0275sanitizeHtml)}}function b(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275template(1,v,5,1,"ng-container",9),e.\u0275\u0275template(2,m,3,1,"ng-template",null,14,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275reference(3),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.perspectiveDoesNotExist)("ngIfElse",n)}}function C(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.selectedDisplayName," ")}}function F(l,r){1&l&&e.\u0275\u0275element(0,"span",32)}function O(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=r.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function L(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",33),e.\u0275\u0275element(1,"h2",34),e.\u0275\u0275elementStart(2,"pbi-dropdown",35),e.\u0275\u0275listener("valueChange",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(p.onAggregationChanged(c.property))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementStart(5,"pbi-dropdown-trigger")(6,"div",25)(7,"span"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(9,O,2,2,"pbi-dropdown-item",36),e.\u0275\u0275elementEnd()()}if(2&l){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("disabled",i.aggregationDropdown.isDisabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",i.aggregationDropdown.selectedItem)("pbiTooltip",i.aggregationDropdown.isDisabled&&e.\u0275\u0275pipeBind1(3,8,"FieldPicker_AggregationsDisabled"))("aria-label",e.\u0275\u0275pipeBind1(4,10,"Summarization"))("isDisabled",i.aggregationDropdown.isDisabled),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(null==i.aggregationDropdown.selectedItem?null:i.aggregationDropdown.selectedItem.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",i.aggregationDropdown.items)}}function R(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"pbi-dropdown-item",37),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=r.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function z(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",38),e.\u0275\u0275element(1,"h2",39),e.\u0275\u0275elementStart(2,"pbi-dropdown",40),e.\u0275\u0275listener("valueChange",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(p.onVariationChanged(c.property))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementStart(4,"pbi-dropdown-trigger")(5,"div",25)(6,"span"),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,R,2,2,"pbi-dropdown-item",36),e.\u0275\u0275elementEnd()()}if(2&l){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("disabled",i.variationsDropdown.isDisabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",i.variationsDropdown.selectedItem)("aria-label",e.\u0275\u0275pipeBind1(3,7,"Date"))("isDisabled",i.variationsDropdown.isDisabled),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==i.variationsDropdown.selectedItem?null:i.variationsDropdown.selectedItem.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",i.variationsDropdown.items)}}function ht(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",20),e.\u0275\u0275element(2,"h2",21),e.\u0275\u0275elementStart(3,"pbi-dropdown",22,23),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementStart(6,"pbi-dropdown-trigger",24)(7,"div",25),e.\u0275\u0275template(8,C,2,1,"span",26),e.\u0275\u0275template(9,F,1,0,"span",27),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"pbi-field-list",28),e.\u0275\u0275listener("onNodeClick",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onNodeClick(c))}),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"div",29),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(13,L,10,12,"div",30),e.\u0275\u0275template(14,z,9,9,"div",31),e.\u0275\u0275elementContainerEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("aria-label",e.\u0275\u0275pipeBind1(5,12,"Field"))("options",i.fieldListDropdownOptions)("maxHeight",i.fieldListDropdownMaxHeight),e.\u0275\u0275advance(3),e.\u0275\u0275property("pbiTooltip",i.selectedItemTooltip),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.selectedDisplayName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.selectedDisplayName),e.\u0275\u0275advance(1),e.\u0275\u0275property("fieldListTree",e.\u0275\u0275pipeBind1(11,14,i.fieldListTree$))("scrollSelectedItemIntoViewOnInit",i.openFieldDropdownOnInit)("hasHighlights",!1)("options",i.fieldListTreeOptions),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.aggregationDropdown),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.variationsDropdown&&!i.variationsDropdown.isDisabled)}}function kt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"pbi-field-list",41),e.\u0275\u0275listener("onNodeClick",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onMultiSelectNodeClick(c))})("handleFieldListTreeHeightDiff",function(c){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.handleFieldListTreeHeightDiff(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext();e.\u0275\u0275property("fieldListTree",e.\u0275\u0275pipeBind1(1,4,i.fieldListTree$))("options",i.fieldListTreeOptions)("checkMode",i.multiCheckMode)("focusSearchBoxOnFirstRenderComplete",!0)}}var St=function(l){function r(n,i,s,c,p,f,h,D,x,w,E){var M=l.call(this)||this;return M.overlayData=n,M.checkableSetting=i,M.checkStrategy=s,M.explorationDisplayNameService=c,M.fieldListTreeService=p,M.groupingDesignStateService=f,M.hideMenuSetting=h,M.inlineItemsExtendShowOrHideSettingStrategy=D,M.localizationService=x,M.overlayRef=w,M.tooltipStrategy=E,M.fieldListTree$=M.fieldListTreeService.fieldListTree$,M.defaultPerspective="",M.fieldListTreeOptions={check:M.checkStrategy,editLabel:null,tooltip:M.tooltipStrategy},M.multiCheckMode=Ke.kH.Multi,M}return(0,y.__extends)(r,l),r.prototype.ngOnInit=function(){var n,i=(n=this.overlayData).fieldListModel,s=n.allowSelectEntities,c=n.perspectiveDisplayName,p=n.schema,f=n.perspectiveDoesNotExist,h=n.openedByKeyboard,D=n.isAddingData;P.fF.assertValue(i,"fieldListModel"),this.perspectiveDoesNotExist=f,this.inNonDefaultPerspective=c&&c!==this.defaultPerspective,this.allowSelectEntities=s,this.perspectiveDoesNotExistsDescriptionHtml=this.localizationService.format("PersonalizeVisual_PerspectiveDescription_With_CubeNameError",c),this.perspectiveExistsDescriptionHtml=this.localizationService.format("PersonalizeVisual_PerspectiveDescription_V2",c),this.isAddingData=D,this.visualCalcCreationInfo=this.overlayData.visualCalcCreationInfo,this.initAggregationDropdown(),P.fF.assertValue(this.aggregationDropdown,"aggregationDropdown should be initialized"),this.initVariationDropdown(),this.openFieldDropdownOnInit=!D&&!h&&this.aggregationDropdown.isDisabled,p&&i&&this.initFieldList()},Object.defineProperty(r.prototype,"fieldListDropdownOptions",{get:function(){return{panelClass:this.overlayData.fieldListOverlayPanelClass}},enumerable:!1,configurable:!0}),r.prototype.ngAfterViewInit=function(){this.isAddingData||(this.fieldListDropdownMaxHeight=this.getFieldListDropdownMaxHeight(),this.openFieldDropdownOnInit&&this.fieldListDropdown.openDropdown())},r.prototype.getFieldListDropdownMaxHeight=function(){var n=this.fieldListDropdownElementRef.nativeElement.getBoundingClientRect(),s=document.documentElement.clientHeight-n.bottom;return Math.max(n.top,s)-4},r.prototype.onAggregationChanged=function(n){var i=this.aggregationDropdown.items.find(function(s){return s.property===n});P.fF.assertValue(i,"aggregationsDropdown.items should contain the selected item"),i&&(this.aggregationDropdown=(0,y.__assign)((0,y.__assign)({},this.aggregationDropdown),{selectedItem:i}),this.onDropdownItemSelected(i))},r.prototype.onVariationChanged=function(n){var i=this.variationsDropdown.items.find(function(s){return s.property===n});P.fF.assertValue(i,"variationsDropdown.items should contain the selected item"),i&&(this.variationsDropdown=(0,y.__assign)((0,y.__assign)({},this.variationsDropdown),{selectedItem:i}),this.onDropdownItemSelected(i))},r.prototype.onDropdownItemSelected=function(n){this.overlayData.onMenuItemSelected(n.property),this.closeOverlay()},r.prototype.initFieldList=function(){var n,i=(n=this.overlayData).visualCapabilities,s=n.fieldListModel,c=n.currentSelection,p=n.disabledCollection,f=n.schema;c=c??[],this.inlineItemsExtendShowOrHideSettingStrategy.addHiddenItemsOnly=!0,this.inlineItemsExtendShowOrHideSettingStrategy.hideInlineItemTooltip="Field_ShowHiddenFieldFromDataPane";var h=1===_.size(s.tables);this.fieldListTreeService.modelToPbiTreeConverterOptions={checkableSetting:this.checkableSetting,showMenuSetting:this.hideMenuSetting,expandedSetting:new Tt(h),inlineItemsSetting:this.inlineItemsExtendShowOrHideSettingStrategy};var D=_.flatMapDeep(c,function(E){return s.findItems(E,f,{excludeVariationSource:!0,excludeHierarchyLevels:!0})}),x=_.flatMapDeep(p,function(E){return s.findItems(E,f,{excludeVariationSource:!0,excludeHierarchyLevels:!0},{excludeHierarchy:!0,excludeVariationSource:!0})});this.fieldListTreeService.setOrUpdateFieldListTreeModel(s,D,void 0,x),P.fF.assert(function(){return c.length<=1},"Expected no more than 1 selection");var w=_.first(c);w&&(this.selectedDisplayName=this.explorationDisplayNameService.getDisplayName(w,f,i,void 0,void 0,{includeHierarchyName:!0,includeVariationSource:!0}),this.selectedItemTooltip=this.explorationDisplayNameService.getQualifiedDisplayName(w,f,i,{includeHierarchyName:!0,includeVariationSource:!0}))},r.prototype.initAggregationDropdown=function(){var i=this.initDropdown(this.overlayData.aggregationMenuItems);if(!i.selectedItem){var s=this.localizationService.get("Count_Visuals_0");i.selectedItem={name:s,property:s}}this.aggregationDropdown=i},r.prototype.initVariationDropdown=function(){var i=this.initDropdown(this.overlayData.variationsMenuItems);this.variationsDropdown=i},r.prototype.initDropdown=function(n){var i={items:[],isDisabled:!1};if(_.isEmpty(n))return i.isDisabled=!0,i;for(var s=0,c=n;s<c.length;s++){var p=c[s],f={name:p.text,property:p};p.checked&&(i.selectedItem=f),i.items.push(f)}return i},r.prototype.onNodeClick=function(n){var i=Ye({flatNode:n,allowSelectEntities:this.allowSelectEntities,groupingDesignStateService:this.groupingDesignStateService});i&&this.overlayRef.close(i)},r.prototype.onMultiSelectNodeClick=function(n){this.checkStrategy.check({flatNode:n,checked:!n.node.checked})},r.prototype.closeOverlay=function(){this.overlayRef.close()},r.prototype.createVisualCalc=function(){this.overlayRef.close({newSelection:void 0,action:2})},r.prototype.handleFieldListTreeHeightDiff=function(n){if(n>0){var i=this.overlayRef.overlayRef.overlayElement.getBoundingClientRect().height;this.overlayRef.overlayRef.updateSize({height:i+n})}},r.\u0275fac=function(i){return new(i||r)(e.\u0275\u0275directiveInject(Ee.M),e.\u0275\u0275directiveInject(Xe.x),e.\u0275\u0275directiveInject(qe),e.\u0275\u0275directiveInject(et.O),e.\u0275\u0275directiveInject(Ge.p),e.\u0275\u0275directiveInject(Fe.AA),e.\u0275\u0275directiveInject(We.W),e.\u0275\u0275directiveInject(He.VI),e.\u0275\u0275directiveInject(tt.o),e.\u0275\u0275directiveInject(Ee.w),e.\u0275\u0275directiveInject(Je.Z))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["field-picker-flyout"]],viewQuery:function(i,s){if(1&i&&(e.\u0275\u0275viewQuery(a,5),e.\u0275\u0275viewQuery(a,5,e.ElementRef)),2&i){var c=void 0;e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.fieldListDropdown=c.first),e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.fieldListDropdownElementRef=c.first)}},features:[e.\u0275\u0275ProvidersFeature([Xe.x,qe,Ge.p,Fe.AA,He.wt,He.VI,pt.n,Je.Z,{provide:We.W,useClass:We.w}]),e.\u0275\u0275InheritDefinitionFeature],decls:13,vars:7,consts:[["role","dialog","aria-labelledby","flyoutContainerTitle",1,"flyout-container"],[1,"header"],["id","flyoutContainerTitle","localize","TaskPane_Fields",1,"fluentTheme-lg-semiBold"],[1,"action-button-container"],["data-testid","create-visual-calc-button","tri-button","","size","small","appearance","subtle","class","increased-contrast",3,"localizeTooltip","click",4,"ngIf"],["localizeTooltip","Close",1,"glyphicon","glyph-mini","pbi-glyph-close","pbi-icon-button","pbi-focus-outline","close-button",3,"click"],[1,"field-list-container"],["class","pbi-field-list-perspective-header",4,"ngIf"],[1,"field-list-content"],[4,"ngIf","ngIfElse"],["multiSelectFieldList",""],["data-testid","create-visual-calc-button","tri-button","","size","small","appearance","subtle",1,"increased-contrast",3,"localizeTooltip","click"],["sprite","visual-calc-icons","name","data_histogram_function_20_regular"],[1,"pbi-field-list-perspective-header"],["showPerspectiveInfo",""],[1,"perspective-error"],["role","presentation",1,"glyphicon","glyph-small","pbi-glyph-error"],[1,"fluentTheme-sm-reg"],[3,"innerHtml"],["role","presentation",1,"glyphicon","glyph-small","pbi-glyph-info"],[1,"field-picker"],["localize","Field",1,"fluentTheme-sm-reg"],["size","xs","dropdown-type","field-list",1,"field-list-field",3,"aria-label","options","maxHeight"],["fieldListDropdown",""],[3,"pbiTooltip"],[1,"field-list-trigger","dropdown-trigger"],[4,"ngIf"],["localize","Select_A_Field",4,"ngIf"],["focus-nav-mode","Browser",1,"field-list-field-dropdown",3,"fieldListTree","scrollSelectedItemIntoViewOnInit","hasHighlights","options","onNodeClick"],["tabindex","0",1,"container-stop-bottom"],["class","aggregation-picker",4,"ngIf"],["class","variations-picker",4,"ngIf"],["localize","Select_A_Field"],[1,"aggregation-picker"],["localize","Summarization",1,"fluentTheme-sm-reg"],["size","xs",1,"field-list-aggregate",3,"value","pbiTooltip","aria-label","isDisabled","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"variations-picker"],["localize","Date",1,"fluentTheme-sm-reg"],["size","xs",1,"field-list-variation",3,"value","aria-label","isDisabled","valueChange"],[1,"multi-select-field-list",3,"fieldListTree","options","checkMode","focusSearchBoxOnFirstRenderComplete","onNodeClick","handleFieldListTreeHeightDiff"]],template:function(i,s){if(1&i&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275element(2,"h1",2),e.\u0275\u0275elementStart(3,"div",3),e.\u0275\u0275template(4,o,2,1,"button",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",5),e.\u0275\u0275listener("click",function(){return s.closeOverlay()}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"section",6),e.\u0275\u0275template(8,b,4,2,"div",7),e.\u0275\u0275elementStart(9,"div",8),e.\u0275\u0275template(10,ht,15,16,"ng-container",9),e.\u0275\u0275template(11,kt,2,6,"ng-template",null,10,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()()),2&i){var c=e.\u0275\u0275reference(12);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",s.isAddingData&&s.visualCalcCreationInfo.supportVisualCalcCreation),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,5,"Close")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",s.inNonDefaultPerspective),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!s.isAddingData)("ngIfElse",c)}},dependencies:[u.NgForOf,u.NgIf,ut.X,vt.r,nt.H,mt.I,ft.r,Ue._,nt.T,$e.V,be.l,it.M,u.AsyncPipe,d.F],styles:['[_nghost-%COMP%]{height:100%;width:100%;background-color:var(--colorNeutralBackground3);border:1px solid var(--colorNeutralStroke3);border-radius:2px;color:var(--colorNeutralForeground1);padding:0;box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 4px 8px var(--colorNeutralShadowKey)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;margin:8px 8px 4px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action-button-container[_ngcontent-%COMP%]{display:flex;flex:auto;justify-content:flex-end;margin-bottom:4px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{width:24px;height:24px;color:var(--colorNeutralForeground1)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground1Hover)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:active{background-color:var(--colorNeutralBackground1Pressed)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]{margin:4px 8px 8px;height:100%}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 4px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:8px}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]   pbi-dropdown[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%]   .dropdown-trigger[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%]   .dropdown-trigger[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]   .dropdown-trigger[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .field-picker[_ngcontent-%COMP%]   h2.disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .aggregation-picker[_ngcontent-%COMP%]   h2.disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   .field-list-container[_ngcontent-%COMP%]   .field-list-content[_ngcontent-%COMP%]   .variations-picker[_ngcontent-%COMP%]   h2.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   button[tri-button].increased-contrast[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground3Hover)}[_nghost-%COMP%]   .flyout-container[_ngcontent-%COMP%]   button[tri-button].increased-contrast[_ngcontent-%COMP%]:active:hover{background-color:var(--colorNeutralBackground3Pressed);color:var(--colorNeutralForeground2Pressed)}.pbi-overlay-caret-small.pbi-overlay-caret[_nghost-%COMP%]:after{background:var(--colorNeutralBackground3)!important;border-color:var(--colorNeutralStroke1Selected)}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]{display:flex;margin:12px 0 4px}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   .pbi-glyph-error[_ngcontent-%COMP%]{color:var(--colorDangerForeground1)}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{margin:3px 8px 0 0}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--colorNeutralForeground1)}[_nghost-%COMP%]   .pbi-field-list-perspective-header[_ngcontent-%COMP%]   .perspective-error[_ngcontent-%COMP%]{background-color:var(--colorDangerBackground1);display:flex;padding:8px}.field-list-field-dropdown[_ngcontent-%COMP%]{padding:8px;height:380px}'],changeDetection:0}),r}(je.w),Tt=function(){function l(r){this.hasSingleTable=r}return l.prototype.isExpanded=function(r){return"Hierarchy"===r.modelObjectType||"Table"===r.modelObjectType&&this.hasSingleTable},l.prototype.isExpandedStateFixed=function(r){return"Hierarchy"===r.modelObjectType},l}(),It=g(98476),Se=g(13941),bt=g(58609),Lt=g(28199),Vt=g(26898),Bt=g(61451),At=g(77200),Rt=g(27980),Nt=g(80357),zt=function(){function l(){}return l.prototype.transform=function(r,n){if(null!=r){var i=n.split(",").map(function(s){return Number(s)});return(0,Y.X)(r,i)}},l.\u0275fac=function(n){return new(n||l)},l.\u0275pipe=e.\u0275\u0275definePipe({name:"itemAtPosition",type:l,pure:!0}),l}(),Ht=["dragDropPickerRef"],Wt=["openFlyoutChevron"];function Ut(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"label",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.label)}}var $t=function(r){return{v2Design:r}};function Kt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",8)(2,"button",9),e.\u0275\u0275listener("click",function(){var p=e.\u0275\u0275restoreView(n);return e.\u0275\u0275resetView(p.ngIf.handler())}),e.\u0275\u0275element(3,"tri-svg-icon",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&l){var i=r.ngIf,s=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(5,$t,s.withFieldList)),e.\u0275\u0275attribute("aria-label",i.tooltip),e.\u0275\u0275advance(1),e.\u0275\u0275property("name",i.svgIconName)("sprite",i.svgIconSpriteName)("pbiTooltip",i.tooltip)}}function jt(l,r){if(1&l&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Kt,4,7,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&l){var n=r.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,n.promotedAction$))}}function Qt(l,r){if(1&l&&(e.\u0275\u0275template(0,jt,3,3,"ng-container",1),e.\u0275\u0275pipe(1,"itemAtPosition"),e.\u0275\u0275pipe(2,"async")),2&l){var n=r.position,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind2(1,1,e.\u0275\u0275pipeBind1(2,4,i.fieldsView$),n.join(",")))}}var Zt=function(r,n){return{v2Design:r,error:n}};function Xt(l,r){if(1&l&&e.\u0275\u0275element(0,"div",16),2&l){var n=e.\u0275\u0275nextContext(2).field,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(1,Zt,i.withFieldList,n.invalid))}}function Gt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17,18),e.\u0275\u0275listener("click",function(h){e.\u0275\u0275restoreView(n);var D=e.\u0275\u0275reference(1),x=e.\u0275\u0275nextContext(2).position,w=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(w.openFlyout({overlayOrigin:D.parentElement.parentElement,fromFieldPosition:x,openedByKeyboard:0===h.detail}))})("keydown.arrowLeft",function(){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(h.focusClearButton())}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext(2),s=i.field,c=i.position,p=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("pbiTooltip",s.actionTooltip),e.\u0275\u0275attribute("aria-expanded",p.arePositionsEqual(e.\u0275\u0275pipeBind1(2,2,p.flyoutOpenPosition$),c))}}function Jt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",19),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(2).position,f=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(f.directEditStrategy.onEdit(p))})("keydown.arrowLeft",function(){e.\u0275\u0275restoreView(n);var p=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(p.focusClearButton())}),e.\u0275\u0275element(1,"tri-svg-icon",20),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext(2).position,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("pbiTooltip",s.directEditStrategy.getActionTooltip())("disabled",s.directEditStrategy.isDisabled(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","edit_20_regular")}}function Yt(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",21),e.\u0275\u0275listener("pbiMenuButtonClick",function(p){e.\u0275\u0275restoreView(n);var f=e.\u0275\u0275nextContext(2).position,h=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(h.onMenuItemSelected(p,f))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementEnd()}if(2&l){var i=e.\u0275\u0275nextContext(2).field,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,4,"Options_Menu"))("pbiMenu",i.menu)("menuMode",s.CompactMenuMode)("pbiMenuActivation",s.pbiMenuActivation)}}function qt(l,r){if(1&l&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,Xt,1,4,"div",12),e.\u0275\u0275template(2,Gt,3,4,"button",13),e.\u0275\u0275template(3,Jt,2,3,"button",14),e.\u0275\u0275template(4,Yt,2,6,"button",15),e.\u0275\u0275elementEnd()),2&l){var n=e.\u0275\u0275nextContext(),i=n.position,s=n.field,c=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.withFieldList&&!c.disallowReplaceItems),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.withFieldList&&c.canOpenFlyout(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==c.directEditStrategy?null:c.directEditStrategy.shouldAllowDirectEdit(i)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!c.withFieldList&&!!s.menu)}}function en(l,r){1&l&&e.\u0275\u0275template(0,qt,5,4,"div",11),2&l&&e.\u0275\u0275property("ngIf",r.field)}function tn(l,r){if(1&l){var n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ut,2,1,"label",2),e.\u0275\u0275elementStart(2,"pbi-drag-drop-picker",3,4),e.\u0275\u0275listener("onChangeAdd",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onPickerChangeAdd(f))})("onChangeRemove",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onPickerChangeRemove(f))})("onChangeReorder",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onPickerChangeReorder(f))})("onChangeReplace",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onPickerChangeReplace(f))})("onChangeLabelUpdate",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onPickerChangeRename(f))})("onCrossPickerDrop",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onCrossPickerDrop.emit(f))})("onAddDataClick",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(!h.disabled&&h.openFlyout({overlayOrigin:f.overlayOrigin,openedByKeyboard:0===f.detail,isAddingData:!0}))})("onContentClick",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onContentClickEvent(f))})("onMenuItemClick",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.onMenuItemSelected(f.menuButton,f.position))})("onClearButtonArrowRight",function(f){e.\u0275\u0275restoreView(n);var h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.focusOpenFlyoutChevron(f))}),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275template(7,Qt,3,6,"ng-template",null,5,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(9,en,1,1,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&l){var i=e.\u0275\u0275reference(8),s=e.\u0275\u0275reference(10),c=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.label),e.\u0275\u0275advance(1),e.\u0275\u0275property("compact",c.compact)("ariaLabelledby",c.ariaLabelledby)("dataFormat",c.parameterPickerDataFormat)("disabled",e.\u0275\u0275pipeBind1(4,28,c.changes$("disabled")))("placeholder",e.\u0275\u0275pipeBind1(6,32,"FieldDropZone_AddFields"))("addDataLabelKey",c.addDataLabelKey)("addDataAriaLabelKey",c.addDataAriaLabelKey)("draggable",c.allowReorderItems)("allowEditingLabelsSetting",c.allowEditingLabelsSetting)("allowMultipleValues",c.allowMultipleValues)("allowClear",c.allowClear)("disableDropZoneIndicator",c.disableDropZoneIndicator)("disableContentClick",c.disallowReplaceItems)("pbiDragDropPickerActionsTemplate",s)("itemPromotedActionTemplate",i)("externalCrossPickerDragDropMonitor",c.externalCrossPickerDragDropMonitor)("v2Design",c.withFieldList)("menuMode",c.CompactMenuMode)("useCustomTooltip",c.useCustomTooltip)("tooltipPosition",c.tooltipPosition)("tooltipWithFlexiblePositions",c.tooltipWithFlexiblePositions)("disableAutoScroll",c.disableAutoScroll)("disableClearButtonTabNavigation",!0)("allowEmptyLabel",c.emptyFieldSetsDefaultLabel),e.\u0275\u0275attribute("aria-labelledby",c.ariaLabelledby)("aria-describedby",c.ariaDescribedby)("aria-disabled",e.\u0275\u0275pipeBind1(5,30,c.changes$("disabled")))}}var nn=function(r){return{value:r}},ln=function(l){function r(n,i,s,c,p,f,h,D,x,w,E,M,A,ie,X){var S=l.call(this)||this;return S.aggrOps=n,S.conceptualSchemaProxy=i,S.dataSourcesService=s,S.displayNameService=c,S.eventBridge=p,S.groupingDesignStateService=f,S.injector=h,S.localizationService=D,S.pbiOverlay=x,S.reportSettingsService=w,S.viewModeState=E,S.visualAuthoringOperationsService=M,S.pbiOverlayFactory=A,S.visualActionContext=ie,S.hostOverlayRef=X,S.withFieldList=!1,S.parameterPickerDataFormat=Ke.L$,S.onExprChange=new e.EventEmitter,S.onCrossPickerDrop=new e.EventEmitter,S.flyoutOpenPosition$=new W.X(void 0),S.pbiMenuActivation="both",S.CompactMenuMode=ke.Kb.Compact,S.fieldsMetadataUpdate$=new W.X(void 0),S.fieldsViewUpdate$=new W.X(void 0),S}return(0,y.__extends)(r,l),r.prototype.ngOnInit=function(){var n=this;this.ensureStrategies(),this.changes$("enterExitFieldRename",!0).subscribe(function(i){!0===i?.modeOn?n.dragDropPickerRef.beginEditSection(i.fieldPosition):!1===i?.modeOn&&n.dragDropPickerRef.endEditSection(i.fieldPosition)}),this.lifecycleSubscriptions.add(this.eventBridge.on(at.CCe).subscribe(function(){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.resetFieldListTreeModel()];case 1:return i.sent(),[2]}})})})),this.changes$("initialExpr").pipe((0,_e.U)(function(i){if(n.allowMultipleValues||!_.isArray(i))return i&&!_.isEmpty(i)?(0,B.rY)(i):void 0;P.fF.assertFail("Expected initialExpr to be a single value when allowMultipleValues is false.")}),(0,Le.x)(function(i,s){if(_.isEmpty(s)){var c=n.fieldsMetadataUpdate$.getValue();return _.isEmpty(c?.metadata)}return function(l,r){if(_.size(l)!==_.size(r))return!1;for(var n=function(h){if(!_.some(r,function(D){return(0,k.fS)(h,D)}))return{value:!1}},i=0,s=l??[];i<s.length;i++){var p=n(s[i]);if("object"==typeof p)return p.value}return!0}(_.map(i,function(p){return p.expr}),_.map(s,function(p){return p.expr}))}),(0,Ve.w)(function(i){return(0,pe.D)(n.getSchema()).pipe((0,_e.U)(function(s){return{initialExprs:i,schema:s}}))})).subscribe(function(i){return n.updaterPickerWithInitialExprs(i.initialExprs,i.schema)}),this.lifecycleSubscriptions.add(this.fieldsMetadataUpdate$.subscribe(function(i){if(i&&(n.setFieldsViewUpdate(i),function(l){if(!l)return!1;var r=l.type;switch(r){case"add":case"delete":case"rename":case"reorder":case"replace":return!0;case"initialize":return!1;default:return P.fF.assertNever(r),!1}}(i.update))){var s=_.map(i.metadata,function(p){return{expr:p.expr,metadata:p.metadata}}),c=n.allowMultipleValues?s:_.first(s);n.onExprChange.emit({newExpr:c,fromUpdate:i.update})}})),this.lifecycleSubscriptions.add(this.fieldsViewUpdate$.subscribe(function(i){n.dragDropPickerRef&&i&&"delete"!==i.update.type&&(n.dragDropPickerRef.setAllData(_.map(i.view,function(c){return Pt(c)})),n.dragDropPickerRef.detectChanges())})),this.fieldsView$=this.fieldsViewUpdate$.pipe((0,_e.U)(function(i){return i?.view})),this.visualAuthoringOperationsService.setVisualActionContext(this.visualActionContext)},r.prototype.canOpenFlyout=function(n){var i;return!this.disallowReplaceItems&&(null===(i=this.flyoutFieldsStrategyEnsured)||void 0===i?void 0:i.canOpenFlyout(n))},Object.defineProperty(r.prototype,"allowEditingLabelsSetting",{get:function(){return"varyByItem"},enumerable:!1,configurable:!0}),r.prototype.onPickerChangeRemove=function(n){this.removeFieldMetadata(n.position)},r.prototype.onPickerChangeAdd=function(n){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.onPickerChangeAddReplaceInternal({type:"add",data:n.data,position:n.position})];case 1:return i.sent(),[2]}})})},r.prototype.onPickerChangeReplace=function(n){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.onPickerChangeAddReplaceInternal({type:"replace",data:n.data,position:n.position})];case 1:return i.sent(),[2]}})})},r.prototype.onPickerChangeReorder=function(n){this.reorderFieldMetadata(n.fromPosition,n.toPosition)},r.prototype.onPickerChangeRename=function(n){return(0,y.__awaiter)(this,void 0,void 0,function(){var i,s,c,p,f=this;return(0,y.__generator)(this,function(h){return i=n.newLabel,s=n.position,c=(0,y.__spreadArray)([],this.fieldsMetadataUpdate$.value.metadata,!0),(0,Y.ri)(c,s,function(D,x){var w=D[x];P.fF.assert(function(){return"varyByItem"===f.allowEditingLabelsSetting&&w.allowRename},"the item does not allow rename!"),D[x]=(0,y.__assign)((0,y.__assign)({},w),{displayName:{value:i,fromOverride:!0}})}),p=function(l,r){return{type:"rename",renamed:{position:l,newName:r}}}(s,i),this.updateFieldsMetadata(c,p),[2]})})},r.prototype.onPickerChangeAddReplaceInternal=function(n){var i,s;return(0,y.__awaiter)(this,void 0,void 0,function(){var c,p,f,h,D,x,w,E,M,A,ie;return(0,y.__generator)(this,function(X){switch(X.label){case 0:return[4,this.getSchema()];case 1:return c=X.sent(),P.fF.assertValue(p=n.data.fieldExpr,"expect change data has fieldExpr and value not null"),p?(f=ze.ib.deserializeExpr(p),[4,this.dropExprStrategyInternal.getDropExpr(f,c)]):[3,3];case 2:h=X.sent(),X.label=3;case 3:if(D=n.position,x="replace"===n.type,h)this.addReplaceFieldMetadata(h,f,D,x,c);else{if(!this.dragDropPickerRef)return[2];w=null===(i=this.fieldsViewUpdate$.value)||void 0===i?void 0:i.view,E=this.getEffectiveReplacementPosition(D,_.size(w),x),M=null!=E?(0,Y.X)(w,E):void 0,A=M?.pickerData,null==A?(ie="end"===D?[_.size(null===(s=this.fieldsViewUpdate$.value)||void 0===s?void 0:s.view)]:D,this.dragDropPickerRef.handleClear(ie,!0)):this.dragDropPickerRef.replaceData((0,y.__assign)((0,y.__assign)({},A),{allowEditLabel:M.allowRename,menu:M.menuFactory}),E),this.dragDropPickerRef.detectChanges()}return[2]}})})},r.prototype.onContentClickEvent=function(n){var i=n.overlayOrigin,s=n.position;this.canOpenFlyout(s)&&this.openFlyout({overlayOrigin:i,fromFieldPosition:s})},r.prototype.openFlyout=function(n){var i,s;return(0,y.__awaiter)(this,void 0,void 0,function(){var c,p,f,h,x,w,E,M,A,ie,X,S,me,ye,Pe,De,Te,xe,Ot,wt,ot=this;return(0,y.__generator)(this,function(fe){switch(fe.label){case 0:return c=n.overlayOrigin,p=n.fromFieldPosition,f=n.openedByKeyboard,h=n.isAddingData,this.shouldFieldListShowHiddenFields()===this.lastFieldListShowHiddenFields?[3,2]:[4,this.resetFieldListTreeModel()];case 1:fe.sent(),fe.label=2;case 2:return x=this.pbiOverlay.position().flexibleConnectedTo(c).withPositions([(0,ve.v3)(),(0,ve.J7)(),(0,ve.Zz)(),(0,ve.q6)(),(0,ve.Kb)(),(0,ve.Iz)()]).withFlexibleDimensions(!0).withPush(!0).withViewportMargin(4).withGrowAfterOpen(!0),null!=this.fieldListTreeModel?[3,4]:[4,this.resetFieldListTreeModel()];case 3:fe.sent(),fe.label=4;case 4:return w=null===(i=this.fieldsMetadataUpdate$.value)||void 0===i?void 0:i.metadata,P.fF.assert(function(){return _.size(p)<=2},"field-picker-modern right now only supports maximum 2-levels of fields."),E=null!=p?(0,Y.X)(w,p):void 0,M=E?.expr,[4,this.getSchemaForFlyout()];case 5:if(A=fe.sent(),ie=[],X=[],E?.menu)for(S=0,me=E.menu.items;S<me.length;S++)(ye=me[S]).type===ke.iB.Button&&(Pe=ye.data,De=Pe?.action,(4===De||2===De)&&ie.push(ye),128===De&&X.push(ye));return(xe=new WeakMap).set(bt.yk,this.visualActionContext),(null===(s=this.visualCalcFieldsStrategy)||void 0===s?void 0:s.isEditableVisualCalc(M))?[4,this.pbiOverlay.openWithFactoryLazy({modulePath:"@powerbi/ExploreUIAuthoring/lazy-modules/visual-calc-flyout/visual-calc-flyout.module#VisualCalcFlyoutModule",componentId:"VisualCalcFlyoutComponentId",data:{queryName:this.visualCalcFieldsStrategy.getQueryName(p)},options:{positionStrategy:x,hasBackdrop:!0,backdropClass:Ne.L,minWidth:150},closeOnBackdropClick:!0,hasCaret:!0,caretSize:0,injector:this.injector,providers:xe},this.pbiOverlayFactory)]:[3,7];case 6:return Te=fe.sent(),[3,9];case 7:return[4,this.flyoutFieldsStrategyEnsured.getVisualCalcCreationInfo(this.role)];case 8:Ot=fe.sent(),wt=h?this.hostOverlayRef?this.hostOverlayRef.overlayRef.overlayElement.getBoundingClientRect().height:500:void 0,Te=this.pbiOverlay.openWithFactory({component:St,data:{isAddingData:h,visualCapabilities:this.visualCapabilities,schema:A,fieldListModel:this.fieldListTreeModel,perspectiveDisplayName:this.perspectiveDisplayName,perspectiveDoesNotExist:this.perspectiveDoesNotExist,currentSelection:this.flyoutFieldsStrategyEnsured.getFieldsToSelectOnOpen(p,M),disabledCollection:this.flyoutFieldsStrategyEnsured.getFieldsToDisableOnOpen(p,M,this.fieldListTreeExprs,A),allowSelectEntities:this.allowEntityField,aggregationMenuItems:ie,variationsMenuItems:X,onMenuItemSelected:function(he){return ot.onMenuItemSelected(he,p)},openedByKeyboard:f,fieldListOverlayPanelClass:this.fieldListOverlayPanelClass,role:this.role,handleCheckedField:function(he){return ot.handleCheckedField(he,p)},handleUncheckedField:function(he){return ot.handleUncheckedField(he)},visualCalcCreationInfo:Ot},options:{positionStrategy:x,hasBackdrop:!0,backdropClass:Ne.L,minWidth:206,minHeight:wt},closeOnBackdropClick:!0,hasCaret:!0,caretSize:0,injector:this.injector,providers:xe},this.pbiOverlayFactory),fe.label=9;case 9:return null!=p&&this.flyoutOpenPosition$.next(p),Te.onClose.pipe((0,Be.q)(1)).subscribe(function(le){return(0,y.__awaiter)(ot,void 0,void 0,function(){var he,Ct;return(0,y.__generator)(this,function(Ie){switch(Ie.label){case 0:return null!=this.flyoutOpenPosition$.value&&this.flyoutOpenPosition$.next(void 0),le?function(l){return 0===l.action||2===l.action}(le)?0!==le.action?[3,2]:[4,this.flyoutFieldsStrategyEnsured.handleSelectedField(le.newSelection,p)]:[3,4]:[2];case 1:return Ie.sent(),[3,4];case 2:return 2!==le.action?[3,4]:[4,this.flyoutFieldsStrategyEnsured.onCloseWithCreateVisualCalc(this.role)];case 3:Ie.sent(),Ie.label=4;case 4:return function(l){return 1===l.action}(le)?(P.fF.assertValue(he=le.queryName,"queryName of the visual calc to be edit"),null==he?[2]:[4,null===(Ct=this.visualCalcFieldsStrategy)||void 0===Ct?void 0:Ct.onEditVisualCalc(le.queryName)]):[3,6];case 5:Ie.sent(),Ie.label=6;case 6:return[2]}})})}),[2]}})})},r.prototype.onMenuItemSelected=function(n,i){var s;return(0,y.__awaiter)(this,void 0,void 0,function(){var c,p,f,h,D,x,w=this;return(0,y.__generator)(this,function(E){switch(E.label){case 0:return[4,this.getSchema()];case 1:return c=E.sent(),(p=this.menuStrategyInternal.menuItemClickHandler(n,i,c))?(f=p.fromUpdate,h=null===(s=this.fieldsMetadataUpdate$.value)||void 0===s?void 0:s.metadata,D=(0,B.rY)(p.newExpr),x=_.map(D,function(M,A){return w.createFieldMetadata(M,M.expr,[A],c,f)}),x=_.map(x,function(M,A){return Dt(M,[A],x,h,f)}),this.updateFieldsMetadata(x,f),[2]):[2]}})})},r.prototype.handleCheckedField=function(n,i){this.flyoutFieldsStrategyEnsured.handleSelectedField(n.newSelection,i)},r.prototype.handleUncheckedField=function(n){this.flyoutFieldsStrategyEnsured.handleDeselectedField(n.newSelection)},r.prototype.focusOpenFlyoutChevron=function(n){this.openFlyoutChevronQueryList&&(this.previousFocusedClearButton=n.currentFocusedClearButton,this.openFlyoutChevronQueryList.get(n.topLevelIndex).nativeElement.focus())},r.prototype.arePositionsEqual=function(n,i){return _t(n,i)},r.prototype.focusClearButton=function(){this.previousFocusedClearButton&&this.previousFocusedClearButton.focus()},r.prototype.updaterPickerWithInitialExprs=function(n,i){var s=this,c={type:"initialize"};this.updateFieldsMetadata(_.map(n,function(p,f){return s.createFieldMetadata(p,p.expr,[f],i,c)}),c)},r.prototype.createFieldMetadata=function(n,i,s,c,p){var h,D,f=this,x=this.dropExprStrategyInternal.getDroppedExprChildren(n,s,c,p),w=p;return{expr:n.expr,metadata:n.metadata,pickerDataExpr:i,allowRename:this.nameStrategyInternal.isRenameAllowed(s,w),menu:this.menuStrategyInternal.getMenu(n.expr,s,c,p),displayName:{value:this.nameStrategyInternal.getDisplayName(n.expr,s,c,w),fromOverride:!1,pbiStyle:this.nameStrategyInternal.getDisplayNameStyle?this.nameStrategyInternal.getDisplayNameStyle(s,w):void 0},customTooltipContent:this.nameStrategyInternal.getCustomTooltipContent?this.nameStrategyInternal.getCustomTooltipContent(n.expr,c,s,w):void 0,children:_.isEmpty(x)?void 0:_.map(x,function(E,M){var A=s.concat(M);return f.createFieldMetadata(E,E.expr,A,c,p)}),promotedAction$:null===(h=this.promotedActionStrategy)||void 0===h?void 0:h.getAction(s,w),invalid:this.nameStrategyInternal.isFieldInvalid(s,w),actionTooltip:null!==(D=this.visualCalcFieldsStrategy)&&void 0!==D&&D.isEditableVisualCalc(n.expr)?this.localizationService.get("Calculation_Options"):this.localizationService.get("Data_Options")}},r.prototype.addReplaceFieldMetadata=function(n,i,s,c,p){var f;P.fF.assertValue(!c||"end"!==s,"expect position to be a valid ItemPosition when it is for replace");var h=null===(f=this.fieldsMetadataUpdate$.value)||void 0===f?void 0:f.metadata,D=this.getEffectiveReplacementPosition(s,_.size(h),c),x=null!=D,w=x?void 0:"end"===s?[_.size(h)]:s,E=x?(0,Y.X)(h,D).metadata:void 0,M=x?Mt(D,E):function(l,r,n){return{type:"add",added:{position:l,pickerOriginalExpr:r,metadata:n}}}(w,i,n.metadata),A=x?D:w,ie=this.createFieldMetadata(n,i,A,p,M),X=(0,y.__spreadArray)([],h||[],!0),S=x?1:0;if(1===_.size(A))X.splice(A[0],S,ie);else{var ye=A.slice(0,-1);(0,Y.ri)(X,ye,function(Pe,De){var Te=Pe[De],xe=(0,y.__spreadArray)([],Te.children,!0),rt=_.last(A);xe.splice(rt,S,ie),Pe[De]=(0,y.__assign)((0,y.__assign)({},Te),{children:xe})})}this.updateFieldsMetadata(X,M)},r.prototype.reorderFieldMetadata=function(n,i){var c,s=this;P.fF.assert(function(){return s.allowMultipleValues},"expect this to be called only when this allows multiple values");var p=n.slice(0,-1);P.fF.assert(function(){return _t(p,i.slice(0,-1))},"Expect reordering only among siblings. Add your implement for new scenario.");var f=null===(c=this.fieldsMetadataUpdate$.value)||void 0===c?void 0:c.metadata,h=_.isEmpty(p)?void 0:(0,Y.X)(f,p),D=h?h.children:f,x=_.last(n),w=_.last(i),E=D[x];P.fF.assert(function(){return _.inRange(x,0,_.size(D))},"fromIndex value is invalid"),P.fF.assert(function(){return _.inRange(w,0,_.size(D)+1)},"toIndex value is invalid");var A,M=(0,y.__spreadArray)([],D,!0);M[x]=void 0,M.splice(w,0,E),M=_.filter(M,function(X){return!!X}),h?(A=(0,y.__spreadArray)([],f,!0),(0,Y.ri)(A,p,function(X,S){var me=X[S];me=(0,y.__assign)((0,y.__assign)({},me),{children:M}),X.splice(S,1,me)})):A=M;var ie=function(l,r,n){return{type:"reorder",reordered:{fromPosition:l,toPosition:r,originalMetadata:n}}}(n,i,E.metadata);this.updateFieldsMetadata(A,ie)},r.prototype.removeFieldMetadata=function(n){var i,s,p,c=(0,y.__spreadArray)([],null!==(s=null===(i=this.fieldsMetadataUpdate$.value)||void 0===i?void 0:i.metadata)&&void 0!==s?s:[],!0);if(1===_.size(n))p=c.splice(n[0],1)[0];else{var h=n.slice(0,-1);p=(0,Y.ri)(c,h,function(x,w){var E=x[w],M=(0,y.__spreadArray)([],E.children,!0),A=_.last(n),ie=M.splice(A,1)[0];return x[w]=(0,y.__assign)((0,y.__assign)({},E),{children:M}),ie})}var D=function(l,r){return{type:"delete",deleted:{position:l,expr:r.expr,metadata:r.metadata}}}(n,p);this.updateFieldsMetadata(c,D)},r.prototype.updateFieldsMetadata=function(n,i){this.fieldsMetadataUpdate$.next({metadata:_.map(n,function(s){return{expr:s.expr,metadata:s.metadata,pickerDataExpr:s.pickerDataExpr,allowRename:s.allowRename,displayName:s.displayName,menu:s.menu,children:s.children,customTooltipContent:s.customTooltipContent,promotedAction$:s.promotedAction$,invalid:s.invalid,actionTooltip:s.actionTooltip}}),update:i})},r.prototype.setFieldsViewUpdate=function(n){P.fF.assertValue(n,"Expect fieldsMetadataUpdate to be defined");var i=_.map(n.metadata,function(s){return yt(s)});this.fieldsViewUpdate$.next({view:i,update:n.update})},r.prototype.ensureStrategies=function(){var n=this;(0,ue.aj)([this.changes$("alwaysAllowAggregate",!0),this.changes$("aggregatesConstraint",!0),this.changes$("validators",!0)]).pipe((0,Ae.R)(this.onDestroy$)).subscribe(function(i){n.defaultStrategy=new sn(function(){var f;return null===(f=n.fieldsMetadataUpdate$.value)||void 0===f?void 0:f.metadata},function(){return n.dragDropPickerRef},i[0],i[1],i[2],n.aggrOps,n.conceptualSchemaProxy,n.dataSourcesService,n.displayNameService,n.localizationService)}),this.changes$("menuStrategy",!0).subscribe(function(i){n.menuStrategyInternal=i??n.defaultStrategy}),this.changes$("getDropExprStrategy",!0).subscribe(function(i){n.dropExprStrategyInternal=i??n.defaultStrategy}),this.changes$("displayNameStrategy",!0).subscribe(function(i){n.nameStrategyInternal=i??n.defaultStrategy,n.useCustomTooltip=!!n.nameStrategyInternal.getCustomTooltipContent}),this.changes$("flyoutFieldsStrategy",!0).subscribe(function(i){n.flyoutFieldsStrategyEnsured={getFieldsToSelectOnOpen:function(c,p){return i?.getFieldsToSelectOnOpen?i.getFieldsToSelectOnOpen(c,p):n.defaultStrategy.getFieldsToSelectOnOpen(c,p)},getFieldsToDisableOnOpen:function(c,p,f,h){return i?.getFieldsToDisableOnOpen?i.getFieldsToDisableOnOpen(c,p,f,h):n.defaultStrategy.getFieldsToDisableOnOpen(c,p,f,h)},handleSelectedField:function(c,p){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(f){switch(f.label){case 0:return i?.handleSelectedField?[4,i.handleSelectedField(c,p)]:[3,2];case 1:return f.sent(),[3,4];case 2:return[4,this.defaultStrategy.handleSelectedField(c,p)];case 3:f.sent(),f.label=4;case 4:return[2]}})})},handleDeselectedField:function(c){i?.handleDeselectedField?i.handleDeselectedField(c):n.defaultStrategy.handleDeselectedField(c)},onCloseWithCreateVisualCalc:function(c){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(p){switch(p.label){case 0:return i?.onCloseWithCreateVisualCalc?[4,i.onCloseWithCreateVisualCalc(c)]:[3,2];case 1:return p.sent(),[3,4];case 2:return[4,this.defaultStrategy.onCloseWithNewVisualCalc(c)];case 3:p.sent(),p.label=4;case 4:return[2]}})})},getVisualCalcCreationInfo:function(c){return(0,y.__awaiter)(n,void 0,void 0,function(){return(0,y.__generator)(this,function(p){switch(p.label){case 0:return i?.getVisualCalcCreationInfo?[4,i.getVisualCalcCreationInfo(c)]:[3,2];case 1:return[2,p.sent()];case 2:return[2,this.defaultStrategy.getVisualCalcCreationInfo(c)]}})})},canOpenFlyout:function(c){return i?.canOpenFlyout?i.canOpenFlyout(c):n.defaultStrategy.canOpenFlyout(c)}}})},r.prototype.buildFieldListTreeModel=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){var n;return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.getSchemaForFlyout()];case 1:return(n=i.sent())?(this.lastFieldListShowHiddenFields=this.shouldFieldListShowHiddenFields(),[2,new oe.O(this.localizationService).createModel(n,!1,!this.lastFieldListShowHiddenFields)]):[2]}})})},r.prototype.resetFieldListTreeModel=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){var n;return(0,y.__generator)(this,function(i){switch(i.label){case 0:return n=this,[4,this.buildFieldListTreeModel()];case 1:return n.fieldListTreeModel=i.sent(),this.setFieldListTreeExprs(),[2]}})})},r.prototype.shouldFieldListShowHiddenFields=function(){var n=this.viewModeState.getMode();return(1===n||2===n)&&this.reportSettingsService.getShowHiddenFields()},r.prototype.getSchemaForFlyout=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){var i;return(0,y.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.conceptualSchemaProxy.get(this.getDataSourceForFlyout())];case 1:return[2,s.sent()];case 2:return(i=s.sent()).serviceError&&"CubeNameDoesNotExist"===i.serviceError.errorCode&&(this.perspectiveDoesNotExist=!0),[2];case 3:return[2]}})})},r.prototype.getDataSourceForFlyout=function(){var n=(0,Re.yd)((0,y.__spreadArray)([],this.dataSourcesService.get(),!0));if(this.perspectiveDisplayName&&""!==this.perspectiveDisplayName){var i=n.findIndex(function(p){return"dsr"===p.type}),s=n[i];if(s){var c=(0,y.__assign)((0,y.__assign)({},s),{perspectiveId:this.perspectiveDisplayName});n[i]=c}}return n},r.prototype.getSchema=function(){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(i){switch(i.label){case 0:return[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return[2,i.sent()]}})})},r.prototype.getEffectiveReplacementPosition=function(n,i,s){return this.allowMultipleValues?(P.fF.assert(function(){return!s||"end"!==n},"an ItemPosition from replace should never be 'end'"),s?n:void 0):i>0&&("end"===n||1===_.size(n))?[0]:s?n:void 0},r.prototype.setFieldListTreeExprs=function(){var n=this;this.fieldListTreeModel&&(this.fieldListTreeExprs=[],_.forEach(this.fieldListTreeModel.entities,function(i){n.fieldListTreeExprs.push((0,U.W4)(i));var s=_.map([i.columns,i.measures,i.kpis,i.hierarchies],function(p){return p.getItems()}),c=[].concat.apply([],s);_.forEach(c,function(p){var f=(0,U.Sd)(p,n.groupingDesignStateService);n.fieldListTreeExprs.push(f)}),_.forEach(i.properties,function(p){_.forEach(p.properties,function(f){f instanceof Z.Jg&&(n.fieldListTreeExprs.push((0,U.Sd)(f,n.groupingDesignStateService)),_.forEach(f.hierarchyLevels,function(h){n.fieldListTreeExprs.push((0,U.Sd)(h,n.groupingDesignStateService))}))})}),_.forEach(i.hierarchies.getItems(),function(p){_.forEach(p.hierarchyLevels,function(f){var h=(0,U.Sd)(f,n.groupingDesignStateService);n.fieldListTreeExprs.push(h)})})}))},r.\u0275fac=function(i){return new(i||r)(e.\u0275\u0275directiveInject(Lt.C),e.\u0275\u0275directiveInject(Vt.i),e.\u0275\u0275directiveInject(t.D),e.\u0275\u0275directiveInject(et.O),e.\u0275\u0275directiveInject(N.J),e.\u0275\u0275directiveInject(Fe.AA),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(tt.o),e.\u0275\u0275directiveInject(Ne._),e.\u0275\u0275directiveInject(Bt.h),e.\u0275\u0275directiveInject(At.kc),e.\u0275\u0275directiveInject(Rt.Q),e.\u0275\u0275directiveInject(lt.l),e.\u0275\u0275directiveInject(bt.yk),e.\u0275\u0275directiveInject(Ee.w,8))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["field-picker-modern"]],viewQuery:function(i,s){if(1&i&&(e.\u0275\u0275viewQuery(Ht,5),e.\u0275\u0275viewQuery(Wt,5)),2&i){var c=void 0;e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.dragDropPickerRef=c.first),e.\u0275\u0275queryRefresh(c=e.\u0275\u0275loadQuery())&&(s.openFlyoutChevronQueryList=c)}},inputs:{initialExpr:"initialExpr",alwaysAllowAggregate:"alwaysAllowAggregate",aggregatesConstraint:"aggregatesConstraint",validators:"validators",allowReorderItems:"allowReorderItems",disallowReplaceItems:"disallowReplaceItems",allowMultipleValues:"allowMultipleValues",disableDropZoneIndicator:"disableDropZoneIndicator",disabled:"disabled",label:"label",addDataLabelKey:"addDataLabelKey",addDataAriaLabelKey:"addDataAriaLabelKey",ariaLabelledby:"ariaLabelledby",ariaDescribedby:"ariaDescribedby",withFieldList:"withFieldList",enterExitFieldRename:"enterExitFieldRename",allowEntityField:"allowEntityField",promotedActionStrategy:"promotedActionStrategy",getDropExprStrategy:"getDropExprStrategy",flyoutFieldsStrategy:"flyoutFieldsStrategy",directEditStrategy:"directEditStrategy",visualCalcFieldsStrategy:"visualCalcFieldsStrategy",menuStrategy:"menuStrategy",displayNameStrategy:"displayNameStrategy",externalCrossPickerDragDropMonitor:"externalCrossPickerDragDropMonitor",perspectiveDisplayName:"perspectiveDisplayName",tooltipPosition:"tooltipPosition",tooltipWithFlexiblePositions:"tooltipWithFlexiblePositions",disableAutoScroll:"disableAutoScroll",parameterPickerDataFormat:"parameterPickerDataFormat",visualCapabilities:"visualCapabilities",emptyFieldSetsDefaultLabel:"emptyFieldSetsDefaultLabel",role:"role",fieldListOverlayPanelClass:"fieldListOverlayPanelClass",allowClear:"allowClear",compact:"compact"},outputs:{onExprChange:"onExprChange",onCrossPickerDrop:"onCrossPickerDrop"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:5,consts:[["fieldPicker",""],[4,"ngIf"],["for","dragDropPickerRef","class","fluentTheme-sm-reg field-picker-label",4,"ngIf"],["id","dragDropPickerId",3,"compact","ariaLabelledby","dataFormat","disabled","placeholder","addDataLabelKey","addDataAriaLabelKey","draggable","allowEditingLabelsSetting","allowMultipleValues","allowClear","disableDropZoneIndicator","disableContentClick","pbiDragDropPickerActionsTemplate","itemPromotedActionTemplate","externalCrossPickerDragDropMonitor","v2Design","menuMode","useCustomTooltip","tooltipPosition","tooltipWithFlexiblePositions","disableAutoScroll","disableClearButtonTabNavigation","allowEmptyLabel","onChangeAdd","onChangeRemove","onChangeReorder","onChangeReplace","onChangeLabelUpdate","onCrossPickerDrop","onAddDataClick","onContentClick","onMenuItemClick","onClearButtonArrowRight"],["dragDropPickerRef",""],["promotedFieldActionTemplate",""],["pickerActionsTemplate",""],["for","dragDropPickerRef",1,"fluentTheme-sm-reg","field-picker-label"],[1,"pbi-drag-drop-picker-actions"],[1,"pbi-icon-button",3,"ngClass","click"],["tri-svg-icon-16","",3,"name","sprite","pbiTooltip"],["class","pbi-drag-drop-picker-actions",4,"ngIf"],["aria-hidden","true","class","button-divider",3,"ngClass",4,"ngIf"],["tabindex","-1","class","glyphicon pbi-glyph-chevronrightmedium glyph-mini pbi-focus-outline pbi-icon-button v2Design","aria-haspopup","true",3,"pbiTooltip","click","keydown.arrowLeft",4,"ngIf"],["class","pbi-focus-outline pbi-icon-button v2Design","tabindex","-1","aria-haspopup","true",3,"pbiTooltip","disabled","click","keydown.arrowLeft",4,"ngIf"],["class","glyphicon pbi-glyph-chevrondownsmall glyph-small pbi-focus-outline pbi-icon-button","aria-haspopup","true",3,"pbiTooltip","pbiMenu","menuMode","pbiMenuActivation","pbiMenuButtonClick",4,"ngIf"],["aria-hidden","true",1,"button-divider",3,"ngClass"],["tabindex","-1","aria-haspopup","true",1,"glyphicon","pbi-glyph-chevronrightmedium","glyph-mini","pbi-focus-outline","pbi-icon-button","v2Design",3,"pbiTooltip","click","keydown.arrowLeft"],["openFlyoutChevron",""],["tabindex","-1","aria-haspopup","true",1,"pbi-focus-outline","pbi-icon-button","v2Design",3,"pbiTooltip","disabled","click","keydown.arrowLeft"],["tri-svg-icon-16","",3,"name"],["aria-haspopup","true",1,"glyphicon","pbi-glyph-chevrondownsmall","glyph-small","pbi-focus-outline","pbi-icon-button",3,"pbiTooltip","pbiMenu","menuMode","pbiMenuActivation","pbiMenuButtonClick"]],template:function(i,s){1&i&&(e.\u0275\u0275elementStart(0,"div",null,0),e.\u0275\u0275template(2,tn,11,34,"ng-container",1),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction1(3,nn,e.\u0275\u0275pipeBind1(3,1,s.fieldsView$))))},dependencies:[u.NgClass,u.NgIf,Y.HV,Nt.l8,$e.V,it.M,u.AsyncPipe,d.F,zt],styles:[".field-picker-label[_ngcontent-%COMP%]{display:inline-block;margin-bottom:4px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button{height:fit-content;width:fit-content;margin-left:12px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.v2Design{margin-left:4px;border-radius:2px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button:disabled tri-svg-icon{opacity:50%}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions .button-divider{width:1px;background-color:var(--gray-130, #605E5C);margin-left:2px;margin-right:2px}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions .button-divider.error{background-color:var(--globalColorCranberryShade10)}"],changeDetection:0}),r}(je.w),sn=function(){function l(r,n,i,s,c,p,f,h,D,x){this.getCurrentMetadata=r,this.getDragDropPickerRef=n,this.alwaysAllowAggregate=i,this.aggregatesConstraint=s,this.validators=c,this.aggrOps=p,this.conceptualSchemaProxy=f,this.dataSourcesService=h,this.displayNameService=D,this.localizationService=x}return l.prototype.getDropExpr=function(r,n){var i,s,c=r;if(this.shouldAggregate(r,n)){var p=null!=(null===(s=null===(i=this.validators)||void 0===i?void 0:i.field)||void 0===s?void 0:s.type)?[this.validators.field.type]:[];c=this.aggrOps.createExprWithAggregate(r,n,!0,p)}if(this.isValidDrop(c,n,!0))return Promise.resolve({expr:c})},l.prototype.getDroppedExprChildren=function(r,n,i,s){},l.prototype.getMenu=function(r,n,i,s){if(null!=r&&this.shouldShowPickerMenu(r,i)){var c={items:[]};if(this.shouldShowAggregationMenu(r,i)){var p=(0,Oe._L)(r);c.items=this.createAggregateMenuItems(r,p,i)}else{var f=this.getVariations(r,i);_.isEmpty(f)||(c.items=this.createVariationMenuItems(f,r,i))}return c}},l.prototype.menuItemClickHandler=function(r,n,i){return this.onMenuItemSelected(r,n,i)},l.prototype.getDisplayName=function(r,n,i,s){return xt(r,i,this.displayNameService)},l.prototype.isRenameAllowed=function(r){return!1},l.prototype.isFieldInvalid=function(r,n){return!1},l.prototype.getFieldsToSelectOnOpen=function(r,n){if(n)return[n]},l.prototype.getFieldsToDisableOnOpen=function(r,n,i,s){},l.prototype.handleSelectedField=function(r,n){var i,s,c;return(0,y.__awaiter)(this,void 0,void 0,function(){var p,f,h=this;return(0,y.__generator)(this,function(D){switch(D.label){case 0:return P.fF.assertValue(r,"selectedField"),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return p=D.sent(),f={fieldExpr:ze.ib.serializeExpr(r),label:xt(r,p,this.displayNameService)},P.fF.assert(function(){return _.size(n)<=2},"field-picker-modern right now only supports maximum 2-levels of fields."),P.fF.assert(function(){return _.size(n)<2||(0,we.ez)((0,Y.X)(h.getCurrentMetadata(),n).expr)},"field-picker-modern second-level field should only be hierarchy levels"),n?null===(i=this.getDragDropPickerRef())||void 0===i||i.handleReplace(f,[n[0]]):null===(s=this.getDragDropPickerRef())||void 0===s||s.handleAdd(f),null===(c=this.getDragDropPickerRef())||void 0===c||c.detectChanges(),[2]}})})},l.prototype.handleDeselectedField=function(r){P.fF.assertValue(r,"deselectedField");var n=this.getCurrentMetadata();if(!_.isEmpty(n)){var i=(0,It.f)(r,n);if(!_.isEmpty(i)){var s=this.getDragDropPickerRef();s&&s.handleClear(i)}}},l.prototype.onCloseWithNewVisualCalc=function(r){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(n){return[2]})})},l.prototype.getVisualCalcCreationInfo=function(r){return(0,y.__awaiter)(this,void 0,void 0,function(){return(0,y.__generator)(this,function(n){return[2,{supportVisualCalcCreation:!1}]})})},l.prototype.canOpenFlyout=function(r){return!0},l.prototype.rename=function(r,n){P.fF.assertFail("Expect this not to be called, rename is not allowed")},l.prototype.shouldAggregate=function(r,n){var i,s;return 1===(null===(s=null===(i=this.validators)||void 0===i?void 0:i.field)||void 0===s?void 0:s.kind)&&!Qe.m.discourageAggregation(r,n)},l.prototype.isValidDrop=function(r,n,i){var s;if(P.fF.assertValue(r,"expr"),!r)return!1;var c=r.getConceptualProperty(n),p=r.getMetadata(n);if(c?.kpiValue||!p)return!1;if(null!==(s=this.validators)&&void 0!==s&&s.field&&p?.kind!==this.validators.field.kind)return!1;var h=function(l){var r,n=null===(r=l?.field)||void 0===r?void 0:r.type;if(n)return n.variant||[n]}(this.validators);if(!_.isEmpty(h)&&!dt.Ge.isCompatibleTo(p?.type,h,!0))return!1;if(i){var x=this.getCurrentMetadata();if(_.some(x,function(w){return(0,k.fS)(w.expr,r)}))return!1}return!0},l.prototype.shouldShowPickerMenu=function(r,n){return!!r&&!(0,we.kb)(r)&&(this.shouldShowAggregationMenu(r,n)||!_.isEmpty(this.getVariations(r,n)))},l.prototype.createAggregateMenuItems=function(r,n,i){var s,c,p=null!=(null===(c=null===(s=this.validators)||void 0===s?void 0:s.field)||void 0===c?void 0:c.type)?[this.validators.field.type]:[],h=(0,Ce.Hh)(r,i,this.aggrOps,!1,this.alwaysAllowAggregate?Ze.DW.GroupingOrMeasure:Ze.DW.Measure,p,this.localizationService,void 0,void 0,this.aggregatesConstraint);return _.map(h,function(D){var x;return{text:D.text,type:ke.iB.Button,data:D.key,checkable:!0,checked:(null===(x=D.key)||void 0===x?void 0:x.aggregate)===n}})},l.prototype.shouldShowAggregationMenu=function(r,n){return this.alwaysAllowAggregate&&!Qe.m.discourageAggregation(r,n)||this.shouldAggregate(r,n)},l.prototype.onMenuItemSelected=function(r,n,i){r.checked=!r.checked,P.fF.assert(function(){return 1===_.size(n)},"default field-picker creates menu only for first level of items");var D,s=n[0],c=this.getCurrentMetadata(),p=_.map(c,function(E){return E.expr}),f=p[s],h=c[s].metadata;if(r.data instanceof Oe.Il)D=r.data;else{var x=r.data.aggregate;D=null==f?f:null==x?(0,st.n)(f,i):(0,ct.k)(f,x)}p[s]=D;var w=Mt(n,h);return{newExpr:_.map(p,function(E,M){return{expr:E,metadata:c[M].metadata}}),fromUpdate:w}},l.prototype.getVariations=function(r,n){var i,s;if(0!==(null===(s=null===(i=this.validators)||void 0===i?void 0:i.field)||void 0===s?void 0:s.kind))return[];var c=r;if((0,we.ez)(r)&&!(c=(0,I.ZB)(r)))return[];var p=(0,I.wA)(n,c);if(!_.isArray(p)&&(0,k.fS)(p,c))return[];var f=(0,B.rY)(p),h=[];this.isValidDrop(c,n,!1)&&h.push(c);for(var D=0,x=f;D<x.length;D++){var w=x[D];this.isValidDrop(w,n,!1)&&h.push(w)}return 1===h.length&&((0,k.fS)(h[0],r)||(0,k.fS)(h[0],c))?[]:h},l.prototype.createVariationMenuItems=function(r,n,i){var s=this;return _.map(r,function(c){return{text:s.displayNameService.getDisplayName(c,i,null),type:ke.iB.Button,data:c,checkable:!0,checked:(0,k.fS)(n,c)}})},l}();function yt(l){var r={fieldExpr:ze.ib.serializeExpr(l.pickerDataExpr),label:l.displayName.value,metadata:l.metadata,customTooltipContent:l.customTooltipContent,pbiStyle:l.displayName.pbiStyle,invalid:l.invalid},n=function(l){var r;return null!=l&&(l.invalid?r={type:1,sheet:"fluentui-icons",symbolId:"warning_20_regular",styles:{color:"var(--globalColorCranberryShade10)",fill:"currentColor"}}:(0,we.jX)(l.expr)&&(r={type:1,sheet:"visual-calc-icons",symbolId:"data_histogram_function_20_regular"})),r}(l);null!=n&&(r.icon=n);var i=l.menu,s=!_.isEmpty(i?.items);return{pickerData:r,allowRename:l.allowRename,menuFactory:s?i:void 0,children:_.map(l.children,function(c){return yt(c)}),promotedAction$:l.promotedAction$,actionTooltip:l.actionTooltip}}function Pt(l){return(0,y.__assign)((0,y.__assign)({},l.pickerData),{allowEditLabel:l.allowRename,menu:l.menuFactory,children:_.map(l.children,function(r){return Pt(r)}),actionTooltip:l.actionTooltip})}function Dt(l,r,n,i,s){var h,c=l.displayName,p=function(l,r,n){var i;if(1===l.length)i=r;else{var s=l.slice(0,-1);i=(0,Y.X)(r,s).children}var f=function(l,r,n){if((0,Se.H2)(n))return l<_.last(n.deleted.position)?l:l+1;if((0,Se.JB)(n)){var i="end"===n.added.position?r-1:_.last(n.added.position);return l===i?void 0:l<i?l:l-1}if((0,Se.y$)(n))return l;if((0,Se.cS)(n)){var c=n.reordered.toPosition,p=_t(n.reordered.fromPosition.slice(0,-1),c.slice(0,-1));P.fF.assert(function(){return p},"Expect reordering only among siblings. Add your implementation for new scenario.");var f=_.last(n.reordered.fromPosition),h=_.last(n.reordered.toPosition);return l<f?l:f<=l&&l<h-1?l+1:l===h-1?f:l}if((0,Se.cA)(n))return l===_.last(n.replaced.position)?void 0:l;(0,Se.V5)(n)||P.fF.assertNever(n)}(_.last(l),_.size(i),n);if(null!=f)return l.slice(0,-1).concat(f)}(r,n,s);return null!=p&&(c=(0,Y.X)(i,p).displayName),_.isEmpty(l.children)||(h=[],_.forEach(l.children,function(D,x){var w=Dt(D,r.concat(x),n,i,s);h.push(w)})),(0,y.__assign)((0,y.__assign)({},l),{displayName:c,children:h})}function _t(l,r){return _.size(l)===_.size(r)&&_.every(l,function(n,i){return n===r[i]})}function xt(l,r,n){return n.getDisplayName(l,r,void 0,void 0,void 0,{includeVariationSource:!0})}function Mt(l,r){return{type:"replace",replaced:{position:l,originalMetadata:r}}}var yn=[{type:ln,componentId:"FieldPickerComponentId"}],Pn=function(){function l(){}return l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=e.\u0275\u0275defineNgModule({type:l}),l.\u0275inj=e.\u0275\u0275defineInjector({providers:(0,y.__spreadArray)((0,y.__spreadArray)([],ee.U,!0),[t.D,N.J,K],!1),imports:[u.CommonModule,q.u5,T.N.withManifests(yn),V.v,te.K,H.C,ae.b,j.N,G.H,ge.Z,Q.J,J.X,q.UX,ne.T6]}),l}()},98476:function(Me,re,g){g.d(re,{f:function(){return t}});var y=g(45413),u=g(74082);function q(N){return void 0!==N.pickerDataExpr}function t(N,T){for(var ee,V=(0,u.ez)(N),te=T.length-1;te>=0;te--){var H=T[te],J=H.expr;if(V&&(0,u.y3)(J)){var j,ae=te;if((j=q(H)?_.findIndex(H.children,function(G){return(0,y.fS)(G.expr,N)}):_.findIndex(H.hierarchyLevels,function(G){return(0,y.fS)(G.expr,N)}))>=0)return[ae,j]}if((0,u.iV)(J)&&(J=J.arg),(0,y.fS)(J,N))return[te]}return ee}},4722:function(Me,re,g){g.d(re,{HV:function(){return ft},X:function(){return Ue},ri:function(){return be}});var y=g(81337),u=g(64560),q=g(93247),t=g(50423),N=g(17174),T=g(62458),V=g(59694),ee=g(14172),te=g(59973),H=g(22318),J=g(6663),ae=g(35497),j=g(65181),G=g(77476),ge=g(23097),Q=g(59968),ne=g(44581),W=g(24150),se=g(86663),ce=g(80357),de=g(45916),K=g(36858),e=g(85102),pe=["dragDropPicker"],ue=["clearButton"],_e=["contentLabel"],Le=["listOfData"],Ve=function(){return[]},Be=function(a,o){return{nonEmptyDisplayDataList:a,isTopLevel:!0,rootToParentIndices:o}};function Ae(d,a){if(1&d&&t.\u0275\u0275elementContainer(0,7),2&d){var o=t.\u0275\u0275nextContext(),v=t.\u0275\u0275reference(5);t.\u0275\u0275property("ngTemplateOutlet",v)("ngTemplateOutletContext",t.\u0275\u0275pureFunction2(3,Be,o.listOfPbiDisplayData,t.\u0275\u0275pureFunction0(2,Ve)))}}function Y(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",8),t.\u0275\u0275listener("drop",function(m){t.\u0275\u0275restoreView(o);var b=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(b.handleDrop(m))})("dragover",function(m){t.\u0275\u0275restoreView(o);var b=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(!b.isItRedundantPositionToDropCurrentData("end")&&b.handleDragover(m))})("dragenter",function(){t.\u0275\u0275restoreView(o);var m=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(m.handleDragEnterListEndArea())})("dragleave",function(){t.\u0275\u0275restoreView(o);var m=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(m.handleDragLeaveListEndArea())}),t.\u0275\u0275elementEnd()}}var Ce=function(a){return{highlight:a}};function Re(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",20),t.\u0275\u0275listener("dragenter",function(){t.\u0275\u0275restoreView(o);var b=t.\u0275\u0275nextContext().index,C=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(C.handleDragEnterPosition([b]))})("dragleave",function(){t.\u0275\u0275restoreView(o);var b=t.\u0275\u0275nextContext().index,C=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(C.handleDragLeavePosition([b]))})("dragover",function(b){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(!C.isItRedundantPositionToDrop()&&C.handleDragover(b))})("drop",function(b){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(C.handleDrop(b))}),t.\u0275\u0275elementEnd()}if(2&d){var v=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(1,Ce,v.highlight))}}function P(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function B(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function k(d,a){1&d&&t.\u0275\u0275elementContainer(0)}var I=function(a,o){return{nonEmptyDisplayDataList:a,isTopLevel:!1,rootToParentIndices:o}};function U(d,a){if(1&d&&t.\u0275\u0275elementContainer(0,7),2&d){var o=t.\u0275\u0275nextContext(2),v=o.$implicit,m=o.index,b=t.\u0275\u0275nextContext().rootToParentIndices;t.\u0275\u0275nextContext();var C=t.\u0275\u0275reference(5);t.\u0275\u0275property("ngTemplateOutlet",C)("ngTemplateOutletContext",t.\u0275\u0275pureFunction2(2,I,v.children,b.concat(m)))}}var Z=function(a,o,v){return{$implicit:a,position:o,field:v}};function oe(d,a){if(1&d&&t.\u0275\u0275elementContainer(0,7),2&d){var o=t.\u0275\u0275nextContext(2),v=o.index,m=o.$implicit,b=t.\u0275\u0275nextContext().rootToParentIndices,C=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngTemplateOutlet",C.pbiDragDropPickerActionsTemplate)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(2,Z,C.picker,b.concat(v),m))}}var Oe=function(a){return{compact:a}},we=function(a,o,v,m){return{isTopLevel:a,displayData:o,allowDrag:v,position:m}},ve=function(a){return{position:a}};function ke(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",21)(2,"div",22),t.\u0275\u0275template(3,P,1,0,"ng-container",23),t.\u0275\u0275template(4,B,1,0,"ng-container",23),t.\u0275\u0275template(5,k,1,0,"ng-container",23),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(6,U,1,5,"ng-container",24),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(7,oe,1,6,"ng-container",24),t.\u0275\u0275elementContainerEnd()),2&d){var o=t.\u0275\u0275nextContext(),v=o.$implicit,m=o.index,b=t.\u0275\u0275reference(7),C=t.\u0275\u0275reference(11),F=t.\u0275\u0275nextContext(),O=F.isTopLevel,L=F.rootToParentIndices,R=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(9,Oe,R.compact)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",b)("ngTemplateOutletContext",t.\u0275\u0275pureFunction4(11,we,O,v,!v.isEditing&&(R.draggable||!R.allowMultipleValues)&&O,L.concat(m))),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",R.itemPromotedActionTemplate)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(16,Z,R.picker,L.concat(m),v)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",C)("ngTemplateOutletContext",t.\u0275\u0275pureFunction1(20,ve,L.concat(m))),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",(null==v.children?null:v.children.length)>0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",O)}}function at(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function Ne(d,a){1&d&&t.\u0275\u0275elementContainer(0)}function lt(d,a){1&d&&t.\u0275\u0275elementContainer(0)}var Ke=function(a,o,v){return{isTopLevel:!0,displayData:a,allowDrag:o,position:v}};function st(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,at,1,0,"ng-container",23),t.\u0275\u0275template(2,Ne,1,0,"ng-container",23),t.\u0275\u0275template(3,lt,1,0,"ng-container",23),t.\u0275\u0275elementContainerEnd()),2&d){var o=t.\u0275\u0275nextContext(),v=o.$implicit,m=o.index,b=t.\u0275\u0275reference(7),C=t.\u0275\u0275reference(11),F=t.\u0275\u0275nextContext().rootToParentIndices,O=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",b)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(6,Ke,v,!v.isEditing&&(O.draggable||!O.allowMultipleValues),F.concat(m))),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",O.pbiDragDropPickerActionsTemplate)("ngTemplateOutletContext",t.\u0275\u0275pureFunction3(10,Z,O.picker,F.concat(m),v)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",C)("ngTemplateOutletContext",t.\u0275\u0275pureFunction1(14,ve,F.concat(m)))}}var je=function(a){return{width:a}};function ze(d,a){if(1&d&&t.\u0275\u0275element(0,"div",32),2&d){var o=t.\u0275\u0275nextContext().position;t.\u0275\u0275property("ngStyle",t.\u0275\u0275pureFunction1(1,je,8*(o.length-1)+"px"))}}function ct(d,a){if(1&d&&t.\u0275\u0275element(0,"pbi-icon",33),2&d){var o=t.\u0275\u0275nextContext().displayData,v=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("name",o.icon.glyph)("size",v.smallIconSize)}}function Qe(d,a){if(1&d&&t.\u0275\u0275element(0,"pbi-svg-use-symbol",34),2&d){var o=t.\u0275\u0275nextContext().displayData;t.\u0275\u0275property("ngStyle",o.icon.styles)("sheet",o.icon.sheet)("symbolId",o.icon.symbolId)}}function dt(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"input",35),t.\u0275\u0275listener("ngModelChange",function(b){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext().displayData;return t.\u0275\u0275resetView(C.value=b)})("keydown",function(b){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext().position,F=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(F.handleKeyDown(b,C))})("blur",function(){t.\u0275\u0275restoreView(o);var b=t.\u0275\u0275nextContext().position,C=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(C.endEditSection(b))}),t.\u0275\u0275elementEnd()}if(2&d){var v=t.\u0275\u0275nextContext().displayData;t.\u0275\u0275property("ngModel",v.value)}}var Ze=function(a,o){return{showHover:a,interactable:o}};function Xe(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",25,26),t.\u0275\u0275listener("singleClickAction",function(){var L=t.\u0275\u0275restoreView(o).position;t.\u0275\u0275nextContext();var R=t.\u0275\u0275reference(3),z=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(z.v2Design&&!z.disableContentClick&&z.handleContentClick(R,L))})("doubleClickAction",function(){var L=t.\u0275\u0275restoreView(o).position,R=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(R.beginEditSection(L))})("accessible-click",function(){var L=t.\u0275\u0275restoreView(o).position;t.\u0275\u0275nextContext();var R=t.\u0275\u0275reference(3),z=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(z.v2Design&&!z.disableContentClick&&z.handleContentClick(R,L))})("keydown.F2",function(){var O=t.\u0275\u0275restoreView(o),L=O.displayData,R=O.position,z=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(L.allowEditing&&!L.isEditing?z.beginEditSection(R):z.return)})("keydown.arrowRight",function(O){t.\u0275\u0275restoreView(o);var L=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(L.focusClearButton(O.target))})("contextmenu",function(O){t.\u0275\u0275restoreView(o);var L=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(L.onContextMenu(O))})("dragstart",function(O){var L=t.\u0275\u0275restoreView(o),R=L.allowDrag,z=L.position,ht=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(R&&ht.handleDragItemStart(O,z))})("dragend",function(){var L=t.\u0275\u0275restoreView(o).allowDrag,R=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(L&&R.handleDragItemEnd())})("dragover",function(O){var R=t.\u0275\u0275restoreView(o).allowDrag,z=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(R&&!z.allowMultipleValues?z.handleDragover(O):z.return)})("drop",function(O){var R=t.\u0275\u0275restoreView(o).allowDrag,z=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(R&&!z.allowMultipleValues?z.handleDrop(O):z.return)})("pbiMenuButtonClick",function(O){var R=t.\u0275\u0275restoreView(o).position,z=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(z.handleMenuItemClick(O,R))}),t.\u0275\u0275template(2,ze,1,3,"div",27),t.\u0275\u0275elementStart(3,"div",28),t.\u0275\u0275template(4,ct,1,2,"pbi-icon",29),t.\u0275\u0275template(5,Qe,1,3,"pbi-svg-use-symbol",30),t.\u0275\u0275template(6,dt,1,1,"input",31),t.\u0275\u0275elementEnd()()}if(2&d){var v=a.displayData,m=a.isTopLevel;t.\u0275\u0275nextContext();var b=t.\u0275\u0275reference(9),C=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("id","contentLabelId"+C.uid)("ngClass",t.\u0275\u0275pureFunction2(28,Ze,v.interactionAvailable&&!v.isEditing&&!C.disableHover,v.interactionAvailable))("ngStyle",v.pbiStyle)("disabled",C.v2Design&&null==v.menu)("pbiMenu",C.v2Design?v.menu:null)("menuMode",null!=C.menuMode?C.menuMode:C.CompactMenuMode)("pbiMenuActivation",C.v2Design&&v.menu?"contextmenu":null)("draggable",!v.isEditing&&C.draggable&&!C.disabled)("singleClickDisabled",v.isEditing)("pbiTooltip",b)("pbiTooltipDisabled",C.disableHover)("pbiTooltipPosition",C.calculatedTooltipPosition)("pbiTooltipWithFlexiblePositions",C.tooltipWithFlexiblePositions)("doubleClickDisabled",!v.allowEditing||v.isEditing)("accessible-click-ignore-mouse",!0)("accessible-click-ignore-tabindex",!C.v2Design&&!v.allowEditing),t.\u0275\u0275attribute("role",C.v2Design?"button":null)("aria-haspopup",!!C.v2Design||null)("aria-labelledby",C.ariaLabelledby+" contentLabelId"+C.uid),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!m),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngSwitch",null==v.icon?null:v.icon.type),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngSwitchCase",C.PbiIconGlyphKind),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngSwitchCase",C.PbiIconSvgKind),t.\u0275\u0275advance(1),t.\u0275\u0275property("pbiEditableLabel",C.editableLabelOptions)("pbiEditableLabelValue",v.value)("pbiEditableLabelMode",v.isEditing)("pbiEditableLabelEditable",v.isEditing)("pbiEditableLabelClasses",C.editableLabelClasses)}}function Ge(d,a){if(1&d&&t.\u0275\u0275element(0,"div",38),2&d){var o=t.\u0275\u0275nextContext(2).$implicit;t.\u0275\u0275property("textContent",o.customTooltipContent.description)}}function He(d,a){if(1&d&&(t.\u0275\u0275element(0,"div",36),t.\u0275\u0275template(1,Ge,1,1,"div",37)),2&d){var o=t.\u0275\u0275nextContext().$implicit,v=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("textContent",v.useCustomTooltip?null==o.customTooltipContent?null:o.customTooltipContent.title:o.value),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",v.useCustomTooltip&&(null==o.customTooltipContent?null:o.customTooltipContent.description))}}function pt(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",40,41),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext().position,F=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(F.handleClear(C))})("keydown.arrowLeft",function(C){t.\u0275\u0275restoreView(o);var F=t.\u0275\u0275nextContext(4);return t.\u0275\u0275resetView(F.focusContentLabel(C.target))})("keydown.arrowRight",function(C){t.\u0275\u0275restoreView(o);var F=t.\u0275\u0275nextContext().position,O=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(O.handleClearButtonArrowRight(C.target,F))}),t.\u0275\u0275pipe(2,"localize"),t.\u0275\u0275elementEnd()}if(2&d){var v=t.\u0275\u0275nextContext(2).$implicit,m=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("tabindex",m.disableClearButtonTabNavigation?-1:0)("pbiTooltip",t.\u0275\u0275pipeBind1(2,3,"FieldPicker_RemoveData"))("aria-label",v.removeDataAriaLabel)}}function Je(d,a){if(1&d&&t.\u0275\u0275template(0,pt,3,5,"button",39),2&d){var o=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("ngIf",o.allowClear&&!o.disabled)}}function We(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,Re,1,3,"div",14),t.\u0275\u0275elementStart(2,"span",15,16),t.\u0275\u0275template(4,ke,8,22,"ng-container",13),t.\u0275\u0275template(5,st,4,16,"ng-container",13),t.\u0275\u0275template(6,Xe,7,31,"ng-template",null,17,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(8,He,2,2,"ng-template",null,18,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(10,Je,1,1,"ng-template",null,19,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()),2&d){var o=a.$implicit,v=t.\u0275\u0275nextContext().isTopLevel,m=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",v),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("error",o.invalid),t.\u0275\u0275attribute("role",m.v2Design?"listitem":null)("aria-level",m.v2Design?1:null)("aria-setsize",m.v2Design?1:null)("aria-posinset",m.v2Design?1:null),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",m.v2Design),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!m.v2Design)}}function Fe(d,a){if(1&d&&t.\u0275\u0275element(0,"div",42),2&d){var o=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(1,Ce,o.shouldHighlightLastItemBottom))}}var Ee=function(a){return{showListEndDropZone:a}};function gt(d,a){if(1&d&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementContainer(1,7),t.\u0275\u0275elementContainerEnd()),2&d){var o=t.\u0275\u0275nextContext().nonEmptyDisplayDataList;t.\u0275\u0275nextContext();var v=t.\u0275\u0275reference(9);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngTemplateOutlet",v)("ngTemplateOutletContext",t.\u0275\u0275pureFunction1(2,Ee,o.length>0))}}var Ye=function(a){return{childrenContentContainer:a}};function qe(d,a){if(1&d&&(t.\u0275\u0275elementStart(0,"div",9,10),t.\u0275\u0275template(2,We,12,9,"ng-container",11),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,Fe,1,3,"div",12),t.\u0275\u0275template(4,gt,2,4,"ng-container",13)),2&d){var o=a.nonEmptyDisplayDataList,v=a.isTopLevel,m=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(5,Ye,!v)),t.\u0275\u0275attribute("role",m.v2Design?"list":null),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",o),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!m.v2Design||!m.allowMultipleValues),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",m.v2Design&&m.allowMultipleValues&&v)}}function et(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"span",44),t.\u0275\u0275listener("drop",function(b){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(C.handleDrop(b))})("dragover",function(b){t.\u0275\u0275restoreView(o);var C=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(C.handleDragover(b))}),t.\u0275\u0275elementStart(1,"label"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd()()}if(2&d){var v=t.\u0275\u0275nextContext(2);t.\u0275\u0275attribute("aria-label",v.placeholder),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(v.placeholder)}}function tt(d,a){if(1&d&&t.\u0275\u0275template(0,et,3,2,"span",43),2&d){var o=t.\u0275\u0275nextContext(),v=t.\u0275\u0275reference(9);t.\u0275\u0275property("ngIf",!o.v2Design)("ngIfElse",v)}}function ut(d,a){if(1&d&&t.\u0275\u0275element(0,"div",50),2&d){var o=t.\u0275\u0275nextContext(3);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(1,Ce,o.shouldHighlightLastItemBottom))}}function vt(d,a){if(1&d){var o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"span",46,47),t.\u0275\u0275listener("accessible-click",function(F){t.\u0275\u0275restoreView(o);var O=t.\u0275\u0275reference(1),L=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(L.handleAddDataClick(F,O))})("drop",function(F){t.\u0275\u0275restoreView(o);var O=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(O.handleDrop(F))})("dragenter",function(){t.\u0275\u0275restoreView(o);var F=t.\u0275\u0275nextContext().showListEndDropZone,O=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(F?O.handleDragEnterListEndArea():O.return)})("dragleave",function(){t.\u0275\u0275restoreView(o);var F=t.\u0275\u0275nextContext().showListEndDropZone,O=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(F?O.handleDragLeaveListEndArea():O.return)})("dragover",function(F){t.\u0275\u0275restoreView(o);var O=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(O.handleDragOverAddDataArea(F))}),t.\u0275\u0275template(2,ut,1,3,"div",48),t.\u0275\u0275element(3,"label",49),t.\u0275\u0275pipe(4,"localize"),t.\u0275\u0275elementEnd()}if(2&d){var b,v=t.\u0275\u0275nextContext().showListEndDropZone,m=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(8,Oe,m.compact)),t.\u0275\u0275attribute("aria-labelledby",m.ariaLabelledby+" addDataLabelId"+m.uid),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",v),t.\u0275\u0275advance(1),t.\u0275\u0275propertyInterpolate("localize",m.addDataLabelKey),t.\u0275\u0275property("id","addDataLabelId"+m.uid),t.\u0275\u0275attribute("aria-label",null!==(b=m.addDataAriaLabelKey)&&void 0!==b?b:t.\u0275\u0275pipeBind1(4,6,"Add_Data"))}}function nt(d,a){if(1&d&&t.\u0275\u0275template(0,vt,5,10,"span",45),2&d){var o=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngIf",o.v2Design)}}var mt=function(a,o,v,m,b){return{empty:a,disabled:o,v2Design:v,disableDropZoneIndicator:m,compact:b}},ft=function(){function d(a,o){this.changeDetectorRef=a,this.localizationService=o,this.CompactMenuMode=u.Kb.Compact,this.PbiIconGlyphKind=0,this.PbiIconSvgKind=1,this.listOfPbiDisplayData=[],this.smallIconSize="small",this.shouldHighlightLastItemBottom=!1,this.draggingToPosition="end",this.allowClear=!0,this.data=[],this.dataFormat="text",this.allowMultipleValues=!1,this.allowEditingLabelsSetting="allDisallow",this.v2Design=!1,this.onChangeAdd=new t.EventEmitter,this.onChangeRemove=new t.EventEmitter,this.onChangeReorder=new t.EventEmitter,this.onChangeReplace=new t.EventEmitter,this.onChangeLabelUpdate=new t.EventEmitter,this.onCrossPickerDrop=new t.EventEmitter,this.onAddDataClick=new t.EventEmitter,this.onContentClick=new t.EventEmitter,this.onMenuItemClick=new t.EventEmitter,this.onClearButtonArrowRight=new t.EventEmitter,this.editableLabelClasses=["fluentTheme-md-reg","trimmedTextWithEllipsis"],this.uid=ae.q.generateShortId(4)}return d.prototype.ngOnInit=function(){var a,o;this.disableHover=!0,this.allowClear=null===(a=this.allowClear)||void 0===a||a,this.addDataLabelKey=null!==(o=this.addDataLabelKey)&&void 0!==o?o:"Plus_Add_Data",this.editableLabelClasses=this.v2Design?["fluentTheme-sm-reg","trimmedTextWithEllipsis"]:["fluentTheme-md-reg","trimmedTextWithEllipsis"],this.editableLabelOptions={customTooltip:!0,disableClick:!0,inputMatchLabelWidth:!1},this.calculatedTooltipPosition=this.tooltipPosition?this.tooltipPosition:this.allowMultipleValues?"before":"above"},d.prototype.ngAfterViewInit=function(){var a=this;this.dragDropPicker.nativeElement.addEventListener("mousemove",function v(){T.fF.assert(function(){return a.disableHover},"Expect hover is disabled"),a.disableHover=!1,a.dragDropPicker.nativeElement.removeEventListener("mousemove",v)}),!this.disableAutoScroll&&(this.scrollToViewSubscription=this.listOfDataAsQueryList.changes.pipe((0,ee.U)(function(v){return v.toArray()}),(0,te.h)(function(){return a.allowMultipleValues}),(0,H.O)([]),(0,J.G)()).subscribe(function(v){var m=v[0],b=v[1];null!=a.scrollToIndex&&b?.length>0&&m.length<b.length&&b[a.scrollToIndex].nativeElement.scrollIntoView(),a.resetHighlight(),a.resetDraggingIndex(),a.scrollToIndex=null}))},d.prototype.ngOnDestroy=function(){var a;null===(a=this.scrollToViewSubscription)||void 0===a||a.unsubscribe()},d.prototype.endEditSection=function(a){var o=this.getDisplayDataAtPosition(a);if(o.allowEditing){if(!o.isEditing)return void T.fF.assertFail("Pbi-drag-drop-picker: Attempting to end editing when you are NOT in edit mode");o.isEditing=!1;var v=this.getDataAtPosition(a);T.fF.assertValue(v,"Expect data at the given position exists");var b,m=o.value;if("string"==typeof v){if((0,V.g)(o.value))return void(o.value=v);v!==m&&(b=m)}else{if(!this.allowEmptyLabel&&(0,V.g)(o.value))return void(o.value=v.label);v.label!==m&&(b=(0,y.__assign)((0,y.__assign)({},v),{label:m}))}b&&(this.setDataAtPosition(a,b),this.propagateChange&&this.propagateChange(this.data),this.onChangeLabelUpdate.emit({newLabel:m,position:a}))}},d.prototype.handleKeyDown=function(a,o){(a.keyCode===q.hY||a.keyCode===q.K5)&&!(0,q.Vb)(a)&&this.endEditSection(o),a.stopPropagation()},d.prototype.beginEditSection=function(a){var o=this.getDisplayDataAtPosition(a);if(o.allowEditing){if(o.isEditing)return void T.fF.assertFail("Pbi-drag-drop-picker: Attempting to edit when you are already in edit mode");o.isEditing=!0}},d.prototype.detectChanges=function(){this.changeDetectorRef.detectChanges()},d.prototype.writeValue=function(a){this.data=[],this.listOfPbiDisplayData=[];for(var o=0,v=a;o<v.length;o++)this.addData(v[o])},d.prototype.registerOnChange=function(a){this.propagateChange=a},d.prototype.registerOnTouched=function(a){},d.prototype.setDisabledState=function(a){this.disabled=a},d.prototype.handleDragItemStart=function(a,o){var v,m;if(this.draggable){this.disableHover=!0,this.draggingFromPosition=o;var b={fromGroupId:null===(v=this.externalCrossPickerDragDropMonitor)||void 0===v?void 0:v.groupId,fromComponentId:null===(m=this.externalCrossPickerDragDropMonitor)||void 0===m?void 0:m.componentId,fromPosition:o,data:this.getDataAtPosition(o)};a.dataTransfer.setData(this.dataFormat,JSON.stringify(b))}},d.prototype.handleDragItemEnd=function(){this.disableHover=!1,this.resetDraggingIndex()},d.prototype.handleDragover=function(a){a.preventDefault()},d.prototype.handleDragOverAddDataArea=function(a){var o;this.allowMultipleValues&&0!==this.listOfPbiDisplayData.length?(null===(o=this.draggingFromPosition)||void 0===o?void 0:o[0])!==this.listOfPbiDisplayData.length-1&&this.handleDragover(a):this.handleDragover(a)},d.prototype.handleDragLeavePosition=function(a){this.getDisplayDataAtPosition(a).highlight=!1},d.prototype.handleDragEnterPosition=function(a){this.draggable&&(this.draggingToPosition=a,!this.isItRedundantPositionToDrop(this.draggingFromPosition,a))&&(this.getDisplayDataAtPosition(a).highlight=!0)},d.prototype.handleAddDataClick=function(a,o){this.v2Design&&this.onAddDataClick.emit({type:a.type,overlayOrigin:o})},d.prototype.handleContentClick=function(a,o){var v=this;T.fF.assert(function(){return!v.disableContentClick},"Expect this not to be called if disableContentClick is true"),this.v2Design&&this.onContentClick.emit({overlayOrigin:a,position:o})},d.prototype.handleMenuItemClick=function(a,o){this.v2Design&&this.onMenuItemClick.emit({menuButton:a,position:o})},d.prototype.onContextMenu=function(a){a.stopPropagation(),a.preventDefault()},d.prototype.focusClearButton=function(a){if(this.clearButtonQueryList){var o=this.contentLabelQueryList.toArray().findIndex(function(v){return v.nativeElement===a});this.clearButtonQueryList.get(o).nativeElement.focus()}},d.prototype.focusContentLabel=function(a){if(this.contentLabelQueryList){var o=this.clearButtonQueryList.toArray().findIndex(function(v){return v.nativeElement===a});this.contentLabelQueryList.get(o).nativeElement.focus()}},d.prototype.handleClearButtonArrowRight=function(a,o){this.onClearButtonArrowRight.emit({currentFocusedClearButton:a,topLevelIndex:_.first(o)})},d.prototype.doesCurrentDragDropReorderItems=function(){return this.doesMoveLocationReorderItems(this.draggingFromPosition,this.draggingToPosition)},d.prototype.doesMoveLocationReorderItems=function(a,o){if(!a)return!1;T.fF.assert(function(){return 1===_.size(a)},"we ONLY handle drag-drop into first level position as of now. Add your implementation for new scenario."),T.fF.assert(function(){return"end"===o||1===_.size(o)},"we ONLY handle drag-drop into first level position as of now. Add your implementation for new scenario.");var v=a[0],m=_.isArray(o)?o[0]:o;return m!==v&&("end"===m?v!==_.size(this.data)-1:m-1!==v)},d.prototype.isItRedundantPositionToDrop=function(a,o){return!!a&&!this.doesMoveLocationReorderItems(a,o)},d.prototype.isItRedundantPositionToDropCurrentData=function(a){return this.isItRedundantPositionToDrop(this.draggingFromPosition,a)},d.prototype.resetHighlight=function(){if(this.draggingFromPosition){var a=this.getDisplayDataAtPosition(this.draggingFromPosition);a&&(a.highlight=!1)}if("end"!==this.draggingToPosition){var o=this.getDisplayDataAtPosition(this.draggingToPosition);o&&(o.highlight=!1)}this.shouldHighlightLastItemBottom=!1},d.prototype.reorderItemsInternal=function(a,o){var v=this;T.fF.assert(function(){return null!=a&&_.inRange(a,0,_.size(v.data))},"expect 0 <= fromIndex < itemsCount"),T.fF.assert(function(){return null!=o&&_.inRange(o,0,_.size(v.data)+1)},"expect 0 <= toIndex <= itemsCount"),a<o&&o--;var m=this.data.splice(a,1)[0];this.data.splice(o,0,m);var b=this.listOfPbiDisplayData.splice(a,1)[0];this.listOfPbiDisplayData.splice(o,0,b),this.propagateChange&&this.propagateChange(this.data)},d.prototype.resetDraggingIndex=function(){this.draggingFromPosition=void 0,this.draggingToPosition="end"},d.prototype.handleDragEnterListEndArea=function(){this.shouldHighlightLastItemBottom=null==this.draggingFromPosition||_.size(this.draggingFromPosition)>1||this.draggingFromPosition[0]!==this.data.length-1,this.draggingToPosition="end"},d.prototype.handleDragLeaveListEndArea=function(){this.shouldHighlightLastItemBottom=!1},d.prototype.handleDrop=function(a){if(a.preventDefault(),a.stopPropagation(),null==this.draggingFromPosition){var o=a.dataTransfer.types;T.fF.assert(function(){return _.size(o)<=1},"We set one drag data format at most in the dragstart event");var v=_.first(o),m=a.dataTransfer.getData(v);if(m){var b=void 0;try{b=JSON.parse(m)}catch{}var C=void 0;if("object"==typeof b)if(function(d){return!!d&&d.hasOwnProperty("fromGroupId")&&d.hasOwnProperty("fromComponentId")&&d.hasOwnProperty("fromPosition")&&d.hasOwnProperty("data")}(b)){if(C=b.data,this.externalCrossPickerDragDropMonitor&&(this.externalCrossPickerDragDropMonitor.groupId!==b.fromGroupId||this.externalCrossPickerDragDropMonitor.componentId!==b.fromComponentId))return this.onCrossPickerDrop.emit({fromGroupId:b.fromGroupId,fromComponentId:b.fromComponentId,fromPosition:b.fromPosition,toGroupId:this.externalCrossPickerDragDropMonitor.groupId,toComponentId:this.externalCrossPickerDragDropMonitor.componentId,toPosition:this.draggingToPosition}),void this.resetHighlight()}else C=b;else C=m;this.handleAdd(C,this.draggingToPosition)}}else this.handleReorder(this.draggingFromPosition,this.draggingToPosition)},d.prototype.handleClear=function(a,o){void 0===o&&(o=!1);var v=$e(this.data,a);$e(this.listOfPbiDisplayData,a),v?(this.propagateChange&&this.propagateChange(this.data),o||this.onChangeRemove.emit({data:v,position:a})):T.fF.assertFail("expect position to be valid")},d.prototype.handleAdd=function(a,o){void 0===o&&(o="end"),this.allowMultipleValues||_.isEmpty(this.data)||"end"!==o&&1!==o.length?(this.addReplaceDataInternal(a,o,!1),this.propagateChange&&this.propagateChange(this.data),this.onChangeAdd.emit({data:a,position:o})):this.handleReplace(a,[0])},d.prototype.handleReplace=function(a,o){this.addReplaceDataInternal(a,o,!0),this.propagateChange&&this.propagateChange(this.data),this.onChangeReplace.emit({data:a,position:o})},d.prototype.addData=function(a){this.addReplaceDataInternal(a,"end",!1)},d.prototype.replaceData=function(a,o){this.addReplaceDataInternal(a,o,!0)},d.prototype.setAllData=function(a){var o=[],v=[];if(!_.isEmpty(a)&&_.every(a,function(O){return!!O}))for(var m=0,b=a;m<b.length;m++){var C=b[m],F=this.getPbiDisplayData(C,this.allowEditingLabelsSetting);if(!F)return;o.push(C),v.push(F)}this.data=o,this.listOfPbiDisplayData=v},d.prototype.handleReorder=function(a,o){var v=this;T.fF.assert(function(){return 1===_.size(a)},"We ONLY support reordering in first-level right now. Add your implementation for new scenario."),T.fF.assert(function(){return"end"===o||1===_.size(o)},"We ONLY support reordering in first-level right now. Add your implementation for new scenario.");var m=a[0],b=_.isArray(o)?o[0]:o;if(T.fF.assert(function(){return null!=m&&_.inRange(m,0,_.size(v.data))},"expect fromIndex to be in valid range"),T.fF.assert(function(){return null!=b&&("end"===b||_.inRange(b,0,_.size(v.data)))},"expect toIndex to be in valid range"),this.resetHighlight(),this.doesMoveLocationReorderItems(a,o)){var C="end"!==b?b:_.size(this.data);this.reorderItemsInternal(m,C),this.onChangeReorder.emit({data:this.data[m],fromPosition:a,toPosition:[C]})}},d.prototype.addReplaceDataInternal=function(a,o,v){if(a){T.fF.assert(function(){return"end"===o||1===_.size(o)},"we ONLY handle add/replace first level position data as of now. Add your implementation for new scenario."),T.fF.assert(function(){return!v||"end"!==o[0]},"replacement index must be a valid number"),!this.allowMultipleValues&&!v&&(this.data.pop(),this.listOfPbiDisplayData.pop());var m=this.getPbiDisplayData(a,this.allowEditingLabelsSetting);if(m){this.resetHighlight();var b=v?1:0;if("end"!==o){var C=o[0];this.data.splice(C,b,a),this.listOfPbiDisplayData.splice(C,b,m),this.scrollToIndex=C}else this.data.push(a),this.scrollToIndex=this.data.length-1,this.listOfPbiDisplayData.push(m)}}},d.prototype.getDataAtPosition=function(a){return Ue(this.data,a)},d.prototype.setDataAtPosition=function(a,o){be(this.data,a,function(v,m){v[m]=o})},d.prototype.getDisplayDataAtPosition=function(a){return Ue(this.listOfPbiDisplayData,a)},d.prototype.getPbiDisplayData=function(a,o){var m,v=this;if("string"==typeof a){if(""===a)return}else if(0===Object.keys(a).length)return;var b=(m="string"==typeof a?"allAllow"===o:"allAllow"===o||"varyByItem"===o&&!!a.allowEditLabel)||this.v2Design&&!this.disableContentClick||this.v2Design&&"string"!=typeof a&&!!a.menu;return"string"==typeof a?{value:a,allowEditing:m,isEditing:!1,highlight:!1,interactionAvailable:b}:{value:a.label,icon:a.icon,allowEditing:m,isEditing:!1,highlight:!1,interactionAvailable:b,menu:a.menu,customTooltipContent:a.customTooltipContent,children:_.isEmpty(a.children)?void 0:_.map(a.children,function(F){return v.getPbiDisplayData(F,o)}),actionTooltip:a.actionTooltip,removeDataAriaLabel:this.localizationService.format("FieldPicker_RemoveField",a.label),pbiStyle:a.pbiStyle,invalid:a.invalid}},d.\u0275fac=function(o){return new(o||d)(t.\u0275\u0275directiveInject(t.ChangeDetectorRef),t.\u0275\u0275directiveInject(j.o))},d.\u0275cmp=t.\u0275\u0275defineComponent({type:d,selectors:[["pbi-drag-drop-picker"]],viewQuery:function(o,v){if(1&o&&(t.\u0275\u0275viewQuery(pe,5),t.\u0275\u0275viewQuery(ue,5),t.\u0275\u0275viewQuery(_e,5),t.\u0275\u0275viewQuery(Le,5)),2&o){var m=void 0;t.\u0275\u0275queryRefresh(m=t.\u0275\u0275loadQuery())&&(v.dragDropPicker=m.first),t.\u0275\u0275queryRefresh(m=t.\u0275\u0275loadQuery())&&(v.clearButtonQueryList=m),t.\u0275\u0275queryRefresh(m=t.\u0275\u0275loadQuery())&&(v.contentLabelQueryList=m),t.\u0275\u0275queryRefresh(m=t.\u0275\u0275loadQuery())&&(v.listOfDataAsQueryList=m)}},inputs:{pbiDragDropPickerActionsTemplate:"pbiDragDropPickerActionsTemplate",itemPromotedActionTemplate:"itemPromotedActionTemplate",externalCrossPickerDragDropMonitor:"externalCrossPickerDragDropMonitor",allowClear:"allowClear",data:"data",dataFormat:"dataFormat",disabled:"disabled",draggable:"draggable",placeholder:"placeholder",addDataLabelKey:"addDataLabelKey",addDataAriaLabelKey:"addDataAriaLabelKey",allowMultipleValues:"allowMultipleValues",allowEditingLabelsSetting:"allowEditingLabelsSetting",useCustomTooltip:"useCustomTooltip",tooltipPosition:"tooltipPosition",tooltipWithFlexiblePositions:"tooltipWithFlexiblePositions",disableAutoScroll:"disableAutoScroll",disableClearButtonTabNavigation:"disableClearButtonTabNavigation",allowEmptyLabel:"allowEmptyLabel",compact:"compact",disableDropZoneIndicator:"disableDropZoneIndicator",disableContentClick:"disableContentClick",v2Design:"v2Design",menuMode:"menuMode",ariaLabelledby:"ariaLabelledby"},outputs:{onChangeAdd:"onChangeAdd",onChangeRemove:"onChangeRemove",onChangeReorder:"onChangeReorder",onChangeReplace:"onChangeReplace",onChangeLabelUpdate:"onChangeLabelUpdate",onCrossPickerDrop:"onCrossPickerDrop",onAddDataClick:"onAddDataClick",onContentClick:"onContentClick",onMenuItemClick:"onMenuItemClick",onClearButtonArrowRight:"onClearButtonArrowRight"},features:[t.\u0275\u0275ProvidersFeature([{provide:N.JU,useExisting:(0,t.forwardRef)(function(){return d}),multi:!0}])],decls:10,vars:10,consts:[[1,"drag-drop-picker",3,"ngClass"],["dragDropPicker",""],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf","ngIfElse"],["class","dropArea unselectable",3,"drop","dragover","dragenter","dragleave",4,"ngIf"],["nonEmptyDisplayDataListTemplate",""],["showPlaceholder",""],["addData",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"dropArea","unselectable",3,"drop","dragover","dragenter","dragleave"],[3,"ngClass"],["listOfData",""],[4,"ngFor","ngForOf"],["class","dropBetween unselectable",3,"ngClass",4,"ngIf"],[4,"ngIf"],["class","dropBetween unselectable",3,"ngClass","dragenter","dragleave","dragover","drop",4,"ngIf"],[1,"content"],["contentContainer",""],["contentLabelTemplate",""],["tooltipTemplateRef",""],["clearButtonTemplate",""],[1,"dropBetween","unselectable",3,"ngClass","dragenter","dragleave","dragover","drop"],[1,"selfAndChildrenContent"],[1,"selfLevelContentContainer",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["customClick","","pbiTooltipAlwaysShow","true",1,"contentWithIndentationContainer",3,"id","ngClass","ngStyle","disabled","pbiMenu","menuMode","pbiMenuActivation","draggable","singleClickDisabled","pbiTooltip","pbiTooltipDisabled","pbiTooltipPosition","pbiTooltipWithFlexiblePositions","doubleClickDisabled","accessible-click-ignore-mouse","accessible-click-ignore-tabindex","singleClickAction","doubleClickAction","accessible-click","keydown.F2","keydown.arrowRight","contextmenu","dragstart","dragend","dragover","drop","pbiMenuButtonClick"],["contentLabel",""],["class","indentation",3,"ngStyle",4,"ngIf"],[1,"content-label",3,"ngSwitch"],[3,"name","size",4,"ngSwitchCase"],[3,"ngStyle","sheet","symbolId",4,"ngSwitchCase"],["class","editableLabel","spellcheck","false",3,"ngModel","ngModelChange","keydown","blur",4,"pbiEditableLabel","pbiEditableLabelValue","pbiEditableLabelMode","pbiEditableLabelEditable","pbiEditableLabelClasses"],[1,"indentation",3,"ngStyle"],[3,"name","size"],[3,"ngStyle","sheet","symbolId"],["spellcheck","false",1,"editableLabel",3,"ngModel","ngModelChange","keydown","blur"],[1,"tooltipTitle",3,"textContent"],["class","fieldTooltipDescription",3,"textContent",4,"ngIf"],[1,"fieldTooltipDescription",3,"textContent"],["class","glyphicon pbi-glyph-close glyph-mini content-clear pbi-focus-outline unselectable",3,"tabindex","pbiTooltip","aria-label","click","keydown.arrowLeft","keydown.arrowRight",4,"ngIf"],[1,"glyphicon","pbi-glyph-close","glyph-mini","content-clear","pbi-focus-outline","unselectable",3,"tabindex","pbiTooltip","aria-label","click","keydown.arrowLeft","keydown.arrowRight"],["clearButton",""],[1,"dropBetween","unselectable",3,"ngClass"],["class","placeholder","aria-readonly","true","tabIndex","0",3,"drop","dragover",4,"ngIf","ngIfElse"],["aria-readonly","true","tabIndex","0",1,"placeholder",3,"drop","dragover"],["data-testid","add-data-button","class","placeholder","tabIndex","0","role","button","aria-haspopup","true",3,"ngClass","accessible-click","drop","dragenter","dragleave","dragover",4,"ngIf"],["data-testid","add-data-button","tabIndex","0","role","button","aria-haspopup","true",1,"placeholder",3,"ngClass","accessible-click","drop","dragenter","dragleave","dragover"],["addDataButton",""],["class","dropBetween unselectable insidePlaceholder",3,"ngClass",4,"ngIf"],[1,"fluentTheme-sm-reg",3,"localize","id"],[1,"dropBetween","unselectable","insidePlaceholder",3,"ngClass"]],template:function(o,v){if(1&o&&(t.\u0275\u0275elementStart(0,"div",0,1),t.\u0275\u0275template(2,Ae,1,6,"ng-container",2),t.\u0275\u0275template(3,Y,1,0,"div",3),t.\u0275\u0275template(4,qe,5,7,"ng-template",null,4,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(6,tt,1,2,"ng-template",null,5,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275template(8,nt,1,1,"ng-template",null,6,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd()),2&o){var m=t.\u0275\u0275reference(7);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction5(4,mt,v.listOfPbiDisplayData.length<1,v.disabled,v.v2Design,v.disableDropZoneIndicator,v.compact)),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",v.listOfPbiDisplayData.length>0)("ngIfElse",m),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!v.v2Design&&v.allowMultipleValues&&v.listOfPbiDisplayData.length>0)}},dependencies:[G.NgClass,G.NgForOf,G.NgIf,G.NgTemplateOutlet,G.NgStyle,G.NgSwitch,G.NgSwitchCase,ge.f,N.Fj,N.JJ,N.On,Q.X,ne.t,W.D,se._,ce.l8,de.R,K.V,e.F],styles:['[_nghost-%COMP%]{--contentBackgroundColor: var(--gray-30);--contentBorderColor: var(--gray-40);--colorActionButton: var(--gray-190);--colorItemHover: var(--gray-60);--grayBackgroundEmpty: var(--gray-20)}[data-legacy-theming=false]   [_nghost-%COMP%]{--contentBackgroundColor: var(--colorNeutralBackground3);--contentBorderColor: var(--colorNeutralStroke1);--colorActionButton: var(--colorNeutralForeground1);--colorItemHover: var(--colorNeutralBackground3Hover);--grayBackgroundEmpty: var(--colorNeutralBackground3)}.placeholder-gray-background[_nghost-%COMP%]   .drag-drop-picker.empty[_ngcontent-%COMP%]{background-color:var(--grayBackgroundEmpty);border:1px solid var(--grayBackgroundEmpty)}.pbi-drag-drop-picker-scrollbar[_nghost-%COMP%]   .drag-drop-picker[_ngcontent-%COMP%]{overflow-y:auto}.tooltipTitle[_ngcontent-%COMP%]{font-weight:700}.fieldTooltipDescription[_ngcontent-%COMP%]{max-width:240px;display:block;word-break:break-word;white-space:pre-wrap}.drag-drop-picker[_ngcontent-%COMP%]{display:flex;border:1px dashed var(--gray-130, #605E5C);border-radius:2px;flex-direction:column;--field-error-background-color: var(--globalColorCranberryTint60);--field-error-border-color: var(--globalColorCranberryShade10)}  [data-legacy-theming=false] .drag-drop-picker{--field-error-background-color: var(--colorDangerBackground1);--field-error-border-color: var(--colorDangerBorder1)}.drag-drop-picker.disabled[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.drag-drop-picker.v2Design[_ngcontent-%COMP%]{border:1px dashed var(--colorNeutralStrokeAccessible);background-color:var(--colorNeutralBackground1);height:100%;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground2);border-color:var(--colorNeutralStrokeAccessible);border-radius:3px;color:var(--colorNeutralForeground1);padding:2px;height:fit-content;display:flex;flex-direction:row;align-items:center}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content.error[_ngcontent-%COMP%]{border-color:var(--field-error-border-color);background-color:var(--field-error-background-color);color:var(--colorDangerForeground1)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow-x:hidden}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:row;align-items:center;box-sizing:border-box;height:24px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]{padding:0 2px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .contentWithIndentationContainer.interactable[_ngcontent-%COMP%]{cursor:pointer}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .contentWithIndentationContainer.showHover[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground3Hover)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]{height:24px;width:24px;display:flex;align-items:center;justify-content:center;margin:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground3Hover)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer.compact[_ngcontent-%COMP%]{height:16px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer.compact[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]{height:16px;width:16px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .childrenContentContainer[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .childrenContentContainer[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{border:none;padding:0;margin:0}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);display:flex;justify-content:center;cursor:pointer;padding:0;margin:4px;line-height:28px;box-sizing:border-box;position:relative;border:1px solid var(--colorNeutralStrokeAccessible)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder.compact[_ngcontent-%COMP%]{line-height:20px}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]   .dropBetween.insidePlaceholder[_ngcontent-%COMP%]{pointer-events:none;position:absolute;top:0;left:0;width:calc(100% - 8px)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]:hover{background-color:var(--colorNeutralBackground1Hover)}.drag-drop-picker.v2Design[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;cursor:pointer;pointer-events:none;display:flex;align-items:center;justify-content:center}.drag-drop-picker.v2Design.disabled[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.5}.drag-drop-picker[_ngcontent-%COMP%]   div.dropBetween[_ngcontent-%COMP%]{height:4px;margin:0 4px}.drag-drop-picker[_ngcontent-%COMP%]   div.dropBetween.highlight[_ngcontent-%COMP%]{background-color:var(--theme-primary-color, #F2C811)}.drag-drop-picker[_ngcontent-%COMP%]   div.dropArea[_ngcontent-%COMP%]{flex:1;min-height:8px}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex:1;white-space:nowrap;overflow:hidden;padding:6px 8px;height:12px;border-radius:2px}.drag-drop-picker[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]{color:var(--gray-90, #A19F9D)}.drag-drop-picker[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{margin:0 4px;border:1px solid var(--contentBorderColor);background-color:var(--contentBackgroundColor)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-right:8px;flex-shrink:0}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   pbi-svg-use-symbol[_ngcontent-%COMP%]{width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px);margin-right:8px;flex-shrink:0}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]{overflow:hidden;flex:1;display:flex;flex-direction:row}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer.showHover[_ngcontent-%COMP%]:hover{background-color:var(--colorItemHover)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-label[_ngcontent-%COMP%]{display:flex;text-overflow:ellipsis;overflow:hidden;align-items:center;padding:0;flex:1;color:var(--colorNeutralForeground1)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%]{cursor:pointer;padding:0;border:0;background:transparent;margin-left:12px;color:var(--colorActionButton)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%], .drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-clear[_ngcontent-%COMP%], .drag-drop-picker   span   [_nghost-%COMP%]     .pbi-drag-drop-picker-actions button{box-sizing:border-box;border:solid 2px transparent;border-radius:2px;outline:none}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer.pbi-focus-outline[_ngcontent-%COMP%]:focus-visible, .drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .content-clear.pbi-focus-outline[_ngcontent-%COMP%]:focus-visible, .drag-drop-picker   span   [_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.pbi-focus-outline:focus-visible{border-color:var(--gray-140, #484644)}.drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]   .content-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .drag-drop-picker[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .contentWithIndentationContainer[_ngcontent-%COMP%]   .content-label[_ngcontent-%COMP%]   pbi-text-label[_ngcontent-%COMP%]{outline:none;border:none}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]{border-style:solid}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{border-style:none}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer[_ngcontent-%COMP%]{height:26px}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]   .selfAndChildrenContent[_ngcontent-%COMP%]   .selfLevelContentContainer.compact[_ngcontent-%COMP%]{height:18px}.drag-drop-picker.disableDropZoneIndicator[_ngcontent-%COMP%]   span.placeholder[_ngcontent-%COMP%]{border-color:var(--colorNeutralStroke1)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions{align-self:stretch;display:flex;justify-content:space-evenly;align-items:center}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions>*{color:var(--gray-190, #201F1E)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.v2Design{margin:0;border:0;height:24px;width:24px;color:var(--colorNeutralForeground1);fill:var(--colorNeutralForeground1)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions button.v2Design:hover{background-color:var(--colorNeutralBackground3Hover)}[_nghost-%COMP%]     .pbi-drag-drop-picker-actions .button-divider.v2Design{align-self:stretch;margin-top:4px;margin-bottom:4px;background-color:var(--colorNeutralStrokeAccessible)}[_nghost-%COMP%]     .compact button.v2Design{height:16px;width:16px}[_nghost-%COMP%]     .compact .button-divider.v2Design{margin-top:2px;margin-bottom:2px}[_nghost-%COMP%]     .content-label pbi-text-label{margin:0;padding:0;flex:1;overflow-x:hidden}[_nghost-%COMP%]     .content-label input{margin:0;padding:2px 0;width:100%}'],changeDetection:0}),d}();function Ue(d,a){return be(d,a,function(o,v){return o[v]})}function $e(d,a){return be(d,a,function(o,v){return o.splice(v,1)[0]})}function be(d,a,o){T.fF.assert(function(){return!_.isEmpty(a)},"the given position should contain at least one element");var v=a[0],m=_.nth(d,v);T.fF.assertAnyValue(m,"it is possible that currentLevelItem is undefined, e.g. when using this function to add an item after the last item in the collection at the lowest level of the position");var b=a.slice(1);return _.isEmpty(b)?o(d,v):m?"string"==typeof m?(T.fF.assertFail("string data should not have any child"),o(d,v)):be(m.children,b,o):void T.fF.assertFail("trying to do something to a child of an item but the item does not exist")}},56598:function(Me,re,g){g.d(re,{K:function(){return ae}});var y=g(67659),u=g(5806),q=g(94770),t=g(93367),N=g(94841),T=g(79725),V=g(16095),ee=g(77476),te=g(17174),H=g(79061),J=g(50423),ae=function(){function j(){}return j.\u0275fac=function(ge){return new(ge||j)},j.\u0275mod=J.\u0275\u0275defineNgModule({type:j}),j.\u0275inj=J.\u0275\u0275defineInjector({imports:[ee.CommonModule,u.Y,te.u5,H.v,y._,q.f,t.U,N.b,T.j,V.Z,te.UX]}),j}()},58679:function(Me,re,g){g.d(re,{I:function(){return ge}});var y=g(65005),u=g(62458),q=g(9795),t=g(59017),N=g(59973),T=g(14172),V=g(81905),ee=g(83317),te=g(48787),H=g(50423),J=g(84354),ae=function(){function Q(ne){this.pbiDropdownService=ne,this.isOpen$=this.pbiDropdownService.select$("open");var W=this.pbiDropdownService.select$("dropdownItems"),se=this.pbiDropdownService.select$("overlayRef"),ce=W.pipe((0,N.h)(function(K){return!!K}),(0,T.U)(function(K){return u.fF.assert(function(){return 1===K.length},"Expected 1 FieldListComponent"),K.first})),de=ce.pipe((0,V.w)(function(K){return K.onFirstRenderComplete}));(0,t.aj)([this.isOpen$,se,ce,de]).pipe((0,ee.R)(this.pbiDropdownService.onDestroy$),(0,N.h)(function(K){var pe=K[1],ue=K[2];return K[0]&&!!pe?.overlayRef.overlayElement&&!!ue})).subscribe(function(K){K[2].focusSearchBox()})}return Q.prototype.buttonKeydown=function(ne){var W=this;this.isOpen$.pipe((0,te.q)(1)).subscribe(function(se){se||(0,q.Wl)(ne.keyCode)&&(W.pbiDropdownService.toggleOpenState(),ne.preventDefault())})},Q.\u0275fac=function(W){return new(W||Q)(H.\u0275\u0275inject(J.S))},Q.\u0275prov=H.\u0275\u0275defineInjectable({token:Q,factory:Q.\u0275fac}),Q}(),j=g(26333),G=g(31343),ge=function(){function Q(ne,W){this.pbiDropdownService=ne,this.strategy=W}return Q.prototype.ngAfterViewInit=function(){var ne=this;(0,j.x)([{strategy:this.strategy,dropdownItems:this.dropdownItems}],G.N).subscribe(function(W){ne.pbiDropdownService.updateState(W)})},Q.\u0275fac=function(W){return new(W||Q)(H.\u0275\u0275directiveInject(J.S),H.\u0275\u0275directiveInject(ae))},Q.\u0275dir=H.\u0275\u0275defineDirective({type:Q,selectors:[["pbi-dropdown","dropdown-type","field-list"]],contentQueries:function(W,se,ce){var de;(1&W&&H.\u0275\u0275contentQuery(ce,y.l,5),2&W)&&(H.\u0275\u0275queryRefresh(de=H.\u0275\u0275loadQuery())&&(se.dropdownItems=de))},features:[H.\u0275\u0275ProvidersFeature([ae])]}),Q}()},65005:function(Me,re,g){g.d(re,{l:function(){return Re}});var y=g(81337),u=g(50423),q=g(48787),t=g(30794),N=g(37196),T=[],V=g(77476),ee=g(68070),te=g(89237);function H(P,B){1&P&&u.\u0275\u0275element(0,"div",7)}function J(P,B){1&P&&(u.\u0275\u0275elementStart(0,"div",8),u.\u0275\u0275element(1,"div",9)(2,"div",10),u.\u0275\u0275elementEnd())}function ae(P,B){1&P&&(u.\u0275\u0275elementStart(0,"div",11),u.\u0275\u0275element(1,"div",12),u.\u0275\u0275elementStart(2,"div",13),u.\u0275\u0275element(3,"div",14)(4,"div",15),u.\u0275\u0275elementEnd()())}function j(P,B){if(1&P&&(u.\u0275\u0275elementContainerStart(0,3),u.\u0275\u0275template(1,H,1,0,"div",4),u.\u0275\u0275template(2,J,3,0,"div",5),u.\u0275\u0275template(3,ae,5,0,"div",6),u.\u0275\u0275elementContainerEnd()),2&P){var k=B.$implicit,I=u.\u0275\u0275nextContext(2);u.\u0275\u0275property("ngSwitch",k),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngSwitchCase",I.largeBarType),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngSwitchCase",I.multipleBarType),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngSwitchCase",I.multipleSmallLargeType)}}function G(P,B){if(1&P&&(u.\u0275\u0275elementStart(0,"div",1),u.\u0275\u0275template(1,j,4,4,"ng-container",2),u.\u0275\u0275elementEnd()),2&P){var k=u.\u0275\u0275nextContext();u.\u0275\u0275property("ngStyle",k.barsStyle),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngForOf",k.barsProperties.bars)}}var ce=function(){function P(){this.largeBarType=0,this.multipleBarType=1,this.multipleSmallLargeType=2}return P.prototype.ngOnChanges=function(){this.barsProperties&&(this.barsStyle={height:"".concat((this.barsProperties.height+8)*this.barsProperties.bars.length,"px")})},P.\u0275fac=function(k){return new(k||P)},P.\u0275cmp=u.\u0275\u0275defineComponent({type:P,selectors:[["shimmering-bars"]],inputs:{barsProperties:"barsProperties"},features:[u.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","bars",3,"ngStyle",4,"ngIf"],[1,"bars",3,"ngStyle"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["class","largerLoadingBar animate",4,"ngSwitchCase"],["class","multipleBars",4,"ngSwitchCase"],["class","multipleSmallLarge",4,"ngSwitchCase"],[1,"largerLoadingBar","animate"],[1,"multipleBars"],[1,"miniLoadingBar","animate"],[1,"smallerLoadingBar","animate"],[1,"multipleSmallLarge"],[1,"shimmerBox","animate"],[1,"smallLargeBarContainer"],[1,"upperLoadingBar","animate"],[1,"lowerLoadingBar","animate"]],template:function(k,I){1&k&&u.\u0275\u0275template(0,G,2,2,"div",0),2&k&&u.\u0275\u0275property("ngIf",I.barsProperties)},dependencies:[V.NgForOf,V.NgIf,V.NgStyle,V.NgSwitch,V.NgSwitchCase],styles:['[_nghost-%COMP%]{--shimmer-background-color: var(--gray-20);--shimmer-animate1: var(--gray-30);--shimmer-animate2: var(--gray-50)}[data-legacy-theming=false]   [_nghost-%COMP%]{--shimmer-background-color: var(--colorNeutralBackground3);--shimmer-animate1: var(--colorNeutralBackground3Hover);--shimmer-animate2: var(--colorNeutralBackground3Pressed)}.bars[_ngcontent-%COMP%]{display:flex;flex-direction:column}.largerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;flex-grow:1;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .largerLoadingBar[_ngcontent-%COMP%]{margin:4px 8px}.multipleBars[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1}html:not([dir="rtl"])[_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .multipleBars[_ngcontent-%COMP%]{margin:4px 8px}.miniLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:60%;width:10%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%]{margin-right:4px}html[dir="rtl"][_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .miniLoadingBar[_ngcontent-%COMP%]{margin-left:4px}.smallerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:80%;width:100%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%]{margin-left:4px}html[dir="rtl"][_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .smallerLoadingBar[_ngcontent-%COMP%]{margin-right:4px}.multipleSmallLarge[_ngcontent-%COMP%]{display:flex;flex-grow:1;padding:10px 9px}html:not([dir="rtl"])[_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%]{margin:4px 8px}html[dir="rtl"][_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .multipleSmallLarge[_ngcontent-%COMP%]{margin:4px 8px}.upperLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:65%;width:49%;background:var(--shimmer-background-color)}html:not([dir="rtl"])[_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%]{margin:0 4px 11px 0}html[dir="rtl"][_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .upperLoadingBar[_ngcontent-%COMP%]{margin:0 0 11px 4px}.lowerLoadingBar[_ngcontent-%COMP%]{border-radius:2px;height:65%;width:100%;background:var(--shimmer-background-color)}.shimmerBox[_ngcontent-%COMP%]{background:var(--shimmer-background-color);border-radius:2px;height:32px;width:32px}.smallLargeBarContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;max-width:167px}html:not([dir="rtl"])[_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%]{margin:4px 0 2.42px 13px}html[dir="rtl"][_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .smallLargeBarContainer[_ngcontent-%COMP%]{margin:4px 13px 2.42px 0}.animate[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shimmer 5s infinite linear;background:linear-gradient(270deg,var(--shimmer-animate1) 0%,var(--shimmer-animate2) 50%,var(--shimmer-animate1) 100%);background-size:250% 100%}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:250% 0}to{background-position:-250% 0}}'],changeDetection:0}),P}(),de=g(85102),K=["pbiTree"];function e(P,B){if(1&P){var k=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"tri-search-box",5),u.\u0275\u0275listener("value",function(Z){u.\u0275\u0275restoreView(k);var oe=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(oe.search$.next(Z))}),u.\u0275\u0275pipe(1,"localize"),u.\u0275\u0275pipe(2,"localize"),u.\u0275\u0275elementEnd()}if(2&P){var I=u.\u0275\u0275nextContext();u.\u0275\u0275property("currentInputValue",I.searchText||"")("placeholderText",u.\u0275\u0275pipeBind1(2,8,"SearchBox_Text"))("fluentTheme",!0)("compact",!0)("fullWidth",!0),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(1,6,"SearchBox_Text"))}}function pe(P,B){if(1&P){var k=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"pbi-search-box")(1,"input",6),u.\u0275\u0275listener("input",function(Z){u.\u0275\u0275restoreView(k);var oe=u.\u0275\u0275nextContext();return u.\u0275\u0275resetView(oe.search$.next(Z.target.value))}),u.\u0275\u0275pipe(2,"localize"),u.\u0275\u0275pipe(3,"localize"),u.\u0275\u0275elementEnd()()}if(2&P){var I=u.\u0275\u0275nextContext();u.\u0275\u0275advance(1),u.\u0275\u0275property("value",I.searchText||"")("placeholder",u.\u0275\u0275pipeBind1(3,5,"SearchBox_Text")),u.\u0275\u0275attribute("aria-label",u.\u0275\u0275pipeBind1(2,3,"SearchBox_Text"))}}function ue(P,B){if(1&P&&(u.\u0275\u0275elementContainerStart(0),u.\u0275\u0275element(1,"shimmering-bars",7),u.\u0275\u0275elementContainerEnd()),2&P){var k=u.\u0275\u0275nextContext();u.\u0275\u0275advance(1),u.\u0275\u0275property("barsProperties",k.shimmeringBars)}}function _e(P,B){if(1&P){var k=u.\u0275\u0275getCurrentView();u.\u0275\u0275elementStart(0,"pbi-tree",12,13),u.\u0275\u0275listener("onNodeClick",function(Z){u.\u0275\u0275restoreView(k);var oe=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(oe.onNodeClick.emit(Z))})("onNodeCheck",function(Z){u.\u0275\u0275restoreView(k);var oe=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(oe.onNodeCheck.emit(Z))})("onNodeExpansionToggle",function(Z){u.\u0275\u0275restoreView(k);var oe=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(oe.onNodeExpansionToggle.emit(Z))})("onFirstRender",function(){u.\u0275\u0275restoreView(k);var Z=u.\u0275\u0275nextContext(2);return u.\u0275\u0275resetView(Z.onFirstRender())}),u.\u0275\u0275pipe(2,"async"),u.\u0275\u0275elementEnd()}if(2&P){var I=u.\u0275\u0275nextContext(2);u.\u0275\u0275property("tree",I.fieldListTree)("search",u.\u0275\u0275pipeBind1(2,5,I.search$))("hasHighlights",I.hasHighlights)("checkMode",I.checkMode)("options",I._options)}}function Le(P,B){1&P&&u.\u0275\u0275projection(0,2)}function Ve(P,B){if(1&P&&(u.\u0275\u0275elementStart(0,"div",8),u.\u0275\u0275element(1,"div",9),u.\u0275\u0275elementEnd(),u.\u0275\u0275template(2,_e,3,7,"pbi-tree",10),u.\u0275\u0275template(3,Le,1,0,"ng-template",null,11,u.\u0275\u0275templateRefExtractor)),2&P){var k=u.\u0275\u0275reference(4),I=u.\u0275\u0275nextContext();u.\u0275\u0275advance(2),u.\u0275\u0275property("ngIf",I.fieldListTree)("ngIfElse",k)}}var Be=[[["",8,"pbi-field-list-perspective-header"]],[["",8,"pbi-field-list-header"]],[["",8,"pbi-field-list-watermark"]]],Ae=[".pbi-field-list-perspective-header",".pbi-field-list-header",".pbi-field-list-watermark"],Ce={height:24,bars:[0,1,1,0,0]},Re=function(){function P(){this.hasHighlights=!1,this.loading=!1,this.shimmeringBars=Ce,this.defaultOptions={},this._options=this.defaultOptions,this.onNodeExpansionToggle=new u.EventEmitter,this.onNodeClick=new u.EventEmitter,this.onNodeCheck=new u.EventEmitter,this.onFirstRenderComplete=new u.EventEmitter,this.handleFieldListTreeHeightDiff=new u.EventEmitter,this.search$=new t.xQ}return Object.defineProperty(P.prototype,"options",{set:function(k){this._options=(0,y.__assign)((0,y.__assign)({},this.defaultOptions),k)},enumerable:!1,configurable:!0}),P.prototype.ngOnInit=function(){var B=this;this.focusSearchBoxOnFirstRenderComplete&&this.onFirstRenderComplete.pipe((0,q.q)(1)).subscribe(function(){return B.focusSearchBox()})},P.prototype.onFirstRender=function(){var B=this.getFieldListTreeHeightDiff();this.handleFieldListTreeHeightDiff.emit(B),this.scrollSelectedItemIntoViewOnInit&&this.pbiTree.scrollToFirstSelectedNode(),this.onFirstRenderComplete.emit()},P.prototype.focusSearchBox=function(){$(".field-list-search-container input").trigger("focus")},P.prototype.getFieldListTreeHeightDiff=function(){return this.pbiTree.getTreeHeight()+2-this.pbiTreeElementRef.nativeElement.getBoundingClientRect().height},P.\u0275fac=function(k){return new(k||P)},P.\u0275cmp=u.\u0275\u0275defineComponent({type:P,selectors:[["pbi-field-list"]],viewQuery:function(k,I){if(1&k&&(u.\u0275\u0275viewQuery(N.u,5),u.\u0275\u0275viewQuery(K,5,u.ElementRef)),2&k){var U=void 0;u.\u0275\u0275queryRefresh(U=u.\u0275\u0275loadQuery())&&(I.pbiTree=U.first),u.\u0275\u0275queryRefresh(U=u.\u0275\u0275loadQuery())&&(I.pbiTreeElementRef=U.first)}},inputs:{fieldListTree:"fieldListTree",scrollSelectedItemIntoViewOnInit:"scrollSelectedItemIntoViewOnInit",checkMode:"checkMode",hasHighlights:"hasHighlights",loading:"loading",searchText:"searchText",focusSearchBoxOnFirstRenderComplete:"focusSearchBoxOnFirstRenderComplete",fluent:"fluent",options:"options"},outputs:{onNodeExpansionToggle:"onNodeExpansionToggle",onNodeClick:"onNodeClick",onNodeCheck:"onNodeCheck",onFirstRenderComplete:"onFirstRenderComplete",handleFieldListTreeHeightDiff:"handleFieldListTreeHeightDiff"},features:[u.\u0275\u0275ProvidersFeature(T)],ngContentSelectors:Ae,decls:8,vars:4,consts:[["data-tutorial-target","search-box",1,"field-list-search-container"],["data-testid","search-bar-input",3,"currentInputValue","placeholderText","fluentTheme","compact","fullWidth","value",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["loaded",""],["data-testid","search-bar-input",3,"currentInputValue","placeholderText","fluentTheme","compact","fullWidth","value"],["pbiSearchInput","","data-testid","search-bar-input",1,"pbi-focus-outline",3,"value","placeholder","input"],[3,"barsProperties"],[1,"tutorial-target-container"],["data-tutorial-target","data-tree"],["data-testid","data-tree",3,"tree","search","hasHighlights","checkMode","options","onNodeClick","onNodeCheck","onNodeExpansionToggle","onFirstRender",4,"ngIf","ngIfElse"],["watermark",""],["data-testid","data-tree",3,"tree","search","hasHighlights","checkMode","options","onNodeClick","onNodeCheck","onNodeExpansionToggle","onFirstRender"],["pbiTree",""]],template:function(k,I){if(1&k&&(u.\u0275\u0275projectionDef(Be),u.\u0275\u0275elementStart(0,"div",0),u.\u0275\u0275template(1,e,3,10,"tri-search-box",1),u.\u0275\u0275template(2,pe,4,7,"pbi-search-box",2),u.\u0275\u0275elementEnd(),u.\u0275\u0275projection(3),u.\u0275\u0275projection(4,1),u.\u0275\u0275template(5,ue,2,1,"ng-container",3),u.\u0275\u0275template(6,Ve,5,2,"ng-template",null,4,u.\u0275\u0275templateRefExtractor)),2&k){var U=u.\u0275\u0275reference(7);u.\u0275\u0275advance(1),u.\u0275\u0275property("ngIf",I.fluent),u.\u0275\u0275advance(1),u.\u0275\u0275property("ngIf",!I.fluent),u.\u0275\u0275advance(3),u.\u0275\u0275property("ngIf",I.loading)("ngIfElse",U)}},dependencies:[V.NgIf,ee.a,ee.p,te.U,N.u,ce,V.AsyncPipe,de.F],styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}pbi-tree[_ngcontent-%COMP%]{margin-top:9px;height:100%;display:block;overflow:hidden}.tutorial-target-container[_ngcontent-%COMP%]{position:relative;visibility:hidden;height:0;width:0}.tutorial-target-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:20px;visibility:hidden;height:0;width:0}"],changeDetection:0}),P}()}}]);