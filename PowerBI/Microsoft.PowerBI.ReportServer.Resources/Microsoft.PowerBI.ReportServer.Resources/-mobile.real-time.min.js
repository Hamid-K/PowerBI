(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["real-time"],{74793:function(xe,ye,te){"use strict";Object.defineProperty(ye,"__esModule",{value:!0}),ye.Autoload=void 0;var re,se=function(){function re(D,w){for(var M=0;M<w.length;M++){var L=w[M];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(D,L.key,L)}}return function(D,w,M){return w&&re(D.prototype,w),M&&re(D,M),D}}(),Q=(re=te(68276))&&re.__esModule?re:{default:re};ye.Autoload=function(){function re(){(function(re,D){if(!(re instanceof D))throw new TypeError("Cannot call a class as a function")})(this,re),this.count={},this.instance=void 0}return se(re,[{key:"initialize",value:function(w){this.instance=w}},{key:"enableLoad",value:function(w){var M=this;w.autoload&&"number"==typeof w.autoload&&(this.count[w.channels]=w.autoload,w.channels.forEach(function(L){M.count[L]=w.autoload}))}},{key:"getHistory",value:function(w,M){var L=this;if(this.count[w]){var B=this.instance,ie=Array.isArray(w)?w:[w],ge=ie.length;ie.forEach(function(Ee){B.history({channel:Ee,count:L.count[w]}).then(function(rt){rt.messages.forEach(function(ze){ze.message=ze.entry,ze.channel=Ee,B.outputOn.push(w,ze)}),ge-=1,M&&0===ge&&(B.outputOn.sort(w,Q.default.history_sort_attribute),M())}).catch(function(){})})}}},{key:"disableLoad",value:function(w){var M=this;Array.isArray(w.channels)?w.channels.forEach(function(L){M.count[L]&&delete M.count[L]}):this.count[w.channels]&&delete this.count[w.channels]}}]),re}()},16019:function(xe,ye,te){"use strict";Object.defineProperty(ye,"__esModule",{value:!0}),ye.Broadcast=void 0;var w,se=function(){function w(M,L){for(var B=0;B<L.length;B++){var ie=L[B];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(M,ie.key,ie)}}return function(M,L,B){return L&&w(M.prototype,L),B&&w(M,B),M}}(),Q=(w=te(68276))&&w.__esModule?w:{default:w};ye.Broadcast=function(){function w(){var M=this;(function(w,M){if(!(w instanceof M))throw new TypeError("Cannot call a class as a function")})(this,w),Q.default.subscribe_listener_events_to_broadcast.forEach(function(L){var B="_".concat(L);M[B]={},M[L]=function(ie,ge){!function(w,M,L){Array.isArray(M)?M.forEach(function(B){w[B]=L}):w[M]=L}(this[B],ie,ge)}})}return se(w,[{key:"emit",value:function(L,B,ie){var ge="_".concat(L);this[ge]&&this[ge][B]&&this[ge][B].call(null,ie)}},{key:"error",value:function(L){this._error=L}},{key:"emitError",value:function(L){this._error&&this._error.call(null,L)}},{key:"unsubscribe",value:function(L){var B=this;Q.default.subscribe_listener_events_to_broadcast.forEach(function(ie){var ge="_".concat(ie);!function(w,M){Array.isArray(M)?M.forEach(function(L){w[L]&&delete w[L]}):w[M]&&delete w[M]}(B[ge],L)})}}]),w}()},44889:function(xe,ye,te){"use strict";Object.defineProperty(ye,"__esModule",{value:!0}),ye.Mock=void 0;var re,se=function(){function re(D,w){for(var M=0;M<w.length;M++){var L=w[M];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(D,L.key,L)}}return function(D,w,M){return w&&re(D.prototype,w),M&&re(D,M),D}}(),Q=(re=te(68276))&&re.__esModule?re:{default:re};ye.Mock=function(){function re(D){(function(re,D){if(!(re instanceof D))throw new TypeError("Cannot call a class as a function")})(this,re),this.listener=null,this.broadcaster=D,this.broadcastChannels={}}return se(re,[{key:"initializeListener",value:function(w){if(null===this.listener){var M=this;M.listener={},Q.default.subscribe_listener_events_to_broadcast.forEach(function(L){M.listener[L]=function(B){B.subscription&&M.broadcastChannels[B.subscription]&&M.broadcastChannels[B.subscription].includes(L)&&(M.broadcaster.emit(L,B.subscription,B),B.channel&&M.broadcaster.emit(L,B.channel,B)),B.channel&&M.broadcastChannels[B.channel]&&M.broadcastChannels[B.channel].includes(L)&&M.broadcaster.emit(L,B.channel,B),"status"===L&&(B.error?M.broadcaster.emitError(B):B.affectedChannels||B.affectedChannelGroups?(B.affectedChannels.forEach(function(ie){M.broadcastChannels[ie]&&M.broadcastChannels[ie].includes(L)&&M.broadcaster.emit(L,ie,B)}),B.affectedChannelGroups.forEach(function(ie){M.broadcastChannels[ie]&&M.broadcastChannels[ie].includes(L)&&M.broadcaster.emit(L,ie,B)})):Object.keys(M.broadcastChannels).forEach(function(ie){M.broadcaster.emit(L,ie,B)}))}}),w.getOriginalInstance().addListener(this.listener)}}},{key:"addEventsBroadcast",value:function(w,M){var L=this;w.forEach(function(B){"boolean"==typeof M?L.broadcastChannels[B]=Q.default.subscribe_listener_events_to_broadcast:Array.isArray(M)&&(L.broadcastChannels[B]=[],M.forEach(function(ie){Q.default.subscribe_listener_events_to_broadcast.includes(ie)&&L.broadcastChannels[B].push(ie)}))})}},{key:"removeEventBroadcast",value:function(w){var M=this;w.forEach(function(L){M.broadcastChannels[L]&&delete M.broadcastChannels[L]})}},{key:"enableEventsBroadcast",value:function(w){w.channels&&this.addEventsBroadcast(w.channels,w.triggerEvents),w.channelGroups&&this.addEventsBroadcast(w.channelGroups,w.triggerEvents)}},{key:"disableEventsBroadcast",value:function(w){w.channels&&this.removeEventBroadcast(w.channels),w.channelGroups&&this.removeEventBroadcast(w.channelGroups)}}]),re}()},94495:function(xe,ye){"use strict";Object.defineProperty(ye,"__esModule",{value:!0});var te=function(){function Q(le,Y){for(var q=0;q<Y.length;q++){var re=Y[q];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(le,re.key,re)}}return function(le,Y,q){return Y&&Q(le.prototype,Y),q&&Q(le,q),le}}();ye.Output=function(){function Q(){(function(Q,le){if(!(Q instanceof le))throw new TypeError("Cannot call a class as a function")})(this,Q),this.channels={},this.keepMessages={}}return te(Q,[{key:"push",value:function(Y,q){this.channels[Y]&&(this.channels[Y].push(q),this.keepMessages[Y]&&this.channels[Y].length>this.keepMessages[Y]&&this.channels[Y].splice(0,this.channels[Y].length-this.keepMessages[Y]))}},{key:"get",value:function(Y){return this.channels[Y]?this.channels[Y]:null}},{key:"clean",value:function(Y){this.channels[Y]&&(this.channels[Y].length=0)}},{key:"subscribe",value:function(Y,q){return!this.channels[Y]&&(this.channels[Y]=[],this.keepMessages[Y]=q,!0)}},{key:"sort",value:function(Y,q){this.channels[Y]&&this.channels[Y].sort(function(re,D){return re[q]>D[q]?1:re[q]<D[q]?-1:0})}},{key:"unsubscribe",value:function(Y){this.channels[Y]&&(this.clean(Y),delete this.channels[Y])}}]),Q}()},25850:function(xe,ye,te){"use strict";ye.n=void 0;var Q=q(te(44048)),Y=q(te(2342));function q(L){return L&&L.__esModule?L:{default:L}}ye.n=function(L){function B(){return function(L,B){if(!(L instanceof B))throw new TypeError("Cannot call a class as a function")}(this,B),function(L,B){if(!L)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!B||"object"!=typeof B&&"function"!=typeof B?L:B}(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,Q.default))}return function(L,B){if("function"!=typeof B&&null!==B)throw new TypeError("Super expression must either be null or a function, not "+typeof B);L.prototype=Object.create(B&&B.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(L,B):L.__proto__=B)}(B,L),B}(Y.default)},2342:function(xe,ye,te){"use strict";Object.defineProperty(ye,"__esModule",{value:!0});var D,se=function(){function D(w,M){for(var L=0;L<M.length;L++){var B=M[L];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(w,B.key,B)}}return function(w,M,L){return M&&D(w.prototype,M),L&&D(w,L),w}}(),Q=(D=te(68276))&&D.__esModule?D:{default:D},le=te(53426),re=function(){function D(w){(function(D,w){if(!(D instanceof w))throw new TypeError("Cannot call a class as a function")})(this,D),this.pubnub=w,this.wrappers={}}return se(D,[{key:"init",value:function(M){var L=this.getInstance(Q.default.default_instance_name);return L.init(M),L}},{key:"getInstance",value:function(M){var L=this,B=this.wrappers[M];return B&&B instanceof le.Wrapper?B:"string"==typeof M&&M.length>0?(this.wrappers[M]=new le.Wrapper(M,this.pubnub),Q.default.attributes_to_delegate.forEach(function(ie){L.wrappers[M].wrapAttribute(ie),L[ie]||Object.defineProperty(L,ie,{get:function(){return this.getInstance(Q.default.default_instance_name)[ie]}})}),Q.default.methods_to_delegate.forEach(function(ie){L.wrappers[M].wrapMethod(ie),L[ie]||(L[ie]=function(){var ge=this.getInstance(Q.default.default_instance_name);return ge[ie].apply(ge,arguments)})}),this.wrappers[M]):B}},{key:"subscribe",value:function(M){this.getInstance(Q.default.default_instance_name).subscribe(M)}},{key:"unsubscribe",value:function(M){this.getInstance(Q.default.default_instance_name).unsubscribe(M)}},{key:"getMessage",value:function(M){for(var L,B=arguments.length,ie=Array(B>1?B-1:0),ge=1;ge<B;ge++)ie[ge-1]=arguments[ge];return(L=this.getInstance(Q.default.default_instance_name)).getMessage.apply(L,[M].concat(ie))}},{key:"getPresence",value:function(M,L){this.getInstance(Q.default.default_instance_name).getPresence(M,L)}},{key:"getStatus",value:function(M,L){this.getInstance(Q.default.default_instance_name).getStatus(M,L)}},{key:"getError",value:function(M){this.getInstance(Q.default.default_instance_name).getError(M)}},{key:"clean",value:function(M){this.getInstance(Q.default.default_instance_name).clean(M)}},{key:"release",value:function(M){this.getInstance(Q.default.default_instance_name).release(M)}}]),D}();ye.default=re,xe.exports=ye.default},53426:function(xe,ye,te){"use strict";Object.defineProperty(ye,"__esModule",{value:!0}),ye.Wrapper=void 0;var se=function(){function D(w,M){for(var L=0;L<M.length;L++){var B=M[L];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(w,B.key,B)}}return function(w,M,L){return M&&D(w.prototype,M),L&&D(w,L),w}}(),W=te(44889),Q=te(16019),le=te(94495),Y=te(74793);ye.Wrapper=function(){function D(w,M){if(function(D,w){if(!(D instanceof w))throw new TypeError("Cannot call a class as a function")}(this,D),this.label=w,this.pubnubInstance=null,this.PubNub=M,this.broadcastOn=new Q.Broadcast,this.outputOn=new le.Output,this.mockingInstance=new W.Mock(this.broadcastOn),this.autoload=new Y.Autoload,this.PubNub||(this.PubNub=PubNub),typeof this.PubNub>"u"||null===this.PubNub)throw new Error("PubNub is not in global scope. Ensure that pubnub.js v4 library is included before the angular adapter")}return se(D,[{key:"init",value:function(M){this.pubnubInstance=new this.PubNub(M),this.mockingInstance.initializeListener(this),this.autoload.initialize(this)}},{key:"getLabel",value:function(){return this.label}},{key:"subscribe",value:function(M){this.getOriginalInstance().subscribe(M),this.mockingInstance.enableEventsBroadcast(M),this.autoload.enableLoad(M)}},{key:"unsubscribe",value:function(M){this.autoload.disableLoad(M),this.outputOn.unsubscribe(M),this.getOriginalInstance().unsubscribe(M);var L=this,B=setTimeout(function(){L.mockingInstance.disableEventsBroadcast(M),clearTimeout(B)},1e3)}},{key:"getMessage",value:function(M){var L=this,B=void 0,ie=100;return 1==(arguments.length<=1?0:arguments.length-1)&&"function"==typeof(arguments.length<=1?void 0:arguments[1])?B=arguments.length<=1?void 0:arguments[1]:1==(arguments.length<=1?0:arguments.length-1)&&"number"==typeof(arguments.length<=1?void 0:arguments[1])?ie=arguments.length<=1?void 0:arguments[1]:2==(arguments.length<=1?0:arguments.length-1)&&(B=arguments.length<=1?void 0:arguments[1],ie=arguments.length<=2?void 0:arguments[2]),this.outputOn.subscribe(M,ie)&&this.autoload.getHistory(M,B),this.broadcastOn.message(M,function(ge){L.outputOn.push(M,ge),B&&B(ge)}),this.outputOn.get(M)}},{key:"getPresence",value:function(M,L){this.broadcastOn&&this.broadcastOn.presence(M,L)}},{key:"getStatus",value:function(M,L){this.broadcastOn&&this.broadcastOn.status(M,L)}},{key:"getError",value:function(M){this.broadcastOn&&this.broadcastOn.error(M)}},{key:"clean",value:function(M){this.outputOn.clean(M)}},{key:"release",value:function(M){this.broadcastOn.unsubscribe(M),this.outputOn.unsubscribe(M)}},{key:"getOriginalInstance",value:function(){if(this.pubnubInstance)return this.pubnubInstance;throw new ReferenceError("Pubnub default instance is not initialized yet. Invoke #init() method first.")}},{key:"wrapAttribute",value:function(M){Object.defineProperty(this,M,{get:function(){return this.getOriginalInstance()[M]}})}},{key:"wrapMethod",value:function(M){this[M]=function(){return this.getOriginalInstance()[M].apply(this,arguments)}}}]),D}()},44048:function(xe,ye,te){xe.exports=function(){"use strict";var se=function(e,t){return(se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])})(e,t)};function W(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}se(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var Q=function(){return Q=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Q.apply(this,arguments)};function le(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]])}return t}function Y(n,e,t,r){return new(t||(t=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(c){o(c)}}function s(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(p){p(c)})).then(a,s)}l((r=r.apply(n,e||[])).next())})}function q(n,e){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(6===c[0]&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(n,a)}catch(p){c=[6,p],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function re(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function D(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var r,i,o=t.call(n),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a}function w(n,e,t){if(t||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))}var M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof te.g<"u"?te.g:typeof self<"u"?self:{};var n,e,t,r,i,o,a,B={exports:{}};n=B,e=M,r=Math.pow(2,-24),i=Math.pow(2,32),o=Math.pow(2,53),a={encode:function(l){var u,c=new ArrayBuffer(256),p=new DataView(c),h=0;function b(H){for(var P=c.byteLength,A=h+H;P<A;)P*=2;if(P!==c.byteLength){var k=p;c=new ArrayBuffer(P),p=new DataView(c);for(var O=h+3>>2,V=0;V<O;++V)p.setUint32(4*V,k.getUint32(4*V))}return u=H,p}function y(){h+=u}function f(H){y(b(1).setUint8(h,H))}function v(H){for(var P=b(H.length),A=0;A<H.length;++A)P.setUint8(h+A,H[A]);y()}function d(H,P){var A;P<24?f(H<<5|P):P<256?(f(H<<5|24),f(P)):P<65536?(f(H<<5|25),A=P,y(b(2).setUint16(h,A))):P<4294967296?(f(H<<5|26),function(A){y(b(4).setUint32(h,A))}(P)):(f(H<<5|27),function(A){var k=A%i,O=(A-k)/i,V=b(8);V.setUint32(h,O),V.setUint32(h+4,k),y()}(P))}if(function H(P){var A,C;if(!1===P)return f(244);if(!0===P)return f(245);if(null===P)return f(246);if(P===t)return f(247);switch(typeof P){case"number":if(Math.floor(P)===P){if(0<=P&&P<=o)return d(0,P);if(-o<=P&&P<0)return d(1,-(P+1))}return f(251),C=P,void y(b(8).setFloat64(h,C));case"string":var k=[];for(A=0;A<P.length;++A){var O=P.charCodeAt(A);O<128?k.push(O):O<2048?(k.push(192|O>>6),k.push(128|63&O)):O<55296?(k.push(224|O>>12),k.push(128|O>>6&63),k.push(128|63&O)):(O=(1023&O)<<10,O|=1023&P.charCodeAt(++A),k.push(240|(O+=65536)>>18),k.push(128|O>>12&63),k.push(128|O>>6&63),k.push(128|63&O))}return d(3,k.length),v(k);default:var V;if(Array.isArray(P))for(d(4,V=P.length),A=0;A<V;++A)H(P[A]);else if(P instanceof Uint8Array)d(2,P.length),v(P);else{var T=Object.keys(P);for(d(5,V=T.length),A=0;A<V;++A){var m=T[A];H(m),H(P[m])}}}}(l),"slice"in c)return c.slice(0,h);for(var E=new ArrayBuffer(h),j=new DataView(E),F=0;F<h;++F)j.setUint8(F,p.getUint8(F));return E},decode:function(l,u,c){var p=new DataView(l),h=0;function b(A,k){return h+=k,A}function y(A){return b(new Uint8Array(l,h,A),A)}function f(){return b(p.getUint8(h),1)}function v(){return b(p.getUint16(h),2)}function d(){return b(p.getUint32(h),4)}function E(){return 255===p.getUint8(h)&&(h+=1,!0)}function j(A){if(A<24)return A;if(24===A)return f();if(25===A)return v();if(26===A)return d();if(27===A)return d()*i+d();if(31===A)return-1;throw"Invalid length encoding"}function F(A){var k=f();if(255===k)return-1;var O=j(31&k);if(O<0||k>>5!==A)throw"Invalid indefinite length element";return O}function H(A,k){for(var O=0;O<k;++O){var V=f();128&V&&(V<224?(V=(31&V)<<6|63&f(),k-=1):V<240?(V=(15&V)<<12|(63&f())<<6|63&f(),k-=2):(V=(15&V)<<18|(63&f())<<12|(63&f())<<6|63&f(),k-=3)),V<65536?A.push(V):(A.push(55296|(V-=65536)>>10),A.push(56320|1023&V))}}"function"!=typeof u&&(u=function(k){return k}),"function"!=typeof c&&(c=function(){return t});var P=function A(){var k,O,V=f(),T=V>>5,m=31&V;if(7===T)switch(m){case 25:return function(){var ce=new ArrayBuffer(4),_e=new DataView(ce),nt=v(),Fe=31744&nt,Xe=1023&nt;if(31744===Fe)Fe=261120;else if(0!==Fe)Fe+=114688;else if(0!==Xe)return Xe*r;return _e.setUint32(0,(32768&nt)<<16|Fe<<13|Xe<<13),_e.getFloat32(0)}();case 26:return b(p.getFloat32(h),4);case 27:return b(p.getFloat64(h),8)}if((O=j(m))<0&&(T<2||6<T))throw"Invalid length";switch(T){case 0:return O;case 1:return-1-O;case 2:if(O<0){for(var C=[],X=0;(O=F(T))>=0;)X+=O,C.push(y(O));var N=new Uint8Array(X),G=0;for(k=0;k<C.length;++k)N.set(C[k],G),G+=C[k].length;return N}return y(O);case 3:var K=[];if(O<0)for(;(O=F(T))>=0;)H(K,O);else H(K,O);return String.fromCharCode.apply(null,K);case 4:var z;if(O<0)for(z=[];!E();)z.push(A());else for(z=new Array(O),k=0;k<O;++k)z[k]=A();return z;case 5:var ue={};for(k=0;k<O||O<0&&!E();++k)ue[A()]=A();return ue;case 6:return u(A(),O);case 7:switch(O){case 20:return!1;case 21:return!0;case 22:return null;case 23:return t;default:return c(O)}}}();if(h!==l.byteLength)throw"Remaining bytes";return P}},n.exports?n.exports=a:e.CBOR||(e.CBOR=a);var ie=B.exports,ge={exports:{}};!function(n,e){(function(t){var i={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function o(){var s,l,u="";for(s=0;s<32;s++)l=16*Math.random()|0,8!==s&&12!==s&&16!==s&&20!==s||(u+="-"),u+=(12===s?4:16===s?3&l|8:l).toString(16);return u}function a(s,l){var u=i[l||"all"];return u&&u.test(s)||!1}o.isUUID=a,o.VERSION="0.1.0",t.uuid=o,t.isUUID=a})(e),null!==n&&(n.exports=e.uuid)}(ge,ge.exports);var Ee=ge.exports,rt=function(){return Ee.uuid?Ee.uuid():Ee()},ze=function(){function n(e){var t,r,i,o,a=e.setup;if(this._PNSDKSuffix={},this.instanceId="pn-".concat(rt()),this.secretKey=a.secretKey||a.secret_key,this.subscribeKey=a.subscribeKey||a.subscribe_key,this.publishKey=a.publishKey||a.publish_key,this.sdkName=a.sdkName,this.sdkFamily=a.sdkFamily,this.partnerId=a.partnerId,this.setAuthKey(a.authKey),this.cryptoModule=a.cryptoModule,this.setFilterExpression(a.filterExpression),"string"!=typeof a.origin&&!Array.isArray(a.origin)&&void 0!==a.origin)throw new Error("Origin must be either undefined, a string or a list of strings.");if(this.origin=a.origin||Array.from({length:20},function(s,l){return"ps".concat(l+1,".pndsn.com")}),this.secure=a.ssl||!1,this.restore=a.restore||!1,this.proxy=a.proxy,this.keepAlive=a.keepAlive,this.keepAliveSettings=a.keepAliveSettings,this.autoNetworkDetection=a.autoNetworkDetection||!1,this.dedupeOnSubscribe=a.dedupeOnSubscribe||!1,this.maximumCacheSize=a.maximumCacheSize||100,this.customEncrypt=a.customEncrypt,this.customDecrypt=a.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=a.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(r=a.useRandomIVs)||void 0===r||r,this.enableEventEngine=null!==(i=a.enableEventEngine)&&void 0!==i&&i,this.maintainPresenceState=null===(o=a.maintainPresenceState)||void 0===o||o,typeof location<"u"&&"https:"===location.protocol&&(this.secure=!0),this.logVerbosity=a.logVerbosity||!1,this.suppressLeaveEvents=a.suppressLeaveEvents||!1,this.announceFailedHeartbeats=a.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=a.announceSuccessfulHeartbeats||!1,this.useInstanceId=a.useInstanceId||!1,this.useRequestId=a.useRequestId||!1,this.requestMessageCountThreshold=a.requestMessageCountThreshold,a.retryConfiguration&&this._setRetryConfiguration(a.retryConfiguration),this.setTransactionTimeout(a.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(a.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(a.useSendBeacon||!0),a.presenceTimeout?this.setPresenceTimeout(a.presenceTimeout):this._presenceTimeout=300,null!=a.heartbeatInterval&&this.setHeartbeatInterval(a.heartbeatInterval),"string"==typeof a.userId){if("string"==typeof a.uuid)throw new Error("Only one of the following configuration options has to be provided: `uuid` or `userId`");this.setUserId(a.userId)}else{if("string"!=typeof a.uuid)throw new Error("One of the following configuration options has to be provided: `uuid` or `userId`");this.setUUID(a.uuid)}this.setCipherKey(a.cipherKey,a)}return n.prototype.getAuthKey=function(){return this.authKey},n.prototype.setAuthKey=function(e){return this.authKey=e,this},n.prototype.setCipherKey=function(e,t,r){var i;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(i=t.cryptoModule)&&void 0!==i?i:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),r&&(r.cryptoModule=this.cryptoModule)),this},n.prototype.getUUID=function(){return this.UUID},n.prototype.setUUID=function(e){if(!e||"string"!=typeof e||0===e.trim().length)throw new Error("Missing uuid parameter. Provide a valid string uuid");return this.UUID=e,this},n.prototype.getUserId=function(){return this.UUID},n.prototype.setUserId=function(e){if(!e||"string"!=typeof e||0===e.trim().length)throw new Error("Missing or invalid userId parameter. Provide a valid string userId");return this.UUID=e,this},n.prototype.getFilterExpression=function(){return this.filterExpression},n.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},n.prototype.getPresenceTimeout=function(){return this._presenceTimeout},n.prototype.setPresenceTimeout=function(e){return this._presenceTimeout=e>=20?e:20,this.setHeartbeatInterval(this._presenceTimeout/2-1),this},n.prototype.setProxy=function(e){this.proxy=e},n.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},n.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},n.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},n.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},n.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},n.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},n.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},n.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},n.prototype.getVersion=function(){return"7.6.2"},n.prototype._setRetryConfiguration=function(e){if(e.minimumdelay<2)throw new Error("Minimum delay can not be set less than 2 seconds for retry");if(e.maximumDelay>150)throw new Error("Maximum delay can not be set more than 150 seconds for retry");if(e.maximumDelay&&maximumRetry>6)throw new Error("Maximum retry for exponential retry policy can not be more than 6");if(e.maximumRetry>10)throw new Error("Maximum retry for linear retry policy can not be more than 10");this.retryConfiguration=e},n.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},n.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce(function(r,i){return r+e+t._PNSDKSuffix[i]},"")},n}();function ft(n){var e=n.replace(/==?$/,""),t=Math.floor(e.length/4*3),r=new ArrayBuffer(t),i=new Uint8Array(r),o=0;function a(){var f=e.charAt(o++),v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f);if(-1===v)throw new Error("Illegal character at ".concat(o,": ").concat(e.charAt(o-1)));return v}for(var s=0;s<t;s+=3){var l=a(),u=a(),c=a(),p=a(),b=(15&u)<<4|c>>2,y=(3&c)<<6|p;i[s]=(63&l)<<2|u>>4,64!=c&&(i[s+1]=b),64!=p&&(i[s+2]=y)}return r}function Ot(n){for(var e,t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(n),o=i.byteLength,a=o%3,s=o-a,l=0;l<s;l+=3)t+=r[(16515072&(e=i[l]<<16|i[l+1]<<8|i[l+2]))>>18]+r[(258048&e)>>12]+r[(4032&e)>>6]+r[63&e];return 1==a?t+=r[(252&(e=i[s]))>>2]+r[(3&e)<<4]+"==":2==a&&(t+=r[(64512&(e=i[s]<<8|i[s+1]))>>10]+r[(1008&e)>>4]+r[(15&e)<<2]+"="),t}var Et,sn,Kt,un,it,Ne=Ne||function(n,e){var t={},r=t.lib={},i=function(){},o=r.Base={extend:function(y){i.prototype=this;var f=new i;return y&&f.mixIn(y),f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var y=this.extend();return y.init.apply(y,arguments),y},init:function(){},mixIn:function(y){for(var f in y)y.hasOwnProperty(f)&&(this[f]=y[f]);y.hasOwnProperty("toString")&&(this.toString=y.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=o.extend({init:function(y,f){y=this.words=y||[],this.sigBytes=f??4*y.length},toString:function(y){return(y||l).stringify(this)},concat:function(y){var f=this.words,v=y.words,d=this.sigBytes;if(y=y.sigBytes,this.clamp(),d%4)for(var E=0;E<y;E++)f[d+E>>>2]|=(v[E>>>2]>>>24-E%4*8&255)<<24-(d+E)%4*8;else if(65535<v.length)for(E=0;E<y;E+=4)f[d+E>>>2]=v[E>>>2];else f.push.apply(f,v);return this.sigBytes+=y,this},clamp:function(){var y=this.words,f=this.sigBytes;y[f>>>2]&=4294967295<<32-f%4*8,y.length=n.ceil(f/4)},clone:function(){var y=o.clone.call(this);return y.words=this.words.slice(0),y},random:function(y){for(var f=[],v=0;v<y;v+=4)f.push(4294967296*n.random()|0);return new a.init(f,y)}}),s=t.enc={},l=s.Hex={stringify:function(y){var f=y.words;y=y.sigBytes;for(var v=[],d=0;d<y;d++){var E=f[d>>>2]>>>24-d%4*8&255;v.push((E>>>4).toString(16)),v.push((15&E).toString(16))}return v.join("")},parse:function(y){for(var f=y.length,v=[],d=0;d<f;d+=2)v[d>>>3]|=parseInt(y.substr(d,2),16)<<24-d%8*4;return new a.init(v,f/2)}},u=s.Latin1={stringify:function(y){var f=y.words;y=y.sigBytes;for(var v=[],d=0;d<y;d++)v.push(String.fromCharCode(f[d>>>2]>>>24-d%4*8&255));return v.join("")},parse:function(y){for(var f=y.length,v=[],d=0;d<f;d++)v[d>>>2]|=(255&y.charCodeAt(d))<<24-d%4*8;return new a.init(v,f)}},c=s.Utf8={stringify:function(y){try{return decodeURIComponent(escape(u.stringify(y)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(y){return u.parse(unescape(encodeURIComponent(y)))}},p=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(y){"string"==typeof y&&(y=c.parse(y)),this._data.concat(y),this._nDataBytes+=y.sigBytes},_process:function(y){var f=this._data,v=f.words,d=f.sigBytes,E=this.blockSize,j=d/(4*E);if(y=(j=y?n.ceil(j):n.max((0|j)-this._minBufferSize,0))*E,d=n.min(4*y,d),y){for(var F=0;F<y;F+=E)this._doProcessBlock(v,F);F=v.splice(0,y),f.sigBytes-=d}return new a.init(F,d)},clone:function(){var y=o.clone.call(this);return y._data=this._data.clone(),y},_minBufferSize:0});r.Hasher=p.extend({cfg:o.extend(),init:function(y){this.cfg=this.cfg.extend(y),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(y){return this._append(y),this._process(),this},finalize:function(y){return y&&this._append(y),this._doFinalize()},blockSize:16,_createHelper:function(y){return function(f,v){return new y.init(v).finalize(f)}},_createHmacHelper:function(y){return function(f,v){return new h.HMAC.init(y,v).finalize(f)}}});var h=t.algo={};return t}(Math);(function(n){for(var e=Ne,t=(i=e.lib).WordArray,r=i.Hasher,i=e.algo,o=[],a=[],s=function(f){return 4294967296*(f-(0|f))|0},l=2,u=0;64>u;){var c;e:{for(var p=n.sqrt(c=l),h=2;h<=p;h++)if(!(c%h)){c=!1;break e}c=!0}c&&(8>u&&(o[u]=s(n.pow(l,.5))),a[u]=s(n.pow(l,1/3)),u++),l++}var b=[];i=i.SHA256=r.extend({_doReset:function(){this._hash=new t.init(o.slice(0))},_doProcessBlock:function(f,v){for(var d=this._hash.words,E=d[0],j=d[1],F=d[2],H=d[3],P=d[4],A=d[5],k=d[6],O=d[7],V=0;64>V;V++){if(16>V)b[V]=0|f[v+V];else{var T=b[V-15],m=b[V-2];b[V]=((T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3)+b[V-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+b[V-16]}T=O+((P<<26|P>>>6)^(P<<21|P>>>11)^(P<<7|P>>>25))+(P&A^~P&k)+a[V]+b[V],m=((E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22))+(E&j^E&F^j&F),O=k,k=A,A=P,P=H+T|0,H=F,F=j,j=E,E=T+m|0}d[0]=d[0]+E|0,d[1]=d[1]+j|0,d[2]=d[2]+F|0,d[3]=d[3]+H|0,d[4]=d[4]+P|0,d[5]=d[5]+A|0,d[6]=d[6]+k|0,d[7]=d[7]+O|0},_doFinalize:function(){var f=this._data,v=f.words,d=8*this._nDataBytes,E=8*f.sigBytes;return v[E>>>5]|=128<<24-E%32,v[14+(E+64>>>9<<4)]=n.floor(d/4294967296),v[15+(E+64>>>9<<4)]=d,f.sigBytes=4*v.length,this._process(),this._hash},clone:function(){var f=r.clone.call(this);return f._hash=this._hash.clone(),f}}),e.SHA256=r._createHelper(i),e.HmacSHA256=r._createHmacHelper(i)})(Math),sn=(Et=Ne).enc.Utf8,Et.algo.HMAC=Et.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=sn.parse(t));var r=e.blockSize,i=4*r;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),a=this._iKey=t.clone(),s=o.words,l=a.words,u=0;u<r;u++)s[u]^=1549556828,l[u]^=909522486;o.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),un=(Kt=Ne).lib.WordArray,Kt.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,i=this._map;e.clamp(),e=[];for(var o=0;o<r;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;4>s&&o+.75*s<r;s++)e.push(i.charAt(a>>>6*(3-s)&63));if(t=i.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map;(i=r.charAt(64))&&-1!=(i=e.indexOf(i))&&(t=i);for(var i=[],o=0,a=0;a<t;a++)if(a%4){var s=r.indexOf(e.charAt(a-1))<<a%4*2,l=r.indexOf(e.charAt(a))>>>6-a%4*2;i[o>>>2]|=(s|l)<<24-o%4*8,o++}return un.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(n){function e(p,h,b,y,f,v,d){return((p=p+(h&b|~h&y)+f+d)<<v|p>>>32-v)+h}function t(p,h,b,y,f,v,d){return((p=p+(h&y|b&~y)+f+d)<<v|p>>>32-v)+h}function r(p,h,b,y,f,v,d){return((p=p+(h^b^y)+f+d)<<v|p>>>32-v)+h}function i(p,h,b,y,f,v,d){return((p=p+(b^(h|~y))+f+d)<<v|p>>>32-v)+h}for(var o=Ne,a=(l=o.lib).WordArray,s=l.Hasher,l=o.algo,u=[],c=0;64>c;c++)u[c]=4294967296*n.abs(n.sin(c+1))|0;l=l.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(h,b){for(var y=0;16>y;y++){var f=h[v=b+y];h[v]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}var v=h[b+0],d=(f=h[b+1],h[b+2]),E=h[b+3],j=h[b+4],F=h[b+5],H=h[b+6],P=h[b+7],A=h[b+8],k=h[b+9],O=h[b+10],V=h[b+11],T=h[b+12],m=h[b+13],C=h[b+14],X=h[b+15],N=e(N=(y=this._hash.words)[0],z=y[1],K=y[2],G=y[3],v,7,u[0]),G=e(G,N,z,K,f,12,u[1]),K=e(K,G,N,z,d,17,u[2]),z=e(z,K,G,N,E,22,u[3]);N=e(N,z,K,G,j,7,u[4]),G=e(G,N,z,K,F,12,u[5]),K=e(K,G,N,z,H,17,u[6]),z=e(z,K,G,N,P,22,u[7]),N=e(N,z,K,G,A,7,u[8]),G=e(G,N,z,K,k,12,u[9]),K=e(K,G,N,z,O,17,u[10]),z=e(z,K,G,N,V,22,u[11]),N=e(N,z,K,G,T,7,u[12]),G=e(G,N,z,K,m,12,u[13]),K=e(K,G,N,z,C,17,u[14]),N=t(N,z=e(z,K,G,N,X,22,u[15]),K,G,f,5,u[16]),G=t(G,N,z,K,H,9,u[17]),K=t(K,G,N,z,V,14,u[18]),z=t(z,K,G,N,v,20,u[19]),N=t(N,z,K,G,F,5,u[20]),G=t(G,N,z,K,O,9,u[21]),K=t(K,G,N,z,X,14,u[22]),z=t(z,K,G,N,j,20,u[23]),N=t(N,z,K,G,k,5,u[24]),G=t(G,N,z,K,C,9,u[25]),K=t(K,G,N,z,E,14,u[26]),z=t(z,K,G,N,A,20,u[27]),N=t(N,z,K,G,m,5,u[28]),G=t(G,N,z,K,d,9,u[29]),K=t(K,G,N,z,P,14,u[30]),N=r(N,z=t(z,K,G,N,T,20,u[31]),K,G,F,4,u[32]),G=r(G,N,z,K,A,11,u[33]),K=r(K,G,N,z,V,16,u[34]),z=r(z,K,G,N,C,23,u[35]),N=r(N,z,K,G,f,4,u[36]),G=r(G,N,z,K,j,11,u[37]),K=r(K,G,N,z,P,16,u[38]),z=r(z,K,G,N,O,23,u[39]),N=r(N,z,K,G,m,4,u[40]),G=r(G,N,z,K,v,11,u[41]),K=r(K,G,N,z,E,16,u[42]),z=r(z,K,G,N,H,23,u[43]),N=r(N,z,K,G,k,4,u[44]),G=r(G,N,z,K,T,11,u[45]),K=r(K,G,N,z,X,16,u[46]),N=i(N,z=r(z,K,G,N,d,23,u[47]),K,G,v,6,u[48]),G=i(G,N,z,K,P,10,u[49]),K=i(K,G,N,z,C,15,u[50]),z=i(z,K,G,N,F,21,u[51]),N=i(N,z,K,G,T,6,u[52]),G=i(G,N,z,K,E,10,u[53]),K=i(K,G,N,z,O,15,u[54]),z=i(z,K,G,N,f,21,u[55]),N=i(N,z,K,G,A,6,u[56]),G=i(G,N,z,K,X,10,u[57]),K=i(K,G,N,z,H,15,u[58]),z=i(z,K,G,N,m,21,u[59]),N=i(N,z,K,G,j,6,u[60]),G=i(G,N,z,K,V,10,u[61]),K=i(K,G,N,z,d,15,u[62]),z=i(z,K,G,N,k,21,u[63]),y[0]=y[0]+N|0,y[1]=y[1]+z|0,y[2]=y[2]+K|0,y[3]=y[3]+G|0},_doFinalize:function(){var h=this._data,b=h.words,y=8*this._nDataBytes,f=8*h.sigBytes;b[f>>>5]|=128<<24-f%32;var v=n.floor(y/4294967296);for(b[15+(f+64>>>9<<4)]=16711935&(v<<8|v>>>24)|4278255360&(v<<24|v>>>8),b[14+(f+64>>>9<<4)]=16711935&(y<<8|y>>>24)|4278255360&(y<<24|y>>>8),h.sigBytes=4*(b.length+1),this._process(),b=(h=this._hash).words,y=0;4>y;y++)b[y]=16711935&((f=b[y])<<8|f>>>24)|4278255360&(f<<24|f>>>8);return h},clone:function(){var h=s.clone.call(this);return h._hash=this._hash.clone(),h}}),o.MD5=s._createHelper(l),o.HmacMD5=s._createHmacHelper(l)}(Math),function(){var n,e=Ne,t=(n=e.lib).Base,r=n.WordArray,i=(n=e.algo).EvpKDF=t.extend({cfg:t.extend({keySize:4,hasher:n.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,s){for(var l=(h=this.cfg).hasher.create(),u=r.create(),c=u.words,p=h.keySize,h=h.iterations;c.length<p;){b&&l.update(b);var b=l.update(a).finalize(s);l.reset();for(var y=1;y<h;y++)b=l.finalize(b),l.reset();u.concat(b)}return u.sigBytes=4*p,u}});e.EvpKDF=function(o,a,s){return i.create(s).compute(o,a)}}(),Ne.lib.Cipher||function(n){var e=(b=Ne).lib,t=e.Base,r=e.WordArray,i=e.BufferedBlockAlgorithm,o=b.enc.Base64,a=b.algo.EvpKDF,s=e.Cipher=i.extend({cfg:t.extend(),createEncryptor:function(v,d){return this.create(this._ENC_XFORM_MODE,v,d)},createDecryptor:function(v,d){return this.create(this._DEC_XFORM_MODE,v,d)},init:function(v,d,E){this.cfg=this.cfg.extend(E),this._xformMode=v,this._key=d,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(v){return this._append(v),this._process()},finalize:function(v){return v&&this._append(v),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(v){return{encrypt:function(E,j,F){return("string"==typeof j?y:h).encrypt(v,E,j,F)},decrypt:function(E,j,F){return("string"==typeof j?y:h).decrypt(v,E,j,F)}}}});e.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=b.mode={},u=function(v,d,E){var j=this._iv;j?this._iv=void 0:j=this._prevBlock;for(var F=0;F<E;F++)v[d+F]^=j[F]},c=(e.BlockCipherMode=t.extend({createEncryptor:function(v,d){return this.Encryptor.create(v,d)},createDecryptor:function(v,d){return this.Decryptor.create(v,d)},init:function(v,d){this._cipher=v,this._iv=d}})).extend();c.Encryptor=c.extend({processBlock:function(v,d){var E=this._cipher,j=E.blockSize;u.call(this,v,d,j),E.encryptBlock(v,d),this._prevBlock=v.slice(d,d+j)}}),c.Decryptor=c.extend({processBlock:function(v,d){var E=this._cipher,j=E.blockSize,F=v.slice(d,d+j);E.decryptBlock(v,d),u.call(this,v,d,j),this._prevBlock=F}}),l=l.CBC=c,c=(b.pad={}).Pkcs7={pad:function(v,d){for(var E,j=(E=(E=4*d)-v.sigBytes%E)<<24|E<<16|E<<8|E,F=[],H=0;H<E;H+=4)F.push(j);E=r.create(F,E),v.concat(E)},unpad:function(v){v.sigBytes-=255&v.words[v.sigBytes-1>>>2]}},e.BlockCipher=s.extend({cfg:s.cfg.extend({mode:l,padding:c}),reset:function(){s.reset.call(this);var v=(d=this.cfg).iv,d=d.mode;if(this._xformMode==this._ENC_XFORM_MODE)var E=d.createEncryptor;else E=d.createDecryptor,this._minBufferSize=1;this._mode=E.call(d,this,v&&v.words)},_doProcessBlock:function(v,d){this._mode.processBlock(v,d)},_doFinalize:function(){var v=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){v.pad(this._data,this.blockSize);var d=this._process(!0)}else d=this._process(!0),v.unpad(d);return d},blockSize:4});var p=e.CipherParams=t.extend({init:function(v){this.mixIn(v)},toString:function(v){return(v||this.formatter).stringify(this)}}),h=(l=(b.format={}).OpenSSL={stringify:function(v){var d=v.ciphertext;return((v=v.salt)?r.create([1398893684,1701076831]).concat(v).concat(d):d).toString(o)},parse:function(v){var d=(v=o.parse(v)).words;if(1398893684==d[0]&&1701076831==d[1]){var E=r.create(d.slice(2,4));d.splice(0,4),v.sigBytes-=16}return p.create({ciphertext:v,salt:E})}},e.SerializableCipher=t.extend({cfg:t.extend({format:l}),encrypt:function(v,d,E,j){j=this.cfg.extend(j);var F=v.createEncryptor(E,j);return d=F.finalize(d),p.create({ciphertext:d,key:E,iv:(F=F.cfg).iv,algorithm:v,mode:F.mode,padding:F.padding,blockSize:v.blockSize,formatter:j.format})},decrypt:function(v,d,E,j){return j=this.cfg.extend(j),d=this._parse(d,j.format),v.createDecryptor(E,j).finalize(d.ciphertext)},_parse:function(v,d){return"string"==typeof v?d.parse(v,this):v}})),b=(b.kdf={}).OpenSSL={execute:function(v,d,E,j){return j||(j=r.random(8)),v=a.create({keySize:d+E}).compute(v,j),E=r.create(v.words.slice(d),4*E),v.sigBytes=4*d,p.create({key:v,iv:E,salt:j})}},y=e.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:b}),encrypt:function(v,d,E,j){return E=(j=this.cfg.extend(j)).kdf.execute(E,v.keySize,v.ivSize),j.iv=E.iv,(v=h.encrypt.call(this,v,d,E.key,j)).mixIn(E),v},decrypt:function(v,d,E,j){return j=this.cfg.extend(j),d=this._parse(d,j.format),E=j.kdf.execute(E,v.keySize,v.ivSize,d.salt),j.iv=E.iv,h.decrypt.call(this,v,d,E.key,j)}})}(),function(){for(var n=Ne,e=n.lib.BlockCipher,t=n.algo,r=[],i=[],o=[],a=[],s=[],l=[],u=[],c=[],p=[],h=[],b=[],y=0;256>y;y++)b[y]=128>y?y<<1:y<<1^283;var f=0,v=0;for(y=0;256>y;y++){var d=(d=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&d^99;r[f]=d,i[d]=f;var E=b[f],j=b[E],F=b[j],H=257*b[d]^16843008*d;o[f]=H<<24|H>>>8,a[f]=H<<16|H>>>16,s[f]=H<<8|H>>>24,l[f]=H,u[d]=(H=16843009*F^65537*j^257*E^16843008*f)<<24|H>>>8,c[d]=H<<16|H>>>16,p[d]=H<<8|H>>>24,h[d]=H,f?(f=E^b[b[b[F^E]]],v^=b[b[v]]):f=v=1}var P=[0,1,2,4,8,16,32,64,128,27,54];t=t.AES=e.extend({_doReset:function(){for(var k=(V=this._key).words,O=V.sigBytes/4,V=4*((this._nRounds=O+6)+1),T=this._keySchedule=[],m=0;m<V;m++)if(m<O)T[m]=k[m];else{var C=T[m-1];m%O?6<O&&m%O==4&&(C=r[C>>>24]<<24|r[C>>>16&255]<<16|r[C>>>8&255]<<8|r[255&C]):(C=r[(C=C<<8|C>>>24)>>>24]<<24|r[C>>>16&255]<<16|r[C>>>8&255]<<8|r[255&C],C^=P[m/O|0]<<24),T[m]=T[m-O]^C}for(k=this._invKeySchedule=[],O=0;O<V;O++)m=V-O,C=O%4?T[m]:T[m-4],k[O]=4>O||4>=m?C:u[r[C>>>24]]^c[r[C>>>16&255]]^p[r[C>>>8&255]]^h[r[255&C]]},encryptBlock:function(k,O){this._doCryptBlock(k,O,this._keySchedule,o,a,s,l,r)},decryptBlock:function(k,O){var V=k[O+1];k[O+1]=k[O+3],k[O+3]=V,this._doCryptBlock(k,O,this._invKeySchedule,u,c,p,h,i),V=k[O+1],k[O+1]=k[O+3],k[O+3]=V},_doCryptBlock:function(k,O,V,T,m,C,X,N){for(var G=this._nRounds,K=k[O]^V[0],z=k[O+1]^V[1],ue=k[O+2]^V[2],ce=k[O+3]^V[3],_e=4,nt=1;nt<G;nt++){var ht=T[K>>>24]^m[z>>>16&255]^C[ue>>>8&255]^X[255&ce]^V[_e++],Fe=T[z>>>24]^m[ue>>>16&255]^C[ce>>>8&255]^X[255&K]^V[_e++],Xe=T[ue>>>24]^m[ce>>>16&255]^C[K>>>8&255]^X[255&z]^V[_e++];ce=T[ce>>>24]^m[K>>>16&255]^C[z>>>8&255]^X[255&ue]^V[_e++],K=ht,z=Fe,ue=Xe}ht=(N[K>>>24]<<24|N[z>>>16&255]<<16|N[ue>>>8&255]<<8|N[255&ce])^V[_e++],Fe=(N[z>>>24]<<24|N[ue>>>16&255]<<16|N[ce>>>8&255]<<8|N[255&K])^V[_e++],Xe=(N[ue>>>24]<<24|N[ce>>>16&255]<<16|N[K>>>8&255]<<8|N[255&z])^V[_e++],ce=(N[ce>>>24]<<24|N[K>>>16&255]<<16|N[z>>>8&255]<<8|N[255&ue])^V[_e++],k[O]=ht,k[O+1]=Fe,k[O+2]=Xe,k[O+3]=ce},keySize:8}),n.AES=e._createHelper(t)}(),Ne.mode.ECB=((it=Ne.lib.BlockCipherMode.extend()).Encryptor=it.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),it.Decryptor=it.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),it);var me=Ne;function Tt(n){var e,t=[];for(e=0;e<n.length;e+=1)t[e/4|0]|=n[e]<<24-8*e;return me.lib.WordArray.create(t,n.length)}var dt=function(){function n(e){this._config=e.config,this._iv="0123456789012345",this._allowedKeyEncodings=["hex","utf8","base64","binary"],this._allowedKeyLengths=[128,256],this._allowedModes=["ecb","cbc"],this._defaultOptions={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}return n.prototype.HMACSHA256=function(e){return me.HmacSHA256(e,this._config.secretKey).toString(me.enc.Base64)},n.prototype.SHA256=function(e){return me.SHA256(e).toString(me.enc.Hex)},n.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty("encryptKey")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty("keyEncoding")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty("keyLength")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty("mode")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},n.prototype._decodeKey=function(e,t){return"base64"===t.keyEncoding?me.enc.Base64.parse(e):"hex"===t.keyEncoding?me.enc.Hex.parse(e):e},n.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?me.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},n.prototype._getMode=function(e){return"ecb"===e.mode?me.mode.ECB:me.mode.CBC},n.prototype._getIV=function(e){return"cbc"===e.mode?me.enc.Utf8.parse(this._iv):null},n.prototype._getRandomIV=function(){return me.lib.WordArray.random(16)},n.prototype.encrypt=function(e,t,r){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,r)},n.prototype.decrypt=function(e,t,r){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,r)},n.prototype.pnEncrypt=function(e,t,r){if(!t&&!this._config.cipherKey)return e;r=this._parseOptions(r);var i=this._getMode(r),o=this._getPaddedKey(t||this._config.cipherKey,r);if(this._config.useRandomIVs){var a=this._getRandomIV(),s=me.AES.encrypt(e,o,{iv:a,mode:i}).ciphertext;return a.clone().concat(s.clone()).toString(me.enc.Base64)}var l=this._getIV(r);return me.AES.encrypt(e,o,{iv:l,mode:i}).ciphertext.toString(me.enc.Base64)||e},n.prototype.pnDecrypt=function(e,t,r){if(!t&&!this._config.cipherKey)return e;r=this._parseOptions(r);var i=this._getMode(r),o=this._getPaddedKey(t||this._config.cipherKey,r);if(this._config.useRandomIVs){var a=Tt((u=new Uint8ClampedArray(ft(e))).slice(0,16)),s=Tt(u.slice(16));try{var l=me.AES.decrypt({ciphertext:s},o,{iv:a,mode:i}).toString(me.enc.Utf8);return JSON.parse(l)}catch{return null}}else{a=this._getIV(r);try{var u=me.enc.Base64.parse(e);return l=me.AES.decrypt({ciphertext:u},o,{iv:a,mode:i}).toString(me.enc.Utf8),JSON.parse(l)}catch{return null}}},n}(),Gn=function(){function n(e){this._timeEndpoint=e.timeEndpoint}return n.prototype.onReconnection=function(e){this._reconnectionCallback=e},n.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},n.prototype.stopPolling=function(){clearInterval(this._timeTimer)},n.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint(function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())})},n}(),Kn=function(){function n(e){var t=e.config;this.hashHistory=[],this._config=t}return n.prototype.getKey=function(e){var t=function(i){var o=0;if(0===i.length)return o;for(var a=0;a<i.length;a+=1)o=(o<<5)-o+i.charCodeAt(a),o&=o;return o}(JSON.stringify(e.payload)).toString();return"".concat(e.publishMetaData.publishTimetoken,"-").concat(t)},n.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},n.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},n.prototype.clearHistory=function(){this.hashHistory=[]},n}(),fe={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory",PNDisconnectedCategory:"PNDisconnectedCategory",PNConnectionErrorCategory:"PNConnectionErrorCategory",PNDisconnectedUnexpectedlyCategory:"PNDisconnectedUnexpectedlyCategory"},Bn=function(){function n(e){var t=e.subscribeEndpoint,r=e.leaveEndpoint,i=e.heartbeatEndpoint,o=e.setStateEndpoint,a=e.timeEndpoint,s=e.getFileUrl,l=e.config,u=e.crypto,p=e.cryptoModule,h=e.eventEmitter;this._listenerManager=e.listenerManager,this._config=l,this._leaveEndpoint=r,this._heartbeatEndpoint=i,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=s,this._crypto=u,this._cryptoModule=p,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new Gn({timeEndpoint:a}),this._dedupingManager=new Kn({config:l}),this._cryptoModule&&(this._decoder=new TextDecoder),this._eventEmitter=h}return n.prototype.adaptStateChange=function(e,t){var r=this,i=e.state,o=e.channels,a=void 0===o?[]:o,s=e.channelGroups,l=void 0===s?[]:s,u=e.withHeartbeat,c=void 0!==u&&u;if(a.forEach(function(h){h in r._channels&&(r._channels[h].state=i)}),l.forEach(function(h){h in r._channelGroups&&(r._channelGroups[h].state=i)}),c){var p={};return a.forEach(function(h){return p[h]=i}),l.forEach(function(h){return p[h]=i}),this._heartbeatEndpoint({channels:a,channelGroups:l,state:p},t)}return this._setStateEndpoint({state:i,channels:a,channelGroups:l},t)},n.prototype.adaptPresenceChange=function(e){var t=this,i=e.channels,o=void 0===i?[]:i,a=e.channelGroups,s=void 0===a?[]:a;e.connected?(o.forEach(function(l){t._heartbeatChannels[l]={state:{}}}),s.forEach(function(l){t._heartbeatChannelGroups[l]={state:{}}})):(o.forEach(function(l){l in t._heartbeatChannels&&delete t._heartbeatChannels[l]}),s.forEach(function(l){l in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[l]}),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:s},function(l){t._listenerManager.announceStatus(l)})),this.reconnect()},n.prototype.adaptSubscribeChange=function(e){var t=this,r=e.timetoken,i=e.channels,o=void 0===i?[]:i,a=e.channelGroups,s=void 0===a?[]:a,l=e.withPresence,u=void 0!==l&&l,c=e.withHeartbeats,p=void 0!==c&&c;this._config.subscribeKey&&""!==this._config.subscribeKey?(r&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=r),"0"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach(function(h){t._channels[h]={state:{}},u&&(t._presenceChannels[h]={}),(p||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[h]={}),t._pendingChannelSubscriptions.push(h)}),s.forEach(function(h){t._channelGroups[h]={state:{}},u&&(t._presenceChannelGroups[h]={}),(p||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[h]={}),t._pendingChannelGroupSubscriptions.push(h)}),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console},n.prototype.adaptUnsubscribeChange=function(e,t){var r=this,i=e.channels,a=e.channelGroups,s=void 0===a?[]:a,l=[],u=[];(void 0===i?[]:i).forEach(function(c){c in r._channels&&(delete r._channels[c],l.push(c),c in r._heartbeatChannels&&delete r._heartbeatChannels[c]),c in r._presenceChannels&&(delete r._presenceChannels[c],l.push(c))}),s.forEach(function(c){c in r._channelGroups&&(delete r._channelGroups[c],u.push(c),c in r._heartbeatChannelGroups&&delete r._heartbeatChannelGroups[c]),c in r._presenceChannelGroups&&(delete r._presenceChannelGroups[c],u.push(c))}),0===l.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:l,channelGroups:u},function(c){c.affectedChannels=l,c.affectedChannelGroups=u,c.currentTimetoken=r._currentTimetoken,c.lastTimetoken=r._lastTimetoken,r._listenerManager.announceStatus(c)}),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},n.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},n.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},n.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},n.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},n.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},n.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},n.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},n.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},n.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},n.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),r=this.getHeartbeatChannelGroups(),i={};(0!==t.length||0!==r.length)&&(this.getSubscribedChannels().forEach(function(o){var a=e._channels[o].state;Object.keys(a).length&&(i[o]=a)}),this.getSubscribedChannelGroups().forEach(function(o){var a=e._channelGroups[o].state;Object.keys(a).length&&(i[o]=a)}),this._heartbeatEndpoint({channels:t,channelGroups:r,state:i},function(o){o.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(o),o.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!o.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(o)}.bind(this)))},n.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},r=[],i=[];Object.keys(this._channels).forEach(function(a){var s=e._channels[a].state;Object.keys(s).length&&(t[a]=s),r.push(a)}),Object.keys(this._presenceChannels).forEach(function(a){r.push("".concat(a,"-pnpres"))}),Object.keys(this._channelGroups).forEach(function(a){var s=e._channelGroups[a].state;Object.keys(s).length&&(t[a]=s),i.push(a)}),Object.keys(this._presenceChannelGroups).forEach(function(a){i.push("".concat(a,"-pnpres"))}),(0!==r.length||0!==i.length)&&(this._subscribeCall=this._subscribeEndpoint({channels:r,channelGroups:i,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region},this._processSubscribeResponse.bind(this)))},n.prototype._processSubscribeResponse=function(e,t){var r=this;if(e.error){if(e.errorData&&"Aborted"===e.errorData.message)return;e.category===fe.PNTimeoutCategory?this._startSubscribeLoop():e.category===fe.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection(function(){r._config.autoNetworkDetection&&!r._isOnline&&(r._isOnline=!0,r._listenerManager.announceNetworkUp()),r.reconnect(),r._subscriptionStatusAnnounced=!0,r._listenerManager.announceStatus({category:fe.PNReconnectedCategory,operation:e.operation,lastTimetoken:r._lastTimetoken,currentTimetoken:r._currentTimetoken})}),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===fe.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=fe.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var o=t.messages||[],a=this._config,s=a.requestMessageCountThreshold,l=a.dedupeOnSubscribe;if(s&&o.length>=s){var u={};u.category=fe.PNRequestMessageCountExceededCategory,u.operation=e.operation,this._listenerManager.announceStatus(u)}o.forEach(function(c){if(l){if(r._dedupingManager.isDuplicate(c))return;r._dedupingManager.addEntry(c)}r._eventEmitter.emitEvent(c)}),this._region=t.metadata.region,this._startSubscribeLoop()}},n.prototype._stopSubscribeLoop=function(){this._subscribeCall&&("function"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},n.prototype._renameEvent=function(e){return"set"===e?"updated":"removed"},n.prototype._renameChannelField=function(e){var t=e.channel,r=le(e,["channel"]);return r.spaceId=t,r},n}(),J={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNDeleteMessagesOperation:"PNDeleteMessagesOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNMessageCounts:"PNMessageCountsOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNSignalOperation:"PNSignalOperation",PNAddMessageActionOperation:"PNAddActionOperation",PNRemoveMessageActionOperation:"PNRemoveMessageActionOperation",PNGetMessageActionsOperation:"PNGetMessageActionsOperation",PNCreateUserOperation:"PNCreateUserOperation",PNUpdateUserOperation:"PNUpdateUserOperation",PNDeleteUserOperation:"PNDeleteUserOperation",PNGetUserOperation:"PNGetUsersOperation",PNGetUsersOperation:"PNGetUsersOperation",PNCreateSpaceOperation:"PNCreateSpaceOperation",PNUpdateSpaceOperation:"PNUpdateSpaceOperation",PNDeleteSpaceOperation:"PNDeleteSpaceOperation",PNGetSpaceOperation:"PNGetSpacesOperation",PNGetSpacesOperation:"PNGetSpacesOperation",PNGetMembersOperation:"PNGetMembersOperation",PNUpdateMembersOperation:"PNUpdateMembersOperation",PNGetMembershipsOperation:"PNGetMembershipsOperation",PNUpdateMembershipsOperation:"PNUpdateMembershipsOperation",PNListFilesOperation:"PNListFilesOperation",PNGenerateUploadUrlOperation:"PNGenerateUploadUrlOperation",PNPublishFileOperation:"PNPublishFileOperation",PNGetFileUrlOperation:"PNGetFileUrlOperation",PNDownloadFileOperation:"PNDownloadFileOperation",PNGetAllUUIDMetadataOperation:"PNGetAllUUIDMetadataOperation",PNGetUUIDMetadataOperation:"PNGetUUIDMetadataOperation",PNSetUUIDMetadataOperation:"PNSetUUIDMetadataOperation",PNRemoveUUIDMetadataOperation:"PNRemoveUUIDMetadataOperation",PNGetAllChannelMetadataOperation:"PNGetAllChannelMetadataOperation",PNGetChannelMetadataOperation:"PNGetChannelMetadataOperation",PNSetChannelMetadataOperation:"PNSetChannelMetadataOperation",PNRemoveChannelMetadataOperation:"PNRemoveChannelMetadataOperation",PNSetMembersOperation:"PNSetMembersOperation",PNSetMembershipsOperation:"PNSetMembershipsOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerGrantToken:"PNAccessManagerGrantToken",PNAccessManagerAudit:"PNAccessManagerAudit",PNAccessManagerRevokeToken:"PNAccessManagerRevokeToken",PNHandshakeOperation:"PNHandshakeOperation",PNReceiveMessagesOperation:"PNReceiveMessagesOperation"},Hn=function(){function n(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._telemetryExcludeOperations=[J.PNSubscribeOperation,J.PNReceiveMessagesOperation,J.PNHandshakeOperation],this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return n.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach(function(r){var o=e._averageLatency(e._latencies[r]);o>0&&(t["l_".concat(r)]=o)}),t},n.prototype.startLatencyMeasure=function(e,t){!this._telemetryExcludeOperations.includes(e)&&t&&(this._trackedLatencies[t]=Date.now())},n.prototype.stopLatencyMeasure=function(e,t){if(!this._telemetryExcludeOperations.includes(e)&&t){var r=this._endpointName(e),i=this._latencies[r],o=this._trackedLatencies[t];i||(this._latencies[r]=[],i=this._latencies[r]),i.push(Date.now()-o),i.length>this._maximumSamplesCount&&i.splice(0,i.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},n.prototype._averageLatency=function(e){return Math.floor(e.reduce(function(t,r){return t+r},0)/e.length)},n.prototype._endpointName=function(e){var t=null;switch(e){case J.PNPublishOperation:t="pub";break;case J.PNSignalOperation:t="sig";break;case J.PNHistoryOperation:case J.PNFetchMessagesOperation:case J.PNDeleteMessagesOperation:case J.PNMessageCounts:t="hist";break;case J.PNUnsubscribeOperation:case J.PNWhereNowOperation:case J.PNHereNowOperation:case J.PNHeartbeatOperation:case J.PNSetStateOperation:case J.PNGetStateOperation:t="pres";break;case J.PNAddChannelsToGroupOperation:case J.PNRemoveChannelsFromGroupOperation:case J.PNChannelGroupsOperation:case J.PNRemoveGroupOperation:case J.PNChannelsForGroupOperation:t="cg";break;case J.PNPushNotificationEnabledChannelsOperation:case J.PNRemoveAllPushNotificationsOperation:t="push";break;case J.PNCreateUserOperation:case J.PNUpdateUserOperation:case J.PNDeleteUserOperation:case J.PNGetUserOperation:case J.PNGetUsersOperation:case J.PNCreateSpaceOperation:case J.PNUpdateSpaceOperation:case J.PNDeleteSpaceOperation:case J.PNGetSpaceOperation:case J.PNGetSpacesOperation:case J.PNGetMembersOperation:case J.PNUpdateMembersOperation:case J.PNGetMembershipsOperation:case J.PNUpdateMembershipsOperation:t="obj";break;case J.PNAddMessageActionOperation:case J.PNRemoveMessageActionOperation:case J.PNGetMessageActionsOperation:t="msga";break;case J.PNAccessManagerGrant:case J.PNAccessManagerAudit:t="pam";break;case J.PNAccessManagerGrantToken:case J.PNAccessManagerRevokeToken:t="pamv3";break;default:t="time"}return t},n}(),Bt=function(){function n(e,t,r){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=r}return Object.defineProperty(n.prototype,"payload",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"title",{set:function(t){this._title=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"subtitle",{set:function(t){this._subtitle=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"body",{set:function(t){this._body=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"badge",{set:function(t){this._badge=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sound",{set:function(t){this._sound=t},enumerable:!1,configurable:!0}),n.prototype._setDefaultPayloadStructure=function(){},n.prototype.toObject=function(){return{}},n}(),zn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return W(e,n),Object.defineProperty(e.prototype,"configurations",{set:function(r){r&&r.length&&(this._configurations=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notification",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(r){r&&r.length&&(this._payload.aps.alert.title=r,this._title=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subtitle",{get:function(){return this._subtitle},set:function(r){r&&r.length&&(this._payload.aps.alert.subtitle=r,this._subtitle=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},set:function(r){r&&r.length&&(this._payload.aps.alert.body=r,this._body=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"badge",{get:function(){return this._badge},set:function(r){null!=r&&(this._payload.aps.badge=r,this._badge=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return this._sound},set:function(r){r&&r.length&&(this._payload.aps.sound=r,this._sound=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"silent",{set:function(r){this._isSilent=r},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},e.prototype.toObject=function(){var t=this,r=Q({},this._payload),i=r.aps,o=i.alert;if(this._isSilent&&(i["content-available"]=1),"apns2"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError("APNS2 configuration is missing");var a=[];this._configurations.forEach(function(s){a.push(t._objectFromAPNS2Configuration(s))}),a.length&&(r.pn_push=a)}return o&&Object.keys(o).length||delete i.alert,this._isSilent&&(delete i.alert,delete i.badge,delete i.sound,o={}),this._isSilent||Object.keys(o).length?r:null},e.prototype._objectFromAPNS2Configuration=function(t){var r=this;if(!t.targets||!t.targets.length)throw new ReferenceError("At least one APNS2 target should be provided");var i=[];t.targets.forEach(function(l){i.push(r._objectFromAPNSTarget(l))});var o=t.collapseId,a=t.expirationDate,s={auth_method:"token",targets:i,version:"v2"};return o&&o.length&&(s.collapse_id=o),a&&(s.expiration=a.toISOString()),s},e.prototype._objectFromAPNSTarget=function(t){if(!t.topic||!t.topic.length)throw new TypeError("Target 'topic' undefined.");var i=t.environment,a=t.excludedDevices,s=void 0===a?[]:a,l={topic:t.topic,environment:void 0===i?"development":i};return s.length&&(l.excluded_devices=s),l},e}(Bt),cn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return W(e,n),Object.defineProperty(e.prototype,"backContent",{get:function(){return this._backContent},set:function(r){r&&r.length&&(this._payload.back_content=r,this._backContent=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backTitle",{get:function(){return this._backTitle},set:function(r){r&&r.length&&(this._payload.back_title=r,this._backTitle=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._count},set:function(r){null!=r&&(this._payload.count=r,this._count=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(r){r&&r.length&&(this._payload.title=r,this._title=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(r){r&&r.length&&(this._payload.type=r,this._type=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subtitle",{get:function(){return this.backTitle},set:function(r){this.backTitle=r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this.backContent},set:function(r){this.backContent=r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"badge",{get:function(){return this.count},set:function(r){this.count=r},enumerable:!1,configurable:!0}),e.prototype.toObject=function(){return Object.keys(this._payload).length?Q({},this._payload):null},e}(Bt),Ht=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return W(e,n),Object.defineProperty(e.prototype,"notification",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(r){r&&r.length&&(this._payload.notification.title=r,this._title=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},set:function(r){r&&r.length&&(this._payload.notification.body=r,this._body=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sound",{get:function(){return this._sound},set:function(r){r&&r.length&&(this._payload.notification.sound=r,this._sound=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(r){r&&r.length&&(this._payload.notification.icon=r,this._icon=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){return this._tag},set:function(r){r&&r.length&&(this._payload.notification.tag=r,this._tag=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"silent",{set:function(r){this._isSilent=r},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},e.prototype.toObject=function(){var t=Q({},this._payload.data),r=null,i={};if(Object.keys(this._payload).length>2){var a=le(this._payload,["notification","data"]);t=Q(Q({},t),a)}return this._isSilent?t.notification=this._payload.notification:r=this._payload.notification,Object.keys(t).length&&(i.data=t),r&&Object.keys(r).length&&(i.notification=r),Object.keys(i).length?i:null},e}(Bt),zt=function(){function n(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new zn(this._payload.apns,e,t),this.mpns=new cn(this._payload.mpns,e,t),this.fcm=new Ht(this._payload.fcm,e,t)}return Object.defineProperty(n.prototype,"debugging",{set:function(t){this._debugging=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"body",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"subtitle",{get:function(){return this._subtitle},set:function(t){this._subtitle=t,this.apns.subtitle=t,this.mpns.subtitle=t,this.fcm.subtitle=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"badge",{get:function(){return this._badge},set:function(t){this._badge=t,this.apns.badge=t,this.mpns.badge=t,this.fcm.badge=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t,this.apns.sound=t,this.mpns.sound=t,this.fcm.sound=t},enumerable:!1,configurable:!0}),n.prototype.buildPayload=function(e){var t={};if(e.includes("apns")||e.includes("apns2")){this.apns._apnsPushType=e.includes("apns")?"apns":"apns2";var r=this.apns.toObject();r&&Object.keys(r).length&&(t.pn_apns=r)}if(e.includes("mpns")){var i=this.mpns.toObject();i&&Object.keys(i).length&&(t.pn_mpns=i)}if(e.includes("fcm")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},n}(),ln=function(){function n(){this._listeners=[]}return n.prototype.addListener=function(e){this._listeners.includes(e)||this._listeners.push(e)},n.prototype.removeListener=function(e){var t=[];this._listeners.forEach(function(r){r!==e&&t.push(r)}),this._listeners=t},n.prototype.removeAllListeners=function(){this._listeners=[]},n.prototype.announcePresence=function(e){this._listeners.forEach(function(t){t.presence&&t.presence(e)})},n.prototype.announceStatus=function(e){this._listeners.forEach(function(t){t.status&&t.status(e)})},n.prototype.announceMessage=function(e){this._listeners.forEach(function(t){t.message&&t.message(e)})},n.prototype.announceSignal=function(e){this._listeners.forEach(function(t){t.signal&&t.signal(e)})},n.prototype.announceMessageAction=function(e){this._listeners.forEach(function(t){t.messageAction&&t.messageAction(e)})},n.prototype.announceFile=function(e){this._listeners.forEach(function(t){t.file&&t.file(e)})},n.prototype.announceObjects=function(e){this._listeners.forEach(function(t){t.objects&&t.objects(e)})},n.prototype.announceUser=function(e){this._listeners.forEach(function(t){t.user&&t.user(e)})},n.prototype.announceSpace=function(e){this._listeners.forEach(function(t){t.space&&t.space(e)})},n.prototype.announceMembership=function(e){this._listeners.forEach(function(t){t.membership&&t.membership(e)})},n.prototype.announceNetworkUp=function(){var e={};e.category=fe.PNNetworkUpCategory,this.announceStatus(e)},n.prototype.announceNetworkDown=function(){var e={};e.category=fe.PNNetworkDownCategory,this.announceStatus(e)},n}(),qn=function(){function n(e,t){this._config=e,this._cbor=t}return n.prototype.setToken=function(e){this._token=e&&e.length>0?e:void 0},n.prototype.getToken=function(){return this._token},n.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return!(128&~e)&&(t.join=!0),!(64&~e)&&(t.update=!0),!(32&~e)&&(t.get=!0),!(8&~e)&&(t.delete=!0),!(4&~e)&&(t.manage=!0),!(2&~e)&&(t.write=!0),!(1&~e)&&(t.read=!0),t},n.prototype.parseToken=function(e){var t=this,r=this._cbor.decodeToken(e);if(void 0!==r){var i=r.res.uuid?Object.keys(r.res.uuid):[],o=Object.keys(r.res.chan),a=Object.keys(r.res.grp),s=r.pat.uuid?Object.keys(r.pat.uuid):[],l=Object.keys(r.pat.chan),u=Object.keys(r.pat.grp),c={version:r.v,timestamp:r.t,ttl:r.ttl,authorized_uuid:r.uuid},p=i.length>0,h=o.length>0,b=a.length>0;(p||h||b)&&(c.resources={},p&&(c.resources.uuids={},i.forEach(function(d){c.resources.uuids[d]=t.extractPermissions(r.res.uuid[d])})),h&&(c.resources.channels={},o.forEach(function(d){c.resources.channels[d]=t.extractPermissions(r.res.chan[d])})),b&&(c.resources.groups={},a.forEach(function(d){c.resources.groups[d]=t.extractPermissions(r.res.grp[d])})));var y=s.length>0,f=l.length>0,v=u.length>0;return(y||f||v)&&(c.patterns={},y&&(c.patterns.uuids={},s.forEach(function(d){c.patterns.uuids[d]=t.extractPermissions(r.pat.uuid[d])})),f&&(c.patterns.channels={},l.forEach(function(d){c.patterns.channels[d]=t.extractPermissions(r.pat.chan[d])})),v&&(c.patterns.groups={},u.forEach(function(d){c.patterns.groups[d]=t.extractPermissions(r.pat.grp[d])}))),Object.keys(r.meta).length>0&&(c.meta=r.meta),c.signature=r.sig,c}},n}();function qt(n){return encodeURIComponent(n).replace(/[!~*'()]/g,function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())})}var oe={signPamFromParams:function(e){return function(n){return function(e){var t=[];return Object.keys(e).forEach(function(r){return t.push(r)}),t}(n).sort()}(e).map(function(t){return"".concat(t,"=").concat(qt(e[t]))}).join("&")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise(function(r,i){e=r,t=i}),reject:t,fulfill:e}},encodeString:qt,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),i=0,o=e.length;i<o;i++)r[i]=e.charCodeAt(i);return t},removeSingleOccurance:function(e,t){var r=Object.fromEntries(t.map(function(i){return[i,!1]}));return e.filter(function(i){return!(t.includes(i)&&!r[i]&&(r[i]=!0,1))})},findUniqueCommonElements:function(e,t){return __spreadArray([],__read(e),!1).filter(function(r){return t.includes(r)&&e.indexOf(r)===e.lastIndexOf(r)&&t.indexOf(r)===t.lastIndexOf(r)})}},ve=function(n){function e(t,r){var i=this.constructor,o=n.call(this,t)||this;return o.name=o.constructor.name,o.status=r,o.message=t,Object.setPrototypeOf(o,i.prototype),o}return W(e,n),e}(Error);function Ye(n){return(e={message:n}).type="validationError",e.error=!0,e;var e}function hn(n){if(n.sdkName)return n.sdkName;var e="PubNub-JS-".concat(n.sdkFamily);n.partnerId&&(e+="-".concat(n.partnerId)),e+="/".concat(n.getVersion());var t=n._getPnsdkSuffix(" ");return t.length>0&&(e+=t),e}function yt(n,e,t){return e.usePost&&e.usePost(n,t)?"POST":e.usePatch&&e.usePatch(n,t)?"PATCH":e.useDelete&&e.useDelete(n,t)?"DELETE":e.useGetFile&&e.useGetFile(n,t)?"GETFILE":"GET"}function fn(n,e,t,r,i){var o=n.config,a=n.crypto,s=yt(n,i,r);t.timestamp=Math.floor((new Date).getTime()/1e3),"PNPublishOperation"===i.getOperation()&&i.usePost&&i.usePost(n,r)&&(s="GET"),"GETFILE"===s&&(s="GET");var l="".concat(s,"\n").concat(o.publishKey,"\n").concat(e,"\n").concat(oe.signPamFromParams(t),"\n");if("POST"===s)l+="string"==typeof(u=i.postPayload(n,r))?u:JSON.stringify(u);else if("PATCH"===s){var u;l+="string"==typeof(u=i.patchPayload(n,r))?u:JSON.stringify(u)}var c="v2.".concat(a.HMACSHA256(l));c=(c=(c=c.replace(/\+/g,"-")).replace(/\//g,"_")).replace(/=+$/,""),t.signature=c}function ne(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=n.networking,o=n.config,a=n.telemetryManager,s=n.tokenManager,l=rt(),u=null,c=null,p={};e.getOperation()===J.PNTimeOperation||e.getOperation()===J.PNChannelGroupsOperation?u=t[0]:(p=t[0],u=t[1]),typeof Promise>"u"||u||(c=oe.createPromise());var h=e.validateParams(n,p);if(h)return u?u(Ye(h)):c?(c.reject(new ve("Validation failed, check status for details",Ye(h))),c.promise):void 0;var b,y=e.prepareParams(n,p),f=function(n,e,t){return n.usePost&&n.usePost(e,t)?n.postURL(e,t):n.usePatch&&n.usePatch(e,t)?n.patchURL(e,t):n.useGetFile&&n.useGetFile(e,t)?n.getFileURL(e,t):n.getURL(e,t)}(e,n,p),v={url:f,operation:e.getOperation(),timeout:e.getRequestTimeout(n),headers:e.getRequestHeaders?e.getRequestHeaders():{},ignoreBody:"function"==typeof e.ignoreBody&&e.ignoreBody(n),forceBuffered:"function"==typeof e.forceBuffered?e.forceBuffered(n,p):null,abortSignal:"function"==typeof e.getAbortSignal?e.getAbortSignal(n,p):null};y.uuid=o.UUID,y.pnsdk=hn(o);var d=a.operationsLatencyForRequest();if(Object.keys(d).length&&(y=Q(Q({},y),d)),o.useInstanceId&&(y.instanceid=o.instanceId),o.useRequestId&&(y.requestid=l),e.isAuthSupported()){var E=s.getToken()||o.getAuthKey();E&&(y.auth=E)}o.secretKey&&fn(n,f,y,p,e);var j=function(P,A){if(P.error)return e.handleError&&e.handleError(n,p,P),void(u?u(P):c&&c.reject(new ve("PubNub call failed, check status for details",P)));a.stopLatencyMeasure(e.getOperation(),l);var k=e.handleResponse(n,A,p);"function"!=typeof k?.then&&(k=Promise.resolve(k)),k.then(function(O){u?u(P,O):c&&c.fulfill(O)}).catch(function(O){if(u){var V=O;e.getOperation()===J.PNSubscribeOperation&&(V={statusCode:400,error:!0,operation:e.getOperation(),errorData:O,category:fe.PNUnknownCategory}),u(V,null)}else c&&c.reject(new ve("PubNub call failed, check status for details",O))})};if(a.startLatencyMeasure(e.getOperation(),l),"POST"===yt(n,e,p)){var F=e.postPayload(n,p);b=i.POST(y,F,v,j)}else"PATCH"===yt(n,e,p)?(F=e.patchPayload(n,p),b=i.PATCH(y,F,v,j)):b="DELETE"===yt(n,e,p)?i.DELETE(y,v,j):"GETFILE"===yt(n,e,p)?i.GETFILE(y,v,j):i.GET(y,v,j);return e.getOperation()===J.PNSubscribeOperation?b:c?c.promise:void 0}var dn=Object.freeze({__proto__:null,getOperation:function(){return J.PNAddChannelsToGroupOperation},validateParams:function(e,t){var r=t.channels;return t.channelGroup?r&&0!==r.length?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"},getURL:function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/".concat(e.config.subscribeKey,"/channel-group/").concat(oe.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channels;return{add:(void 0===r?[]:r).join(",")}},handleResponse:function(){return{}}}),Wn=Object.freeze({__proto__:null,getOperation:function(){return J.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var r=t.channels;return t.channelGroup?r&&0!==r.length?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"},getURL:function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/".concat(e.config.subscribeKey,"/channel-group/").concat(oe.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channels;return{remove:(void 0===r?[]:r).join(",")}},handleResponse:function(){return{}}}),Ct=Object.freeze({__proto__:null,getOperation:function(){return J.PNRemoveGroupOperation},validateParams:function(e,t){return t.channelGroup?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"},getURL:function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/".concat(e.config.subscribeKey,"/channel-group/").concat(oe.encodeString(r),"/remove")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}}),yn=Object.freeze({__proto__:null,getOperation:function(){return J.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e){return"/v1/channel-registration/sub-key/".concat(e.config.subscribeKey,"/channel-group")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}}),Jn=Object.freeze({__proto__:null,getOperation:function(){return J.PNChannelsForGroupOperation},validateParams:function(e,t){return t.channelGroup?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"},getURL:function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/".concat(e.config.subscribeKey,"/channel-group/").concat(oe.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}}),gn=Object.freeze({__proto__:null,getOperation:function(){return J.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var i=t.pushGateway,o=t.channels;return t.device?i?"apns2"!==i||t.topic?o&&0!==o.length?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(e,t){var r=t.device,o=e.config;return"apns2"===t.pushGateway?"/v2/push/sub-key/".concat(o.subscribeKey,"/devices-apns2/").concat(r):"/v1/push/sub-key/".concat(o.subscribeKey,"/devices/").concat(r)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,i=t.channels,a=t.environment,s=void 0===a?"development":a,l=t.topic,u={type:r,add:(void 0===i?[]:i).join(",")};return"apns2"===r&&delete(u=Q(Q({},u),{environment:s,topic:l})).type,u},handleResponse:function(){return{}}}),mn=Object.freeze({__proto__:null,getOperation:function(){return J.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var i=t.pushGateway,o=t.channels;return t.device?i?"apns2"!==i||t.topic?o&&0!==o.length?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(e,t){var r=t.device,o=e.config;return"apns2"===t.pushGateway?"/v2/push/sub-key/".concat(o.subscribeKey,"/devices-apns2/").concat(r):"/v1/push/sub-key/".concat(o.subscribeKey,"/devices/").concat(r)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,i=t.channels,a=t.environment,s=void 0===a?"development":a,l=t.topic,u={type:r,remove:(void 0===i?[]:i).join(",")};return"apns2"===r&&delete(u=Q(Q({},u),{environment:s,topic:l})).type,u},handleResponse:function(){return{}}}),$n=Object.freeze({__proto__:null,getOperation:function(){return J.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var i=t.pushGateway;return t.device?i?"apns2"!==i||t.topic?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(e,t){var r=t.device,o=e.config;return"apns2"===t.pushGateway?"/v2/push/sub-key/".concat(o.subscribeKey,"/devices-apns2/").concat(r):"/v1/push/sub-key/".concat(o.subscribeKey,"/devices/").concat(r)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,i=t.environment,o=void 0===i?"development":i,a=t.topic,s=t.start,l=t.count,u={type:r};return"apns2"===r&&delete(u=Q(Q({},u),{environment:o,topic:a})).type,s&&(u.start=s),l&&l>0&&(u.count=l),u},handleResponse:function(e,t){return{channels:t}}}),Qn=Object.freeze({__proto__:null,getOperation:function(){return J.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var i=t.pushGateway;return t.device?i?"apns2"!==i||t.topic?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(e,t){var r=t.device,o=e.config;return"apns2"===t.pushGateway?"/v2/push/sub-key/".concat(o.subscribeKey,"/devices-apns2/").concat(r,"/remove"):"/v1/push/sub-key/".concat(o.subscribeKey,"/devices/").concat(r,"/remove")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,i=t.environment,o=void 0===i?"development":i,a=t.topic,s={type:r};return"apns2"===r&&delete(s=Q(Q({},s),{environment:o,topic:a})).type,s},handleResponse:function(){return{}}}),vn=Object.freeze({__proto__:null,getOperation:function(){return J.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e,t){var r=e.config,i=t.channels,o=void 0===i?[]:i,a=o.length>0?o.join(","):",";return"/v2/presence/sub-key/".concat(r.subscribeKey,"/channel/").concat(oe.encodeString(a),"/leave")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,i=void 0===r?[]:r,o={};return i.length>0&&(o["channel-group"]=i.join(",")),o},handleResponse:function(){return{}}}),bn=Object.freeze({__proto__:null,getOperation:function(){return J.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e,t){var r=e.config,i=t.uuid,o=void 0===i?r.UUID:i;return"/v2/presence/sub-key/".concat(r.subscribeKey,"/uuid/").concat(oe.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}}),gt=Object.freeze({__proto__:null,getOperation:function(){return J.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e,t){var r=e.config,i=t.channels,o=void 0===i?[]:i,a=o.length>0?o.join(","):",";return"/v2/presence/sub-key/".concat(r.subscribeKey,"/channel/").concat(oe.encodeString(a),"/heartbeat")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var r=t.channelGroups,i=void 0===r?[]:r,o=t.state,a=e.config,s={};return i.length>0&&(s["channel-group"]=i.join(",")),o&&(s.state=JSON.stringify(o)),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}}),Xn=Object.freeze({__proto__:null,getOperation:function(){return J.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e,t){var r=e.config,i=t.uuid,o=void 0===i?r.UUID:i,a=t.channels,s=void 0===a?[]:a,l=s.length>0?s.join(","):",";return"/v2/presence/sub-key/".concat(r.subscribeKey,"/channel/").concat(oe.encodeString(l),"/uuid/").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,i=void 0===r?[]:r,o={};return i.length>0&&(o["channel-group"]=i.join(",")),o},handleResponse:function(e,t,r){var i=r.channels,o=void 0===i?[]:i,a=r.channelGroups,l={};return 1===o.length&&0===(void 0===a?[]:a).length?l[o[0]]=t.payload:l=t.payload,{channels:l}}}),_n=Object.freeze({__proto__:null,getOperation:function(){return J.PNSetStateOperation},validateParams:function(e,t){var o=t.channels,s=t.channelGroups;return t.state?e.config.subscribeKey?0===(void 0===o?[]:o).length&&0===(void 0===s?[]:s).length?"Please provide a list of channels and/or channel-groups":void 0:"Missing Subscribe Key":"Missing State"},getURL:function(e,t){var r=e.config,i=t.channels,o=void 0===i?[]:i,a=o.length>0?o.join(","):",";return"/v2/presence/sub-key/".concat(r.subscribeKey,"/channel/").concat(oe.encodeString(a),"/uuid/").concat(oe.encodeString(r.UUID),"/data")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var i=t.channelGroups,o=void 0===i?[]:i,a={};return a.state=JSON.stringify(t.state),o.length>0&&(a["channel-group"]=o.join(",")),a},handleResponse:function(e,t){return{state:t.payload}}}),Yn=Object.freeze({__proto__:null,getOperation:function(){return J.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e,t){var i=t.channels,o=void 0===i?[]:i,a=t.channelGroups,s=void 0===a?[]:a,l="/v2/presence/sub-key/".concat(e.config.subscribeKey);if(o.length>0||s.length>0){var u=o.length>0?o.join(","):",";l+="/channel/".concat(oe.encodeString(u))}return l},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,i=void 0===r?[]:r,o=t.includeUUIDs,s=t.includeState,l=void 0!==s&&s,u=t.queryParameters,c=void 0===u?{}:u,p={};return void 0===o||o||(p.disable_uuids=1),l&&(p.state=1),i.length>0&&(p["channel-group"]=i.join(",")),Q(Q({},p),c)},handleResponse:function(e,t,r){var h,i=r.channels,o=void 0===i?[]:i,a=r.channelGroups,s=void 0===a?[]:a,l=r.includeUUIDs,u=void 0===l||l,c=r.includeState,p=void 0!==c&&c;return o.length>1||s.length>0||0===s.length&&0===o.length?((h={}).totalChannels=t.payload.total_channels,h.totalOccupancy=t.payload.total_occupancy,h.channels={},Object.keys(t.payload.channels).forEach(function(b){var y=t.payload.channels[b],f=[];return h.channels[b]={occupants:f,name:b,occupancy:y.occupancy},u&&y.uuids.forEach(function(v){f.push(p?{state:v.state,uuid:v.uuid}:{state:null,uuid:v})}),h}),h):function(){var h={},b=[];return h.totalChannels=1,h.totalOccupancy=t.occupancy,h.channels={},h.channels[o[0]]={occupants:b,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach(function(y){b.push(p?{state:y.state,uuid:y.uuid}:{state:null,uuid:y})}),h}()},handleError:function(e,t,r){402!==r.statusCode||this.getURL(e,t).includes("channel")||(r.errorData.message="You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.")}}),Zn=Object.freeze({__proto__:null,getOperation:function(){return J.PNAddMessageActionOperation},validateParams:function(e,t){var i=t.action;return t.messageTimetoken?e.config.subscribeKey?t.channel?i?i.value?i.type?i.type.length>15?"Action.type value exceed maximum length of 15":void 0:"Missing Action.type":"Missing Action.value":"Missing Action":"Missing message channel":"Missing Subscribe Key":"Missing message timetoken"},usePost:function(){return!0},postURL:function(e,t){var i=t.channel,o=t.messageTimetoken;return"/v1/message-actions/".concat(e.config.subscribeKey,"/channel/").concat(oe.encodeString(i),"/message/").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{"Content-Type":"application/json"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}}),Sn=Object.freeze({__proto__:null,getOperation:function(){return J.PNRemoveMessageActionOperation},validateParams:function(e,t){return t.messageTimetoken?t.actionTimetoken?e.config.subscribeKey?t.channel?void 0:"Missing message channel":"Missing Subscribe Key":"Missing action timetoken":"Missing message timetoken"},useDelete:function(){return!0},getURL:function(e,t){var i=t.channel,o=t.actionTimetoken,a=t.messageTimetoken;return"/v1/message-actions/".concat(e.config.subscribeKey,"/channel/").concat(oe.encodeString(i),"/message/").concat(a,"/action/").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}}),Pn=Object.freeze({__proto__:null,getOperation:function(){return J.PNGetMessageActionsOperation},validateParams:function(e,t){return e.config.subscribeKey?t.channel?void 0:"Missing message channel":"Missing Subscribe Key"},getURL:function(e,t){var i=t.channel;return"/v1/message-actions/".concat(e.config.subscribeKey,"/channel/").concat(oe.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.limit,i=t.start,o=t.end,a={};return r&&(a.limit=r),i&&(a.start=i),o&&(a.end=o),a},handleResponse:function(e,t){var r={data:t.data,start:null,end:null};return r.data.length&&(r.end=r.data[r.data.length-1].actionTimetoken,r.start=r.data[0].actionTimetoken),r}}),Vr={getOperation:function(){return J.PNListFilesOperation},validateParams:function(e,t){if(!t?.channel)return"channel can't be empty"},getURL:function(e,t){return"/v1/files/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel),"/files")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r={};return t.limit&&(r.limit=t.limit),t.next&&(r.next=t.next),r},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},er={getOperation:function(){return J.PNGenerateUploadUrlOperation},validateParams:function(e,t){return t?.channel?t?.name?void 0:"name can't be empty":"channel can't be empty"},usePost:function(){return!0},postURL:function(e,t){return"/v1/files/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel),"/generate-upload-url")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},tr={getOperation:function(){return J.PNPublishFileOperation},validateParams:function(e,t){return t?.channel?t?.fileId?t?.fileName?void 0:"file name can't be empty":"file id can't be empty":"channel can't be empty"},getURL:function(e,t){var r=e.config,i=r.publishKey,o=r.subscribeKey,a=function(s,l){var u=JSON.stringify(l);if(s.cryptoModule){var c=s.cryptoModule.encrypt(u);u="string"==typeof c?c:Ot(c),u=JSON.stringify(u)}return u||""}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return"/v1/files/publish-file/".concat(i,"/").concat(o,"/0/").concat(oe.encodeString(t.channel),"/0/").concat(oe.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r={};return t.ttl&&(r.ttl=t.ttl),void 0!==t.storeInHistory&&(r.store=t.storeInHistory?"1":"0"),t.meta&&"object"==typeof t.meta&&(r.meta=JSON.stringify(t.meta)),r},handleResponse:function(e,t){return{timetoken:t[2]}}},g=function(e,t){var r=t.channel,i=t.id,o=t.name,a=e.config,s=e.networking,l=e.tokenManager;if(!r)throw new ve("Validation failed, check status for details",Ye("channel can't be empty"));if(!i)throw new ve("Validation failed, check status for details",Ye("file id can't be empty"));if(!o)throw new ve("Validation failed, check status for details",Ye("file name can't be empty"));var u="/v1/files/".concat(a.subscribeKey,"/channels/").concat(oe.encodeString(r),"/files/").concat(i,"/").concat(o),c={};c.uuid=a.getUUID(),c.pnsdk=hn(a);var p=l.getToken()||a.getAuthKey();p&&(c.auth=p),a.secretKey&&fn(e,u,c,{},{getOperation:function(){return"PubNubGetFileUrlOperation"}});var h=Object.keys(c).map(function(b){return"".concat(encodeURIComponent(b),"=").concat(encodeURIComponent(c[b]))}).join("&");return""!==h?"".concat(s.getStandardOrigin()).concat(u,"?").concat(h):"".concat(s.getStandardOrigin()).concat(u)},S={getOperation:function(){return J.PNDownloadFileOperation},validateParams:function(e,t){return t?.channel?t?.name?t?.id?void 0:"id can't be empty":"name can't be empty":"channel can't be empty"},useGetFile:function(){return!0},getFileURL:function(e,t){return"/v1/files/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel),"/files/").concat(t.id,"/").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,r){var i=e.PubNubFile,o=e.config,a=e.cryptography,s=e.cryptoModule;return Y(void 0,void 0,void 0,function(){var l,u,c,p;return q(this,function(h){switch(h.label){case 0:return l=t.response.body,i.supportsEncryptFile&&(r.cipherKey||s)?null!=r.cipherKey?[3,2]:[4,s.decryptFile(i.create({data:l,name:r.name}),i)]:[3,5];case 1:return u=h.sent().data,[3,4];case 2:return[4,a.decrypt(null!==(c=r.cipherKey)&&void 0!==c?c:o.cipherKey,l)];case 3:u=h.sent(),h.label=4;case 4:l=u,h.label=5;case 5:return[2,i.create({data:l,name:null!==(p=t.response.name)&&void 0!==p?p:r.name,mimeType:t.response.type})]}})})}},R={getOperation:function(){return J.PNListFilesOperation},validateParams:function(e,t){return t?.channel?t?.id?t?.name?void 0:"file name can't be empty":"file id can't be empty":"channel can't be empty"},useDelete:function(){return!0},getURL:function(e,t){return"/v1/files/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel),"/files/").concat(t.id,"/").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},x={getOperation:function(){return J.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){return"/v2/objects/".concat(e.config.subscribeKey,"/uuids")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o,a,s,l,u,c,p,h={include:["status","type"]};return t?.include&&!(null===(r=t.include)||void 0===r)&&r.customFields&&h.include.push("custom"),h.include=h.include.join(","),!(null===(i=t?.include)||void 0===i)&&i.totalCount&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),!(null===(a=t?.page)||void 0===a)&&a.next&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),!(null===(l=t?.page)||void 0===l)&&l.prev&&(h.end=null===(u=t.page)||void 0===u?void 0:u.prev),t?.filter&&(h.filter=t.filter),h.limit=null!==(c=t?.limit)&&void 0!==c?c:100,t?.sort&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map(function(b){var y=D(b,2),f=y[0],v=y[1];return"asc"===v||"desc"===v?"".concat(f,":").concat(v):f})),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},U={getOperation:function(){return J.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var r,i=e.config;return"/v2/objects/".concat(i.subscribeKey,"/uuids/").concat(oe.encodeString(null!==(r=t?.uuid)&&void 0!==r?r:i.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o=e.config,a={};return a.uuid=null!==(r=t?.uuid)&&void 0!==r?r:o.getUUID(),a.include=["status","type","custom"],t?.include&&!1===(null===(i=t.include)||void 0===i?void 0:i.customFields)&&a.include.pop(),a.include=a.include.join(","),a},handleResponse:function(e,t){return{status:t.status,data:t.data}}},$={getOperation:function(){return J.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!t?.data)return"Data cannot be empty"},usePatch:function(){return!0},patchURL:function(e,t){var r,i=e.config;return"/v2/objects/".concat(i.subscribeKey,"/uuids/").concat(oe.encodeString(null!==(r=t.uuid)&&void 0!==r?r:i.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o=e.config,a={};return a.uuid=null!==(r=t?.uuid)&&void 0!==r?r:o.getUUID(),a.include=["status","type","custom"],t?.include&&!1===(null===(i=t.include)||void 0===i?void 0:i.customFields)&&a.include.pop(),a.include=a.include.join(","),a},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Z={getOperation:function(){return J.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var r,i=e.config;return"/v2/objects/".concat(i.subscribeKey,"/uuids/").concat(oe.encodeString(null!==(r=t?.uuid)&&void 0!==r?r:i.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i=e.config;return{uuid:null!==(r=t?.uuid)&&void 0!==r?r:i.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ee={getOperation:function(){return J.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){return"/v2/objects/".concat(e.config.subscribeKey,"/channels")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o,a,s,l,u,c,p,h={include:["status","type"]};return t?.include&&!(null===(r=t.include)||void 0===r)&&r.customFields&&h.include.push("custom"),h.include=h.include.join(","),!(null===(i=t?.include)||void 0===i)&&i.totalCount&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),!(null===(a=t?.page)||void 0===a)&&a.next&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),!(null===(l=t?.page)||void 0===l)&&l.prev&&(h.end=null===(u=t.page)||void 0===u?void 0:u.prev),t?.filter&&(h.filter=t.filter),h.limit=null!==(c=t?.limit)&&void 0!==c?c:100,t?.sort&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map(function(b){var y=D(b,2),f=y[0],v=y[1];return"asc"===v||"desc"===v?"".concat(f,":").concat(v):f})),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},ae={getOperation:function(){return J.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!t?.channel)return"Channel cannot be empty"},getURL:function(e,t){return"/v2/objects/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i={include:["status","type","custom"]};return t?.include&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(","),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},de={getOperation:function(){return J.PNSetChannelMetadataOperation},validateParams:function(e,t){return t?.channel?t?.data?void 0:"Data cannot be empty":"Channel cannot be empty"},usePatch:function(){return!0},patchURL:function(e,t){return"/v2/objects/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i={include:["status","type","custom"]};return t?.include&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(","),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return J.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!t?.channel)return"Channel cannot be empty"},getURL:function(e,t){return"/v2/objects/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Me={getOperation:function(){return J.PNGetMembersOperation},validateParams:function(e,t){if(!t?.channel)return"channel cannot be empty"},getURL:function(e,t){return"/v2/objects/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel),"/uuids")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o,a,s,l,u,c,p,h,b,y,f,v,d={include:[]};return t?.include&&(!(null===(r=t.include)||void 0===r)&&r.statusField&&d.include.push("status"),!(null===(i=t.include)||void 0===i)&&i.customFields&&d.include.push("custom"),!(null===(o=t.include)||void 0===o)&&o.UUIDFields&&d.include.push("uuid"),!(null===(a=t.include)||void 0===a)&&a.customUUIDFields&&d.include.push("uuid.custom"),!(null===(s=t.include)||void 0===s)&&s.UUIDStatusField&&d.include.push("uuid.status"),!(null===(l=t.include)||void 0===l)&&l.UUIDTypeField&&d.include.push("uuid.type")),d.include=d.include.join(","),!(null===(u=t?.include)||void 0===u)&&u.totalCount&&(d.count=null===(c=t.include)||void 0===c?void 0:c.totalCount),!(null===(p=t?.page)||void 0===p)&&p.next&&(d.start=null===(h=t.page)||void 0===h?void 0:h.next),!(null===(b=t?.page)||void 0===b)&&b.prev&&(d.end=null===(y=t.page)||void 0===y?void 0:y.prev),t?.filter&&(d.filter=t.filter),d.limit=null!==(f=t?.limit)&&void 0!==f?f:100,t?.sort&&(d.sort=Object.entries(null!==(v=t.sort)&&void 0!==v?v:{}).map(function(E){var j=D(E,2),F=j[0],H=j[1];return"asc"===H||"desc"===H?"".concat(F,":").concat(H):F})),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ie={getOperation:function(){return J.PNSetMembersOperation},validateParams:function(e,t){return t?.channel?t?.uuids&&0!==t?.uuids.length?void 0:"UUIDs cannot be empty":"Channel cannot be empty"},usePatch:function(){return!0},patchURL:function(e,t){return"/v2/objects/".concat(e.config.subscribeKey,"/channels/").concat(oe.encodeString(t.channel),"/uuids")},patchPayload:function(e,t){var r;return(r={set:[],delete:[]})[t.type]=t.uuids.map(function(i){return"string"==typeof i?{uuid:{id:i}}:{uuid:{id:i.id},custom:i.custom,status:i.status}}),r},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o,a,s,l,u,c,p,h={include:["uuid.status","uuid.type","type"]};return t?.include&&(!(null===(r=t.include)||void 0===r)&&r.customFields&&h.include.push("custom"),!(null===(i=t.include)||void 0===i)&&i.customUUIDFields&&h.include.push("uuid.custom"),!(null===(o=t.include)||void 0===o)&&o.UUIDFields&&h.include.push("uuid")),h.include=h.include.join(","),!(null===(a=t?.include)||void 0===a)&&a.totalCount&&(h.count=!0),!(null===(s=t?.page)||void 0===s)&&s.next&&(h.start=null===(l=t.page)||void 0===l?void 0:l.next),!(null===(u=t?.page)||void 0===u)&&u.prev&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),t?.filter&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),t?.sort&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map(function(b){var y=D(b,2),f=y[0],v=y[1];return"asc"===v||"desc"===v?"".concat(f,":").concat(v):f})),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},nr={getOperation:function(){return J.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var r,i=e.config;return"/v2/objects/".concat(i.subscribeKey,"/uuids/").concat(oe.encodeString(null!==(r=t?.uuid)&&void 0!==r?r:i.getUUID()),"/channels")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o,a,s,l,u,c,p,h,b,y,f,v,d={include:[]};return t?.include&&(!(null===(r=t.include)||void 0===r)&&r.statusField&&d.include.push("status"),!(null===(i=t.include)||void 0===i)&&i.customFields&&d.include.push("custom"),!(null===(o=t.include)||void 0===o)&&o.channelFields&&d.include.push("channel"),!(null===(a=t.include)||void 0===a)&&a.customChannelFields&&d.include.push("channel.custom"),!(null===(s=t.include)||void 0===s)&&s.channelStatusField&&d.include.push("channel.status"),!(null===(l=t.include)||void 0===l)&&l.channelTypeField&&d.include.push("channel.type")),d.include=d.include.join(","),!(null===(u=t?.include)||void 0===u)&&u.totalCount&&(d.count=null===(c=t.include)||void 0===c?void 0:c.totalCount),!(null===(p=t?.page)||void 0===p)&&p.next&&(d.start=null===(h=t.page)||void 0===h?void 0:h.next),!(null===(b=t?.page)||void 0===b)&&b.prev&&(d.end=null===(y=t.page)||void 0===y?void 0:y.prev),t?.filter&&(d.filter=t.filter),d.limit=null!==(f=t?.limit)&&void 0!==f?f:100,t?.sort&&(d.sort=Object.entries(null!==(v=t.sort)&&void 0!==v?v:{}).map(function(E){var j=D(E,2),F=j[0],H=j[1];return"asc"===H||"desc"===H?"".concat(F,":").concat(H):F})),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Wr={getOperation:function(){return J.PNSetMembershipsOperation},validateParams:function(e,t){if(!t?.channels||0===t?.channels.length)return"Channels cannot be empty"},usePatch:function(){return!0},patchURL:function(e,t){var r,i=e.config;return"/v2/objects/".concat(i.subscribeKey,"/uuids/").concat(oe.encodeString(null!==(r=t.uuid)&&void 0!==r?r:i.getUUID()),"/channels")},patchPayload:function(e,t){var r;return(r={set:[],delete:[]})[t.type]=t.channels.map(function(i){return"string"==typeof i?{channel:{id:i}}:{channel:{id:i.id},custom:i.custom,status:i.status}}),r},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r,i,o,a,s,l,u,c,p,h={include:["channel.status","channel.type","status"]};return t?.include&&(!(null===(r=t.include)||void 0===r)&&r.customFields&&h.include.push("custom"),!(null===(i=t.include)||void 0===i)&&i.customChannelFields&&h.include.push("channel.custom"),!(null===(o=t.include)||void 0===o)&&o.channelFields&&h.include.push("channel")),h.include=h.include.join(","),!(null===(a=t?.include)||void 0===a)&&a.totalCount&&(h.count=!0),!(null===(s=t?.page)||void 0===s)&&s.next&&(h.start=null===(l=t.page)||void 0===l?void 0:l.next),!(null===(u=t?.page)||void 0===u)&&u.prev&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),t?.filter&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),t?.sort&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map(function(b){var y=D(b,2),f=y[0],v=y[1];return"asc"===v||"desc"===v?"".concat(f,":").concat(v):f})),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},ho=Object.freeze({__proto__:null,getOperation:function(){return J.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e){return"/v2/auth/audit/sub-key/".concat(e.config.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var r=t.channel,i=t.channelGroup,o=t.authKeys,a=void 0===o?[]:o,s={};return r&&(s.channel=r),i&&(s["channel-group"]=i),a.length>0&&(s.auth=a.join(",")),s},handleResponse:function(e,t){return t.payload}}),fo=Object.freeze({__proto__:null,getOperation:function(){return J.PNAccessManagerGrant},validateParams:function(e,t){var r=e.config;return r.subscribeKey?r.publishKey?r.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:"Both channel/channelgroup and uuid cannot be used in the same request":"authKeys are required for grant request on uuids":"Missing Secret Key":"Missing Publish Key":"Missing Subscribe Key"},getURL:function(e){return"/v2/auth/grant/sub-key/".concat(e.config.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var r=t.channels,i=void 0===r?[]:r,o=t.channelGroups,a=void 0===o?[]:o,s=t.uuids,l=void 0===s?[]:s,u=t.ttl,c=t.read,h=t.write,b=void 0!==h&&h,y=t.manage,f=void 0!==y&&y,v=t.get,d=void 0!==v&&v,E=t.join,j=void 0!==E&&E,F=t.update,H=void 0!==F&&F,P=t.authKeys,A=void 0===P?[]:P,k=t.delete,O={};return O.r=void 0!==c&&c?"1":"0",O.w=b?"1":"0",O.m=f?"1":"0",O.d=k?"1":"0",O.g=d?"1":"0",O.j=j?"1":"0",O.u=H?"1":"0",i.length>0&&(O.channel=i.join(",")),a.length>0&&(O["channel-group"]=a.join(",")),A.length>0&&(O.auth=A.join(",")),l.length>0&&(O["target-uuid"]=l.join(",")),(u||0===u)&&(O.ttl=u),O},handleResponse:function(){return{}}});function Jr(n){var e,t,r,i,o=void 0!==n?.authorizedUserId,a=void 0!==(null===(e=n?.resources)||void 0===e?void 0:e.users),s=void 0!==(null===(t=n?.resources)||void 0===t?void 0:t.spaces),l=void 0!==(null===(r=n?.patterns)||void 0===r?void 0:r.users),u=void 0!==(null===(i=n?.patterns)||void 0===i?void 0:i.spaces);return l||a||u||s||o}function De(n){var e=0;return n.join&&(e|=128),n.update&&(e|=64),n.get&&(e|=32),n.delete&&(e|=8),n.manage&&(e|=4),n.write&&(e|=2),n.read&&(e|=1),e}var go=Object.freeze({__proto__:null,getOperation:function(){return J.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var r,i,o,a,s,l,u=e.config;if(!u.subscribeKey)return"Missing Subscribe Key";if(!u.publishKey)return"Missing Publish Key";if(!u.secretKey)return"Missing Secret Key";if(!t.resources&&!t.patterns)return"Missing either Resources or Patterns.";var c=void 0!==t?.authorized_uuid,p=void 0!==(null===(r=t?.resources)||void 0===r?void 0:r.uuids),h=void 0!==(null===(i=t?.resources)||void 0===i?void 0:i.channels),b=void 0!==(null===(o=t?.resources)||void 0===o?void 0:o.groups),y=void 0!==(null===(a=t?.patterns)||void 0===a?void 0:a.uuids),f=void 0!==(null===(s=t?.patterns)||void 0===s?void 0:s.channels),v=void 0!==(null===(l=t?.patterns)||void 0===l?void 0:l.groups),d=c||p||y||h||f||b||v;return Jr(t)&&d?"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:"Missing values for either Resources or Patterns."},postURL:function(e){return"/v3/pam/".concat(e.config.subscribeKey,"/grant")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return function(n,e){if(Jr(e))return function(y,f){var v=f.ttl,d=f.resources,E=f.patterns,j=f.meta,F=f.authorizedUserId,H={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(d){var P=d.users,A=d.spaces,k=d.groups;P&&Object.keys(P).forEach(function(m){H.permissions.resources.uuids[m]=De(P[m])}),A&&Object.keys(A).forEach(function(m){H.permissions.resources.channels[m]=De(A[m])}),k&&Object.keys(k).forEach(function(m){H.permissions.resources.groups[m]=De(k[m])})}if(E){var O=E.users,V=E.spaces,T=E.groups;O&&Object.keys(O).forEach(function(m){H.permissions.patterns.uuids[m]=De(O[m])}),V&&Object.keys(V).forEach(function(m){H.permissions.patterns.channels[m]=De(V[m])}),T&&Object.keys(T).forEach(function(m){H.permissions.patterns.groups[m]=De(T[m])})}return(v||0===v)&&(H.ttl=v),j&&(H.permissions.meta=j),F&&(H.permissions.uuid="".concat(F)),H}(0,e);var t=e.ttl,r=e.resources,i=e.patterns,o=e.meta,a=e.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var l=r.uuids,u=r.channels,c=r.groups;l&&Object.keys(l).forEach(function(y){s.permissions.resources.uuids[y]=De(l[y])}),u&&Object.keys(u).forEach(function(y){s.permissions.resources.channels[y]=De(u[y])}),c&&Object.keys(c).forEach(function(y){s.permissions.resources.groups[y]=De(c[y])})}if(i){var p=i.uuids,h=i.channels,b=i.groups;p&&Object.keys(p).forEach(function(y){s.permissions.patterns.uuids[y]=De(p[y])}),h&&Object.keys(h).forEach(function(y){s.permissions.patterns.channels[y]=De(h[y])}),b&&Object.keys(b).forEach(function(y){s.permissions.patterns.groups[y]=De(b[y])})}return(t||0===t)&&(s.ttl=t),o&&(s.permissions.meta=o),a&&(s.permissions.uuid="".concat(a)),s}(0,t)},handleResponse:function(e,t){return t.data.token}}),mo={getOperation:function(){return J.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:"token can't be empty":"Missing Secret Key"},getURL:function(e,t){return"/v3/pam/".concat(e.config.subscribeKey,"/grant/").concat(oe.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function $r(n,e){var t=JSON.stringify(e);if(n.cryptoModule){var r=n.cryptoModule.encrypt(t);t="string"==typeof r?r:Ot(r),t=JSON.stringify(t)}return t||""}var vo=Object.freeze({__proto__:null,getOperation:function(){return J.PNPublishOperation},validateParams:function(e,t){return t.channel?t.message?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"},usePost:function(e,t){var r=t.sendByPost;return void 0!==r&&r},getURL:function(e,t){var r=e.config,i=t.channel,o=$r(e,t.message);return"/publish/".concat(r.publishKey,"/").concat(r.subscribeKey,"/0/").concat(oe.encodeString(i),"/0/").concat(oe.encodeString(o))},postURL:function(e,t){var r=e.config,i=t.channel;return"/publish/".concat(r.publishKey,"/").concat(r.subscribeKey,"/0/").concat(oe.encodeString(i),"/0")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return $r(e,t.message)},prepareParams:function(e,t){var r=t.meta,i=t.replicate,o=void 0===i||i,a=t.storeInHistory,s=t.ttl,l={};return null!=a&&(l.store=a?"1":"0"),s&&(l.ttl=s),!1===o&&(l.norep="true"),r&&"object"==typeof r&&(l.meta=JSON.stringify(r)),l},handleResponse:function(e,t){return{timetoken:t[2]}}}),bo=Object.freeze({__proto__:null,getOperation:function(){return J.PNSignalOperation},validateParams:function(e,t){return t.channel?t.message?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"},getURL:function(e,t){var i=e.config,o=t.channel,s=JSON.stringify(t.message);return"/signal/".concat(i.publishKey,"/").concat(i.subscribeKey,"/0/").concat(oe.encodeString(o),"/0/").concat(oe.encodeString(s))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}}),_o=Object.freeze({__proto__:null,getOperation:function(){return J.PNHistoryOperation},validateParams:function(e,t){return t.channel?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},getURL:function(e,t){var r=t.channel;return"/v2/history/sub-key/".concat(e.config.subscribeKey,"/channel/").concat(oe.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.start,i=t.end,o=t.reverse,a=t.count,l=t.stringifiedTimeToken,u=void 0!==l&&l,c=t.includeMeta,p=void 0!==c&&c,h={include_token:"true"};return h.count=void 0===a?100:a,r&&(h.start=r),i&&(h.end=i),u&&(h.string_message_token="true"),null!=o&&(h.reverse=o.toString()),p&&(h.include_meta="true"),h},handleResponse:function(e,t){var r={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach(function(i){var o=function(s,l){var u={};if(!s.cryptoModule)return u.payload=l,u;try{var c=s.cryptoModule.decrypt(l),p=c instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(c)):c;return u.payload=p,u}catch(h){s.config.logVerbosity&&console&&console,u.payload=l,u.error="Error while decrypting message content: ".concat(h.message)}return u}(e,i.message),a={timetoken:i.timetoken,entry:o.payload};i.meta&&(a.meta=i.meta),o.error&&(a.error=o.error),r.messages.push(a)}),r}}),So=Object.freeze({__proto__:null,getOperation:function(){return J.PNDeleteMessagesOperation},validateParams:function(e,t){return t.channel?e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},useDelete:function(){return!0},getURL:function(e,t){var r=t.channel;return"/v3/history/sub-key/".concat(e.config.subscribeKey,"/channel/").concat(oe.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.start,i=t.end,o={};return r&&(o.start=r),i&&(o.end=i),o},handleResponse:function(e,t){return t.payload}}),Po=Object.freeze({__proto__:null,getOperation:function(){return J.PNMessageCounts},validateParams:function(e,t){var r=t.channels,o=t.channelTimetokens;return r?t.timetoken&&o?"timetoken and channelTimetokens are incompatible together":o&&o.length>1&&r.length!==o.length?"Length of channelTimetokens and channels do not match":e.config.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},getURL:function(e,t){var i=e.config,o=t.channels.join(",");return"/v3/history/sub-key/".concat(i.subscribeKey,"/message-counts/").concat(oe.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.timetoken,i=t.channelTimetokens,o={};if(i&&1===i.length){var a=D(i,1)[0];o.timetoken=a}else i?o.channelsTimetoken=i.join(","):r&&(o.timetoken=r);return o},handleResponse:function(e,t){return{channels:t.channels}}}),wo=Object.freeze({__proto__:null,getOperation:function(){return J.PNFetchMessagesOperation},validateParams:function(e,t){var r=t.channels,i=t.includeMessageActions;if(!r||0===r.length)return"Missing channels";if(!e.config.subscribeKey)return"Missing Subscribe Key";if(void 0!==i&&i&&r.length>1)throw new TypeError("History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.")},getURL:function(e,t){var r=t.channels,i=void 0===r?[]:r,o=t.includeMessageActions,s=e.config,l=void 0!==o&&o?"history-with-actions":"history",u=i.length>0?i.join(","):",";return"/v3/".concat(l,"/sub-key/").concat(s.subscribeKey,"/channel/").concat(oe.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var i=t.start,o=t.end,l=t.stringifiedTimeToken,u=void 0!==l&&l,c=t.includeMeta,p=void 0!==c&&c,h=t.includeUuid,b=t.includeUUID,y=void 0===b||b,f=t.includeMessageType,v=void 0===f||f,d={};return d.max=t.count||(t.channels.length>1||!0===t.includeMessageActions?25:100),i&&(d.start=i),o&&(d.end=o),u&&(d.string_message_token="true"),p&&(d.include_meta="true"),y&&!1!==h&&(d.include_uuid="true"),v&&(d.include_message_type="true"),d},handleResponse:function(e,t){var r={channels:{}};return Object.keys(t.channels||{}).forEach(function(i){r.channels[i]=[],(t.channels[i]||[]).forEach(function(o){var a={},s=function(l,u){var c={};if(!l.cryptoModule)return c.payload=u,c;try{var p=l.cryptoModule.decrypt(u),h=p instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(p)):p;return c.payload=h,c}catch(b){l.config.logVerbosity&&console&&console,c.payload=u,c.error="Error while decrypting message content: ".concat(b.message)}return c}(e,o.message);a.channel=i,a.timetoken=o.timetoken,a.message=s.payload,a.messageType=o.message_type,a.uuid=o.uuid,o.actions&&(a.actions=o.actions,a.data=o.actions),o.meta&&(a.meta=o.meta),s.error&&(a.error=s.error),r.channels[i].push(a)})}),t.more&&(r.more=t.more),r}}),Oo=Object.freeze({__proto__:null,getOperation:function(){return J.PNTimeOperation},getURL:function(){return"/time/0"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}}),Eo=Object.freeze({__proto__:null,getOperation:function(){return J.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(e,t){var r=e.config,i=t.channels,o=void 0===i?[]:i,a=o.length>0?o.join(","):",";return"/v2/subscribe/".concat(r.subscribeKey,"/").concat(oe.encodeString(a),"/0")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var i=t.state,o=t.channelGroups,a=void 0===o?[]:o,s=t.timetoken,l=t.filterExpression,u=t.region,c={heartbeat:e.config.getPresenceTimeout()};return a.length>0&&(c["channel-group"]=a.join(",")),l&&l.length>0&&(c["filter-expr"]=l),Object.keys(i).length&&(c.state=JSON.stringify(i)),s&&(c.tt=s),u&&(c.tr=u),c},handleResponse:function(e,t){var r=[];return t.m.forEach(function(o){var a={timetoken:o.p.t,region:o.p.r},s={shard:parseInt(o.a,10),subscriptionMatch:o.b,channel:o.c,messageType:o.e,payload:o.d,flags:o.f,issuingClientId:o.i,subscribeKey:o.k,originationTimetoken:o.o,userMetadata:o.u,publishMetaData:a};r.push(s)}),{messages:r,metadata:{timetoken:t.t.t,region:t.t.r}}}}),To={getOperation:function(){return J.PNHandshakeOperation},validateParams:function(e,t){if(!t?.channels&&!t?.channelGroups)return"channels and channleGroups both should not be empty"},getURL:function(e,t){var r=e.config,i=t.channels,o=void 0===i?[]:i,a=o.length>0?o.join(","):",";return"/v2/subscribe/".concat(r.subscribeKey,"/").concat(oe.encodeString(a),"/0")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r={};return t.channelGroups&&t.channelGroups.length>0&&(r["channel-group"]=t.channelGroups.join(",")),r.tt=0,t.state&&(r.state=JSON.stringify(t.state)),t.filterExpression&&t.filterExpression.length>0&&(r["filter-expr"]=t.filterExpression),r.ee="",r},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Co={getOperation:function(){return J.PNReceiveMessagesOperation},validateParams:function(e,t){return t?.channels||t?.channelGroups?t?.timetoken?t?.region?void 0:"region can not be empty":"timetoken can not be empty":"channels and channleGroups both should not be empty"},getURL:function(e,t){var r=e.config,i=t.channels,o=void 0===i?[]:i,a=o.length>0?o.join(","):",";return"/v2/subscribe/".concat(r.subscribeKey,"/").concat(oe.encodeString(a),"/0")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var r={};return t.channelGroups&&t.channelGroups.length>0&&(r["channel-group"]=t.channelGroups.join(",")),t.filterExpression&&t.filterExpression.length>0&&(r["filter-expr"]=t.filterExpression),r.tt=t.timetoken,r.tr=t.region,r.ee="",r},handleResponse:function(e,t){var r=[];return t.m.forEach(function(i){var o={shard:parseInt(i.a,10),subscriptionMatch:i.b,channel:i.c,messageType:i.e,payload:i.d,flags:i.f,issuingClientId:i.i,subscribeKey:i.k,originationTimetoken:i.o,userMetadata:i.u,publishMetaData:{timetoken:i.p.t,region:i.p.r}};r.push(o)}),{messages:r,metadata:{region:t.t.r,timetoken:t.t.t}}}},Qr=function(){function n(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return n.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},n.prototype.notify=function(e){var t=this,r=function(){t.listeners.forEach(function(o){o(e)})};this.sync?r():setTimeout(r,0)},n}(),Ce=function(){function n(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return n.prototype.transition=function(e,t){var r;if(this.transitionMap.has(t.type))return null===(r=this.transitionMap.get(t.type))||void 0===r?void 0:r(e,t)},n.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},n.prototype.with=function(e,t){return[this,e,t??[]]},n.prototype.onEnter=function(e){return this.enterEffects.push(e),this},n.prototype.onExit=function(e){return this.exitEffects.push(e),this},n}(),Xr=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return W(e,n),e.prototype.describe=function(t){return new Ce(t)},e.prototype.start=function(t,r){this.currentState=t,this.currentContext=r,this.notify({type:"engineStarted",state:t,context:r})},e.prototype.transition=function(t){var r,i,o,a,s,l;if(!this.currentState)throw new Error("Start the engine first");this.notify({type:"eventReceived",event:t});var u=this.currentState.transition(this.currentContext,t);if(u){var c=D(u,3),p=c[0],h=c[1],b=c[2];try{for(var y=re(this.currentState.exitEffects),f=y.next();!f.done;f=y.next()){var v=f.value;this.notify({type:"invocationDispatched",invocation:v(this.currentContext)})}}catch(A){r={error:A}}finally{try{f&&!f.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}var d=this.currentState;this.currentState=p;var E=this.currentContext;this.currentContext=h,this.notify({type:"transitionDone",fromState:d,fromContext:E,toState:p,toContext:h,event:t});try{for(var j=re(b),F=j.next();!F.done;F=j.next())this.notify({type:"invocationDispatched",invocation:v=F.value})}catch(A){o={error:A}}finally{try{F&&!F.done&&(a=j.return)&&a.call(j)}finally{if(o)throw o.error}}try{for(var H=re(this.currentState.enterEffects),P=H.next();!P.done;P=H.next())this.notify({type:"invocationDispatched",invocation:(v=P.value)(this.currentContext)})}catch(A){s={error:A}}finally{try{P&&!P.done&&(l=H.return)&&l.call(H)}finally{if(s)throw s.error}}}},e}(Qr),Yr=function(){function n(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return n.prototype.on=function(e,t){this.handlers.set(e,t)},n.prototype.dispatch=function(e){if("CANCEL"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error("Unhandled invocation '".concat(e.type,"'"));var r=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,r),r.start()}else if(this.instances.has(e.payload)){var i=this.instances.get(e.payload);i?.cancel(),this.instances.delete(e.payload)}},n.prototype.dispose=function(){var e,t;try{for(var r=re(this.instances.entries()),i=r.next();!i.done;i=r.next()){var o=D(i.value,2),a=o[0];o[1].cancel(),this.instances.delete(a)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},n}();function be(n,e){var t=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return{type:n,payload:e?.apply(void 0,w([],D(i),!1))}};return t.type=n,t}function Vt(n,e){var t=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return{type:n,payload:e.apply(void 0,w([],D(i),!1)),managed:!1}};return t.type=n,t}function Rt(n,e){var t=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return{type:n,payload:e.apply(void 0,w([],D(i),!1)),managed:!0}};return t.type=n,t.cancel={type:"CANCEL",payload:n,managed:!1},t}var Zr=function(n){function e(){var t=this.constructor,r=n.call(this,"The operation was aborted.")||this;return r.name="AbortError",Object.setPrototypeOf(r,t.prototype),r}return W(e,n),e}(Error),Ro=function(n){function e(){var t=null!==n&&n.apply(this,arguments)||this;return t._aborted=!1,t}return W(e,n),Object.defineProperty(e.prototype,"aborted",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),e.prototype.throwIfAborted=function(){if(this._aborted)throw new Zr},e.prototype.abort=function(){this._aborted=!0,this.notify(new Zr)},e}(Qr),Ao=function(n){function e(t,r,i){var o=n.call(this,t,r)||this;return o.asyncFunction=i,o.abortSignal=new Ro,o}return W(e,n),e.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies).catch(function(t){})},e.prototype.cancel=function(){this.abortSignal.abort()},e}(function(n,e){this.payload=n,this.dependencies=e}),Ge=function(e){return function(t,r){return new Ao(t,r,e)}},rr=Rt("HANDSHAKE",function(n,e){return{channels:n,groups:e}}),ir=Rt("RECEIVE_MESSAGES",function(n,e,t){return{channels:n,groups:e,cursor:t}}),or=Vt("EMIT_MESSAGES",function(n){return n}),Ze=Vt("EMIT_STATUS",function(n){return n}),ar=Rt("RECEIVE_RECONNECT",function(n){return n}),sr=Rt("HANDSHAKE_RECONNECT",function(n){return n}),Le=be("SUBSCRIPTION_CHANGED",function(n,e){return{channels:n,groups:e}}),qe=be("SUBSCRIPTION_RESTORED",function(n,e,t,r){return{channels:n,groups:e,cursor:{timetoken:t,region:r??0}}}),ei=be("HANDSHAKE_SUCCESS",function(n){return n}),ti=be("HANDSHAKE_FAILURE",function(n){return n}),ni=be("HANDSHAKE_RECONNECT_SUCCESS",function(n){return{cursor:n}}),ri=be("HANDSHAKE_RECONNECT_FAILURE",function(n){return n}),ii=be("HANDSHAKE_RECONNECT_GIVEUP",function(n){return n}),oi=be("RECEIVE_SUCCESS",function(n,e){return{cursor:n,events:e}}),ai=be("RECEIVE_FAILURE",function(n){return n}),si=be("RECEIVE_RECONNECT_SUCCESS",function(n,e){return{cursor:n,events:e}}),ui=be("RECEIVE_RECONNECT_FAILURE",function(n){return n}),ci=be("RECEIVING_RECONNECT_GIVEUP",function(n){return n}),Wt=be("DISCONNECT",function(){return{}}),Jt=be("RECONNECT",function(n,e){return{cursor:{timetoken:n??"",region:e??0}}}),ot=be("UNSUBSCRIBE_ALL",function(){return{}}),ko=function(n){function e(t,r){var i=n.call(this,r)||this;return i.on(rr.type,Ge(function(o,a,s){var l=s.handshake,u=s.presenceState,c=s.config;return Y(i,void 0,void 0,function(){var p,h;return q(this,function(b){switch(b.label){case 0:a.throwIfAborted(),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,l(Q({abortSignal:a,channels:o.channels,channelGroups:o.groups,filterExpression:c.filterExpression},c.maintainPresenceState&&{state:u}))];case 2:return p=b.sent(),[2,t.transition(ei(p))];case 3:return(h=b.sent())instanceof Error&&"Aborted"===h.message?[2]:h instanceof ve?[2,t.transition(ti(h))]:[3,4];case 4:return[2]}})})})),i.on(ir.type,Ge(function(o,a,s){var l=s.receiveMessages,u=s.config;return Y(i,void 0,void 0,function(){var c,p;return q(this,function(h){switch(h.label){case 0:a.throwIfAborted(),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,l({abortSignal:a,channels:o.channels,channelGroups:o.groups,timetoken:o.cursor.timetoken,region:o.cursor.region,filterExpression:u.filterExpression})];case 2:return c=h.sent(),t.transition(oi(c.metadata,c.messages)),[3,4];case 3:return(p=h.sent())instanceof Error&&"Aborted"===p.message?[2]:p instanceof ve&&!a.aborted?[2,t.transition(ai(p))]:[3,4];case 4:return[2]}})})})),i.on(or.type,Ge(function(o,a,s){var l=s.emitMessages;return Y(i,void 0,void 0,function(){return q(this,function(u){return o.length>0&&l(o),[2]})})})),i.on(Ze.type,Ge(function(o,a,s){var l=s.emitStatus;return Y(i,void 0,void 0,function(){return q(this,function(u){return l(o),[2]})})})),i.on(ar.type,Ge(function(o,a,s){var l=s.receiveMessages,u=s.delay,c=s.config;return Y(i,void 0,void 0,function(){var p,h;return q(this,function(b){switch(b.label){case 0:return c.retryConfiguration&&c.retryConfiguration.shouldRetry(o.reason,o.attempts)?(a.throwIfAborted(),[4,u(c.retryConfiguration.getDelay(o.attempts,o.reason))]):[3,6];case 1:b.sent(),a.throwIfAborted(),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,l({abortSignal:a,channels:o.channels,channelGroups:o.groups,timetoken:o.cursor.timetoken,region:o.cursor.region,filterExpression:c.filterExpression})];case 3:return p=b.sent(),[2,t.transition(si(p.metadata,p.messages))];case 4:return(h=b.sent())instanceof Error&&"Aborted"===h.message?[2]:h instanceof ve?[2,t.transition(ui(h))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(ci(new ve(c.retryConfiguration.getGiveupReason(o.reason,o.attempts))))];case 7:return[2]}})})})),i.on(sr.type,Ge(function(o,a,s){var l=s.handshake,u=s.delay,c=s.presenceState,p=s.config;return Y(i,void 0,void 0,function(){var h,b;return q(this,function(y){switch(y.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(o.reason,o.attempts)?(a.throwIfAborted(),[4,u(p.retryConfiguration.getDelay(o.attempts,o.reason))]):[3,6];case 1:y.sent(),a.throwIfAborted(),y.label=2;case 2:return y.trys.push([2,4,,5]),[4,l(Q({abortSignal:a,channels:o.channels,channelGroups:o.groups,filterExpression:p.filterExpression},p.maintainPresenceState&&{state:c}))];case 3:return h=y.sent(),[2,t.transition(ni(h))];case 4:return(b=y.sent())instanceof Error&&"Aborted"===b.message?[2]:b instanceof ve?[2,t.transition(ri(b))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(ii(new ve(p.retryConfiguration.getGiveupReason(o.reason,o.attempts))))];case 7:return[2]}})})})),i}return W(e,n),e}(Yr),$t=new Ce("HANDSHAKE_FAILED");$t.on(Le.type,function(n,e){return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:n.cursor})}),$t.on(Jt.type,function(n,e){return Se.with({channels:n.channels,groups:n.groups,cursor:e.payload.cursor||n.cursor})}),$t.on(qe.type,function(n,e){var t,r;return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region?e.payload.cursor.region:null!==(r=null===(t=n?.cursor)||void 0===t?void 0:t.region)&&void 0!==r?r:0}})}),$t.on(ot.type,function(n){return je.with()});var at=new Ce("HANDSHAKE_STOPPED");at.on(Le.type,function(n,e){return at.with({channels:e.payload.channels,groups:e.payload.groups,cursor:n.cursor})}),at.on(Jt.type,function(n,e){return Se.with(Q(Q({},n),{cursor:e.payload.cursor||n.cursor}))}),at.on(qe.type,function(n,e){var t;return at.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region||(null===(t=n?.cursor)||void 0===t?void 0:t.region)||0}})}),at.on(ot.type,function(n){return je.with()});var Qt=new Ce("RECEIVE_FAILED");Qt.on(Jt.type,function(n,e){var t;return Se.with({channels:n.channels,groups:n.groups,cursor:{timetoken:e.payload.cursor.timetoken?null===(t=e.payload.cursor)||void 0===t?void 0:t.timetoken:n.cursor.timetoken,region:e.payload.cursor.region||n.cursor.region}})}),Qt.on(Le.type,function(n,e){return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:n.cursor})}),Qt.on(qe.type,function(n,e){return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region||n.cursor.region}})}),Qt.on(ot.type,function(n){return je.with(void 0)});var st=new Ce("RECEIVE_STOPPED");st.on(Le.type,function(n,e){return st.with({channels:e.payload.channels,groups:e.payload.groups,cursor:n.cursor})}),st.on(qe.type,function(n,e){return st.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region||n.cursor.region}})}),st.on(Jt.type,function(n,e){var t;return Se.with({channels:n.channels,groups:n.groups,cursor:{timetoken:e.payload.cursor.timetoken?null===(t=e.payload.cursor)||void 0===t?void 0:t.timetoken:n.cursor.timetoken,region:e.payload.cursor.region||n.cursor.region}})}),st.on(ot.type,function(){return je.with(void 0)});var Ke=new Ce("RECEIVE_RECONNECTING");Ke.onEnter(function(n){return ar(n)}),Ke.onExit(function(){return ar.cancel}),Ke.on(si.type,function(n,e){return Re.with({channels:n.channels,groups:n.groups,cursor:e.payload.cursor},[or(e.payload.events)])}),Ke.on(ui.type,function(n,e){return Ke.with(Q(Q({},n),{attempts:n.attempts+1,reason:e.payload}))}),Ke.on(ci.type,function(n,e){var t;return Qt.with({groups:n.groups,channels:n.channels,cursor:n.cursor,reason:e.payload},[Ze({category:fe.PNDisconnectedUnexpectedlyCategory,error:null===(t=e.payload)||void 0===t?void 0:t.message})])}),Ke.on(Wt.type,function(n){return st.with({channels:n.channels,groups:n.groups,cursor:n.cursor},[Ze({category:fe.PNDisconnectedCategory})])}),Ke.on(qe.type,function(n,e){return Re.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region||n.cursor.region}})}),Ke.on(Le.type,function(n,e){return Re.with({channels:e.payload.channels,groups:e.payload.groups,cursor:n.cursor})}),Ke.on(ot.type,function(n){return je.with(void 0,[Ze({category:fe.PNDisconnectedCategory})])});var Re=new Ce("RECEIVING");Re.onEnter(function(n){return ir(n.channels,n.groups,n.cursor)}),Re.onExit(function(){return ir.cancel}),Re.on(oi.type,function(n,e){return Re.with({channels:n.channels,groups:n.groups,cursor:e.payload.cursor},[or(e.payload.events)])}),Re.on(Le.type,function(n,e){return 0===e.payload.channels.length&&0===e.payload.groups.length?je.with(void 0):Re.with({cursor:n.cursor,channels:e.payload.channels,groups:e.payload.groups})}),Re.on(qe.type,function(n,e){return 0===e.payload.channels.length&&0===e.payload.groups.length?je.with(void 0):Re.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region||n.cursor.region}})}),Re.on(ai.type,function(n,e){return Ke.with(Q(Q({},n),{attempts:0,reason:e.payload}))}),Re.on(Wt.type,function(n){return st.with({channels:n.channels,groups:n.groups,cursor:n.cursor},[Ze({category:fe.PNDisconnectedCategory})])}),Re.on(ot.type,function(n){return je.with(void 0,[Ze({category:fe.PNDisconnectedCategory})])});var Be=new Ce("HANDSHAKE_RECONNECTING");Be.onEnter(function(n){return sr(n)}),Be.onExit(function(){return sr.cancel}),Be.on(ni.type,function(n,e){var t,r,i={timetoken:null!==(t=n.cursor)&&void 0!==t&&t.timetoken?null===(r=n.cursor)||void 0===r?void 0:r.timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region};return Re.with({channels:n.channels,groups:n.groups,cursor:i},[Ze({category:fe.PNConnectedCategory})])}),Be.on(ri.type,function(n,e){return Be.with(Q(Q({},n),{attempts:n.attempts+1,reason:e.payload}))}),Be.on(ii.type,function(n,e){var t;return $t.with({groups:n.groups,channels:n.channels,cursor:n.cursor,reason:e.payload},[Ze({category:fe.PNConnectionErrorCategory,error:null===(t=e.payload)||void 0===t?void 0:t.message})])}),Be.on(Wt.type,function(n){return at.with({channels:n.channels,groups:n.groups,cursor:n.cursor})}),Be.on(Le.type,function(n,e){return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:n.cursor})}),Be.on(qe.type,function(n,e){var t,r;return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:(null===(t=e.payload.cursor)||void 0===t?void 0:t.region)||(null===(r=n?.cursor)||void 0===r?void 0:r.region)||0}})}),Be.on(ot.type,function(n){return je.with(void 0)});var Se=new Ce("HANDSHAKING");Se.onEnter(function(n){return rr(n.channels,n.groups)}),Se.onExit(function(){return rr.cancel}),Se.on(Le.type,function(n,e){return 0===e.payload.channels.length&&0===e.payload.groups.length?je.with(void 0):Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:n.cursor})}),Se.on(ei.type,function(n,e){var t,r;return Re.with({channels:n.channels,groups:n.groups,cursor:{timetoken:null!==(t=n?.cursor)&&void 0!==t&&t.timetoken?null===(r=n?.cursor)||void 0===r?void 0:r.timetoken:e.payload.timetoken,region:e.payload.region}},[Ze({category:fe.PNConnectedCategory})])}),Se.on(ti.type,function(n,e){return Be.with({channels:n.channels,groups:n.groups,cursor:n.cursor,attempts:0,reason:e.payload})}),Se.on(Wt.type,function(n){return at.with({channels:n.channels,groups:n.groups,cursor:n.cursor})}),Se.on(qe.type,function(n,e){var t;return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:{timetoken:e.payload.cursor.timetoken,region:e.payload.cursor.region||(null===(t=n?.cursor)||void 0===t?void 0:t.region)||0}})}),Se.on(ot.type,function(n){return je.with()});var je=new Ce("UNSUBSCRIBED");je.on(Le.type,function(n,e){return Se.with({channels:e.payload.channels,groups:e.payload.groups})}),je.on(qe.type,function(n,e){return Se.with({channels:e.payload.channels,groups:e.payload.groups,cursor:e.payload.cursor})});var No=function(){function n(e){var t=this;this.engine=new Xr,this.channels=[],this.groups=[],this.dependencies=e,this.dispatcher=new ko(this.engine,e),this._unsubscribeEngine=this.engine.subscribe(function(r){"invocationDispatched"===r.type&&t.dispatcher.dispatch(r.invocation)}),this.engine.start(je,void 0)}return Object.defineProperty(n.prototype,"_engine",{get:function(){return this.engine},enumerable:!1,configurable:!0}),n.prototype.subscribe=function(e){var t=this,r=e.channels,i=e.channelGroups,o=e.timetoken,a=e.withPresence;this.channels=w(w([],D(this.channels),!1),D(r??[]),!1),this.groups=w(w([],D(this.groups),!1),D(i??[]),!1),a&&(this.channels.map(function(s){return t.channels.push("".concat(s,"-pnpres"))}),this.groups.map(function(s){return t.groups.push("".concat(s,"-pnpres"))})),this.engine.transition(o?qe(Array.from(new Set(w(w([],D(this.channels),!1),D(r??[]),!1))),Array.from(new Set(w(w([],D(this.groups),!1),D(i??[]),!1))),o):Le(Array.from(new Set(w(w([],D(this.channels),!1),D(r??[]),!1))),Array.from(new Set(w(w([],D(this.groups),!1),D(i??[]),!1))))),this.dependencies.join&&this.dependencies.join({channels:Array.from(new Set(this.channels.filter(function(s){return!s.endsWith("-pnpres")}))),groups:Array.from(new Set(this.groups.filter(function(s){return!s.endsWith("-pnpres")})))})},n.prototype.unsubscribe=function(e){var t=this,r=e.channels,i=void 0===r?[]:r,o=e.channelGroups,a=void 0===o?[]:o,s=oe.removeSingleOccurance(this.channels,w(w([],D(i),!1),D(i.map(function(p){return"".concat(p,"-pnpres")})),!1)),l=oe.removeSingleOccurance(this.groups,w(w([],D(a),!1),D(a.map(function(p){return"".concat(p,"-pnpres")})),!1));if(new Set(this.channels).size!==new Set(s).size||new Set(this.groups).size!==new Set(l).size){var u=oe.findUniqueCommonElements(this.channels,i),c=oe.findUniqueCommonElements(this.groups,a);this.dependencies.presenceState&&(u?.forEach(function(p){return delete t.dependencies.presenceState[p]}),c?.forEach(function(p){return delete t.dependencies.presenceState[p]})),this.channels=s,this.groups=l,this.engine.transition(Le(Array.from(new Set(this.channels.slice(0))),Array.from(new Set(this.groups.slice(0))))),this.dependencies.leave&&this.dependencies.leave({channels:u.slice(0),groups:c.slice(0)})}},n.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.dependencies.presenceState&&(this.dependencies.presenceState={}),this.engine.transition(Le(this.channels.slice(0),this.groups.slice(0))),this.dependencies.leaveAll&&this.dependencies.leaveAll()},n.prototype.reconnect=function(e){this.engine.transition(Jt(e.timetoken,e.region))},n.prototype.disconnect=function(){this.engine.transition(Wt()),this.dependencies.leaveAll&&this.dependencies.leaveAll()},n.prototype.getSubscribedChannels=function(){return Array.from(new Set(this.channels))},n.prototype.getSubscribedChannelGroups=function(){return Array.from(new Set(this.groups))},n.prototype.dispose=function(){this.disconnect(),this._unsubscribeEngine(),this.dispatcher.dispose()},n}(),li=be("RECONNECT",function(){return{}}),wn=be("DISCONNECT",function(){return{}}),mt=be("JOINED",function(n,e){return{channels:n,groups:e}}),At=be("LEFT",function(n,e){return{channels:n,groups:e}}),kt=be("LEFT_ALL",function(){return{}}),On=be("HEARTBEAT_SUCCESS",function(n){return{statusCode:n}}),En=be("HEARTBEAT_FAILURE",function(n){return n}),pi=be("HEARTBEAT_GIVEUP",function(){return{}}),hi=be("TIMES_UP",function(){return{}}),fi=Vt("HEARTBEAT",function(n,e){return{channels:n,groups:e}}),Ue=Vt("LEAVE",function(n,e){return{channels:n,groups:e}}),Mo=Vt("EMIT_STATUS",function(n){return n}),ur=Rt("WAIT",function(){return{}}),cr=Rt("DELAYED_HEARTBEAT",function(n){return n}),Io=function(n){function e(t,r){var i=n.call(this,r)||this;return i.on(fi.type,Ge(function(o,a,s){var l=s.heartbeat,u=s.presenceState,c=s.config;return Y(i,void 0,void 0,function(){var p;return q(this,function(h){switch(h.label){case 0:return h.trys.push([0,2,,3]),[4,l(Q({channels:o.channels,channelGroups:o.groups},c.maintainPresenceState&&{state:u}))];case 1:return h.sent(),t.transition(On(200)),[3,3];case 2:return(p=h.sent())instanceof ve?[2,t.transition(En(p))]:[3,3];case 3:return[2]}})})})),i.on(Ue.type,Ge(function(o,a,s){var l=s.leave,u=s.config;return Y(i,void 0,void 0,function(){return q(this,function(c){switch(c.label){case 0:if(u.suppressLeaveEvents)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,l({channels:o.channels,channelGroups:o.groups})];case 2:case 3:return c.sent(),[3,4];case 4:return[2]}})})})),i.on(ur.type,Ge(function(o,a,s){var l=s.heartbeatDelay;return Y(i,void 0,void 0,function(){return q(this,function(u){switch(u.label){case 0:return a.throwIfAborted(),[4,l()];case 1:return u.sent(),a.throwIfAborted(),[2,t.transition(hi())]}})})})),i.on(cr.type,Ge(function(o,a,s){var l=s.heartbeat,u=s.retryDelay,c=s.presenceState,p=s.config;return Y(i,void 0,void 0,function(){var h;return q(this,function(b){switch(b.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(o.reason,o.attempts)?(a.throwIfAborted(),[4,u(p.retryConfiguration.getDelay(o.attempts,o.reason))]):[3,6];case 1:b.sent(),a.throwIfAborted(),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,l(Q({channels:o.channels,channelGroups:o.groups},p.maintainPresenceState&&{state:c}))];case 3:return b.sent(),[2,t.transition(On(200))];case 4:return(h=b.sent())instanceof Error&&"Aborted"===h.message?[2]:h instanceof ve?[2,t.transition(En(h))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(pi())];case 7:return[2]}})})})),i.on(Mo.type,Ge(function(o,a,s){var l=s.emitStatus,u=s.config;return Y(i,void 0,void 0,function(){var c;return q(this,function(p){return u.announceFailedHeartbeats&&!0===(null===(c=o?.status)||void 0===c?void 0:c.error)?l(o.status):u.announceSuccessfulHeartbeats&&200===o.statusCode&&l(Q(Q({},o),{operation:J.PNHeartbeatOperation,error:!1})),[2]})})})),i}return W(e,n),e}(Yr),Ve=new Ce("HEARTBEAT_STOPPED");Ve.on(mt.type,function(n,e){return Ve.with({channels:w(w([],D(n.channels),!1),D(e.payload.channels),!1),groups:w(w([],D(n.groups),!1),D(e.payload.groups),!1)})}),Ve.on(At.type,function(n,e){return Ve.with({channels:n.channels.filter(function(t){return!e.payload.channels.includes(t)}),groups:n.groups.filter(function(t){return!e.payload.groups.includes(t)})})}),Ve.on(li.type,function(n,e){return we.with({channels:n.channels,groups:n.groups})}),Ve.on(kt.type,function(n,e){return vt.with(void 0)});var et=new Ce("HEARTBEAT_COOLDOWN");et.onEnter(function(){return ur()}),et.onExit(function(){return ur.cancel}),et.on(hi.type,function(n,e){return we.with({channels:n.channels,groups:n.groups})}),et.on(mt.type,function(n,e){return we.with({channels:w(w([],D(n.channels),!1),D(e.payload.channels),!1),groups:w(w([],D(n.groups),!1),D(e.payload.groups),!1)})}),et.on(At.type,function(n,e){return we.with({channels:n.channels.filter(function(t){return!e.payload.channels.includes(t)}),groups:n.groups.filter(function(t){return!e.payload.groups.includes(t)})},[Ue(e.payload.channels,e.payload.groups)])}),et.on(wn.type,function(n){return Ve.with({channels:n.channels,groups:n.groups},[Ue(n.channels,n.groups)])}),et.on(kt.type,function(n,e){return vt.with(void 0,[Ue(n.channels,n.groups)])});var Nt=new Ce("HEARTBEAT_FAILED");Nt.on(mt.type,function(n,e){return we.with({channels:w(w([],D(n.channels),!1),D(e.payload.channels),!1),groups:w(w([],D(n.groups),!1),D(e.payload.groups),!1)})}),Nt.on(At.type,function(n,e){return we.with({channels:n.channels.filter(function(t){return!e.payload.channels.includes(t)}),groups:n.groups.filter(function(t){return!e.payload.groups.includes(t)})},[Ue(e.payload.channels,e.payload.groups)])}),Nt.on(li.type,function(n,e){return we.with({channels:n.channels,groups:n.groups})}),Nt.on(wn.type,function(n,e){return Ve.with({channels:n.channels,groups:n.groups},[Ue(n.channels,n.groups)])}),Nt.on(kt.type,function(n,e){return vt.with(void 0,[Ue(n.channels,n.groups)])});var He=new Ce("HEARBEAT_RECONNECTING");He.onEnter(function(n){return cr(n)}),He.onExit(function(){return cr.cancel}),He.on(mt.type,function(n,e){return we.with({channels:w(w([],D(n.channels),!1),D(e.payload.channels),!1),groups:w(w([],D(n.groups),!1),D(e.payload.groups),!1)})}),He.on(At.type,function(n,e){return we.with({channels:n.channels.filter(function(t){return!e.payload.channels.includes(t)}),groups:n.groups.filter(function(t){return!e.payload.groups.includes(t)})},[Ue(e.payload.channels,e.payload.groups)])}),He.on(wn.type,function(n,e){Ve.with({channels:n.channels,groups:n.groups},[Ue(n.channels,n.groups)])}),He.on(On.type,function(n,e){return et.with({channels:n.channels,groups:n.groups})}),He.on(En.type,function(n,e){return He.with(Q(Q({},n),{attempts:n.attempts+1,reason:e.payload}))}),He.on(pi.type,function(n,e){return Nt.with({channels:n.channels,groups:n.groups})}),He.on(kt.type,function(n,e){return vt.with(void 0,[Ue(n.channels,n.groups)])});var we=new Ce("HEARTBEATING");we.onEnter(function(n){return fi(n.channels,n.groups)}),we.on(On.type,function(n,e){return et.with({channels:n.channels,groups:n.groups})}),we.on(mt.type,function(n,e){return we.with({channels:w(w([],D(n.channels),!1),D(e.payload.channels),!1),groups:w(w([],D(n.groups),!1),D(e.payload.groups),!1)})}),we.on(At.type,function(n,e){return we.with({channels:n.channels.filter(function(t){return!e.payload.channels.includes(t)}),groups:n.groups.filter(function(t){return!e.payload.groups.includes(t)})},[Ue(e.payload.channels,e.payload.groups)])}),we.on(En.type,function(n,e){return He.with(Q(Q({},n),{attempts:0,reason:e.payload}))}),we.on(wn.type,function(n){return Ve.with({channels:n.channels,groups:n.groups},[Ue(n.channels,n.groups)])}),we.on(kt.type,function(n,e){return vt.with(void 0,[Ue(n.channels,n.groups)])});var vt=new Ce("HEARTBEAT_INACTIVE");vt.on(mt.type,function(n,e){return we.with({channels:e.payload.channels,groups:e.payload.groups})});var jo=function(){function n(e){var t=this;this.engine=new Xr,this.channels=[],this.groups=[],this.dispatcher=new Io(this.engine,e),this.dependencies=e,this._unsubscribeEngine=this.engine.subscribe(function(r){"invocationDispatched"===r.type&&t.dispatcher.dispatch(r.invocation)}),this.engine.start(vt,void 0)}return Object.defineProperty(n.prototype,"_engine",{get:function(){return this.engine},enumerable:!1,configurable:!0}),n.prototype.join=function(e){var t=e.channels,r=e.groups;this.channels=w(w([],D(this.channels),!1),D(t??[]),!1),this.groups=w(w([],D(this.groups),!1),D(r??[]),!1),this.engine.transition(mt(this.channels.slice(0),this.groups.slice(0)))},n.prototype.leave=function(e){var t=this,r=e.channels,i=e.groups;this.dependencies.presenceState&&(r?.forEach(function(o){return delete t.dependencies.presenceState[o]}),i?.forEach(function(o){return delete t.dependencies.presenceState[o]})),this.engine.transition(At(r??[],i??[]))},n.prototype.leaveAll=function(){this.engine.transition(kt())},n.prototype.dispose=function(){this._unsubscribeEngine(),this.dispatcher.dispose()},n}(),di=function(){function n(){}return n.LinearRetryPolicy=function(e){return{delay:e.delay,maximumRetry:e.maximumRetry,shouldRetry:function(r,i){var o;return 403!==(null===(o=r?.status)||void 0===o?void 0:o.statusCode)&&this.maximumRetry>i},getDelay:function(r,i){var o;return 1e3*((null!==(o=i.retryAfter)&&void 0!==o?o:this.delay)+Math.random())},getGiveupReason:function(r,i){var o;return this.maximumRetry<=i?"retry attempts exhaused.":403===(null===(o=r?.status)||void 0===o?void 0:o.statusCode)?"forbidden operation.":"unknown error"}}},n.ExponentialRetryPolicy=function(e){return{minimumDelay:e.minimumDelay,maximumDelay:e.maximumDelay,maximumRetry:e.maximumRetry,shouldRetry:function(r,i){var o;return 403!==(null===(o=r?.status)||void 0===o?void 0:o.statusCode)&&this.maximumRetry>i},getDelay:function(r,i){var o;return 1e3*((null!==(o=i.retryAfter)&&void 0!==o?o:Math.min(Math.pow(2,r),this.maximumDelay))+Math.random())},getGiveupReason:function(r,i){var o;return this.maximumRetry<=i?"retry attempts exhaused.":403===(null===(o=r?.status)||void 0===o?void 0:o.statusCode)?"forbidden operation.":"unknown error"}}},n}(),Do=function(){function n(e){var t=e.modules,r=e.listenerManager,i=e.getFileUrl;this.modules=t,this.listenerManager=r,this.getFileUrl=i,this._channelListenerMap=new Map,this._groupListenerMap=new Map,t.cryptoModule&&(this._decoder=new TextDecoder)}return n.prototype.emitEvent=function(e){var t=e.channel,r=e.publishMetaData,i=e.subscriptionMatch;if(t===i&&(i=null),e.channel.endsWith("-pnpres")){var o={channel:null,subscription:null};t&&(o.channel=t.substring(0,t.lastIndexOf("-pnpres"))),i&&(o.subscription=i.substring(0,i.lastIndexOf("-pnpres"))),o.action=e.payload.action,o.state=e.payload.data,o.timetoken=r.timetoken,o.occupancy=e.payload.occupancy,o.uuid=e.payload.uuid,o.timestamp=e.payload.timestamp,e.payload.join&&(o.join=e.payload.join),e.payload.leave&&(o.leave=e.payload.leave),e.payload.timeout&&(o.timeout=e.payload.timeout),o.actualChannel=null!=i?t:null,o.subscribedChannel=i??t,this.listenerManager.announcePresence(o),this._announce("presence",o,o.channel,o.subscription)}else if(1===e.messageType)(o={channel:null,subscription:null}).channel=t,o.subscription=i,o.timetoken=r.timetoken,o.publisher=e.issuingClientId,e.userMetadata&&(o.userMetadata=e.userMetadata),o.message=e.payload,this.listenerManager.announceSignal(o),this._announce("signal",o,o.channel,o.subscription);else if(2===e.messageType){if((o={channel:null,subscription:null}).channel=t,o.subscription=i,o.timetoken=r.timetoken,o.publisher=e.issuingClientId,e.userMetadata&&(o.userMetadata=e.userMetadata),o.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},this.listenerManager.announceObjects(o),this._announce("objects",o,o.channel,o.subscription),"uuid"===e.payload.type){var a=this._renameChannelField(o),s=Q(Q({},a),{message:Q(Q({},a.message),{event:this._renameEvent(a.message.event),type:"user"})});this.listenerManager.announceUser(s),this._announce("user",s,o.channel,o.subscription)}else if("channel"===e.payload.type){a=this._renameChannelField(o);var l=Q(Q({},a),{message:Q(Q({},a.message),{event:this._renameEvent(a.message.event),type:"space"})});this.listenerManager.announceSpace(l),this._announce("space",l,o.channel,o.subscription)}else if("membership"===e.payload.type){var u=(a=this._renameChannelField(o)).message.data,c=u.uuid,p=u.channel,h=le(u,["uuid","channel"]);h.user=c,h.space=p;var b=Q(Q({},a),{message:Q(Q({},a.message),{event:this._renameEvent(a.message.event),data:h})});this.listenerManager.announceMembership(b),this._announce("membership",b,o.channel,o.subscription)}}else if(3===e.messageType)(o={}).channel=t,o.subscription=i,o.timetoken=r.timetoken,o.publisher=e.issuingClientId,o.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},o.event=e.payload.event,this.listenerManager.announceMessageAction(o),this._announce("messageAction",o,o.channel,o.subscription);else if(4===e.messageType){(o={}).channel=t,o.subscription=i,o.timetoken=r.timetoken,o.publisher=e.issuingClientId;var y=e.payload;if(this.modules.cryptoModule){var f=void 0;try{f=(v=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(v)):v}catch(d){f=null,o.error="Error while decrypting message content: ".concat(d.message)}null!==f&&(y=f)}e.userMetadata&&(o.userMetadata=e.userMetadata),o.message=y.message,o.file={id:y.file.id,name:y.file.name,url:this.getFileUrl({id:y.file.id,name:y.file.name,channel:t})},this.listenerManager.announceFile(o),this._announce("file",o,o.channel,o.subscription)}else{if((o={channel:null,subscription:null}).channel=t,o.subscription=i,o.timetoken=r.timetoken,o.publisher=e.issuingClientId,e.userMetadata&&(o.userMetadata=e.userMetadata),this.modules.cryptoModule){f=void 0;try{var v;f=(v=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(v)):v}catch(d){f=null,o.error="Error while decrypting message content: ".concat(d.message)}o.message=f??e.payload}else o.message=e.payload;o.actualChannel=null!=i?t:null,o.subscribedChannel=i??t,this.listenerManager.announceMessage(o),this._announce("message",o,o.channel,o.subscription)}},n.prototype.addListener=function(e,t,r){var i=this;t&&r?(t?.forEach(function(o){i._channelListenerMap[o]?i._channelListenerMap[o].includes(e)||i._channelListenerMap[o].push(e):i._channelListenerMap[o]=[e]}),r?.forEach(function(o){i._groupListenerMap[o]?i._groupListenerMap[o].includes(e)||i._groupListenerMap[o].push(e):i._groupListenerMap[o]=[e]})):this.listenerManager.addListener(e)},n.prototype.removeListener=function(e,t,r){var i=this;t&&r?(t?.forEach(function(o){var a;i._channelListenerMap[o]=null===(a=i._channelListenerMap[o])||void 0===a?void 0:a.filter(function(s){return s!==e})}),r?.forEach(function(o){var a;i._groupListenerMap[o]=null===(a=i._groupListenerMap[o])||void 0===a?void 0:a.filter(function(s){return s!==e})})):this.listenerManager.removeListener(e)},n.prototype.removeAllListeners=function(){this.listenerManager.removeAllListeners()},n.prototype._renameEvent=function(e){return"set"===e?"updated":"removed"},n.prototype._renameChannelField=function(e){var t=e.channel,r=le(e,["channel"]);return r.spaceId=t,r},n.prototype._announce=function(e,t,r,i){var o,a;null===(o=this._channelListenerMap[r])||void 0===o||o.forEach(function(s){return s[e]&&s[e](t)}),null===(a=this._groupListenerMap[i])||void 0===a||a.forEach(function(s){return s[e]&&s[e](t)})},n}(),yi=function(){function n(){}return n.prototype.subscribe=function(){var e,t;this.pubnub.subscribe(Q({channels:this.channelNames,channelGroups:this.groupNames},(null===(t=null===(e=this.options)||void 0===e?void 0:e.cursor)||void 0===t?void 0:t.timetoken)&&{timetoken:this.options.cursor.timetoken}))},n.prototype.unsubscribe=function(){this.pubnub.unsubscribe({channels:this.channelNames.filter(function(e){return!e.endsWith("-pnpres")}),channelGroups:this.groupNames.filter(function(e){return!e.endsWith("-pnpres")})})},Object.defineProperty(n.prototype,"onMessage",{set:function(t){this.listener.message=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onPresence",{set:function(t){this.listener.presence=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onSignal",{set:function(t){this.listener.signal=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onObjects",{set:function(t){this.listener.objects=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onMessageAction",{set:function(t){this.listener.messageAction=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onFile",{set:function(t){this.listener.file=t},enumerable:!1,configurable:!0}),n.prototype.addListener=function(e){this.eventEmitter.addListener(e,this.channelNames.filter(function(t){return!t.endsWith("-pnpres")}),this.groupNames.filter(function(t){return!t.endsWith("-pnpres")}))},n.prototype.removeListener=function(e){this.eventEmitter.removeListener(e,this.channelNames,this.groupNames)},Object.defineProperty(n.prototype,"channels",{get:function(){return this.channelNames.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"channelGroups",{get:function(){return this.groupNames.slice(0)},enumerable:!1,configurable:!0}),n}(),gi=function(n){function e(t){var r=t.channels,i=void 0===r?[]:r,o=t.channelGroups,a=void 0===o?[]:o,s=t.subscriptionOptions,l=t.eventEmitter,u=t.pubnub,c=n.call(this)||this;return c.channelNames=[],c.groupNames=[],c.subscriptionList=[],c.options=s,c.eventEmitter=l,c.pubnub=u,i.forEach(function(p){var h=c.pubnub.channel(p).subscription(c.options);c.channelNames=w(w([],D(c.channelNames),!1),D(h.channels),!1),c.subscriptionList.push(h)}),a.forEach(function(p){var h=c.pubnub.channelGroup(p).subscription(c.options);c.groupNames=w(w([],D(c.groupNames),!1),D(h.channelGroups),!1),c.subscriptionList.push(h)}),c.listener={},l.addListener(c.listener,c.channelNames.filter(function(p){return!p.endsWith("-pnpres")}),c.groupNames.filter(function(p){return!p.endsWith("-pnpres")})),c}return W(e,n),e.prototype.addSubscription=function(t){this.subscriptionList.push(t),this.channelNames=w(w([],D(this.channelNames),!1),D(t.channels),!1),this.groupNames=w(w([],D(this.groupNames),!1),D(t.channelGroups),!1)},e.prototype.removeSubscription=function(t){var r=t.channels,i=t.channelGroups;this.channelNames=this.channelNames.filter(function(o){return!r.includes(o)}),this.groupNames=this.groupNames.filter(function(o){return!i.includes(o)}),this.subscriptionList=this.subscriptionList.filter(function(o){return o!==t})},e.prototype.addSubscriptionSet=function(t){this.subscriptionList=w(w([],D(this.subscriptionList),!1),D(t.subscriptions),!1),this.channelNames=w(w([],D(this.channelNames),!1),D(t.channels),!1),this.groupNames=w(w([],D(this.groupNames),!1),D(t.channelGroups),!1)},e.prototype.removeSubscriptionSet=function(t){var r=t.channels,i=t.channelGroups;this.channelNames=this.channelNames.filter(function(o){return!r.includes(o)}),this.groupNames=this.groupNames.filter(function(o){return!i.includes(o)}),this.subscriptionList=this.subscriptionList.filter(function(o){return!t.subscriptions.includes(o)})},Object.defineProperty(e.prototype,"subscriptions",{get:function(){return this.subscriptionList.slice(0)},enumerable:!1,configurable:!0}),e}(yi),Tn=function(n){function e(t){var r=t.channels,i=t.channelGroups,o=t.subscriptionOptions,a=t.eventEmitter,s=t.pubnub,l=n.call(this)||this;return l.channelNames=[],l.groupNames=[],l.channelNames=r,l.groupNames=i,l.options=o,l.pubnub=s,l.eventEmitter=a,l.listener={},a.addListener(l.listener,l.channelNames.filter(function(u){return!u.endsWith("-pnpres")}),l.groupNames.filter(function(u){return!u.endsWith("-pnpres")})),l}return W(e,n),e.prototype.addSubscription=function(t){return new gi({channels:w(w([],D(this.channelNames),!1),D(t.channels),!1),channelGroups:w(w([],D(this.groupNames),!1),D(t.channelGroups),!1),subscriptionOptions:Q(Q({},this.options),t?.options),eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(yi),Uo=function(){function n(e,t,r){this.name=e,this.eventEmitter=t,this.pubnub=r}return n.prototype.subscription=function(e){return new Tn({channels:e?.receivePresenceEvents?[this.name,"".concat(this.name,"-pnpres")]:[this.name],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},n}(),xo=function(){function n(e,t,r){this.name=e,this.eventEmitter=t,this.pubnub=r}return n.prototype.subscription=function(e){return new Tn({channels:[],channelGroups:e?.receivePresenceEvents?[this.name,"".concat(this.name,"-pnpres")]:[this.name],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},n}(),Lo=function(){function n(e,t,r){this.id=e,this.eventEmitter=t,this.pubnub=r}return n.prototype.subscription=function(e){return new Tn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},n}(),Fo=function(){function n(e,t,r){this.id=e,this.eventEmitter=t,this.pubnub=r}return n.prototype.subscription=function(e){return new Tn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},n}(),Go=function(){function n(e){var t=this,r=e.networking,i=e.cbor,o=new ze({setup:e});this._config=o;var a=new dt({config:o}),s=e.cryptography;r.init(o);var l=new qn(o,i);this._tokenManager=l;var u=new Hn({maximumSamplesCount:6e4});this._telemetryManager=u;var c=this._config.cryptoModule,p={config:o,networking:r,crypto:a,cryptography:s,tokenManager:l,telemetryManager:u,PubNubFile:e.PubNubFile,cryptoModule:c};this.File=e.PubNubFile,this.encryptFile=function(P,A){return 1==arguments.length&&"string"!=typeof P&&p.cryptoModule?p.cryptoModule.encryptFile(A=P,this.File):s.encryptFile(P,A,this.File)},this.decryptFile=function(P,A){return 1==arguments.length&&"string"!=typeof P&&p.cryptoModule?p.cryptoModule.decryptFile(A=P,this.File):s.decryptFile(P,A,this.File)};var h=ne.bind(this,p,Oo),b=ne.bind(this,p,vn),y=ne.bind(this,p,gt),f=ne.bind(this,p,_n),v=ne.bind(this,p,Eo),d=new ln;if(this._listenerManager=d,this.iAmHere=ne.bind(this,p,gt),this.iAmAway=ne.bind(this,p,vn),this.setPresenceState=ne.bind(this,p,_n),this.handshake=ne.bind(this,p,To),this.receiveMessages=ne.bind(this,p,Co),this._eventEmitter=new Do({modules:p,listenerManager:this._listenerManager,getFileUrl:function(A){return g(p,A)}}),!0===o.enableEventEngine){if(o.maintainPresenceState&&(this.presenceState={},this.setState=function(P){var A,k;return null===(A=P.channels)||void 0===A||A.forEach(function(O){return t.presenceState[O]=P.state}),null===(k=P.channelGroups)||void 0===k||k.forEach(function(O){return t.presenceState[O]=P.state}),t.setPresenceState({channels:P.channels,channelGroups:P.channelGroups,state:t.presenceState})}),o.getHeartbeatInterval()){var E=new jo({heartbeat:this.iAmHere,leave:this.iAmAway,heartbeatDelay:function(){return new Promise(function(A){return setTimeout(A,1e3*p.config.getHeartbeatInterval())})},retryDelay:function(A){return new Promise(function(k){return setTimeout(k,A)})},config:p.config,presenceState:this.presenceState,emitStatus:function(A){d.announceStatus(A)}});this.presenceEventEngine=E,this.join=this.presenceEventEngine.join.bind(E),this.leave=this.presenceEventEngine.leave.bind(E),this.leaveAll=this.presenceEventEngine.leaveAll.bind(E)}var j=new No({handshake:this.handshake,receiveMessages:this.receiveMessages,delay:function(A){return new Promise(function(k){return setTimeout(k,A)})},join:this.join,leave:this.leave,leaveAll:this.leaveAll,presenceState:this.presenceState,config:p.config,emitMessages:function(A){var k,O;try{for(var V=re(A),T=V.next();!T.done;T=V.next())t._eventEmitter.emitEvent(T.value)}catch(C){k={error:C}}finally{try{T&&!T.done&&(O=V.return)&&O.call(V)}finally{if(k)throw k.error}}},emitStatus:function(A){d.announceStatus(A)}});this.subscribe=j.subscribe.bind(j),this.unsubscribe=j.unsubscribe.bind(j),this.unsubscribeAll=j.unsubscribeAll.bind(j),this.reconnect=j.reconnect.bind(j),this.disconnect=j.disconnect.bind(j),this.destroy=j.dispose.bind(j),this.getSubscribedChannels=j.getSubscribedChannels.bind(j),this.getSubscribedChannelGroups=j.getSubscribedChannelGroups.bind(j),this.eventEngine=j}else{var F=new Bn({timeEndpoint:h,leaveEndpoint:b,heartbeatEndpoint:y,setStateEndpoint:f,subscribeEndpoint:v,crypto:p.crypto,config:p.config,listenerManager:d,getFileUrl:function(A){return g(p,A)},cryptoModule:p.cryptoModule,eventEmitter:this._eventEmitter});this.subscribe=F.adaptSubscribeChange.bind(F),this.unsubscribe=F.adaptUnsubscribeChange.bind(F),this.disconnect=F.disconnect.bind(F),this.reconnect=F.reconnect.bind(F),this.unsubscribeAll=F.unsubscribeAll.bind(F),this.getSubscribedChannels=F.getSubscribedChannels.bind(F),this.getSubscribedChannelGroups=F.getSubscribedChannelGroups.bind(F),this.setState=F.adaptStateChange.bind(F),this.presence=F.adaptPresenceChange.bind(F),this.destroy=function(P){F.unsubscribeAll(P),F.disconnect()}}this.addListener=this._eventEmitter.addListener.bind(this._eventEmitter),this.removeListener=this._eventEmitter.removeListener.bind(this._eventEmitter),this.removeAllListeners=this._eventEmitter.removeAllListeners.bind(this._eventEmitter),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:ne.bind(this,p,yn),listChannels:ne.bind(this,p,Jn),addChannels:ne.bind(this,p,dn),removeChannels:ne.bind(this,p,Wn),deleteGroup:ne.bind(this,p,Ct)},this.push={addChannels:ne.bind(this,p,gn),removeChannels:ne.bind(this,p,mn),deleteDevice:ne.bind(this,p,Qn),listChannels:ne.bind(this,p,$n)},this.hereNow=ne.bind(this,p,Yn),this.whereNow=ne.bind(this,p,bn),this.getState=ne.bind(this,p,Xn),this.grant=ne.bind(this,p,fo),this.grantToken=ne.bind(this,p,go),this.audit=ne.bind(this,p,ho),this.revokeToken=ne.bind(this,p,mo),this.publish=ne.bind(this,p,vo),this.fire=function(P,A){return P.replicate=!1,P.storeInHistory=!1,t.publish(P,A)},this.signal=ne.bind(this,p,bo),this.history=ne.bind(this,p,_o),this.deleteMessages=ne.bind(this,p,So),this.messageCounts=ne.bind(this,p,Po),this.fetchMessages=ne.bind(this,p,wo),this.addMessageAction=ne.bind(this,p,Zn),this.removeMessageAction=ne.bind(this,p,Sn),this.getMessageActions=ne.bind(this,p,Pn),this.listFiles=ne.bind(this,p,Vr);var H=ne.bind(this,p,er);this.publishFile=ne.bind(this,p,tr),this.sendFile=function(e){var t=function(r){var i=this,o=r.generateUploadUrl,a=r.publishFile,s=r.modules,l=s.PubNubFile,u=s.config,c=s.cryptography,p=s.cryptoModule,h=s.networking;return function(b){var y=b.channel,f=b.file,v=b.message,d=b.cipherKey,E=b.meta,j=b.ttl,F=b.storeInHistory;return Y(i,void 0,void 0,function(){var H,P,A,k,O,V,T,m,C,X,N,G,K,z,ue,ce,_e,nt,ht,Fe,Xe,co,lo,an,Br,Hr,Fn,zr;return q(this,function(Pe){switch(Pe.label){case 0:if(!y)throw new ve("Validation failed, check status for details",Ye("channel can't be empty"));if(!f)throw new ve("Validation failed, check status for details",Ye("file can't be empty"));return H=l.create(f),[4,o({channel:y,name:H.name})];case 1:return P=Pe.sent(),k=(A=P.file_upload_request).url,O=A.form_fields,T=(V=P.data).id,m=V.name,l.supportsEncryptFile&&(d||p)?null!=d?[3,3]:[4,p.encryptFile(H,l)]:[3,6];case 2:return C=Pe.sent(),[3,5];case 3:return[4,c.encryptFile(d,H,l)];case 4:C=Pe.sent(),Pe.label=5;case 5:H=C,Pe.label=6;case 6:X=O,H.mimeType&&(X=O.map(function(qr){return"Content-Type"===qr.key?{key:qr.key,value:H.mimeType}:qr})),Pe.label=7;case 7:return Pe.trys.push([7,21,,22]),l.supportsFileUri&&f.uri?(K=(G=h).POSTFILE,z=[k,X],[4,H.toFileUri()]):[3,10];case 8:return[4,K.apply(G,z.concat([Pe.sent()]))];case 9:return N=Pe.sent(),[3,20];case 10:return l.supportsFile?(ce=(ue=h).POSTFILE,_e=[k,X],[4,H.toFile()]):[3,13];case 11:return[4,ce.apply(ue,_e.concat([Pe.sent()]))];case 12:return N=Pe.sent(),[3,20];case 13:return l.supportsBuffer?(ht=(nt=h).POSTFILE,Fe=[k,X],[4,H.toBuffer()]):[3,16];case 14:return[4,ht.apply(nt,Fe.concat([Pe.sent()]))];case 15:return N=Pe.sent(),[3,20];case 16:return l.supportsBlob?(co=(Xe=h).POSTFILE,lo=[k,X],[4,H.toBlob()]):[3,19];case 17:return[4,co.apply(Xe,lo.concat([Pe.sent()]))];case 18:return N=Pe.sent(),[3,20];case 19:throw new Error("Unsupported environment");case 20:return[3,22];case 21:throw(an=Pe.sent()).response&&"string"==typeof an.response.text?(Br=/<Message>(.*)<\/Message>/gi.exec(an.response.text),new ve(Br?"Upload to bucket failed: ".concat(Br[1]):"Upload to bucket failed.",an)):new ve("Upload to bucket failed.",an);case 22:if(204!==N.status)throw new ve("Upload to bucket was unsuccessful",N);Hr=u.fileUploadPublishRetryLimit,Fn=!1,zr={timetoken:"0"},Pe.label=23;case 23:return Pe.trys.push([23,25,,26]),[4,a({channel:y,message:v,fileId:T,fileName:m,meta:E,storeInHistory:F,ttl:j})];case 24:return zr=Pe.sent(),Fn=!0,[3,26];case 25:return Pe.sent(),Hr-=1,[3,26];case 26:if(!Fn&&Hr>0)return[3,23];Pe.label=27;case 27:if(Fn)return[2,{timetoken:zr.timetoken,id:T,name:m}];throw new ve("Publish failed. You may want to execute that operation manually using pubnub.publishFile",{channel:y,id:T,name:m})}})})}}(e);return function(r,i){var o=t(r);return"function"==typeof i&&o.then(function(a){return i(null,a)}).catch(function(a){return i(a,null)}),o}}({generateUploadUrl:H,publishFile:this.publishFile,modules:p}),this.getFileUrl=function(P){return g(p,P)},this.downloadFile=ne.bind(this,p,S),this.deleteFile=ne.bind(this,p,R),this.channel=function(P){return new Uo(P,t._eventEmitter,t)},this.channelGroup=function(P){return new xo(P,t._eventEmitter,t)},this.channelMetadata=function(P){return new Lo(P,t._eventEmitter,t)},this.userMetadata=function(P){return new Fo(P,t._eventEmitter,t)},this.subscriptionSet=function(P){return new gi({channels:P.channels,channelGroups:P.channelGroups,subscriptionOptions:P.subscriptionOptions,eventEmitter:t._eventEmitter,pubnub:t})},this.objects={getAllUUIDMetadata:ne.bind(this,p,x),getUUIDMetadata:ne.bind(this,p,U),setUUIDMetadata:ne.bind(this,p,$),removeUUIDMetadata:ne.bind(this,p,Z),getAllChannelMetadata:ne.bind(this,p,ee),getChannelMetadata:ne.bind(this,p,ae),setChannelMetadata:ne.bind(this,p,de),removeChannelMetadata:ne.bind(this,p,Te),getChannelMembers:ne.bind(this,p,Me),setChannelMembers:function(A){for(var k=[],O=1;O<arguments.length;O++)k[O-1]=arguments[O];return ne.call.apply(ne,w([t,p,Ie,Q({type:"set"},A)],D(k),!1))},removeChannelMembers:function(A){for(var k=[],O=1;O<arguments.length;O++)k[O-1]=arguments[O];return ne.call.apply(ne,w([t,p,Ie,Q({type:"delete"},A)],D(k),!1))},getMemberships:ne.bind(this,p,nr),setMemberships:function(A){for(var k=[],O=1;O<arguments.length;O++)k[O-1]=arguments[O];return ne.call.apply(ne,w([t,p,Wr,Q({type:"set"},A)],D(k),!1))},removeMemberships:function(A){for(var k=[],O=1;O<arguments.length;O++)k[O-1]=arguments[O];return ne.call.apply(ne,w([t,p,Wr,Q({type:"delete"},A)],D(k),!1))}},this.createUser=function(P){return t.objects.setUUIDMetadata({uuid:P.userId,data:P.data,include:P.include})},this.updateUser=this.createUser,this.removeUser=function(P){return t.objects.removeUUIDMetadata({uuid:P?.userId})},this.fetchUser=function(P){return t.objects.getUUIDMetadata({uuid:P?.userId,include:P?.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(P){return t.objects.setChannelMetadata({channel:P.spaceId,data:P.data,include:P.include})},this.updateSpace=this.createSpace,this.removeSpace=function(P){return t.objects.removeChannelMetadata({channel:P.spaceId})},this.fetchSpace=function(P){return t.objects.getChannelMetadata({channel:P.spaceId,include:P.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(P){var A,k;return"string"==typeof P.spaceId?t.objects.setChannelMembers({channel:P.spaceId,uuids:null===(A=P.users)||void 0===A?void 0:A.map(function(O){return"string"==typeof O?O:{id:O.userId,custom:O.custom,status:O.status}}),limit:0}):t.objects.setMemberships({uuid:P.userId,channels:null===(k=P.spaces)||void 0===k?void 0:k.map(function(O){return"string"==typeof O?O:{id:O.spaceId,custom:O.custom,status:O.status}}),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(P){return"string"==typeof P.spaceId?t.objects.removeChannelMembers({channel:P.spaceId,uuids:P.userIds,limit:0}):t.objects.removeMemberships({uuid:P.userId,channels:P.spaceIds,limit:0})},this.fetchMemberships=function(P){return"string"==typeof P.spaceId?t.objects.getChannelMembers({channel:P.spaceId,filter:P.filter,limit:P.limit,page:P.page,include:{customFields:P.include.customFields,UUIDFields:P.include.userFields,customUUIDFields:P.include.customUserFields,statusField:P.include.statusField,UUIDStatusField:P.include.userStatusField,UUIDTypeField:P.include.userTypeField,totalCount:P.include.totalCount},sort:null!=P.sort?Object.fromEntries(Object.entries(P.sort).map(function(A){var k=D(A,2),V=k[1];return[k[0].replace("user","uuid"),V]})):null}).then(function(A){var k;return A.data=null===(k=A.data)||void 0===k?void 0:k.map(function(O){return{user:O.uuid,custom:O.custom,updated:O.updated,eTag:O.eTag}}),A}):t.objects.getMemberships({uuid:P.userId,filter:P.filter,limit:P.limit,page:P.page,include:{customFields:P.include.customFields,channelFields:P.include.spaceFields,customChannelFields:P.include.customSpaceFields,statusField:P.include.statusField,channelStatusField:P.include.spaceStatusField,channelTypeField:P.include.spaceTypeField,totalCount:P.include.totalCount},sort:null!=P.sort?Object.fromEntries(Object.entries(P.sort).map(function(A){var k=D(A,2),V=k[1];return[k[0].replace("space","channel"),V]})):null}).then(function(A){var k;return A.data=null===(k=A.data)||void 0===k?void 0:k.map(function(O){return{space:O.channel,custom:O.custom,updated:O.updated,eTag:O.eTag}}),A})},this.time=h,this.stop=this.destroy,this.encrypt=function(P,A){if(void 0===A&&p.cryptoModule){var k=p.cryptoModule.encrypt(P);return"string"==typeof k?k:Ot(k)}return a.encrypt(P,A)},this.decrypt=function(P,A){if(void 0===A&&c){var k=p.cryptoModule.decrypt(P);return k instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(k)):k}return a.decrypt(P,A)},this.getAuthKey=p.config.getAuthKey.bind(p.config),this.setAuthKey=p.config.setAuthKey.bind(p.config),this.getUUID=p.config.getUUID.bind(p.config),this.setUUID=p.config.setUUID.bind(p.config),this.getUserId=p.config.getUserId.bind(p.config),this.setUserId=p.config.setUserId.bind(p.config),this.getFilterExpression=p.config.getFilterExpression.bind(p.config),this.setFilterExpression=p.config.setFilterExpression.bind(p.config),this.setCipherKey=function(P){return p.config.setCipherKey(P,e,p)},this.setHeartbeatInterval=p.config.setHeartbeatInterval.bind(p.config),r.hasModule("proxy")&&(this.setProxy=function(P){p.config.setProxy(P),t.reconnect()})}return n.prototype.getVersion=function(){return this._config.getVersion()},n.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},n.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},n.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},n.notificationPayload=function(e,t){return new zt(e,t)},n.generateUUID=function(){return rt()},n.OPERATIONS=J,n.CATEGORIES=fe,n.LinearRetryPolicy=di.LinearRetryPolicy,n.ExponentialRetryPolicy=di.ExponentialRetryPolicy,n}(),Ko=function(){function n(e){var t=this;this._modules={},Object.keys(e).forEach(function(r){t._modules[r]=e[r].bind(t)})}return n.prototype.init=function(e){this._config=e,this._currentSubDomain=Array.isArray(this._config.origin)?Math.floor(Math.random()*this._config.origin.length):0,this._coreParams={},this.shiftStandardOrigin()},n.prototype.nextOrigin=function(){var e=this._config.secure?"https://":"http://";if("string"==typeof this._config.origin)return"".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return"".concat(e).concat(t)},n.prototype.hasModule=function(e){return e in this._modules},n.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},n.prototype.getStandardOrigin=function(){return this._standardOrigin},n.prototype.POSTFILE=function(e,t,r){return this._modules.postfile(e,t,r)},n.prototype.GETFILE=function(e,t,r){return this._modules.getfile(e,t,r)},n.prototype.POST=function(e,t,r,i){return this._modules.post(e,t,r,i)},n.prototype.PATCH=function(e,t,r,i){return this._modules.patch(e,t,r,i)},n.prototype.GET=function(e,t,r){return this._modules.get(e,t,r)},n.prototype.DELETE=function(e,t,r){return this._modules.del(e,t,r)},n.prototype._detectErrorCategory=function(e){if("ENOTFOUND"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"EAI_AGAIN"===e.code||0===e.status||e.hasOwnProperty("status")&&void 0===e.status)return fe.PNNetworkIssuesCategory;if(e.timeout)return fe.PNTimeoutCategory;if("ETIMEDOUT"===e.code)return fe.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return fe.PNBadRequestCategory;if(e.response.forbidden)return fe.PNAccessDeniedCategory}return fe.PNUnknownCategory},n}();function mi(n){var e=function(i){return i&&"object"==typeof i&&i.constructor===Object};if(!e(n))return n;var t={};return Object.keys(n).forEach(function(r){var s,i="string"==typeof(s=r)||s instanceof String,o=r,a=n[r];Array.isArray(r)||i&&r.indexOf(",")>=0?o=(i?r.split(","):r).reduce(function(s,l){return s+String.fromCharCode(l)},""):(function(s){return"number"==typeof s&&isFinite(s)}(r)||i&&!isNaN(r))&&(o=String.fromCharCode(i?parseInt(r,10):10)),t[o]=e(a)?mi(a):a}),t}var Bo=function(){function n(e,t){this._base64ToBinary=t,this._decode=e}return n.prototype.decodeToken=function(e){var t="";e.length%4==3?t="=":e.length%4==2&&(t="==");var r=e.replace(/-/gi,"+").replace(/_/gi,"/")+t,i=this._decode(this._base64ToBinary(r));if("object"==typeof i)return i},n}(),lr={exports:{}},vi={exports:{}};!function(n){function e(t){if(t)return function(r){for(var i in e.prototype)r[i]=e.prototype[i];return r}(t)}n.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,r){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(r),this},e.prototype.once=function(t,r){function i(){this.off(t,i),r.apply(this,arguments)}return i.fn=r,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,r){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,o=this._callbacks["$"+t];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var a=0;a<o.length;a++)if((i=o[a])===r||i.fn===r){o.splice(a,1);break}return 0===o.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var r=new Array(arguments.length-1),i=this._callbacks["$"+t],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(i){o=0;for(var a=(i=i.slice(0)).length;o<a;++o)i[o].apply(this,r)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}}(vi);var Ho=Xt;Xt.default=Xt,Xt.stable=Si,Xt.stableStringify=Si;var Cn="[...]",bi="[Circular]",bt=[],_t=[];function _i(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Xt(n,e,t,r){var i;void 0===r&&(r=_i()),pr(n,"",0,[],void 0,0,r);try{i=0===_t.length?JSON.stringify(n,e,t):JSON.stringify(n,Pi(e),t)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==bt.length;){var o=bt.pop();4===o.length?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return i}function Mt(n,e,t,r){var i=Object.getOwnPropertyDescriptor(r,t);void 0!==i.get?i.configurable?(Object.defineProperty(r,t,{value:n}),bt.push([r,t,e,i])):_t.push([e,t,n]):(r[t]=n,bt.push([r,t,e]))}function pr(n,e,t,r,i,o,a){var s;if(o+=1,"object"==typeof n&&null!==n){for(s=0;s<r.length;s++)if(r[s]===n)return void Mt(bi,n,e,i);if(void 0!==a.depthLimit&&o>a.depthLimit||void 0!==a.edgesLimit&&t+1>a.edgesLimit)return void Mt(Cn,n,e,i);if(r.push(n),Array.isArray(n))for(s=0;s<n.length;s++)pr(n[s],s,s,r,n,o,a);else{var l=Object.keys(n);for(s=0;s<l.length;s++){var u=l[s];pr(n[u],u,s,r,n,o,a)}}r.pop()}}function zo(n,e){return n<e?-1:n>e?1:0}function Si(n,e,t,r){void 0===r&&(r=_i());var i,o=hr(n,"",0,[],void 0,0,r)||n;try{i=0===_t.length?JSON.stringify(o,e,t):JSON.stringify(o,Pi(e),t)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==bt.length;){var a=bt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return i}function hr(n,e,t,r,i,o,a){var s;if(o+=1,"object"==typeof n&&null!==n){for(s=0;s<r.length;s++)if(r[s]===n)return void Mt(bi,n,e,i);try{if("function"==typeof n.toJSON)return}catch{return}if(void 0!==a.depthLimit&&o>a.depthLimit||void 0!==a.edgesLimit&&t+1>a.edgesLimit)return void Mt(Cn,n,e,i);if(r.push(n),Array.isArray(n))for(s=0;s<n.length;s++)hr(n[s],s,s,r,n,o,a);else{var l={},u=Object.keys(n).sort(zo);for(s=0;s<u.length;s++){var c=u[s];hr(n[c],c,s,r,n,o,a),l[c]=n[c]}if(void 0===i)return l;bt.push([i,e,n]),i[e]=l}r.pop()}}function Pi(n){return n=void 0!==n?n:function(e,t){return t},function(e,t){if(_t.length>0)for(var r=0;r<_t.length;r++){var i=_t[r];if(i[1]===e&&i[0]===t){t=i[2],_t.splice(r,1);break}}return n.call(this,e,t)}}var pe,wi=typeof Symbol<"u"&&Symbol,fr=Array.prototype.slice,Wo=Object.prototype.toString,dr=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==Wo.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var r,i=fr.call(arguments,1),a=Math.max(0,t.length-i.length),s=[],l=0;l<a;l++)s.push("$"+l);if(r=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var p=t.apply(this,i.concat(fr.call(arguments)));return Object(p)===p?p:this}return t.apply(e,i.concat(fr.call(arguments)))}),t.prototype){var u=function(){};u.prototype=t.prototype,r.prototype=new u,u.prototype=null}return r},Qo=dr.call(Function.call,Object.prototype.hasOwnProperty),Yt=SyntaxError,Oi=Function,It=TypeError,yr=function(e){try{return Oi('"use strict"; return ('+e+").constructor;")()}catch{}},St=Object.getOwnPropertyDescriptor;if(St)try{St({},"")}catch{St=null}var gr=function(){throw new It},Xo=St?function(){try{return gr}catch{try{return St(arguments,"callee").get}catch{return gr}}}():gr,jt="function"==typeof wi&&"function"==typeof Symbol&&"symbol"==typeof wi("foo")&&"symbol"==typeof Symbol("bar")&&function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t||"[object Symbol]"!==Object.prototype.toString.call(t)||"[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}(),ut=Object.getPrototypeOf||function(n){return n.__proto__},Dt={},Yo=typeof Uint8Array>"u"?pe:ut(Uint8Array),Ut={"%AggregateError%":typeof AggregateError>"u"?pe:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?pe:ArrayBuffer,"%ArrayIteratorPrototype%":jt?ut([][Symbol.iterator]()):pe,"%AsyncFromSyncIteratorPrototype%":pe,"%AsyncFunction%":Dt,"%AsyncGenerator%":Dt,"%AsyncGeneratorFunction%":Dt,"%AsyncIteratorPrototype%":Dt,"%Atomics%":typeof Atomics>"u"?pe:Atomics,"%BigInt%":typeof BigInt>"u"?pe:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?pe:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?pe:Float32Array,"%Float64Array%":typeof Float64Array>"u"?pe:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?pe:FinalizationRegistry,"%Function%":Oi,"%GeneratorFunction%":Dt,"%Int8Array%":typeof Int8Array>"u"?pe:Int8Array,"%Int16Array%":typeof Int16Array>"u"?pe:Int16Array,"%Int32Array%":typeof Int32Array>"u"?pe:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":jt?ut(ut([][Symbol.iterator]())):pe,"%JSON%":"object"==typeof JSON?JSON:pe,"%Map%":typeof Map>"u"?pe:Map,"%MapIteratorPrototype%":typeof Map<"u"&&jt?ut((new Map)[Symbol.iterator]()):pe,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?pe:Promise,"%Proxy%":typeof Proxy>"u"?pe:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?pe:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?pe:Set,"%SetIteratorPrototype%":typeof Set<"u"&&jt?ut((new Set)[Symbol.iterator]()):pe,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?pe:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":jt?ut(""[Symbol.iterator]()):pe,"%Symbol%":jt?Symbol:pe,"%SyntaxError%":Yt,"%ThrowTypeError%":Xo,"%TypedArray%":Yo,"%TypeError%":It,"%Uint8Array%":typeof Uint8Array>"u"?pe:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?pe:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?pe:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?pe:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?pe:WeakMap,"%WeakRef%":typeof WeakRef>"u"?pe:WeakRef,"%WeakSet%":typeof WeakSet>"u"?pe:WeakSet},Zo=function n(e){var t;if("%AsyncFunction%"===e)t=yr("async function () {}");else if("%GeneratorFunction%"===e)t=yr("function* () {}");else if("%AsyncGeneratorFunction%"===e)t=yr("async function* () {}");else if("%AsyncGenerator%"===e){var r=n("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if("%AsyncIteratorPrototype%"===e){var i=n("%AsyncGenerator%");i&&(t=ut(i.prototype))}return Ut[e]=t,t},Ei={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Rn=dr,An=Qo,ea=Rn.call(Function.call,Array.prototype.concat),ta=Rn.call(Function.apply,Array.prototype.splice),Ti=Rn.call(Function.call,String.prototype.replace),kn=Rn.call(Function.call,String.prototype.slice),na=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ra=/\\(\\)?/g,oa=function(e,t){var r,i=e;if(An(Ei,i)&&(i="%"+(r=Ei[i])[0]+"%"),An(Ut,i)){var o=Ut[i];if(o===Dt&&(o=Zo(i)),void 0===o&&!t)throw new It("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:o}}throw new Yt("intrinsic "+e+" does not exist!")},mr=function(e,t){if("string"!=typeof e||0===e.length)throw new It("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new It('"allowMissing" argument must be a boolean');var r=function(e){var t=kn(e,0,1),r=kn(e,-1);if("%"===t&&"%"!==r)throw new Yt("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new Yt("invalid intrinsic syntax, expected opening `%`");var i=[];return Ti(e,na,function(o,a,s,l){i[i.length]=s?Ti(l,ra,"$1"):a||o}),i}(e),i=r.length>0?r[0]:"",o=oa("%"+i+"%",t),a=o.name,s=o.value,l=!1,u=o.alias;u&&(i=u[0],ta(r,ea([0,1],u)));for(var c=1,p=!0;c<r.length;c+=1){var h=r[c],b=kn(h,0,1),y=kn(h,-1);if(('"'===b||"'"===b||"`"===b||'"'===y||"'"===y||"`"===y)&&b!==y)throw new Yt("property names with quotes must have matching quotes");if("constructor"!==h&&p||(l=!0),An(Ut,a="%"+(i+="."+h)+"%"))s=Ut[a];else if(null!=s){if(!(h in s)){if(!t)throw new It("base intrinsic for "+e+" exists, but the property is not available.");return}if(St&&c+1>=r.length){var f=St(s,h);s=(p=!!f)&&"get"in f&&!("originalValue"in f.get)?f.get:s[h]}else p=An(s,h),s=s[h];p&&!l&&(Ut[a]=s)}}return s},Ci={exports:{}};!function(n){var e=dr,t=mr,r=t("%Function.prototype.apply%"),i=t("%Function.prototype.call%"),o=t("%Reflect.apply%",!0)||e.call(i,r),a=t("%Object.getOwnPropertyDescriptor%",!0),s=t("%Object.defineProperty%",!0),l=t("%Math.max%");if(s)try{s({},"a",{value:1})}catch{s=null}n.exports=function(c){var p=o(e,i,arguments);return a&&s&&a(p,"length").configurable&&s(p,"length",{value:1+l(0,c.length-(arguments.length-1))}),p};var u=function(){return o(e,r,arguments)};s?s(n.exports,"apply",{value:u}):n.exports.apply=u}(Ci);var Ri=mr,Ai=Ci.exports,aa=Ai(Ri("String.prototype.indexOf")),ki=function(n){if(n.__esModule)return n;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(n).forEach(function(t){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}),e}(Object.freeze({__proto__:null,default:{}})),vr="function"==typeof Map&&Map.prototype,br=Object.getOwnPropertyDescriptor&&vr?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Nn=vr&&br&&"function"==typeof br.get?br.get:null,Ni=vr&&Map.prototype.forEach,_r="function"==typeof Set&&Set.prototype,Sr=Object.getOwnPropertyDescriptor&&_r?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Mn=_r&&Sr&&"function"==typeof Sr.get?Sr.get:null,Mi=_r&&Set.prototype.forEach,Zt="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,en="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,Ii="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,sa=Boolean.prototype.valueOf,ua=Object.prototype.toString,ca=Function.prototype.toString,la=String.prototype.match,Pr=String.prototype.slice,ct=String.prototype.replace,pa=String.prototype.toUpperCase,ji=String.prototype.toLowerCase,Di=RegExp.prototype.test,Ui=Array.prototype.concat,We=Array.prototype.join,ha=Array.prototype.slice,xi=Math.floor,wr="function"==typeof BigInt?BigInt.prototype.valueOf:null,Or=Object.getOwnPropertySymbols,Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,xt="function"==typeof Symbol&&"object"==typeof Symbol.iterator,Ae="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol,1)?Symbol.toStringTag:null,Li=Object.prototype.propertyIsEnumerable,Fi=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function Gi(n,e){if(n===1/0||n===-1/0||n!=n||n&&n>-1e3&&n<1e3||Di.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof n){var r=n<0?-xi(-n):xi(n);if(r!==n){var i=String(r),o=Pr.call(e,i.length+1);return ct.call(i,t,"$&_")+"."+ct.call(ct.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ct.call(e,t,"$&_")}var Tr=ki,Ki=Tr.custom,Bi=qi(Ki)?Ki:null;function Hi(n,e,t){var r="double"===(t.quoteStyle||e)?'"':"'";return r+n+r}function fa(n){return ct.call(String(n),/"/g,"&quot;")}function Cr(n){return!("[object Array]"!==pt(n)||Ae&&"object"==typeof n&&Ae in n)}function zi(n){return!("[object RegExp]"!==pt(n)||Ae&&"object"==typeof n&&Ae in n)}function qi(n){if(xt)return n&&"object"==typeof n&&n instanceof Symbol;if("symbol"==typeof n)return!0;if(!n||"object"!=typeof n||!Er)return!1;try{return Er.call(n),!0}catch{}return!1}var da=Object.prototype.hasOwnProperty||function(n){return n in this};function lt(n,e){return da.call(n,e)}function pt(n){return ua.call(n)}function Vi(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t;return-1}function Wi(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,r="... "+t+" more character"+(t>1?"s":"");return Wi(Pr.call(n,0,e.maxStringLength),e)+r}return Hi(ct.call(ct.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,ya),"single",e)}function ya(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+pa.call(e.toString(16))}function tn(n){return"Object("+n+")"}function Rr(n){return n+" { ? }"}function Ji(n,e,t,r){return n+" ("+e+") {"+(r?Ar(t,r):We.call(t,", "))+"}"}function Ar(n,e){if(0===n.length)return"";var t="\n"+e.prev+e.base;return t+We.call(n,","+t)+"\n"+e.prev}function In(n,e){var t=Cr(n),r=[];if(t){r.length=n.length;for(var i=0;i<n.length;i++)r[i]=lt(n,i)?e(n[i],n):""}var o,a="function"==typeof Or?Or(n):[];if(xt){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var l in n)lt(n,l)&&(t&&String(Number(l))===l&&l<n.length||xt&&o["$"+l]instanceof Symbol||(Di.call(/[^\w$]/,l)?r.push(e(l,n)+": "+e(n[l],n)):r.push(l+": "+e(n[l],n))));if("function"==typeof Or)for(var u=0;u<a.length;u++)Li.call(n,a[u])&&r.push("["+e(a[u])+"]: "+e(n[a[u]],n));return r}var kr=mr,Lt=function(e,t){var r=Ri(e,!!t);return"function"==typeof r&&aa(e,".prototype.")>-1?Ai(r):r},ga=function n(e,t,r,i){var o=t||{};if(lt(o,"quoteStyle")&&"single"!==o.quoteStyle&&"double"!==o.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(lt(o,"maxStringLength")&&("number"==typeof o.maxStringLength?o.maxStringLength<0&&o.maxStringLength!==1/0:null!==o.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=!lt(o,"customInspect")||o.customInspect;if("boolean"!=typeof a&&"symbol"!==a)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(lt(o,"indent")&&null!==o.indent&&"\t"!==o.indent&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(lt(o,"numericSeparator")&&"boolean"!=typeof o.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var s=o.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return Wi(e,o);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var l=String(e);return s?Gi(e,l):l}if("bigint"==typeof e){var u=String(e)+"n";return s?Gi(e,u):u}var c=void 0===o.depth?5:o.depth;if(void 0===r&&(r=0),r>=c&&c>0&&"object"==typeof e)return Cr(e)?"[Array]":"[Object]";var m,p=function(m,C){var X;if("\t"===m.indent)X="\t";else{if(!("number"==typeof m.indent&&m.indent>0))return null;X=We.call(Array(m.indent+1)," ")}return{base:X,prev:We.call(Array(C+1),X)}}(o,r);if(void 0===i)i=[];else if(Vi(i,e)>=0)return"[Circular]";function h(m,C,X){if(C&&(i=ha.call(i)).push(C),X){var N={depth:o.depth};return lt(o,"quoteStyle")&&(N.quoteStyle=o.quoteStyle),n(m,N,r+1,i)}return n(m,o,r+1,i)}if("function"==typeof e&&!zi(e)){var b=function(m){if(m.name)return m.name;var C=la.call(ca.call(m),/^function\s*([\w$]+)/);return C?C[1]:null}(e),y=In(e,h);return"[Function"+(b?": "+b:" (anonymous)")+"]"+(y.length>0?" { "+We.call(y,", ")+" }":"")}if(qi(e)){var f=xt?ct.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Er.call(e);return"object"!=typeof e||xt?f:tn(f)}if((m=e)&&"object"==typeof m&&(typeof HTMLElement<"u"&&m instanceof HTMLElement||"string"==typeof m.nodeName&&"function"==typeof m.getAttribute)){for(var v="<"+ji.call(String(e.nodeName)),d=e.attributes||[],E=0;E<d.length;E++)v+=" "+d[E].name+"="+Hi(fa(d[E].value),"double",o);return v+=">",e.childNodes&&e.childNodes.length&&(v+="..."),v+"</"+ji.call(String(e.nodeName))+">"}if(Cr(e)){if(0===e.length)return"[]";var j=In(e,h);return p&&!function(m){for(var C=0;C<m.length;C++)if(Vi(m[C],"\n")>=0)return!1;return!0}(j)?"["+Ar(j,p)+"]":"[ "+We.call(j,", ")+" ]"}if(function(m){return!("[object Error]"!==pt(m)||Ae&&"object"==typeof m&&Ae in m)}(e)){var F=In(e,h);return"cause"in Error.prototype||!("cause"in e)||Li.call(e,"cause")?0===F.length?"["+String(e)+"]":"{ ["+String(e)+"] "+We.call(F,", ")+" }":"{ ["+String(e)+"] "+We.call(Ui.call("[cause]: "+h(e.cause),F),", ")+" }"}if("object"==typeof e&&a){if(Bi&&"function"==typeof e[Bi]&&Tr)return Tr(e,{depth:c-r});if("symbol"!==a&&"function"==typeof e.inspect)return e.inspect()}if(function(m){if(!Nn||!m||"object"!=typeof m)return!1;try{Nn.call(m);try{Mn.call(m)}catch{return!0}return m instanceof Map}catch{}return!1}(e)){var H=[];return Ni&&Ni.call(e,function(m,C){H.push(h(C,e,!0)+" => "+h(m,e))}),Ji("Map",Nn.call(e),H,p)}if(function(m){if(!Mn||!m||"object"!=typeof m)return!1;try{Mn.call(m);try{Nn.call(m)}catch{return!0}return m instanceof Set}catch{}return!1}(e)){var P=[];return Mi&&Mi.call(e,function(m){P.push(h(m,e))}),Ji("Set",Mn.call(e),P,p)}if(function(m){if(!Zt||!m||"object"!=typeof m)return!1;try{Zt.call(m,Zt);try{en.call(m,en)}catch{return!0}return m instanceof WeakMap}catch{}return!1}(e))return Rr("WeakMap");if(function(m){if(!en||!m||"object"!=typeof m)return!1;try{en.call(m,en);try{Zt.call(m,Zt)}catch{return!0}return m instanceof WeakSet}catch{}return!1}(e))return Rr("WeakSet");if(function(m){if(!Ii||!m||"object"!=typeof m)return!1;try{return Ii.call(m),!0}catch{}return!1}(e))return Rr("WeakRef");if(function(m){return!("[object Number]"!==pt(m)||Ae&&"object"==typeof m&&Ae in m)}(e))return tn(h(Number(e)));if(function(m){if(!m||"object"!=typeof m||!wr)return!1;try{return wr.call(m),!0}catch{}return!1}(e))return tn(h(wr.call(e)));if(function(m){return!("[object Boolean]"!==pt(m)||Ae&&"object"==typeof m&&Ae in m)}(e))return tn(sa.call(e));if(function(m){return!("[object String]"!==pt(m)||Ae&&"object"==typeof m&&Ae in m)}(e))return tn(h(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===M)return"{ [object globalThis] }";if(!function(m){return!("[object Date]"!==pt(m)||Ae&&"object"==typeof m&&Ae in m)}(e)&&!zi(e)){var A=In(e,h),k=Fi?Fi(e)===Object.prototype:e instanceof Object||e.constructor===Object,O=e instanceof Object?"":"null prototype",V=!k&&Ae&&Object(e)===e&&Ae in e?Pr.call(pt(e),8,-1):O?"Object":"",T=(k||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(V||O?"["+We.call(Ui.call([],V||[],O||[]),": ")+"] ":"");return 0===A.length?T+"{}":p?T+"{"+Ar(A,p)+"}":T+"{ "+We.call(A,", ")+" }"}return String(e)},ma=kr("%TypeError%"),jn=kr("%WeakMap%",!0),Dn=kr("%Map%",!0),va=Lt("WeakMap.prototype.get",!0),ba=Lt("WeakMap.prototype.set",!0),_a=Lt("WeakMap.prototype.has",!0),Sa=Lt("Map.prototype.get",!0),Pa=Lt("Map.prototype.set",!0),wa=Lt("Map.prototype.has",!0),Nr=function(e,t){for(var r,i=e;null!==(r=i.next);i=r)if(r.key===t)return i.next=r.next,r.next=e.next,e.next=r,r},Oa=String.prototype.replace,Ea=/%20/g,$i="RFC3986",Mr={default:$i,formatters:{RFC1738:function(e){return Oa.call(e,Ea,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:$i},Ta=Mr,Ir=Object.prototype.hasOwnProperty,Pt=Array.isArray,Je=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),Qi=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(r[i]=e[i]);return r},Xi={arrayToObject:Qi,assign:function(e,t){return Object.keys(t).reduce(function(r,i){return r[i]=t[i],r},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var o=t[i],a=o.obj[o.prop],s=Object.keys(a),l=0;l<s.length;++l){var u=s[l],c=a[u];"object"==typeof c&&null!==c&&-1===r.indexOf(c)&&(t.push({obj:a,prop:u}),r.push(c))}return function(p){for(;p.length>1;){var h=p.pop(),b=h.obj[h.prop];if(Pt(b)){for(var y=[],f=0;f<b.length;++f)void 0!==b[f]&&y.push(b[f]);h.obj[h.prop]=y}}}(t),e},decode:function(e,t,r){var i=e.replace(/\+/g," ");if("iso-8859-1"===r)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},encode:function(e,t,r,i,o){if(0===e.length)return e;var a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var s="",l=0;l<a.length;++l){var u=a.charCodeAt(l);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===Ta.RFC1738&&(40===u||41===u)?s+=a.charAt(l):u<128?s+=Je[u]:u<2048?s+=Je[192|u>>6]+Je[128|63&u]:u<55296||u>=57344?s+=Je[224|u>>12]+Je[128|u>>6&63]+Je[128|63&u]:(u=65536+((1023&u)<<10|1023&a.charCodeAt(l+=1)),s+=Je[240|u>>18]+Je[128|u>>12&63]+Je[128|u>>6&63]+Je[128|63&u])}return s},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(Pt(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)},merge:function n(e,t,r){if(!t)return e;if("object"!=typeof t){if(Pt(e))e.push(t);else{if(!e||"object"!=typeof e)return[e,t];(r&&(r.plainObjects||r.allowPrototypes)||!Ir.call(Object.prototype,t))&&(e[t]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(t);var i=e;return Pt(e)&&!Pt(t)&&(i=Qi(e,r)),Pt(e)&&Pt(t)?(t.forEach(function(o,a){if(Ir.call(e,a)){var s=e[a];s&&"object"==typeof s&&o&&"object"==typeof o?e[a]=n(s,o,r):e.push(o)}else e[a]=o}),e):Object.keys(t).reduce(function(o,a){var s=t[a];return o[a]=Ir.call(o,a)?n(o[a],s,r):s,o},i)}},Yi=function(){var e,t,r,i={assert:function(a){if(!i.has(a))throw new ma("Side channel does not contain "+ga(a))},get:function(a){if(jn&&a&&("object"==typeof a||"function"==typeof a)){if(e)return va(e,a)}else if(Dn){if(t)return Sa(t,a)}else if(r)return(u=Nr(r,a))&&u.value;var u},has:function(a){if(jn&&a&&("object"==typeof a||"function"==typeof a)){if(e)return _a(e,a)}else if(Dn){if(t)return wa(t,a)}else if(r)return!!Nr(r,a);return!1},set:function(a,s){var l,u,c,p;jn&&a&&("object"==typeof a||"function"==typeof a)?(e||(e=new jn),ba(e,a,s)):Dn?(t||(t=new Dn),Pa(t,a,s)):(r||(r={key:{},next:null}),c=s,(p=Nr(l=r,u=a))?p.value=c:l.next={key:u,next:l.next,value:c})}};return i},Un=Xi,nn=Mr,Ca=Object.prototype.hasOwnProperty,Zi={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},tt=Array.isArray,Ra=Array.prototype.push,eo=function(e,t){Ra.apply(e,tt(t)?t:[t])},Aa=Date.prototype.toISOString,to=nn.default,ke={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Un.encode,encodeValuesOnly:!1,format:to,formatter:nn.formatters[to],indices:!1,serializeDate:function(e){return Aa.call(e)},skipNulls:!1,strictNullHandling:!1},jr={},ka=function n(e,t,r,i,o,a,s,l,u,c,p,h,b,y,f,v){for(var d,E=e,j=v,F=0,H=!1;void 0!==(j=j.get(jr))&&!H;){var P=j.get(e);if(F+=1,void 0!==P){if(P===F)throw new RangeError("Cyclic object value");H=!0}void 0===j.get(jr)&&(F=0)}if("function"==typeof l?E=l(t,E):E instanceof Date?E=p(E):"comma"===r&&tt(E)&&(E=Un.maybeMap(E,function(G){return G instanceof Date?p(G):G})),null===E){if(o)return s&&!y?s(t,ke.encoder,f,"key",h):t;E=""}if("string"==typeof(d=E)||"number"==typeof d||"boolean"==typeof d||"symbol"==typeof d||"bigint"==typeof d||Un.isBuffer(E))return s?[b(y?t:s(t,ke.encoder,f,"key",h))+"="+b(s(E,ke.encoder,f,"value",h))]:[b(t)+"="+b(String(E))];var A,k=[];if(void 0===E)return k;if("comma"===r&&tt(E))y&&s&&(E=Un.maybeMap(E,s)),A=[{value:E.length>0?E.join(",")||null:void 0}];else if(tt(l))A=l;else{var O=Object.keys(E);A=u?O.sort(u):O}for(var V=i&&tt(E)&&1===E.length?t+"[]":t,T=0;T<A.length;++T){var m=A[T],C="object"==typeof m&&void 0!==m.value?m.value:E[m];if(!a||null!==C){var X=tt(E)?"function"==typeof r?r(V,m):V:V+(c?"."+m:"["+m+"]");v.set(e,F);var N=Yi();N.set(jr,v),eo(k,n(C,X,r,i,o,a,"comma"===r&&y&&tt(E)?null:s,l,u,c,p,h,b,y,f,N))}}return k},Ft=Xi,Dr=Object.prototype.hasOwnProperty,Na=Array.isArray,Oe={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Ft.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ma=function(e){return e.replace(/&#(\d+);/g,function(t,r){return String.fromCharCode(parseInt(r,10))})},no=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},Ia=function(e,t,r,i){if(e){var o=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(o),l=s?o.slice(0,s.index):o,u=[];if(l){if(!r.plainObjects&&Dr.call(Object.prototype,l)&&!r.allowPrototypes)return;u.push(l)}for(var c=0;r.depth>0&&null!==(s=a.exec(o))&&c<r.depth;){if(c+=1,!r.plainObjects&&Dr.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(s[1])}return s&&u.push("["+o.slice(s.index)+"]"),function(p,h,b,y){for(var f=y?h:no(h,b),v=p.length-1;v>=0;--v){var d,E=p[v];if("[]"===E&&b.parseArrays)d=[].concat(f);else{d=b.plainObjects?Object.create(null):{};var j="["===E.charAt(0)&&"]"===E.charAt(E.length-1)?E.slice(1,-1):E,F=parseInt(j,10);b.parseArrays||""!==j?!isNaN(F)&&E!==j&&String(F)===j&&F>=0&&b.parseArrays&&F<=b.arrayLimit?(d=[])[F]=f:"__proto__"!==j&&(d[j]=f):d={0:f}}f=d}return f}(u,t,r,i)}},Da={formats:Mr,parse:function(e,t){var r=function(c){if(!c)return Oe;if(null!=c.decoder&&"function"!=typeof c.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==c.charset&&"utf-8"!==c.charset&&"iso-8859-1"!==c.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");return{allowDots:void 0===c.allowDots?Oe.allowDots:!!c.allowDots,allowPrototypes:"boolean"==typeof c.allowPrototypes?c.allowPrototypes:Oe.allowPrototypes,allowSparse:"boolean"==typeof c.allowSparse?c.allowSparse:Oe.allowSparse,arrayLimit:"number"==typeof c.arrayLimit?c.arrayLimit:Oe.arrayLimit,charset:void 0===c.charset?Oe.charset:c.charset,charsetSentinel:"boolean"==typeof c.charsetSentinel?c.charsetSentinel:Oe.charsetSentinel,comma:"boolean"==typeof c.comma?c.comma:Oe.comma,decoder:"function"==typeof c.decoder?c.decoder:Oe.decoder,delimiter:"string"==typeof c.delimiter||Ft.isRegExp(c.delimiter)?c.delimiter:Oe.delimiter,depth:"number"==typeof c.depth||!1===c.depth?+c.depth:Oe.depth,ignoreQueryPrefix:!0===c.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof c.interpretNumericEntities?c.interpretNumericEntities:Oe.interpretNumericEntities,parameterLimit:"number"==typeof c.parameterLimit?c.parameterLimit:Oe.parameterLimit,parseArrays:!1!==c.parseArrays,plainObjects:"boolean"==typeof c.plainObjects?c.plainObjects:Oe.plainObjects,strictNullHandling:"boolean"==typeof c.strictNullHandling?c.strictNullHandling:Oe.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var i="string"==typeof e?function(c,p){var h,b={__proto__:null},v=(p.ignoreQueryPrefix?c.replace(/^\?/,""):c).split(p.delimiter,p.parameterLimit===1/0?void 0:p.parameterLimit),d=-1,E=p.charset;if(p.charsetSentinel)for(h=0;h<v.length;++h)0===v[h].indexOf("utf8=")&&("utf8=%E2%9C%93"===v[h]?E="utf-8":"utf8=%26%2310003%3B"===v[h]&&(E="iso-8859-1"),d=h,h=v.length);for(h=0;h<v.length;++h)if(h!==d){var j,F,H=v[h],P=H.indexOf("]="),A=-1===P?H.indexOf("="):P+1;-1===A?(j=p.decoder(H,Oe.decoder,E,"key"),F=p.strictNullHandling?null:""):(j=p.decoder(H.slice(0,A),Oe.decoder,E,"key"),F=Ft.maybeMap(no(H.slice(A+1),p),function(k){return p.decoder(k,Oe.decoder,E,"value")})),F&&p.interpretNumericEntities&&"iso-8859-1"===E&&(F=Ma(F)),H.indexOf("[]=")>-1&&(F=Na(F)?[F]:F),b[j]=Dr.call(b,j)?Ft.combine(b[j],F):F}return b}(e,r):e,o=r.plainObjects?Object.create(null):{},a=Object.keys(i),s=0;s<a.length;++s){var l=a[s],u=Ia(l,i[l],r,"string"==typeof e);o=Ft.merge(o,u,r)}return!0===r.allowSparse?o:Ft.compact(o)},stringify:function(e,t){var r,i=e,o=function(f){if(!f)return ke;if(null!=f.encoder&&"function"!=typeof f.encoder)throw new TypeError("Encoder has to be a function.");var v=f.charset||ke.charset;if(void 0!==f.charset&&"utf-8"!==f.charset&&"iso-8859-1"!==f.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var d=nn.default;if(void 0!==f.format){if(!Ca.call(nn.formatters,f.format))throw new TypeError("Unknown format option provided.");d=f.format}var E=nn.formatters[d],j=ke.filter;return("function"==typeof f.filter||tt(f.filter))&&(j=f.filter),{addQueryPrefix:"boolean"==typeof f.addQueryPrefix?f.addQueryPrefix:ke.addQueryPrefix,allowDots:void 0===f.allowDots?ke.allowDots:!!f.allowDots,charset:v,charsetSentinel:"boolean"==typeof f.charsetSentinel?f.charsetSentinel:ke.charsetSentinel,delimiter:void 0===f.delimiter?ke.delimiter:f.delimiter,encode:"boolean"==typeof f.encode?f.encode:ke.encode,encoder:"function"==typeof f.encoder?f.encoder:ke.encoder,encodeValuesOnly:"boolean"==typeof f.encodeValuesOnly?f.encodeValuesOnly:ke.encodeValuesOnly,filter:j,format:d,formatter:E,serializeDate:"function"==typeof f.serializeDate?f.serializeDate:ke.serializeDate,skipNulls:"boolean"==typeof f.skipNulls?f.skipNulls:ke.skipNulls,sort:"function"==typeof f.sort?f.sort:null,strictNullHandling:"boolean"==typeof f.strictNullHandling?f.strictNullHandling:ke.strictNullHandling}}(t);"function"==typeof o.filter?i=(0,o.filter)("",i):tt(o.filter)&&(r=o.filter);var s=[];if("object"!=typeof i||null===i)return"";var l=Zi[t&&t.arrayFormat in Zi?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices"];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var u="comma"===l&&t&&t.commaRoundTrip;r||(r=Object.keys(i)),o.sort&&r.sort(o.sort);for(var c=Yi(),p=0;p<r.length;++p){var h=r[p];o.skipNulls&&null===i[h]||eo(s,ka(i[h],h,l,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var b=s.join(o.delimiter),y=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&(y+="iso-8859-1"===o.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),b.length>0?y+b:""}},wt={};!function(n){function e(r,i){var o=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!o){if(Array.isArray(r)||(o=function(p,h){if(p){if("string"==typeof p)return t(p,h);var b=Object.prototype.toString.call(p).slice(8,-1);if("Object"===b&&p.constructor&&(b=p.constructor.name),"Map"===b||"Set"===b)return Array.from(p);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return t(p,h)}}(r))||i&&r&&"number"==typeof r.length){o&&(r=o);var a=0,s=function(){};return{s,n:function(){return a>=r.length?{done:!0}:{done:!1,value:r[a++]}},e:function(h){throw h},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=!0,c=!1;return{s:function(){o=o.call(r)},n:function(){var h=o.next();return u=h.done,h},e:function(h){c=!0,l=h},f:function(){try{u||null==o.return||o.return()}finally{if(c)throw l}}}}function t(r,i){(null==i||i>r.length)&&(i=r.length);for(var o=0,a=new Array(i);o<i;o++)a[o]=r[o];return a}n.type=function(r){return r.split(/ *; */).shift()},n.params=function(r){var o,i={},a=e(r.split(/ *; */));try{for(a.s();!(o=a.n()).done;){var s=o.value.split(/ *= */),l=s.shift(),u=s.shift();l&&u&&(i[l]=u)}}catch(c){a.e(c)}finally{a.f()}return i},n.parseLinks=function(r){var o,i={},a=e(r.split(/ *, */));try{for(a.s();!(o=a.n()).done;){var s=o.value.split(/ *; */),l=s[0].slice(1,-1);i[s[1].split(/ *= */)[1].slice(1,-1)]=l}}catch(u){a.e(u)}finally{a.f()}return i},n.cleanHeader=function(r,i){return delete r["content-type"],delete r["content-length"],delete r["transfer-encoding"],delete r.host,i&&(delete r.authorization,delete r.cookie),r},n.isObject=function(r){return null!==r&&"object"==typeof r},n.hasOwn=Object.hasOwn||function(r,i){if(null==r)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(new Object(r),i)},n.mixin=function(r,i){for(var o in i)n.hasOwn(i,o)&&(r[o]=i[o])}}(wt);var ro=ki,xn=wt.isObject,rn=wt.hasOwn,Ua=he;function he(){}he.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},he.prototype.parse=function(n){return this._parser=n,this},he.prototype.responseType=function(n){return this._responseType=n,this},he.prototype.serialize=function(n){return this._serializer=n,this},he.prototype.timeout=function(n){if(!n||"object"!=typeof n)return this._timeout=n,this._responseTimeout=0,this._uploadTimeout=0,this;for(var e in n)if(rn(n,e))switch(e){case"deadline":this._timeout=n.deadline;break;case"response":this._responseTimeout=n.response;break;case"upload":this._uploadTimeout=n.upload}return this},he.prototype.retry=function(n,e){return 0!==arguments.length&&!0!==n||(n=1),n<=0&&(n=0),this._maxRetries=n,this._retries=0,this._retryCallback=e,this};var xa=new Set(["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]),La=new Set([408,413,429,500,502,503,504,521,522,524]);he.prototype._shouldRetry=function(n,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var t=this._retryCallback(n,e);if(!0===t)return!0;if(!1===t)return!1}catch(r){}return!!(e&&e.status&&La.has(e.status)||n&&(n.code&&xa.has(n.code)||n.timeout&&"ECONNABORTED"===n.code||n.crossDomain))},he.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},he.prototype.then=function(n,e){var t=this;if(!this._fullfilledPromise){var r=this;this._fullfilledPromise=new Promise(function(i,o){r.on("abort",function(){if(!(t._maxRetries&&t._maxRetries>t._retries)){if(t.timedout&&t.timedoutError)return void o(t.timedoutError);var a=new Error("Aborted");a.code="ABORTED",a.status=t.status,a.method=t.method,a.url=t.url,o(a)}}),r.end(function(a,s){a?o(a):i(s)})})}return this._fullfilledPromise.then(n,e)},he.prototype.catch=function(n){return this.then(void 0,n)},he.prototype.use=function(n){return n(this),this},he.prototype.ok=function(n){if("function"!=typeof n)throw new Error("Callback required");return this._okCallback=n,this},he.prototype._isResponseOK=function(n){return!!n&&(this._okCallback?this._okCallback(n):n.status>=200&&n.status<300)},he.prototype.get=function(n){return this._header[n.toLowerCase()]},he.prototype.getHeader=he.prototype.get,he.prototype.set=function(n,e){if(xn(n)){for(var t in n)rn(n,t)&&this.set(t,n[t]);return this}return this._header[n.toLowerCase()]=e,this.header[n]=e,this},he.prototype.unset=function(n){return delete this._header[n.toLowerCase()],delete this.header[n],this},he.prototype.field=function(n,e,t){if(null==n)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(xn(n)){for(var r in n)rn(n,r)&&this.field(r,n[r]);return this}if(Array.isArray(e)){for(var i in e)rn(e,i)&&this.field(n,e[i]);return this}if(null==e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=String(e)),t?this._getFormData().append(n,e,t):this._getFormData().append(n,e),this},he.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(ro.gte(process.version,"v13.0.0")&&ro.lt(process.version,"v14.0.0"))throw new Error("Superagent does not work in v13 properly with abort() due to Node.js core changes");this.req.abort()}return this.clearTimeout(),this.emit("abort"),this},he.prototype._auth=function(n,e,t,r){switch(t.type){case"basic":this.set("Authorization","Basic "+r(n+":"+e));break;case"auto":this.username=n,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+n)}return this},he.prototype.withCredentials=function(n){return void 0===n&&(n=!0),this._withCredentials=n,this},he.prototype.redirects=function(n){return this._maxRedirects=n,this},he.prototype.maxResponseSize=function(n){if("number"!=typeof n)throw new TypeError("Invalid argument");return this._maxResponseSize=n,this},he.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},he.prototype.send=function(n){var e=xn(n),t=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data)Array.isArray(n)?this._data=[]:this._isHost(n)||(this._data={});else if(n&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(e&&xn(this._data))for(var r in n){if("bigint"==typeof n[r]&&!n[r].toJSON)throw new Error("Cannot serialize BigInt value to json");rn(n,r)&&(this._data[r]=n[r])}else{if("bigint"==typeof n)throw new Error("Cannot send value of type BigInt");"string"==typeof n?(t||this.type("form"),(t=this._header["content-type"])&&(t=t.toLowerCase().trim()),this._data="application/x-www-form-urlencoded"===t?this._data?this._data+"&"+n:n:(this._data||"")+n):this._data=n}return!e||this._isHost(n)||t||this.type("json"),this},he.prototype.sortQuery=function(n){return this._sort=void 0===n||n,this},he.prototype._finalizeQueryString=function(){var n=this._query.join("&");if(n&&(this.url+=(this.url.includes("?")?"&":"?")+n),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var t=this.url.slice(e+1).split("&");"function"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+"?"+t.join("&")}}},he.prototype._appendQueryString=function(){},he.prototype._timeoutError=function(n,e,t){if(!this._aborted){var r=new Error(n+e+"ms exceeded");r.timeout=e,r.code="ECONNABORTED",r.errno=t,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)}},he.prototype._setTimeouts=function(){var n=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){n._timeoutError("Timeout of ",n._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){n._timeoutError("Response timeout of ",n._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var Ur=wt,Fa=Ln;function Ln(){}function io(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function xr(){this._defaults=[]}Ln.prototype.get=function(n){return this.header[n.toLowerCase()]},Ln.prototype._setHeaderProperties=function(n){var e=n["content-type"]||"";this.type=Ur.type(e);var t=Ur.params(e);for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(this[r]=t[r]);this.links={};try{n.link&&(this.links=Ur.parseLinks(n.link))}catch{}},Ln.prototype._setStatusProperties=function(n){var e=Math.trunc(n/100);this.statusCode=n,this.status=this.statusCode,this.statusType=e,this.info=1===e,this.ok=2===e,this.redirect=3===e,this.clientError=4===e,this.serverError=5===e,this.error=(4===e||5===e)&&this.toError(),this.created=201===n,this.accepted=202===n,this.noContent=204===n,this.badRequest=400===n,this.unauthorized=401===n,this.notAcceptable=406===n,this.forbidden=403===n,this.notFound=404===n,this.unprocessableEntity=422===n};for(var Ka=function(){var e=oo[Lr];xr.prototype[e]=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return this._defaults.push({fn:e,args:r}),this}},Lr=0,oo=["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"];Lr<oo.length;Lr++)Ka();xr.prototype._setDefaults=function(n){var e,t=function(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(l,u){if(l){if("string"==typeof l)return io(l,u);var c=Object.prototype.toString.call(l).slice(8,-1);if("Object"===c&&l.constructor&&(c=l.constructor.name),"Map"===c||"Set"===c)return Array.from(l);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return io(l,u)}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(u){throw u},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){t=t.call(n)},n:function(){var u=t.next();return a=u.done,u},e:function(u){s=!0,o=u},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw o}}}}(this._defaults);try{for(t.s();!(e=t.n()).done;){var r=e.value;n[r.fn].apply(n,r.args)}}catch(i){t.e(i)}finally{t.f()}};var Ba=xr;!function(n,e){function r(T,m){(null==m||m>T.length)&&(m=T.length);for(var C=0,X=new Array(m);C<m;C++)X[C]=T[C];return X}var i;i=typeof window<"u"?window:typeof self>"u"?void 0:self;var o=vi.exports,a=Ho,s=Da,l=Ua,u=wt.isObject,c=wt.mixin,p=wt.hasOwn,h=Fa,b=Ba;function y(){}n.exports=function(T,m){return"function"==typeof m?new e.Request("GET",T).end(m):1===arguments.length?new e.Request("GET",T):new e.Request(T,m)};var f=e=n.exports;e.Request=P,f.getXHR=function(){if(i.XMLHttpRequest)return new i.XMLHttpRequest;throw new Error("Browser-only version of superagent could not find XHR")};var v="".trim?function(T){return T.trim()}:function(T){return T.replace(/(^\s*|\s*$)/g,"")};function d(T){if(!u(T))return T;var m=[];for(var C in T)p(T,C)&&E(m,C,T[C]);return m.join("&")}function E(T,m,C){if(void 0!==C)if(null!==C)if(Array.isArray(C)){var X,N=function(T,m){var C=typeof Symbol<"u"&&T[Symbol.iterator]||T["@@iterator"];if(!C){if(Array.isArray(T)||(C=function(ue,ce){if(ue){if("string"==typeof ue)return r(ue,void 0);var _e=Object.prototype.toString.call(ue).slice(8,-1);if("Object"===_e&&ue.constructor&&(_e=ue.constructor.name),"Map"===_e||"Set"===_e)return Array.from(ue);if("Arguments"===_e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return r(ue,void 0)}}(T))||m&&T&&"number"==typeof T.length){C&&(T=C);var X=0,N=function(){};return{s:N,n:function(){return X>=T.length?{done:!0}:{done:!1,value:T[X++]}},e:function(ce){throw ce},f:N}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var G,K=!0,z=!1;return{s:function(){C=C.call(T)},n:function(){var ce=C.next();return K=ce.done,ce},e:function(ce){z=!0,G=ce},f:function(){try{K||null==C.return||C.return()}finally{if(z)throw G}}}}(C);try{for(N.s();!(X=N.n()).done;)E(T,m,X.value)}catch(K){N.e(K)}finally{N.f()}}else if(u(C))for(var G in C)p(C,G)&&E(T,m+"["+G+"]",C[G]);else T.push(encodeURI(m)+"="+encodeURIComponent(C));else T.push(encodeURI(m))}function j(T){for(var X,N,m={},C=T.split("&"),G=0,K=C.length;G<K;++G)-1===(N=(X=C[G]).indexOf("="))?m[decodeURIComponent(X)]="":m[decodeURIComponent(X.slice(0,N))]=decodeURIComponent(X.slice(N+1));return m}function F(T){return/[/+]json($|[^-\w])/i.test(T)}function H(T){this.req=T,this.xhr=this.req.xhr,this.text="HEAD"!==this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var m=this.xhr.status;1223===m&&(m=204),this._setStatusProperties(m),this.headers=function(C){for(var G,K,z,ue,X=C.split(/\r?\n/),N={},ce=0,_e=X.length;ce<_e;++ce)-1!==(G=(K=X[ce]).indexOf(":"))&&(z=K.slice(0,G).toLowerCase(),ue=v(K.slice(G+1)),N[z]=ue);return N}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body=null===this.text&&T._responseType?this.xhr.response:"HEAD"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function P(T,m){var C=this;this._query=this._query||[],this.method=T,this.url=m,this.header={},this._header={},this.on("end",function(){var X,N=null,G=null;try{G=new H(C)}catch(K){return(N=new Error("Parser is unable to parse the response")).parse=!0,N.original=K,C.xhr?(N.rawResponse=void 0===C.xhr.responseType?C.xhr.responseText:C.xhr.response,N.status=C.xhr.status?C.xhr.status:null,N.statusCode=N.status):(N.rawResponse=null,N.status=null),C.callback(N)}C.emit("response",G);try{C._isResponseOK(G)||(X=new Error(G.statusText||G.text||"Unsuccessful HTTP response"))}catch(K){X=K}X?(X.original=N,X.response=G,X.status=X.status||G.status,C.callback(X,G)):C.callback(null,G)})}f.serializeObject=d,f.parseString=j,f.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},f.serialize={"application/x-www-form-urlencoded":s.stringify,"application/json":a},f.parse={"application/x-www-form-urlencoded":j,"application/json":JSON.parse},c(H.prototype,h.prototype),H.prototype._parseBody=function(T){var m=f.parse[this.type];return this.req._parser?this.req._parser(this,T):(!m&&F(this.type)&&(m=f.parse["application/json"]),m&&T&&(T.length>0||T instanceof Object)?m(T):null)},H.prototype.toError=function(){var T=this.req,m=T.method,C=T.url,N=new Error("cannot "+m+" "+C+" ("+this.status+")");return N.status=this.status,N.method=m,N.url=C,N},f.Response=H,o(P.prototype),c(P.prototype,l.prototype),P.prototype.type=function(T){return this.set("Content-Type",f.types[T]||T),this},P.prototype.accept=function(T){return this.set("Accept",f.types[T]||T),this},P.prototype.auth=function(T,m,C){return 1===arguments.length&&(m=""),"object"==typeof m&&null!==m&&(C=m,m=""),C||(C={type:"function"==typeof btoa?"basic":"auto"}),this._auth(T,m,C,C.encoder?C.encoder:function(N){if("function"==typeof btoa)return btoa(N);throw new Error("Cannot use basic auth, btoa is not a function")})},P.prototype.query=function(T){return"string"!=typeof T&&(T=d(T)),T&&this._query.push(T),this},P.prototype.attach=function(T,m,C){if(m){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(T,m,C||m.name)}return this},P.prototype._getFormData=function(){return this._formData||(this._formData=new i.FormData),this._formData},P.prototype.callback=function(T,m){if(this._shouldRetry(T,m))return this._retry();var C=this._callback;this.clearTimeout(),T&&(this._maxRetries&&(T.retries=this._retries-1),this.emit("error",T)),C(T,m)},P.prototype.crossDomainError=function(){var T=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");T.crossDomain=!0,T.status=this.status,T.method=this.method,T.url=this.url,this.callback(T)},P.prototype.buffer=P.prototype.ca=P.prototype.agent=function(){return this},P.prototype.pipe=P.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},P.prototype._isHost=function(T){return T&&"object"==typeof T&&!Array.isArray(T)&&"[object Object]"!==Object.prototype.toString.call(T)},P.prototype.end=function(T){this._endCalled=!0,this._callback=T||y,this._finalizeQueryString(),this._end()},P.prototype._setUploadTimeout=function(){var T=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(function(){T._timeoutError("Upload timeout of ",T._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))},P.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var T=this;this.xhr=f.getXHR();var m=this.xhr,C=this._formData||this._data;this._setTimeouts(),m.addEventListener("readystatechange",function(){var z=m.readyState;if(z>=2&&T._responseTimeoutTimer&&clearTimeout(T._responseTimeoutTimer),4===z){var ue;try{ue=m.status}catch{ue=0}if(!ue)return T.timedout||T._aborted?void 0:T.crossDomainError();T.emit("end")}});var X=function(ue,ce){ce.total>0&&(ce.percent=ce.loaded/ce.total*100,100===ce.percent&&clearTimeout(T._uploadTimeoutTimer)),ce.direction=ue,T.emit("progress",ce)};if(this.hasListeners("progress"))try{m.addEventListener("progress",X.bind(null,"download")),m.upload&&m.upload.addEventListener("progress",X.bind(null,"upload"))}catch{}m.upload&&this._setUploadTimeout();try{this.username&&this.password?m.open(this.method,this.url,!0,this.username,this.password):m.open(this.method,this.url,!0)}catch(z){return this.callback(z)}if(this._withCredentials&&(m.withCredentials=!0),!this._formData&&"GET"!==this.method&&"HEAD"!==this.method&&"string"!=typeof C&&!this._isHost(C)){var N=this._header["content-type"],G=this._serializer||f.serialize[N?N.split(";")[0]:""];!G&&F(N)&&(G=f.serialize["application/json"]),G&&(C=G(C))}for(var K in this.header)null!==this.header[K]&&p(this.header,K)&&m.setRequestHeader(K,this.header[K]);this._responseType&&(m.responseType=this._responseType),this.emit("request",this),m.send(void 0===C?null:C)},f.agent=function(){return new b};for(var A=function(){var m=O[k];b.prototype[m.toLowerCase()]=function(C,X){var N=new f.Request(m,C);return this._setDefaults(N),X&&N.end(X),N}},k=0,O=["GET","POST","OPTIONS","PATCH","PUT","DELETE"];k<O.length;k++)A();function V(T,m,C){var X=f("DELETE",T);return"function"==typeof m&&(C=m,m=null),m&&X.send(m),C&&X.end(C),X}b.prototype.del=b.prototype.delete,f.get=function(T,m,C){var X=f("GET",T);return"function"==typeof m&&(C=m,m=null),m&&X.query(m),C&&X.end(C),X},f.head=function(T,m,C){var X=f("HEAD",T);return"function"==typeof m&&(C=m,m=null),m&&X.query(m),C&&X.end(C),X},f.options=function(T,m,C){var X=f("OPTIONS",T);return"function"==typeof m&&(C=m,m=null),m&&X.send(m),C&&X.end(C),X},f.del=V,f.delete=V,f.patch=function(T,m,C){var X=f("PATCH",T);return"function"==typeof m&&(C=m,m=null),m&&X.send(m),C&&X.end(C),X},f.post=function(T,m,C){var X=f("POST",T);return"function"==typeof m&&(C=m,m=null),m&&X.send(m),C&&X.end(C),X},f.put=function(T,m,C){var X=f("PUT",T);return"function"==typeof m&&(C=m,m=null),m&&X.send(m),C&&X.end(C),X}}(lr,lr.exports);var Gt=lr.exports;function Ha(n){var e=(new Date).getTime(),t=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log("<<<<<"),r.log("[".concat(t,"]"),"\n",n.url,"\n",n.qs),r.log("-----"),n.on("response",function(i){var o=(new Date).getTime()-e,a=(new Date).toISOString();r.log(">>>>>>"),r.log("[".concat(a," / ").concat(o,"]"),"\n",n.url,"\n",n.qs,"\n",i.text),r.log("-----")})}function on(n,e,t){var r=this;this._config.logVerbosity&&(n=n.use(Ha)),this._config.proxy&&this._modules.proxy&&(n=this._modules.proxy.call(this,n)),this._config.keepAlive&&this._modules.keepAlive&&(n=this._modules.keepAlive(n));var i=n;if(e.abortSignal)var o=e.abortSignal.subscribe(function(){i.abort(),o()});return!0===e.forceBuffered?i=typeof Blob>"u"?i.buffer().responseType("arraybuffer"):i.responseType("arraybuffer"):!1===e.forceBuffered&&(i=i.buffer(!1)),(i=i.timeout(e.timeout)).on("abort",function(){return t({category:fe.PNUnknownCategory,error:!0,operation:e.operation,errorData:new Error("Aborted")},null)}),i.end(function(a,s){var l,u={};if(u.error=null!==a,u.operation=e.operation,s&&s.status&&(u.statusCode=s.status),a){if(a.response&&a.response.text&&!r._config.logVerbosity)try{u.errorData=JSON.parse(a.response.text)}catch{u.errorData=a}else u.errorData=a;return u.category=r._detectErrorCategory(a),t(u,null)}if(e.ignoreBody)l={headers:s.headers,redirects:s.redirects,response:s};else try{l=JSON.parse(s.text)}catch{return u.errorData=s,u.error=!0,t(u,null)}return l.error&&1===l.error&&l.status&&l.message&&l.service?(u.errorData=l,u.statusCode=l.status,u.error=!0,u.category=r._detectErrorCategory(u),t(u,null)):(l.error&&l.error.message&&(u.errorData=l.error),t(u,l))}),i}function za(n,e,t){return Y(this,void 0,void 0,function(){var r;return q(this,function(i){switch(i.label){case 0:return r=Gt.post(n),e.forEach(function(o){r=r.field(o.key,o.value)}),r.attach("file",t,{contentType:"application/octet-stream"}),[4,r];case 1:return[2,i.sent()]}})})}function qa(n,e,t){var r=Gt.get(this.getStandardOrigin()+e.url).set(e.headers).query(n);return on.call(this,r,e,t)}function Va(n,e,t){var r=Gt.get(this.getStandardOrigin()+e.url).set(e.headers).query(n);return on.call(this,r,e,t)}function Wa(n,e,t,r){var i=Gt.post(this.getStandardOrigin()+t.url).query(n).set(t.headers).send(e);return on.call(this,i,t,r)}function Ja(n,e,t,r){var i=Gt.patch(this.getStandardOrigin()+t.url).query(n).set(t.headers).send(e);return on.call(this,i,t,r)}function $a(n,e,t){var r=Gt.delete(this.getStandardOrigin()+e.url).set(e.headers).query(n);return on.call(this,r,e,t)}function ao(n,e){var t=new Uint8Array(n.byteLength+e.byteLength);return t.set(new Uint8Array(n),0),t.set(new Uint8Array(e),n.byteLength),t.buffer}var $e,so=function(){function n(){}return Object.defineProperty(n.prototype,"algo",{get:function(){return"aes-256-cbc"},enumerable:!1,configurable:!0}),n.prototype.encrypt=function(e,t){return Y(this,void 0,void 0,function(){var r;return q(this,function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:if(r=i.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(r,t)];if("string"==typeof t)return[2,this.encryptString(r,t)];throw new Error("Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer")}})})},n.prototype.decrypt=function(e,t){return Y(this,void 0,void 0,function(){var r;return q(this,function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:if(r=i.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(r,t)];if("string"==typeof t)return[2,this.decryptString(r,t)];throw new Error("Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer")}})})},n.prototype.encryptFile=function(e,t,r){return Y(this,void 0,void 0,function(){var i,o,a;return q(this,function(s){switch(s.label){case 0:if(t.data.byteLength<=0)throw new Error("encryption error. empty content");return[4,this.getKey(e)];case 1:return i=s.sent(),[4,t.data.arrayBuffer()];case 2:return o=s.sent(),[4,this.encryptArrayBuffer(i,o)];case 3:return a=s.sent(),[2,r.create({name:t.name,mimeType:"application/octet-stream",data:a})]}})})},n.prototype.decryptFile=function(e,t,r){return Y(this,void 0,void 0,function(){var i,o,a;return q(this,function(s){switch(s.label){case 0:return[4,this.getKey(e)];case 1:return i=s.sent(),[4,t.data.arrayBuffer()];case 2:return o=s.sent(),[4,this.decryptArrayBuffer(i,o)];case 3:return a=s.sent(),[2,r.create({name:t.name,data:a})]}})})},n.prototype.getKey=function(e){return Y(this,void 0,void 0,function(){var t,r,i;return q(this,function(o){switch(o.label){case 0:return[4,crypto.subtle.digest("SHA-256",n.encoder.encode(e))];case 1:return t=o.sent(),r=Array.from(new Uint8Array(t)).map(function(a){return a.toString(16).padStart(2,"0")}).join(""),i=n.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey("raw",i,"AES-CBC",!0,["encrypt","decrypt"])]}})})},n.prototype.encryptArrayBuffer=function(e,t){return Y(this,void 0,void 0,function(){var r,i,o;return q(this,function(a){switch(a.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),i=ao,o=[r.buffer],[4,crypto.subtle.encrypt({name:"AES-CBC",iv:r},e,t)];case 1:return[2,i.apply(void 0,o.concat([a.sent()]))]}})})},n.prototype.decryptArrayBuffer=function(e,t){return Y(this,void 0,void 0,function(){var r;return q(this,function(i){switch(i.label){case 0:if(r=t.slice(0,16),t.slice(n.IV_LENGTH).byteLength<=0)throw new Error("decryption error: empty content");return[4,crypto.subtle.decrypt({name:"AES-CBC",iv:r},e,t.slice(n.IV_LENGTH))];case 1:return[2,i.sent()]}})})},n.prototype.encryptString=function(e,t){return Y(this,void 0,void 0,function(){var r,i,o,a;return q(this,function(s){switch(s.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),i=n.encoder.encode(t).buffer,[4,crypto.subtle.encrypt({name:"AES-CBC",iv:r},e,i)];case 1:return o=s.sent(),a=ao(r.buffer,o),[2,n.decoder.decode(a)]}})})},n.prototype.decryptString=function(e,t){return Y(this,void 0,void 0,function(){var r,i,o,a;return q(this,function(s){switch(s.label){case 0:return r=n.encoder.encode(t).buffer,i=r.slice(0,16),o=r.slice(16),[4,crypto.subtle.decrypt({name:"AES-CBC",iv:i},e,o)];case 1:return a=s.sent(),[2,n.decoder.decode(a)]}})})},n.IV_LENGTH=16,n.encoder=new TextEncoder,n.decoder=new TextDecoder,n}(),Qa=(($e=function(){function n(e){if(e instanceof File?(this.data=e,this.name=this.data.name,this.mimeType=this.data.type):e.data&&(this.data=new File([e.data],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)),void 0===this.data)throw new Error("Couldn't construct a file out of supplied options.");if(void 0===this.name)throw new Error("Couldn't guess filename out of the options. Please provide one.")}return n.create=function(e){return new this(e)},n.prototype.toBuffer=function(){return Y(this,void 0,void 0,function(){return q(this,function(e){throw new Error("This feature is only supported in Node.js environments.")})})},n.prototype.toStream=function(){return Y(this,void 0,void 0,function(){return q(this,function(e){throw new Error("This feature is only supported in Node.js environments.")})})},n.prototype.toFileUri=function(){return Y(this,void 0,void 0,function(){return q(this,function(e){throw new Error("This feature is only supported in react native environments.")})})},n.prototype.toBlob=function(){return Y(this,void 0,void 0,function(){return q(this,function(e){return[2,this.data]})})},n.prototype.toArrayBuffer=function(){return Y(this,void 0,void 0,function(){var e=this;return q(this,function(t){return[2,new Promise(function(r,i){var o=new FileReader;o.addEventListener("load",function(){if(o.result instanceof ArrayBuffer)return r(o.result)}),o.addEventListener("error",function(){i(o.error)}),o.readAsArrayBuffer(e.data)})]})})},n.prototype.toString=function(){return Y(this,void 0,void 0,function(){var e=this;return q(this,function(t){return[2,new Promise(function(r,i){var o=new FileReader;o.addEventListener("load",function(){if("string"==typeof o.result)return r(o.result)}),o.addEventListener("error",function(){i(o.error)}),o.readAsBinaryString(e.data)})]})})},n.prototype.toFile=function(){return Y(this,void 0,void 0,function(){return q(this,function(e){return[2,this.data]})})},n}()).supportsFile=typeof File<"u",$e.supportsBlob=typeof Blob<"u",$e.supportsArrayBuffer=typeof ArrayBuffer<"u",$e.supportsBuffer=!1,$e.supportsStream=!1,$e.supportsString=!0,$e.supportsEncryptFile=!0,$e.supportsFileUri=!1,$e),Fr=function(){function n(e){this.config=e,this.cryptor=new dt({config:e}),this.fileCryptor=new so}return Object.defineProperty(n.prototype,"identifier",{get:function(){return""},enumerable:!1,configurable:!0}),n.prototype.encrypt=function(e){var t="string"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},n.prototype.decrypt=function(e){var t="string"==typeof e.data?e.data:Ot(e.data);return this.cryptor.decrypt(t)},n.prototype.encryptFile=function(e,t){var r;return Y(this,void 0,void 0,function(){return q(this,function(i){return[2,this.fileCryptor.encryptFile(null===(r=this.config)||void 0===r?void 0:r.cipherKey,e,t)]})})},n.prototype.decryptFile=function(e,t){return Y(this,void 0,void 0,function(){return q(this,function(r){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]})})},n}(),Gr=function(){function n(e){this.cipherKey=e.cipherKey,this.CryptoJS=me,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(n.prototype,"algo",{get:function(){return"AES-CBC"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"identifier",{get:function(){return"ACRH"},enumerable:!1,configurable:!0}),n.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(n.BLOCK_SIZE))},n.prototype.getKey=function(){return Y(this,void 0,void 0,function(){var e,t;return q(this,function(r){switch(r.label){case 0:return e=n.encoder.encode(this.cipherKey),[4,crypto.subtle.digest("SHA-256",e.buffer)];case 1:return t=r.sent(),[2,crypto.subtle.importKey("raw",t,this.algo,!0,["encrypt","decrypt"])]}})})},n.prototype.encrypt=function(e){if(0===("string"==typeof e?e:n.decoder.decode(e)).length)throw new Error("encryption error. empty content");var t=this.getIv();return{metadata:t,data:ft(this.CryptoJS.AES.encrypt(e,this.encryptedKey,{iv:this.bufferToWordArray(t),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},n.prototype.decrypt=function(e){var t=this.bufferToWordArray(new Uint8ClampedArray(e.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(e.data));return n.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:t,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},n.prototype.encryptFileData=function(e){return Y(this,void 0,void 0,function(){var t,r,i;return q(this,function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),r=this.getIv(),i={},[4,crypto.subtle.encrypt({name:this.algo,iv:r},t,e)];case 2:return[2,(i.data=o.sent(),i.metadata=r,i)]}})})},n.prototype.decryptFileData=function(e){return Y(this,void 0,void 0,function(){var t;return q(this,function(r){switch(r.label){case 0:return[4,this.getKey()];case 1:return t=r.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}})})},n.prototype.bufferToWordArray=function(e){var t,r=[];for(t=0;t<e.length;t+=1)r[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(r,e.length)},n.BLOCK_SIZE=16,n.encoder=new TextEncoder,n.decoder=new TextDecoder,n}(),uo=function(){function n(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return n.legacyCryptoModule=function(e){var t;return new this({default:new Fr({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new Gr({cipherKey:e.cipherKey})]})},n.aesCbcCryptoModule=function(e){var t;return new this({default:new Gr({cipherKey:e.cipherKey}),cryptors:[new Fr({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},n.withDefaultCryptor=function(e){return new this({default:e})},n.prototype.getAllCryptors=function(){return w([this.defaultCryptor],D(this.cryptors),!1)},n.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var r=this.getHeaderData(t);return this.concatArrayBuffer(r,t.data)},n.prototype.decrypt=function(e){var t="string"==typeof e?ft(e):e,r=Qe.tryParse(t),i=this.getCryptor(r),o=r.length>0?t.slice(r.length-r.metadataLength,r.length):null;if(t.slice(r.length).byteLength<=0)throw new Error("decryption error. empty content");return i.decrypt({data:t.slice(r.length),metadata:o})},n.prototype.encryptFile=function(e,t){return Y(this,void 0,void 0,function(){var r,i;return q(this,function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===Qe.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:[4,this.getFileData(e.data)];case 1:return r=o.sent(),[4,this.defaultCryptor.encryptFileData(r)];case 2:return i=o.sent(),[2,t.create({name:e.name,mimeType:"application/octet-stream",data:this.concatArrayBuffer(this.getHeaderData(i),i.data)})]}})})},n.prototype.decryptFile=function(e,t){return Y(this,void 0,void 0,function(){var r,i,o,a,s,l,u,c;return q(this,function(p){switch(p.label){case 0:return[4,e.data.arrayBuffer()];case 1:return r=p.sent(),i=Qe.tryParse(r),(null==(o=this.getCryptor(i))?void 0:o.identifier)===n.LEGACY_IDENTIFIER?[2,o.decryptFile(e,t)]:[4,this.getFileData(r)];case 2:return a=p.sent(),s=a.slice(i.length-i.metadataLength,i.length),u=(l=t).create,c={name:e.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(i.length),metadata:s})];case 3:return[2,u.apply(l,[(c.data=p.sent(),c)])]}})})},n.prototype.getCryptor=function(e){if(""===e){var t=this.getAllCryptors().find(function(r){return""===r.identifier});if(t)return t;throw new Error("unknown cryptor error")}if(e instanceof Kr)return this.getCryptorFromId(e.identifier)},n.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find(function(r){return e===r.identifier});if(t)return t;throw Error("unknown cryptor error")},n.prototype.concatArrayBuffer=function(e,t){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r.buffer},n.prototype.getHeaderData=function(e){if(e.metadata){var t=Qe.from(this.defaultCryptor.identifier,e.metadata),r=new Uint8Array(t.length),i=0;return r.set(t.data,i),i+=t.length-e.metadata.byteLength,r.set(new Uint8Array(e.metadata),i),r.buffer}},n.prototype.getFileData=function(e){return Y(this,void 0,void 0,function(){return q(this,function(t){switch(t.label){case 0:return e instanceof Blob?[4,e.arrayBuffer()]:[3,2];case 1:return[2,t.sent()];case 2:if(e instanceof ArrayBuffer)return[2,e];if("string"==typeof e)return[2,n.encoder.encode(e)];throw new Error("Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob")}})})},n.LEGACY_IDENTIFIER="",n.encoder=new TextEncoder,n.decoder=new TextDecoder,n}(),Qe=function(){function n(){}return n.from=function(e,t){if(e!==n.LEGACY_IDENTIFIER)return new Kr(e,t.byteLength)},n.tryParse=function(e){var t=new Uint8Array(e),r="";if(t.byteLength>=4&&(r=t.slice(0,4),this.decoder.decode(r)!==n.SENTINEL))return"";if(!(t.byteLength>=5))throw new Error("decryption error. invalid header version");if(t[4]>n.MAX_VERSION)throw new Error("unknown cryptor error");var i,o=5+n.IDENTIFIER_LENGTH;if(!(t.byteLength>=o))throw new Error("decryption error. invalid crypto identifier");i=t.slice(5,o);var a=null;if(!(t.byteLength>=o+1))throw new Error("decryption error. invalid metadata length");return a=t[o],o+=1,255===a&&t.byteLength>=o+2&&(a=new Uint16Array(t.slice(o,o+2)).reduce(function(s,l){return(s<<8)+l},0),o+=2),new Kr(this.decoder.decode(i),a)},n.SENTINEL="PNED",n.LEGACY_IDENTIFIER="",n.IDENTIFIER_LENGTH=4,n.VERSION=1,n.MAX_VERSION=1,n.decoder=new TextDecoder,n}(),Kr=function(){function n(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(n.prototype,"identifier",{get:function(){return this._identifier},set:function(t){this._identifier=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metadataLength",{get:function(){return this._metadataLength},set:function(t){this._metadataLength=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"version",{get:function(){return Qe.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return Qe.SENTINEL.length+1+Qe.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){var t=0,r=new Uint8Array(this.length),i=new TextEncoder;r.set(i.encode(Qe.SENTINEL)),r[t+=Qe.SENTINEL.length]=this.version,t++,this.identifier&&r.set(i.encode(this.identifier),t),t+=Qe.IDENTIFIER_LENGTH;var o=this.metadataLength;return o<255?r[t]=o:r.set([255,o>>8,255&o],t),r},enumerable:!1,configurable:!0}),n.IDENTIFIER_LENGTH=4,n.SENTINEL="PNED",n}();function Xa(n){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(n)}var Ya=function(n){function e(t){var r=this,i=t.listenToBrowserNetworkEvents,o=void 0===i||i;return t.sdkFamily="Web",t.networking=new Ko({del:$a,get:Va,post:Wa,patch:Ja,sendBeacon:Xa,getfile:qa,postfile:za}),t.cbor=new Bo(function(a){return mi(ie.decode(a))},ft),t.PubNubFile=Qa,t.cryptography=new so,t.initCryptoModule=function(a){return new uo({default:new Fr({cipherKey:a.cipherKey,useRandomIVs:a.useRandomIVs}),cryptors:[new Gr({cipherKey:a.cipherKey})]})},r=n.call(this,t)||this,o&&(window.addEventListener("offline",function(){r.networkDownDetected()}),window.addEventListener("online",function(){r.networkUpDetected()})),r}return W(e,n),e.CryptoModule=uo,e}(Go);return Ya}()},64904:function(xe,ye,te){"use strict";te.r(ye),te.d(ye,{RealTimeModule:function(){return tr}});var se=te(81337),W=te(50423),Q=te(18405),le=te(26805),Y=te(61008),q=te(62458),re=te(80777),D=te(8060),w=te(46544),M=te(70604),L=te(48787),B=te(65181),ie=te(26898),ge=te(49092),Ee=te(41114),rt="PBI.RealTime.AddUpdateRemoveStreamingDataset",ze=Ee.cx[rt]=(0,Ee.b1)(rt),ft="PBI.RealTime.GetStreamingDataset",Ot=Ee.cx[ft]=(0,Ee.b1)(ft),Et="PBI.RealTimeDataUpdateException",sn=Ee.cx[Et]=(0,Ee.b1)(Et,{logRatio:1e-4}),Kt="PBI.RealTime.LongPollError",un=Ee.cx[Kt]=(0,Ee.b1)(Kt),it="PBI.RealTime.GetPubNubCredentials",Ne=Ee.cx[it]=(0,Ee.b1)(it),me=te(43286),Tt=te(50911),dt=te(2931),Gn=function(){function I(){}return Object.defineProperty(I.prototype,"code",{get:function(){return"RealTimeLongPollError"},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"ignorable",{get:function(){return!1},enumerable:!1,configurable:!0}),I.prototype.getDetails=function(g){return{message:g.get("Realtime_longPollErrorValue"),displayableErrorInfo:[{errorInfoKey:g.get("Realtime_longPollErrorKey"),errorInfoValue:g.get("Realtime_longPollErrorValue")}],debugErrorInfo:[{errorInfoKey:dt.zd,errorInfoValue:this.code}]}},I}(),Kn=function(){function I(){}return Object.defineProperty(I.prototype,"code",{get:function(){return"RealTimeGetHistory"},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"ignorable",{get:function(){return!1},enumerable:!1,configurable:!0}),I.prototype.getDetails=function(g){return{message:g.get("Realtime_retrieveHistoryValue"),displayableErrorInfo:[{errorInfoKey:g.get("Realtime_retrieveHistoryKey"),errorInfoValue:g.get("Realtime_retrieveHistoryValue")}],debugErrorInfo:[{errorInfoKey:dt.zd,errorInfoValue:this.code}]}},I}(),fe=function(){function I(){}return Object.defineProperty(I.prototype,"code",{get:function(){return"RTMessageExceedLimit"},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"ignorable",{get:function(){return!0},enumerable:!1,configurable:!0}),I.prototype.getDetails=function(g){return{message:g.get("Realtime_MessageExceedLimitValue"),displayableErrorInfo:[{errorInfoKey:g.get("Realtime_MessageExceedLimitKey"),errorInfoValue:g.get("Realtime_MessageExceedLimitValue")}],debugErrorInfo:[{errorInfoKey:dt.zd,errorInfoValue:this.code}]}},I}(),Bn=function(){function I(){}return Object.defineProperty(I.prototype,"code",{get:function(){return"RealTimePubNubCredentials"},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"ignorable",{get:function(){return!1},enumerable:!1,configurable:!0}),I.prototype.getDetails=function(g){return{message:g.get("Realtime_PubNubGetCredentialsFailedValue"),displayableErrorInfo:[{errorInfoKey:g.get("Realtime_PubNubGetCredentialsFailedKey"),errorInfoValue:g.get("Realtime_PubNubGetCredentialsFailedValue")}],debugErrorInfo:[{errorInfoKey:dt.zd,errorInfoValue:this.code}]}},I}(),J=te(14463),Hn=te(26112),Bt=te(36508),zn=te(60255),cn=te(629),Ht=function(){function I(g,S){this.activeFolderId=g,this.httpService=S}return I.prototype.createDataset=function(g){q.fF.assertValue(g,"datasetDef");var S=this.httpService.powerbiRequestOptions(null,"Create Real Time Dataset"),R="realtime/models";return R=this.activeFolderId.appendFolderToQueryStringIfExists(R),this.httpService.post(R,g,S)},I.prototype.getCredentials=function(g){q.fF.assertValue(g,"modelId");var S=this.httpService.powerbiRequestOptions(null,"Get Real Time Dataset External Credentials");return this.httpService.get("realtime/models/"+g+"/credentials",S)},I.prototype.getDataset=function(g){q.fF.assertValue(g,"modelId");var S=this.httpService.powerbiRequestOptions(null,"Get Real Time Dataset");return this.httpService.get("realtime/models/"+g,S)},I.prototype.getHistory=function(g){q.fF.assertValue(g,"requests");var S=this.httpService.powerbiRequestOptions(null,"Get History");return this.httpService.post("realtime/history",g,S)},I.prototype.updateDataset=function(g,S){q.fF.assertValue(g,"modelId"),q.fF.assertValue(S,"datasetDef");var R=this.httpService.powerbiRequestOptions(null,"Update Real Time Dataset");return this.httpService.put("realtime/models/"+g,S,R)},I.\u0275fac=function(S){return new(S||I)(W.\u0275\u0275inject(zn.j),W.\u0275\u0275inject(cn.M))},I.\u0275prov=W.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac,providedIn:"root"}),I}(),zt=te(91712),qt="realTimeErrorCode",pn=function(I){return I[I.None=0]="None",I[I.MaximumDataExceeded=1]="MaximumDataExceeded",I}({}),oe=function(I){function g(S,R,x,U,$,Z){var ee=I.call(this,$,Z)||this;return ee.localizationService=S,ee.realTimeDataHttpService=R,ee.tabularData=x,ee.telemetryService=U,ee.promiseFactory=$,ee.activeRealTimeModelIds=[],ee}return(0,se.ZT)(g,I),g.prototype.setCallbacks=function(S,R){q.fF.assertValue(R,"errorCallback"),q.fF.assertValue(S,"updateCallback"),this.updateCallback=S,this.errorCallback=R},g.prototype.subscribe=function(S){q.fF.assertValue(this.updateCallback,"updateCallback"),q.fF.assertValue(S,"id"),S&&(_.includes(this.activeRealTimeModelIds,S)||(this.activeRealTimeModelIds.push(S),this.delayedGetHistory()))},g.prototype.unsubscribe=function(S){q.fF.assertValue(S,"id"),S&&(_.remove(this.activeRealTimeModelIds,S),this.delayedGetUpdate())},g.prototype.resume=function(){this.paused=!1,this.delayedGetHistory()},g.prototype.getRequest=function(){for(var S=[],R=this.tabularData,x=0,U=this.activeRealTimeModelIds;x<U.length;x++){var $=U[x],ee=R.getKey(null!=$.originalModelId?$.originalModelId:$.id,$.tableName),ae=R.get(ee);S.push({id:ae.modelId,packageId:$.packageId,tableName:ae.name,version:ae.lastVersion?ae.lastVersion:0})}if(!_.isEmpty(S))return{models:S}},g.prototype.getEndpointUrl=function(){return"powerbi/refresh/rtsubscribe"},g.prototype.processResponse=function(S){S&&this.processUpdates(S.results)},g.prototype.processError=function(){this.telemetryService.logEvent(un),this.errorCallback(this.activeRealTimeModelIds,(new Gn).getDetails(this.localizationService))},Object.defineProperty(g.prototype,"longPollDurationInMs",{get:function(){return 12e4},enumerable:!1,configurable:!0}),g.prototype.delayedGetHistory=function(){var S=this;clearTimeout(this.getHistoryHandle),this.getHistoryHandle=setTimeout(function(){return S.getHistory()},20)},g.prototype.delayedGetUpdate=function(){var S=this;clearTimeout(this.getUpdateHandle),this.getUpdateHandle=setTimeout(function(){S.getUpdate()},20)},g.prototype.getUpdate=function(){this.cancelCurrentRequest(),_.isEmpty(this.activeRealTimeModelIds)||this.startMonitoring()},g.prototype.getHistory=function(){for(var S=this,R=[],x=0,U=this.activeRealTimeModelIds;x<U.length;x++){var $=U[x];R.push({modelId:null!=$.originalModelId?$.originalModelId:$.id,tableName:$.tableName,fromMilliseconds:le.cm})}_.isEmpty(R)||this.realTimeDataHttpService.getHistory(R).then(function(ee){ee&&S.processUpdates(ee.data),S.getUpdate()},function(){var ee=(new Kn).getDetails(S.localizationService);S.errorCallback(S.activeRealTimeModelIds,ee)})},g.prototype.processUpdates=function(S){if(!_.isEmpty(S))for(var R=0,x=S;R<x.length;R++){var U=x[R];if(U){var $=g.convertToDataRowGroup(U.rows);if(!_.isEmpty($)){var Z=g.checkForError($);Z&&this.errorCallback([U],Z.getDetails(this.localizationService)),$=g.filterOutErrorRow($),this.updateCallback({modelId:U.id,name:U.tableName,rowGroups:$,lastVersion:U.version})}}}},g.checkForError=function(S){var R=_.last(S);if(R){var x=_.head(R.rows);if(x){var U=x[qt];if(U)return g.getErrorForCode(U)}}},g.filterOutErrorRow=function(S){for(var R=[],x=0,U=S;x<U.length;x++){var $=U[x];_.remove($.rows,function(Z){return null!=Z[qt]}),!_.isEmpty($.rows)&&R.push($)}return R},g.getErrorForCode=function(S){if(S===(0,me.BB)(pn,pn.MaximumDataExceeded))return new fe},g.convertToDataRowGroup=function(S){var R=[];if(_.isEmpty(S))return R;for(var x=0,U=S;x<U.length;x++){var $=U[x],ee=(0,Hn.K)($&&$.data);_.isEmpty(ee)||R.push({version:$.version,rows:ee})}return R},g.\u0275fac=function(R){return new(R||g)(W.\u0275\u0275inject(B.o),W.\u0275\u0275inject(Ht),W.\u0275\u0275inject(zt.s),W.\u0275\u0275inject(w.y0),W.\u0275\u0275inject(J.t),W.\u0275\u0275inject(cn.M))},g.\u0275prov=W.\u0275\u0275defineInjectable({token:g,factory:g.\u0275fac,providedIn:"root"}),g}(Bt.y),ve=te(94853),Ye=te(11105),Vn=te(76072),fn=function(){function I(g,S,R,x,U){this.realTimeDataHttpService=g,this.tabularDataService=S,this.telemetryService=R,this.localizationService=x,this.lazyProvider=U,this.modelCredentialMap={},this.pubNubConnectionMap={}}return I.prototype.setCallbacks=function(g,S){q.fF.assertValue(S,"errorCallback"),q.fF.assertValue(g,"updateCallback"),this.updateCallback=g,this.errorCallback=S},I.prototype.pause=function(){this.toggleSubscribe(1)},I.prototype.resume=function(){this.toggleSubscribe(0)},I.prototype.toggleSubscribe=function(g){var S=this;_.forOwn(this.modelCredentialMap,function(R,x){var U=S.getConnectionKey(R),$=S.pubNubConnectionMap[U],Z=$&&$.instance;if(Z){var ee=Object.keys($.channelListeners);0===g?Z.subscribe({channels:ee,message:function(de,Te,Me,Ie){S.processMessage(R,de,Te[1])}}):Z.unsubscribe({channels:ee})}})},I.prototype.subscribe=function(g){return(0,se.mG)(this,void 0,void 0,function(){var S,R,x,U,$,Z,ee,ae=this;return(0,se.Jh)(this,function(de){switch(de.label){case 0:return q.fF.assertValue(this.updateCallback,"updateCallback"),q.fF.assertValue(g,"id"),null!=this.pubNubAngular?[3,2]:(S=this,[4,this.lazyProvider.get("@powerbi/RealTime/real-time.module#RealTimeModule","pubNubAngularService")]);case 1:S.pubNubAngular=de.sent(),de.label=2;case 2:return g?[4,this.getCredentials(g)]:[2];case 3:return R=de.sent(),x=this.getConnectionKey(R),(U=this.pubNubConnectionMap[x])||($={message:function(Me){ae.processMessage(R,Me.message,Me.timetoken)}},(U={instance:this.getPubNubInstance(R,200),channelListeners:{},listener:$}).instance.addListener($),this.pubNubConnectionMap[x]=U),ee=U.channelListeners[Z=R.channelName],_.isEmpty(ee)&&(U.instance.subscribe({channels:[Z]}),ee=U.channelListeners[Z]=[]),ee.push(g),[2]}})})},I.prototype.unsubscribe=function(g){return(0,se.mG)(this,void 0,void 0,function(){var S,R,x,U,$,Z;return(0,se.Jh)(this,function(ee){switch(ee.label){case 0:return q.fF.assertValue(g,"id"),g?[4,this.getCredentials(g)]:[2];case 1:return S=ee.sent(),R=S.channelName,x=this.getConnectionKey(S),($=(U=this.pubNubConnectionMap[x])&&U.channelListeners[R])&&(_.remove($,g),_.isEmpty($)&&(delete U.channelListeners[R],(Z=U.instance).removeListener(U.listener),Z.unsubscribe({channels:[R]}),_.isEmpty(Object.keys(U.channelListeners))&&delete this.pubNubConnectionMap[x])),[2]}})})},I.prototype.detectPubNubColumnsDefinition=function(g){return(0,se.mG)(this,void 0,void 0,function(){var S,R,x=this;return(0,se.Jh)(this,function(U){switch(U.label){case 0:return q.fF.assertValue(g,"credential"),null!=this.pubNubAngular?[3,2]:(S=this,[4,this.lazyProvider.get("@powerbi/RealTime/real-time.module#RealTimeModule","pubNubAngularService")]);case 1:S.pubNubAngular=U.sent(),U.label=2;case 2:return R=g.channelName,[2,new Promise(function($,Z){var ee=x.getPubNubInstance(g),ae={message:function(Me){clearTimeout(de),ee.removeListener(ae),ee.unsubscribe({channels:[R]});var Ie=Me.message;Ie?$((0,Y.KA)(Ie)):Z("Row missing from response")}};ee.addListener(ae);var de=setTimeout(function(){Z("Timeout exceeded"),ee.removeListener(ae),ee.unsubscribe({channels:[R]})},5e3);ee.subscribe({channels:[R]})})]}})})},I.prototype.getCredentials=function(g){var S=this;return q.fF.assertValue(g,"getCredentials modelInfo"),new Promise(function(R,x){var $=S.tabularDataService.getKey(null!=g.originalModelId?g.originalModelId:g.id,g.tableName),Z=S.modelCredentialMap[$];if(Z)R(Z);else{var ee=S.telemetryService.startEvent(Ne);S.realTimeDataHttpService.getCredentials(g.id).then(function(ae){var de=ae.data;S.modelCredentialMap[$]=de,ee.resolve(),R(de)},function(ae){ee.reject((0,ve.GB)(ae.error,ae.status)),S.errorCallback([g],(new Bn).getDetails(S.localizationService)),x(ae)})}})},I.prototype.getPubNubInstance=function(g,S){return void 0===S&&(S=void 0),this.pubNubAngular.init({uuid:(0,Ye.Z)(),subscribeKey:g.subscriptionKey,authKey:g.authKey,ssl:!0,noleave:!0,windowing:S})},I.prototype.getConnectionKey=function(g){return q.fF.assertValue(g,"credentials"),g.subscriptionKey+(g.authKey||"")},I.prototype.processMessage=function(g,S,R){if(S&&R)for(var x=this.getConnectionKey(g),$=this.pubNubConnectionMap[x].channelListeners[g.channelName],Z=I.convertTimeTokenToVersion(R),ee=0,ae=$;ee<ae.length;ee++){var de=ae[ee],Me={modelId:null!=de.originalModelId?de.originalModelId:de.id,name:de.tableName,rowGroups:I.convertToDataRowGroup(Z,S),lastVersion:Z};this.updateCallback(Me)}},I.convertToDataRowGroup=function(g,S){return q.fF.assertValue(g,"version"),q.fF.assertValue(S,"rows"),S?[{version:g,rows:[S]}]:[]},I.convertTimeTokenToVersion=function(g){return q.fF.assert(function(){return!isNaN(g)},"timeToken is NaN"),Math.floor(g/1e4)},I.\u0275fac=function(S){return new(S||I)(W.\u0275\u0275inject(Ht),W.\u0275\u0275inject(zt.s),W.\u0275\u0275inject(w.y0),W.\u0275\u0275inject(B.o),W.\u0275\u0275inject(Vn.E))},I.\u0275prov=W.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac,providedIn:"root"}),I}(),ne=function(){function I(g,S,R,x,U){this.datasetStore=g,this.realTimeLongPollDataService=S,this.realTimeLongPubNubDataService=R,this.telemetryService=x,this.tabularDataCache=U,this.listenerMap={},S.setCallbacks(this.processMessage.bind(this),this.raiseErrors.bind(this)),R.setCallbacks(this.processMessage.bind(this),this.raiseErrors.bind(this))}return I.prototype.subscribe=function(g,S){if(q.fF.assertValue(g,"realTimeModelId"),q.fF.assertValue(S,"listener"),g&&S){var R=this.tabularDataCache,x=null!=g.originalModelId?g.originalModelId:g.id,U=R.getKey(x,g.tableName),$=this.listenerMap[U]||[];if(!_.includes($,S))return $.push(S),this.listenerMap[U]=$,R.get(U)?void S.onDataChanged():(R.add({modelId:x,name:g.tableName,rowGroups:null,columns:this.getColumnMetadata(g.schema)}),this.resolveDataService(g).then(function(ee){ee&&ee.subscribe(g)}))}},I.prototype.unsubscribe=function(g,S){if(q.fF.assertValue(g,"realTimeModelId"),q.fF.assertValue(S,"listener"),g&&S){var R=this.tabularDataCache,U=R.getKey(null!=g.originalModelId?g.originalModelId:g.id,g.tableName),$=this.listenerMap[U];if($&&(_.pull($,S),_.isEmpty($)))return delete this.listenerMap[U],R.remove(U),this.resolveDataService(g).then(function(Z){Z&&Z.unsubscribe(g)})}},I.prototype.pause=function(){this.realTimeLongPollDataService.pause(),this.realTimeLongPubNubDataService.pause()},I.prototype.resume=function(){this.realTimeLongPollDataService.resume(),this.realTimeLongPubNubDataService.resume()},I.prototype.replaceListener=function(g,S,R){if(g){var U=this.tabularDataCache.getKey(null!=g.originalModelId?g.originalModelId:g.id,g.tableName),$=this.listenerMap[U]||[];this.listenerMap[U]=$;var Z=_.remove($,function(ee){return ee===S});_.isEmpty(Z)||$.push(R)}},I.prototype.processMessage=function(g){try{if(!g)return;var S=this.tabularDataCache,R=S.getKey(g.modelId,g.name);if(_.isEmpty(g.rowGroups)){if(g.lastVersion){var x=this.tabularDataCache.get(R);x&&(x.lastVersion=g.lastVersion)}return}S.mergeRows(g.modelId,g.name,g.rowGroups,g.lastVersion);var U=this.listenerMap[R];if(!U)return;for(var $=0,Z=U;$<Z.length;$++)Z[$].onDataChanged()}catch(ae){this.telemetryService&&this.telemetryService.logEvent(sn,{source:ae.fileName,lineNumber:ae.lineNumber,columnNumber:ae.columnNumber,stack:ae.stack,message:ae.message})}},I.prototype.raiseErrors=function(g,S){q.fF.assertValue(g,"modelIds should be defined"),q.fF.assertValue(S,"errorDetails should be defined");for(var R=[],x=0,U=g;x<U.length;x++){var $=U[x],Z=this.tabularDataCache.getKey($.id,$.tableName);R.push(Z)}for(var ee=0,ae=R=_.uniq(R);ee<ae.length;ee++){var de=this.listenerMap[Z=ae[ee]];if(!de)return;for(var Te=0,Me=de;Te<Me.length;Te++)Me[Te].onError(S)}},I.prototype.getColumnMetadata=function(g){if(g){var S=g.entities;if(!_.isEmpty(S)){var R=_.head(S);if(!_.isEmpty(R.properties)){for(var x=[],U=0,$=R.properties;U<$.length;U++){var Z=$[U];x.push({name:Z.name,type:Z.type})}return x}}}},I.prototype.resolveDataService=function(g){var S=this;return this.datasetStore.findAll(g.id,!0).then(function(R){if(!_.isEmpty(R)){var x=_.find(R,function(U){return null==g.packageId||U.packageId===g.packageId});switch(x||(x=_.find(R,function(U){return(0,me.yE)(U.permissions,7)})),x||(x=_.first(R)),x.realTimeMode){case 1:case 2:return S.realTimeLongPollDataService;case 3:return S.realTimeLongPubNubDataService;default:q.fF.assertFail("invalid realTimeMode")}}},function(R){return R})},I.\u0275fac=function(S){return new(S||I)(W.\u0275\u0275inject(Tt.s),W.\u0275\u0275inject(oe),W.\u0275\u0275inject(fn),W.\u0275\u0275inject(w.y0),W.\u0275\u0275inject(zt.s))},I.\u0275prov=W.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac,providedIn:"root"}),I}(),dn=te(88565),Wn=te(85732),Ct=te(77476),yn=te(12338);function Jn(I,g){if(1&I&&W.\u0275\u0275element(0,"visual-modern",3),2&I){var S=W.\u0275\u0275nextContext();W.\u0275\u0275property("viewModel",S.initialVisual)("allowDeferredRendering",!0)("useOnPushChangeDetection",S.isOnPushChangeDetection)}}var gn=function(){function I(g,S,R,x,U,$,Z,ee){this.localizationService=g,this.conceptualSchemaProxy=S,this.dataProxy=R,this.realTimeData=x,this.visualQueryGenerator=U,this.telemetryService=$,this.store=Z,this.ref=ee,this.onTileError=new W.EventEmitter,this.onClearTileError=new W.EventEmitter}return I.prototype.ngOnChanges=function(g){var R,S=this;if(g.contract){var x=g.contract.previousValue,U=g.contract.currentValue;x?.modelId!==U?.modelId&&(x?.modelId?this.unsubscribe(x).then(function(){U?.modelId&&(S.isInitialized=null,S.initialize())}):U?.modelId&&this.initialize())}null!==(R=g.initialVisual)&&void 0!==R&&R.currentValue&&this.isInitialized&&this.isInitialized.then(function($){$&&S.onDataChanged()})},I.prototype.ngOnInit=function(){var g=this;this.isInitialized?this.isInitialized.then(function(S){S||g.initialize()}):this.initialize()},I.prototype.initialize=function(){return(0,se.mG)(this,void 0,void 0,function(){var S,R,x,U,$=this;return(0,se.Jh)(this,function(Z){switch(Z.label){case 0:return this.isInitialized?[4,this.isInitialized]:[3,2];case 1:if(Z.sent())return[2];Z.label=2;case 2:return S=new M.B,this.isInitialized=S.promise,[4,this.findModelIds(this.contract)];case 3:return(R=Z.sent())?(x=(0,Y.bk)(R.id,R.originalModelId),[4,this.conceptualSchemaProxy.get(x)]):(S.resolve(!1),[2]);case 4:return U=Z.sent(),this.fixUpSchema(U),this.schema=U,this.listener={onDataChanged:function(){$.onDataChanged()},onError:function(ae){$.onErrorChanged(ae)}},[4,this.logEventForRealtimeTile(this.contract)];case 5:return Z.sent(),this.realTimeData.subscribe(this.getRealTimeModelId(R),this.listener),S.resolve(!0),[2]}})})},I.prototype.fixUpSchema=function(g){var S=g.schema(le.db).entities;q.fF.assert(function(){return S&&1===S.length},"Exactly 1 entity is expected.");for(var x=0,U=S[0].properties;x<U.length;x++){var $=U[x];($.type===re.Ge.fromDescriptor({numeric:!0})||$.type===re.Ge.fromDescriptor({integer:!0}))&&($.kind=1)}},I.prototype.getSchemaTableName=function(){var g=this.getRealTimeConceptualSchema();if(g){var S=g.entities;return q.fF.assert(function(){return 1===S.length},"Expecting only one entity"),_.head(S).name}},I.prototype.getRealTimeConceptualSchema=function(){if(this.schema)return this.schema.schema(le.db)},I.prototype.findModelIds=function(g){return(0,se.mG)(this,void 0,void 0,function(){var S;return(0,se.Jh)(this,function(x){switch(x.label){case 0:return[4,this.getDataset(g)];case 1:return(S=x.sent())?[2,{id:S.id,originalModelId:S.originalModelId,packageId:g.packageId}]:[2]}})})},I.prototype.logEventForRealtimeTile=function(g){return(0,se.mG)(this,void 0,void 0,function(){var S,R;return(0,se.Jh)(this,function(x){switch(x.label){case 0:return x.trys.push([0,2,,3]),[4,this.getDataset(g)];case 1:return(S=x.sent())?S.realTimeMode||S.pushDataVersion?(this.telemetryService.logEvent(D.bm,{modelId:S.id,realtimeMode:S.realTimeMode||0,pushdataVersion:S.pushDataVersion||0,controller:"DashboardTileController"}),[3,3]):(q.fF.assertFail("Error logging event for realtime tile. dataset.realtimeMode: ".concat(S.realTimeMode,", dataset.pushDataVersion: ").concat(S.pushDataVersion)),[2]):[2];case 2:return R=x.sent(),q.fF.assertFail("Error logging event for realtime tile. ".concat(R.message)),[3,3];case 3:return[2]}})})},I.prototype.getDataset=function(g){return(0,se.mG)(this,void 0,void 0,function(){return(0,se.Jh)(this,function(S){return[2,this.store.select(Q.pY,{modelId:g.modelId,packageId:g.packageId}).pipe((0,L.q)(1)).toPromise()]})})},I.prototype.getRealTimeModelId=function(g){if(g)return(0,se.pi)((0,se.pi)({},g),{tableName:this.getSchemaTableName(),schema:this.getRealTimeConceptualSchema()})},I.prototype.onDataChanged=function(){return(0,se.mG)(this,void 0,void 0,function(){var g,S,R,x,U,$,Z,ee,ae,de,Te;return(0,se.Jh)(this,function(Ie){switch(Ie.label){case 0:return(g=this.config.realTimeVisual.$visualContainer.config.singleVisual)&&g.visualType?(S=le.PB,(R=this.config.realTimeVisual)&&R.dataWindow&&(S=R.dataWindow),[4,this.findModelIds(this.contract)]):[2];case 1:return x=Ie.sent(),(U=this.getRealTimeModelId(x))?($=(0,Y.bk)(U.id,U.originalModelId),!(Z=this.visualQueryGenerator.execute({dataSources:$,schema:this.schema,config:g,additionalFilters:null,dataWindow:S}))||Z.error?(this.onErrorChanged(Z.error.getDetails(this.localizationService)),[3,5]):[3,2]):[2];case 2:return Ie.trys.push([2,4,,5]),[4,this.dataProxy.execute(Z.options)];case 3:ee=Ie.sent(),ae={dataView:ee&&ee.dataReaderResult?ee.dataReaderResult.dataView:null},de=this.lastCategoryValue;try{if(Te=(0,Y.kQ)(ae.dataView),null!=de&&null!=Te&&de.valueOf()>=Te.valueOf())return[2];this.lastCategoryValue=Te}catch(nr){}return this.initialVisual.data=ae,this.initialVisual.dataTransforms=Z.transforms,this.initialVisual.type=g.visualType,this.loading=!1,this.isOnPushChangeDetection&&this.ref.markForCheck(),[3,5];case 4:return Ie.sent(),[3,5];case 5:return[2]}})})},I.prototype.ngOnDestroy=function(){this.unsubscribe(this.contract)},I.prototype.unsubscribe=function(g){return(0,se.mG)(this,void 0,void 0,function(){var S,R;return(0,se.Jh)(this,function(x){switch(x.label){case 0:return[4,this.findModelIds(g)];case 1:return S=x.sent(),(R=this.getRealTimeModelId(S))&&R.tableName&&this.realTimeData.unsubscribe(R,this.listener),[2]}})})},I.prototype.onErrorChanged=function(g){g?.message?this.onTileError.emit({error:g.message}):this.onClearTileError.emit()},I.\u0275fac=function(S){return new(S||I)(W.\u0275\u0275directiveInject(B.o),W.\u0275\u0275directiveInject(ie.i),W.\u0275\u0275directiveInject(ge.d),W.\u0275\u0275directiveInject(ne),W.\u0275\u0275directiveInject(dn.S),W.\u0275\u0275directiveInject(w.y0),W.\u0275\u0275directiveInject(Wn.yh),W.\u0275\u0275directiveInject(W.ChangeDetectorRef))},I.\u0275cmp=W.\u0275\u0275defineComponent({type:I,selectors:[["real-time-tile-new"]],inputs:{initialVisual:"initialVisual",contract:"contract",config:"config",isOnPushChangeDetection:"isOnPushChangeDetection"},outputs:{onTileError:"onTileError",onClearTileError:"onClearTileError"},features:[W.\u0275\u0275NgOnChangesFeature],decls:3,vars:1,consts:[[1,"realTimeTile","compositeTile"],[1,"visualTile"],[3,"viewModel","allowDeferredRendering","useOnPushChangeDetection",4,"ngIf"],[3,"viewModel","allowDeferredRendering","useOnPushChangeDetection"]],template:function(S,R){1&S&&(W.\u0275\u0275elementStart(0,"div",0)(1,"div",1),W.\u0275\u0275template(2,Jn,1,3,"visual-modern",2),W.\u0275\u0275elementEnd()()),2&S&&(W.\u0275\u0275advance(2),W.\u0275\u0275property("ngIf",!R.loading))},dependencies:[Ct.NgIf,yn.y],encapsulation:2}),I}(),mn=te(50544),$n=te(1316);function Qn(I,g){if(1&I&&W.\u0275\u0275element(0,"visual-modern",3),2&I){var S=W.\u0275\u0275nextContext();W.\u0275\u0275property("viewModel",S.viewModel.visual)("allowDeferredRendering",!0)}}var vn=function(g){return{fullLayout:g}},bn=function(){function I(g,S,R,x,U,$){this.conceptualSchemaProxy=g,this.dataProxy=S,this.realTimeData=R,this.telemetryService=x,this.visualQueryGenerator=U,this.datasetStore=$,this.onTileError=new W.EventEmitter,this.onClearTileError=new W.EventEmitter}return I.prototype.ngOnInit=function(){var g=this;this.viewModel.setRealTimeModelDependencies(this.dataProxy,this.visualQueryGenerator,this.conceptualSchemaProxy,this.realTimeData,this.datasetStore),this.viewModel.onErrorDelegate=function(){return g.onErrorChanged()},this.viewModel.initialize()},I.prototype.ngOnDestroy=function(){var g=this.viewModel;g&&g.unsubscribe()},I.prototype.onErrorChanged=function(){var g=this.viewModel;g&&(g.isError?(this.telemetryService.logEvent($n.UH,{tileType:mn.YU[mn.YU.realTime],message:g.errorText}),this.onTileError.emit({error:g.errorText,errorDetails:g.errorDetails})):this.onClearTileError.emit())},I.\u0275fac=function(S){return new(S||I)(W.\u0275\u0275directiveInject(ie.i),W.\u0275\u0275directiveInject(ge.d),W.\u0275\u0275directiveInject(ne),W.\u0275\u0275directiveInject(w.y0),W.\u0275\u0275directiveInject(dn.S),W.\u0275\u0275directiveInject(Tt.s))},I.\u0275cmp=W.\u0275\u0275defineComponent({type:I,selectors:[["real-time-tile-modern"]],inputs:{viewModel:"viewModel"},outputs:{onTileError:"onTileError",onClearTileError:"onClearTileError"},decls:3,vars:4,consts:[[1,"realTimeTile","compositeTile",3,"ngClass"],[1,"visualTile"],[3,"viewModel","allowDeferredRendering",4,"ngIf"],[3,"viewModel","allowDeferredRendering"]],template:function(S,R){1&S&&(W.\u0275\u0275elementStart(0,"div",0)(1,"div",1),W.\u0275\u0275template(2,Qn,1,2,"visual-modern",2),W.\u0275\u0275elementEnd()()),2&S&&(W.\u0275\u0275property("ngClass",W.\u0275\u0275pureFunction1(2,vn,1===R.viewModel.config.layoutType)),W.\u0275\u0275advance(2),W.\u0275\u0275property("ngIf",!R.viewModel.isLoading&&!R.viewModel.hideVisual))},dependencies:[Ct.NgClass,Ct.NgIf,yn.y],encapsulation:2}),I}(),gt=te(12713),Xn=te(81213),_n=function(){function I(g,S,R,x,U,$){this.datasetStore=g,this.conceptualSchemaProxy=S,this.errorService=R,this.localizationService=x,this.realTimeDataHttpService=U,this.telemetryService=$,this.selectedModelId=null}return I.prototype.setSelected=function(g){q.fF.assertAnyValue(g,"modelId"),this.selectedModelId=g,this.selectedModel=null},I.prototype.getSelected=function(){var g=this;if(this.selectedModel)return Promise.resolve(this.selectedModel);var S=this.getModel(this.selectedModelId);return S.then(function(R){g.selectedModel=R}),S},I.prototype.createModel=function(g){var S=this;return q.fF.assertValue(g,"definition"),new Promise(function(R,x){var U=S.getColumnStatistic(g.columns),$=S.telemetryService.startEvent(ze,{action:"Create",dateTimeColumnCount:U.dateTimeColumnCount,numericColumnCount:U.numericColumnCount,stringColumnCount:U.stringColumnCount,realTimeType:g.mode});S.realTimeDataHttpService.createDataset(g).then(function(Z){var ee=new gt.o(Z.data,g);ee.isNew=!0,S.selectedModel=ee,$.resolve(),R(ee)},function(Z){S.errorService.error(S.localizationService.get("StreamingDataset_FailedToCreateDataset"),"StreamingDataset_FailedToCreateDataset",{requestId:Z.requestId,statusCode:Z.status.toString()});var ee=(0,ve.GB)(Z.error,Z.status);$.reject(ee),x(ee)})})},I.prototype.getModel=function(g){var S=this;if(!g||g<0)return Promise.resolve(null);var R=this.telemetryService.startEvent(Ot);return this.realTimeDataHttpService.getDataset(g).then(function(x){var U=(0,Y.bk)(g),$=x.data;return R.resolve(),S.conceptualSchemaProxy.get(U).then(function(Z){return S.datasetStore.findAll(g).then(function(ee){var ae=_.head(ee);return new gt.o($,gt.o.createRealTimeDatasetDefinition(ae.displayName,ae.realTimeMode,Z))},function(ee){return ee})},function(Z){return Z})},function(x){S.errorService.error(S.localizationService.get("StreamingDataset_FailedToLoadDataset"),"StreamingDataset_FailedToLoadDataset",{requestId:x.requestId,statusCode:x.status.toString()});var U=(0,ve.GB)(x.error,x.status);return R.reject(U),U})},I.prototype.getAndSelectEmptyModel=function(){var g=this.createDefaultRealTimeModel();return this.selectedModel=g,g},I.prototype.updateModel=function(g,S){var R=this;return q.fF.assertValue(S||this.selectedModelId,"modelId or selectedModelId"),new Promise(function(x,U){var $=R.getColumnStatistic(g.columns),Z=R.telemetryService.startEvent(ze,{action:"Update",dateTimeColumnCount:$.dateTimeColumnCount,numericColumnCount:$.numericColumnCount,stringColumnCount:$.stringColumnCount,realTimeType:g.mode}),ee=(0,Y.bk)(S||R.selectedModelId);R.conceptualSchemaProxy.clearCache(null,ee),R.realTimeDataHttpService.updateDataset(S||R.selectedModelId,g).then(function(){Z.resolve(),x()},function(ae){R.errorService.error(R.localizationService.get("StreamingDataset_FailedToUpdateDataset"),"StreamingDataset_FailedToUpdateDataset",{requestId:ae.requestId,statusCode:ae.status.toString()});var de=(0,ve.GB)(ae.error,ae.status);Z.reject(de),U(de)})})},I.prototype.deleteModel=function(g){var S=this;return this.datasetStore.findAll(g).then(function(R){var x=_.head(R),U=S.telemetryService.startEvent(ze,{action:"Delete",realTimeType:x.realTimeMode});return S.datasetStore.delete(x,!1,U).then(function(){S.selectedModelId===g&&(S.selectedModelId=null,S.selectedModel=null)})})},I.prototype.getColumnStatistic=function(g){for(var S={dateTimeColumnCount:0,numericColumnCount:0,stringColumnCount:0},R=0,x=g;R<x.length;R++){var U=x[R];2===U.dataType?S.dateTimeColumnCount++:1===U.dataType?S.numericColumnCount++:0===U.dataType&&S.stringColumnCount++}return S},I.prototype.createDefaultRealTimeModel=function(){var S=new gt.o(null,{name:"",columns:[],mode:1});return S.isNew=!0,S},I.\u0275fac=function(S){return new(S||I)(W.\u0275\u0275inject(Tt.s),W.\u0275\u0275inject(ie.i),W.\u0275\u0275inject(Xn.T),W.\u0275\u0275inject(B.o),W.\u0275\u0275inject(Ht),W.\u0275\u0275inject(w.y0))},I.\u0275prov=W.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac,providedIn:"root"}),I}(),Yn=te(32288),Zn=te(77906),Sn=te(25850),Pn=[{provide:"realTimeModel",useExisting:_n},Sn.n,{provide:"pubNubAngularService",useExisting:Sn.n}],er=[{type:bn,componentId:"RealTimeTileComponentId"},{type:gn,componentId:"RealTimeTileComponentNewId"}],tr=function(){function I(){}return I.forRoot=function(){return{ngModule:I,providers:Pn}},I.\u0275fac=function(S){return new(S||I)},I.\u0275mod=W.\u0275\u0275defineNgModule({type:I}),I.\u0275inj=W.\u0275\u0275defineInjector({providers:Pn,imports:[Ct.CommonModule,Yn.J,Zn.N.withManifests(er)]}),I}()},68276:function(xe){"use strict";xe.exports=JSON.parse('{"pubnub_prefix":"pubnub","default_instance_name":"default","attributes_to_delegate":["channelGroups","push"],"methods_to_delegate":["addListener","removeListener","removeAllListeners","hereNow","whereNow","getState","setState","grant","audit","publish","fire","history","deleteMessages","fetchMessages","time","reconnect","stop","unsubscribeAll","getSubscribedChannels","getSubscribedChannelGroups","encrypt","decrypt","getAuthKey","setAuthKey","setCipherKey","getUUID","setUUID","getFilterExpression","setFilterExpression"],"common_callbacks_to_wrap":["callback","error"],"subscribe_listener_events_to_broadcast":["message","presence","status"],"history_sort_attribute":"timetoken"}')}}]);