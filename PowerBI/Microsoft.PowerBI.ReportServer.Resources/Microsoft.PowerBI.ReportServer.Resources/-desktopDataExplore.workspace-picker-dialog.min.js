"use strict";(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["workspace-picker-dialog"],{55924:function(I,d,o){o.r(d),o.d(d,{WorkspacePickerDialogModule:function(){return Z}});var l=o(77476),m=o(76966),h=o(59022),u=o(47768),f=o(78035),B=o(16149),y=o(44913),C=o(46303),b=o(5915),v=o(81337),w=o(35510),E=o(59017),O=o(11547),T=o(14172),N=o(4633),S=o(67489),P=o(94759),z=o(14714),L=o(9522),e=o(50423),j=o(7452),F=o(96777),V=o(45769),Q=o(65e3),x=o(20551),R=o(64716),U=o(85721),H=o(89237),J=o(54729),A=o(55334);function G(i,a){if(1&i&&e.\u0275\u0275element(0,"tri-message-bar",9),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBarViewModel)}}function $(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-trigger"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.selectedWorkspace.displayName)}}function K(i,a){if(1&i&&(e.\u0275\u0275elementStart(0,"tri-dropdown-item",10),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=a.$implicit;e.\u0275\u0275property("value",t.objectId),e.\u0275\u0275attribute("aria-label",t.displayName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function X(i,a){1&i&&(e.\u0275\u0275elementStart(0,"tri-spinner",11),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Workspaces_Picker_Loading")))}var Y=function(){function i(a,t,r,n){this.llmStatusService=a,this.triLocalizationService=t,this.templateDialogPayload=r,this.telemetryService=n,this.selectedWorkspace=void 0,this.messageBarViewModel=void 0,this.loading=!1,this.maxItems=8,this.dropdownOptions={showFullContent:!0,dropdownMaxHeight:(0,y.Vh)({totalItems:this.maxItems,hasSearchBox:!0}),dropdownMinHeight:(0,y.Vh)({totalItems:1})},this.searchText=new w.X(""),this.responseStatuses=[],this.errors=[]}return i.prototype.ngOnInit=function(){var a=this;this.messageBarViewModel=this.templateDialogPayload.input.infoMessage,this.workspaces=this.templateDialogPayload.input.workspaces.sort(function(t,r){return t.displayName.localeCompare(r.displayName)}),this.scenarioNames=this.templateDialogPayload.input.scenarioNames,this.templateDialogPayload.setOkButtonState(!0),this.templateDialogPayload.onOkButtonClick=function(){return a.ok()},this.templateDialogPayload.onCancelButtonClick=function(){return a.cancel()},this.selectedWorkspace=this.findSelectedWorkspace(this.templateDialogPayload.input.selectedWorkspaceObjectId),this.filteredWorkspaces$=(0,E.aj)([this.searchText,(0,O.of)(this.workspaces)]).pipe((0,T.U)(function(t){var r=t[0];return t[1].filter(function(s){return s.displayName.toLowerCase().includes(r.toLowerCase())})}))},i.prototype.ok=function(){return this.logTelemetry(),Promise.resolve(this.selectedWorkspace)},i.prototype.cancel=function(){return this.logTelemetry(!0),Promise.resolve(void 0)},i.prototype.logTelemetry=function(a){void 0===a&&(a=!1);var t=JSON.stringify(this.responseStatuses),r=JSON.stringify(this.errors),n=JSON.stringify(this.scenarioNames);this.telemetryService.logEvent(L.VD,{isCancelled:a,scenarioNames:n,events:t,errors:r})},i.prototype.onSearch=function(a){this.searchText.next(a)},i.prototype.onSelectWorkspace=function(a){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(t){switch(t.label){case 0:return this.loading=!0,this.resetState(),a?(this.selectedWorkspace=this.findSelectedWorkspace(a),[4,this.validateSelectedWorkspace(a)]):[3,2];case 1:t.sent(),t.label=2;case 2:return this.loading=!1,[2]}})})},i.prototype.findSelectedWorkspace=function(a){return _.find(this.workspaces,function(t){return t.objectId===a})},i.prototype.validateSelectedWorkspace=function(a){var t,r,n;return(0,v.__awaiter)(this,void 0,void 0,function(){var s,g,c,M;return(0,v.__generator)(this,function(p){switch(p.label){case 0:if(null===(t=this.scenarioNames)||void 0===t||!t.length)return this.templateDialogPayload.setOkButtonState(!1),[2];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.llmStatusService.getStatusForLanguageModels({workspaceId:a,scenarioNames:this.scenarioNames,artifactInfo:{artifactType:"Report"}}).toPromise()];case 2:return s=p.sent(),g=Object.values(null!==(r=s?.copilotModelsStatus)&&void 0!==r?r:{}),this.responseStatuses.push(g),g.some(function(k){return k.reason===P.D3.DisabledForCrossGeo})?(this.setErrorBanner(this.triLocalizationService.get("CopilotCapability_GeoFailed_Message")),[2]):g.some(function(k){return k.reason===P.D3.DisabledForTenant})?(this.setErrorBanner(this.triLocalizationService.get("CopilotCapability_CapacityFailed_Message")),[2]):(this.templateDialogPayload.setOkButtonState(!1),[3,4]);case 3:return c=p.sent(),this.errors.push(c),M=null!==(n=c?.error)&&void 0!==n&&n.message?c.error.message:this.triLocalizationService.get("ServerError_UnknownError"),this.setErrorBanner(M),[3,4];case 4:return[2]}})})},i.prototype.setErrorBanner=function(a){this.messageBarViewModel={bannerType:1,message:a,isRoundedCorners:!0}},i.prototype.resetState=function(){var a;null===(a=this.searchBox)||void 0===a||a.clear(),this.messageBarViewModel=void 0,this.templateDialogPayload.setOkButtonState(!0)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(z.ey),e.\u0275\u0275directiveInject(j.z),e.\u0275\u0275directiveInject(S.x),e.\u0275\u0275directiveInject(N.y0))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["workspace-picker-dialog"]],viewQuery:function(t,r){var n;(1&t&&e.\u0275\u0275viewQuery(C.U,5),2&t)&&(e.\u0275\u0275queryRefresh(n=e.\u0275\u0275loadQuery())&&(r.searchBox=n.first))},features:[e.\u0275\u0275ProvidersFeature([S.x])],decls:24,vars:33,consts:[[1,"picker-description"],["href","https://go.microsoft.com/fwlink/?linkid=2249079","target","_blank",3,"external","showExternalIcon"],[3,"viewModel",4,"ngIf"],[1,"picker-description-title"],[3,"value","options","isDisabled","placeholder","valueChange"],[4,"ngIf"],[3,"placeholderText","disableTabIndex","value"],["class","dropdown-item",3,"value",4,"ngFor","ngForOf"],["size","tiny","labelPosition","after",4,"ngIf"],[3,"viewModel"],[1,"dropdown-item",3,"value"],["size","tiny","labelPosition","after"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"p",0),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275element(4,"br"),e.\u0275\u0275elementStart(5,"tri-link",1),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"p",0),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,G,1,1,"tri-message-bar",2),e.\u0275\u0275elementStart(13,"p",3),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"tri-dropdown",4),e.\u0275\u0275listener("valueChange",function(s){return r.onSelectWorkspace(s)}),e.\u0275\u0275pipe(17,"localize"),e.\u0275\u0275template(18,$,2,1,"tri-dropdown-trigger",5),e.\u0275\u0275elementStart(19,"tri-search-box",6),e.\u0275\u0275listener("value",function(s){return r.onSearch(s)}),e.\u0275\u0275pipe(20,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,K,2,3,"tri-dropdown-item",7),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(23,X,3,3,"tri-spinner",8),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,17,"CopilotCapability_Connect_Message")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("external",!0)("showExternalIcon",!1),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,19,"CopilotCapability_Requirements_LearnMore")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,21,"CopilotCapability_Requirements_LearnMore")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,23,"CopilotCapability_Change_Workspace_Message")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.messageBarViewModel),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(15,25,"WorkspacesSelect_Label_Text")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",null==r.selectedWorkspace?null:r.selectedWorkspace.objectId)("options",r.dropdownOptions)("isDisabled",r.loading)("placeholder",e.\u0275\u0275pipeBind1(17,27,"WorkspacesSelect_Label_Text")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.selectedWorkspace),e.\u0275\u0275advance(1),e.\u0275\u0275property("placeholderText",e.\u0275\u0275pipeBind1(20,29,"Workspaces_Picker_Search"))("disableTabIndex",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(22,31,r.filteredWorkspaces$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.loading))},dependencies:[l.NgForOf,l.NgIf,F.J,V.h,Q.v,x.M3,R.l,U.q,x.ii,H.U,J.D,l.AsyncPipe,A.Y],styles:["[_nghost-%COMP%]{color:var(--colorNeutralForeground1)}.workspace-picker-dialog[_ngcontent-%COMP%]{border-radius:var(--borderRadiusXLarge)}.picker-description-title[_ngcontent-%COMP%]{margin:0 0 4px;font-size:var(--md-font-size);line-height:var(--lineHeightBase300);font-weight:var(--fontWeightSemibold)}.picker-description[_ngcontent-%COMP%]{margin-top:0;margin-bottom:8px;font-size:var(--md-font-size);line-height:var(--lineHeightBase300)}tri-search-box[_ngcontent-%COMP%], tri-dropdown[_ngcontent-%COMP%]{width:100%}tri-message-bar[_ngcontent-%COMP%]{margin-bottom:10px}tri-spinner[_ngcontent-%COMP%]{display:inline-block;margin-top:4px}"]}),i}(),Z=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[l.CommonModule,m.c.withManifest([{componentIdentifier:h.U,componentType:Y}]),u.I,f.Y,B.m,y.lK,C.b,b.d]}),i}()},9522:function(I,d,o){o.d(d,{VD:function(){return f},pO:function(){return h}});var l=o(41114),m="PBI.QuickSaveDialog",h=l.cx[m]=(0,l.b1)(m),u="PBI.WorkspacePickerDialog",f=l.cx[u]=(0,l.b1)(u)}}]);