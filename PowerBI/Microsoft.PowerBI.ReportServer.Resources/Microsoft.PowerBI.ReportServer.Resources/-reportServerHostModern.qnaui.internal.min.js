"use strict";(self.webpackChunkreportServerHostModern=self.webpackChunkreportServerHostModern||[]).push([["qnaui.internal"],{8898:function(Ze,me,p){p.d(me,{x:function(){return B}});var B=new(p(50423).InjectionToken)("EventAggregationServiceToken")},65947:function(Ze,me,p){p.d(me,{z:function(){return B}});var B=new(p(50423).InjectionToken)("QnaModelUtilsPath")},12123:function(Ze,me,p){p.d(me,{n:function(){return B}});var B=new(p(50423).InjectionToken)("QnaProxyPath")},71148:function(Ze,me,p){p.d(me,{b:function(){return B}});var B=new(p(50423).InjectionToken)("QnaToolingDialogLauncherService")},70940:function(Ze,me,p){p.d(me,{s:function(){return N}});var D=p(47508),B=p(45034),J=new B.o(function(){var E={};return E[3]=D.L.card,E[13]=D.L.lineClusteredColumnComboChart,E[29]=D.L.multiRowCard,E[7]=D.L.clusteredBarChart,E[10]=D.L.clusteredColumnChart,E[20]=D.L.donutChart,E[16]=D.L.funnel,E[30]=D.L.gauge,E[22]=D.L.heatMap,E[9]=D.L.hundredPercentStackedBarChart,E[12]=D.L.hundredPercentStackedColumnChart,E[4]=D.L.lineChart,E[1]=D.L.map,E[19]=D.L.filledMap,E[2]=D.L.pivotTable,E[5]=D.L.pieChart,E[6]=D.L.scatterChart,E[8]=D.L.barChart,E[11]=D.L.columnChart,E[0]=D.L.tableEx,E[17]=D.L.treemap,E[23]=D.L.waterfallChart,E[26]=D.L.stackedAreaChart,E[27]=D.L.hundredPercentStackedAreaChart,E[32]=D.L.areaChart,E[33]=D.L.ribbonChart,E[34]=D.L.kpi,E[35]=D.L.decompositionTreeVisual,E});function N(E){return J.getValue()[E]}new B.o(function(){var E={};return E[D.L.card.name]=3,E[D.L.lineClusteredColumnComboChart.name]=13,E[D.L.multiRowCard.name]=29,E[D.L.clusteredBarChart.name]=7,E[D.L.clusteredColumnChart.name]=10,E[D.L.donutChart.name]=20,E[D.L.funnel.name]=16,E[D.L.gauge.name]=30,E[D.L.heatMap.name]=22,E[D.L.hundredPercentStackedBarChart.name]=9,E[D.L.hundredPercentStackedColumnChart.name]=12,E[D.L.lineChart.name]=4,E[D.L.map.name]=1,E[D.L.filledMap.name]=19,E[D.L.matrix.name]=2,E[D.L.pivotTable.name]=2,E[D.L.pieChart.name]=5,E[D.L.scatterChart.name]=6,E[D.L.barChart.name]=8,E[D.L.columnChart.name]=11,E[D.L.table.name]=0,E[D.L.tableEx.name]=0,E[D.L.treemap.name]=17,E[D.L.waterfallChart.name]=23,E[D.L.stackedAreaChart.name]=26,E[D.L.hundredPercentStackedAreaChart.name]=27,E[D.L.areaChart.name]=32,E[D.L.ribbonChart.name]=33,E[D.L.kpi.name]=34,E[D.L.decompositionTreeVisual.name]=35,E})},76126:function(Ze,me,p){p.r(me),p.d(me,{QnaUIInternalModule:function(){return Zs}});var D=p(77476),B=p(52910),J=p(76966),q=p(558),N=p(22824),z=p(76521),E=p(82156),ue=p(79061),j=p(67659),le=p(48501),pe=p(16095),Ve=p(22760),De=p(1931),ge=p(98665),et=p(47768),We=p(94785),ft=p(47231),C=p(81337),he=p(14172),ie=p(83317),tt=p(30794),G=p(73446),g=p(62458),n=p(50423),te=p(43286),de=p(37320),k=p(16808),b=p(72129),x=p(282),V=p(48787),U=p(17653),W=p(57243),H=p(77526),X=p(83495),re=p(18353),ne=p(59973),ye=p(81905),qe=p(46358),$e=p(23558),ee=p(35510),Me=p(59787),Pe=p(11547),ke=p(59017),Ue=p(40133),Oe=p(82762),Le=p(63057),mt=p(35988),vt=p(1521),Mt=p(87632),wt=p(59107),nt=p(32105),je=p(31982),qt=p(65947),Bt=p(12123),en=p(87974),Fe=p(38078);function nn(i){i.remove?i.remove():i.parentNode&&i.parentNode.removeChild?i.parentNode.removeChild(i):g.fF.assertFail("No remove element API found")}function Tt(i){return i.isComposing||229===i.keyCode}function vn(i){if(g.fF.assertValue(i,"response"),!_.isEmpty(i.utterance)){for(var e=i.utterance,t=[],r=0,o=_.first(i.results),s=0,u=o&&o.spans||[];s<u.length;s++){var c=u[s];if(r<c.startIndex){var l=rn(e,r,c.startIndex);t.push.apply(t,l||[])}t.push(c),r=c.endExcludingIndex}if(r<e.length){var d=rn(e,r,e.length);t.push.apply(t,d||[])}return t}}function Xe(i){return i&&i.replace(/\s/g," ")}function jt(i,e){if(i){if(i.nodeType===Node.TEXT_NODE)return i;for(var t=i.childNodes,r=_.size(t),a=0,s=e?_.range(0,r):_.range(r-1,-1,-1);a<s.length;a++){var l=jt(t[s[a]],e);if(l)return l}}}function rn(i,e,t){for(var r=[],o=e;o<t;){var a=o,s=void 0,u=void 0;if(/\s/.test(i.charAt(o)))u=!0,s=a+1,o++;else{u=!1;var c=i.indexOf(" ",o);s=c=c>-1?Math.min(c,t):t,o=c}var l=i.substring(a,s);r.push({startIndex:a,endExcludingIndex:s,text:l,isWhiteSpace:u,isOverlapping:!1,isCorrected:!1,isUnknown:!1,isUsed:!1,state:"none"})}return r}function h(i,e){if(g.fF.assertValue(i,"The given node must be defined"),g.fF.assertValue(e>=0,"The given nodeTextContentOffset must be >= 0"),g.fF.assert(function(){return i.nodeType!==Node.COMMENT_NODE},"Expect the given node is NOT a comment node"),0===e)return{node:jt(i,!0)||i,textOrChildNodesOffset:0};if(e>i.textContent.length)return{node:void 0,textOrChildNodesOffset:-1};if(_.isEmpty(i.childNodes))return g.fF.assert(function(){return i.nodeType===Node.TEXT_NODE},"0 < nodeTextContentOffset <= node.textContent.length, and node has no childNodes, then node should be a TEXT_NODE"),{node:i,textOrChildNodesOffset:e};for(var o=e,a=0;a<i.childNodes.length;a++){var s=i.childNodes.item(a);if(s.nodeType!==Node.COMMENT_NODE){var u=s.textContent.length;if(o>u){o-=u;continue}if(s.nodeType===Node.TEXT_NODE)return{node:s,textOrChildNodesOffset:o};if(o===u){var c=jt(s,!1);return c?{node:c,textOrChildNodesOffset:c.textContent.length}:{node:i,textOrChildNodesOffset:a+1}}return h(s,o)}}g.fF.assertFail("nodeTextContentOffset <= node.textContent.length, there should be a descendant (or same) Node that the given position lands on")}function y(i,e){return!(!i||!e)&&(i===e||(e.nodeType===Node.ELEMENT_NODE?i.contains(e):y(i,e.parentNode)))}var M=p(41114),oe="PBI.QnaVisual.Initialized",Ie=M.cx[oe]=(0,M.b1)(oe,{logExpAssignment:!0}),fe="PBI.QnaAutoComplete.Initialized",Qe=M.cx[fe]=(0,M.b1)(fe),_t="PBI.QnaAutoComplete.DropdownSelected",it=M.cx[_t]=(0,M.b1)(_t),rt="PBI.ImproveLsdlBackground.Login",Ct=M.cx[rt]=(0,M.b1)(rt),St="PBI.ImproveLsdlBackground.Prompt",Cn=M.cx[St]=(0,M.b1)(St),Dn="PBI.ImproveLsdlBackground.Result",yn=M.cx[Dn]=(0,M.b1)(Dn);function En(i,e){var t=0,r=[];return _.forEach(i,function(o,a){var s;o.title&&t++;var u=e-t;return u<=0?_.take(i,a):_.size(o.groupItems)<=u?(t+=_.size(o.groupItems),void r.push({title:o.title,groupItems:(0,C.ev)([],null!==(s=o?.groupItems)&&void 0!==s?s:[],!0)})):(r.push({title:o.title,groupItems:_.take(o.groupItems,u)}),r)}),r}function st(i,e,t,r,o){g.fF.assert(function(){return!_.isEmpty(t)},"Expect the given bindingCategories NOT empty!"),g.fF.assertValue(r,"uniqueItemsTextList must be defined already");var a=i[e];g.fF.assertValue(a,"spans[selectedSpanIndex] must be defined!");var s=[];return _.forEach(t,function(u){var c=function(i,e){var t=i.replacementBindings;switch(e){case 1:return t&&t.alternates;case 2:return t&&t.phraseCompletions;case 3:return t&&t.suggestedReplacements;case 0:return i.binding?[i.binding]:[];case 4:return t&&t.phraseExtensions;default:return void g.fF.assertFail("Unhandled SpanBindingCategory value")}}(a,u),l=[];_.forEach(c,function(d){l.push({segments:d.textSegmentsWithMatchInfo,score:d.score,bindingCategory:u})}),l.sort(function(d,f){return f.score-d.score}),s.push.apply(s,l)}),_n(i,e,s,r,o)}function _n(i,e,t,r,o){var a=[],s=i[e];if(_.forEach(t,function(v){var F=[];_.forEach(i,function(I,T){T!==e?F.push({text:I.text,isMatched:!0}):(g.fF.assertValue(_.isEmpty(v)||v.segments,"selectedSpanOneBindingText.segments"),_.isEmpty(v)||F.push.apply(F,v.segments||[]))}),Et(F,a,r,v.score)}),!(_.findIndex(t,function(v){return 0===v.bindingCategory})>=0||_.isEmpty(s.overlapSpans))){var c=Math.max(0,_.findLastIndex(t,function(v){return 1===v.bindingCategory})),l=function(i,e,t,r){var o=[],a=_.map(i,function(c){return c.text}).join("");return _.isEmpty(i[e].overlapSpans)||(i[e].overlapSpans=_.filter(i[e].overlapSpans,function(c){return _.inRange(r,c.startIndex,c.endExcludingIndex+1)})),_.forEach(i[e].overlapSpans,function(c){var l=[],d=0;_.forEach(i,function(v){v.endExcludingIndex<=c.startIndex?(l.push({text:v.text,isMatched:!0}),d++):v.startIndex<c.endExcludingIndex?(v.startIndex<c.startIndex&&(l.push({text:a.substring(v.startIndex,c.startIndex),isMatched:!0}),d++),c.endExcludingIndex<v.endExcludingIndex&&l.push({text:a.substring(c.endExcludingIndex,v.endExcludingIndex),isMatched:!0})):l.push({text:v.text,isMatched:!0})}),_.forEach(c.replacementBindings&&c.replacementBindings.alternates,function(v){for(var F=_.cloneDeep(l),I=v.textSegmentsWithMatchInfo,T=I.length-1;T>=0;T--)F.splice(d,0,I[T]);Et(F,o,t,v.score)})}),o}(i,e,r,o),d=_.slice(a,0,c),f=(0,C.ev)((0,C.ev)([],d,!0),l,!0);f.sort(function(v,F){return F.score-v.score}),a=(0,C.ev)((0,C.ev)([],f,!0),_.slice(a,c),!0)}return a}function Et(i,e,t,r){var o=_.map(i,function(a){return a.text}).join("");-1===_.indexOf(t,o)&&(t.push(o),e.push({textSegments:i,text:o,score:r}))}var Vt=new n.InjectionToken("QnaUnknownTermService"),Pt=p(64647),At=p(83309),Ut=p(65181),Gt=p(59968),Lt=p(44581),an=function(e,t,r,o,a){return{"font-size":e,"font-family":t,"font-weight":r,"font-style":o,"text-decoration":a}};function Hn(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"h4",7),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext().$implicit,r=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction5(2,an,r.presentation.value.questionFontProperties.size.px+"px",r.presentation.value.questionFontProperties.family,r.presentation.value.questionFontProperties.bold,r.presentation.value.questionFontProperties.italic,r.presentation.value.questionFontProperties.underline)),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.title)}}var Mn=function(e){return{matchedSegment:e}};function Ht(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"span",15),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()),2&i){var t=e.$implicit;n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(3,Mn,!t.isMatched)),n.\u0275\u0275attribute("aria-hidden",!0),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.text)}}function Wt(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",13),n.\u0275\u0275template(1,Ht,2,5,"span",14),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.textSegments)}}function $t(i,e){1&i&&(n.\u0275\u0275elementStart(0,"div",16),n.\u0275\u0275element(1,"span",17),n.\u0275\u0275elementEnd())}var ae=function(e,t,r,o,a,s){return{backgroundColor:e,"font-size":t,"font-family":r,"font-weight":o,"font-style":a,"text-decoration":s}},Wn=function(e,t,r,o){return{selected:e,themableBackgroundColorSelected:t,showMoreItem:r,showAsGroupTitle:o}};function $n(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"li",10),n.\u0275\u0275listener("mouseenter",function(){var l=n.\u0275\u0275restoreView(t).index,d=n.\u0275\u0275nextContext(2).index,f=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(f.updateHoverItemIndex(d,l))})("accessible-click",function(){var l=n.\u0275\u0275restoreView(t).$implicit,d=n.\u0275\u0275nextContext(4);return n.\u0275\u0275resetView(d.selectDropdownItem(l))}),n.\u0275\u0275template(1,Wt,2,1,"div",11),n.\u0275\u0275template(2,$t,2,0,"div",12),n.\u0275\u0275elementEnd()}if(2&i){var r=e.$implicit,o=e.index,a=n.\u0275\u0275nextContext(2).index,s=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction6(5,ae,s.presentation.value.useShellTheme?"":o===s.selectedSpanIndex&&a===s.selectedGroupIndex||o===s.hoverSpanIndex&&a===s.hoverGroupIndex?s.presentation.value.hoverColor:s.presentation.value.backgroundColor,s.presentation.value.questionFontProperties.size.px+"px",s.presentation.value.questionFontProperties.family,s.presentation.value.questionFontProperties.bold,s.presentation.value.questionFontProperties.italic,s.presentation.value.questionFontProperties.underline))("ngClass",n.\u0275\u0275pureFunction4(12,Wn,o===s.selectedSpanIndex&&a===s.selectedGroupIndex||o===s.hoverSpanIndex&&a===s.hoverGroupIndex,o===s.selectedSpanIndex&&a===s.selectedGroupIndex||o===s.hoverSpanIndex&&a===s.hoverGroupIndex,r.isShowMore,r.isShowMore&&s.hasGroupTitle)),n.\u0275\u0275attribute("aria-selected",o===s.selectedSpanIndex&&a===s.selectedGroupIndex?"true":"false"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",!r.isShowMore),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",r.isShowMore)}}function wn(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"ul",8),n.\u0275\u0275template(1,$n,3,17,"li",9),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.groupItems)}}function K(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"li",4),n.\u0275\u0275template(1,Hn,2,8,"h4",5),n.\u0275\u0275template(2,wn,2,1,"ul",6),n.\u0275\u0275elementEnd()),2&i){var t=e.$implicit,r=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction5(3,an,r.presentation.value.questionFontProperties.size.px+"px",r.presentation.value.questionFontProperties.family,r.presentation.value.questionFontProperties.bold,r.presentation.value.questionFontProperties.italic,r.presentation.value.questionFontProperties.underline)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.title&&(null==t.groupItems?null:t.groupItems.length)>0),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.groupItems)}}var m=function(e,t){return{link:e,fixRequestedText:t}},P=function(e){return{"border-top-color":e}};function A(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"span",20),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(a.performActionsInUnknownSpanHeader())}),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext(3);n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(3,m,!r.disableUnknownSpanHeaderSubtitleAction,r.isUnknownSpanHeaderForFixRequested))("innerHTML",r.unknownSpanHeaderSubtitle,n.\u0275\u0275sanitizeHtml)("ngStyle",n.\u0275\u0275pureFunction1(6,P,r.presentation.value.useShellTheme?"":r.presentation.value.questionFontProperties.color))}}function Q(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"h4",18)(1,"span"),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(3,A,1,8,"span",19),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction5(3,an,t.presentation.value.questionFontProperties.size.px+"px",t.presentation.value.questionFontProperties.family,t.presentation.value.questionFontProperties.bold,t.presentation.value.questionFontProperties.italic,t.presentation.value.questionFontProperties.underline)),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(t.unknownSpanHeaderTitle),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.unknownSpanHeaderSubtitle)}}var L=function(e,t){return{backgroundColor:e,color:t}};function O(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"ul",1),n.\u0275\u0275template(1,K,3,9,"li",2),n.\u0275\u0275template(2,Q,4,9,"h4",3),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction2(3,L,t.presentation.value.useShellTheme?"":t.presentation.value.backgroundColor,t.presentation.value.useShellTheme?"":t.presentation.value.questionFontProperties.color)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t.autoCompleteViewModel.dropdownGroups),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.showUnknownSpanHeader)}}var Z=/\u00a0/g,Y="qna_autocomplete_open",ve="qna_autocomplete_item",ce=function(){function i(e,t,r,o,a){this.highContrastCssGenerationService=e,this.localizationService=t,this.screenReaderService=r,this.telemetryService=o,this.unknownTermService=a,this.utteranceSelected=new n.EventEmitter,this.fullyExpanded=new n.EventEmitter,this.destroy$=new tt.xQ,this.resetSelectedIndices(),this.resetHoverIndices(),this.initializeHighContrastRules()}return i.prototype.ngOnInit=function(){var e=this;this.maxItemCountInFullExpansion=this.maxItemCountInFullExpansion>0?this.maxItemCountInFullExpansion:10,this.maxItemCountInPartialExpansion=this.maxItemCountInPartialExpansion>0?this.maxItemCountInPartialExpansion:4,g.fF.assert(function(){return e.maxItemCountInFullExpansion>=e.maxItemCountInPartialExpansion},"maxItemCountInFullExpansion is less than maxItemCountInPartialExpansion. It does not make sense so we are setting maxItemCountInFullExpansion to be maxItemCountInPartialExpansion now."),this.maxItemCountInFullExpansion=Math.max(this.maxItemCountInFullExpansion,this.maxItemCountInPartialExpansion),this.params.pipe((0,ie.R)(this.destroy$)).subscribe(function(t){return e.generateDropdownItems(t)}),this.selectPrevious.pipe((0,ie.R)(this.destroy$)).subscribe(function(){return e.moveSelectionUp()}),this.selectNext.pipe((0,ie.R)(this.destroy$)).subscribe(function(){return e.moveSelectionDown()}),this.confirmSelection.pipe((0,ie.R)(this.destroy$)).subscribe(function(){return e.selectCurrentDropdownItem()}),this.initializedTelemetryEvent=this.telemetryService.logEvent(Qe),this.isInitialized=!0},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete(),this.screenReaderService.cancelDebounce(ve)},i.prototype.updateHoverItemIndex=function(e,t){this.resetSelectedIndices(),this.hoverGroupIndex=e,this.hoverSpanIndex=t,this.screenReaderCurrentDropdownSelection(e,t)},i.prototype.selectDropdownItem=function(e){if(this.isInitialized){if(e.isShowMore)return void this.expandAllItems();e&&e.textSegments&&(this.utteranceSelected.emit({utterance:e.text,tags:["Dropdown","Committed"]}),this.telemetryService.logChildEvent(this.initializedTelemetryEvent,it,{spanState:this.selectedSpan.state}))}},i.prototype.performActionsInUnknownSpanHeader=function(){var e,t;return(0,C.mG)(this,void 0,void 0,function(){var r,o;return(0,C.Jh)(this,function(a){switch(a.label){case 0:return this.disableUnknownSpanHeaderSubtitleAction?[2]:(r=_.map(this.params.value.spans,function(s){return s.text}).join(""),[4,this.unknownTermService.handleUnknownTerm(r,this.selectedSpan.text,this.params.value.dataSourceArray,this.params.value.exploration,null===(t=null===(e=this.params.value.config.header)||void 0===e?void 0:e.unknownSpanHeaderConfig)||void 0===t?void 0:t.actionType)]);case 1:return 0===(o=a.sent())?(this.unknownSpanHeaderSubtitle=this.localizationService.get("Qna_AutoComplete_FixRequestedLabelText"),this.disableUnknownSpanHeaderSubtitleAction=!0,this.isUnknownSpanHeaderForFixRequested=!0,this.utteranceSelected.emit({utterance:r,tags:["Dropdown","AskToAdd","Committed"],showDropdown:!0,action:o})):this.utteranceSelected.emit({utterance:void 0,action:o}),[2]}})})},Object.defineProperty(i.prototype,"hasGroupTitle",{get:function(){var t;return _.some(null===(t=this.autoCompleteViewModel)||void 0===t?void 0:t.dropdownGroups,function(r){return!_.isEmpty(r.title)})},enumerable:!1,configurable:!0}),i.prototype.expandAllItems=function(){var e=this;g.fF.assertValue(this.shouldDisplayShowMore,"Expect this be called only when this.shouldDisplayShowMore is true"),g.fF.assertValue(this.autoCompleteViewModel,"Expect this.autoCompleteViewModel to be defined"),this.shouldDisplayShowMore=!1,g.fF.assert(function(){return _.last(_.last(e.autoCompleteViewModel.dropdownGroups).groupItems).isShowMore},"last group should be for showMore item");var t=_.size(this.autoCompleteViewModel.dropdownGroups)-2;g.fF.assert(function(){return t>=0},"expect lastVisibleGroupIndex>=0 before click ShowMore");var r=_.size(this.autoCompleteViewModel.dropdownGroups[t].groupItems)-1;g.fF.assert(function(){return r>=0},"expect lastVisiableItemIndex>=0 before click ShowMore"),this.autoCompleteViewModel.dropdownGroups=this.allDropdownGroups;var o=Ee(this.autoCompleteViewModel.dropdownGroups,{groupIndex:t,itemIndex:r});this.selectedGroupIndex=o.groupIndex,this.selectedSpanIndex=o.itemIndex,this.screenReaderCurrentDropdownSelection(this.selectedGroupIndex,this.selectedSpanIndex),this.fullyExpanded.emit()},i.prototype.moveSelectionUp=function(){var t,r,e=this;if(this.isInitialized&&(!this.selectPrevious||void 0!==this.selectPrevious.value)&&null!==(t=this.autoCompleteViewModel)&&void 0!==t&&t.dropdownGroups){if(g.fF.assert(function(){return e.selectedSpanIndex>=0},"Expect selectedSpanIndex >= 0"),this.selectedSpanIndex>0)this.selectedSpanIndex--;else if(0===this.selectedSpanIndex)if(this.selectedGroupIndex>0)this.selectedGroupIndex--,this.selectedSpanIndex=this.autoCompleteViewModel.dropdownGroups[this.selectedGroupIndex].groupItems.length-1;else if(0===this.selectedGroupIndex)this.selectedGroupIndex--;else{this.selectedGroupIndex=this.autoCompleteViewModel.dropdownGroups.length-1;var o=null===(r=this.autoCompleteViewModel.dropdownGroups[this.selectedGroupIndex])||void 0===r?void 0:r.groupItems;_.isEmpty(o)||(this.selectedSpanIndex=o.length-1)}this.resetHoverIndices(),this.screenReaderCurrentDropdownSelection(this.selectedGroupIndex,this.selectedSpanIndex)}},i.prototype.moveSelectionDown=function(){var e;if(this.isInitialized&&(!this.selectNext||void 0!==this.selectNext.value)&&null!==(e=this.autoCompleteViewModel)&&void 0!==e&&e.dropdownGroups){var t=Ee(this.autoCompleteViewModel.dropdownGroups,{groupIndex:this.selectedGroupIndex,itemIndex:this.selectedSpanIndex});this.selectedGroupIndex=t.groupIndex,this.selectedSpanIndex=t.itemIndex,this.resetHoverIndices(),this.screenReaderCurrentDropdownSelection(this.selectedGroupIndex,this.selectedSpanIndex)}},i.prototype.selectCurrentDropdownItem=function(){var e,t;if(this.isInitialized&&(!this.confirmSelection||void 0!==this.confirmSelection.value)){var r=null===(e=this.autoCompleteViewModel)||void 0===e?void 0:e.dropdownGroups,o=r&&(null===(t=r[this.selectedGroupIndex])||void 0===t?void 0:t.groupItems);o&&o[this.selectedSpanIndex]?this.selectDropdownItem(o[this.selectedSpanIndex]):this.utteranceSelected.emit({utterance:void 0})}},i.prototype.currentDropdownString=function(e,t){var r,o=null===(r=this.autoCompleteViewModel.dropdownGroups[e])||void 0===r?void 0:r.groupItems,a=o&&o[t];if(a)return a.isShowMore?a.text:_.map(a.textSegments,function(s){return s.text}).join("").replace(Z," ")},i.prototype.screenReaderCurrentDropdownSelection=function(e,t){var r=this.currentDropdownString(e,t);if(r){var o=this.autoCompleteViewModel.dropdownGroups[e].title;this.screenReaderService.alertWithDebounce(ve,o?o+" "+r:r)}},i.prototype.generateDropdownItems=function(e){if(e){var t=e.spans,r=e.cursorPosition;this.resetSelectedIndices(),this.resetHoverIndices();var o=function(i,e){var t=0;if(_.isEmpty(i))return-1;if(0===e)return t;if(e>i[i.length-1].endExcludingIndex)return-1;for(t=i.length-1;t>=0;t--){var o=i[t],a=t>0?i[t-1]:void 0,s=e===o.startIndex&&_.isEmpty(o.text),u=a&&a.isWhiteSpace,c=o.startIndex<=e&&e<=o.endExcludingIndex;if(s){var l=o.replacementBindings,d=!_.isEmpty(l&&l.phraseExtensions),f=!_.isEmpty(l&&l.phraseCompletions);if((d||f)&&u)return t}else if(c&&!o.isWhiteSpace)return t}return t}(t,r);if(-1===o)return void(this.showAutoCompleteDropdown=!1);this.unknownSpanHeaderTitle=void 0,this.unknownSpanHeaderSubtitle=void 0,this.selectedSpan=t[o],this.showUnknownSpanHeader=!1,this.disableUnknownSpanHeaderSubtitleAction=!1,this.isUnknownSpanHeaderForFixRequested=!1;var a=function(i,e,t){var r,o,zt,a=function(i){return _.map(i,function(e){return{text:e.text,correctedStartIndex:e.correctedStartIndex,correctedEndExcludingIndex:e.correctedEndExcludingIndex,isOverlapping:e.isOverlapping,tokens:e.tokens,binding:e.binding,replacementBindings:e.replacementBindings,inferredTermBindings:e.inferredTermBindings,overlapSpans:e.overlapSpans,inferredTermBindingsUnsupported:e.inferredTermBindingsUnsupported,isWhiteSpace:e.isWhiteSpace,isCorrected:e.isCorrected,isUsed:e.isUsed,isUnknown:e.isUnknown,state:e.state,startIndex:e.startIndex,endExcludingIndex:e.endExcludingIndex}})}(i.spans),s=i.config,u=i.cursorPosition,c=a[e],l=c.isUnknown,d=!!c.binding,f=!_.isEmpty(a[e].overlapSpans),v=c.replacementBindings,F=!_.isEmpty(v&&v.alternates),I=!_.isEmpty(v&&v.phraseExtensions),T=!_.isEmpty(v&&v.phraseCompletions),Se=!_.isEmpty(v&&v.suggestedReplacements),Ne=d||F||I||T||Se||f,He=null===(r=s.header)||void 0===r?void 0:r.show,xt=[],Yt=[];if("accepted"===c.state||"none"===c.state){if(!_.isEmpty(c.text)){var Gn=st(a,e,[0],Yt,u);_.isEmpty(Gn)||xt.push({groupItems:Gn})}(F||f||T||I||Se)&&(zt=st(a,e,[1,2,4,3],Yt,u),_.isEmpty(zt)||xt.push({groupItems:zt,title:He&&d?t.get("Qna_YouCouldAlsoTry_LabelText"):void 0}))}else l&&He&&"none"!==s.header.unknownSpanHeaderConfig.actionType?(g.fF.assert(function(){return null!=s.header.unknownSpanHeaderConfig.actionType},"when config.header.show is true, config.header.unknownSpanHeaderConfig.actionType must be defined"),xt.push({title:t.get("Qna_AutoComplete_UnknowTermWithNoAlternatesTitle")})):Ne?(d&&xt.push({groupItems:st(a,e,[0],Yt,u)}),(F||f)&&(zt=st(a,e,[1],Yt,u),_.isEmpty(zt)||xt.push({groupItems:zt,title:He?t.get(d?"Qna_YouCouldAlsoTry_LabelText":"Qna_DidYouMean_LabelTextWithColon"):void 0}))):xt.push({groupItems:_n(a,e,[{segments:[{text:c.text,isMatched:!0}],score:null===(o=c.binding)||void 0===o?void 0:o.score}],Yt,u)});return{dropdownGroups:xt}}(e,o,this.localizationService);if(this.allDropdownGroups=En(a.dropdownGroups,this.maxItemCountInFullExpansion),this.autoCompleteViewModel=_.merge({},a,{dropdownGroups:this.allDropdownGroups}),this.showAutoCompleteDropdown=!_.isEmpty(this.allDropdownGroups),this.generateUnknownSpanTitle(e,o),this.resetExpansionState(),this.showAutoCompleteDropdown){var s=_.sum(this.autoCompleteViewModel.dropdownGroups.map(function(c){return _.size(c.groupItems)}));this.shouldDisplayShowMore&&s--;var u=this.localizationService.format("Qna_ScreenReader_SuggestionsOpened_NoTerm",["".concat(s)]);this.screenReaderService.alertWithDebounce(Y,u)}else this.screenReaderService.cancelDebounce(Y)}},i.prototype.generateUnknownSpanTitle=function(e,t){var o,a,s,u,r=this;if("none"===(null===(a=null===(o=e.config.header)||void 0===o?void 0:o.unknownSpanHeaderConfig)||void 0===a?void 0:a.actionType))return this.showUnknownSpanHeader=!1,this.unknownSpanHeaderTitle=void 0,void(this.unknownSpanHeaderSubtitle=void 0);var c=e.spans,l=_.last(this.allDropdownGroups);if(l?.title&&this.unknownTermService){var d=_.map(c,function(I){return I.text}).join(""),f=null===(u=null===(s=e.config.header)||void 0===s?void 0:s.unknownSpanHeaderConfig)||void 0===u?void 0:u.actionType;if(l.title===this.localizationService.get("Qna_DidYouMean_LabelTextWithColon"))g.fF.assert(function(){var I;return null===(I=e.config.header)||void 0===I?void 0:I.show},"Expect params.config.header?.show to be true when lastDropdownGroup.title is not empty"),"textOnlyHeader"!==f&&!this.unknownTermService.wasUtteranceAdded(d,this.selectedSpan.text)&&(this.unknownSpanHeaderTitle=this.localizationService.get("Qna_AutoComplete_UnusedTermWithAlternatesTitle"),this.unknownSpanHeaderSubtitle=this.unknownTermService.getLabel(c[t],f,e.modelOwner),this.showUnknownSpanHeader=!0);else if(l.title===this.localizationService.get("Qna_AutoComplete_UnknowTermWithNoAlternatesTitle"))if(g.fF.assert(function(){var I;return null===(I=e.config.header)||void 0===I?void 0:I.show},"Expect params.config.header?.show to be true when lastDropdownGroup.title is not empty"),this.showUnknownSpanHeader=!0,"textOnlyHeader"===f){this.unknownSpanHeaderTitle=void 0;var v=e.config.header.unknownSpanHeaderConfig.textOnlyTemplate;if(v){var F=_.map(v.variables,function(I){var T=1===I.type?r.selectedSpan.text:I.text;return I.isBold?function(i){return"<b>"+i+"</b>"}(T):T});this.unknownSpanHeaderSubtitle=this.localizationService.format(v.template,F)}else this.unknownSpanHeaderSubtitle=this.localizationService.get("Qna_AutoComplete_UnknowTermWithNoAlternatesTitle");this.disableUnknownSpanHeaderSubtitleAction=!0}else this.unknownTermService.wasUtteranceAdded(d,this.selectedSpan.text)?(this.unknownSpanHeaderTitle=this.localizationService.get("Qna_AutoComplete_UnknowTermHasAlreadyBeenAdded"),this.disableUnknownSpanHeaderSubtitleAction=!0,this.isUnknownSpanHeaderForFixRequested=!0):(g.fF.assert(function(){return"askToAdd"===f||"defineInTooling"===f},"Expect the actionType is either AskToAdd or DefineInTooling"),this.unknownSpanHeaderTitle=this.localizationService.get("Qna_AutoComplete_UnknowTermWithNoAlternatesTitle"),this.unknownSpanHeaderSubtitle=this.unknownTermService.getLabel(c[t],f,e.modelOwner))}},i.prototype.resetExpansionState=function(){var e,t;g.fF.assertValue(this.autoCompleteViewModel,"Expect this.autoCompleteViewModel to be defined"),this.autoCompleteViewModel.dropdownGroups=En(this.allDropdownGroups,this.showUnknownSpanHeader?this.maxItemCountInPartialExpansion-1:this.maxItemCountInPartialExpansion),this.shouldDisplayShowMore=_.size(this.autoCompleteViewModel.dropdownGroups)<_.size(this.allDropdownGroups)||_.size(null===(e=_.last(this.autoCompleteViewModel.dropdownGroups))||void 0===e?void 0:e.groupItems)<_.size(null===(t=_.last(this.allDropdownGroups))||void 0===t?void 0:t.groupItems),this.shouldDisplayShowMore&&this.autoCompleteViewModel.dropdownGroups.push({groupItems:[{isShowMore:!0,text:this.localizationService.get("ShowMore"),textSegments:[],score:0}]})},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .link","{ color: var(--link-color) !important; opacity: 1 !important; }")},i.prototype.resetHoverIndices=function(){this.hoverGroupIndex=-1,this.hoverSpanIndex=0},i.prototype.resetSelectedIndices=function(){this.selectedGroupIndex=-1,this.selectedSpanIndex=0},i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275directiveInject(Pt.g),n.\u0275\u0275directiveInject(Ut.o),n.\u0275\u0275directiveInject(At.g),n.\u0275\u0275directiveInject(ge.y0),n.\u0275\u0275directiveInject(Vt,8))},i.\u0275cmp=n.\u0275\u0275defineComponent({type:i,selectors:[["qna-autocomplete"]],inputs:{maxItemCountInFullExpansion:"maxItemCountInFullExpansion",maxItemCountInPartialExpansion:"maxItemCountInPartialExpansion",params:"params",presentation:"presentation",selectPrevious:"selectPrevious",selectNext:"selectNext",confirmSelection:"confirmSelection"},outputs:{utteranceSelected:"utteranceSelected",fullyExpanded:"fullyExpanded"},decls:1,vars:1,consts:[["id","qnaAutoComplete","role","listbox","class","qnaAutoComplete themeableElement highContrastBorder",3,"ngStyle",4,"ngIf"],["id","qnaAutoComplete","role","listbox",1,"qnaAutoComplete","themeableElement","highContrastBorder",3,"ngStyle"],["class","groupItem","drag-resize-disabled","true",3,"ngStyle",4,"ngFor","ngForOf"],["class","unknownTermTitle",3,"ngStyle",4,"ngIf"],["drag-resize-disabled","true",1,"groupItem",3,"ngStyle"],["class","dropdownGroupTitle",3,"ngStyle",4,"ngIf"],["class","dropdownGroupItems",4,"ngIf"],[1,"dropdownGroupTitle",3,"ngStyle"],[1,"dropdownGroupItems"],["class","singleDropdownItem","role","option","data-testid","single-dropdown-item",3,"ngStyle","ngClass","mouseenter","accessible-click",4,"ngFor","ngForOf"],["role","option","data-testid","single-dropdown-item",1,"singleDropdownItem",3,"ngStyle","ngClass","mouseenter","accessible-click"],["class","singleDropdownItemTextContainer",4,"ngIf"],["class","singleDropdownItemTextContainer showMoreItem",4,"ngIf"],[1,"singleDropdownItemTextContainer"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"singleDropdownItemTextContainer","showMoreItem"],["localize","ShowMore"],[1,"unknownTermTitle",3,"ngStyle"],["tabindex","0","drag-resize-disabled","true",3,"ngClass","innerHTML","ngStyle","accessible-click",4,"ngIf"],["tabindex","0","drag-resize-disabled","true",3,"ngClass","innerHTML","ngStyle","accessible-click"]],template:function(t,r){1&t&&n.\u0275\u0275template(0,O,3,6,"ul",0),2&t&&n.\u0275\u0275property("ngIf",r.showAutoCompleteDropdown)},dependencies:[D.NgClass,D.NgForOf,D.NgIf,D.NgStyle,Gt.X,Lt.t],styles:['.qnaAutoComplete[_ngcontent-%COMP%]{display:block;position:absolute;left:0;width:100%;border-radius:2px;box-shadow:0 1.2px 3.6px rgba(0,0,0,.11),0 6.4px 14.4px rgba(0,0,0,.13);background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1)}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%]{font-family:Segoe UI Semibold,wf_segoe-ui_semibold,helvetica,arial,sans-serif;background-color:transparent;margin:0;white-space:pre-wrap}html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%]{padding:4px 8px 8px}html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupTitle[_ngcontent-%COMP%], html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%], html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem.showAsGroupTitle[_ngcontent-%COMP%]{padding:4px 8px 8px}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1)}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.selected[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1Hover)}.qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%]{font-weight:400!important;border-top-color:var(--colorNeutralForeground1)}.qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--colorBrandForegroundLink);text-decoration:none;cursor:pointer!important}.qnaAutoComplete[_ngcontent-%COMP%]   .unknownTermTitle[_ngcontent-%COMP%]   .fixRequestedText[_ngcontent-%COMP%]{font-weight:700!important}.qnaAutoComplete[_ngcontent-%COMP%]   .groupItem[_ngcontent-%COMP%]{display:block;text-decoration:none}.qnaAutoComplete[_ngcontent-%COMP%]   .groupItem[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]{list-style:none;z-index:2;cursor:pointer;display:block;position:relative;margin-top:0!important;overflow:visible;white-space:pre-wrap}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:0;background-color:transparent;overflow-wrap:break-word}html:not([dir="rtl"])[_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{padding:4px 0 8px 16px}html[dir="rtl"][_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]{padding:4px 16px 8px 0}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline-offset:-1px}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem[_ngcontent-%COMP%]   .singleDropdownItemTextContainer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline}.qnaAutoComplete[_ngcontent-%COMP%]   .dropdownGroupItems[_ngcontent-%COMP%]   .singleDropdownItem.showMoreItem[_ngcontent-%COMP%]{color:var(--colorBrandForegroundLink)}.qnaAutoComplete[_ngcontent-%COMP%]   .matchedSegment[_ngcontent-%COMP%]{font-weight:700}']}),i}();function Ee(i,e){var t;g.fF.assertValue(i,"Expect dropdownGroups to be defined"),g.fF.assert(function(){return e.itemIndex>=0},"Expect currentIndices.itemIndex >= 0");var r=e.groupIndex,o=e.itemIndex,a=null===(t=i[r])||void 0===t?void 0:t.groupItems;return a&&o===a.length-1?r>=i.length-1?{groupIndex:-1,itemIndex:0}:{groupIndex:r+1,itemIndex:0}:r<0?{groupIndex:0,itemIndex:0}:{groupIndex:r,itemIndex:o+1}}var xe=p(26898),Re=p(83008),Ce=p(39503),Ke=p(83342),Ge=p(76072),pt=p(84281),gt=p(52298),ze=p(22844),Rt=p(1240),Ft=["contentElementExtraContainer"],Ye=["deleteButton"],sn=["commitButton"],un=["autoComplete"],ln=["contentElement"],cn=["qnaInputContainer"],Kt=["beginGripper"],dn=["endGripper"],be=["spanElement"],ut=function(e,t,r,o){return{width:e,height:t,right:r,top:o}},_e=function(e){return{"stroke-width":e}};function Ae(i,e){if(1&i&&(n.\u0275\u0275namespaceSVG(),n.\u0275\u0275elementStart(0,"svg",19),n.\u0275\u0275element(1,"circle",20),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext().ngIf,r=n.\u0275\u0275nextContext(3).ngIf;n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction4(7,ut,t.meatball.width+"px",t.meatball.height+"px",t.meatball.right+"px",t.meatball.top+"px")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(12,_e,t.meatball.strokeWidth+"px")),n.\u0275\u0275attribute("stroke",t.meatball.strokeColor)("fill",r.useShellTheme?"":t.meatball.fillColor)("r",t.meatball.r)("cx",t.meatball.cx)("cy",t.meatball.cy)}}var bt=function(e,t,r){return{notClickable:e,loadingIcon:t,warningIcon:r}},Bn=function(e,t){return{color:e,"font-size":t}};function Sn(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"span",17),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var c=n.\u0275\u0275nextContext(4);return n.\u0275\u0275resetView(c.resetAllState())}),n.\u0275\u0275template(1,Ae,2,14,"svg",18),n.\u0275\u0275elementEnd()}if(2&i){var r=e.ngIf,o=n.\u0275\u0275nextContext(2).ngIf,a=n.\u0275\u0275nextContext().ngIf,s=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction3(6,bt,s.noResetAllActionIndication,"loading"===r.state,"warning"===r.state))("ngStyle",n.\u0275\u0275pureFunction2(10,Bn,a.useShellTheme?"":a.questionFontProperties.color,o.iconFontSize+"px"))("pbi-tooltip",r.tooltipConfig),n.\u0275\u0275attribute("aria-label",r.ariaLabel)("role","normal"!==r.state?"alert":"button"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf","normal"!==r.state)}}var On=function(e){return{width:e}},kt=function(e){return{"font-size":e}},Tn=function(e,t,r,o){return{state:e,ariaLabel:t,tooltipConfig:r,meatball:o}};function Kn(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"div",14)(2,"span",15),n.\u0275\u0275text(3,"\xa0"),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(4,Sn,2,13,"span",16),n.\u0275\u0275pipe(5,"async"),n.\u0275\u0275pipe(6,"async"),n.\u0275\u0275pipe(7,"async"),n.\u0275\u0275pipe(8,"async"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext().ngIf,r=n.\u0275\u0275nextContext().ngIf,o=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(11,On,null!=o.fullConfig&&o.fullConfig.showQuestionIcon?t.iconFontSize+"px":0)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(13,kt,r.questionFontProperties.size.px+"px")),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",n.\u0275\u0275pureFunction4(15,Tn,n.\u0275\u0275pipeBind1(5,3,o.questionIconProperties.state$),n.\u0275\u0275pipeBind1(6,5,o.questionIconProperties.ariaLabel$),n.\u0275\u0275pipeBind1(7,7,o.questionIconProperties.tooltipConfig$),n.\u0275\u0275pipeBind1(8,9,o.questionIconProperties.loadingWarningPresentation$)))}}function Jn(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",32,33),n.\u0275\u0275listener("keyup",function(a){n.\u0275\u0275restoreView(t);var s=n.\u0275\u0275nextContext(2).$implicit,u=n.\u0275\u0275nextContext(6);return n.\u0275\u0275resetView(u.gripperKeyUp(a,s,"beginGripper"))})("cdkDragStarted",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(8);return n.\u0275\u0275resetView(a.beginGripperDragStarted())}),n.\u0275\u0275namespaceSVG(),n.\u0275\u0275elementStart(2,"svg",34),n.\u0275\u0275element(3,"rect"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"svg",35),n.\u0275\u0275element(5,"circle"),n.\u0275\u0275elementEnd()()}if(2&i){var r=n.\u0275\u0275nextContext(7).ngIf;n.\u0275\u0275property("cdkDragData","beginGripper"),n.\u0275\u0275advance(3),n.\u0275\u0275attribute("fill",r.errorUnderlineColor),n.\u0275\u0275advance(2),n.\u0275\u0275attribute("stroke",r.errorUnderlineColor)("fill",r.backgroundColor)}}function Pr(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",36,37),n.\u0275\u0275listener("keyup",function(a){n.\u0275\u0275restoreView(t);var s=n.\u0275\u0275nextContext(2).$implicit,u=n.\u0275\u0275nextContext(6);return n.\u0275\u0275resetView(u.gripperKeyUp(a,s,"endGripper"))})("cdkDragStarted",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(8);return n.\u0275\u0275resetView(a.endGripperDragStarted())}),n.\u0275\u0275namespaceSVG(),n.\u0275\u0275elementStart(2,"svg",38),n.\u0275\u0275element(3,"rect"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"svg",35),n.\u0275\u0275element(5,"circle"),n.\u0275\u0275elementEnd()()}if(2&i){var r=n.\u0275\u0275nextContext(7).ngIf;n.\u0275\u0275property("cdkDragData","endGripper"),n.\u0275\u0275advance(3),n.\u0275\u0275attribute("fill",r.errorUnderlineColor),n.\u0275\u0275advance(2),n.\u0275\u0275attribute("stroke",r.errorUnderlineColor)("fill",r.backgroundColor)}}var Ar=function(e,t,r,o,a,s,u,c,l){return{dropZoneLocatedBeforeToken:e,dropZoneLocatedAfterToken:t,noGripperOnDragging:r,beginGripperOnDragging:o,endGripperOnDragging:a,serveBeginGripper:s,serveEndGripper:u,hasBeginGripper:c,hasEndGripper:l}};function Fr(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",29),n.\u0275\u0275listener("cdkDropListEntered",function(c){n.\u0275\u0275restoreView(t);var l=n.\u0275\u0275nextContext(7);return n.\u0275\u0275resetView(l.gripperEnter(c))})("cdkDropListDropped",function(c){n.\u0275\u0275restoreView(t);var l=n.\u0275\u0275nextContext(7);return n.\u0275\u0275resetView(l.dropGripper(c))}),n.\u0275\u0275template(1,Jn,6,4,"div",30),n.\u0275\u0275template(2,Pr,6,4,"div",31),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext().$implicit,o=n.\u0275\u0275nextContext(2).$implicit,a=n.\u0275\u0275nextContext(2).ngIf,s=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunctionV(5,Ar,[r===(null==o.dropZonesInfo?null:o.dropZonesInfo.zoneLocatedBeforeInfo),r===(null==o.dropZonesInfo?null:o.dropZonesInfo.zoneLocatedAfterInfo),"none"===a.gripperOnDragging,"beginGripper"===a.gripperOnDragging,"endGripper"===a.gripperOnDragging,!!r.beginGripperOf,!!r.endGripperOf,!!r.hasBeginGripper,!!r.hasEndGripper]))("cdkDropListData",r)("cdkDropListEnterPredicate",s.dropZonePredicate),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",r.hasBeginGripper),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",r.hasEndGripper)}}function br(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Fr,3,15,"div",28),n.\u0275\u0275elementContainerEnd()),2&i){var t=e.$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t)}}var Ir=function(e,t){return[e,t]};function xr(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,br,2,1,"ng-container",27),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",n.\u0275\u0275pureFunction2(1,Ir,null==t.dropZonesInfo?null:t.dropZonesInfo.zoneLocatedBeforeInfo,null==t.dropZonesInfo?null:t.dropZonesInfo.zoneLocatedAfterInfo))}}var Mr=function(e,t,r,o){return{space:e,filler:t,isBetweenDroppedGrippers:r,isBetweenOnDraggingGrippers:o}};function wr(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"span",26),n.\u0275\u0275text(1),n.\u0275\u0275template(2,xr,2,4,"ng-container",0),n.\u0275\u0275elementEnd()),2&i){var t=e.$implicit,r=n.\u0275\u0275nextContext(4);n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction4(4,Mr,t.isWhiteSpace,t.isFillerText,t.isBetweenDroppedGrippers,t.isBetweenOnDraggingGrippers)),n.\u0275\u0275attribute("aria-hidden",t.isWhiteSpace),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.text),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",null==r.fullConfig?null:r.fullConfig.supportTokenGrippers)}}var Br=function(e,t){return{height:e,bottom:t,left:0}};function Or(i,e){if(1&i&&(n.\u0275\u0275namespaceSVG(),n.\u0275\u0275elementStart(0,"svg",39),n.\u0275\u0275element(1,"line",40),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(3).ngIf;n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction2(7,Br,2*t.singleUnderlineThickness+"px",-.5*t.singleUnderlineSpace+-1.5*t.singleUnderlineThickness+"px")),n.\u0275\u0275advance(1),n.\u0275\u0275attribute("x1",t.singleUnderlineThickness)("y1",t.singleUnderlineThickness)("y2",t.singleUnderlineThickness)("stroke-width",t.singleUnderlineThickness)("stroke-dasharray","1 "+(t.singleUnderlineThickness+2))("stroke",t.warningUnderlineColor)}}var Tr=function(e,t,r,o,a,s){return{unused:e,space:t,corrected:r,showAcceptedUnderline:o,showErrorUnderline:a,showWarningUnderline:s}},Zn=function(e){return{"background-color":e}},Vr=function(e,t){return{hasMultipleTokens:e,unused:t}},Ur=function(e,t,r,o){return{color:e,"border-bottom-color":t,"border-bottom-style":r,"border-bottom-width":o}};function Lr(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"span",21,22),n.\u0275\u0275listener("mouseover",function(){var u=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(c.onSpanMouseEnter(u))})("mouseleave",function(){var u=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(c.onSpanMouseLeave(u))}),n.\u0275\u0275elementStart(2,"span",23),n.\u0275\u0275template(3,wr,3,9,"span",24),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(4,Or,2,10,"svg",25),n.\u0275\u0275elementEnd()}if(2&i){var r=e.$implicit,o=n.\u0275\u0275nextContext(2).ngIf;n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction6(7,Tr,r.isUnused,r.isWhiteSpace,r.isCorrected,r.shouldShowAcceptedUnderline,r.shouldShowErrorUnderline,r.shouldShowWarningUnderline))("ngStyle",n.\u0275\u0275pureFunction1(14,Zn,o.useShellTheme?"":r.backgroundColor)),n.\u0275\u0275attribute("aria-hidden",r.isWhiteSpace),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(16,Vr,(null==r.tokens?null:r.tokens.length)>1,r.isUnused))("ngStyle",n.\u0275\u0275pureFunction4(19,Ur,o.useShellTheme?"":r.isUnused?o.droppedFontColor:o.questionFontProperties.color,o.useShellTheme?"":r.shouldShowAcceptedUnderline?o.acceptedUnderlineColor:r.shouldShowErrorUnderline?o.errorUnderlineColor:o.warningUnderlineColor,r.shouldShowAcceptedUnderline?"solid":r.shouldShowErrorUnderline?"double":"unset",(r.shouldShowAcceptedUnderline?o.singleUnderlineThickness:r.shouldShowErrorUnderline?2*o.singleUnderlineThickness:0)+"px")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",null==r?null:r.tokens),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",r.shouldShowWarningUnderline)}}var _i=function(e,t){return{disabled:e,usingShellTheme:t}},Rr=function(){return{tooltipLocalizeDescription:"Clear",tooltipShowOnFocus:!0}},Si=function(e,t){return{"font-size":e,color:t}};function kr(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",43)(1,"button",44,45),n.\u0275\u0275listener("accessible-click",function(s){n.\u0275\u0275restoreView(t);var u=n.\u0275\u0275nextContext(6);return n.\u0275\u0275resetView(u.clearButtonClicked(s))}),n.\u0275\u0275elementStart(3,"div",46)(4,"span",20),n.\u0275\u0275text(5,"\xa0"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",47),n.\u0275\u0275element(7,"i",48),n.\u0275\u0275elementEnd()()()()}if(2&i){var r=n.\u0275\u0275nextContext(4).ngIf,o=n.\u0275\u0275nextContext().ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(6,_i,r.isUtteranceEmpty,o.useShellTheme))("pbi-tooltip",n.\u0275\u0275pureFunction0(9,Rr))("ngStyle",n.\u0275\u0275pureFunction1(10,Zn,o.useShellTheme?"":o.backgroundColor)),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(12,kt,o.questionFontProperties.size.px+"px")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(14,kt,o.questionFontProperties.size.px+"px")),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction2(16,Si,r.iconFontSize+"px",o.useShellTheme?"":o.questionFontProperties.color))}}var Qr=function(e){return{"aria-label":e}},Nr=function(e){return{tooltipLocalizeDescription:e,tooltipShowOnFocus:!0}};function zr(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",43)(1,"button",49,50),n.\u0275\u0275listener("accessible-click",function(u){n.\u0275\u0275restoreView(t);var c=n.\u0275\u0275nextContext(7);return n.\u0275\u0275resetView(c.commitButtonClicked(u))}),n.\u0275\u0275elementStart(3,"div",46)(4,"span",20),n.\u0275\u0275text(5,"\xa0"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",47),n.\u0275\u0275element(7,"i",51),n.\u0275\u0275elementEnd()()()()}if(2&i){var r=n.\u0275\u0275nextContext().ngIf,o=n.\u0275\u0275nextContext(4).ngIf,a=n.\u0275\u0275nextContext().ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(7,_i,!r.isTrue,a.useShellTheme))("localizeAttr",n.\u0275\u0275pureFunction1(10,Qr,r.isTrue?"Submit":"Qna_Input_SubmitQuestion_Disabled_Description"))("pbi-tooltip",n.\u0275\u0275pureFunction1(12,Nr,r.isTrue?"Submit":"Qna_Input_SubmitQuestion_Disabled_Description"))("ngStyle",n.\u0275\u0275pureFunction1(14,Zn,a.useShellTheme?"":a.commitButtonBackgroundColor)),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(16,kt,a.questionFontProperties.size.px+"px")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(18,kt,a.questionFontProperties.size.px+"px")),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction2(20,Si,o.iconFontSize+"px",a.useShellTheme?"":a.commitButtonForegroundColor))}}function qr(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,zr,8,23,"div",42),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext(2).ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.commitVisible)}}var jr=function(e){return{isTrue:e}};function Gr(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"div",41),n.\u0275\u0275listener("click",function(u){n.\u0275\u0275restoreView(t);var c=n.\u0275\u0275nextContext(5);return n.\u0275\u0275resetView(c.actionButtonsContainerClicked(u))}),n.\u0275\u0275template(2,kr,8,19,"div",42),n.\u0275\u0275template(3,qr,2,1,"ng-container",0),n.\u0275\u0275pipe(4,"async"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}if(2&i){var r=n.\u0275\u0275nextContext().ngIf,o=n.\u0275\u0275nextContext(2).ngIf,a=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(5,On,(o.iconFontSize+16)*(!a.inCommitOnDemandMode||null!=a.fullConfig.commitOnDemandConfigs&&a.fullConfig.commitOnDemandConfigs.hideCommitActionUI?1:2)+"px")),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",r.deleteVisible),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pureFunction1(7,jr,n.\u0275\u0275pipeBind1(4,3,a.hasUncommittedQuestion$)))}}function Hr(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Gr,5,9,"ng-container",0),n.\u0275\u0275elementContainerEnd()),2&i){var t=e.ngIf,r=n.\u0275\u0275nextContext(2).ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",!r.isUtteranceEmpty||t.commitVisible||t.deleteVisible)}}var Wr=function(e,t){return{commitVisible:e,deleteVisible:t}};function $r(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Hr,2,1,"ng-container",0),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275pipe(3,"async"),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext(3);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pureFunction2(5,Wr,n.\u0275\u0275pipeBind1(2,1,t.commitActionVisible$),n.\u0275\u0275pipeBind1(3,3,t.clearActionVisible$)))}}function Kr(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"qna-autocomplete",52,53),n.\u0275\u0275listener("utteranceSelected",function(s){n.\u0275\u0275restoreView(t);var u=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(u.autoCompleteDropdownItemSelected(s))})("fullyExpanded",function(){n.\u0275\u0275restoreView(t);var s=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(s.autoCompleteFullyExpanded())}),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext(2).ngIf,o=n.\u0275\u0275nextContext();n.\u0275\u0275classProp("withTopSeparator",r.height),n.\u0275\u0275property("params",o.autoCompleteInputArgs.params)("presentation",o.autoCompleteInputArgs.presentation)("selectPrevious",o.autoCompleteInputArgs.selectPrevious)("selectNext",o.autoCompleteInputArgs.selectNext)("confirmSelection",o.autoCompleteInputArgs.confirmSelection)}}var Jr=function(e,t,r,o){return{withBorder:e,withShadow:t,authoringDisabled:r,showDisabled:o}},Zr=function(e,t,r,o,a,s,u,c,l){return{"background-color":e,color:t,"font-size":r,"font-family":o,"border-color":a,"font-weight":s,"font-style":u,"text-decoration":c,height:l}},Xr=function(e){return{height:e}},Yr=function(e,t){return{withFixedHeight:e,allowContentHorizontalScroll:t}},eo=function(e){return{"max-height":e}},to=function(e){return{withMaxHeight:e}},no=function(e){return{isGripperOnDragging:e}};function io(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",3),n.\u0275\u0275template(1,Kn,9,20,"ng-container",0),n.\u0275\u0275elementStart(2,"div",4,5)(4,"div",6)(5,"div",7)(6,"div",8,9)(8,"div",10,11),n.\u0275\u0275pipe(10,"async"),n.\u0275\u0275template(11,Lr,5,24,"span",12),n.\u0275\u0275pipe(12,"async"),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(13,$r,4,8,"ng-container",0),n.\u0275\u0275elementEnd()(),n.\u0275\u0275template(14,Kr,2,7,"qna-autocomplete",13),n.\u0275\u0275pipe(15,"async"),n.\u0275\u0275elementEnd()()()),2&i){var t=e.ngIf,r=n.\u0275\u0275nextContext().ngIf,o=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",null==o.fullConfig?null:o.fullConfig.showQuestionIcon),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction4(20,Jr,r.withBorder,r.withShadow,null==o.fullConfig?null:o.fullConfig.disableAuthoring,null==o.fullConfig?null:o.fullConfig.displayDisabledStateVisually))("ngStyle",n.\u0275\u0275pureFunctionV(25,Zr,[r.useShellTheme?"":r.backgroundColor,r.useShellTheme?"":r.questionFontProperties.color,r.questionFontProperties.size.px+"px",r.questionFontProperties.family,r.useShellTheme?"":r.borderColor,r.questionFontProperties.weight,r.questionFontProperties.style,r.questionFontProperties.textDecoration,r.height?r.height+"px":"auto"])),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(35,Xr,r.height?r.height+"px":"auto"))("ngClass",n.\u0275\u0275pureFunction2(37,Yr,r.height,r.allowContentHorizontalScroll)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(40,eo,r.height?r.height+"px":"unset"))("ngClass",n.\u0275\u0275pureFunction1(42,to,r.height)),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(44,no,"none"!==t.gripperOnDragging)),n.\u0275\u0275attribute("contenteditable",o.isEditable())("placeholder",n.\u0275\u0275pipeBind1(10,14,o.placeholder$))("aria-label",o.ariaLabel),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngForOf",n.\u0275\u0275pipeBind1(12,16,o.uiSpans$)),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",null==o.fullConfig?null:o.fullConfig.showActionButtons),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(15,18,o.shouldShowAutoComplete$))}}var ro=function(e){return{corrected:e}};function oo(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"span",58),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()),2&i){var t=e.$implicit;n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(2,ro,t.isCorrected)),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.text)}}var ao=function(e,t,r){return{color:e,"font-size":t,"font-family":r}};function so(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",54)(1,"span",55),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(3,"div",56),n.\u0275\u0275listener("accessible-click",function(){var u=n.\u0275\u0275restoreView(t).ngIf,c=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(c.replaceWithCorrectedUtterance(u.replacementUtterance,u.state))}),n.\u0275\u0275template(4,oo,2,4,"span",57),n.\u0275\u0275elementEnd()()}if(2&i){var r=e.ngIf,o=n.\u0275\u0275nextContext().ngIf;n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction3(4,ao,o.restatementFontProperties.color,o.restatementFontProperties.size.px+"px",o.restatementFontProperties.family)),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(r.label),n.\u0275\u0275advance(1),n.\u0275\u0275attribute("aria-label",r.replacementUtterance),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",r.spans)}}var uo=function(e,t,r){return{gripperOnDragging:e,isUtteranceEmpty:t,iconFontSize:r}};function lo(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,io,16,46,"div",1),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275pipe(3,"async"),n.\u0275\u0275pipe(4,"async"),n.\u0275\u0275template(5,so,5,8,"div",2),n.\u0275\u0275pipe(6,"async"),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pureFunction3(10,uo,n.\u0275\u0275pipeBind1(2,2,null==t.grippersInfo?null:t.grippersInfo.gripperOnDragging$),n.\u0275\u0275pipeBind1(3,4,t.isDisplayedUtteranceEmpty$),n.\u0275\u0275pipeBind1(4,6,t.iconFontSize$))),n.\u0275\u0275advance(4),n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(6,8,t.currentUtteranceAutoCorrectionInfo$))}}var Pi={withBorder:!1,withShadow:!1,backgroundColor:"#FFFFFF",borderColor:"#A19F9D",questionFontProperties:{color:"#323130",size:nt.B.createFromPt(10),family:"'Segoe UI', wf_segoe- ui_normal, helvetica, arial, sans- serif"},acceptedUnderlineColor:"#0078D4",errorUnderlineColor:"#FF0000",warningUnderlineColor:"#0078D4",singleUnderlineThickness:2,singleUnderlineSpace:1,droppedFontColor:"#A19F9D",hoverColor:"#EEEEEE",restatementFontProperties:{color:"#323130",size:nt.B.createFromPt(9),family:"'Segoe UI', wf_segoe- ui_normal, helvetica, arial, sans- serif"},commitButtonBackgroundColor:"#F3F2F1",commitButtonForegroundColor:"#323130",allowContentHorizontalScroll:!1},po={sendPausedTagTimeout:3e3,showErrorWarningUnderlineTimeout:1500,showActionButtons:!0,showPlaceholderText:!0,showQuestionIcon:!0,showWarningIcon:!0,showLoadingIcon:!0,showCorrectedUtterance:!0,customPlaceholderText:"",autoFocusOnInit:!1,disableAuthoring:!1,disableAuthoringMessage:"",displayDisabledStateVisually:!0,disableSendingServiceTags:!1,supportTokenGrippers:!1,supportsPodQueries:!1,supportsInsightsQueries:!1,inferUnknownModelTerms:!1,singleAnswerBias:!1,hostSupportsUndo:!1,spanDropdownHeaderConfig:{show:!0,unknownSpanHeaderConfig:{actionType:"none"}},calculation:void 0,considerDroppedSpans:!0,considerErrorSpans:!0,considerWarningSpans:!0,commitOnDemandForcedMode:void 0,commitOnDemandConfigs:{hideCommitActionUI:!1,noCommitOnDropdownSelection:!1,noCommitOnInitialUtterance:!1}},Xn="\xa0",Un=function(){function i(e,t,r,o,a,s,u,c,l,d,f,v,F){this.changeDetectorRef=e,this.conceptualSchemaProxy=t,this.dataSourcesService=r,this.explorationNavigationService=o,this.featureSwitchService=a,this.highContrastCssGenerationService=s,this.lazyProvider=u,this.localizationService=c,this.screenReaderService=l,this.undoRedoService=d,this.linguisticSchemaProxy=f,this.qnaProxyPathToken=v,this.qnaModelUtilsPathToken=F,this.grippersDefinedTextRangeChanged=new n.EventEmitter,this.enterKeyPressed=new n.EventEmitter,this.initialized=new n.EventEmitter,this.toolingLaunched=new n.EventEmitter,this.inputBoxFocused=new n.EventEmitter,this.displayedUtteranceInternal$=new ee.X(void 0),this.distinctDisplayedUtterance$=new ee.X(void 0),this.hasUncommittedQuestion$=new ee.X(!1),this.loadingStateTooltipConfig$=new ee.X(void 0),this.warningStateTooltipConfig$=new ee.X(void 0),this.hasFocus$=new ee.X(void 0),this.cursorLocation$=new ee.X(-1),this.uiSpanWithMouseHover$=new ee.X(void 0),this.tokensGripperLocInfoUpdated$=new ee.X(void 0),this.delayedSpanUnderlineStyleUpdated$=new ee.X(void 0),this.contentElementAngularCommentNodes=[],this.destroy$=new tt.xQ,this.firstTimeLoad=!0,this.componentUniqueId=Fe.b$.generateGuid(),this.interpretRequestSequenceNumber=-1,this.initializeHighContrastRules(),g.fF.assert(function(){return!(0,k.rO)()},"Expect input box never get created if it is in IE browser.")}return Object.defineProperty(i.prototype,"autoCompleteElementRef",{set:function(t){t&&(this.autoCompleteElement=t.nativeElement)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"contentElementRef",{set:function(t){var r=this;if(t&&(this.contentElement=t.nativeElement,this.firstTimeLoad)){this.firstTimeLoad=!1;var o=!1;this.contentElement&&this.isEditable()&&this.fullConfig.autoFocusOnInit&&(o=!0),this.contentElementAngularCommentNodes=_.takeWhile(this.contentElement.childNodes,function(a){return a.nodeType===Node.COMMENT_NODE}),_.isEmpty(this.contentElementAngularCommentNodes)&&(this.contentElementAngularCommentNodes=_.takeRightWhile(this.contentElement.childNodes,function(a){return a.nodeType===Node.COMMENT_NODE})),this.addEventListeners(),g.fF.assert(function(){return!r.initialUtteranceFromSaved||!_.isEmpty(r.initialUtterance)},"initialUtteranceFromSaved is true, then there must be an initialUtterance"),_.isEmpty(this.initialUtterance)?o&&setTimeout(function(){r.contentElement.focus()}):setTimeout(function(){var a,s;g.fF.assertValue(r.fullConfig,"this.fullConfig should already been set"),r.interpretUtteranceRequest$.next({utterance:r.initialUtterance,uniqueId:Fe.b$.generateGuid(),utteranceUITextAlreadyEnsured:!1,suppressSuggestions:!0,requireCursorAtEndIfFocused:!0,enforceFocus:o,delayError:!1,linguisticSchemaJson:r.linguisticInfo&&r.linguisticInfo.linguisticSchemaJson,inferredTermBinding:r.linguisticInfo&&r.linguisticInfo.inferredTermBinding,incomingTags:r.initialUtteranceFromSaved?["SavedQuestion"]:void 0,specifiedSpans:void 0,isCommitInCommitQuestionOnDemandMode:!(null!==(s=null===(a=r.fullConfig)||void 0===a?void 0:a.commitOnDemandConfigs)&&void 0!==s&&s.noCommitOnInitialUtterance)})})}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"spanElementRefs",{set:function(t){var r=this;_.forEach(t.toArray(),function(o){(0,Me.R)(o.nativeElement,"click").pipe((0,ie.R)(r.destroy$)).subscribe(function(a){var s=r.getUtteranceSelection();r.cursorLocation$.next(Jt(1,s)),r.flushUnderlineDelayApply(),Je(a);var u=Jt(0,s);-1!==u&&r.showDropdownAtPosition(1,u)})})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"qnaInputContainerElementRef",{set:function(t){var r=this;t&&(this.qnaInputContainerElement=t.nativeElement,(0,Me.R)(t.nativeElement,"focusout").pipe((0,ie.R)(this.destroy$)).subscribe(function(o){var a=o.relatedTarget,s=o.target,u=!!s&&y(r.autoCompleteElement,s),c=!1;(!a&&!u||a&&!y(r.qnaInputContainerElement,a))&&(c=!0),c&&r.showHideDropdown(!1,{utterance:r.getCurrentUtteranceSpaceNormalized()})}))},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){var e;return(0,C.mG)(this,void 0,void 0,function(){var t,o,a,s,u=this;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return this.qnaProxyPath=this.qnaProxyPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule",t=this,[4,this.lazyProvider.get(this.qnaProxyPath,"InterpretServiceModern")];case 1:return t.interpretService=c.sent(),o=this,[4,this.lazyProvider.get(this.qnaModelUtilsPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","qnaModelUtilsService")];case 2:return o.qnaModelUtils=c.sent(),this.fullConfig=_.merge({},po,this.configs),[4,this.updateCommitOnDemandMode()];case 3:return c.sent(),this.placeholder$=this.fullConfig.showPlaceholderText?_.isEmpty(this.fullConfig.customPlaceholderText)?this.interpretService.getPlaceholderText(this.qnaSupportedScopes).pipe((0,V.q)(1),(0,he.U)(function(l){return l.result})):(0,Pe.of)(this.fullConfig.customPlaceholderText):(0,Pe.of)(""),this.fullConfig.showLoadingIcon&&this.interpretListener.getObservable().subscribe(function(l){if(l&&1===l.resultType&&null!=l.retryWarning){var d=Mi([l.retryWarning],u.qnaProxyPath,u.localizationService);if(g.fF.assert(function(){return!_.isEmpty(d)},"Unmapped retry warning"),!_.isEmpty(d)){var f={tooltipShowOnFocus:!0,tooltipDescription:d,tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:u.getWarningLoadingIconTooltipArrowPosition()};u.loadingStateTooltipConfig$.next(f)}}}),this.ariaLabel=this.screenReaderService.concatMessages([this.fullConfig.customAriaLabel?this.fullConfig.customAriaLabel:this.localizationService.get("Qna_ScreenReader_TextboxLabel"),this.localizationService.get("Qna_ScreenReader_InitialInstruction")]),this.resetTags(),this.presentationSubject$=new ee.X(this.presentationArgs),this.interpretUtteranceRequest$=new ee.X(void 0),this.fullPresentation$=this.presentationSubject$.pipe((0,he.U)(function(l){var d=_.merge({},Pi,l);return d.singleUnderlineThickness=2+Math.floor(d.questionFontProperties.size.px/20),d}),(0,U.b)(function(l){u.autoCompleteInputArgs.presentation.next(l),u.errorBackgroundColorString=(0,vt.Et)(l.errorUnderlineColor,.15),u.warningBackgroundColorString=(0,vt.Et)(l.warningUnderlineColor,.15),u.acceptedBackgroundColorString=(0,vt.Et)(l.acceptedUnderlineColor,.15)}),(0,W.d)()),this.fullConfig.showWarningIcon&&this.fullConfig.disableAuthoring&&!_.isEmpty(this.fullConfig.disableAuthoringMessage)&&this.warningStateTooltipConfig$.next({tooltipShowOnFocus:!0,tooltipDescription:this.fullConfig.disableAuthoringMessage,tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:this.getWarningLoadingIconTooltipArrowPosition()}),this.displayedUtteranceInternal$.pipe((0,ie.R)(this.destroy$),(0,H.x)()).subscribe(function(l){u.distinctDisplayedUtterance$.next(l)}),this.isDisplayedUtteranceEmpty$=this.distinctDisplayedUtterance$.pipe((0,ie.R)(this.destroy$),(0,he.U)(function(l){return _.isEmpty(l)}),(0,H.x)(),(0,W.d)(1)),this.fullConfig.showActionButtons?this.inCommitOnDemandMode?(this.interpretUtteranceRequest$.pipe((0,ie.R)(this.destroy$),(0,he.U)(function(l){return null!=l&&!l.isCommitInCommitQuestionOnDemandMode}),(0,H.x)()).subscribe(function(l){u.hasUncommittedQuestion$.next(l)}),a=(0,ke.aj)([this.hasFocus$,this.isDisplayedUtteranceEmpty$,this.hasUncommittedQuestion$]).pipe((0,ie.R)(this.destroy$),(0,he.U)(function(l){return!!l[2]||l[0]&&!l[1]}),(0,H.x)(),(0,X.B)()),this.commitActionVisible$=null!==(e=this.fullConfig.commitOnDemandConfigs)&&void 0!==e&&e.hideCommitActionUI?(0,Pe.of)(!1):a.pipe((0,ie.R)(this.destroy$)),this.clearActionVisible$=a.pipe((0,ie.R)(this.destroy$))):(this.commitActionVisible$=(0,Pe.of)(!1),this.clearActionVisible$=(0,ke.aj)([this.hasFocus$,this.isDisplayedUtteranceEmpty$]).pipe((0,ie.R)(this.destroy$),(0,he.U)(function(l){return l[0]&&!l[1]}),(0,H.x)())):(this.commitActionVisible$=(0,Pe.of)(!1),this.clearActionVisible$=(0,Pe.of)(!1),this.noResetAllActionIndication=!0),this.isDisplayedUtteranceEmpty$.pipe((0,ie.R)(this.destroy$)).subscribe(function(l){l&&(!_.isEmpty(u.utteranceSuggestions)&&u.isInputBoxFocused()?u.showUtteranceSuggestions():u.contentElement&&(u.updateAutoCompleteArgsCommand$.next(void 0),u.showHideDropdown(!1),u.resetPausedTagTimeoutHandler(!1)))}),this.interpretResponse$=this.interpretUtteranceRequest$.pipe((0,re.R)(function(l,d){return l.push(d),l.slice(-2)},[]),(0,ne.h)(function(l){var d,f,v=_.last(l);if(!v)return!1;var F=null!==(d=Xe(v.utterance))&&void 0!==d?d:"",I=null!==(f=u.initialUtterance)&&void 0!==f?f:"";return g.fF.assert(function(){return null!=u.contentElement||I===F},"If an interpret request sent in before this.contentElement is even initialized, we expect its utterance to be the same as 'initialUtterance' but now it's not. Re-check this assumption and fix accordingly."),!(null==u.contentElement&&I===F)}),(0,U.b)(function(l){_.nth(l,0)&&_.nth(l,1)&&!bi(l[0].utterance,l[1].utterance)&&u.showGrippersAroundTextRangeRequest$.next(void 0)}),(0,he.U)(function(l){var d=_.last(l);if(!d.utteranceUITextAlreadyEnsured){var f=Xe(d.utterance),v=u.getUtteranceSelection(),F=u.ensureContentElementUtteranceText(f);u.displayedUtteranceInternal$.next(f);var I=!1;if(F?(v||d.enforceFocus)&&(v&&u.isValidRange(v)?u.setUtteranceSelection(v):I=!0):!v&&d.enforceFocus&&(I=!0),I){var T=d.utterance.length;u.setUtteranceSelection({normalizedAnchor:T,normalizedFocus:T})}}return d}),(0,ne.h)(function(l){return!!l}),(0,U.b)(function(l){u.displayedUtteranceInternal$.next(Xe(l.utterance))}),(0,ye.w)(function(l){return u.interpretInternal(l)})),this.currentUtteranceInterpretResponse$=(0,ke.aj)([this.interpretUtteranceRequest$,this.interpretResponse$]).pipe((0,he.U)(function(l){var d=l[0],f=l[1];if(f&&d&&f.interpretRequestId===d.uniqueId&&Xe(d.utterance)===u.getCurrentUtteranceSpaceNormalized())return(0,C.pi)((0,C.pi)({},f),{suppressSuggestions:d.suppressSuggestions,requireCursorAtEndIfFocused:d.requireCursorAtEndIfFocused,enforceFocus:d.enforceFocus,delayError:d.delayError,isFromInputEvent:d.isFromInputEvent})}),(0,ne.h)(function(l){return!!l}),(0,ie.R)(this.destroy$),(0,X.B)()),this.currentUtteranceInterpretResponseProcessed$=this.currentUtteranceInterpretResponse$.pipe((0,U.b)(function(l){if(u.loadingStateTooltipConfig$.next(void 0),u.fullConfig.showWarningIcon){var d=l?.warnings,f=Mi(d,u.qnaProxyPath,u.localizationService);if(!_.isEmpty(f)){var F={tooltipShowOnFocus:!0,tooltipDescription:_.isEmpty(u.fullConfig.disableAuthoringMessage)?f:u.localizationService.format("Qna_Input_Warning_AuthoringDisabled_Plus_AnotherWarning",[u.fullConfig.disableAuthoringMessage,f]),tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:u.getWarningLoadingIconTooltipArrowPosition()};u.warningStateTooltipConfig$.next(F)}}}),(0,ne.h)(function(l){return l&&!(_.isEmpty(l.utterance)&&!l.results)}),(0,he.U)(function(l){var d;return{utterance:l.utterance,fullCoverageSpans:vn(l),modelOwner:null===(d=_.first(l.results))||void 0===d?void 0:d.modelOwner,suppressSuggestions:l.suppressSuggestions,requireCursorAtEndIfFocused:l.requireCursorAtEndIfFocused,enforceFocus:l.enforceFocus,delayError:l.delayError,isFromInputEvent:l.isFromInputEvent}}),(0,U.b)(function(l){var d=u.getUtteranceSelectionAnchor();l.suppressSuggestions?u.showHideDropdown(!1):u.updateAutoCompleteArgsCommand$.next({matchingUtterance:l.utterance,cursorPosition:Math.max(d,0),triggerSource:0,spans:l.fullCoverageSpans})}),(0,X.B)()),s=_.merge({},Pi,this.presentationArgs),this.setupAutoCompleteRelatedPipes(s),this.uiSpans$=this.currentUtteranceInterpretResponseProcessed$.pipe((0,qe.D)(function(l){return(0,Ue.H)(l.isFromInputEvent?200:0)}),(0,ne.h)(function(l){return Xe(l.utterance)===u.getCurrentUtteranceSpaceNormalized()}),(0,he.U)(function(l){return{response:l,currentSelection:u.contentElement?u.getUtteranceSelection():void 0}}),(0,U.b)(function(l){var d=Xe(l.response&&l.response.utterance),f=l.currentSelection;u.cleanContentElement(),u.cursorLocation$.next(-1),u.ensureAngularCommentNodes(),u.contentElement.contentEditable="false";var v=l.response;setTimeout(function(){u.changeDetectorRef.detectChanges();var F=u.getCurrentUtteranceSpaceNormalized();if(f){var I=!1;v.requireCursorAtEndIfFocused||d===F&&(I=!0),u.setUtteranceSelection(I?f:{normalizedAnchor:T=F.length,normalizedFocus:T})}else if(u.isInputBoxFocused()||v.enforceFocus){var T;u.setUtteranceSelection({normalizedAnchor:T=F.length,normalizedFocus:T})}u.isInputBoxFocused()&&u.cursorLocation$.next(u.getUtteranceCursorPosition()),u.contentElement.contentEditable="true"},1)}),(0,he.U)(function(l){var d=l.response;return{uiSpans:ho(d.fullCoverageSpans,u.fullConfig),delayError:d.delayError,cursorPosition:l.currentSelection?l.currentSelection.normalizedFocus:-1}}),(0,U.b)(function(l){if(u.cancelUnderlineDelayApply(),l.delayError){var f,v,d=l.cursorPosition;-1!==d&&(f=_.find(l.uiSpans,function(F){return!F.isWhiteSpace&&d>=F.startIndex&&d<=F.endExcludingIndex})),f||(f=_.last(l.uiSpans)),f&&(f.shouldShowErrorUnderline||f.shouldShowWarningUnderline)&&(f.shouldShowErrorUnderline?(f.shouldShowErrorUnderline=!1,v=function(){f.shouldShowErrorUnderline=!0}):(f.shouldShowWarningUnderline=!1,v=function(){f.shouldShowWarningUnderline=!0}),u.underlineDelayApplyInfo={timeoutHandler:setTimeout(function(){v(),u.delayedSpanUnderlineStyleUpdated$.next(!0)},u.fullConfig.showErrorWarningUnderlineTimeout),apply:v})}}),(0,he.U)(function(l){return l.uiSpans}),(0,X.B)()),this.uiSpanWithCursor$=(0,ke.aj)([this.uiSpans$,this.cursorLocation$]).pipe((0,ie.R)(this.destroy$),(0,he.U)(function(l){var f=l[1];if(!(f<0))for(var v=0,F=l[0]||[];v<F.length;v++){var I=F[v];if(!I.isWhiteSpace&&I.text.length>0&&f>=I.startIndex&&f<=I.endExcludingIndex)return I}}),(0,X.B)()),this.uiSpanWithCursor$.pipe((0,ie.R)(this.destroy$),(0,ne.h)(function(l){return!!l})).subscribe(function(l){l.shouldShowErrorUnderline&&u.showGrippersAroundTextRangeRequest$.next({startIndex:l.startIndex,endExcludingIndex:l.endExcludingIndex})}),this.setupCorrectionRelatedPipes(),this.setupGrippersRelatedPipes(),(0,ke.aj)([this.uiSpans$,this.uiSpanWithCursor$,this.uiSpanWithMouseHover$,this.grippersInfo.grippersLocationDuringDragging$,this.tokensGripperLocInfoUpdated$,this.delayedSpanUnderlineStyleUpdated$]).pipe((0,ie.R)(this.destroy$)).subscribe(function(l){var d=l[0],f=l[1],v=l[2],F=l[3],I=F?.associatedUISpans===d&&!!F?.begin&&!!F?.end;_.forEach(d,function(T){var Se=u.getUISpanBackgroundState(T,T===f,T===v,I);T.backgroundColor="error"===Se?u.errorBackgroundColorString:"warning"===Se?u.warningBackgroundColorString:"accepted"===Se?u.acceptedBackgroundColorString:"transparent"})}),this.iconFontSize$=this.fullPresentation$.pipe((0,he.U)(function(l){return u.getIconFontSizePx(l)})),this.questionIconProperties={state$:new ee.X("normal"),ariaLabel$:new ee.X(this.localizationService.get("Qna_ScreenReader_TextboxIcon")),tooltipConfig$:new ee.X(void 0),loadingWarningPresentation$:new ee.X(void 0)},(0,ke.aj)([this.loadingStateTooltipConfig$,this.warningStateTooltipConfig$]).pipe((0,ie.R)(this.destroy$)).subscribe(function(l){var d=l[0],f=l[1],v=d??f;u.questionIconProperties.state$.next(d?"loading":f?"warning":"normal");var F=[u.localizationService.get("Qna_ResetAllStates_Tooltip")];v?.tooltipDescription&&F.push(v?.tooltipDescription);var I=F.join("\n\n"),T=(0,C.pi)({},v??{tooltipShowOnFocus:!0,tooltipDescription:"",tooltipDelay:0,tooltipHideDelay:0,tooltipArrowPosition:u.getWarningLoadingIconTooltipArrowPosition()});T.tooltipDescription=I,u.questionIconProperties.tooltipConfig$.next(T),u.questionIconProperties.ariaLabel$.next(T.tooltipDescription)}),this.fullPresentation$.pipe((0,ie.R)(this.destroy$)).subscribe(function(l){var d=u.getQuestionIconWarningCirleRadius(l);u.questionIconProperties.loadingWarningPresentation$.next({width:2*d,height:2*d,right:1-d+1,top:1-d+1,r:d,cx:d,cy:d,strokeColor:l.backgroundColor,strokeWidth:1,fillColor:l.commitButtonBackgroundColor})}),this.hasInitialized=!0,this.initialized&&this.initialized.emit(),[2]}})})},i.prototype.ngOnChanges=function(e){if(this.hasInitialized){var t=e.presentationArgs&&e.presentationArgs.currentValue;if(t){var r=e.presentationArgs.previousValue,o=r?_.merge({},r,t):t;this.presentationSubject$.next(o)}var a=e.configs&&e.configs.currentValue;if(a){var s=e.configs.previousValue;o=s?_.merge({},s,a):a,g.fF.assertValue(this.fullConfig,"this.fullConfig should have been initialized inside ngOnInit, since it comes here only if this.hasInitialized."),this.fullConfig=_.merge({},this.fullConfig,o)}}},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},Object.defineProperty(i.prototype,"currentDisplayedUtterance",{get:function(){return this.distinctDisplayedUtterance$.value},enumerable:!1,configurable:!0}),i.prototype.isEditable=function(){return!this.fullConfig.disableAuthoring},i.prototype.focus=function(){var e;if(this.contentElement&&(null===(e=this.fullConfig)||void 0===e||!e.disableAuthoring))return this.contentElement.focus(),!0},i.prototype.actionButtonsContainerClicked=function(){this.focus()},i.prototype.clearButtonClicked=function(e){Je(e),this.clearUtterance(!0)},i.prototype.commitButtonClicked=function(e){Je(e),this.hasUncommittedQuestion$.value&&this.commitUtterance()},i.prototype.showGrippersAroundTextRange=function(e){var t=this;g.fF.assert(function(){return t.fullConfig.supportTokenGrippers},"this should be called only when this.fullConfig.supportTokenGrippers is true"),this.showGrippersAroundTextRangeRequest$.next(e)},i.prototype.interpretUtterance=function(e){var t=e.utterance,r=e.isCommitInCommitQuestionOnDemandMode,o=e.specifiedSpans;if(this.inCommitOnDemandMode)if(e.useUncommittedUtterance&&this.hasUncommittedQuestion$.value){var a=this.getCurrentUtteranceSpaceNormalized();a!==t&&(t=a,r=!0,o=void 0)}else!this.hasUncommittedQuestion$.value&&e.utterance===this.getCurrentUtteranceSpaceNormalized()&&(r=!0);this.interpretUtteranceRequest$.next({utterance:t,uniqueId:Fe.b$.generateGuid(),isCommitInCommitQuestionOnDemandMode:r,utteranceUITextAlreadyEnsured:!1,delayError:!1,enforceFocus:e.enforceFocus,requireCursorAtEndIfFocused:e.requireCursorAtEndIfFocused,suppressSuggestions:e.suppressSuggestions,incomingTags:e.incomingTags,linguisticSchemaJson:this.linguisticInfo&&this.linguisticInfo.linguisticSchemaJson,inferredTermBinding:this.linguisticInfo&&this.linguisticInfo.inferredTermBinding,specifiedSpans:o})},i.prototype.clearUtterance=function(e,t){var r=this;void 0===t&&(t=!1),this.undoRedoService.register(this.inCommitOnDemandMode&&t?"Reset Qna state":"Clear QnA utterance",function(){var a=!!r.inCommitOnDemandMode&&t;r.interpretUtteranceRequest$.next({uniqueId:Fe.b$.generateGuid(),utterance:"",utteranceUITextAlreadyEnsured:!1,delayError:!1,enforceFocus:!!e,requireCursorAtEndIfFocused:!1,suppressSuggestions:!0,linguisticSchemaJson:void 0,inferredTermBinding:void 0,incomingTags:void 0,specifiedSpans:void 0,isCommitInCommitQuestionOnDemandMode:a})})},i.prototype.commitUtterance=function(){var e=this;g.fF.assert(function(){return e.inCommitOnDemandMode},"expect this.inCommitOnDemandMode to be true"),this.undoRedoService.register("Commit QnA utterance",function(){e.interpretUtteranceRequest$.next({uniqueId:Fe.b$.generateGuid(),utterance:e.displayedUtteranceInternal$.value,isCommitInCommitQuestionOnDemandMode:!0,utteranceUITextAlreadyEnsured:!0,delayError:!1,enforceFocus:!0,requireCursorAtEndIfFocused:!1,suppressSuggestions:!0,linguisticSchemaJson:void 0,inferredTermBinding:void 0,incomingTags:["Committed"],specifiedSpans:void 0})})},i.prototype.resetAllState=function(){this.clearUtterance(!0,!0)},i.prototype.replaceWithCorrectedUtterance=function(e,t){if(1===t||2===t){var r=1===t?["DidYouMean"]:["ShowingResultsFor"];return r.push("Committed"),void this.replaceWithUtterance(e,!0,!0,!0,r)}g.fF.assertFail("this should only be called for didYouMean or showingResultsFor")},i.prototype.onSpanMouseEnter=function(e){this.uiSpanWithMouseHover$.next(e)},i.prototype.onSpanMouseLeave=function(e){this.uiSpanWithMouseHover$.value===e&&this.uiSpanWithMouseHover$.next(void 0)},i.prototype.gripperKeyUp=function(e,t,r){var o=this,a="beginGripper"===r;if(a||"endGripper"===r){if("Escape"===e.key)return Je(e),lt(e),this.setUtteranceSelection({normalizedAnchor:t.position,normalizedFocus:t.position}),void this.updateAutoCompleteArgsCommand$.next({matchingUtterance:this.getCurrentUtteranceSpaceNormalized(),cursorPosition:t.position,triggerSource:2,spans:void 0});if("ArrowDown"===e.key)return Je(e),lt(e),this.setUtteranceSelection({normalizedAnchor:t.position,normalizedFocus:t.position}),void this.arrowDownOnInputboxHanlder();var u="ArrowLeft"===e.key;(u||"ArrowRight"===e.key)&&(Je(e),lt(e),this.showHideDropdown(!1),this.tryDropGripperInZone(r,a?u?t.previousBeginGripperZoneInfo:t.nextBeginGripperZoneInfo:u?t.previousEndGripperZoneInfo:t.nextEndGripperZoneInfo)&&setTimeout(function(){var d,f,v=a?null===(d=o.beginGripperElementRef)||void 0===d?void 0:d.nativeElement:null===(f=o.endGripperElementRef)||void 0===f?void 0:f.nativeElement;v&&v.focus()}))}},i.prototype.getWarningLoadingIconTooltipArrowPosition=function(){return Mt.xI.arrowBottomLeft},i.prototype.getIconFontSizePx=function(e){return Math.max(e.questionFontProperties.size.px,14)},i.prototype.getQuestionIconWarningCirleRadius=function(e){var t=this.getIconFontSizePx(e);return 3+.5*(Math.floor(t/4)-4)+1},i.prototype.updateCommitOnDemandMode=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t,r;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return g.fF.assertValue(this.fullConfig,"this.fullConfig should already been set"),null!=(e=this.fullConfig.commitOnDemandForcedMode)?(this.inCommitOnDemandMode="AlwaysOn"===e,[2]):(this.inCommitOnDemandMode=!1,t=_.map(this.qnaSupportedScopes,function(a){return a.model}),r=this,[4,(0,en.U)(_.map(t,function(a){return{datasetName:a.dbName,datasetId:a.id}}),this.qnaModelUtils,this.featureSwitchService)]);case 1:return r.inCommitOnDemandMode=o.sent(),[2]}})})},i.prototype.getCurrentUtteranceSpaceNormalized=function(){return this.contentElement?Xe(this.contentElement.textContent):void 0},i.prototype.getUISpanBackgroundState=function(e,t,r,o){return e.shouldShowAcceptedUnderline||e.shouldShowErrorUnderline||e.shouldShowWarningUnderline?((t||r)&&(a=!o&&!_.some(e.tokens,function(s){return s.isBetweenOnDraggingGrippers||s.isBetweenDroppedGrippers})),a?e.shouldShowErrorUnderline?"error":e.shouldShowWarningUnderline?"warning":"accepted":"normal"):"normal";var a},i.prototype.replaceWithUtterance=function(e,t,r,o,a){var s=this;this.undoRedoService.register("Replace QnA utterance",function(){var u,c;s.interpretUtteranceRequest$.next({uniqueId:Fe.b$.generateGuid(),utterance:e,utteranceUITextAlreadyEnsured:!1,suppressSuggestions:t,requireCursorAtEndIfFocused:!0,enforceFocus:r,delayError:!1,linguisticSchemaJson:null===(u=s.linguisticInfo)||void 0===u?void 0:u.linguisticSchemaJson,inferredTermBinding:null===(c=s.linguisticInfo)||void 0===c?void 0:c.inferredTermBinding,incomingTags:a,specifiedSpans:void 0,isCommitInCommitQuestionOnDemandMode:o})})},i.prototype.autoCompleteDropdownItemSelected=function(e){var t,r=this.getCurrentUtteranceSpaceNormalized();1===e.action&&this.toolingLaunched.emit();var o=!(null!==(t=this.fullConfig.commitOnDemandConfigs)&&void 0!==t&&t.noCommitOnDropdownSelection);_.isEmpty(e.utterance)||Xe(e.utterance)===r?this.showHideDropdown(!!e.showDropdown,{incomingTags:e.tags,utterance:r}):(this.resetPausedTagTimeoutHandler(!1),this.replaceWithUtterance(Xe(e.utterance),!0,!0,o,e.tags),this.showHideDropdown(!1)),this.inCommitOnDemandMode&&o&&this.hasUncommittedQuestion$.value&&this.commitUtterance()},i.prototype.autoCompleteFullyExpanded=function(){g.fF.assertValue(this.utteranceSelectionAtLastAutoCompleteInputUpdate,"autocomplete fully expanded, this.utteranceSelectionAtLastAutoCompleteInputUpdate should be defined"),this.utteranceSelectionAtLastAutoCompleteInputUpdate?this.setUtteranceSelection(this.utteranceSelectionAtLastAutoCompleteInputUpdate):this.focus()},i.prototype.getTokenZoneInfo=function(e,t){var r=e.dropZonesInfo;if(r)return t?r.zoneLocatedBeforeInfo:r.zoneLocatedAfterInfo},i.prototype.dropZonePredicate=function(e,t){return"beginGripper"===e.data?!!t.data.beginGripperOf:!!t.data.endGripperOf},i.prototype.beginGripperDragStarted=function(){this.oneGripperDragStarted("beginGripper")},i.prototype.endGripperDragStarted=function(){this.oneGripperDragStarted("endGripper")},i.prototype.gripperEnter=function(e){var t,r;Ii(null===(t=e.item)||void 0===t?void 0:t.data,null===(r=e.container)||void 0===r?void 0:r.data,this.grippersInfo.grippersLocationDuringDragging$)},i.prototype.dropGripper=function(e){var t,r,o=null===(t=e.item)||void 0===t?void 0:t.data,a=null===(r=e.container)||void 0===r?void 0:r.data;this.tryDropGripperInZone(o,a)},i.prototype.tryDropGripperInZone=function(e,t){var r;return this.grippersInfo.gripperOnDragging$.next("none"),g.fF.assertValue(null===(r=this.grippersInfo.grippersLocationDuringDragging$.value)||void 0===r?void 0:r.associatedUISpans,"this.grippersInfo.grippersLocationDuringDragging$.value.associatedUISpans should be defined"),this.grippersInfo.grippersLocationDuringDragging$.next({associatedUISpans:this.grippersInfo.grippersLocationDuringDragging$.value.associatedUISpans,begin:void 0,end:void 0}),Ii(e,t,this.grippersInfo.grippersLocationDropped$)},i.prototype.sendFeedback=function(e,t){return g.fF.assertValue(e,"invalid feedback"),g.fF.assertValue(t,"invalid feedback utterance"),this.interpretService.sendFeedback(e,t,this.qnaSupportedScopes,this.tags)},i.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".qnaInputV2Container svg *","{ stroke: @foregroundColor !important; fill: @foregroundColor !important; opacity: 1 !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .qnaInputV2Container *.disabled, .themeableElement .qnaInputV2Container *.disabled *","{ color: @disabledTextColor !important; border-color: @disabledTextColor !important; opacity: 1 !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .inputBox .qnaInputV2Container .inputWithoutAutoCompleteContainer button.actionButton.disabled:hover, .themeableElement .inputBox .qnaInputV2Container .inputWithoutAutoCompleteContainer button.actionButton.disabled:hover * ","{ background-color: transparent !important; color: @disabledTextColor !important; }"),this.highContrastCssGenerationService.addRule('html[data-focus-source="key"] .inputBox .qnaInputV2Container .beginGripper:focus, html[data-focus-source="key"] .inputBox .qnaInputV2Container .endGripper:focus',"{ outline-color: @foregroundColor; outline-offset: 4px; outline-style: dashed }")},i.prototype.showUtteranceSuggestions=function(){if(!_.isEmpty(this.utteranceSuggestions)){var e={startIndex:0,endExcludingIndex:0,text:"",isUnknown:!1,isCorrected:!1,state:"accepted",isOverlapping:!1,isWhiteSpace:!1,isUsed:!1,replacementBindings:{alternates:_.map(this.utteranceSuggestions,function(r){return{type:10,text:r,textSegmentsWithMatchInfo:[{text:r,isMatched:!1}],score:0}})}};this.showHideDropdown(!0),this.autoCompleteInputArgs.params.next({spans:[e],cursorPosition:0,config:{header:{show:!1}}}),this.resetPausedTagTimeoutHandler(!1)}},i.prototype.resetTags=function(){this.tags=[this.entryPoint]},i.prototype.flushUnderlineDelayApply=function(){if(this.underlineDelayApplyInfo){var e=this.underlineDelayApplyInfo.apply;this.cancelUnderlineDelayApply(),e()}},i.prototype.cancelUnderlineDelayApply=function(){this.underlineDelayApplyInfo&&(clearTimeout(this.underlineDelayApplyInfo.timeoutHandler),this.underlineDelayApplyInfo.timeoutHandler=void 0,this.underlineDelayApplyInfo=void 0)},i.prototype.showDropdownAtCurrentPosition=function(e){var t=this.getUtteranceSelectionAnchor();this.showDropdownAtPosition(e,t)},i.prototype.showDropdownAtPosition=function(e,t){g.fF.assert(function(){return-1!==t},"the given cursorPosition should not be -1.");var r=this.getCurrentUtteranceSpaceNormalized();g.fF.assert(function(){return t<=_.size(r)},"the given cursorPosition should not be > current displayed utterance's length."),-1!==t&&this.updateAutoCompleteArgsCommand$.next({matchingUtterance:r,cursorPosition:t,triggerSource:e,spans:void 0}),this.showHideDropdown(!0)},i.prototype.setupAutoCompleteRelatedPipes=function(e){var t=this;this.isDropdownOn$=new ee.X(!1),this.updateAutoCompleteArgsCommand$=new ee.X(void 0),this.autoCompleteInputArgs={params:new ee.X(void 0),presentation:new ee.X(e),selectPrevious:new ee.X(void 0),selectNext:new ee.X(void 0),confirmSelection:new ee.X(void 0)},this.fullConfig.disableAuthoring?this.shouldShowAutoComplete$=(0,Pe.of)(!1):((0,ke.aj)([this.updateAutoCompleteArgsCommand$,this.currentUtteranceInterpretResponseProcessed$]).pipe((0,he.U)(function(r){var o=r[0],a=r[1];if(o&&a&&bi(o.matchingUtterance,a.utterance))return{command:o,response:a}}),(0,ne.h)(function(r){return!!r}),(0,H.x)(function(r,o){if(r.command.matchingUtterance===o.command.matchingUtterance&&r.command.cursorPosition===o.command.cursorPosition)return!0}),(0,he.U)(function(r){var o,a,s=r.command,u=r.response,c=t.getCurrentUtteranceSpaceNormalized(),l={spans:s.spans||u.fullCoverageSpans,cursorPosition:s.cursorPosition,config:{header:{show:(null===(o=t.fullConfig.spanDropdownHeaderConfig)||void 0===o?void 0:o.show)&&0!==s.triggerSource&&s.cursorPosition<c.length}},modelOwner:u.modelOwner,dataSourceArray:t.dataSourcesService.get(),exploration:t.explorationNavigationService.getCurrentExploration()};return l.config.header.show&&(l.config.header.unknownSpanHeaderConfig=null===(a=t.fullConfig.spanDropdownHeaderConfig)||void 0===a?void 0:a.unknownSpanHeaderConfig),{params:l,utterance:s.matchingUtterance}}),(0,ie.R)(this.destroy$)).subscribe(function(r){t.autoCompleteInputArgs.params.next(r.params);var o=!_.isEmpty(r.utterance)&&!!r.params;t.resetPausedTagTimeoutHandler(o,r.utterance);var a=!_.isEmpty(r.utterance)&&!t.escapedDropdown;t.showHideDropdown(a)}),this.shouldShowAutoComplete$=(0,ke.aj)([this.isDropdownOn$,this.autoCompleteInputArgs.params]).pipe((0,he.U)(function(r){return!!r[1]&&!!r[0]}),(0,U.b)(function(r){t.utteranceSelectionAtLastAutoCompleteInputUpdate=r?t.getUtteranceSelection():void 0}),(0,H.x)(),(0,ie.R)(this.destroy$)))},i.prototype.setupCorrectionRelatedPipes=function(){var e=this;this.currentUtteranceAutoCorrectionInfo$=this.fullConfig.showCorrectedUtterance?this.currentUtteranceInterpretResponse$.pipe((0,ne.h)(function(r){return!r.isQuestionUnCommitted}),(0,he.U)(function(r){var s,u,o=_.first(r?.results),a=o?.correctionInfo;if(a&&0!==a.state)return(0,je.Gd)(a)?(s=a.correctedUtterance,u=(0,je.zM)(a)):(s=a.replacementUtterance,u=(0,je.Yi)(o.spans,a)),{label:mo(a.state,e.localizationService),spans:u,replacementUtterance:s,state:a.state}})):(0,Pe.of)(void 0)},i.prototype.setupGrippersRelatedPipes=function(){var e=this;this.grippersInfo={grippersLocationDropped$:new ee.X(void 0),grippersLocationDuringDragging$:new ee.X(void 0),gripperOnDragging$:new ee.X("none")},this.showGrippersAroundTextRangeRequest$=new ee.X(void 0),this.fullConfig.supportTokenGrippers&&((0,ke.aj)([this.uiSpans$,this.showGrippersAroundTextRangeRequest$]).pipe((0,ie.R)(this.destroy$)).subscribe(function(t){var r=t[0],o=t[1],a=-1;o&&(a=_.findIndex(r,function(u){return u.startIndex===o.startIndex&&u.endExcludingIndex===o.endExcludingIndex})),e.grippersInfo.grippersLocationDropped$.next(-1===a?{associatedUISpans:r,begin:void 0,end:void 0}:{associatedUISpans:r,begin:{spanIndex:a,tokenIndex:0},end:{spanIndex:a,tokenIndex:_.size(r[a].tokens)-1}}),e.grippersInfo.grippersLocationDuringDragging$.next({associatedUISpans:r,begin:void 0,end:void 0}),e.grippersInfo.gripperOnDragging$.next("none")}),(0,ke.aj)([this.uiSpans$,this.grippersInfo.grippersLocationDuringDragging$]).pipe((0,ie.R)(this.destroy$),(0,H.x)(function(t,r){return t[0]===r[0]&&_.isEqual(t[1],r[1])})).subscribe(function(t){var r=t[0],o=t[1];o&&o.associatedUISpans!==r||(_.forEach(r,function(a,s){_.forEach(a.tokens,function(u,c){u.isBetweenOnDraggingGrippers=!!o&&xi(s,c,e.grippersInfo.grippersLocationDuringDragging$.value)})}),e.tokensGripperLocInfoUpdated$.next(!0))}),(0,ke.aj)([this.uiSpans$,this.grippersInfo.grippersLocationDropped$]).pipe((0,ie.R)(this.destroy$),(0,H.x)(function(t,r){return t[0]===r[0]&&_.isEqual(t[1],r[1])})).subscribe(function(t){var r=t[0],o=t[1];if(!o||o.associatedUISpans===r)if(_.forEach(r,function(d,f){_.forEach(d.tokens,function(v,F){var I=v.dropZonesInfo;if(o?.begin&&o?.end){if(I){var T=I.zoneLocatedBeforeInfo;T.hasBeginGripper=Ln(v,!0,"beginGripper",o),T.hasEndGripper=Ln(v,!0,"endGripper",o);var Se=I.zoneLocatedAfterInfo;Se.hasBeginGripper=Ln(v,!1,"beginGripper",o),Se.hasEndGripper=Ln(v,!1,"endGripper",o)}v.isBetweenDroppedGrippers=xi(f,F,e.grippersInfo.grippersLocationDropped$.value)}else I&&(I.zoneLocatedBeforeInfo.hasBeginGripper=!1,I.zoneLocatedBeforeInfo.hasEndGripper=!1,I.zoneLocatedAfterInfo.hasBeginGripper=!1,I.zoneLocatedAfterInfo.hasEndGripper=!1),v.isBetweenDroppedGrippers=!1})}),e.tokensGripperLocInfoUpdated$.next(!0),o?.begin&&o?.end){var a=o.begin,u=o.end,c=r[u.spanIndex].tokens[u.tokenIndex];e.grippersDefinedTextRangeChanged.emit({startIndex:r[a.spanIndex].tokens[a.tokenIndex].startIndex,endExcludingIndex:c.startIndex+c.text.length})}else e.grippersDefinedTextRangeChanged.emit(void 0)}))},i.prototype.interpretInternal=function(e){var t=this;this.fullConfig.showWarningIcon&&!_.isEmpty(this.fullConfig.disableAuthoringMessage)?this.warningStateTooltipConfig$.next({tooltipShowOnFocus:!0,tooltipDescription:this.fullConfig.disableAuthoringMessage,tooltipDelay:0,tooltipHideDelay:0}):this.warningStateTooltipConfig$.next(void 0),this.loadingStateTooltipConfig$.next(void 0);var r=!0;this.inCommitOnDemandMode&&(r=!!e.isCommitInCommitQuestionOnDemandMode),this.escapedDropdown=!1;var o={utterance:"",interpretRequestId:e.uniqueId,isQuestionCommitted:!0};if(_.isEmpty(e.utterance))return r&&this.interpretListener.onInterpretResultCleared(),this.resetTags(),(0,Pe.of)(o);var a=_.union(this.tags,e.incomingTags);this.resetTags();var s=this.fullConfig.calculation;return s&&r&&(s=(0,C.pi)((0,C.pi)({},s),{isCommitted:!0})),this.interpretRequestSequenceNumber++,this.getReportMetadata().pipe((0,ye.w)(function(c){return t.interpretService.interpret({groupId:t.componentUniqueId,groupSequenceNumber:t.interpretRequestSequenceNumber},e.utterance,t.entryPoint,t.qnaSupportedScopes,t.interpretListener,{supportsPodQueries:t.fullConfig.supportsPodQueries,supportsInsightsQueries:t.fullConfig.supportsInsightsQueries,inferUnknownModelTerms:t.fullConfig.inferUnknownModelTerms,singleAnswerBias:t.fullConfig.singleAnswerBias,supportsCalculation:!!s},{isQuestionNotCommitted:!r,specifiedSpans:e.specifiedSpans,linguisticSchemaJson:e.linguisticSchemaJson,inferredTermBinding:e.inferredTermBinding,tags:a,calculation:s},c).pipe((0,V.q)(1),(0,he.U)(function(l){return _.merge({},l,{interpretRequestId:e.uniqueId,isQuestionUnCommitted:!r})}))}))},i.prototype.getReportMetadata=function(){var e=this;if("@powerbi/Qna/qnadesktop.module#QnaDesktopModule"!==this.qnaProxyPath||!this.fullConfig.supportsPodQueries||!this.linguisticSchemaProxy)return(0,Pe.of)(void 0);var t=this.explorationNavigationService.getCurrentExploration();return t?(0,Oe.D)(this.conceptualSchemaProxy.get(this.dataSourcesService.get())).pipe((0,he.U)(function(o){var a=e.linguisticSchemaProxy.getSchema(-1);if(a?.content)return{linguisticSchema:a.content,pods:_.map(t.pods,function(s){return{name:s.name,parameters:_.chain(s.parameters).map(function(u){var c=function(i,e,t,r){var o=_.find(t.sections,function(u){return u.name===e});if(o){var a=_.find(o.filters,function(u){return u.name===i});if(a?.expression){var s=a.expression.getConceptualProperty(r);return s?{column:s.name,entity:a.expression.getTargetEntity().entity}:void 0}g.fF.assertFail("filter should be part of the section and have an expression")}else g.fF.assertFail("pod section should be part of the exploration")}(u.boundFilter,s.boundSection,t,o);if(c)return{name:u.name,targetColumn:c.column,targetEntity:c.entity}}).filter(function(u){return!!u}).value(),cortanaEnabled:s.cortanaEnabled}})}})):(0,Pe.of)(void 0)},i.prototype.resetPausedTagTimeoutHandler=function(e,t){var r=this;this.fullConfig.disableSendingServiceTags||(null!=this.pausedTagTimeoutHandler&&(clearTimeout(this.pausedTagTimeoutHandler),this.pausedTagTimeoutHandler=null),e&&(g.fF.assert(function(){return!_.isEmpty(t)},"Expect the given utteranceIfRestart not to be empty."),this.pausedTagTimeoutHandler=setTimeout(function(){r.sendTags(["Paused"],t),r.pausedTagTimeoutHandler=void 0},this.fullConfig.sendPausedTagTimeout)))},i.prototype.showHideDropdown=function(e,t){if(!this.fullConfig.disableAuthoring){var r=this.isDropdownOn$.value;if(this.escapedDropdown=!e,(r!==e||e)&&(this.isDropdownOn$.next(e),t)){var o=void 0;_.isEmpty(this.getCurrentUtteranceSpaceNormalized())?o=_.union(t.incomingTags,["Dropdown:Suggested","Committed"]):(g.fF.assert(function(){return!_.isEmpty(t.utterance)},"Going to send tags for dropdown commit, expect its associated utterance not empty"),o=_.union(t.incomingTags,["Committed"])),this.resetPausedTagTimeoutHandler(!1),this.sendTags(o,t.utterance)}}},i.prototype.sendTags=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var r;return(0,C.Jh)(this,function(o){switch(o.label){case 0:return r=_.union(this.tags,e),this.resetTags(),_.isEmpty(r)?[2]:[4,this.interpretService.sendTags(r,t,this.entryPoint,this.qnaSupportedScopes,{supportsPodQueries:this.fullConfig.supportsPodQueries,supportsInsightsQueries:this.fullConfig.supportsInsightsQueries,inferUnknownModelTerms:this.fullConfig.inferUnknownModelTerms,singleAnswerBias:this.fullConfig.singleAnswerBias})];case 1:return o.sent(),[2]}})})},i.prototype.isInputBoxFocused=function(){return this.contentElement&&y(this.contentElement,document.activeElement)},i.prototype.getUtteranceSelection=function(){if(g.fF.assertValue(this.contentElement,"this.contentElement"),this.isInputBoxFocused())return function(i){if(i&&window.getSelection){var e=window.getSelection();if(e.rangeCount&&y(i,e.anchorNode)&&y(i,e.focusNode)){var t=e.getRangeAt(0),r=t.cloneRange();r.selectNodeContents(i),r.setEnd(t.startContainer,t.startOffset);var o=r.toString().length;if(e.isCollapsed)return{normalizedAnchor:o,normalizedFocus:o};r.setEnd(t.endContainer,t.endOffset);var a=r.toString().length,s=e.anchorNode===t.startContainer;return{normalizedAnchor:s?o:a,normalizedFocus:s?a:o}}}}(this.contentElement)},i.prototype.isValidRange=function(e){var t=_.size(this.contentElement.textContent);return _.inRange(e.normalizedAnchor,0,t+1)&&_.inRange(e.normalizedFocus,0,t+1)},i.prototype.setUtteranceSelection=function(e){g.fF.assertValue(e,"selection"),g.fF.assertValue(this.contentElement,"this.contentElement"),function(i,e){g.fF.assertValue(i,"Expect the given node to be defined."),g.fF.assertValue(e,"Expect the given selectionRange to be defined."),g.fF.assert(function(){return _.inRange(e.normalizedAnchor,0,_.size(i.textContent)+1)},"Expect the given selectionRange.anchor is a valid position inside the given node"),g.fF.assert(function(){return _.inRange(e.normalizedFocus,0,_.size(i.textContent)+1)},"Expect the given selectionRange.focus is a valid position inside the given node");var t=_.size(i.textContent);if(i&&e&&_.inRange(e.normalizedAnchor,0,t+1)&&_.inRange(e.normalizedFocus,0,t+1)){var r=window.getSelection&&window.getSelection();if(r){var o=e.normalizedAnchor,a=e.normalizedFocus,s=h(i,o);if(g.fF.assertValue(s,"Expect to find the NodeAndOffset for character position "+o+" inside the node"),s){var u=a===o?s:h(i,a);if(g.fF.assertValue(s,"Expect to find the NodeAndOffset for character position "+a+" inside the node"),u){var c=s.node,l=s.textOrChildNodesOffset,d=u.node,f=u.textOrChildNodesOffset;if(r.anchorNode!==c||r.focusNode!==d||r.anchorOffset!==l||r.focusOffset!==f){i instanceof HTMLElement&&i.focus();var v=document.createRange();v.setStart(c,l),v.setEnd(d,f),r.removeAllRanges(),r.addRange(v)}}}}}}(this.contentElement,e)},i.prototype.getUtteranceCursorPosition=function(){var e=this.getUtteranceSelection();return e?e.normalizedFocus:-1},i.prototype.getUtteranceSelectionAnchor=function(){return Jt(0,this.getUtteranceSelection())},i.prototype.addEventListeners=function(){var e=this;(0,Me.R)(this.contentElement,"click").pipe((0,ie.R)(this.destroy$),(0,X.B)()).subscribe(function(d){var f=e.getUtteranceSelection(),v=Jt(1,f);e.cursorLocation$.next(v),e.flushUnderlineDelayApply(),Je(d);var F=e.getCurrentUtteranceSpaceNormalized(),I=Jt(0,f);_.isEmpty(F)||-1!==I&&e.updateAutoCompleteArgsCommand$.next({matchingUtterance:F,cursorPosition:I,triggerSource:1,spans:void 0})});var r=(0,Me.R)(this.contentElement,"paste").pipe((0,he.U)(function(d){return{event:d,beforePastedContentElementText:e.contentElement.textContent}}),(0,U.b)(function(d){if(lt(d.event),Je(d.event),window.getSelection){var f=(e.getCurrentUtteranceSpaceNormalized()||"").length,v=e.getUtteranceSelection();v&&(f-=Math.abs(v.normalizedAnchor-v.normalizedFocus));var F=(function(i){var e=i.originalEvent||i;return e.clipboardData&&e.clipboardData.getData?e.clipboardData.getData("text/plain"):window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):void 0}(d.event)||"").substr(0,200-f);!function(i){g.fF.assertValue(window.getSelection,"Expecting window.getSelection is defined");var e=window.getSelection();if(e.rangeCount){var t=e.getRangeAt(0);if(t.deleteContents(),i){var r=document.createTextNode(i);t.insertNode(r),t.setStart(r,i.length),t.collapse(!0)}}}(F)}}),(0,ne.h)(function(d){return d.beforePastedContentElementText!==e.contentElement.textContent})),o=(0,Me.R)(this.contentElement,"compositionend").pipe((0,X.B)()),a=(0,Me.R)(this.contentElement,"keyup").pipe((0,ie.R)(this.destroy$),(0,ne.h)(function(d){return!Tt(d)}),(0,X.B)());a.pipe((0,ie.R)(this.destroy$),(0,ne.h)(function(d){return"Backspace"===d.key||"Delete"===d.key})).subscribe(function(d){_.isEmpty(e.getCurrentUtteranceSpaceNormalized())&&e.cleanContentElement()}),a.pipe((0,ie.R)(this.destroy$),(0,ne.h)(function(d){return _.includes(["Home","End","ArrowLeft","ArrowRight"],d.key)})).subscribe(function(d){Yn(d)||e.cursorLocation$.next(e.getUtteranceCursorPosition())});var s=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Backspace","Delete","Home","End","Enter","Escape","Tab"],u=["A","X","C","Z","a","x","c","z"],c=(0,Me.R)(this.contentElement,"keydown").pipe((0,ie.R)(this.destroy$),(0,ne.h)(function(d){return!Tt(d)}),(0,U.b)(function(d){!Yn(d)&&!_.includes(s,d.key)&&(!d.ctrlKey||!_.includes(u,d.key))&&e.getCurrentUtteranceSpaceNormalized().length>=200&&lt(d)}),(0,X.B)());(0,Me.R)(this.contentElement,"focus").pipe((0,ie.R)(this.destroy$),(0,$e.M)(this.distinctDisplayedUtterance$)).subscribe(function(d){var v=d[1];e.inputBoxFocused.emit(d[0]),e.hasFocus$.next(!0),e.cursorLocation$.next(e.getUtteranceCursorPosition()),!e.isAutoCompleteDropdownShown()&&_.isEmpty(v)&&e.showUtteranceSuggestions()}),(0,Me.R)(this.contentElement,"blur").pipe((0,ie.R)(this.destroy$)).subscribe(function(d){var f=d.relatedTarget;e.deleteButtonElementRef&&e.deleteButtonElementRef.nativeElement.contains(f)||e.commitButtonElementRef&&e.commitButtonElementRef.nativeElement.contains(f)||e.hasFocus$.next(!1),e.cursorLocation$.next(-1),e.flushUnderlineDelayApply();var I=window.getSelection?window.getSelection():void 0;I&&I.removeAllRanges()});var l=(0,Me.R)(this.contentElement,"input").pipe((0,ne.h)(function(d){return!d.isComposing}));(0,Le.T)(l,o,r).pipe((0,ie.R)(this.destroy$),(0,he.U)(function(d){return e.getCurrentUtteranceSpaceNormalized()}),(0,U.b)(function(d){e.displayedUtteranceInternal$.next(d)})).subscribe(function(d){e.interpretUtteranceRequest$.next({uniqueId:Fe.b$.generateGuid(),utterance:d,utteranceUITextAlreadyEnsured:!0,delayError:!0,enforceFocus:!1,suppressSuggestions:!1,requireCursorAtEndIfFocused:!1,linguisticSchemaJson:e.linguisticInfo&&e.linguisticInfo.linguisticSchemaJson,inferredTermBinding:e.linguisticInfo&&e.linguisticInfo.inferredTermBinding,incomingTags:void 0,specifiedSpans:void 0,isFromInputEvent:!0})}),c.pipe((0,ie.R)(this.destroy$),(0,ne.h)(function(d){return!Tt(d)})).subscribe(function(d){if(Yn(d)&&!_.includes(["Tab","Enter"],d.key))return _.includes(["ArrowLeft","ArrowRight","Escape","ArrowDown"],d.key)?(Je(d),void lt(d)):void 0;var f=e.getCurrentUtteranceSpaceNormalized();switch(d.key){case"z":case"Z":wt.M.isCtrlOrMeta(d)&&(lt(d),e.fullConfig.hostSupportsUndo?e.contentElement.blur():Je(d));break;case"ArrowLeft":e.flushUnderlineDelayApply(),Je(d),_.isEmpty(f)||-1!==(F=Jt(0,v=e.getUtteranceSelection()))&&e.updateAutoCompleteArgsCommand$.next({matchingUtterance:f,cursorPosition:v.normalizedAnchor!==v.normalizedFocus?F:Math.max(0,F-1),triggerSource:2,spans:void 0});break;case"ArrowRight":case"Right":var v,F;e.flushUnderlineDelayApply(),Je(d),_.isEmpty(f)||-1!==(F=Jt(0,v=e.getUtteranceSelection()))&&e.updateAutoCompleteArgsCommand$.next({matchingUtterance:f,cursorPosition:v.normalizedAnchor!==v.normalizedFocus?F:Math.min(F+1,f.length),triggerSource:2,spans:void 0});break;case"ArrowUp":e.flushUnderlineDelayApply(),Je(d),lt(d),e.autoCompleteInputArgs.selectPrevious.next(!0);break;case"ArrowDown":e.flushUnderlineDelayApply(),Je(d),lt(d),e.arrowDownOnInputboxHanlder();break;case"Enter":e.flushUnderlineDelayApply(),Je(d),e.isAutoCompleteDropdownShown()?e.autoCompleteInputArgs.confirmSelection.next(!0):(e.enterKeyPressed&&e.enterKeyPressed.emit(),e.inCommitOnDemandMode&&e.hasUncommittedQuestion$.value&&e.commitUtterance()),lt(d);break;case"Backspace":"false"===e.contentElement.contentEditable&&lt(d);case"Delete":Je(d);break;case"Escape":e.flushUnderlineDelayApply();var I=e.isAutoCompleteDropdownShown();e.showHideDropdown(!1,{utterance:f}),I&&(lt(d),Je(d));break;case"Home":_.isEmpty(f)||e.updateAutoCompleteArgsCommand$.next({matchingUtterance:f,cursorPosition:0,triggerSource:2,spans:void 0});break;case"End":_.isEmpty(f)||e.updateAutoCompleteArgsCommand$.next({matchingUtterance:f,cursorPosition:f.length,triggerSource:2,spans:void 0})}})},i.prototype.cleanContentElement=function(){this.contentElement&&_.filter(this.contentElement.childNodes,function(t){return t.nodeType!==Node.COMMENT_NODE}).forEach(function(t){nn(t)})},i.prototype.isAutoCompleteDropdownShown=function(){var e;return null===(e=this.autoCompleteComponent)||void 0===e?void 0:e.showAutoCompleteDropdown},i.prototype.ensureAngularCommentNodes=function(){var e=this;""===this.contentElement.textContent&&(this.contentElement.innerHTML="");var t=[];_.forEach(this.contentElement.childNodes,function(c){c.nodeType===Node.COMMENT_NODE&&_.includes(e.contentElementAngularCommentNodes,c)&&t.push(c)});var r=_.size(this.contentElementAngularCommentNodes);if(_.size(t)!==r){_.forEach(t,function(c){return nn(c)});var o=_.first(this.contentElement.childNodes);if(o)for(var a=o,s=void 0,u=r-1;u>=0;u--)this.contentElement.insertBefore(s=this.contentElementAngularCommentNodes[u],a),a=s;else _.forEach(this.contentElementAngularCommentNodes,function(c){e.contentElement.appendChild(c)})}},i.prototype.ensureContentElementUtteranceText=function(e){return Xe(e)!==this.getCurrentUtteranceSpaceNormalized()&&(this.cleanContentElement(),e&&this.contentElement.appendChild(document.createTextNode(e)),!0)},i.prototype.oneGripperDragStarted=function(e){g.fF.assert(function(){return"none"!==e},"Expect this not to be called with GripperIdentifier.None");var t=this.grippersInfo.grippersLocationDropped$.value;g.fF.assertValue(t,"this.grippersInfo.grippersLocationDropped$.value should be defined"),this.grippersInfo.grippersLocationDuringDragging$.next({associatedUISpans:t.associatedUISpans,begin:t.begin,end:t.end}),this.grippersInfo.gripperOnDragging$.next(e)},i.prototype.arrowDownOnInputboxHanlder=function(){this.showDropdownAtCurrentPosition(2),this.autoCompleteInputArgs.selectNext.next(!0)},i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(xe.i),n.\u0275\u0275directiveInject(Re.D),n.\u0275\u0275directiveInject(Ce.z),n.\u0275\u0275directiveInject(Ke.vZ),n.\u0275\u0275directiveInject(Pt.g),n.\u0275\u0275directiveInject(Ge.E),n.\u0275\u0275directiveInject(Ut.o),n.\u0275\u0275directiveInject(At.g),n.\u0275\u0275directiveInject(pt.z),n.\u0275\u0275directiveInject(gt.e,8),n.\u0275\u0275directiveInject(Bt.n,8),n.\u0275\u0275directiveInject(qt.z,8))},i.\u0275cmp=n.\u0275\u0275defineComponent({type:i,selectors:[["qna-input-v2"]],viewQuery:function(t,r){if(1&t&&(n.\u0275\u0275viewQuery(Ft,5,n.ElementRef),n.\u0275\u0275viewQuery(Ye,5,n.ElementRef),n.\u0275\u0275viewQuery(sn,5,n.ElementRef),n.\u0275\u0275viewQuery(un,5,n.ElementRef),n.\u0275\u0275viewQuery(ln,5,n.ElementRef),n.\u0275\u0275viewQuery(ce,5),n.\u0275\u0275viewQuery(cn,5,n.ElementRef),n.\u0275\u0275viewQuery(Kt,5,n.ElementRef),n.\u0275\u0275viewQuery(dn,5,n.ElementRef),n.\u0275\u0275viewQuery(be,5,n.ElementRef)),2&t){var o=void 0;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.contentElementExtraContainer=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.deleteButtonElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.commitButtonElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.autoCompleteElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.contentElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.autoCompleteComponent=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.qnaInputContainerElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.beginGripperElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.endGripperElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.spanElementRefs=o)}},hostVars:1,hostBindings:function(t,r){2&t&&n.\u0275\u0275attribute("tabindex",null!=r.fullConfig&&r.fullConfig.disableAuthoring?null:-1)},inputs:{entryPoint:"entryPoint",presentationArgs:"presentationArgs",configs:"configs",qnaSupportedScopes:"qnaSupportedScopes",interpretListener:"interpretListener",linguisticInfo:"linguisticInfo",initialUtterance:"initialUtterance",initialUtteranceFromSaved:"initialUtteranceFromSaved",utteranceSuggestions:"utteranceSuggestions"},outputs:{grippersDefinedTextRangeChanged:"grippersDefinedTextRangeChanged",enterKeyPressed:"enterKeyPressed",initialized:"initialized",toolingLaunched:"toolingLaunched",inputBoxFocused:"inputBoxFocused"},features:[n.\u0275\u0275NgOnChangesFeature],decls:2,vars:3,consts:[[4,"ngIf"],["class","resetButtonAndInputV2Container",4,"ngIf"],["class","qnaAutoCorrection",3,"ngStyle",4,"ngIf"],[1,"resetButtonAndInputV2Container"],["data-testId","qna-input-v2-container","role","application",1,"qnaInputV2Container",3,"ngClass","ngStyle"],["qnaInputContainer",""],[1,"inputAndAutoCompleteContainer",3,"ngStyle","ngClass"],[1,"inputWithoutAutoCompleteContainer",3,"ngStyle","ngClass"],["contenteditable","false","tabindex","-1",1,"utteranceContentExtraContainer"],["contentElementExtraContainer",""],["data-testId","qna-input-box","tabindex","0","cdkDropListGroup","","role","textbox","aria-autocomplete","list","spellcheck","false",1,"utteranceContent",3,"ngClass"],["contentElement",""],["class","term",3,"ngClass","ngStyle","mouseover","mouseleave",4,"ngFor","ngForOf"],[3,"withTopSeparator","params","presentation","selectPrevious","selectNext","confirmSelection","utteranceSelected","fullyExpanded",4,"ngIf"],[1,"beforeUtteranceOneLineHeightContainer",3,"ngStyle"],["aria-hidden","true",2,"width","1px",3,"ngStyle"],["class","questionIcon glyphicon pbi-glyph-qna",3,"ngClass","ngStyle","pbi-tooltip","accessible-click",4,"ngIf"],[1,"questionIcon","glyphicon","pbi-glyph-qna",3,"ngClass","ngStyle","pbi-tooltip","accessible-click"],["class","questionIconWarningLoadingCircle","preserveAspectRatio","none","style","position: absolute;",3,"ngStyle",4,"ngIf"],["preserveAspectRatio","none",1,"questionIconWarningLoadingCircle",2,"position","absolute",3,"ngStyle"],[3,"ngStyle"],[1,"term",3,"ngClass","ngStyle","mouseover","mouseleave"],["spanElement",""],[1,"term-main",3,"ngClass","ngStyle"],["class","token",3,"ngClass",4,"ngFor","ngForOf"],["style","position: absolute;",3,"ngStyle",4,"ngIf"],[1,"token",3,"ngClass"],[4,"ngFor","ngForOf"],["cdkDropList","","class","dropZone","contenteditable","false",3,"ngClass","cdkDropListData","cdkDropListEnterPredicate","cdkDropListEntered","cdkDropListDropped",4,"ngIf"],["cdkDropList","","contenteditable","false",1,"dropZone",3,"ngClass","cdkDropListData","cdkDropListEnterPredicate","cdkDropListEntered","cdkDropListDropped"],["cdkDrag","","class","beginGripper","cdkDragBoundary",".utteranceContent","tabindex","0",3,"cdkDragData","keyup","cdkDragStarted",4,"ngIf"],["cdkDrag","","class","endGripper","cdkDragBoundary",".utteranceContent","tabindex","0",3,"cdkDragData","keyup","cdkDragStarted",4,"ngIf"],["cdkDrag","","cdkDragBoundary",".utteranceContent","tabindex","0",1,"beginGripper",3,"cdkDragData","keyup","cdkDragStarted"],["beginGripper",""],["preserveAspectRatio","none",1,"line"],["preserveAspectRatio","none",1,"circle"],["cdkDrag","","cdkDragBoundary",".utteranceContent","tabindex","0",1,"endGripper",3,"cdkDragData","keyup","cdkDragStarted"],["endGripper",""],[1,"line"],[2,"position","absolute",3,"ngStyle"],["x2","100%","stroke-linecap","round"],[1,"actionButtonsInputBoxFullHeightContainer",3,"ngStyle","click"],["class","singleButtonContainer",4,"ngIf"],[1,"singleButtonContainer"],["role","button",1,"actionButton","deleteButton",3,"ngClass","pbi-tooltip","ngStyle","accessible-click"],["deleteButton",""],[1,"actionButtonsInputBoxOneLineHeightContainer",3,"ngStyle"],[1,"buttonIconContainer"],[1,"glyphicon","pbi-glyph-exit",3,"ngStyle"],["role","button","data-testId","qna-submit-button",1,"actionButton","commitButton",3,"ngClass","localizeAttr","pbi-tooltip","ngStyle","accessible-click"],["commitButton",""],[1,"glyphicon","pbi-glyph-rightarrow",3,"ngStyle"],[3,"params","presentation","selectPrevious","selectNext","confirmSelection","utteranceSelected","fullyExpanded"],["autoComplete",""],[1,"qnaAutoCorrection",3,"ngStyle"],[1,"correctedUtteranceLabel"],["tabindex","0",1,"correctedUtteranceContentContainer",3,"accessible-click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(t,r){1&t&&(n.\u0275\u0275template(0,lo,7,14,"ng-container",0),n.\u0275\u0275pipe(1,"async")),2&t&&n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(1,1,r.fullPresentation$))},dependencies:[D.NgClass,D.NgForOf,D.NgIf,D.NgStyle,q.Wj,q.Fd,q.Zt,ze.b,Rt.i,Lt.t,ce,D.AsyncPipe],styles:["@keyframes _ngcontent-%COMP%_pulse{0%{opacity:.2}50%{opacity:1}to{opacity:.2}}html[data-focus-source=key][_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]:focus{outline:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]{display:flex}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]{margin-right:8px;padding:6px 0;background-color:transparent;position:relative;height:fit-content}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-40%)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .questionIcon[_ngcontent-%COMP%]{cursor:pointer;color:var(--colorNeutralForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .questionIcon[_ngcontent-%COMP%]   .questionIconWarningLoadingCircle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:var(--colorBrandBackground)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .questionIcon.notClickable[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .beforeUtteranceOneLineHeightContainer[_ngcontent-%COMP%]   .loadingIcon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1s linear .5s infinite}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]{flex:1;display:flex;display:-ms-flexbox;flex-flow:column;align-items:flex-start;position:relative;cursor:text;margin:0;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border-color:var(--colorNeutralStrokeAccessible);--inputContainerBackgroundColor: inherit;--inputContainerColor: inherit}[data-legacy-theming=false][_ngcontent-%COMP%]   .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]{--inputContainerBackgroundColor: var(--colorNeutralForegroundInverted);--inputContainerColor: var(--colorNeutralForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer[_ngcontent-%COMP%]{width:100%;overflow-y:hidden}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer.withFixedHeight[_ngcontent-%COMP%]{overflow-y:auto}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer[_ngcontent-%COMP%]   .inputWithoutAutoCompleteContainer[_ngcontent-%COMP%]{width:100%;overflow-y:visible;display:flex;display:-ms-flexbox;flex-direction:column}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer.allowContentHorizontalScroll[_ngcontent-%COMP%]{overflow-x:auto}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .inputAndAutoCompleteContainer.allowContentHorizontalScroll[_ngcontent-%COMP%]   .inputWithoutAutoCompleteContainer[_ngcontent-%COMP%]{min-width:100%;width:fit-content}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.withBorder[_ngcontent-%COMP%]{border:1px solid;border-radius:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.withShadow[_ngcontent-%COMP%]{box-shadow:var(--fluent-shadow-depth4, 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey))}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]{flex:1;-ms-flex:1 1 auto;position:relative;display:inline-flex;display:-ms-inline-flexbox;background-color:var(--inputContainerBackgroundColor)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]{flex:1;-ms-flex:1 1 0px;margin-left:10px;display:block;padding:6px;outline:none;box-sizing:border-box;white-space:pre-wrap;pointer-events:auto;-ms-user-select:text;user-select:text;-webkit-user-select:text;color:var(--inputContainerColor)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-selection, .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::selection{background:var(--fluent-theme-neutral-lighter-secondary-color, #E5E5E5)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]:empty:before{content:attr(placeholder);color:var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .dropZone[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent.isGripperOnDragging[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]{cursor:grabbing!important}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]{display:inline}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{position:static;display:inline;cursor:text;margin:0;min-height:6px;color:var(--inputContainerColor)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main.hasMultipleTokens[_ngcontent-%COMP%]{white-space:nowrap}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main.unused[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]{position:relative;display:inline}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.space[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.filler[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.isBetweenDroppedGrippers[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token.isBetweenOnDraggingGrippers[_ngcontent-%COMP%]{background-color:rgba(254,217,204,.5)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]{pointer-events:auto;cursor:grab;width:6px;height:100%;box-sizing:border-box;background:transparent}  html[data-focus-source=key] .resetButtonAndInputV2Container .qnaInputV2Container .utteranceContentExtraContainer .utteranceContent .term .term-main .token .beginGripper:focus,   html[data-focus-source=key] .resetButtonAndInputV2Container .qnaInputV2Container .utteranceContentExtraContainer .utteranceContent .term .term-main .token .endGripper:focus{outline-offset:2px;outline-style:dashed}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]{width:2px;height:calc(100% - 12px)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%]{width:100%;height:100%}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]{width:8px;height:8px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{cx:4px;cy:4px;r:3px;stroke-width:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone[_ngcontent-%COMP%]{pointer-events:auto;cursor:default;background-color:transparent;position:absolute}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone.noGripperOnDragging[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone.endGripperOnDragging[_ngcontent-%COMP%]:not(.serveEndGripper):not(.hasBeginGripper), .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone.beginGripperOnDragging[_ngcontent-%COMP%]:not(.serveBeginGripper):not(.hasEndGripper){visibility:hidden;width:0;height:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]{position:absolute;width:calc(50% + 2px);left:-2px;height:calc(100% + 14px);top:unset;bottom:-2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]{position:absolute;left:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]{position:absolute;left:0;bottom:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedBeforeToken[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]{position:absolute;left:-3px;top:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]{position:absolute;right:-2px;height:calc(100% + 16px);width:calc(50% + 2px);top:-2px;bottom:unset}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]{position:absolute;right:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.line[_ngcontent-%COMP%]{position:absolute;right:0;top:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZoneLocatedAfterToken[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%]   svg.circle[_ngcontent-%COMP%]{position:absolute;right:-3px;bottom:2px}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.unused[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertiary-color, #A19F9D)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showAcceptedUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{cursor:pointer;padding-bottom:1px;border-bottom-color:var(--colorSuccessForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showAcceptedUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--colorSuccessForeground1) 15%,transparent)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]{position:relative}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{cursor:pointer;border-bottom-color:var(--colorSuccessForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--colorSuccessForeground1) 15%,transparent)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showWarningUnderline[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;width:100%}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showErrorUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]{cursor:pointer;padding-bottom:1px;border-bottom-color:var(--colorDangerForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .term.showErrorUnderline[_ngcontent-%COMP%]   .term-main[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--colorDangerForeground1) 15%,transparent)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]{display:flex;display:-ms-flexbox;position:relative;margin-left:2px;padding:1px 0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]{flex:1;-ms-flex:1 1 auto;position:relative}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton[_ngcontent-%COMP%]{width:100%;position:absolute;top:0;padding:0;margin:0;border:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]{left:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]{right:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]:not(.usingShellTheme).disabled, .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]:not(.usingShellTheme).disabled{opacity:.5;cursor:default}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]:not(.usingShellTheme):hover:not(.disabled), .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]:not(.usingShellTheme):hover:not(.disabled){filter:brightness(90%)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton[_ngcontent-%COMP%]:not(.usingShellTheme):active:not(.disabled), .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton[_ngcontent-%COMP%]:not(.usingShellTheme):active:not(.disabled){filter:brightness(80%)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme.disabled[_ngcontent-%COMP%]{color:var(--colorNeutralForegroundDisabled);cursor:default}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--colorNeutralBackground1Hover)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.deleteButton.usingShellTheme[_ngcontent-%COMP%]:active:not(.disabled){background-color:var(--colorNeutralBackground1Pressed)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme[_ngcontent-%COMP%]{background-color:var(--colorBrandBackground);color:var(--colorNeutralForegroundOnBrand)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme.disabled[_ngcontent-%COMP%]{background-color:var(--colorNeutralBackgroundDisabled);color:var(--colorNeutralForegroundDisabled);cursor:default}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--colorBrandBackgroundHover)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton.commitButton.usingShellTheme[_ngcontent-%COMP%]:active:not(.disabled){background-color:var(--colorBrandBackgroundPressed)}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton[_ngcontent-%COMP%]   .actionButtonsInputBoxOneLineHeightContainer[_ngcontent-%COMP%]{padding:5px 0;width:100%}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .actionButtonsInputBoxFullHeightContainer[_ngcontent-%COMP%]   .singleButtonContainer[_ngcontent-%COMP%]   .actionButton[_ngcontent-%COMP%]   .actionButtonsInputBoxOneLineHeightContainer[_ngcontent-%COMP%]   .buttonIconContainer[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;height:100%;display:flex;display:-ms-flexbox;align-items:center;justify-content:center}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{pointer-events:none}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token.space[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token.filler[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .beginGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .endGripper[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled[_ngcontent-%COMP%]   .utteranceContentExtraContainer[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]   .token[_ngcontent-%COMP%]   .dropZone[_ngcontent-%COMP%]{pointer-events:none!important}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled.showDisabled[_ngcontent-%COMP%]   .questionIcon[_ngcontent-%COMP%], .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container.authoringDisabled.showDisabled[_ngcontent-%COMP%]   .utteranceContent[_ngcontent-%COMP%]{opacity:.6}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]     ul.qnaAutoComplete, .resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]     .qnaAutoComplete ul{text-decoration:none;list-style:none;margin-top:4px!important;z-index:101;white-space:pre;max-height:400px;overflow-y:auto;padding:0}.resetButtonAndInputV2Container[_ngcontent-%COMP%]   .qnaInputV2Container[_ngcontent-%COMP%]     .withTopSeparator ul.qnaAutoComplete{border-top:solid 1px var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}.qnaAutoCorrection[_ngcontent-%COMP%]{margin-top:8px;display:flex;display:-ms-flexbox}.qnaAutoCorrection[_ngcontent-%COMP%]   .correctedUtteranceContentContainer[_ngcontent-%COMP%]{margin-left:4px;cursor:pointer;font-style:italic;text-decoration:underline}.qnaAutoCorrection[_ngcontent-%COMP%]   .correctedUtteranceContentContainer[_ngcontent-%COMP%]   .corrected[_ngcontent-%COMP%]{font-weight:600}"]}),i}();function ho(i,e){if(i){var t=_.map(i,function(r){if(!_.isEmpty(r.text))return{text:r.isWhiteSpace?r.text:r.text.replace(" ",Xn),startIndex:r.startIndex,endExcludingIndex:r.endExcludingIndex,tokens:fo(r),isCorrected:r.isCorrected,isUnused:!r.isUsed&&e.considerDroppedSpans,isWhiteSpace:r.isWhiteSpace,shouldShowAcceptedUnderline:"accepted"===r.state,shouldShowErrorUnderline:"error"===r.state&&e.considerErrorSpans,shouldShowWarningUnderline:"warning"===r.state&&e.considerWarningSpans}}).filter(function(r){return!!r});return e.supportTokenGrippers&&function(i){var e,t;_.forEach(i,function(r,o){_.forEach(r.tokens,function(a,s){var u=i[o].tokens[s];if(!_.isEmpty(u.text)&&!u.isWhiteSpace){var c={position:a.startIndex,beginGripperOf:{spanIndex:o,tokenIndex:s},hasBeginGripper:!1,hasEndGripper:!1,previousBeginGripperZoneInfo:e,previousEndGripperZoneInfo:t},l={position:a.endExcludingIndex,endGripperOf:{spanIndex:o,tokenIndex:s},hasBeginGripper:!1,hasEndGripper:!1,previousBeginGripperZoneInfo:e,previousEndGripperZoneInfo:t};e&&(e.nextBeginGripperZoneInfo=c,e.nextEndGripperZoneInfo=l),t&&(t.nextBeginGripperZoneInfo=c,t.nextEndGripperZoneInfo=l),e=c,t=l,a.dropZonesInfo={zoneLocatedBeforeInfo:c,zoneLocatedAfterInfo:l}}})})}(t),t}}function fo(i){for(var e=[],t=0,r=function(d){var f=d.startIndex-i.startIndex,v=d.endExcludingIndex-d.startIndex;if(g.fF.assert(function(){return _.inRange(f,0,_.size(i.text))},"Expect each token.startIndex is a valid index with the given spanText and spanStartIndex"),g.fF.assert(function(){return!_.isEmpty(_.trim(i.text.substr(f,v)))},"Expect no Token being pure space"),t<f){var F=Fi(i.startIndex,i.text,t,f,i.isWhiteSpace);e.push.apply(e,F||[])}e.push({text:d.text.replace(" ",Xn),startIndex:d.startIndex,endExcludingIndex:d.endExcludingIndex,isFillerText:!1,isWhiteSpace:!1}),t=f+v},o=0,a=i.tokens||[];o<a.length;o++)r(a[o]);var u=_.size(i.text);if(t<u){var c=Fi(i.startIndex,i.text,t,u,i.isWhiteSpace);e.push.apply(e,c||[])}return e}function Fi(i,e,t,r,o){g.fF.assert(function(){return _.inRange(t,0,_.size(e))},"Expect the given startIndexInSpan is a valid index in the given spanText"),g.fF.assert(function(){return _.inRange(r,0,_.size(e)+1)},"Expect the given notIncludingEndIndexInSpan is a valid index in the given spanText or equals to spanText.length+1");for(var a=[],s=/\s/.test(e.charAt(t)),u=t,c=t+1;c<=r;c++){var l=/\s/.test(e.charAt(c));if(c===r||s!==l){var d=c-u,f=s&&!o?_.repeat(Xn,d):e.substr(u,d);a.push({text:f,startIndex:i+u,endExcludingIndex:i+u+d,isFillerText:!0,isWhiteSpace:s}),s=l,u=c}}return a}function mo(i,e){if(i){if(1===i)return e.get("Qna_DidYouMean_LabelText");if(2===i)return e.get("Qna_ShowingResultsFor_LabelText")}}function lt(i){i.preventDefault&&i.preventDefault()}function Je(i){i.stopPropagation&&i.stopPropagation()}function bi(i,e){return null==i?null==e:null==e?null==i:Xe(i)===Xe(e)}function Ii(i,e,t){var r,o,a,s;if(!e)return!1;if("beginGripper"===i&&e.beginGripperOf){var u=_.cloneDeep(t.value.end);if(e.beginGripperOf.spanIndex<u.spanIndex||e.beginGripperOf.spanIndex===u.spanIndex&&e.beginGripperOf.tokenIndex<=u.tokenIndex){var c=e.beginGripperOf;return g.fF.assertValue(null===(r=t.value)||void 0===r?void 0:r.associatedUISpans,"grippersPairLocation$.value.associatedUISpans should be defined"),t.next({associatedUISpans:null===(o=t.value)||void 0===o?void 0:o.associatedUISpans,begin:c,end:u}),!0}}else if("endGripper"===i&&e.endGripperOf){var l=_.cloneDeep(t.value.begin);if(e.endGripperOf.spanIndex>l.spanIndex||e.endGripperOf.spanIndex===l.spanIndex&&e.endGripperOf.tokenIndex>=l.tokenIndex){var d=e.endGripperOf;return g.fF.assertValue(null===(a=t.value)||void 0===a?void 0:a.associatedUISpans,"grippersPairLocation$.value.associatedUISpans should be defined"),t.next({associatedUISpans:null===(s=t.value)||void 0===s?void 0:s.associatedUISpans,begin:l,end:d}),!0}}return!1}function Ln(i,e,t,r){if(!r?.begin||!r?.end||!i.dropZonesInfo)return!1;var o=e?i.dropZonesInfo.zoneLocatedBeforeInfo:i.dropZonesInfo.zoneLocatedAfterInfo;g.fF.assert(function(){return"none"!==t},"The given gripper should not be GripperIdentifier.None");var a="beginGripper"===t?r.begin:r.end,s="beginGripper"===t?o.beginGripperOf:o.endGripperOf;return a.spanIndex===(s&&s.spanIndex)&&a.tokenIndex===(s&&s.tokenIndex)}function xi(i,e,t){if(!t?.begin||!t?.end)return!1;var r=t.begin,a=t.end;return(i!==r.spanIndex?i>r.spanIndex:e>=r.tokenIndex)&&(i!==a.spanIndex?i<a.spanIndex:e<=a.tokenIndex)}function Yn(i){var e;return _.some(null===(e=i?.target)||void 0===e?void 0:e.classList,function(t){return"beginGripper"===t||"endGripper"===t})}function Mi(i,e,t){var r=mt.Tm(i,e);return _.map(r,function(a){return t.get(a)}).join("\n\n")}function Jt(i,e){return e?0===i?e.normalizedAnchor:e.normalizedFocus:-1}var wi=p(71148),Zt=p(46135),Bi=p(98136),Oi=p(77200),Co=p(55232),Ti=p(28894),Do=p(73425),Vi=p(98885),yo=p(46101),Eo=p(36858),_o=p(21548),ht=function(e){return{color:e}},ei=function(){return{"aria-label":"Qna_FeedbackDialog_ThumbsUp"}},ti=function(){return{"aria-label":"Qna_FeedbackDialog_ThumbsDown"}};function So(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3),n.\u0275\u0275element(1,"span",4),n.\u0275\u0275elementStart(2,"button",5),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.feedbackIconClick(!0))}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(3,"button",6),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.feedbackIconClick(!1))}),n.\u0275\u0275elementEnd()()}if(2&i){var r=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(5,ht,r.fontColor)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(7,ht,r.fontColor))("localizeAttr",n.\u0275\u0275pureFunction0(9,ei)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(10,ht,r.fontColor))("localizeAttr",n.\u0275\u0275pureFunction0(12,ti))}}function Po(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3)(1,"a",7),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.launchFeedbackDialog(!0))}),n.\u0275\u0275element(2,"span",8),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"button",9),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(3,ht,r.fontColor)),n.\u0275\u0275advance(2),n.\u0275\u0275property("localizeAttr",n.\u0275\u0275pureFunction0(5,ei))("ngStyle",n.\u0275\u0275pureFunction1(6,ht,r.fontColor))}}function Ao(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3)(1,"a",10),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.launchFeedbackDialog(!1))}),n.\u0275\u0275element(2,"span",11),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"button",12),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext();n.\u0275\u0275advance(2),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(3,ht,r.fontColor)),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(5,ht,r.fontColor))("localizeAttr",n.\u0275\u0275pureFunction0(7,ti))}}function Fo(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",3),n.\u0275\u0275element(1,"span",13)(2,"button",9),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(3,ht,t.fontColor)),n.\u0275\u0275advance(1),n.\u0275\u0275property("localizeAttr",n.\u0275\u0275pureFunction0(5,ei))("ngStyle",n.\u0275\u0275pureFunction1(6,ht,t.fontColor))}}function bo(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",3),n.\u0275\u0275element(1,"span",13)(2,"button",14),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(3,ht,t.fontColor)),n.\u0275\u0275advance(1),n.\u0275\u0275property("localizeAttr",n.\u0275\u0275pureFunction0(5,ti))("ngStyle",n.\u0275\u0275pureFunction1(6,ht,t.fontColor))}}var ni=function(){function i(e,t,r,o){this.core=e,this.localizationService=t,this.qnaFeedbackStateService=r,this.screenReaderService=o}return i.prototype.ngOnInit=function(){this.utterance=this.core.getCurrentUtteranceTrimmed()},i.prototype.feedbackIconClick=function(e){var t={sentiment:e?1:-1,reason:void 0,comment:void 0};this.updateState(e?"PositiveChecked":"NegativeChecked"),this.sendFeedbackInterpretRequest(t)},i.prototype.getState=function(){return this.qnaFeedbackStateService.getState(this.utterance)},i.prototype.announceDescription=function(){var e=this.getState(),t=this.localizationService.get("Qna_FeedbackState_"+e);g.fF.assertValue(t,"no strings for current feedback state"),this.screenReaderService.alert(t)},i.prototype.launchFeedbackDialog=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(t){return this.core.launchFeedbackDialog(e?1:-1,!0),[2]})})},i.prototype.sendFeedbackInterpretRequest=function(e){return g.fF.assertValue(e,"invalid feedback"),this.core.sendFeedback(e)},i.prototype.updateState=function(e){this.qnaFeedbackStateService.updateState(this.utterance,e)},i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275directiveInject(x.D),n.\u0275\u0275directiveInject(Ut.o),n.\u0275\u0275directiveInject(_o.B),n.\u0275\u0275directiveInject(At.g))},i.\u0275cmp=n.\u0275\u0275defineComponent({type:i,selectors:[["qna-feedback"]],inputs:{fontColor:"fontColor"},features:[n.\u0275\u0275ProvidersFeature([G.Q,Bi.Z])],decls:7,vars:6,consts:[["focus-nav-mode","Hierarchy",1,"qnnFeedback",3,"focusin"],[3,"ngSwitch"],["class","textAndIcons",4,"ngSwitchCase"],[1,"textAndIcons"],["localize","Qna_FeedbackState_Unchosen",1,"descriptionText",3,"ngStyle"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-like",3,"ngStyle","localizeAttr","accessible-click"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-dislike",3,"ngStyle","localizeAttr","accessible-click"],["href","javascript:void(0);",1,"descriptionText",3,"ngStyle","accessible-click"],["localize","Qna_FeedbackState_PositiveChecked"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-likesolid",3,"localizeAttr","ngStyle"],["href","javascript:void(0);",1,"descriptionText",3,"accessible-click"],["localize","Qna_FeedbackState_NegativeChecked",3,"ngStyle"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-dislikesolid",3,"ngStyle","localizeAttr"],["localize","Qna_FeedbackState_FeedbackDetailSubmitted",1,"descriptionText",3,"ngStyle"],[1,"feedbackIcon","glyphicon","glyph-small","pbi-glyph-dislikesolid",3,"localizeAttr","ngStyle"]],template:function(t,r){1&t&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275listener("focusin",function(){return r.announceDescription()}),n.\u0275\u0275elementStart(1,"div",1),n.\u0275\u0275template(2,So,4,13,"div",2),n.\u0275\u0275template(3,Po,4,8,"div",2),n.\u0275\u0275template(4,Ao,4,8,"div",2),n.\u0275\u0275template(5,Fo,3,8,"div",2),n.\u0275\u0275template(6,bo,3,8,"div",2),n.\u0275\u0275elementEnd()()),2&t&&(n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitch",r.getState()),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","Unchosen"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","PositiveChecked"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","NegativeChecked"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","PositiveDetailSubmitted"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","NegativeDetailSubmitted"))},dependencies:[D.NgStyle,D.NgSwitch,D.NgSwitchCase,Gt.X,ze.b,Lt.t],styles:['.qnnFeedback[_ngcontent-%COMP%]{height:100%}.qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]{display:flex;flex-direction:row}html:not([dir="rtl"])[_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%]{margin-right:10px}html[dir="rtl"][_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .descriptionText[_ngcontent-%COMP%]{margin-left:10px}.qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%]{background-color:transparent}html:not([dir="rtl"])[_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%]{margin-left:2px;margin-right:2px}html[dir="rtl"][_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon[_ngcontent-%COMP%]{margin-left:2px;margin-right:2px}.qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon.pbi-glyph-likesolid[_ngcontent-%COMP%], .qnnFeedback[_ngcontent-%COMP%]   .textAndIcons[_ngcontent-%COMP%]   .feedbackIcon.pbi-glyph-dislikesolid[_ngcontent-%COMP%]{cursor:default}']}),i}(),Rn=p(59694),Io=p(73221),xo=p(45769);function Mo(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"tri-message-bar",2),n.\u0275\u0275listener("hideMessageBar",function(){var s=n.\u0275\u0275restoreView(t).$implicit,u=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(u.onDismissBanner(s.id))}),n.\u0275\u0275elementEnd()}2&i&&n.\u0275\u0275property("viewModel",e.$implicit)}function wo(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Mo,1,1,"tri-message-bar",1),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext().ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngForOf",t)}}function Bo(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,wo,2,1,"ng-container",0),n.\u0275\u0275elementContainerEnd()),2&i){var t=e.ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.length>0)}}var ii=function(i){function e(){var t=i.call(this)||this;return t.onDismiss=new n.EventEmitter,t}return(0,C.ZT)(e,i),e.prototype.ngOnInit=function(){var t=this;this.messageBarModels$=this.changes$("bannerContent").pipe((0,he.U)(function(r){return _.chain(r.banners).filter(function(a){return a.isVisible}).map(function(a){var s,u;return{id:a.id,bannerType:t.mapToMessageBarType(a.bannerType),message:t.mapToMessageBarText(a.message),barButtons:_.chain(a.actions).map(function(c){return t.mapToMessageBarAction(c,a.data)}).filter(function(c){return!!c}).value(),allowDismiss:a.allowDismiss,isRoundedCorners:!0,isMultiline:!0,link:null===(s=a.link)||void 0===s?void 0:s.href,linkDisplayName:null===(u=a.link)||void 0===u?void 0:u.text}}).value()}))},e.prototype.onDismissBanner=function(t){g.fF.assertValue(t,"bannerId"),this.onDismiss.emit(t)},e.prototype.mapToMessageBarType=function(t){switch(t){case"copilot":return 6;case"error":return 1;case"info":return 0;case"warning":return 2;default:g.fF.assertFail("unknown bannerType ".concat(t))}},e.prototype.mapToMessageBarText=function(t){return g.fF.assert(function(){return!(0,Rn.g)(t.text)},"banner message should be defined and non empty"),t.emphasis?"<b>".concat(t.emphasis,"</b> ").concat(t.text):t.text},e.prototype.mapToMessageBarAction=function(t,r){var o=this,a=(0,Rn.g)(t.text);if(g.fF.assert(function(){return!a},"banner action text should be defined and non empty"),!a)return{buttonText:t.text,buttonAction:function(){return function(c){if("noop"!==c){var l=o.bannerContent.actionHandlers.get(c);g.fF.assertValue(l,"handler with actionId ".concat(c)),null!=r?l(r):l()}}(t.id)},buttonAppearance:"primary"===t.actionAppearance?"primary":void 0,isLoading:"loading"===t.actionAppearance,isDisabled:"loading"===t.actionAppearance}},e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=n.\u0275\u0275defineComponent({type:e,selectors:[["qna-banner"]],inputs:{bannerContent:"bannerContent"},outputs:{onDismiss:"onDismiss"},features:[n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[[4,"ngIf"],["style","margin-bottom: 4px;",3,"viewModel","hideMessageBar",4,"ngFor","ngForOf"],[2,"margin-bottom","4px",3,"viewModel","hideMessageBar"]],template:function(r,o){1&r&&(n.\u0275\u0275template(0,Bo,2,1,"ng-container",0),n.\u0275\u0275pipe(1,"async")),2&r&&n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(1,1,o.messageBarModels$))},dependencies:[D.NgForOf,D.NgIf,xo.h,D.AsyncPipe],styles:["[_nghost-%COMP%]     tri-message-bar .message-banner{border-top-color:transparent;border-right-color:transparent;border-left-color:transparent}"]}),e}(Io.w),Oo=p(85102),To=["bannerMainMessageTextContainer"],Vo=["contentContainer"];function Uo(i,e){1&i&&(n.\u0275\u0275elementStart(0,"div",8)(1,"div",9),n.\u0275\u0275element(2,"spinner",10)(3,"span",11),n.\u0275\u0275elementEnd()()),2&i&&(n.\u0275\u0275advance(2),n.\u0275\u0275property("delay",0))}function Lo(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div")(1,"canvas-visual-error-overlay",12),n.\u0275\u0275listener("showErrorDetails",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.showQnaVisualErrorDetails())}),n.\u0275\u0275elementEnd()()}if(2&i){var r=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("errorInfo",r.viewModel.error)("viewport",r.viewModel.viewport)}}function Ro(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"qna-banner",20),n.\u0275\u0275listener("onDismiss",function(a){n.\u0275\u0275restoreView(t);var s=n.\u0275\u0275nextContext(4);return n.\u0275\u0275resetView(s.onBannerDismiss(a))}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}if(2&i){var r=n.\u0275\u0275nextContext().ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("bannerContent",r)}}function ko(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Ro,2,1,"ng-container",19),n.\u0275\u0275elementContainerEnd()),2&i){var t=e.ngIf;n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.showBanners)}}function Qo(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,ko,2,1,"ng-container",19),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(2,1,t.bannerContent$))}}var No=function(){return{"aria-label":"VisualContainer_QnaVisual_Promotion_HideAction"}};function zo(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",22),n.\u0275\u0275element(1,"i",23)(2,"span",24,25),n.\u0275\u0275elementStart(4,"button",26),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(a.performBannerMainAction())}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(5,"button",27),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(a.dismissBanner())}),n.\u0275\u0275pipe(6,"localize"),n.\u0275\u0275elementEnd()()}if(2&i){var r=n.\u0275\u0275nextContext(3);n.\u0275\u0275advance(2),n.\u0275\u0275property("pbiTooltip",r.bannerMainMessageTooltip)("localize","VisualContainer_QnaVisual_Promotion_MainMessage"),n.\u0275\u0275advance(2),n.\u0275\u0275property("localize","VisualContainer_QnaVisual_Promotion_ActionText"),n.\u0275\u0275advance(1),n.\u0275\u0275property("pbiTooltip",n.\u0275\u0275pipeBind1(6,5,"VisualContainer_QnaVisual_Promotion_HideAction"))("localizeAttr",n.\u0275\u0275pureFunction0(7,No))}}function qo(i,e){if(1&i&&n.\u0275\u0275template(0,zo,7,8,"div",21),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngIf",t.showLegacyBanner)}}var jo=function(e){return{disabled:e}},Go=function(){return{"aria-label":"Qna_ConvertDescription"}},Ui=function(e,t){return{color:e,"font-size":t}};function Ho(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"i",28),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(a.convertVisualClicked())}),n.\u0275\u0275pipe(1,"localize"),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(6,jo,!r.viewModel.result||"Visual"!==r.viewModel.result.type&&"QueryError"!==r.viewModel.result.type))("pbiTooltip",n.\u0275\u0275pipeBind1(1,4,"Qna_ConvertDescription"))("localizeAttr",n.\u0275\u0275pureFunction0(8,Go))("ngStyle",n.\u0275\u0275pureFunction2(9,Ui,null==r.inputPresentation||null==r.inputPresentation.restatementFontProperties?null:r.inputPresentation.restatementFontProperties.color,(null==r.inputPresentation||null==r.inputPresentation.questionFontProperties?null:r.inputPresentation.questionFontProperties.size.px)+"px"))}}var Wo=function(){return{"aria-label":"Qna_ToolingDescription"}};function $o(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"i",29),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(a.showTooling("VisualTooling"))}),n.\u0275\u0275pipe(1,"localize"),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("pbiTooltip",n.\u0275\u0275pipeBind1(1,3,"Qna_ToolingDescription"))("localizeAttr",n.\u0275\u0275pureFunction0(5,Wo))("ngStyle",n.\u0275\u0275pureFunction2(6,Ui,null==r.inputPresentation||null==r.inputPresentation.restatementFontProperties?null:r.inputPresentation.restatementFontProperties.color,(null==r.inputPresentation||null==r.inputPresentation.questionFontProperties?null:r.inputPresentation.questionFontProperties.size.px)+"px"))}}var Ko=function(e){return{hasBanner:e}};function Jo(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Qo,3,3,"ng-container",13),n.\u0275\u0275pipe(2,"async"),n.\u0275\u0275template(3,qo,1,1,"ng-template",null,14,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementStart(5,"div",15)(6,"qna-input-v2",16),n.\u0275\u0275listener("inputBoxFocused",function(s){n.\u0275\u0275restoreView(t);var u=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(u.onInputBoxFocused(s))}),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(7,Ho,2,12,"i",17),n.\u0275\u0275template(8,$o,2,9,"i",18),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}if(2&i){var r=n.\u0275\u0275reference(4),o=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(2,12,o.allowTooling&&o.isCopilotSynonymsEnabled$))("ngIfElse",r),n.\u0275\u0275advance(4),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(14,Ko,o.showLegacyBanner)),n.\u0275\u0275advance(1),n.\u0275\u0275property("entryPoint",o.viewModel.qnaInputConfiguration.entryPoint)("qnaSupportedScopes",o.viewModel.qnaInputConfiguration.qnaSupportedScopes)("interpretListener",o.viewModel.qnaInputConfiguration.interpretListener)("presentationArgs",o.inputPresentation)("configs",o.viewModel.qnaInputConfiguration.configs)("initialUtterance",o.viewModel.qnaInputConfiguration.initialUtterance)("initialUtteranceFromSaved",o.viewModel.qnaInputConfiguration.initialUtteranceFromSaved),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",o.config.canEdit),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",o.allowTooling)}}var Zo=function(e){return{color:e}};function Xo(i,e){if(1&i&&n.\u0275\u0275element(0,"i",30),2&i){var t=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction1(3,Zo,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color))("pbiTooltip",t.displayedRestatement),n.\u0275\u0275attribute("aria-label",t.displayedRestatement.tooltipDescription)}}var Yo=function(e,t,r,o,a,s,u){return{"background-color":e,color:t,"font-size":r,"font-family":o,"font-weight":a,"font-style":s,"text-decoration":u}};function ea(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",45),n.\u0275\u0275listener("accessible-click",function(){var u=n.\u0275\u0275restoreView(t).$implicit,c=n.\u0275\u0275nextContext(4);return n.\u0275\u0275resetView(c.interpretSuggestedQuestion(u.content))}),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()}if(2&i){var r=e.$implicit,o=n.\u0275\u0275nextContext(4);n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction7(3,Yo,null==o.suggestionsPresentation?null:o.suggestionsPresentation.backgroundColor,null==o.suggestionsPresentation||null==o.suggestionsPresentation.cardFontProperties?null:o.suggestionsPresentation.cardFontProperties.color,(null==o.suggestionsPresentation||null==o.suggestionsPresentation.cardFontProperties||null==o.suggestionsPresentation.cardFontProperties.size?null:o.suggestionsPresentation.cardFontProperties.size.px)+"px",null==o.suggestionsPresentation||null==o.suggestionsPresentation.cardFontProperties?null:o.suggestionsPresentation.cardFontProperties.family,null==o.suggestionsPresentation||null==o.suggestionsPresentation.cardFontProperties?null:o.suggestionsPresentation.cardFontProperties.weight,null==o.suggestionsPresentation||null==o.suggestionsPresentation.cardFontProperties?null:o.suggestionsPresentation.cardFontProperties.style,null==o.suggestionsPresentation||null==o.suggestionsPresentation.cardFontProperties?null:o.suggestionsPresentation.cardFontProperties.textDecoration)),n.\u0275\u0275attribute("aria-label",r.accessibilityLabel),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",r.content," ")}}var ta=function(e,t,r,o,a,s){return{color:e,"font-size":t,"font-family":r,"font-weight":o,"font-style":a,"text-decoration":s}},na=function(e){return{"aria-label":e}};function ia(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",40),n.\u0275\u0275element(1,"div",41),n.\u0275\u0275elementStart(2,"div",42),n.\u0275\u0275template(3,ea,2,11,"div",43),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"div",44),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(a.toggleShowAllSuggestions())}),n.\u0275\u0275elementEnd()()}if(2&i){var r=n.\u0275\u0275nextContext(3);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction6(4,ta,null==r.suggestionsPresentation||null==r.suggestionsPresentation.headerFontProperties?null:r.suggestionsPresentation.headerFontProperties.color,(null==r.suggestionsPresentation||null==r.suggestionsPresentation.headerFontProperties||null==r.suggestionsPresentation.headerFontProperties.size?null:r.suggestionsPresentation.headerFontProperties.size.px)+"px",null==r.suggestionsPresentation||null==r.suggestionsPresentation.headerFontProperties?null:r.suggestionsPresentation.headerFontProperties.family,null==r.suggestionsPresentation||null==r.suggestionsPresentation.headerFontProperties?null:r.suggestionsPresentation.headerFontProperties.weight,null==r.suggestionsPresentation||null==r.suggestionsPresentation.headerFontProperties?null:r.suggestionsPresentation.headerFontProperties.style,null==r.suggestionsPresentation||null==r.suggestionsPresentation.headerFontProperties?null:r.suggestionsPresentation.headerFontProperties.textDecoration)),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngForOf",r.viewModel.result.suggestions),n.\u0275\u0275advance(1),n.\u0275\u0275propertyInterpolate("localize",r.viewModel.result.showAllSuggestions?"Visual_Qna_SuggestionsLess":"Visual_Qna_SuggestionsAll"),n.\u0275\u0275property("localizeAttr",n.\u0275\u0275pureFunction1(11,na,r.viewModel.result.showAllSuggestions?"Visual_Qna_SuggestionsLess":"Visual_Qna_SuggestionsAll"))}}var Li=function(e,t,r,o,a){return{color:e,"font-family":t,"font-weight":r,"font-style":o,"text-decoration":a}};function ra(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"span",46),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(3);n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction5(2,Li,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.family,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.weight,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.style,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.textDecoration)),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",t.viewModel.result.failedToLoadSuggestionsMessage," ")}}function oa(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",37),n.\u0275\u0275template(1,ia,5,13,"div",38),n.\u0275\u0275template(2,ra,2,8,"span",39),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.viewModel.result.suggestions.length>0&&t.suggestionsPresentation.show),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.viewModel.result.failedToLoadSuggestionsMessage&&t.suggestionsPresentation.show)}}function aa(i,e){1&i&&n.\u0275\u0275element(0,"spinner",52),2&i&&n.\u0275\u0275property("delay",0)}function sa(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",49),n.\u0275\u0275template(1,aa,1,1,"spinner",50),n.\u0275\u0275element(2,"single-visual-host",51),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(3);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.viewModel.result.isLoading),n.\u0275\u0275advance(1),n.\u0275\u0275property("visual",t.viewModel.result.visual)("visualViewport",t.viewModel.viewport)("themeCollection",t.viewModel.themeCollection)("config",t.core.singleVisualHostConfig)}}function ua(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",47),n.\u0275\u0275template(1,sa,3,5,"div",48),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.viewModel.result.visual&&t.core.singleVisualHostConfig)}}function la(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"a",57),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.launchFeedbackDialog(-1,!1))}),n.\u0275\u0275element(1,"span",58),n.\u0275\u0275elementEnd()}}function ca(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",53)(1,"div",54)(2,"div")(3,"span",55),n.\u0275\u0275text(4),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(5,la,2,0,"a",56),n.\u0275\u0275elementEnd()()()),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngStyle",n.\u0275\u0275pureFunction5(3,Li,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color,null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.family,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.weight,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.style,null==t.suggestionsPresentation||null==t.suggestionsPresentation.restatementFontProperties?null:t.suggestionsPresentation.restatementFontProperties.textDecoration)),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate(t.viewModel.result.message),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.allowFeedback&&t.core.shouldShowdoNotUnderstandMessageFeedbackLink())}}function da(i,e){1&i&&n.\u0275\u0275elementContainer(0)}function pa(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",59),n.\u0275\u0275template(1,da,1,0,"ng-container",60),n.\u0275\u0275elementEnd()),2&i){n.\u0275\u0275nextContext();var t=n.\u0275\u0275reference(7);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",t)}}function ga(i,e){1&i&&n.\u0275\u0275elementContainer(0)}function ha(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",59),n.\u0275\u0275template(1,ga,1,0,"ng-container",60),n.\u0275\u0275elementEnd()),2&i){n.\u0275\u0275nextContext();var t=n.\u0275\u0275reference(7);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngTemplateOutlet",t)}}function fa(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"a",57),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var o=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(o.launchFeedbackDialog(-1,!1))}),n.\u0275\u0275element(1,"span",58),n.\u0275\u0275elementEnd()}}function ma(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"canvas-visual-error-overlay",12),n.\u0275\u0275listener("showErrorDetails",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(a.showResultErrorDetails())}),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(1,fa,2,0,"a",56)}if(2&i){var r=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("errorInfo",r.viewModel.result)("viewport",r.viewModel.viewport),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",r.allowFeedback&&r.core.shouldShowdoNotUnderstandMessageFeedbackLink())}}function va(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0,31),n.\u0275\u0275template(1,oa,3,2,"div",32),n.\u0275\u0275template(2,ua,2,1,"div",33),n.\u0275\u0275template(3,ca,6,9,"div",34),n.\u0275\u0275template(4,pa,2,1,"div",35),n.\u0275\u0275template(5,ha,2,1,"div",35),n.\u0275\u0275template(6,ma,2,3,"ng-template",null,36,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngSwitch",t.viewModel.result.type),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","Suggestions"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","Visual"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","DoNotUnderstand"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","Error"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","QueryError")}}function Ca(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",64),n.\u0275\u0275element(1,"qna-feedback",65),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("fontColor",null==t.inputPresentation||null==t.inputPresentation.restatementFontProperties?null:t.inputPresentation.restatementFontProperties.color)}}function Da(i,e){1&i&&(n.\u0275\u0275elementStart(0,"div",66),n.\u0275\u0275element(1,"span",67)(2,"a",68),n.\u0275\u0275elementEnd())}function ya(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",61),n.\u0275\u0275template(1,Ca,2,1,"div",62),n.\u0275\u0275template(2,Da,3,0,"div",63),n.\u0275\u0275pipe(3,"async"),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.allowFeedback&&t.core.showFeedbackForCurrentQuestion()),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",n.\u0275\u0275pipeBind1(3,2,t.isCopilotSynonymsEnabled$)&&"Visual"===(null==t.viewModel.result?null:t.viewModel.result.type))}}var Ea=function(e,t){return{contentReady:e,suggestionContent:t}},ri=function(){function i(e,t,r,o,a,s,u,c,l,d){this.dataSources=e,this.explorationNavigation=t,this.featureSwitchService=r,this.lazyScoped=o,this.viewModeState=a,this.telemetryService=s,this.core=u,this.highContrastCssGenerationService=c,this.settingsService=l,this.qnaToolingDialogLauncher=d,this.inputBoxFocused=new n.EventEmitter,this.utteranceUpdated=new n.EventEmitter,this.convertVisual=new n.EventEmitter,this.destroy$=new tt.xQ,this.viewModel=this.core.viewModel,g.fF.assert(function(){return!(0,k.rO)()},"Expect qna.component never get created if it is in IE browser."),this.highContrastCssGenerationService.addRule('html[data-focus-source="key"] .themeableElement .qnaVisual *:focus',"{ outline: 2px solid @selectedBackgroundColor; }")}return Object.defineProperty(i.prototype,"inputComponent",{set:function(t){var r=this;this.qnaInputComponent=t,this.core.setGetQnaInputComponentFunc(function(){return r.qnaInputComponent})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_bannerMessageElementRef",{set:function(t){this.bannerMainMessageTextContainerElementRef=t,t&&this.updateBannerMainMessageTooltipConfig()},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t,r,o,s,u=this;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return e=0!==this.viewModeState.getMode(),this.initializedTelemetryEvent=this.telemetryService.logEvent(Ie,{isAuthoring:e,entryPoint:this.entryPoint}),g.fF.assertValue(this.config,"Expect this.config to be defined"),t=_.cloneDeep(this.config),t=_.merge({},t,{hostHandlesUndo:!0}),[4,this.core.initialize(this.models,t,this.hostServices,this.entryPoint,this.utteranceUpdated,this.convertVisual,this.initializedTelemetryEvent,this.contentContainerElement,void 0)];case 1:return c.sent(),this.isCopilotSynonymsEnabled$=this.featureSwitchService.featureSwitches$.pipe((0,he.U)(function(l){return l.qnaImproveLsdlCopilot})),r=this,[4,this.core.shouldShowThumbsUpDown()];case 2:return r.allowFeedback=c.sent(),o=this,[4,this.core.allowTooling()];case 3:return o.allowTooling=c.sent(),this.allowTooling?[4,this.lazyScoped.get("improveLsdlBackgroundService")]:[3,7];case 4:return[4,c.sent().tryImproveLsdl("qnaVisual")];case 5:return c.sent(),s=this,[4,this.lazyScoped.get("qnaBannerService")];case 6:s.qnaBannerService=c.sent(),this.bannerContent$=this.qnaBannerService.getBannerContent("Visual"),c.label=7;case 7:return this.showLegacyBanner=this.shouldShowBanner(),this.settingsService.settingChanged$.pipe((0,ie.R)(this.destroy$)).subscribe(function(l){"ShowQnaVisualBanner"===l&&(u.showLegacyBanner=u.shouldShowBanner())}),[2]}})})},i.prototype.ngAfterViewInit=function(){this.core.updateViewport()},i.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},i.prototype.onBannerDismiss=function(e){var t;null===(t=this.qnaBannerService)||void 0===t||t.dismissBanner("Visual",e)},i.prototype.update=function(e){(0,te.yE)(e.type,Zt.EP.Resize)&&this.updateBannerMainMessageTooltipConfig(),this.core.update(e)},i.prototype.enumerateObjectInstances=function(e){return this.core.enumerateObjectInstances(e)},i.prototype.getFormattingModel=function(){return this.core.getFormattingModel()},i.prototype.focus=function(){if(this.qnaInputComponent)return this.qnaInputComponent.focus(),!0},i.prototype.onInputBoxFocused=function(e){this.inputBoxFocused.emit(e)},i.prototype.getCurrentVisual=function(){return this.core.getCurrentVisual()},i.prototype.convertVisualClicked=function(){this.core.convertVisualClicked()},i.prototype.dismissBanner=function(){this.settingsService.setShowQnaVisualBanner(!1),this.showLegacyBanner=!1},i.prototype.performBannerMainAction=function(){return(0,C.mG)(this,void 0,void 0,function(){var e=this;return(0,C.Jh)(this,function(t){switch(t.label){case 0:return g.fF.assert(function(){return e.showLegacyBanner},"This should only be called when showBanner is true"),[4,this.showTooling("VisualBanner","bulkEditing")];case 1:return t.sent(),[2]}})})},Object.defineProperty(i.prototype,"inputPresentation",{get:function(){if(this.viewModel)return this.viewModel.presentationViewModel.inputBox},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"suggestionsPresentation",{get:function(){if(this.viewModel)return this.viewModel.presentationViewModel.suggestions},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"displayedRestatement",{get:function(){if("Ready"!==this.viewModel.state)return null;var t=this.viewModel.result;return t?(0,b.mn)(t)||(0,b.fU)(t)||(0,b.lP)(t)?t.restatement:void 0:null},enumerable:!1,configurable:!0}),i.prototype.showTooling=function(e,t){return(0,C.mG)(this,void 0,void 0,function(){var r,o,a=this;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return g.fF.assert(function(){return a.allowTooling},"this should be called only when this.allowTooling is true"),this.allowTooling?(r=this.dataSources.get(),o=this.explorationNavigation.getCurrentExploration(),[4,this.qnaToolingDialogLauncher.showToolingDialog({dataSources:r,exploration:o,entryPoint:e,entryContentType:t,entryQuestion:this.core.getCurrentUtteranceTrimmed()})]):[2];case 1:return s.sent(),[2]}})})},i.prototype.interpretSuggestedQuestion=function(e){this.core.interpretSuggestedQuestion(e)},i.prototype.toggleShowAllSuggestions=function(){this.core.toggleShowAllSuggestions()},i.prototype.showQnaVisualErrorDetails=function(){this.core.showQnaVisualErrorDetails()},i.prototype.showResultErrorDetails=function(){this.core.showResultErrorDetails()},i.prototype.launchFeedbackDialog=function(e,t){this.core.launchFeedbackDialog(e,t)},i.prototype.shouldShowBanner=function(){var e=this;return g.fF.assert(function(){return null!=e.allowTooling},"this.allowTooling value should already been set to be true or false"),this.allowTooling&&this.settingsService.getShowQnaVisualBanner()},i.prototype.updateBannerMainMessageTooltipConfig=function(){if(this.bannerMainMessageTextContainerElementRef){var e=this.bannerMainMessageTextContainerElementRef.nativeElement,t=e&&e.offsetWidth<e.scrollWidth;!this.bannerMainMessage!=!t&&(this.bannerMainMessage=t?e.textContent:null)}},i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275directiveInject(Re.D),n.\u0275\u0275directiveInject(Ce.z),n.\u0275\u0275directiveInject(Ke.vZ),n.\u0275\u0275directiveInject(Ti.H),n.\u0275\u0275directiveInject(Oi.kc),n.\u0275\u0275directiveInject(ge.y0),n.\u0275\u0275directiveInject(x.D),n.\u0275\u0275directiveInject(Pt.g),n.\u0275\u0275directiveInject(Co.g),n.\u0275\u0275directiveInject(wi.b,8))},i.\u0275cmp=n.\u0275\u0275defineComponent({type:i,selectors:[["qna-host"]],viewQuery:function(t,r){if(1&t&&(n.\u0275\u0275viewQuery(Un,5),n.\u0275\u0275viewQuery(To,5,n.ElementRef),n.\u0275\u0275viewQuery(Vo,7,n.ElementRef)),2&t){var o=void 0;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.inputComponent=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r._bannerMessageElementRef=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.contentContainerElement=o.first)}},inputs:{models:"models",config:"config",hostServices:"hostServices",entryPoint:"entryPoint"},outputs:{inputBoxFocused:"inputBoxFocused",utteranceUpdated:"utteranceUpdated",convertVisual:"convertVisual"},features:[n.\u0275\u0275ProvidersFeature([de.y,G.Q,Bi.Z,x.D])],decls:9,vars:11,consts:[[1,"qnaVisual",3,"ngSwitch"],["class","loadingContainer",4,"ngSwitchCase"],[4,"ngSwitchCase"],["class","glyphicon icon glyph-small pbi-glyph-info restatementIcon","tabindex","0",3,"ngStyle","pbiTooltip",4,"ngIf"],[1,"content",3,"ngClass"],["contentContainer",""],[3,"ngSwitch",4,"ngIf"],["class","footer",4,"ngIf"],[1,"loadingContainer"],[1,"loading"],["size","large",3,"delay"],["localize","Qna_InitialLoading"],[3,"errorInfo","viewport","showErrorDetails"],[4,"ngIf","ngIfElse"],["legacyBanner",""],[1,"header",3,"ngClass"],["drag-resize-disabled","true","tabindex","-1",1,"inputBox",3,"entryPoint","qnaSupportedScopes","interpretListener","presentationArgs","configs","initialUtterance","initialUtteranceFromSaved","inputBoxFocused"],["class","glyphicon icon glyph-small pbi-glyph-dependencyadd qnaAction","role","button",3,"ngClass","pbiTooltip","localizeAttr","ngStyle","accessible-click",4,"ngIf"],["class","glyphicon icon glyph-small pbi-glyph-settings qnaAction","role","button",3,"pbiTooltip","localizeAttr","ngStyle","accessible-click",4,"ngIf"],[4,"ngIf"],[3,"bannerContent","onDismiss"],["class","banner",4,"ngIf"],[1,"banner"],[1,"glyphicon","glyph-small","pbi-glyph-info"],[1,"mainMessage",3,"pbiTooltip","localize"],["bannerMainMessageTextContainer",""],["mat-button","",1,"mainAction",3,"localize","accessible-click"],["mat-button","",1,"dismiss","glyphicon","pbi-glyph-close","glyph-mini",3,"pbiTooltip","localizeAttr","accessible-click"],["role","button",1,"glyphicon","icon","glyph-small","pbi-glyph-dependencyadd","qnaAction",3,"ngClass","pbiTooltip","localizeAttr","ngStyle","accessible-click"],["role","button",1,"glyphicon","icon","glyph-small","pbi-glyph-settings","qnaAction",3,"pbiTooltip","localizeAttr","ngStyle","accessible-click"],["tabindex","0",1,"glyphicon","icon","glyph-small","pbi-glyph-info","restatementIcon",3,"ngStyle","pbiTooltip"],[3,"ngSwitch"],["class","suggestionsContainer",4,"ngSwitchCase"],["class","visualResultContainer",4,"ngSwitchCase"],["class","doNotUnderstandContainer",4,"ngSwitchCase"],["class","resultErrorContainer",4,"ngSwitchCase"],["errorOverlayTemplate",""],[1,"suggestionsContainer"],["class","suggestions",4,"ngIf"],["class","suggestionsWarning",3,"ngStyle",4,"ngIf"],[1,"suggestions"],["localize","Visual_Qna_SuggestionsHeader",1,"suggestionTitle",3,"ngStyle"],["data-testid","qna-suggestions",1,"suggestionsList"],["class","suggestion themeableElement","tabindex","0","role","button","data-testid","qna-suggestion",3,"ngStyle","accessible-click",4,"ngFor","ngForOf"],["tabindex","0","role","button","data-testid","qna-show-all-suggestions-btn",1,"showAllToggle",3,"localize","localizeAttr","accessible-click"],["tabindex","0","role","button","data-testid","qna-suggestion",1,"suggestion","themeableElement",3,"ngStyle","accessible-click"],[1,"suggestionsWarning",3,"ngStyle"],[1,"visualResultContainer"],["class","singleVisualHostContainer",4,"ngIf"],[1,"singleVisualHostContainer"],["class","loadingSpinner","size","small",3,"delay",4,"ngIf"],["tabindex","0","focus-nav-mode","Hierarchy","data-testid","qna-visual",3,"visual","visualViewport","themeCollection","config"],["size","small",1,"loadingSpinner",3,"delay"],[1,"doNotUnderstandContainer"],[1,"showDoNotUnderstandMessage",3,"ngStyle"],[1,"message"],["class","tellUsMore","href","javascript:void(0);",3,"accessible-click",4,"ngIf"],["href","javascript:void(0);",1,"tellUsMore",3,"accessible-click"],["localize","Qna_Feedback_TellUsMore"],[1,"resultErrorContainer"],[4,"ngTemplateOutlet"],[1,"footer"],["class","feedback",4,"ngIf"],["class","disclaimer",4,"ngIf"],[1,"feedback"],[3,"fontColor"],[1,"disclaimer"],["localize","Copilot_Disclaimer_Short"],["href","https://go.microsoft.com/fwlink/?linkid=2243166","localize","CopilotInline_PreviewLink","target","_blank",1,"pbi-external-link","fluentTheme-sm-reg"]],template:function(t,r){1&t&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275template(1,Uo,4,1,"div",1),n.\u0275\u0275template(2,Lo,2,2,"div",2),n.\u0275\u0275template(3,Jo,9,16,"ng-container",2),n.\u0275\u0275template(4,Xo,1,5,"i",3),n.\u0275\u0275elementStart(5,"div",4,5),n.\u0275\u0275template(7,va,8,6,"ng-container",6),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(8,ya,4,4,"div",7),n.\u0275\u0275elementEnd()),2&t&&(n.\u0275\u0275property("ngSwitch",r.viewModel.state),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","Loading"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","Error"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngSwitchCase","Ready"),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",r.displayedRestatement),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(8,Ea,"Ready"===r.viewModel.state,r.viewModel.result&&"Suggestions"===r.viewModel.result.type)),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",r.viewModel.result),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf","Ready"===r.viewModel.state))},dependencies:[D.NgClass,D.NgForOf,D.NgIf,D.NgTemplateOutlet,D.NgStyle,D.NgSwitch,D.NgSwitchCase,Gt.X,ze.b,Do.O,Vi.f,yo.v,Lt.t,Eo.V,Un,ni,ii,D.AsyncPipe,Oo.F],styles:['.qnaVisual[_ngcontent-%COMP%]{font-size:12px;height:100%;display:flex;flex-direction:column}  html[data-focus-source=key] .qnaVisual:focus,   html[data-focus-source=key] .qnaVisual *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}  html[data-focus-source=mouse] .qnaVisual:focus,   html[data-focus-source=mouse] .qnaVisual *:focus,   html[data-focus-source=program] .qnaVisual:focus,   html[data-focus-source=program] .qnaVisual *:focus{outline:none}.qnaVisual[_ngcontent-%COMP%]     .powerbi-spinner{position:unset!important;margin-right:12px}.qnaVisual[_ngcontent-%COMP%]   .pbi-glyph-info[_ngcontent-%COMP%]:before{content:"\\e946"!important}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;justify-content:center}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.qnaVisual[_ngcontent-%COMP%]   .loadingContainer[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;text-align:center;margin:12px}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:var(--gray-20, #F3F2F1);padding:0 12px;margin:8px 4px 4px;color:var(--gray-160, #323130);align-items:center}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{margin:8px 0}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .mainMessage[_ngcontent-%COMP%]{margin:4px 8px;flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .mainAction[_ngcontent-%COMP%]{margin:0;padding:2px 20px;background:var(--white-color, #FFF);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);border:1px solid var(--gray-110, #8A8886);box-sizing:border-box;border-radius:2px;height:fit-content}.qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%]{padding:0}html:not([dir="rtl"])[_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%]{margin:0 0 0 12px}html[dir="rtl"][_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .qnaVisual[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .glyphicon.dismiss[_ngcontent-%COMP%]{margin:0 12px 0 0}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:row;min-height:44px;position:relative;margin-top:16px}.qnaVisual[_ngcontent-%COMP%]   .header.hasBanner[_ngcontent-%COMP%]{margin-top:0}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .inputBox[_ngcontent-%COMP%]{flex:1;margin:4px}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .qnaAction[_ngcontent-%COMP%]{margin:12px 4px 0;cursor:pointer;height:16px}.qnaVisual[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .qnaAction.disabled[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertiary-color, #A19F9D)!important;cursor:default}.qnaVisual[_ngcontent-%COMP%]   .restatementIcon[_ngcontent-%COMP%]{align-self:flex-end;cursor:default}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:4px;flex:0}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionTitle[_ngcontent-%COMP%]{margin:1px 1px 12px 4px}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionsList[_ngcontent-%COMP%]{padding:0 4px;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));grid-template-rows:repeat(auto-fit,minmax(32px,1fr))}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestionsList[_ngcontent-%COMP%]   .suggestion[_ngcontent-%COMP%]{font-size:14px;padding:12px 20px;border-radius:2px;box-shadow:var(--fluent-shadow-depth4, 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 2px 4px var(--colorNeutralShadowKey));border:1px solid transparent;box-sizing:border-box;cursor:pointer;margin:0 12px 12px 0}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .showAllToggle[_ngcontent-%COMP%]{font-size:14px;color:var(--fluent-theme-link-color, #0078D4);margin:12px 4px;cursor:pointer;align-self:flex-end}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]{position:relative;height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   spinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   single-visual-host[_ngcontent-%COMP%]{position:relative;display:block;height:100%;background-color:transparent}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .visualResultContainer[_ngcontent-%COMP%]   .singleVisualHostContainer[_ngcontent-%COMP%]   single-visual-host[_ngcontent-%COMP%]     .visual{height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-right:4px}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .doNotUnderstandContainer[_ngcontent-%COMP%]   .showDoNotUnderstandMessage[_ngcontent-%COMP%], .qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .suggestionsContainer[_ngcontent-%COMP%]   .suggestionsWarning[_ngcontent-%COMP%]{display:flex;text-align:center;align-items:center;font-size:14px;max-width:450px;padding:20px;width:100%;box-sizing:border-box}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]{height:100%;position:relative;background-color:var(--neutral-lighter-color, #F4F4F4);display:flex;flex-direction:column;justify-content:center}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]   canvas-visual-error-overlay[_ngcontent-%COMP%]{position:relative;height:auto}.qnaVisual[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .resultErrorContainer[_ngcontent-%COMP%]   .tellUsMore[_ngcontent-%COMP%]{text-align:center;font-size:14px}.qnaVisual[_ngcontent-%COMP%]   .content.contentReady[_ngcontent-%COMP%]{flex:1;overflow:hidden}.qnaVisual[_ngcontent-%COMP%]   .content.suggestionContent[_ngcontent-%COMP%]{overflow-y:auto}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]{flex:0;padding-top:2px}.qnaVisual[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .feedback[_ngcontent-%COMP%]   qna-feedback[_ngcontent-%COMP%]{float:right}']}),i}(),Ri=p(8898);new n.InjectionToken("DesktopHostInjectionToken"),new n.InjectionToken("PromiseStoreService");var ki=function(){function i(e){this.eventAggregationService=e,this.eventHandlers={}}return i.prototype.subscribe=function(e,t){var r;if(this.eventHandlers[e])throw new Error("Already subscribed to ".concat(e));null===(r=this.eventAggregationService)||void 0===r||r.subscribe(e,t),this.eventHandlers[e]=t},i.prototype.unsubscribeAll=function(){var e;for(var t in this.eventHandlers)null===(e=this.eventAggregationService)||void 0===e||e.unsubscribe(t,this.eventHandlers[t])},i}(),ba=p(14463),Pn=p(8590),Qi=p(3579),Ni=p(60661),Ia=p(91615),xa=p(73058),Ma=p(32640),wa=p(82755),zi=p(5265),Ba=p(99917),Oa=p(4541),Ta=p(69838),Va=p(64546),kn=p(74857),oi=p(91592),Ua=p(11494),qi=p(48145),La=p(94717),Ra=p(39631),ka=p(10861),Qa=p(18950),Na=p(29866),za=p(72262),qa=p(28107),ja=p(67660),Ga=p(35756),Ha=["qnaVisual"],Wa=function(){return{"aria-label":"Qna_MessageDialog_EnableQnaButtonText"}};function $a(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"button",11),n.\u0275\u0275listener("accessible-click",function(){n.\u0275\u0275restoreView(t);var o=n.\u0275\u0275nextContext(4);return n.\u0275\u0275resetView(o.enableQna())}),n.\u0275\u0275elementEnd()}2&i&&n.\u0275\u0275property("localizeAttr",n.\u0275\u0275pureFunction0(2,Wa))("localize","Qna_MessageDialog_EnableQnaButtonText")}function Ka(i,e){if(1&i&&(n.\u0275\u0275elementStart(0,"div",7),n.\u0275\u0275element(1,"div",8),n.\u0275\u0275elementStart(2,"span",9),n.\u0275\u0275text(3),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(4,$a,1,3,"button",10),n.\u0275\u0275elementEnd()),2&i){var t=n.\u0275\u0275nextContext(3);n.\u0275\u0275advance(2),n.\u0275\u0275attribute("aria-label",t.disallowQnaDetails.notEnabledDetails.message),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate(t.disallowQnaDetails.notEnabledDetails.message),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.disallowQnaDetails.notEnabledDetails.canEnable)}}function Ja(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"canvas-visual-error-overlay",12),n.\u0275\u0275listener("showErrorDetails",function(){n.\u0275\u0275restoreView(t);var a=n.\u0275\u0275nextContext(3);return n.\u0275\u0275resetView(a.showVisualErrorDetails())}),n.\u0275\u0275elementEnd()}if(2&i){var r=n.\u0275\u0275nextContext(3);n.\u0275\u0275property("errorInfo",r.disallowQnaDetails.otherReasonErrorDetails)("viewport",r.currentViewport)}}function Za(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Ka,5,3,"div",5),n.\u0275\u0275template(2,Ja,1,2,"canvas-visual-error-overlay",6),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf","qnaNotEnabled"===t.disallowQnaDetails.reason),n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf","qnaNotEnabled"!==t.disallowQnaDetails.reason)}}function Xa(i,e){if(1&i&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275template(1,Za,3,2,"ng-container",4),n.\u0275\u0275elementContainerEnd()),2&i){var t=n.\u0275\u0275nextContext(),r=n.\u0275\u0275reference(4);n.\u0275\u0275advance(1),n.\u0275\u0275property("ngIf",t.disallowQna)("ngIfElse",r)}}function Ya(i,e){if(1&i){var t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",13)(1,"qna-host",14,15),n.\u0275\u0275listener("utteranceUpdated",function(a){n.\u0275\u0275restoreView(t);var s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.utteranceUpdated(a))})("convertVisual",function(a){n.\u0275\u0275restoreView(t);var s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.convertVisual(a))})("inputBoxFocused",function(a){n.\u0275\u0275restoreView(t);var s=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(s.onInputBoxFocused(a))}),n.\u0275\u0275elementEnd()()}if(2&i){var r=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("config",r.config)("models",r.models)("hostServices",r.hostServices)("entryPoint",r.entryPoint)}}var es=function(e,t){return{hasDisallowQnaContent:e,customPadding:t}},ji="hiddenProperties",Gi="savedUtterance",Hi=function(){function i(e,t,r,o,a,s,u,c,l,d,f,v,F,I,T,Se,Ne,He,xt,Yt,zt,Gn){var Ei=this;this.changeDetectorRef=e,this.conceptualSchemaProxy=t,this.dataSources=r,this.errorService=o,this.eventBridge=a,this.explorationCapabilitiesService=s,this.explorationNavigation=u,this.filterGenerator=c,this.lazyProvider=l,this.localizationService=d,this.pauseQueriesService=f,this.visualPlugin=v,this.featureSwitchService=F,this.selection=I,this.telemetryService=T,this.themeService=Se,this.viewModeState=Ne,this.visualAuthoring=He,this.visualAuthoringCustomizeOperations=xt,this.promiseFactory=Yt,this.qnaProxyPath=Gn,this.visualReady=new n.EventEmitter,this.inputBoxFocused=new n.EventEmitter,this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager().subscribe(Pn.CCe,function(){return(0,C.mG)(Ei,void 0,void 0,function(){return(0,C.Jh)(this,function(Sr){switch(Sr.label){case 0:return[4,this.onModelChanged()];case 1:return Sr.sent(),[2]}})})}),this.subscriptions=new ki(zt),this.isReportPausedSubscription=this.pauseQueriesService.isReportPaused$().subscribe(function(){Ei.visualContainer&&Ei.reInitializeComponent()})}return i.prototype.ngOnInit=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){return this.reInitializeComponent(),[2]})})},i.prototype.ngOnDestroy=function(){this.subscriptionManager.unsubscribeAll(),this.subscriptions.unsubscribeAll(),this.settingsChangedSubscription&&this.settingsChangedSubscription.unsubscribe(),this.isReportPausedSubscription&&this.isReportPausedSubscription.unsubscribe(),this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(this.visualContainer)&&this.visualAuthoringCustomizeOperations.removeCustomizeFrom(this.visualContainer)},i.prototype.ngDoCheck=function(){var e=this.visualDefinition.viewport;(!this.currentViewport||e.height!==this.currentViewport.height||e.width!==this.currentViewport.width||e.scale!==this.currentViewport.scale)&&(this.currentViewport={width:e.width,height:e.height,scale:e.scale},this.setNewViewport(e),this.qnaHost&&!this.disallowQna&&this.qnaHost.update({type:Zt.EP.Resize,viewport:this.currentViewport}))},i.prototype.init=function(e){var t=this,r=this.extractObjects(this.visualContainer),o=(0,wa.NA)(r,{objectName:ji,propertyName:Gi},"");this.config={canEdit:this.getCanEdit(),canShowPods:!1,canShowVisuals:!0,canShowDidYouMean:!0,initialUtterance:o,initialUtteranceFromSaved:!_.isEmpty(o)};var a=_.find(this.dataSources.get(),function(s){return s.type===xa.nKy});this.models=[{vsName:a.dsr.vsName,dbName:a.dsr.dbName,qnaSupported:!0,id:a.id}],this.entryPoint="Visual",this.hostServices=e.host,this.isLoading=!1,this.setNewViewport(e.viewport),this.changeDetectorRef.detectChanges(),this.onVisualContainerUpdate(!0),this.visualAuthoringCustomizeOperations.registerCustomizeFrom(this.visualContainer,function(s){return t.customizeConvertFrom(s)})},i.prototype.update=function(e){!(0,te.yE)(e.type,Zt.EP.Resize)||!this.qnaHost||(this.setNewViewport(e.viewport),this.qnaHost.update({type:Zt.EP.Resize,viewport:e.viewport}))},i.prototype.onViewModeChanged=function(e){this.config.canEdit=this.getCanEdit()},i.prototype.enumerateObjectInstances=function(e){if(this.qnaHost)return this.qnaHost.enumerateObjectInstances(e)},i.prototype.getFormattingModel=function(){if(this.qnaHost)return this.qnaHost.getFormattingModel()},Object.defineProperty(i.prototype,"supportsCustomPadding",{get:function(){var t;return null===(t=this.featureSwitchService)||void 0===t?void 0:t.featureSwitches.vcPadding},enumerable:!1,configurable:!0}),i.prototype.focus=function(){if(this.qnaHost)return this.qnaHost.focus()},i.prototype.utteranceUpdated=function(e){var t;if(null!=e){var r={merge:[{objectName:ji,selector:void 0,properties:(t={},t[Gi]=e,t)}]};this.hostServices.persistProperties(r,!0)}},i.prototype.convertVisual=function(e){return(0,C.mG)(this,void 0,void 0,function(){var t,o,a=this;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return t=(0,Qi.s)(e),[4,this.visualAuthoring.convert(this.visualContainer,this.dataSources.get(),t,void 0)];case 1:return s.sent()&&(o=this.selection.getSelectedElements().find(function(u){return u.canvasItem.name===a.visualContainer.name}))&&this.eventBridge.publishToChannel(Pn.MEZ,{affectContainer:function(c){return c===o.canvasItem},preventScroll:!0}),[2]}})})},i.prototype.onInputBoxFocused=function(e){this.inputBoxFocused.emit(e)},i.prototype.customizeConvertFrom=function(e){g.fF.assertValue(e,"visualContainer");var t=this.qnaHost&&this.qnaHost.getCurrentVisual();t&&(e.config.singleVisual.query=t.config.singleVisual.query,e.config.singleVisual.visualType=t.config.singleVisual.visualType,e.config.singleVisual.objects=(0,C.pi)((0,C.pi)({},e.config.singleVisual.objects||{}),t.config.singleVisual.objects||{}),e.filters=t.filters,e.config.singleVisual.conversionSourceContext=void 0)},i.prototype.enableQna=function(){var e=this;g.fF.assert(function(){var t,r;return e.disallowQna&&(null===(r=null===(t=e.disallowQnaDetails)||void 0===t?void 0:t.notEnabledDetails)||void 0===r?void 0:r.canEnable)},"Expect this is called only when this.disallowQna && this.disallowQnaDetails.becauseNotEnabledDetails.canEnable is true"),this.qnaSupportabilityService.enableQna()},i.prototype.showVisualErrorDetails=function(){var e=this;g.fF.assert(function(){var t;return e.disallowQna&&!(null===(t=e.disallowQnaDetails)||void 0===t||!t.otherReasonErrorDetails)},"Expect this to be called only when this.disallowQna && this.disallowQnaDetails.becauseOtherReasonErrorDetails is defined"),(0,kn.aZ)(this.disallowQnaDetails.otherReasonErrorDetails,this.errorService,this.localizationService)},i.prototype.reInitializeComponent=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t,r,o=this;return(0,C.Jh)(this,function(a){switch(a.label){case 0:return this.isLoading=!0,this.visualContainer.filters=void 0,[4,this.ensureQnaSupportabilityService()];case 1:return a.sent(),this.settingsChangedSubscription||(this.settingsChangedSubscription=this.qnaSupportabilityService.qnaSettingsChanged$.subscribe(function(){return o.reInitializeComponent()})),[4,this.checkIsQnaAllowed()];case 2:return a.sent(),this.disallowQna?(this.isLoading=!1,[2]):(this.wasQnaAllowedBefore?this.visualDefinition.visual.destroy():(this.currentViewport=this.visualDefinition.viewport,e=this.visualPlugin.getPlugin(this.visualDefinition.type),this.visualDefinition.visual=(0,Va.nm)(e,e.create,this.promiseFactory,this.telemetryService,{createQnaVisual:function(){return o}}),this.subscriptionManager.subscribe(Pn.jCS,function(s,u){u&&u.affectContainer(o.visualContainer)&&o.onVisualContainerUpdate()}).subscribe(Ia.kx,function(){return(0,C.mG)(o,void 0,void 0,function(){return(0,C.Jh)(this,function(s){switch(s.label){case 0:return[4,this.onVisualContainerUpdate()];case 1:return[2,s.sent()]}})})}).subscribe(Pn.Tuj,function(){return(0,C.mG)(o,void 0,void 0,function(){return(0,C.Jh)(this,function(s){switch(s.label){case 0:return[4,this.onVisualContainerUpdate()];case 1:return[2,s.sent()]}})})}),this.subscriptions.subscribe("LuciaDomainModelChangedEvent",function(){return o.onVisualContainerUpdate()})),this.wasQnaAllowedBefore=!0,t=(0,kn.Su)(this.explorationNavigation,this.featureSwitchService),r={element:{empty:function(){},get:function(){}},host:this.visualDefinition.hostServices,visualAdapterHostServices:this.visualDefinition.visualAdapterHostServices,style:this.themeService&&this.themeService.getVisualStyle(t),viewport:this.visualDefinition.viewport,animation:{transitionImmediate:!1},featureSwitches:(0,C.pi)({},this.featureSwitchService.featureSwitches)},[2,this.visualDefinition.visual.init(r)])}})})},i.prototype.getCanEdit=function(){return 0!==this.viewModeState.getMode()},i.prototype.onModelChanged=function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return[4,this.reInitializeComponent()];case 1:return e.sent(),[2]}})})},i.prototype.checkIsQnaAllowed=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,r,o;return(0,C.Jh)(this,function(a){switch(a.label){case 0:if(this.pauseQueriesService.isReportPaused())return this.disallowQna=!0,this.disallowQnaDetails={reason:"qnaNotSupported",otherReasonErrorDetails:is(this.localizationService)},[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 2:return e=a.sent(),[3,4];case 3:return a.sent(),[2];case 4:if(r=this.explorationCapabilitiesService.getCapabilities(),o=(0,oi.H)(r,e,this.qnaSupportabilityService),this.disallowQna=!o.isAllowed,o.isAllowed)return[2];switch(o.disallowedReason){case"featureDisabledInIE":this.disallowQnaDetails={reason:"featureDisabledInIE",otherReasonErrorDetails:(0,kn.ET)(this.localizationService)};break;case"featureDisabledInApp":g.fF.assertFail("Expect the code of generating a qna visual never be called if app doesn't allow qna feature");break;case"noModel":this.disallowQnaDetails={reason:"noModel",otherReasonErrorDetails:ts(this.localizationService)};break;case"qnaNotSupported":this.disallowQnaDetails={reason:"qnaNotSupported",otherReasonErrorDetails:ns(this.localizationService)};break;case"qnaNotEnabled":this.disallowQnaDetails={reason:"qnaNotEnabled",notEnabledDetails:{message:this.qnaSupportabilityService.modelHasQnaDisabledMessage,canEnable:this.qnaSupportabilityService.canAnyUserEnableQna()}};break;default:g.fF.assertNever(o.disallowedReason)}return[2]}})})},i.prototype.onVisualContainerUpdate=function(e){return void 0===e&&(e=!1),(0,C.mG)(this,void 0,void 0,function(){var t,r,o,a,s=this;return(0,C.Jh)(this,function(u){switch(u.label){case 0:return this.isLoading?[2]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return t=u.sent(),r=this.filterGenerator.calculateVisualContainerFilter(this.explorationNavigation.getCurrentExploration(),this.explorationNavigation.getCurrentSection(),this.visualContainer,t),o=this.extractObjects(this.visualContainer),a=Zt.EP.Style|Zt.EP.Data,e&&(a|=Zt.EP.Resize),this.qnaHost&&(this.qnaHost.update({type:a,filters:r,objects:o,firstUpdate:e,viewport:this.currentViewport}),this.visualAuthoringCustomizeOperations.registerCustomizeFrom(this.visualContainer,function(c){return s.customizeConvertFrom(c)})),this.eventBridge.publishToChannel(Pn.D1A,this.visualContainer),this.visualReady.emit(),[2]}})})},i.prototype.extractObjects=function(e){var t=(0,Ni.GQ)(e);t||(t={}),t=(0,zi.d9)(t);var r=(0,kn.Su)(this.explorationNavigation,this.featureSwitchService),o=this.themeService.getVisualObjects(r,(0,Qi.s)(e),void 0,Ma.OF.objects,!1);(0,zi.l7)(t,o);var a=[];for(var s in t)a.push({name:s,properties:t[s][0].properties});var u=(0,Ni.cj)(e,this.visualPlugin),c=u?.objects;if(c){var l=this.themeService.getVisualStyle(r),d=(0,Ta.X)(),f=new Oa.Q(this.featureSwitchService.featureSwitches,l);return(0,Ba.PJ)(f,d,c,a)}},i.prototype.setNewViewport=function(e){var t=this.qnaVisualElement.nativeElement;$(t).height(e.height),$(t).width(e.width)},i.prototype.ensureQnaSupportabilityService=function(){return(0,C.mG)(this,void 0,void 0,function(){var e;return(0,C.Jh)(this,function(t){switch(t.label){case 0:return this.qnaSupportabilityService?[2]:(e=this,[4,this.lazyProvider.get(this.qnaProxyPath||"@powerbi/Qna/qnaweb.module#QnaWebModule","qnaSupportabilityService")]);case 1:return e.qnaSupportabilityService=t.sent(),[2]}})})},i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(xe.i),n.\u0275\u0275directiveInject(Re.D),n.\u0275\u0275directiveInject(Qa.T),n.\u0275\u0275directiveInject(Ua.J),n.\u0275\u0275directiveInject(qi.U),n.\u0275\u0275directiveInject(Ce.z),n.\u0275\u0275directiveInject(La.r),n.\u0275\u0275directiveInject(Ge.E),n.\u0275\u0275directiveInject(Ut.o),n.\u0275\u0275directiveInject(Ra.F),n.\u0275\u0275directiveInject(Na.D),n.\u0275\u0275directiveInject(Ke.vZ),n.\u0275\u0275directiveInject(za.z),n.\u0275\u0275directiveInject(ge.y0),n.\u0275\u0275directiveInject(ja.f),n.\u0275\u0275directiveInject(Oi.kc),n.\u0275\u0275directiveInject(ka.$8),n.\u0275\u0275directiveInject(qa.Q),n.\u0275\u0275directiveInject(ba.t),n.\u0275\u0275directiveInject(Ri.x,8),n.\u0275\u0275directiveInject(Bt.n,8))},i.\u0275cmp=n.\u0275\u0275defineComponent({type:i,selectors:[["qna-visual-host"]],viewQuery:function(t,r){if(1&t&&(n.\u0275\u0275viewQuery(Ha,7,n.ElementRef),n.\u0275\u0275viewQuery(Ve.Pl,7),n.\u0275\u0275viewQuery(ri,5)),2&t){var o=void 0;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.qnaVisualElement=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.portalOutlet=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r.qnaHost=o.first)}},inputs:{visualDefinition:"visualDefinition",visualContainer:"visualContainer"},outputs:{visualReady:"visualReady",inputBoxFocused:"inputBoxFocused"},decls:5,vars:6,consts:[["keyboard-shortcuts","ctrl-ArrowRight scoped",1,"visual","visual-qnaVisual",3,"ngClass"],["qnaVisual",""],[4,"ngIf"],["showQna",""],[4,"ngIf","ngIfElse"],["class","qnaNotEnabledContainer",4,"ngIf"],[3,"errorInfo","viewport","showErrorDetails",4,"ngIf"],[1,"qnaNotEnabledContainer"],[1,"glyphicon","pbi-glyph-blocked2","glyph-med"],["tabindex","0",1,"message"],["class","btn primary",3,"localizeAttr","localize","accessible-click",4,"ngIf"],[1,"btn","primary",3,"localizeAttr","localize","accessible-click"],[3,"errorInfo","viewport","showErrorDetails"],[1,"qnaVisualContent"],[3,"config","models","hostServices","entryPoint","utteranceUpdated","convertVisual","inputBoxFocused"],["qnaHost",""]],template:function(t,r){1&t&&(n.\u0275\u0275elementStart(0,"div",0,1),n.\u0275\u0275template(2,Xa,2,2,"ng-container",2),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(3,Ya,3,4,"ng-template",null,3,n.\u0275\u0275templateRefExtractor)),2&t&&(n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(3,es,r.disallowQna,r.supportsCustomPadding)),n.\u0275\u0275attribute("focus-nav-mode","Group"),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",!r.isLoading))},dependencies:[D.NgClass,D.NgIf,Gt.X,ze.b,Vi.f,Lt.t,Ga.q,ri],styles:[".visual-qnaVisual.hasDisallowQnaContent[_ngcontent-%COMP%]{width:100%!important;height:100%!important}  html[data-focus-source=key] .visual-qnaVisual:focus,   html[data-focus-source=key] .visual-qnaVisual *:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}  html[data-focus-source=mouse] .visual-qnaVisual:focus,   html[data-focus-source=mouse] .visual-qnaVisual *:focus,   html[data-focus-source=program] .visual-qnaVisual:focus,   html[data-focus-source=program] .visual-qnaVisual *:focus{outline:none}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaNotEnabledContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;box-sizing:border-box;padding:20px;background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);font-size:14px;text-align:center}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaNotEnabledContainer[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-top:12px;max-width:300px}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaNotEnabledContainer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:12px}.visual-qnaVisual[_ngcontent-%COMP%]   .qnaVisualContent[_ngcontent-%COMP%]{height:100%}"]}),i}();function ts(i){return{code:"qnaNotAllowedWithoutModel",fixableError:0,hideSeeDetails:!0,details:{message:i.get("Qna_NotAllowedForReport_WithoutModel"),displayableErrorInfo:void 0},source:"User"}}function ns(i){var r=[{errorInfoKey:i.get("VisualContainer_QnaVisual_NotSupportedTitle"),errorInfoValue:i.get("VisualContainer_QnaVisual_NotSupportedMessage")}];return{code:"qnaNotSupported",fixableError:0,hideSeeDetails:!1,details:{message:i.get("Qna_NotAllowedForReport_QnaNotSupported"),displayableErrorInfo:r},source:"User"}}function is(i){return{code:"qnaNotSupported",fixableError:0,hideSeeDetails:!0,details:{message:i.get("Qna_NotAllowedForReport_Paused"),displayableErrorInfo:void 0},source:"User"}}var Wi=p(67489),rs=p(96777),$i=function(){function i(e){this.templateDialogPayload=e}return i.prototype.ngOnInit=function(){var e,t=(e=this.templateDialogPayload.input).errorCode,r=e.errorMessage;g.fF.assertValue(t,"diagnostic dialog error code"),this.diagnosticMessage=(0,Rn.g)(r)?t:"".concat(t," ").concat(r)},i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275directiveInject(Wi.x))},i.\u0275cmp=n.\u0275\u0275defineComponent({type:i,selectors:[["qna-diagnostic-dialog"]],features:[n.\u0275\u0275ProvidersFeature([Wi.x])],decls:3,vars:1,consts:[[2,"min-width","400px"]],template:function(t,r){1&t&&(n.\u0275\u0275elementStart(0,"template-dialog")(1,"p",0),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd()()),2&t&&(n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(r.diagnosticMessage))},dependencies:[rs.J],encapsulation:2,changeDetection:0}),i}(),os=p(92060),as=p(96427),ai=p(14714),ss=p(68082),si=p(70604),us=p(58938);function Ki(i,e,t,r,o){var a;return(0,C.mG)(this,void 0,void 0,function(){var s,u;return(0,C.Jh)(this,function(l){switch(l.label){case 0:return[4,i.get(e.get())];case 1:return s=l.sent(),u=t.getCapabilities(),(0,oi.H)(u,s,r).isAllowed&&r.allowsLinguisticSchemaEdit()&&"None"!==(null===(a=o.DynamicImprovement)||void 0===a?void 0:a.Schema)?[2,!0]:[2,!1]}})})}function Qn(i){return _.includes(i,"PowerBI.AzureOpenAISynonyms")||_.includes(i,"PowerBI.AzureOpenAIPhrasings")}function Ji(i){return i.qnaImproveLsdlCopilot&&i.qnaSupportCommitQuestionOnDemandForAll&&i.qnaFuzzyMatch}var Zi=function(){function i(e,t){this.agentName=e,this.agentProperties=t}return Object.defineProperty(i.prototype,"name",{get:function(){return this.agentName},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lastModified",{get:function(){return this.agentProperties.LastModified},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"state",{get:function(){var t;return null!==(t=this.agentProperties.State)&&void 0!==t?t:"Enabled"},set:function(t){this.agentProperties.State=t,this.isDirty=!0},enumerable:!1,configurable:!0}),i.prototype.shouldCommit=function(){return this.isDirty},i.prototype.resetCommitState=function(){this.isDirty=!1},i.prototype.markDirty=function(){this.isDirty=!0},i}(),ct=p(69615),ot=function(){function i(e,t,r,o,a,s,u){this.value=e,this.state=t,this.weight=r,this.sourceType=o,this.sourceAgent=a,this.type=s,this.lastModified=u,g.fF.assertValue(e,"value"),this.value=e.trim(),t||(this.state="Authored"),o||(this.sourceType="Default")}return i.createAuthoredTerm=function(e){return new i(e,"Authored",void 0,"Default",void 0,void 0,(0,ct.uL)())},i.createAuthoredTerms=function(e){return _.map(e,function(t){return i.createAuthoredTerm(t)})},Object.defineProperty(i.prototype,"isSuggested",{get:function(){return"Suggested"===this.state},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isVisualColumnRenameTerm",{get:function(){return this.isSuggested&&"External"===this.sourceType&&"PowerBI.VisualColumnRename"===this.sourceAgent},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isAuthored",{get:function(){return"Authored"===this.state||null==this.state},enumerable:!1,configurable:!0}),i.prototype.createModified=function(e){return g.fF.assertValue(e,"modifiedProperties"),new i(this.value,e.state||this.state,e.clearWeight?void 0:this.weight,e.sourceType||this.sourceType,e.clearSourceAgent?void 0:this.sourceAgent,this.type,e.updateLastModified?(0,ct.uL)():this.lastModified)},i.prototype.areValuesEqual=function(e){return g.fF.assertValue(e,"term"),i.getUniqueKey(this.value)===i.getUniqueKey(e.value)},i.getUniqueKey=function(e){return g.fF.assertValue(e,"value"),e.toLowerCase()},i}(),dt=function(){function i(e,t,r,o,a,s,u){void 0===u&&(u=!1),this.kind=e,this.lsdlName=t,this.entityState=r,this.entityTerms=o,this.entityVisibility=a,this.entityVisibilityState=s,g.fF.assertValue(e,"kind"),this.entityState||(this.entityState="Authored"),this.entityTerms||(this.entityTerms=[]),a||(this.entityVisibility="Visible"),s||(this.entityVisibilityState="Default"),this.isDirty=u}return Object.defineProperty(i.prototype,"terms",{get:function(){return this.entityTerms},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"state",{get:function(){return this.entityState},set:function(t){this.entityState=t,this.isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visibility",{get:function(){return this.entityVisibility},set:function(t){g.fF.assertValue(t,"value"),this.entityVisibility=t,this.entityVisibilityState="Authored",this.isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visibilityState",{get:function(){return this.entityVisibilityState},enumerable:!1,configurable:!0}),i.prototype.shouldCommit=function(){return this.isDirty},i.prototype.equals=function(e){if(g.fF.assertValue(e,"LsdlEntityModel"),this.terms.length!==e.terms.length)return!1;for(var t=new Set,r=0,o=this.terms;r<o.length;r++)"Deleted"!==(a=o[r]).state&&t.add(a.value);for(var s=0,u=e.terms;s<u.length;s++){var a;if("Deleted"!==(a=u[s]).state&&!t.has(a.value))return!1}return this.kind===e.kind&&this.lsdlName===e.lsdlName&&this.visibility===e.visibility&&this.state===e.state},i.prototype.moveToIndex=function(e,t){var r=this;g.fF.assert(function(){return t>=0&&t<_.size(r.terms)},"specified index out of bounds");var o=_.indexOf(this.terms,e);o<0&&g.fF.assertFail("item not in array"),o!==t&&(this.terms.splice(t,0,this.terms.splice(o,1)[0]),this.markGeneratedTermsAsAuthored(),this.isDirty=!0)},i.prototype.addAuthoredTerm=function(e){g.fF.assertValue(e,"value");var t=ot.createAuthoredTerm(e);return _.remove(this.entityTerms,function(r){return r.areValuesEqual(t)}),this.entityTerms.push(t),this.markGeneratedTermsAsAuthored(),this.isDirty=!0,t},i.prototype.addVisualColumnRenameTerms=function(e){g.fF.assertNonEmpty(e,"values");for(var t=function(c){var l=_.trim(c);if(_.isEmpty(l))return"continue";var d=new ot(l,"Suggested",.9,"External","PowerBI.VisualColumnRename",void 0,void 0),f=_.find(r.entityTerms,function(v){return v.areValuesEqual(d)});if(f&&("Suggested"!==f.state||f.isVisualColumnRenameTerm))return"continue";r.entityTerms.push(d),r.isDirty=!0},r=this,o=0,a=e;o<a.length;o++)t(a[o])},i.prototype.removeVisualColumnRenameTerms=function(){var e=_.remove(this.entityTerms,function(t){return t.isVisualColumnRenameTerm});_.isEmpty(e)||(this.isDirty=!0)},i.prototype.removeSuggestedTermsByAgent=function(e){var t=_.remove(this.entityTerms,function(r){return r.isSuggested&&r.sourceAgent===e});_.isEmpty(t)||(this.isDirty=!0)},i.prototype.promoteSuggestedTerm=function(e){g.fF.assertValue(e,"termModel"),this.modifyTerm(e,{state:"Authored",clearWeight:!0,clearSourceAgent:!1,updateLastModified:!0}),this.markGeneratedTermsAsAuthored()},i.prototype.tryMarkTermAsDeleted=function(e){return g.fF.assertValue(e,"termModel"),!_.every(this.terms,function(t){return t.areValuesEqual(e)||"Deleted"===t.state})&&(this.modifyTerm(e,{state:"Deleted",sourceType:"Default",clearWeight:!0,clearSourceAgent:!0,updateLastModified:!0}),this.markGeneratedTermsAsAuthored(),!0)},i.prototype.setAsPrimaryTerm=function(e){g.fF.assertValue(e,"termModel"),g.fF.assert(function(){return"Authored"===e.state||"Generated"===e.state},"only authored/generated terms can be promoted"),_.remove(this.entityTerms,e),this.entityTerms.splice(0,0,e),this.isDirty=!0,this.markGeneratedTermsAsAuthored()},i.prototype.getPrimaryTerm=function(){return _.find(this.entityTerms,function(e){return!e.isSuggested})},i.prototype.resetCommitState=function(){this.isDirty=!1},i.isConceptualEntityModel=function(e){return 1===e.kind},i.isConceptualPropertyModel=function(e){return 2===e.kind},i.isConceptualHierarchyModel=function(e){return 3===e.kind},i.isConceptualHierarchyLevelModel=function(e){return 4===e.kind},i.prototype.markGeneratedTermsAsAuthored=function(){for(var e=0,t=this.entityTerms;e<t.length;e++){var r=t[e];"Generated"===r.state&&this.modifyTerm(r,{state:"Authored",updateLastModified:!1})}},i.prototype.modifyTerm=function(e,t){var r=_.indexOf(this.entityTerms,e);g.fF.assertValue(r>=0,"term has to be part of the current entityModel");var o=e.createModified(t);this.entityTerms.splice(r,1,o),this.isDirty=!0},i}(),cs=function(i){function e(t,r,o,a,s,u,c){void 0===c&&(c=!1);var l=i.call(this,1,r,o,a,s,u,c)||this;return l.tableName=t,g.fF.assertValue(r,"lsdlName"),g.fF.assertValue(t,"tableName"),l}return(0,C.ZT)(e,i),e}(dt),Xi=function(i){function e(t,r,o,a,s,u,c,l){void 0===l&&(l=!1);var d=i.call(this,2,o,a,s,u,c,l)||this;return d.tableName=t,d.propertyName=r,g.fF.assertValue(o,"lsdlName"),g.fF.assertValue(t,"tableName"),g.fF.assertValue(r,"propertyName"),d}return(0,C.ZT)(e,i),e}(dt),ds=function(i){function e(t,r,o,a,s,u,c,l,d){var f=i.call(this,3,s,u,c,l,d)||this;return f.tableName=t,f.hierarchy=r,f.variationSet=o,f.variationSource=a,g.fF.assertValue(s,"lsdlName"),g.fF.assertValue(t,"tableName"),g.fF.assertValue(r,"hierarchy"),g.fF.assertAnyValue(o,"variationSet"),g.fF.assertAnyValue(a,"variationSource"),f}return(0,C.ZT)(e,i),e}(dt),ps=function(i){function e(t,r,o,a,s,u,c,l,d,f){var v=i.call(this,4,u,c,l,d,f)||this;return v.tableName=t,v.hierarchy=r,v.hierarchyLevel=o,v.variationSet=a,v.variationSource=s,g.fF.assertValue(u,"lsdlName"),g.fF.assertValue(t,"tableName"),g.fF.assertValue(r,"hierarchy"),g.fF.assertValue(o,"hierarchyLevel"),g.fF.assertAnyValue(a,"variationSet"),g.fF.assertAnyValue(s,"variationSource"),v}return(0,C.ZT)(e,i),e}(dt),Yi=function(){function i(e,t,r,o){void 0===o&&(o=!1),this.prepPhrasePrepositions=e,this.prepPhraseObjectEntity=t,this.lsdlReference=r,g.fF.assertNonEmpty(e,"cannot have prep phrase with no prepositions"),g.fF.assertValue(t,"objectEntity"),this.isDirty=o}return Object.defineProperty(i.prototype,"prepositions",{get:function(){return this.prepPhrasePrepositions},set:function(t){this.prepPhrasePrepositions=t,this.isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"objectEntity",{get:function(){return this.prepPhraseObjectEntity},set:function(t){this.prepPhraseObjectEntity=t,this.isDirty=!0},enumerable:!1,configurable:!0}),i.prototype.shouldCommit=function(){return this.isDirty},i.prototype.resetCommitState=function(){this.isDirty=!1},i.prototype.equalsToPrepPhraseReferenceModel=function(e){return this.lsdlReference===e.lsdlReference},i.prototype.equalsToPrepPhraseReference=function(e){return this.lsdlReference===e},i.prototype.clone=function(){return new i((0,C.ev)([],this.prepPhrasePrepositions,!0),(0,C.pi)({},this.prepPhraseObjectEntity),this.lsdlReference)},i}(),An=function(){function i(e,t,r,o,a,s,u,c,l){void 0===l&&(l=!1),this.kind=e,this.prepPhrases=t,this.phrasingLastModified=r,this.phrasingID=o,this.phrasingState=a,this.phrasingSource=s,this.parentRelationship=u,this.lsdlReference=c,g.fF.assert(function(){return null!=e},"LsdlPhrasingModel kind"),g.fF.assertValue(u,"parentRelationship"),_.isEmpty(this.prepPhrases)&&(this.prepPhrases=[]),this.phrasingState||(this.phrasingState="Authored"),this.isDirty=l}return Object.defineProperty(i.prototype,"lastModified",{get:function(){return this.phrasingLastModified},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ID",{get:function(){return this.phrasingID},set:function(t){this.phrasingID=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"state",{get:function(){return this.phrasingState},set:function(t){this.phrasingState=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"prepositionalPhrases",{get:function(){return this.prepPhrases},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"source",{get:function(){return this.phrasingSource},set:function(t){this.phrasingSource=t,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),i.prototype.shouldCommit=function(){return this.isDirty},i.prototype.resetCommitState=function(){this.isDirty=!1},i.prototype.setPhrasingUpdated=function(){this.isDirty=!0,this.phrasingLastModified=(0,ct.uL)(),"Deleted"!==this.phrasingState&&(this.phrasingState="Authored"),"Deleted"!==this.parentRelationship.state&&(this.parentRelationship.state="Authored")},i.prototype.updatePrepositionalPhrases=function(e){var t=this;this.prepPhrases=_.map(e,function(r){t.parentRelationship.ensureRole(r.object);var o=r.originalModel?_.find(t.prepositionalPhrases,function(s){return s.equalsToPrepPhraseReferenceModel(r.originalModel)}):void 0;if(null!=o)return o.prepositions=pn(r.prepositions,o.prepositions),o.objectEntity=r.object,o;var a=ot.createAuthoredTerms(r.prepositions);return new Yi(a,r.object,void 0,!0)}),this.setPhrasingUpdated()},i.prototype.equalsToPhrasingReferenceModel=function(e){return this.lsdlReference===e.lsdlReference},i.prototype.equalsToPhrasingReference=function(e){return this.lsdlReference===e},i}(),Nn=function(i){function e(){return null!==i&&i.apply(this,arguments)||this}return(0,C.ZT)(e,i),e}(An),ui=function(i){function e(t,r,o,a,s,u,c,l,d,f,v,F){void 0===F&&(F=!1);var I=i.call(this,1,s,u,c,l,d,f,v,F)||this;return I.phrasingSubject=t,I.phrasingAdjectives=r,I.phrasingAntonyms=o,I.phrasingMeasurement=a,g.fF.assertValue(t,"LsdlAdjectivePhrasingModel phrasingSubject"),g.fF.assertAnyValue(r,"LsdlAdjectivePhrasingModel phrasingAdjectives"),g.fF.assertAnyValue(o,"LsdlAdjectivePhrasingModel phrasingAntonyms"),g.fF.assertAnyValue(a,"LsdlAdjectivePhrasingModel phrasingMeasurement"),g.fF.assertAnyValue(s,"LsdlAdjectivePhrasingModel prepositionalPhrases"),I.phrasingAdjectives||(I.phrasingAdjectives=[]),I.phrasingAntonyms||(I.phrasingAntonyms=[]),I}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adjectives",{get:function(){return this.phrasingAdjectives},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"antonyms",{get:function(){return this.phrasingAntonyms},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"measurement",{get:function(){return this.phrasingMeasurement},set:function(r){r&&this.parentRelationship.ensureRole(r),this.phrasingMeasurement=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),e.prototype.updateAdjectives=function(t){this.phrasingAdjectives=pn(t,this.phrasingAdjectives),this.setPhrasingUpdated()},e.prototype.updateAntonyms=function(t){this.phrasingAntonyms=pn(t,this.phrasingAntonyms),this.setPhrasingUpdated()},e.prototype.markTermAsDeleted=function(t){var r=Fn(this.phrasingAdjectives,t,this,this.parentRelationship);return(r=Fn(this.phrasingAntonyms,t,this,this.parentRelationship)||r)&&this.setPhrasingUpdated(),r},e.prototype.hasTerms=function(){return bn(this.phrasingAdjectives)||bn(this.phrasingAntonyms)},e.prototype.clone=function(t){return new e((0,C.pi)({},this.phrasingSubject),(0,C.ev)([],this.phrasingAdjectives,!0),(0,C.ev)([],this.phrasingAntonyms,!0),this.phrasingMeasurement?(0,C.pi)({},this.phrasingMeasurement):void 0,_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(Nn),li=function(i){function e(t,r,o,a,s,u,c,l,d,f){void 0===f&&(f=!1);var v=i.call(this,3,o,a,s,u,c,l,d,f)||this;return v.phrasingSubject=t,v.phrasingAdjective=r,g.fF.assertValue(t,"LsdlDynamicAdjectivePhrasingModel phrasingSubject"),g.fF.assertValue(r,"LsdlDynamicAdjectivePhrasingModel phrasingAdjective"),g.fF.assertAnyValue(o,"LsdlDynamicAdjectivePhrasingModel prepositionalPhrases"),v}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adjective",{get:function(){return this.phrasingAdjective},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingAdjective=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),e.prototype.clone=function(t){return new e((0,C.pi)({},this.phrasingSubject),(0,C.pi)({},this.phrasingAdjective),_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(An),ci=function(i){function e(t,r,o,a,s,u,c,l,d,f){void 0===f&&(f=!1);var v=i.call(this,2,o,a,s,u,c,l,d,f)||this;return v.phrasingSubject=t,v.phrasingNouns=r,g.fF.assertValue(t,"LsdlNounPhrasingModel phrasingSubject"),g.fF.assertValue(r,"LsdlNounPhrasingModel phrasingNouns"),g.fF.assertAnyValue(o,"LsdlNounPhrasingModel prepositionalPhrases"),v}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nouns",{get:function(){return this.phrasingNouns},enumerable:!1,configurable:!0}),e.prototype.updateNouns=function(t){this.phrasingNouns=pn(t,this.phrasingNouns),this.setPhrasingUpdated()},e.prototype.markTermAsDeleted=function(t){var r=Fn(this.phrasingNouns,t,this,this.parentRelationship);return r&&this.setPhrasingUpdated(),r},e.prototype.hasTerms=function(){return bn(this.phrasingNouns)},e.prototype.clone=function(t){return new e((0,C.pi)({},this.phrasingSubject),(0,C.ev)([],this.phrasingNouns,!0),_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(Nn),di=function(i){function e(t,r,o,a,s,u,c,l,d,f){void 0===f&&(f=!1);var v=i.call(this,4,o,a,s,u,c,l,d,f)||this;return v.phrasingSubject=t,v.phrasingNoun=r,g.fF.assertValue(t,"LsdlDynamicNounPhrasingModel phrasingSubject"),g.fF.assertValue(r,"LsdlDynamicNounPhrasingModel phrasingNoun"),g.fF.assertAnyValue(o,"LsdlDynamicNounPhrasingModel prepositionalPhrases"),v}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"noun",{get:function(){return this.phrasingNoun},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingNoun=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),e.prototype.clone=function(t){return new e((0,C.pi)({},this.phrasingSubject),(0,C.pi)({},this.phrasingNoun),_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(An),pi=function(i){function e(t,r,o,a,s,u,c,l,d,f,v,F){void 0===F&&(F=!1);var I=i.call(this,5,s,u,c,l,d,f,v,F)||this;return I.phrasingSubject=t,I.phrasingVerbs=r,I.phrasingIndirectObject=o,I.phrasingObject=a,g.fF.assertValue(r,"LsdlVerbPhrasingModel phrasingVerbs"),g.fF.assertAnyValue(t,"LsdlVerbPhrasingModel phrasingSubject"),g.fF.assertAnyValue(o,"LsdlVerbPhrasingModel phrasingIndirectObject"),g.fF.assertAnyValue(a,"LsdlVerbPhrasingModel phrasingObject"),g.fF.assertAnyValue(s,"LsdlVerbPhrasingModel prepositionalPhrases"),I}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){r&&this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verbs",{get:function(){return this.phrasingVerbs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indirectObject",{get:function(){return this.phrasingIndirectObject},set:function(r){r&&this.parentRelationship.ensureRole(r),this.phrasingIndirectObject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"directObject",{get:function(){return this.phrasingObject},enumerable:!1,configurable:!0}),e.prototype.updateVerbs=function(t){this.phrasingVerbs=pn(t,this.phrasingVerbs),this.setPhrasingUpdated()},Object.defineProperty(e.prototype,"object",{set:function(r){r&&this.parentRelationship.ensureRole(r),this.phrasingObject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),e.prototype.markTermAsDeleted=function(t){var r=Fn(this.phrasingVerbs,t,this,this.parentRelationship);return r&&this.setPhrasingUpdated(),r},e.prototype.hasTerms=function(){return bn(this.phrasingVerbs)},e.prototype.clone=function(t){return new e(this.phrasingSubject?(0,C.pi)({},this.phrasingSubject):void 0,(0,C.ev)([],this.phrasingVerbs,!0),this.phrasingIndirectObject?(0,C.pi)({},this.phrasingIndirectObject):void 0,this.phrasingObject?(0,C.pi)({},this.phrasingObject):void 0,_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(Nn),gi=function(i){function e(t,r,o,a,s,u,c,l,d,f,v){void 0===v&&(v=!1);var F=i.call(this,6,a,s,u,c,l,d,f,v)||this;return F.phrasingSubject=t,F.phrasingPrepositions=r,F.phrasingObject=o,g.fF.assertValue(t,"LsdlPrepositionPhrasingModel phrasingSubject"),g.fF.assertValue(r,"LsdlPrepositionPhrasingModel phrasingPrepositions"),g.fF.assertValue(o,"LsdlPrepositionPhrasingModel phrasingObject"),g.fF.assertAnyValue(a,"LsdlPrepositionPhrasingModel prepositionalPhrases"),F}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"prepositions",{get:function(){return this.phrasingPrepositions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"object",{get:function(){return this.phrasingObject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingObject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),e.prototype.updatePrepositions=function(t){this.phrasingPrepositions=pn(t,this.phrasingPrepositions),this.setPhrasingUpdated()},e.prototype.markTermAsDeleted=function(t){var r=Fn(this.phrasingPrepositions,t,this,this.parentRelationship);return r&&this.setPhrasingUpdated(),r},e.prototype.hasTerms=function(){return bn(this.phrasingPrepositions)},e.prototype.clone=function(t){return new e((0,C.pi)({},this.phrasingSubject),(0,C.ev)([],this.phrasingPrepositions,!0),(0,C.pi)({},this.phrasingObject),_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(Nn),hi=function(i){function e(t,r,o,a,s,u,c,l,d,f){void 0===f&&(f=!1);var v=i.call(this,7,o,a,s,u,c,l,d,f)||this;return v.phrasingSubject=t,v.phrasingObject=r,g.fF.assertValue(t,"LsdlAttributePhrasingModel phrasingSubject"),g.fF.assertValue(r,"LsdlAttributePhrasingModel phrasingObject"),g.fF.assertAnyValue(o,"LsdlAttributePhrasingModel prepositionalPhrases"),v}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"object",{get:function(){return this.phrasingObject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingObject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),e.prototype.clone=function(t){return new e((0,C.pi)({},this.phrasingSubject),(0,C.pi)({},this.phrasingObject),_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(An),fi=function(i){function e(t,r,o,a,s,u,c,l,d,f){void 0===f&&(f=!1);var v=i.call(this,8,o,a,s,u,c,l,d,f)||this;return v.phrasingSubject=t,v.phrasingName=r,g.fF.assertValue(t,"LsdlNamePhrasingModel phrasingSubject"),g.fF.assertValue(r,"LsdlNamePhrasingModel phrasingName"),v}return(0,C.ZT)(e,i),Object.defineProperty(e.prototype,"subject",{get:function(){return this.phrasingSubject},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingSubject=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.phrasingName},set:function(r){this.parentRelationship.ensureRole(r),this.phrasingName=r,this.setPhrasingUpdated()},enumerable:!1,configurable:!0}),e.prototype.clone=function(t){return new e((0,C.pi)({},this.phrasingSubject),(0,C.pi)({},this.phrasingName),_.map(this.prepositionalPhrases,function(r){return r.clone()}),this.lastModified,this.ID,this.state,this.source,t,this.lsdlReference)},e}(An);function Fn(i,e,t,r){var o=_.findIndex(i,e);if(o<0)return!1;var a=i[o].createModified({state:"Deleted",sourceType:"Default",clearWeight:!0,clearSourceAgent:!0,updateLastModified:!0});return i.splice(o,1,a),_.every(i,function(s){return"Deleted"===s.state})&&(t.state="Deleted"),_.every(r.phrasings,function(s){return"Deleted"===s.state})&&(r.state="Deleted"),!0}function bn(i){return _.some(i,function(e){return"Deleted"!==e.state})}function pn(i,e){return _.map(i,function(t){var r=ot.createAuthoredTerm(t);return _.find(e,function(a){return a.areValuesEqual(r)})??r})}var er=function(){function i(e,t,r,o,a){void 0===a&&(a=!1),this.target=e,this.aggregation=t,this.operator=r,this.value=o,g.fF.assertValue(e,"LsdlConditionModel target"),g.fF.assertValue(r,"LsdlConditionModel operator"),g.fF.assertAnyValue(o,"LsdlConditionModel value"),this.isDirty=a}return i.prototype.shouldCommit=function(){return this.isDirty},i.prototype.resetCommitState=function(){this.isDirty=!1},i.prototype.clone=function(){return new i((0,C.pi)({},this.target),this.aggregation,this.operator,(0,C.pi)({},this.value))},i}(),tr=function(){function i(e,t){this.lsdlName=e,this.entityName=t,g.fF.assertValue(e,"LsdlRoleModel lsdlName"),g.fF.assertValue(t,"LsdlRoleModel entityName")}return i.prototype.shouldCommit=function(){return this.isDirty},i.prototype.resetCommitState=function(){this.isDirty=!1},i.prototype.clone=function(){return new i(this.lsdlName,this.entityName)},i}(),mi=function(){function i(e,t,r,o,a){void 0===a&&(a=!1),this.where=e,this.when=t,this.duration=r,this.occurrences=o,this.isDirty=!1,this.isDirty=a}return i.prototype.shouldCommit=function(){return this.isDirty},i.prototype.resetCommitState=function(){this.isDirty=!1},i.prototype.clone=function(){return new i(this.where?(0,C.pi)({},this.where):void 0,this.when?(0,C.pi)({},this.when):void 0,this.duration?(0,C.pi)({},this.duration):void 0,this.occurrences?(0,C.pi)({},this.occurrences):void 0)},i}(),Qt={Type:"User"},nr=function(){function i(e,t,r,o,a,s,u,c,l,d){void 0===l&&(l=!1),this.lsdlName=e,this.tableName=t,this.relationshipPhrasings=r,this.relationshipConditions=o,this.relationshipRoles=a,this.relationshipSemanticSlots=s,this.relationshipLastModified=u,this.relationshipState=c,this.basedOnLsdlName=d,g.fF.assertValue(e,"LsdlRelationshipModel lsdlName"),null==this.relationshipPhrasings&&(this.relationshipPhrasings=[]),null==this.relationshipConditions&&(this.relationshipConditions=[]),null==this.relationshipRoles&&(this.relationshipRoles=[]),null==this.relationshipSemanticSlots&&(this.relationshipSemanticSlots=new mi),null==this.relationshipState&&(this.relationshipState="Authored"),this.isDirty=l}return Object.defineProperty(i.prototype,"table",{get:function(){return this.tableName},set:function(t){this.tableName=t,this.setRelationshipUpdated()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"phrasings",{get:function(){return this.relationshipPhrasings},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"condition",{get:function(){return this.relationshipConditions[0]},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"roles",{get:function(){return this.relationshipRoles},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"semanticSlots",{get:function(){return this.relationshipSemanticSlots},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lastModified",{get:function(){return this.relationshipLastModified},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"state",{get:function(){return this.relationshipState},set:function(t){this.relationshipState=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"basedOn",{get:function(){return this.basedOnLsdlName},enumerable:!1,configurable:!0}),i.prototype.setRelationshipUpdated=function(){this.isDirty=!0,this.relationshipLastModified=(0,ct.uL)(),"Deleted"!==this.relationshipState&&(this.relationshipState="Authored")},i.prototype.markDirtyForForceSave=function(){this.isDirty=!0},i.prototype.addAdjectivePhrasing=function(e,t,r,o,a){this.ensureRole(e),null!=t&&this.ensureRole(t);var s=ot.createAuthoredTerms(r),u=ot.createAuthoredTerms(o),c=new ui(e,s,u,t,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,a,!0);this.relationshipPhrasings.push(c),this.setRelationshipUpdated()},i.prototype.addDynamicAdjectivePhrasing=function(e,t,r){this.ensureRole(e),this.ensureRole(t);var o=new li(e,t,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,r,!0);this.relationshipPhrasings.push(o),this.setRelationshipUpdated()},i.prototype.addNounPhrasing=function(e,t,r){this.ensureRole(e);var o=ot.createAuthoredTerms(t),a=new ci(e,o,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,r,!0);this.relationshipPhrasings.push(a),this.setRelationshipUpdated()},i.prototype.addDynamicNounPhrasing=function(e,t,r){this.ensureRole(e),this.ensureRole(t);var o=new di(e,t,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,r,!0);this.relationshipPhrasings.push(o),this.setRelationshipUpdated()},i.prototype.addVerbPhrasing=function(e,t,r,o,a){var s=ot.createAuthoredTerms(e);null!=t&&this.ensureRole(t),null!=o&&this.ensureRole(o),null!=r&&this.ensureRole(r);var u=new pi(t,s,r,o,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,a,!0);this.relationshipPhrasings.push(u),this.setRelationshipUpdated()},i.prototype.addPrepositionPhrasing=function(e,t,r,o){this.ensureRole(e),this.ensureRole(r);var a=ot.createAuthoredTerms(t),s=new gi(e,a,r,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,o,!0);this.relationshipPhrasings.push(s),this.setRelationshipUpdated()},i.prototype.addAttributePhrasing=function(e,t,r){this.ensureRole(e),this.ensureRole(t);var o=new hi(e,t,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,r,!0);this.relationshipPhrasings.push(o),this.setRelationshipUpdated()},i.prototype.addNamePhrasing=function(e,t,r){this.ensureRole(e),this.ensureRole(t);var o=new fi(e,t,void 0,(0,ct.uL)(),void 0,"Authored",Qt,this,r,!0);this.relationshipPhrasings.push(o),this.setRelationshipUpdated()},i.prototype.deletePhrasing=function(e){g.fF.assertValue(e,"lsdlRelationshipModel deletePhrasing"),_.findIndex(this.relationshipPhrasings,e)>=0&&(e.state="Deleted",this.setRelationshipUpdated()),_.every(this.relationshipPhrasings,function(r){return"Deleted"===r.state})&&(this.state="Deleted")},i.prototype.hasPhrasings=function(){return _.some(this.relationshipPhrasings,function(e){return"Deleted"!==e.state})},i.prototype.updateCondition=function(e,t,r,o){this.ensureRole(e),this.relationshipConditions=[new er(e,t,r,o,!0)],this.setRelationshipUpdated()},i.prototype.deleteCondition=function(){this.relationshipConditions=[],this.setRelationshipUpdated()},i.prototype.updateSemanticSlots=function(e){null!=e.where&&this.ensureRole(e.where),null!=e.when&&this.ensureRole(e.when),null!=e.duration&&this.ensureRole(e.duration),null!=e.occurrences&&this.ensureRole(e.occurrences),this.relationshipSemanticSlots=new mi(e.where,e.when,e.duration,e.occurrences),this.setRelationshipUpdated()},i.prototype.shouldCommit=function(){return this.isDirty||this.relationshipSemanticSlots.shouldCommit()||_.some(this.relationshipPhrasings,function(e){return e.shouldCommit()})||_.some(this.relationshipRoles,function(e){return e.shouldCommit()})||_.some(this.relationshipConditions,function(e){return e.shouldCommit()})},i.prototype.resetCommitState=function(){this.isDirty=!1,this.relationshipSemanticSlots.resetCommitState(),_.forEach(this.relationshipPhrasings,function(e){return e.resetCommitState()}),_.forEach(this.relationshipRoles,function(e){return e.resetCommitState()}),_.forEach(this.relationshipConditions,function(e){return e.resetCommitState()})},i.prototype.hasSemanticSlots=function(){return null!=this.relationshipSemanticSlots},i.prototype.ensureRole=function(e){if(null==e.role){var r=_.find(this.relationshipRoles,function(s){return s.entityName===e.entity});if(null!=r)e.role=r.lsdlName;else{var o={};_.forEach(this.relationshipRoles,function(s){return o[s.lsdlName]=!0});var a=(0,Fe.zE)(o,e.entity);e.role=a,this.relationshipRoles.push(new tr(e.role,e.entity))}}else null==_.find(this.relationshipRoles,function(s){return s.lsdlName===e.role})&&g.fF.assertFail("Unknown role mapping")},i.prototype.clone=function(e){var t=new i(this.lsdlName,this.tableName,[],_.map(this.relationshipConditions,function(r){return r.clone()}),_.map(this.relationshipRoles,function(r){return r.clone()}),this.relationshipSemanticSlots.clone(),this.relationshipLastModified,this.relationshipState);return _.forEach(this.relationshipPhrasings,function(r){r.equalsToPhrasingReferenceModel(e)&&t.relationshipPhrasings.push(r.clone(t))}),t},i}();function vi(i){return!!i.Binding}function ir(i){return!!i.HierarchyLevel}function rr(i){return!!i.ConceptualProperty}function or(i){return!(!i.VariationSet&&!i.VariationSource)}function ar(i){return!!i.Noun}function sr(i){return!!i.Adjective}function ur(i){return!!i.DynamicAdjective}function lr(i){return!!i.DynamicNoun}function cr(i){return!!i.Verb}function dr(i){return!!i.Preposition}function pr(i){return!!i.Attribute}function Ci(i,e){g.fF.assertValue(i,"name"),g.fF.assert(function(){return function(i){if(0===_.size(i)||!zn(i[0],!0))return!1;for(var e=1;e<_.size(i);e++)if(!zn(i[e],!1))return!1;return!0}(e)},"fallbackName is not CLS compliant");for(var t="",r=0,o=i;r<o.length;r++){var a=o[r],s=_.size(t);s>0&&(vs(a)||"."===a||"/"===a)?t+="_":zn(a,0===s)?t+=a:0===s&&zn(a,!1)&&(t=t+e+a)}return _.size(t)>0?t:e}function zn(i,e){g.fF.assert(function(){return 1===_.size(i)},"char is supposed to be 1 character");var t=i.match(/(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7D0\uA7D6\uA7D8\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])|(?:[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0560-\u0588\u10D0-\u10FA\u10FD-\u10FF\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5F\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7AF\uA7B5\uA7B7\uA7B9\uA7BB\uA7BD\uA7BF\uA7C1\uA7C3\uA7C8\uA7CA\uA7D1\uA7D3\uA7D5\uA7D7\uA7D9\uA7F6\uA7FA\uAB30-\uAB5A\uAB60-\uAB68\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD81B[\uDE60-\uDE7F]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD837[\uDF00-\uDF09\uDF0B-\uDF1E\uDF25-\uDF2A]|\uD83A[\uDD22-\uDD43])|[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]|(?:[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5\u06E6\u07F4\u07F5\u07FA\u081A\u0824\u0828\u08C9\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C\uA69D\uA717-\uA71F\uA770\uA788\uA7F2-\uA7F4\uA7F8\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3\uAAF4\uAB5C-\uAB5F\uAB69\uFF70\uFF9E\uFF9F]|\uD801[\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD81A[\uDF40-\uDF43]|\uD81B[\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD838[\uDC30-\uDC6D\uDD37-\uDD3D]|\uD839\uDCEB|\uD83A\uDD4B)|(?:[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05EF-\u05F2\u0620-\u063F\u0641-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C8\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E45\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC50-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF4A\uDF50]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD837\uDF0A|\uD838[\uDD00-\uDD2C\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]|\uD800[\uDD40-\uDD74\uDF41\uDF4A\uDFD1-\uDFD5]|\uD809[\uDC00-\uDC6E])/g);if(1===_.size(t))return!0;if(e)return!1;var r=i.match(/(?:[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDEAB\uDEAC\uDEFD-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC01\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC81\uDCB3-\uDCB6\uDCB9\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD2B\uDD2D-\uDD34\uDD73\uDD80\uDD81\uDDB6-\uDDBE\uDDC9-\uDDCC\uDDCF\uDE2F-\uDE31\uDE34\uDE36\uDE37\uDE3E\uDE41\uDEDF\uDEE3-\uDEEA\uDF00\uDF01\uDF3B\uDF3C\uDF40\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC38-\uDC3F\uDC42-\uDC44\uDC46\uDC5E\uDCB3-\uDCB8\uDCBA\uDCBF\uDCC0\uDCC2\uDCC3\uDDB2-\uDDB5\uDDBC\uDDBD\uDDBF\uDDC0\uDDDC\uDDDD\uDE33-\uDE3A\uDE3D\uDE3F\uDE40\uDEAB\uDEAD\uDEB0-\uDEB5\uDEB7\uDF1D-\uDF1F\uDF22-\uDF25\uDF27-\uDF2B]|\uD806[\uDC2F-\uDC37\uDC39\uDC3A\uDD3B\uDD3C\uDD3E\uDD43\uDDD4-\uDDD7\uDDDA\uDDDB\uDDE0\uDE01-\uDE0A\uDE33-\uDE38\uDE3B-\uDE3E\uDE47\uDE51-\uDE56\uDE59-\uDE5B\uDE8A-\uDE96\uDE98\uDE99]|\uD807[\uDC30-\uDC36\uDC38-\uDC3D\uDC3F\uDC92-\uDCA7\uDCAA-\uDCB0\uDCB2\uDCB3\uDCB5\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD90\uDD91\uDD95\uDD97\uDEF3\uDEF4\uDF00\uDF01\uDF36-\uDF3A\uDF40\uDF42]|\uD80D[\uDC40\uDC47-\uDC55]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF8F-\uDF92\uDFE4]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD67-\uDD69\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF])|(?:[\u0903\u093B\u093E-\u0940\u0949-\u094C\u094E\u094F\u0982\u0983\u09BE-\u09C0\u09C7\u09C8\u09CB\u09CC\u09D7\u0A03\u0A3E-\u0A40\u0A83\u0ABE-\u0AC0\u0AC9\u0ACB\u0ACC\u0B02\u0B03\u0B3E\u0B40\u0B47\u0B48\u0B4B\u0B4C\u0B57\u0BBE\u0BBF\u0BC1\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD7\u0C01-\u0C03\u0C41-\u0C44\u0C82\u0C83\u0CBE\u0CC0-\u0CC4\u0CC7\u0CC8\u0CCA\u0CCB\u0CD5\u0CD6\u0CF3\u0D02\u0D03\u0D3E-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D57\u0D82\u0D83\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DF2\u0DF3\u0F3E\u0F3F\u0F7F\u102B\u102C\u1031\u1038\u103B\u103C\u1056\u1057\u1062-\u1064\u1067-\u106D\u1083\u1084\u1087-\u108C\u108F\u109A-\u109C\u1715\u1734\u17B6\u17BE-\u17C5\u17C7\u17C8\u1923-\u1926\u1929-\u192B\u1930\u1931\u1933-\u1938\u1A19\u1A1A\u1A55\u1A57\u1A61\u1A63\u1A64\u1A6D-\u1A72\u1B04\u1B35\u1B3B\u1B3D-\u1B41\u1B43\u1B44\u1B82\u1BA1\u1BA6\u1BA7\u1BAA\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2\u1BF3\u1C24-\u1C2B\u1C34\u1C35\u1CE1\u1CF7\u302E\u302F\uA823\uA824\uA827\uA880\uA881\uA8B4-\uA8C3\uA952\uA953\uA983\uA9B4\uA9B5\uA9BA\uA9BB\uA9BE-\uA9C0\uAA2F\uAA30\uAA33\uAA34\uAA4D\uAA7B\uAA7D\uAAEB\uAAEE\uAAEF\uAAF5\uABE3\uABE4\uABE6\uABE7\uABE9\uABEA\uABEC]|\uD804[\uDC00\uDC02\uDC82\uDCB0-\uDCB2\uDCB7\uDCB8\uDD2C\uDD45\uDD46\uDD82\uDDB3-\uDDB5\uDDBF\uDDC0\uDDCE\uDE2C-\uDE2E\uDE32\uDE33\uDE35\uDEE0-\uDEE2\uDF02\uDF03\uDF3E\uDF3F\uDF41-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63]|\uD805[\uDC35-\uDC37\uDC40\uDC41\uDC45\uDCB0-\uDCB2\uDCB9\uDCBB-\uDCBE\uDCC1\uDDAF-\uDDB1\uDDB8-\uDDBB\uDDBE\uDE30-\uDE32\uDE3B\uDE3C\uDE3E\uDEAC\uDEAE\uDEAF\uDEB6\uDF20\uDF21\uDF26]|\uD806[\uDC2C-\uDC2E\uDC38\uDD30-\uDD35\uDD37\uDD38\uDD3D\uDD40\uDD42\uDDD1-\uDDD3\uDDDC-\uDDDF\uDDE4\uDE39\uDE57\uDE58\uDE97]|\uD807[\uDC2F\uDC3E\uDCA9\uDCB1\uDCB4\uDD8A-\uDD8E\uDD93\uDD94\uDD96\uDEF5\uDEF6\uDF03\uDF34\uDF35\uDF3E\uDF3F\uDF41]|\uD81B[\uDF51-\uDF87\uDFF0\uDFF1]|\uD834[\uDD65\uDD66\uDD6D-\uDD72])|(?:[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD801[\uDCA0-\uDCA9]|\uD803[\uDD30-\uDD39]|\uD804[\uDC66-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDEF0-\uDEF9]|\uD805[\uDC50-\uDC59\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9\uDF30-\uDF39]|\uD806[\uDCE0-\uDCE9\uDD50-\uDD59]|\uD807[\uDC50-\uDC59\uDD50-\uDD59\uDDA0-\uDDA9\uDF50-\uDF59]|\uD81A[\uDE60-\uDE69\uDEC0-\uDEC9\uDF50-\uDF59]|\uD835[\uDFCE-\uDFFF]|\uD838[\uDD40-\uDD49\uDEF0-\uDEF9]|\uD839[\uDCF0-\uDCF9]|\uD83A[\uDD50-\uDD59]|\uD83E[\uDFF0-\uDFF9])|[_\u203F\u2040\u2054\uFE33\uFE34\uFE4D-\uFE4F\uFF3F]|(?:[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F])/g);return 1===_.size(r)}function vs(i){g.fF.assert(function(){return 1===_.size(i)},"char is supposed to be 1 character");var e=i.match(/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]|\u2028|\u2029/g);return 1===_.size(e)}function Cs(i,e){return g.fF.assertValue(i,"binding"),g.fF.assertValue(e,"visitor"),function(i){return!!i.Hierarchy&&!ir(i)}(i)?e.visitHierarchy(i):ir(i)?e.visitHierarchyLevel(i):rr(i)?or(i)?void g.fF.assertFail("conceptual property with variation"):e.visitProperty(i):e.visitEntity(i)}function gr(i,e){return g.fF.assertValue(i,"phrasingModel"),g.fF.assertValue(e,"visitor"),i instanceof ui?e.visitAdjectivePhrasing(i):i instanceof ci?e.visitNounPhrasing(i):i instanceof pi?e.visitVerbPhrasing(i):i instanceof gi?e.visitPrepositionPhrasing(i):i instanceof li?e.visitDynamicAdjectivePhrasing(i):i instanceof di?e.visitDynamicNounPhrasing(i):i instanceof hi?e.visitAttributePhrasing(i):i instanceof fi?e.visitNamePhrasing(i):void g.fF.assertFail("Unknown phrasing modeltype")}function It(i,e){var t,r;_.isEmpty(i)&&(i=[]);for(var o={},a=0,s=i;a<s.length;a++){var u=s[a],c=Object.keys(u)[0],l=u[c];o[d=ot.getUniqueKey(c)]||(o[d]={value:c,properties:l})}var f=[];if(!_.isEmpty(e))for(var v=0,F=e;v<F.length;v++){var I=F[v],T={};if(o[d=ot.getUniqueKey(I.value)]){if("Deleted"!==o[d].properties.State)T=o[d].properties;else if("Authored"!==I.state)continue;delete o[d]}T.State=I.state,T.Source={Type:I.sourceType},null!=I.sourceAgent?T.Source.Agent=I.sourceAgent:delete T.Source.Agent,null!=I.type?T.Type=I.type:delete T.Type,null!=I.weight?T.Weight=I.weight:delete T.Weight,null!=I.lastModified?T.LastModified=I.lastModified:delete T.LastModified,f.push(((t={})[I.value]=T,t))}for(var d in o)"Deleted"===(l=o[d].properties).State&&f.push(((r={})[o[d].value]=l,r));return _.isEmpty(f)?void 0:f}var Ps=function(){function i(){}return i.prototype.visitEntity=function(e){return{Definition:{Binding:{ConceptualEntity:e.tableName}},State:e.state,Visibility:{Value:e.visibility,State:e.visibilityState}}},i.prototype.visitProperty=function(e){return{Definition:{Binding:{ConceptualEntity:e.tableName,ConceptualProperty:e.propertyName}},State:e.state,Visibility:{Value:e.visibility,State:e.visibilityState}}},i.prototype.visitHierarchy=function(e){g.fF.assertFail("not implemented")},i.prototype.visitHierarchyLevel=function(e){g.fF.assertFail("not implemented")},i}();function As(i,e){var t=(0,C.pi)({},i||{});return null==i&&(t={}),e.where?t.Where=we(e.where):delete t.Where,e.when?t.When=we(e.when):delete t.When,e.duration?t.Duration=we(e.duration):delete t.Duration,e.occurrences?t.Occurrences=we(e.occurrences):delete t.Occurrences,_.isEmpty(t)&&(t=void 0),t}function Fs(i,e){if(null!=e){var t=i?.[0];return[t=(0,C.pi)((0,C.pi)({},t||{}),{Target:we(e.target),Aggregation:e.aggregation,Operator:e.operator,Value:e.value})]}}function bs(i,e){var t={};return _.forEach(e,function(r){var o=i?.[r.lsdlName];t[r.lsdlName]=null!=o?o:{Target:{Entity:r.entityName}}}),_.isEmpty(t)?void 0:t}function Is(i,e){var t=[];return _.isEmpty(i)?_.forEach(e,function(r){var o=new hr;t.push(gr(r,o))}):_.forEach(e,function(r){var o=_.find(i,function(s){return r.equalsToPhrasingReference(s)});if(null!=o){var a=new hr(o);t.push((0,C.pi)({TemplateSchema:o.TemplateSchema,Weight:o.Weight},gr(r,a)))}}),_.isEmpty(t)?void 0:t}function Xt(i,e){var t=[];return _.forEach(e,function(r){var o=_.find(i,function(a){return r.equalsToPrepPhraseReference(a)});null==o?t.push({Prepositions:It(void 0,r.prepositions),Object:we(r.objectEntity)}):(o.Prepositions=It(o.Prepositions,r.prepositions),o.Object=we(r.objectEntity),t.push(o))}),_.isEmpty(t)?void 0:t}var hr=function(){function i(e){this.lsdlPhrasing=_.cloneDeep(e)}return i.prototype.visitAdjectivePhrasing=function(e){var t;return null!=this.lsdlPhrasing&&sr(this.lsdlPhrasing)&&(t=this.lsdlPhrasing.Adjective),(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{Adjective:{Subject:we(e.subject),Adjectives:It(t?.Adjectives,e.adjectives),Antonyms:It(t?.Antonyms,e.antonyms),Measurement:we(e.measurement),AdverbPhrases:t?.AdverbPhrases,PrepositionalPhrases:Xt(t?.PrepositionalPhrases,e.prepositionalPhrases)}})},i.prototype.visitNounPhrasing=function(e){var t;return this.lsdlPhrasing&&ar(this.lsdlPhrasing)&&(t=this.lsdlPhrasing.Noun),(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{Noun:{Subject:we(e.subject),Nouns:It(t?.Nouns,e.nouns),PrepositionalPhrases:Xt(t?.PrepositionalPhrases,e.prepositionalPhrases)}})},i.prototype.visitVerbPhrasing=function(e){var t;return this.lsdlPhrasing&&cr(this.lsdlPhrasing)&&(t=this.lsdlPhrasing.Verb),(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{Verb:{Subject:we(e.subject),Verbs:It(t?.Verbs,e.verbs),IndirectObject:we(e.indirectObject),Object:we(e.directObject),AdverbPhrases:t?.AdverbPhrases,PrepositionalPhrases:Xt(t?.PrepositionalPhrases,e.prepositionalPhrases)}})},i.prototype.visitPrepositionPhrasing=function(e){var t;return this.lsdlPhrasing&&dr(this.lsdlPhrasing)&&(t=this.lsdlPhrasing.Preposition),(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{Preposition:{Subject:we(e.subject),Prepositions:It(t?.Prepositions,e.prepositions),Object:we(e.object),PrepositionalPhrases:Xt(t?.PrepositionalPhrases,e.prepositionalPhrases)}})},i.prototype.visitDynamicAdjectivePhrasing=function(e){var t;return this.lsdlPhrasing&&ur(this.lsdlPhrasing)&&(t=this.lsdlPhrasing.DynamicAdjective),(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{DynamicAdjective:{Subject:we(e.subject),Adjective:we(e.adjective),PrepositionalPhrases:Xt(t?.PrepositionalPhrases,e.prepositionalPhrases)}})},i.prototype.visitDynamicNounPhrasing=function(e){var t;return this.lsdlPhrasing&&lr(this.lsdlPhrasing)&&(t=this.lsdlPhrasing.DynamicNoun),(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{DynamicNoun:{Subject:we(e.subject),Noun:we(e.noun),PrepositionalPhrases:Xt(t?.PrepositionalPhrases,e.prepositionalPhrases)}})},i.prototype.visitAttributePhrasing=function(e){var t;return this.lsdlPhrasing&&pr(this.lsdlPhrasing)&&(t=this.lsdlPhrasing.Attribute),(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{Attribute:{Subject:we(e.subject),Object:we(e.object),PrepositionalPhrases:Xt(t?.PrepositionalPhrases,e.prepositionalPhrases)}})},i.prototype.visitNamePhrasing=function(e){return(0,C.pi)((0,C.pi)({},this.getCommonLsdlPhrasingProperties(e)),{Name:{Subject:we(e.subject),Name:we(e.name)}})},i.prototype.getCommonLsdlPhrasingProperties=function(e){return{ID:e.ID,LastModified:e.lastModified,State:e.state,Source:e.source}},i}();function we(i){return null!=i?{Role:i.role}:void 0}var Bs=function(){function i(e,t){this.lsdlEntityName=e,this.state=t.State,this.terms=this.getTermsForLsdlEntity(t);var r=t.Visibility;null!=r&&(this.visibility=r.Value,this.visibilityState=r.State)}return i.prototype.visitEntity=function(e){return new cs(e.ConceptualEntity,this.lsdlEntityName,this.state,this.terms,this.visibility,this.visibilityState)},i.prototype.visitProperty=function(e){return new Xi(e.ConceptualEntity,e.ConceptualProperty,this.lsdlEntityName,this.state,this.terms,this.visibility,this.visibilityState)},i.prototype.visitHierarchy=function(e){return new ds(e.ConceptualEntity,e.Hierarchy,e.VariationSet,e.VariationSource,this.lsdlEntityName,this.state,this.terms,this.visibility,this.visibilityState)},i.prototype.visitHierarchyLevel=function(e){return new ps(e.ConceptualEntity,e.Hierarchy,e.HierarchyLevel,e.VariationSet,e.VariationSource,this.lsdlEntityName,this.state,this.terms,this.visibility,this.visibilityState)},i.prototype.getTermsForLsdlEntity=function(e){var t=e.Terms;if(!_.isEmpty(t)){for(var r={},o=[],a=0,s=t;a<s.length;a++){var c=fr(s[a]);if("Deleted"!==c.state){var l=ot.getUniqueKey(c.value);r[l]||(r[l]=c,o.push(c))}}return o}},i}(),Os=function(){function i(e,t,r){this.roles=t,this.parentRelationship=r,this.state=e.State,this.source=e.Source}return i.prototype.visitAdjectivePhrasing=function(e){var t=e.Adjective,r=[];(function(i){return!!i.Adjectives})(t)&&(r=gn(t.Adjectives));var o=gn(t.Antonyms),a=this.createPrepPhrases(t.PrepositionalPhrases);return new ui(Te(this.roles,t.Subject),r,o,Te(this.roles,t.Measurement),a,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.visitNounPhrasing=function(e){var t=e.Noun,r=gn(t.Nouns),o=this.createPrepPhrases(t.PrepositionalPhrases);return new ci(Te(this.roles,t.Subject),r,o,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.visitVerbPhrasing=function(e){var t=e.Verb,r=gn(t.Verbs),o=this.createPrepPhrases(t.PrepositionalPhrases);return new pi(Te(this.roles,t.Subject),r,Te(this.roles,t.IndirectObject),Te(this.roles,t.Object),o,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.visitPrepositionPhrasing=function(e){var t=e.Preposition,r=gn(t.Prepositions),o=this.createPrepPhrases(t.PrepositionalPhrases);return new gi(Te(this.roles,t.Subject),r,Te(this.roles,t.Object),o,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.visitDynamicAdjectivePhrasing=function(e){var t=e.DynamicAdjective,r=this.createPrepPhrases(t.PrepositionalPhrases);return new li(Te(this.roles,t.Subject),Te(this.roles,t.Adjective),r,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.visitDynamicNounPhrasing=function(e){var t=e.DynamicNoun,r=this.createPrepPhrases(t.PrepositionalPhrases);return new di(Te(this.roles,t.Subject),Te(this.roles,t.Noun),r,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.visitAttributePhrasing=function(e){var t=e.Attribute,r=this.createPrepPhrases(t.PrepositionalPhrases);return new hi(Te(this.roles,t.Subject),Te(this.roles,t.Object),r,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.visitNamePhrasing=function(e){var t=e.Name;return new fi(Te(this.roles,t.Subject),Te(this.roles,t.Name),void 0,e.LastModified,e.ID,this.state,this.source,this.parentRelationship,e)},i.prototype.createPrepPhrases=function(e){var t=this,r=[];return _.isEmpty(e)||e.forEach(function(o){var a=gn(o.Prepositions);r.push(new Yi(a,Te(t.roles,o.Object),o))}),r},i}();function fr(i){var e=Object.keys(i)[0],t=i[e],r=t.Source;return new ot(e,t.State,t.Weight,r?.Type,r?.Agent,t.Type,t.LastModified)}function gn(i){return _.map(i,function(e){return fr(e)})}function Te(i,e){if(null!=e){var t=i[e.Role];if(null!=t)return{role:e.Role,entity:t.Target.Entity}}}var hn=function(){function i(e){var t;g.fF.assertValue(e,"linguisticSchema"),this.document=e,this.existingEntityNames={},this.existingRelationshipNames={},this.ensureAgentModels(),this.runtimeUnderstanding=null===(t=this.document.DynamicImprovement)||void 0===t?void 0:t.RuntimeUnderstanding}return i.prototype.toJsonString=function(){return JSON.stringify(this.document)},i.prototype.getEntities=function(){return this.ensureEntityModels(),g.fF.assertValue(this.entityModels,"entityModels"),this.entityModels},i.prototype.getEntityForTable=function(e){return g.fF.assertValue(e,"tableName"),this.ensureEntityModels(),_.find(this.entityModels,function(t){return dt.isConceptualEntityModel(t)&&t.tableName===e})},i.prototype.getEntityForProperty=function(e,t){return g.fF.assertValue(e,"tableName"),g.fF.assertValue(t,"propertyName"),this.ensureEntityModels(),_.find(this.entityModels,function(r){return dt.isConceptualPropertyModel(r)&&r.tableName===e&&r.propertyName===t})},i.prototype.getEntityForHierarchy=function(e,t,r,o){return g.fF.assertValue(e,"tableName"),g.fF.assertValue(t,"hierarchy"),this.ensureEntityModels(),_.find(this.entityModels,function(a){return dt.isConceptualHierarchyModel(a)&&a.tableName===e&&a.hierarchy===t&&a.variationSet===r&&a.variationSource===o})},i.prototype.getEntityForHierarchyLevel=function(e,t,r,o,a){return g.fF.assertValue(e,"tableName"),g.fF.assertValue(t,"hierarchy"),g.fF.assertValue(r,"hierarchyLevel"),this.ensureEntityModels(),_.find(this.entityModels,function(s){return dt.isConceptualHierarchyLevelModel(s)&&s.tableName===e&&s.hierarchy===t&&s.variationSet===o&&s.variationSource===a&&s.hierarchyLevel===r})},i.prototype.getEntityWithEntityKey=function(e){return g.fF.assertValue(e,"entity key"),_.find(this.entityModels,function(t){return t.lsdlName===e})},i.prototype.getEntityWithRoleReference=function(e,t){var r=_.find(e,function(o){return o.lsdlName===t});if(r)return _.find(this.entityModels,function(o){return r.entityName===o.lsdlName})},i.prototype.getRelationships=function(){return this.ensureRelationshipModels(),g.fF.assertValue(this.relationshipModels,"relationshipModels"),this.relationshipModels},i.prototype.getRelationshipWithRelationshipKey=function(e){return g.fF.assertValue(e,"relationship key"),_.find(this.relationshipModels,function(t){return t.lsdlName===e})},i.prototype.getAgents=function(e){return g.fF.assertValue(this.agentModels,"agentModels"),"oaiPhrasings"===e?_.filter(this.agentModels,function(t){return"PowerBI.AzureOpenAIPhrasings"===t.name}):"allSynonyms"===e?_.filter(this.agentModels,function(t){return"PowerBI.AzureOpenAIPhrasings"!==t.name}):"externalSynonyms"===e?_.filter(this.agentModels,function(t){return"PowerBI.AzureOpenAISynonyms"===t.name||"PowerBI.OrganizationLsdlSharing"===t.name}):void g.fF.assertFail("Incorrect agent category")},i.prototype.setAgents=function(e){g.fF.assertValue(e,"agentModels"),_.forEach(e,function(t){return t.markDirty()}),this.agentModels=e},i.prototype.getRuntimeUnderstanding=function(){return this.runtimeUnderstanding},i.prototype.setRuntimeUnderstanding=function(e){this.runtimeUnderstanding=e??void 0},i.prototype.addEntity=function(e,t){if(g.fF.assertValue(e,"tableName"),g.fF.assertValue(t,"propertyName"),this.ensureEntityModels(),!_.find(this.document.Entities,function(a){return"Deleted"===a.State&&null!=a.Definition&&vi(a.Definition)&&rr(a.Definition.Binding)&&!or(a.Definition.Binding)&&a.Definition.Binding.ConceptualEntity===e&&a.Definition.Binding.ConceptualProperty===t})){var r=this.getUniqueEntityName(e,t),o=new Xi(e,t,r,"Generated",void 0,void 0,void 0,!0);return this.entityModels.push(o),o}},i.prototype.addRelationship=function(e,t){void 0===t&&(t=void 0),g.fF.assertValue(e,"relationshipModel"),this.ensureRelationshipModels();var r=_.isEmpty(t)?e.lsdlName:t,o=this.getUniqueRelationshipName(r);return this.relationshipModels.push(this.mutateRelationshipWith(e,{lsdlName:o})),o},i.prototype.updateRelationship=function(e,t,r){void 0===r&&(r=void 0),this.ensureRelationshipModels();var o=_.some(t.phrasings,function(d){return _.some(e.phrasings,function(f){return f.equalsToPhrasingReferenceModel(d)&&Di(f)})}),a=_.size(e.phrasings)>1||o,s=_.isEmpty(r)?t.lsdlName:r,u=a?this.getUniqueRelationshipName(s):e.lsdlName,c=this.mutateRelationshipWith(t,{lsdlName:u,basedOn:e.lsdlName});c.setRelationshipUpdated(),_.forEach(c.phrasings,function(d){return d.setPhrasingUpdated()});var l=_.indexOf(this.relationshipModels,e);return this.relationshipModels.splice(l,a?0:1,c),a&&_.forEach(t.phrasings,function(d){_.remove(e.phrasings,function(f){return f.equalsToPhrasingReferenceModel(d)&&!Di(f)}),_.forEach(e.phrasings,function(f){f.equalsToPhrasingReferenceModel(d)&&Di(f)&&e.deletePhrasing(f)})}),u},i.prototype.commit=function(){var e,t=!1;return this.runtimeUnderstanding!==(null===(e=this.document.DynamicImprovement)||void 0===e?void 0:e.RuntimeUnderstanding)&&(null==this.document.DynamicImprovement&&(this.document.DynamicImprovement={}),this.document.DynamicImprovement=(0,C.pi)((0,C.pi)({},this.document.DynamicImprovement),{RuntimeUnderstanding:this.runtimeUnderstanding}),t=!0),_.some(this.entityModels,function(r){return r.shouldCommit()})&&(function(i,e){if(!_.isEmpty(e))for(var t=function(u){var c=_.find(i.Entities,function(f,v){if(vi(f.Definition)){var F=f.Definition.Binding;if(F&&F.ConceptualEntity)return v===u.lsdlName}});if(c)c.State=u.state,c.Visibility={Value:u.visibility,State:u.visibilityState},c.Terms=It(c.Terms,u.terms);else{i.Entities=i.Entities||{};var l=new Ps,d=function(i,e){return g.fF.assertValue(i,"model"),g.fF.assertValue(e,"visitor"),dt.isConceptualHierarchyLevelModel(i)?e.visitHierarchyLevel(i):dt.isConceptualHierarchyModel(i)?e.visitHierarchy(i):dt.isConceptualPropertyModel(i)?e.visitProperty(i):dt.isConceptualEntityModel(i)?e.visitEntity(i):void g.fF.assertFail("unknown entity model")}(u,l);d&&(d.Terms=It(d.Terms,u.terms),i.Entities[u.lsdlName]=d)}u.resetCommitState()},r=0,o=e;r<o.length;r++)t(o[r])}(this.document,this.entityModels),t=!0),_.some(this.relationshipModels,function(r){return r.shouldCommit()})&&(function(i,e){var t;if(!_.isEmpty(e))for(var r=0,o=e;r<o.length;r++){var a=o[r],s=null!==(t=a.basedOn)&&void 0!==t?t:a.lsdlName;null==i.Relationships[s]&&(i.Relationships[s]={});var u=i.Relationships[s];i.Relationships[a.lsdlName]=(0,C.pi)((0,C.pi)({},u),{Binding:null!=a.table?{ConceptualEntity:a.table}:void 0,State:a.state,LastModified:a.lastModified,SemanticSlots:As(u.SemanticSlots,a.semanticSlots),Conditions:Fs(u.Conditions,a.condition),Roles:bs(u.Roles,a.roles),Phrasings:Is(u.Phrasings,a.phrasings)}),a.resetCommitState()}}(this.document,this.relationshipModels),t=!0),_.some(this.agentModels,function(r){return r.shouldCommit()})&&(function(i,e){if(!_.isEmpty(e)){i.Agents||(i.Agents={});for(var t=0,r=e;t<r.length;t++){var o=r[t];i.Agents[o.name]={LastModified:o.lastModified,State:o.state},o.resetCommitState()}}}(this.document,this.agentModels),t=!0),t},i.prototype.ensureEntityModels=function(){var e=this;this.entityModels||(this.entityModels=function(i){if(_.isEmpty(i))return[];var e=[];for(var t in i){var r=i[t];if("Deleted"!==r.State&&vi(r.Definition)){var o=r.Definition.Binding;if(null!=o?.ConceptualEntity){var s=Cs(o,new Bs(t,r));s&&e.push(s)}}}return e}(this.document.Entities),_.forEach(this.entityModels,function(t){return e.existingEntityNames[t.lsdlName]=!0}))},i.prototype.ensureRelationshipModels=function(){var e=this;this.relationshipModels||(this.relationshipModels=function(i){var e;if(_.isEmpty(i))return[];var t=[],r=function(s){var u=i[s];if("Deleted"===u.State)return"continue";var c=[],l=new nr(s,null===(e=u.Binding)||void 0===e?void 0:e.ConceptualEntity,c,function(i,e){var t=[];if(_.isEmpty(i))return t;for(var r=0,o=i;r<o.length;r++){var a=o[r],s=new er(Te(e,a.Target),a.Aggregation,a.Operator,a.Value);t.push(s)}return t}(u.Conditions,u.Roles),function(i){var e=[];if(_.isEmpty(i))return e;for(var t in i){var o=new tr(t,i[t].Target.Entity);e.push(o)}return e}(u.Roles),function(i,e){if(null!=i)return new mi(Te(e,i.Where),Te(e,i.When),Te(e,i.Duration),Te(e,i.Occurrences))}(u.SemanticSlots,u.Roles),u.LastModified,u.State);_.forEach(u.Phrasings,function(d){if("Deleted"!==d.State){var v=function(i,e){return g.fF.assertValue(i,"phrasing"),g.fF.assertValue(e,"visitor"),sr(i)?e.visitAdjectivePhrasing(i):ar(i)?e.visitNounPhrasing(i):cr(i)?e.visitVerbPhrasing(i):dr(i)?e.visitPrepositionPhrasing(i):ur(i)?e.visitDynamicAdjectivePhrasing(i):lr(i)?e.visitDynamicNounPhrasing(i):pr(i)?e.visitAttributePhrasing(i):function(i){return!!i.Name}(i)?e.visitNamePhrasing(i):void g.fF.assertFail("Unknown phrasing type")}(d,new Os(d,u.Roles,l));v?c.push(v):g.fF.assertFail("Empty phrasing model - Failed to create")}}),t.push(l)};for(var o in i)r(o);return t}(this.document.Relationships),_.forEach(this.relationshipModels,function(t){return e.existingRelationshipNames[t.lsdlName]=!0}))},i.prototype.ensureAgentModels=function(){var e=function(i){var e=[];for(var t in i)e.push(new Zi(t,i[t]));return e}(this.document.Agents),t=(0,C.ev)([],e,!0);_.forEach(["PowerBI.AzureOpenAISynonyms","PowerBI.AzureOpenAIPhrasings","PowerBI.OrganizationLsdlSharing","Thesaurus"],function(o){_.find(t,function(a){return a.name===o})||t.push(new Zi(o,{State:"Enabled"}))}),this.agentModels=t},i.prototype.getUniqueEntityName=function(e,t){var r=Ci(e.toLowerCase(),"table"),o=Ci(t.toLowerCase(),"column"),a="".concat(r,".").concat(o),s=(0,Fe.zE)(this.existingEntityNames,a);return this.existingEntityNames[s]=!0,s},i.prototype.getUniqueRelationshipName=function(e){var t=Ci(e.toLowerCase(),"relationship"),r=(0,Fe.zE)(this.existingRelationshipNames,t);return this.existingRelationshipNames[r]=!0,r},i.prototype.mutateRelationshipWith=function(e,t){var r,o;return new nr(null!==(r=t.lsdlName)&&void 0!==r?r:e.lsdlName,e.table,(0,C.ev)([],e.phrasings,!0),e.condition?[e.condition]:[],(0,C.ev)([],e.roles,!0),e.semanticSlots,e.lastModified,e.state,!0,null!==(o=t.basedOn)&&void 0!==o?o:e.basedOn)},i}();function Di(i){return"Generated"===i.state||"Suggested"===i.state}var Nt=function(){function i(e){this.deferredPromise=e}return i.prototype.signalCompletion=function(){this.deferredPromise.resolve()},i.prototype.getDeferredPromise=function(){return this.deferredPromise.promise},i}();function mr(i,e,t){var r;switch(g.fF.assert(function(){return!_.isEmpty(i)},"lsdlAgents should be defined and non empty"),g.fF.assertValue(e,"localizationService"),g.fF.assertValue(t,"target should be defined"),t){case"Synonyms":var o=_.includes(i,"PowerBI.AzureOpenAISynonyms"),a=_.includes(i,"PowerBI.OrganizationLsdlSharing");g.fF.assert(function(){return o||a},"target: Synonyms should contain AzureOpenAISynonyms or OrganizationLsdlSharing agent or both in the improve lsdl flow"),r=vr(o,a,e);break;case"Phrasings":g.fF.assert(function(){return _.includes(i,"PowerBI.AzureOpenAIPhrasings")},"target: Phrasings should contain AzureOpenAIPhrasings agent in the improve lsdl flow"),r=Cr(e);break;default:g.fF.assertFail("target should be synonyms or phrasings")}return r}function vr(i,e,t){return{emphasis:t.get(i&&e?"Qna_ImproveLsdl_Synonyms_Copilot_Org":i?"Qna_ImproveLsdl_Synonyms_Copilot":"Qna_ImproveLsdl_Synonyms_Org"),text:t.get(i?"Qna_ImproveLsdl_Copilot_Disclaimer":"Qna_ImproveLsdl_Synonyms_Org_Message")}}function Cr(i){var e=i.format("Qna_ImproveLsdl_Copilot_Phrasings_Prompt",[i.get("Qna_ImproveLsdl_Copilot_Disclaimer")]);return{emphasis:i.get("Qna_ImproveLsdl_Phrasings_Copilot"),text:e}}function yi(i,e,t){void 0===t&&(t=!1);var r=e.getAgents(i),o=_.chain(r).filter(function(a){var s="Enabled"===a.state,u=(0,Rn.g)(a.lastModified);return t?s:s&&u}).map(function(a){return a.name}).value();return"oaiPhrasings"!==i||_.find(r,function(a){return"PowerBI.AzureOpenAIPhrasings"===a.name})?"externalSynonyms"===i&&(_.find(r,function(a){return"PowerBI.AzureOpenAISynonyms"===a.name})||o.push("PowerBI.AzureOpenAISynonyms"),_.find(r,function(a){return"PowerBI.OrganizationLsdlSharing"===a.name})||o.push("PowerBI.OrganizationLsdlSharing")):o.push("PowerBI.AzureOpenAIPhrasings"),o}var Ls=function(i){function e(t,r,o,a,s,u,c){var l=i.call(this,c)||this;return l.featureSwitchService=t,l.conceptualSchemaProxy=r,l.dataModelService=o,l.dataSourcesService=a,l.explorationCapabilitiesService=s,l.qnaSupportabilityService=u,l}return(0,C.ZT)(e,i),e.prototype.execute=function(){var t;return(0,C.mG)(this,void 0,void 0,function(){var o,a,s;return(0,C.Jh)(this,function(u){switch(u.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return u.sent().qnaCopilotPhrasings?[4,this.dataModelService.getLinguisticSchema()]:(this.signalCompletion(),[2,this.getDeferredPromise()]);case 2:return o=u.sent(),[4,Ki(this.conceptualSchemaProxy,this.dataSourcesService,this.explorationCapabilitiesService,this.qnaSupportabilityService,o)];case 3:return u.sent()?(a=new hn(o),s=yi("oaiPhrasings",a),_.includes(s,"PowerBI.AzureOpenAIPhrasings")&&this.doneOAISynonyms(a)&&this.hasAuthoredTerm(a)?(null===(t=this.next)||void 0===t||t.execute(s),[2,this.getDeferredPromise()]):(this.signalCompletion(),[2,this.getDeferredPromise()])):(this.signalCompletion(),[2,this.getDeferredPromise()])}})})},e.prototype.doneOAISynonyms=function(t){var r=yi("externalSynonyms",t);return!_.includes(r,"PowerBI.AzureOpenAISynonyms")},e.prototype.hasAuthoredTerm=function(t){var r=t.getEntities();return _.some(r,function(o){return _.some(o.terms,function(a){return a.isAuthored})})},e}(Nt),Rs=function(i){function e(t,r,o,a,s,u){var c=i.call(this,u)||this;return c.conceptualSchemaProxy=t,c.dataModelService=r,c.dataSourcesService=o,c.explorationCapabilitiesService=a,c.qnaSupportabilityService=s,c}return(0,C.ZT)(e,i),e.prototype.execute=function(){var t;return(0,C.mG)(this,void 0,void 0,function(){var r,o,a;return(0,C.Jh)(this,function(s){switch(s.label){case 0:return[4,this.dataModelService.getLinguisticSchema()];case 1:return r=s.sent(),[4,Ki(this.conceptualSchemaProxy,this.dataSourcesService,this.explorationCapabilitiesService,this.qnaSupportabilityService,r)];case 2:return s.sent()?(o=new hn(r),a=yi("externalSynonyms",o),_.isEmpty(a)?this.signalCompletion():null===(t=this.next)||void 0===t||t.execute(a),[2,this.getDeferredPromise()]):(this.signalCompletion(),[2,this.getDeferredPromise()])}})})},e}(Nt),Qs={provide:"qnaBannerService",useFactory:function(){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(i){return[2,new Ns]})})},deps:[]},Be={showBanners:!1,banners:[]},Ns=function(){function i(){var e;this.bannerContent$=new ee.X(((e={}).ToolingHome=Be,e.ToolingSynonyms=Be,e.ToolingPhrasings=Be,e.Visual=Be,e))}return i.prototype.setContent=function(e){g.fF.assertValue(e,"bannersBySurface"),_.forEach(e,function(t){g.fF.assertValue(t,"banner content should not be null")}),this.bannerContent$.next(e)},i.prototype.updateContent=function(e,t){g.fF.assertValue(e,"qnaBannerSurface"),g.fF.assertValue(t,"updatedContent");var r=this.bannerContent$.value;r[e]=t,this.bannerContent$.next(r)},i.prototype.getBannerContent=function(e){return g.fF.assertValue(e,"qnaBannerSurface"),this.bannerContent$.asObservable().pipe((0,he.U)(function(t){return t[e]}))},i.prototype.dismissBanner=function(e,t){g.fF.assertValue(e,"qnaBannerSurface"),g.fF.assertValue(t,"qnaBannerId");var o=(0,C.pi)({},this.bannerContent$.value[e]),a=_.find(o.banners,function(s){return s.id===t});null!=a?(a.isVisible=!1,o.banners=(0,C.ev)([],o.banners,!0),this.updateContent(e,o),1===_.size(o.banners)&&o.onDismissAllBanners&&o.onDismissAllBanners()):g.fF.assertFail("banner with id: ".concat(t," not found"))},i.\u0275prov=n.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(t){return new(t||i)}}),i}(),Dr=function(i){function e(t,r,o,a,s,u,c,l,d){var f=i.call(this,d)||this;return f.accountService=t,f.dataSourcesService=r,f.explorationNavigationService=o,f.qnaBannerService=a,f.qnaToolingLauncher=s,f.localizationService=u,f.improveLsdlBackgroundTelemetry=c,f.target=l,f}return(0,C.ZT)(e,i),e.prototype.execute=function(t){var r;return(0,C.mG)(this,void 0,void 0,function(){var a,s,u,c,l,d,f=this;return(0,C.Jh)(this,function(v){switch(v.label){case 0:return[4,this.accountService.isSignedInAsync()];case 1:return v.sent()?(this.clearBannerContent(),null===(r=this.next)||void 0===r||r.execute(t),[2,this.getDeferredPromise()]):(a=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Synonyms_LoginMessage":"Qna_ImproveLsdl_Phrasings_LoginMessage"),s={emphasis:this.localizationService.get("Qna_ImproveLsdl_Login"),text:a},u=this.localizationService.get("SignInButton"),c=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Synonyms_AddYourOwnButton":"Qna_ImproveLsdl_Phrasings_AddYourOwnButton"),l=function(I){f.improveLsdlBackgroundTelemetry.logSigninEvent({surface:I,type:f.target,action:"Login"}),f.accountService.trySignInAsync()},this.qnaBannerService.setContent(((d={}).Visual={showBanners:!0,banners:[{id:Fe.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"},{id:"launchTooling",text:c,actionAppearance:"secondary"}]}],actionHandlers:new Map([["login",function(){return l("Visual")}],["launchTooling",function(){f.improveLsdlBackgroundTelemetry.logSigninEvent({surface:"Visual",type:f.target,action:"AddYourOwn"}),f.qnaToolingLauncher.showToolingDialog({dataSources:f.dataSourcesService.get(),exploration:f.explorationNavigationService.getCurrentExploration(),entryPoint:"VisualBanner",entryContentType:"Synonyms"===f.target?"bulkEditing":"managePhrasings"})}]])},d.ToolingHome={showBanners:!0,banners:[{id:Fe.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"},{id:"Synonyms"===this.target?"switchToSynonymsPage":"switchToPhrasingsPage",text:c,actionAppearance:"secondary"}]}],actionHandlers:new Map([["login",function(){return l("ToolingHome")}],["switchToSynonymsPage",void 0],["switchToPhrasingsPage",void 0]])},d.ToolingSynonyms="Synonyms"===this.target?{showBanners:!0,banners:[{id:Fe.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"}]}],actionHandlers:new Map([["login",function(){return l("ToolingSynonyms")}]])}:Be,d.ToolingPhrasings="Phrasings"===this.target?{showBanners:!0,banners:[{id:Fe.b$.generateGuid(),message:s,isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"login",text:u,actionAppearance:"primary"}]}],actionHandlers:new Map([["login",function(){return l("ToolingPhrasings")}]])}:Be,d)),[2,this.getDeferredPromise()])}})})},e.prototype.clearBannerContent=function(){var t;this.qnaBannerService.setContent(((t={}).Visual=Be,t.ToolingHome=Be,t.ToolingSynonyms=Be,t.ToolingPhrasings=Be,t))},e}(Nt),zs=p(53439),fn=p(62345),qn="https://go.microsoft.com/fwlink/?linkid=2243166",jn=function(i){function e(t,r,o,a,s,u,c,l,d,f,v,F,I){var T=i.call(this,I)||this;return T.dataModelService=t,T.dataSourcesService=r,T.explorationNavigationService=o,T.featureSwitchService=a,T.qnaBannerService=s,T.qnaToolingLauncher=u,T.modelAuthoringService=c,T.localizationService=l,T.dialogService=d,T.improveLsdlExecutionHandler=f,T.improveLsdlBackgroundTelemetry=v,T.target=F,T.underExecution=!1,T}return(0,C.ZT)(e,i),e.prototype.execute=function(t){var r=t.response,o=t.requestedAgents,a=t.copilotWorkspaceId;return(0,C.mG)(this,void 0,void 0,function(){var s,u,c,l,d,f,v,F,I,T,Se=this;return(0,C.Jh)(this,function(Ne){switch(Ne.label){case 0:return null==r.result?[3,1]:(s=new hn(r.result.lsdlObject),[3,3]);case 1:return[4,this.dataModelService.getLinguisticSchema()];case 2:u=Ne.sent(),s=new hn(u),Ne.label=3;case 3:return[4,this.featureSwitchService.getFeatureSwitches()];case 4:if(c=Ne.sent(),l=Ji(c),d=!1,l&&(s.setRuntimeUnderstanding("Full"),d=s.commit()),null==r.result&&!d)return[3,8];Ne.label=5;case 5:return Ne.trys.push([5,7,,8]),[4,this.modelAuthoringService.apply({changes:[{updateLinguisticMetadata:{linguisticSchemaJson:s.toJsonString()}}]})];case 6:return Ne.sent(),[3,8];case 7:return f=Ne.sent(),g.fF.assertFail(f),[3,8];case 8:return(I={}).Visual=[],I.ToolingHome=[],I.ToolingSynonyms=[],I.ToolingPhrasings=[],v=I,null!=r.result&&(v=this.getSuccessBanners(s,o)),F=[],!_.isEmpty(r.errors)&&null==_.find(r.errors,function(He){return"OperationCancelled"===He.code})&&(F=e.getErrorBanners(r.errors,this.localizationService,this.target)),this.qnaBannerService.setContent(((T={}).Visual={showBanners:!0,banners:(0,C.ev)((0,C.ev)([],v.Visual,!0),F,!0),onDismissAllBanners:function(){return Se.signalCompletion()},actionHandlers:new Map([["launchTooling",function(){var He=_.first(v.Visual);Se.qnaBannerService.dismissBanner("Visual",He.id),Se.improveLsdlBackgroundTelemetry.logResultEvent({surface:"Visual",type:Se.target,action:"ReviewResults",resultType:"Success"}),Se.qnaToolingLauncher.showToolingDialog({dataSources:Se.dataSourcesService.get(),exploration:Se.explorationNavigationService.getCurrentExploration(),entryPoint:"VisualBanner",entryContentType:"Synonyms"===Se.target?"bulkEditing":"managePhrasings"}),Se.signalCompletion()}],["errorDetails",this.getErrorDetailsHandler("Visual")],["retry",this.getRetryHandler("Visual",o,a)]])},T.ToolingHome={showBanners:!0,banners:(0,C.ev)((0,C.ev)([],v.ToolingHome,!0),F,!0),onDismissAllBanners:function(){return Se.signalCompletion()},actionHandlers:"Synonyms"===this.target?new Map([["switchToSynonymsPage",void 0],["errorDetails",this.getErrorDetailsHandler("ToolingHome")],["retry",this.getRetryHandler("ToolingHome",o,a)]]):new Map([["switchToPhrasingsPage",void 0],["errorDetails",this.getErrorDetailsHandler("ToolingHome")],["retry",this.getRetryHandler("ToolingHome",o,a)]])},T.ToolingSynonyms="Synonyms"===this.target?{showBanners:!0,banners:F,onDismissAllBanners:function(){return Se.signalCompletion()},actionHandlers:new Map([["errorDetails",this.getErrorDetailsHandler("ToolingSynonyms")],["retry",void 0]])}:Be,T.ToolingPhrasings="Phrasings"===this.target?{showBanners:!0,banners:F,onDismissAllBanners:function(){return Se.signalCompletion()},actionHandlers:new Map([["errorDetails",this.getErrorDetailsHandler("ToolingPhrasings")],["retry",void 0]])}:Be,T)),[2,this.getDeferredPromise()]}})})},e.getErrorBanners=function(t,r,o){var a=this,s=_.filter(t,function(d){return null!=d.agent}),u=_.filter(t,function(d){return null==d.agent}),c=new Map;_.forEach(s,function(d){if(c.has(d.code)){var f=c.get(d.code);f.agents.push(d.agent),c.set(d.code,f)}else c.set(d.code,{agents:[d.agent],originalError:d})});var l=[];return c.forEach(function(d){var F=a.generateErrorBanner(d.originalError,r,o,d.agents);l.push(F)}),_.forEach(u,function(d){var f=a.generateErrorBanner(d,r,o);l.push(f)}),l},e.generateErrorBanner=function(t,r,o,a){void 0===a&&(a=[]);var s=this.getErrorConfig(t.code,r,o,a),u=s.text,c=s.bannerType,l=s.actions;return{id:Fe.b$.generateGuid(),message:{text:u},isVisible:!0,allowDismiss:!0,bannerType:c,data:t,actions:l}},e.prototype.getSuccessBanners=function(t,r){var o,u,a=t.getAgents("Synonyms"===this.target?"externalSynonyms":"oaiPhrasings"),s=_.chain(a).filter(function(f){return null!=f.lastModified}).map(function(f){return f.name}).value();u="Synonyms"===this.target?vr(_.includes(s,"PowerBI.AzureOpenAISynonyms")&&_.includes(r,"PowerBI.AzureOpenAISynonyms"),_.includes(s,"PowerBI.OrganizationLsdlSharing")&&_.includes(r,"PowerBI.OrganizationLsdlSharing"),this.localizationService):Cr(this.localizationService);var d=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Synonyms_Review":"Qna_ImproveLsdl_Phrasings_Review");return(o={}).Visual=[{id:Fe.b$.generateGuid(),message:u,link:{href:qn,text:this.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"launchTooling",text:d,actionAppearance:"primary"}]}],o.ToolingHome=[{id:Fe.b$.generateGuid(),message:u,link:{href:qn,text:this.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:"Synonyms"===this.target?"switchToSynonymsPage":"switchToPhrasingsPage",text:d,actionAppearance:"primary"}]}],o.ToolingSynonyms=[],o.ToolingPhrasings=[],o},e.getErrorConfig=function(t,r,o,a){var s;void 0===a&&(a=[]);var u,f,c=e.getErrorMessageConfig(t,r,o);if("copilotAndOrg"===c.possibleSources){g.fF.assert(function(){return"Synonyms"===o},"target can only be synonyms when the sources are copilot and org");var l=_.includes(a,"PowerBI.AzureOpenAISynonyms"),d=_.includes(a,"PowerBI.OrganizationLsdlSharing");u=l&&d?c.copilotAndOrg:l?c.copilot:c.org}else"copilotOnly"===c.possibleSources?u=c.copilot:"orgOnly"===c.possibleSources?(g.fF.assert(function(){return"Synonyms"===o},"target can only be synonyms when the source is org"),u=c.org):"agnostic"===c.possibleSources?u=c.agnostic:g.fF.assertFail("possibleSources not handled");switch(t){case"NoLsdlIndexAvailable":case"NoLsdlSharingModelsAvailable":f="info";break;case"RequestThrottled":case"RequestTimeOut":f="blocked";break;case"UnsafeContentDetectedInRequest":case"UnsafeContentDetectedInResponse":case"PartiallySuccessful":f="warning";break;case"FeatureNotAvailable":f="info";break;case"FailedToOpenLsdlIndexSearcher":f="info";case"UnsupportedLanguage":g.fF.assertFail("Unexpected improve lsdl error ".concat("UnsupportedLanguage"));default:f="error"}return{text:r.get(u),bannerType:f,actions:null!==(s=c.availableActions)&&void 0!==s?s:[]}},e.getErrorMessageConfig=function(t,r,o){var a={id:"retry",text:r.get("IntermittentFailureRetryButton"),actionAppearance:"primary"},s={id:"errorDetails",text:r.get("View_Details"),actionAppearance:"secondary"},u="Synonyms"===o,l=u?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Synonyms_Error_Generic_Copilot_Org",copilot:"Qna_ImproveLsdl_Synonyms_Error_Generic_Copilot",org:"Qna_ImproveLsdl_Synonyms_Error_Generic_Org",availableActions:[s]}:"Phrasings"===o?{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Phrasings_Error_Generic_Copilot",availableActions:[s]}:{possibleSources:"copilotOnly",copilot:"Qna_FuzzyMatching_PickWorkspace_Error_Generic",availableActions:[s]};switch(t){case"GenericError":case"FailedToParseLsdlFromRequest":case"FailedToParseLsdlFromRequest":case"UnsupportedLanguage":case"NoKnownAgentsRequested":case"GenericFailure":return l;case"NetworkConnectionIssue":return{possibleSources:"agnostic",agnostic:u?"Qna_ImproveLsdl_Error_NetworkIssue_Synonyms":"Qna_ImproveLsdl_Error_NetworkIssue_Phrasings",availableActions:[a]};case"NoLsdlIndexAvailable":return g.fF.assert(function(){return u},"NoLsdlIndexAvailable error code is only applicable to synonyms"),{possibleSources:"orgOnly",org:"Qna_ImproveLsdl_Error_NoLsdlIndexAvailable"};case"NoLsdlSharingModelsAvailable":return g.fF.assert(function(){return u},"NoLsdlSharingModelsAvailable error code is only applicable to synonyms"),{possibleSources:"orgOnly",org:"Qna_ImproveLsdl_Error_NoLsdlSharingModelsAvailable"};case"InvalidRequestVersion":case"RequiresNewerVersion":return{possibleSources:"agnostic",agnostic:"Qna_ImproveLsdl_Error_RequiresNewerVersion"};case"FailedToOpenLsdlIndexSearcher":return g.fF.assert(function(){return u},"FailedToOpenLsdlIndexSearcher error code is only applicable to synonyms"),{possibleSources:"orgOnly",org:"Qna_ImproveLsdl_Error_FailedToOpenLsdlIndexSearcher"};case"FeatureNotAvailable":case"FeatureNotAvailable":return{possibleSources:"copilotOnly",copilot:u?"Qna_ImproveLsdl_Error_Copilot_Tenant_Disabled_Synonyms":"Qna_ImproveLsdl_Error_Copilot_Tenant_Disabled_Phrasings"};case"UnsupportedUser":return{possibleSources:"copilotOnly",copilot:"CopilotCapability_NoEligibleWorkspace_Message"};case"PartiallySuccessful":return u?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_PartialSuccess_Org_Synonyms",availableActions:[a]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Phrasings",availableActions:[a]};case"UnsafeContentDetectedInRequest":case"UnsafeContentDetectedInResponse":return u?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_PartialSuccess_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_PartialSuccess_Org_Synonyms",availableActions:[a]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_Unsafe_Content_Copilot",availableActions:[s]};case"RequestThrottled":return u?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_Throttle_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_Throttle_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_Throttle_Org_Synonyms",availableActions:[a]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_Throttle_Copilot_Phrasings",availableActions:[a]};case"RequestTimeOut":return u?{possibleSources:"copilotAndOrg",copilotAndOrg:"Qna_ImproveLsdl_Error_Timeout_Copilot_Org_Synonyms",copilot:"Qna_ImproveLsdl_Error_Timeout_Copilot_Synonyms",org:"Qna_ImproveLsdl_Error_Timeout_Org_Synonyms",availableActions:[a]}:{possibleSources:"copilotOnly",copilot:"Qna_ImproveLsdl_Error_Timeout_Copilot_Phrasings",availableActions:[a]};case"DisallowedForCrossGeo":return{possibleSources:"copilotOnly",copilot:u?"Qna_ImproveLsdl_Error_Copilot_CrossGeo_Disallowed_Synonyms":"Qna_ImproveLsdl_Error_Copilot_CrossGeo_Disallowed_Phrasings"};default:return g.fF.assertFail("unhandled improveLsdlErrorCode ".concat(t)),l}},e.prototype.getRetryHandler=function(t,r,o){var a=this;return function(){return(0,C.mG)(a,void 0,void 0,function(){return(0,C.Jh)(this,function(s){switch(s.label){case 0:return this.underExecution?[2]:(this.underExecution=!0,this.improveLsdlBackgroundTelemetry.logResultEvent({surface:t,type:this.target,action:"Retry",resultType:"Failure"}),[4,this.improveLsdlExecutionHandler.execute({requestedAgents:r,copilotWorkspaceId:o})]);case 1:return s.sent(),this.underExecution=!1,[2]}})})}},e.prototype.getErrorDetailsHandler=function(t){var r=this;return function(o){g.fF.assertValue(o,"improve lsdl error"),r.improveLsdlBackgroundTelemetry.logResultEvent({surface:t,type:r.target,action:"ShowErrorDetails",resultType:"Failure"}),r.dialogService.showTemplateDialog("QnaDiagnosticDialogComponentId",{title:r.localizationService.get("Qna_Explore_ErrorMessage"),hideCancelButton:!0,input:{errorCode:o.code,errorMessage:o.diagnosticMessage}})}},e}(Nt),js=function(i){function e(t,r,o,a,s){var u=i.call(this,s)||this;return u.copilotRequirementsService=t,u.localizationService=r,u.modelAuthoringService=o,u.qnaBannerService=a,u}return(0,C.ZT)(e,i),e.prototype.execute=function(t){return(0,C.mG)(this,void 0,void 0,function(){var r,a,s=this;return(0,C.Jh)(this,function(u){return r="pickWorkspace",this.qnaBannerService.setContent(((a={}).Visual={showBanners:!0,banners:[{id:Fe.b$.generateGuid(),message:{text:s.localizationService.get("Qna_Enhance_WithCopilot_FromSelectWorkspace_Disclaminer"),emphasis:s.localizationService.get("Qna_Enhance_WithCopilot")},link:{href:"https://go.microsoft.com/fwlink/?linkid=2258254",text:s.localizationService.get("LearnMore")},isVisible:!0,allowDismiss:!0,bannerType:"copilot",actions:[{id:r,text:s.localizationService.get("WorkspacesSelect_Label_Text"),actionAppearance:"primary"}]}],onDismissAllBanners:function(){return s.signalCompletion()},actionHandlers:new Map([[r,s.pickWorkspace(t)]])},a.ToolingHome=Be,a.ToolingSynonyms=Be,a.ToolingPhrasings=Be,a)),[2,this.getDeferredPromise()]})})},e.prototype.pickWorkspace=function(t){var r=this;return function(){return(0,C.mG)(r,void 0,void 0,function(){var o,a,s,u,l,d;return(0,C.Jh)(this,function(f){switch(f.label){case 0:return[4,this.copilotRequirementsService.validateRequirements({showLoadingDialog:!1})];case 1:if(!(o=f.sent()).copilotStatus.enabled||_.isEmpty(o.copilotRequirements.workspaceId))return[3,6];if(a=JSON.parse(JSON.stringify(t)),(s=new hn(a)).setRuntimeUnderstanding("Full"),!s.commit())return[3,5];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,this.modelAuthoringService.apply({changes:[{updateLinguisticMetadata:{linguisticSchemaJson:s.toJsonString()}}]})];case 3:return f.sent(),[3,5];case 4:return u=f.sent(),g.fF.assertFail(u),[3,5];case 5:return this.qnaBannerService.setContent(((d={}).Visual=Be,d.ToolingHome=Be,d.ToolingSynonyms=Be,d.ToolingPhrasings=Be,d)),this.signalCompletion(),[3,7];case 6:if(o.copilotStatus.reason===fn.Hm.NoWorkspaceId)return[2];l=jn.getErrorBanners([{category:"powerbi",code:"UnsupportedUser"}],this.localizationService,"fuzzyMatchWorkspace"),this.qnaBannerService.updateContent("Visual",{showBanners:!0,banners:l}),f.label=7;case 7:return[2]}})})}},e}(Nt),Gs=function(i){function e(t,r,o,a,s,u,c,l,d){var f=i.call(this,d)||this;return f.qnaProxyPath=t,f.conceptualSchemaProxy=r,f.copilotCapabilityService=o,f.dataModelService=a,f.dataSourcesService=s,f.explorationCapabilitiesService=u,f.featureSwitchService=c,f.qnaSupportabilityService=l,f}return(0,C.ZT)(e,i),e.prototype.execute=function(){var t,r;return(0,C.mG)(this,void 0,void 0,function(){var s,u,l,f,v,F,I;return(0,C.Jh)(this,function(T){switch(T.label){case 0:return"@powerbi/Qna/qnadesktop.module#QnaDesktopModule"!==this.qnaProxyPath?(this.signalCompletion(),[2,this.getDeferredPromise()]):[4,this.featureSwitchService.getFeatureSwitches()];case 1:return Ji(T.sent())?[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())]:(this.signalCompletion(),[2,this.getDeferredPromise()]);case 2:return s=T.sent(),u=this.explorationCapabilitiesService.getCapabilities(),(0,oi.H)(u,s,this.qnaSupportabilityService).isAllowed&&this.qnaSupportabilityService.allowsLinguisticSchemaEdit()?[4,this.copilotCapabilityService.getCopilotEnablementStatus()]:(this.signalCompletion(),[2,this.getDeferredPromise()]);case 3:return l=T.sent(),f=_.includes([fn.Hm.NoWorkspaceId,fn.Hm.WorkspaceNotFound,fn.Hm.UserNotSignedIn],l.copilotStatus.reason),[4,this.dataModelService.getLinguisticSchema()];case 4:return v=T.sent(),F=null===(t=v.DynamicImprovement)||void 0===t?void 0:t.RuntimeUnderstanding,I=null==F||"Default"===F||"Full"===F,f&&I?[2,null===(r=this.next)||void 0===r?void 0:r.execute(v)]:[2]}})})},e}(Nt),Hs=p(40682),yr=function(){function i(e,t){this.certifiedEventsService=e,this.telemetryService=t,this.featureName="Qna - Improve LSDL Feature"}return i.prototype.logSigninEvent=function(e){this.telemetryService.logEvent(Ct,e),this.logCertifiedEvent(rt,(0,C.pi)({},e))},i.prototype.logPromptEvent=function(e){this.telemetryService.logEvent(Cn,e),this.logCertifiedEvent(St,(0,C.pi)({},e))},i.prototype.logResultEvent=function(e){this.telemetryService.logEvent(yn,e),this.logCertifiedEvent(Dn,(0,C.pi)({},e))},i.prototype.logCertifiedEvent=function(e,t){this.certifiedEventsService.logStandardizedFeatureEvent({correlationId:this.telemetryService.root.id,activityName:e,activityAttributes:t,resultCode:"",featureName:this.featureName,activityStatus:"Succeeded"},{normalizeHierarchicalSeparators:!0})},i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275inject(Hs.l),n.\u0275\u0275inject(ge.y0))},i.\u0275prov=n.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Er=function(i){function e(t,r,o,a,s,u){var c=i.call(this,u)||this;return c.improveLsdlService=t,c.dataModelService=r,c.localizationService=o,c.qnaBannerService=a,c.target=s,c}return(0,C.ZT)(e,i),e.prototype.execute=function(t){var r=t.requestedAgents,o=t.copilotWorkspaceId;return(0,C.mG)(this,void 0,void 0,function(){var a,s,u;return(0,C.Jh)(this,function(c){switch(c.label){case 0:return _.isEmpty(r)?(g.fF.assertFail("requestable agents should be defined and non empty"),this.signalCompletion(),[2,this.getDeferredPromise()]):Qn(r)&&_.isEmpty(o)?(g.fF.assertFail("copilotWorkspaceId should be defined for copilot agents"),this.signalCompletion(),[2,this.getDeferredPromise()]):[4,this.dataModelService.getLinguisticSchema()];case 1:return a=c.sent(),s=new hn(a),this.setLoadingBanner(r),[4,this.improveLsdlService.improveLinguisticSchema({requestedAgents:r,requestPriority:"Background",lsdlJson:s.toJsonString(),copilotWorkspaceId:o})];case 2:return u=c.sent(),[4,this.next.execute({response:u,requestedAgents:r})];case 3:return c.sent(),[2,this.getDeferredPromise()]}})})},e.prototype.setLoadingBanner=function(t){var r,o=this,a=mr(t,this.localizationService,this.target),s=function(Se,Ne){o.improveLsdlService.cancelImproveLinguisticSchema(),o.qnaBannerService.dismissBanner(Ne,Se)},u=this.localizationService.get("Synonyms"===this.target?"Qna_ImproveLsdl_Loading_Synonyms":"Qna_ImproveLsdl_Loading_Relationships"),c=this.localizationService.get("PBI_Button_Label_Cancel"),l=Qn(t)?"copilot":"info",d=Fe.b$.generateGuid(),f=Fe.b$.generateGuid(),v=Fe.b$.generateGuid(),I={showBanners:!0,banners:[{id:v,message:a,isVisible:!0,allowDismiss:!1,bannerType:l,actions:[{id:"noop",text:u,actionAppearance:"loading"},{id:"cancelImproveLsdl",text:c,actionAppearance:"secondary"}]}],actionHandlers:new Map([["noop",void 0],["cancelImproveLsdl","Synonyms"===this.target?function(){return s(v,"ToolingSynonyms")}:function(){return s(v,"ToolingPhrasings")}]])};this.qnaBannerService.setContent(((r={}).Visual={showBanners:!0,banners:[{id:d,message:a,link:{href:qn,text:this.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:l,actions:[{id:"noop",text:u,actionAppearance:"loading"},{id:"cancelImproveLsdl",text:c,actionAppearance:"secondary"}]}],actionHandlers:new Map([["noop",void 0],["cancelImproveLsdl",function(){return s(d,"Visual")}]])},r.ToolingHome={showBanners:!0,banners:[{id:f,message:a,isVisible:!0,allowDismiss:!0,bannerType:l,actions:[{id:"noop",text:u,actionAppearance:"loading"},{id:"cancelImproveLsdl",text:c,actionAppearance:"secondary"}]}],actionHandlers:new Map([["noop",void 0],["cancelImproveLsdl",function(){return s(f,"ToolingHome")}]])},r.ToolingSynonyms="Synonyms"===this.target?I:Be,r.ToolingPhrasings="Phrasings"===this.target?I:Be,r))},e}(Nt),_r=function(i){function e(t,r,o,a,s,u){var c=i.call(this,u)||this;return c.qnaBannerService=t,c.localizationService=r,c.improveLsdlBackgroundTelemetry=o,c.copilotRequirementsService=a,c.target=s,c.underExecution=!1,c}return(0,C.ZT)(e,i),e.prototype.execute=function(t){return(0,C.mG)(this,void 0,void 0,function(){var r,o,a,s=this;return(0,C.Jh)(this,function(u){return g.fF.assertNonEmpty(t,"requestableAgents"),r="Synonyms"===this.target?"generateSynonyms":"generatePhrasings",this.qnaBannerService.setContent(((a={}).Visual=(o=function(l){return{showBanners:!0,banners:[{id:Fe.b$.generateGuid(),message:mr(t,s.localizationService,s.target),link:{href:qn,text:s.localizationService.get("CopilotInline_PreviewLink")},isVisible:!0,allowDismiss:!0,bannerType:Qn(t)?"copilot":"info",actions:[{id:r,text:s.localizationService.get("Synonyms"===s.target?"Add_Synonyms":"Add_Relationships"),actionAppearance:"primary"}]}],actionHandlers:new Map([[r,s.getGenerationHandler(t,s.target,l)]])}})("Visual"),a.ToolingHome=o("ToolingHome"),a.ToolingSynonyms="Synonyms"===this.target?o("ToolingSynonyms"):Be,a.ToolingPhrasings="Phrasings"===this.target?o("ToolingPhrasings"):Be,a)),[2,this.getDeferredPromise()]})})},e.prototype.getGenerationHandler=function(t,r,o){var a=this;return function(){return(0,C.mG)(a,void 0,void 0,function(){var s,u,l;return(0,C.Jh)(this,function(d){switch(d.label){case 0:return this.underExecution?[2]:(this.underExecution=!0,this.improveLsdlBackgroundTelemetry.logPromptEvent({surface:o,type:r}),Qn(t)?[3,2]:[4,this.next.execute({requestedAgents:t})]);case 1:return d.sent(),this.underExecution=!1,[2];case 2:return[4,this.copilotRequirementsService.validateRequirements({showLoadingDialog:!1})];case 3:return(s=d.sent()).copilotStatus.enabled&&!_.isEmpty(s.copilotRequirements.workspaceId)?[4,this.next.execute({requestedAgents:t,copilotWorkspaceId:s.copilotRequirements.workspaceId})]:[3,5];case 4:return d.sent(),this.underExecution=!1,[2];case 5:if(s.copilotStatus.reason===fn.Hm.NoWorkspaceId)return this.underExecution=!1,[2];d.label=6;case 6:return u=_.filter(t,function(f){return"PowerBI.AzureOpenAISynonyms"!==f&&"PowerBI.AzureOpenAIPhrasings"!==f}),_.isEmpty(u)?[3,8]:[4,this.next.execute({requestedAgents:u})];case 7:return d.sent(),this.underExecution=!1,[2];case 8:return l=jn.getErrorBanners([{category:"powerbi",code:s.copilotStatus.reason===fn.Hm.DisabledForCrossGeo?"DisallowedForCrossGeo":"UnsupportedUser",agent:"Synonyms"===r?"PowerBI.AzureOpenAISynonyms":"PowerBI.AzureOpenAIPhrasings"}],this.localizationService,r),this.qnaBannerService.updateContent(o,{showBanners:!0,banners:l}),this.underExecution=!1,[2]}})})}},e}(Nt),$s={provide:"improveLsdlBackgroundService",useFactory:function(i,e,t,r,o,a,s,u,c,l,d,f,v,F,I,T,Se){return(0,C.mG)(this,void 0,void 0,function(){var Ne;return(0,C.Jh)(this,function(He){switch(He.label){case 0:return[4,r.get(c||"@powerbi/Qna/qnadesktop.module#QnaDesktopModule","qnaSupportabilityService")];case 1:return Ne=He.sent(),g.fF.assertValue(Ne,"qna supportability service should be provided"),[2,new Ks(i,e,t,o,a,s,u,Ne,l,d,f,v,c,F,I,T,Se)]}})})},deps:[xe.i,Re.D,Ti.H,Ge.E,Ut.o,qi.U,Ce.z,Ke.vZ,Bt.n,us.x,yr,as.g,ai.I_,os.F,wi.b,ss.n,zs.S,ai.Dt,ai.vb]},Ks=function(){function i(e,t,r,o,a,s,u,c,l,d,f,v,F,I,T,Se,Ne){var He=this;this.conceptualSchemaProxy=e,this.dataSourcesService=t,this.lazyScoped=r,this.localizationService=o,this.explorationCapabilities=a,this.explorationNavigation=s,this.featureSwitchService=u,this.qnaSupportabilityService=c,this.dialogService=l,this.improveLsdlBackgroundTelemetry=d,this.copilotRequirementsService=f,this.copilotCapabilityService=v,this.qnaProxyPath=F,this.accountService=I,this.qnaToolingDialogLauncher=T,this.dataModelService=Se,this.modelAuthoringService=Ne,this.manualImproveLsdlTriggered$=new tt.xQ,this.improveLsdlBackground$=(0,Le.T)(this.qnaSupportabilityService.qnaSettingsChanged$.asObservable(),this.manualImproveLsdlTriggered$.asObservable()).pipe((0,ye.w)(function(){return He.tryImproveLsdlCore()}))}return i.prototype.tryImproveLsdl=function(e){return(0,C.mG)(this,void 0,void 0,function(){return(0,C.Jh)(this,function(r){switch(r.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return r.sent().qnaImproveLsdlCopilot&&null==this.improveLsdlBackgroundSub?(this.improveLsdlBackgroundSub=this.improveLsdlBackground$.subscribe(),this.manualImproveLsdlTriggered$.next(e),[2]):[2]}})})},i.prototype.ngOnDestroy=function(){var e;null===(e=this.improveLsdlBackgroundSub)||void 0===e||e.unsubscribe()},i.prototype.tryImproveLsdlCore=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,r,o;return(0,C.Jh)(this,function(a){switch(a.label){case 0:return[4,this.ensureLazyScopedServices()];case 1:return a.sent(),e=new si.B,this.constructSynonymsBannerTree(e),[4,this.improveSynonymsBannerTree.execute()];case 2:return a.sent(),r=new si.B,this.constructPhrasingsBannerTree(r),[4,this.improvePhrasingsBannerTree.execute()];case 3:return a.sent(),o=new si.B,this.constructWorkspacePickerBannerTree(o),[2,this.workspacePickerBannerTree.execute()]}})})},i.prototype.constructSynonymsBannerTree=function(e){this.improveSynonymsBannerTree=new Rs(this.conceptualSchemaProxy,this.dataModelService,this.dataSourcesService,this.explorationCapabilities,this.qnaSupportabilityService,e);var t=new Dr(this.accountService,this.dataSourcesService,this.explorationNavigation,this.qnaBannerService,this.qnaToolingDialogLauncher,this.localizationService,this.improveLsdlBackgroundTelemetry,"Synonyms",e),r=new _r(this.qnaBannerService,this.localizationService,this.improveLsdlBackgroundTelemetry,this.copilotRequirementsService,"Synonyms",e),o=new Er(this.improveLsdlService,this.dataModelService,this.localizationService,this.qnaBannerService,"Synonyms",e),a=new jn(this.dataModelService,this.dataSourcesService,this.explorationNavigation,this.featureSwitchService,this.qnaBannerService,this.qnaToolingDialogLauncher,this.modelAuthoringService,this.localizationService,this.dialogService,o,this.improveLsdlBackgroundTelemetry,"Synonyms",e);this.improveSynonymsBannerTree.next=t,t.next=r,r.next=o,o.next=a},i.prototype.constructPhrasingsBannerTree=function(e){this.improvePhrasingsBannerTree=new Ls(this.featureSwitchService,this.conceptualSchemaProxy,this.dataModelService,this.dataSourcesService,this.explorationCapabilities,this.qnaSupportabilityService,e);var t=new Dr(this.accountService,this.dataSourcesService,this.explorationNavigation,this.qnaBannerService,this.qnaToolingDialogLauncher,this.localizationService,this.improveLsdlBackgroundTelemetry,"Phrasings",e),r=new _r(this.qnaBannerService,this.localizationService,this.improveLsdlBackgroundTelemetry,this.copilotRequirementsService,"Phrasings",e),o=new Er(this.improveLsdlService,this.dataModelService,this.localizationService,this.qnaBannerService,"Phrasings",e),a=new jn(this.dataModelService,this.dataSourcesService,this.explorationNavigation,this.featureSwitchService,this.qnaBannerService,this.qnaToolingDialogLauncher,this.modelAuthoringService,this.localizationService,this.dialogService,o,this.improveLsdlBackgroundTelemetry,"Phrasings",e);this.improvePhrasingsBannerTree.next=t,t.next=r,r.next=o,o.next=a},i.prototype.constructWorkspacePickerBannerTree=function(e){this.workspacePickerBannerTree=new Gs(this.qnaProxyPath,this.conceptualSchemaProxy,this.copilotCapabilityService,this.dataModelService,this.dataSourcesService,this.explorationCapabilities,this.featureSwitchService,this.qnaSupportabilityService,e);var t=new js(this.copilotRequirementsService,this.localizationService,this.modelAuthoringService,this.qnaBannerService,e);this.workspacePickerBannerTree.next=t},i.prototype.ensureLazyScopedServices=function(){return(0,C.mG)(this,void 0,void 0,function(){var e,t;return(0,C.Jh)(this,function(r){switch(r.label){case 0:return this.qnaBannerService?[3,2]:(e=this,[4,this.lazyScoped.get("qnaBannerService")]);case 1:e.qnaBannerService=r.sent(),g.fF.assertValue(this.qnaBannerService,"qna banner service should be provided"),r.label=2;case 2:return this.improveLsdlService?[3,4]:(t=this,[4,this.lazyScoped.get("improveLsdlService")]);case 3:t.improveLsdlService=r.sent(),g.fF.assertValue(this.improveLsdlService,"improve lsdl service should be provided"),r.label=4;case 4:return[2]}})})},i.\u0275fac=function(t){n.\u0275\u0275invalidFactory()},i.\u0275prov=n.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Js=[{type:Hi,componentId:"QnaVisualHostComponentId"},{type:ce,componentId:"QnaAutocompleteComponentId"},{type:Un,componentId:"QnaInputV2ComponentId"},{type:ni,componentId:"QnaFeedbackComponentId"},{type:ii,componentId:"QnaBannerComponentId"}],Zs=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=n.\u0275\u0275defineInjector({providers:[$s,Qs,yr],imports:[E.N.withManifests(Js),J.c.withManifest([{componentIdentifier:"QnaDiagnosticDialogComponentId",componentType:$i}]),D.CommonModule,q._t,ue.v,We.g,le.gd,Ve.eL,N.J,ft.c,z.A3,B.O,ge.e3,j._,De.T,pe.Z,et.I]}),i}()},1931:function(Ze,me,p){p.d(me,{T:function(){return et}});var D=p(77476),B=p(52910),J=p(29513),q=p(31109),N=p(22824),z=p(76521),E=p(40516),ue=p(84497),j=p(79061),le=p(98665),pe=p(94785),Ve=p(47231),De=p(50423),et=function(){function We(){}return We.\u0275fac=function(C){return new(C||We)},We.\u0275mod=De.\u0275\u0275defineNgModule({type:We}),We.\u0275inj=De.\u0275\u0275defineInjector({imports:[D.CommonModule,B.O,J.T,q.F,N.J,z.A3,E.h,ue.L,j.v,le.e3,pe.g,Ve.c]}),We}()},37320:function(Ze,me,p){p.d(me,{y:function(){return G}});var D=p(81337),B=p(35510),J=p(74804),q=p(62458),N=p(58291),z=p(57871),E=p(42614),ue=p(3579),j=p(38953),le=p(3468),pe=p(35988),Ve=p(74857),De=p(50423),ge=p(26898),et=p(83008),We=p(3404),ft=p(21436),C=p(28894),he=p(84916),ie=p(29866),G=function(){function k(b,x,V,U,W,H,X){this.conceptualSchemaProxy=b,this.dataSources=x,this.explorationSerializer=V,this.lazyScoped=U,this.podExplorationResolver=W,this.resourcePackage=H,this.visualPlugin=X}return k.prototype.createInterpretListener=function(b,x){return void 0===x&&(x=500),new g(this.conceptualSchemaProxy,this.dataSources,this.explorationSerializer,this.lazyScoped,this.podExplorationResolver,this.resourcePackage,this.visualPlugin,b,x)},k.\u0275fac=function(x){return new(x||k)(De.\u0275\u0275inject(ge.i),De.\u0275\u0275inject(et.D),De.\u0275\u0275inject(We.L),De.\u0275\u0275inject(C.H),De.\u0275\u0275inject(ft.Bl),De.\u0275\u0275inject(he.o),De.\u0275\u0275inject(ie.D))},k.\u0275prov=De.\u0275\u0275defineInjectable({token:k,factory:k.\u0275fac}),k}(),g=function(){function k(b,x,V,U,W,H,X,re,ne){this.conceptualSchemaProxy=b,this.dataSources=x,this.explorationSerializer=V,this.lazyScoped=U,this.podExplorationResolver=W,this.resourcePackage=H,this.visualPlugin=X,this.setupParams=re,this.timeout=ne,q.fF.assertValue(re,"setupParams"),this.updateManager=new de(this.timeout),this.setupParams=re}return k.prototype.getObservable=function(){return this.updateManager.getObservable()},k.prototype.onInterpretIssued=function(){this.cancelErrorThrottler(),this.updateManager.pushUpdate({resultType:0})},k.prototype.onInterpretRetry=function(b){this.updateManager.pushUpdate({resultType:1,retryWarning:b})},k.prototype.onInterpretResultCleared=function(){this.cancelErrorThrottler(),this.updateManager.pushUpdate({resultType:4,utterance:""})},k.prototype.onInterpretResult=function(b,x){var V;return(0,D.mG)(this,void 0,void 0,function(){var U,W;return(0,D.Jh)(this,function(H){return U=!!x.error||!this.setupParams.forTrainingTermBinding&&_.isEmpty(x.results)||this.setupParams.forTrainingTermBinding&&_.every(x.results,function(X){return!X.command})&&!function(k){return!k||!!_.find(k,function(b){return 2===b||8===b||11===b||12===b||9===b||10===b||24===b})}(x.warnings),U?(W=_.first(x.results),this.onInterpretErrorV2(x.utterance,b,x.error,W?.spans,null===(V=W?.correctionInfo)||void 0===V?void 0:V.correctedUtterance),[2]):[2,this.onInterpretSuccessV2(x,b)]})})},k.prototype.onInterpretSuccessV2=function(b,x){var V,U;return(0,D.mG)(this,void 0,void 0,function(){var W,H;return(0,D.Jh)(this,function(re){switch(re.label){case 0:return q.fF.assertValue(b,"interpretResponse"),this.cancelErrorThrottler(),null!==(V=x?.intent)&&void 0!==V&&V.defineCalculation?[4,this.handleCalculationResult(b,x)]:[3,2];case 1:return re.sent(),[3,6];case 2:return W=_.first(b.results),(H=null===(U=W?.command)||void 0===U?void 0:U.query)&&_.find(H.from().sources(),function(ne){return(0,j.Yg)(ne)})?[4,this.handlePodPageResult(b,x)]:[3,4];case 3:return re.sent(),[3,6];case 4:return[4,this.handleVisualResult(b,x)];case 5:re.sent(),re.label=6;case 6:return[2]}})})},k.prototype.onInterpretErrorV2=function(b,x,V,U,W){var H=this;q.fF.assertValue(b,"utterance"),this.cancelErrorThrottler();var X=this.setupParams.forTrainingTermBinding?{spans:U,correctedUtterance:W}:void 0;this.errorThrottler=setTimeout(function(){H.updateManager.pushThrottledUpdate({request:x,resultType:3,interpretError:V,utterance:b,termBindingsTrainingInfo:X,doNotShowResult:!0}),H.errorThrottler=void 0},this.timeout)},k.prototype.cancelErrorThrottler=function(){this.errorThrottler&&clearTimeout(this.errorThrottler),this.errorThrottler=void 0},k.prototype.handlePodPageResult=function(b,x){return(0,D.mG)(this,void 0,void 0,function(){var V,U,W,H,X,re,ne,ye,qe,$e,ee,Me,Pe,ke,Ue,Oe,Le,mt,vt,Mt;return(0,D.Jh)(this,function(nt){switch(nt.label){case 0:if(V=_.first(b?.results),q.fF.assertValue(V,"query interpretResult must be defined for handling pod result"),U=b.utterance,W=n(V),this.setupParams.forTrainingTermBinding)return this.updateManager.pushThrottledUpdate({request:x,resultType:2,utterance:U,termBindingsTrainingInfo:W,doNotShowResult:!1}),[2];if(!this.setupParams.canShowPods)return this.updateManager.pushThrottledUpdate({request:x,resultType:5,utterance:U}),[2];H=V?.command,X=H?.query,q.fF.assertValue(X,"interpretResult command must have a defined query for handling pod result"),re=_.find(X.from().sources(),function(je){return(0,j.Yg)(je)}),q.fF.assertValue(re,"expect there is a pod entity"),ne=this.podExplorationResolver.getReportId(re.schema),nt.label=1;case 1:return nt.trys.push([1,3,,4]),$e=(qe=this.explorationSerializer).deepCopyExploration,[4,this.podExplorationResolver.getExploration(ne)];case 2:return ye=$e.apply(qe,[nt.sent()]),ee=_.find(ye.pods,function(je){return je.name===re.pod}),Me=ee&&ee.boundSection,Pe=_.find(ye.sections,function(je){return Me===je.name}),ee&&Me&&Pe?(E.l.mergeExplorationSectionFilters(ye,Pe),ke=(0,Ve.Nj)(H?.queryMetadata),Ue=le.ib.serializeQuery(X),_.isEmpty(Ue.Where)||(Oe=E.l.extractParameterFilters(Ue,ke),E.l.applySectionParameterFilters(Pe,ee,void 0,Oe)),Le=_.filter(ye.resourcePackages,function(je){return _.some(Pe.visualContainers,function(qt){return(0,ue.s)(qt)===je.name})}),_.isEmpty(Le)||(this.resourcePackage.registerPackages(Le),this.visualPlugin.ensurePlugins(Le)),Pe.size.displayOption=1,ye.activeSectionIndex=_.findIndex(ye.sections,function(je){return je.name===Pe.name}),mt=this.getModelFromResult(V),this.ensureDataSources(mt,ye),vt=mt.id,Mt=this.getNotShowLowConfidenceResult(V),this.updateManager.pushThrottledUpdate({request:x,resultType:2,modelId:vt,utterance:U,exploration:ye,restatement:V.restatement,doNotShowResult:Mt,usedAgents:V?.usedAgents}),[3,4]):(this.updateManager.pushThrottledUpdate({request:x,resultType:6,utterance:U}),[2]);case 3:return nt.sent(),this.updateManager.pushThrottledUpdate({request:x,resultType:6,utterance:U}),[3,4];case 4:return[2]}})})},k.prototype.handleVisualResult=function(b,x){return(0,D.mG)(this,void 0,void 0,function(){var V,U,W,H,X,re,ne,ye,ee,Me,Pe;return(0,D.Jh)(this,function(Ue){switch(Ue.label){case 0:if(q.fF.assertValue(b,"interpretResponse"),V=b.utterance,U=_.first(b?.results),!this.setupParams.canShowVisuals)return this.updateManager.pushThrottledUpdate(this.setupParams.forTrainingTermBinding?{request:x,resultType:2,utterance:V,termBindingsTrainingInfo:n(U),doNotShowResult:!1}:{request:x,resultType:5,utterance:V}),[2];W=this.setupParams.forTrainingTermBinding?n(U):void 0,Ue.label=1;case 1:return Ue.trys.push([1,4,,5]),H=(0,pe.vr)(b?.warnings),X=_.uniq(_.map(H,function(Oe){return Oe.messageKey})),re=!_.isEmpty(H),ne=void 0,(ye=U&&U.command)&&ye.query?_.isEmpty(H)?(ee=this.getModelFromResult(U),this.ensureDataSources(ee,void 0),[4,this.lazyScoped.get("visualRecommendationService")]):(this.updateManager.pushThrottledUpdate({request:x,resultType:2,utterance:V,termBindingsTrainingInfo:W,doNotShowResult:!0,doNotShowResultCustomMessageKeys:X}),[2]):(this.updateManager.pushThrottledUpdate({request:x,resultType:this.setupParams.forTrainingTermBinding?2:3,utterance:V,termBindingsTrainingInfo:W,doNotShowResult:!this.setupParams.forTrainingTermBinding||re,doNotShowResultCustomMessageKeys:re?X:void 0}),[2]);case 2:return Me=Ue.sent(),[4,(0,Ve.y_)(U,this.conceptualSchemaProxy,this.dataSources,Me)];case 3:return(ne=Ue.sent())?(Pe=this.getNotShowLowConfidenceResult(U),this.updateManager.pushThrottledUpdate({request:x,resultType:2,modelId:ee.id,utterance:V,restatement:U&&U.restatement,termBindingsTrainingInfo:W,visualContainer:ne,doNotShowResult:Pe,usedAgents:U?.usedAgents})):this.updateManager.pushThrottledUpdate({request:x,resultType:6,utterance:V,termBindingsTrainingInfo:W}),[3,5];case 4:return Ue.sent(),this.updateManager.pushThrottledUpdate({request:x,resultType:6,utterance:V,termBindingsTrainingInfo:W}),[3,5];case 5:return[2]}})})},k.prototype.handleCalculationResult=function(b,x){var V;return(0,D.mG)(this,void 0,void 0,function(){var U,W,X,re,ne;return(0,D.Jh)(this,function(ye){for(U=b.utterance,this.setupParams.canShowCalculations||this.updateManager.pushThrottledUpdate({request:x,resultType:5,utterance:U}),W=[],X=0,re=b.results;X<re.length;X++)null!==(V=(ne=re[X]).command)&&void 0!==V&&V.defineCalculation&&!this.getNotShowLowConfidenceResult(ne)&&W.push((0,D.pi)((0,D.pi)({},ne.command.defineCalculation),{restatement:ne.restatement}));return _.isEmpty(W)?this.updateManager.pushThrottledUpdate({request:x,resultType:3,utterance:U}):this.updateManager.pushThrottledUpdate({request:x,resultType:2,utterance:U,restatement:void 0,doNotShowResult:!1,calculations:W}),[2]})})},k.prototype.getNotShowLowConfidenceResult=function(b){if(!b?.command)return!0;var x=b.correctionInfo&&b.correctionInfo.state;return 0===x||1===x&&this.setupParams.canShowDidYouMean},k.prototype.getModelFromResult=function(b){var x=1===_.size(this.setupParams.models)?this.setupParams.models[0]:_.find(this.setupParams.models,function(V){return V.dbName===b.databaseName&&V.vsName===b.virtualServerName});return q.fF.assertValue(x,"There are multiple models for interpret, one of them should match the model that the interpret result is from"),x},k.prototype.ensureDataSources=function(b,x){if(b&&this.setupParams.resetDataSources){var V=(0,J.CD)(b),U=(0,J.yd)([V]);if(!_.isEmpty(x?.modelExtensions)){var W=z.eM,H=V.name;U.push({type:N.K,id:void 0,name:W,extends:H,exploration:{schemaName:W,extends:H,getModelExtensions:function(){return x.modelExtensions},getDataSourceVariables:function(){return x.dataSourceVariables}}})}this.dataSources.set(U)}},k}();function n(k){if(k){var b=k.command;return{spans:k.spans,correctedUtterance:k.correctionInfo&&k.correctionInfo.correctedUtterance,linguisticSchemaJson:b&&b.linguisticSchemaJson,linguisticSchemaItems:b&&b.linguisticSchemaItems,inferredTermMetadata:b&&b.inferredTermMetadata}}}var de=function(){function k(b){this.timeout=b,this.interpretResult$=new B.X(void 0)}return k.prototype.getObservable=function(){return this.interpretResult$.asObservable()},k.prototype.pushUpdate=function(b){this.throttler&&clearTimeout(this.throttler),this.throttler=void 0,this.throttledUpdate=void 0,this.interpretResult$.next(b),this.throttler=this.startThrottler()},k.prototype.pushThrottledUpdate=function(b){this.throttler?this.throttledUpdate=b:(this.interpretResult$.next(b),this.throttler=this.startThrottler())},k.prototype.startThrottler=function(){var b=this;return setTimeout(function(){b.throttledUpdate?(b.interpretResult$.next(b.throttledUpdate),b.throttledUpdate=void 0,b.throttler=b.startThrottler()):b.throttler=void 0},this.timeout)},k}()},72129:function(Ze,me,p){function D(E){return"Suggestions"===E?.type}function B(E){return"Visual"===E?.type}function J(E){return"VisualAsExploration"===E?.type}function q(E){return"Pod"===E?.type}function N(E){return"Error"===E?.type}function z(E){return"QueryError"===E?.type}p.d(me,{Ew:function(){return D},fU:function(){return J},lP:function(){return q},mn:function(){return B},uT:function(){return N},wp:function(){return z}})},282:function(Ze,me,p){p.d(me,{D:function(){return $n}});var D=p(81337),B=p(50423),J=p(48787),q=p(92060),N=p(79154),z=p(94419),E=p(80981),ue=p(90120),j=p(56578),le=p(1521),pe=p(26982),Ve=p(18664),De=p(47245),ge=p(62458),et=p(73058),We=p(2931),ft=p(50550),C=p(11077),he=p(32105),ie=p(48501),tt=p(18503),G=p(82755),g=p(3579),n=p(60661),te=p(76045),de=p(43286),k=p(39681),b=p(16808),x=p(28579),V=p(14463),U=p(78778),W=new B.InjectionToken("QnaLiveConnectService"),H=p(65947),X=p(12123),re=p(32640),ne=p(21728),ye=p(80952),qe=p(98665),$e=p(9410),ee=p(38078),Me=p(46135),Pe=p(8590),ke=p(80318),Ue=p(5894),Oe=p(72129),Le=p(74857),mt=p(35988),vt=p(87974),Mt=p(29866),wt=p(52121),nt=p(26898),je=p(83008),qt=p(48145),Bt=p(39503),en=p(11494),Fe=p(77200),mn=p(27980),Ot=p(58938),tn=p(67660),nn=p(69474),Tt=p(3404),vn=p(79006),Xe=p(72262),jt=p(906),rn=p(84281),h=p(80277),y=p(83342),S=p(21548),w=p(76072),M=p(2330),oe=p(40956),Ie=p(58991),fe=p(65181),Qe=p(18950),_t=p(83309),it=p(37320),rt=p(1599),yn="qnaVisualContainer",at="inputBox",Dt="suggestions",En="hiddenProperties",xn="background",st="header",_n="cardBackground",yt="card",Et="question",on="restatement",Vt="FontColor",Pt="FontSize",At="FontFamily",Ut="hoverColor",Gt="acceptedColor",Lt="errorColor",an="warningColor",Mn="commitButtonBackgroundColor",Ht="Bold",Wt="Italic",$t="Underline",ae={withBorder:!0,showSuggestions:!0,acceptedColor:"#0078D4",errorColor:"#FF0000",warningColor:"#0078D4",borderColor:"#A19F9D",fontColor:"#323130",darkFontColor:"#252423",lightFontColor:"#FFFFFF",inputBoxBackgroundColor:"#FFFFFF",suggestionBackgroundColor:"#F3F2F1",hoverColor:"#EEEEEE",semiboldFont:"'Segoe UI Semibold', wf_segoe-ui_semibold, helvetica, arial, sans-serif",regularFont:"'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",smallFontSize:he.B.createFromPt(9),mediumFontSize:he.B.createFromPt(10),largeFontSize:he.B.createFromPt(12),defaultBIUValue:!1},Wn={spanDropdownHeaderConfig:{show:!0,unknownSpanHeaderConfig:{actionType:"none"}}},$n=function(){function K(m,P,A,Q,L,O,Z,Y,ve,se,R,ce,Ee,xe,Re,Ce,Ke,Ge,pt,gt,ze,Rt,Ft,Ye,sn,un,ln,cn,Kt,dn,be,ut,_e,Ae,bt,Bn,Sn,On){if(this.visualPlugin=m,this.changeDetectorRef=P,this.conceptualSchemaProxy=A,this.dataSources=Q,this.dialogService=L,this.explorationActivity=O,this.explorationCapabilities=Z,this.explorationNavigation=Y,this.explorationSerializer=ve,this.eventBridge=se,this.featureSwitchService=R,this.qnaFeedbackStateService=ce,this.lazyProvider=Ee,this.themeService=xe,this.expandCollapse=Re,this.geocoder=Ce,this.geolocationService=Ke,this.moduleLoader=Ge,this.localizationService=pt,this.errorService=gt,this.telemetryService=ze,this.resourceLoader=Rt,this.screenReaderService=Ft,this.interpretListenerFactory=Ye,this.selectionService=sn,this.sortService=un,this.undoRedoService=ln,this.viewModeState=cn,this.visualAuthoringOpService=Kt,this.azureMapTokenCache=dn,this.azureMapsEndpoint=be,this.geocoderIndexedDB=ut,this.visualHostTooltipServiceFactory=_e,this.promiseFactory=Ae,this.accountService=bt,this.qnaProxyPathToken=Bn,this.qnaModelUtilsPathToken=Sn,this.qnaLiveConnectService=On,this.utteranceUpdated=new B.EventEmitter,this.pinnableContentDefinitionUpdated=new B.EventEmitter,this.convertVisual=new B.EventEmitter,this.utteranceRestated=new B.EventEmitter,this.interpretationError=new B.EventEmitter,this.isBrowserIE=(0,b.rO)(),this.isBrowserIE)this.viewModel={state:"Error",error:(0,Le.ET)(pt),qnaInputConfiguration:void 0,themeCollection:void 0,viewport:void 0,presentationViewModel:void 0};else{this.pendingSuggestedQuestionsRequests=0;var kt=(0,Le.Su)(this.explorationNavigation,this.featureSwitchService),Tn=this.themeService.getVisualStyle(kt).colorPalette.dataColors.getColorByIndex(0).value,Kn={withBorder:ae.withBorder,borderColor:ae.borderColor,backgroundColor:ae.inputBoxBackgroundColor,questionFontProperties:{color:ae.fontColor,size:ae.mediumFontSize,family:ae.regularFont},acceptedUnderlineColor:ae.acceptedColor,errorUnderlineColor:ae.errorColor,warningUnderlineColor:ae.warningColor,hoverColor:ae.hoverColor,restatementFontProperties:{color:ae.fontColor,size:ae.smallFontSize,family:ae.regularFont},commitButtonBackgroundColor:Tn,commitButtonForegroundColor:wn(Tn)};this.viewModel={state:"Loading",qnaInputConfiguration:void 0,themeCollection:kt,viewport:void 0,presentationViewModel:{inputBox:Kn,suggestions:{backgroundColor:ae.suggestionBackgroundColor,show:ae.showSuggestions,cardFontProperties:{color:ae.fontColor,size:ae.mediumFontSize,family:ae.regularFont},headerFontProperties:{color:ae.fontColor,size:ae.largeFontSize,family:ae.semiboldFont}}}}}}return K.prototype.initialize=function(m,P,A,Q,L,O,Z,Y,ve,se,R,ce,Ee){var xe;return void 0===Ee&&(Ee=!1),(0,D.mG)(this,void 0,void 0,function(){var Ce,Ge,pt,gt,ze,Rt,Ft,Ye,sn,ln,cn,Kt,be=this;return(0,D.Jh)(this,function(ut){switch(ut.label){case 0:return this.isBrowserIE?[2]:(this.models=m,this.config=P,this.hostServices=A,this.entryPoint=Q,this.utteranceUpdated=L,this.convertVisual=O,this.utteranceRestated=se,this.interpretationError=R,this.initializedTelemetryEvent=Z,this.contentElement=Y,ve&&(this.pinnableContentDefinitionUpdated=ve),Ce=this,[4,this.lazyProvider.get(this.qnaProxyPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","InterpretServiceModern")]);case 1:return Ce.interpretService=ut.sent(),Ge=this,[4,this.lazyProvider.get(this.qnaModelUtilsPathToken||"@powerbi/Qna/qnaweb.module#QnaWebModule","qnaModelUtilsService")];case 2:return Ge.qnaModelUtils=ut.sent(),pt=_.map(this.models,function(_e){return{datasetName:_e.dbName,datasetId:_e.id}}),gt=this,[4,(0,vt.U)(pt,this.qnaModelUtils,this.featureSwitchService)];case 3:return gt.inCommitQuestionOnDemandMode=ut.sent(),this.interpretListener=this.interpretListenerFactory.createInterpretListener({forTrainingTermBinding:!1,canShowPods:this.config.canShowPods,canShowVisuals:this.config.canShowVisuals,canShowDidYouMean:this.config.canShowDidYouMean,models:this.models,resetDataSources:this.config.resetDataSources}),this.interpretListener.getObservable().subscribe(function(_e){return be.onResultAvailable(_e)}),ze=_.find(this.dataSources.get(),function(_e){return _e.type===et.nKy}),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 4:return Rt=ut.sent(),Ft=ze&&Rt&&Rt.schema(ze.name).capabilities,(Ye=(null===(xe=this.viewModel.qnaInputConfiguration)||void 0===xe?void 0:xe.configs)||{}).supportsPodQueries=!!P.canShowPods,null!=P.focusOnInit&&(Ye.autoFocusOnInit=P.focusOnInit),null!=P.disableQnaInputAuthoring&&(Ye.disableAuthoring=P.disableQnaInputAuthoring,Ye.displayDisabledStateVisually=P.disableQnaInputAuthoring),null!=P.disableQnaInputAuthoringMessage&&(Ye.disableAuthoringMessage=P.disableQnaInputAuthoringMessage),null!=P.hostHandlesUndo&&(Ye.hostSupportsUndo=P.hostHandlesUndo),null!=P.showTermDropdownHeader&&(Ye.spanDropdownHeaderConfig={show:P.showTermDropdownHeader}),P.showUnknownTermDropdownHeaderTextOnly&&(Ye.spanDropdownHeaderConfig||(Ye.spanDropdownHeaderConfig={show:void 0}),Ye.spanDropdownHeaderConfig.unknownSpanHeaderConfig={actionType:"textOnlyHeader",textOnlyTemplate:P.unknownTermDropdownHeaderTextOnlyTemplate}),this.viewModel.themeCollection=(0,Le.Su)(this.explorationNavigation,this.featureSwitchService),this.viewModel.qnaInputConfiguration={entryPoint:this.entryPoint,interpretListener:this.interpretListener,qnaSupportedScopes:_.map(this.models,function(_e){return{model:_e}}),configs:Ye,presentation:this.viewModel.presentationViewModel.inputBox,initialUtterance:this.config.initialUtterance||"",initialUtteranceFromSaved:this.config.initialUtteranceFromSaved},this.viewModel.presentationViewModel.inputBox.useShellTheme=Ee,sn=this,[4,this.getIsModelEditable()];case 5:return sn.isModelEditable=ut.sent(),[4,this.updateUnknownSpanHeaderConfig()];case 6:return ut.sent(),ln=_.map(ce,function(_e,Ae){return{name:"TempFilter"+Ae,filter:_e}}),cn=this.getCurrentVisual(),Kt=(0,k.ED)((0,De.q)({geocoder:this.geocoder,geolocation:this.geolocationService,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.createFromVisualContract(cn),getAzureMapToken:function(){return be.azureMapTokenCache.getAzureMapToken()},azureMapsEndpoint:this.azureMapsEndpoint,geocoderIndexedDB:this.geocoderIndexedDB}),function(_e){_e.getLocalizedString=be.hostServices.getLocalizedString,_e.tooltips=be.hostServices.tooltips,_e.canSelect=be.hostServices.canSelect,_e.onSelecting=be.hostServices.onSelecting,_e.onSelect=be.hostServices.onSelect,_e.onCustomSort=function(Ae){return be.onCustomSort(Ae.sortDescriptors)},_e.geocoder=be.hostServices.geocoder,_e.launchUrl=be.hostServices.launchUrl,_e.canExpandCollapse=function(Ae){return Ft&&Ft.supportsInstanceFilters},_e.setNodeExpansionState=function(Ae){var bt=be.getCurrentVisual();bt&&(Ae.isCollapse?be.expandCollapse.collapseNode(bt,Ae.dataRoles,Ae.data):be.expandCollapse.expandNode(bt,Ae.dataRoles,Ae.data),be.eventBridge.publishToChannel(Pe.jCS,{affectContainer:function(Sn){return Sn.name===yn}}))},_e.telemetry=be.hostServices.telemetry}),Object.defineProperty(Kt,"instanceId",{value:ee.b$.generateGuid()}),this.singleVisualHostConfig={notifyStart:_.noop,notifyEnd:function(){var Ae;Oe.mn(null===(Ae=be.viewModel)||void 0===Ae?void 0:Ae.result)&&(be.viewModel.result.isLoading=!1)},clearQueryErrors:_.noop,handleQueryErrors:function(Ae){return be.handleQueryErrors(Ae)},handleQueryWarnings:_.noop,queryVisualHostServices:{getFilters:function(){var Ae=be.getCurrentVisual();if(Ae){var bt=_.union(Ae&&Ae.filters,ln);return be.createVisualContainerFilters(Ae,bt)}},getDataSourceVariables:function(){var Ae=be.explorationNavigation.getCurrentExploration();return Ae&&Ae.dataSourceVariables},disableAnchorTime:!0},visualHostServices:Kt,interactivityOptions:{selection:!0},additionalObjectUpdates:void 0,disableQueryCacheUpdates:!1,noLoadMore:!1},[4,this.setSuggestedQuestions()];case 7:return ut.sent(),_.isEmpty(this.config.initialUtterance)&&this.setSuggestionsViewModel(),[2]}})})},K.prototype.onCustomSort=function(m){var P=this.getCurrentVisual();(0,Le.fI)(P,this.sortHelper,m)},K.prototype.ngAfterViewInit=function(){this.updateViewport()},K.prototype.update=function(m){var P;return(0,D.mG)(this,void 0,void 0,function(){var A,Q,L,O,Z,Y,ve,se,R,ce,Ee,xe,Re,Ce,Ke,Ge,pt,gt;return(0,D.Jh)(this,function(ze){switch(ze.label){case 0:return A=this,[4,this.getIsModelEditable()];case 1:return A.isModelEditable=ze.sent(),(0,de.yE)(m.type,Me.EP.Style)&&!this.isBrowserIE?(ge.fF.assertValue(this.viewModel,"viewModel should be defined"),Q=(0,Le.Su)(this.explorationNavigation,this.featureSwitchService),this.viewModel.themeCollection=Q,L=Q&&this.themeService.getVisualStyle(Q),O=L&&L.colorPalette.background.value||ae.inputBoxBackgroundColor,Z=L&&L.colorPalette.backgroundNeutral.value||ae.hoverColor,Y=ae.acceptedColor,ve=ae.errorColor,se=ae.warningColor,R=L&&ue.v.create(L),ce=this.themeService.getVisualStyle(this.viewModel.themeCollection).colorPalette.dataColors.getColorByIndex(0).value,Ee=(0,le.um)(ce)>.6?ae.darkFontColor:ae.lightFontColor,xe=(0,G.W7)(m.objects,{objectName:at,propertyName:xn},O),Re=this.createFontProperties(m.objects,at,Et,"label",ae.mediumFontSize,!1,R,L),Ce=(0,G.W7)(m.objects,{objectName:at,propertyName:Mn},ce),Ke={withBorder:ae.withBorder,borderColor:ae.borderColor,backgroundColor:xe,questionFontProperties:Re,acceptedUnderlineColor:(0,G.W7)(m.objects,{objectName:at,propertyName:Gt},Y),errorUnderlineColor:(0,G.W7)(m.objects,{objectName:at,propertyName:Lt},ve),warningUnderlineColor:(0,G.W7)(m.objects,{objectName:at,propertyName:an},se),hoverColor:(0,G.W7)(m.objects,{objectName:at,propertyName:Ut},Z),restatementFontProperties:this.createFontProperties(m.objects,at,on,"smallLabel",ae.smallFontSize,!1,R,L),commitButtonBackgroundColor:Ce,commitButtonForegroundColor:wn(Ce)},this.viewModel.presentationViewModel.inputBox=Ke,Ge=this.createFontProperties(m.objects,Dt,yt,"label",ae.mediumFontSize,!1,R,L),(!m.objects||!m.objects[Dt]||!m.objects[Dt][yt+Vt])&&(Ge.color=Ee),pt={show:(0,G.NA)(m.objects,{objectName:Dt,propertyName:"show"},!0),backgroundColor:(0,G.W7)(m.objects,{objectName:Dt,propertyName:_n},ce),cardFontProperties:Ge,headerFontProperties:this.createFontProperties(m.objects,Dt,st,"largeLabel",ae.largeFontSize,!1,R,L)},this.viewModel.presentationViewModel.suggestions=pt,this.viewModel.qnaInputConfiguration||(this.viewModel.qnaInputConfiguration={entryPoint:this.entryPoint,qnaSupportedScopes:void 0,configs:Wn}),[4,this.updateUnknownSpanHeaderConfig()]):[3,3];case 2:ze.sent(),ze.label=3;case 3:return(0,de.yE)(m.type,Me.EP.Data)?(this.inheritedFilters=m.filters,null!==(P=this.viewModel.qnaInputConfiguration)&&void 0!==P&&P.qnaSupportedScopes?[4,this.setSuggestedQuestions()]:[3,6]):[3,7];case 4:return ze.sent(),Oe.Ew(this.viewModel.result)&&this.setSuggestionsViewModel(),[4,this.updateUnknownSpanHeaderConfig()];case 5:ze.sent(),ze.label=6;case 6:this.eventBridge.publishToChannel(Pe.jCS,{affectContainer:function(Ft){return Ft.name===yn}}),ze.label=7;case 7:return(0,de.yE)(m.type,Me.EP.Resize)&&(this.visualContainerViewport=m.viewport,this.updateViewport(),!this.isBrowserIE&&Oe.Ew(this.viewModel.result)&&this.setSuggestionsViewModel()),this.isBrowserIE||m.firstUpdate||m.objects&&m.objects[En]&&(gt=(0,G.NA)(m.objects,{objectName:En,propertyName:"savedUtterance"},""),this.qnaInputComponent&&this.qnaInputComponent.interpretUtterance({utterance:gt,suppressSuggestions:!0,incomingTags:["Committed"],useUncommittedUtterance:!0})),[2]}})})},K.prototype.enumerateObjectInstances=function(m){var P,A,Q=this;if(ge.fF.assert(function(){return!Q.isBrowserIE},"Expect this not to be called if it is inside IE browser"),!this.isBrowserIE){var L=new x.G,O=this.viewModel.presentationViewModel;switch(m.objectName){case at:var Z=((P={})[xn]=O.inputBox.backgroundColor,P[Et+Vt]=O.inputBox.questionFontProperties.color,P[Et+Pt]=O.inputBox.questionFontProperties.size.pt,P);Z[Et+Ht]=O.inputBox.questionFontProperties.weight===N.en,Z[Et+Wt]=O.inputBox.questionFontProperties.style===N.BF,Z[Et+$t]=O.inputBox.questionFontProperties.textDecoration===N.f0,Z[Et+At]=O.inputBox.questionFontProperties.family,Z[Gt]=O.inputBox.acceptedUnderlineColor,Z[Lt]=O.inputBox.errorUnderlineColor,Z[an]=O.inputBox.warningUnderlineColor,Z[Ut]=O.inputBox.hoverColor,Z[on+Vt]=O.inputBox.restatementFontProperties.color,Z[on+Pt]=O.inputBox.restatementFontProperties.size.pt,Z[on+At]=O.inputBox.restatementFontProperties.family,this.inCommitQuestionOnDemandMode&&(Z[Mn]=O.inputBox.commitButtonBackgroundColor),L.pushInstance({selector:null,properties:Z,objectName:at});break;case Dt:var Y=((A={}).show=O.suggestions.show,A[st+Vt]=O.suggestions.headerFontProperties.color,A[st+Pt]=O.suggestions.headerFontProperties.size.pt,A);Y[st+Ht]=O.suggestions.headerFontProperties.weight===N.en,Y[st+Wt]=O.suggestions.headerFontProperties.style===N.BF,Y[st+$t]=O.suggestions.headerFontProperties.textDecoration===N.f0,Y[st+At]=O.suggestions.headerFontProperties.family,Y[_n]=O.suggestions.backgroundColor,Y[yt+Vt]=O.suggestions.cardFontProperties.color,Y[yt+Pt]=O.suggestions.cardFontProperties.size.pt,Y[yt+Ht]=O.suggestions.cardFontProperties.weight===N.en,Y[yt+Wt]=O.suggestions.cardFontProperties.style===N.BF,Y[yt+$t]=O.suggestions.cardFontProperties.textDecoration===N.f0,Y[yt+At]=O.suggestions.cardFontProperties.family,L.pushInstance({selector:null,properties:Y,objectName:Dt})}return L.complete()}},K.prototype.getFormattingModel=function(){var m=this;if(ge.fF.assert(function(){return!m.isBrowserIE},"Expect this not to be called if it is inside IE browser"),!this.isBrowserIE){var P=this.viewModel.presentationViewModel;return new j.Nq(function(){return m.buildInputBoxFormattingCard(P)},function(){return m.buildRestatementFormattingCard(P)},function(){return m.buildSuggestionsFormattingCard(P)}).build()}},K.prototype.getCurrentVisual=function(){var m,P=null===(m=this.viewModel)||void 0===m?void 0:m.result;return Oe.mn(P)?P.visual:Oe.fU(P)?_.first(P.exploreCanvas.contract.visualContainers):Oe.wp(P)?P.visualWithError:void 0},K.prototype.getCurrentUtteranceTrimmed=function(){return _.trim(this.getCurrentUtteranceUntrimmed())},K.prototype.setGetQnaInputComponentFunc=function(m){ge.fF.assertValue(m,"getQnaInputComponent must be defined."),this.getQnaInputComponent=m},K.prototype.convertVisualClicked=function(){var m=this.getCurrentVisual();if(m){var P=(0,g.s)(m);this.telemetryService.logChildEvent(this.initializedTelemetryEvent,Ue.dN,{visualType:P}),this.convertVisual.emit(m)}},K.prototype.interpretSuggestedQuestion=function(m){var P=this;this.telemetryService.logChildEvent(this.initializedTelemetryEvent,Ue.WW,{isAutoSuggestion:!0}),this.qnaInputComponent&&this.undoRedoService.register("Commit suggested QnA utterance",function(){P.qnaInputComponent.interpretUtterance({utterance:m,suppressSuggestions:!0,incomingTags:["SuggestedUtterance","Committed"],requireCursorAtEndIfFocused:!0,enforceFocus:!0,isCommitInCommitQuestionOnDemandMode:!0})})},K.prototype.toggleShowAllSuggestions=function(){if(Oe.Ew(this.viewModel.result)){var m=this.viewModel.result;m.showAllSuggestions=!m.showAllSuggestions,this.setSuggestionsViewModel()}},K.prototype.showQnaVisualErrorDetails=function(){(0,Le.aZ)(this.viewModel.error,this.errorService,this.localizationService)},K.prototype.showResultErrorDetails=function(){(Oe.uT(this.viewModel.result)||Oe.wp(this.viewModel.result))&&(0,Le.aZ)(this.viewModel.result,this.errorService,this.localizationService)},K.prototype.updateViewport=function(){if(!this.isBrowserIE){var m=this.contentElement.nativeElement;this.viewport={scale:1,height:m.clientHeight-10,width:m.clientWidth-10},this.viewModel.viewport=this.viewport}},K.prototype.getUnknownSpanDropdownHeaderActionType=function(){return(0,D.mG)(this,void 0,void 0,function(){return(0,D.Jh)(this,function(m){switch(m.label){case 0:return this.qnaLiveConnectService?this.qnaLiveConnectService.allowsLinguisticSchemaFeedback()?[2,"askToAdd"]:[3,1]:[2,"askToAdd"];case 1:return[4,this.allowTooling()];case 2:return m.sent()?[2,"defineInTooling"]:[2,"none"];case 3:return[2]}})})},K.prototype.allowTooling=function(){var m;return(0,D.mG)(this,void 0,void 0,function(){var P,A,Q;return(0,D.Jh)(this,function(L){switch(L.label){case 0:return null==(P=null===(m=this.config)||void 0===m?void 0:m.canEdit)&&(P=0!==this.viewModeState.getMode()),P?(A=this.explorationCapabilities.getCapabilities(),A?.allowQnaTooling?null!=this.isModelEditable?[3,2]:(Q=this,[4,this.getIsModelEditable()]):[2,!1]):[2,!1];case 1:Q.isModelEditable=L.sent(),L.label=2;case 2:return this.isModelEditable?[2,!0]:[2,!1]}})})},K.prototype.shouldShowThumbsUpDown=function(){return(0,D.mG)(this,void 0,void 0,function(){return(0,D.Jh)(this,function(P){switch(P.label){case 0:return this.isBrowserIE?[2,!1]:this.featureSwitchService.featureSwitches.qnaThumbsUpDown?[4,this.getIsModelEditable()]:[2,!1];case 1:return[2,!P.sent()]}})})},K.prototype.showFeedbackForCurrentQuestion=function(){var P,m=this;if(ge.fF.assert(function(){return!m.isBrowserIE},"Expect this never get called if it is inside IE browser"),this.isBrowserIE)return!1;var A=null===(P=this.viewModel)||void 0===P?void 0:P.result;return!!A&&(Oe.mn(A)||Oe.lP(A)||Oe.fU(A))},K.prototype.sendFeedback=function(m){return this.logFeedbackTelemetry(m),this.qnaInputComponent.sendFeedback(m,this.getCurrentUtteranceTrimmed())},K.prototype.launchFeedbackDialog=function(m,P){return(0,D.mG)(this,void 0,void 0,function(){var Q,L=this;return(0,D.Jh)(this,function(O){switch(O.label){case 0:return O.trys.push([0,2,,3]),[4,this.dialogService.openHostDialog({bindings:{sentiment:m,showOptions:P},componentName:U.Xr,config:{minWidth:"600px",panelClass:["no-padding"]},dialogName:"QnaFeedbackDialog"})];case 1:return O.sent().afterClosed().pipe((0,J.q)(1)).subscribe(function(Z){if(Z&&(!_.isEmpty(Z.reason)||!_.isEmpty(Z.comment))){L.sendFeedback(Z);var Y=1===m?"PositiveDetailSubmitted":"NegativeDetailSubmitted";L.qnaFeedbackStateService.updateState(L.getCurrentUtteranceTrimmed(),Y)}}),[3,3];case 2:return Q=O.sent(),ge.fF.assertFail("Qna Feedback dialog failed to open"),ge.fF.log(Q),[3,3];case 3:return[2]}})})},K.prototype.updateUnknownSpanHeaderConfig=function(){var m;return(0,D.mG)(this,void 0,void 0,function(){var P,Q,L;return(0,D.Jh)(this,function(O){switch(O.label){case 0:return ge.fF.assertValue(this.viewModel.qnaInputConfiguration.configs,"Expect this.viewModel.qnaInputConfiguration.configs has already been defined"),P=this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig,"textOnlyHeader"===(null===(m=P?.unknownSpanHeaderConfig)||void 0===m?void 0:m.actionType)?[3,2]:(this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig||(this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig={show:void 0}),Q=this.viewModel.qnaInputConfiguration.configs.spanDropdownHeaderConfig,L={},[4,this.getUnknownSpanDropdownHeaderActionType()]);case 1:Q.unknownSpanHeaderConfig=(L.actionType=O.sent(),L),O.label=2;case 2:return[2]}})})},K.prototype.logFeedbackTelemetry=function(m){this.telemetryService.logChildEvent(this.initializedTelemetryEvent,Ue.v5,{senitment:this.mapToTelemetryFeedbackSentiment(m.sentiment),reason:m.reason})},K.prototype.mapToTelemetryFeedbackSentiment=function(m){return ge.fF.assert(function(){return 1===m||-1===m},"unexpected telemetry sentiment"),1===m?"Positive":"Negative"},K.prototype.shouldShowdoNotUnderstandMessageFeedbackLink=function(){var m=this.getCurrentUtteranceTrimmed();return"NegativeDetailSubmitted"!==this.qnaFeedbackStateService.getState(m)},Object.defineProperty(K.prototype,"qnaInputComponent",{get:function(){return this.getQnaInputComponent&&this.getQnaInputComponent()},enumerable:!1,configurable:!0}),K.prototype.getIsModelEditable=function(){return(0,D.mG)(this,void 0,void 0,function(){var m,P,A;return(0,D.Jh)(this,function(Q){switch(Q.label){case 0:return m=_.find(this.dataSources.get(),function(L){return L.type===et.nKy}),[4,this.conceptualSchemaProxy.get(this.dataSources.get())];case 1:return P=Q.sent(),A=m&&P?.schema(m.name).capabilities,[2,A?.canEdit]}})})},K.prototype.getCurrentUtteranceUntrimmed=function(){return this.qnaInputComponent&&this.qnaInputComponent.currentDisplayedUtterance},K.prototype.setSuggestedQuestions=function(){return(0,D.mG)(this,void 0,void 0,function(){var m,P,A,Q,L,Z=this;return(0,D.Jh)(this,function(Y){switch(Y.label){case 0:return ge.fF.assert(function(){return!!Z.interpretService},"interpretService should be defined"),this.pendingSuggestedQuestionsRequests++,[4,this.interpretService.getSuggestedQuestions(this.convertRequestScopes(this.viewModel.qnaInputConfiguration.qnaSupportedScopes)).toPromise()];case 1:if(m=Y.sent(),this.pendingSuggestedQuestionsRequests--,P=m.result,"Loading"===this.viewModel.state&&this.pendingSuggestedQuestionsRequests>0&&!m.error&&_.isEmpty(P?.utterances))return[2];if(m.error)return this.viewModel.error=this.getErrorDetailsFromError(m.error),this.viewModel.state="Error",[2];if(A=_.chain(this.models).map(function(ve){return _.map(ve.featuredQuestions,function(se){return se.utterance})}).flatten().value(),_.isEmpty(A))for(A=[],Q=0,L=P.utterances;Q<L.length;Q++)A.push(L[Q].text);return ge.fF.assert(function(){return!_.isEmpty(P.utterances)||!_.isEmpty(P.warnings)},"No suggested question but no warning? something is wrong."),this.suggestions={questions:A,hasWarnings:!_.isEmpty(P.warnings)},this.viewModel.state="Ready",[2]}})})},K.prototype.getErrorDetailsFromError=function(m){ge.fF.assertValue(m,"Expect the given error to be defined.");var Q,P=(0,mt.AU)(m.errorCode,this.localizationService),A=m.errorCode,L=[],O=[];if("SchemaLanguageNotSupported"===m.errorCode)Q=!1,L=[{errorInfoKey:this.localizationService.get("VisualContainer_QnaVisual_NotSupportedTitle"),errorInfoValue:this.localizationService.get("VisualContainer_QnaVisual_NotSupportedMessage")}];else if(!(Q="GenericRequestFailure"!==A))if(m.sourceServiceError){var se=new ye.sI(m.sourceServiceError).getDetails(this.localizationService);L=se.displayableErrorInfo,O=se.debugErrorInfo}else _.isEmpty(m.message)||O.push({errorInfoKey:We.Bm,errorInfoValue:m.message}),_.isEmpty(m.stackTrace)||O.push({errorInfoKey:We.RU,errorInfoValue:m.stackTrace});var R={code:A,fixableError:0,hideSeeDetails:Q,details:{message:P,displayableErrorInfo:L,debugErrorInfo:O},source:m.source};return"DataIndexMissingAllStatistics"===m.errorCode&&(R.details.helpLink="https://go.microsoft.com/fwlink/?LinkId=786785",R.details.helpLinkType=1,R.details.errorType=1),ge.fF.assert(function(){return!_.isEmpty(R.code)},"telemetryCode should not be empty"),ge.fF.assert(function(){return null!=R.hideSeeDetails},"hideSeeDetails should not be null"),ge.fF.assert(function(){return!_.isEmpty(R.details.message)},"mainMessage should not be empty"),ge.fF.assert(function(){return null!=R.source},"errorSource should not be null"),R},K.prototype.setSuggestionsViewModel=function(){var P,A,Q,m=this;ge.fF.assert(function(){return!m.isBrowserIE},"Expect this never get called if it is inside IE browser");var L=_.size(null===(P=this.suggestions)||void 0===P?void 0:P.questions),O=this.viewModel.result,Z=!!Oe.Ew(O)&&O.showAllSuggestions;L>0&&!Z&&(L=Math.floor(this.contentElement.nativeElement.clientWidth/200))<=1&&(L=5);var se=_.take(null===(A=this.suggestions)||void 0===A?void 0:A.questions,L),R=_.size(se);this.viewModel.result={type:"Suggestions",suggestions:_.map(se,function(ce,Ee){return{content:ce,accessibilityLabel:m.localizationService.format("Visual_Qna_SuggestedQuestion_AccessibilityLabel",Ee+1,R,ce)}}),showAllSuggestions:Z,failedToLoadSuggestionsMessage:0===L&&null!==(Q=this.suggestions)&&void 0!==Q&&Q.hasWarnings?this.localizationService.get("QnaStart_ErrorLoadingSuggestions"):void 0}},K.prototype.onResultAvailable=function(m){var P,A,Q;return(0,D.mG)(this,void 0,void 0,function(){var L,O,Z,Y,ve,se,R,ce,Ee,xe=this;return(0,D.Jh)(this,function(Re){switch(Re.label){case 0:return m&&1===m.resultType?[2]:m?(this.showQuestionProblematicResultTimeout&&(clearTimeout(this.showQuestionProblematicResultTimeout),this.showQuestionProblematicResultTimeout=void 0),_.includes(m.usedAgents,"PowerBI.AzureOpenAISynonyms")?[4,this.logInterpretCopilotTelemetry()]:[3,2]):(this.pinnableContentDefinitionUpdated.emit(void 0),this.viewModel.result=void 0,[2]);case 1:Re.sent(),Re.label=2;case 2:return null!=m.utterance&&this.utteranceUpdated.emit(m.utterance),this.updateViewport(),4===m.resultType&&this.setSuggestionsViewModel(),4!==m.resultType&&6!==m.resultType&&0!==m.resultType&&m.doNotShowResult&&(this.showQuestionProblematicResultTimeout=setTimeout(function(){var Ce=m.interpretError;if(Ce)xe.interpretationError&&xe.interpretationError.emit(),xe.viewModel.result=(0,D.pi)({type:"Error"},xe.getErrorDetailsFromError(Ce));else{var Ke=xe.localizationService.get("Qna_NoVisual_Message");xe.viewModel.result={type:"DoNotUnderstand",message:_.isEmpty(m.doNotShowResultCustomMessageKeys)?Ke:_.map(m.doNotShowResultCustomMessageKeys,function(Ge){return xe.localizationService.get(Ge)}).join("\n\n")},xe.screenReaderService.alert(Ke)}},1500)),4===m.resultType||6===m.resultType||m.doNotShowResult||2!==m.resultType||!m.visualContainer&&!m.exploration?(this.pinnableContentDefinitionUpdated.emit(void 0),this.cancelVisualUpdateAlert(),[2]):(this.utteranceRestated&&this.utteranceRestated.emit(m.restatement),ge.fF.assertValue(m.visualContainer||m.exploration,"result should contain either visualContainer or exploration"),m.visualContainer&&(m.visualContainer.name=yn),L=m.restatement,_.startsWith(L,"Show ")&&(L=_.replace(L,"Show ",m.visualContainer?"This visual is showing ":"Showing ")),O=m.modelId,m.visualContainer?(ge.fF.assert(function(){var Ce;return!(null===(Ce=m.visualContainer.config)||void 0===Ce||!Ce.singleVisual)},"single visual is not defined"),this.config.showVisualsAsExploration?(Z="QnaSection",m.visualContainer.layouts=(0,ft.Br)([{id:0,position:{x:0,y:0,height:this.viewport.height,width:this.viewport.width}}]),(Y=null!==(P=(0,n.PQ)(m.visualContainer).vcObjects)&&void 0!==P?P:{}).title=[{properties:{show:(0,z.O7)(!1)}}],m.visualContainer.config.singleVisual.vcObjects=Y,ve={name:Z,displayName:Z,size:{displayOption:0,width:this.viewport.width,height:this.viewport.height},visualContainers:[m.visualContainer],visualContainerGroups:[m.visualContainer],filters:[]},R={themeCollection:(0,Le.D4)(this.featureSwitchService),dataSources:this.dataSources.get(),sections:[ve],settings:{useNewFilterPaneExperience:!0,allowChangeFilterTypes:!0}},this.explorationNavigation.loadExploration(R),this.explorationNavigation.goto(ve),this.viewModel.result={type:"VisualAsExploration",restatement:L,exploreCanvas:(0,pe.T8)(R,ve,0),modelId:O},ne.UP.selectCanvasItem(m.visualContainer,this.selectionService),this.explorationActivity.sendExplorationContainerReady({parentActivity:void 0})):(this.viewModel.result=void 0,setTimeout(function(){return(0,D.mG)(xe,void 0,void 0,function(){var Ce,Ke=this;return(0,D.Jh)(this,function(Ge){switch(Ge.label){case 0:return this.viewModel.result={type:"Visual",restatement:L,visual:m.visualContainer,modelId:O,isLoading:!0},Ce=(0,n.oJ)(m.visualContainer),_.isEmpty(Ce)?[3,2]:[4,this.createSortHelper(m.visualContainer)];case 1:Ge.sent(),Ge.label=2;case 2:return this.changeDetectorRef.detectChanges(),this.eventBridge.publishToChannel(Pe.jCS,{affectContainer:function(gt){return gt.name===m.visualContainer.name}}),setTimeout(function(){return Ke.updateViewport()}),[2]}})})})),se=(0,E.d9)(m.visualContainer,this.explorationSerializer),null!=(null===(Q=null===(A=se?.config)||void 0===A?void 0:A.singleVisual)||void 0===Q?void 0:Q.vcObjects)&&(se.config.singleVisual.vcObjects=void 0),this.pinnableContentDefinitionUpdated.emit({pinVisualArgs:{dataSources:this.dataSources.get(),filters:this.createVisualContainerFilters(m.visualContainer,m.visualContainer.filters),modelId:O,resourcePackages:void 0,themeCollection:this.viewModel.themeCollection,utterance:m.utterance,visualContainer:se}}),this.alertVisualUpdate(this.getCurrentUtteranceTrimmed(),(0,g.s)(m.visualContainer)),[3,6]):[3,3]);case 3:return m.exploration?(this.updateViewport(),m.exploration.themeCollection?[4,$e.P.loadThemeAndBaseTheme(this.promiseFactory,this.resourceLoader,this.themeService,m.exploration.resourcePackages,m.exploration.themeCollection)]:[3,5]):[3,6];case 4:Re.sent(),Re.label=5;case 5:ce=(R=m.exploration).sections[R.activeSectionIndex],this.explorationNavigation.loadExploration(R),this.explorationNavigation.goto(ce),this.viewModel.result={type:"Pod",restatement:L,exploreCanvas:(0,pe.T8)(R,ce,0),modelId:O},Ee=_.find(this.models,function(Ce){return Ce.id===O}),this.pinnableContentDefinitionUpdated.emit({pinReportPageArgs:{exploration:(0,pe.vi)(R,0,R.activeSectionIndex,void 0,this.localizationService),section:ce,reportId:R.reportId,modelId:O,packageId:Ee&&Ee.packageId,action:{action:et.RCq},utterance:m.utterance,pod:_.find(m.exploration.pods,function(Ce){return Ce.boundSection===ce.name}).name,filters:ce.filters}}),this.cancelVisualUpdateAlert(),Re.label=6;case 6:return[2]}})})},K.prototype.createSortHelper=function(m){return(0,D.mG)(this,void 0,void 0,function(){var P;return(0,D.Jh)(this,function(A){switch(A.label){case 0:return P=this,[4,(0,Le.Vq)(m,this.conceptualSchemaProxy,this.dataSources,this.sortService,this.undoRedoService,this.visualAuthoringOpService,this.visualPlugin)];case 1:return P.sortHelper=A.sent(),[2]}})})},K.prototype.createFontProperties=function(m,P,A,Q,L,O,Z,Y){var ve=m&&m[P],se="".concat(A).concat(Ht),R="".concat(A).concat(Wt),ce="".concat(A).concat($t),Ee=(0,te.N)(ve,se),xe=(0,te.N)(ve,R),Re=(0,te.N)(ve,ce),Ce={color:"".concat(A).concat(Vt),family:"".concat(A).concat(At),size:"".concat(A).concat(Pt)};return Ee&&(Ce.bold="".concat(A).concat(Ht)),xe&&(Ce.italic="".concat(A).concat(Wt)),Re&&(Ce.underline="".concat(A).concat($t)),(0,Ve.Zi)(m&&m[P],Ce,Z,Y,"foreground",Q,{color:ae.fontColor,family:O?ae.semiboldFont:ae.regularFont,size:L,weight:N.AI,style:N.AI,textDecoration:N.zu})},K.prototype.createVisualContainerFilters=function(m,P){var A=_.isEmpty(P)?[]:_.chain(P).filter(function(ce){return ce.filter}).map(function(ce){return ce.filter}).value();this.inheritedFilters&&this.inheritedFilters.dataFilter&&A.push.apply(A,_.map(this.inheritedFilters.dataFiltersUnmerged,function(ce){return ce.filter}));for(var Q=new C.ME,L=0,O=A;L<O.length;L++)Q.addVisualFilter({filter:O[L]});var Y=(0,g.s)(m),ve=Y&&this.visualPlugin.capabilities(Y),se=ve&&ve.supportsHighlight;!se&&this.inheritedFilters&&this.inheritedFilters.highlightFilter&&Q.addVisualFilter({filter:this.inheritedFilters.highlightFilter});var R=Q.getFilters(!1);return{dataFilter:R.dataFilter,dataFiltersUnmerged:R.dataFiltersUnmerged,highlightFilter:se&&this.inheritedFilters?this.inheritedFilters.highlightFilter:void 0,highlightFiltersUnmerged:se&&this.inheritedFilters?this.inheritedFilters.highlightFiltersUnmerged:void 0}},K.prototype.handleQueryErrors=function(m){if(!m.ignorable){var P=m.getDetails(this.localizationService),A=(0,tt.fe)(m.code);this.viewModel.result={type:"QueryError",visualWithError:this.getCurrentVisual(),details:P,code:m.code,fixableError:0,hideSeeDetails:(0,tt.O6)(m.code),overlayType:A,requestId:m.requestId,source:P.source||m.source||"PowerBI"},this.cancelVisualUpdateAlert()}},K.prototype.alertVisualUpdate=function(m,P){if(m){var A=P?this.localizationService.format("Qna_ScreenReader_VisualUpdatedWithChartType",[m,P]):this.localizationService.format("Qna_ScreenReader_VisualUpdated",[m]);this.screenReaderService.alertWithDebounce("qna_visual_update",A)}},K.prototype.cancelVisualUpdateAlert=function(){this.screenReaderService.cancelDebounce("qna_visual_update")},K.prototype.logInterpretCopilotTelemetry=function(){var m;return(0,D.mG)(this,void 0,void 0,function(){var P,A,Q;return(0,D.Jh)(this,function(O){switch(O.label){case 0:return P=null!==(m=this.qnaProxyPathToken)&&void 0!==m?m:"@powerbi/Qna/qnaweb.module#QnaWebModule",[4,this.ensureInterpretCopilotTelemetry(P)];case 1:return O.sent(),[4,this.accountService.isSignedInAsync()];case 2:return A=O.sent(),Q=this.viewModeState.getMode(),this.interpretCopilotTelemetry.logInterpretWithCopilotEvent("@powerbi/Qna/qnaweb.module#QnaWebModule"===this.qnaProxyPathToken?"service":"desktop",A,Q),[2]}})})},K.prototype.ensureInterpretCopilotTelemetry=function(m){return(0,D.mG)(this,void 0,void 0,function(){var P;return(0,D.Jh)(this,function(A){switch(A.label){case 0:return null!=this.interpretCopilotTelemetry?[2]:(P=this,[4,this.lazyProvider.get(m,"interpretCopilotTelemetryService")]);case 1:return P.interpretCopilotTelemetry=A.sent(),[2]}})})},K.prototype.convertRequestScopes=function(m){return _.map(m,function(P){return{model:P.model,reportIds:P.reportIds}})},K.prototype.buildInputBoxFormattingCard=function(m){var P=this,A=re.Fp.inputBox,Q=new j.CQ(new j.lg("inputBox"),"Visual_Qna_QuestionBox",A,function(se){return P.localizationService.get(se)}),L=m.inputBox.questionFontProperties.weight===N.en,O=m.inputBox.questionFontProperties.style===N.BF,Z=m.inputBox.questionFontProperties.textDecoration===N.f0,ve=(new j.UN).withFontFamily({descriptor:A.questionFontFamily,value:m.inputBox.questionFontProperties.family}).withFontSizeProperties({descriptor:A.questionFontSize,value:m.inputBox.questionFontProperties.size.pt}).withBold({descriptor:A.questionBold,value:L}).withItalic({descriptor:A.questionItalic,value:O}).withUnderline({descriptor:A.questionUnderline,value:Z}).build();return Q.addGroup("text",function(se){se.withDisplayName("Text").addCompositeSlice("fontselector","Font",ve).addSimpleSlice("color",function(){return new j.BT({descriptor:A.questionFontColor,value:{value:m.inputBox.questionFontProperties.color}}).build()},function(R){return R.withCustomDisplayName("Generic_Color")})}),Q.addGroup("background",function(se){se.withDisplayName("Visual_Background").addSimpleSlice("defaultColor",function(){return new j.BT({descriptor:A.background,value:{value:m.inputBox.backgroundColor}}).build()},function(R){return R.withCustomDisplayName("Visual_Qna_QuestionBackgroundColor")}).addSimpleSlice("hoverColor",function(){return new j.BT({descriptor:A.hoverColor,value:{value:m.inputBox.hoverColor}}).build()},function(R){return R.withCustomDisplayName("Visual_Qna_QuestionBackgroundHoverColor")})}),Q.addGroup("underlines",function(se){se.withDisplayName("Underline").addSimpleSlice("acceptedColor",function(){return new j.BT({descriptor:A.acceptedColor,value:{value:m.inputBox.acceptedUnderlineColor}}).build()},function(R){return R.withCustomDisplayName("AcceptedColor")}).addSimpleSlice("errorColor",function(){return new j.BT({descriptor:A.errorColor,value:{value:m.inputBox.errorUnderlineColor}}).build()},function(R){return R.withCustomDisplayName("Error_Color")}).addSimpleSlice("warningColor",function(){return new j.BT({descriptor:A.warningColor,value:{value:m.inputBox.warningUnderlineColor}}).build()},function(R){return R.withCustomDisplayName("Warning_TitleColor")})}),Q.addGroup("submitButton",function(se){se.withDisplayName("Visual_Qna_CommitButtonBackground").addSimpleSlice("submitButtonColor",function(){return new j.BT({descriptor:A.commitButtonBackgroundColor,value:{value:m.inputBox.commitButtonBackgroundColor}}).build()},function(R){return R.withCustomDisplayName("Background_Color")})}),Q.build()},K.prototype.buildRestatementFormattingCard=function(m){var P=this,A=re.Fp.inputBox,Q=new j.CQ(new j.lg("restatement"),"Visual_Qna_Restatement",A,function(Z){return P.localizationService.get(Z)}),O=(new j.UN).withFontFamily({descriptor:A.restatementFontFamily,value:m.inputBox.restatementFontProperties.family}).withFontSizeProperties({descriptor:A.restatementFontSize,value:m.inputBox.restatementFontProperties.size.pt}).build();return Q.addGroup("text",function(Z){Z.addCompositeSlice("fontselector","Font",O).addSimpleSlice("color",function(){return new j.BT({descriptor:A.restatementFontColor,value:{value:m.inputBox.restatementFontProperties.color}}).build()},function(Y){return Y.withCustomDisplayName("Generic_Color")})}),Q.build()},K.prototype.buildSuggestionsFormattingCard=function(m){var P=this,A=re.Fp.suggestions,Q=new j.CQ(new j.lg("suggestions"),"Suggestions",A,function(ce){return P.localizationService.get(ce)});Q.addTopLevelToggle("show",function(){return new j.bd({descriptor:A.show,value:m.suggestions.show}).build()});var L=m.suggestions.headerFontProperties.weight===N.en,O=m.suggestions.headerFontProperties.style===N.BF,Z=m.suggestions.headerFontProperties.textDecoration===N.f0,ve=(new j.UN).withFontFamily({descriptor:A.headerFontFamily,value:m.suggestions.headerFontProperties.family}).withFontSizeProperties({descriptor:A.headerFontSize,value:m.suggestions.headerFontProperties.size.pt}).withBold({descriptor:A.headerBold,value:L}).withItalic({descriptor:A.headerItalic,value:O}).withUnderline({descriptor:A.headerUnderline,value:Z}).build();Q.addGroup("header",function(ce){ce.withDisplayName("Visual_Qna_SuggestionsCardHeader").addCompositeSlice("fontselector","Font",ve).addSimpleSlice("color",function(){return new j.BT({descriptor:A.headerFontColor,value:{value:m.suggestions.headerFontProperties.color}}).build()},function(Ee){return Ee.withCustomDisplayName("Generic_Color")})}),L=m.suggestions.cardFontProperties.weight===N.en,O=m.suggestions.cardFontProperties.style===N.BF,Z=m.suggestions.cardFontProperties.textDecoration===N.f0;var R=(new j.UN).withFontFamily({descriptor:A.cardFontFamily,value:m.suggestions.cardFontProperties.family}).withFontSizeProperties({descriptor:A.cardFontSize,value:m.suggestions.cardFontProperties.size.pt}).withBold({descriptor:A.cardBold,value:L}).withItalic({descriptor:A.cardItalic,value:O}).withUnderline({descriptor:A.cardUnderline,value:Z}).build();return Q.addGroup("cards",function(ce){ce.withDisplayName("Cards").addCompositeSlice("fontselector","Font",R).addSimpleSlice("text",function(){return new j.BT({descriptor:A.cardFontColor,value:{value:m.suggestions.cardFontProperties.color}}).build()},function(Ee){return Ee.withCustomDisplayName("Text_Color")}).addSimpleSlice("background",function(){return new j.BT({descriptor:A.cardBackground,value:{value:m.suggestions.backgroundColor}}).build()},function(Ee){return Ee.withCustomDisplayName("Background_Color")})}),Q.build()},K.\u0275fac=function(P){return new(P||K)(B.\u0275\u0275inject(Mt.D),B.\u0275\u0275inject(B.ChangeDetectorRef),B.\u0275\u0275inject(nt.i),B.\u0275\u0275inject(je.D),B.\u0275\u0275inject(Ot.x),B.\u0275\u0275inject(nn.Z),B.\u0275\u0275inject(qt.U),B.\u0275\u0275inject(Bt.z),B.\u0275\u0275inject(Tt.L),B.\u0275\u0275inject(en.J),B.\u0275\u0275inject(y.vZ),B.\u0275\u0275inject(S.B),B.\u0275\u0275inject(w.E),B.\u0275\u0275inject(tn.f),B.\u0275\u0275inject(vn.v),B.\u0275\u0275inject(oe.i),B.\u0275\u0275inject(ie._1),B.\u0275\u0275inject(M.m),B.\u0275\u0275inject(fe.o),B.\u0275\u0275inject(Qe.T),B.\u0275\u0275inject(qe.y0),B.\u0275\u0275inject(wt.l6),B.\u0275\u0275inject(_t.g),B.\u0275\u0275inject(it.y),B.\u0275\u0275inject(Xe.z),B.\u0275\u0275inject(jt.K),B.\u0275\u0275inject(rn.z),B.\u0275\u0275inject(Fe.kc),B.\u0275\u0275inject(mn.Q),B.\u0275\u0275inject(h.o),B.\u0275\u0275inject(Ie.A),B.\u0275\u0275inject(rt.W),B.\u0275\u0275inject(ke.A),B.\u0275\u0275inject(V.t),B.\u0275\u0275inject(q.F),B.\u0275\u0275inject(X.n,8),B.\u0275\u0275inject(H.z,8),B.\u0275\u0275inject(W,8))},K.\u0275prov=B.\u0275\u0275defineInjectable({token:K,factory:K.\u0275fac}),K}();function wn(K){return(0,le.um)(K)>.6?ae.darkFontColor:ae.lightFontColor}},21548:function(Ze,me,p){p.d(me,{B:function(){return B}});var D=p(50423),B=function(){function J(){this.states={}}return J.prototype.updateState=function(q,N){this.states[q.toLocaleLowerCase()]=N},J.prototype.getState=function(q){var N;return null!==(N=this.states[q.toLocaleLowerCase()])&&void 0!==N?N:"Unchosen"},J.\u0275prov=D.\u0275\u0275defineInjectable({token:J,factory:J.\u0275fac=function(N){return new(N||J)},providedIn:"root"}),J}()},5894:function(Ze,me,p){p.d(me,{WW:function(){return J},dN:function(){return N},v5:function(){return j},yP:function(){return E}});var D=p(41114),B="PBI.QnaVisual.SuggestionCardClicked",J=D.cx[B]=(0,D.b1)(B),q="PBI.QnaVisual.VisualConverted",N=D.cx[q]=(0,D.b1)(q),z="PBI.QnA.INAQ",E=D.cx[z]=(0,D.b1)(z,{logExpAssignment:!0}),ue="PBI.QnA.Feedback",j=D.cx[ue]=(0,D.b1)(ue),le="PBI.QnA.UpdateLsdlSharingPermission",Ve=(D.cx[le]=(0,D.b1)(le),"PBI.QnaTooling.ImproveLsdlRequest");D.cx[Ve]=(0,D.b1)(Ve)},31982:function(Ze,me,p){function D(q){if(q){var N=q.correctedUtterance,z=q.correctedTextSegments,E=[];if(!_.isEmpty(z)){var ue=0;return _.forEach(z,function(j){ue<j.startIndex&&E.push({text:N.substring(ue,j.startIndex),isCorrected:!1}),E.push({text:N.substring(j.startIndex,j.endExcludingIndex),isCorrected:!0}),ue=j.endExcludingIndex}),ue<N.length&&E.push({text:N.substring(ue),isCorrected:!1}),E}}}function B(q,N){if(N){for(var z=N.correctedUtterance,E=[],ue=0,j=0,le=0,pe=0,Ve=q;pe<Ve.length;pe++){var De=Ve[pe];if(!_.isEmpty(De.text)&&(ue=le,null!=De.correctedStartIndex&&null!=De.correctedEndExcludingIndex?(j=De.correctedStartIndex,le=De.correctedEndExcludingIndex):le=(j=z.indexOf(De.text,ue))+(De.endExcludingIndex-De.startIndex),De.isUsed)){if(ue!==j){var ge=z.substring(ue,j);(!_.isEmpty(_.trim(ge))||!_.isEmpty(E))&&E.push({text:z.substring(ue,j),isCorrected:!1})}E.push({text:z.substring(j,le),isCorrected:De.isCorrected})}}return E}}function J(q){return"correctedTextSegments"in q}p.d(me,{Gd:function(){return J},Yi:function(){return B},zM:function(){return D}})},87974:function(Ze,me,p){p.d(me,{U:function(){return B}});var D=p(81337);function B(J,q,N){return(0,D.mG)(this,void 0,void 0,function(){var z,E;return(0,D.Jh)(this,function(j){switch(j.label){case 0:if(N.featureSwitches.qnaSupportCommitQuestionOnDemandForAll)return[2,!0];z=0,E=J??[],j.label=1;case 1:return z<E.length?[4,q.isDQOrLiveConnectToOnPrem(E[z])]:[3,4];case 2:if(j.sent())return[2,!0];j.label=3;case 3:return z++,[3,1];case 4:return[2,!1]}})})}},91592:function(Ze,me,p){p.d(me,{G:function(){return J},H:function(){return B}});var D=p(16808);function B(q,N,z){return(0,D.rO)()?{isAllowed:!1,disallowedReason:"featureDisabledInIE"}:z.appShouldHideQnaFeature()?{isAllowed:!1,disallowedReason:"featureDisabledInApp"}:_.some(N?.schemas,function(j){return!j.isExtensionSchema&&!_.isEmpty(j.entities)})?z.modelSupportsQna(N,q)?z.modelHasQnaEnabled(N,q)?{isAllowed:!0}:{isAllowed:!1,disallowedReason:"qnaNotEnabled"}:{isAllowed:!1,disallowedReason:"qnaNotSupported"}:{isAllowed:!1,disallowedReason:"noModel"}}function J(){return{getIsQnaAllowedInfo:B}}},74857:function(Ze,me,p){p.d(me,{D4:function(){return ge},ET:function(){return ue},Kt:function(){return We},Nj:function(){return pe},Su:function(){return De},Vq:function(){return ft},aZ:function(){return Ve},fI:function(){return C},y_:function(){return et}});var D=p(81337),B=p(62458),J=p(38701),q=p(60661),N=p(18503),z=p(50547),E=p(2240);function ue(G){return{code:"qnaNotAllowedInIE",fixableError:0,hideSeeDetails:!0,details:{message:G.get("Qna_NotSupportedInIE"),displayableErrorInfo:void 0},source:"User"}}function pe(G){if(G)return{Filters:_.map(G.filters,function(g){return{Restatement:g.Restatement,type:void 0}}),Select:_.map(G.selects,function(g){return{Restatement:g.restatement}})}}function Ve(G,g,n){B.fF.assertValue(G,"Expect this to be called only when the given error is defined.");var te=G.details;if(te){var de=(0,N.jx)(te),k=n.get("ServiceError_CannotLoadVisual"),b=te.message,x=[];if(de&&(k=te.displayableErrorInfo[0].errorInfoKey,b=te.displayableErrorInfo[0].errorInfoValue,te.displayableErrorInfo.length>1))for(var V=1;V<te.displayableErrorInfo.length;V++)x.push(te.displayableErrorInfo[V]);B.fF.assert(function(){return null!=G.source},"Expect error.source is not null."),g.error(b,G.code,{debugErrorInfo:te.debugErrorInfo,displayableErrorInfo:x,title:k,source:G.source,level:z.U.Error})}}function De(G,g){var n=G.getCurrentExploration(),te=n?.themeCollection;return _.isEmpty(te)?ge(g):te}function ge(G){return{baseTheme:(0,J.DC)(G)}}function et(G,g,n,te){return(0,D.mG)(this,void 0,void 0,function(){var de,k,b,x,V,U,W,H;return(0,D.Jh)(this,function(X){switch(X.label){case 0:return de=G?.command,k=de?.query,k?(b=k.select(),x=de.queryMetadata,V=_.map(x?.selects,function(re,ne){return{expression:b[ne].expr,type:re.type,isGroup:re.isGroup,defaultLabel:re.defaultLabel,isExplicitSortBy:re.isExplicitSortBy}}),U=x?.filters,[4,g.get(n.get())]):[2];case 1:return W=X.sent(),(H=te.recommendVisuals(k,W,{numberOfResults:1,visualType:_.first(de.suggestedVisualTypes),filterMetadata:U,exprMetadata:V,addDefaultFormatting:!0,allowTooltipMeasures:!0}))?(B.fF.assert(function(){return 1===_.size(H.visualContainers)},"Expected 1 result"),[2,H.visualContainers[0]]):[2]}})})}function We(G,g,n,te,de,k,b){return(0,D.mG)(this,void 0,void 0,function(){var x,V,U;return(0,D.Jh)(this,function(H){switch(H.label){case 0:return[4,g.get(n.get())];case 1:return x=H.sent(),V=(0,q.PQ)(G),U={multiAndLastValueConnectorSpecialResourceKey:"AndConjunction_MultiItemsAndOne",displayIndividualValuesLimitSetting:null!=b?{limit:b,limitedValueShownResourceKey:"AndOthers_SingleItem",multiLimitedValuesShownResourceKey:"AndOthers_MultipleItem"}:void 0},[2,te.getVisualTitle(V,x,de.capabilities(V.visualType),void 0,U,k)]}})})}function ft(G,g,n,te,de,k,b){return(0,D.mG)(this,void 0,void 0,function(){var x,V;return(0,D.Jh)(this,function(U){switch(U.label){case 0:return[4,ie(G,g,n,te)];case 1:return x=U.sent(),V={defaultSortBehavior:he(G,b),sortableFields:x?.sortableFields,sortGroups:x?.sortGroups},[2,new E.B(V,G,te,de,k)]}})})}function C(G,g,n){if(!_.isEmpty(n)){var te=(0,q.oJ)(G);_.isEmpty(te)||g.applySortByFields(n)}}function he(G,g){var n,te=(0,q.cj)(G,g);return!!te&&!(null===(n=te.sorting)||void 0===n||!n.default)}function ie(G,g,n,te){return(0,D.mG)(this,void 0,void 0,function(){var de,k,b,x;return(0,D.Jh)(this,function(U){switch(U.label){case 0:if(!(de=n.get()))return[2];U.label=1;case 1:return U.trys.push([1,3,,4]),k=(0,q.PQ)(G),b=(0,q.Xf)(G),[4,g.get(de)];case 2:return x=U.sent(),[2,te.getSortableFields({query:b,schema:x,visualType:k.visualType,columnProperties:k.columnProperties,compiledMappings:[]})];case 3:return U.sent(),[3,4];case 4:return[2]}})})}},35988:function(Ze,me,p){p.d(me,{AU:function(){return ke},B4:function(){return tt},C2:function(){return ee},Cb:function(){return n},R1:function(){return G},Tm:function(){return Pe},fL:function(){return ne},oA:function(){return x},pk:function(){return b},vr:function(){return Me}});var z,E,ue,j,le,pe,D=p(70940),B=p(3468),J=p(62458),q=p(43286),N=p(80777),Ve=((z={}).GeneratedLinguisticSchema=0,z.DataIndexBuildingCancelled=16,z.DataIndexMissingStatistics=17,z.DataIndexNotReady=8,z.DataIndexSizeLimitReached=15,z.DataIndexUpdateFailure=10,z.DomainModelNotReady=2,z.DomainModelPartialLoad=3,z.DomainModelUpdateFailure=9,z.EmptyLinguisticSchema=1,z.InterpretationSemanticError=4,z.InterpretationSemanticWarning=5,z.InterpretCancelled=18,z.InvalidTextualEntity=6,z.LinguisticSchemaTruncated=14,z.MissingOrInvalidPodParameters=13,z.QueryAggregateNotSupported=19,z.QueryMedianNotSupported=20,z.QueryPercentileNotSupported=21,z.QueryScopedEvalNotSupported=22,z.QuerySubqueryRegroupingNotSupported=23,z.StaleDataIndex=12,z.StaleDomainModel=11,z.RequiresNewerVersion=7,z.DataIndexVersionIsOld=24,z.QueryGroupByTableNotSupported=25,z.QueryNotSupported=26,z.NextBestInterpretation=27,z),De=((E={}).ActivationFailure="ActivationFailure",E.CloudRlsModelAccessDenied="CloudRlsModelAccessDenied",E.DataIndexBuildFailure="DataIndexBuildFailure",E.DomainModelLoadFailure="DomainModelLoadFailure",E.ExternalModelAccessDenied="ExternalModelAccessDenied",E.GenericRequestFailure="GenericRequestFailure",E.LinguisticSchemaLoadFailure="LinguisticSchemaLoadFailure",E.ModelNotFound="ModelNotFound",E.ModelQnaNotEnabled="ModelQnaNotEnabled",E.ModelQnaNotSupported="ModelQnaNotSupported",E.RequiresNewerVersion="RequiresNewerVersion",E.SchemaLanguageNotSupported="SchemaLanguageNotSupported",E.MissingRuntimeModule="MissingRuntimeModule",E.VerifyRuntimeFailure="VerifyRuntimeFailure",E.DataIndexMissingAllStatistics="DataIndexMissingAllStatistics",E),ge=((ue={})[16]="Qna_Warning_DataIndexIncomplete_Desktop",ue[15]="Qna_Warning_DataIndexIncomplete_Desktop",ue[14]="Qna_Warning_LinguisticSchemaTruncated_Desktop",ue),et=((j={})[16]="Qna_Warning_DataIndexIncomplete_Service",j[15]="Qna_Warning_DataIndexIncomplete_Service",j[14]="Qna_Warning_LinguisticSchemaTruncated_Service",j),ft=[2,8],C=((le={})[1]="Qna_NotAllowedForReport_WithoutModel",le[2]="Qna_Explore_WarningBuildingLanguageModel",le[7]="Qna_Warning_RequiresNewerVersion",le[8]="Qna_Explore_WarningIndexing",le[9]="Qna_Warning_ModelUpdateFailure",le[10]="Qna_Warning_DataIndexUpdateFailure",le[11]="Qna_Warning_StaleModel",le[12]="Qna_Warning_StaleIndex",le[17]="Qna_Warning_DataIndexMissingStatistics",le[19]="Qna_Warning_UnsupportedFunction",le[20]="Qna_Warning_UnsupportedFunction",le[21]="Qna_Warning_UnsupportedFunction",le[22]="Qna_Warning_UnsupportedFunction",le[23]="Qna_Warning_UnsupportedFunction",le[25]="Qna_Warning_QueryGroupByTableNotSupported",le[26]="Qna_Warning_QueryNotSupported",le[27]="Qna_Warning_NextBestInterpretation",le),he=((pe={}).FeatureNotAvailable="Qna_Error_GenericRequestFailure",pe.NetworkConnectionIssue="Qna_Error_NetworkIssue",pe.RequiresNewerVersion="Qna_Error_RequiresNewerVersion",pe.ModelNotFound="Qna_Error_ModelNotFound",pe.ModelQnaNotEnabled="Qna_Error_ModelQnaNotEnabled",pe.ModelQnaNotSupported="Qna_Error_ModelQnaNotSupported",pe.MissingRuntimeModule="Qna_Explore_MissingBinaries",pe.VerifyRuntimeFailure="Qna_Explore_MissingBinaries",pe.SchemaLanguageNotSupported="Qna_NotAllowedForReport_QnaNotSupported",pe.SessionIsInactive="Qna_Error_GenericRequestFailure",pe.GenericRequestFailure="Qna_Error_GenericRequestFailure",pe.DataIndexBuildFailure="Qna_Explore_WarningFailedIndexing",pe.CloudRlsModelAccessDenied="Tile_RLS_NoAccess",pe.ExternalModelAccessDenied="Qna_Explore_ModelAccessDenied_WithoutSpecifyOwner",pe.DataIndexMissingAllStatistics="Qna_Error_DataIndexMissingAllStatistics",pe),ie=[19,20,22,21,23,25,26];function tt(h){J.fF.assertValue(h,"Expect the given wireV3Response to be defined");var y=Ue(h);if(y)return{error:y};var S=_.first(h.Results),w=_.first(S?.Interpretations);return{result:{utterances:_.map(w?.SuggestedUtterances,function(M){return{text:M.Text,source:M.Source}}),warnings:Le(S?.DiagnosticMessages)}}}function G(h,y,S,w){J.fF.assertValue(w,"Expect the given wireV3Response to be defined");var oe,Ie,M=Ue(w);if(!M){var fe=_.first(w.Results);Ie=Le(fe?.DiagnosticMessages);var Qe=y??1,_t=_.take(fe?.Interpretations,Qe);_.isEmpty(_t)||(oe=_.map(_t,function(it){var rt,Ct,St;return{restatement:it.Restatement,databaseName:null===(rt=fe.Context)||void 0===rt?void 0:rt.DatabaseName,virtualServerName:null===(Ct=fe.Context)||void 0===Ct?void 0:Ct.VirtualServerName,command:vt(it.Command),correctionInfo:Xe(it),spans:V(h,it.Spans),language:fe.Language,modelLanguage:fe.ModelLanguage,modelOwner:null===(St=fe.Context)||void 0===St?void 0:St.ModelOwner,usedAgents:_.map(it.UsedAgents,function(Cn){return Cn}),score:it.Score,relevantSchemaElements:g(fe.RelevantSchemaElements)}}))}return{utterance:h,requestId:S,error:M,results:oe,warnings:Ie}}function g(h){if(null!=h&&(null!=h.Entities||null!=h.Relationships)){var y=function(w){return{description:w.Description,score:w.Score}};return{entities:_.map(h.Entities,y),relationships:_.map(h.Relationships,y)}}}function n(h){J.fF.assertValue(h,"Expect the given wireV3Response to be defined");var y=Ue(h);if(y)return{error:y};var S=_.first(h.Results);return{results:_.map(S?.Interpretations,function(M){return{language:S.Language}})}}function b(h){J.fF.assertValue(h,"Expect the given wireResponse to be defined");var y=function(h){J.fF.assertValue(h,"Expect the given wireV3Response to be defined");var y=_.first(h.Results);return Le(y?.DiagnosticMessages)}(h);return _.find(ft,function(S){return _.includes(y,S)})}function x(h){var y=_.cloneDeep(h);return y.Results=y.Results.sort(function(S,w){var M,oe;return(null===(M=_.maxBy(w.Interpretations,function(Qe){return Qe.Score}))||void 0===M?void 0:M.Score)-(null===(oe=_.maxBy(S.Interpretations,function(Qe){return Qe.Score}))||void 0===oe?void 0:oe.Score)}),y}function V(h,y){if(J.fF.assertValue(h,"utterance"),J.fF.assertAnyValue(y,"wireSpans"),y){_.isEmpty(h)&&J.fF.assert(function(){return _.every(y,function(M){return 0===M.Length})},"utterance is empty, every span should have zero length");var S=[],w=[];return _.forEach(y,function(M){5!==M.Resolution||M.Binding?S.push(new mt(h,M,!1)):w.push(new mt(h,M,!0))}),_.isEmpty(w)||_.forEach(w,function(M){_.forEach(S,function(oe){if(function(h,y){return y.startIndex<=h.startIndex&&y.endExcludingIndex>h.startIndex||y.startIndex<h.endExcludingIndex&&y.endExcludingIndex>h.endExcludingIndex||h.startIndex<=y.startIndex&&h.endExcludingIndex>=y.endExcludingIndex||y.startIndex<=h.startIndex&&y.endExcludingIndex>=h.endExcludingIndex}(oe,M))oe.overlapSpans.push(M);else if(M.endExcludingIndex<oe.startIndex)return})}),S}}function W(h){return _.map(h,function(y){return{startIndex:y.StartIndex,endExcludingIndex:y.StartIndex+y.Length}})}function ne(h){J.fF.assertValue(h,"The given request must be defined");var y=function(h){return h?{Version:"3.3.0",Utterance:h.utterance,Spans:_.map(h.spans,function(y){var S={StartIndex:y.startIndex,Length:y.endExcludingIndex-y.startIndex};return y.inferredTerm&&(S.Binding={InferredTerm:Tt(y.inferredTerm)}),S}),Options:$e(h),LinguisticSchemaJson:h.linguisticSchemaJson,InferredTermBinding:Tt(h.inferredTermBinding),Intent:qe(h.intent),IsCommitted:h.isCommitted,DesiredInterpretationsCount:h.desiredInterpretationsCount,GroupId:h.groupId,GroupSequenceNumber:h.groupSequenceNumber}:{Version:"3.3.0",Utterance:""}}(h);return y.Context={ModelScopes:_.map(h.scopes,function(S){return{VirtualServerName:S.model.vsName,DatabaseName:S.model.dbName,ReportIds:S.reportIds}}),Tags:h.tags,ImpersonatedUserPrincipalName:h.impersonatedUserPrincipalName,ImpersonatedRoles:h.impersonatedRoles,Feedback:tn(h.feedback)},y}function qe(h){if(h?.defineCalculation)return{DefineCalculation:{Language:h.defineCalculation.language,Options:h.defineCalculation.options}}}function $e(h){return null==h?.options?{}:{QueryMetadata:(0,q.yE)(h.options,2),VisualConfiguration:(0,q.yE)(h.options,4),SupportPodQueries:(0,q.yE)(h.options,8),IncludeRelevantSchemaElements:(0,q.yE)(h.options,32),Spans:(0,q.yE)(h.options,64),Diagnostics:(0,q.yE)(h.options,128),FrameTree:!1,AllowFollowUpQuestion:!1,AllowInsightQueries:(0,q.yE)(h.options,512),InferUnknownModelTerms:(0,q.yE)(h.options,4096),AllowPlaceholderSuggestions:!1,SuggestFollowUp:!1,SuggestedUtterances:(0,q.yE)(h.options,2048),SkipCompletion:h.skipCompletion,SingleAnswerBias:(0,q.yE)(h.options,8192),SuggestedDefineCalculationUtterances:(0,q.yE)(h.options,16384),UseLlmParser:(0,q.yE)(h.options,65536)}}function ee(h){return _.map(h,function(y){var S,w;return{VirtualServerName:null===(S=y.model)||void 0===S?void 0:S.vsName,DatabaseName:null===(w=y.model)||void 0===w?void 0:w.dbName,ReportIds:y.reportIds}})}function Me(h){if(_.indexOf(h,27)>=0)return[];var y=_.intersection(h,ie);return _.map(y,function(S){return{warning:S,messageKey:C[S]}})}function Pe(h,y){if(!_.isEmpty(h)){J.fF.assert(function(){return!_.isEmpty(y)},"Must provide a valid qnaProxyPath");for(var S=[],w="@powerbi/Qna/qnadesktop.module#QnaDesktopModule"===y?ge:et,M=0,oe=h;M<oe.length;M++){var Ie=oe[M];if(w){var fe=w[Ie];if(fe){S.push(fe);continue}}var Qe=C[Ie];Qe&&S.push(Qe)}return _.uniq(S)}}function ke(h,y){return y.get(he[h]||"Qna_Error_GenericRequestFailure")}function Ue(h){var y,S;if(J.fF.assertValue(h,"Expect the given wireV3Response to be defined"),"3.3.0"!==h.Version)y="RequiresNewerVersion";else{var w=_.first(h.Results);if(!w)return;S=_.find(w.DiagnosticMessages,function(Ie){return 1===Ie.Severity}),y=S?.Code}if(null!=y){var M=function(h){var y=De[h];return J.fF.assert(function(){return null!=y},"InterpretDiagnosticCodeToQnaErrorCodeMappings should contain key "+h),y||(y="NoClientHandling"),y}(y),oe={errorCode:M,source:"GenericRequestFailure"===M?"PowerBI":"User",message:S?.Message,stackTrace:S?.StackTrace};return"NoClientHandling"===oe.errorCode&&(oe.message=_.isEmpty(oe.message)?y+".":y+". "+oe.message),oe}}function Le(h){if(!_.isEmpty(h)){for(var y=[],w=function(Qe){J.fF.assert(function(){return null!=Ve[Qe.Code]},'unknown mapping to convert InterpretDiagnosticMessage "'+Qe.Code+'" to client interpret warning code'),Ve[Qe.Code]&&y.push(Ve[Qe.Code])},M=0,oe=h.filter(function(fe){return 2===fe.Severity});M<oe.length;M++)w(oe[M]);return y}}var mt=function(){return function(y,S,w){this.utterance=y,this.wireSpan=S,this.isOverlappingSpan=w,this.startIndex=S.StartIndex,this.endExcludingIndex=S.StartIndex+S.Length,this.text=y.substr(S.StartIndex,S.Length),this.correctedStartIndex=S.CorrectedStartIndex,this.correctedEndExcludingIndex=null!=S.CorrectedStartIndex?S.CorrectedStartIndex+S.CorrectedLength:void 0,this.resolution=S.Resolution,this.isOverlapping=w,this.tokens=function(h,y,S){return _.map(S,function(w){var M=w.StartIndex-y;return J.fF.assert(function(){return _.inRange(M,0,_.size(h))},"Expect each token.StartIndex is a valid index with the given spanText and spanStartIndex"),J.fF.assert(function(){return!_.isEmpty(_.trim(h.substr(M,w.Length)))},"Expect no WireToken being pure space"),{startIndex:w.StartIndex,endExcludingIndex:w.StartIndex+w.Length,text:h.substr(M,w.Length)}})}(this.text,this.startIndex,S.Tokens);var M=en(this.text,S.Binding);this.binding=M&&M.bindingInfo,this.isCorrected=!(!this.binding||!M.isCorrected);var oe=Ot(this.text,S.AlternateBindings),Ie=Ot(this.text,S.PhraseCompletions),fe=Ot(this.text,S.PhraseExtensions),Qe=Ot(this.text,S.SuggestedReplacements);(!_.isEmpty(oe)||!_.isEmpty(Ie)||!_.isEmpty(fe)||!_.isEmpty(Qe))&&(this.replacementBindings={alternates:oe,phraseCompletions:Ie,phraseExtensions:fe,suggestedReplacements:Qe}),this.inferredTermBindings=_.map(S.InferredTermBindings,function(Ct){return{inferredBindingType:(h=Ct.InferredTerm).Type,definitionPrompt:h.DefinitionPrompt,definitionText:h.DefinitionText,prefixText:h.PrefixText,suffixText:h.SuffixText,hintText:h.HintText,alternateDefinitionTexts:h.AlternateDefinitionTexts,linguisticSchemaItems:h.LinguisticSchemaItems,definedTerm:h.DefinedTerm,targetRole:h.TargetRole,metadata:h.Metadata};var h}),this.inferredTermBindingsUnsupported=S.InferredTermBindingsUnsupported,this.hasBinding=null!=this.binding||null!=this.replacementBindings||!_.isEmpty(this.inferredTermBindings),this.isWhiteSpace=!_.isEmpty(this.text)&&_.isEmpty(_.trim(this.text)),this.isUsed=!this.isOverlapping&&(null==this.resolution||0===this.resolution||4===this.resolution),this.isUnknown=3===this.resolution,this.isInferred=4===this.resolution,this.overlapSpans=[];var h,it=!((h=this).isOverlapping||_.isEmpty(h.text)||nt(h)||je(h)||Bt(h))&&h.hasBinding&&h.isUsed,rt=Bt(this);J.fF.assert(function(){return!(it&&rt)},"A span can not be definedWithOptions and undefinedWithOptions at the same time."),this.state=it?"accepted":rt&&this.isUsed?"warning":rt?"error":"none"}}();function vt(h){if(h){var y=h.Query?B.ib.deserializeQuery(h.Query):void 0;return{query:y,queryMetadata:wt(y,h.QueryMetadata),data:h.Data,binding:h.Binding,visualConfigurations:_.map(h.VisualConfigurations,function(w){var M=w.Query?B.ib.deserializeQuery(w.Query):void 0;return{visualizationType:w.VisualizationType,dataShapeBinding:w.DataShapeBinding,visualElements:w.VisualElements,query:M,queryMetadata:wt(y,w.QueryMetadata)}}),suggestedVisualTypes:_.map(h.SuggestedVisualizations,function(w){return(0,D.s)(w.VisualizationType).name}),linguisticSchemaJson:h.LinguisticSchemaJson,linguisticSchemaItems:h.LinguisticSchemaItems,inferredTermMetadata:h.InferredTermMetadata,defineCalculation:Mt(h.DefineCalculation)}}}function Mt(h){if(h)return{expression:h.Expression,homeTable:h.HomeTable,format:h.Format}}function wt(h,y){if(h&&y){var S=_.filter(y.Filters,function(M){return!!M}),w=_.filter(y.Select,function(M){return!!M});return{filters:_.map(S,function(M){return{Restatement:M.Restatement,type:void 0}}),selects:_.map(w,function(M){return{restatement:M.Restatement,valueType:jt(M.DefaultLabel?M.DefaultLabel.SemanticType:M.SemanticType),isGroup:M.IsGroup,defaultLabel:M.DefaultLabel?rn(M.DefaultLabel.Expression,h):void 0,isExplicitSortBy:M.IsExplicitSortBy}})}}}function nt(h){var y,S;return 7===(null===(y=h.binding)||void 0===y?void 0:y.type)&&!h.isCorrected&&_.isEmpty(null===(S=h.replacementBindings)||void 0===S?void 0:S.suggestedReplacements)&&_.isEmpty(h.inferredTermBindings)}function je(h){var y,S;return 8===(null===(y=h.binding)||void 0===y?void 0:y.type)&&!h.isCorrected&&2===h.resolution&&_.isEmpty(null===(S=h.replacementBindings)||void 0===S?void 0:S.suggestedReplacements)&&_.isEmpty(h.inferredTermBindings)}function Bt(h){return!(h.isOverlapping||_.isEmpty(h.text)||nt(h)||je(h)||!(h.isCorrected||3===h.resolution||h.hasBinding&&!h.isUsed))}function en(h,y){if(y&&!y.InferredTerm){var S,w;if(y.Table)S=y.Table,w=0;else if(y.Pod)S=y.Pod,w=1;else if(y.Property)S=y.Property,w=2;else if(y.Value)S=y.Value,w=3;else if(y.Range)S=y.Range,w=4;else if(y.VisType)S=y.VisType,w=5;else if(y.Composite)S=y.Composite,w=6;else if(y.Core)S=y.Core,w=7;else if(y.Phrasing)S=y.Phrasing,w=8;else if(y.TextualEntity)S=y.TextualEntity,w=9;else{if(!y.AnyEntity){var M=y;return void J.fF.assert(function(){return!!M.Literal},"Has binding type that is unhandled by client right now. Known unhandled types are: [Literal] and this is not a known type. Check to either update the known unhandled type list, or handle it on the client side.")}S=y.AnyEntity,w=10}return{bindingInfo:{type:w,text:S.Text,textSegmentsWithMatchInfo:mn(h,S.Text,S.MatchedSegments),matchType:S.MatchType,score:S.Score},isCorrected:S.Corrected}}}function mn(h,y,S){if(_.isEmpty(h)||_.isEmpty(S))return[{text:y,isMatched:!1}];for(var w=[],M=0,oe=0,Ie=S;oe<Ie.length;oe++){var fe=Ie[oe];M<fe.StartIndex&&w.push({text:y.substring(M,fe.StartIndex),isMatched:!1}),w.push({text:y.substr(fe.StartIndex,fe.Length),isMatched:!0}),M=fe.StartIndex+fe.Length}return M<_.size(y)&&w.push({text:y.substring(M),isMatched:!1}),w}function Ot(h,y){if(y){for(var S=[],w=0,M=y;w<M.length;w++){var Ie=en(h,M[w]);Ie&&S.push(Ie.bindingInfo)}return S}}function tn(h){return h?{Sentiment:h.sentiment,Reason:h.reason,Comment:h.comment}:void 0}function Tt(h){return null==h?void 0:{Type:h.inferredBindingType,DefinitionPrompt:h.definitionPrompt,DefinitionText:h.definitionText,PrefixText:h.prefixText,SuffixText:h.suffixText,HintText:h.hintText,AlternateDefinitionTexts:h.alternateDefinitionTexts,LinguisticSchemaItems:h.linguisticSchemaItems,DefinedTerm:h.definedTerm,TargetRole:h.targetRole,Metadata:h.metadata}}function Xe(h){J.fF.assertValue(h,"result");var y=h.CorrectedUtterance;if(!_.isEmpty(y)){var w=h.ReplacementUtterance,M=2;return!!h.Command||(h.ConfidenceLevel<=5?M=0:h.ConfidenceLevel<=20&&(M=1)),_.isEmpty(h.CorrectedUtteranceTextSegments)?{correctedUtterance:y,replacementUtterance:w||y,state:M}:{correctedUtterance:y,correctedTextSegments:W(h.CorrectedUtteranceTextSegments),state:M}}}function jt(h){switch(h){case 0:case 1:case 2:case 3:return;case 4:return N.Ge.fromExtendedType(7078913);case 5:return N.Ge.fromDescriptor({dateTime:!0});case 6:return N.Ge.fromDescriptor({numeric:!0})}}function rn(h,y){var S=B.ib.serializeQuery(y);S.Select.push(h);var w=B.ib.deserializeQuery(S);return _.last(w.select()).expr}}}]);