(self.webpackChunkdesktopDataExplore=self.webpackChunkdesktopDataExplore||[]).push([["goals-ui"],{77489:function(pt){pt.exports=function(M,w){(null==w||w>M.length)&&(w=M.length);for(var b=0,e=new Array(w);b<w;b++)e[b]=M[b];return e},pt.exports.default=pt.exports,pt.exports.__esModule=!0},32878:function(pt){function Ct(w,b){for(var e=0;e<b.length;e++){var j=b[e];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(w,j.key,j)}}pt.exports=function(w,b,e){return b&&Ct(w.prototype,b),e&&Ct(w,e),w},pt.exports.default=pt.exports,pt.exports.__esModule=!0},34850:function(pt,Ct,M){var w=M(91052);pt.exports=function(e,j){var qe=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(qe)return(qe=qe.call(e)).next.bind(qe);if(Array.isArray(e)||(qe=w(e))||j&&e&&"number"==typeof e.length){qe&&(e=qe);var te=0;return function(){return te>=e.length?{done:!0}:{done:!1,value:e[te++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},pt.exports.default=pt.exports,pt.exports.__esModule=!0},12864:function(pt,Ct,M){var w=M(74);pt.exports=function(e,j){e.prototype=Object.create(j.prototype),e.prototype.constructor=e,w(e,j)},pt.exports.default=pt.exports,pt.exports.__esModule=!0},74:function(pt){function Ct(M,w){return pt.exports=Ct=Object.setPrototypeOf||function(e,j){return e.__proto__=j,e},pt.exports.default=pt.exports,pt.exports.__esModule=!0,Ct(M,w)}pt.exports=Ct,pt.exports.default=pt.exports,pt.exports.__esModule=!0},91052:function(pt,Ct,M){var w=M(77489);pt.exports=function(e,j){if(e){if("string"==typeof e)return w(e,j);var qe=Object.prototype.toString.call(e).slice(8,-1);if("Object"===qe&&e.constructor&&(qe=e.constructor.name),"Map"===qe||"Set"===qe)return Array.from(e);if("Arguments"===qe||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(qe))return w(e,j)}},pt.exports.default=pt.exports,pt.exports.__esModule=!0},36444:function(pt,Ct,M){var w=M(32878).default,b=M(12864).default,e=M(34850).default;function j(){"use strict";j=function(){return te};var qe,te={},Le=Object.prototype,tt=Le.hasOwnProperty,Ge=Object.defineProperty||function(he,Oe,Ce){he[Oe]=Ce.value},He="function"==typeof Symbol?Symbol:{},Z=He.iterator||"@@iterator",Ee=He.asyncIterator||"@@asyncIterator",se=He.toStringTag||"@@toStringTag";function I(he,Oe,Ce){return Object.defineProperty(he,Oe,{value:Ce,enumerable:!0,configurable:!0,writable:!0}),he[Oe]}try{I({},"")}catch{I=function(Ce,we,ct){return Ce[we]=ct}}function ie(he,Oe,Ce,we){var dt=Object.create((Oe&&Oe.prototype instanceof be?Oe:be).prototype),Ue=new st(we||[]);return Ge(dt,"_invoke",{value:K(he,Ce,Ue)}),dt}function ye(he,Oe,Ce){try{return{type:"normal",arg:he.call(Oe,Ce)}}catch(we){return{type:"throw",arg:we}}}te.wrap=ie;var W="suspendedStart",ne="suspendedYield",ve="executing",me="completed",q={};function be(){}function _e(){}function pe(){}var Re={};I(Re,Z,function(){return this});var Qe=Object.getPrototypeOf,ke=Qe&&Qe(Qe(vt([])));ke&&ke!==Le&&tt.call(ke,Z)&&(Re=ke);var N=pe.prototype=be.prototype=Object.create(Re);function B(he){["next","throw","return"].forEach(function(Oe){I(he,Oe,function(Ce){return this._invoke(Oe,Ce)})})}function X(he,Oe){function Ce(ct,dt,Ue,Dt){var E=ye(he[ct],he,dt);if("throw"!==E.type){var Sn=E.arg,xn=Sn.value;return xn&&"object"==typeof xn&&tt.call(xn,"__await")?Oe.resolve(xn.__await).then(function(on){Ce("next",on,Ue,Dt)},function(on){Ce("throw",on,Ue,Dt)}):Oe.resolve(xn).then(function(on){Sn.value=on,Ue(Sn)},function(on){return Ce("throw",on,Ue,Dt)})}Dt(E.arg)}var we;Ge(this,"_invoke",{value:function(dt,Ue){function Dt(){return new Oe(function(E,Sn){Ce(dt,Ue,E,Sn)})}return we=we?we.then(Dt,Dt):Dt()}})}function K(he,Oe,Ce){var we=W;return function(ct,dt){if(we===ve)throw new Error("Generator is already running");if(we===me){if("throw"===ct)throw dt;return{value:qe,done:!0}}for(Ce.method=ct,Ce.arg=dt;;){var Ue=Ce.delegate;if(Ue){var Dt=le(Ue,Ce);if(Dt){if(Dt===q)continue;return Dt}}if("next"===Ce.method)Ce.sent=Ce._sent=Ce.arg;else if("throw"===Ce.method){if(we===W)throw we=me,Ce.arg;Ce.dispatchException(Ce.arg)}else"return"===Ce.method&&Ce.abrupt("return",Ce.arg);we=ve;var E=ye(he,Oe,Ce);if("normal"===E.type){if(we=Ce.done?me:ne,E.arg===q)continue;return{value:E.arg,done:Ce.done}}"throw"===E.type&&(we=me,Ce.method="throw",Ce.arg=E.arg)}}}function le(he,Oe){var Ce=Oe.method,we=he.iterator[Ce];if(we===qe)return Oe.delegate=null,"throw"===Ce&&he.iterator.return&&(Oe.method="return",Oe.arg=qe,le(he,Oe),"throw"===Oe.method)||"return"!==Ce&&(Oe.method="throw",Oe.arg=new TypeError("The iterator does not provide a '"+Ce+"' method")),q;var ct=ye(we,he.iterator,Oe.arg);if("throw"===ct.type)return Oe.method="throw",Oe.arg=ct.arg,Oe.delegate=null,q;var dt=ct.arg;return dt?dt.done?(Oe[he.resultName]=dt.value,Oe.next=he.nextLoc,"return"!==Oe.method&&(Oe.method="next",Oe.arg=qe),Oe.delegate=null,q):dt:(Oe.method="throw",Oe.arg=new TypeError("iterator result is not an object"),Oe.delegate=null,q)}function ae(he){var Oe={tryLoc:he[0]};1 in he&&(Oe.catchLoc=he[1]),2 in he&&(Oe.finallyLoc=he[2],Oe.afterLoc=he[3]),this.tryEntries.push(Oe)}function ze(he){var Oe=he.completion||{};Oe.type="normal",delete Oe.arg,he.completion=Oe}function st(he){this.tryEntries=[{tryLoc:"root"}],he.forEach(ae,this),this.reset(!0)}function vt(he){if(he||""===he){var Oe=he[Z];if(Oe)return Oe.call(he);if("function"==typeof he.next)return he;if(!isNaN(he.length)){var Ce=-1,we=function ct(){for(;++Ce<he.length;)if(tt.call(he,Ce))return ct.value=he[Ce],ct.done=!1,ct;return ct.value=qe,ct.done=!0,ct};return we.next=we}}throw new TypeError(typeof he+" is not iterable")}return _e.prototype=pe,Ge(N,"constructor",{value:pe,configurable:!0}),Ge(pe,"constructor",{value:_e,configurable:!0}),_e.displayName=I(pe,se,"GeneratorFunction"),te.isGeneratorFunction=function(he){var Oe="function"==typeof he&&he.constructor;return!!Oe&&(Oe===_e||"GeneratorFunction"===(Oe.displayName||Oe.name))},te.mark=function(he){return Object.setPrototypeOf?Object.setPrototypeOf(he,pe):(he.__proto__=pe,I(he,se,"GeneratorFunction")),he.prototype=Object.create(N),he},te.awrap=function(he){return{__await:he}},B(X.prototype),I(X.prototype,Ee,function(){return this}),te.AsyncIterator=X,te.async=function(he,Oe,Ce,we,ct){void 0===ct&&(ct=Promise);var dt=new X(ie(he,Oe,Ce,we),ct);return te.isGeneratorFunction(Oe)?dt:dt.next().then(function(Ue){return Ue.done?Ue.value:dt.next()})},B(N),I(N,se,"Generator"),I(N,Z,function(){return this}),I(N,"toString",function(){return"[object Generator]"}),te.keys=function(he){var Oe=Object(he),Ce=[];for(var we in Oe)Ce.push(we);return Ce.reverse(),function ct(){for(;Ce.length;){var dt=Ce.pop();if(dt in Oe)return ct.value=dt,ct.done=!1,ct}return ct.done=!0,ct}},te.values=vt,st.prototype={constructor:st,reset:function(Oe){if(this.prev=0,this.next=0,this.sent=this._sent=qe,this.done=!1,this.delegate=null,this.method="next",this.arg=qe,this.tryEntries.forEach(ze),!Oe)for(var Ce in this)"t"===Ce.charAt(0)&&tt.call(this,Ce)&&!isNaN(+Ce.slice(1))&&(this[Ce]=qe)},stop:function(){this.done=!0;var Oe=this.tryEntries[0].completion;if("throw"===Oe.type)throw Oe.arg;return this.rval},dispatchException:function(Oe){if(this.done)throw Oe;var Ce=this;function we(Sn,xn){return Ue.type="throw",Ue.arg=Oe,Ce.next=Sn,xn&&(Ce.method="next",Ce.arg=qe),!!xn}for(var ct=this.tryEntries.length-1;ct>=0;--ct){var dt=this.tryEntries[ct],Ue=dt.completion;if("root"===dt.tryLoc)return we("end");if(dt.tryLoc<=this.prev){var Dt=tt.call(dt,"catchLoc"),E=tt.call(dt,"finallyLoc");if(Dt&&E){if(this.prev<dt.catchLoc)return we(dt.catchLoc,!0);if(this.prev<dt.finallyLoc)return we(dt.finallyLoc)}else if(Dt){if(this.prev<dt.catchLoc)return we(dt.catchLoc,!0)}else{if(!E)throw new Error("try statement without catch or finally");if(this.prev<dt.finallyLoc)return we(dt.finallyLoc)}}}},abrupt:function(Oe,Ce){for(var we=this.tryEntries.length-1;we>=0;--we){var ct=this.tryEntries[we];if(ct.tryLoc<=this.prev&&tt.call(ct,"finallyLoc")&&this.prev<ct.finallyLoc){var dt=ct;break}}dt&&("break"===Oe||"continue"===Oe)&&dt.tryLoc<=Ce&&Ce<=dt.finallyLoc&&(dt=null);var Ue=dt?dt.completion:{};return Ue.type=Oe,Ue.arg=Ce,dt?(this.method="next",this.next=dt.finallyLoc,q):this.complete(Ue)},complete:function(Oe,Ce){if("throw"===Oe.type)throw Oe.arg;return"break"===Oe.type||"continue"===Oe.type?this.next=Oe.arg:"return"===Oe.type?(this.rval=this.arg=Oe.arg,this.method="return",this.next="end"):"normal"===Oe.type&&Ce&&(this.next=Ce),q},finish:function(Oe){for(var Ce=this.tryEntries.length-1;Ce>=0;--Ce){var we=this.tryEntries[Ce];if(we.finallyLoc===Oe)return this.complete(we.completion,we.afterLoc),ze(we),q}},catch:function(Oe){for(var Ce=this.tryEntries.length-1;Ce>=0;--Ce){var we=this.tryEntries[Ce];if(we.tryLoc===Oe){var ct=we.completion;if("throw"===ct.type){var dt=ct.arg;ze(we)}return dt}}throw new Error("illegal catch attempt")},delegateYield:function(Oe,Ce,we){return this.delegate={iterator:vt(Oe),resultName:Ce,nextLoc:we},"next"===this.method&&(this.arg=qe),q}},te}typeof self<"u"&&self,pt.exports=function(){var Ge,He,qe={302:function(He,Z,Ee){var I;Z.formatArgs=function(I){if(I[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+I[0]+(this.useColors?"%c ":" ")+"+"+He.exports.humanize(this.diff),this.useColors){var ie="color: "+this.color;I.splice(1,0,ie,"color: inherit");var ye=0,W=0;I[0].replace(/%[a-zA-Z%]/g,function(ne){"%%"!==ne&&(ye++,"%c"===ne&&(W=ye))}),I.splice(W,0,ie)}},Z.save=function(I){try{I?Z.storage.setItem("debug",I):Z.storage.removeItem("debug")}catch{}},Z.load=function(){var I;try{I=Z.storage.getItem("debug")}catch{}return!I&&typeof process<"u"&&"env"in process&&(I=process.env.DEBUG),I},Z.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},Z.storage=function(){try{return localStorage}catch{}}(),Z.destroy=(I=!1,function(){I||(I=!0)}),Z.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],Z.log=console.debug||console.log||function(){},He.exports=Ee(65)(Z),He.exports.formatters.j=function(I){try{return JSON.stringify(I)}catch(ie){return"[UnexpectedJSONParseError]: "+ie.message}}},65:function(He,Z,Ee){He.exports=function(se){function I(W){var ne,ve,me,q=null;function be(){for(var _e=arguments.length,pe=new Array(_e),Re=0;Re<_e;Re++)pe[Re]=arguments[Re];if(be.enabled){var Qe=be,ke=Number(new Date);Qe.diff=ke-(ne||ke),Qe.prev=ne,Qe.curr=ke,ne=ke,pe[0]=I.coerce(pe[0]),"string"!=typeof pe[0]&&pe.unshift("%O");var B=0;pe[0]=pe[0].replace(/%([a-zA-Z%])/g,function(X,K){if("%%"===X)return"%";B++;var le=I.formatters[K];return"function"==typeof le&&(X=le.call(Qe,pe[B]),pe.splice(B,1),B--),X}),I.formatArgs.call(Qe,pe),(Qe.log||I.log).apply(Qe,pe)}}return be.namespace=W,be.useColors=I.useColors(),be.color=I.selectColor(W),be.extend=ie,be.destroy=I.destroy,Object.defineProperty(be,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==q?q:(ve!==I.namespaces&&(ve=I.namespaces,me=I.enabled(W)),me)},set:function(pe){q=pe}}),"function"==typeof I.init&&I.init(be),be}function ie(W,ne){var ve=I(this.namespace+(void 0===ne?":":ne)+W);return ve.log=this.log,ve}function ye(W){return W.toString().substring(2,W.toString().length-2).replace(/\.\*\?$/,"*")}return I.debug=I,I.default=I,I.coerce=function(W){return W instanceof Error?W.stack||W.message:W},I.disable=function(){var W=[].concat(I.names.map(ye),I.skips.map(ye).map(function(ne){return"-"+ne})).join(",");return I.enable(""),W},I.enable=function(W){var ne;I.save(W),I.namespaces=W,I.names=[],I.skips=[];var ve=("string"==typeof W?W:"").split(/[\s,]+/),me=ve.length;for(ne=0;ne<me;ne++)ve[ne]&&("-"===(W=ve[ne].replace(/\*/g,".*?"))[0]?I.skips.push(new RegExp("^"+W.slice(1)+"$")):I.names.push(new RegExp("^"+W+"$")))},I.enabled=function(W){if("*"===W[W.length-1])return!0;var ne,ve;for(ne=0,ve=I.skips.length;ne<ve;ne++)if(I.skips[ne].test(W))return!1;for(ne=0,ve=I.names.length;ne<ve;ne++)if(I.names[ne].test(W))return!0;return!1},I.humanize=Ee(247),I.destroy=function(){},Object.keys(se).forEach(function(W){I[W]=se[W]}),I.names=[],I.skips=[],I.formatters={},I.selectColor=function(W){for(var ne=0,ve=0;ve<W.length;ve++)ne=(ne<<5)-ne+W.charCodeAt(ve),ne|=0;return I.colors[Math.abs(ne)%I.colors.length]},I.enable(I.load()),I}},247:function(He){var Z=1e3,Ee=60*Z,se=60*Ee,I=24*se;function ne(ve,me,q,be){var _e=me>=1.5*q;return Math.round(ve/q)+" "+be+(_e?"s":"")}He.exports=function(ve,me){me=me||{};var q=typeof ve;if("string"===q&&ve.length>0)return function(ve){if(!((ve=String(ve)).length>100)){var me=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(ve);if(me){var q=parseFloat(me[1]);switch((me[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*q;case"weeks":case"week":case"w":return 6048e5*q;case"days":case"day":case"d":return q*I;case"hours":case"hour":case"hrs":case"hr":case"h":return q*se;case"minutes":case"minute":case"mins":case"min":case"m":return q*Ee;case"seconds":case"second":case"secs":case"sec":case"s":return q*Z;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return q;default:return}}}}(ve);if("number"===q&&isFinite(ve))return me.long?function(ve){var me=Math.abs(ve);return me>=I?ne(ve,me,I,"day"):me>=se?ne(ve,me,se,"hour"):me>=Ee?ne(ve,me,Ee,"minute"):me>=Z?ne(ve,me,Z,"second"):ve+" ms"}(ve):function(ve){var me=Math.abs(ve);return me>=I?Math.round(ve/I)+"d":me>=se?Math.round(ve/se)+"h":me>=Ee?Math.round(ve/Ee)+"m":me>=Z?Math.round(ve/Z)+"s":ve+"ms"}(ve);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ve))}}},te={};function Le(Ge){var He=te[Ge];if(void 0!==He)return He.exports;var Z=te[Ge]={exports:{}};return qe[Ge](Z,Z.exports,Le),Z.exports}He=Object.getPrototypeOf?function(Z){return Object.getPrototypeOf(Z)}:function(Z){return Z.__proto__},Le.t=function(Z,Ee){if(1&Ee&&(Z=this(Z)),8&Ee||"object"==typeof Z&&Z&&(4&Ee&&Z.__esModule||16&Ee&&"function"==typeof Z.then))return Z;var se=Object.create(null);Le.r(se);var I={};Ge=Ge||[null,He({}),He([]),He(He)];for(var ie=2&Ee&&Z;"object"==typeof ie&&!~Ge.indexOf(ie);ie=He(ie))Object.getOwnPropertyNames(ie).forEach(function(ye){return I[ye]=function(){return Z[ye]}});return I.default=function(){return Z},Le.d(se,I),se},Le.d=function(Ge,He){for(var Z in He)Le.o(He,Z)&&!Le.o(Ge,Z)&&Object.defineProperty(Ge,Z,{enumerable:!0,get:He[Z]})},Le.o=function(Ge,He){return Object.prototype.hasOwnProperty.call(Ge,He)},Le.r=function(Ge){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Ge,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Ge,"__esModule",{value:!0})};var tt={};return function(){"use strict";Le.r(tt),Le.d(tt,{ActionObjectType:function(){return Oe},ChannelType:function(){return Lr},ChildAppWindow:function(){return Qo},DialogDimension:function(){return on},ErrorCode:function(){return we},FileOpenPreference:function(){return he},FrameContexts:function(){return E},HostClientType:function(){return Ue},HostName:function(){return Dt},LiveShareHost:function(){return sa},NotificationTypes:function(){return qo},ParentAppWindow:function(){return uo},SecondaryM365ContentIdName:function(){return Ce},TaskModuleDimension:function(){return er},TeamType:function(){return Sn},UserSettingTypes:function(){return oo},UserTeamRole:function(){return xn},ViewerActionTypes:function(){return Bo},app:function(){return Ln},appEntity:function(){return Dn},appInitialization:function(){return Vr},appInstallDialog:function(){return so},authentication:function(){return Zi},barCode:function(){return qr},calendar:function(){return Ei},call:function(){return _o},chat:function(){return Wo},clipboard:function(){return ci},conversations:function(){return si},dialog:function(){return pr},enablePrintCapability:function(){return ss},executeDeepLink:function(){return vr},externalAppAuthentication:function(){return Jr},externalAppCardActions:function(){return Gi},files:function(){return Ot},geoLocation:function(){return Mi},getAdaptiveCardSchemaVersion:function(){return $o},getContext:function(){return ls},getMruTabInstances:function(){return Mo},getTabInstances:function(){return So},initialize:function(){return as},initializeWithFrameContext:function(){return Fi},liveShare:function(){return hi},location:function(){return xi},logs:function(){return zo},mail:function(){return Ii},marketplace:function(){return Ci},media:function(){return In},meeting:function(){return ui},meetingRoom:function(){return Kr},menus:function(){return Ji},monetization:function(){return Ti},navigateBack:function(){return oa},navigateCrossDomain:function(){return ia},navigateToTab:function(){return Vi},notifications:function(){return Ar},openFilePreview:function(){return ao},pages:function(){return Ut},people:function(){return ho},print:function(){return ea},profile:function(){return di},registerAppButtonClickHandler:function(){return cs},registerAppButtonHoverEnterHandler:function(){return ta},registerAppButtonHoverLeaveHandler:function(){return bo},registerBackButtonHandler:function(){return pi},registerBeforeUnloadHandler:function(){return ar},registerChangeSettingsHandler:function(){return wo},registerCustomHandler:function(){return Qa},registerFocusEnterHandler:function(){return na},registerFullScreenHandler:function(){return ki},registerOnLoadHandler:function(){return rn},registerOnThemeChangeHandler:function(){return or},registerUserSettingsChangeHandler:function(){return nl},remoteCamera:function(){return Ni},returnFocus:function(){return ra},search:function(){return Di},secondaryBrowser:function(){return Pi},sendCustomEvent:function(){return tl},sendCustomMessage:function(){return el},setFrameContext:function(){return Zr},settings:function(){return Ai},shareDeepLink:function(){return Yr},sharing:function(){return Nn},stageView:function(){return Jn},tasks:function(){return Li},teams:function(){return Cr},teamsCore:function(){return Ur},thirdPartyCloudStorage:function(){return yo},uploadCustomApp:function(){return Ks},version:function(){return Xi},videoEffects:function(){return Zn},videoEffectsEx:function(){return ei},visualMedia:function(){return vo},webStorage:function(){return Co}});var se,I,l,Ge=(0,Le(302).debug)("teamsJs");function He(l){return Ge.extend(l)}function Z(l,h){return l+"_"+h}function Ee(l){return/^v\d+_[\w.]+$/.test(l)}(l=se||(se={})).V_0="v0",l.V_1="v1",l.V_2="v2",l.V_3="v3",function(l){l.App_GetContext="app.getContext",l.App_Initialize="app.initialize",l.App_NotifyAppLoaded="app.notifyAppLoaded",l.App_NotifyExpectedFailure="app.notifyExpectedFailure",l.App_NotifyFailure="app.notifyFailure",l.App_NotifySuccess="app.notifySuccess",l.App_OpenLink="app.openLink",l.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",l.AppEntity_SelectAppEntity="appEntity.selectAppEntity",l.BarCode_HasPermission="barCode.hasPermission",l.BarCode_RequestPermission="barCode.requestPermission",l.BarCode_ScanBarCode="barCode.scanBarCode",l.Calendar_ComposeMeeting="calendar.composeMeeting",l.Calendar_OpenCalendarItem="calendar.openCalendarItem",l.Call_StartCall="call.startCall",l.Clipboard_Read="clipboard.read",l.Clipboard_Write="clipboard.write",l.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",l.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",l.Dialog_Update_Resize="dialog.update.resize",l.Dialog_Url_Bot_Open="dialog.url.bot.open",l.Dialog_Url_Open="dialog.url.open",l.Dialog_Url_Submit="dialog.url.submit",l.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",l.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",l.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",l.GeoLocation_HasPermission="geoLocation.hasPermission",l.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",l.GeoLocation_RequestPermission="geoLocation.hasPermission",l.GeoLocation_ShowLocation="geoLocation.showLocation",l.Location_GetLocation="location.getLocation",l.Location_ShowLocation="location.showLocation",l.Mail_ComposeMail="mail.composeMail",l.Mail_OpenMailItem="mail.openMailItem",l.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",l.Marketplace_GetCart="marketplace.getCart",l.Marketplace_RemoveCardItems="marketplace.removeCartItems",l.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",l.Media_CaptureImage="media.captureImage",l.Media_Controller="media.controller",l.Media_GetMedia="media.getMedia",l.Media_HasPermission="media.hasPermission",l.Media_RequestPermission="media.requestPermission",l.Media_ScanBarCode="media.scanBarCode",l.Media_SelectMedia="media.selectMedia",l.Media_ViewImages="media.viewImages",l.Navigation_NavigateBack="navigation.navigateBack",l.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",l.Navigation_NavigateToTab="navigation.navigateToTab",l.Navigation_ReturnFocus="navigation.returnFocus",l.Pages_AppButton_OnClick="pages.appButton.onClick",l.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",l.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",l.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",l.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",l.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",l.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",l.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",l.Pages_Config_SetConfig="pages.config.setConfig",l.Pages_Config_SetValidityState="pages.config.setValidityState",l.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",l.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",l.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",l.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",l.Pages_GetConfig="pages.getConfig.",l.Pages_NavigateCrossDomain="pages.navigateCrossDomain",l.Pages_NavigateToApp="pages.navigateToApp",l.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",l.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",l.Pages_ReturnFocus="pages.returnFocus",l.Pages_SetCurrentFrame="pages.setCurrentFrame",l.Pages_ShareDeepLink="pages.shareDeepLink",l.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",l.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",l.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",l.PublicAPIs_ExecuteDeepLink="executeDeepLink",l.PublicAPIs_GetContext="getContext",l.PublicAPIs_GetMruTabInstances="getMruTabInstances",l.PublicAPIs_GetTabInstances="getTabInstances",l.PublicAPIs_Initialize="initialize",l.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",l.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",l.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",l.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",l.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",l.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",l.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",l.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",l.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",l.PublicAPIs_SetFrameContext="setFrameContext",l.PublicAPIs_ShareDeepLink="shareDeepLink",l.RegisterHandler="registerHandler",l.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",l.Settings_Remove_Failure="settings.remove.failure",l.Settings_Remove_Success="settings.remove.success",l.Settings_Save_Failure="settings.save.failure",l.Settings_Save_Success="settings.save.success",l.Tasks_StartTask="tasks.startTask",l.Tasks_SubmitTask="tasks.submitTask",l.Tasks_UpdateTask="tasks.updateTask"}(I||(I={}));var ie=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"]}'),ye="2.0.1",W="2.0.3",ve="1.8.0",me=Le.t(ie,2).validOrigins,q=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),be=/^https:\/\//,_e="https",pe="teams.microsoft.com",Re="The library has not yet been initialized",Qe="The runtime has not yet been initialized",ke="The runtime version is not supported",N=function(){};N.initializeCalled=!1,N.initializeCompleted=!1,N.additionalValidOrigins=[],N.initializePromise=void 0,N.isFramelessWindow=!1,N.frameContext=void 0,N.hostClientType=void 0,N.printCapabilityEnabled=!1;var X,B={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},K=new Uint8Array(16);function le(){if(!X&&!(X=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return X(K)}for(var ae=[],ze=0;ze<256;++ze)ae.push((ze+256).toString(16).slice(1));var he,Oe,Ce,we,ct,dt,Ue,Dt,E,Sn,xn,on,vt=function(h,C,y){if(B.randomUUID&&!C&&!h)return B.randomUUID();var m=(h=h||{}).random||(h.rng||le)();if(m[6]=15&m[6]|64,m[8]=63&m[8]|128,C){y=y||0;for(var S=0;S<16;++S)C[y+S]=m[S];return C}return function(l,h){return void 0===h&&(h=0),(ae[l[h+0]]+ae[l[h+1]]+ae[l[h+2]]+ae[l[h+3]]+"-"+ae[l[h+4]]+ae[l[h+5]]+"-"+ae[l[h+6]]+ae[l[h+7]]+"-"+ae[l[h+8]]+ae[l[h+9]]+"-"+ae[l[h+10]]+ae[l[h+11]]+ae[l[h+12]]+ae[l[h+13]]+ae[l[h+14]]+ae[l[h+15]]).toLowerCase()}(m)};(function(l){l.Inline="inline",l.Desktop="desktop",l.Web="web"})(he||(he={})),function(l){l.M365Content="m365content"}(Oe||(Oe={})),function(l){l.DriveId="driveId",l.GroupId="groupId",l.SiteId="siteId",l.UserId="userId"}(Ce||(Ce={})),function(l){l[l.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",l[l.INTERNAL_ERROR=500]="INTERNAL_ERROR",l[l.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",l[l.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",l[l.NETWORK_ERROR=2e3]="NETWORK_ERROR",l[l.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",l[l.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",l[l.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",l[l.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",l[l.THROTTLE=7e3]="THROTTLE",l[l.USER_ABORT=8e3]="USER_ABORT",l[l.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",l[l.OLD_PLATFORM=9e3]="OLD_PLATFORM",l[l.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",l[l.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(we||(we={})),function(l){l.GeoLocation="geolocation",l.Media="media"}(ct||(ct={})),function(l){l.TextPlain="text/plain",l.TextHtml="text/html",l.ImagePNG="image/png",l.ImageJPEG="image/jpeg"}(dt||(dt={})),function(l){l.desktop="desktop",l.web="web",l.android="android",l.ios="ios",l.ipados="ipados",l.macos="macos",l.rigel="rigel",l.surfaceHub="surfaceHub",l.teamsRoomsWindows="teamsRoomsWindows",l.teamsRoomsAndroid="teamsRoomsAndroid",l.teamsPhones="teamsPhones",l.teamsDisplays="teamsDisplays"}(Ue||(Ue={})),function(l){l.office="Office",l.outlook="Outlook",l.outlookWin32="OutlookWin32",l.orange="Orange",l.places="Places",l.teams="Teams",l.teamsModern="TeamsModern"}(Dt||(Dt={})),function(l){l.settings="settings",l.content="content",l.authentication="authentication",l.remove="remove",l.task="task",l.sidePanel="sidePanel",l.stage="stage",l.meetingStage="meetingStage"}(E||(E={})),function(l){l[l.Standard=0]="Standard",l[l.Edu=1]="Edu",l[l.Class=2]="Class",l[l.Plc=3]="Plc",l[l.Staff=4]="Staff"}(Sn||(Sn={})),function(l){l[l.Admin=0]="Admin",l[l.User=1]="User",l[l.Guest=2]="Guest"}(xn||(xn={})),function(l){l.Large="large",l.Medium="medium",l.Small="small"}(on||(on={}));var Lr,er=on;!function(l){l.Regular="Regular",l.Private="Private",l.Shared="Shared"}(Lr||(Lr={}));var Pe={errorCode:we.NOT_SUPPORTED_ON_PLATFORM},br={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},Bi=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),Rn=new Error("Invalid response: Received more images than the specified max limit in the response.");function jn(l){return function(h,C){if(!h)throw new Error(l||C)}}function Yt(l,h){if("string"!=typeof l||"string"!=typeof h)return NaN;var C=l.split("."),y=h.split(".");function m(F){return/^\d+$/.test(F)}if(!C.every(m)||!y.every(m))return NaN;for(;C.length<y.length;)C.push("0");for(;y.length<C.length;)y.push("0");for(var S=0;S<C.length;++S)if(Number(C[S])!=Number(y[S]))return Number(C[S])>Number(y[S])?1:-1;return 0}function wr(){return vt()}function ni(l){return Object.keys(l).forEach(function(h){"object"==typeof l[h]&&ni(l[h])}),Object.freeze(l)}function sr(l,h){for(var C=arguments.length,y=new Array(C>2?C-2:0),m=2;m<C;m++)y[m-2]=arguments[m];var S=l.apply(void 0,y);return S.then(function(){h&&h(null)}).catch(function(F){h&&h(F)}),S}function Gr(l){return!(Yt(l.majorVersion+"."+l.minorVersion,"1.5")>=0)}function nr(l){return"https:"===l.protocol}function rr(l,h){return new Promise(function(C,y){l||y("MimeType cannot be null or empty."),h||y("Base64 string cannot be null or empty.");var m=atob(h);if(l.startsWith("image/")){for(var S=new Uint8Array(m.length),F=0;F<m.length;F++)S[F]=m.charCodeAt(F);C(new Blob([S],{type:l}))}C(new Blob([m],{type:l}))})}function ht(l){return new Promise(function(h,C){0===l.size&&C(new Error("Blob cannot be empty."));var y=new FileReader;y.onloadend=function(){y.result?h(y.result.toString().split(",")[1]):C(new Error("Failed to read the blob"))},y.onerror=function(){C(y.error)},y.readAsDataURL(l)})}function Ke(){if(Zt())throw new Error("window object undefined at SSR check");return window}function Zt(){return typeof window>"u"}var Wn=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Ye(l){if(!Wn.test(l))throw new Error("App ID is not valid. Must be GUID format. App ID: "+l)}var Cn=He("runtime"),pn=3;function zn(l){return l.apiVersion===pn}var O={apiVersion:-1,supports:{}},Ts={apiVersion:3,hostVersionsInfo:br,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},Fa=[Ue.desktop,Ue.web,Ue.rigel,Ue.surfaceHub,Ue.teamsRoomsWindows,Ue.teamsRoomsAndroid,Ue.teamsPhones,Ue.teamsDisplays],ji=[].concat(Fa,[Ue.android,Ue.ios,Ue.ipados]);var Es=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(h){var C;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:h.isLegacyTeams,supports:Object.assign(Object.assign({},h.supports),{dialog:h.supports.dialog?{card:void 0,url:h.supports.dialog,update:null===(C=h.supports.dialog)||void 0===C?void 0:C.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(h){var m=function(h,C){var y={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&C.indexOf(m)<0&&(y[m]=h[m]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var S=0;for(m=Object.getOwnPropertySymbols(h);S<m.length;S++)C.indexOf(m[S])<0&&Object.prototype.propertyIsEnumerable.call(h,m[S])&&(y[m[S]]=h[m[S]])}return y}(h.supports,["appNotification"]);return Object.assign(Object.assign({},h),{apiVersion:3,supports:m})}}],ko={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:Fa}],"1.9.0":[{capability:{location:{}},hostClientTypes:ji}],"2.0.0":[{capability:{people:{}},hostClientTypes:ji},{capability:{sharing:{}},hostClientTypes:[Ue.desktop,Ue.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[Ue.android,Ue.desktop,Ue.ios,Ue.teamsRoomsAndroid,Ue.teamsPhones,Ue.teamsDisplays,Ue.web]},{capability:{webStorage:{}},hostClientTypes:[Ue.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[Ue.android,Ue.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[Ue.android,Ue.ios]}]},ri=Cn.extend("generateBackCompatRuntimeConfig");function Aa(l,h){var C=Object.assign({},l);for(var y in h)Object.prototype.hasOwnProperty.call(h,y)&&("object"!=typeof h[y]||Array.isArray(h[y])?y in l||(C[y]=h[y]):C[y]=Aa(l[y]||{},h[y]));return C}function Wi(l,h,C){ri("generating back compat runtime config for %s",l);var y=Object.assign({},h.supports);ri("Supported capabilities in config before updating based on highestSupportedVersion: %o",y),Object.keys(C).forEach(function(S){Yt(l,S)>=0&&C[S].forEach(function(F){void 0!==N.hostClientType&&F.hostClientTypes.includes(N.hostClientType)&&(y=Aa(y,F.capability))})});var m={apiVersion:pn,hostVersionsInfo:br,isLegacyTeams:!0,supports:y};return ri("Runtime config after updating based on highestSupportedVersion: %o",m),m}var $i=Cn.extend("applyRuntimeConfig");function Qi(l){"string"==typeof l.apiVersion&&($i("Trying to apply runtime with string apiVersion, processing as v1: %o",l),l=Object.assign(Object.assign({},l),{apiVersion:1})),$i("Fast-forwarding runtime %o",l);var h=function(l){var h=l;if(h.apiVersion<pn&&Es.forEach(function(C){h.apiVersion===C.versionToUpgradeFrom&&(h=C.upgradeToNextVersion(h))}),zn(h))return h;throw new Error("Received a runtime that could not be upgraded to the latest version")}(l);$i("Applying runtime %o",h),O=ni(h)}var Xi="2.19.0",Is=He("internal"),Zl=Is.extend("ensureInitializeCalled"),Ds=Is.extend("ensureInitialized");function dr(){if(!N.initializeCalled)throw Zl(Re),new Error(Re)}function U(l){if(!N.initializeCompleted)throw Ds("%s. initializeCalled: %s",Re,N.initializeCalled.toString()),new Error(Re);for(var h=arguments.length,C=new Array(h>1?h-1:0),y=1;y<h;y++)C[y-1]=arguments[y];if(C&&C.length>0){for(var m=!1,S=0;S<C.length;S++)if(C[S]===N.frameContext){m=!0;break}if(!m)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(C)+'. Current context: "'+N.frameContext+'".')}return function(l){if(zn(l))return!0;throw-1===l.apiVersion?new Error(Qe):new Error(ke)}(l)}function $n(l){void 0===l&&(l=ye);var h=Yt(N.clientSupportedSDKVersion,l);return!isNaN(h)&&h>=0}function Fo(){return N.hostClientType==Ue.android||N.hostClientType==Ue.ios||N.hostClientType==Ue.ipados}function Yi(l){if(void 0===l&&(l=ye),!Fo())throw{errorCode:we.NOT_SUPPORTED_ON_PLATFORM};if(!$n(l))throw{errorCode:we.OLD_PLATFORM}}function Ht(l){return null==l}var Zi,Ra=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})},nn=[],Sr=He("validateOrigin");function Vs(){return Ra(this,void 0,void 0,j().mark(function l(){return j().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",0!==nn.length?nn:Zt()?(nn=me,me):fetch(q).then(function(y){if(!y.ok)throw new Error("Invalid Response from Fetch Call");return y.json().then(function(m){if(As(JSON.stringify(m)))return nn=m.validOrigins;throw new Error("Valid Origins List Is Invalid")})}).catch(function(y){return Sr("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",y),nn=me}));case 1:case"end":return C.stop()}},l)}))}function As(l){var h=JSON.parse(l);try{h=JSON.parse(l)}catch{return!1}if(!h.validOrigins)return!1;for(var y,C=e(h.validOrigins);!(y=C()).done;){var m=y.value;try{new URL("https://"+m)}catch{return Sr("isValidOriginsFromCDN call failed to validate origin: %s",m),!1}}return!0}function Mr(l,h){if("*."===l.substring(0,2)){var C=l.substring(1);if(h.length>C.length&&h.split(".").length===C.split(".").length&&h.substring(h.length-C.length)===C)return!0}else if(l===h)return!0;return!1}function Kl(l){return Vs().then(function(h){if(!nr(l))return Sr("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",l,l.protocol),!1;var C=l.host;if(h.some(function(F){return Mr(F,C)}))return!0;for(var m,y=e(N.additionalValidOrigins);!(m=y()).done;){var S=m.value;if(Mr("https://"===S.substring(0,8)?S.substring(8):S,C))return!0}return Sr("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",l,h,N.additionalValidOrigins),!1})}!function(l){var h,C,y,re;function S(re){return new Promise(function(Ne,$e){if(N.hostClientType===Ue.desktop||N.hostClientType===Ue.android||N.hostClientType===Ue.ios||N.hostClientType===Ue.ipados||N.hostClientType===Ue.macos||N.hostClientType===Ue.rigel||N.hostClientType===Ue.teamsRoomsWindows||N.hostClientType===Ue.teamsRoomsAndroid||N.hostClientType===Ue.teamsPhones||N.hostClientType===Ue.teamsDisplays||N.hostClientType===Ue.surfaceHub){var Ie=document.createElement("a");Ie.href=re.url,Ne(Qn("authentication.authenticate",[Ie.href,re.width,re.height,re.isExternal]).then(function(Pt){var yn=Pt[1];if(Pt[0])return yn;throw new Error(yn)}))}else h={success:Ne,fail:$e},function(re){R();var Ne=re.width||600,$e=re.height||400;Ne=Math.min(Ne,Fe.currentWindow.outerWidth-400),$e=Math.min($e,Fe.currentWindow.outerHeight-200);var Ie=document.createElement("a");Ie.href=re.url.replace("{oauthRedirectMethod}","web");var Pt=void 0!==Fe.currentWindow.screenLeft?Fe.currentWindow.screenLeft:Fe.currentWindow.screenX,Ft=void 0!==Fe.currentWindow.screenTop?Fe.currentWindow.screenTop:Fe.currentWindow.screenY;Fe.childWindow=Fe.currentWindow.open(Ie.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+(Ft+=Fe.currentWindow.outerHeight/2-$e/2)+", left="+(Pt+=Fe.currentWindow.outerWidth/2-Ne/2)+", width="+Ne+", height="+$e),Fe.childWindow?(k(),C=Fe.currentWindow.setInterval(function(){if(!Fe.childWindow||Fe.childWindow.closed)De("CancelledByUser");else{var re=Fe.childOrigin;try{Fe.childOrigin="*",Xn("ping")}finally{Fe.childOrigin=re}}},100),et("initialize",function(){return[E.authentication,N.hostClientType]}),et("navigateCrossDomain",function(){return!1})):De("FailedToOpenWindow")}(re)})}function R(){k();try{Fe.childWindow&&Fe.childWindow.close()}finally{Fe.childWindow=null,Fe.childOrigin=null}}function k(){C&&(clearInterval(C),C=0),hn("initialize"),hn("navigateCrossDomain")}function ee(re){try{h&&h.success(re)}finally{h=void 0,R()}}function De(re){try{h&&h.fail(new Error(re))}finally{h=void 0,R()}}function wt(re,Ne,$e){if(re){var Ie=document.createElement("a");Ie.href=decodeURIComponent(re),Ie.host&&Ie.host!==Ke().location.host&&"outlook.office.com"===Ie.host&&Ie.search.indexOf("client_type=Win32_Outlook")>-1&&(Ne&&"result"===Ne&&($e&&(Ie.href=Te(Ie.href,"result",$e)),Fe.currentWindow.location.assign(Te(Ie.href,"authSuccess",""))),Ne&&"reason"===Ne&&($e&&(Ie.href=Te(Ie.href,"reason",$e)),Fe.currentWindow.location.assign(Te(Ie.href,"authFailure",""))))}}function Te(re,Ne,$e){var Ie=re.indexOf("#"),Pt=-1===Ie?"#":re.substr(Ie);return Pt=Pt+"&"+Ne+(""!==$e?"="+$e:""),(re=-1===Ie?re:re.substr(0,Ie))+Pt}l.initialize=function(){et("authentication.authenticate.success",ee,!1),et("authentication.authenticate.failure",De,!1)},l.registerAuthenticationHandlers=function(re){y=re},l.authenticate=function(re){var Ne=void 0!==re,$e=Ne?re:y;if(!$e)throw new Error("No parameters are provided for authentication");return U(O,E.content,E.sidePanel,E.settings,E.remove,E.task,E.stage,E.meetingStage),S($e).then(function(Ie){try{return $e&&$e.successCallback?($e.successCallback(Ie),""):Ie}finally{Ne||(y=void 0)}}).catch(function(Ie){try{if($e&&$e.failureCallback)return $e.failureCallback(Ie.message),"";throw Ie}finally{Ne||(y=void 0)}})},l.getAuthToken=function(re){return dr(),function(re){return new Promise(function(Ne){Ne(Qn("authentication.getAuthToken",[re?.resources,re?.claims,re?.silent]))}).then(function(Ne){var Ie=Ne[1];if(Ne[0])return Ie;throw new Error(Ie)})}(re).then(function(Ne){return re&&re.successCallback?(re.successCallback(Ne),""):Ne}).catch(function(Ne){if(re&&re.failureCallback)return re.failureCallback(Ne.message),"";throw Ne})},l.getUser=function(re){return dr(),new Promise(function(re){re(Qn("authentication.getUser"))}).then(function(re){var $e=re[1];if(re[0])return $e;throw new Error($e)}).then(function(Ne){return re&&re.successCallback?(re.successCallback(Ne),null):Ne}).catch(function(Ne){if(re&&re.failureCallback)return re.failureCallback(Ne.message),null;throw Ne})},l.notifySuccess=function(re,Ne){wt(Ne,"result",re),U(O,E.authentication),We("authentication.authenticate.success",[re]),zr(Fe.parentWindow,function(){return setTimeout(function(){return Fe.currentWindow.close()},200)})},l.notifyFailure=function(re,Ne){wt(Ne,"reason",re),U(O,E.authentication),We("authentication.authenticate.failure",[re]),zr(Fe.parentWindow,function(){return setTimeout(function(){return Fe.currentWindow.close()},200)})},(re=l.DataResidency||(l.DataResidency={})).Public="public",re.EUDB="eudb",re.Other="other"}(Zi||(Zi={}));var pr,Ji,Nr=se.V_2;function Rs(l,h){if(U(O,E.content,E.sidePanel,E.task,E.meetingStage),!pr.update.isSupported())throw Pe;Tt(l,"tasks.updateTask",[h])}function La(l,h,C,y){if(U(O,E.content,E.sidePanel,E.meetingStage),!pr.url.isSupported())throw Pe;y&&et("messageForParent",y),Tt(l,"tasks.startTask",[pr.url.getDialogInfoFromUrlDialogInfo(h)],function(m,S){C?.({err:m,result:S}),hn("messageForParent")})}function Ls(l,h,C,y){if(U(O,E.content,E.sidePanel,E.meetingStage),!pr.url.bot.isSupported())throw Pe;y&&et("messageForParent",y),Tt(l,"tasks.startTask",[pr.url.getDialogInfoFromBotUrlDialogInfo(h)],function(m,S){C?.({err:m,result:S}),hn("messageForParent")})}function Gs(l,h,C){if(U(O,E.content,E.task),!pr.url.isSupported())throw Pe;Tt(l,"tasks.completeTask",[h,C?Array.isArray(C)?C:[C]:[]])}(function(l){var F,h=[];function C(F){N.frameContext&&(N.frameContext===E.task?h.push(F):hn("messageForChild"))}l.initialize=function(){et("messageForChild",C,!1)},function(F){function A(){return U(O)&&void 0!==(O.supports.dialog&&O.supports.dialog.url)}var k;function V(k){return{url:k.url,height:k.size?k.size.height:on.Small,width:k.size?k.size.width:on.Small,title:k.title,fallbackUrl:k.fallbackUrl}}F.open=function(k,J,ee){La(Z(Nr,I.Dialog_Url_Open),k,J,ee)},F.submit=function(k,J){Gs(Z(Nr,I.Dialog_Url_Submit),k,J)},F.sendMessageToParentFromDialog=function(k){if(U(O,E.task),!A())throw Pe;Tt(Z(Nr,I.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[k])},F.sendMessageToDialog=function(k){if(U(O,E.content,E.sidePanel,E.meetingStage),!A())throw Pe;Tt(Z(Nr,I.Dialog_Url_SendMessageToDialog),"messageForChild",[k])},F.registerOnMessageFromParent=function(k){if(U(O,E.task),!A())throw Pe;for(hn("messageForChild"),et("messageForChild",k),h.reverse();h.length>0;)k(h.pop())},F.isSupported=A,(k=F.bot||(F.bot={})).open=function(J,ee,De){Ls(Z(Nr,I.Dialog_Url_Bot_Open),J,ee,De)},k.isSupported=function(){return U(O)&&void 0!==(O.supports.dialog&&O.supports.dialog.url&&O.supports.dialog.url.bot)},F.getDialogInfoFromUrlDialogInfo=V,F.getDialogInfoFromBotUrlDialogInfo=function(k){var J=V(k);return J.completionBotId=k.completionBotId,J}}(l.url||(l.url={})),l.isSupported=function(){return!(!U(O)||!O.supports.dialog)},(F=l.update||(l.update={})).resize=function(A){Rs(Z(Nr,I.Dialog_Update_Resize),A)},F.isSupported=function(){return!(!U(O)||!O.supports.dialog||!O.supports.dialog.update)},function(F){function A(){var J=O.hostVersionsInfo&&O.hostVersionsInfo.adaptiveCardSchemaVersion&&!Gr(O.hostVersionsInfo.adaptiveCardSchemaVersion);return U(O)&&void 0!==(J&&O.supports.dialog&&O.supports.dialog.card)}function V(J){return{card:J.card,height:J.size?J.size.height:on.Small,width:J.size?J.size.width:on.Small,title:J.title}}F.open=function(J,ee){if(U(O,E.content,E.sidePanel,E.meetingStage),!A())throw Pe;var De=V(J);Tt(Z(Nr,I.Dialog_AdaptiveCard_Open),"tasks.startTask",[De],function(wt,Te){ee?.({err:wt,result:Te})})},F.isSupported=A,function(J){function ee(){var De=O.hostVersionsInfo&&O.hostVersionsInfo.adaptiveCardSchemaVersion&&!Gr(O.hostVersionsInfo.adaptiveCardSchemaVersion);return U(O)&&void 0!==(De&&O.supports.dialog&&O.supports.dialog.card&&O.supports.dialog.card.bot)}J.open=function(De,wt){if(U(O,E.content,E.sidePanel,E.meetingStage),!ee())throw Pe;var Te=function(J){var ee=V(J);return ee.completionBotId=J.completionBotId,ee}(De);Tt(Z(Nr,I.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[Te],function(re,Ne){wt?.({err:re,result:Ne})})},J.isSupported=ee}(F.bot||(F.bot={}))}(l.adaptiveCard||(l.adaptiveCard={}))})(pr||(pr={})),function(l){var y,m,S,k;function F(k){S&&S(k)||(U(O),We("viewConfigItemPress",[k]))}function A(k){y&&y(k)||(U(O),We("handleNavBarMenuItemPress",[k]))}function R(k){m&&m(k)||(U(O),We("handleActionMenuItemPress",[k]))}function V(){return!(!U(O)||!O.supports.menus)}(k=l.DisplayMode||(l.DisplayMode={}))[k.ifRoom=0]="ifRoom",k[k.overflowOnly=1]="overflowOnly",l.MenuItem=function(){return function(){this.enabled=!0,this.selected=!1}}(),function(k){k.dropDown="dropDown",k.popOver="popOver"}(l.MenuListType||(l.MenuListType={})),l.initialize=function(){et("navBarMenuItemPress",A,!1),et("actionMenuItemPress",R,!1),et("setModuleView",F,!1)},l.setUpViews=function(k,J){if(U(O),!V())throw Pe;S=J,We("setUpViews",[k])},l.setNavBarMenu=function(k,J){if(U(O),!V())throw Pe;y=J,We("setNavBarMenu",[k])},l.showActionMenu=function(k,J){if(U(O),!V())throw Pe;m=J,We("showActionMenu",[k])},l.isSupported=V}(Ji||(Ji={}));var Hr=se.V_2,ec=5e3,Ns=He("app");function Ga(l,h){return Zt()?(Ns.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(l,h,C){return new Promise(function(y,m){var S=setTimeout(m,h,C);l().then(function(F){clearTimeout(S),y(F)}).catch(function(F){clearTimeout(S),m(F)})})}(function(){return function(l,h){return new Promise(function(C){N.initializeCalled||(N.initializeCalled=!0,ft.initializeHandlers(),N.initializePromise=function(l,h){var C=this;if(Qt.messageListener=function(m){return jt(C,void 0,void 0,j().mark(function S(){return j().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,Ba(m);case 2:return A.abrupt("return",A.sent);case 3:case"end":return A.stop()}},S)}))},Fe.currentWindow=Fe.currentWindow||Ke(),Fe.parentWindow=Fe.currentWindow.parent!==Fe.currentWindow.self?Fe.currentWindow.parent:Fe.currentWindow.opener,(Fe.parentWindow||l)&&Fe.currentWindow.addEventListener("message",Qt.messageListener,!1),!Fe.parentWindow){var y=Fe.currentWindow;if(!y.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));N.isFramelessWindow=!0,y.onNativeMessage=no}try{return Fe.parentOrigin="*",Tr(h,"initialize",[Xi,pn]).then(function(m){return{context:m[0],clientType:m[1],runtimeConfig:m[2],clientSupportedSDKVersion:m[3]}})}finally{Fe.parentOrigin=null}}(h,l).then(function(y){var S=y.clientType,F=y.runtimeConfig,A=y.clientSupportedSDKVersion,R=void 0===A?ye:A;N.frameContext=y.context,N.hostClientType=S,N.clientSupportedSDKVersion=R;try{ii("Parsing %s",F);var V=JSON.parse(F);if(ii("Checking if %o is a valid runtime object",V??"null"),!V||!V.apiVersion)throw new Error("Received runtime config is invalid");F&&Qi(V)}catch(J){if(!(J instanceof SyntaxError))throw J;try{ii("Attempting to parse %s as an SDK version",F),isNaN(Yt(F,ye))||(N.clientSupportedSDKVersion=F);var k=JSON.parse(R);if(ii("givenRuntimeConfig parsed to %o",k??"null"),!k)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");Qi(k)}catch(ee){if(!(ee instanceof SyntaxError))throw ee;Qi(Wi(N.clientSupportedSDKVersion,Ts,ko))}}N.initializeCompleted=!0}),Zi.initialize(),Ji.initialize(),Ut.config.initialize(),pr.initialize()),Array.isArray(h)&&function(l){var h=N.additionalValidOrigins.concat(l.filter(function(y){return"string"==typeof y&&be.test(y)})),C={};h=h.filter(function(y){return!C[y]&&(C[y]=!0,!0)}),N.additionalValidOrigins=h}(h),void 0!==N.initializePromise?C(N.initializePromise):ii("GlobalVars.initializePromise is unexpectedly undefined")})}(l,h)},ec,new Error("SDK initialization timed out."))}var Ln,ii=Ns.extend("initializeHelper");function Ki(l,h){!Ht(h)&&dr(),function(l,h){ft.themeChangeHandler=h,!Ht(h)&&Tt(l,"registerHandler",["themeChange"])}(l,h)}function Na(l,h){return new Promise(function(C){U(O,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),C(Xt(l,"executeDeepLink",h))})}!function(l){var S,h=He("app");l.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(S=l.FailedReason||(l.FailedReason={})).AuthFailed="AuthFailed",S.Timeout="Timeout",S.Other="Other",function(S){S.PermissionError="PermissionError",S.NotFound="NotFound",S.Throttling="Throttling",S.Offline="Offline",S.Other="Other"}(l.ExpectedFailureReason||(l.ExpectedFailureReason={})),l.isInitialized=function(){return N.initializeCompleted},l.getFrameContext=function(){return N.frameContext},function(){if(!Zt()){var S=document.getElementsByTagName("script"),F=S&&S[S.length-1]&&S[S.length-1].src,A="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";F&&0!==F.length?h("teamsjs is being used from %s. %s",F,A):h("teamsjs is being used from a script tag embedded directly in your html. %s",A)}}(),l.initialize=function(S){return function(){Ra(this,void 0,void 0,j().mark(function l(){return j().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,Vs();case 2:case"end":return C.stop()}},l)}))}(),Ga(Z(Hr,I.App_Initialize),S)},l._initialize=function(S){Fe.currentWindow=S},l._uninitialize=function(){N.initializeCalled&&(ft.uninitializeHandlers(),N.initializeCalled=!1,N.initializeCompleted=!1,N.initializePromise=void 0,N.additionalValidOrigins=[],N.frameContext=void 0,N.hostClientType=void 0,N.isFramelessWindow=!1,Fe.currentWindow&&Fe.currentWindow.removeEventListener("message",Qt.messageListener,!1),Fe.currentWindow=null,Fe.parentWindow=null,Fe.parentOrigin=null,Fe.childWindow=null,Fe.childOrigin=null,Qt.parentMessageQueue=[],Qt.childMessageQueue=[],Qt.nextMessageId=0,Qt.callbacks={},Qt.promiseCallbacks={})},l.getContext=function(){return new Promise(function(S){dr(),S(xr(Z(Hr,I.App_GetContext),"getContext"))}).then(function(S){return function(l){var h;return{actionInfo:l.actionInfo,app:{locale:l.locale,sessionId:l.appSessionId?l.appSessionId:"",theme:l.theme?l.theme:"default",iconPositionVertical:l.appIconPosition,osLocaleInfo:l.osLocaleInfo,parentMessageId:l.parentMessageId,userClickTime:l.userClickTime,userFileOpenPreference:l.userFileOpenPreference,host:{name:l.hostName?l.hostName:Dt.teams,clientType:l.hostClientType?l.hostClientType:Ue.web,sessionId:l.sessionId?l.sessionId:"",ringId:l.ringId},appLaunchId:l.appLaunchId},page:{id:l.entityId,frameContext:l.frameContext?l.frameContext:N.frameContext,subPageId:l.subEntityId,isFullScreen:l.isFullScreen,isMultiWindow:l.isMultiWindow,sourceOrigin:l.sourceOrigin},user:{id:null!==(h=l.userObjectId)&&void 0!==h?h:"",displayName:l.userDisplayName,isCallingAllowed:l.isCallingAllowed,isPSTNCallingAllowed:l.isPSTNCallingAllowed,licenseType:l.userLicenseType,loginHint:l.loginHint,userPrincipalName:l.userPrincipalName,tenant:l.tid?{id:l.tid,teamsSku:l.tenantSKU}:void 0},channel:l.channelId?{id:l.channelId,displayName:l.channelName,relativeUrl:l.channelRelativeUrl,membershipType:l.channelType,defaultOneNoteSectionId:l.defaultOneNoteSectionId,ownerGroupId:l.hostTeamGroupId,ownerTenantId:l.hostTeamTenantId}:void 0,chat:l.chatId?{id:l.chatId}:void 0,meeting:l.meetingId?{id:l.meetingId}:void 0,sharepoint:l.sharepoint,team:l.teamId?{internalId:l.teamId,displayName:l.teamName,type:l.teamType,groupId:l.groupId,templateId:l.teamTemplateId,isArchived:l.isTeamArchived,userRole:l.userTeamRole}:void 0,sharePointSite:l.teamSiteUrl||l.teamSiteDomain||l.teamSitePath||l.mySitePath||l.mySiteDomain?{teamSiteUrl:l.teamSiteUrl,teamSiteDomain:l.teamSiteDomain,teamSitePath:l.teamSitePath,teamSiteId:l.teamSiteId,mySitePath:l.mySitePath,mySiteDomain:l.mySiteDomain}:void 0}}(S)})},l.notifyAppLoaded=function(){dr(),Tt(Z(Hr,I.App_NotifyAppLoaded),l.Messages.AppLoaded,[Xi])},l.notifySuccess=function(){dr(),Tt(Z(Hr,I.App_NotifySuccess),l.Messages.Success,[Xi])},l.notifyFailure=function(S){dr(),Tt(Z(Hr,I.App_NotifyFailure),l.Messages.Failure,[S.reason,S.message])},l.notifyExpectedFailure=function(S){dr(),Tt(Z(Hr,I.App_NotifyExpectedFailure),l.Messages.ExpectedFailure,[S.reason,S.message])},l.registerOnThemeChangeHandler=function(S){Ki(Z(Hr,I.App_RegisterOnThemeChangeHandler),S)},l.openLink=function(S){return Na(Z(Hr,I.App_OpenLink),S)},function(S){S.registerBeforeSuspendOrTerminateHandler=function(F){if(!F)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");U(O),function(l){ft.beforeSuspendOrTerminateHandler=l,!Ht(l)&&We("registerHandler",["beforeUnload"])}(F)},S.registerOnResumeHandler=function(F){if(!F)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");U(O),function(l){ft.resumeHandler=l,!Ht(l)&&We("registerHandler",["load"])}(F)}}(l.lifecycle||(l.lifecycle={}))}(Ln||(Ln={}));var Ut,Nt=se.V_2;function Vo(l,h){return new Promise(function(C){if(U(O,E.content,E.sidePanel,E.settings,E.remove,E.task,E.stage,E.meetingStage),!Ut.isSupported())throw Pe;C(gr(l,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",h))})}function zs(l){return new Promise(function(h){if(U(O),!Ut.backStack.isSupported())throw Pe;h(gr(l,"navigateBack","Back navigation is not supported in the current client or context."))})}function nt(l,h){return new Promise(function(C){if(U(O),!Ut.tabs.isSupported())throw Pe;C(gr(l,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",h))})}function ir(l,h){if(U(O),!Ut.isSupported())throw Pe;Tt(l,"returnFocus",[h])}function Mn(l,h){return new Promise(function(C){if(U(O),!Ut.tabs.isSupported())throw Pe;C(xr(l,"getTabInstances",h))})}function je(l,h){return new Promise(function(C){if(U(O),!Ut.tabs.isSupported())throw Pe;C(xr(l,"getMruTabInstances",h))})}function Ao(l,h){if(U(O,E.content,E.sidePanel,E.meetingStage),!Ut.isSupported())throw Pe;Tt(l,"shareDeepLink",[h.subPageId,h.subPageLabel,h.subPageWebUrl])}function Jt(l,h){if(U(O,E.content),!Ut.isSupported())throw Pe;Tt(l,"setFrameContext",[h])}!function(l){function h(V){Jt(Z(Nt,I.Pages_SetCurrentFrame),V)}function C(){return!(!U(O)||!O.supports.pages)}var V;l.returnFocus=function(V){ir(Z(Nt,I.Pages_ReturnFocus),V)},l.registerFocusEnterHandler=function(V){En(Z(Nt,I.Pages_RegisterFocusEnterHandler),"focusEnter",V,[],function(){if(!C())throw Pe})},l.setCurrentFrame=h,l.initializeWithFrameContext=function(V,k,J){Ln.initialize(J).then(function(){return k&&k()}),h(V)},l.getConfig=function(){return new Promise(function(V){if(U(O,E.content,E.settings,E.remove,E.sidePanel),!C())throw Pe;V(xr(Z(Nt,I.Pages_GetConfig),"settings.getSettings"))})},l.navigateCrossDomain=function(V){return Vo(Z(Nt,I.Pages_NavigateCrossDomain),V)},l.navigateToApp=function(V){return new Promise(function(k){if(U(O,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!C())throw Pe;var J=Z(Nt,I.Pages_NavigateCrossDomain);k(O.isLegacyTeams?Xt(J,"executeDeepLink",function(l){var h=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(l.appId)+"/"+encodeURIComponent(l.pageId));return l.webUrl&&h.searchParams.append("webUrl",l.webUrl),(l.channelId||l.subPageId)&&h.searchParams.append("context",JSON.stringify({channelId:l.channelId,subEntityId:l.subPageId})),h.toString()}(V)):Xt(J,"pages.navigateToApp",V))})},l.shareDeepLink=function(V){return Ao(Z(Nt,I.Pages_ShareDeepLink),V)},l.registerFullScreenHandler=function(V){En(Z(Nt,I.Pages_RegisterFullScreenHandler),"fullScreenChange",V,[],function(){if(!Ht(V)&&!C())throw Pe})},l.isSupported=C,(V=l.tabs||(l.tabs={})).navigateToTab=function(k){return nt(Z(Nt,I.Pages_Tabs_NavigateToTab),k)},V.getTabInstances=function(k){return Mn(Z(Nt,I.Pages_Tabs_GetTabInstances),k)},V.getMruTabInstances=function(k){return je(Z(Nt,I.Pages_Tabs_GetMruTabInstances),k)},V.isSupported=function(){return!(!U(O)||!O.supports.pages||!O.supports.pages.tabs)},function(V){var k,J;function ee(Ie,Pt){!Ht(Ie)&&U(O,E.settings),Pt&&Pt(),k=Ie,!Ht(Ie)&&Tt(Z(Nt,I.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function De(Ie,Pt){!Ht(Ie)&&U(O,E.remove,E.settings),Pt&&Pt(),J=Ie,!Ht(Ie)&&Tt(Z(Nt,I.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function wt(Ie){var Pt=new Te(Ie);k?k(Pt):Fe.childWindow?Xn("settings.save",[Ie]):Pt.notifySuccess()}V.initialize=function(){et("settings.save",wt,!1),et("settings.remove",re,!1)},V.setValidityState=function(Ie){if(U(O,E.settings,E.remove),!$e())throw Pe;Tt(Z(Nt,I.Pages_Config_SetValidityState),"settings.setValidityState",[Ie])},V.setConfig=function(Ie){return new Promise(function(Pt){if(U(O,E.content,E.settings,E.sidePanel),!$e())throw Pe;Pt(Xt(Z(Nt,I.Pages_Config_SetConfig),"settings.setSettings",Ie))})},V.registerOnSaveHandler=function(Ie){ee(Ie,function(){if(!Ht(Ie)&&!$e())throw Pe})},V.registerOnSaveHandlerHelper=ee,V.registerOnRemoveHandler=function(Ie){De(Ie,function(){if(!Ht(Ie)&&!$e())throw Pe})},V.registerOnRemoveHandlerHelper=De,V.registerChangeConfigHandler=function(Ie){En(Z(Nt,I.Pages_Config_RegisterChangeConfigHandler),"changeSettings",Ie,[E.content],function(){if(!$e())throw Pe})};var Te=function(){function Ie(Ft){this.notified=!1,this.result=Ft||{}}var Pt=Ie.prototype;return Pt.notifySuccess=function(){this.ensureNotNotified(),Tt(Z(Nt,I.Settings_Save_Success),"settings.save.success"),this.notified=!0},Pt.notifyFailure=function(yn){this.ensureNotNotified(),Tt(Z(Nt,I.Settings_Save_Failure),"settings.save.failure",[yn]),this.notified=!0},Pt.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},Ie}();function re(){var Ie=new Ne;J?J(Ie):Fe.childWindow?Xn("settings.remove",[]):Ie.notifySuccess()}var Ne=function(){function Ie(){this.notified=!1}var Pt=Ie.prototype;return Pt.notifySuccess=function(){this.ensureNotNotified(),Tt(Z(Nt,I.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},Pt.notifyFailure=function(yn){this.ensureNotNotified(),Tt(Z(Nt,I.Settings_Remove_Failure),"settings.remove.failure",[yn]),this.notified=!0},Pt.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},Ie}();function $e(){return!(!U(O)||!O.supports.pages||!O.supports.pages.config)}V.isSupported=$e}(l.config||(l.config={})),function(V){var k;function J(){return zs(Z(Nt,I.Pages_BackStack_NavigateBack))}function ee(Te,re,Ne){!Ht(re)&&U(O),Ne&&Ne(),k=re,!Ht(re)&&Tt(Te,"registerHandler",["backButton"])}function De(){k&&k()||(Fe.childWindow?Xn("backButtonPress",[]):J())}function wt(){return!(!U(O)||!O.supports.pages||!O.supports.pages.backStack)}V._initialize=function(){et("backButtonPress",De,!1)},V.navigateBack=J,V.registerBackButtonHandler=function(Te){ee(Z(Nt,I.Pages_BackStack_RegisterBackButtonHandler),Te,function(){if(!Ht(Te)&&!wt())throw Pe})},V.registerBackButtonHandlerHelper=ee,V.isSupported=wt}(l.backStack||(l.backStack={})),function(V){function k(){return!(!U(O)||!O.supports.pages||!O.supports.pages.fullTrust)}V.enterFullscreen=function(){if(U(O,E.content),!k())throw Pe;Tt(Z(Nt,I.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},V.exitFullscreen=function(){if(U(O,E.content),!k())throw Pe;Tt(Z(Nt,I.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},V.isSupported=k}(l.fullTrust||(l.fullTrust={})),function(V){function k(){return!(!U(O)||!O.supports.pages||!O.supports.pages.appButton)}V.onClick=function(J){En(Z(Nt,I.Pages_AppButton_OnClick),"appButtonClick",J,[E.content],function(){if(!k())throw Pe})},V.onHoverEnter=function(J){En(Z(Nt,I.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",J,[E.content],function(){if(!k())throw Pe})},V.onHoverLeave=function(J){En(Z(Nt,I.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",J,[E.content],function(){if(!k())throw Pe})},V.isSupported=k}(l.appButton||(l.appButton={})),function(V){function k(){return!(!U(O)||!O.supports.pages||!O.supports.pages.currentApp)}V.navigateTo=function(J){return new Promise(function(ee){if(U(O,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!k())throw Pe;ee(Mt(Z(Nt,I.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",J))})},V.navigateToDefaultPage=function(){return new Promise(function(J){if(U(O,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!k())throw Pe;J(Mt(Z(Nt,I.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))})},V.isSupported=k}(l.currentApp||(l.currentApp={}))}(Ut||(Ut={}));var Ro=He("handlers"),ft=function(){function l(){}return l.initializeHandlers=function(){l.handlers.themeChange=Pr,l.handlers.load=Or,l.handlers.beforeUnload=Bs,Ut.backStack._initialize()},l.uninitializeHandlers=function(){l.handlers={},l.themeChangeHandler=null,l.loadHandler=null,l.beforeUnloadHandler=null,l.beforeSuspendOrTerminateHandler=null,l.resumeHandler=null},l}();ft.handlers={},ft.themeChangeHandler=null,ft.loadHandler=null,ft.beforeUnloadHandler=null,ft.beforeSuspendOrTerminateHandler=null,ft.resumeHandler=null;var Lo=Ro.extend("callHandler");function eo(l,h){var C=ft.handlers[l];return C?(Lo("Invoking the registered handler for message %s with arguments %o",l,h),[!0,C.apply(this,h)]):Fe.childWindow?(Xn(l,h),[!1,void 0]):(Lo("Handler for action message %s not found.",l),[!1,void 0])}function et(l,h,C,y){void 0===C&&(C=!0),void 0===y&&(y=[]),h?(ft.handlers[l]=h,C&&Tt(Z(se.V_0,I.RegisterHandler),"registerHandler",[l].concat(y))):delete ft.handlers[l]}function hn(l){delete ft.handlers[l]}function Gn(l){return null!=ft.handlers[l]}function En(l,h,C,y,m){C&&U.apply(void 0,[O].concat(y)),m&&m(),et(h,C)}function Pr(l){ft.themeChangeHandler&&ft.themeChangeHandler(l),Fe.childWindow&&Xn("themeChange",[l])}function Or(l){ft.resumeHandler?ft.resumeHandler(l):ft.loadHandler&&ft.loadHandler(l),Fe.childWindow&&Xn("load",[l])}function Bs(){var l=function(){We("readyToUnload",[])};ft.beforeSuspendOrTerminateHandler?(ft.beforeSuspendOrTerminateHandler(),Fe.childWindow?Xn("beforeUnload"):l()):ft.beforeUnloadHandler&&ft.beforeUnloadHandler(l)||(Fe.childWindow?Xn("beforeUnload"):l())}var jt=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})},wi=He("communication"),Fe=function(){},Qt=function(){};function xr(l,h){for(var C=arguments.length,y=new Array(C>2?C-2:0),m=2;m<C;m++)y[m-2]=arguments[m];return Tr(l,h,y).then(function(S){return S[0]})}function ai(l){for(var h=arguments.length,C=new Array(h>1?h-1:0),y=1;y<h;y++)C[y-1]=arguments[y];return Qn(l,C).then(function(m){return m[0]})}function Xt(l,h){for(var C=arguments.length,y=new Array(C>2?C-2:0),m=2;m<C;m++)y[m-2]=arguments[m];return Tr(l,h,y).then(function(S){if(!S[0])throw new Error(S[1])})}function ln(l){for(var h=arguments.length,C=new Array(h>1?h-1:0),y=1;y<h;y++)C[y-1]=arguments[y];return Qn(l,C).then(function(m){if(!m[0])throw new Error(m[1])})}function gr(l,h,C){for(var y=arguments.length,m=new Array(y>3?y-3:0),S=3;S<y;S++)m[S-3]=arguments[S];return Tr(l,h,m).then(function(F){if(!F[0])throw new Error(F[1]||C)})}function Mt(l,h){for(var C=arguments.length,y=new Array(C>2?C-2:0),m=2;m<C;m++)y[m-2]=arguments[m];return Tr(l,h,y).then(function(S){var F=S[0];if(F)throw F;return S[1]})}function Kt(l){for(var h=arguments.length,C=new Array(h>1?h-1:0),y=1;y<h;y++)C[y-1]=arguments[y];return Qn(l,C).then(function(m){var S=m[0];if(S)throw S;return m[1]})}function Tr(l,h,C){if(void 0===C&&(C=void 0),!Ee(l))throw Error("apiVersionTag: "+l+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");return new Promise(function(y){y(za(to(l,h,C).id))})}function Qn(l,h){return void 0===h&&(h=void 0),new Promise(function(C){C(za(to(Z(se.V_0,"testing"),l,h).id))})}function za(l){return new Promise(function(h){Qt.promiseCallbacks[l]=h})}function Tt(l,h,C,y){var m;if(C instanceof Function?y=C:C instanceof Array&&(m=C),!Ee(l))throw Error("apiVersionTag: "+l+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");var S=to(l,h,m);y&&(Qt.callbacks[S.id]=y)}function We(l,h,C){var y;h instanceof Function?C=h:h instanceof Array&&(y=h);var m=to(Z(se.V_0,"testing"),l,y);C&&(Qt.callbacks[m.id]=C)}Qt.parentMessageQueue=[],Qt.childMessageQueue=[],Qt.nextMessageId=0,Qt.callbacks={},Qt.promiseCallbacks={};var $s=wi.extend("sendMessageToParentHelper");function to(l,h,C){var y=$s,m=Fe.parentWindow,S=function(l,h,C){return{id:Qt.nextMessageId++,func:h,timestamp:Date.now(),args:C||[],apiversiontag:l}}(l,h,C);if(y("Message %i information: %o",S.id,{actionName:h,args:C}),N.isFramelessWindow)Fe.currentWindow&&Fe.currentWindow.nativeInterface&&(y("Sending message %i to parent via framelessPostMessage interface",S.id),Fe.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(S)));else{var F=io(m);m&&F?(y("Sending message %i to parent via postMessage",S.id),m.postMessage(S,F)):(y("Adding message %i to parent message queue",S.id),ro(m).push(S))}return S}var qa=wi.extend("processMessage");function Ba(l){return jt(this,void 0,void 0,j().mark(function h(){var C,y;return j().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(l&&l.data&&"object"==typeof l.data){S.next=2;break}return S.abrupt("return",void qa("Unrecognized message format received by app, message being ignored. Message: %o",l));case 2:return S.abrupt("return",Qs(C=l.source||l.originalEvent&&l.originalEvent.source,y=l.origin||l.originalEvent&&l.originalEvent.origin).then(function(F){F?(Xs(C,y),C===Fe.parentWindow?no(l):C===Fe.childWindow&&No(l)):qa("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}));case 4:case"end":return S.stop()}},h)}))}var Ua=wi.extend("shouldProcessMessage");function Qs(l,h){return jt(this,void 0,void 0,j().mark(function C(){var y;return j().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!Fe.currentWindow||l!==Fe.currentWindow){S.next=2;break}return S.abrupt("return",(Ua("Should not process message because it is coming from the current window"),!1));case 2:if(!(Fe.currentWindow&&Fe.currentWindow.location&&h&&h===Fe.currentWindow.location.origin)){S.next=4;break}return S.abrupt("return",!0);case 4:return S.next=6,Kl(new URL(h));case 6:return S.abrupt("return",((y=S.sent)||Ua("Message has an invalid origin of %s",h),y));case 8:case"end":return S.stop()}},C)}))}function Xs(l,h){N.isFramelessWindow||Fe.parentWindow&&!Fe.parentWindow.closed&&l!==Fe.parentWindow?Fe.childWindow&&!Fe.childWindow.closed&&l!==Fe.childWindow||(Fe.childWindow=l,Fe.childOrigin=h):(Fe.parentWindow=l,Fe.parentOrigin=h),Fe.parentWindow&&Fe.parentWindow.closed&&(Fe.parentWindow=null,Fe.parentOrigin=null),Fe.childWindow&&Fe.childWindow.closed&&(Fe.childWindow=null,Fe.childOrigin=null),Wa(Fe.parentWindow),Wa(Fe.childWindow)}var ja=wi.extend("handleParentMessage");function no(l){var h=ja;if("id"in l.data&&"number"==typeof l.data.id){var C=l.data,y=Qt.callbacks[C.id];h("Received a response from parent for message %i",C.id),y&&(h("Invoking the registered callback for message %i with arguments %o",C.id,C.args),y.apply(null,[].concat(C.args,[C.isPartialResponse])),function(l){return!0===l.data.isPartialResponse}(l)||(h("Removing registered callback for message %i",C.id),delete Qt.callbacks[C.id]));var m=Qt.promiseCallbacks[C.id];m&&(h("Invoking the registered promise callback for message %i with arguments %o",C.id,C.args),m(C.args),h("Removing registered promise callback for message %i",C.id),delete Qt.promiseCallbacks[C.id])}else if("func"in l.data&&"string"==typeof l.data.func){var S=l.data;h("Received an action message %s from parent",S.func),eo(S.func,S.args)}else h("Received an unknown message: %O",l)}function No(l){if("id"in l.data&&"func"in l.data){var h=l.data,C=eo(h.func,h.args),m=C[1];C[0]&&void 0!==m?$a(h.id,Array.isArray(m)?m:[m]):We(h.func,h.args,function(){if(Fe.childWindow){for(var S=arguments.length,F=new Array(S),A=0;A<S;A++)F[A]=arguments[A];var R=F.pop();$a(h.id,F,R)}})}}function ro(l){return l===Fe.parentWindow?Qt.parentMessageQueue:l===Fe.childWindow?Qt.childMessageQueue:[]}function io(l){return l===Fe.parentWindow?Fe.parentOrigin:l===Fe.childWindow?Fe.childOrigin:null}var zo,qo,Bo,oo,si,Ys=wi.extend("flushMessageQueue");function Wa(l){for(var h=io(l),C=ro(l),y=l==Fe.parentWindow?"parent":"child";l&&h&&C.length>0;){var m=C.shift();Ys("Flushing message %i from "+y+" message queue via postMessage.",m?.id),l.postMessage(m,h)}}function zr(l,h){var C;C=Fe.currentWindow.setInterval(function(){0===ro(l).length&&(clearInterval(C),h())},100)}function $a(l,h,C){var y=Fe.childWindow,m=function(l,h,C){return{id:l,args:h||[],isPartialResponse:C}}(l,h,C),S=io(y);y&&S&&y.postMessage(m,S)}function Xn(l,h){var C=Fe.childWindow,y=function(l,h){return{func:l,args:h||[]}}(l,h),m=io(C);C&&m?C.postMessage(y,m):ro(C).push(y)}function Ks(l,h){U(O),We("uploadCustomApp",[l],h||jn())}function el(l,h,C){U(O),We(l,h,C)}function tl(l,h){if(U(O),!Fe.childWindow)throw new Error("The child window has not yet been initialized or is not present");Xn(l,h)}function Qa(l,h){var C=this;U(O),et(l,function(){for(var y=arguments.length,m=new Array(y),S=0;S<y;S++)m[S]=arguments[S];return h.apply(C,m)})}function nl(l,h){U(O),et("userSettingsChange",h,!0,[l])}function ao(l){U(O,E.content,E.task),We("openFilePreview",[l.entityId,l.title,l.description,l.type,l.objectUrl,l.downloadUrl,l.webPreviewUrl,l.webEditUrl,l.baseUrl,l.editFile,l.subEntityId,l.viewerAction,l.fileOpenPreference,l.conversationId,l.sizeInBytes])}(function(l){function h(){return!(!U(O)||!O.supports.logs)}l.registerGetLogHandler=function(C){if(!Ht(C)&&U(O),!Ht(C)&&!h())throw Pe;C?et("log.request",function(){We("log.receive",[C()])}):hn("log.request")},l.isSupported=h})(zo||(zo={})),function(l){l.fileDownloadStart="fileDownloadStart",l.fileDownloadComplete="fileDownloadComplete"}(qo||(qo={})),function(l){l.view="view",l.edit="edit",l.editNew="editNew"}(Bo||(Bo={})),function(l){l.fileOpenPreference="fileOpenPreference",l.theme="theme"}(oo||(oo={})),function(l){function h(){return!(!U(O)||!O.supports.conversations)}l.openConversation=function(C){return new Promise(function(y){if(U(O,E.content),!h())throw Pe;var m=ln("conversations.openConversation",{title:C.title,subEntityId:C.subEntityId,conversationId:C.conversationId,channelId:C.channelId,entityId:C.entityId});C.onStartConversation&&et("startConversation",function(S,F,A,R){var V;return null===(V=C.onStartConversation)||void 0===V?void 0:V.call(C,{subEntityId:S,conversationId:F,channelId:A,entityId:R})}),C.onCloseConversation&&et("closeConversation",function(S,F,A,R){var V;return null===(V=C.onCloseConversation)||void 0===V?void 0:V.call(C,{subEntityId:S,conversationId:F,channelId:A,entityId:R})}),y(m)})},l.closeConversation=function(){if(U(O,E.content),!h())throw Pe;We("conversations.closeConversation"),hn("startConversation"),hn("closeConversation")},l.getChatMembers=function(){return new Promise(function(C){if(U(O),!h())throw Pe;C(ai("getChatMembers"))})},l.isSupported=h}(si||(si={}));var so;function Si(l,h,C){if(0===l.length)throw new Error("Must have at least one user when creating a chat deep link");var y="users="+l.map(function(F){return encodeURIComponent(F)}).join(","),m=void 0===h?"":"&topicName="+encodeURIComponent(h),S=void 0===C?"":"&message="+encodeURIComponent(C);return _e+"://"+pe+"/l/chat/0/0?"+y+m+S}!function(l){function h(){return!(!U(O)||!O.supports.appInstallDialog)}l.openAppInstallDialog=function(C){return new Promise(function(y){if(U(O,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!h())throw new Error("Not supported");O.isLegacyTeams?y(ln("executeDeepLink",function(l){if(!l)throw new Error("App ID must be set when creating an app install dialog deep link");return _e+"://"+pe+"/l/app/"+encodeURIComponent(l)}(C.appId))):(We("appInstallDialog.openAppInstallDialog",[C]),y())})},l.isSupported=h}(so||(so={}));var In,qn=se.V_1,Yn=He("media");function li(l,h){if(null==l||null==h||l.length<=0)return null;var C=null,y=1;return l.sort(function(m,S){return m.sequence>S.sequence?1:-1}),l.forEach(function(m){m.sequence==y&&(C=C?new Blob([C,m.file],{type:h}):new Blob([m.file],{type:h}),y++)}),C}function lo(l,h){if(null==l||null==h)return null;for(var C=atob(l.chunk),y=new Array(C.length),m=0;m<C.length;m++)y[m]=C.charCodeAt(m);var S=new Uint8Array(y),F=new Blob([S],{type:h});return{sequence:l.chunkSequence,file:F}}function il(l){!function(l){return!(!l||l.mediaType!=In.MediaType.VideoAndImage&&!l.videoAndImageProps)}(l)?function(l){return!(!l||l.mediaType!=In.MediaType.Video||!l.videoProps||l.videoProps.isFullScreenMode)}(l)?Yi(W):function(l){var h;return!(l?.mediaType!=In.MediaType.Image||null===(h=l?.imageProps)||void 0===h||!h.imageOutputFormats)}(l)&&Yi("2.0.4"):Yi("2.0.2")}function jo(l){return!l||!(null===l.timeOutIntervalInSec||null!=l.timeOutIntervalInSec&&l.timeOutIntervalInSec<=0||null!=l.timeOutIntervalInSec&&l.timeOutIntervalInSec>60)}!function(l){var C,S,ee;(ee=l.FileFormat||(l.FileFormat={})).Base64="base64",ee.ID="id";var R=function(){};function V(){return!(!U(O)||!O.supports.permissions)}l.File=R,l.captureImage=function(ee){if(!ee)throw new Error("[captureImage] Callback cannot be null");U(O,E.content,E.task),N.isFramelessWindow?$n("1.7.0")?Tt(Z(qn,I.Media_CaptureImage),"captureImage",ee):ee({errorCode:we.OLD_PLATFORM},[]):ee({errorCode:we.NOT_SUPPORTED_ON_PLATFORM},[])},l.hasPermission=function(){if(U(O,E.content,E.task),!V())throw Pe;var ee=ct.Media;return new Promise(function(De){De(Mt(Z(qn,I.Media_HasPermission),"permissions.has",ee))})},l.requestPermission=function(){if(U(O,E.content,E.task),!V())throw Pe;var ee=ct.Media;return new Promise(function(De){De(Mt(Z(qn,I.Media_RequestPermission),"permissions.request",ee))})};var k=function(ee){function De(Te){var re;return re=ee.call(this)||this,Te&&(re.content=Te.content,re.format=Te.format,re.mimeType=Te.mimeType,re.name=Te.name,re.preview=Te.preview,re.size=Te.size),re}b(De,ee);var wt=De.prototype;return wt.getMedia=function(re){if(!re)throw new Error("[get Media] Callback cannot be null");U(O,E.content,E.task),$n(ve)?function(l,h,C){return null!=l&&null!=h&&h==In.FileFormat.ID&&null!=C}(this.mimeType,this.format,this.content)?$n("2.0.0")?this.getMediaViaCallback(re):this.getMediaViaHandler(re):re({errorCode:we.INVALID_ARGUMENTS},new Blob):re({errorCode:we.OLD_PLATFORM},new Blob)},wt.getMediaViaCallback=function(re){var Ne={mediaMimeType:this.mimeType,assembleAttachment:[]},$e=[this.content];Tt(Z(qn,I.Media_GetMedia),"getMedia",$e,function(Ie){if(re)if(Ie&&Ie.error)re(Ie.error,new Blob);else if(Ie&&Ie.mediaChunk)if(Ie.mediaChunk.chunkSequence<=0){var Pt=li(Ne.assembleAttachment,Ne.mediaMimeType);re(Ie.error,Pt??new Blob)}else{var Ft=lo(Ie.mediaChunk,Ne.mediaMimeType);Ft?Ne.assembleAttachment.push(Ft):Yn("Received a null assemble attachment for when decoding chunk sequence "+Ie.mediaChunk.chunkSequence+"; not including the chunk in the assembled file.")}else re({errorCode:we.INTERNAL_ERROR,message:"data received is null"},new Blob)})},wt.getMediaViaHandler=function(re){var Ne=wr(),$e={mediaMimeType:this.mimeType,assembleAttachment:[]},Ie=[Ne,this.content];this.content&&!Ht(re)&&Tt(Z(qn,I.Media_GetMedia),"getMedia",Ie),et("getMedia"+Ne,function(Pt){if(re){var Ft=JSON.parse(Pt);if(Ft.error)re(Ft.error,new Blob),hn("getMedia"+Ne);else if(Ft.mediaChunk)if(Ft.mediaChunk.chunkSequence<=0){var yn=li($e.assembleAttachment,$e.mediaMimeType);re(Ft.error,yn??new Blob),hn("getMedia"+Ne)}else{var cn=lo(Ft.mediaChunk,$e.mediaMimeType);cn&&$e.assembleAttachment.push(cn)}else re({errorCode:we.INTERNAL_ERROR,message:"data received is null"},new Blob),hn("getMedia"+Ne)}})},De}(R);l.Media=k;var J=function(){function ee(wt){this.controllerCallback=wt}var De=ee.prototype;return De.notifyEventToHost=function(Te,re){U(O,E.content,E.task);try{Yi(W)}catch($e){return void(re&&re($e))}var Ne={mediaType:this.getMediaType(),mediaControllerEvent:Te};Tt(Z(qn,I.Media_Controller),"media.controller",[Ne],function($e){re&&re($e)})},De.stop=function(Te){this.notifyEventToHost(C.StopRecording,Te)},ee}();l.VideoController=function(ee){function De(){return ee.apply(this,arguments)||this}b(De,ee);var wt=De.prototype;return wt.getMediaType=function(){return S.Video},wt.notifyEventToApp=function(re){if(this.controllerCallback)switch(re){case C.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},De}(J),function(ee){ee[ee.StartRecording=1]="StartRecording",ee[ee.StopRecording=2]="StopRecording"}(C=l.MediaControllerEvent||(l.MediaControllerEvent={})),function(ee){ee[ee.Photo=1]="Photo",ee[ee.Document=2]="Document",ee[ee.Whiteboard=3]="Whiteboard",ee[ee.BusinessCard=4]="BusinessCard"}(l.CameraStartMode||(l.CameraStartMode={})),function(ee){ee[ee.Camera=1]="Camera",ee[ee.Gallery=2]="Gallery"}(l.Source||(l.Source={})),function(ee){ee[ee.Image=1]="Image",ee[ee.Video=2]="Video",ee[ee.VideoAndImage=3]="VideoAndImage",ee[ee.Audio=4]="Audio"}(S=l.MediaType||(l.MediaType={})),function(ee){ee[ee.ID=1]="ID",ee[ee.URL=2]="URL"}(l.ImageUriType||(l.ImageUriType={})),function(ee){ee[ee.IMAGE=1]="IMAGE",ee[ee.PDF=2]="PDF"}(l.ImageOutputFormats||(l.ImageOutputFormats={})),l.selectMedia=function(ee,De){if(!De)throw new Error("[select Media] Callback cannot be null");if(U(O,E.content,E.task),$n(ve)){try{il(ee)}catch(Ne){return void De(Ne,[])}if(function(l){return!(null==l||l.maxMediaCount>10)}(ee)){var re=[ee];Tt(Z(qn,I.Media_SelectMedia),"selectMedia",re,function(Ne,$e,Ie){var Pt,Ft;if(Ie)(function(l){return!(l.mediaType!=In.MediaType.Video||!l.videoProps||!l.videoProps.videoController)})(ee)&&(null===(Ft=null===(Pt=ee?.videoProps)||void 0===Pt?void 0:Pt.videoController)||void 0===Ft||Ft.notifyEventToApp(Ie));else if($e){for(var xo,yn=[],cn=e($e);!(xo=cn()).done;)yn.push(new k(xo.value));De(Ne,yn)}else De(Ne,[])})}else De({errorCode:we.INVALID_ARGUMENTS},[])}else De({errorCode:we.OLD_PLATFORM},[])},l.viewImages=function(ee,De){if(!De)throw new Error("[view images] Callback cannot be null");if(U(O,E.content,E.task),$n(ve))if(function(l){return!(null==l||l.length<=0||l.length>10)}(ee)){var wt=[ee];Tt(Z(qn,I.Media_ViewImages),"viewImages",wt,De)}else De({errorCode:we.INVALID_ARGUMENTS});else De({errorCode:we.OLD_PLATFORM})},l.scanBarCode=function(ee,De){if(!ee)throw new Error("[media.scanBarCode] Callback cannot be null");U(O,E.content,E.task),N.hostClientType!==Ue.desktop&&N.hostClientType!==Ue.web&&N.hostClientType!==Ue.rigel&&N.hostClientType!==Ue.teamsRoomsWindows&&N.hostClientType!==Ue.teamsRoomsAndroid&&N.hostClientType!==Ue.teamsPhones&&N.hostClientType!==Ue.teamsDisplays?$n("1.9.0")?jo(De)?Tt(Z(qn,I.Media_ScanBarCode),"media.scanBarCode",[De],ee):ee({errorCode:we.INVALID_ARGUMENTS},""):ee({errorCode:we.OLD_PLATFORM},""):ee({errorCode:we.NOT_SUPPORTED_ON_PLATFORM},"")}}(In||(In={}));var qr,Wo,co=se.V_2;(function(l){function h(){return!!(U(O)&&O.supports.barCode&&O.supports.permissions)}l.scanBarCode=function(C){return new Promise(function(y){if(U(O,E.content,E.task),!h())throw Pe;if(!jo(C))throw{errorCode:we.INVALID_ARGUMENTS};y(Mt(Z(co,I.BarCode_ScanBarCode),"media.scanBarCode",C))})},l.hasPermission=function(){if(U(O,E.content,E.task),!h())throw Pe;var C=ct.Media;return new Promise(function(y){y(Mt(Z(co,I.BarCode_HasPermission),"permissions.has",C))})},l.requestPermission=function(){if(U(O,E.content,E.task),!h())throw Pe;var C=ct.Media;return new Promise(function(y){y(Mt(Z(co,I.BarCode_RequestPermission),"permissions.request",C))})},l.isSupported=h})(qr||(qr={})),function(l){function h(y){return new Promise(function(m){if(U(O,E.content,E.task),!C())throw Pe;m(O.isLegacyTeams?ln("executeDeepLink",Si([y.user],void 0,y.message)):ln("chat.openChat",{members:[y.user],message:y.message}))})}function C(){return!(!U(O)||!O.supports.chat)}l.openChat=h,l.openGroupChat=function(y){return new Promise(function(m){if(y.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===y.users.length)m(h({user:y.users[0],message:y.message}));else{if(U(O,E.content,E.task),!C())throw Pe;m(O.isLegacyTeams?ln("executeDeepLink",Si(y.users,y.topic,y.message)):ln("chat.openChat",{members:y.users,message:y.message,topic:y.topic}))}})},l.isSupported=C}(Wo||(Wo={}));var ci,ts=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})},ns=se.V_2;!function(l){function h(){return!!(U(O)&&navigator&&navigator.clipboard&&O.supports.clipboard)}l.write=function(C){return ts(this,void 0,void 0,j().mark(function y(){var S;return j().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(U(O,E.content,E.meetingStage,E.task,E.settings,E.stage,E.sidePanel),h()){A.next=2;break}throw Pe;case 2:if(C.type&&Object.values(dt).includes(C.type)){A.next=4;break}throw new Error("Blob type "+C.type+" is not supported. Supported blob types are "+Object.values(dt));case 4:return A.next=6,ht(C);case 6:return S={mimeType:C.type,content:A.sent},A.abrupt("return",Mt(Z(ns,I.Clipboard_Write),"clipboard.writeToClipboard",S));case 9:case"end":return A.stop()}},y)}))},l.read=function(){return ts(this,void 0,void 0,j().mark(function C(){var y;return j().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(U(O,E.content,E.meetingStage,E.task,E.settings,E.stage,E.sidePanel),h()){S.next=2;break}throw Pe;case 2:if(!Fo()&&N.hostClientType!==Ue.macos){S.next=9;break}return S.t0=JSON,S.next=6,Kt("clipboard.readFromClipboard");case 6:return S.t1=S.sent,y=S.t0.parse.call(S.t0,S.t1),S.abrupt("return",rr(y.mimeType,y.content));case 9:return S.abrupt("return",Mt(Z(ns,I.Clipboard_Read),"clipboard.readFromClipboard"));case 10:case"end":return S.stop()}},C)}))},l.isSupported=h}(ci||(ci={}));var Mi,Pi,kr=se.V_2;function $o(){return O.hostVersionsInfo?O.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(l){function h(){return!!(U(O)&&O.supports.geoLocation&&O.supports.permissions)}l.getCurrentLocation=function(){if(U(O,E.content,E.task),!h())throw Pe;return Mt(Z(kr,I.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},l.hasPermission=function(){if(U(O,E.content,E.task),!h())throw Pe;var y=ct.GeoLocation;return new Promise(function(m){m(Mt(Z(kr,I.GeoLocation_HasPermission),"permissions.has",y))})},l.requestPermission=function(){if(U(O,E.content,E.task),!h())throw Pe;var y=ct.GeoLocation;return new Promise(function(m){m(Mt(Z(kr,I.GeoLocation_RequestPermission),"permissions.request",y))})},l.isSupported=h,function(y){function m(){return!!(U(O)&&O.supports.geoLocation&&O.supports.geoLocation.map&&O.supports.permissions)}y.chooseLocation=function(){if(U(O,E.content,E.task),!m())throw Pe;return Mt(Z(kr,I.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},y.showLocation=function(S){if(U(O,E.content,E.task),!m())throw Pe;if(!S)throw{errorCode:we.INVALID_ARGUMENTS};return Mt(Z(kr,I.GeoLocation_ShowLocation),"location.showLocation",S)},y.isSupported=m}(l.map||(l.map={}))}(Mi||(Mi={}));var Qo=function(){function l(){}var h=l.prototype;return h.postMessage=function(y,m){U(O),We("messageForChild",[y],m||jn())},h.addEventListener=function(y,m){U(O),"message"===y&&et("messageForParent",m)},l}(),uo=function(){function l(){}var h=l.prototype;return h.postMessage=function(y,m){U(O,E.task),We("messageForParent",[y],m||jn())},h.addEventListener=function(y,m){U(O,E.task),"message"===y&&et("messageForChild",m)},w(l,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),l}();!function(l){function h(){return!(!U(O)||!O.supports.secondaryBrowser)}l.open=function(C){if(U(O,E.content),!h())throw Pe;if(!C||!nr(C))throw{errorCode:we.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return Kt("secondaryBrowser.open",C.toString())},l.isSupported=h}(Pi||(Pi={}));var xi,Oi=se.V_1;!function(l){function h(){return!(!U(O)||!O.supports.location)}l.getLocation=function(C,y){if(!y)throw new Error("[location.getLocation] Callback cannot be null");if(U(O,E.content,E.task),!$n("1.9.0"))throw{errorCode:we.OLD_PLATFORM};if(!C)throw{errorCode:we.INVALID_ARGUMENTS};if(!h())throw Pe;Tt(Z(Oi,I.Location_GetLocation),"location.getLocation",[C],y)},l.showLocation=function(C,y){if(!y)throw new Error("[location.showLocation] Callback cannot be null");if(U(O,E.content,E.task),!$n("1.9.0"))throw{errorCode:we.OLD_PLATFORM};if(!C)throw{errorCode:we.INVALID_ARGUMENTS};if(!h())throw Pe;Tt(Z(Oi,I.Location_ShowLocation),"location.showLocation",[C],y)},l.isSupported=h}(xi||(xi={}));var ui,Ti,Br=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})};(function(l){var h,S,k;function V(k,J){U(O,E.sidePanel,E.meetingStage),We("meeting.updateMicState",[k,J])}(k=h||(h={}))[k.HostInitiated=0]="HostInitiated",k[k.AppInitiated=1]="AppInitiated",k[k.AppDeclinedToChange=2]="AppDeclinedToChange",k[k.AppFailedToChange=3]="AppFailedToChange",function(k){k.like="like",k.heart="heart",k.laugh="laugh",k.surprised="surprised",k.applause="applause"}(l.MeetingReactionType||(l.MeetingReactionType={})),function(k){k.Unknown="Unknown",k.Adhoc="Adhoc",k.Scheduled="Scheduled",k.Recurring="Recurring",k.Broadcast="Broadcast",k.MeetNow="MeetNow"}(l.MeetingType||(l.MeetingType={})),function(k){k.OneOnOneCall="oneOnOneCall",k.GroupCall="groupCall"}(l.CallType||(l.CallType={})),function(k){k.Collaborative="Collaborative",k.ScreenShare="ScreenShare"}(S=l.SharingProtocol||(l.SharingProtocol={})),l.getIncomingClientAudioState=function(k){if(!k)throw new Error("[get incoming client audio state] Callback cannot be null");U(O,E.sidePanel,E.meetingStage),We("getIncomingClientAudioState",k)},l.toggleIncomingClientAudio=function(k){if(!k)throw new Error("[toggle incoming client audio] Callback cannot be null");U(O,E.sidePanel,E.meetingStage),We("toggleIncomingClientAudio",k)},l.getMeetingDetails=function(k){if(!k)throw new Error("[get meeting details] Callback cannot be null");U(O,E.sidePanel,E.meetingStage,E.settings,E.content),We("meeting.getMeetingDetails",k)},l.getAuthenticationTokenForAnonymousUser=function(k){if(!k)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");U(O,E.sidePanel,E.meetingStage,E.task),We("meeting.getAuthenticationTokenForAnonymousUser",k)},l.getLiveStreamState=function(k){if(!k)throw new Error("[get live stream state] Callback cannot be null");U(O,E.sidePanel),We("meeting.getLiveStreamState",k)},l.requestStartLiveStreaming=function(k,J,ee){if(!k)throw new Error("[request start live streaming] Callback cannot be null");U(O,E.sidePanel),We("meeting.requestStartLiveStreaming",[J,ee],k)},l.requestStopLiveStreaming=function(k){if(!k)throw new Error("[request stop live streaming] Callback cannot be null");U(O,E.sidePanel),We("meeting.requestStopLiveStreaming",k)},l.registerLiveStreamChangedHandler=function(k){if(!k)throw new Error("[register live stream changed handler] Handler cannot be null");U(O,E.sidePanel),et("meeting.liveStreamChanged",k)},l.shareAppContentToStage=function(k,J,ee){if(void 0===ee&&(ee={sharingProtocol:S.Collaborative}),!k)throw new Error("[share app content to stage] Callback cannot be null");U(O,E.sidePanel,E.meetingStage),We("meeting.shareAppContentToStage",[J,ee],k)},l.getAppContentStageSharingCapabilities=function(k){if(!k)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");U(O,E.sidePanel,E.meetingStage),We("meeting.getAppContentStageSharingCapabilities",k)},l.stopSharingAppContentToStage=function(k){if(!k)throw new Error("[stop sharing app content to stage] Callback cannot be null");U(O,E.sidePanel,E.meetingStage),We("meeting.stopSharingAppContentToStage",k)},l.getAppContentStageSharingState=function(k){if(!k)throw new Error("[get app content stage sharing state] Callback cannot be null");U(O,E.sidePanel,E.meetingStage),We("meeting.getAppContentStageSharingState",k)},l.registerSpeakingStateChangeHandler=function(k){if(!k)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");U(O,E.sidePanel,E.meetingStage),et("meeting.speakingStateChanged",k)},l.registerRaiseHandStateChangedHandler=function(k){if(!k)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");U(O,E.sidePanel,E.meetingStage),et("meeting.raiseHandStateChanged",k)},l.registerMeetingReactionReceivedHandler=function(k){if(!k)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");U(O,E.sidePanel,E.meetingStage),et("meeting.meetingReactionReceived",k)},function(k){k.setOptions=function(J){U(O,E.sidePanel),J.contentUrl&&new URL(J.contentUrl),We("meeting.appShareButton.setOptions",[J])}}(l.appShareButton||(l.appShareButton={})),l.requestAppAudioHandling=function(k,J){if(!J)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!k.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");U(O,E.sidePanel,E.meetingStage),k.isAppHandlingAudio?function(k,J){var ee=this;We("meeting.requestAppAudioHandling",[k.isAppHandlingAudio],function(De,wt){if(De&&null!=wt)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(De)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+De.errorCode+" "+De.message);if("boolean"!=typeof wt)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");et("meeting.micStateChanged",function(Te){return Br(ee,void 0,void 0,j().mark(function re(){var Ne;return j().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.prev=0,Ie.next=3,k.micMuteStateChangedCallback(Te);case 3:V(Ne=Ie.sent,Ne.isMicMuted===Te.isMicMuted?h.HostInitiated:h.AppDeclinedToChange),Ie.next=10;break;case 7:Ie.prev=7,Ie.t0=Ie.catch(0),V(Te,h.AppFailedToChange);case 10:case"end":return Ie.stop()}},re,null,[[0,7]])}))}),et("meeting.audioDeviceSelectionChanged",function(Te){var re;null===(re=k.audioDeviceSelectionChangedCallback)||void 0===re||re.call(k,Te)}),J(wt)})}(k,J):function(k,J){We("meeting.requestAppAudioHandling",[k.isAppHandlingAudio],function(ee,De){if(ee&&null!=De)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(ee)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+ee.errorCode+" "+ee.message);if("boolean"!=typeof De)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Gn("meeting.micStateChanged")&&hn("meeting.micStateChanged"),Gn("meeting.audioDeviceSelectionChanged")&&hn("meeting.audioDeviceSelectionChanged"),J(De)})}(k,J)},l.updateMicState=function(k){V(k,h.AppInitiated)}})(ui||(ui={})),function(l){function h(){return!(!U(O)||!O.supports.monetization)}l.openPurchaseExperience=function(C,y){var m,S;return"function"==typeof C?(m=C,S=y):S=C,U(O,E.content),function(l,h){for(var C=arguments.length,y=new Array(C>2?C-2:0),m=2;m<C;m++)y[m-2]=arguments[m];var S=l.apply(void 0,y);return S.then(function(F){h&&h(null,F)}).catch(function(F){h&&h(F,null)}),S}(function(){return new Promise(function(F){if(!h())throw Pe;F(Kt("monetization.openPurchaseExperience",S))})},m)},l.isSupported=h}(Ti||(Ti={}));var Ei,po=se.V_2;!function(l){function h(){return!(!U(O)||!O.supports.calendar)}l.openCalendarItem=function(C){return new Promise(function(y){if(U(O,E.content),!h())throw new Error("Not supported");if(!C.itemId||!C.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");y(Xt(Z(po,I.Calendar_OpenCalendarItem),"calendar.openCalendarItem",C))})},l.composeMeeting=function(C){return new Promise(function(y){if(U(O,E.content),!h())throw new Error("Not supported");y(O.isLegacyTeams?ln("executeDeepLink",function(l,h,C,y,m){var S=void 0===l?"":"attendees="+l.map(function(k){return encodeURIComponent(k)}).join(","),F=void 0===h?"":"&startTime="+encodeURIComponent(h),A=void 0===C?"":"&endTime="+encodeURIComponent(C),R=void 0===y?"":"&subject="+encodeURIComponent(y),V=void 0===m?"":"&content="+encodeURIComponent(m);return _e+"://"+pe+"/l/meeting/new?"+S+F+A+R+V}(C.attendees,C.startTime,C.endTime,C.subject,C.content)):Xt(Z(po,I.Calendar_ComposeMeeting),"calendar.composeMeeting",C))})},l.isSupported=h}(Ei||(Ei={}));var Ii,Ur,ho,di,Xo=se.V_2;(function(l){function h(){return!(!U(O)||!O.supports.mail)}var y;l.openMailItem=function(y){return new Promise(function(m){if(U(O,E.content),!h())throw new Error("Not supported");if(!y.itemId||!y.itemId.trim())throw new Error("Must supply an itemId to openMailItem");m(Xt(Z(Xo,I.Mail_OpenMailItem),"mail.openMailItem",y))})},l.composeMail=function(y){return new Promise(function(m){if(U(O,E.content),!h())throw new Error("Not supported");m(Xt(Z(Xo,I.Mail_ComposeMail),"mail.composeMail",y))})},l.isSupported=h,(y=l.ComposeMailType||(l.ComposeMailType={})).New="new",y.Reply="reply",y.ReplyAll="replyAll",y.Forward="forward"})(Ii||(Ii={})),function(l){function h(){Ke().print()}function C(S,F){!Ht(S)&&U(O),!Ht(S)&&F&&F(),function(l){ft.loadHandler=l,!Ht(l)&&Tt(Z(se.V_2,I.RegisterHandler),"registerHandler",["load"])}(S)}function y(S,F){!Ht(S)&&U(O),!Ht(S)&&F&&F(),function(l){ft.beforeUnloadHandler=l,!Ht(l)&&Tt(Z(se.V_2,I.RegisterHandler),"registerHandler",["beforeUnload"])}(S)}function m(){return!(!U(O)||!O.supports.teamsCore)}l.enablePrintCapability=function(){if(!N.printCapabilityEnabled){if(U(O),!m())throw Pe;N.printCapabilityEnabled=!0,document.addEventListener("keydown",function(S){(S.ctrlKey||S.metaKey)&&80===S.keyCode&&(h(),S.cancelBubble=!0,S.preventDefault(),S.stopImmediatePropagation())})}},l.print=h,l.registerOnLoadHandler=function(S){C(S,function(){if(!Ht(S)&&!m())throw Pe})},l.registerOnLoadHandlerHelper=C,l.registerBeforeUnloadHandler=function(S){y(S,function(){if(!Ht(S)&&!m())throw Pe})},l.registerBeforeUnloadHandlerHelper=y,l.isSupported=m}(Ur||(Ur={})),function(l){function h(y){return new Promise(function(m){if(!$n("2.0.0"))throw{errorCode:we.OLD_PLATFORM};if(!function(l){return!(l&&(l.title&&"string"!=typeof l.title||l.setSelected&&"object"!=typeof l.setSelected||l.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof l.openOrgWideSearchInChatOrChannel||l.singleSelect&&"boolean"!=typeof l.singleSelect))}(y))throw{errorCode:we.INVALID_ARGUMENTS};if(!C())throw Pe;m(Kt("people.selectPeople",y))})}function C(){return!(!U(O)||!O.supports.people)}l.selectPeople=function(y,m){var S,F,A;return U(O,E.content,E.task,E.settings),"function"==typeof y?(F=(S=[y,m])[0],A=S[1]):A=y,function(l,h){for(var C=arguments.length,y=new Array(C>2?C-2:0),m=2;m<C;m++)y[m-2]=arguments[m];var S=l.apply(void 0,y);return S.then(function(F){h&&h(void 0,F)}).catch(function(F){h&&h(F)}),S}(h,F,A)},l.isSupported=C}(ho||(ho={})),function(l){l.showProfile=function(h){return U(O,E.content),new Promise(function(C){var y=function(l){return l?l.modality&&"string"!=typeof l.modality?[!1,"modality must be a string"]:l.targetElementBoundingRect&&"object"==typeof l.targetElementBoundingRect?l.triggerType&&"string"==typeof l.triggerType?function(l){return l?l.displayName&&"string"!=typeof l.displayName?[!1,"displayName must be a string"]:l.identifiers&&"object"==typeof l.identifiers?l.identifiers.AadObjectId||l.identifiers.Smtp||l.identifiers.Upn?l.identifiers.AadObjectId&&"string"!=typeof l.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:l.identifiers.Smtp&&"string"!=typeof l.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:l.identifiers.Upn&&"string"!=typeof l.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(l.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(h);if(!y[0])throw{errorCode:we.INVALID_ARGUMENTS,message:y[1]};C(Kt("profile.showProfile",{modality:h.modality,persona:h.persona,triggerType:h.triggerType,targetRectangle:{x:h.targetElementBoundingRect.x,y:h.targetElementBoundingRect.y,width:h.targetElementBoundingRect.width,height:h.targetElementBoundingRect.height}}))})},l.isSupported=function(){return!(!U(O)||!O.supports.profile)}}(di||(di={}));var Fr,jr=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})};function is(l,h,C,y){var m,S;return jr(this,void 0,void 0,j().mark(function F(){var A;return j().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return A=os(),!Zt()&&(null===(S=null===(m=window.chrome)||void 0===m?void 0:m.webview)||void 0===S||S.registerTextureStream(l,A)),V.t0=$r,V.next=5,al(l,C,y);case 5:V.t1=V.sent,V.t2=new Qr(C,h),V.t3=A.writable,(0,V.t0)(V.t1,V.t2,V.t3);case 9:case"end":return V.stop()}},F)}))}function Wr(l,h,C,y){var m,S;return jr(this,void 0,void 0,j().mark(function F(){var A;return j().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return A=os(),!Zt()&&(null===(S=null===(m=window.chrome)||void 0===m?void 0:m.webview)||void 0===S||S.registerTextureStream(l,A)),V.t0=$r,V.next=5,al(l,C,y);case 5:V.t1=V.sent,V.t2=new cl(C,h),V.t3=A.writable,(0,V.t0)(V.t1,V.t2,V.t3);case 9:case"end":return V.stop()}},F)}))}function al(l,h,C){return jr(this,void 0,void 0,j().mark(function y(){var m,S;return j().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(!Zt()){A.next=2;break}throw Pe;case 2:return m=Ke().chrome,A.prev=3,C?.reportGettingTextureStream(l),A.next=7,m.webview.getTextureStream(l);case 7:if(0!==(S=A.sent.getVideoTracks()).length){A.next=10;break}throw new Error("No video track in stream "+l);case 10:return A.abrupt("return",(C?.reportTextureStreamAcquired(),S[0]));case 13:throw A.prev=13,A.t0=A.catch(3),h("Failed to get video track from stream "+l+", error: "+A.t0),new Error("Internal error: can't get video track from stream "+l);case 16:case"end":return A.stop()}},y,null,[[3,13]])}))}function os(){if(Zt())throw Pe;var l=window.MediaStreamTrackGenerator;if(!l)throw Pe;return new l({kind:"video"})}function $r(l,h,C){new(Ke().MediaStreamTrackProcessor)({track:l}).readable.pipeThrough(new TransformStream(h)).pipeTo(C)}!function(l){l.TimestampIsNull="timestamp of the original video frame is null",l.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(Fr||(Fr={}));var Qr=function(h,C){var y=this;this.notifyError=h,this.videoFrameHandler=C,this.transform=function(m,S){return jr(y,void 0,void 0,j().mark(function F(){var A,R,V;return j().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(null===(A=m.timestamp)){J.next=15;break}return J.prev=2,J.next=5,this.videoFrameHandler({videoFrame:m});case 5:R=J.sent,V=new VideoFrame(R,{timestamp:A}),S.enqueue(V),m.close(),R.close(),J.next=13;break;case 10:J.prev=10,J.t0=J.catch(2),m.close(),this.notifyError(J.t0);case 13:J.next=16;break;case 15:this.notifyError(Fr.TimestampIsNull);case 16:case"end":return J.stop()}},F,this,[[2,10]])}))}},sl=function(){function l(h,C){if(this.headerBuffer=h,this.notifyError=C,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(h),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return w(l,[{key:"oneTextureLayoutId",get:function(){return this.headerDataView[0]}},{key:"version",get:function(){return this.headerDataView[1]}},{key:"frameRowOffset",get:function(){return this.headerDataView[2]}},{key:"frameFormat",get:function(){return this.headerDataView[3]}},{key:"frameWidth",get:function(){return this.headerDataView[4]}},{key:"frameHeight",get:function(){return this.headerDataView[5]}},{key:"multiStreamHeaderRowOffset",get:function(){return this.headerDataView[6]}},{key:"multiStreamCount",get:function(){return this.headerDataView[7]}}]),l}(),ll=function(){function l(h,C){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var y=new Uint32Array(h),m=0,S=0;m<C;m++){var F=y[S++],A=y[S++],R=y[S++],V=new Uint8Array(h,A,R);this.metadataMap.set(F,V)}}return w(l,[{key:"audioInferenceResult",get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}]),l}(),cl=function(h,C){var y=this;this.notifyError=h,this.videoFrameHandler=C,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(m,S){return jr(y,void 0,void 0,j().mark(function F(){var A,R,V,k,ee,De,wt;return j().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(null===(A=m.timestamp)){re.next=22;break}return re.prev=2,re.next=5,this.extractVideoFrameAndMetadata(m);case 5:return V=(R=re.sent).videoFrame,ee=(void 0===(k=R.metadata)?{}:k).audioInferenceResult,re.next=12,this.videoFrameHandler({videoFrame:V,audioInferenceResult:ee});case 12:De=re.sent,wt=new VideoFrame(De,{timestamp:A}),S.enqueue(wt),V.close(),m.close(),De.close(),re.next=20;break;case 17:re.prev=17,re.t0=re.catch(2),m.close(),this.notifyError(re.t0);case 20:re.next=23;break;case 22:this.notifyError(Fr.TimestampIsNull);case 23:case"end":return re.stop()}},F,this,[[2,17]])}))},this.extractVideoFrameAndMetadata=function(m){return jr(y,void 0,void 0,j().mark(function S(){var F,A,R,V,k,J;return j().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:if(!Zt()){De.next=2;break}throw Pe;case 2:if("NV12"===m.format){De.next=4;break}throw this.notifyError(Fr.UnsupportedVideoFramePixelFormat),new Error(Fr.UnsupportedVideoFramePixelFormat);case 4:return F={x:0,y:0,width:m.codedWidth,height:2},A=new ArrayBuffer(F.width*F.height*3/2),De.next=7,m.copyTo(A,{rect:F});case 7:return R=new sl(A,this.notifyError),V={x:0,y:R.multiStreamHeaderRowOffset,width:m.codedWidth,height:m.codedHeight-R.multiStreamHeaderRowOffset},k=new ArrayBuffer(V.width*V.height*3/2),De.next=10,m.copyTo(k,{rect:V});case 10:return J=new ll(k,R.multiStreamCount),De.abrupt("return",{videoFrame:new VideoFrame(m,{timestamp:m.timestamp,visibleRect:{x:0,y:R.frameRowOffset,width:R.frameWidth,height:R.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:J.audioInferenceResult}});case 12:case"end":return De.stop()}},S,this)}))},et("video.mediaStream.audioInferenceDiscardStatusChange",function(m){y.shouldDiscardAudioInferenceResult=m.discardAudioInferenceResult})};function fr(l,h){return function(C,y){h?.reportApplyingVideoEffect(C||"",y),l(C,y).then(function(){h?.reportVideoEffectChanged(C||"",y),We("video.videoEffectReadiness",[!0,C,void 0,y])}).catch(function(m){We("video.videoEffectReadiness",[!1,C,m in Zn.EffectFailureReason?m:Zn.EffectFailureReason.InitializationFailure,y])})}}var mr=function(){function l(){}return l.setTimeout=function(C,y){var m=performance.now(),S=wr();return l.setTimeoutCallbacks[S]={callback:C,timeoutInMs:y,startedAtInMs:m},S},l.clearTimeout=function(C){delete l.setTimeoutCallbacks[C]},l.setInterval=function(C,y){l.setTimeout(function m(){C(),l.setTimeout(m,y)},y)},l.tick=function(){var C=performance.now(),y=[];for(var m in l.setTimeoutCallbacks){var S=l.setTimeoutCallbacks[m];C-S.startedAtInMs>=S.timeoutInMs&&y.push(m)}for(var F=0,A=y;F<A.length;F++){var R=A[F];l.setTimeoutCallbacks[R].callback(),delete l.setTimeoutCallbacks[R]}},l}();mr.setTimeoutCallbacks={};var fo=function(){function l(C,y){this.reportStatisticsResult=y,this.sampleCount=0,this.distributionBins=new Uint32Array(C)}var h=l.prototype;return h.processStarts=function(y,m,S,F){mr.tick(),this.suitableForThisSession(y,m,S,F)||this.reportAndResetSession(this.getStatistics(),y,F,m,S),this.start()},h.processEnds=function(){var y=performance.now()-this.frameProcessingStartedAt,m=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,y)));this.distributionBins[m]+=1,this.sampleCount+=1},h.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},h.start=function(){this.frameProcessingStartedAt=performance.now()},h.suitableForThisSession=function(y,m,S,F){return this.currentSession&&this.currentSession.effectId===y&&this.currentSession.effectParam===F&&this.currentSession.frameWidth===m&&this.currentSession.frameHeight===S},h.reportAndResetSession=function(y,m,S,F,A){var R=this;y&&this.reportStatisticsResult(y),this.resetCurrentSession(this.getNextTimeout(m,this.currentSession),m,S,F,A),this.timeoutId&&mr.clearTimeout(this.timeoutId),this.timeoutId=mr.setTimeout(function(){return R.reportAndResetSession(R.getStatistics(),m,S,F,A)}.bind(this),this.currentSession.timeoutInMs)},h.resetCurrentSession=function(y,m,S,F,A){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:y,effectId:m,effectParam:S,frameWidth:F,frameHeight:A},this.sampleCount=0,this.distributionBins.fill(0)},h.getNextTimeout=function(y,m){return m&&m.effectId===y?Math.min(l.maxSessionTimeoutInMs,2*m.timeoutInMs):l.initialSessionTimeoutInMs},l}();fo.initialSessionTimeoutInMs=1e3,fo.maxSessionTimeoutInMs=3e4;var mo=function(){function l(C){var y=this;this.reportPerformanceEvent=C,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new fo(l.distributionBinSize,function(m){return y.reportPerformanceEvent("video.performance.performanceDataGenerated",[m])})}var h=l.prototype;return h.startMonitorSlowFrameProcessing=function(){var y=this;mr.setInterval(function(){if(0!==y.processedFrameCount){var m=y.frameProcessingTimeCost/y.processedFrameCount;m>y.frameProcessTimeLimit&&y.reportPerformanceEvent("video.performance.frameProcessingSlow",[m]),y.frameProcessingTimeCost=0,y.processedFrameCount=0}},l.calculateFPSInterval)},h.setFrameProcessTimeLimit=function(y){this.frameProcessTimeLimit=y},h.reportApplyingVideoEffect=function(y,m){var S,F;(null===(S=this.applyingEffect)||void 0===S?void 0:S.effectId)===y&&(null===(F=this.applyingEffect)||void 0===F?void 0:F.effectParam)===m||(this.applyingEffect={effectId:y,effectParam:m},this.appliedEffect=void 0)},h.reportVideoEffectChanged=function(y,m){void 0===this.applyingEffect||this.applyingEffect.effectId!==y&&this.applyingEffect.effectParam!==m||(this.appliedEffect={effectId:y,effectParam:m},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},h.reportStartFrameProcessing=function(y,m){mr.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,y,m,this.appliedEffect.effectParam))},h.reportFrameProcessed=function(){var y;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(y=this.appliedEffect)||void 0===y?void 0:y.effectParam])))},h.reportGettingTextureStream=function(y){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=y},h.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var y=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,y])}},l}();mo.distributionBinSize=1e3,mo.calculateFPSInterval=1e3;var Zn,Di,Nn,Jn,Xr=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})};(function(l){var Te,h=Zt()?void 0:new mo(We);function F(Te){We("video.notifyError",[Te])}function A(){return U(O)&&!!O.supports.video&&(!!O.supports.video.mediaStream||!!O.supports.video.sharedFrame)}function V(Te,re){var Ne=this;return function($e){return Xr(Ne,void 0,void 0,j().mark(function Ie(){var Pt,Ft;return j().wrap(function(cn){for(;;)switch(cn.prev=cn.next){case 0:return Pt=$e.videoFrame,re?.reportStartFrameProcessing(Pt.codedWidth,Pt.codedHeight),cn.next=4,Te($e);case 4:return Ft=cn.sent,cn.abrupt("return",(re?.reportFrameProcessed(),Ft));case 6:case"end":return cn.stop()}},Ie)}))}}function k(Te,re){if(U(O,E.sidePanel),!A()||!wt())throw Pe;et("video.newVideoFrame",function(Ne){if(Ne){var $e=Ne.timestamp;h?.reportStartFrameProcessing(Ne.width,Ne.height),Te(function(Te){if("videoFrameBuffer"in Te)return Te;var re=Te.data,Ne=function(h,C){var y={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&C.indexOf(m)<0&&(y[m]=h[m]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var S=0;for(m=Object.getOwnPropertySymbols(h);S<m.length;S++)C.indexOf(m[S])<0&&Object.prototype.propertyIsEnumerable.call(h,m[S])&&(y[m[S]]=h[m[S]])}return y}(Te,["data"]);return Object.assign(Object.assign({},Ne),{videoFrameBuffer:re})}(Ne),function(){h?.reportFrameProcessed(),function(Te){We("video.videoFrameProcessed",[Te])}($e)},F)}},!1),We("video.registerForVideoFrame",[re])}function ee(){var Te;return U(O,E.sidePanel)&&function(){var Te,re,Ne,$e;return!(null===(re=null===(Te=Ke().chrome)||void 0===Te?void 0:Te.webview)||void 0===re||!re.getTextureStream||null===($e=null===(Ne=Ke().chrome)||void 0===Ne?void 0:Ne.webview)||void 0===$e||!$e.registerTextureStream)}()&&!(null===(Te=O.supports.video)||void 0===Te||!Te.mediaStream)}function wt(){var Te;return U(O,E.sidePanel)&&!(null===(Te=O.supports.video)||void 0===Te||!Te.sharedFrame)}(l.VideoFrameFormat||(l.VideoFrameFormat={})).NV12="NV12",(Te=l.EffectChangeType||(l.EffectChangeType={})).EffectChanged="EffectChanged",Te.EffectDisabled="EffectDisabled",function(Te){Te.InvalidEffectId="InvalidEffectId",Te.InitializationFailure="InitializationFailure"}(l.EffectFailureReason||(l.EffectFailureReason={})),l.registerForVideoFrame=function(Te){if(U(O,E.sidePanel),!A())throw Pe;if(!Te.videoFrameHandler||!Te.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(et("video.setFrameProcessTimeLimit",function(re){return h?.setFrameProcessTimeLimit(re.timeLimit)},!1),ee())!function(Te,re){var Ne=this;if(U(O,E.sidePanel),!A()||!ee())throw Pe;et("video.startVideoExtensibilityVideoStream",function($e){return Xr(Ne,void 0,void 0,j().mark(function Ie(){var Pt,Ft;return j().wrap(function(cn){for(;;)switch(cn.prev=cn.next){case 0:return Pt=$e.streamId,Ft=V(Te,h),cn.next=3,is(Pt,Ft,F,h);case 3:case"end":return cn.stop()}},Ie)}))},!1),We("video.mediaStream.registerForVideoFrame",[re])}(Te.videoFrameHandler,Te.config);else{if(!wt())throw Pe;k(Te.videoBufferHandler,Te.config)}h?.startMonitorSlowFrameProcessing()},l.notifySelectedVideoEffectChanged=function(Te,re){if(U(O,E.sidePanel),!A())throw Pe;We("video.videoEffectChanged",[Te,re])},l.registerForVideoEffect=function(Te){if(U(O,E.sidePanel),!A())throw Pe;et("video.effectParameterChange",fr(Te,h),!1),We("video.registerForVideoEffect")},l.isSupported=A})(Zn||(Zn={})),function(l){var h="search.queryChange",C="search.queryClose",y="search.queryExecute";function m(){return!(!U(O)||!O.supports.search)}l.registerHandlers=function(S,F,A){if(U(O,E.content),!m())throw Pe;et(C,S),et(y,F),A&&et(h,A)},l.unregisterHandlers=function(){if(U(O,E.content),!m())throw Pe;We("search.unregister"),hn(h),hn(C),hn(y)},l.isSupported=m,l.closeSearch=function(){return new Promise(function(S){if(U(O,E.content),!m())throw new Error("Not supported");S(ln("search.closeSearch"))})}}(Di||(Di={})),function(l){function h(F){return new Promise(function(A){if(!S())throw Pe;A(Kt(l.SharingAPIMessages.shareWebContent,F))})}function S(){return!(!U(O)||!O.supports.sharing)}l.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},l.shareWebContent=function(F,A){try{(function(F){if(!(F&&F.content&&F.content.length))throw{errorCode:we.INVALID_ARGUMENTS,message:"Shared content is missing"}})(F),function(F){if(F.content.some(function(R){return!R.type}))throw{errorCode:we.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(F.content.some(function(R){return R.type!==F.content[0].type}))throw{errorCode:we.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(F),function(F){if("URL"!==F.content[0].type)throw{errorCode:we.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(F.content.some(function(R){return!R.url}))throw{errorCode:we.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(F)}catch(R){return sr(function(){return Promise.reject(R)},A)}return U(O,E.content,E.sidePanel,E.task,E.stage,E.meetingStage),sr(h,A,F)},l.isSupported=S}(Nn||(Nn={})),function(l){var y;function C(){return!(!U(O)||!O.supports.stageView)}(y=l.StageViewOpenMode||(l.StageViewOpenMode={})).modal="modal",y.popout="popout",y.popoutWithChat="popoutWithChat",l.open=function(y){return new Promise(function(m){if(U(O,E.content),!C())throw Pe;if(!y)throw new Error("[stageView.open] Stage view params cannot be null");m(Kt("stageView.open",y))})},l.isSupported=C}(Jn||(Jn={}));var vo,Co,Zo=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})};(function(l){var y,m;(m=l.CameraRestriction||(l.CameraRestriction={}))[m.FrontOrRear=1]="FrontOrRear",m[m.FrontOnly=2]="FrontOnly",m[m.RearOnly=3]="RearOnly",function(m){m[m.Camera=1]="Camera",m[m.Gallery=2]="Gallery"}(l.Source||(l.Source={})),l.hasPermission=function(){if(U(O,E.content,E.task),!y.isSupported())throw Pe;return Kt("permissions.has",ct.Media)},l.requestPermission=function(){if(U(O,E.content,E.task),!y.isSupported())throw Pe;return Kt("permissions.request",ct.Media)},function(m){function S(){return!!(U(O)&&O.supports.visualMedia&&O.supports.visualMedia.image&&O.supports.permissions)}function F(){if(!S())throw Pe}function A(V){if(!V||V.maxVisualMediaCount>10||V.maxVisualMediaCount<1)throw Bi}function R(V,k){if(k.length>V)throw Rn}m.captureImages=function(V){return Zo(this,void 0,void 0,j().mark(function k(){var J;return j().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return U(O,E.content,E.task),F(),A(V),De.next=3,Kt("visualMedia.image.captureImages",V);case 3:return De.abrupt("return",(R(V.maxVisualMediaCount,J=De.sent),J));case 5:case"end":return De.stop()}},k)}))},m.retrieveImages=function(V){return Zo(this,void 0,void 0,j().mark(function k(){var J;return j().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return U(O,E.content,E.task),F(),A(V),De.next=3,Kt("visualMedia.image.retrieveImages",V);case 3:return De.abrupt("return",(R(V.maxVisualMediaCount,J=De.sent),J));case 5:case"end":return De.stop()}},k)}))},m.isSupported=S}(y=l.image||(l.image={}))})(vo||(vo={})),function(l){function h(){return!(!U(O)||!O.supports.webStorage)}l.isWebStorageClearedOnUserLogOut=function(){return U(O),h()},l.isSupported=h}(Co||(Co={}));var _o,Vr,Jo=se.V_2;(function(l){var h,y;function C(){return!(!U(O)||!O.supports.call)}(y=h=l.CallModalities||(l.CallModalities={})).Unknown="unknown",y.Audio="audio",y.Video="video",y.VideoBasedScreenSharing="videoBasedScreenSharing",y.Data="data",l.startCall=function(y){var m=Z(Jo,I.Call_StartCall);return new Promise(function(S){var F;if(U(O,E.content,E.task),!C())throw Pe;if(!O.isLegacyTeams)return Tt(m,"call.startCall",[y],S);S(xr(m,"executeDeepLink",function(l,h,C){if(0===l.length)throw new Error("Must have at least one target when creating a call deep link");var y="users="+l.map(function(F){return encodeURIComponent(F)}).join(","),m=void 0===h?"":"&withVideo="+encodeURIComponent(h),S=void 0===C?"":"&source="+encodeURIComponent(C);return _e+"://"+pe+"/l/call/0/0?"+y+m+S}(y.targets,null===(F=y.requestedModalities)||void 0===F?void 0:F.includes(h.Video),y.source)).then(function(A){if(!A)throw new Error("The call was not properly started");return A}))})},l.isSupported=C})(_o||(_o={})),function(l){l.Messages=Ln.Messages,l.FailedReason=Ln.FailedReason,l.ExpectedFailureReason=Ln.ExpectedFailureReason,l.notifyAppLoaded=function(){Ln.notifyAppLoaded()},l.notifySuccess=function(){Ln.notifySuccess()},l.notifyFailure=function(h){Ln.notifyFailure(h)},l.notifyExpectedFailure=function(h){Ln.notifyExpectedFailure(h)}}(Vr||(Vr={}));var yo,Ko=He("thirdPartyCloudStorage");!function(l){var h=[],C={fileType:"",assembleAttachment:[]},y=!0,m=null;function S(A){if(m)if(A&&A.error)m([],A.error),m=null;else if(A&&A.fileChunk)try{y||0!==A.fileChunk.chunkSequence||(Ko("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),y=!0,m([],{errorCode:we.INTERNAL_ERROR,message:"error occurred while receiving data"}),h=[],m=null);var R=lo(A.fileChunk,A.fileType);if(R?C.assembleAttachment.push(R):(Ko("Received a null assemble attachment for when decoding chunk sequence "+A.fileChunk.chunkSequence+"; not including the chunk in the assembled file."),m?m([],{errorCode:we.INTERNAL_ERROR,message:"error occurred while receiving data"}):m=null,h=[],m=null,y=!0),y=A.fileChunk.endOfFile,A.fileChunk.endOfFile){var V=li(C.assembleAttachment,C.fileType);if(V){var k=new File([V],A.fileName,{type:V.type});h.push(k)}A.isLastFile&&m&&(m(h,A.error),h=[],m=null,y=!0),C={fileType:"",assembleAttachment:[]}}}catch(J){m&&(m([],{errorCode:we.INTERNAL_ERROR,message:J}),h=[],m=null,y=!0)}else m([],{errorCode:we.INTERNAL_ERROR,message:"data received is null"}),h=[],m=null,y=!0}function F(){return!(!U(O)||!O.supports.thirdPartyCloudStorage)}l.getDragAndDropFiles=function(A,R){if(!R)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(A&&""!==A){if(U(O,E.content,E.task),!F())throw Pe;if(m)throw m=null,new Error("getDragAndDropFiles cannot be called twice");m=R,y=!0,We("thirdPartyCloudStorage.getDragAndDropFiles",[A],S)}else R([],{errorCode:we.INVALID_ARGUMENTS})},l.isSupported=F}(yo||(yo={}));var an=se.V_1;function as(l,h){Ga(Z(an,I.PublicAPIs_Initialize),h).then(function(){l&&l()})}function ss(){Ur.enablePrintCapability()}function ea(){Ur.print()}function ls(l){dr(),Tt(Z(an,I.PublicAPIs_GetContext),"getContext",function(h){h.frameContext||(h.frameContext=N.frameContext),l(h)})}function or(l){Ki(Z(an,I.PublicAPIs_RegisterOnThemeChangeHandlerHelper),l)}function ki(l){En(Z(an,I.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",l,[])}function cs(l){En(Z(an,I.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",l,[E.content])}function ta(l){En(Z(an,I.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",l,[E.content])}function bo(l){En(Z(an,I.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",l,[E.content])}function pi(l){Ut.backStack.registerBackButtonHandlerHelper(Z(an,I.PublicAPIs_RegisterBackButtonHandler),l)}function rn(l){Ur.registerOnLoadHandlerHelper(l)}function ar(l){Ur.registerBeforeUnloadHandlerHelper(l)}function na(l){En(Z(an,I.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",l,[])}function wo(l){En(Z(an,I.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",l,[E.content])}function So(l,h){U(O),Mn(Z(an,I.PublicAPIs_GetTabInstances),h).then(function(C){l(C)})}function Mo(l,h){U(O),je(Z(an,I.PublicAPIs_GetMruTabInstances),h).then(function(C){l(C)})}function Yr(l){Ao(Z(an,I.PublicAPIs_ShareDeepLink),{subPageId:l.subEntityId,subPageLabel:l.subEntityLabel,subPageWebUrl:l.subEntityWebUrl})}function vr(l,h){U(O,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage);var C=h??jn();Na(Z(an,I.PublicAPIs_ExecuteDeepLink),l).then(function(){C(!0)}).catch(function(y){C(!1,y.message)})}function Zr(l){Jt(Z(an,I.PublicAPIs_SetFrameContext),l)}function Fi(l,h,C){Ga(Z(an,I.PublicAPIs_Initialize),C).then(function(){return h&&h()}),Jt(Z(an,I.PublicAPIs_SetFrameContext),l)}var Ai,Vt=se.V_1;function ra(l){ir(Z(Vt,I.Navigation_ReturnFocus),l)}function Vi(l,h){U(O);var C=h??jn();nt(Z(Vt,I.Navigation_NavigateToTab),l).then(function(){C(!0)}).catch(function(y){C(!1,y.message)})}function ia(l,h){U(O,E.content,E.sidePanel,E.settings,E.remove,E.task,E.stage,E.meetingStage);var C=h??jn();Vo(Z(Vt,I.Navigation_NavigateCrossDomain),l).then(function(){C(!0)}).catch(function(y){C(!1,y.message)})}function oa(l){U(O);var h=l??jn();zs(Z(Vt,I.Navigation_NavigateBack)).then(function(){h(!0)}).catch(function(C){h(!1,C.message)})}!function(l){l.setValidityState=function(h){Ut.config.setValidityState(h)},l.getSettings=function(h){U(O,E.content,E.settings,E.remove,E.sidePanel),Ut.getConfig().then(function(C){h(C)})},l.setSettings=function(h,C){U(O,E.content,E.settings,E.sidePanel);var y=C??jn();Ut.config.setConfig(h).then(function(){y(!0)}).catch(function(m){y(!1,m.message)})},l.registerOnSaveHandler=function(h){Ut.config.registerOnSaveHandlerHelper(h)},l.registerOnRemoveHandler=function(h){Ut.config.registerOnRemoveHandlerHelper(h)}}(Ai||(Ai={}));var Li,hi,Ri=se.V_1;(function(l){function y(m){return m.height=m.height?m.height:er.Small,m.width=m.width?m.width:er.Small,m}l.startTask=function(m,S){var F=Z(Ri,I.Tasks_StartTask),A=S?function(R){var V,k;return S(null!==(V=R.err)&&void 0!==V?V:"",null!==(k=R.result)&&void 0!==k?k:"")}:void 0;return void 0===m.card&&void 0===m.url||m.card?(U(O,E.content,E.sidePanel,E.meetingStage),Tt(F,"tasks.startTask",[m],S)):void 0!==m.completionBotId?Ls(F,function(m){if(void 0===m.url||void 0===m.completionBotId)throw new Error("Both url "+m.url+" and completionBotId "+m.completionBotId+" are required for bot url dialog. At least one is undefined.");return{url:m.url,size:{height:m.height?m.height:er.Small,width:m.width?m.width:er.Small},title:m.title,fallbackUrl:m.fallbackUrl,completionBotId:m.completionBotId}}(m),A):La(F,function(m){if(void 0===m.url)throw new Error("url property of taskInfo object can't be undefined");return{url:m.url,size:{height:m.height?m.height:er.Small,width:m.width?m.width:er.Small},title:m.title,fallbackUrl:m.fallbackUrl}}(m),A),new Qo},l.updateTask=function(m){var R=function(h,C){var y={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&C.indexOf(m)<0&&(y[m]=h[m]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var S=0;for(m=Object.getOwnPropertySymbols(h);S<m.length;S++)C.indexOf(m[S])<0&&Object.prototype.propertyIsEnumerable.call(h,m[S])&&(y[m[S]]=h[m[S]])}return y}(m=y(m),["width","height"]);if(Object.keys(R).length)throw new Error("resize requires a TaskInfo argument containing only width and height");Rs(Z(Ri,I.Tasks_UpdateTask),m)},l.submitTask=function(m,S){Gs(Z(Ri,I.Tasks_SubmitTask),m,S)},l.getDefaultSizeIfNotProvided=y})(Li||(Li={})),function(l){var y;(y=l.UserMeetingRole||(l.UserMeetingRole={})).guest="Guest",y.attendee="Attendee",y.presenter="Presenter",y.organizer="Organizer",function(y){y.added="Added",y.alreadyExists="AlreadyExists",y.conflict="Conflict",y.notFound="NotFound"}(l.ContainerState||(l.ContainerState={})),l.isSupported=function(){return!(!U(O,E.meetingStage,E.sidePanel)||!O.supports.interactive)}}(hi||(hi={}));var sa=function(){function l(){}var h=l.prototype;return h.getFluidTenantInfo=function(){return Kn(),new Promise(function(y){y(Kt("interactive.getFluidTenantInfo"))})},h.getFluidToken=function(y){return Kn(),new Promise(function(m){m(Kt("interactive.getFluidToken",y))})},h.getFluidContainerId=function(){return Kn(),new Promise(function(y){y(Kt("interactive.getFluidContainerId"))})},h.setFluidContainerId=function(y){return Kn(),new Promise(function(m){m(Kt("interactive.setFluidContainerId",y))})},h.getNtpTime=function(){return Kn(),new Promise(function(y){y(Kt("interactive.getNtpTime"))})},h.registerClientId=function(y){return Kn(),new Promise(function(m){m(Kt("interactive.registerClientId",y))})},h.getClientRoles=function(y){return Kn(),new Promise(function(m){m(Kt("interactive.getClientRoles",y))})},h.getClientInfo=function(y){return Kn(),new Promise(function(m){m(Kt("interactive.getClientInfo",y))})},l.create=function(){return Kn(),new l},l}();function Kn(){if(!hi.isSupported())throw new Error("LiveShareHost Not supported")}var la=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function gi(l){try{return l.cartItems=Po(l.cartItems),l}catch{throw new Error("Error deserializing cart")}}function Po(l){return l.map(function(h){if(h.imageURL){var C=new URL(h.imageURL);h.imageURL=C}return h.accessories&&(h.accessories=Po(h.accessories)),h})}var da=function l(h){try{return h.map(function(C){var y=C.imageURL,m=C.accessories,S=function(h,C){var y={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&C.indexOf(m)<0&&(y[m]=h[m]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var S=0;for(m=Object.getOwnPropertySymbols(h);S<m.length;S++)C.indexOf(m[S])<0&&Object.prototype.propertyIsEnumerable.call(h,m[S])&&(y[m[S]]=h[m[S]])}return y}(C,["imageURL","accessories"]),F=Object.assign({},S);return y&&(F.imageURL=y.href),m&&(F.accessories=l(m)),F})}catch{throw new Error("Error serializing cart items")}};function ha(l){if(null!=l){if(!Array.isArray(l)||0===l.length)throw new Error("CartItem.accessories must be a non-empty array");for(var C,h=e(l);!(C=h()).done;){var y=C.value;if(y.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");Oo(y)}}}function Oo(l){if(!l.id)throw new Error("cartItem.id must not be empty");if(!l.name)throw new Error("cartItem.name must not be empty");(function(l){if("number"!=typeof l||l<0)throw new Error("price "+l+" must be a number not less than 0");if(parseFloat(l.toFixed(3))!==l)throw new Error("price "+l+" must have at most 3 decimal places")})(l.price),function(l){if("number"!=typeof l||l<=0||parseInt(l.toString())!==l)throw new Error("quantity "+l+" must be an integer greater than 0")}(l.quantity)}function fi(l){if(null!=l){if(!l)throw new Error("id must not be empty");if(!1===("string"==typeof(h=l)&&la.test(h)))throw new Error("id must be a valid UUID")}var h}var Ci,Jr,Gi,Ot,Kr,Ar,Ni,vi=se.V_2;(function(l){var m;function y(){return!(!U(O)||!O.supports.marketplace)}l.cartVersion={majorVersion:1,minorVersion:1},(m=l.Intent||(l.Intent={})).TACAdminUser="TACAdminUser",m.TeamsAdminUser="TeamsAdminUser",m.TeamsEndUser="TeamsEndUser",function(m){m.Open="Open",m.Processing="Processing",m.Processed="Processed",m.Closed="Closed",m.Error="Error"}(l.CartStatus||(l.CartStatus={})),l.getCart=function(){if(U(O,E.content,E.task),!y())throw Pe;return Mt(Z(vi,I.Marketplace_GetCart),"marketplace.getCart",l.cartVersion).then(gi)},l.addOrUpdateCartItems=function(m){if(U(O,E.content,E.task),!y())throw Pe;if(!m)throw new Error("addOrUpdateCartItemsParams must be provided");return fi(m?.cartId),function(l){if(!Array.isArray(l)||0===l.length)throw new Error("cartItems must be a non-empty array");for(var C,h=e(l);!(C=h()).done;){var y=C.value;Oo(y),ha(y.accessories)}}(m?.cartItems),Mt(Z(vi,I.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},m),{cartItems:da(m.cartItems),cartVersion:l.cartVersion})).then(gi)},l.removeCartItems=function(m){if(U(O,E.content,E.task),!y())throw Pe;if(!m)throw new Error("removeCartItemsParams must be provided");if(fi(m?.cartId),!Array.isArray(m?.cartItemIds)||0===m?.cartItemIds.length)throw new Error("cartItemIds must be a non-empty array");return Mt(Z(vi,I.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},m),{cartVersion:l.cartVersion})).then(gi)},l.updateCartStatus=function(m){if(U(O,E.content,E.task),!y())throw Pe;if(!m)throw new Error("updateCartStatusParams must be provided");return fi(m?.cartId),function(l){if(!Object.values(Ci.CartStatus).includes(l))throw new Error("cartStatus "+l+" is not valid")}(m?.cartStatus),Mt(Z(vi,I.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},m),{cartVersion:l.cartVersion})).then(gi)},l.isSupported=y})(Ci||(Ci={})),function(l){var C,m,A,h="Action.Execute";function S(A){if(A.requestType===C.ActionExecuteInvokeRequest){if(A.type!==h)throw{errorCode:m.INTERNAL_ERROR,message:"Invalid action type "+A.type+'. Action type must be "'+h+'"'}}else if(A.requestType===C.QueryMessageExtensionRequest){if(A.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(A.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(var k,V=e(A.parameters);!(k=V()).done;){var J=k.value;if(J.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(J.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function F(){return!(!U(O)||!O.supports.externalAppAuthentication)}(A=C=l.OriginalRequestType||(l.OriginalRequestType={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",A.QueryMessageExtensionRequest="QueryMessageExtensionRequest",function(A){A.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",A.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(l.InvokeResponseType||(l.InvokeResponseType={})),function(A){A.INTERNAL_ERROR="INTERNAL_ERROR"}(m=l.InvokeErrorCode||(l.InvokeErrorCode={})),l.authenticateAndResendRequest=function(A,R,V){if(U(O,E.content),!F())throw Pe;return Ye(A),S(V),Qn("externalAppAuthentication.authenticateAndResendRequest",[A,V,R.url.href,R.width,R.height,R.isExternal]).then(function(k){var ee=k[1];if(k[0]&&null!=ee.responseType)return ee;throw ee})},l.authenticateWithSSO=function(A,R){if(U(O,E.content),!F())throw Pe;return Ye(A),Qn("externalAppAuthentication.authenticateWithSSO",[A,R.claims,R.silent]).then(function(V){if(!V[0])throw V[1]})},l.authenticateWithSSOAndResendRequest=function(A,R,V){if(U(O,E.content),!F())throw Pe;return Ye(A),S(V),Qn("externalAppAuthentication.authenticateWithSSOAndResendRequest",[A,V,R.claims,R.silent]).then(function(k){var ee=k[1];if(k[0]&&null!=ee.responseType)return ee;throw ee})},l.isSupported=F}(Jr||(Jr={})),function(l){var S;function m(){return!(!U(O)||!O.supports.externalAppCardActions)}(S=l.ActionOpenUrlType||(l.ActionOpenUrlType={})).DeepLinkDialog="DeepLinkDialog",S.DeepLinkOther="DeepLinkOther",S.DeepLinkStageView="DeepLinkStageView",S.GenericUrl="GenericUrl",function(S){S.INTERNAL_ERROR="INTERNAL_ERROR",S.INVALID_LINK="INVALID_LINK",S.NOT_SUPPORTED="NOT_SUPPORTED"}(l.ActionOpenUrlErrorCode||(l.ActionOpenUrlErrorCode={})),function(S){S.INTERNAL_ERROR="INTERNAL_ERROR"}(l.ActionSubmitErrorCode||(l.ActionSubmitErrorCode={})),l.processActionSubmit=function(S,F){if(U(O,E.content),!m())throw Pe;return Ye(S),Qn("externalAppCardActions.processActionSubmit",[S,F]).then(function(A){if(!A[0])throw A[1]})},l.processActionOpenUrl=function(S,F){if(U(O,E.content),!m())throw Pe;return Ye(S),Qn("externalAppCardActions.processActionOpenUrl",[S,F.href]).then(function(A){var R=A[0];if(R)throw R;return A[1]})},l.isSupported=m}(Gi||(Gi={})),function(l){var R;function A(R,V){return{errorCode:R,message:V}}(R=l.CloudStorageProvider||(l.CloudStorageProvider={})).Dropbox="DROPBOX",R.Box="BOX",R.Sharefile="SHAREFILE",R.GoogleDrive="GOOGLEDRIVE",R.Egnyte="EGNYTE",R.SharePoint="SharePoint",function(R){R[R.Sharepoint=0]="Sharepoint",R[R.WopiIntegration=1]="WopiIntegration",R[R.Google=2]="Google",R[R.OneDrive=3]="OneDrive",R[R.Recent=4]="Recent",R[R.Aggregate=5]="Aggregate",R[R.FileSystem=6]="FileSystem",R[R.Search=7]="Search",R[R.AllFiles=8]="AllFiles",R[R.SharedWithMe=9]="SharedWithMe"}(l.CloudStorageProviderType||(l.CloudStorageProviderType={})),function(R){R.ClassMaterials="classMaterials"}(l.SpecialDocumentLibraryType||(l.SpecialDocumentLibraryType={})),function(R){R.Readonly="readonly"}(l.DocumentLibraryAccessType||(l.DocumentLibraryAccessType={})),function(R){R.Downloaded="Downloaded",R.Downloading="Downloading",R.Failed="Failed"}(l.FileDownloadStatus||(l.FileDownloadStatus={})),function(R){R.Download="DOWNLOAD",R.Upload="UPLOAD",R.Delete="DELETE"}(l.CloudStorageProviderFileAction||(l.CloudStorageProviderFileAction={})),l.getCloudStorageFolders=function(R,V){if(U(O,E.content),!R||0===R.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!V)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");We("files.getCloudStorageFolders",[R],V)},l.addCloudStorageFolder=function(R,V){if(U(O,E.content),!R||0===R.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!V)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");We("files.addCloudStorageFolder",[R],V)},l.deleteCloudStorageFolder=function(R,V,k){if(U(O,E.content),!R)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!V)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!k)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");We("files.deleteCloudStorageFolder",[R,V],k)},l.getCloudStorageFolderContents=function(R,V,k){if(U(O,E.content),!R||!V)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!k)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in R&&!R.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");We("files.getCloudStorageFolderContents",[R,V],k)},l.openCloudStorageFile=function(R,V,k){if(U(O,E.content),!R||!V)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(R.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");We("files.openCloudStorageFile",[R,V,k])},l.getExternalProviders=function(R,V){if(void 0===R&&(R=!1),U(O,E.content),!V)throw new Error("[files.getExternalProviders] Callback cannot be null");We("files.getExternalProviders",[R],V)},l.copyMoveFiles=function(R,V,k,J,ee,De){if(void 0===ee&&(ee=!1),U(O,E.content),!R||0===R.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!V)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!k)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!J)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!De)throw new Error("[files.copyMoveFiles] callback cannot be null");We("files.copyMoveFiles",[R,V,k,J,ee],De)},l.getFileDownloads=function(R){if(U(O,E.content),!R)throw new Error("[files.getFileDownloads] Callback cannot be null");We("files.getFileDownloads",[],R)},l.openDownloadFolder=function(R,V){if(void 0===R&&(R=void 0),U(O,E.content),!V)throw new Error("[files.openDownloadFolder] Callback cannot be null");We("files.openDownloadFolder",[R],V)},l.addCloudStorageProvider=function(R){if(U(O,E.content),!R)throw A(we.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");We("files.addCloudStorageProvider",[],R)},l.removeCloudStorageProvider=function(R,V){if(U(O,E.content),!V)throw A(we.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!R||!R.content)throw A(we.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");We("files.removeCloudStorageProvider",[R],V)},l.addCloudStorageProviderFile=function(R,V){if(U(O,E.content),!V)throw A(we.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!R||!R.content)throw A(we.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");We("files.addCloudStorageProviderFile",[R],V)},l.renameCloudStorageProviderFile=function(R,V){if(U(O,E.content),!V)throw A(we.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!R||!R.content)throw A(we.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");We("files.renameCloudStorageProviderFile",[R],V)},l.deleteCloudStorageProviderFile=function(R,V){if(U(O,E.content),!V)throw A(we.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(R&&R.content&&R.content.itemList&&R.content.itemList.length>0))throw A(we.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");We("files.deleteCloudStorageProviderFile",[R],V)},l.downloadCloudStorageProviderFile=function(R,V){if(U(O,E.content),!V)throw A(we.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(R&&R.content&&R.content.itemList&&R.content.itemList.length>0))throw A(we.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");We("files.downloadCloudStorageProviderFile",[R],V)},l.uploadCloudStorageProviderFile=function(R,V){if(U(O,E.content),!V)throw A(we.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(R&&R.content&&R.content.itemList&&R.content.itemList.length>0))throw A(we.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!R.content.destinationFolder)throw A(we.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");We("files.uploadCloudStorageProviderFile",[R],V)},l.registerCloudStorageProviderListChangeHandler=function(R){if(U(O),!R)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");et("files.cloudStorageProviderListChange",R)},l.registerCloudStorageProviderContentChangeHandler=function(R){if(U(O),!R)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");et("files.cloudStorageProviderContentChange",R)}}(Ot||(Ot={})),function(l){function h(){return!(!U(O)||!O.supports.meetingRoom)}l.getPairedMeetingRoomInfo=function(){return new Promise(function(C){if(U(O),!h())throw Pe;C(Kt("meetingRoom.getPairedMeetingRoomInfo"))})},l.sendCommandToPairedMeetingRoom=function(C){return new Promise(function(y){if(!C||0==C.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(U(O),!h())throw Pe;y(Kt("meetingRoom.sendCommandToPairedMeetingRoom",C))})},l.registerMeetingRoomCapabilitiesUpdateHandler=function(C){if(!C)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(U(O),!h())throw Pe;et("meetingRoom.meetingRoomCapabilitiesUpdate",function(y){U(O),C(y)})},l.registerMeetingRoomStatesUpdateHandler=function(C){if(!C)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(U(O),!h())throw Pe;et("meetingRoom.meetingRoomStatesUpdate",function(y){U(O),C(y)})},l.isSupported=h}(Kr||(Kr={})),function(l){function h(){return!(!U(O)||!O.supports.notifications)}l.showNotification=function(C){if(U(O,E.content),!h())throw Pe;We("notifications.showNotification",[C])},l.isSupported=h}(Ar||(Ar={})),function(l){var S;function m(){return!(!U(O)||!O.supports.remoteCamera)}(S=l.ControlCommand||(l.ControlCommand={})).Reset="Reset",S.ZoomIn="ZoomIn",S.ZoomOut="ZoomOut",S.PanLeft="PanLeft",S.PanRight="PanRight",S.TiltUp="TiltUp",S.TiltDown="TiltDown",function(S){S[S.CommandResetError=0]="CommandResetError",S[S.CommandZoomInError=1]="CommandZoomInError",S[S.CommandZoomOutError=2]="CommandZoomOutError",S[S.CommandPanLeftError=3]="CommandPanLeftError",S[S.CommandPanRightError=4]="CommandPanRightError",S[S.CommandTiltUpError=5]="CommandTiltUpError",S[S.CommandTiltDownError=6]="CommandTiltDownError",S[S.SendDataError=7]="SendDataError"}(l.ErrorReason||(l.ErrorReason={})),function(S){S[S.None=0]="None",S[S.ControlDenied=1]="ControlDenied",S[S.ControlNoResponse=2]="ControlNoResponse",S[S.ControlBusy=3]="ControlBusy",S[S.AckTimeout=4]="AckTimeout",S[S.ControlTerminated=5]="ControlTerminated",S[S.ControllerTerminated=6]="ControllerTerminated",S[S.DataChannelError=7]="DataChannelError",S[S.ControllerCancelled=8]="ControllerCancelled",S[S.ControlDisabled=9]="ControlDisabled",S[S.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(l.SessionTerminatedReason||(l.SessionTerminatedReason={})),l.getCapableParticipants=function(S){if(!S)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(U(O,E.sidePanel),!m())throw Pe;We("remoteCamera.getCapableParticipants",S)},l.requestControl=function(S,F){if(!S)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!F)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(U(O,E.sidePanel),!m())throw Pe;We("remoteCamera.requestControl",[S],F)},l.sendControlCommand=function(S,F){if(!S)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!F)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(U(O,E.sidePanel),!m())throw Pe;We("remoteCamera.sendControlCommand",[S],F)},l.terminateSession=function(S){if(!S)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(U(O,E.sidePanel),!m())throw Pe;We("remoteCamera.terminateSession",S)},l.registerOnCapableParticipantsChangeHandler=function(S){if(!S)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(U(O,E.sidePanel),!m())throw Pe;et("remoteCamera.capableParticipantsChange",S)},l.registerOnErrorHandler=function(S){if(!S)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(U(O,E.sidePanel),!m())throw Pe;et("remoteCamera.handlerError",S)},l.registerOnDeviceStateChangeHandler=function(S){if(!S)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(U(O,E.sidePanel),!m())throw Pe;et("remoteCamera.deviceStateChange",S)},l.registerOnSessionStatusChangeHandler=function(S){if(!S)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(U(O,E.sidePanel),!m())throw Pe;et("remoteCamera.sessionStatusChange",S)},l.isSupported=m}(Ni||(Ni={}));var Dn,Cr,Pn=se.V_1;(function(l){function h(){return!(!U(O)||!O.supports.appEntity)}l.selectAppEntity=function(C,y,m,S){if(U(O,E.content),!h())throw Pe;if(!C||0==C.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!S)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");Tt(Z(Pn,I.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[C,y,m],S)},l.isSupported=h})(Dn||(Dn={})),function(l){var m;function y(){return!(!U(O)||!O.supports.teams)}(m=l.ChannelType||(l.ChannelType={}))[m.Regular=0]="Regular",m[m.Private=1]="Private",m[m.Shared=2]="Shared",l.getTeamChannels=function(m,S){if(U(O,E.content),!y())throw Pe;if(!m)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!S)throw new Error("[teams.getTeamChannels] Callback cannot be null");We("teams.getTeamChannels",[m],S)},l.refreshSiteUrl=function(m,S){if(U(O),!y())throw Pe;if(!m)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!S)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");We("teams.refreshSiteUrl",[m],S)},l.isSupported=y,function(m){function F(){return!(!U(O)||!O.supports.teams||!O.supports.teams.fullTrust)}(function(A){function R(){return!!(U(O)&&O.supports.teams&&O.supports.teams.fullTrust&&O.supports.teams.fullTrust.joinedTeams)}A.getUserJoinedTeams=function(V){return new Promise(function(k){if(U(O),!R())throw Pe;if((N.hostClientType===Ue.android||N.hostClientType===Ue.teamsRoomsAndroid||N.hostClientType===Ue.teamsPhones||N.hostClientType===Ue.teamsDisplays)&&!$n("2.0.1"))throw new Error(JSON.stringify({errorCode:we.OLD_PLATFORM}));k(ai("getUserJoinedTeams",V))})},A.isSupported=R})(m.joinedTeams||(m.joinedTeams={})),m.getConfigSetting=function(A){return new Promise(function(R){if(U(O),!F())throw Pe;R(ai("getConfigSetting",A))})},m.isSupported=F}(l.fullTrust||(l.fullTrust={}))}(Cr||(Cr={}));var ei,_i=function(h,C,y,m){return new(y||(y=Promise))(function(F,A){function R(J){try{k(m.next(J))}catch(ee){A(ee)}}function V(J){try{k(m.throw(J))}catch(ee){A(ee)}}function k(J){J.done?F(J.value):function(F){return F instanceof y?F:new y(function(A){A(F)})}(J.value).then(R,V)}k((m=m.apply(h,C||[])).next())})};!function(l){l.frameProcessingTimeoutInMs=2e3;var C,V,h=Zt()?void 0:new mo(We);function y(){var V=setTimeout(function(){R("Frame not processed in "+l.frameProcessingTimeoutInMs+"ms",C.Warn)},l.frameProcessingTimeoutInMs);return function(){clearTimeout(V)}}function m(V,k){var J=this;return function(ee){return _i(J,void 0,void 0,j().mark(function De(){var wt,Te,re;return j().wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return k.reportStartFrameProcessing((wt=ee.videoFrame).codedWidth,wt.codedHeight),Te=y(),$e.next=5,V(ee);case 5:return re=$e.sent,$e.abrupt("return",(Te(),k.reportFrameProcessed(),re));case 7:case"end":return $e.stop()}},De)}))}}function F(){return U(O),Zn.isSupported()}function R(V,k){void 0===k&&(k=C.Warn),We("video.notifyError",[V,k])}(V=C=l.ErrorLevel||(l.ErrorLevel={})).Fatal="fatal",V.Warn="warn",l.registerForVideoFrame=function(V){var J,ee,k=this;if(!F())throw Pe;if(!V.videoFrameHandler||!V.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(U(O,E.sidePanel)){if(et("video.setFrameProcessTimeLimit",function(De){return h?.setFrameProcessTimeLimit(De)},!1),null===(J=O.supports.video)||void 0===J?void 0:J.mediaStream)et("video.startVideoExtensibilityVideoStream",function(De){return _i(k,void 0,void 0,j().mark(function wt(){var Te,re,Ne;return j().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:if(Te=De.streamId,re=De.metadataInTexture,Ne=h?m(V.videoFrameHandler,h):V.videoFrameHandler,!re){Ie.next=6;break}return Ie.next=4,Wr(Te,Ne,R,h);case 4:Ie.next=8;break;case 6:return Ie.next=8,is(Te,Ne,R,h);case 8:case"end":return Ie.stop()}},wt)}))},!1),We("video.mediaStream.registerForVideoFrame",[V.config]);else{if(null===(ee=O.supports.video)||void 0===ee||!ee.sharedFrame)throw Pe;et("video.newVideoFrame",function(De){if(De){h?.reportStartFrameProcessing(De.width,De.height);var wt=y(),Te=De.timestamp;V.videoBufferHandler(function(V){return V.videoFrameBuffer=V.videoFrameBuffer||V.data,delete V.data,V}(De),function(){wt(),h?.reportFrameProcessed(),function(V){We("video.videoFrameProcessed",[V])}(Te)},R)}},!1),We("video.registerForVideoFrame",[V.config])}h?.startMonitorSlowFrameProcessing()}},l.notifySelectedVideoEffectChanged=function(V,k,J){if(U(O,E.sidePanel),!F())throw Pe;We("video.videoEffectChanged",[V,k,J])},l.registerForVideoEffect=function(V){if(U(O,E.sidePanel),!F())throw Pe;et("video.effectParameterChange",fr(V,h),!1),We("video.registerForVideoEffect")},l.updatePersonalizedEffects=function(V){if(U(O,E.sidePanel),!Zn.isSupported())throw Pe;We("video.personalizedEffectsChanged",[V])},l.isSupported=F,l.notifyFatalError=function(V){if(U(O),!Zn.isSupported())throw Pe;R(V,C.Fatal)}}(ei||(ei={}))}(),tt}()},78590:function(pt,Ct,M){"use strict";M.d(Ct,{w9:function(){return bo},rP:function(){return us},Qo:function(){return b},Cq:function(){return cs},Mw:function(){return e}});var b,o,e,j,qe,te,Le,tt,Ge,He,Z,Ee,w={};M.r(w),M.d(w,{addQueryParameters:function(){return ea},getOrigin:function(){return ls},removeQueryAndFragment:function(){return ss}}),(o=b||(b={}))[o.ExistingPersistedMashup=0]="ExistingPersistedMashup",o[o.TransientMashup=1]="TransientMashup",o[o.TransientEmptyMashup=2]="TransientEmptyMashup",function(o){o.AddQueries="addQueries",o.BrowseMashup="BrowseMashup",o.ConnectToDataSource="ConnectToDataSource",o.CreateConnection="CreateConnection",o.DataPreview="DataPreview",o.DiagramView="DiagramView",o.EditConnection="EditConnection",o.EditDataflowComputeEngineSettings="EditDataflowComputeEngineSettings",o.EditCubeVariables="editCubeVariables",o.EditQuery="editQuery",o.EditQuickCreate="EditQuickCreate",o.ImportMashupTemplate="importMashupTemplate",o.IncrementalRefreshSettings="incrementalRefreshSettings",o.ManageConnections="manageConnections",o.ManageDataflowComputeEngine="manageDataflowComputeEngine",o.Navigate="navigate",o.QuickCreate="QuickCreate",o.RefreshSettings="refreshSettings",o.ResolveResourceChallenge="ResolveResourceChallenge",o.ShowRefreshHistory="showRefreshHistory"}(e||(e={})),function(o){o.Cancelled="Cancelled",o.CombineFiles="CombineFiles",o.CsvTextSettings="CsvTextSettings",o.DataDiscovery="DataDiscovery",o.DataSources="DataSources",o.DataSourceSettings="DataSourceSettings",o.FolderPreview="FolderPreview",o.IncrementalRefreshSettings="IncrementalRefreshSettings",o.Loading="Loading",o.MappingEditor="MappingEditor",o.Navigator="Navigator",o.QueryEditor="QueryEditor",o.QuickCreate="QuickCreate",o.RecentDataPreview="RecentDataPreview",o.RefreshSettings="RefreshSettings",o.TemplateCredentials="TemplateCredentials",o.TemplateParameters="TemplateParameters",o.TextByExample="TextByExample"}(j||(j={})),function(o){o.Attach="Attach"}(qe||(qe={})),function(o){o.Busy="Busy",o.Error="Error",o.Ready="Ready",o.Unknown="Unknown"}(te||(te={})),function(o){o.Editable="Editable",o.Hidden="Hidden",o.Readonly="Readonly"}(Le||(Le={})),function(o){o.Dataflow="Dataflow",o.Project="Project"}(tt||(tt={})),function(o){o.Definition="Definition",o.Instance="Instance"}(Ge||(Ge={})),function(o){o.DataSourceTemplateKind="DataSourceTemplateKind"}(He||(He={})),function(o){o.DataSourceTemplateKind="DataSourceTemplateKind",o.Navigation="Navigation"}(Z||(Z={})),function(o){o.Busy="Busy",o.Error="Error",o.Ready="Ready",o.Unknown="Unknown"}(Ee||(Ee={}));var yr,br,se=M(90341);function q(o){throw new Error("Unexpected value: "+o)}function X(o){switch(o.kind){case e.BrowseMashup:case e.ConnectToDataSource:case e.DataPreview:case e.DiagramView:case e.EditConnection:case e.EditCubeVariables:case e.EditDataflowComputeEngineSettings:case e.EditQuickCreate:case e.ImportMashupTemplate:case e.IncrementalRefreshSettings:case e.ManageConnections:case e.ManageDataflowComputeEngine:case e.Navigate:case e.QuickCreate:case e.RefreshSettings:case e.ShowRefreshHistory:return!0;case e.AddQueries:case e.CreateConnection:case e.EditQuery:case e.ResolveResourceChallenge:return!o.keepFlowRunningOnCommit;default:q(o)}}function K(o){switch(o.kind){case e.AddQueries:case e.BrowseMashup:case e.ConnectToDataSource:case e.CreateConnection:case e.DataPreview:case e.DiagramView:case e.EditConnection:case e.EditCubeVariables:case e.EditDataflowComputeEngineSettings:case e.EditQuery:case e.EditQuickCreate:case e.ImportMashupTemplate:case e.IncrementalRefreshSettings:case e.ManageConnections:case e.ManageDataflowComputeEngine:case e.Navigate:case e.QuickCreate:case e.RefreshSettings:case e.ShowRefreshHistory:return!0;case e.ResolveResourceChallenge:return!o.keepFlowRunningOnCancel;default:q(o)}}function Pe(o,d){return o.kind===d.kind}function Rn(o){Yt(o)}function Yt(o,d){if(null==o)throw new Error(d?d():"Value should be defined");return o}!function(o){o.ClientInstanceId="clientInstanceId",o.ProtocolId="protocolId"}(yr||(yr={})),function(o){o.DataAutomationId="data-automation-id",o.DataIsAutoFocusable="data-is-autofocusable",o.DataIsFocusable="data-is-focusable"}(br||(br={}));var tr,sr,lr,cr,vn,Gr,nr,rr,ht,Ke,Zt,Wn,Ye,ot,Cn,pn,zn,ni=function(){function o(g,f,T){this.iFrameElement=document.createElement("iframe"),this.iFrameElementOriginalDisplayValue=this.iFrameElement.style.display,this.iFrameElement.src=g,this.iFrameElement.title="Power Query",this.iFrameElement.allow="clipboard-read; clipboard-write",this.iFrameElement.setAttribute(br.DataIsFocusable,"true"),Rn(f),this.container=f,T&&(this.iFrameElement.className=T),this.hide(),this.container.appendChild(this.iFrameElement),this.isDisposed=!1}var d=o.prototype;return d.addEventListener=function(f,T,H){this.isDisposed||(Rn(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.addEventListener(f,T,H))},d.removeEventListener=function(f,T,H){this.isDisposed||(Rn(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.removeEventListener(f,T,H))},d.postMessage=function(f,T,H){this.isDisposed||(Rn(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.postMessage(f,T,H))},d.hide=function(){if(!this.isDisposed){var f=this.iFrameElement.style.display;"none"!==f&&(this.iFrameElementOriginalDisplayValue=f,this.iFrameElement.style.display="none")}},d.show=function(){this.isDisposed||(this.iFrameElement.style.display=this.iFrameElementOriginalDisplayValue)},d.dispose=function(){this.container.removeChild(this.iFrameElement),this.isDisposed=!0},o}();!function(o){o.GetEntityQueryScript="browseMashupCallbacks.getEntityQueryScript"}(tr||(tr={})),function(o){o.GetInitialComputeEngineSettings="computeEngineCallbacks.getInitialComputeEngineSettings"}(sr||(sr={})),function(o){o.OnStateChanged="createConnectionFlowClientCallbacks.onStateChanged"}(lr||(lr={})),function(o){o.OnSampleDataItemClick="dataDiscoveryFormCallbacks.onSampleDataItemClick"}(cr||(cr={})),function(o){o.OnEvaluationEnded="dataPreview.onEvaluationEnded",o.OnEvaluationStarted="dataPreview.onEvaluationStarted",o.OnQueryScriptChange="dataPreview.onQueryScriptChange",o.OnTableSelectionChanged="dataPreview.onTableSelectionChanged"}(vn||(vn={})),function(o){o.OnControlStateChanged="flowControlRpcMethodNames.onControlStateChanged"}(Gr||(Gr={})),function(o){o.OnCommandExecuted="hostCommandsCallbacks.onCommandExecuted"}(nr||(nr={})),function(o){o.GetLoginSuccessRedirectUri="hostPopupsCallbacks.getLoginSuccessRedirectUri",o.OpenHostPopup="hostPopupsCallbacks.openHostPopup"}(rr||(rr={})),function(o){o.OnUnlinkConnection="manageConnectionsFlowCallbacks.onUnlinkConnection"}(ht||(ht={})),function(o){o.GenerateNewEntityFieldNames="mappingEditorCallbacks.generateNewEntityFieldNames",o.GenerateNewEntityNames="mappingEditorCallbacks.generateNewEntityNames",o.GetEntities="mappingEditorCallbacks.getEntities",o.GetEntityFields="mappingEditorCallbacks.getEntityFields",o.GetEntityKeys="mappingEditorCallbacks.getEntityKeys",o.ValidateMappingEditorResult="mappingEditorCallbacks.validateMappingEditorResult"}(Ke||(Ke={})),function(o){o.GetEntityTypeFields="mappingCallbacks.getEntityTypeFields",o.GetEntityTypes="mappingCallbacks.getEntityTypes"}(Zt||(Zt={})),function(o){o.GetEntityDefinitionFromEntityPath="mappingCallbacksV2.getEntityDefinitionFromEntityPath",o.GetManifestDefinitionFromManifestPath="mappingCallbacksV2.getManifestDefinitionFromManifestPath",o.GetRootManifestDefinition="mappingCallbacksV2.getRootManifestDefinition"}(Wn||(Wn={})),function(o){o.GetMashupSensitivityLabel="mashupEditorClientCallbacks.getMashupSensitivityLabel",o.OnComputeEngineSettingsChanged="mashupEditorClientCallbacks.onComputeEngineSettingsChanged",o.OnEditingSessionMashupChanged="mashupEditorClientCallbacks.onEditingSessionMashupChanged",o.OnEditingSessionMashupInitialized="mashupEditorClientCallbacks.onEditingSessionMashupInitialized",o.OnMashupEditorClick="mashupEditorClientCallbacks.onMashupEditorClick",o.RenameMashup="mashupEditorClientCallbacks.renameMashup"}(Ye||(Ye={})),function(o){o.OnNewSqlQueryButtonClicked="powerBIDataMart.onNewSqlQueryButtonClicked",o.OnNewVisualQueryButtonClicked="powerBIDataMart.onNewVisualQueryButtonClicked",o.OnSaveAsViewButtonClicked="powerBIDataMart.onSaveAsViewButtonClicked",o.OnViewSqlButtonClicked="powerBIDataMart.onViewSqlButtonClicked",o.OnVisualizeResultButtonClicked="powerBIDataMart.onVisualizeResultButtonClicked"}(ot||(ot={})),function(o){o.OnDownloadExcelFileButtonClick="queryEditorPreviewButtonsCallbacks.onDownloadExcelFileButtonClick",o.OnSaveAsTableButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsTableButtonClick",o.OnSaveAsViewButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsViewButtonClick",o.OnVisualizeResultsButtonClick="queryEditorPreviewButtonsCallbacks.onVisualizeResultsButtonClick"}(Cn||(Cn={})),function(o){o.OnCommandBarPopupButtonClick="queryEditorCallbacks.onCommandBarPopupButtonClick",o.OnDiagramViewCommandBarPopupButtonClick="queryEditorCallbacks.onDiagramViewCommandBarPopupButtonClick",o.OnOpenInExcelButtonClick="queryEditorCallbacks.onOpenInExcelButtonClick",o.ValidateQuery="queryEditorCallbacks.validateQuery",o.ValidateQueryNameInteractive="queryEditorCallbacks.validateQueryNameInteractive"}(pn||(pn={})),function(o){o.GetUserSettings="userSettings.getUserSettings",o.SetUserSettings="userSettings.setUserSettings"}(zn||(zn={}));var O,yt=function(){function o(g,f,T,H,de){this.clientRpcChannel=g,this.clientRpcEndpointHost=f,this.client=T,this.configuration=H,this.clientStartTime=de,this.registerRpcMethods()}var d=o.prototype;return d.dispose=function(){this.unregisterRpcMethods()},d.registerRpcMethods=function(){var T,H,de,it,Ze,Xe,lt,Ve,Wt,en,sn,kt,St,un,gn,Bt,kn,On,dn,$t,Bn,fn,bn,wn,Rr,Fn,Vn,An,Q,D,L,oe,ge,ce,rt,gt,_t,zt,Rt,qt,ds,ps,hs,gs,fs,ms,vs,Cs,_s,f=this;this.register("acquireToken",function(Lt){return f.configuration.acquireToken(Lt)}),this.register("getClientStartTime",function(){return f.clientStartTime}),this.register("getSettings",function(){return f.configuration.editorSettings}),this.register("getVersion",function(){return"22.28.0"}),this.register("hasMappingCallbacks",function(){return null!=f.configuration.mappingCallbacks}),this.register("hasMappingCallbacksV2",function(){return null!=f.configuration.mappingCallbacksV2}),this.register("onAppReady",function(){return f.clientRpcEndpointHost.onAppReady()}),this.register("onCancel",function(){return f.clientRpcEndpointHost.onCancelCurrentFlow()}),this.register("onCommit",function(){}),this.register("onCommit2",function(Lt){return f.clientRpcEndpointHost.onCommitCurrentFlow(Lt)}),this.register("onFlowReady",function(){return f.clientRpcEndpointHost.onCurrentFlowReady()}),!(null===(T=this.configuration.browseMashupCallbacks)||void 0===T)&&T.getEntityQueryScript&&this.register(tr.GetEntityQueryScript,this.configuration.browseMashupCallbacks.getEntityQueryScript),!(null===(H=this.configuration.computeEngineCallbacks)||void 0===H)&&H.getInitialComputeEngineSettings&&this.register(sr.GetInitialComputeEngineSettings,this.configuration.computeEngineCallbacks.getInitialComputeEngineSettings),!(null===(de=this.configuration.createConnectionFlowClientCallbacks)||void 0===de)&&de.onStateChanged&&this.register(lr.OnStateChanged,this.configuration.createConnectionFlowClientCallbacks.onStateChanged),!(null===(it=this.configuration.dataPreviewCallbacks)||void 0===it)&&it.onEvaluationEnded&&this.register(vn.OnEvaluationEnded,this.configuration.dataPreviewCallbacks.onEvaluationEnded),!(null===(Ze=this.configuration.dataPreviewCallbacks)||void 0===Ze)&&Ze.onEvaluationStarted&&this.register(vn.OnEvaluationStarted,this.configuration.dataPreviewCallbacks.onEvaluationStarted),!(null===(Xe=this.configuration.dataPreviewCallbacks)||void 0===Xe)&&Xe.onQueryScriptChange&&this.register(vn.OnQueryScriptChange,this.configuration.dataPreviewCallbacks.onQueryScriptChange),!(null===(lt=this.configuration.dataPreviewCallbacks)||void 0===lt)&&lt.onTableSelectionChanged&&this.register(vn.OnTableSelectionChanged,this.configuration.dataPreviewCallbacks.onTableSelectionChanged),!(null===(Ve=this.configuration.flowControlCallbacks)||void 0===Ve)&&Ve.onControlStateChanged&&this.register(Gr.OnControlStateChanged,function(){var Lt;return null===(Lt=f.configuration.flowControlCallbacks)||void 0===Lt?void 0:Lt.onControlStateChanged(f.client)}),!(null===(Wt=this.configuration.hostPopupsCallbacks)||void 0===Wt)&&Wt.getLoginSuccessRedirectUri&&this.register(rr.GetLoginSuccessRedirectUri,this.configuration.hostPopupsCallbacks.getLoginSuccessRedirectUri),!(null===(en=this.configuration.hostPopupsCallbacks)||void 0===en)&&en.openHostPopup&&this.register(rr.OpenHostPopup,this.configuration.hostPopupsCallbacks.openHostPopup),!(null===(sn=this.configuration.hostCommandsCallbacks)||void 0===sn)&&sn.onCommandExecuted&&this.register(nr.OnCommandExecuted,this.configuration.hostCommandsCallbacks.onCommandExecuted),!(null===(kt=this.configuration.manageConnectionsFlowCallbacks)||void 0===kt)&&kt.onUnlinkConnection&&this.register(ht.OnUnlinkConnection,this.configuration.manageConnectionsFlowCallbacks.onUnlinkConnection),!(null===(St=this.configuration.mappingEditorCallbacks)||void 0===St)&&St.generateNewEntityFieldNames&&this.register(Ke.GenerateNewEntityFieldNames,this.configuration.mappingEditorCallbacks.generateNewEntityFieldNames),!(null===(un=this.configuration.mappingEditorCallbacks)||void 0===un)&&un.generateNewEntityNames&&this.register(Ke.GenerateNewEntityNames,this.configuration.mappingEditorCallbacks.generateNewEntityNames),!(null===(gn=this.configuration.mappingEditorCallbacks)||void 0===gn)&&gn.getEntities&&this.register(Ke.GetEntities,this.configuration.mappingEditorCallbacks.getEntities),!(null===(Bt=this.configuration.mappingEditorCallbacks)||void 0===Bt)&&Bt.getEntityFields&&this.register(Ke.GetEntityFields,this.configuration.mappingEditorCallbacks.getEntityFields),!(null===(kn=this.configuration.mappingEditorCallbacks)||void 0===kn)&&kn.getEntityKeys&&this.register(Ke.GetEntityKeys,this.configuration.mappingEditorCallbacks.getEntityKeys),!(null===(On=this.configuration.mappingEditorCallbacks)||void 0===On)&&On.validateMappingEditorResult&&this.register(Ke.ValidateMappingEditorResult,this.configuration.mappingEditorCallbacks.validateMappingEditorResult),!(null===(dn=this.configuration.mappingCallbacks)||void 0===dn)&&dn.getEntityTypeFields&&this.register(Zt.GetEntityTypeFields,this.configuration.mappingCallbacks.getEntityTypeFields),!(null===($t=this.configuration.mappingCallbacks)||void 0===$t)&&$t.getEntityTypes&&this.register(Zt.GetEntityTypes,null===(Bn=this.configuration.mappingCallbacks)||void 0===Bn?void 0:Bn.getEntityTypes),!(null===(fn=this.configuration.mappingCallbacksV2)||void 0===fn)&&fn.getEntityDefinitionFromEntityPath&&this.register(Wn.GetEntityDefinitionFromEntityPath,this.configuration.mappingCallbacksV2.getEntityDefinitionFromEntityPath),!(null===(bn=this.configuration.mappingCallbacksV2)||void 0===bn)&&bn.getManifestDefinitionFromManifestPath&&this.register(Wn.GetManifestDefinitionFromManifestPath,this.configuration.mappingCallbacksV2.getManifestDefinitionFromManifestPath),!(null===(wn=this.configuration.mappingCallbacksV2)||void 0===wn)&&wn.getRootManifestDefinition&&this.register(Wn.GetRootManifestDefinition,null===(Rr=this.configuration.mappingCallbacksV2)||void 0===Rr?void 0:Rr.getRootManifestDefinition),!(null===(Fn=this.configuration.mashupEditorClientCallbacks)||void 0===Fn)&&Fn.getMashupSensitivityLabel&&this.register(Ye.GetMashupSensitivityLabel,this.configuration.mashupEditorClientCallbacks.getMashupSensitivityLabel),!(null===(Vn=this.configuration.mashupEditorClientCallbacks)||void 0===Vn)&&Vn.onComputeEngineSettingsChanged&&this.register(Ye.OnComputeEngineSettingsChanged,this.configuration.mashupEditorClientCallbacks.onComputeEngineSettingsChanged),!(null===(An=this.configuration.mashupEditorClientCallbacks)||void 0===An)&&An.onEditingSessionMashupChanged&&this.register(Ye.OnEditingSessionMashupChanged,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupChanged),!(null===(Q=this.configuration.mashupEditorClientCallbacks)||void 0===Q)&&Q.onEditingSessionMashupInitialized&&this.register(Ye.OnEditingSessionMashupInitialized,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupInitialized),!(null===(D=this.configuration.mashupEditorClientCallbacks)||void 0===D)&&D.onMashupEditorClick&&this.register(Ye.OnMashupEditorClick,null===(L=this.configuration.mashupEditorClientCallbacks)||void 0===L?void 0:L.onMashupEditorClick),!(null===(oe=this.configuration.mashupEditorClientCallbacks)||void 0===oe)&&oe.renameMashup&&this.register(Ye.RenameMashup,this.configuration.mashupEditorClientCallbacks.renameMashup),!(null===(ge=this.configuration.powerBIDataMartCallbacks)||void 0===ge)&&ge.onNewSqlQueryButtonClicked&&this.register(ot.OnNewSqlQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewSqlQueryButtonClicked),!(null===(ce=this.configuration.powerBIDataMartCallbacks)||void 0===ce)&&ce.onNewVisualQueryButtonClicked&&this.register(ot.OnNewVisualQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewVisualQueryButtonClicked),!(null===(rt=this.configuration.powerBIDataMartCallbacks)||void 0===rt)&&rt.onSaveAsViewButtonClicked&&this.register(ot.OnSaveAsViewButtonClicked,this.configuration.powerBIDataMartCallbacks.onSaveAsViewButtonClicked),!(null===(gt=this.configuration.powerBIDataMartCallbacks)||void 0===gt)&&gt.onViewSqlButtonClicked&&this.register(ot.OnViewSqlButtonClicked,this.configuration.powerBIDataMartCallbacks.onViewSqlButtonClicked),!(null===(_t=this.configuration.powerBIDataMartCallbacks)||void 0===_t)&&_t.onVisualizeResultButtonClicked&&this.register(ot.OnVisualizeResultButtonClicked,this.configuration.powerBIDataMartCallbacks.onVisualizeResultButtonClicked),!(null===(zt=this.configuration.queryEditorCallbacks)||void 0===zt)&&zt.onCommandBarPopupButtonClick&&this.register(pn.OnCommandBarPopupButtonClick,function(){var Lt;return Yt(null===(Lt=f.configuration.queryEditorCallbacks)||void 0===Lt?void 0:Lt.onCommandBarPopupButtonClick)(f.client)}),!(null===(Rt=this.configuration.queryEditorCallbacks)||void 0===Rt)&&Rt.onDiagramViewCommandBarPopupButtonClick&&this.register(pn.OnDiagramViewCommandBarPopupButtonClick,function(){var Lt;return Yt(null===(Lt=f.configuration.queryEditorCallbacks)||void 0===Lt?void 0:Lt.onDiagramViewCommandBarPopupButtonClick)(f.client)}),!(null===(qt=this.configuration.queryEditorCallbacks)||void 0===qt)&&qt.onOpenInExcelButtonClick&&this.register(pn.OnOpenInExcelButtonClick,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.queryEditorCallbacks)||void 0===Gt?void 0:Gt.onOpenInExcelButtonClick)(f.client,Lt)}),!(null===(ds=this.configuration.queryEditorCallbacks)||void 0===ds)&&ds.validateQuery&&this.register(pn.ValidateQuery,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.queryEditorCallbacks)||void 0===Gt?void 0:Gt.validateQuery)(f.client,Lt)}),!(null===(ps=this.configuration.queryEditorCallbacks)||void 0===ps)&&ps.validateQueryNameInteractive&&this.register(pn.ValidateQueryNameInteractive,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.queryEditorCallbacks)||void 0===Gt?void 0:Gt.validateQueryNameInteractive)(f.client,Lt)}),!(null===(hs=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===hs)&&hs.onDownloadExcelFileButtonClick&&this.register(Cn.OnDownloadExcelFileButtonClick,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Gt?void 0:Gt.onDownloadExcelFileButtonClick)(Lt)}),!(null===(gs=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===gs)&&gs.onSaveAsTableButtonClick&&this.register(Cn.OnSaveAsTableButtonClick,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Gt?void 0:Gt.onSaveAsTableButtonClick)(Lt)}),!(null===(fs=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===fs)&&fs.onSaveAsViewButtonClick&&this.register(Cn.OnSaveAsViewButtonClick,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Gt?void 0:Gt.onSaveAsViewButtonClick)(Lt)}),!(null===(ms=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===ms)&&ms.onVisualizeResultsButtonClick&&this.register(Cn.OnVisualizeResultsButtonClick,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Gt?void 0:Gt.onVisualizeResultsButtonClick)(Lt)}),!(null===(vs=this.configuration.userSettingsStorageCallbacks)||void 0===vs)&&vs.getUserSettings&&this.register(zn.GetUserSettings,this.configuration.userSettingsStorageCallbacks.getUserSettings),!(null===(Cs=this.configuration.userSettingsStorageCallbacks)||void 0===Cs)&&Cs.setUserSettings&&this.register(zn.SetUserSettings,this.configuration.userSettingsStorageCallbacks.setUserSettings),null!==(_s=this.configuration.dataDiscoveryFormCallbacks)&&void 0!==_s&&_s.onSampleDataItemClick&&this.register(cr.OnSampleDataItemClick,function(Lt){var Gt;return Yt(null===(Gt=f.configuration.dataDiscoveryFormCallbacks)||void 0===Gt?void 0:Gt.onSampleDataItemClick)(Lt)})},d.unregisterRpcMethods=function(){this.unregister("acquireToken"),this.unregister("getClientStartTime"),this.unregister("getSettings"),this.unregister("getVersion"),this.unregister("onAppReady"),this.unregister("onCancel"),this.unregister("onCommit"),this.unregister("onFlowReady"),this.unregister(tr.GetEntityQueryScript),this.unregister(sr.GetInitialComputeEngineSettings),this.unregister(lr.OnStateChanged),this.unregister(vn.OnEvaluationEnded),this.unregister(vn.OnEvaluationStarted),this.unregister(vn.OnQueryScriptChange),this.unregister(vn.OnTableSelectionChanged),this.unregister(rr.GetLoginSuccessRedirectUri),this.unregister(rr.OpenHostPopup),this.unregister(nr.OnCommandExecuted),this.unregister(ht.OnUnlinkConnection),this.unregister(Ke.GenerateNewEntityFieldNames),this.unregister(Ke.GenerateNewEntityNames),this.unregister(Ke.GetEntities),this.unregister(Ke.GetEntityFields),this.unregister(Ke.GetEntityKeys),this.unregister(Ke.ValidateMappingEditorResult),this.unregister(Zt.GetEntityTypeFields),this.unregister(Zt.GetEntityTypes),this.unregister(Wn.GetEntityDefinitionFromEntityPath),this.unregister(Wn.GetManifestDefinitionFromManifestPath),this.unregister(Wn.GetRootManifestDefinition),this.unregister(Ye.GetMashupSensitivityLabel),this.unregister(Ye.OnComputeEngineSettingsChanged),this.unregister(Ye.OnEditingSessionMashupChanged),this.unregister(Ye.OnEditingSessionMashupInitialized),this.unregister(Ye.OnMashupEditorClick),this.unregister(Ye.RenameMashup),this.unregister(ot.OnNewSqlQueryButtonClicked),this.unregister(ot.OnNewVisualQueryButtonClicked),this.unregister(ot.OnSaveAsViewButtonClicked),this.unregister(ot.OnViewSqlButtonClicked),this.unregister(ot.OnVisualizeResultButtonClicked),this.unregister(pn.OnCommandBarPopupButtonClick),this.unregister(pn.OnDiagramViewCommandBarPopupButtonClick),this.unregister(pn.OnOpenInExcelButtonClick),this.unregister(pn.ValidateQuery),this.unregister(pn.ValidateQueryNameInteractive),this.unregister(Cn.OnDownloadExcelFileButtonClick),this.unregister(Cn.OnSaveAsTableButtonClick),this.unregister(Cn.OnSaveAsViewButtonClick),this.unregister(Cn.OnVisualizeResultsButtonClick),this.unregister(zn.GetUserSettings),this.unregister(zn.SetUserSettings),this.unregister(cr.OnSampleDataItemClick)},d.register=function(f,T){this.clientRpcChannel.register(f,T)},d.unregister=function(f){this.clientRpcChannel.unregister(f)},o}();!function(o){o.ActivateQuery="activateQuery",o.AddQuery="addQuery",o.CancelAddQueriesFlow="cancelAddQueriesFlow",o.ClickCancelButton="clickCancelButton",o.ClickCommitButton="clickCommitButton",o.ClickCustomButton="clickCustomButton",o.ClickNextStageButton="clickNextStageButton",o.ClickPreviousStageButton="clickPreviousStageButton",o.CreateConnectionFlow_Commit="createConnectionFlow_commit",o.DataPreview_CancelCurrentQueryEvaluation="dataPreview_cancelCurrentQueryEvaluation",o.DataPreview_SelectColumns="dataPreview_selectColumns",o.DeleteAllQueries="deleteAllQueries",o.DisposeService="disposeService",o.EndFlow="endFlow",o.GetActiveQueryName="getActiveQueryName",o.GetCancelButtonLabel="getCancelButtonLabel",o.GetCommitButtonLabel="getCommitButtonLabel",o.GetCommitResult="getCommitResult",o.GetComputeEngineSettings="getComputeEngineSettings",o.GetCurrentFlow="getCurrentFlow",o.GetCustomButtonLabel="getCustomButtonLabel",o.GetDataSourceQueryScript="getDataSourceQueryScript",o.GetDataWizardFooter_ClickCancelButton="getDataWizardFooter_clickCancelButton",o.GetDataWizardFooter_ClickCommitButton="getDataWizardFooter_clickCommitButton",o.GetDataWizardFooter_ClickCustomButton="getDataWizardFooter_clickCustomButton",o.GetDataWizardFooter_ClickNextStageButton="getDataWizardFooter_clickNextStageButton",o.GetDataWizardFooter_ClickPreviousStageButton="getDataWizardFooter_clickPreviousStageButton",o.GetEditingSessionId="getEditingSessionId",o.GetEditingSessionMashup="getEditingSessionMashup",o.GetFooterMessage="getFooterMessage",o.GetGetDataWizardFlowStage="getGetDataWizardFlowStage",o.GetIncrementalRefreshSettings="getIncrementalRefreshSettings",o.GetMashupGatewayVersion="getMashupGatewayVersion",o.GetNextStageButtonLabel="getNextStageButtonLabel",o.GetPreviousStageButtonLabel="getPreviousStageButtonLabel",o.GetQueriesInfo="getQueriesInfo",o.GetQueryEditorState="getQueryEditorState",o.GetQueryEditorStateOrThrow="getQueryEditorStateOrThrow",o.GetQueryNames="getQueryNames",o.GetQueryScript="getQueryScript",o.GetReadyState="getReadyState",o.GetRefreshSettings="getRefreshSettings",o.GetSelectedStepName="getSelectedStepName",o.GetUserSettings="getUserSettings",o.IsCancelButtonEnabled="isCancelButtonEnabled",o.IsCancelButtonVisible="isCancelButtonVisible",o.IsCommitButtonEnabled="isCommitButtonEnabled",o.IsCommitButtonVisible="isCommitButtonVisible",o.IsCustomButtonEnabled="isCustomButtonEnabled",o.IsCustomButtonVisible="isCustomButtonVisible",o.IsDialogVisible="isDialogVisible",o.IsFeatureSupported="isFeatureSupported",o.IsFooterOverlayVisible="isFooterOverlayVisible",o.IsNextStageButtonEnabled="isNextStageButtonEnabled",o.IsNextStageButtonVisible="isNextStageButtonVisible",o.IsPreviousStageButtonEnabled="isPreviousStageButtonEnabled",o.IsPreviousStageButtonVisible="isPreviousStageButtonVisible",o.LogXFramePerformanceMarks="logXFramePerformanceMarks",o.OnHostPopupCancelled="onHostPopupCancelled",o.RefreshActiveQueryResult="refreshActiveQueryResult",o.SetCommitButtonEnabledStatePolicy="setCommitButtonEnabledStatePolicy",o.SetUserSettings="setUserSettings",o.StartFlow="startFlow",o.TrySetQueryScript="trySetQueryScript"}(O||(O={}));var Ts=function(){function o(g){this.clientRpcChannel=g}var d=o.prototype;return d.activateQuery=function(f){return this.clientRpcChannel.call(O.ActivateQuery,[f])},d.addQuery=function(f,T,H){return this.clientRpcChannel.call(O.AddQuery,[f,T,H])},d.endFlow=function(){return this.clientRpcChannel.callIfSupported(O.EndFlow)},d.cancelAddQueriesFlow=function(){return this.clientRpcChannel.call(O.CancelAddQueriesFlow)},d.clickCancelButton=function(){return this.clientRpcChannel.call(O.ClickCancelButton)},d.clickCommitButton=function(){return this.clientRpcChannel.call(O.ClickCommitButton)},d.clickCustomButton=function(){return this.clientRpcChannel.call(O.ClickCustomButton)},d.clickNextStageButton=function(){return this.clientRpcChannel.call(O.ClickNextStageButton)},d.clickPreviousStageButton=function(){return this.clientRpcChannel.call(O.ClickPreviousStageButton)},d.createConnectionFlow_commit=function(f){return this.clientRpcChannel.call(O.CreateConnectionFlow_Commit,[f])},d.dataPreview_cancelCurrentQueryEvaluation=function(){return this.clientRpcChannel.call(O.DataPreview_CancelCurrentQueryEvaluation)},d.dataPreview_selectColumns=function(f){return this.clientRpcChannel.callIfSupported(O.DataPreview_SelectColumns,[f])},d.deleteAllQueries=function(){return this.clientRpcChannel.callIfSupported(O.DeleteAllQueries)},d.disposeService=function(){return this.clientRpcChannel.callIfSupported(O.DisposeService)},d.getActiveQueryName=function(){return this.clientRpcChannel.call(O.GetActiveQueryName)},d.getCancelButtonLabel=function(){return this.clientRpcChannel.call(O.GetCancelButtonLabel)},d.getCommitButtonLabel=function(){return this.clientRpcChannel.call(O.GetCommitButtonLabel)},d.getCustomButtonLabel=function(){return this.clientRpcChannel.call(O.GetCustomButtonLabel)},d.getCommitResult=function(){return this.clientRpcChannel.call(O.GetCommitResult)},d.getComputeEngineSettings=function(){return this.clientRpcChannel.call(O.GetComputeEngineSettings)},d.getCurrentFlow=function(){return this.clientRpcChannel.callIfSupported(O.GetCurrentFlow)},d.getDataSourceQueryScript=function(f,T){return this.clientRpcChannel.call(O.GetDataSourceQueryScript,[f,T])},d.getDataWizardFooter_clickCancelButton=function(){return this.clientRpcChannel.call(O.GetDataWizardFooter_ClickCancelButton)},d.getDataWizardFooter_clickCommitButton=function(){return this.clientRpcChannel.call(O.GetDataWizardFooter_ClickCommitButton)},d.getDataWizardFooter_clickCustomButton=function(){return this.clientRpcChannel.call(O.GetDataWizardFooter_ClickCustomButton)},d.getDataWizardFooter_clickNextStageButton=function(){return this.clientRpcChannel.call(O.GetDataWizardFooter_ClickNextStageButton)},d.getDataWizardFooter_clickPreviousStageButton=function(){return this.clientRpcChannel.call(O.GetDataWizardFooter_ClickPreviousStageButton)},d.getEditingSessionId=function(){return this.clientRpcChannel.call(O.GetEditingSessionId)},d.getEditingSessionMashup=function(f){return this.clientRpcChannel.call(O.GetEditingSessionMashup,[f])},d.getFooterMessage=function(){return this.clientRpcChannel.call(O.GetFooterMessage)},d.getGetDataWizardFlowStage=function(){return this.clientRpcChannel.callIfSupported(O.GetGetDataWizardFlowStage)},d.getIncrementalRefreshSettings=function(){return this.clientRpcChannel.call(O.GetIncrementalRefreshSettings)},d.getMashupGatewayVersion=function(){return this.clientRpcChannel.call(O.GetMashupGatewayVersion)},d.getNextStageButtonLabel=function(){return this.clientRpcChannel.call(O.GetNextStageButtonLabel)},d.getPreviousStageButtonLabel=function(){return this.clientRpcChannel.call(O.GetPreviousStageButtonLabel)},d.getQueriesInfo=function(){return this.clientRpcChannel.call(O.GetQueriesInfo)},d.getQueryEditorState=function(){return this.clientRpcChannel.call(O.GetQueryEditorState)},d.getQueryEditorStateOrThrow=function(){return this.clientRpcChannel.call(O.GetQueryEditorStateOrThrow)},d.getQueryNames=function(){return this.clientRpcChannel.call(O.GetQueryNames)},d.getQueryScript=function(f){return this.clientRpcChannel.call(O.GetQueryScript,[f])},d.getReadyState=function(){return this.clientRpcChannel.call(O.GetReadyState)},d.getRefreshSettings=function(){return this.clientRpcChannel.callIfSupported(O.GetRefreshSettings)},d.getSelectedStepName=function(){return this.clientRpcChannel.call(O.GetSelectedStepName)},d.getUserSettings=function(){return this.clientRpcChannel.call(O.GetUserSettings)},d.isCancelButtonEnabled=function(){return this.clientRpcChannel.call(O.IsCancelButtonEnabled)},d.isCancelButtonVisible=function(){return this.clientRpcChannel.call(O.IsCancelButtonVisible)},d.isCommitButtonEnabled=function(){return this.clientRpcChannel.call(O.IsCommitButtonEnabled)},d.isCommitButtonVisible=function(){return this.clientRpcChannel.call(O.IsCommitButtonVisible)},d.isCustomButtonEnabled=function(){return this.clientRpcChannel.call(O.IsCustomButtonEnabled)},d.isCustomButtonVisible=function(){return this.clientRpcChannel.call(O.IsCustomButtonVisible)},d.isDialogVisible=function(){return this.clientRpcChannel.call(O.IsDialogVisible)},d.isFeatureSupported=function(f){return this.clientRpcChannel.call(O.IsFeatureSupported,[f])},d.isFooterOverlayVisible=function(){return this.clientRpcChannel.call(O.IsFooterOverlayVisible)},d.isNextStageButtonEnabled=function(){return this.clientRpcChannel.call(O.IsNextStageButtonEnabled)},d.isNextStageButtonVisible=function(){return this.clientRpcChannel.call(O.IsNextStageButtonVisible)},d.isPreviousStageButtonEnabled=function(){return this.clientRpcChannel.call(O.IsPreviousStageButtonEnabled)},d.isPreviousStageButtonVisible=function(){return this.clientRpcChannel.call(O.IsPreviousStageButtonVisible)},d.logXFramePerformanceMarks=function(f){return this.clientRpcChannel.call(O.LogXFramePerformanceMarks,[f])},d.onHostPopupCancelled=function(f){return this.clientRpcChannel.callIfSupported(O.OnHostPopupCancelled,[f])},d.refreshActiveQueryResult=function(){return this.clientRpcChannel.callIfSupported(O.RefreshActiveQueryResult)},d.setCommitButtonEnabledStatePolicy=function(f){return this.clientRpcChannel.call(O.SetCommitButtonEnabledStatePolicy,[f])},d.setUserSettings=function(f){return this.clientRpcChannel.callIfSupported(O.SetUserSettings,[f])},d.startFlow=function(f,T){return this.clientRpcChannel.callIfSupported(O.StartFlow,[f,T])},d.trySetQueryScript=function(f,T){return this.clientRpcChannel.call(O.TrySetQueryScript,[f,T])},o}(),Fa=M(37419),Ui=function(){function o(){var g=this;this.resolveMethod=function(f){},this.rejectMethod=function(f){},this.promise=new Promise(function(f,T){g.resolveMethod=f,g.rejectMethod=T})}o.createResolvedDeferred=function(){var f=new o;return f.resolve(),f};var d=o.prototype;return d.resolve=function(f){this.resolveMethod(f)},d.reject=function(f){this.rejectMethod(f)},o}(),Va=M(79078);function ko(){return Va.Z()}function ri(){ri=function(){return d};var o,d={},g=Object.prototype,f=g.hasOwnProperty,T=Object.defineProperty||function(Q,D,L){Q[D]=L.value},H="function"==typeof Symbol?Symbol:{},de=H.iterator||"@@iterator",it=H.asyncIterator||"@@asyncIterator",Ze=H.toStringTag||"@@toStringTag";function Xe(Q,D,L){return Object.defineProperty(Q,D,{value:L,enumerable:!0,configurable:!0,writable:!0}),Q[D]}try{Xe({},"")}catch{Xe=function(L,oe,ge){return L[oe]=ge}}function lt(Q,D,L,oe){var ce=Object.create((D&&D.prototype instanceof un?D:un).prototype),rt=new Vn(oe||[]);return T(ce,"_invoke",{value:bn(Q,L,rt)}),ce}function Ve(Q,D,L){try{return{type:"normal",arg:Q.call(D,L)}}catch(oe){return{type:"throw",arg:oe}}}d.wrap=lt;var Wt="suspendedStart",en="suspendedYield",sn="executing",kt="completed",St={};function un(){}function gn(){}function Bt(){}var kn={};Xe(kn,de,function(){return this});var On=Object.getPrototypeOf,dn=On&&On(On(An([])));dn&&dn!==g&&f.call(dn,de)&&(kn=dn);var $t=Bt.prototype=un.prototype=Object.create(kn);function Bn(Q){["next","throw","return"].forEach(function(D){Xe(Q,D,function(L){return this._invoke(D,L)})})}function fn(Q,D){function L(ge,ce,rt,gt){var _t=Ve(Q[ge],Q,ce);if("throw"!==_t.type){var zt=_t.arg,Rt=zt.value;return Rt&&"object"==typeof Rt&&f.call(Rt,"__await")?D.resolve(Rt.__await).then(function(qt){L("next",qt,rt,gt)},function(qt){L("throw",qt,rt,gt)}):D.resolve(Rt).then(function(qt){zt.value=qt,rt(zt)},function(qt){return L("throw",qt,rt,gt)})}gt(_t.arg)}var oe;T(this,"_invoke",{value:function(ce,rt){function gt(){return new D(function(_t,zt){L(ce,rt,_t,zt)})}return oe=oe?oe.then(gt,gt):gt()}})}function bn(Q,D,L){var oe=Wt;return function(ge,ce){if(oe===sn)throw new Error("Generator is already running");if(oe===kt){if("throw"===ge)throw ce;return{value:o,done:!0}}for(L.method=ge,L.arg=ce;;){var rt=L.delegate;if(rt){var gt=wn(rt,L);if(gt){if(gt===St)continue;return gt}}if("next"===L.method)L.sent=L._sent=L.arg;else if("throw"===L.method){if(oe===Wt)throw oe=kt,L.arg;L.dispatchException(L.arg)}else"return"===L.method&&L.abrupt("return",L.arg);oe=sn;var _t=Ve(Q,D,L);if("normal"===_t.type){if(oe=L.done?kt:en,_t.arg===St)continue;return{value:_t.arg,done:L.done}}"throw"===_t.type&&(oe=kt,L.method="throw",L.arg=_t.arg)}}}function wn(Q,D){var L=D.method,oe=Q.iterator[L];if(oe===o)return D.delegate=null,"throw"===L&&Q.iterator.return&&(D.method="return",D.arg=o,wn(Q,D),"throw"===D.method)||"return"!==L&&(D.method="throw",D.arg=new TypeError("The iterator does not provide a '"+L+"' method")),St;var ge=Ve(oe,Q.iterator,D.arg);if("throw"===ge.type)return D.method="throw",D.arg=ge.arg,D.delegate=null,St;var ce=ge.arg;return ce?ce.done?(D[Q.resultName]=ce.value,D.next=Q.nextLoc,"return"!==D.method&&(D.method="next",D.arg=o),D.delegate=null,St):ce:(D.method="throw",D.arg=new TypeError("iterator result is not an object"),D.delegate=null,St)}function Rr(Q){var D={tryLoc:Q[0]};1 in Q&&(D.catchLoc=Q[1]),2 in Q&&(D.finallyLoc=Q[2],D.afterLoc=Q[3]),this.tryEntries.push(D)}function Fn(Q){var D=Q.completion||{};D.type="normal",delete D.arg,Q.completion=D}function Vn(Q){this.tryEntries=[{tryLoc:"root"}],Q.forEach(Rr,this),this.reset(!0)}function An(Q){if(Q||""===Q){var D=Q[de];if(D)return D.call(Q);if("function"==typeof Q.next)return Q;if(!isNaN(Q.length)){var L=-1,oe=function ge(){for(;++L<Q.length;)if(f.call(Q,L))return ge.value=Q[L],ge.done=!1,ge;return ge.value=o,ge.done=!0,ge};return oe.next=oe}}throw new TypeError(typeof Q+" is not iterable")}return gn.prototype=Bt,T($t,"constructor",{value:Bt,configurable:!0}),T(Bt,"constructor",{value:gn,configurable:!0}),gn.displayName=Xe(Bt,Ze,"GeneratorFunction"),d.isGeneratorFunction=function(Q){var D="function"==typeof Q&&Q.constructor;return!!D&&(D===gn||"GeneratorFunction"===(D.displayName||D.name))},d.mark=function(Q){return Object.setPrototypeOf?Object.setPrototypeOf(Q,Bt):(Q.__proto__=Bt,Xe(Q,Ze,"GeneratorFunction")),Q.prototype=Object.create($t),Q},d.awrap=function(Q){return{__await:Q}},Bn(fn.prototype),Xe(fn.prototype,it,function(){return this}),d.AsyncIterator=fn,d.async=function(Q,D,L,oe,ge){void 0===ge&&(ge=Promise);var ce=new fn(lt(Q,D,L,oe),ge);return d.isGeneratorFunction(D)?ce:ce.next().then(function(rt){return rt.done?rt.value:ce.next()})},Bn($t),Xe($t,Ze,"Generator"),Xe($t,de,function(){return this}),Xe($t,"toString",function(){return"[object Generator]"}),d.keys=function(Q){var D=Object(Q),L=[];for(var oe in D)L.push(oe);return L.reverse(),function ge(){for(;L.length;){var ce=L.pop();if(ce in D)return ge.value=ce,ge.done=!1,ge}return ge.done=!0,ge}},d.values=An,Vn.prototype={constructor:Vn,reset:function(D){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(Fn),!D)for(var L in this)"t"===L.charAt(0)&&f.call(this,L)&&!isNaN(+L.slice(1))&&(this[L]=o)},stop:function(){this.done=!0;var D=this.tryEntries[0].completion;if("throw"===D.type)throw D.arg;return this.rval},dispatchException:function(D){if(this.done)throw D;var L=this;function oe(zt,Rt){return rt.type="throw",rt.arg=D,L.next=zt,Rt&&(L.method="next",L.arg=o),!!Rt}for(var ge=this.tryEntries.length-1;ge>=0;--ge){var ce=this.tryEntries[ge],rt=ce.completion;if("root"===ce.tryLoc)return oe("end");if(ce.tryLoc<=this.prev){var gt=f.call(ce,"catchLoc"),_t=f.call(ce,"finallyLoc");if(gt&&_t){if(this.prev<ce.catchLoc)return oe(ce.catchLoc,!0);if(this.prev<ce.finallyLoc)return oe(ce.finallyLoc)}else if(gt){if(this.prev<ce.catchLoc)return oe(ce.catchLoc,!0)}else{if(!_t)throw new Error("try statement without catch or finally");if(this.prev<ce.finallyLoc)return oe(ce.finallyLoc)}}}},abrupt:function(D,L){for(var oe=this.tryEntries.length-1;oe>=0;--oe){var ge=this.tryEntries[oe];if(ge.tryLoc<=this.prev&&f.call(ge,"finallyLoc")&&this.prev<ge.finallyLoc){var ce=ge;break}}ce&&("break"===D||"continue"===D)&&ce.tryLoc<=L&&L<=ce.finallyLoc&&(ce=null);var rt=ce?ce.completion:{};return rt.type=D,rt.arg=L,ce?(this.method="next",this.next=ce.finallyLoc,St):this.complete(rt)},complete:function(D,L){if("throw"===D.type)throw D.arg;return"break"===D.type||"continue"===D.type?this.next=D.arg:"return"===D.type?(this.rval=this.arg=D.arg,this.method="return",this.next="end"):"normal"===D.type&&L&&(this.next=L),St},finish:function(D){for(var L=this.tryEntries.length-1;L>=0;--L){var oe=this.tryEntries[L];if(oe.finallyLoc===D)return this.complete(oe.completion,oe.afterLoc),Fn(oe),St}},catch:function(D){for(var L=this.tryEntries.length-1;L>=0;--L){var oe=this.tryEntries[L];if(oe.tryLoc===D){var ge=oe.completion;if("throw"===ge.type){var ce=ge.arg;Fn(oe)}return ce}}throw new Error("illegal catch attempt")},delegateYield:function(D,L,oe){return this.delegate={iterator:An(D),resultName:L,nextLoc:oe},"next"===this.method&&(this.arg=o),St}},d}var Wi="__SUPPORTS_METHOD__",$i=function(){function o(g){var f=this;this.onMessageReceived=function(T){T.method?f.handleRequestMessageReceived(T):f.handleResponseMessageReceived(T)},this.options=g,this.ready=!1,this.methodCallbackMap=new Map,this.requestDeferredByMessageId=new Map,this.queuedRequestMessages=[],this.options.rpcWindow.addListener(this.onMessageReceived),this.internalRegister(Wi,function(T){return f.handleSupportsMethodMessage(T)})}var d=o.prototype;return d.call=function(f,T){return this.internalCall(o.normalizeMethodName(f),T)},d.callIfSupported=function(f,T){return function(o,d,g,f){return new(g||(g=Promise))(function(H,de){function it(lt){try{Xe(f.next(lt))}catch(Ve){de(Ve)}}function Ze(lt){try{Xe(f.throw(lt))}catch(Ve){de(Ve)}}function Xe(lt){lt.done?H(lt.value):function(H){return H instanceof g?H:new g(function(de){de(H)})}(lt.value).then(it,Ze)}Xe((f=f.apply(o,d||[])).next())})}(this,void 0,void 0,ri().mark(function H(){return ri().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.next=2,this.supportsMethod(f);case 2:if(!Ze.sent){Ze.next=5;break}return Ze.abrupt("return",this.call(f,T));case 5:return Ze.abrupt("return",void 0);case 6:case"end":return Ze.stop()}},H,this)}))},d.dispose=function(){this.internalUnregister(Wi),this.requestDeferredByMessageId.forEach(function(f){return f.reject(function(o){var d=new Error("Rpc disposed");if(null!=d.stack)return d;try{throw d}catch(g){return g}}())}),this.requestDeferredByMessageId.clear(),this.options.rpcWindow.removeListener(this.onMessageReceived)},d.register=function(f,T){var H=this,de=o.normalizeMethodName(f);this.internalRegister(de,function(){for(var it,Ze,Xe=arguments.length,lt=new Array(Xe),Ve=0;Ve<Xe;Ve++)lt[Ve]=arguments[Ve];return null===(Ze=(it=H.options).onMethodInvoked)||void 0===Ze||Ze.call(it,f,lt),T.apply(void 0,lt)})},d.supportsMethod=function(f){return this.internalCall(Wi,[f])},d.unregister=function(f){var T=o.normalizeMethodName(f);this.internalUnregister(T)},d.canPostMessage=function(f){return this.ready},d.internalCall=function(f,T){void 0===T&&(T=void 0);var H=ko(),de={id:H,method:f,params:T},it=new Ui;return this.requestDeferredByMessageId.set(H,it),this.canPostMessage(de)?this.tryPostMessage(de):this.queuedRequestMessages.push(de),it.promise},d.internalRegister=function(f,T){if(this.methodCallbackMap.has(f))throw new Error("Rpc method with name '"+f+"' already registered.");this.methodCallbackMap.set(f,T)},d.internalUnregister=function(f){this.methodCallbackMap.delete(f)},d.onReady=function(){this.ready=!0,this.flushRequestMessageQueue()},o.getResponseMessageError=function(f){return f instanceof Error?{message:f.message,name:f.name,stack:f.stack}:f},o.normalizeMethodName=function(f){return f.toUpperCase()},d.flushRequestMessageQueue=function(){var f=this;this.queuedRequestMessages.forEach(function(T){return f.tryPostMessage(T)}),this.queuedRequestMessages=[]},d.handleRequestMessageReceived=function(f){var T=this,H=this.methodCallbackMap.get(f.method);if(H){var de={signature:f.signature,id:f.id};try{var it=H.apply(this,f.params);Promise.resolve(it).then(function(Ze){de.result=Ze,T.postMessage(de)}).catch(function(Ze){de.error=o.getResponseMessageError(Ze),T.postMessage(de)})}catch(Ze){de.error=o.getResponseMessageError(Ze),this.postMessage(de)}}},d.handleResponseMessageReceived=function(f){var T=f.id,H=this.requestDeferredByMessageId.get(T);H&&(f.error?H.reject(f.error):H.resolve(f.result),this.requestDeferredByMessageId.delete(T))},d.handleSupportsMethodMessage=function(f){return this.methodCallbackMap.has(o.normalizeMethodName(f))},d.postMessage=function(f){this.options.rpcWindow.postMessage(f)},d.tryPostMessage=function(f){try{this.postMessage(f)}catch(de){if(de instanceof Error){var T=f.id,H=this.requestDeferredByMessageId.get(T);H&&(H.reject(de),this.requestDeferredByMessageId.delete(T))}}},(0,se.Z)(o,[{key:"rpcHandshakeHandler",get:function(){return this.options.rpcHandshakeHandler}}]),o}(),Qi=function(o){function d(f){var T;return(T=o.call(this,f)||this).clientOptions=f,T.internalRegister(f.rpcHandshakeHandler.getReadyMessageMethod(),function(){return T.handleReadyMessage()}),T}return(0,Fa.Z)(d,o),d.prototype.handleReadyMessage=function(){return this.internalUnregister(this.rpcHandshakeHandler.getReadyMessageMethod()),this.onReady(),this.clientOptions.onAck&&this.clientOptions.onAck(),this.rpcHandshakeHandler.createAckResponse()},d}($i);function Qr(o,d,g){var f;return o&&mr(o)&&o.hasOwnProperty(d)&&null!==(f=o[d])&&void 0!==f?f:g}function mr(o){return function(o){return null!==o&&"object"==typeof o}(o)&&!Array.isArray(o)&&o.constructor===Object}var Jn=function(){function o(g){this.signature=g}var d=o.prototype;return d.deserialize=function(f){var T=f.data;return mr(T)?Qr(T,"data",T):T},d.serialize=function(f){return f.signature=this.signature,{id:f.id,kind:Qr(f,"method",o.emptyValue),signature:o.frameSignature,data:f}},o}();Jn.emptyValue="",Jn.frameSignature="FxFrameControl";var Vr,vo=function(){function o(){}var d=o.prototype;return d.createAckResponse=function(){return"start"},d.getReadyMessageMethod=function(){return"ready"},d.isAckResponse=function(f){return"start"===f},o}(),Co=function(){function o(g){this.signature=g}var d=o.prototype;return d.deserialize=function(f){return f.data},d.serialize=function(f){return f.signature=this.signature,f},o}(),Jo="__PONG__",_o=function(){function o(){}var d=o.prototype;return d.createAckResponse=function(){return Jo},d.getReadyMessageMethod=function(){return"__PING__"},d.isAckResponse=function(f){return f===Jo},o}();!function(o){o.Default="default",o.AzurePortal_v1_0_0="azureportal-v1.0.0"}(Vr||(Vr={}));var an=function(){function o(g){Rn(g.targetWindow),Rn(g.sourceWindow),this.options=g,this.eventListeners=new Map}var d=o.prototype;return d.addListener=function(f){var T=this;if(this.eventListeners.has(f))throw new Error("Duplicate rpc listener added.");var H=function(it){return T.handleMessageReceived(it,f)};this.eventListeners.set(f,H),this.options.sourceWindow.addEventListener(o.eventTypeName,H)},d.postMessage=function(f){var T=this.options.targetOriginProvider.getTargetOrigin(f);this.options.targetWindow.postMessage(this.options.rpcMessageConverter.serialize(f),T)},d.removeListener=function(f){var T=this.eventListeners.get(f);T&&(this.options.sourceWindow.removeEventListener(o.eventTypeName,T),this.eventListeners.delete(f))},o.isMessageEvent=function(f){return!function(o){return null==o}(f.data)},d.canProcessMessage=function(f){return!!f&&f.signature===this.options.rpcMessageConverter.signature},d.handleMessageReceived=function(f,T){if(o.isMessageEvent(f)){var H=this.options.rpcMessageConverter.deserialize(f);this.canProcessMessage(H)&&this.options.allowedOrigins.some(function(de){return function(o,d){if("*"===d)return!0;if(d.startsWith("https://*.")&&o.startsWith("https://")){var f=d.substring(9);return o.substring(8).endsWith(f)}return o===d}(f.origin,de)})&&(this.options.targetOriginProvider.onMessageReceived(f.origin),T(H))}},o}();an.eventTypeName="message";var as=function(){function o(g){this.explicitTargetOrigin=g}var d=o.prototype;return d.getTargetOrigin=function(f){return this.explicitTargetOrigin},d.onMessageReceived=function(f){},o}();function ss(o){var d=o.indexOf("#"),g=d>=0?o.substring(0,d):o,f=o.indexOf("?");return f>=0?g.substring(0,f):g}function ea(o){for(var g=o.indexOf("?")>-1?"&":"?",f=arguments.length,T=new Array(f>1?f-1:0),H=1;H<f;H++)T[H-1]=arguments[H];return""+o+g+T.map(function(it){return encodeURIComponent(it.name)+"="+encodeURIComponent(it.value)}).join("&")}function ls(o){var d=o.indexOf("//");if(d>=0){var g=o.indexOf("/",d+=2);if(g>=0)return o.substring(0,g)}return o}function or(){or=function(){return d};var o,d={},g=Object.prototype,f=g.hasOwnProperty,T=Object.defineProperty||function(Q,D,L){Q[D]=L.value},H="function"==typeof Symbol?Symbol:{},de=H.iterator||"@@iterator",it=H.asyncIterator||"@@asyncIterator",Ze=H.toStringTag||"@@toStringTag";function Xe(Q,D,L){return Object.defineProperty(Q,D,{value:L,enumerable:!0,configurable:!0,writable:!0}),Q[D]}try{Xe({},"")}catch{Xe=function(L,oe,ge){return L[oe]=ge}}function lt(Q,D,L,oe){var ce=Object.create((D&&D.prototype instanceof un?D:un).prototype),rt=new Vn(oe||[]);return T(ce,"_invoke",{value:bn(Q,L,rt)}),ce}function Ve(Q,D,L){try{return{type:"normal",arg:Q.call(D,L)}}catch(oe){return{type:"throw",arg:oe}}}d.wrap=lt;var Wt="suspendedStart",en="suspendedYield",sn="executing",kt="completed",St={};function un(){}function gn(){}function Bt(){}var kn={};Xe(kn,de,function(){return this});var On=Object.getPrototypeOf,dn=On&&On(On(An([])));dn&&dn!==g&&f.call(dn,de)&&(kn=dn);var $t=Bt.prototype=un.prototype=Object.create(kn);function Bn(Q){["next","throw","return"].forEach(function(D){Xe(Q,D,function(L){return this._invoke(D,L)})})}function fn(Q,D){function L(ge,ce,rt,gt){var _t=Ve(Q[ge],Q,ce);if("throw"!==_t.type){var zt=_t.arg,Rt=zt.value;return Rt&&"object"==typeof Rt&&f.call(Rt,"__await")?D.resolve(Rt.__await).then(function(qt){L("next",qt,rt,gt)},function(qt){L("throw",qt,rt,gt)}):D.resolve(Rt).then(function(qt){zt.value=qt,rt(zt)},function(qt){return L("throw",qt,rt,gt)})}gt(_t.arg)}var oe;T(this,"_invoke",{value:function(ce,rt){function gt(){return new D(function(_t,zt){L(ce,rt,_t,zt)})}return oe=oe?oe.then(gt,gt):gt()}})}function bn(Q,D,L){var oe=Wt;return function(ge,ce){if(oe===sn)throw new Error("Generator is already running");if(oe===kt){if("throw"===ge)throw ce;return{value:o,done:!0}}for(L.method=ge,L.arg=ce;;){var rt=L.delegate;if(rt){var gt=wn(rt,L);if(gt){if(gt===St)continue;return gt}}if("next"===L.method)L.sent=L._sent=L.arg;else if("throw"===L.method){if(oe===Wt)throw oe=kt,L.arg;L.dispatchException(L.arg)}else"return"===L.method&&L.abrupt("return",L.arg);oe=sn;var _t=Ve(Q,D,L);if("normal"===_t.type){if(oe=L.done?kt:en,_t.arg===St)continue;return{value:_t.arg,done:L.done}}"throw"===_t.type&&(oe=kt,L.method="throw",L.arg=_t.arg)}}}function wn(Q,D){var L=D.method,oe=Q.iterator[L];if(oe===o)return D.delegate=null,"throw"===L&&Q.iterator.return&&(D.method="return",D.arg=o,wn(Q,D),"throw"===D.method)||"return"!==L&&(D.method="throw",D.arg=new TypeError("The iterator does not provide a '"+L+"' method")),St;var ge=Ve(oe,Q.iterator,D.arg);if("throw"===ge.type)return D.method="throw",D.arg=ge.arg,D.delegate=null,St;var ce=ge.arg;return ce?ce.done?(D[Q.resultName]=ce.value,D.next=Q.nextLoc,"return"!==D.method&&(D.method="next",D.arg=o),D.delegate=null,St):ce:(D.method="throw",D.arg=new TypeError("iterator result is not an object"),D.delegate=null,St)}function Rr(Q){var D={tryLoc:Q[0]};1 in Q&&(D.catchLoc=Q[1]),2 in Q&&(D.finallyLoc=Q[2],D.afterLoc=Q[3]),this.tryEntries.push(D)}function Fn(Q){var D=Q.completion||{};D.type="normal",delete D.arg,Q.completion=D}function Vn(Q){this.tryEntries=[{tryLoc:"root"}],Q.forEach(Rr,this),this.reset(!0)}function An(Q){if(Q||""===Q){var D=Q[de];if(D)return D.call(Q);if("function"==typeof Q.next)return Q;if(!isNaN(Q.length)){var L=-1,oe=function ge(){for(;++L<Q.length;)if(f.call(Q,L))return ge.value=Q[L],ge.done=!1,ge;return ge.value=o,ge.done=!0,ge};return oe.next=oe}}throw new TypeError(typeof Q+" is not iterable")}return gn.prototype=Bt,T($t,"constructor",{value:Bt,configurable:!0}),T(Bt,"constructor",{value:gn,configurable:!0}),gn.displayName=Xe(Bt,Ze,"GeneratorFunction"),d.isGeneratorFunction=function(Q){var D="function"==typeof Q&&Q.constructor;return!!D&&(D===gn||"GeneratorFunction"===(D.displayName||D.name))},d.mark=function(Q){return Object.setPrototypeOf?Object.setPrototypeOf(Q,Bt):(Q.__proto__=Bt,Xe(Q,Ze,"GeneratorFunction")),Q.prototype=Object.create($t),Q},d.awrap=function(Q){return{__await:Q}},Bn(fn.prototype),Xe(fn.prototype,it,function(){return this}),d.AsyncIterator=fn,d.async=function(Q,D,L,oe,ge){void 0===ge&&(ge=Promise);var ce=new fn(lt(Q,D,L,oe),ge);return d.isGeneratorFunction(D)?ce:ce.next().then(function(rt){return rt.done?rt.value:ce.next()})},Bn($t),Xe($t,Ze,"Generator"),Xe($t,de,function(){return this}),Xe($t,"toString",function(){return"[object Generator]"}),d.keys=function(Q){var D=Object(Q),L=[];for(var oe in D)L.push(oe);return L.reverse(),function ge(){for(;L.length;){var ce=L.pop();if(ce in D)return ge.value=ce,ge.done=!1,ge}return ge.done=!0,ge}},d.values=An,Vn.prototype={constructor:Vn,reset:function(D){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(Fn),!D)for(var L in this)"t"===L.charAt(0)&&f.call(this,L)&&!isNaN(+L.slice(1))&&(this[L]=o)},stop:function(){this.done=!0;var D=this.tryEntries[0].completion;if("throw"===D.type)throw D.arg;return this.rval},dispatchException:function(D){if(this.done)throw D;var L=this;function oe(zt,Rt){return rt.type="throw",rt.arg=D,L.next=zt,Rt&&(L.method="next",L.arg=o),!!Rt}for(var ge=this.tryEntries.length-1;ge>=0;--ge){var ce=this.tryEntries[ge],rt=ce.completion;if("root"===ce.tryLoc)return oe("end");if(ce.tryLoc<=this.prev){var gt=f.call(ce,"catchLoc"),_t=f.call(ce,"finallyLoc");if(gt&&_t){if(this.prev<ce.catchLoc)return oe(ce.catchLoc,!0);if(this.prev<ce.finallyLoc)return oe(ce.finallyLoc)}else if(gt){if(this.prev<ce.catchLoc)return oe(ce.catchLoc,!0)}else{if(!_t)throw new Error("try statement without catch or finally");if(this.prev<ce.finallyLoc)return oe(ce.finallyLoc)}}}},abrupt:function(D,L){for(var oe=this.tryEntries.length-1;oe>=0;--oe){var ge=this.tryEntries[oe];if(ge.tryLoc<=this.prev&&f.call(ge,"finallyLoc")&&this.prev<ge.finallyLoc){var ce=ge;break}}ce&&("break"===D||"continue"===D)&&ce.tryLoc<=L&&L<=ce.finallyLoc&&(ce=null);var rt=ce?ce.completion:{};return rt.type=D,rt.arg=L,ce?(this.method="next",this.next=ce.finallyLoc,St):this.complete(rt)},complete:function(D,L){if("throw"===D.type)throw D.arg;return"break"===D.type||"continue"===D.type?this.next=D.arg:"return"===D.type?(this.rval=this.arg=D.arg,this.method="return",this.next="end"):"normal"===D.type&&L&&(this.next=L),St},finish:function(D){for(var L=this.tryEntries.length-1;L>=0;--L){var oe=this.tryEntries[L];if(oe.finallyLoc===D)return this.complete(oe.completion,oe.afterLoc),Fn(oe),St}},catch:function(D){for(var L=this.tryEntries.length-1;L>=0;--L){var oe=this.tryEntries[L];if(oe.tryLoc===D){var ge=oe.completion;if("throw"===ge.type){var ce=ge.arg;Fn(oe)}return ce}}throw new Error("illegal catch attempt")},delegateYield:function(D,L,oe){return this.delegate={iterator:An(D),resultName:L,nextLoc:oe},"next"===this.method&&(this.arg=o),St}},d}var ta,bo,pi,rn,ar,na,wo,So,Mo,Yr,vr,Zr,Fi,Vt,ra,Vi,ia,oa,Ai,aa,Ri,Li,hi,sa,Kn,la,ca,ua,gi,Po,da,pa,ha,Oo,fi,ga,mi,fa,vi,Ci,Jr,Gi,Ot,Kr,Ar,Ni,Pn,Dn,Cr,ei,_i,l,h,C,y,m,S,F,A,R,V,k,J,ee,De,wt,Te,re,Ne,$e,Ie,Pt,Ft,yn,cn,xo,ma,us,ul,dl,pl,hl,gl,fl,ml,vl,Cl,va,_l,yl,bl,wl,Sl,Ml,Pl,Ol,xl,Tl,El,Il,Dl,kl,Fl,Vl,Al,Rl,Ll,Gl,Nl,Hl,zl,ki=function(o,d,g,f){return new(g||(g=Promise))(function(H,de){function it(lt){try{Xe(f.next(lt))}catch(Ve){de(Ve)}}function Ze(lt){try{Xe(f.throw(lt))}catch(Ve){de(Ve)}}function Xe(lt){lt.done?H(lt.value):function(H){return H instanceof g?H:new g(function(de){de(H)})}(lt.value).then(it,Ze)}Xe((f=f.apply(o,d||[])).next())})},cs=function(){function o(g){var T,H,de,f=this,it=new Date;this.instanceId=ko(),this.configuration=g;var Ze=null!==(T=this.configuration.clientSettings.clientEnvironment)&&void 0!==T?T:this.createDefaultClientEnvironment(this.configuration.clientSettings.container,this.configuration.clientSettings.className),Xe=[{name:yr.ClientInstanceId,value:this.instanceId}];this.configuration.clientSettings.protocolId&&Xe.push({name:yr.ProtocolId,value:this.configuration.clientSettings.protocolId});var lt=ea.apply(w,[this.configuration.clientSettings.url].concat(Xe));this.appWindow=Ze.appWindowFactory(lt);var Ve=void 0!==this.configuration.clientSettings.allowedOrigin?this.configuration.clientSettings.allowedOrigin:"*",Wt=function(o,d){return d===Vr.AzurePortal_v1_0_0?{rpcMessageConverter:new Jn(o),rpcHandshakeHandler:new vo}:{rpcMessageConverter:new Co(o),rpcHandshakeHandler:new _o}}(function(o){return null==o?"mspq":"mspq-"+o}(this.instanceId),null!==(H=this.configuration.clientSettings.protocolId)&&void 0!==H?H:Vr.Default);this.clientRpcChannel=new Qi({debugName:"MashupEditorClient.clientRpcChannel",enableDebugLogging:null!==(de=this.configuration.clientSettings.enableDebugLogging)&&void 0!==de&&de,rpcHandshakeHandler:Wt.rpcHandshakeHandler,rpcWindow:new an({allowedOrigins:[Ve],rpcMessageConverter:Wt.rpcMessageConverter,sourceWindow:Ze.clientWindow,targetOriginProvider:new as(Ve),targetWindow:this.appWindow})}),this.clientRpcEndpoint=new yt(this.clientRpcChannel,{onCancelCurrentFlow:function(){return f.onCancelCurrentFlow()},onCommitCurrentFlow:function(sn){return f.onCommitCurrentFlow(sn)},onCurrentFlowReady:function(){return f.onCurrentFlowReady()},onAppReady:function(){return f.appReady.resolve()}},this,g,it),this.serviceProxy=new Ts(this.clientRpcChannel),this.appReady=new Ui}var d=o.prototype;return d.activateQuery=function(f){return this.serviceProxy.activateQuery(f)},d.addQuery=function(f,T,H){return this.serviceProxy.addQuery(f,T,H)},d.deleteAllQueries=function(){return this.serviceProxy.deleteAllQueries()},d.onHostPopupCancelled=function(f){return this.serviceProxy.onHostPopupCancelled(f)},d.cancelAddQueriesFlow=function(){return this.serviceProxy.cancelAddQueriesFlow()},d.endFlow=function(){return this.appWindow.hide(),this.serviceProxy.endFlow()},d.getActiveQueryName=function(){return this.serviceProxy.getActiveQueryName()},d.getCommitResult=function(){return this.serviceProxy.getCommitResult()},d.getComputeEngineSettings=function(){return this.serviceProxy.getComputeEngineSettings()},d.getCurrentFlow=function(){return this.serviceProxy.getCurrentFlow()},d.getDataSourceQueryScript=function(f,T){return this.serviceProxy.getDataSourceQueryScript(f,T)},d.getEditingSessionId=function(){return this.serviceProxy.getEditingSessionId()},d.getEditingSessionMashup=function(f){return this.serviceProxy.getEditingSessionMashup(f)},d.getMashupGatewayVersion=function(){return this.serviceProxy.getMashupGatewayVersion()},d.getGetDataWizardFlowStage=function(){return this.serviceProxy.getGetDataWizardFlowStage()},d.getFooterMessage=function(){return this.serviceProxy.getFooterMessage()},d.getIncrementalRefreshSettings=function(){return this.serviceProxy.getIncrementalRefreshSettings()},d.getQueriesInfo=function(){return this.serviceProxy.getQueriesInfo()},d.getQueryEditorState=function(){return this.serviceProxy.getQueryEditorState()},d.getQueryEditorStateOrThrow=function(){return this.serviceProxy.getQueryEditorStateOrThrow()},d.getQueryNames=function(){return this.serviceProxy.getQueryNames()},d.getQueryScript=function(f){return this.serviceProxy.getQueryScript(f)},d.getReadyState=function(){return this.serviceProxy.getReadyState()},d.getRefreshSettings=function(){return this.serviceProxy.getRefreshSettings()},d.getSelectedStepName=function(){return this.serviceProxy.getSelectedStepName()},d.getUserSettings=function(){return this.serviceProxy.getUserSettings()},d.isDialogVisible=function(){return this.serviceProxy.isDialogVisible()},d.isFeatureSupported=function(f){return this.serviceProxy.isFeatureSupported(f)},d.isFooterOverlayVisible=function(){return this.serviceProxy.isFooterOverlayVisible()},d.logXFramePerformanceMarks=function(f){return this.serviceProxy.logXFramePerformanceMarks(f)},d.refreshActiveQueryResult=function(){return this.serviceProxy.refreshActiveQueryResult()},d.setCommitButtonEnabledStatePolicy=function(f){return this.serviceProxy.setCommitButtonEnabledStatePolicy(f)},d.setUserSettings=function(f){return this.serviceProxy.setUserSettings(f)},d.startFlow=function(f,T,H,de){return ki(this,void 0,void 0,or().mark(function it(){return or().wrap(function(lt){for(;;)switch(lt.prev=lt.next){case 0:return lt.next=2,this.ready;case 2:return lt.next=4,this.getCurrentFlow();case 4:if(null==lt.sent){lt.next=7;break}throw Error("cannot start a new flow when an existing flow is running");case 7:return this.currentFlowConfiguration={flowReady:new Ui,shouldEndFlowOnCommit:X(f),shouldEndFlowOnCancel:K(f),onCommit:function(Wt,en){if(Pe(en,f))return T(Wt,en);throw new Error("The flow "+f.kind+" returned the wrong type of result: "+en.kind)},onCancel:H},this.appWindow.show(),this.serviceProxy.startFlow(f,de),lt.abrupt("return",this.currentFlowConfiguration.flowReady.promise);case 11:case"end":return lt.stop()}},it,this)}))},d.dispose=function(){return ki(this,void 0,void 0,or().mark(function f(){return or().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return this.appWindow.hide(),H.prev=1,H.next=4,this.serviceProxy.disposeService();case 4:return H.prev=4,this.clientRpcEndpoint.dispose(),this.clientRpcChannel.dispose(),this.appWindow.dispose(),H.finish(4);case 9:case"end":return H.stop()}},f,this,[[1,,4,9]])}))},d.trySetQueryScript=function(f,T){return this.serviceProxy.trySetQueryScript(f,T)},d.createDefaultClientEnvironment=function(f,T){return{clientWindow:window,appWindowFactory:function(de){return new ni(de,f,T)}}},d.onCancelCurrentFlow=function(){return ki(this,void 0,void 0,or().mark(function f(){return or().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!this.configuration.onCancel){H.next=2;break}return H.abrupt("return",this.configuration.onCancel(this));case 2:return Rn(this.currentFlowConfiguration),H.next=5,this.currentFlowConfiguration.onCancel(this);case 5:this.currentFlowConfiguration.shouldEndFlowOnCancel&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return H.stop()}},f,this)}))},d.onCommitCurrentFlow=function(f){return ki(this,void 0,void 0,or().mark(function T(){return or().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(!this.configuration.onCommit){de.next=2;break}return de.abrupt("return",this.configuration.onCommit(this));case 2:return Rn(this.currentFlowConfiguration),de.next=5,this.currentFlowConfiguration.onCommit(this,f);case 5:this.currentFlowConfiguration.shouldEndFlowOnCommit&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return de.stop()}},T,this)}))},d.onCurrentFlowReady=function(){Rn(this.currentFlowConfiguration),this.currentFlowConfiguration.flowReady.resolve()},(0,se.Z)(o,[{key:"dataPreview",get:function(){var f=this;return{cancelCurrentEvaluation:function(){return f.serviceProxy.dataPreview_cancelCurrentQueryEvaluation()},selectColumns:function(H){return f.serviceProxy.dataPreview_selectColumns(H)}}}},{key:"getDataWizardFooterCallbacks",get:function(){var f=this;return{clickCancelButton:function(){return f.serviceProxy.getDataWizardFooter_clickCancelButton()},clickCommitButton:function(){return f.serviceProxy.getDataWizardFooter_clickCommitButton()},clickCustomButton:function(){return f.serviceProxy.getDataWizardFooter_clickCustomButton()},clickNextStageButton:function(){return f.serviceProxy.getDataWizardFooter_clickNextStageButton()},clickPreviousStageButton:function(){return f.serviceProxy.getDataWizardFooter_clickPreviousStageButton()}}}},{key:"cancelButton",get:function(){var f=this;return{click:function(){return f.serviceProxy.clickCancelButton()},getLabel:function(){return f.serviceProxy.getCancelButtonLabel()},isEnabled:function(){return f.serviceProxy.isCancelButtonEnabled()},isVisible:function(){return f.serviceProxy.isCancelButtonVisible()}}}},{key:"commitButton",get:function(){var f=this;return{click:function(){return f.serviceProxy.clickCommitButton()},getLabel:function(){return f.serviceProxy.getCommitButtonLabel()},isEnabled:function(){return f.serviceProxy.isCommitButtonEnabled()},isVisible:function(){return f.serviceProxy.isCommitButtonVisible()}}}},{key:"customButton",get:function(){var f=this;return{click:function(){return f.serviceProxy.clickCustomButton()},getLabel:function(){return f.serviceProxy.getCustomButtonLabel()},isEnabled:function(){return f.serviceProxy.isCustomButtonEnabled()},isVisible:function(){return f.serviceProxy.isCustomButtonVisible()}}}},{key:"nextStageButton",get:function(){var f=this;return{click:function(){return f.serviceProxy.clickNextStageButton()},getLabel:function(){return f.serviceProxy.getNextStageButtonLabel()},isEnabled:function(){return f.serviceProxy.isNextStageButtonEnabled()},isVisible:function(){return f.serviceProxy.isNextStageButtonVisible()}}}},{key:"createConnectionFlowCallbacks",get:function(){var f=this;return{commit:function(H){return f.serviceProxy.createConnectionFlow_commit(H)}}}},{key:"previousStageButton",get:function(){var f=this;return{click:function(){return f.serviceProxy.clickPreviousStageButton()},getLabel:function(){return f.serviceProxy.getPreviousStageButtonLabel()},isEnabled:function(){return f.serviceProxy.isPreviousStageButtonEnabled()},isVisible:function(){return f.serviceProxy.isPreviousStageButtonVisible()}}}},{key:"ready",get:function(){return this.appReady.promise}}]),o}();!function(o){o.Success="Success",o.Error_EmptyName="Error_EmptyName",o.Error_InvalidCharacters="Error_InvalidCharacters",o.Error_NameAlreadyExists="Error_NameAlreadyExists",o.Error_NameTooLong="Error_NameTooLong"}(ta||(ta={})),function(o){o.Cancel="Cancel",o.Commit="Commit"}(bo||(bo={})),function(o){o.AlwaysCancel="AlwaysCancel",o.AlwaysCommit="AlwaysCommit",o.Ask="Ask"}(pi||(pi={})),function(o){o.BuiltInCommand="BuiltInCommand",o.HostCommand="HostCommand"}(rn||(rn={})),function(o){o.Kusto="kusto",o.Sql="sql"}(ar||(ar={})),function(o){o.StepLabel="StepLabel",o.StepName="StepName"}(na||(na={})),function(o){o.CalculatedEntity="CalculatedEntity",o.Default="Default",o.LinkedEntity="LinkedEntity",o.Parameter="Parameter",o.Visual="Visual"}(wo||(wo={})),function(o){o.Data="Data",o.Schema="Schema"}(So||(So={})),function(o){o.None="None",o.Query="Query",o.Step="Step"}(Mo||(Mo={})),function(o){o.Critical="Critical",o.Error="Error"}(Yr||(Yr={})),function(o){o.AlwaysDisabled="AlwaysDisabled",o.Default="Default"}(vr||(vr={})),function(o){o.Cancelled="Cancelled",o.Completed="Completed",o.Failed="Failed",o.NotStarted="NotStarted",o.Running="Running"}(Zr||(Zr={})),function(o){o.Access="Access",o.Access_Monocolor="Access_Monocolor",o.ActiveDirectory="ActiveDirectory",o.AddFuzzyClusterColumn="AddFuzzyClusterColumn",o.AddRankColumn="AddRankColumn",o.AdobeAnalytics="AdobeAnalytics",o.AIInsights="AIInsights",o.AllFilled="AllFilled",o.AllRegular="AllRegular",o.Alternates="Alternates",o.AnyType="AnyType",o.AppendQueries="AppendQueries",o.AppendQueriesAsNew="AppendQueriesAsNew",o.AzureAnalysisServices="AzureAnalysisServices",o.AzureBlobs="AzureBlobs",o.AzureFilled="AzureFilled",o.AzureHdInsightClusters="AzureHdInsightClusters",o.AzureRegular="AzureRegular",o.AzureSql="AzureSql",o.AzureSynapse="AzureSynapse",o.AzureTables="AzureTables",o.Binary="Binary",o.Blog="Blog",o.BlueLink="BlueLink",o.CalculatedEntity="CalculatedEntity",o.Calculator="Calculator",o.Cancel="Cancel",o.CancelRefresh="CancelRefresh",o.Cds="Cds",o.ChartClusteredBar="ChartClusteredBar",o.ChartClusteredColumn="ChartClusteredColumn",o.ChartLine="ChartLine",o.ChartPercentageStackedArea="ChartPercentageStackedArea",o.ChartPercentageStackedBar="ChartPercentageStackedBar",o.ChartPercentageStackedColumn="ChartPercentageStackedColumn",o.ChartStackedArea="ChartStackedArea",o.ChartStackedBar="ChartStackedBar",o.ChartStackedColumn="ChartStackedColumn",o.Checkmark="Checkmark",o.ChooseColumns="ChooseColumns",o.ClearFilter="ClearFilter",o.Close="Close",o.CloseAndLoad="CloseAndLoad",o.CloseAndLoadTo="CloseAndLoadTo",o.CloseRed="CloseRed",o.Column="Column",o.ColumnByExample="ColumnByExample",o.CombineFiles="CombineFiles",o.Community="Community",o.ConditionalColumn="ConditionalColumn",o.ConnectDatabase="ConnectDatabase",o.Copilot="Copilot",o.Copy="Copy",o.CountRows="CountRows",o.Cube="Cube",o.CubeAddAndExpandDimensionColumn="CubeAddAndExpandDimensionColumn",o.CubeCollapseAndRemoveColumns="CubeCollapseAndRemoveColumns",o.CubeDimension="CubeDimension",o.CubeDimensionAttribute="CubeDimensionAttribute",o.CubeDimensionHierarchy="CubeDimensionHierarchy",o.CubeMeasure="CubeMeasure",o.CubeServer="CubeServer",o.Currency="Currency",o.CustomColumn="CustomColumn",o.Cut="Cut",o.Database="Database",o.DatabaseClock="DatabaseClock",o.DatabaseDynamic="DatabaseDynamic",o.DatabaseFilled="DatabaseFilled",o.DatabaseLightning="DatabaseLightning",o.DatabaseOpaque="DatabaseOpaque",o.DatabaseRefresh="DatabaseRefresh",o.DatabaseRegular="DatabaseRegular",o.Databases="Databases",o.DatabaseUnknown="DatabaseUnknown",o.Dataflows="Dataflows",o.Dataverse="Dataverse",o.Date="Date",o.DateTime="DateTime",o.DateTimeZone="DateTimeZone",o.Delete="Delete",o.DeleteFile="DeleteFile",o.DemoteHeaders="DemoteHeaders",o.DetectDataType="DetectDataType",o.Diagram="Diagram",o.Documentation="Documentation",o.DragQueries="DragQueries",o.DragQueryGroups="DragQueryGroups",o.DuplicateColumn="DuplicateColumn",o.Duration="Duration",o.Dynamics365="Dynamics365",o.Empty="Empty",o.Entity="Entity",o.Error="Error",o.Excel="Excel",o.Excel_Monocolor="Excel_Monocolor",o.Exchange="Exchange",o.Exchange_Monocolor="Exchange_Monocolor",o.Expand="Expand",o.ExpandColumn="ExpandColumn",o.Fabric="Fabric",o.FabricFilled="FabricFilled",o.FabricRegular="FabricRegular",o.FastCopy="FastCopy",o.Feedback="Feedback",o.FeedbackExtremelyDissatisfied="FeedbackExtremelyDissatisfied",o.FeedbackExtremelySatisfied="FeedbackExtremelySatisfied",o.FeedbackSomewhatDissatisfied="FeedbackSomewhatDissatisfied",o.FeedbackSomewhatSatisfied="FeedbackSomewhatSatisfied",o.Fhir="Fhir",o.FileFilled="FileFilled",o.FileRegular="FileRegular",o.FillDown="FillDown",o.FillUp="FillUp",o.Filter="Filter",o.FitToView="FitToView",o.FluentView="FluentView",o.Folder="Folder",o.FormatText="FormatText",o.FullScreen="FullScreen",o.Function="Function",o.Gear="Gear",o.GetData="GetData",o.GoogleAnalytics="GoogleAnalytics",o.GoToColumn="GoToColumn",o.GridAutoFilter="GridAutoFilter",o.GridCombineFiles="GridCombineFiles",o.GridEditFilter="GridEditFilter",o.GridExpandColumn="GridExpandColumn",o.GridSortedAscending="GridSortedAscending",o.GridSortedDescending="GridSortedDescending",o.GroupBy="GroupBy",o.HorizontalLayout="HorizontalLayout",o.IndexColumn="IndexColumn",o.Info="Info",o.InsertColumnsLeft="InsertColumnsLeft",o.InsertColumnsRight="InsertColumnsRight",o.InsertRowsAbove="InsertRowsAbove",o.InsertRowsBelow="InsertRowsBelow",o.InvokeCustomFunction="InvokeCustomFunction",o.JoinKindFullOuter="JoinKindFullOuter",o.JoinKindInner="JoinKindInner",o.JoinKindLeftAnti="JoinKindLeftAnti",o.JoinKindLeftOuter="JoinKindLeftOuter",o.JoinKindRightAnti="JoinKindRightAnti",o.JoinKindRightOuter="JoinKindRightOuter",o.KeepBottomRows="KeepBottomRows",o.KeepDuplicates="KeepDuplicates",o.KeepErrors="KeepErrors",o.KeepRange="KeepRange",o.KeepTopRows="KeepTopRows",o.Key="Key",o.KeyboardShortcuts="KeyboardShortcuts",o.Kusto="Kusto",o.LightBulb="LightBulb",o.LinkedEntity="LinkedEntity",o.List="List",o.ListToTable="ListToTable",o.Load="Load",o.Logical="Logical",o.ManageConnections="ManageConnections",o.ManageDataSources="ManageDataSources",o.Map="Map",o.MapToEntity="MapToEntity",o.MashupGraphCollapse="MashupGraphCollapse",o.MashupGraphExpand="MashupGraphExpand",o.MashupGraphRelated="MashupGraphRelated",o.MathInfo="MathInfo",o.MergeColumns="MergeColumns",o.MergeQueries="MergeQueries",o.MergeQueriesAsNew="MergeQueriesAsNew",o.More="More",o.MoveColumns="MoveColumns",o.MoveColumnsLeft="MoveColumnsLeft",o.MoveColumnsRight="MoveColumnsRight",o.MoveColumnsToBeginning="MoveColumnsToBeginning",o.MoveColumnsToEnd="MoveColumnsToEnd",o.MoveDown="MoveDown",o.MoveLeft="MoveLeft",o.MoveRight="MoveRight",o.MoveUp="MoveUp",o.Neutral="Neutral",o.Number="Number",o.OData="OData",o.Odbc="Odbc",o.OnlineServicesFilled="OnlineServicesFilled",o.OnlineServicesRegular="OnlineServicesRegular",o.OtherFilled="OtherFilled",o.OtherRegular="OtherRegular",o.Parameter="Parameter",o.Parquet="Parquet",o.Parse="Parse",o.Paste="Paste",o.Pdf="Pdf",o.Pencil="Pencil",o.Percentage="Percentage",o.PivotColumn="PivotColumn",o.Plus="Plus",o.PowerBI="PowerBI",o.PowerBIReport="PowerBIReport",o.PowerPlatformFilled="PowerPlatformFilled",o.PowerPlatformRegular="PowerPlatformRegular",o.PowerQuery="PowerQuery",o.PrimitiveToList="PrimitiveToList",o.PrivacyBuffering="PrivacyBuffering",o.PromoteHeaders="PromoteHeaders",o.Properties="Properties",o.QuerySettings="QuerySettings",o.QuestionMark="QuestionMark",o.Record="Record",o.Reference="Reference",o.Refresh="Refresh",o.RemoveAlternateRows="RemoveAlternateRows",o.RemoveBlankRows="RemoveBlankRows",o.RemoveBottomRows="RemoveBottomRows",o.RemoveColumns="RemoveColumns",o.RemoveDuplicates="RemoveDuplicates",o.RemoveErrors="RemoveErrors",o.RemoveOtherColumns="RemoveOtherColumns",o.RemoveRows="RemoveRows",o.RemoveTopRows="RemoveTopRows",o.Rename="Rename",o.ReplaceErrors="ReplaceErrors",o.ReplaceValues="ReplaceValues",o.Reset="Reset",o.ReverseRows="ReverseRows",o.Rounding="Rounding",o.Salesforce="Salesforce",o.Save="Save",o.Scientific="Scientific",o.Script="Script",o.Sensitivity="Sensitivity",o.Settings="Settings",o.Share="Share",o.SharePoint="SharePoint",o.Sheet="Sheet",o.SheetAccess="SheetAccess",o.SheetCsv="SheetCsv",o.SheetDataflow="SheetDataflow",o.SheetExcel="SheetExcel",o.SheetHtml="SheetHtml",o.SheetJson="SheetJson",o.SheetSql="SheetSql",o.SheetText="SheetText",o.SheetXml="SheetXml",o.SortAscending="SortAscending",o.SortDescending="SortDescending",o.Spark="Spark",o.Sparkle="Sparkle",o.Sparkle_Monocolor="Sparkle_Monocolor",o.SplitColumn="SplitColumn",o.Standard="Standard",o.Statistics="Statistics",o.Success="Success",o.Suggestion="Suggestion",o.Support="Support",o.Table="Table",o.TableSchema="TableSchema",o.Template="Template",o.Text="Text",o.TextFile="TextFile",o.Time="Time",o.ToTable="ToTable",o.Transpose="Transpose",o.Trigonometry="Trigonometry",o.UnknownType="UnknownType",o.Unlink="Unlink",o.UnpivotColumns="UnpivotColumns",o.Vertica="Vertica",o.VerticalLayout="VerticalLayout",o.View="View",o.Visual="Visual",o.Wand="Wand",o.Warning="Warning",o.Web="Web",o.Website="Website",o.WholeNumber="WholeNumber",o.Worksheet="Worksheet"}(Fi||(Fi={})),function(o){o.FullRefresh="FullRefresh",o.IncrementalRefresh="IncrementalRefresh"}(Vt||(Vt={})),function(o){o.Days="Days",o.Months="Months",o.Quarters="Quarters",o.Years="Years"}(ra||(ra={})),function(o){o.Custom="Custom",o.Standard="Standard",o.System="System"}(Vi||(Vi={})),function(o){o.EvaluateTop1000Rows="EvaluateTop1000Rows",o.EvaluateEntireDataset="EvaluateEntireDataset"}(ia||(ia={})),function(o){o.Action="Action.Type",o.Any="Any.Type",o.Binary="Binary.Type",o.Byte="Byte.Type",o.Character="Character.Type",o.Currency="Currency.Type",o.Date="Date.Type",o.DateTime="DateTime.Type",o.DateTimeZone="DateTimeZone.Type",o.Decimal="Decimal.Type",o.Double="Double.Type",o.Duration="Duration.Type",o.Function="Function.Type",o.Int16="Int16.Type",o.Int32="Int32.Type",o.Int64="Int64.Type",o.Int8="Int8.Type",o.List="List.Type",o.Logical="Logical.Type",o.None="None.Type",o.Null="Null.Type",o.Number="Number.Type",o.Percentage="Percentage.Type",o.Record="Record.Type",o.Single="Single.Type",o.Table="Table.Type",o.Text="Text.Type",o.Time="Time.Type",o.Type="Type.Type"}(oa||(oa={})),function(o){o.MultiLine="MultiLine",o.SingleLine="SingleLine"}(Ai||(Ai={})),function(o){o.Always="Always",o.BasedOnProjectSettings="BasedOnProjectSettings",o.Never="Never"}(aa||(aa={})),function(o){o.Collapsed="Collapsed",o.Expanded="Expanded",o.Maximized="Maximized"}(Ri||(Ri={})),function(o){o.Host="Host",o.Initialization="Initialization",o.UserInteraction="UserInteraction"}(Li||(Li={})),function(o){o.Action="action",o.Any="any",o.AnyNonNull="anynonnull",o.Binary="binary",o.Currency="currency",o.Date="date",o.DateTime="datetime",o.DateTimeZone="datetimezone",o.Duration="duration",o.Exception="exception",o.Function="function",o.List="list",o.Logical="logical",o.None="none",o.Null="null",o.Number="number",o.Percentage="percentage",o.Record="record",o.Table="table",o.Text="text",o.Time="time",o.Type="type",o.WholeNumber="wholenumber"}(hi||(hi={})),function(o){o.Auto="Auto",o.Percent="Percent",o.Pixels="Pixels"}(sa||(sa={})),function(o){o.Cells="Cells",o.Columns="Columns",o.Rows="Rows"}(Kn||(Kn={})),function(o){o.Access="access",o.ActiveDirectory="activeDirectory",o.AdobeAnalytics="adobeAnalytics",o.AnalysisServices="analysisServices",o.AzureAnalysisServices="azureAnalysisServices",o.AzureBlobs="azureBlobs",o.AzureDataLake="azureDataLake",o.AzureHdInsightHdfs="azureHdInsightHdfs",o.AzureSql="azureSql",o.AzureSqlDw="azureSqlDW",o.AzureTables="azureTables",o.Blank="blank",o.Db2="db2",o.Dynamics365="dynamics365",o.EnterData="enterData",o.Excel="excel",o.ExchangeOnline="exchangeOnline",o.FolderContents="folderContents",o.FolderFiles="folderFiles",o.GoogleAnalytics="googleAnalytics",o.Json="json",o.MySql="mySql",o.Odata="odata",o.Odbc="odbc",o.Oracle="oracle",o.Parquet="parquet",o.Pdf="pdf",o.PostgreSql="postgreSql",o.SharepointFolder="sharepointFolder",o.SharepointList="sharepointList",o.SharepointOnlineList="sharepointOnlineList",o.SalesforceObjects="salesforceObjects",o.SalesforceReports="salesforceReports",o.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",o.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",o.SapHanaDatabase="SapHanaDatabase",o.Sql="sql",o.Sybase="sybase",o.Teradata="teradata",o.TextCsv="textCsv",o.Web="web",o.WebApi="webApi",o.Xml="xml"}(la||(la={})),function(o){o.Extension="extension"}(ca||(ca={})),function(o){o.Failed="Failed",o.Idle="Idle",o.InProgress="InProgress",o.Success="Success"}(ua||(ua={})),function(o){o.WaitingToStart="WaitingToStart",o.EvaluatingRelationships="EvaluatingRelationships",o.WaitingForOtherEntities="WaitingForOtherEntities",o.EvaluatingSchema="EvaluatingSchema",o.DeletingEntity="DeletingEntity",o.CreatingEntity="CreatingEntity",o.DeletingExistingData="DeletingExistingData",o.EvaluatingData="EvaluatingData",o.ProvisioningTempStorage="ProvisioningTempStorage",o.UploadingDataToTempStorage="UploadingDataToTempStorage",o.InitializingLoadSession="InitializingLoadSession",o.WaitingForLoadSessionToInitialize="WaitingForLoadSessionToInitialize",o.CreatingDefinitionGroup="CreatingDefinitionGroup",o.CreatingDefinitionGroupDetails="CreatingDefinitionGroupDetails",o.UploadingData="UploadingData",o.GeneratingFieldMapping="GeneratingFieldMapping",o.AutoSequencing="AutoSequencing",o.ExecutingLoad="ExecutingLoad",o.WaitingForLoadToComplete="WaitingForLoadToComplete",o.GeneratingExecutionErrors="GeneratingExecutionErrors",o.Success="Success",o.SignInRequired="SignInRequired",o.DeletingExistingDataFailed="DeletingExistingDataFailed",o.EvaluationFailed="EvaluationFailed",o.CreatingEntityFailed="CreatingEntityFailed",o.DeletingEntityFailed="DeletingEntityFailed",o.RetrievingEntityMetadataFailed="RetrievingEntityMetadataFailed",o.Canceled="Canceled",o.LoadToCdsPartiallySucceeded="LoadToCdsPartiallySucceeded",o.LoadToCdsFailed="LoadToCdsFailed",o.LoadFailedDueToErrorInOtherEntity="LoadFailedDueToErrorInOtherEntity",o.Unknown="Unknown"}(gi||(gi={})),function(o){o.Composition="Composition",o.Conditional="Conditional",o.CountDistinctValues="CountDistinctValues",o.CountValues="CountValues",o.Date_Age="Date_Age",o.Date_CombineWithTime="Date_CombineWithTime",o.Date_Day="Date_Day",o.Date_DayOfWeek="Date_DayOfWeek",o.Date_DayOfWeekName="Date_DayOfWeekName",o.Date_DayOfYear="Date_DayOfYear",o.Date_DaysInMonth="Date_DaysInMonth",o.Date_Earliest="Date_Earliest",o.Date_EndOfDay="Date_EndOfDay",o.Date_EndOfMonth="Date_EndOfMonth",o.Date_EndOfQuarter="Date_EndOfQuarter",o.Date_EndOfWeek="Date_EndOfWeek",o.Date_EndOfYear="Date_EndOfYear",o.Date_From="Date_From",o.Date_Latest="Date_Latest",o.Date_Month="Date_Month",o.Date_MonthName="Date_MonthName",o.Date_QuarterOfYear="Date_QuarterOfYear",o.Date_StartOfDay="Date_StartOfDay",o.Date_StartOfMonth="Date_StartOfMonth",o.Date_StartOfQuarter="Date_StartOfQuarter",o.Date_StartOfWeek="Date_StartOfWeek",o.Date_StartOfYear="Date_StartOfYear",o.Date_SubtractDays="Date_SubtractDays",o.Date_WeekOfMonth="Date_WeekOfMonth",o.Date_WeekOfYear="Date_WeekOfYear",o.Date_Year="Date_Year",o.DateTime_Earliest="DateTime_Earliest",o.DateTime_From="DateTime_From",o.DateTime_Latest="DateTime_Latest",o.DateTime_Subtract="DateTime_Subtract",o.DateTime_SubtractDays="DateTime_SubtractDays",o.DateTimeZone_Earliest="DateTimeZone_Earliest",o.DateTimeZone_From="DateTimeZone_From",o.DateTimeZone_Latest="DateTimeZone_Latest",o.DateTimeZone_Subtract="DateTimeZone_Subtract",o.DateTimeZone_SubtractDays="DateTimeZone_SubtractDays",o.DateTimeZone_ToLocal="DateTimeZone_ToLocal",o.Number_Abs="Number_Abs",o.Number_Acos="Number_Acos",o.Number_Asin="Number_Asin",o.Number_Atan="Number_Atan",o.Number_Average="Number_Average",o.Number_Cos="Number_Cos",o.Number_Cube="Number_Cube",o.Number_Divide="Number_Divide",o.Number_Exp="Number_Exp",o.Number_Factorial="Number_Factorial",o.Number_From="Number_From",o.Number_IntegerDivide="Number_IntegerDivide",o.Number_IsEven="Number_IsEven",o.Number_IsOdd="Number_IsOdd",o.Number_Ln="Number_Ln",o.Number_Log10="Number_Log10",o.Number_Maximum="Number_Maximum",o.Number_Median="Number_Median",o.Number_Minimum="Number_Minimum",o.Number_Modulo="Number_Modulo",o.Number_MultiplyColumnAndConstant="Number_MultiplyColumnAndConstant",o.Number_MultiplyColumns="Number_MultiplyColumns",o.Number_PercentOf="Number_PercentOf",o.Number_Power="Number_Power",o.Number_Range="Number_Range",o.Number_Round="Number_Round",o.Number_RoundDown="Number_RoundDown",o.Number_RoundUp="Number_RoundUp",o.Number_Sign="Number_Sign",o.Number_Sin="Number_Sin",o.Number_Sqrt="Number_Sqrt",o.Number_Square="Number_Square",o.Number_StandardDeviation="Number_StandardDeviation",o.Number_Subtract="Number_Subtract",o.Number_SumColumnAndConstant="Number_SumColumnAndConstant",o.Number_SumColumns="Number_SumColumns",o.Number_Tan="Number_Tan",o.Reference="Reference",o.Text_AfterDelimiter="Text_AfterDelimiter",o.Text_BeforeDelimiter="Text_BeforeDelimiter",o.Text_BetweenDelimiters="Text_BetweenDelimiters",o.Text_Combine="Text_Combine",o.Text_End="Text_End",o.Text_Length="Text_Length",o.Text_Literal="Text_Literal",o.Text_Middle="Text_Middle",o.Text_Reference="Text_Reference",o.Text_Remove="Text_Remove",o.Text_Replace="Text_Replace",o.Text_Select="Text_Select",o.Text_Start="Text_Start",o.Time_Earliest="Time_Earliest",o.Time_EndOfHour="Time_EndOfHour",o.Time_From="Time_From",o.Time_Hour="Time_Hour",o.Time_Latest="Time_Latest",o.Time_Minute="Time_Minute",o.Time_Second="Time_Second",o.Time_StartOfHour="Time_StartOfHour",o.Time_Subtract="Time_Subtract"}(Po||(Po={})),function(o){o.UnknownError="UnknownError",o.InvalidConnectionProvider="InvalidConnectionProvider"}(da||(da={})),function(o){o.Adf="Adf",o.CdsA="CdsA",o.Desktop="Desktop",o.DmtsPowerBi="DmtsPowerBi",o.DmtsSa="DmtsSa",o.None="None",o.PowerApps="PowerApps",o.SelfHosted="SelfHosted"}(pa||(pa={})),function(o){o.SqlDw="SqlDw",o.SynapseOnDemand="SynapseOnDemand"}(ha||(ha={})),function(o){o.Error="Error",o.Warning="Warning"}(Oo||(Oo={})),function(o){o[o.sunday=0]="sunday",o[o.monday=1]="monday",o[o.tuesday=2]="tuesday",o[o.wednesday=3]="wednesday",o[o.thursday=4]="thursday",o[o.friday=5]="friday",o[o.saturday=6]="saturday"}(fi||(fi={})),function(o){o.Boolean="Boolean",o.DateAndTime="DateAndTime",o.DateOnly="DateOnly",o.Decimal="Decimal",o.Double="Double",o.Integer="Integer",o.Lookup="Lookup",o.Memo="Memo",o.Money="Money",o.String="String"}(ga||(ga={})),function(o){o.Resource="Resource",o.Personal="Personal",o.VirtualNetwork="VirtualNetwork"}(mi||(mi={})),function(o){o[o.none=0]="none",o[o.fetchDataSourceDetails=1]="fetchDataSourceDetails",o[o.schemaRowsets=2]="schemaRowsets",o[o.mdDataset=4]="mdDataset",o[o.columnOrdinals=8]="columnOrdinals",o[o.statefulSessions=16]="statefulSessions",o[o.directQuerySingleSignOn_Kerberos=32]="directQuerySingleSignOn_Kerberos",o[o.mashupCustomConnectors=64]="mashupCustomConnectors",o[o.mashupCustomConnectorsForODG=128]="mashupCustomConnectorsForODG",o[o.sapHanaSSOManagedProvider=256]="sapHanaSSOManagedProvider",o[o.filteringMashupExtensionsOnODG=512]="filteringMashupExtensionsOnODG",o[o.certifiedConnectors=1024]="certifiedConnectors",o[o.mashupAzureConnectorsCachingPool=2048]="mashupAzureConnectorsCachingPool",o[o.skipTestConnection=4096]="skipTestConnection",o[o.encryptedConnectionOptionOverride=8192]="encryptedConnectionOptionOverride",o[o.mashupADONetProviderSSO=16384]="mashupADONetProviderSSO",o[o.authTypeSAS=32768]="authTypeSAS",o[o.powerQueryOnlineCachingPool=65536]="powerQueryOnlineCachingPool",o[o.ssoTestConnection=131072]="ssoTestConnection",o[o.mashupIgnorePreviouslyCachedData=262144]="mashupIgnorePreviouslyCachedData",o[o.mashupQueryStatus=524288]="mashupQueryStatus",o[o.multipleResults=1048576]="multipleResults",o[o.renewDiagnosticsStorageAccess=2097152]="renewDiagnosticsStorageAccess",o[o.oAuthResource=4194304]="oAuthResource",o[o.statefulDbConnection=8388608]="statefulDbConnection",o[o.discoverDatasourcesUsingMashupDSR=16777216]="discoverDatasourcesUsingMashupDSR"}(fa||(fa={})),function(o){o.Critical="Critical",o.Error="Error",o.Warning="Warning",o.Informational="Informational",o.Verbose="Verbose"}(vi||(vi={})),function(o){o[o.connectionNotFound=0]="connectionNotFound",o[o.failedToRefreshConnection=1]="failedToRefreshConnection",o[o.unauthorizedConnection=2]="unauthorizedConnection"}(Ci||(Ci={})),function(o){o.DifferentUser="DifferentUser",o.NoMatchingConnection="NoMatchingConnection",o.NonOAuthConnection="NonOAuthConnection ",o.NoToken="NoToken"}(Jr||(Jr={})),function(o){o.Active="ActivePowerAppsEnvironment",o.HardDeleted="HardDeletedPowerAppsEnvironment",o.SoftDeleted="SoftDeletedPowerAppsEnvironment",o.Unknown="UnknownPowerAppsEnvironment"}(Gi||(Gi={})),function(o){o.MappingEditorProperties="MappingEditorProperties"}(Ot||(Ot={})),function(o){o[o.day=0]="day",o[o.month=1]="month",o[o.quarter=2]="quarter",o[o.year=3]="year"}(Kr||(Kr={})),function(o){o.Minutes="Minutes",o.Hours="Hours",o.Days="Days",o.Weeks="Weeks",o.Months="Months"}(Ar||(Ar={})),function(o){o[o.uploadFileMalformedMultipartContent=1]="uploadFileMalformedMultipartContent",o[o.uploadFileUnsupportedFileExtension=2]="uploadFileUnsupportedFileExtension",o[o.oAuthStartLoginFailed=3]="oAuthStartLoginFailed",o[o.oAuthFinishLoginFailed=4]="oAuthFinishLoginFailed",o[o.normalizeResourceFailed=8]="normalizeResourceFailed",o[o.editVersionMismatch=9]="editVersionMismatch",o[o.updateGatewayVersion=10]="updateGatewayVersion",o[o.mashupTooLong=11]="mashupTooLong",o[o.gatewayBindingMultipleMatchingGatewayError=12]="gatewayBindingMultipleMatchingGatewayError",o[o.gatewayBindingNoMatchingDataSourceError=13]="gatewayBindingNoMatchingDataSourceError",o[o.gatewayBindingNoMatchingGatewayError=14]="gatewayBindingNoMatchingGatewayError"}(Ni||(Ni={})),function(o){o.NoTextExampleFound="NoTextExampleFound",o.NoTextProgramFound="NoTextProgramFound",o.NoTextProgramFoundBeforeCancellation="NoTextProgramFoundBeforeCancellation",o.NoTextProgramFoundBeforeTimeout="NoTextProgramFoundBeforeTimeout"}(Pn||(Pn={})),function(o){o.Successful="Successful",o.Failed="Failed",o.SessionExpired="SessionExpired"}(Dn||(Dn={})),function(o){o.AM="AM",o.PM="PM"}(Cr||(Cr={})),function(o){o[o.anonymous=1]="anonymous",o[o.basic=2]="basic",o[o.oAuth2=3]="oAuth2",o[o.windows=4]="windows",o[o.key=5]="key",o[o.sas=6]="sas",o[o.servicePrincipal=7]="servicePrincipal"}(ei||(ei={})),function(o){o.Access="access",o.ActiveDirectory="activeDirectory",o.AdobeAnalytics="adobeAnalytics",o.AnalysisServices="analysisServices",o.AzureAnalysisServices="azureAnalysisServices",o.AzureBlobs="azureBlobs",o.AzureDataLake="azureDataLake",o.AzureHdInsightHdfs="azureHdInsightHdfs",o.AzureSql="azureSql",o.AzureSqlDw="azureSqlDW",o.AzureTables="azureTables",o.Blank="blank",o.Db2="db2",o.Dynamics365="dynamics365",o.EnterData="enterData",o.Excel="excel",o.ExchangeOnline="exchangeOnline",o.FolderContents="folderContents",o.FolderFiles="folderFiles",o.GoogleAnalytics="googleAnalytics",o.Json="json",o.MySql="mySql",o.Odata="odata",o.Odbc="odbc",o.Oracle="oracle",o.Parquet="parquet",o.Pdf="pdf",o.PostgreSql="postgreSql",o.SharepointFolder="sharepointFolder",o.SharepointList="sharepointList",o.SharepointOnlineList="sharepointOnlineList",o.SalesforceObjects="salesforceObjects",o.SalesforceReports="salesforceReports",o.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",o.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",o.SapHanaDatabase="SapHanaDatabase",o.Sql="sql",o.Sybase="sybase",o.Teradata="teradata",o.TextCsv="textCsv",o.Web="web",o.WebApi="webApi",o.Xml="xml"}(_i||(_i={})),function(o){o.Automatic="Automatic",o.Explicit="Explicit",o.Fixed="Fixed"}(l||(l={})),function(o){o.Count="Count",o.ErrorCount="ErrorCount",o.NullCount="NullCount",o.DistinctCount="DistinctCount",o.UniqueCount="UniqueCount",o.Min="Min",o.Max="Max",o.ValueDistribution="ValueDistribution",o.Average="Average",o.EmptyStringCount="EmptyStringCount",o.TextLengthDistribution="TextLengthDistribution",o.NaNCount="NaNCount",o.ZeroCount="ZeroCount",o.EvenCount="EvenCount",o.OddCount="OddCount",o.StandardDeviation="StandardDeviation",o.SignDistribution="SignDistribution",o.ParityDistribution="ParityDistribution",o.TrueCount="TrueCount",o.FalseCount="FalseCount",o.YearDistribution="YearDistribution",o.MonthDistribution="MonthDistribution",o.DayDistribution="DayDistribution",o.WeekOfYearDistribution="WeekOfYearDistribution",o.DayOfWeekDistribution="DayOfWeekDistribution",o.AmPmDistribution="AmPmDistribution",o.HourDistribution="HourDistribution"}(h||(h={})),function(o){o.AccessPremiumConnectionNotAllowed="AccessPremiumConnectionNotAllowed",o.AdfConnectionEvaluationError="AdfConnectionEvaluationError",o.CdsaFeatureNotAvailableError="CdsaFeatureNotAvailableError",o.ConnectionApiPolicyViolation="ConnectionApiPolicyViolation",o.ConnectionCouldNotBeCreated="ConnectionCouldNotBeCreated",o.ConnectionCouldNotBeUpdated="ConnectionCouldNotBeUpdated",o.ConnectionKindNotSupported="ConnectionKindNotSupported",o.ConnectionNotFound="ConnectionNotFound",o.ConnectionShareNotAllowedInEnvironment="ConnectionShareNotAllowedInEnvironment",o.DataAccessError="DataAccessError",o.DataflowDatasourceIsReadOnly="DataflowDatasourceIsReadOnly",o.DataSourceUnreachableOrGatewayRequired="DataSourceUnreachableOrGatewayRequired",o.DuplicateDataSourceNameError="DuplicateDataSourceNameError",o.EncryptionNotSupportedForKindAndGateway="EncryptionNotSupportedForKindAndGateway",o.ExceededLimit="ExceededLimit",o.GatewayDetailsNotFound="GatewayDetailsNotFound",o.GatewayNotAuthorized="GatewayNotAuthorized",o.GatewayUnreachable="GatewayUnreachable",o.GatewayUnsupportedByLicense="GatewayUnsupportedByLicense",o.InvalidCredentials="InvalidCredentials",o.InvalidPath="InvalidPath",o.OAuthLoginFailed="OAuthLoginFailed",o.OboSignInError="OboSignInError",o.OboTokenAcquisitionFailed="OboTokenAcquisitionFailed",o.TooManyConnections="TooManyConnections",o.UnknownDmtsError="UnknownDmtsError",o.UnknownError="UnknownError",o.UnknownGatewayError="UnknownGatewayError",o.Unsupported="Unsupported"}(C||(C={})),function(o){o.AddStep="AddStep",o.CreateQuery="CreateQuery",o.DeleteQuery="DeleteQuery",o.ExplainQuery="ExplainQuery",o.ExplainStep="ExplainStep"}(y||(y={})),function(o){o.CouldNotExplainQuery="CouldNotExplainQuery",o.CouldNotGenerateQuery="CouldNotGenerateQuery",o.CouldNotGenerateStep="CouldNotGenerateStep",o.DataItemsMissing="DataItemsMissing",o.LanguageNotSupported="LanguageNotSupported",o.OutOfScope="OutOfScope",o.QueryNotFound="QueryNotFound",o.SkillNotFound="SkillNotFound",o.TableNotFound="TableNotFound",o.Unknown="Unknown"}(m||(m={})),function(o){o.Action="Action",o.Error="Error"}(S||(S={})),function(o){o.Automatic="Automatic",o.Explicit="Explicit",o.Fixed="Fixed"}(F||(F={})),function(o){o.Singleton="Singleton",o.Database="Database",o.Uri="Uri",o.Custom="Custom"}(A||(A={})),function(o){o.BuiltIn="BuiltIn",o.Extension="Extension"}(R||(R={})),function(o){o.JsonDsr="JsonDsr",o.MScript="MScript",o.QueryModel="QueryModel"}(V||(V={})),function(o){o.DSR="DSR",o.Reference="Reference",o.Script="Script"}(k||(k={})),function(o){o.Cluster="Cluster",o.Database="Database",o.Lakehouse="Lakehouse",o.Object="Object",o.Schema="Schema",o.Server="Server",o.Table="Table",o.Warehouse="Warehouse",o.Workspace="Workspace"}(J||(J={})),function(o){o.Constant="Constant",o.Duplicate="Duplicate",o.Empty="Empty",o.Index="Index"}(ee||(ee={})),function(o){o[o.false=0]="false",o[o.true=1]="true",o[o.notApplicable=2]="notApplicable",o[o.existingConnection=3]="existingConnection"}(De||(De={})),function(o){o.ApiHubTokenExchangeFailed="ApiHubTokenExchangeFailed",o.Cancelled="Cancelled",o.DuplicateEvaluationId="DuplicateEvaluationId",o.ErrorGettingPowerBIPrivateLinkConfig="ErrorGettingPowerBIPrivateLinkConfig",o.EvaluationAgentNotFound="EvaluationAgentNotFound",o.EvaluationQuotaReached="EvaluationQuotaReached",o.ExternalServiceError="ExternalServiceError",o.GatewayDetailsNotFound="GatewayDetailsNotFound",o.GatewayNeeded="GatewayNeeded",o.GatewayNotAuthorized="GatewayNotAuthorized",o.GatewayNotFound="GatewayNotFound",o.GatewayUnknownError="GatewayUnknownError",o.GatewayUnreachable="GatewayUnreachable",o.GatewayUpgradeRequired="GatewayUpgradeRequired",o.GatewayUserError="GatewayUserError",o.MashupEntityNotFound="MashupEntityNotFound",o.MaxConcurrentEvaluationsReached="MaxConcurrentEvaluationsReached",o.NetworkAccessDenied="NetworkAccessDenied",o.NoPowerBiClusterForTenant="NoPowerBiClusterForTenant",o.ParameterNotFound="ParameterNotFound",o.PowerAppsEnvironmentNotFound="PowerAppsEnvironmentNotFound",o.QueryNameAndQueryScriptBothSpecified="QueryNameAndQueryScriptBothSpecified",o.QueryNameAndQueryScriptNotSpecified="QueryNameAndQueryScriptNotSpecified",o.QueryNotFound="QueryNotFound",o.StepNotFound="StepNotFound",o.UnableToContactBackend="UnableToContactBackend",o.Unknown="Unknown",o.UnsupportedKind="UnsupportedKind",o.ValueTooComplex="ValueTooComplex"}(wt||(wt={})),function(o){o.Path="Path",o.QueryScript="QueryScript"}(Te||(Te={})),function(o){o.AutoFilterColumnValues="AutoFilterColumnValues",o.BinaryMetadata="BinaryMetadata",o.ConnectorRows="ConnectorRows",o.ConnectorSchema="ConnectorSchema",o.CubeAllowedValues="CubeAllowedValues",o.CubeDisplayFolders="CubeDisplayFolders",o.CubeParameters="CubeParameters",o.DataSourceQuery="DataSourceQuery",o.DetailsPreview="DetailsPreview",o.DetectTableHeaderAndColumnTypes="DetectTableHeaderAndColumnTypes",o.DsrDetailsFetching="DsrDetailsFetching",o.ExcelTableInferenceGetInferredTables="ExcelTableInferenceGetInferredTables",o.ExpandColumnNames="ExpandColumnNames",o.FunctionBrowser="FunctionBrowser",o.JsonTableInferenceGetJsonText="JsonTableInferenceGetJsonText",o.LoadToCdsCreateEntitiesRelationships="LoadToCdsCreateEntitiesRelationships",o.LoadToCdsRelationships="LoadToCdsRelationships",o.LoadToCdsSchema="LoadToCdsSchema",o.MappingEditorQueryProfiling="MappingEditorQueryProfiling",o.MappingEditorSchemaResult="MappingEditorSchemaResult",o.MappingEditorTypeMetadata="MappingEditorTypeMetadata",o.MashupLoad="MashupLoad",o.MergeMatchAnalysis="MergeMatchAnalysis",o.MergeQueriesPreview="MergeQueriesPreview",o.MergeQueriesSuggestionsLeftCandidatePreview="MergeQueriesSuggestionsLeftCandidatePreview",o.MergeQueriesSuggestionsRightCandidatePreview="MergeQueriesSuggestionsRightCandidatePreview",o.NaturalLanguageValidation="NaturalLanguageValidation",o.NavigatorCubeAllowedValues="NavigatorCubeAllowedValues",o.NavigatorCubeParameters="NavigatorCubeParameters",o.NavigatorCubePreview="NavigatorCubePreview",o.NavigatorDiscoverRelatedTables="NavigatorDiscoverRelatedTables",o.NavigatorPreview="NavigatorPreview",o.NavigatorTemporaryQueryForIndirectionNode="NavigatorTemporaryQueryForIndirectionNode",o.Preview="Preview",o.QueryAnalysis="QueryAnalysis",o.QueryPlan="QueryPlan",o.QuerySanitizer="QuerySanitizer",o.QuerySanitizerAnalysis="QuerySanitizerAnalysis",o.QuerySanitizerQueryAnalysis="QuerySanitizerQueryAnalysis",o.QueryScriptPreview="QueryScriptPreview",o.SemanticEntitySets="SemanticEntitySets",o.SemanticDataGetData="SemanticDataGetData",o.SemanticDataList="SemanticDataList",o.SemanticDataSearchInDataflow="SemanticDataSearchInDataflow",o.SplitColumnInferMultiplePositions="SplitColumnInferMultiplePositions",o.SplitColumnNumberOfColumns="SplitColumnNumberOfColumns",o.StepAnalysis="StepAnalysis",o.TableProfiler="TableProfiler",o.TextByExampleGetText="TextByExampleGetText",o.WebByExampleExecuteSelectors="WebByExampleExecuteSelectors",o.WebByExampleGetHtml="WebByExampleGetHtml"}(re||(re={})),function(o){o.None="None",o.Any="Any",o.Access="Access",o.Excel="Excel",o.Json="Json",o.TextCsv="TextCsv",o.Pdf="Pdf",o.Xml="Xml"}(Ne||(Ne={})),function(o){o.List="List"}($e||($e={})),function(o){o.MenuItem="MenuItem",o.Separator="Separator"}(Ie||(Ie={})),function(o){o.Max="Max",o.Mean="Mean",o.Min="Min",o.Mode="Mode",o.RoundedMean="RoundedMean"}(Pt||(Pt={})),function(o){o.Cancelled="Cancelled",o.CombineFiles="CombineFiles",o.CsvTextSettings="CsvTextSettings",o.DataDiscovery="DataDiscovery",o.DataSources="DataSources",o.DataSourceSettings="DataSourceSettings",o.FolderPreview="FolderPreview",o.IncrementalRefreshSettings="IncrementalRefreshSettings",o.Loading="Loading",o.MappingEditor="MappingEditor",o.Navigator="Navigator",o.QueryEditor="QueryEditor",o.QuickCreate="QuickCreate",o.RecentDataPreview="RecentDataPreview",o.RefreshSettings="RefreshSettings",o.TemplateCredentials="TemplateCredentials",o.TemplateParameters="TemplateParameters",o.TextByExample="TextByExample"}(Ft||(Ft={})),function(o){o.Database="Database",o.File="File"}(yn||(yn={})),function(o){o.AlwaysWhenInferringAllColumnTypes="AlwaysWhenInferringAllColumnTypes",o.BasedOnMetadata="BasedOnMetadata",o.Never="Never"}(cn||(cn={})),function(o){o.Always="Always",o.Never="Never",o.HasNewLoadableQueries="HasNewLoadableQueries",o.NumberOfQueries="NumberOfQueries"}(xo||(xo={})),function(o){o.Equals="Equals",o.GreaterThan="GreaterThan",o.GreaterThanOrEqual="GreaterThanOrEqual",o.LessThan="LessThan",o.LessThanOrEqual="LessThanOrEqual"}(ma||(ma={})),function(o){o.Adf="Adf",o.Athena="Athena",o.CdsA="CdsA",o.CdsLite="CdsLite",o.CdsT="CdsT",o.CdsV1="CdsAdHoc",o.CustomerInsights="CustomerInsights",o.CustomerInsightsPPDF="CustomerInsightsPPDF",o.D365TalentInsights="D365TalentInsights",o.DataIntegration="DataIntegration",o.DesktopBootstrap="DesktopBootstrap",o.DesktopUITester="DesktopUITester",o.DmtsPowerBiExperimental="DmtsPowerBiExperimental",o.DmtsSaExperimental="DmtsSaExperimental",o.ExcelDesktop="ExcelDesktop",o.ExcelOnline="ExcelOnline",o.ExcelOnlineDmtsPowerBi="ExcelOnlineDmtsPowerBi",o.Experimental="Experimental",o.Flow="Flow",o.IAPDataflowTemplateReferenceApp="IAPDataflowTemplateReferenceApp",o.IntelligentOrderManagement="IntelligentOrderManagement",o.InternalPortal="InternalPortal",o.KustoViewDesigner="KustoViewDesigner",o.MashupEditorBootstrap="MashupEditorBootstrap",o.PowerAppsTeams="PowerAppsTeams",o.PowerBIDataMart="PowerBIDataMart",o.PowerBIModeling="PowerBIModeling",o.PowerBIModelingDmtsPowerBi="PowerBIModelingDmtsPowerBi",o.PowerBIPaginatedReports="PowerBIPaginatedReports",o.PowerBIPPDF="PowerBIPPDF",o.PowerBIReportView="PowerBIReportView",o.PowerPlatformDataflowAdlsGen2="PowerPlatformDataflowAdlsGen2",o.PowerPlatformDataflowsBootstrap="PowerPlatformDataflowsBootstrap",o.PowerPlatformExperimental="PowerPlatformExperimental",o.PowerQueryDesktop="PowerQueryDesktop",o.ProcessAdvisor="ProcessAdvisor",o.SupplyChainVisibility="SupplyChainVisibility",o.SustainabilityCloud="SustainabilityCloud",o.Synapse="Synapse",o.TridentDataflow="TridentDataflow",o.TridentDataPipeline="TridentDataPipeline",o.TridentDataverseOneLake="TridentDataverseOneLake",o.TridentDataWarehouse="TridentDataWarehouse",o.TridentEventStream="TridentEventStream",o.TridentKusto="TridentKusto",o.TridentLakehouse="TridentLakehouse",o.TridentLakeWarehouse="TridentLakeWarehouse",o.TridentMountedDataWarehouse="TridentMountedDataWarehouse",o.TridentOneLake="TridentOneLake",o.TridentReplicator="TridentReplicator",o.TridentSynapseLink="TridentSynapseLink"}(us||(us={})),function(o){o.Boolean="Boolean"}(ul||(ul={})),function(o){o.NaN="NaN",o.NegativeInfinity="NegativeInfinity",o.PositiveInfinity="PositiveInfinity",o.FormattedNumber="FormattedNumber",o.Number="Number"}(dl||(dl={})),function(o){o.Access="Access",o.ActiveDirectory="ActiveDirectory",o.AdoDotNet="AdoDotNet",o.AdobeAnalytics="AdobeAnalytics",o.AnalysisServices="AnalysisServices",o.AzureBlobs="AzureBlobs",o.AzureDataLakeStorage="AzureDataLakeStorage",o.AzureTables="AzureTables",o.Cdpa="CDPA",o.CurrentWorkbook="CurrentWorkbook",o.DB2="DB2",o.Environment="Environment",o.Essbase="Essbase",o.Exchange="Exchange",o.File="File",o.Folder="Folder",o.Ftp="Ftp",o.GoogleAnalytics="GoogleAnalytics",o.HDInsight="HDInsight",o.Hdfs="Hdfs",o.Informix="Informix",o.MQ="MQ",o.MicrosoftInformationProtection="MicrosoftInformationProtection",o.MySql="MySql",o.OData="OData",o.Odbc="Odbc",o.OleDb="OleDb",o.Oracle="Oracle",o.PostgreSQL="PostgreSQL",o.PowerBIDataflow="PowerBI",o.Python="Python",o.R="R",o.Salesforce="Salesforce",o.SapBusinessWarehouse="SapBusinessWarehouse",o.SapHana="SapHana",o.SharePoint="SharePoint",o.Spark="Spark",o.Sql="SQL",o.Staging="Staging",o.Sybase="Sybase",o.Teradata="Teradata",o.Web="Web"}(pl||(pl={})),function(o){o.TemplateMetadata="Metadata.json",o.MashupDocument="MashupDocument.pq",o.MashupMetadata="MashupMetadata.json"}(hl||(hl={})),function(o){o.GroupNestingLimitReached="GroupNestingLimitReached",o.NullMashupXml="NullMashupXml",o.Unknown="Unknown"}(gl||(gl={})),function(o){o.CompletedSuccessfully="CompletedSuccessfully",o.CompletedWithExpectedError="CompletedWithExpectedError",o.CompletedWithUnexpectedError="CompletedWithUnexpectedError",o.Started="Started"}(fl||(fl={})),function(o){o.Above="Above",o.Below="Below"}(ml||(ml={})),function(o){o.ErrorInvokingOpenAiApi="ErrorInvokingOpenAiApi",o.NoProgramFound="NoProgramFound",o.OpenAiApiKeyNotProvided="OpenAiApiKeyNotProvided",o.RequestCanceled="RequestCanceled"}(vl||(vl={})),function(o){o.Ascii="Ascii",o.Utf8="Utf8",o.Utf16="Utf16",o.Windows="Windows"}(Cl||(Cl={})),function(o){o.Excel="Excel",o.Json="Json",o.Parquet="Parquet",o.Text="Text"}(va||(va={})),function(o){o.Colon="Colon",o.Comma="Comma",o.None="None",o.Semicolon="Semicolon",o.Space="Space",o.Tab="Tab"}(_l||(_l={})),function(o){o.Even="Even",o.Odd="Odd"}(yl||(yl={})),function(o){o.None="None",o.Private="Private",o.Organizational="Organizational",o.Public="Public"}(bl||(bl={})),function(o){o.ChangeModes="ChangeModes"}(wl||(wl={})),function(o){o.QueryNeedsToFold="QueryNeedsToFold"}(Sl||(Sl={})),function(o){o.AzureBlob="AzureBlob",o.Database="Database"}(Ml||(Ml={})),function(o){o.DynamicPlanFolded="DynamicPlanFolded",o.DynamicPlanMightFold="DynamicPlanMightFold",o.DynamicPlanNotFolded="DynamicPlanNotFolded",o.DynamicPlanOpaque="DynamicPlanOpaque",o.ErrorRetrievingPlan="ErrorRetrievingPlan",o.FoldedQueryNotImplemented="FoldedQueryNotImplemented",o.FoldedQueryNull="FoldedQueryNull",o.FoldedWithQuery="FoldedWithQuery",o.NotFolded="NotFolded",o.NotFoldedPrivacyBuffering="NotFoldedPrivacyBuffering",o.NotTable="NotTable",o.OpaqueConstant="OpaqueConstant",o.UnexpectedPlanKind="UnexpectedPlanKind"}(Pl||(Pl={})),function(o){o.ActiveDirectory="ActiveDirectory",o.AdobeAnalytics="AdobeAnalytics",o.AmazonRedshift="AmazonRedshift",o.AnalysisServices="AnalysisServices",o.AzureAnalysisServices="AzureAnalysisServices",o.AzureBlobs="AzureBlobs",o.AzureDataExplorer="AzureDataExplorer",o.AzureDataLakeStorage="AzureDataLakeStorage",o.AzureTables="AzureTables",o.AIFunctions="AIFunctions",o.AIInsights="AIInsights",o.AzureMLFunctions="AzureMLFunctions",o.AIInsightsInProc="AIInsightsInProc",o.Cds="Cds",o.CommonDataService="CommonDataService",o.DataLake="DataLake",o.Dataverse="Dataverse",o.DB2="DB2",o.ElasticSearch="ElasticSearch",o.Exchange="Exchange",o.Fhir="Fhir",o.File="File",o.Folder="Folder",o.GoogleAnalytics="GoogleAnalytics",o.GoogleBigQuery="GoogleBigQuery",o.HDInsight="HDInsight",o.Impala="Impala",o.Kusto="Kusto",o.Lakehouse="Lakehouse",o.MySql="MySql",o.OData="OData",o.Odbc="Odbc",o.Oracle="Oracle",o.OracleERP="OracleERP",o.PostgreSQL="PostgreSQL",o.PowerBI="PowerBI",o.PowerBIDatamarts="PowerBIDatamarts",o.PowerPlatformDataflows="PowerPlatformDataflows",o.PQGenericInvokeTestExtension="PQGenericInvokeTestExtension",o.Salesforce="Salesforce",o.SapBusinessWarehouse="SapBusinessWarehouse",o.SAPERP="SAPERP",o.SapHana="SapHana",o.SharePoint="SharePoint",o.Snowflake="Snowflake",o.Spark="Spark",o.SQL="SQL",o.Sybase="Sybase",o.Teradata="Teradata",o.Vertica="Vertica",o.Warehouse="Warehouse",o.Web="Web"}(Ol||(Ol={})),function(o){o.CompilationError="CompilationError",o.InvalidQueryName="InvalidQueryName",o.ParsingError="ParsingError",o.Success="Success",o.UnexpectedDocumentKind="UnexpectedDocumentKind"}(xl||(xl={})),function(o){o.Failure="Failure",o.Success="Success"}(Tl||(Tl={})),function(o){o[o.endpointNotAvailableInRegion=0]="endpointNotAvailableInRegion",o[o.httpError=1]="httpError",o[o.invalidInput=2]="invalidInput",o[o.maxRetriesReached=3]="maxRetriesReached",o[o.modelError=4]="modelError"}(El||(El={})),function(o){o.Error="Error",o.Ok="Ok"}(Il||(Il={})),function(o){o.Default="Default",o.FastCopy="FastCopy"}(Dl||(Dl={})),function(o){o.ConnectionsAuthorizationFailed="ConnectionsAuthorizationFailed",o.DuplicateQueryId="DuplicateQueryId",o.DuplicateQueryName="DuplicateQueryName",o.DuplicateStepName="DuplicateStepName",o.InvalidQueryName="InvalidQueryName",o.MashupDocumentNotASectionDocument="MashupDocumentNotASectionDocument",o.ParsingError="ParsingError",o.UnexpectedQueryIdFormat="UnexpectedQueryIdFormat"}(kl||(kl={})),function(o){o.Custom="Custom",o.DropColumn="DropColumn",o.DropBlankRows="DropBlankRows",o.DropDuplicates="DropDuplicates",o.FillColumn="FillColumn",o.SplitColumn="SplitColumn",o.UnpivotColumns="UnpivotColumns",o.UnpivotOtherColumns="UnpivotOtherColumns"}(Fl||(Fl={})),function(o){o.Column="Column",o.ColumnType="ColumnType",o.Count="Count",o.ErrorCount="ErrorCount",o.NullCount="NullCount",o.DistinctCount="DistinctCount",o.UniqueCount="UniqueCount",o.Min="Min",o.Max="Max",o.ValueDistribution="ValueDistribution",o.Average="Average",o.EmptyStringCount="EmptyStringCount",o.TextLengthDistribution="TextLengthDistribution",o.NaNCount="NaNCount",o.ZeroCount="ZeroCount",o.EvenCount="EvenCount",o.OddCount="OddCount",o.StandardDeviation="StandardDeviation",o.SignDistribution="SignDistribution",o.ParityDistribution="ParityDistribution",o.TrueCount="TrueCount",o.FalseCount="FalseCount",o.YearDistribution="YearDistribution",o.MonthDistribution="MonthDistribution",o.DayDistribution="DayDistribution",o.WeekOfYearDistribution="WeekOfYearDistribution",o.DayOfWeekDistribution="DayOfWeekDistribution",o.AmPmDistribution="AmPmDistribution",o.HourDistribution="HourDistribution"}(Vl||(Vl={})),function(o){o.AppendRows="AppendRows",o.ReplaceRows="ReplaceRows",o.UpsertRows="UpsertRows"}(Al||(Al={})),function(o){o.SelectRows="SelectRows",o.Sort="Sort",o.SelectColumns="SelectColumns",o.RenameColumns="RenameColumns",o.AddColumn="AddColumn",o.ReplaceColumns="ReplaceColumns",o.ReplaceRows="ReplaceRows",o.AddRows="AddRows",o.SplitColumn="SplitColumn",o.ReplaceTable="ReplaceTable"}(Rl||(Rl={})),function(o){o.InvocationPattern="InvocationPattern",o.Script="Script"}(Ll||(Ll={})),function(o){o.DataSourceTag="DataSourceTag",o.QueryEditorMessageBar="QueryEditorMessageBar",o.QuickCreateForm="QuickCreateForm",o.WebByExampleForm="WebByExampleForm"}(Gl||(Gl={})),function(o){o.Append="Append",o.Replace="Replace"}(Nl||(Nl={})),function(o){o.CompilationError="CompilationError",o.ParsingError="ParsingError",o.Success="Success",o.UnexpectedDocumentKind="UnexpectedDocumentKind"}(Hl||(Hl={})),function(o){o.Link="Link",o.Text="Text"}(zl||(zl={}))},69903:function(pt,Ct,M){"use strict";M.d(Ct,{p:function(){return tt}});var w=M(37419),b=M(47875),e=M(96721),j={leading:!0,trailing:!1};function tt(Ee,se,I){return void 0===se&&(se=e.P),void 0===I&&(I=j),function(ie){return ie.lift(new Ge(Ee,se,I.leading,I.trailing))}}var Ge=function(){function Ee(I,ie,ye,W){this.duration=I,this.scheduler=ie,this.leading=ye,this.trailing=W}return Ee.prototype.call=function(ie,ye){return ye.subscribe(new He(ie,this.duration,this.scheduler,this.leading,this.trailing))},Ee}(),He=function(Ee){function se(ie,ye,W,ne,ve){var me;return(me=Ee.call(this,ie)||this).duration=ye,me.scheduler=W,me.leading=ne,me.trailing=ve,me._hasTrailingValue=!1,me._trailingValue=null,me}(0,w.Z)(se,Ee);var I=se.prototype;return I._next=function(ye){this.throttled?this.trailing&&(this._trailingValue=ye,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Z,this.duration,{subscriber:this})),this.leading?this.destination.next(ye):this.trailing&&(this._trailingValue=ye,this._hasTrailingValue=!0))},I._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},I.clearThrottle=function(){var ye=this.throttled;ye&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),ye.unsubscribe(),this.remove(ye),this.throttled=null)},se}(b.L);function Z(Ee){Ee.subscriber.clearThrottle()}},73088:function(pt,Ct,M){"use strict";M.d(Ct,{F:function(){return b}});var b=new(M(50423).InjectionToken)("ScorecardActionsService")},62113:function(pt,Ct,M){"use strict";M.d(Ct,{Q:function(){return ke}});var Z,N,w=M(81337),b=M(29019),e=M(66422),j=M(37241),qe=M(41170),te_clientInfoDecodingError_code="client_info_decoding_error",te_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",te_clientInfoEmptyError_code="client_info_empty_error",te_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",te_tokenParsingError_code="token_parsing_error",te_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",te_nullOrEmptyToken_code="null_or_empty_token",te_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",te_endpointResolutionError_code="endpoints_resolution_error",te_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",te_networkError_code="network_error",te_networkError_desc="Network request failed. Please check network trace to determine root cause.",te_unableToGetOpenidConfigError_code="openid_config_error",te_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",te_hashNotDeserialized_code="hash_not_deserialized",te_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",te_invalidStateError_code="invalid_state",te_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",te_stateMismatchError_code="state_mismatch",te_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",te_stateNotFoundError_code="state_not_found",te_stateNotFoundError_desc="State not found",te_nonceMismatchError_code="nonce_mismatch",te_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",te_nonceNotFoundError_code="nonce_not_found",te_nonceNotFoundError_desc="nonce not found",te_multipleMatchingTokens_code="multiple_matching_tokens",te_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",te_multipleMatchingAccounts_code="multiple_matching_accounts",te_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",te_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",te_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",te_tokenRequestCannotBeMade_code="request_cannot_be_made",te_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",te_appendEmptyScopeError_code="cannot_append_empty_scope",te_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",te_removeEmptyScopeError_code="cannot_remove_empty_scope",te_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",te_appendScopeSetError_code="cannot_append_scopeset",te_appendScopeSetError_desc="Cannot append ScopeSet due to error.",te_emptyInputScopeSetError_code="empty_input_scopeset",te_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",te_DeviceCodePollingCancelled_code="device_code_polling_cancelled",te_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",te_DeviceCodeExpired_code="device_code_expired",te_DeviceCodeExpired_desc="Device code is expired.",te_DeviceCodeUnknownError_code="device_code_unknown_error",te_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",te_NoAccountInSilentRequest_code="no_account_in_silent_request",te_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",te_invalidCacheRecord_code="invalid_cache_record",te_invalidCacheRecord_desc="Cache record object was null or undefined.",te_invalidCacheEnvironment_code="invalid_cache_environment",te_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",te_noAccountFound_code="no_account_found",te_noAccountFound_desc="No account found in cache for given key.",te_CachePluginError_code="no cache plugin set on CacheManager",te_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",te_noCryptoObj_code="no_crypto_object",te_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",te_invalidCacheType_code="invalid_cache_type",te_invalidCacheType_desc="Invalid cache type",te_unexpectedAccountType_code="unexpected_account_type",te_unexpectedAccountType_desc="Unexpected account type.",te_unexpectedCredentialType_code="unexpected_credential_type",te_unexpectedCredentialType_desc="Unexpected credential type.",te_invalidAssertion_code="invalid_assertion",te_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",te_invalidClientCredential_code="invalid_client_credential",te_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",te_tokenRefreshRequired_code="token_refresh_required",te_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",te_userTimeoutReached_code="user_timeout_reached",te_userTimeoutReached_desc="User defined timeout for device code polling reached",te_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",te_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",te_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",te_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",te_bindingKeyNotRemovedError_code="binding_key_not_removed",te_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",te_logoutNotSupported_code="end_session_endpoint_not_supported",te_logoutNotSupported_desc="Provided authority does not support logout.",te_keyIdMissing_code="key_id_missing",te_keyIdMissing_desc="A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",Le=function(N){function B(X,K){var le=N.call(this,X,K)||this;return le.name="ClientAuthError",Object.setPrototypeOf(le,B.prototype),le}return(0,j.ZT)(B,N),B.createClientInfoDecodingError=function(X){return new B(te_clientInfoDecodingError_code,te_clientInfoDecodingError_desc+" Failed with error: "+X)},B.createClientInfoEmptyError=function(){return new B(te_clientInfoEmptyError_code,""+te_clientInfoEmptyError_desc)},B.createTokenParsingError=function(X){return new B(te_tokenParsingError_code,te_tokenParsingError_desc+" Failed with error: "+X)},B.createTokenNullOrEmptyError=function(X){return new B(te_nullOrEmptyToken_code,te_nullOrEmptyToken_desc+" Raw Token Value: "+X)},B.createEndpointDiscoveryIncompleteError=function(X){return new B(te_endpointResolutionError_code,te_endpointResolutionError_desc+" Detail: "+X)},B.createNetworkError=function(X,K){return new B(te_networkError_code,te_networkError_desc+" | Fetch client threw: "+K+" | Attempted to reach: "+X.split("?")[0])},B.createUnableToGetOpenidConfigError=function(X){return new B(te_unableToGetOpenidConfigError_code,te_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+X)},B.createHashNotDeserializedError=function(X){return new B(te_hashNotDeserialized_code,te_hashNotDeserialized_desc+" Given Object: "+X)},B.createInvalidStateError=function(X,K){return new B(te_invalidStateError_code,te_invalidStateError_desc+" Invalid State: "+X+", Root Err: "+K)},B.createStateMismatchError=function(){return new B(te_stateMismatchError_code,te_stateMismatchError_desc)},B.createStateNotFoundError=function(X){return new B(te_stateNotFoundError_code,te_stateNotFoundError_desc+":  "+X)},B.createNonceMismatchError=function(){return new B(te_nonceMismatchError_code,te_nonceMismatchError_desc)},B.createNonceNotFoundError=function(X){return new B(te_nonceNotFoundError_code,te_nonceNotFoundError_desc+":  "+X)},B.createMultipleMatchingTokensInCacheError=function(){return new B(te_multipleMatchingTokens_code,te_multipleMatchingTokens_desc+".")},B.createMultipleMatchingAccountsInCacheError=function(){return new B(te_multipleMatchingAccounts_code,te_multipleMatchingAccounts_desc)},B.createMultipleMatchingAppMetadataInCacheError=function(){return new B(te_multipleMatchingAppMetadata_code,te_multipleMatchingAppMetadata_desc)},B.createTokenRequestCannotBeMadeError=function(){return new B(te_tokenRequestCannotBeMade_code,te_tokenRequestCannotBeMade_desc)},B.createAppendEmptyScopeToSetError=function(X){return new B(te_appendEmptyScopeError_code,te_appendEmptyScopeError_desc+" Given Scope: "+X)},B.createRemoveEmptyScopeFromSetError=function(X){return new B(te_removeEmptyScopeError_code,te_removeEmptyScopeError_desc+" Given Scope: "+X)},B.createAppendScopeSetError=function(X){return new B(te_appendScopeSetError_code,te_appendScopeSetError_desc+" Detail Error: "+X)},B.createEmptyInputScopeSetError=function(){return new B(te_emptyInputScopeSetError_code,""+te_emptyInputScopeSetError_desc)},B.createDeviceCodeCancelledError=function(){return new B(te_DeviceCodePollingCancelled_code,""+te_DeviceCodePollingCancelled_desc)},B.createDeviceCodeExpiredError=function(){return new B(te_DeviceCodeExpired_code,""+te_DeviceCodeExpired_desc)},B.createDeviceCodeUnknownError=function(){return new B(te_DeviceCodeUnknownError_code,""+te_DeviceCodeUnknownError_desc)},B.createNoAccountInSilentRequestError=function(){return new B(te_NoAccountInSilentRequest_code,""+te_NoAccountInSilentRequest_desc)},B.createNullOrUndefinedCacheRecord=function(){return new B(te_invalidCacheRecord_code,te_invalidCacheRecord_desc)},B.createInvalidCacheEnvironmentError=function(){return new B(te_invalidCacheEnvironment_code,te_invalidCacheEnvironment_desc)},B.createNoAccountFoundError=function(){return new B(te_noAccountFound_code,te_noAccountFound_desc)},B.createCachePluginError=function(){return new B(te_CachePluginError_code,""+te_CachePluginError_desc)},B.createNoCryptoObjectError=function(X){return new B(te_noCryptoObj_code,""+te_noCryptoObj_desc+X)},B.createInvalidCacheTypeError=function(){return new B(te_invalidCacheType_code,""+te_invalidCacheType_desc)},B.createUnexpectedAccountTypeError=function(){return new B(te_unexpectedAccountType_code,""+te_unexpectedAccountType_desc)},B.createUnexpectedCredentialTypeError=function(){return new B(te_unexpectedCredentialType_code,""+te_unexpectedCredentialType_desc)},B.createInvalidAssertionError=function(){return new B(te_invalidAssertion_code,""+te_invalidAssertion_desc)},B.createInvalidCredentialError=function(){return new B(te_invalidClientCredential_code,""+te_invalidClientCredential_desc)},B.createRefreshRequiredError=function(){return new B(te_tokenRefreshRequired_code,te_tokenRefreshRequired_desc)},B.createUserTimeoutReachedError=function(){return new B(te_userTimeoutReached_code,te_userTimeoutReached_desc)},B.createTokenClaimsRequiredError=function(){return new B(te_tokenClaimsRequired_code,te_tokenClaimsRequired_desc)},B.createNoAuthCodeInServerResponseError=function(){return new B(te_noAuthorizationCodeFromServer_code,te_noAuthorizationCodeFromServer_desc)},B.createBindingKeyNotRemovedError=function(){return new B(te_bindingKeyNotRemovedError_code,te_bindingKeyNotRemovedError_desc)},B.createLogoutNotSupportedError=function(){return new B(te_logoutNotSupported_code,te_logoutNotSupported_desc)},B.createKeyIdMissingError=function(){return new B(te_keyIdMissing_code,te_keyIdMissing_desc)},B}(qe.l),tt=function(){function N(){}return N.decodeAuthToken=function(B){if(N.isEmpty(B))throw Le.createTokenNullOrEmptyError(B);var K=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(B);if(!K||K.length<4)throw Le.createTokenParsingError("Given token is malformed: "+JSON.stringify(B));return{header:K[1],JWSPayload:K[2],JWSSig:K[3]}},N.isEmpty=function(B){return typeof B>"u"||!B||0===B.length},N.isEmptyObj=function(B){if(B&&!N.isEmpty(B))try{var X=JSON.parse(B);return 0===Object.keys(X).length}catch{}return!0},N.startsWith=function(B,X){return 0===B.indexOf(X)},N.endsWith=function(B,X){return B.length>=X.length&&B.lastIndexOf(X)===B.length-X.length},N.queryStringToObject=function(B){var X={},K=B.split("&"),le=function(ze){return decodeURIComponent(ze.replace(/\+/g," "))};return K.forEach(function(ae){if(ae.trim()){var ze=ae.split(/=(.+)/g,2),st=ze[0],vt=ze[1];st&&vt&&(X[le(st)]=le(vt))}}),X},N.trimArrayEntries=function(B){return B.map(function(X){return X.trim()})},N.removeEmptyStringsFromArray=function(B){return B.filter(function(X){return!N.isEmpty(X)})},N.jsonParseHelper=function(B){try{return JSON.parse(B)}catch{return null}},N.matchPattern=function(B,X){return new RegExp(B.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(X)},N}();(N=Z||(Z={}))[N.Default=0]="Default",N[N.Adfs=1]="Adfs";var Ee=function(){function N(){}return N.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(e.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},N.prototype.generateAccountKey=function(){return N.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},N.prototype.generateType=function(){switch(this.authorityType){case e.iR.ADFS_ACCOUNT_TYPE:return e.LL.ADFS;case e.iR.MSAV1_ACCOUNT_TYPE:return e.LL.MSA;case e.iR.MSSTS_ACCOUNT_TYPE:return e.LL.MSSTS;case e.iR.GENERIC_ACCOUNT_TYPE:return e.LL.GENERIC;default:throw Le.createUnexpectedAccountTypeError()}},N.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},N.generateAccountCacheKey=function(B){return[B.homeAccountId,B.environment||e.gT.EMPTY_STRING,B.tenantId||e.gT.EMPTY_STRING].join(e.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},N.createAccount=function(B,X,K,le,ae,ze,st,vt,he){var Oe,Ce,we,ct,dt,Ue,Dt=new N;Dt.authorityType=e.iR.MSSTS_ACCOUNT_TYPE,Dt.clientInfo=B,Dt.homeAccountId=X,Dt.nativeAccountId=he;var E=vt||le&&le.getPreferredCache();if(!E)throw Le.createInvalidCacheEnvironmentError();return Dt.environment=E,Dt.realm=(null===(Oe=K?.claims)||void 0===Oe?void 0:Oe.tid)||e.gT.EMPTY_STRING,Dt.oboAssertion=ae,K&&(Dt.idTokenClaims=K.claims,Dt.localAccountId=(null===(Ce=K?.claims)||void 0===Ce?void 0:Ce.oid)||(null===(we=K?.claims)||void 0===we?void 0:we.sub)||e.gT.EMPTY_STRING,Dt.username=(null===(ct=K?.claims)||void 0===ct?void 0:ct.preferred_username)||(null!==(dt=K?.claims)&&void 0!==dt&&dt.emails?K.claims.emails[0]:e.gT.EMPTY_STRING),Dt.name=null===(Ue=K?.claims)||void 0===Ue?void 0:Ue.name),Dt.cloudGraphHostName=ze,Dt.msGraphHost=st,Dt},N.createGenericAccount=function(B,X,K,le,ae,ze,st){var vt,he,Oe,Ce,we=new N;we.authorityType=K&&K.authorityType===Z.Adfs?e.iR.ADFS_ACCOUNT_TYPE:e.iR.GENERIC_ACCOUNT_TYPE,we.homeAccountId=B,we.realm=e.gT.EMPTY_STRING,we.oboAssertion=le;var ct=st||K&&K.getPreferredCache();if(!ct)throw Le.createInvalidCacheEnvironmentError();return X&&(we.localAccountId=(null===(vt=X?.claims)||void 0===vt?void 0:vt.oid)||(null===(he=X?.claims)||void 0===he?void 0:he.sub)||e.gT.EMPTY_STRING,we.username=(null===(Oe=X?.claims)||void 0===Oe?void 0:Oe.upn)||e.gT.EMPTY_STRING,we.name=(null===(Ce=X?.claims)||void 0===Ce?void 0:Ce.name)||e.gT.EMPTY_STRING,we.idTokenClaims=X?.claims),we.environment=ct,we.cloudGraphHostName=ae,we.msGraphHost=ze,we},N.generateHomeAccountId=function(B,X,K,le,ae){var ze,st=null!==(ze=ae?.claims)&&void 0!==ze&&ze.sub?ae.claims.sub:e.gT.EMPTY_STRING;if(X===Z.Adfs)return st;if(B)try{var vt=function(N,B){if(tt.isEmpty(N))throw Le.createClientInfoEmptyError();try{var X=B.base64Decode(N);return JSON.parse(X)}catch(K){throw Le.createClientInfoDecodingError(K)}}(B,le);if(!tt.isEmpty(vt.uid)&&!tt.isEmpty(vt.utid))return""+vt.uid+e.Bv.CLIENT_INFO_SEPARATOR+vt.utid}catch{}return K.verbose("No client info in response"),st},N.isAccountEntity=function(B){return!!B&&B.hasOwnProperty("homeAccountId")&&B.hasOwnProperty("environment")&&B.hasOwnProperty("realm")&&B.hasOwnProperty("localAccountId")&&B.hasOwnProperty("username")&&B.hasOwnProperty("authorityType")},N.accountInfoIsEqual=function(B,X,K){if(!B||!X)return!1;var le=!0;if(K){var ae=B.idTokenClaims||{},ze=X.idTokenClaims||{};le=ae.iat===ze.iat&&ae.nonce===ze.nonce}return B.homeAccountId===X.homeAccountId&&B.localAccountId===X.localAccountId&&B.username===X.username&&B.tenantId===X.tenantId&&B.environment===X.environment&&B.nativeAccountId===X.nativeAccountId&&le},N}(),se=M(4633),I=M(98049),ie=M(19270),ye=M(66070),W=function(N){function B(X,K){var le=N.call(this,X)||this;return le.message=X,le.msalError=K,le}return(0,w.__extends)(B,N),B}(Error),ne=M(41114),ve="PBI.App.AdHocTokenAcquisition",me=ne.cx[ve]=(0,ne.b1)(ve),q="PBI.App.AdHocTokenAcquisition.UserConfirmation",be=ne.cx[q]=(0,ne.b1)(q),_e=M(50423),pe=M(58938),Re=M(65181),Qe=window,ke=function(){function N(B,X,K){this.dialogService=B,this.localizationService=X,this.telemetryService=K,this.msalClientApplication=Qe.msalClientApplication}return N.prototype.acquireToken=function(B,X,K){var le;return void 0===K&&(K=!1),(0,w.__awaiter)(this,void 0,void 0,function(){var ae,ze,st,vt,he;return(0,w.__generator)(this,function(Oe){switch(Oe.label){case 0:if(ae=this.retrieveSignedInAccount(),ze=this.telemetryService.startActivity(null,me,{scenarioName:B,authMethod:"Silent"}),!ae)return[3,5];Oe.label=1;case 1:return Oe.trys.push([1,3,,4]),[4,this.msalClientApplication.acquireTokenSilent({scopes:X,account:ae,forceRefresh:K})];case 2:return st=Oe.sent(),ze.resolve(),[2,{token:st.accessToken,expiry:st.expiresOn}];case 3:throw(vt=Oe.sent()).constructor.name===b.Yo.name?(ze.reject({errorSource:"External",errorMessage:he=ie.fW.UserInteractionRequired,errorCode:"UserInteractionRequired"}),new W(he,vt)):(he=null!==(le=vt.message)&&void 0!==le?le:vt,ze.reject({errorSource:"External",errorMessage:he,errorCode:vt.code}),new W("Error code: ".concat(vt.code,", error message: ").concat(he),vt));case 4:return[3,6];case 5:throw ze.reject({errorSource:"PowerBI",errorMessage:he=ie.fW.UserNotSignedIn,errorCode:"UserNotSignedIn"}),Error(he);case 6:return[2]}})})},N.prototype.acquireTokenPopup=function(B,X){return(0,w.__awaiter)(this,void 0,void 0,function(){var K=this;return(0,w.__generator)(this,function(le){return[2,ye.kB.retryOnInteractionInProgressError(function(){return K.acquireTokenPopupInternal(B,X)})]})})},N.prototype.acquireTokenPopupInternal=function(B,X){var K;return(0,w.__awaiter)(this,void 0,void 0,function(){var ae,ze,st,vt,he,Oe;return(0,w.__generator)(this,function(Ce){switch(Ce.label){case 0:return[4,this.dialogService.open(I.J,{data:{title:this.localizationService.get("AcquireToken_Dialog_VerifyIdentity"),ariaLabel:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),message:this.localizationService.get("AcquireToken_Dialog_SelectContinue"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),cancelButtonText:this.localizationService.get("ModalDialog_Cancel")},autoFocus:!0}).afterClosed().toPromise()];case 1:if(ae=Ce.sent(),this.telemetryService.logEvent(be,{scenarioName:B,authMethod:"Popup",result:1===ae}),1!==ae)throw Error(ie.fW.UserInteractionDeclined);ze=this.retrieveSignedInAccount(),st=this.telemetryService.startActivity(null,me,{scenarioName:B,authMethod:"Popup"}),Ce.label=2;case 2:return Ce.trys.push([2,4,,5]),[4,this.msalClientApplication.acquireTokenPopup({scopes:X,account:ze})];case 3:return vt=Ce.sent(),this.msalClientApplication.setActiveAccount(vt.account),[3,5];case 4:throw he=Ce.sent(),Oe=null!==(K=he.message)&&void 0!==K?K:he,st.reject({errorSource:"External",errorMessage:Oe,errorCode:he.code}),new W("Error code: ".concat(he.code,", error message: ").concat(Oe),he);case 5:if(!Ee.accountInfoIsEqual(ze??null,vt.account))throw st.reject({errorSource:"External",errorMessage:ie.fW.UserAccountChanged,errorCode:"UserAccountChanged"}),this.reloadPage(),Error(ie.fW.UserAccountChanged);return st.resolve(),[2,{token:vt.accessToken,expiry:vt.expiresOn}]}})})},N.prototype.reloadPage=function(){window.location.reload()},N.prototype.retrieveSignedInAccount=function(){return Qe.signInProviderService.retrieveSignedInAccount()},N.\u0275fac=function(X){return new(X||N)(_e.\u0275\u0275inject(pe.x),_e.\u0275\u0275inject(Re.o),_e.\u0275\u0275inject(se.y0))},N.\u0275prov=_e.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac,providedIn:"root"}),N}()},14967:function(pt,Ct,M){"use strict";M.d(Ct,{Gp:function(){return tr},HG:function(){return Lr},JW:function(){return jn},T4:function(){return Sn},Uo:function(){return Oe},Xg:function(){return Wn},dG:function(){return cr},dQ:function(){return vn},ic:function(){return yr},pH:function(){return Yt},q5:function(){return we},zb:function(){return rr},zh:function(){return Ue}});var Oe=function(){return function(ot){this.payload=ot,this.type="[Dataset] Load All Success"}}(),we=function(){return function(ot){this.payload=ot,this.type="[Dataset] Load"}}(),Ue=function(){return function(ot){this.payload=ot,this.type="[Dataset] Bulk Add Without Update"}}(),Sn=function(){return function(ot){this.payload=ot,this.type="[Dataset] Bulk Load"}}(),Lr=function(){return function(ot){this.payload=ot,this.type="[Dataset] Delete"}}(),yr=function(){return function(ot){this.payload=ot,this.type="[Dataset] Rename"}}(),jn=function(){return function(ot){this.payload=ot,this.type="[Dataset] Remove"}}(),Yt=function(){return function(ot){this.payload=ot,this.type="[Dataset] Load Shared"}}(),tr=function(){return function(ot){this.payload=ot,this.type="[Dataset] Update Caching"}}(),cr=function(){return function(ot){this.payload=ot,this.type="[Dataset] Load User Permissions"}}(),vn=function(){return function(ot){this.payload=ot,this.type="[Dataset] Endorse"}}(),rr=function(){return function(ot){this.payload=ot,this.type="[Dataset] Ensure Loaded readonly shared"}}(),Wn=function(){return function(ot){this.payload=ot,this.type="[Dataset] Move To Subfolder Success"}}()},98632:function(pt,Ct,M){"use strict";M.d(Ct,{AX:function(){return sr},BN:function(){return tr},HG:function(){return E},JW:function(){return ni},Lf:function(){return Lr},Ph:function(){return Yt},Xg:function(){return nr},Zt:function(){return lr},_S:function(){return wr},c:function(){return cr},f$:function(){return Bi},ic:function(){return ti},q5:function(){return we},xb:function(){return ct},yO:function(){return vn},yi:function(){return vt}});var vt=function(){return function(Ke){this.payload=Ke,this.type="[Report] Ensure Report Metadata"}}(),we=function(){return function(Ke){this.payload=Ke,this.type="[Report] Load"}}(),ct=function(){return function(Ke){this.payload=Ke,this.type="[Report] Load From Sync Service"}}(),E=function(){return function(Ke){this.payload=Ke,this.type="[Report] Delete"}}(),Lr=function(){return function(Ke){this.payload=Ke,this.type="[Report] Update Visibility"}}(),ti=function(){return function(Ke){this.payload=Ke,this.type="[Report] Rename"}}(),Bi=function(){return function(Ke){this.payload=Ke,this.type="[Report] Rebind"}}(),Yt=function(){return function(Ke){this.payload=Ke,this.type="[Report] Select"}}(),wr=function(){return function(Ke){this.payload=Ke,this.type="[Report] Ensure"}}(),ni=function(){return function(Ke){this.payload=Ke,this.type="[Report] Remove"}}(),tr=function(){return function(Ke){this.payload=Ke,this.type="[Report] Update"}}(),sr=function(){return function(Ke){this.payload=Ke,this.type="[Report] Update Many"}}(),lr=function(){return function(Ke){this.payload=Ke,this.type="[Report] Upsert Many"}}(),cr=function(){return function(Ke){this.payload=Ke,this.type="[Report] Hide"}}(),vn=function(){return function(Ke){this.payload=Ke,this.type="[Report] Unhide"}}(),nr=function(){return function(Ke){this.payload=Ke,this.type="[Report] Move To Subfolder Success"}}()},90982:function(pt,Ct,M){"use strict";M.d(Ct,{e:function(){return b}});var b=new(M(50423).InjectionToken)("coreModuleConfiguration")},50911:function(pt,Ct,M){"use strict";M.d(Ct,{s:function(){return Z}});var w=M(81337),b=M(14967),e=M(90982),j=M(28726),qe=M(18405),te=M(48787),Le=M(14172),tt=M(31727),Ge=M(50423),He=M(85732),Z=function(){function Ee(se,I){this.store=se,this.config=I,this.dataset$=this.store.select(I.shouldFilterDataServicesByFolder?j.F8:qe.uL),this.explorableDatasets$=this.store.select(j.Ol),this.writeableModels$=this.store.select(j.YZ),this.selectedDataset$=this.store.select(qe.rY)}return Object.defineProperty(Ee.prototype,"datasets",{get:function(){return this.dataset$},enumerable:!1,configurable:!0}),Object.defineProperty(Ee.prototype,"explorableDatasets",{get:function(){return this.explorableDatasets$},enumerable:!1,configurable:!0}),Object.defineProperty(Ee.prototype,"writeableModels",{get:function(){return this.writeableModels$.pipe((0,te.q)(1)).toPromise()},enumerable:!1,configurable:!0}),Object.defineProperty(Ee.prototype,"selectedDataset",{get:function(){return this.selectedDataset$},enumerable:!1,configurable:!0}),Ee.prototype.getSelectedDatasetId=function(){return this.store.select(qe.m5)},Ee.prototype.getDatasetsByGroupId=function(se){return this.store.select(j.Rx,{id:se}).pipe((0,te.q)(1))},Ee.prototype.findById=function(se,I){var ie=se+"_"+I;return this.store.select(qe.vw).pipe((0,Le.U)(function(ye){return ye[ie]}),(0,te.q)(1)).toPromise()},Ee.prototype.findDatasetById=function(se){return this.store.select(qe.Ue,{id:se}).pipe((0,te.q)(1)).toPromise()},Ee.prototype.findDatasetByIdAsObservable=function(se){return this.store.select(qe.Ue,{id:se})},Ee.prototype.findByPackageId=function(se,I){return(this.config.shouldFilterDataServicesByFolder?this.store.select(j.Rx,{id:I}):this.store.select(qe.Su)).pipe((0,Le.U)(function(ye){return ye.filter(function(W){return W.packageId===se})}),(0,te.q)(1)).toPromise()},Ee.prototype.findDataset=function(se,I,ie){return void 0===ie&&(ie=!1),this.store.select(qe.pY,{modelId:se,packageId:I,allowOtherPackages:ie}).pipe((0,te.q)(1)).toPromise()},Ee.prototype.findDatasetByObjectId=function(se){return this.store.select(j.Z6,se).pipe((0,Le.U)(function(I){return I[0]}),(0,te.q)(1)).toPromise()},Ee.prototype.findAll=function(se,I){return void 0===I&&(I=!1),this.store.select(I||!this.config.shouldFilterDataServicesByFolder?qe.Su:j.qI).pipe((0,Le.U)(function(ye){return ye.filter(function(W){return W.id===se})}),(0,te.q)(1)).toPromise()},Ee.prototype.loadUserPermissions=function(se,I){this.store.dispatch(new b.dG({id:se,permissions:I}))},Ee.prototype.delete=function(se,I,ie){return se&&this.store.dispatch(I?new b.JW({dataset:se,relatedReportIds:[]}):new b.HG({dataset:se,telemetryEvent:ie})),ie&&ie.promise},Ee.prototype.rename=function(se,I,ie){return this.store.dispatch(new b.ic({dataset:se,name:I,telemetryEvent:ie})),ie&&ie.promise},Ee.prototype.bulkLoad=function(se,I){this.store.dispatch(new b.T4({datasets:se,loadCompletion:I}))},Ee.prototype.load=function(se,I,ie,ye){this.store.dispatch(new b.q5({id:se,packageId:I,loadCompletion:ie,telemetryEvent:ye}))},Ee.prototype.add=function(se,I,ie){this.store.dispatch(new b.q5({id:se,packageId:I,isNew:!0,loadCompletion:ie}))},Ee.prototype.bulkAdd=function(se){this.store.dispatch(new b.Uo(se))},Ee.prototype.bulkAddWithoutUpdate=function(se){this.store.dispatch(new b.zh(se))},Ee.prototype.loadShared=function(se){this.store.dispatch(new b.pH({loadCompletion:se}))},Ee.prototype.ensureLoadedReadonlyShared=function(se){this.store.dispatch(new b.zb({loadCompletion:se}))},Ee.prototype.updateCaching=function(se,I,ie,ye){this.store.dispatch(new b.Gp({id:se,packageId:I,cachingSettings:ie,telemetryEvent:ye}))},Ee.prototype.endorse=function(se,I){this.store.dispatch(new b.dQ({dataset:se,galleryItem:I}))},Ee.prototype.findModelByDBName=function(se,I){var ie;return!(ie=I?this.dataset$.pipe((0,Le.U)(function(ye){return _.find(_.map(ye,function(W){return W.dataset}),function(W){return W.dbName===se&&W.packageId===I})}),(0,te.q)(1)).toPromise():this.findDatasetByObjectId(se))&&!I&&(ie=this.dataset$.pipe((0,Le.U)(function(ye){return _.find(_.map(ye,function(W){return W.dataset}),function(W){return W.dbName===se})}),(0,te.q)(1)).toPromise()),ie},Ee.prototype.moveToSubfolder=function(se){this.store.dispatch(new b.Xg({movedDatasets:se}))},Ee.prototype.getCopyEditUsableDataSets=function(se){return(0,w.__awaiter)(this,void 0,void 0,function(){var I,ie,ye;return(0,w.__generator)(this,function(ne){switch(ne.label){case 0:return[4,this.store.select(qe.uL).pipe((0,te.q)(1),(0,Le.U)(function(ve){return _.filter(_.map(ve,function(me){return me.dataset}),function(me){return(0,tt.q0)(me)})})).toPromise()];case 1:return I=ne.sent(),[4,this.combineAndFilterUsableModelLists(I,se)];case 2:return ie=ne.sent(),[2,{models:ye=_.filter(ie,function(ve){return ve.workspaceName}),filteredCount:I.length-ye.length}]}})})},Ee.prototype.combineAndFilterUsableModelLists=function(se,I){return(0,w.__awaiter)(this,void 0,void 0,function(){var ie,ye,W,ne;return(0,w.__generator)(this,function(ve){switch(ve.label){case 0:return I?(W=(ye=_).concat,[4,this.datasets.pipe((0,te.q)(1),(0,Le.U)(function(me){return _.map(me,function(q){return q.dataset})})).toPromise()]):[2,se];case 1:return ne=[ve.sent()],[4,this.explorableDatasets.pipe((0,te.q)(1)).toPromise()];case 2:return ie=W.apply(ye,ne.concat([ve.sent()])),[2,_.filter(ie,function(me){return 2!==me.workspaceType})]}})})},Ee.\u0275fac=function(I){return new(I||Ee)(Ge.\u0275\u0275inject(He.yh),Ge.\u0275\u0275inject(e.e))},Ee.\u0275prov=Ge.\u0275\u0275defineInjectable({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee}()},19178:function(pt,Ct,M){"use strict";M.d(Ct,{Y:function(){return ie}});var w=M(81337),b=M(82515),e=M(74076),j=M(40898),qe=M(82762),te=M(11547),Le=M(59017),tt=M(81905),Ge=M(14172),He=M(48787),Z=M(41198),Ee=M(23558),se=M(50423),I=M(85732),ie=function(){function ye(W){this.store=W}return Object.defineProperty(ye.prototype,"selectedGroup$",{get:function(){return this.store.select(e.S6)},enumerable:!1,configurable:!0}),Object.defineProperty(ye.prototype,"selectedFolderId$",{get:function(){return this.store.select(e.CW)},enumerable:!1,configurable:!0}),Object.defineProperty(ye.prototype,"myFolderObjectId$",{get:function(){return this.store.select(e.iF)},enumerable:!1,configurable:!0}),Object.defineProperty(ye.prototype,"nonMyWorkspaces$",{get:function(){return this.store.select(e.c_)},enumerable:!1,configurable:!0}),Object.defineProperty(ye.prototype,"myWorkspace$",{get:function(){return this.store.select(e.Au)},enumerable:!1,configurable:!0}),ye.prototype.foldersWithEditPermissions=function(W){var ne=this;return(0,qe.D)(this.ensureWorkspacesLoaded()).pipe((0,tt.w)(function(){return(0,Le.aj)([ne.store.select(j.Ou),W?ne.store.select(e.Ze):(0,te.of)(null)])}),(0,Ge.U)(function(ve){var q=ve[1],be=_(ve[0]).filter(function(_e){return!q||!_.isEqual(_e,q)}).sortBy(function(_e){return _e.displayName.toLocaleLowerCase()}).value();return q?(0,w.__spreadArray)([q],be,!0):be}))},ye.prototype.add=function(W,ne){this.store.dispatch(new b.mm({group:W,isFolder:ne}))},Object.defineProperty(ye.prototype,"folders",{get:function(){return this.store.select(j.xh).pipe((0,Ge.U)(function(ne){return _.map(Object.keys(ne),function(ve){return ne[ve]})}))},enumerable:!1,configurable:!0}),ye.prototype.remove=function(W){this.store.dispatch(new b.JW(W))},ye.prototype.update=function(W){this.store.dispatch(new b.BN(W))},ye.prototype.updateGroup=function(W){this.store.dispatch(new b.bn(W))},ye.prototype.updatePartialWorkspaces=function(W){this.store.dispatch(new b.ZG(W))},ye.prototype.load=function(W){this.store.dispatch(new b.q5({groupId:W}))},ye.prototype.getGroupById=function(W){return this.store.select(e.VL,{id:W})},ye.prototype.getAllNonEmptyDomains=function(){return this.store.select(e.vL)},ye.prototype.addDomainFilters=function(W){this.store.dispatch(new b.qC({domainObjectIds:W}))},ye.prototype.deleteDomainFilters=function(W){this.store.dispatch(new b.tk({domainObjectIds:W}))},ye.prototype.getGroupObjectId=function(W){return this.store.select(e.cM).pipe((0,tt.w)(function(ne){for(var ve in ne){var me=ne[ve];if(me.id===W)return(0,te.of)(me?.objectId)}return(0,te.of)(void 0)}),(0,He.q)(1))},ye.prototype.loadSuccess=function(W,ne,ve,me){this.store.dispatch(new b.Xt({id:W,group:ne,folderId:ve,permissions:me}))},ye.prototype.loadSuccessBasedOnWorkspaceContext=function(W,ne){var ve=this;this.store.select(e.ve).pipe((0,He.q)(1)).subscribe(function(me){ve.store.dispatch(new b.Xt(me?{id:W,group:ne,folderId:void 0,permissions:void 0,currentWorkspaceType:"folder"}:{id:W,group:ne,folderId:void 0,permissions:void 0,currentWorkspaceType:"group"}))})},ye.prototype.select=function(W){this.store.dispatch(new b.Ph({id:W}))},ye.prototype.switch=function(W,ne){this.store.dispatch(new b.q_({groupId:W,groupSwitchOptions:ne}))},ye.prototype.ensureGroupArtifactsLoaded=function(W,ne){var ve=this;return this.store.select(e.s4).pipe((0,Z.n)(function(me){return!me}),(0,He.q)(1)).subscribe(function(){ve.store.dispatch(new b._S({groupObjectId:W,refreshIfStale:!1,addArtifacts:ne}))}),this.store.select(e.VL,{id:W}).pipe((0,Ee.M)(this.store.select(e.Uy)),(0,Z.n)(function(me){var q=me[0];return!q||!(q.loaded&&(!ne||!0===me[1]))}),(0,He.q)(1),(0,Ge.U)(function(){return!0})).toPromise()},ye.prototype.ensureGroupArtifactsLoadedOrError=function(W){var ne=this;return this.store.select(e.s4).pipe((0,Z.n)(function(ve){return!ve}),(0,He.q)(1)).subscribe(function(){ne.store.dispatch(new b._S({groupObjectId:W,refreshIfStale:!1}))}),this.store.select(e.VL,{id:W}).pipe((0,Z.n)(function(ve){return!ve||!ve.loaded&&!ve.loadedWithError}),(0,He.q)(1),(0,Ge.U)(function(){return!0})).toPromise()},ye.prototype.ensureGroupSelectedAndLoaded=function(W){return this.store.select(e.S6).pipe((0,Z.n)(function(ne){return!ne||!ne.loaded||ne.objectId!==W}),(0,He.q)(1),(0,Ge.U)(function(){return!0})).toPromise()},ye.prototype.ensureWorkspacesLoaded=function(){var W=this;return this.store.select(e.LD).pipe((0,Z.n)(function(ne){return!ne||ne.loading}),(0,He.q)(1)).subscribe(function(ne){ne.loaded||W.store.dispatch(new b.Us)}),this.store.select(e.LD).pipe((0,Z.n)(function(ne){return!ne||!ne.loaded}),(0,He.q)(1),(0,Ge.U)(function(){return!0})).toPromise()},ye.prototype.forceReloadWorkspaces=function(){return this.store.dispatch(new b.Us),this.store.select(e.LD).pipe((0,Z.n)(function(W){return!W||!W.loaded}),(0,He.q)(1),(0,Ge.U)(function(){return!0})).toPromise()},ye.prototype.updateMyWorkSpaceCapacity=function(W){this.store.dispatch(new b.Vd(W))},ye.prototype.loadFoldersSuccess=function(W){this.store.dispatch(new b.uw(W))},ye.prototype.hide=function(W){this.store.dispatch(new b.c({group:W}))},ye.prototype.unhide=function(W){this.store.dispatch(new b.yO({group:W}))},ye.\u0275fac=function(ne){return new(ne||ye)(se.\u0275\u0275inject(I.yh))},ye.\u0275prov=se.\u0275\u0275defineInjectable({token:ye,factory:ye.\u0275fac,providedIn:"root"}),ye}()},94420:function(pt,Ct,M){"use strict";M.d(Ct,{R:function(){return me}});var w=M(81337),b=M(98632),e=M(82515),j=M(90982),qe=M(3408),te=M(35911),Le=M(62458),tt=M(59017),Ge=M(48787),He=M(14172),Z=M(59973),Ee=M(40521),se=M(74076),I=M(14556),ie=M(43633),ye=M(18405),W=M(81871),ne=M(50423),ve=M(85732),me=function(){function q(be,_e){this.store=be,this.reports$=this.store.select(_e.shouldFilterDataServicesByFolder?Ee.CL:ie.I1),this.sharedReports$=this.store.select(_e.shouldFilterDataServicesByFolder?Ee.pV:I.XA),this.selectedReport$=this.store.select(ie.OX)}return Object.defineProperty(q.prototype,"reports",{get:function(){return this.reports$},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"sharedReports",{get:function(){return this.sharedReports$},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"selectedReport",{get:function(){return this.selectedReport$},enumerable:!1,configurable:!0}),q.prototype.getReportsByGroupId=function(be){return this.store.select(Ee.Uw,{id:be}).pipe((0,Ge.q)(1))},q.prototype.findByObjectId=function(be){return this.store.select(ie.Ok).pipe((0,He.U)(function(_e){return _e[be]}),(0,Ge.q)(1)).toPromise()},q.prototype.findById=function(be){return this.store.select(ie.Ok).pipe((0,He.U)(function(_e){return _.find(_e,function(pe){return pe.id===be})}),(0,Ge.q)(1)).toPromise()},q.prototype.findByPackageId=function(be){return this.store.select(ie.I1).pipe((0,He.U)(function(_e){return _.filter(_e,function(pe){return pe.packageId===be})}),(0,Ge.q)(1)).toPromise()},q.prototype.findByName=function(be){return this.store.select(ie.I1).pipe((0,He.U)(function(_e){return _.filter(_e,function(pe){var Re;return(null===(Re=pe.displayName)||void 0===Re?void 0:Re.toLowerCase())===be?.toLowerCase()})}),(0,Ge.q)(1)).toPromise()},q.prototype.delete=function(be,_e,pe){return be&&this.store.dispatch(_e?new b.JW({report:be}):new b.HG({report:be,telemetryEvent:pe})),pe&&pe.promise},q.prototype.rename=function(be,_e,pe){return this.store.dispatch(new b.ic({report:be,name:_e,telemetryEvent:pe})),pe&&pe.promise},q.prototype.load=function(be,_e){this.store.dispatch(new b.q5({id:be,loadCompletion:_e}))},q.prototype.rebind=function(be,_e){this.store.dispatch(new b.f$({report:be,dataset:_e}))},q.prototype.addFromSyncService=function(be,_e){this.store.dispatch(new b.xb({id:be,isNew:!0,loadCompletion:_e}))},q.prototype.select=function(be){this.store.dispatch(new b.Ph({reportInfo:be}))},q.prototype.ensure=function(be){var _e=this;Le.fF.assertValue(be,"ensure - report");var pe=this.store;(0,tt.aj)(pe.select(W.zu),pe.select(ye.Su)).pipe((0,Ge.q)(1),(0,He.U)(function(Re){var N=Re[0][be.packageId],B=be.modelId,X=_.find(Re[1],function(K){return K.id===B});return new b._S({report:be,pkg:N,datasetId:X&&(0,qe.EL)(X)})})).subscribe(function(Re){_e.store.dispatch(Re)})},q.prototype.updateVisibility=function(be,_e,pe){this.store.dispatch(new b.Lf({report:be,isVisible:_e,telemetryEvent:pe}))},q.prototype.hide=function(be){this.store.dispatch(new b.c({report:be}))},q.prototype.unhide=function(be){this.store.dispatch(new b.yO({report:be}))},q.prototype.update=function(be,_e){this.store.dispatch(new b.BN({report:be,changes:_e}))},q.prototype.updateMany=function(be){this.store.dispatch(new b.AX(be))},q.prototype.isReportInAdminFolder=function(){return this.store.select(se.$y)},q.prototype.moveToSubfolder=function(be){this.store.dispatch(new b.Xg({movedReports:be}))},q.prototype.ensureReportLoaded=function(be,_e){return(0,w.__awaiter)(this,void 0,void 0,function(){var pe,Re;return(0,w.__generator)(this,function(Qe){switch(Qe.label){case 0:return[4,this.store.select(se.cM).pipe((0,Ge.q)(1)).toPromise()];case 1:return pe=Qe.sent(),this.store.dispatch(new b.yi({reportObjectId:be,workspaceObjectId:Re=_e&&pe[_e]?_e:te.fm})),this.store.dispatch(new e.oi({groupId:Re,reportId:be})),[4,this.store.select(ie.W4,{id:be}).pipe((0,Z.h)(function(ke){return ke&&(!1===ke.loading||!0===ke.loaded)}),(0,Ge.q)(1)).toPromise()];case 2:return Qe.sent(),[2]}})})},q.\u0275fac=function(_e){return new(_e||q)(ne.\u0275\u0275inject(ve.yh),ne.\u0275\u0275inject(j.e))},q.\u0275prov=ne.\u0275\u0275defineInjectable({token:q,factory:q.\u0275fac,providedIn:"root"}),q}()},31447:function(pt,Ct,M){"use strict";M.r(Ct),M.d(Ct,{GoalsUIModule:function(){return om}});var w=M(81337),b=M(62458),e=M(50423),j=M(77476),qe=M(36858),te=M(223),Le=function(n){return{userEmail:n}};function tt(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"user-details-host",4),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(4,Le,t))("photoSize",r.photoSize)("showUserInfo",!1)("showTooltip",!0)}}function Ge(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",5)(1,"div",6),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(),r=e.\u0275\u0275reference(5);e.\u0275\u0275styleProp("width",t.photoSize,"px")("height",t.photoSize,"px"),e.\u0275\u0275property("pbiTooltip",r)("pbiTooltipCaretSize","small")("pbiTooltipPosition","below"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" +",t.emails.length-t.numUsersToShow," ")}}function He(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275listener("click",function(a){return a.stopPropagation()}),e.\u0275\u0275element(1,"user-details-host",10),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(4,Le,t))("showUserInfo",!0)("showOneLine",!1)("showTooltip",!1)}}function Z(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275template(1,He,2,6,"div",8),e.\u0275\u0275pipe(2,"slice"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind2(2,1,t.emails,t.numUsersToShow))}}var Ee=function(){function i(){this.emails=[],this.numAvatarsToShow=5,this.avatarSize="medium",this.rowStyle="spread",this.AvatarSizeMap={smallest:{photoSize:16,spreadSpacing:8,stackOverlap:2,stackOutline:2},small:{photoSize:20,spreadSpacing:10,stackOverlap:2,stackOutline:2},medium:{photoSize:24,spreadSpacing:10,stackOverlap:4,stackOutline:2}}}return i.prototype.ngOnInit=function(){this.setSize()},i.prototype.ngOnChanges=function(n){(n.emails||n.numAvatarsToShow)&&this.setUserCount(),(n.avatarSize||n.rowStyle)&&this.setSize()},i.prototype.setUserCount=function(){this.numUsersToShow=this.emails.length>this.numAvatarsToShow?this.numAvatarsToShow-1:this.numAvatarsToShow},i.prototype.setSize=function(){var n=this.AvatarSizeMap[this.avatarSize];b.fF.assertValue(n,"Invalid size ".concat(this.avatarSize," for AvatarRow.")),this.photoSize=n.photoSize;var t=0,r=0,a=0;"spread"===this.rowStyle?a=n.spreadSpacing:"stack"===this.rowStyle?(t=n.stackOutline,r=-n.stackOutline,a=-n.stackOutline-n.stackOverlap):b.fF.assertFail("Invalid style ".concat(this.rowStyle," for AvatarRow.")),this.styleVariables={"--avatar-left-margin":r+"px","--avatar-right-margin":a+"px","--avatar-outline":t+"px"}},i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["avatar-row"]],inputs:{emails:"emails",numAvatarsToShow:"numAvatarsToShow",avatarSize:"avatarSize",rowStyle:"rowStyle"},features:[e.\u0275\u0275NgOnChangesFeature],decls:6,vars:8,consts:[[1,"avatar-row-container"],[4,"ngFor","ngForOf"],["class","plus-number-container",3,"width","height","pbiTooltip","pbiTooltipCaretSize","pbiTooltipPosition",4,"ngIf"],["collapsedAvatars",""],[1,"user-details-host",3,"details","photoSize","showUserInfo","showTooltip"],[1,"plus-number-container",3,"pbiTooltip","pbiTooltipCaretSize","pbiTooltipPosition"],[1,"plus-number"],[1,"collapsed-avatar-list"],["class","collapsed-avatar",3,"click",4,"ngFor","ngForOf"],[1,"collapsed-avatar",3,"click"],[3,"details","showUserInfo","showOneLine","showTooltip"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,tt,2,6,"div",1),e.\u0275\u0275pipe(2,"slice"),e.\u0275\u0275template(3,Ge,3,8,"div",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Z,3,4,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275styleMap(r.styleVariables),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind3(2,4,r.emails,0,r.numUsersToShow)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.emails.length>r.numUsersToShow))},dependencies:[j.NgForOf,j.NgIf,qe.V,te.s,j.SlicePipe],styles:['.avatar-row-container[_ngcontent-%COMP%]{display:inline-flex;--avatar-outline-color: var(--fluent-theme-white-color)}.avatar-row-container[_ngcontent-%COMP%]   .user-details-host[_ngcontent-%COMP%]     .user-image{margin-left:var(--avatar-left-margin);margin-right:var(--avatar-right-margin)}.avatar-row-container[_ngcontent-%COMP%]   .user-details-host[_ngcontent-%COMP%]     .user-image>*{border:var(--avatar-outline) solid var(--avatar-outline-color)}.avatar-row-container[_ngcontent-%COMP%]   .plus-number-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);border-radius:50%;border:var(--avatar-outline) solid var(--avatar-outline-color)}.avatar-row-container[_ngcontent-%COMP%]   .plus-number-container[_ngcontent-%COMP%]   .plus-number[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xs-font-size, 10px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}.collapsed-avatar-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0 16px}.collapsed-avatar[_ngcontent-%COMP%]{display:flex;align-items:center;height:48px;white-space:nowrap;overflow:hidden}'],changeDetection:0}),i}(),se=M(73221),I=M(77526),ie=M(83317),ye=M(8297),W=M(60042),ne=M(44603),ve=M(4444),me=M(38078),q=function(){function i(){}return i.isSampleScorecard=function(n){return"00000000-0000-0000-0000-000000000000"===n.id},i.getGoalCreateRequest=function(n){var t;return b.fF.assertValue(n,"goal"),{name:n.name,completionDate:n.completionDate,owner:n.owner,additionalOwners:n.additionalOwners,parentId:null!==(t=n.parentId)&&void 0!==t?t:null,startDate:n.startDate,unit:n.unit,datesFormatString:n.datesFormatString,valuesFormatString:n.valuesFormatString,valuesCategoryId:n.valuesCategoryId}},i.getGoalUpdateRequest=function(n){var t;return b.fF.assertValue(n,"goal"),{name:n.name,completionDate:n.completionDate,owner:n.owner,additionalOwners:n.additionalOwners,parentId:null!==(t=n.parentId)&&void 0!==t?t:null,startDate:n.startDate,unit:n.unit,datesFormatString:n.datesFormatString,valuesFormatString:n.valuesFormatString,description:n.description,cycle:n.cycle,cyclePeriod:n.cyclePeriod,valuesCategoryId:n.valuesCategoryId,metadata:n.metadata,cycleMetadata:n.cycleMetadata}},i.getGoalValueCreateRequest=function(n){return b.fF.assertValue(n,"goalValue"),{timestamp:n.timestamp,value:n.value,target:n.target,trend:n.trend,forecast:n.forecast,status:n.status}},i.getGoalValueUpdateRequest=function(n){return b.fF.assertValue(n,"goalValue"),{value:n.value,target:n.target,trend:n.trend,forecast:n.forecast,status:n.status}},i.getGoalStatusRulesUpdateRequest=function(n){b.fF.assertValue(n,"statusRules");var t=function(p){return{dateTime:p.dateTime,field:p.field,number:p.number,percentOf:p.percentOf?{field:p.percentOf.field,percent:p.percentOf.percent}:void 0}},r=function(p){return{field:p.field,operator:p.operator,value:t(p.value)}};return{rules:_.map(n.rules,function(u){return p=u,{conditions:_.map(p.conditions,function(v){return function(p){return{fieldComparison:r(p.fieldComparison),expression:p.expression}}(v)}),output:p.output};var p}),defaultOutput:n.defaultOutput}},i.isGoalMetadataUpdated=function(n,t){return!_.isEqual(i.getGoalUpdateRequest(n),i.getGoalUpdateRequest(t))},i.createNewGoal=function(n,t,r){b.fF.assertValue(n,"owner"),b.fF.assertValue(t,"scorecardId");var a=new Date,s=ne.E.getCurrentUTCDay().toISOString(),c=ne.E.getCurrentLocalDay();c.setMonth(c.getMonth()+1);var u=ne.E.treatAsUTCDate(c).toISOString();return{name:null,id:"new-".concat(me.b$.generateGuid()),scorecardId:t,createdTime:a.toISOString(),lastModifiedBy:n,lastModifiedTime:a.toISOString(),owner:n,additionalOwners:[],startDate:s,completionDate:u,unit:0,parentId:r??null,goalValues:[],subGoals:[],isNew:!0,state:"Editing",valuesCategoryId:null,isExpanded:!0}},i.getGoal=function(n,t){return this.findGoal(n,function(r){return r.id===t})},i.buildGoalTree=function(n){for(var t={},r=0,a=n;r<a.length;r++)t[(s=a[r]).id]=s;for(var c=[],u=0,p=n;u<p.length;u++){var s;if((s=p[u]).parentId&&t[s.parentId]){var v=t[s.parentId];v.subGoals?v.subGoals.push(s):v.subGoals=[s]}else c.push(s)}return c},i.findGoal=function(n,t){if(_.some(n)){var r=_.find(n,function(u){return t(u)});if(r)return r;for(var a=0,s=n;a<s.length;a++)if(r=this.findGoal(s[a].subGoals,t))return r}return null},i.forEachGoal=function(n,t){if(_.some(n))for(var r=0,a=n;r<a.length;r++){var s=a[r];t(s),this.forEachGoal(s?.subGoals,t)}},i.countSubGoals=function(n,t){var r=this;return void 0===t&&(t=function(){return!0}),_.isEmpty(n?.subGoals)?0:n.subGoals.filter(t).length+n.subGoals.reduce(function(s,c){return s+r.countSubGoals(c,t)},0)},i.flattenGoals=function(n){return function r(a){return _.flatMap(a,function(s){return(0,w.__spreadArray)([s],r(s.subGoals),!0)})}(n)},i.filterGoals=function(n,t){return _.filter(this.flattenGoals(n),t)},i.mapGoals=function(n,t){return _.map(this.flattenGoals(n),t)},i.anyGoals=function(n,t){var r;if(_.some(n))for(var a=0,s=n;a<s.length;a++){var c=s[a];if(t(c)||this.anyGoals(null!==(r=c.subGoals)&&void 0!==r?r:[],t))return!0}return!1},i.computeGoalHeight=function(n){return _.isEmpty(n?.subGoals)?0:Math.max.apply(Math,n.subGoals.map(function(t){return 1+i.computeGoalHeight(t)}))},i.computeGoalLevel=function(n,t){for(var r=0,a=t;a;)r++,a=a.parentId?i.getGoal(n,a.parentId):void 0;return r-1},i.filterGoalsAndReassignParents=function(n,t){var r=function a(s,c){var u=[],p=c;return t(s)&&(u.push((0,w.__assign)((0,w.__assign)({},s),{parentId:c})),p=s.id),_.concat(u,_.flatMap(s.subGoals,function(v){return a(v,p)}))};return _.flatMap(n,function(a){return r(a)})},i.isEditing=function(n){return!!i.findGoal(n?.goals,function(t){return!!t.isNew||"Editing"===t.state})},i.isDarkMode=function(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches},i.getCurrentUser=function(){var n;return null===(n=(0,ve.bG)())||void 0===n?void 0:n.name},i.isCurrentUser=function(n){var t=i.getCurrentUser();return t&&n&&(0,me.vr)(t,n)},i.compareGoalQueryConnections=function(n,t){return _.isEqual(n?.query,t?.query)&&_.isEqual(n?.datasetId,t?.datasetId)&&_.isEqual(n?.reportUrl,t?.reportUrl)},i.getGoalValueCategoriesCreateRequest=function(n){return b.fF.assertValue(!_.isEmpty(n),"getGoalValueCategoriesCreateRequest categoricalValues"),{name:"",categories:_.map(n,function(t,r){return{id:r,displayName:t}})}},i.getGoalValueCategoriesUpdateRequest=function(n){return b.fF.assertValue(n,"getGoalValueCategoriesUpdateRequest categoryList"),{name:n.name,categories:n.categories}},i.getGoalOwners=function(n){if(_.some(n)){var r={};return function a(s,c){if(_.some(s))for(var u=0,p=s;u<p.length;u++){var v=p[u];if(v.owner&&(c[v.owner]={displayName:void 0,userPrincipalName:v.owner,objectId:void 0,objectType:3,isSecurityGroup:void 0}),_.some(v.additionalOwners))for(var P=0,x=v.additionalOwners;P<x.length;P++){var G=x[P];G.userPrincipalName&&(c[G.userPrincipalName]={displayName:void 0,userPrincipalName:G.userPrincipalName,objectId:void 0,objectType:3,isSecurityGroup:void 0})}a(v.subGoals,c)}}(n,r),_.values(r)}return[]},i.observeAndRemoveFocusableAttributes=function(n){if(n){var t=new MutationObserver(function(r){_.some(r,function(s){var c;return(null===(c=s.addedNodes)||void 0===c?void 0:c.length)>0})&&function s(c){c&&(c.removeAttribute("tabindex"),c.removeAttribute("focusable"),_.forEach(c.children,s))}(n)});return t.observe(n,{attributeFilter:["tabindex","focusable"],characterData:!1,childList:!0,subtree:!0}),t}return null},i.getGoalsWithRollups=function(n,t,r){for(var s,a=[];t&&null!=(s=i.getGoal(n,t))&&!0!==s.isLinked&&(t=s.parentId,1===r&&null!=s.valueRollup||2===r&&null!=s.targetRollup);)a.push(s);return a},i}(),be=M(86940),_e=M(25512),pe=M(35510),Re=M(30794);function Qe(i){if(null==i)return 0;if("number"==typeof i)return i;if("string"==typeof i)switch(i.toString().trim().toLowerCase()){case"none":return 0;case"read":default:return 1;case"write":return 2;case"readwrite":return 3}return 0}var ke=M(125),N=M(57535),B=function(){function i(){}return i.sortAndFilter=function(n,t,r,a){if(_.isEmpty(n))return n;var s=t.sortAscending?"asc":"desc",c=[this.sortingFunctions[t.sortBy]];return"Rank"===t.sortBy&&c.push(this.sortingFunctions.CreatedTime),c.push("Name"===t.sortBy?this.sortingFunctions.CreatedTime:this.sortingFunctions.Name),this.sortRecursive(n,s,c,r,a)},i.sort=function(n,t){return this.sortAndFilter(n,t,{},{})},i.toggleSort=function(n,t){return t?n.sortBy===t?n.sortAscending?{sortBy:n.sortBy,sortAscending:!1}:W.Ij:{sortBy:t,sortAscending:!0}:n},i.sortRecursive=function(n,t,r,a,s){for(var c=0,u=n=_.orderBy(n,r,[t,"asc"]);c<u.length;c++){var p=u[c];_.isEmpty(p.subGoals)||(p.subGoals=this.sortRecursive(p.subGoals,t,r,a,s)),_.isNil(s)?(delete p.isFilterMatch,delete p.isHidden):(p.isFilterMatch=i.matchesFilter(p,a,s),p.isHidden=!p.isFilterMatch&&!_.some(p.subGoals,function(v){return!v.isHidden}))}return n},i.matchesFilter=function(n,t,r){var a,s,c,u,p;if(_.isNil(r)||n.isNew||"Editing"===n.state||"Saving"===n.state)return!0;var v=null!==(a=ke.r.buildCurrentGoalValue(n).status)&&void 0!==a?a:0,P=N.p.getGoalStatusForScorecardId(v,n.scorecardId,t),x=!1,G=null===(s=r?.keyword)||void 0===s?void 0:s.toLocaleLowerCase();if(!_.isString(G)||_.isEmpty(G))x=!0;else if(!(null===(c=n.name)||void 0===c)&&c.toLocaleLowerCase().includes(G)&&(x=!0),r?.matchOwner&&!x&&((null===(u=n.ownerDisplayNames)||void 0===u?void 0:u.length)>=1?x=_.some(n.ownerDisplayNames,function(Se){return Se?.toLocaleLowerCase().includes(G)}):(x=null===(p=n.owner)||void 0===p?void 0:p.toLocaleLowerCase().includes(G))||(x=_.some(n.additionalOwners,function(Se){var Ae,xe=null!==(Ae=Se.userPrincipalName)&&void 0!==Ae?Ae:Se.aadAppId;return xe?.toLocaleLowerCase().includes(G)}))),r?.matchStatus&&!x){var Y=P.displayName;Y?.toLocaleLowerCase().includes(G)&&(x=!0)}var ue=!1;return(_.isNil(r?.statuses)||_.isEmpty(r?.statuses)||N.p.listIncludesMatchingStatus(r.statuses,P))&&(ue=!0),x&&ue},i.sortingFunctions={Rank:function(t){return t.rank},CreatedTime:function(t){return t.createdTime},Name:function(t){var r;return null===(r=t.name)||void 0===r?void 0:r.trim().toLocaleLowerCase()},Owner:function(t){var r,a,s;return null===(s=null!==(a=null===(r=t.ownerDisplayNames)||void 0===r?void 0:r[0])&&void 0!==a?a:t.owner)||void 0===s?void 0:s.trim().toLocaleLowerCase()},Status:function(t){return(ke.r.buildCurrentGoalValue(t).status+1)%6},Value:function(t){return ke.r.buildCurrentGoalValue(t).value},Change:function(t){return ke.r.calculateValueChange(t,!0).changeAmount},Milestone:function(t){return ke.r.buildCurrentGoalValue(t).nextTarget},Target:function(t){return ke.r.buildCurrentGoalValue(t).finalTarget},DueDate:function(t){return t.completionDate}},i}(),X=M(558),K=function(){function i(){}return i.moveColumnSettingUp=function(n,t){if(!(_.size(n)<=1||0===t)){var r=n;return(0,w.__spreadArray)((0,w.__spreadArray)((0,w.__spreadArray)([],_.slice(r,0,t-1),!0),[r[t],r[t-1]],!1),_.slice(r,t+1),!0)}},i.moveColumnSettingDown=function(n,t){if(!(_.size(n)<=1||t===_.size(n)-1)){var r=n;return(0,w.__spreadArray)((0,w.__spreadArray)((0,w.__spreadArray)([],_.slice(r,0,t),!0),[r[t+1],r[t]],!1),_.slice(r,t+2),!0)}},i.canMoveLeft=function(n,t){if(t<=1)return!1;var r=_.slice(n,0,t);return _.findLastIndex(r,function(s){return s.show})>0},i.canMoveRight=function(n,t){return!(0===t||t>=n.length-1)&&_.findIndex(n,function(a){return a.show},t+1)>t},i.moveColumnLeft=function(n,t){var r=_.findIndex(n,function(c){return c.columnId===t}),a=_.slice(n,0,r),s=_.findLastIndex(a,function(c){return c.show});(0,X.bA)(n,r,s)},i.moveColumnRight=function(n,t){var r=_.findIndex(n,function(s){return s.columnId===t}),a=_.findIndex(n,function(s){return s.show},r+1);(0,X.bA)(n,r,a)},i.hideColumn=function(n,t){var r=_.findIndex(n,function(a){return a.columnId===t});r>=0&&(n[r].show=!1)},i.showColumn=function(n,t){var r=_.findIndex(n,function(a){return a.columnId===t});r>=0&&(n[r].show=!0)},i.isColumnVisible=function(n,t){var r=_.find(n,function(a){return a.columnId===t});return!!_.isUndefined(r?.show)||r.show},i.mergeColumns=function(n,t){for(var r=new Array,a=new Set(t.map(function(G){return G.columnId})),s=new Set,c=0,u=n;c<u.length;c++){var p=u[c];a.has(p.columnId)&&!s.has(p.columnId)&&(r.push(p),s.add(p.columnId))}for(var v=0,P=t;v<P.length;v++){var x=P[v];s.has(x.columnId)||r.push(x)}return r},i.removeColumnSettings=function(n,t){var r=new Set(t);_.remove(n,function(a){return r.has(a.columnId)})},i.adjustColumnSettings=function(n,t){n.featureSwitches.scorecardSplitColumns||(i.removeColumnSettings(t,[7,8,9]),i.isColumnVisible(t,3)||i.showColumn(t,3)),n.featureSwitches.scorecardCompactView||i.removeColumnSettings(t,[10])},i}(),le=function(){function i(){}return i.ManuallyUpdatingConnectedGoalValueNotAllowed="ManuallyUpdatingConnectedGoalValueNotAllowed",i.ManuallyUpdatingConnectedMetricValueNotAllowed="ManuallyUpdatingConnectedMetricValueNotAllowed",i.MultiGeoNotSupported="MultiGeoNotSupported",i.InvalidScorecardColumnSetting="InvalidScorecardColumnSetting",i.CircularRelationshipsNotAllowed="CircularRelationshipsNotAllowed",i}(),ae=M(11547),ze=M(18353),st=M(42195),vt=M(70032),he=M(48787),Oe=function(){function i(n){var t,r=this;this.scorecardService=n,this.MinPollingInterval=200,this.MaxPollingInterval=4e3,this.MaxPollingRequests=40,this.PollingDelay=function(a){return r.MinPollingInterval+(r.MaxPollingInterval-r.MinPollingInterval)*a/r.MaxPollingRequests},this.ConnectionTypeAsText=((t={})[1]="Current",t[2]="Target",t)}return i.prototype.startPollingAsync=function(n,t,r){return(0,w.__awaiter)(this,void 0,void 0,function(){var a,c=this;return(0,w.__generator)(this,function(u){switch(u.label){case 0:if(this.setGoalRefreshState(n.id,t,!0),a=r?.lastRefreshTimestamp,null!=a)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.getLastRefreshTimestamp(n.id,t)];case 2:return a=u.sent(),[3,4];case 3:return u.sent(),this.setGoalRefreshState(n.id,t,!1),[2];case 4:return(0,w.__awaiter)(c,void 0,void 0,function(){var p,v,P,G,x=this;return(0,w.__generator)(this,function(Y){switch(Y.label){case 0:return Y.trys.push([0,,9,10]),p=new Re.xQ,(v=p.pipe((0,ze.R)(function(ue){return ue+1},-1),(0,st.zg)(function(ue){return(0,ae.of)(void 0).pipe((0,vt.g)(x.PollingDelay(ue)))}),(0,he.q)(this.MaxPollingRequests))).subscribe(function(){return(0,w.__awaiter)(x,void 0,void 0,function(){return(0,w.__generator)(this,function(ue){switch(ue.label){case 0:return[4,this.getLastRefreshTimestamp(n.id,t)];case 1:return P=ue.sent(),a===P?p.next():(b.fF.assertValue(P>a,"Expected new refresh history count to be higher"),p.complete()),[2]}})})}),p.next(),[4,v.toPromise()];case 1:return Y.sent(),r?.refreshGoal?[4,this.scorecardService.refreshGoal(n.id)]:[3,3];case 2:Y.sent(),Y.label=3;case 3:return r?.refreshGoalValues?[4,this.scorecardService.expandGoalValues(n.id,!0)]:[3,5];case 4:Y.sent(),Y.label=5;case 5:return r?.refreshRollups&&n.parentId?[4,this.startRollupPolling(n.parentId,t,P)]:[3,7];case 6:Y.sent(),Y.label=7;case 7:return[4,null===(G=r?.onComplete)||void 0===G?void 0:G.call(r,P)];case 8:return Y.sent(),[3,10];case 9:return this.setGoalRefreshState(n.id,t,!1),[7];case 10:return[2]}})}),[2]}})})},i.prototype.refreshRollups=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a,s,c,u,p,v,P,x;return(0,w.__generator)(this,function(ue){switch(ue.label){case 0:if(!n.parentId||null!=n.valuesCategoryId)return[3,2];if(r=[],a=this.scorecardService.getCurrentScorecard(),!(s=q.getGoal(a.goals,n.parentId)))return[3,2];for(c=!1,u=!1,p=function(Ae){var xe=new Date(Ae.timestamp).getTime(),Be=_.find(n.goalValues,function(Je){return new Date(Je.timestamp).getTime()===xe});if(v.isPartOfParentGoalRollup(s.valueRollup,Ae)&&(c||(c=Be?.value!==Ae.value)),v.isPartOfParentGoalRollup(s.targetRollup,Ae)&&(u||(u=Be?.target!==Ae.target)),c&&u)return"break"},v=this,P=0,x=t;P<x.length&&"break"!==p(x[P]);P++);return c&&r.push(this.startRollupPolling(n.parentId,1)),u&&r.push(this.startRollupPolling(n.parentId,2)),_.some(r)?[4,Promise.all(r)]:[3,2];case 1:ue.sent(),ue.label=2;case 2:return[2]}})})},i.prototype.refreshRollupsAfterMove=function(n){var t;return(0,w.__awaiter)(this,void 0,void 0,function(){var r,s,c,u,p,v,P;return(0,w.__generator)(this,function(x){switch(x.label){case 0:return r=this.scorecardService.getCurrentScorecard(),null!=q.getGoal(r.goals,n.goalToMove.goalId).valuesCategoryId?[2]:(s=[],c=[],null!=n.goalToMove.currentParentId&&(s.push.apply(s,q.getGoalsWithRollups(r.goals,u=n.goalToMove.currentParentId,1)),c.push.apply(c,q.getGoalsWithRollups(r.goals,u,2))),null!=(null===(t=n.newParent)||void 0===t?void 0:t.goalId)&&(v=q.getGoalsWithRollups(r.goals,p=n.newParent.goalId,1),P=q.getGoalsWithRollups(r.goals,p,2),s=this.mergeParents(s,v),c=this.mergeParents(c,P)),[4,Promise.all([this.startRollupPollingForGoals(s,1),this.startRollupPollingForGoals(c,2)])]);case 1:return x.sent(),[2]}})})},i.prototype.refreshRollupsAfterGoalDelete=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a,s,p=this;return(0,w.__generator)(this,function(v){switch(v.label){case 0:return n.parentId&&null==n.valuesCategoryId?(t=this.scorecardService.getCurrentScorecard(),(r=q.getGoal(t.goals,n.parentId))?(a=[],s=[],_.isNil(r.valueRollup)||_.some(n.goalValues,function(P){return!_.isNil(P.value)&&p.isPartOfParentGoalRollup(r.valueRollup,P)})&&a.push.apply(a,q.getGoalsWithRollups(t.goals,r.id,1)),_.isNil(r.targetRollup)||_.some(n.goalValues,function(P){return!_.isNil(P.target)&&p.isPartOfParentGoalRollup(r.targetRollup,P)})&&s.push.apply(s,q.getGoalsWithRollups(t.goals,r.id,2)),[4,Promise.all([this.startRollupPollingForGoals(a,1),this.startRollupPollingForGoals(s,2)])]):[3,2]):[3,2];case 1:v.sent(),v.label=2;case 2:return[2]}})})},i.prototype.refreshRollupsAfterGoalValueDelete=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a,s,c;return(0,w.__generator)(this,function(v){switch(v.label){case 0:return n.parentId&&null==n.valuesCategoryId?(r=this.scorecardService.getCurrentScorecard(),(a=q.getGoal(r.goals,n.parentId))?(s=[],c=[],_.isNil(a.valueRollup)||!_.isNil(t.value)&&this.isPartOfParentGoalRollup(a.valueRollup,t)&&s.push.apply(s,q.getGoalsWithRollups(r.goals,a.id,1)),_.isNil(a.targetRollup)||!_.isNil(t.target)&&this.isPartOfParentGoalRollup(a.targetRollup,t)&&c.push.apply(c,q.getGoalsWithRollups(r.goals,a.id,2)),[4,Promise.all([this.startRollupPollingForGoals(s,1),this.startRollupPollingForGoals(c,2)])]):[3,2]):[3,2];case 1:v.sent(),v.label=2;case 2:return[2]}})})},i.prototype.isPartOfParentGoalRollup=function(n,t){return n&&(_.isNil(n.startDate)||new Date(t.timestamp).getTime()>=new Date(n.startDate).getTime())},i.prototype.startRollupPolling=function(n,t,r){return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s;return(0,w.__generator)(this,function(c){switch(c.label){case 0:return a=this.scorecardService.getCurrentScorecard(),s=q.getGoalsWithRollups(a.goals,n,t),[4,this.startRollupPollingForGoals(s,t,r)];case 1:return c.sent(),[2]}})})},i.prototype.startRollupPollingForGoals=function(n,t,r){return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s=this;return(0,w.__generator)(this,function(c){switch(c.label){case 0:return _.some(n)?(a=n.shift(),[4,this.startPollingAsync(a,t,{lastRefreshTimestamp:r,refreshGoal:!0,refreshGoalValues:!0,onComplete:function(p){return s.startRollupPollingForGoals(n,t,p)}})]):[3,2];case 1:c.sent(),c.label=2;case 2:return[2]}})})},i.prototype.getLastRefreshTimestamp=function(n,t){var r;return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s,c;return(0,w.__generator)(this,function(p){switch(p.label){case 0:return a=this.ConnectionTypeAsText[t],[4,this.scorecardService.getRefreshHistory(n)];case 1:return s=p.sent(),c=_.filter(s,function(v){return v.connectionType===t||v.connectionType===a}),[2,null===(r=_.maxBy(c,function(v){return v.timestamp}))||void 0===r?void 0:r.timestamp]}})})},i.prototype.mergeParents=function(n,t){if(!_.some(n))return t;var r=_.intersectionBy(n,t,function(u){return u.id});if(_.isEmpty(r))return(0,w.__spreadArray)((0,w.__spreadArray)([],n,!0),t,!0);for(var a=_.findIndex(t,function(u){return u.id===r[0].id}),s=[],c=0;c<a;c++)s.push(t[c]);return s.push.apply(s,n),s},i.prototype.setGoalRefreshState=function(n,t,r){this.scorecardService.setGoalRefreshState(n,t,r)},i}(),Ce=M(41114),we="PBI.Goal.ContextMenu.CreateAPowerAutomateFlow",dt=(Ce.cx[we]=(0,Ce.b1)(we),"PBI.Goal.TargetsEditor.Action.Opened"),Ue=Ce.cx[dt]=(0,Ce.b1)(dt),Dt="PBI.Goal.TargetsEditor.Action.Canceled",E=Ce.cx[Dt]=(0,Ce.b1)(Dt),Sn="PBI.Goal.TargetsEditor.Action.Done",xn=Ce.cx[Sn]=(0,Ce.b1)(Sn),on="PBI.Goal.ValuesEditor.Action.Opened",Lr=Ce.cx[on]=(0,Ce.b1)(on),er="PBI.Goal.ValuesEditor.Action.Canceled",Pe=Ce.cx[er]=(0,Ce.b1)(er),ti="PBI.Goal.ValuesEditor.Action.Done",yr=Ce.cx[ti]=(0,Ce.b1)(ti),br="PBI.ScorecardHeader.LabelInlineEdit",Bi=Ce.cx[br]=(0,Ce.b1)(br),Rn="PBI.ScorecardHeader.DescriptionInlineEdit",jn=Ce.cx[Rn]=(0,Ce.b1)(Rn),Yt=function(i){return i.Manual="Manual",i.Connect="Connect",i.Rollup="Rollup",i}({}),wr="PBI.WebScorecard.SaveCurrentValueSelection",ni=Ce.cx[wr]=(0,Ce.b1)(wr),tr="PBI.WebScorecard.SaveTargetValueSelection",sr=Ce.cx[tr]=(0,Ce.b1)(tr),lr="PBI.DatasetDetailsPage.GoalRollupsCoachmarkTriggered",cr=Ce.cx[lr]=(0,Ce.b1)(lr),vn="PBI.DatasetDetailsPage.GoalRollupsDetailsPaneCoachmarkTriggered",Gr=Ce.cx[vn]=(0,Ce.b1)(vn),nr="PBI.Scorecard.ChangeViewType",rr=Ce.cx[nr]=(0,Ce.b1)(nr),ht="PBI.Scorecard.Hierarchies.Builder.Open",Ke=Ce.cx[ht]=(0,Ce.b1)(ht),Zt=function(){function i(){}return i.getGoalValueMap=function(n){var t=new Map;if(_.isEmpty(n))return t;for(var r=0,a=n;r<a.length;r++){var s=a[r];t.set(new Date(s.timestamp).getTime(),s)}return t},i.areGoalValuesEqual=function(n,t,r,a){return b.fF.assertValue(n,"goalValueOne"),b.fF.assertValue(t,"goalValueTwo"),!(!r&&n.value!==t.value||!a&&n.target!==t.target||n.trend!==t.trend||n.forecast!==t.forecast||n.status!==t.status)},i.diffGoalValues=function(n,t){b.fF.assertValue(n,"goalValueOne"),b.fF.assertValue(t,"goalValueTwo");var r={timestamp:n.timestamp,goalId:n.goalId,scorecardId:n.scorecardId,createdTime:n.createdTime,lastModifiedTime:n.lastModifiedTime};return n.value!==t.value&&(r.value=n.value),n.target!==t.target&&(r.target=n.target),n.trend!==t.trend&&(r.trend=n.trend),n.forecast!==t.forecast&&(r.forecast=n.forecast),n.status!==t.status&&(r.status=n.status),r},i.calculateGoalValueChanges=function(n,t){for(var r=[],a=new Map,s=0,c=n;s<c.length;s++){var u=c[s],p=new Date(u.timestamp).getTime();a.set(p,u.value)}for(var v=0,P=t;v<P.length;v++)u=P[v],p=new Date(u.timestamp).getTime(),a.has(p)?u.value!==a.get(p)&&r.push(u):r.push(u);for(var x=new Set,G=0,Y=t;G<Y.length;G++)u=Y[G],p=new Date(u.timestamp).getTime(),x.add(p);for(var ue=0,Se=n;ue<Se.length;ue++)u=Se[ue],p=new Date(u.timestamp).getTime(),x.has(p)||r.push({timestamp:u.timestamp,value:null});return r},i}(),Wn=M(74076),Ye=new e.InjectionToken("GoalsHttpService"),ot=new e.InjectionToken("ScorecardHostService"),Cn=new e.InjectionToken("ScorecardSettingsService"),pn=M(10723),zn=M(50547),ur=M(43286),yt=M(85732),Ui=((0,yt.PH)("[Tab] Init"),(0,yt.PH)("[Tab] Noop"),(0,yt.PH)("[Tab] Setup Router Hook"),(0,yt.PH)("[Tab] Select Tab",(0,yt.Ky)())),ji=(0,yt.PH)("[Tab] Update Tab",(0,yt.Ky)()),Va=(0,yt.PH)("[Tab] Add Tabs After Refresh",(0,yt.Ky)()),Es=(0,yt.PH)("[Tab] Update Tab After Open",(0,yt.Ky)()),ko=(0,yt.PH)("[Tab] Remove Tab",(0,yt.Ky)()),ri=(0,yt.PH)("[Tab] Delete PBI Artifact In Tab",(0,yt.Ky)()),Wi=((0,yt.PH)("[Tab] Delete Trident Artifact In Tab",(0,yt.Ky)()),(0,yt.PH)("[Tab] Init Tab",(0,yt.Ky)())),$i=(0,yt.PH)("[Tab] Init Tab Success",(0,yt.Ky)()),Qi=(0,yt.PH)("[Tab] Init Tab Failure",(0,yt.Ky)()),Xi=(0,yt.PH)("[Tab] Close Tab",(0,yt.Ky)()),Ds=((0,yt.PH)("[Tab] Close Foreground Tab"),(0,yt.PH)("[Tab] Close Background Tab",(0,yt.Ky)()),(0,yt.PH)("[Tab] Destroy Tab",(0,yt.Ky)())),dr=(0,yt.PH)("[Tab] Destroy Tab Success",(0,yt.Ky)()),U=(0,yt.PH)("[Tab] Destroy Tab Failure",(0,yt.Ky)()),$n=(0,yt.PH)("[Tab] Delete",(0,yt.Ky)()),Fo=(0,yt.PH)("[Tab] Move Tab To Top",(0,yt.Ky)()),Yi=(0,yt.PH)("[Tab] Open Tab In Background",(0,yt.Ky)()),ks=(0,yt.PH)("[Tab] Execute Open Tab In Background",(0,yt.Ky)()),nn=(0,M(8894).H)({selectId:function(n){return n.id}}),Sr=(0,yt.ZF)("tab"),Fs=(0,yt.P1)(Sr,function(i){return nn.getSelectors().selectAll(i.tabs).filter(function(n){return"destroying"!==n.status})}),As=((0,yt.P1)(Sr,function(i){return i.selectedTabId?nn.getSelectors().selectEntities(i.tabs)[i.selectedTabId]:void 0}),function(){function i(n){this.store=n,this.tabs$=this.store.select(Fs)}return i.prototype.closeTab=function(n){this.store.dispatch(Xi({id:n}))},i.prototype.updateTab=function(n){var t=n.id,r=(0,w.__rest)(n,["id"]);this.store.dispatch(ji({id:t,changes:r}))},i.prototype.deletePBIArtifactInTab=function(n){this.store.dispatch(ri({id:n.id}))},i.prototype.moveTabToTop=function(n){this.store.dispatch(Fo({id:n}))},i.prototype.openInBackground=function(n,t){this.store.dispatch(Yi({urlPath:n,displayName:t}))},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(yt.yh))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}()),Tn=(M(94771),M(16559),M(35030),M(86668),M(73471),M(89082),M(41838),M(36012)),Ki=M(71477),Na=M(33827),Ln=M(25082),Hs={tabs:nn.getInitialState(),selectedTabId:void 0};function Vo(i,n){for(var t=0,r=Object.values(i.tabs.entities);t<r.length;t++){var a=r[t];a&&a.associatedArtifactObjectId===n.objectId&&a.title!==n.displayName&&(i.tabs=nn.updateOne({id:a.id,changes:{title:n.displayName}},i.tabs))}}(0,yt.Lq)(Hs,(0,Tn.P)(Ui,function(i,n){var t=n.id;t?i.tabs.entities[t]&&(i.selectedTabId=t):i.selectedTabId=void 0}),(0,Tn.P)(ji,function(i,n){var r=(0,w.__rest)(n,["type"]);i.tabs=nn.updateOne(r,i.tabs)}),(0,Tn.P)(Wi,function(i,n){var r=(0,w.__rest)(n,["type"]);i.tabs=nn.upsertOne((0,w.__assign)((0,w.__assign)({},r),{status:"initializing"}),i.tabs)}),(0,Tn.P)($i,function(i,n){i.tabs=nn.updateOne({id:n.id,changes:{status:"initialized",title:n.title,associatedArtifactObjectId:n.associatedArtifactObjectId}},i.tabs)}),(0,Tn.P)(Qi,function(i,n){i.tabs=nn.removeOne(n.id,i.tabs)}),(0,Tn.P)(Ds,function(i,n){i.tabs=nn.updateOne({id:n.id,changes:{status:"destroying"}},i.tabs)}),(0,Tn.P)(dr,U,ko,function(i,n){i.tabs=nn.removeOne(n.id,i.tabs)}),(0,Tn.P)(Na._t,function(i,n){for(var r=0,a=n.artifacts;r<a.length;r++)Vo(i,a[r])}),(0,Tn.P)(Ln.j$.RN,Ln.j$.aX,Ln.j$.wt,Ki.W2,Ki.C2,Ki.lK,function(i,n){Vo(i,n.artifact)}),(0,Tn.P)(Fo,function(i,n){for(var t=n.id,r=i.tabs.ids.slice(0),a=0;a<r.length;a++)if(r[a]===t){r.splice(a,1),r.push(t),i.tabs.ids=r;break}}),(0,Tn.P)($n,function(i,n){i.tabs=nn.removeOne(n.id,i.tabs)}),(0,Tn.P)(Va,function(i,n){var r=n.tabs.filter(function(a){return!i.tabs.ids.includes(a.id)}).map(function(a){return a.status="refreshed",a.dirty=!1,a});r.length>0&&(i.tabs=nn.addMany(r,i.tabs))}),(0,Tn.P)(ks,function(i,n){i.tabs.ids.includes(n.id)||(i.tabs=nn.addOne(n,i.tabs))}),(0,Tn.P)(Es,function(i,n){var r=(0,w.__rest)(n,["type"]);i.tabs=nn.updateOne(r,i.tabs)}));var nt=M(74466),ir=M(33554),Mn=M(59017),je=M(14172),Ao=M(68549),Jt=M(81905),Ut=M(58938),Ro=M(81213),ft=M(65181),Ha=M(79474),_n=M(9380),Lo=function(){function i(n,t){this.errorService=n,this.localizationService=t}return i.prototype.showUserError=function(n,t,r){var a;void 0===r&&(r="GenericErrorDescription"),this.errorService.error(this.localizationService.get(r),t,{requestId:n?.requestId,statusCode:null===(a=n?.status)||void 0===a?void 0:a.toString()})},i.prototype.showThrottlingError=function(){this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("You_Have_Exceeded_Limit_Try_Again_Later"),"throttling",{title:this.localizationService.get("Rate_Limit_Is_Exceeded"),level:zn.U.Information,isDismissable:!0,showAdditionalErrorInfo:!1})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Ro.T),e.\u0275\u0275inject(ft.o))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),eo=M(96608),et=function(){function i(n,t,r,a,s,c,u,p,v,P,x,G,Y){var Se,Ae,ue=this;this.goalsHttpService=n,this.userDetailsService=t,this.dialogService=r,this.errorService=a,this.localizationService=s,this.userInfo=c,this.featureSwitches=u,this.goalsErrorService=p,this.telemetryService=v,this.tabFacade=P,this.store=x,this.scorecardHost=G,this.scorecardSettings=Y,this.scorecard=void 0,this._scorecard$=new ir.t(1),this._selectedGoalIds$=this._scorecard$.pipe((0,je.U)(function(xe){return xe?.selectedGoalIds}),(0,I.x)(_.isEqual)),this._activeGoalId$=this._scorecard$.pipe((0,je.U)(function(xe){return xe?.activeGoalId}),(0,I.x)()),this.isEditMode$=new pe.X(!1),this.loading$=new pe.X(0),this._viewType$=new pe.X("List"),this._scorecardSelectionMode$=new pe.X(null),this.switchingHierarchyPath$=new pe.X(!1),this.linkedScorecardsById={},this._goalStatusesByScorecardId$=new pe.X({}),this.onHierarchyNotFound$=new Re.xQ,this.onDestroy$=new Re.xQ,this.requestId=0,this.pollingService=new Oe(this),this.scorecardHost&&(this.getSelectedGoalsObservable().pipe((0,ie.R)(this.onDestroy$)).subscribe(function(xe){ue.scorecardHost.onSelectGoals(xe)}),this._scorecard$.pipe((0,je.U)(function(xe){return xe.hierarchyPaths}),(0,I.x)(),(0,ie.R)(this.onDestroy$)).subscribe(function(xe){ue.scorecardHost.onChangeHierarchyPath(xe)})),this._scorecard$.pipe((0,I.x)(function(xe,Be){var Je,ut;return _.isEqual(null===(Je=xe?.goalStatuses)||void 0===Je?void 0:Je.statuses,null===(ut=Be?.goalStatuses)||void 0===ut?void 0:ut.statuses)&&xe?.linkedScorecards===Be?.linkedScorecards}),(0,je.U)(function(xe){return N.p.getGoalStatusesByScorecardId(xe)}),(0,ie.R)(this.onDestroy$)).subscribe(this._goalStatusesByScorecardId$),(0,Mn.aj)([this.isEditMode$,this.viewType$,null!==(Ae=null===(Se=this.scorecardSettings)||void 0===Se?void 0:Se.settings)&&void 0!==Ae?Ae:(0,ae.of)({})]).pipe((0,je.U)(function(xe){var Be=xe[0],Je=xe[1],ut=xe[2];return"tile"===ut?.displayMode?ue.featureSwitches.featureSwitches.multipleGoalTilesVisual?"multiple":"single":ut?.useMultiselectMode?"multiple":"List"===Je&&Be?"ctrl":null}),(0,I.x)(),(0,ie.R)(this.onDestroy$)).subscribe(this._scorecardSelectionMode$)}return i.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},i.prototype.loadScorecard=function(n,t,r,a){var s=this;if(q.isEditing(this.scorecard)&&!r)this.promptUserConfirmation({title:this.localizationService.get("MetricsUnsavedChangesTitle"),message:this.localizationService.get("MetricsUnsavedChangesDescription"),okButtonText:this.localizationService.get("Refresh"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(s,void 0,void 0,function(){return(0,w.__generator)(this,function(p){return[2,this.loadScorecard(n,t,!0,a)]})})}});else{this.loading$.next(this.loading$.value+1),this.requestId++;var c=this.requestId;this.goalsHttpService.getScorecard(n,t,!0,a).toPromise().then(function(u){s.loading$.next(s.loading$.value-1),!(c<s.requestId)&&(s.switchingHierarchyPath$.next(!1),s.setScorecardWithGoals(u))}).catch(function(u){if(s.loading$.next(s.loading$.value-1),!(c<s.requestId)){if(s.switchingHierarchyPath$.next(!1),_.isEmpty(a))s.scorecard=null;else if(s.goalsErrorService.showUserError(u,"LoadHierarchy","MetricsHierarchy_Loading_Error"),404===u?.status&&(s.setActiveHierarchy(void 0,!0),s.onHierarchyNotFound$.next(a),!s.scorecard))return;s.commit()}})}return this._scorecard$.asObservable()},i.prototype.setActiveHierarchy=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a=this;return(0,w.__generator)(this,function(s){switch(s.label){case 0:return r=function(u,p){return _.isEmpty(u)&&_.isEmpty(p)||_.isEqual(u,p)},this.scorecard&&!r(this.scorecard.hierarchyPaths,n)?q.isEditing(this.scorecard)&&!t?[2,this.promptUserConfirmation({title:this.localizationService.get("MetricsUnsavedChangesTitle"),message:this.localizationService.get("MetricsUnsavedChangesDescription"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(a,void 0,void 0,function(){return(0,w.__generator)(this,function(u){return[2,this.setActiveHierarchy(n,!0)]})})}})]:[3,1]:[3,3];case 1:return this.switchingHierarchyPath$.next(!0),[4,this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!0,n).pipe((0,Ao.o)(function(c){return!r(c.hierarchyPaths,n)},!0)).toPromise()];case 2:return[2,s.sent()];case 3:return[2]}})})},Object.defineProperty(i.prototype,"onHierarchyNotFound",{get:function(){return this.onHierarchyNotFound$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isHierarchicalScorecard",{get:function(){var t;return!_.isEmpty(null===(t=this.scorecard)||void 0===t?void 0:t.hierarchyPaths)},enumerable:!1,configurable:!0}),i.prototype.assertNoActivehierarchy=function(n){return void 0===n&&(n=!1),!this.isHierarchicalScorecard||(n?this.dialogService.showSimpleDialog(this.localizationService.get("Coming_Soon"),this.localizationService.get("MetricsHierarchy_ComingSoon")):b.fF.assertFail("Cannot perform this operation on a hierarchical scorecard. ".concat((new Error).stack)),!1)},Object.defineProperty(i.prototype,"hierarchyPaths$",{get:function(){return this._scorecard$.pipe((0,je.U)(function(t){return t?.hierarchyPaths}),(0,I.x)())},enumerable:!1,configurable:!0}),i.prototype.assertScorecardLoaded=function(n){return!(n.id!==this.scorecard.id||!_.isEqual(n.hierarchyPaths,this.scorecard.hierarchyPaths))||(b.fF.assertFail("Scorecard has changed. Active scorecard: ".concat(JSON.stringify(this.scorecard.hierarchyPaths),". Previous scorecard ").concat(JSON.stringify(n.hierarchyPaths))),!1)},i.prototype.isSwitchingHierarchyPath=function(){return this.switchingHierarchyPath$.asObservable()},i.prototype.saveGoal=function(n,t){var r,a,s,c,u,p;return(0,w.__awaiter)(this,void 0,void 0,function(){var v,P,x,G,Y,ue,Se,Ae=this;return(0,w.__generator)(this,function(xe){switch(xe.label){case 0:if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),v=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(v,"goal"),P=q.isGoalMetadataUpdated(v,t),!v.isNew&&!P)return[2,n];if(x=(null===(r=t.metadata)||void 0===r?void 0:r.showFinalTarget)!==(null===(a=v.metadata)||void 0===a?void 0:a.showFinalTarget)||(null===(s=t.metadata)||void 0===s?void 0:s.showPercentChange)!==(null===(c=v.metadata)||void 0===c?void 0:c.showPercentChange)||!_.isEqual(null!==(u=v.cycleMetadata)&&void 0!==u?u:{},null!==(p=t.cycleMetadata)&&void 0!==p?p:{}),!this.assertNoActivehierarchy(!0))return[2,n];xe.label=1;case 1:return xe.trys.push([1,9,,10]),G=this.scorecard,v.isNew?[4,this.goalsHttpService.createGoal(this.scorecard.groupId,this.scorecard.id,q.getGoalCreateRequest(t)).toPromise()]:[3,5];case 2:return Y=xe.sent(),t.metadata?[4,this.goalsHttpService.updateGoal(this.scorecard.groupId,this.scorecard.id,Y.id,{metadata:t.metadata}).toPromise()]:[3,4];case 3:Y=xe.sent(),xe.label=4;case 4:return[3,7];case 5:return P?[4,this.goalsHttpService.updateGoal(this.scorecard.groupId,this.scorecard.id,v.id,q.getGoalUpdateRequest(t)).toPromise()]:[3,7];case 6:Y=xe.sent(),xe.label=7;case 7:return this.assertScorecardLoaded(G)?[4,this.getOwnerDisplayNames(v)]:[2];case 8:return ue=xe.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(Be){var Je=q.getGoal(Be.goals,n);Ae.assignGoal(Je,Y),Je.isNew=!1,Je.ownerDisplayNames=ue}),n=Y.id,[3,10];case 9:throw Se=xe.sent(),this.goalsErrorService.showUserError(Se,"SaveGoalError"),Se;case 10:return x?[4,this.refreshGoal(n)]:[3,12];case 11:return xe.sent(),[3,13];case 12:this.commit(),xe.label=13;case 13:return[2,n]}})})},i.prototype.moveGoal=function(n,t,r){var a;return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u,p,x,G;return(0,w.__generator)(this,function(Y){switch(Y.label){case 0:return b.fF.assertValue(this.scorecard,"No scorecard loaded"),b.fF.assertValue(this.scorecard.goals,"Scorecard should have at least one goal to move"),this.assertNoActivehierarchy()?(s=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(s,"Source goal does not exist"),c=q.computeGoalHeight(s),u=r?q.getGoal(this.scorecard.goals,r):void 0,b.fF.assertValue(!r||u,"Destination parent goal does not exist"),p=u?q.computeGoalLevel(this.scorecard.goals,u):void 0,(_.isNil(p)?c:c+p+1)>W.gT.MaxSubGoals?[4,this.dialogService.showSimpleInfoDialog({title:this.localizationService.get("MetricCannotBeMovedTitle"),message:this.localizationService.format("MetricCannotBeMovedMessage",W.gT.MaxSubGoals)},{autoFocus:!0}).afterClosed().toPromise()]:[3,2]):[2];case 1:return Y.sent(),[2];case 2:x={goalToMove:{goalId:n}},this.scorecard=(0,nt.Uy)(this.scorecard,function(ue){var Se,Ae,xe,Be,Je=q.getGoal(ue.goals,n);x.goalToMove.currentParentId=null!==(Se=Je.parentId)&&void 0!==Se?Se:void 0;var ut=Je.parentId?q.getGoal(ue.goals,Je.parentId):void 0;Je.parentId&&!ut||_.remove(Je.parentId?ut.subGoals:ue.goals,function(xt){return xt.id===Je.id});var mt=r?q.getGoal(ue.goals,r):void 0;mt&&(x.newParent={goalId:mt.id,currentParentId:null!==(Ae=mt.parentId)&&void 0!==Ae?Ae:void 0});var bt=mt?mt.subGoals:ue.goals;if(bt){var z=t?bt.findIndex(function(xt){return xt.id===t}):bt.length;b.fF.assertValue(-1!==z,"Destination next goal does not exist");var fe=z-1>=0?bt[z-1]:void 0;fe&&(x.newPrevious={goalId:fe.id,currentParentId:null!==(xe=fe.parentId)&&void 0!==xe?xe:void 0});var Me=z<bt.length?bt[z]:void 0;b.fF.assertValue(!Me||Me.parentId===r,"Destination next goal parent should be the same as the destination parent goal"),Me&&(x.newNext={goalId:Me.id,currentParentId:null!==(Be=Me.parentId)&&void 0!==Be?Be:void 0}),bt.splice(z,0,Je);var at=0;bt.forEach(function(xt){xt.rank=at,at++})}else Je.rank=0,mt.subGoals=[Je];return Je.parentId=r,Je.state="Saving",ue}),this.loading$.next(this.loading$.value+1),this.commit(),Y.label=3;case 3:return Y.trys.push([3,6,10,11]),[4,this.pollingService.refreshRollupsAfterMove(x)];case 4:return Y.sent(),[4,this.goalsHttpService.moveGoal(this.scorecard.groupId,this.scorecard.id,x).toPromise()];case 5:return Y.sent(),this.setGoalState(n,"Consumption"),[3,11];case 6:return G=Y.sent(),(null===(a=G?.error)||void 0===a?void 0:a.code)!==le.CircularRelationshipsNotAllowed?[3,8]:[4,this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!0)];case 7:return Y.sent(),this.dialogService.showSimpleDialog(this.localizationService.get("Unable_to_move_metric"),this.localizationService.get("Metrics_Circular_Relationships_Not_Allowed")),[3,9];case 8:throw this.goalsErrorService.showUserError(G,"MoveGoalError"),G;case 9:return[3,11];case 10:return this.loading$.next(this.loading$.value-1),[7];case 11:return[2]}})})},i.prototype.refreshGoal=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a,s,c=this;return(0,w.__generator)(this,function(u){switch(u.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),u.label=1;case 1:return u.trys.push([1,4,,5]),t=this.scorecard,[4,this.goalsHttpService.getGoal(this.scorecard.groupId,this.scorecard.id,n,!1,this.scorecard.hierarchyPaths).toPromise()];case 2:return r=u.sent(),this.assertScorecardLoaded(t)?[4,this.getOwnerDisplayNames(r)]:[2];case 3:return a=u.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(p){var v=q.getGoal(p.goals,n);c.assignGoal(v,r),v.ownerDisplayNames=a}),[3,5];case 4:throw s=u.sent(),this.goalsErrorService.showUserError(s,"RefreshGoalError"),s;case 5:return this.commit(),[2]}})})},i.prototype.saveGoalValue=function(n,t){var r,a;return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u,p,v,P;return(0,w.__generator)(this,function(x){switch(x.label){case 0:return b.fF.assertValue(this.scorecard,"No scorecard loaded"),[4,this.expandGoalValues(n)];case 1:x.sent(),s=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(s,"goal"),c=_.find(s.goalValues,function(G){return new Date(G.timestamp).getTime()===new Date(t.timestamp).getTime()}),b.fF.assert(function(){return!s.valueConnection||_.isNil(t.value)},"Value cannot be updated when it is connected to data"),b.fF.assert(function(){return!s.targetConnection||_.isNil(t.target)},"Target cannot be updated when it is connected to data"),s.hasStatusRules&&(t.status=null),x.label=2;case 2:return x.trys.push([2,9,15,16]),this.loading$.next(this.loading$.value+1),[4,this.pollingService.refreshRollups(s,[t])];case 3:return x.sent(),u=this.scorecard,c?[4,this.goalsHttpService.updateGoalValue(this.scorecard.groupId,this.scorecard.id,n,new Date(t.timestamp).toISOString(),q.getGoalValueUpdateRequest(t),this.scorecard.hierarchyPaths).toPromise()]:[3,5];case 4:return p=x.sent(),this.assertScorecardLoaded(u)?(this.scorecard=(0,nt.Uy)(this.scorecard,function(G){var Y=q.getGoal(G.goals,n);b.fF.assertValue(Y,"Goal not found");var ue=_.find(Y.goalValues,function(Se){return new Date(Se.timestamp).getTime()===new Date(p.timestamp).getTime()});b.fF.assertValue(ue,"Goal value not found"),Object.assign(ue,p)}),[3,7]):[2];case 5:return[4,this.goalsHttpService.createGoalValue(this.scorecard.groupId,this.scorecard.id,n,q.getGoalValueCreateRequest(t),this.scorecard.hierarchyPaths).toPromise()];case 6:if(v=x.sent(),!this.assertScorecardLoaded(u))return[2];this.scorecard=(0,nt.Uy)(this.scorecard,function(G){var Y=q.getGoal(G.goals,n);b.fF.assertValue(Y,"Goal not found"),Y.goalValues?Y.goalValues.push(v):Y.goalValues=[v]}),x.label=7;case 7:return[4,this.refreshGoal(n)];case 8:return x.sent(),[3,16];case 9:if(P=x.sent(),(null===(r=P?.error)||void 0===r?void 0:r.code)!==le.ManuallyUpdatingConnectedGoalValueNotAllowed&&(null===(a=P?.error)||void 0===a?void 0:a.code)!==le.ManuallyUpdatingConnectedMetricValueNotAllowed)return[3,10];throw this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("Updating_Connected_MetricValue_Not_Allowed"),"Not_Allowed",{title:this.localizationService.get("Operation_Not_Allowed"),level:zn.U.Information,isDismissable:!0,showAdditionalErrorInfo:!1}),P;case 10:return c||409!==P?.status?[3,13]:(this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("Metrics_Existing_Checkin_Found"),"Checkin_Exists",{title:this.localizationService.get("Metrics_Existing_Checkin_Found_Title"),level:zn.U.Information,isDismissable:!0,showAdditionalErrorInfo:!1,hideGetHelpLink:!0}),[4,this.refreshGoal(n)]);case 11:return x.sent(),[4,this.expandGoalValues(n,!0)];case 12:return x.sent(),[3,14];case 13:throw this.goalsErrorService.showUserError(P,"SaveGoalValueError"),P;case 14:return[3,16];case 15:return this.loading$.next(this.loading$.value-1),[7];case 16:return this.commit(),[2]}})})},i.prototype.expandGoalValues=function(n,t){return void 0===t&&(t=!1),(0,w.__awaiter)(this,void 0,void 0,function(){var r,a,s,c;return(0,w.__generator)(this,function(u){switch(u.label){case 0:if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.isSample)return[2];if(r=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(r,"goal"),!r||r.isExpanded&&!t)return[2];u.label=1;case 1:return u.trys.push([1,3,4,5]),this.loading$.next(this.loading$.value+1),a=this.scorecard,[4,this.goalsHttpService.getGoalValues(this.scorecard.groupId,this.scorecard.id,r.id,!0,this.scorecard.hierarchyPaths).toPromise()];case 2:return s=u.sent(),this.assertScorecardLoaded(a)?(this.scorecard=(0,nt.Uy)(this.scorecard,function(p){var v=q.getGoal(p.goals,n);b.fF.assertValue(v,"goal"),v.goalValues=s,v.isExpanded=!0}),this.commit(),[3,5]):[2];case 3:throw c=u.sent(),this.goalsErrorService.showUserError(c,"ExpandGoalValues"),c;case 4:return this.loading$.next(this.loading$.value-1),[7];case 5:return[2]}})})},i.prototype.upsertGoalValues=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a,s;return(0,w.__generator)(this,function(c){switch(c.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];r=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(r,"goal"),c.label=1;case 1:return c.trys.push([1,5,6,7]),this.loading$.next(this.loading$.value+1),[4,this.pollingService.refreshRollups(r,t)];case 2:return c.sent(),[4,this.goalsHttpService.upsertGoalValues(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 3:return a=c.sent(),[4,this.refreshGoal(n)];case 4:return c.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(u){var p=q.getGoal(u.goals,n);p.goalValues=a,p.isExpanded=!0}),this.commit(),[3,7];case 5:throw s=c.sent(),this.goalsErrorService.showUserError(s,"UpsertGoalValues"),s;case 6:return this.loading$.next(this.loading$.value-1),[7];case 7:return[2]}})})},i.prototype.overwriteMultipleGoalValues=function(n,t){var r,a;return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u,p,v;return(0,w.__generator)(this,function(P){switch(P.label){case 0:return this.assertNoActivehierarchy(!0)?[4,this.expandGoalValues(n)]:[2];case 1:return P.sent(),c=q.getGoal(this.scorecard.goals,n),u=null!==(a=null===(r=c.goalValues)||void 0===r?void 0:r.filter(function(x){return!_.isNil(x.value)}).map(function(x){return{timestamp:x.timestamp,value:x.value}}))&&void 0!==a?a:[],p=t.map(function(x){return{timestamp:x.timestamp,value:x.value}}),(s=Zt.calculateGoalValueChanges(u,p)).length>0?(v=s.map(function(x){return{timestamp:x.timestamp,value:x.value}}),[4,this.upsertGoalValues(n,v)]):[3,3];case 2:P.sent(),P.label=3;case 3:return[2]}})})},i.prototype.overwriteGoalTargets=function(n,t){var r,a;return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u,p,v;return(0,w.__generator)(this,function(P){switch(P.label){case 0:return this.assertNoActivehierarchy(!0)?[4,this.expandGoalValues(n)]:[2];case 1:return P.sent(),s=q.getGoal(this.scorecard.goals,n),c=null!==(a=null===(r=s.goalValues)||void 0===r?void 0:r.filter(function(x){return!_.isNil(x.target)}).map(function(x){return{timestamp:x.timestamp,value:x.target}}))&&void 0!==a?a:[],u=t.map(function(x){return{timestamp:x.timestamp,value:x.target}}),(p=Zt.calculateGoalValueChanges(c,u)).length>0?(v=p.map(function(x){return{timestamp:x.timestamp,target:x.value}}),[4,this.upsertGoalValues(n,v)]):[3,3];case 2:P.sent(),P.label=3;case 3:return[2]}})})},i.prototype.followGoal=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t;return(0,w.__generator)(this,function(r){switch(r.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];if(q.isSampleScorecard(this.scorecard))return[2];b.fF.assertValue(this.scorecard,"No scorecard loaded"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.goalsHttpService.followGoal(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return r.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(a){var s=q.getGoal(a.goals,n);b.fF.assertValue(s,"Goal not found"),s.isFollowed=!0}),this.commit(),[3,4];case 3:throw t=r.sent(),this.goalsErrorService.showUserError(t,"Follow Metric Error"),t;case 4:return[2]}})})},i.prototype.unfollowGoal=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t;return(0,w.__generator)(this,function(r){switch(r.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];if(q.isSampleScorecard(this.scorecard))return[2];b.fF.assertValue(this.scorecard,"No scorecard loaded"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.goalsHttpService.unfollowGoal(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return r.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(a){var s=q.getGoal(a.goals,n);b.fF.assertValue(s,"Goal not found"),s.isFollowed=!1}),this.commit(),[3,4];case 3:throw t=r.sent(),this.goalsErrorService.showUserError(t,"Unfollow Metric Error"),t;case 4:return[2]}})})},i.prototype.editNote=function(n,t,r,a){return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u;return(0,w.__generator)(this,function(p){switch(p.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),p.label=1;case 1:return p.trys.push([1,3,,4]),s=this.scorecard,[4,this.goalsHttpService.editNote(this.scorecard.groupId,this.scorecard.id,n,r,t,a,this.scorecard.hierarchyPaths).toPromise()];case 2:return c=p.sent(),this.assertScorecardLoaded(s)?(this.scorecard=(0,nt.Uy)(this.scorecard,function(v){var P=q.getGoal(v.goals,n);b.fF.assertValue(P,"Goal not found");var x=_.find(P.goalValues,function(Y){return new Date(Y.timestamp).getTime()===new Date(t).getTime()});if(b.fF.assertValue(x,"Goal value not found"),!_.isEmpty(x)){var G=x.notes.findIndex(function(Y){return Y.id===r});b.fF.assertValue(x.notes,"Goal note not found"),x.notes[G]=c}}),this.commit(),[3,4]):[2];case 3:throw u=p.sent(),this.goalsErrorService.showUserError(u,"EditGoalNoteError"),u;case 4:return[2]}})})},i.prototype.insertNote=function(n,t,r){return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s,c;return(0,w.__generator)(this,function(u){switch(u.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),u.label=1;case 1:return u.trys.push([1,3,,4]),a=this.scorecard,[4,this.goalsHttpService.insertNote(this.scorecard.groupId,this.scorecard.id,n,t,r,this.scorecard.hierarchyPaths).toPromise()];case 2:return s=u.sent(),this.assertScorecardLoaded(a)?(this.scorecard=(0,nt.Uy)(this.scorecard,function(p){var v=q.getGoal(p.goals,n);b.fF.assertValue(v,"Goal not found");var P=_.find(v.goalValues,function(x){return new Date(x.timestamp).getTime()===new Date(t).getTime()});b.fF.assertValue(P,"Goal value not found"),v.notesCount=_.isFinite(v.notesCount)?v.notesCount+1:1,P.notes=(0,w.__spreadArray)((0,w.__spreadArray)([],P.notes||[],!0),[s],!1)}),this.commit(),[3,4]):[2];case 3:throw c=u.sent(),this.goalsErrorService.showUserError(c,"InsertGoalNoteError"),c;case 4:return[2]}})})},i.prototype.getGoal=function(n){return b.fF.assertValue(this.scorecard,"No scorecard loaded"),this._scorecard$.pipe((0,je.U)(function(t){return q.getGoal(t.goals,n)}),(0,I.x)())},i.prototype.getGoals=function(){return b.fF.assertValue(this.scorecard,"No scorecard loaded"),this._scorecard$.pipe((0,je.U)(function(n){return n.goals}))},i.prototype.getActiveGoal=function(){var n=this;return this._activeGoalId$.pipe((0,Jt.w)(function(t){return t?n.getGoal(t):(0,ae.of)(void 0)}))},i.prototype.getActiveGoalId=function(){return this._activeGoalId$},i.prototype.deleteNote=function(n){var t=this;return this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_Note_Title"),message:this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone"),panelClass:["updateDeleteNoteConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(t,void 0,void 0,function(){return(0,w.__generator)(this,function(a){switch(a.label){case 0:return[4,this.deleteNoteRequest(n)];case 1:return a.sent(),[2,!0]}})})}})},i.prototype.deleteNoteRequest=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),t=this.scorecard,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteNote(this.scorecard.groupId,this.scorecard.id,n.goalId,n.id,n.valueTimestamp,this.scorecard.hierarchyPaths).toPromise()];case 2:return a.sent(),[3,4];case 3:if(r=a.sent(),404!==r?.status)throw this.goalsErrorService.showUserError(r,"DeleteGoalNoteError"),r;return[3,4];case 4:return this.assertScorecardLoaded(t)?(this.scorecard=(0,nt.Uy)(this.scorecard,function(s){var c=q.getGoal(s.goals,n.goalId);if(b.fF.assertValue(c,"Goal not found"),!_.isEmpty(c.goalValues)){var u=_.find(c.goalValues,function(p){return new Date(p.timestamp).getTime()===new Date(n.valueTimestamp).getTime()});u.notes=_.filter(u.notes,function(p){return p.id!==n.id})}c.notesCount=null==c.notesCount?0:c.notesCount-1}),this.commit(),[2]):[2]}})})},i.prototype.deleteGoal=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a,s,c=this;return(0,w.__generator)(this,function(u){switch(u.label){case 0:return this.assertNoActivehierarchy()?[4,this.getGoal(n).pipe((0,he.q)(1)).toPromise()]:[2];case 1:return t=u.sent(),r=!_.isEmpty(t.subGoals),a=this.localizationService.get(t.isLinked?r?"ScorecardDialog_Delete_Metric_Title_Linked":"ScorecardDialog_Delete_Metric_Title_Linked_Submetrics":r?"ScorecardDialog_Delete_Metric_Title":"ScorecardDialog_Delete_Metric_Title_Submetrics"),s=t.isLinked?this.localizationService.get("ScorecardDialog_Delete_Metric_Message_Linked")+(r?this.localizationService.get("ScorecardDialog_Delete_Metric_Message_Linked_Submetrics"):""):this.localizationService.get("ScorecardDialog_Delete_Metric_Message_First_Line"),[2,this.promptUserConfirmation({title:a,message:s,panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(c,void 0,void 0,function(){return(0,w.__generator)(this,function(v){switch(v.label){case 0:return[4,this.pollingService.refreshRollupsAfterGoalDelete(t)];case 1:return v.sent(),[4,this.deleteGoalRequest(n)];case 2:return v.sent(),[2,!0]}})})}})]}})})},i.prototype.applySortAndFilter=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return this.scorecard?[4,this.ensureUsersLoaded()]:[2];case 1:return a.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(s){s.goals=B.sortAndFilter(s.goals,n,r._goalStatusesByScorecardId$.value,t)}),this.commit(),[2]}})})},i.prototype.deleteGoalRequest=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:if(!this.assertNoActivehierarchy())return[2];if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),t=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(t,"Goal not found"),t.isNew)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),this.setGoalState(n,"Deleting"),[4,this.goalsHttpService.deleteGoal(this.scorecard.groupId,this.scorecard.id,t.id).toPromise()];case 2:return a.sent(),[3,4];case 3:if(r=a.sent(),404!==r?.status)throw this.goalsErrorService.showUserError(r,"DeleteGoalError"),this.setGoalState(n,"Consumption"),r;return[3,4];case 4:return this.scorecard=(0,nt.Uy)(this.scorecard,function(s){var c=q.getGoal(s.goals,t.parentId);c?.subGoals?c.subGoals=c.subGoals.filter(function(u){return u.id!==n}):s.goals&&(s.goals=s.goals.filter(function(u){return u.id!==n}))}),this.commit(),[2]}})})},i.prototype.deleteGoalValue=function(n){var t=this;return this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_CheckIn_Message_title"),message:"".concat(this.localizationService.get("ScorecardDialog_Delete_CheckIn_Message_First_Line"),"\n\n            ").concat(this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone")),panelClass:["updateDeleteCheckInConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(t,void 0,void 0,function(){var a;return(0,w.__generator)(this,function(s){switch(s.label){case 0:return[4,this.getGoal(n.goalId).pipe((0,he.q)(1)).toPromise()];case 1:return a=s.sent(),[4,this.pollingService.refreshRollupsAfterGoalValueDelete(a,n)];case 2:return s.sent(),[4,this.deleteGoalValueRequest(n)];case 3:return s.sent(),[2,!0]}})})}})},i.prototype.deleteGoalValueRequest=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),t=this.scorecard,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteGoalValue(this.scorecard.groupId,this.scorecard.id,n.goalId,n.timestamp,this.scorecard.hierarchyPaths).toPromise()];case 2:return a.sent(),[3,4];case 3:if(r=a.sent(),404!==r?.status)throw this.goalsErrorService.showUserError(r,"DeleteGoalValueError"),r;return[3,4];case 4:return this.assertScorecardLoaded(t)?(this.scorecard=(0,nt.Uy)(this.scorecard,function(s){var c=q.getGoal(s.goals,n.goalId);b.fF.assertValue(c,"Goal not found"),c.goalValues=_.filter(c.goalValues,function(u){return u.timestamp!==n.timestamp})}),[4,this.refreshGoal(n.goalId)]):[2];case 5:return a.sent(),this.commit(),[2]}})})},i.prototype.updateGoalQueryConnection=function(n,t,r){return(0,w.__awaiter)(this,void 0,void 0,function(){var a,c,u,p=this;return(0,w.__generator)(this,function(v){switch(v.label){case 0:if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),a=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(a,"goal"),q.compareGoalQueryConnections(1===t?a.valueConnection:a.targetConnection,r))return[2];if(!this.assertNoActivehierarchy())return[2];v.label=1;case 1:return v.trys.push([1,4,,5]),[4,this.pollingService.startPollingAsync(a,t,{refreshGoal:!0,refreshGoalValues:!0,refreshRollups:!0})];case 2:return v.sent(),[4,this.goalsHttpService.updateGoalQueryConnection(this.scorecard.groupId,this.scorecard.id,n,t,(0,w.__assign)((0,w.__assign)({},r),{userId:this.userInfo.uoid})).toPromise()];case 3:return c=v.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(P){a=q.getGoal(P.goals,n),p.assignGoal(a,c)}),this.commit(),[3,5];case 4:throw u=v.sent(),this.goalsErrorService.showUserError(u,"UpdateGoalQueryConnectionError"),u;case 5:return[2]}})})},i.prototype.deleteGoalQueryConnection=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,w.__generator)(this,function(a){return this.assertNoActivehierarchy()?[2,this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_Metric_Query_Connection_Title"),message:"".concat(this.localizationService.format("ScorecardDialog_Delete_Metric_Query_Connection_Message_Line_1",[this.localizationService.get(1===t?"CurrentValue":"Target")]),"\n\n            ").concat(this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone")),onConfirmation:function(){return(0,w.__awaiter)(r,void 0,void 0,function(){var c,u,p=this;return(0,w.__generator)(this,function(v){switch(v.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),v.label=1;case 1:return v.trys.push([1,5,,6]),[4,this.goalsHttpService.deleteGoalQueryConnection(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 2:return c=v.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(P){var x=q.getGoal(P.goals,n);if(!x)throw"Goal not found";x.valueConnection=c.valueConnection,x.targetConnection=c.targetConnection,p.assignGoal(x,c)}),[4,this.refreshGoal(n)];case 3:return v.sent(),[4,this.expandGoalValues(n)];case 4:return v.sent(),this.commit(),[3,6];case 5:throw u=v.sent(),this.goalsErrorService.showUserError(u,"DeleteGoalQueryConnectionError"),u;case 6:return[2,!0]}})})}})]:[2]})})},i.prototype.takeOverGoalQueryConnection=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,w.__generator)(this,function(a){return this.assertNoActivehierarchy()?[2,this.promptUserConfirmation({title:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Confirmation_Title"),message:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Confirmation"),okButtonText:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver"),onConfirmation:function(){return(0,w.__awaiter)(r,void 0,void 0,function(){var c,u,p=this;return(0,w.__generator)(this,function(v){switch(v.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,this.goalsHttpService.takeOverGoalQueryConnection(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 2:return c=v.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(P){var x=q.getGoal(P.goals,n);p.assignGoal(x,c)}),this.commit(),[3,4];case 3:if(u=v.sent(),400!==u?.status)throw this.goalsErrorService.showUserError(u,"TakeOverGoalQueryConnectionError"),u;return this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Error"),"TakeOverGoalQueryConnectionError",{title:this.localizationService.get("MetricsDetailsPane_ConnectionsTab_TakeOver_Error_Title"),level:zn.U.Information}),[3,4];case 4:return[2]}})})}})]:[2]})})},i.prototype.getRefreshHistory=function(n){var t;return(0,w.__awaiter)(this,void 0,void 0,function(){var a;return(0,w.__generator)(this,function(s){switch(s.label){case 0:if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.isSample)return[2,[]];if(!q.getGoal(null===(t=this.scorecard)||void 0===t?void 0:t.goals,n))return b.fF.assertFail("goal"),[2];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.goalsHttpService.getRefreshHistory(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return[2,s.sent()];case 3:throw a=s.sent(),this.goalsErrorService.showUserError(a,"GetRefreshHistoryError"),a;case 4:return[2]}})})},i.prototype.refreshGoalValue=function(n,t){var r;return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s;return(0,w.__generator)(this,function(c){switch(c.label){case 0:if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),!(a=q.getGoal(null===(r=this.scorecard)||void 0===r?void 0:r.goals,n)))return b.fF.assertFail("goal"),[2];if(1===t&&!a.valueConnection||2===t&&!a.targetConnection)return[2];c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.pollingService.startPollingAsync(a,t,{refreshGoal:!0,refreshGoalValues:!0,refreshRollups:!0})];case 2:return c.sent(),[4,this.goalsHttpService.refreshGoalValue(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 3:return c.sent(),this.showRefreshConfirmation(),[3,5];case 4:if(s=c.sent(),429===s?.status)return this.goalsErrorService.showThrottlingError(),this.setGoalRefreshState(n,t,!1),[2];throw this.goalsErrorService.showUserError(s,"RefreshGoalValue"),s;case 5:return[2]}})})},i.prototype.upsertGoalValueRollup=function(n,t,r){return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s,c,u,v,P=this;return(0,w.__generator)(this,function(x){switch(x.label){case 0:if(!this.assertNoActivehierarchy())return[2];b.fF.assertValue(this.scorecard,"No scorecard loaded"),a=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(a,"goal"),x.label=1;case 1:return x.trys.push([1,10,,11]),c=void 0,u=ne.E.getCurrentLocalDay(),_.isEmpty(a.subGoals)?[3,3]:[4,this.pollingService.startPollingAsync(a,t,{refreshGoal:!0,refreshGoalValues:!0,refreshRollups:!0})];case 2:x.sent(),x.label=3;case 3:switch(c=ke.r.hasHistoricalGoalValue(a.goalValues,t)?{rollupType:r,startDate:u.toISOString()}:{rollupType:r},t){case 1:return[3,4];case 2:return[3,6]}return[3,8];case 4:return[4,this.goalsHttpService.upsertGoalCurrentValueRollup(this.scorecard.groupId,this.scorecard.id,n,c).toPromise()];case 5:return s=x.sent(),[3,9];case 6:return[4,this.goalsHttpService.upsertGoalTargetValueRollup(this.scorecard.groupId,this.scorecard.id,n,c).toPromise()];case 7:return s=x.sent(),[3,9];case 8:b.fF.assertNever(t),x.label=9;case 9:return this.scorecard=(0,nt.Uy)(this.scorecard,function(G){a=q.getGoal(G.goals,n),P.assignGoal(a,s)}),this.commit(),[3,11];case 10:throw v=x.sent(),this.goalsErrorService.showUserError(v,"upsertGoalValueRollupError"),v;case 11:return[2]}})})},i.prototype.deleteGoalValueRollup=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a,c,u=this;return(0,w.__generator)(this,function(p){switch(p.label){case 0:if(!this.assertNoActivehierarchy())return[2];b.fF.assertValue(this.scorecard,"No scorecard loaded"),r=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(r,"goal"),p.label=1;case 1:switch(p.trys.push([1,8,,9]),t){case 1:return[3,2];case 2:return[3,4]}return[3,6];case 2:return[4,this.goalsHttpService.deleteGoalCurrentValueRollup(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 3:return a=p.sent(),[3,7];case 4:return[4,this.goalsHttpService.deleteGoalTargetValueRollup(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 5:return a=p.sent(),[3,7];case 6:b.fF.assertNever(t),p.label=7;case 7:return this.scorecard=(0,nt.Uy)(this.scorecard,function(v){(r=q.getGoal(v.goals,n)).valueRollup=a.valueRollup,r.targetRollup=a.targetRollup,u.assignGoal(r,a)}),this.commit(),[3,9];case 8:throw c=p.sent(),this.goalsErrorService.showUserError(c,"deleteGoalValueRollupError"),c;case 9:return[2]}})})},i.prototype.getStatusRules=function(n){var t;return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a;return(0,w.__generator)(this,function(s){switch(s.label){case 0:if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.isSample)return[2,null];if(!(r=q.getGoal(null===(t=this.scorecard)||void 0===t?void 0:t.goals,n)))return b.fF.assertFail("goal"),[2];if(!r.hasStatusRules)return[2,null];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.goalsHttpService.getGoalStatusRules(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return[2,s.sent()];case 3:throw a=s.sent(),this.goalsErrorService.showUserError(a,"GetStatusRulesError"),a;case 4:return[2]}})})},i.prototype.saveStatusRules=function(n,t){var r,a,s,c;return(0,w.__awaiter)(this,void 0,void 0,function(){var u,p,v,P;return(0,w.__generator)(this,function(x){switch(x.label){case 0:return this.assertNoActivehierarchy()?(b.fF.assertValue(this.scorecard,"No scorecard loaded"),(u=q.getGoal(null===(r=this.scorecard)||void 0===r?void 0:r.goals,n))?!t||_.isEmpty(t.rules)?u.hasStatusRules?[4,this.goalsHttpService.deleteGoalStatusRules(this.scorecard.groupId,this.scorecard.id,n).toPromise()]:[3,4]:[3,5]:(b.fF.assertFail("goal"),[2])):[2,t];case 1:return x.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(G){(u=q.getGoal(G.goals,n)).hasStatusRules=!1}),this.commit(),[4,this.refreshGoal(n)];case 2:return x.sent(),[4,this.expandGoalValues(n,!0)];case 3:x.sent(),x.label=4;case 4:return[2];case 5:return x.trys.push([5,9,,10]),p=q.getGoalStatusRulesUpdateRequest(t),[4,this.goalsHttpService.upsertGoalStatusRules(this.scorecard.groupId,this.scorecard.id,n,p).toPromise()];case 6:return v=x.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(G){(u=q.getGoal(G.goals,n)).hasStatusRules=!0}),this.commit(),[4,this.refreshGoal(n)];case 7:return x.sent(),[4,this.expandGoalValues(n,!0)];case 8:return x.sent(),[2,v];case 9:throw P=x.sent(),400===P?.status?this.errorService.errorNoDefaultAdditionalErrorInfo(this.localizationService.get("MetricsDetailsPane_StatusRulesTab_SaveRulesError_Description"),"GetStatusRulesError",{title:this.localizationService.get("MetricsDetailsPane_StatusRulesTab_SaveRulesError"),level:zn.U.Information,isDismissable:!0,showAdditionalErrorInfo:!0,errorDetails:null===(c=null===(s=null===(a=P?.error)||void 0===a?void 0:a.details)||void 0===s?void 0:s[0])||void 0===c?void 0:c.message}):this.goalsErrorService.showUserError(P,"GetStatusRulesError"),P;case 10:return[2]}})})},i.prototype.loadPrefetchedScorecard=function(n){return this.setScorecardWithGoals(n),this._scorecard$.asObservable()},i.prototype.addGoal=function(){var n=this;if(this.assertNoActivehierarchy()){b.fF.assertValue(this.scorecard,"No scorecard loaded"),b.fF.assert(function(){return n.userHasWritePermissions()},"has write permissions");var t=q.getCurrentUser(),r=q.createNewGoal(t,this.scorecard.id);return this.scorecard=(0,nt.Uy)(this.scorecard,function(a){if(a.goals?a.goals.push(r):a.goals=[r],-1!==a.goals.findIndex(function(u){return!_.isNil(u.rank)})){var c=0;a.goals.forEach(function(u){u.rank=c,c++})}}),this.commit(),r.id}},i.prototype.addSubGoal=function(n,t){var r=this;void 0===t&&(t=!0),this.assertNoActivehierarchy()&&(b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,nt.Uy)(this.scorecard,function(a){var s=q.getGoal(a.goals,n);b.fF.assertValue(s,"Parent goal not found");var c=q.getCurrentUser(),u=q.createNewGoal(c,r.scorecard.id,s.id);if(s.subGoals?s.subGoals.push(u):s.subGoals=[u],t&&(a.activeGoalId=void 0,a.selectedGoalIds={}),!_.isNil(s.rank)||-1!==s.subGoals.findIndex(function(P){return!_.isNil(P.rank)})){var v=0;s.subGoals.forEach(function(P){P.rank=v,v++})}}),this.commit())},i.prototype.updateScorecard=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a,s=this;return(0,w.__generator)(this,function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),t=void 0!==n.localTimeZoneId&&n.localTimeZoneId!==this.scorecard.localTimeZoneId,[4,this.goalsHttpService.updateScorecard(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 1:return r=c.sent(),n.name&&this.store.select(Wn.iF).pipe((0,he.q)(1)).subscribe(function(u){s.tabFacade.updateTab(u===s.scorecard.groupId?{id:"me##"+s.scorecard.id,title:n.name}:{id:s.scorecard.groupId+"##"+s.scorecard.id,title:n.name})}),this.scorecard=(0,nt.Uy)(this.scorecard,function(u){for(var v=0,P=_.keys(n);v<P.length;v++){var x=P[v];u[x]=r[x]}}),this.commit(),t?[4,this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!1,this.scorecard.hierarchyPaths)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[3,5];case 4:throw a=c.sent(),this.goalsErrorService.showUserError(a,"UpdateScorecardError"),a;case 5:return[2]}})})},i.prototype.setGoalState=function(n,t){b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,nt.Uy)(this.scorecard,function(r){var a=q.getGoal(r.goals,n);b.fF.assertValue(a,"Goal not found"),a.state=t,("Editing"===a.state||"Deleting"===a.state)&&(r.selectedGoalIds[a.id]||r.activeGoalId===a.id)&&(r.activeGoalId=void 0,"Deleting"===a.state&&delete r.selectedGoalIds[a.id])}),this.commit()},i.prototype.cancelEditing=function(n){b.fF.assertValue(this.scorecard,"No scorecard loaded");var t=q.getGoal(this.scorecard.goals,n);b.fF.assertValue(t,"Goal not found"),t.isNew?this.deleteGoalRequest(n):this.setGoalState(n,"Consumption")},i.prototype.setViewType=function(n,t){var r=this;n!==this.viewType&&(q.isEditing(this.scorecard)&&!t?this.promptUserConfirmation({title:this.localizationService.get("MetricsUnsavedChangesTitle"),message:this.localizationService.get("MetricsUnsavedChangesDescription_SwitchView"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(r,void 0,void 0,function(){var c=this;return(0,w.__generator)(this,function(u){return q.filterGoals(this.scorecard.goals,function(p){return!!p.isNew||"Editing"===p.state}).forEach(function(p){return c.cancelEditing(p.id)}),this.setViewType(n,!0),[2]})})}}):(this.telemetryService.logEvent(rr,{viewType:n}),"Heatmap"===n&&this.setActiveHierarchy(void 0),this._viewType$.next(n)))},Object.defineProperty(i.prototype,"viewType",{get:function(){return this._viewType$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"viewType$",{get:function(){return this._viewType$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scorecardSelectionMode",{get:function(){return this._scorecardSelectionMode$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scorecardSelectionMode$",{get:function(){return this._scorecardSelectionMode$},enumerable:!1,configurable:!0}),i.prototype.setEditMode=function(n){this.isEditMode$.next(n),!n&&this.scorecard&&_.some(this.scorecard.goals)&&(this.scorecard=(0,nt.Uy)(this.scorecard,function(t){(function a(s,c){for(var u,p=function(Y){Y.isNew&&(s?s.subGoals=s.subGoals.filter(function(ue){return ue.id!==Y.id}):t.goals=t.goals.filter(function(ue){return ue.id!==Y.id})),Y.state="Consumption",(null===(u=Y.subGoals)||void 0===u?void 0:u.length)>0&&a(Y,Y.subGoals)},v=0,P=c;v<P.length;v++)p(P[v])})(null,t.goals),t.activeGoalId=void 0,t.selectedGoalIds={}}),this.commit())},i.prototype.isEditMode=function(){return this.isEditMode$.asObservable()},i.prototype.isLoading=function(){return this.loading$.pipe((0,je.U)(function(n){return n>0}))},i.prototype.getColumnSettings=function(){return this._scorecard$.pipe((0,je.U)(function(n){return n.columnSettings}))},i.prototype.setGoalRefreshState=function(n,t,r){this.scorecard=(0,nt.Uy)(this.scorecard,function(a){var s=q.getGoal(a.goals,n);switch(t){case 1:s.currentRefreshInProgress=r;break;case 2:s.targetRefreshInProgress=r;break;default:b.fF.assertNever(t)}}),this.commit()},i.prototype.fetchUserDetails=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t;return(0,w.__generator)(this,function(r){return t=_.chain(n).map(function(a){return _.concat(_.map(a.additionalOwners,function(s){var c;return null!==(c=s?.userPrincipalName)&&void 0!==c?c:s?.aadAppId}),a.owner)}).flattenDeep().filter(function(a){return!!a}).uniq().value(),[2,this.userDetailsService.getUserDetails(t).toPromise()]})})},i.prototype.populateUserDisplayNames=function(n,t){if(!_.isEmpty(n)&&!_.isEmpty(t)){for(var r={},a=0,s=n;a<s.length;a++){var c=s[a];r[c.userPrincipalName]=c,r[c.aadAppId]=c}for(var u=0,p=t;u<p.length;u++){var v=p[u],P=_.concat([v.owner],_.map(v.additionalOwners,function(x){var G;return null!==(G=x?.userPrincipalName)&&void 0!==G?G:x?.aadAppId}));v.ownerDisplayNames=_.map(P,function(x){return r[x]?r[x].displayName:x})}}},i.prototype.toggleSelectedGoal=function(n,t,r){var a=this;return void 0===t&&(t=!0),void 0===r&&(r=!1),b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,nt.Uy)(this.scorecard,function(s){var c,u=q.getGoal(s.goals,n);b.fF.assertValue(u,"Goal not found"),!u.isNew&&(s.activeGoalId=void 0,a.numberOfSelectedGoals()>1||r?(r||(t&&(s.activeGoalId=n),s.selectedGoalIds={}),s.selectedGoalIds[n]||"Deleting"===u.state?delete s.selectedGoalIds[n]:s.selectedGoalIds[n]=!0):s.selectedGoalIds[n]||"Deleting"===u.state?s.selectedGoalIds={}:(t&&(s.activeGoalId=n),s.selectedGoalIds=((c={})[n]=!0,c)))}),this.commit(),this.scorecard.selectedGoalIds[n]},i.prototype.setActiveGoal=function(n){b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,nt.Uy)(this.scorecard,function(t){t.activeGoalId=n}),this.commit()},i.prototype.selectGoal=function(n,t){void 0===t&&(t=!0),b.fF.assertValue(this.scorecard,"No scorecard loaded");var r=q.getGoal(this.scorecard.goals,n);b.fF.assertValue(r,"Goal not found"),!r.isNew&&!this.scorecard.selectedGoalIds[n]&&"Deleting"!==r.state&&(this.scorecard=(0,nt.Uy)(this.scorecard,function(a){var s;t&&(a.activeGoalId=n),a.selectedGoalIds=((s={})[n]=!0,s)}),this.commit())},i.prototype.multiSelectGoal=function(n){b.fF.assertValue(this.scorecard,"No scorecard loaded");var t=q.getGoal(this.scorecard.goals,n);b.fF.assertValue(t,"Goal not found"),!t.isNew&&this.scorecard.selectedGoalIds[n]&&"Deleting"!==t.state&&(this.scorecard=(0,nt.Uy)(this.scorecard,function(r){r.selectedGoalIds[n]=!0}),this.commit())},i.prototype.toggleSelectAllGoals=function(){var n=this;b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,nt.Uy)(this.scorecard,function(t){t.selectedGoalIds={};var r=q.filterGoals(t.goals,function(u){return!u.isNew&&(!n.scorecardHost||n.scorecardHost.canSelectGoal(u).enabled)});if(r.length!==n.numberOfSelectedGoals())for(var a=0,s=r;a<s.length;a++)t.selectedGoalIds[s[a].id]=!0}),this.commit()},i.prototype.unselectAllGoals=function(){b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard=(0,nt.Uy)(this.scorecard,function(n){n.activeGoalId=void 0,n.selectedGoalIds={}}),this.commit()},i.prototype.getSelectedGoalIdsObservable=function(){return this._selectedGoalIds$},i.prototype.getSelectedGoalsObservable=function(){var n=this;return this._selectedGoalIds$.pipe((0,je.U)(function(t){return q.filterGoals(n.scorecard.goals,function(a){return t[a.id]&&!a.isNew})}))},i.prototype.getFirstSelectedGoalId=function(){if(this.numberOfSelectedGoals()>0)return Object.keys(this.scorecard.selectedGoalIds)[0]},i.prototype.numberOfSelectedGoals=function(){return _.isNil(this.scorecard.selectedGoalIds)?0:Object.keys(this.scorecard.selectedGoalIds).length},i.prototype.isCurrentlyInEditMode=function(){return this.isEditMode$.value},i.prototype.getCurrentScorecard=function(){return this.scorecard},i.prototype.getScorecard=function(){return this._scorecard$.asObservable()},i.prototype.flatten=function(){return q.flattenGoals(this.scorecard.goals)},i.prototype.getBoard=function(){return this._scorecard$.pipe((0,je.U)(function(n){return n.board}))},i.prototype.addGroupToBoard=function(n,t){var r={id:n,name:t,goals:[]};this.scorecard=(0,nt.Uy)(this.scorecard,function(a){_.isUndefined(a.board)&&(a.board={id:"",groups:[]}),a.board.id="boardVisual",a.board.groups.push(r)}),this.commit()},i.prototype.deleteGroupFromBoard=function(n){this.scorecard=(0,nt.Uy)(this.scorecard,function(t){t.board.groups=t.board.groups.filter(function(r){return r.id!==n})}),this.commit()},i.prototype.isEditing=function(){return this._scorecard$.pipe((0,je.U)(function(n){return q.isEditing(n)}))},i.prototype.ensureRolesLoaded=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t;return(0,w.__generator)(this,function(r){switch(r.label){case 0:if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),!_.isEmpty(this.scorecard.roles))return[2];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,this.goalsHttpService.getRoles(this.scorecard.groupId,this.scorecard.id).toPromise()];case 2:return n=r.sent(),_.isEmpty(n)?[4,this.initStartingRoles()]:[3,4];case 3:return r.sent(),[3,5];case 4:this.scorecard=(0,nt.Uy)(this.scorecard,function(a){a.roles=n}),this.commit(),r.label=5;case 5:return[3,7];case 6:throw t=r.sent(),this.goalsErrorService.showUserError(t,"LoadRoles"),t;case 7:return[2]}})})},i.prototype.initStartingRoles=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,r,a=this;return(0,w.__generator)(this,function(s){switch(s.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),s.label=1;case 1:return s.trys.push([1,3,,4]),n=[{name:this.localizationService.get("EditScorecardSettings_Role_Card_Default_Role_View_All"),isDefaultRole:!0,permissions:[{goalId:void 0,permissions:1,applyToChildGoals:!0}]},{name:this.localizationService.get("EditScorecardSettings_Role_Card_Default_Role_View_And_Update_All"),isDefaultRole:!1,permissions:[{goalId:void 0,permissions:27,applyToChildGoals:!0}]}],[4,Promise.all(n.map(function(c){return a.goalsHttpService.createRole(a.scorecard.groupId,a.scorecard.id,c).toPromise()}))];case 2:return t=s.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(c){var u;_.isEmpty(c.roles)?c.roles=t:(u=c.roles).push.apply(u,t)}),this.commit(),[2,t];case 3:throw r=s.sent(),this.goalsErrorService.showUserError(r,"InitStartingRolesError"),r;case 4:return[2]}})})},i.prototype.deleteRole=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,w.__generator)(this,function(r){switch(r.label){case 0:return[4,this.ensureRolesLoaded()];case 1:return r.sent(),[2,this.promptUserConfirmation({title:this.localizationService.get("ScorecardDialog_Delete_Role_Title"),message:"".concat(this.localizationService.get("ScorecardDialog_Delete_Role_Message_First_Line"),"\n\n            ").concat(this.localizationService.get("ScorecardDialog_Action_Cant_be_Undone")),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(t,void 0,void 0,function(){var s,c,u;return(0,w.__generator)(this,function(p){switch(p.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),s=null===(u=this.scorecard.roles)||void 0===u?void 0:u.find(function(v){return v.id===n}),b.fF.assertValue(s,"Role not found"),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteRole(this.scorecard.groupId,this.scorecard.id,s.id).toPromise()];case 2:return p.sent(),[3,4];case 3:throw c=p.sent(),this.goalsErrorService.showUserError(c,"DeleteRoleError"),c;case 4:return this.scorecard=(0,nt.Uy)(this.scorecard,function(v){v.roles=v.roles.filter(function(P){return P.id!==n})}),this.commit(),[2,!0]}})})}})]}})})},i.prototype.setAsDefaultRole=function(n){var t,r,a;return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u,p=this;return(0,w.__generator)(this,function(v){switch(v.label){case 0:return[4,this.ensureRolesLoaded()];case 1:return v.sent(),b.fF.assertValue(this.scorecard,"No scorecard loaded"),s=null===(t=this.scorecard.roles)||void 0===t?void 0:t.find(function(P){return P.id===n}),b.fF.assertValue(s,"Role not found"),c=null===(a=null===(r=this.scorecard.roles)||void 0===r?void 0:r.find(function(P){return P.isDefaultRole}))||void 0===a?void 0:a.name,u=s.name,[2,this.promptUserConfirmation({title:this.localizationService.get("EditScorecardSettings_Permission_Pane_Change_Default_Role_title"),message:_.isNil(c)?this.localizationService.format("EditScorecardSettings_Permission_Pane_Set_Default_Role_Message",[u]):this.localizationService.format("EditScorecardSettings_Permission_Pane_Change_Default_Role_Message",[c,u]),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue"),panelClass:["updateRoleConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(p,void 0,void 0,function(){var x;return(0,w.__generator)(this,function(G){switch(G.label){case 0:return G.trys.push([0,2,,3]),[4,this.goalsHttpService.updateRole(this.scorecard.groupId,this.scorecard.id,s.id,{isDefaultRole:!0}).toPromise()];case 1:return G.sent(),[3,3];case 2:throw x=G.sent(),this.goalsErrorService.showUserError(x,"UpdateRoleError"),x;case 3:return this.scorecard=(0,nt.Uy)(this.scorecard,function(Y){Y.roles.forEach(function(ue){ue.isDefaultRole=ue.id===n})}),this.commit(),[2,!0]}})})}})]}})})},i.prototype.createRole=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.createRole(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return t=a.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(s){_.isEmpty(s.roles)?s.roles=[t]:s.roles.push(t)}),this.commit(),[2,t];case 3:throw r=a.sent(),this.goalsErrorService.showUserError(r,"UpdateRoleError"),r;case 4:return[2]}})})},i.prototype.updateRole=function(n,t){var r;return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s,c;return(0,w.__generator)(this,function(u){switch(u.label){case 0:return[4,this.ensureRolesLoaded()];case 1:u.sent(),b.fF.assertValue(this.scorecard,"No scorecard loaded"),a=null===(r=this.scorecard.roles)||void 0===r?void 0:r.find(function(p){return p.id===n}),b.fF.assertValue(a,"Role not found"),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,this.goalsHttpService.updateRole(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 3:return s=u.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(p){p.roles=p.roles.map(function(v){return v.id===n?s:v})}),this.commit(),[2,s];case 4:throw c=u.sent(),this.goalsErrorService.showUserError(c,"UpdateRoleError"),c;case 5:return[2]}})})},i.prototype.updateGoalValueConnectionSettings=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a;return(0,w.__generator)(this,function(s){switch(s.label){case 0:b.fF.assertValue(this.scorecard,"No scorecard loaded"),r=q.getGoal(this.scorecard.goals,n),b.fF.assertValue(r,"Goal not found"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.goalsHttpService.updateConnectionSettings(this.scorecard.groupId,this.scorecard.id,n,t).toPromise()];case 2:return s.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(c){var u=q.getGoal(c.goals,n);u.valueConnection&&1===t.connectionType?u.valueConnection=(0,w.__assign)((0,w.__assign)({},u.valueConnection),{shouldClearGoalValues:t.shouldClearGoalValues}):u.targetConnection&&2===t.connectionType&&(u.targetConnection=(0,w.__assign)((0,w.__assign)({},u.targetConnection),{shouldClearGoalValues:t.shouldClearGoalValues}))}),this.commit(),[3,4];case 3:throw a=s.sent(),this.goalsErrorService.showUserError(a,"UpdateGoalValueConnectionSettingsError"),a;case 4:return[2]}})})},i.prototype.setScorecardWithGoals=function(n){var t=this;this.linkedScorecardsById=_.keyBy(n.linkedScorecards,"id"),this.scorecard=(0,nt.Uy)(n,function(r){var a,s;r.columnSettings=_.isEmpty(r.columnSettings)?W.om:K.mergeColumns(r.columnSettings,W.om),K.adjustColumnSettings(t.featureSwitches,r.columnSettings),t.featureSwitches.featureSwitches.goalsLinkedGoals?null===(a=r.goals)||void 0===a||a.forEach(function(c){return c.isLinked=ke.r.isLinked(c,r)}):r.goals=_.filter(r.goals,function(c){return c.scorecardId===r.id}),r.isSample=q.isSampleScorecard(n),_.some(r?.goals)&&(r.goals=B.sort(q.buildGoalTree(r.goals),W.Ij)),(null===(s=t.scorecard)||void 0===s?void 0:s.id)===n.id?(r.activeGoalId=t.scorecard.activeGoalId,r.selectedGoalIds=t.scorecard.selectedGoalIds):r.selectedGoalIds={},r.showGoalTargetsInChart=!1}),this.commit()},i.prototype.commit=function(){this._scorecard$.next(this.scorecard)},i.prototype.ensureUsersLoaded=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t=this;return(0,w.__generator)(this,function(r){switch(r.label){case 0:return b.fF.assertValue(this.scorecard,"No scorecard loaded"),this.scorecard.usersLoaded?[2]:[4,this.fetchUserDetails(q.flattenGoals(this.scorecard.goals))];case 1:return n=r.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(a){t.populateUserDisplayNames(n,q.flattenGoals(a.goals)),a.usersLoaded=!0}),this.commit(),[2]}})})},i.prototype.showRefreshConfirmation=function(){this.dialogService.showSimpleDialog(this.localizationService.get("Refresh_Scheduled"),this.localizationService.get("Refresh_Scheduled_Data_Will_Be_Updated"))},i.prototype.promptUserConfirmation=function(n){var t,r;return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(c){switch(c.label){case 0:return b.fF.assertValue(n,"args"),b.fF.assertValue(n.title,"args.title"),b.fF.assertValue(n.message,"args.message"),[4,this.dialogService.showConfirmationDialog({title:n.title,message:n.message,okButtonText:null!==(t=n.okButtonText)&&void 0!==t?t:this.localizationService.get("Delete"),cancelButtonText:null!==(r=n.cancelButtonText)&&void 0!==r?r:this.localizationService.get("Cancel_ButtonText")},{autoFocus:!0,panelClass:n.panelClass}).afterClosed().toPromise()];case 1:return 1===c.sent()&&n.onConfirmation?[4,n.onConfirmation()]:[3,3];case 2:return[2,c.sent()];case 3:return[2,void 0]}})})},i.prototype.assignGoal=function(n,t){var r=n.rank;b.fF.assertValue(n,"existingGoal"),b.fF.assertValue(t,"newGoal"),Object.assign(n,t),n.cycle=t.cycle,n.cyclePeriod=t.cyclePeriod,n.rank=r,n.valuesCategoryId=t.valuesCategoryId},i.prototype.createCategoryList=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:b.fF.assertValue(this.scorecard,"createCategoryList No scorecard loaded"),b.fF.assert(function(){return!_.isEmpty(n)},"createCategoryList Categorical values are empty"),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.createGoalValueCategories(this.scorecard.groupId,this.scorecard.id,q.getGoalValueCategoriesCreateRequest(n)).toPromise()];case 2:return t=a.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(s){_.isUndefined(s.goalValueCategories)&&(s.goalValueCategories=[]),s.goalValueCategories.push(t)}),[3,4];case 3:throw r=a.sent(),this.goalsErrorService.showUserError(r,"SaveGoalError"),r;case 4:return this.commit(),[2,t]}})})},i.prototype.updateCategoryList=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a=this;return(0,w.__generator)(this,function(s){switch(s.label){case 0:b.fF.assertValue(this.scorecard,"updateCategoryList No scorecard loaded"),b.fF.assertValue(n,"updateCategoryList categoryList"),b.fF.assertValue(_.find(this.scorecard.goalValueCategories,function(c){return c.id===n.id}),"updateCategoryList No category list found to update"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.goalsHttpService.updateGoalValueCategories(this.scorecard.groupId,this.scorecard.id,n.id,q.getGoalValueCategoriesUpdateRequest(n)).toPromise()];case 2:return t=s.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(c){var u=_.findIndex(a.scorecard.goalValueCategories,function(p){return p.id===t.id});c.goalValueCategories[u]=t}),[3,4];case 3:throw r=s.sent(),this.goalsErrorService.showUserError(r,"SaveGoalError"),r;case 4:return this.commit(),[2,t]}})})},i.prototype.deleteCategoryList=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t;return(0,w.__generator)(this,function(r){switch(r.label){case 0:b.fF.assertValue(this.scorecard,"deleteCategoryList No scorecard loaded"),b.fF.assertValue(_.find(this.scorecard.goalValueCategories,function(a){return a.id===n}),"deleteCategoryList No category list found to delete."),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.goalsHttpService.deleteGoalValueCategories(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return r.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(a){_.remove(a.goalValueCategories,function(s){return s.id===n})}),[3,4];case 3:throw t=r.sent(),this.goalsErrorService.showUserError(t,"SaveGoalError"),t;case 4:return this.commit(),[2]}})})},i.prototype.getGoalValueCategoryLists=function(n){var t,r;return b.fF.assertValue(this.scorecard,"No scorecard loaded"),n?null!==(t=this.getSourceScorecard(n).goalValueCategories)&&void 0!==t?t:[]:null!==(r=this.scorecard.goalValueCategories)&&void 0!==r?r:[]},i.prototype.getGoalValueCategories=function(n){var t,r;if(n.valuesCategoryId){var a=this.getGoalValueCategoryLists(n);return null!==(r=null===(t=_.find(a,function(s){return s.id===n.valuesCategoryId}))||void 0===t?void 0:t.categories)&&void 0!==r?r:[]}},Object.defineProperty(i.prototype,"goalStatusesByScorecardId$",{get:function(){return this._goalStatusesByScorecardId$},enumerable:!1,configurable:!0}),i.prototype.getGoalStatuses=function(n){var t,r,a,s;return b.fF.assertValue(this.scorecard,"No scorecard loaded"),n?null!==(r=null===(t=this.getSourceScorecard(n).goalStatuses)||void 0===t?void 0:t.statuses)&&void 0!==r?r:[]:null!==(s=null===(a=this.scorecard.goalStatuses)||void 0===a?void 0:a.statuses)&&void 0!==s?s:[]},i.prototype.userHasWritePermissions=function(){var n,t=Qe(null===(n=this.scorecard)||void 0===n?void 0:n.permissions);return(0,ur.yE)(t,2)},i.prototype.bulkDeleteGoalsPrompt=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,r=this;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return this.assertNoActivehierarchy(!0)?[4,this.getSelectedGoalsObservable().pipe((0,he.q)(1)).toPromise()]:[2];case 1:return n=a.sent(),t=_.some(n,function(s){return s.isLinked}),[2,this.promptUserConfirmation({title:this.localizationService.format("ScorecardDialog_BulkDelete_Metric_Title",[this.numberOfSelectedGoals()]),message:this.localizationService.get(t?"ScorecardDialog_BulkDelete_Metric_Message_Linked":"ScorecardDialog_BulkDelete_Metric_Message_First_Line"),panelClass:["updateConfirmationDialogPanel"],onConfirmation:function(){return(0,w.__awaiter)(r,void 0,void 0,function(){return(0,w.__generator)(this,function(c){switch(c.label){case 0:return[4,this.bulkDeleteGoals()];case 1:return c.sent(),[2,!0]}})})}})]}})})},i.prototype.bulkDeleteGoals=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t=this;return(0,w.__generator)(this,function(r){switch(r.label){case 0:return this.assertNoActivehierarchy(!0)?(b.fF.assertValue(this.scorecard,"No scorecard loaded"),n=q.filterGoals(this.scorecard.goals,function(a){return t.scorecard.selectedGoalIds[a.id]&&!a.isNew}),[4,this.bulkDeleteGoalsRequest(n)]):[2];case 1:return r.sent(),[2]}})})},i.prototype.bulkDeleteGoalsRequest=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,s,c;return(0,w.__generator)(this,function(u){switch(u.label){case 0:for(t=0,r=n;t<r.length;t++)this.setGoalState(r[t].id,"Deleting");u.label=1;case 1:return u.trys.push([1,4,,5]),s=_.map(n,"id"),_.isEmpty(s)?[3,3]:[4,this.goalsHttpService.bulkDeleteGoals(this.scorecard.groupId,this.scorecard.id,{goalIds:s}).toPromise()];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(c=u.sent(),404!==c?.status)throw this.goalsErrorService.showUserError(c,"BulkDeleteGoalError"),c;return[3,5];case 5:return this.scorecard=(0,nt.Uy)(this.scorecard,function(p){for(var v=function(ue){var Se=q.getGoal(p.goals,ue.parentId);Se?.subGoals?Se.subGoals=Se.subGoals.filter(function(Ae){return Ae.id!==ue.id}):p.goals&&(p.goals=p.goals.filter(function(Ae){return Ae.id!==ue.id}))},P=0,x=n;P<x.length;P++)v(x[P])}),this.commit(),[2]}})})},i.prototype.bulkUpdateGoals=function(n){var t,r,a;return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u,p,P,x,G,Y,ue,Se,Ae,xe,Be,Je,ut,It,mt=this;return(0,w.__generator)(this,function(bt){switch(bt.label){case 0:if(!this.assertNoActivehierarchy(!0))return[2];if(b.fF.assertValue(this.scorecard,"No scorecard loaded"),b.fF.assertValue(n,"No bulk request"),(null===(t=n.goalIds)||void 0===t?void 0:t.length)<=0)return[2];for(s=n.target,delete n.target,c=0,u=n.goalIds;c<u.length;c++)this.setGoalState(xe=u[c],"Saving");return p=_.map(n.owners,function(z){var fe;return null!==(fe=z.userPrincipalName)&&void 0!==fe?fe:z.aadAppId}),_.isEmpty(n.owners)?[3,2]:[4,this.userDetailsService.getUserDetails(p).toPromise()];case 1:return P=bt.sent(),[3,3];case 2:P=[],bt.label=3;case 3:for(x={},G=0,Y=P;G<Y.length;G++)x[(ue=Y[G]).userPrincipalName]=ue,x[ue.aadAppId]=ue;bt.label=4;case 4:if(bt.trys.push([4,10,,11]),_.isNil(s))return[3,8];Se=0,Ae=n.goalIds,bt.label=5;case 5:return Se<Ae.length?(Be=q.getGoal(this.scorecard.goals,xe=Ae[Se]),Je=null!==(a=null===(r=_.find(Be.aggregations,function(z){return"Target"===z.type}))||void 0===r?void 0:r.timestamp)&&void 0!==a?a:n.timestamp,[4,this.upsertGoalValues(xe,[{timestamp:Je,target:s}])]):[3,8];case 6:bt.sent(),bt.label=7;case 7:return Se++,[3,5];case 8:return[4,this.goalsHttpService.bulkUpdateGoals(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 9:return ut=bt.sent(),this.scorecard=(0,nt.Uy)(this.scorecard,function(z){for(var fe=0,Me=ut;fe<Me.length;fe++){var at=Me[fe],xt=q.getGoal(z.goals,at.id),At=xt.additionalOwners;mt.assignGoal(xt,at),_.isEmpty(n.owners)?xt.additionalOwners=At:xt.ownerDisplayNames=_.map(p,function(Do){var zi,qi;return null!==(qi=null===(zi=x[Do])||void 0===zi?void 0:zi.displayName)&&void 0!==qi?qi:Do}),xt.state="Consumption"}}),[3,11];case 10:throw It=bt.sent(),this.goalsErrorService.showUserError(It,"BulkUpdateGoalError"),It;case 11:return this.commit(),[2]}})})},i.prototype.toggleShowGoalTargetsInChart=function(n){this.scorecard=(0,nt.Uy)(this.scorecard,function(t){t.showGoalTargetsInChart=n}),this.commit()},i.prototype.createLinkedGoals=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a,s,c,u,p,v,P;return(0,w.__generator)(this,function(x){switch(x.label){case 0:if(_.isEmpty(n))return[2];r=new Set(q.mapGoals(this.scorecard.goals,function(G){return G.id})),a=new Set,(s=n.length)>1&&(c=this.dialogService.showSimpleWaitDialog(this.localizationService.format("Metrics_LinkedMetrics_Linking",s),s>100?this.localizationService.get("This_Might_Take_A_Moment"):"")),u=0,x.label=1;case 1:if(!(u<s))return[3,9];if(r.has((p=n[u]).id))return b.fF.assertFail("Selected goal to link already exists on this scorecard."),[3,8];(v=p.parentId)&&!a.has(v)&&(b.fF.assertFail("Attempting to link goal with parentId ".concat(v," without having linked parent.")),v=void 0),x.label=2;case 2:return x.trys.push([2,4,,8]),[4,this.goalsHttpService.createLinkedGoals(this.scorecard.groupId,this.scorecard.id,{goalIds:[p.id],scorecardId:p.scorecardId,parentGoalId:v??t}).toPromise()];case 3:return x.sent(),a.add(p.id),[3,8];case 4:return 429!==(P=x.sent()).status?[3,6]:[4,new Promise(function(G){return setTimeout(G,5e3)})];case 5:return x.sent(),u--,[3,7];case 6:return this.goalsErrorService.showUserError(P,"CreateLinkedGoalsError","Metrics_LinkedMetrics_Error"),[3,9];case 7:return[3,8];case 8:return u++,[3,1];case 9:return this.loadScorecard(this.scorecard.groupId,this.scorecard.id,!0,this.scorecard.hierarchyPaths),c?.close(),[2]}})})},i.prototype.getSourceScorecard=function(n){if(n.isLinked){var t=this.linkedScorecardsById[n.scorecardId];if(t)return t;b.fF.assertFail("No linked scorecard with id "+n.scorecardId)}return this.scorecard},i.prototype.openLinkedSourceScorecard=function(n){b.fF.assert(function(){return n.isLinked},"Goal is not linked");var t=this.getSourceScorecard(n);this.scorecardHost.openScorecard(t,n)},i.prototype.getOwnerDisplayNames=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a;return(0,w.__generator)(this,function(s){switch(s.label){case 0:return t=_.concat([n.owner],_.map(n.additionalOwners,function(c){var u;return null!==(u=c?.userPrincipalName)&&void 0!==u?u:c?.aadAppId})),[4,this.userDetailsService.getUserDetails(t).toPromise()];case 1:return r=s.sent(),a=_.map(r,function(c){return c?.displayName}),[2,_.isEmpty(a)?t:a]}})})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Ye),e.\u0275\u0275inject(pn.K),e.\u0275\u0275inject(Ut.x),e.\u0275\u0275inject(Ro.T),e.\u0275\u0275inject(ft.o),e.\u0275\u0275inject(Ha.a),e.\u0275\u0275inject(_n.vZ),e.\u0275\u0275inject(Lo),e.\u0275\u0275inject(eo.y0),e.\u0275\u0275inject(As),e.\u0275\u0275inject(yt.yh),e.\u0275\u0275inject(ot,8),e.\u0275\u0275inject(Cn,8))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Gn=M(57243),En=M(19178),Pr=function(){function i(n){this.capability=n,this.capability||(this.capability={enabled:!0,disabledReasons:new Set})}return i.clone=function(n){return new i(_.cloneDeep(n))},i.prototype.disableIf=function(n,t,r){return n&&(this.capability.enabled=!1,this.capability.disabledReasons.add(t),r&&!this.capability.disabledMessageKey&&(this.capability.disabledMessageKey=r)),new i(this.capability)},i.prototype.disableWithMultiple=function(n){var t=this;return this.capability.enabled=!1,n.forEach(function(r){return t.capability.disabledReasons.add(r)}),new i(this.capability)},i.prototype.build=function(){return this.capability},i}();function oi(i,n){return(0,ur.yE)(i,n)}var Or=["id","permissions","hierarchyPaths"],hr=function(){function i(n,t,r,a){var s=this;this.featureSwitchService=n,this.scorecardService=t,this.groupStore=r,this.scorecardHost=a,this.capabilityInputs$=new pe.X([void 0,"List",!1]);var c=this.scorecardService.getScorecard().pipe((0,I.x)(function(p,v){return!p&&!v||!!p&&!!v&&_.every(Or,function(P){return _.isEqual(p[P],v[P])})})),u=c.pipe((0,je.U)(function(p){return p.groupId}),(0,I.x)(),(0,Jt.w)(function(p){return s.groupStore.getGroupById(p||"me")}),(0,je.U)(function(p){return void 0!==p?.capacitySkuTier&&6!==p.capacitySkuTier}));this.inputSub=(0,Mn.aj)([c,this.scorecardService.viewType$,u]).subscribe(this.capabilityInputs$),this.scorecardCapabilities$=this.capabilityInputs$.pipe((0,je.U)(function(p){return s.calculateScorecardCapabilities(p)}),(0,Gn.d)(1))}return i.prototype.ngOnDestroy=function(){this.inputSub.unsubscribe()},i.prototype.getCurrentScorecardCapabilities=function(){return this.calculateScorecardCapabilities(this.capabilityInputs$.value)},i.prototype.getScorecardCapabilities=function(){return this.scorecardCapabilities$},i.prototype.getCurrentGoalCapabilities=function(n){return _.isNil(n)?{}:this.calculateGoalCapabilities(n,this.capabilityInputs$.value)},i.prototype.getGoalCapabilities=function(n){var t=this;return _.isNil(n)?(0,ae.of)({}):this.capabilityInputs$.pipe((0,je.U)(function(r){return t.calculateGoalCapabilities(n,r)}),(0,Gn.d)(1))},i.prototype.getMultipleGoalCapabilities=function(n){var t=this;return _.isEmpty(n)?(0,ae.of)({}):this.capabilityInputs$.pipe((0,je.U)(function(r){for(var a=_.map(n,function(x){return t.calculateGoalCapabilities(x,r)}),s=a[0],c={},u=function(G){var Y=G,ue=s[Y];if("scorecardCapabilities"===Y)c[Y]=s.scorecardCapabilities;else if("boolean"==typeof ue)c[Y]=_.every(a,function(ut){return ut[Y]});else if(function(i){return"enabled"in i}(ue)){for(var Se=new Pr,Ae=0,xe=a;Ae<xe.length;Ae++){var Je=xe[Ae][Y];Je.enabled||Se.disableWithMultiple(Je.disabledReasons)}c[Y]=Se.build()}else b.fF.assertFail("Unexpected type for key ".concat(Y," when getting multiple goal capabilities"))},p=0,v=_.keys(s);p<v.length;p++)u(v[p]);return c}),(0,Gn.d)(1))},i.prototype.calculateScorecardCapabilities=function(n){var t=n[0],r=n[1],a=n[2],s={},c=oi(Qe(t?.permissions),2),u=!_.isEmpty(t?.hierarchyPaths),p="List"===r;return s.customizeStatus=this.featureSwitchService.featureSwitches.goalsCustomizeStatus&&c,s.createGoal=(new Pr).disableIf(!c,"NoWritePermission","Metrics_Tooltip_NoPermission").disableIf(u,"Hierarchical","Metrics_Tooltip_Create_Metric_Disabled_Hierarchical").disableIf(!p,"UnsupportedView","Metrics_Tooltip_Create_Metric_Disabled_UnsupportedView").build(),s.createLinkedGoal=(new Pr).disableIf(!c,"NoWritePermission","Metrics_Tooltip_NoPermission").disableIf(u,"Hierarchical","Metrics_Tooltip_Create_Metric_Disabled_Hierarchical").disableIf("Heatmap"===r,"UnsupportedView","Metrics_Tooltip_Create_Metric_Disabled_UnsupportedView").build(),s.deleteGoal=c&&!u,s.reorderGoal=this.featureSwitchService.featureSwitches.powerBIGoalsDragAndDrop&&c&&!u&&p,s.editHierarchies=(new Pr).disableIf(!c,"NoWritePermission","MetricsHierarchy_NoPermission").disableIf(!a&&this.featureSwitchService.featureSwitches.scorecardHierarchiesPremium,"NoPremiumWorkspace","MetricsHierarchy_NotAllowedInShared").build(),s.editHeatmap=c,s},i.prototype.calculateGoalCapabilities=function(n,t){var r,a,s={scorecardCapabilities:this.calculateScorecardCapabilities(t)},c=t[0],u=t[1],p=n.isNew?31:function(i){if(_.isNil(i))return 0;if(!isNaN(i))return Number(i);switch(i.toString().trim().toLowerCase()){case"none":return 0;case"view":return 1;case"updatecurrentvalue":return 3;case"updatetargetvalue":return 5;case"updatenotes":return 9;case"updatestatus":return 17;case"updatevalues":return 7;case"all":return 31;default:b.fF.assertValue(i,"can't cast GoalPermission value")}}(n.permissions),v=oi(Qe(c?.permissions),2),P=!!n.valuesCategoryId,x=(null===(a=null===(r=n.aggregations)||void 0===r?void 0:r.find(function(Je){return"NumberOfTargets"===Je.type}))||void 0===a?void 0:a.value)>1,G=!_.isEmpty(c?.hierarchyPaths),Y=q.isSampleScorecard(c),ue=G&&n.isLinked,Se="List"===u;s.selectGoal=this.scorecardHost?this.scorecardHost.canSelectGoal(n):{enabled:!0},s.editGoal=(new Pr).disableIf(!v,"NoWritePermission","Metrics_Tooltip_NoPermission").disableIf(n.isLinked,"LinkedMetric","Metrics_Tooltip_Edit_Metric_Disabled_Linked").disableIf(!Se,"UnsupportedView","Metrics_Tooltip_Edit_Metric_Disabled_UnsupportedView").build();var Ae=v&&!n.isLinked&&!G;s.editName=Ae,s.editStartDate=Ae,s.editDueDate=Ae,s.editStatusRules=Ae,s.editPeriodicity=Ae,s.connectCurrentValueToData=Ae,s.connectTargetValueToData=Ae,s.changeValueFormat=Ae,s.editOwners=Ae,s.deleteGoal=s.scorecardCapabilities.deleteGoal,s.createSubgoal=s.scorecardCapabilities.createGoal,s.editStatus=oi(p,17)&&!ue&&!n.hasStatusRules,s.addNotes=oi(p,9)&&!ue;var xe=oi(p,3)&&!ue&&!n.valueConnection&&!n.valueRollup;s.editCurrentValue=xe,s.editMultipleValues=xe&&!P&&!G&&!n.isLinked;var Be=oi(p,5)&&!n.isLinked;return s.editTargetValue=Be&&!n.targetConnection&&!n.targetRollup&&!x,s.editMultipleTargets=Be&&(!!this.featureSwitchService.featureSwitches.goalsRollups||!n.targetConnection&&!n.targetRollup)&&(!P||x)&&!G,s.deleteCheckIn=v,s.followGoal=this.featureSwitchService.featureSwitches.goalsFavoriteGoals&&!Y&&!G,s.useCategoricalValues=!!this.featureSwitchService.featureSwitches.goalsCategoricalValues&&(!x||P)&&!n.valueRollup&&!n.targetRollup&&!n.valueConnection&&!n.targetConnection,s.supportMultipleTargetsEditing=!!this.featureSwitchService.featureSwitches.powerBIGoalsMultipleTargets,s.supportMultipleValuesEditing=!!this.featureSwitchService.featureSwitches.goalsMultipleValuesEditor,s.supportsRollup=!!this.featureSwitchService.featureSwitches.goalsRollups,s.editCalculationType=Ae,s.usePickerRollup=s.editCalculationType&&!P,s},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(_n.vZ),e.\u0275\u0275inject(et),e.\u0275\u0275inject(En.Y),e.\u0275\u0275inject(ot,8))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Bs=M(34071),Us=M(98632),js=M(43633),jt=M(59973),wi=M(50911),Fe=M(94420),Qt=M(18942),Go=M(76746),Ws=function(){function i(n,t,r,a,s,c,u){this.store=n,this.datasetStore=t,this.domSanitizer=r,this.groupStoreService=a,this.reportStore=s,this.appSettings=c,this.scorecardHost=u}return i.prototype.getConnectedReport=function(n){var t,r;b.fF.assertValue(n.reportUrl,"No connected report url");var a=null===(t=n.reportUrl.match(/\/reports\/([a-zA-Z0-9\-]+)/))||void 0===t?void 0:t[1],s=null===(r=n.reportUrl.match(/\/groups\/([a-zA-Z0-9\-]+)/))||void 0===r?void 0:r[1];return this.getReport(a,s)},i.prototype.getConnectedReportDisplayName=function(n){var t,r=null===(t=n.reportUrl.match(/\/apps\/([a-zA-Z0-9\-]+)/))||void 0===t?void 0:t[1];return this.getConnectedReport(n).pipe((0,je.U)(function(a){return r?a.ownerFullname:a.displayName}))},i.prototype.goToConnectedReport=function(n){b.fF.assertValue(n.reportUrl,"No connected report url");var r,t=n.reportUrl.indexOf("?")>=0?"&":"?";if(r=this.appSettings.tenantId?"".concat(n.reportUrl).concat(t,"ctid=").concat(this.appSettings.tenantId):n.reportUrl,this.scorecardHost)this.scorecardHost.openReport(r);else{var a=new URL(r,window.location.origin).href;window.open(this.domSanitizer.sanitize(e.SecurityContext.URL,a),"_blank")}},i.prototype.getReport=function(n,t){return this.store.dispatch(new Us.yi({reportObjectId:n,workspaceObjectId:t})),this.store.select(js.W4,{id:n}).pipe((0,jt.h)(function(r){return!!r&&!r.loading}))},i.prototype.getConnectedGoalsWithoutBuildPermissions=function(n){var t,r;return(0,w.__awaiter)(this,void 0,void 0,function(){var a,s,c,u,p,v,P;return(0,w.__generator)(this,function(x){switch(x.label){case 0:return a=[],[4,this.groupStoreService.ensureGroupArtifactsLoaded(Bs.fm,!0)];case 1:x.sent(),s=0,c=n,x.label=2;case 2:return s<c.length?(u=c[s]).valueConnection?[4,this.datasetStore.findDatasetByObjectId(u.valueConnection.datasetId)]:[3,5]:[3,9];case 3:return(!(p=x.sent())||!this.hasDatasetBuildPermission(p))&&a.push(u.name),b.fF.assertValue(u.valueConnection.reportUrl,"No value connected report url"),v=null===(t=u.valueConnection.reportUrl.match(/\/reports\/([a-zA-Z0-9\-]+)/))||void 0===t?void 0:t[1],[4,this.reportStore.findByObjectId(v)];case 4:(!(P=x.sent())||!this.hasReportReadPermission(P))&&a.push(u.name),x.label=5;case 5:return u.targetConnection?[4,this.datasetStore.findDatasetByObjectId(u.targetConnection.datasetId)]:[3,8];case 6:return(!(p=x.sent())||!this.hasDatasetBuildPermission(p))&&a.push(u.name),b.fF.assertValue(u.targetConnection.reportUrl,"No target connected report url"),v=null===(r=u.targetConnection.reportUrl.match(/\/reports\/([a-zA-Z0-9\-]+)/))||void 0===r?void 0:r[1],[4,this.reportStore.findByObjectId(v)];case 7:(!(P=x.sent())||!this.hasReportReadPermission(P))&&a.push(u.name),x.label=8;case 8:return s++,[3,2];case 9:return[2,_.uniq(a)]}})})},i.prototype.hasReportReadPermission=function(n){return(0,ur.yE)(n.permissions,1)},i.prototype.hasDatasetBuildPermission=function(n){return(0,ur.yE)(n?.permissions,3)||(0,ur.yE)(n?.permissions,9)||(0,ur.yE)(n?.userPermissions,9)||(0,ur.yE)(n?.userPermissions,3)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(yt.yh),e.\u0275\u0275inject(wi.s),e.\u0275\u0275inject(Qt.H7),e.\u0275\u0275inject(En.Y),e.\u0275\u0275inject(Fe.R),e.\u0275\u0275inject(Go.de),e.\u0275\u0275inject(ot,8))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),xr=function(){function i(n,t){var r=this;this.scorecardService=n,this.featureSwitches=t,this._expansionMap$=new pe.X({}),this._expandableGoals$=new pe.X([]),this._showAllExpanded$=new pe.X(!1),this.onDestroy$=new Re.xQ,this.expandByDefault=!this.featureSwitches.featureSwitches.collapseGoalsByDefault,this.scorecardService.getScorecard().pipe((0,je.U)(function(a){return _.map(q.filterGoals(a.goals,function(s){return!_.isEmpty(s.subGoals)}),function(s){return s.id})}),(0,I.x)(_.isEqual),(0,ie.R)(this.onDestroy$)).subscribe(this._expandableGoals$),this._expandableGoals$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(a){var s=new Set(a),c=_.pickBy(r.expansionMap,function(p,v){return s.has(v)});if(r._expansionMap$.next(c),r.expandByDefault){var u=_.filter(a,function(p){return _.isNil(r.expansionMap[p])});r.setExpansion(u,!0)}}),this._expansionMap$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(){var a=r.expandedGoalIds.length;0===a?r._showAllExpanded$.next(!1):a===r._expandableGoals$.value.length&&r._showAllExpanded$.next(!0)})}return Object.defineProperty(i.prototype,"expansionMap$",{get:function(){return this._expansionMap$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"expansionMap",{get:function(){return this._expansionMap$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"expandedGoalIds",{get:function(){return _.keys(_.pickBy(this.expansionMap,function(t){return t}))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showAllExpanded$",{get:function(){return this._showAllExpanded$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showAllExpanded",{get:function(){return this._showAllExpanded$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasExpandableGoals$",{get:function(){return this._expandableGoals$.pipe((0,je.U)(function(t){return!_.isEmpty(t)}))},enumerable:!1,configurable:!0}),i.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},i.prototype.isExpanded=function(n){var t;return null!==(t=this.expansionMap[n])&&void 0!==t?t:this.expandByDefault},i.prototype.expandGoal=function(n){this.setExpansion([n],!0)},i.prototype.collapseGoal=function(n){this.setExpansion([n],!1)},i.prototype.expandGoals=function(n){this.setExpansion(n,!0)},i.prototype.collapseGoals=function(n){this.setExpansion(n,!1)},i.prototype.expandAllGoals=function(){this.setExpansion(this._expandableGoals$.value,!0)},i.prototype.collapseAllGoals=function(){this.setExpansion(this._expandableGoals$.value,!1)},i.prototype.toggleExpandAll=function(){this.showAllExpanded?this.collapseAllGoals():this.expandAllGoals()},i.prototype.setExpansion=function(n,t){var r=this;if(_.some(n,function(s){return r.expansionMap[s]!==t})){var a=(0,w.__assign)({},this.expansionMap);_.forEach(n,function(s){a[s]=t}),this._expansionMap$.next(a)}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(et),e.\u0275\u0275inject(_n.vZ))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ai=function(){function i(n,t,r,a,s,c){this.scorecardService=n,this.capabilityService=t,this.overlay=r,this.goalConnectionService=a,this.expansionService=s,this.featureSwitches=c,this.contextMenuOpenGoalId$=new pe.X(void 0),this.onDestroy$=new Re.xQ}return i.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Object.defineProperty(i.prototype,"scorecardSelectionMode",{get:function(){return this.scorecardService.scorecardSelectionMode},enumerable:!1,configurable:!0}),i.prototype.capabilities=function(n){return this.capabilityService.getCurrentGoalCapabilities(n)},i.prototype.canSelectGoal=function(n){var t,r;return null===(r=null===(t=this.capabilities(n).selectGoal)||void 0===t?void 0:t.enabled)||void 0===r||r},i.prototype.isSelected=function(n){var t,r;return null===(r=null===(t=this.scorecardService.getCurrentScorecard())||void 0===t?void 0:t.selectedGoalIds)||void 0===r?void 0:r[n.id]},i.prototype.onRowClick=function(n,t){this.canSelectGoal(n)&&this.scorecardService.toggleSelectedGoal(n.id,!1,this.isClickMultiselect(t))},i.prototype.onNameClick=function(n,t){if(this.canSelectGoal(n))if((_.isNil(this.scorecardSelectionMode)||"ctrl"===this.scorecardSelectionMode)&&1===this.scorecardService.numberOfSelectedGoals()&&this.isSelected(n)&&_.isNil(this.scorecardService.getCurrentScorecard().activeGoalId))this.scorecardService.setActiveGoal(n.id);else{var r=this.isClickMultiselect(t);this.scorecardService.toggleSelectedGoal(n.id,!(r||"single"===this.scorecardSelectionMode),r)}t?.stopPropagation()},i.prototype.onCheckboxClick=function(n,t){this.canSelectGoal(n)&&this.scorecardService.toggleSelectedGoal(n.id,!1,"single"!==this.scorecardSelectionMode),t?.stopPropagation()},i.prototype.getGoalActionIcons=function(n,t,r){var a=this.getGoalActions(n);return _.map(_.filter(r?t?this.featureSwitches.featureSwitches.scorecardCompactView?[a.editGoal,a.openNotes,a.openContextMenu]:[a.openNotes,a.editGoal,a.openContextMenu]:this.featureSwitches.featureSwitches.scorecardCompactView?[a.goToReport,a.toggleFollow,a.openNotes]:[a.goToReport,a.openNotes,a.toggleFollow]:[a.openContextMenu],function(c){return!c.hidden}),function(c){return(0,w.__assign)((0,w.__assign)({},c),{onClick:function(p){c.onClick(),p.stopPropagation()}})})},i.prototype.getGoalMenuOptions=function(n,t,r){var a=this,s=this.getGoalActions(n),c=[];return t?(c=[s.goToReport,s.seeDetails,s.addSubGoal,s.toggleFollow,s.goToLinkedSource,s.deleteGoal],r||c.unshift(s.editGoal)):r?b.fF.assertFail("When action icons are shown, read mode has no context menu"):c=[s.goToReport,s.openNotes,s.toggleFollow],_.map(_.filter(c,function(u){return!u.hidden}),function(u){return(0,w.__assign)((0,w.__assign)({},u),{onClick:function(){u.onClick(),a.overlay.closeAll()}})})},i.prototype.onContextMenuClick=function(n,t,r,a,s){var c=this;this.overlay.isOverlayOpen&&this.overlay.closeAll();var u=this.getGoalMenuOptions(n,a,s),v=t.pointerType?{x:t.x,y:t.y}:r,P=this.overlay.open({component:ye.H,data:{goalActions:u},closeOnBackdropClick:!0,disableForwardClickOnBackdropClick:!0,hasCaret:!1,options:{hasBackdrop:!0,backdropClass:be.L,positionStrategy:this.overlay.position().flexibleConnectedTo(v).withPositions([(0,_e.Iz)(),(0,_e.Kb)(),(0,_e.Zz)(),(0,_e.J7)()]).withPush(!0).withGrowAfterOpen(!0)}});return this.contextMenuOpenGoalId$.next(n.id),P.onClose.subscribe(function(x){return c.contextMenuOpenGoalId$.next(void 0)}),t.stopPropagation(),P},i.prototype.getGoalActions=function(n){var r,a,s,c,t=this,u=this.capabilities(n);return{goToReport:{id:"goToReport",onClick:function(){return t.goalConnectionService.goToConnectedReport(n.valueConnection)},labelKey:"TileMenuOption_GoToReport",iconTooltipKey:"Metrics_Tooltip_Open_Report",iconName:"barchart",iconType:"pbi",hidden:_.isNil(n.valueConnection)},openNotes:{id:"openNotes",onClick:function(){t.canSelectGoal(n)&&t.scorecardService.setActiveGoal(n.id)},labelKey:"OpenNotes",iconTooltipKey:"Notes",iconName:"comment_16_regular",iconType:"tri"},seeDetails:{id:"seeDetails",onClick:function(){return t.scorecardService.setActiveGoal(n.id)},labelKey:"VisualContainer_ShowErrorDetails",iconName:"list",iconType:"pbi"},editGoal:{id:"editGoal",onClick:function(){return t.scorecardService.setGoalState(n.id,"Editing")},labelKey:"Metrics_Tooltip_Edit_Metric",iconName:"edit",iconType:"pbi",disabled:!(null!==(r=u?.editGoal)&&void 0!==r&&r.enabled),disabledTooltipKey:null===(a=u?.editGoal)||void 0===a?void 0:a.disabledMessageKey},toggleFollow:{id:"toggleFollow",onClick:function(){n.isFollowed?t.scorecardService.unfollowGoal(n.id):t.scorecardService.followGoal(n.id)},labelKey:n.isFollowed?"Metrics_Follow_Goals_Unfollow_This_Metric":"Metrics_Follow_Goals_Follow_This_Metric",iconName:n.isFollowed?"alert_16_filled":"alert_16_regular",iconType:"tri",hidden:!u.followGoal},addSubGoal:{id:"addSubGoal",onClick:function(){t.scorecardService.addSubGoal(n.id),t.expansionService.expandGoal(n.id)},labelKey:"NewSubmetric",iconName:"add-multiple",iconType:"pbi",hidden:q.computeGoalLevel(this.scorecardService.getCurrentScorecard().goals,n)>=W.gT.MaxSubGoals,disabled:!(null!==(s=u.createSubgoal)&&void 0!==s&&s.enabled),disabledTooltipKey:null===(c=u.createSubgoal)||void 0===c?void 0:c.disabledMessageKey},deleteGoal:{id:"deleteGoal",onClick:function(){return t.scorecardService.deleteGoal(n.id)},labelKey:n.isLinked?"Metrics_LinkedMetrics_RemoveLinkedMetric":"Metrics_Tooltip_Delete_Metric",iconName:"delete",iconType:"pbi",hidden:!u.deleteGoal},goToLinkedSource:{id:"goToLinkedSource",onClick:function(){return t.scorecardService.openLinkedSourceScorecard(n)},labelKey:"Metrics_LinkedMetrics_GoToSource",iconName:"open_16_regular",iconType:"tri",hidden:!n.isLinked},openContextMenu:{id:"openContextMenu",onClick:function(){return b.fF.assertFail("OpenContextMenu must be set up in template")},labelKey:"Options_Menu",iconName:"pbi-glyph-more-vertical",iconType:"mat"}}},i.prototype.isClickMultiselect=function(n){switch(this.scorecardSelectionMode){case"multiple":return!0;case"ctrl":return n?.ctrlKey;default:return!1}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(et),e.\u0275\u0275inject(hr),e.\u0275\u0275inject(be._),e.\u0275\u0275inject(Ws),e.\u0275\u0275inject(xr),e.\u0275\u0275inject(_n.vZ))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Xt=M(44408),ln=M(86663),gr=M(74913),Mt=M(85102),Kt=["*"],Tr=function(){function i(){this.disableTooltip=!1}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["tooltip-wrapper"]],inputs:{tooltipKey:"tooltipKey",disableTooltip:"disableTooltip"},ngContentSelectors:Kt,decls:3,vars:4,consts:[[1,"tooltip-wrapper",3,"pbiTooltipDisabled","pbiTooltip"]],template:function(t,r){1&t&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275projection(2),e.\u0275\u0275elementEnd()),2&t&&e.\u0275\u0275property("pbiTooltipDisabled",r.disableTooltip)("pbiTooltip",r.tooltipKey?e.\u0275\u0275pipeBind1(1,2,r.tooltipKey):void 0)},dependencies:[qe.V,Mt.F],styles:["[_nghost-%COMP%], .tooltip-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex}"],changeDetection:0}),i}();function Qn(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",11),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.goal.notesCount," ")}}function za(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",8),e.\u0275\u0275listener("click",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext().$implicit;return e.\u0275\u0275resetView(p.onClick(u))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",9),e.\u0275\u0275template(3,Qn,2,1,"span",10),e.\u0275\u0275elementEnd()}if(2&i){var s,r=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("show-btn",a.goal.notesCount>0),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,6,null!==(s=r.iconTooltipKey)&&void 0!==s?s:r.labelKey))("disabled",r.disabled),e.\u0275\u0275advance(2),e.\u0275\u0275property("name",r.iconName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.goal.notesCount>0)}}function Tt(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",12,13),e.\u0275\u0275listener("click",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275reference(1),v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onContextMenuClick(u,p))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"mat-icon",14),e.\u0275\u0275elementEnd()}if(2&i){var s,r=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("space-btn",a.goal.notesCount>0),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(2,4,null!==(s=r.iconTooltipKey)&&void 0!==s?s:r.labelKey))("disabled",r.disabled)}}var We=function(n){return{action:n}};function $s(i,n){if(1&i&&e.\u0275\u0275elementContainer(0,15),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275nextContext(2);var r=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngTemplateOutlet",r)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,We,t))}}function to(i,n){1&i&&(e.\u0275\u0275elementContainerStart(0,4),e.\u0275\u0275template(1,za,4,8,"button",5),e.\u0275\u0275template(2,Tt,4,6,"button",6),e.\u0275\u0275template(3,$s,1,4,"ng-container",7),e.\u0275\u0275elementContainerEnd()),2&i&&(e.\u0275\u0275property("ngSwitch",n.$implicit.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","openNotes"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","openContextMenu"))}function qa(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275template(1,to,4,3,"ng-container",3),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.actions)}}function Ba(i,n){if(1&i&&e.\u0275\u0275element(0,"mat-icon",21),2&i){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("fontIcon",t.iconName)}}function Ua(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",22),2&i){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function Qs(i,n){if(1&i&&e.\u0275\u0275element(0,"tri-svg-icon",9),2&i){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function Xs(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",17)(1,"button",8),e.\u0275\u0275listener("click",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext().action;return e.\u0275\u0275resetView(u.onClick(c))}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275template(3,Ba,1,1,"mat-icon",18),e.\u0275\u0275template(4,Ua,1,1,"pbi-icon",19),e.\u0275\u0275template(5,Qs,1,1,"tri-svg-icon",20),e.\u0275\u0275elementEnd()()}if(2&i){var a,r=e.\u0275\u0275nextContext().action;e.\u0275\u0275property("tooltipKey",null==r?null:r.disabledTooltipKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(2,6,null!==(a=r.iconTooltipKey)&&void 0!==a?a:r.labelKey))("disabled",r.disabled),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","mat"===r.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","pbi"===r.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","tri"===r.iconType)}}function ja(i,n){1&i&&e.\u0275\u0275template(0,Xs,6,8,"tooltip-wrapper",16),2&i&&e.\u0275\u0275property("ngIf",n.action)}var no=function(i){function n(t,r){var a=i.call(this)||this;return a.goalRowService=t,a.changeDetector=r,a.showActionIcons=!0,a.goalRowService.contextMenuOpenGoalId$.pipe((0,I.x)(),(0,ie.R)(a.onDestroy$)).subscribe(function(s){a.contextMenuOpen=a.goal&&s===a.goal.id,a.changeDetector.markForCheck()}),a}return(0,w.__extends)(n,i),n.prototype.ngOnChanges=function(t){(t.goal||t.isEditMode||t.showActionIcons)&&(this.actions=this.goalRowService.getGoalActionIcons(this.goal,this.isEditMode,this.showActionIcons)),i.prototype.ngOnChanges.call(this,t)},n.prototype.onContextMenuClick=function(t,r){this.goalRowService.onContextMenuClick(this.goal,t,r,this.isEditMode,this.showActionIcons)},n.\u0275fac=function(r){return new(r||n)(e.\u0275\u0275directiveInject(ai),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["goal-actions-cell"]],hostVars:2,hostBindings:function(r,a){2&r&&e.\u0275\u0275classProp("context-menu-open",a.contextMenuOpen)},inputs:{goal:"goal",isEditMode:"isEditMode",showActionIcons:"showActionIcons"},features:[e.\u0275\u0275InheritDefinitionFeature,e.\u0275\u0275NgOnChangesFeature],decls:3,vars:1,consts:[["class","goal-actions",4,"ngIf"],["actionIcon",""],[1,"goal-actions"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["class","action-btn","mat-icon-button","",3,"show-btn","pbiTooltip","disabled","click",4,"ngSwitchCase"],["class","action-btn context-menu-btn","mat-icon-button","",3,"space-btn","pbiTooltip","disabled","click",4,"ngSwitchCase"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngSwitchDefault"],["mat-icon-button","",1,"action-btn",3,"pbiTooltip","disabled","click"],["tri-svg-icon-16","",1,"tri-svg",3,"name"],["class","notes-count",4,"ngIf"],[1,"notes-count"],["mat-icon-button","",1,"action-btn","context-menu-btn",3,"pbiTooltip","disabled","click"],["contextMenuBtn",""],["fontIcon","pbi-glyph-more-vertical",1,"glyph-small"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"tooltipKey",4,"ngIf"],[3,"tooltipKey"],["class","glyphicon glyph-small",3,"fontIcon",4,"ngIf"],["size","small","class","icon",3,"name",4,"ngIf"],["tri-svg-icon-16","","class","tri-svg",3,"name",4,"ngIf"],[1,"glyphicon","glyph-small",3,"fontIcon"],["size","small",1,"icon",3,"name"]],template:function(r,a){1&r&&(e.\u0275\u0275template(0,qa,2,1,"div",0),e.\u0275\u0275template(1,ja,1,1,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&r&&e.\u0275\u0275property("ngIf","Saving"!==a.goal.state&&"Deleting"!==a.goal.state)},dependencies:[j.NgForOf,j.NgIf,j.NgTemplateOutlet,j.NgSwitch,j.NgSwitchCase,j.NgSwitchDefault,Xt.Hw,ln._,qe.V,gr.M,Tr,Mt.F],styles:["[_nghost-%COMP%]{display:flex}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{position:relative;padding:0;border:none;background:none;height:100%;width:32px}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:rgba(0,0,0,.05);color:inherit}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:before{vertical-align:middle}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   tri-svg-icon[_ngcontent-%COMP%]{margin-top:-5px}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   .notes-count[_ngcontent-%COMP%]{position:absolute;top:12px;right:0;border-radius:30px;padding:2px 4px;min-width:8px;min-height:8px;font-size:var(--xs-font-size);font-family:var(--fluent-font-family);font-weight:var(--font-weight-regular);background:var(--fluent-theme-primary-color);color:var(--text-primary-content-color-hc)}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn.show-btn[_ngcontent-%COMP%]{display:block;visibility:visible}[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn.space-btn[_ngcontent-%COMP%]{display:block}.context-menu-open[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{display:block!important;visibility:visible!important}.context-menu-open[_nghost-%COMP%]   .goal-actions[_ngcontent-%COMP%]   .action-btn.context-menu-btn[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.05);color:inherit}"],changeDetection:0}),n}(se.w),Er=M(82621);function No(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",6),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("rotate180",!t.valueChange.isIncrease),e.\u0275\u0275property("size",t.arrowSize)}}var ro=function(){return{rounded:!0}};function io(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275template(1,No,1,3,"pbi-icon",3),e.\u0275\u0275elementStart(2,"div",4),e.\u0275\u0275elementContainer(3,5),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(),r=e.\u0275\u0275reference(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!t.valueChange),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",r),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",r)("ngTemplateOutletContext",e.\u0275\u0275pureFunction0(4,ro))}}function Ys(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.isCyclePeriodLabelLocalizable?e.\u0275\u0275pipeBind1(2,1,null==t.valueChange?null:t.valueChange.period):null==t.valueChange?null:t.valueChange.period," ")}}function Wa(i,n){if(1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275template(1,Ys,3,3,"span",7)),2&i){var t=n.rounded,r=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate1(" ",t?r.formattedChangeValue:r.formattedTooltipValue," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.valueChange?null:r.valueChange.period)}}var zr=function(){function i(n,t){this.featureSwitches=n,this.formatValuePipe=t,this.arrowSize="micro",this.nilDisplayString=""}return i.prototype.ngOnChanges=function(n){var t,r,a,s,c,u;if(n.goal){this.valueChange=ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations);var p=null!==(t=this.valueChange)&&void 0!==t&&t.isPercentage?void 0:this.goal.valuesFormatString;this.formattedChangeValue=this.formatValuePipe.transform(null===(r=this.valueChange)||void 0===r?void 0:r.changeAmount,p,!0,this.nilDisplayString),this.formattedChangeValue=null!==(a=this.valueChange)&&void 0!==a&&a.isPercentage?this.formattedChangeValue+"%":this.formattedChangeValue,this.formattedTooltipValue=this.formatValuePipe.transform(null===(s=this.valueChange)||void 0===s?void 0:s.changeAmount,p,!1,this.nilDisplayString),this.formattedTooltipValue=null!==(c=this.valueChange)&&void 0!==c&&c.isPercentage?this.formattedTooltipValue+"%":this.formattedTooltipValue,this.isCyclePeriodLabelLocalizable=ke.r.isCyclePeriodLabelLocalizable(null===(u=this.valueChange)||void 0===u?void 0:u.period)}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(Er.c))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-change-cell"]],inputs:{goal:"goal",arrowSize:"arrowSize",nilDisplayString:"nilDisplayString"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:1,consts:[["class","delta",4,"ngIf"],["valueAndPeriod",""],[1,"delta"],["name","arrow",3,"size","rotate180",4,"ngIf"],[1,"change",3,"pbiTooltip"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["name","arrow",3,"size"],[4,"ngIf"]],template:function(t,r){1&t&&(e.\u0275\u0275template(0,io,4,5,"div",0),e.\u0275\u0275template(1,Wa,2,2,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t&&e.\u0275\u0275property("ngIf",!1!==(null==r.goal||null==r.goal.metadata?null:r.goal.metadata.showPercentChange)&&!(null!=r.goal&&r.goal.valuesCategoryId))},dependencies:[j.NgIf,j.NgTemplateOutlet,ln._,qe.V,Mt.F],styles:["[_nghost-%COMP%]{--container-align-items: center;--arrow-margin: none;--arrow-font-weight: var(--font-weight-regular);--change-font-size: var(--sm-font-size);--change-font-weight: var(--font-weight-regular)}.delta[_ngcontent-%COMP%]{display:flex;align-items:var(--container-align-items);font-size:var(--change-font-size);font-weight:var(--change-font-weight);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.delta[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin:var(--arrow-margin);font-weight:var(--arrow-font-weight)}.delta[_ngcontent-%COMP%]   .rotate180[_ngcontent-%COMP%]{transform:rotate(180deg)}.change[_ngcontent-%COMP%]{margin-left:4px;overflow:hidden;text-overflow:ellipsis}"],changeDetection:0}),i}();function $a(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",t.completionDate),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.completionDate,"\n")}}function Xn(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275text(1,"\u2014"),e.\u0275\u0275elementEnd())}var Ho=function(){function i(n){this.localizationService=n,this.formatOptions={day:"numeric",month:"short",year:"numeric"}}return i.prototype.ngOnChanges=function(){if(this.goal.completionDate){var n=this.localizationService.currentLanguageLocale;this.completionDate=ne.E.treatAsLocalDate(new Date(this.goal.completionDate)).toLocaleDateString(n,this.formatOptions)}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-due-date-cell"]],inputs:{goal:"goal",formatOptions:"formatOptions"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","completion-date",3,"pbiTooltip",4,"ngIf","ngIfElse"],["noValueDash",""],[1,"completion-date",3,"pbiTooltip"],[1,"no-value-dash"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,$a,2,2,"div",0),e.\u0275\u0275template(1,Xn,2,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",r.completionDate)("ngIfElse",a)}},dependencies:[j.NgIf,qe.V],styles:["[_nghost-%COMP%]   .completion-date[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .no-value-dash[_ngcontent-%COMP%]{font-size:var(--lg-font-size);font-weight:var(--font-weight-regular);overflow:hidden}"],changeDetection:0}),i}();function Zs(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",4),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(6);e.\u0275\u0275property("pbiTooltip",t)}}function Js(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Metrics_Tooltip_LinkedHierarchical")," "))}function zo(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",9),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"CurrentValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function qo(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",9),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"Role_DisplayName_TargetValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function Bo(i,n){if(1&i&&(e.\u0275\u0275template(0,zo,6,6,"div",8),e.\u0275\u0275template(1,qo,6,6,"div",8)),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",!t.goal.valueConnection),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.goal.targetConnection)}}function oo(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",5),e.\u0275\u0275template(1,Js,3,3,"div",6),e.\u0275\u0275template(2,Bo,2,2,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(3),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.goal.isLinked)("ngIfElse",t)}}var si=function(){function i(n,t){this.goalRowService=n,this.featureSwitches=t,this.boldName=!1,this.innerIndent=0}return i.prototype.ngOnChanges=function(n){var t;n.scorecard&&(this.showHierarchyTooltips=!_.isEmpty(null===(t=this.scorecard)||void 0===t?void 0:t.hierarchyPaths)&&!this.featureSwitches.featureSwitches.goalsHierarchiesHideInfoTooltips)},i.prototype.onNameClick=function(n){this.goalRowService.onNameClick(this.goal,n)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ai),e.\u0275\u0275directiveInject(_n.vZ))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-name-cell"]],inputs:{goal:"goal",scorecard:"scorecard",boldName:"boldName",innerIndent:"innerIndent"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:7,consts:[["data-testid","goal-name-box",1,"name-box",3,"pbiTooltip","click"],[1,"inner-indent"],["class","name-info","name","info","size","mini",3,"pbiTooltip",4,"ngIf"],["infoTooltip",""],["name","info","size","mini",1,"name-info",3,"pbiTooltip"],[1,"goal-info-tooltip"],[4,"ngIf","ngIfElse"],["manualTooltip",""],[4,"ngIf"],[1,"tooltip-value-label"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275listener("click",function(s){return r.onNameClick(s)}),e.\u0275\u0275element(1,"div",1),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Zs,1,1,"pbi-icon",2),e.\u0275\u0275template(5,oo,4,2,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275classProp("bold-name",r.boldName),e.\u0275\u0275property("pbiTooltip",r.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("width",r.innerIndent+"px"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.showHierarchyTooltips&&(r.goal.isLinked||!r.goal.valueConnection||!r.goal.targetConnection)))},dependencies:[j.NgIf,ln._,qe.V,Mt.F],styles:["[_nghost-%COMP%]{display:flex;flex:1;height:100%;overflow:hidden}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]{flex:1;border:none;padding:0;background-color:transparent;overflow:hidden;white-space:break-spaces;text-overflow:ellipsis;text-align:left}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]:hover{text-decoration:underline}[_nghost-%COMP%]   .name-box.bold-name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]   .name-info[_ngcontent-%COMP%]{margin:0 6px}[_nghost-%COMP%]   .name-box[_ngcontent-%COMP%]   .inner-indent[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0}),i}(),Ks=function(n){return{userEmail:n}};function el(i,n){if(1&i&&e.\u0275\u0275element(0,"user-details-host",5),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(3,Ks,t.owners[0]))("showUserInfo",!0)("showTooltip",!0)}}function tl(i,n){if(1&i&&e.\u0275\u0275element(0,"avatar-row",6),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("emails",t.owners)("numAvatarsToShow",t.avatarRowCount)("rowStyle",t.rowStyle)("avatarSize",t.avatarSize)}}function Qa(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275template(1,el,1,5,"user-details-host",3),e.\u0275\u0275template(2,tl,1,4,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(3),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1===r.owners.length&&!r.alwaysShowAvatarRow)("ngIfElse",t)}}function nl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275text(1,"\u2014"),e.\u0275\u0275elementEnd())}var ao=function(){function i(){this.rowStyle="spread",this.avatarSize="medium",this.avatarRowCount=4}return i.prototype.ngOnChanges=function(n){var t;n.goal&&(this.owners=this.goal.owner?[this.goal.owner]:[],this.goal.additionalOwners&&(t=this.owners).push.apply(t,this.goal.additionalOwners.map(function(r){return r.userPrincipalName})))},i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-owners-cell"]],inputs:{goal:"goal",alwaysShowAvatarRow:"alwaysShowAvatarRow",rowStyle:"rowStyle",avatarSize:"avatarSize",avatarRowCount:"avatarRowCount"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","content",4,"ngIf","ngIfElse"],["emptyOwner",""],[1,"content"],[3,"details","showUserInfo","showTooltip",4,"ngIf","ngIfElse"],["hasMultipleOwners",""],[3,"details","showUserInfo","showTooltip"],[3,"emails","numAvatarsToShow","rowStyle","avatarSize"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,Qa,4,2,"div",0),e.\u0275\u0275template(1,nl,2,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",(null==r.owners?null:r.owners.length)>0)("ngIfElse",a)}},dependencies:[j.NgIf,te.s,Ee],styles:["[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{overflow:hidden}[_nghost-%COMP%]     .user-info{color:var(--scorecard-tableRowForegroundColor)!important;font-family:var(--scorecard-fontFamily)}"],changeDetection:0}),i}(),Ir=function(){function i(){}return i.buildSparklineValues=function(n,t,r){if(void 0===r&&(r=7),t&&n.aggregations)return _.chain(n.aggregations).filter(function(s){return"Sparkline"===s.type}).sortBy(function(s){return new Date(s.timestamp)}).takeRight(r).map(function(s){return{scorecardId:n.scorecardId,goalId:n.id,lastModifiedTime:s.maxLastModifiedTime,timestamp:s.timestamp,value:s.value,valueDisplayString:s.valueDisplayString,createdTime:s.calculationTime,lastModifiedBy:null}}).value();var a=_.sortBy(n.goalValues,function(s){return new Date(s.timestamp)});return _.takeRight(a.filter(function(s){return null!=s.value&&null!=s.timestamp}),r)},i.getSparklineOptions=function(n,t,r){var a,s,c,u,p,v,P,x=q.isDarkMode(),G=ke.r.buildCurrentGoalValue(n),Y=N.p.getGoalStatus(G?.status,t),ue=N.p.getGoalSparklineColor(Y.color,null===(a=r?.scorecardDisplayOptions)||void 0===a?void 0:a.isMobileLayout,x);return{height:null!==(u=null===(c=null===(s=r?.scorecardDisplayOptions)||void 0===s?void 0:s.sparklineOptions)||void 0===c?void 0:c.height)&&void 0!==u?u:48,width:null!==(P=null===(v=null===(p=r?.scorecardDisplayOptions)||void 0===p?void 0:p.sparklineOptions)||void 0===v?void 0:v.width)&&void 0!==P?P:120,lineColor:ue,dotColor:ue,showMin:!1,showMax:!1}},i}(),Si=M(35911),Xa=M(27531),Uo=M(14463),rl=M(66794),so=M(47245),qn=M(61036),Yn=M(29589),In=M(47508),li=M(79154),lo=M(39681),il=M(32379),Ya=M(78843),Za=M(61289),ol=M(26743),Et=M(94419),Dr=M(80777),Ja=M(40956),Ka=M(2330),jo=M(29866),es=M(98136),co=M(232),qr=M(698),Wo=function(n){return{"hide-legend":n}};function ts(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",3)(1,"div",4),e.\u0275\u0275element(2,"div",5),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",4),e.\u0275\u0275element(7,"div",6),e.\u0275\u0275elementStart(8,"span"),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"div",4)(12,"div",7),e.\u0275\u0275element(13,"div",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"span"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd()()()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(12,Wo,"Hidden"==t.legend)),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",t.color),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,6,"Progress")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,8,"Milestones")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,10,"Target_Final"))}}function ns(i,n){if(1&i&&e.\u0275\u0275element(0,"visual-modern",9),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.visualDefinition)("useOnPushChangeDetection",!0)}}var ci="Time",kr="Value",Mi="Targets",Pi="Milestones",$o="FinalTarget",Qo={xAxis:{show:!1},yAxis:{show:!1}},uo=function(){function i(n,t,r,a,s,c,u,p){this.geocoder=n,this.geolocation=t,this.localizationService=r,this.moduleLoader=a,this.promiseFactory=s,this.visualPlugin=c,this.visualHostTooltipServiceFactory=u,this.changeDetector=p,this.showGoalTargets=!1,this.axesOptions={xAxis:{show:!0},yAxis:{show:!0}},this.legend="None",this.showZoom=!1,this.type="LineChart",this.targetLineColor=W.gT.GoalTargetsLineColor,this.onSelected=new e.EventEmitter}return Object.defineProperty(i.prototype,"isComboChart",{get:function(){return"ComboChart"===this.type},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){var t,n=this;this.shadeCurrentArea=null!==(t=this.shadeCurrentArea)&&void 0!==t?t:this.isComboChart,this.visualPlugin.ensureBuiltInPlugins().then(function(){n.initializeVisual(),n.isLoaded=!0,n.changeDetector.detectChanges()})},i.prototype.ngOnChanges=function(n){(n.values||n.color||n.showGoalTargets||n.showAxis||n.targetLineColor||n.axesOptions||n.shadeCurrentArea)&&(this.generateDataView(),this.update())},i.prototype.initializeVisual=function(){var t,n=this,r=(0,lo.ED)((0,so.q)({geocoder:this.geocoder,geolocation:this.geolocation,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.create(),getAzureMapToken:void 0,azureMapsEndpoint:void 0,geocoderIndexedDB:void 0}),function(s){s.persistProperties=function(c,u){return n.persistProperties(c)},s.getLocalizedString=function(c){for(var u,p=[],v=1;v<arguments.length;v++)p[v-1]=arguments[v];return(u=n.localizationService).format.apply(u,(0,w.__spreadArray)([c],p||[],!1))},s.getViewMode=function(){return 0},s.locale=function(){return(0,qn.uD)()},s.promiseFactory=function(){return n.promiseFactory},s.onSelect=function(c){var u;if(!_.isEmpty(c?.visualObjects)){var p=null===(u=_.first(c.visualObjects))||void 0===u?void 0:u.selectorsByColumn;if(p){var v=_.first(p.dataMap[ci]);if((0,il.yN)(v)){var P=(0,ol.KX)(v.expr),x=_.first(P);x&&x.value&&n.onSelected.emit(x.value)}else b.fF.assertFail("Unexpected selector")}}}}),a=In.L.lineChart.name;"AreaChart"===this.type?a=In.L.areaChart.name:"ColumnChart"===this.type?a=In.L.columnChart.name:"ComboChart"===this.type&&(a=In.L.lineClusteredColumnComboChart.name),this.visualDefinition={interactivityOptions:{},type:a,allowInvalidDataView:!0,themeCollection:void 0,viewport:null!==(t=this.viewportSize)&&void 0!==t?t:{height:100,width:100,scale:1},dataTransforms:void 0,hostServices:r,visualAdapterHostServices:{startProgressBar:_.noop,stopProgressBar:_.noop,getNextDataSegment:function(){return(0,w.__awaiter)(n,void 0,void 0,function(){return(0,w.__generator)(this,function(c){return[2,{}]})})}},stylePresetName:void 0,additionalObjectUpdates:_.noop,visualPlugin:this.visualPlugin},this.update()},i.prototype.update=function(){var n,t;if(this.visualDefinition){var r={categoryAxis:[{properties:{show:(0,Et.O7)(this.axesOptions.xAxis.show)}}],valueAxis:[{properties:{show:(0,Et.O7)(this.axesOptions.yAxis.show)}}],dataPoint:[{selector:{metadata:kr},properties:{fill:{solid:{color:(0,Et.fL)(this.color)}}}},{selector:{metadata:Mi},properties:{fill:{solid:{color:(0,Et.fL)(this.targetLineColor)}}}},{selector:{metadata:Pi},properties:{fill:{solid:{color:(0,Et.fL)(this.targetLineColor)}}}},{selector:{metadata:$o},properties:{fill:{solid:{color:(0,Et.fL)(this.targetLineColor)}}}}],lineStyles:[{selector:{metadata:Mi},properties:{lineStyle:(0,Et.fL)("dashed"),strokeWidth:(0,Et.cA)(1.5),showMarker:(0,Et.O7)(!1)}},{selector:{metadata:Pi},properties:{showMarker:(0,Et.O7)(!0),markerSize:(0,Et.cA)(5),markerShape:(0,Et.fL)("circle"),strokeWidth:(0,Et.cA)(0)}},{selector:{metadata:$o},properties:{showMarker:(0,Et.O7)(!0),markerSize:(0,Et.cA)(8),markerShape:(0,Et.fL)("diamond"),strokeWidth:(0,Et.cA)(0)}}],legend:[{properties:{show:(0,Et.O7)(!1)}}],zoom:[{properties:{show:(0,Et.O7)(this.showZoom),showOnValueAxis:(0,Et.O7)(!1)}}]};if(this.isComboChart){for(var a=0,s=r.lineStyles;a<s.length;a++){var c=s[a];!_.isUndefined(c.selector)&&c.selector.metadata!==kr&&(c.properties.areaShow=(0,Et.O7)(!1))}r.lineStyles.push({properties:{areaShow:(0,Et.O7)(this.shadeCurrentArea)}})}this.setAxisFontProperties(r.categoryAxis[0].properties,null===(n=this.axesOptions)||void 0===n?void 0:n.xAxis.fontProperties),this.setAxisFontProperties(r.valueAxis[0].properties,null===(t=this.axesOptions)||void 0===t?void 0:t.yAxis.fontProperties),this.visualDefinition.dataTransforms={objects:r},this.applyDataTransformsForComboIfNeeded(),this.visualDefinition.data={dataView:this.dataView}}},i.prototype.setAxisFontProperties=function(n,t){t&&(t.color&&(n.labelColor={solid:{color:(0,Et.fL)(t.color)}}),t.family&&(n.fontFamily=(0,Et.fL)(t.family)),t.size&&(n.fontSize=(0,Et.gH)(t.size.pt)),t.weight&&(n.bold=(0,Et.O7)(t.weight===li.en)),t.style&&(n.italic=(0,Et.O7)(t.style===li.BF)),t.textDecoration&&(n.underline=(0,Et.O7)(t.textDecoration===li.f0)))},i.prototype.persistProperties=function(n){var t=_.isArray(n)?{merge:n}:n;this.visualDefinition&&this.checkAndApplyDataTransformPropertyChanges(t)},i.prototype.checkAndApplyDataTransformPropertyChanges=function(n){var t;if(t=this.isComboChart?In.L.lineClusteredColumnComboChart.capabilities:In.L.lineChart.capabilities,!_.isEmpty(n.merge)||!_.isEmpty(n.remove)){var a=t.objects;this.update(),(0,rl._6)(n,a,this.visualDefinition.dataTransforms.objects),this.changeDetector.detectChanges()}},i.prototype.onResize=function(n){this.viewportSize={width:n.width,height:n.height,scale:1},this.visualDefinition&&(this.visualDefinition.viewport=this.viewportSize)},i.prototype.generateDataView=function(){var n,t,r,a,s,c,u,p,v,P,x=[{displayName:this.localizationService.get("Date"),queryName:ci,type:Dr.Ge.fromPrimitiveTypeAndCategory(6),roles:{Category:!0}},{displayName:this.localizationService.get("Role_DisplayName_Value"),queryName:kr,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:0,objects:(n={},n[Yn.iu.objectName]=(t={},t[Yn.iu.propertyName]=this.formatString,t),n)}];this.showGoalTargets&&(x.push({displayName:this.localizationService.get("Target"),queryName:Mi,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:1,objects:(r={},r[Yn.iu.objectName]=(a={},a[Yn.iu.propertyName]=this.formatString,a),r)}),x.push({displayName:this.localizationService.get("Target_Milestone_Due"),queryName:Pi,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:2,objects:(s={},s[Yn.iu.objectName]=(c={},c[Yn.iu.propertyName]=this.formatString,c),s)}),x.push({displayName:this.localizationService.get("Target_Final_Due"),queryName:$o,type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Y:!0},index:3,objects:(u={},u[Yn.iu.objectName]=(p={},p[Yn.iu.propertyName]=this.formatString,p),u)})),this.updateColumnsForComboIfNeeded(x);var G=(0,Et.Oh)((0,Et.fL)("Date"),"Date"),Y=null!==(P=this.values)&&void 0!==P?P:[];Y=Y.filter(function(at){return!_.isNil(at.value)||!_.isNil(at.target)}),Y=_.sortBy(Y,function(at){return new Date(at.timestamp)});var ue,Se,Ae=[],xe=[],Be=[];if(this.showGoalTargets){ue=[],Se=[];for(var Je=(v=function(){for(var at=Y.length-1;at>=0;at--)if(!_.isNil(Y[at].target))return[Y[at].target,Y[at].timestamp];return[void 0,void 0]}())[0],ut=v[1],It=function(xt){for(var At=xt+1;At<Y.length&&_.isNil(Y[At].target);)At++;return At<Y.length?Y[At].target:void 0},mt=0;mt<Y.length;mt++){var bt=Y[mt],z=It(mt);ue.push(bt.timestamp),Se.push(bt.value),Ae.push(bt.target!==z&&bt.timestamp!==ut?bt.target:void 0),xe.push(bt.timestamp===ut?bt.target:void 0),_.isNil(bt.target)?Be.push(0===mt?z:mt===Y.length-1?Je:void 0):(Be.push(bt.target),_.isNil(z)||(ue.push(bt.timestamp),Be.push(z),Se.push(void 0),Ae.push(void 0),xe.push(void 0)))}}else ue=Y.map(function(at){return at.timestamp}),Se=Y.map(function(at){return at.value});var fe=[];fe.push({source:x[1],values:Se}),this.showGoalTargets&&(fe.push({source:x[3],values:Ae}),fe.push({source:x[4],values:xe}),fe.push({source:x[2],values:Be}));var Me={metadata:{columns:x},categorical:{categories:[{source:x[0],values:_.map(ue,function(at){var xt=new Date(at),At=ne.E.treatAsLocalDate(xt);return At.epochTimeStamp=xt.getTime(),At}),identity:_.map(ue,function(at){return(0,Ya.TZ)((0,Et.Dg)(G,(0,Et.fL)(at)))})}],values:(0,Za.Yv)(fe)}};this.dataView=Me},i.prototype.updateColumnsForComboIfNeeded=function(n){if(this.isComboChart)for(var t=0,r=0,a=n;r<a.length;r++){var s=a[r];s.queryName!==ci&&(s.roles={Y2:!0}),s.index=t,t++}},i.prototype.applyDataTransformsForComboIfNeeded=function(){if(this.isComboChart){var n=this.dataView.metadata.columns.map(function(a){return{displayName:a.displayName,queryName:a.queryName,roles:a.roles}});this.visualDefinition.dataTransforms.selects=n;var t={};for(var r in n)t[r]=!0;this.visualDefinition.dataTransforms.splits=[{selects:void 0},{selects:t}]}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Ja.i),e.\u0275\u0275directiveInject(Si._1),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(Ka.m),e.\u0275\u0275directiveInject(Uo.t),e.\u0275\u0275directiveInject(jo.D),e.\u0275\u0275directiveInject(es.q),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-history-chart"]],inputs:{values:"values",formatString:"formatString",color:"color",showGoalTargets:"showGoalTargets",axesOptions:"axesOptions",legend:"legend",showZoom:"showZoom",type:"type",shadeCurrentArea:"shadeCurrentArea",targetLineColor:"targetLineColor"},outputs:{onSelected:"onSelected"},features:[e.\u0275\u0275ProvidersFeature((0,w.__spreadArray)([],Xa.H,!0)),e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","legend",3,"ngClass",4,"ngIf"],[1,"linechart-wrapper",3,"on-resize"],["class","linechart",3,"viewModel","useOnPushChangeDetection",4,"ngIf"],[1,"legend",3,"ngClass"],[1,"label"],[1,"square"],[1,"circle","filled"],[1,"square","center-diamond"],[1,"diamond","filled"],[1,"linechart",3,"viewModel","useOnPushChangeDetection"]],template:function(t,r){1&t&&(e.\u0275\u0275template(0,ts,17,14,"div",0),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275listener("on-resize",function(s){return r.onResize(s)}),e.\u0275\u0275template(2,ns,1,2,"visual-modern",2),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("ngIf","None"!=r.legend),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.isLoaded&&!!r.viewportSize))},dependencies:[j.NgClass,j.NgIf,co.y,qr.O,Mt.F],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .linechart-wrapper[_ngcontent-%COMP%]{flex:1;position:relative}[_nghost-%COMP%]   .linechart-wrapper[_ngcontent-%COMP%]   .linechart[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;border-radius:4px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:8px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%], [_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{width:12px;height:12px}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{border-radius:50%}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .center-diamond[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .diamond[_ngcontent-%COMP%]{width:10px;height:10px;transform:rotate(45deg)}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .filled[_ngcontent-%COMP%]{background-color:#8a8886}[_nghost-%COMP%]   .hide-legend[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),i}(),Oi=M(64929);function xi(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-history-chart",1),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",t.options.width+"px")("height",t.options.height+"px"),e.\u0275\u0275property("width",t.options.width)("height",t.options.height)("values",t.values)("formatString",t.goal.valuesFormatString)("color",t.options.lineColor)("showGoalTargets",!1)("axesOptions",t.axesOptions)("legend","None")}}var ui=function(){function i(n,t){this.scorecardService=n,this.scorecardConfigurationService=t,this.axesOptions=Qo}return i.prototype.ngOnChanges=function(n){var r,a,s,t=this;if((n.goal||n.sparklineValues)&&(this.isCategorical=!_.isEmpty(this.scorecardService.getGoalValueCategories(this.goal)),this.values=null!==(r=this.sparklineValues)&&void 0!==r?r:Ir.buildSparklineValues(this.goal,!0).map(function(p){return{value:p.value,timestamp:p.timestamp}})),n.goal||n.height||n.width){var c=null!==(s=null===(a=this.scorecardConfigurationService)||void 0===a?void 0:a.getConfiguration())&&void 0!==s?s:{scorecardDisplayOptions:{isMobileLayout:!1}},u=(0,nt.ZP)(c,function(p){p.scorecardDisplayOptions.sparklineOptions||(p.scorecardDisplayOptions.sparklineOptions={}),t.height&&(p.scorecardDisplayOptions.sparklineOptions.height=t.height),t.width&&(p.scorecardDisplayOptions.sparklineOptions.width=t.width)});this.options=Ir.getSparklineOptions(this.goal,this.scorecardService.getGoalStatuses(this.goal),u)}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(Oi.V,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-sparkline-cell"]],inputs:{goal:"goal",sparklineValues:"sparklineValues",height:"height",width:"width"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[[3,"width","height","values","formatString","color","showGoalTargets","axesOptions","legend",4,"ngIf"],[3,"width","height","values","formatString","color","showGoalTargets","axesOptions","legend"]],template:function(t,r){1&t&&e.\u0275\u0275template(0,xi,1,12,"goal-history-chart",0),2&t&&e.\u0275\u0275property("ngIf",!r.isCategorical&&!r.goal.currentRefreshInProgress&&(null==r.values?null:r.values.length)>1&&r.options)},dependencies:[j.NgIf,uo],changeDetection:0}),i}();function Ti(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",1)(1,"span",2),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(t.style),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",t.text),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.text)}}var Br=function(){function i(n){this.localizationService=n,this.goalStatusHelper=new N.p(this.localizationService)}return i.prototype.ngOnChanges=function(){this.configText(),this.configStyle()},i.prototype.configStyle=function(){if(this.outlineOnly){var n=N.p.getGoalStatus(this.status,this.goalStatuses).color,t=N.p.getGoalSparklineColor(n,this.isMobile,this.isDarkMode);this.style={color:void 0,"background-color":void 0,border:"1px solid ".concat(t)}}else{n=N.p.getGoalStatus(this.status,this.goalStatuses).color;var r=N.p.getGoalStatusTextColor(n,this.isMobile,this.isDarkMode),a=N.p.getGoalStatusColor(n,this.isMobile,this.isDarkMode);this.style={color:r,"background-color":a,border:"none"},this.isMobile&&!this.text.trim().length&&(this.style.visibility="hidden")}},i.prototype.configText=function(){var n,t=null===(n=N.p.getGoalStatus(this.status,this.goalStatuses))||void 0===n?void 0:n.displayName;this.text=this.goalStatusHelper.tryLocalizeDisplayName(t)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["status-icon"]],inputs:{goalStatuses:"goalStatuses",isDarkMode:"isDarkMode",isMobile:"isMobile",outlineOnly:"outlineOnly",status:"status"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","status",3,"style",4,"ngIf"],[1,"status"],[3,"pbiTooltip"]],template:function(t,r){1&t&&e.\u0275\u0275template(0,Ti,3,4,"div",0),2&t&&e.\u0275\u0275property("ngIf",r.text)},dependencies:[j.NgIf,qe.V],styles:[".status[_ngcontent-%COMP%]{height:24px;line-height:24px;padding-left:10px;padding-right:10px;border-radius:12px;white-space:nowrap;text-align:center;font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:-webkit-fill-available;display:inline-block}",'mobile-scorecard-container[_nghost-%COMP%]   .status[_ngcontent-%COMP%], mobile-scorecard-container   [_nghost-%COMP%]   .status[_ngcontent-%COMP%]{height:18px;line-height:18px;padding-left:10px;padding-right:10px;border-radius:12px;white-space:nowrap;text-align:center;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);font-weight:500;text-overflow:ellipsis;overflow:hidden;min-width:35px}'],changeDetection:0}),i}(),po=function(){function i(n){this.scorecardService=n}return i.prototype.ngOnChanges=function(n){n.goal&&(this.status=ke.r.buildCurrentGoalValue(this.goal).status,this.goalStatuses=this.scorecardService.getGoalStatuses(this.goal))},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(et))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-status-cell"]],inputs:{goal:"goal"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:2,consts:[[3,"status","goalStatuses"]],template:function(t,r){1&t&&e.\u0275\u0275element(0,"status-icon",0),2&t&&e.\u0275\u0275property("status",r.status)("goalStatuses",r.goalStatuses)},dependencies:[Br],styles:["[_nghost-%COMP%]{display:flex;flex:1;height:100%;overflow:hidden;align-items:center;justify-content:center}"],changeDetection:0}),i}();function Ei(i){if("number"==typeof i)return i;switch(i.toString().trim().toLowerCase()){case"sum":return 1;case"average":return 2;case"min":return 3;case"max":return 4;default:return void b.fF.assertNever(i)}}function Xo(i){var n;return(n={})[1]=i.get("Rollups_Submetrics_Sum"),n[2]=i.get("Rollups_Submetrics_Average"),n[3]=i.get("Rollups_Submetrics_Min"),n[4]=i.get("Rollups_Submetrics_Max"),n}function Ii(i){if(i?.id){for(var n=[],t={hierarchyId:i.hierarchyId,levels:n};i;)n.push(i.value),i=i.parent;return n.reverse(),t}b.fF.assertFail("Invalid item")}function Ur(i,n){for(var r,t=n,a=function(P){if(!(r=_.find(t,function(x){return x.value===P})))return b.fF.assertFail("Item not found for path"),{value:void 0};t=r.children},s=0,c=i;s<c.length;s++){var p=a(c[s]);if("object"==typeof p)return p.value}return r}function ho(i,n){for(var t=[],r=0,a=i;r<a.length;r++){var s=a[r],c=Ur(s.levels,n[s.hierarchyId]);c&&t.push(c)}return t}function di(i){return _.map(_.filter(i,function(n){return!!n.id}),function(n){return Ii(n)})}var Wr=M(54834);function $r(i){return(0,w.__assign)((0,w.__assign)({},i),{connections:_.map(i.connections,function(n){return function(i,n){var t={datasetId:i.datasetId,levels:_.map(n,function(r){return function(i){return{levelId:i.levelId,fieldExpr:i.field?Wr.ib.deserializeExpr(JSON.parse(i.field)):void 0,filter:i.fieldFilter?Wr.ib.deserializeFilter(JSON.parse(i.fieldFilter)):void 0}}(_.find(i.levels,function(s){return s.levelId===r.id})??{levelId:r.id,field:void 0})})};return i.ownerField&&(t.ownerFieldExpr=Wr.ib.deserializeExpr(JSON.parse(i.ownerField))),t}(n,i.levels)})})}function Qr(i){return{id:i.id,levels:i.levels,name:i.name,scorecardId:i.scorecardId,owner:i.owner,connections:_.map(i.connections,function(n){return function(i){var n={datasetId:i.datasetId,levels:_.map(i.levels,function(t){return function(i){return{levelId:i.levelId,field:i.fieldExpr?JSON.stringify(Wr.ib.serializeExpr(i.fieldExpr)):void 0,fieldFilter:i.filter?JSON.stringify(Wr.ib.serializeFilter(i.filter)):void 0}}(t)})};return i.ownerFieldExpr&&(n.ownerField=JSON.stringify(Wr.ib.serializeExpr(i.ownerFieldExpr))),n}(n)})}}var Zn=M(72489),Di=M(9936),Nn=function(){function i(n,t,r){this.goalsHttpService=n,this.errorService=t,this.localization=r,this._hierarchies$=new pe.X(null),this._hierarchyItems$=new pe.X({}),this._hierarchyErrors$=new pe.X({}),this._isSaving$=new pe.X(!1),this.loadingHierarchyItems=new Set,this.isLoadingHierarchies=!1,this.isSaving$=this._isSaving$,this.hierarchies$=this._hierarchies$.pipe((0,I.x)()),this.hierarchyItems$=this._hierarchyItems$.pipe((0,jt.h)(function(a){return!_.isEmpty(a)}),(0,I.x)()),this.hierarchyErrors$=this._hierarchyErrors$.pipe((0,I.x)()),this.hasHierarchies$=this.hierarchies$.pipe((0,jt.h)(function(a){return!!a}),(0,je.U)(function(a){return!_.isEmpty(a)}),(0,I.x)())}return Object.defineProperty(i.prototype,"hierarchies",{get:function(){return this._hierarchies$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hierarchyItems",{get:function(){return this._hierarchyItems$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hierarchyErrors",{get:function(){return this._hierarchyErrors$.value},enumerable:!1,configurable:!0}),i.prototype.setHierarchies=function(n){this._hierarchies$.next(n)},i.prototype.setHierarchyItems=function(n,t){var r=_.find(this.hierarchies,function(a){return a.id===n});b.fF.assertValue(r,"No hierarchies with id ".concat(n)),this._hierarchyItems$.next((0,nt.Uy)(this.hierarchyItems,function(a){a[n]=t}))},i.prototype.setHierarchyErrors=function(n){this._hierarchyErrors$.next(n)},i.prototype.saveHierarchies=function(){var n;return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a,s,c,u,p,v,x,G,Y,ue,Se,Ae,Be,Je=this;return(0,w.__generator)(this,function(ut){switch(ut.label){case 0:if(!this.hierarchies||!this.scorecardId||this.isLoadingHierarchies)return b.fF.assertFail("Hierarchies not loaded"),[2];if(this._isSaving$.value)return b.fF.assertFail("Save already in progress"),[2];if(_.some(this.hierarchyErrors,function(It){return _.some(It,function(mt){return"Error"===mt.severity})}))return b.fF.assertFail("Save blocked by error"),[2];this._isSaving$.next(!0),ut.label=1;case 1:return ut.trys.push([1,11,12,13]),[4,this.goalsHttpService.getScorecardHierarchies(this.groupId,this.scorecardId).toPromise()];case 2:for(t=ut.sent(),r=_.filter(t,function(It){return!_.some(Je.hierarchies,function(mt){return It.id===mt.id})}),a=[],s=_.filter(_.flatten(_.values(this.hierarchyErrors)),function(It){return"MetricsHierarchy_NoDatasetAccess"===It.code}),c=function(mt){var bt=_.find(u.hierarchies,function(fe){return fe.id===mt.hierarchyId});b.fF.assertValue(bt,"Hierarchy with id ".concat(mt.hierarchyId," not found to clear invalid mapping"));var z=_.find(bt.connections,function(fe){return fe.datasetId===mt.datasetId});b.fF.assertValue(z,"Connection with id ".concat(mt.datasetId," not found to clear invalid mapping")),z.levels.forEach(function(fe){fe.fieldExpr=void 0,fe.filter=void 0})},u=this,p=0,v=s;p<v.length;p++)c(v[p]);x=function(mt){var bt,z,fe,Me;return(0,w.__generator)(this,function(at){switch(at.label){case 0:return mt.isNew?_.some(mt.connections,function(xt){return _.some(xt?.levels,function(At){return!!At?.fieldExpr})})?(z=function(i){var n=Qr(i);return{name:n.name,levels:n.levels,connections:n.connections}}(mt),[4,G.goalsHttpService.createScorecardHierarchy(G.groupId,G.scorecardId,z).toPromise()]):[3,2]:[3,3];case 1:fe=at.sent(),Me=$r(fe),a.push(Me),at.label=2;case 2:return[3,7];case 3:return(bt=_.find(t,function(xt){return xt.id===mt.id}))?[3,4]:(b.fF.assertFail("Cannot updated a deleted hierarchy"),[3,7]);case 4:return _.isEqual(Qr($r(bt)),Qr(mt))?[3,6]:(z=function(i){return{hierarchy:Qr(i)}}(mt),[4,G.goalsHttpService.updateScorecardHierarchy(G.groupId,G.scorecardId,mt.id,z).toPromise()]);case 5:return fe=at.sent(),Me=$r(fe),a.push(Me),[3,7];case 6:a.push(mt),at.label=7;case 7:return[2]}})},G=this,Y=0,ue=this.hierarchies,ut.label=3;case 3:return Y<ue.length?[5,x(ue[Y])]:[3,6];case 4:ut.sent(),ut.label=5;case 5:return Y++,[3,3];case 6:Se=0,Ae=r,ut.label=7;case 7:return Se<Ae.length?[4,this.goalsHttpService.deleteScorecardHierarchy(this.groupId,this.scorecardId,Ae[Se].id).toPromise()]:[3,10];case 8:ut.sent(),ut.label=9;case 9:return Se++,[3,7];case 10:return this.setHierarchies(a),[3,13];case 11:throw Be=ut.sent(),this.errorService.error(this.localization.get("MetricsHierarchy_Cannot_Save_Hierarchies"),"GoalsCannotSaveHierarchies",{requestId:Be?.requestId,statusCode:null===(n=Be?.status)||void 0===n?void 0:n.toString()}),Be;case 12:return this._isSaving$.next(!1),[7];case 13:return[2]}})})},i.prototype.loadHierarchies=function(n,t,r){var a=this;return void 0===r&&(r=!0),this.scorecardId===t&&r&&this.hierarchies||this.scorecardId===t&&this.isLoadingHierarchies||(this.scorecardId=t,this.groupId=n,this.isLoadingHierarchies=!0,this.goalsHttpService.getScorecardHierarchies(n,this.scorecardId).toPromise().then(function(s){if(a.setHierarchies(function(i){return _.map(i,function(n){return $r(n)})}(s)),!r&&!_.isEmpty(a.hierarchyItems))for(var c in a.hierarchyItems)a.loadHierarchyItems(c,!1)}).catch(function(s){throw a.setHierarchies([]),s}).finally(function(){a.isLoadingHierarchies=!1,a.gc()})),this.hierarchies$},i.prototype.loadHierarchyItems=function(n,t){var r=this;return void 0===t&&(t=!0),b.fF.assertValue(this.scorecardId,"No scorecard loaded"),(!t||_.isEmpty(this.hierarchyItems[n])&&!this.loadingHierarchyItems.has(n))&&(this.loadingHierarchyItems.add(n),this.goalsHttpService.getScorecardHierarchyItems(this.groupId,this.scorecardId,n).toPromise().then(function(a){return r.setHierarchyItems(n,function(i){for(var n=_.cloneDeep(i),t=_.groupBy(n,function(p){return p.id}),r=[],a=0,s=n;a<s.length;a++){var c=s[a];if(c.parentHierarchyItemId){var u=_.first(t[c.parentHierarchyItemId]);c.parent=u,u?u.children?u.children.push(c):u.children=[c]:b.fF.assertFail("Parent item missing")}else r.push(c)}return r}(a))}).catch(function(a){var s;b.fF.assertFail("Error loading hierarchy items. "+(null===(s=a?.error)||void 0===s?void 0:s.message)),r.setHierarchyItems(n,[])}).finally(function(){return r.loadingHierarchyItems.delete(n)})),this.hierarchyItems$.pipe((0,je.U)(function(a){return a[n]}),(0,I.x)())},i.prototype.getHierarchyItemsForPath=function(n){var t=this;return _.isEmpty(n)?(0,ae.of)(null):(0,Di.D)(_.map(n,function(r){return t.loadHierarchyItems(r.hierarchyId).pipe((0,jt.h)(function(a){return!!a}),(0,he.q)(1))})).pipe((0,je.U)(function(){return ho(n,t.hierarchyItems)}))},i.prototype.getHierarchyDisplayInfoObservable=function(n){var t=this;return(0,Mn.aj)([n,this.hierarchies$]).pipe((0,je.U)(function(r){return t.getHierarchyDisplayInfo(r[1],r[0])}),(0,Gn.d)({bufferSize:1,refCount:!0}))},i.prototype.getHierarchyDisplayInfo=function(n,t){var a,r=this.localization.get("All"),s=_.map(t,function(v){return(0,w.__assign)((0,w.__assign)({},v),{levels:v.levels.map(function(P){return(0,Zn.WU)(P)})})}),c=_.keyBy(s,function(v){return v.hierarchyId});if(!_.isEmpty(t)){var u=_.map(n,function(v){var P;return _.last(null===(P=c[v.id])||void 0===P?void 0:P.levels)});a=_.join(_.compact(u),", ")}var p=_.map(n,function(v){return _.has(c,v.id)?(0,w.__assign)((0,w.__assign)({},c[v.id]),{hierarchyName:v.name}):{hierarchyId:v.id,hierarchyName:v.name,levels:[r]}});return{showingAll:_.isEmpty(t),displayLabel:a,displayPaths:p}},i.prototype.formatHierarchyItemPath=function(n){var t;return(0,w.__assign)((0,w.__assign)({},n),{levels:n.levels.map(function(r){return(0,Zn.WU)(r)}),hierarchyName:null===(t=this.hierarchies.find(function(r){return r.id===n.hierarchyId}))||void 0===t?void 0:t.name})},i.prototype.getActiveHierarchies=function(n){return _.intersectionWith(this.hierarchies,n,function(t,r){return t.id===r.hierarchyId})},i.prototype.isDatasetMappedToHierarchyPath=function(n,t){if(_.isNil(n)||_.isEmpty(t))return b.fF.assertFail("Expected datasetId and hierarchyPaths to be defined"),!1;var r=this.getActiveHierarchies(t);return _.some(r,function(a){return _.some(a.connections,function(s){return s.datasetId===n&&_.some(s.levels,function(c){return!!c.fieldExpr})})})},i.prototype.isGoalOwnerMappedToHierarchy=function(n,t){if(!n.valueConnection&&!n.targetConnection||_.isEmpty(t))return!1;var r=this.getActiveHierarchies(t);return _.some(r,function(a){var s=_.find(a.connections,function(c){var u,p;return c.datasetId===(null===(u=n.valueConnection)||void 0===u?void 0:u.datasetId)||c.datasetId===(null===(p=n.targetConnection)||void 0===p?void 0:p.datasetId)});return!!s?.ownerFieldExpr})},i.prototype.gc=function(){var n=this,t=new Set(_.map(this.hierarchies,function(a){return a.id})),r=(0,nt.Uy)(this.hierarchyItems,function(a){for(var s=0,c=Object.keys(n.hierarchyItems);s<c.length;s++){var u=c[s];t.has(u)||delete a[u]}});r!==this.hierarchyItems&&this._hierarchyItems$.next(r)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Ye),e.\u0275\u0275inject(Ro.T),e.\u0275\u0275inject(ft.o))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Jn=M(24326),Xr=M(90127);function Yo(i,n){1&i&&e.\u0275\u0275element(0,"pbi-spinner",4)}function vo(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2),r=e.\u0275\u0275reference(4);e.\u0275\u0275property("pbiTooltip",r),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind3(2,2,null==t.currentValue?null:t.currentValue.value,t.categories,t.formatString)," ")}}function Co(i,n){1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1,"/"),e.\u0275\u0275elementContainerEnd())}var Zo=function(n){return{"combined-target":n}};function Jo(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275template(1,Co,2,0,"ng-container",10),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatGoalValue"),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2),r=e.\u0275\u0275reference(6);e.\u0275\u0275property("pbiTooltip",r)("ngClass",e.\u0275\u0275pureFunction1(8,Zo,t.showValueAndTargetCombined)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showValueAndTargetCombined),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(4,4,t.showTarget?null==t.currentValue?null:t.currentValue.finalTarget:null==t.currentValue?null:t.currentValue.nextTarget,t.categories,t.formatString))}}var _o=function(n,t){return{categories:n,compact:t}};function Vr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",5),e.\u0275\u0275template(1,vo,3,6,"div",6),e.\u0275\u0275template(2,Jo,5,10,"div",7),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(3,_o,!!t.categories,t.compact)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showCurrent&&t.hasValueOrConnection),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(t.showTarget||t.showMilestone)&&t.hasTargetOrConnection)}}function Ko(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"CurrentValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueNotConnected")," "))}function yo(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Rollups_Submetrics_Tooltip_Footer")))}function an(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"div",16),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,yo,3,3,"div",10),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2("",e.\u0275\u0275pipeBind4(3,3,null==t.currentValue?null:t.currentValue.value,t.categories,t.formatString,!1)," ",t.valueRollupsString,""),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.canViewAllGoals)}}function as(i,n){if(1&i&&e.\u0275\u0275template(0,an,5,8,"div",12),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(5),r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",(null==r.goal?null:r.goal.valueRollup)&&!(null!=r.goal&&r.goal.isLinked))("ngIfElse",t)}}function ss(i,n){if(1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"formatGoalValue")),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind4(1,1,null==t.currentValue?null:t.currentValue.value,t.categories,t.formatString,!1)," ")}}function ea(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275template(1,Ko,6,6,"div",12),e.\u0275\u0275template(2,as,1,2,"ng-template",null,13,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,ss,2,6,"ng-template",null,14,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(3),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isCurrentValueNotConnectedToHierarchy)("ngIfElse",t)}}function ls(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,2,t.showTarget?"Role_DisplayName_TargetValue":"Role_DisplayName_MilestoneValue")," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueNotConnected")," ")}}function or(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Rollups_Submetrics_Tooltip_Footer")))}function ki(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"div",16),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,or,3,3,"div",10),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2(" ",e.\u0275\u0275pipeBind4(3,3,t.showTarget?null==t.currentValue?null:t.currentValue.finalTarget:null==t.currentValue?null:t.currentValue.nextTarget,t.categories,t.formatString,!1)," ",t.targetRollupsString," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.canViewAllGoals)}}function cs(i,n){if(1&i&&e.\u0275\u0275template(0,ki,5,8,"div",12),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(5),r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",(null==r.goal?null:r.goal.targetRollup)&&!(null!=r.goal&&r.goal.isLinked))("ngIfElse",t)}}function ta(i,n){if(1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275elementStart(2,"div",20),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(1,2,t.showTarget?"Target_Final":"Target_Next")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind4(4,4,t.showTarget?null==t.currentValue?null:t.currentValue.finalTarget:null==t.currentValue?null:t.currentValue.nextTarget,t.categories,t.formatString,!1)," ")}}function bo(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",17),e.\u0275\u0275template(1,ls,6,6,"div",12),e.\u0275\u0275template(2,cs,1,2,"ng-template",null,18,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(4,ta,5,9,"ng-template",null,19,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(3),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isTargetValueNotConnectedToHierarchy)("ngIfElse",t)}}var pi=function(){function i(n,t,r,a){var s=this;this.hierarchyService=n,this.localizationService=t,this.scorecardService=r,this.changeDetector=a,this.currentValue=null,this.canViewAllGoals=!0,this.metricRollups=Xo(this.localizationService),this.scorecardSubscription=this.scorecardService.getScorecard().subscribe(function(c){var u;s.scorecard=c,s.canViewAllGoals=3===Qe(null===(u=s.scorecard)||void 0===u?void 0:u.permissions),s.goal&&(s.setHierarchyTooltips(),s.categories=s.scorecardService.getGoalValueCategories(s.goal)),s.changeDetector.markForCheck()})}return i.prototype.ngOnChanges=function(n){var t=this;n.goal&&(this.formatString=this.goal.valuesFormatString,this.currentValue=ke.r.buildCurrentGoalValue(this.goal),this.hasValueOrConnection=!_.isNil(this.currentValue.value)||!_.isNil(this.goal.valueConnection),this.hasTargetOrConnection=!_.isNil(this.currentValue.finalTarget)||!_.isNil(this.currentValue.nextTarget)||!_.isNil(this.goal.targetConnection),_.isNil(this.goal.valueRollup)||(this.valueRollupsString=this.localizationService.format("Rollups_Submetrics_Tooltip_Header",[this.metricRollups[Ei(this.goal.valueRollup.rollupType)]])),_.isNil(this.goal.targetRollup)||(this.targetRollupsString=this.localizationService.format("Rollups_Submetrics_Tooltip_Header",[this.metricRollups[Ei(this.goal.targetRollup.rollupType)]])),this.categories=this.scorecardService.getGoalValueCategories(this.goal),this.setHierarchyTooltips()),(n.showCurrent||n.showTarget||n.showMilestone)&&(b.fF.assert(function(){return!(t.showTarget&&t.showMilestone)},"GoalValueCell can't show both target and milestone."),this.showValueAndTargetCombined=this.showCurrent&&(this.showTarget||this.showMilestone))},i.prototype.ngOnDestroy=function(){this.scorecardSubscription.unsubscribe()},i.prototype.setHierarchyTooltips=function(){var n,t=!_.isEmpty(null===(n=this.scorecard)||void 0===n?void 0:n.hierarchyPaths);this.isCurrentValueNotConnectedToHierarchy=t&&this.goal.valueConnection&&!this.hierarchyService.isDatasetMappedToHierarchyPath(this.goal.valueConnection.datasetId,this.scorecard.hierarchyPaths),this.isTargetValueNotConnectedToHierarchy=t&&this.goal.targetConnection&&!this.hierarchyService.isDatasetMappedToHierarchyPath(this.goal.targetConnection.datasetId,this.scorecard.hierarchyPaths)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-value-cell"]],inputs:{goal:"goal",showCurrent:"showCurrent",showTarget:"showTarget",showMilestone:"showMilestone",compact:"compact"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:2,consts:[["class","pbi-spinner-medium",4,"ngIf","ngIfElse"],["noRefresh",""],["valueTooltip",""],["targetTooltip",""],[1,"pbi-spinner-medium"],[1,"content",3,"ngClass"],["class","value",3,"pbiTooltip",4,"ngIf"],["class","target",3,"pbiTooltip","ngClass",4,"ngIf"],[1,"value",3,"pbiTooltip"],[1,"target",3,"pbiTooltip","ngClass"],[4,"ngIf"],[1,"goal-current-tooltip"],[4,"ngIf","ngIfElse"],["rollupsValueTooltip",""],["currentValueTooltip",""],[1,"no-hierarchy-label"],[1,"rollups"],[1,"goal-target-tooltip"],["rollupsTargetTooltip",""],["targetValueTooltip",""],[1,"target-value"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,Yo,1,0,"pbi-spinner",0),e.\u0275\u0275template(1,Vr,3,6,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(3,ea,6,2,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,bo,6,2,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",!(null==r.goal||!r.goal.currentRefreshInProgress)||!(null==r.goal||!r.goal.targetRefreshInProgress))("ngIfElse",a)}},dependencies:[j.NgClass,j.NgIf,Jn.k,qe.V,Mt.F,Xr.D],styles:["pbi-spinner[_ngcontent-%COMP%]{display:flex;position:relative;top:3px;left:10px}.content[_ngcontent-%COMP%]{display:flex;overflow:hidden;white-space:nowrap;align-items:baseline;font-size:var(--lg-font-size);font-weight:var(--font-weight-regular)}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--xxlg-font-size);font-weight:var(--font-weight-semi-bold)}.content[_ngcontent-%COMP%]   .combined-target[_ngcontent-%COMP%]{font-size:var(--md-font-size)}.content.categories[_ngcontent-%COMP%]{white-space:nowrap}.content.categories[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--vlg-font-size)}.content.compact[_ngcontent-%COMP%], .content.compact[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--md-font-size)}.no-hierarchy-label[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}.rollups[_ngcontent-%COMP%]{font-weight:var(--font-weight-regular)}.goal-target-tooltip[_ngcontent-%COMP%]{margin-left:4px;margin-right:4px}.goal-target-tooltip[_ngcontent-%COMP%]   .target-value[_ngcontent-%COMP%]{margin-top:4px;text-align:center}"],changeDetection:0}),i}(),rn=M(59968),ar=M(17653),na=M(87088);function wo(i,n,t,r){t&&"function"!=typeof t&&(r=t);var a="function"==typeof t?t:void 0,s=new ir.t(i,n,r);return function(c){return(0,na.O)(function(){return s},a)(c)}}var So=M(46266),Mo=M(41819),Yr=function(i){return i[i.Default=0]="Default",i[i.ShowCheckin=1]="ShowCheckin",i[i.ShowStatusRules=2]="ShowStatusRules",i}({}),vr=function(){function i(n,t,r){this.sideFlyoutService=n,this.scorecardHost=t,this.hierarchyService=r,this.destroy$=new ir.t(1)}return i.prototype.openGoalDetails=function(n,t,r,a){var s=this;n.selectGoal(t);var c=n.getCurrentScorecard(),u=q.getGoal(c.goals,t),p=n.getGoalValueCategoryLists(u),v=n.getGoalStatuses(u),P=this.traverse(n.getActiveGoal(),n).pipe((0,je.U)(function(x){var G,Y=null===(G=c.goals)||void 0===G?void 0:G.findIndex(function(ue){return ue.id===x});return W.gT.ColorPalette[Y>0?Y%W.gT.ColorPalette.length:0]}));this.destroy$&&(this.destroy$.next(!0),this.destroy$.complete()),this.destroy$=new ir.t(1),this.sideFlyoutService.show({componentManifest:{componentId:"GoalsDetailsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goal$:n.getActiveGoal().pipe((0,ar.b)(function(x){x&&n.expandGoalValues(x.id)}),wo(1),(0,So.x)(),(0,ie.R)(this.destroy$)),scorecardHierarchyInfo$:this.hierarchyService?this.hierarchyService.getHierarchyDisplayInfoObservable(n.hierarchyPaths$):(0,ae.of)({showingAll:!0}),openAction:r,scorecardConfiguration:a,goalPreviewColor$:P,goalValueCategories:p,goalStatuses:v,showGoalTargetsInChart$:n.getScorecard().pipe((0,je.U)(function(x){return x.showGoalTargetsInChart})),close:function(){s.sideFlyoutService.hide(),n.unselectAllGoals()},saveGoalValue:function(G,Y){return(0,w.__awaiter)(s,void 0,void 0,function(){var ue,Se,Ae,xe;return(0,w.__generator)(this,function(Be){switch(Be.label){case 0:return[4,n.saveGoalValue(G,Y)];case 1:return Be.sent(),ue=n.getCurrentScorecard(),Se=q.getGoal(ue.goals,G),null===(Ae=this.scorecardHost)||void 0===Ae||Ae.onUpdateScorecard(ue),null===(xe=this.scorecardHost)||void 0===xe||xe.updateCachedGoal(Se),[2]}})})},insertNote:function(G,Y,ue){return n.insertNote(G,Y,ue)},deleteNote:function(G){return n.deleteNote(G)},editNote:function(G,Y,ue,Se){return n.editNote(G,Y,ue,Se)},deleteGoalValue:function(G){return n.deleteGoalValue(G)},saveGoal:function(G){return n.saveGoal(G.id,G)},deleteGoalQueryConnection:function(G,Y){return n.deleteGoalQueryConnection(G,Y)},getRefreshHistory:function(G){return n.getRefreshHistory(G)},refreshGoalValue:function(G,Y){return n.refreshGoalValue(G,Y)},isEditMode$:n.isEditMode(),columnSettings$:n.getColumnSettings(),saveStatusRules:function(G,Y){return n.saveStatusRules(G,Y)},getStatusRules:function(G){return n.getStatusRules(G)},updateGoalValueConnectionSettings:function(G,Y){return n.updateGoalValueConnectionSettings(G,Y)},takeOverConnection:function(G,Y){return n.takeOverGoalQueryConnection(G,Y)},toggleShowGoalTargets:function(G){return n.toggleShowGoalTargetsInChart(G)},followGoal:function(G){return n.followGoal(G)},unfollowGoal:function(G){return n.unfollowGoal(G)}}}})},i.prototype.openGoalStatusRulesPane=function(n,t,r,a){var s=this;this.sideFlyoutService.show({componentManifest:{componentId:"StatusRulesPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goal:t,goalStatuses:n,statusRules:r,close:function(){return s.sideFlyoutService.hide()},saveStatusRules:function(u){return(0,w.__awaiter)(s,void 0,void 0,function(){return(0,w.__generator)(this,function(p){switch(p.label){case 0:return[4,a(u)];case 1:return p.sent(),this.sideFlyoutService.hide(),[2]}})})}}}})},i.prototype.openEditStatusesPane=function(n,t,r){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"EditStatusesPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goalStatuses$:n.getScorecard().pipe((0,je.U)(function(s){return s.goalStatuses}),(0,I.x)()),onSave:t,close:function(){return a.sideFlyoutService.hide()},isReadOnly:r}}})},i.prototype.openScorecardSettingsPane=function(n,t,r){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"ScorecardSettingsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecard$:n.getScorecard(),roles$:n.getScorecard().pipe((0,ar.b)(function(s){n.ensureRolesLoaded()}),(0,je.U)(function(s){return s.roles}),wo(1),(0,So.x)()),scorecardSettingsPaneTabIndex:r,onSave:t,close:function(){return a.sideFlyoutService.hide()},setAsDefaultRole:function(c){return n.setAsDefaultRole(c)},editRole:function(c){return a.openRoleSettingsPane(n,!1,c)},deleteRole:function(c){return n.deleteRole(c)},openRoleSettingsPaneWithNewRole:function(){return a.openRoleSettingsPane(n,!0)}}}})},i.prototype.openScorecardColumnSettingsPane=function(n){var t=this;this.sideFlyoutService.show({componentManifest:{componentId:"ScorecardColumnSettingsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecardService:n,close:function(){return t.sideFlyoutService.hide()}}}})},i.prototype.openCategoryListsEditPane=function(n,t,r){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"CategoryListsEditPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecardService:n,creatingNewList:t,applyChanges:r,close:function(){return a.sideFlyoutService.hide()}}}})},i.prototype.openCategoricalValuesEditPane=function(n){this.sideFlyoutService.show({componentManifest:{componentId:"CategoricalValuesEditPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{goalValueCategoryListsService:n}}})},i.prototype.openRoleSettingsPane=function(n,t,r){var a=this;this.sideFlyoutService.show({componentManifest:{componentId:"RoleSettingsPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{scorecard$:n.getScorecard(),goals$:n.getGoals(),roles$:n.getScorecard().pipe((0,ar.b)(function(s){n.ensureRolesLoaded()}),(0,je.U)(function(s){return s.roles})),close:function(){return a.sideFlyoutService.hide()},cancel:function(){return a.openScorecardSettingsPane(n,function(c){return n.updateScorecard(c)},1)},createRole:function(c){return n.createRole(c)},updateRole:function(c,u){return n.updateRole(c,u)},setAsDefaultRole:function(c){return n.setAsDefaultRole(c)},deleteRole:function(c){return n.deleteRole(c)},addNewRole:t,selectedRoleId:r}},paneClass:"role-settings"})},i.prototype.openBulkEditingPane=function(n,t){var r=this,a=n.getGoalStatuses(),s=n.getGoalValueCategoryLists();this.sideFlyoutService.show({componentManifest:{componentId:"BulkEditingPaneComponentId",modulePath:"@powerbi/GoalsDetailsPane/goals-details-pane.module#GoalsDetailsPaneModule",inputArgs:{selectedGoalIds$:n.getSelectedGoalIdsObservable(),selectedGoals$:n.getSelectedGoalsObservable(),goalStatuses:a,goalValueCategories:s,onSave:t,close:function(){return r.sideFlyoutService.hide()}}}})},i.prototype.closeGoalDetails=function(){this.destroy$&&(this.destroy$.next(!0),this.destroy$.complete()),this.sideFlyoutService.hide()},i.prototype.traverse=function(n,t){var r=this;return n.pipe((0,st.zg)(function(a){return a.parentId?r.traverse(t.getGoal(a.parentId),t):(0,ae.of)(a.id)}))},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Mo.p),e.\u0275\u0275inject(ot,8),e.\u0275\u0275inject(Nn,8))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Zr=M(50057),Fi=M(57746),Vt=M(55710),ra=function(n,t,r){return{hide:n,rotate180:t,"reserve-space":r}},Vi=function(){function i(){this.reserveSpaceWhenHidden=!0}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["sort-icon"]],inputs:{hidden:"hidden",upArrow:"upArrow",reserveSpaceWhenHidden:"reserveSpaceWhenHidden"},decls:1,vars:5,consts:[["fontIcon","pbi-glyph-sortup",1,"glyphicon","glyph-mini","sort-icon",3,"ngClass"]],template:function(t,r){1&t&&e.\u0275\u0275element(0,"mat-icon",0),2&t&&e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(1,ra,r.hidden,r.upArrow,r.reserveSpaceWhenHidden))},dependencies:[j.NgClass,Xt.Hw],styles:[".sort-icon[_ngcontent-%COMP%]{height:12px;width:12px;margin-left:12px}.sort-icon.rotate180[_ngcontent-%COMP%]{transform:rotate(180deg)}.sort-icon.hide[_ngcontent-%COMP%]{display:none}.sort-icon.hide.reserve-space[_ngcontent-%COMP%]{display:inline;visibility:hidden}"],changeDetection:0}),i}();function ia(i,n){if(1&i&&e.\u0275\u0275element(0,"sort-icon",24),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("upArrow",!t.sortType.sortAscending)}}function oa(i,n){1&i&&e.\u0275\u0275element(0,"pbi-icon",25)}function Ai(i,n){1&i&&e.\u0275\u0275element(0,"span",26)}function aa(i,n){1&i&&e.\u0275\u0275element(0,"span",27)}function Ri(i,n){1&i&&e.\u0275\u0275element(0,"span",28)}function Li(i,n){1&i&&e.\u0275\u0275element(0,"span",29)}function hi(i,n){1&i&&e.\u0275\u0275element(0,"span")}function sa(i,n){1&i&&e.\u0275\u0275element(0,"span",30)}function Kn(i,n){1&i&&e.\u0275\u0275element(0,"span",31)}function la(i,n){1&i&&e.\u0275\u0275element(0,"span",32)}function ca(i,n){1&i&&e.\u0275\u0275element(0,"span",33)}function ua(i,n){1&i&&e.\u0275\u0275element(0,"span")}function gi(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"button",34),e.\u0275\u0275element(1,"span",35)(2,"pbi-icon",36),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(27);e.\u0275\u0275property("matMenuTriggerFor",t)}}function Po(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.changeColumnSettings(s.moveColumnLeft,a))}),e.\u0275\u0275element(1,"span",38),e.\u0275\u0275elementEnd()}}function da(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.changeColumnSettings(s.moveColumnRight,a))}),e.\u0275\u0275element(1,"span",39),e.\u0275\u0275elementEnd()}}function pa(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.changeColumnSettings(s.hideColumn,a))}),e.\u0275\u0275element(1,"span",40),e.\u0275\u0275elementEnd()}}function ha(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Oo(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",41),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.showHideColumns())}),e.\u0275\u0275element(1,"span",42),e.\u0275\u0275elementEnd()}}var fi=function(n){return{hidden:n}};function ga(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275template(5,ia,1,1,"sort-icon",3),e.\u0275\u0275template(6,oa,1,0,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-menu",5,6)(10,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var P=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(P.sort(!0))}),e.\u0275\u0275element(11,"pbi-icon",8),e.\u0275\u0275template(12,Ai,1,0,"span",9),e.\u0275\u0275template(13,aa,1,0,"span",10),e.\u0275\u0275template(14,Ri,1,0,"span",11),e.\u0275\u0275template(15,Li,1,0,"span",12),e.\u0275\u0275template(16,hi,1,0,"span",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var P=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(P.sort(!1))}),e.\u0275\u0275element(18,"pbi-icon",8),e.\u0275\u0275template(19,sa,1,0,"span",14),e.\u0275\u0275template(20,Kn,1,0,"span",15),e.\u0275\u0275template(21,la,1,0,"span",16),e.\u0275\u0275template(22,ca,1,0,"span",17),e.\u0275\u0275template(23,ua,1,0,"span",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"mat-divider"),e.\u0275\u0275template(25,gi,3,1,"button",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"mat-menu",19,20),e.\u0275\u0275template(28,Po,2,0,"button",21),e.\u0275\u0275template(29,da,2,0,"button",21),e.\u0275\u0275template(30,pa,2,0,"button",21),e.\u0275\u0275element(31,"mat-divider"),e.\u0275\u0275template(32,ha,1,0,"ng-container",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(33,Oo,2,0,"ng-template",null,23,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=n.ngIf,a=e.\u0275\u0275reference(7),s=e.\u0275\u0275reference(9),c=e.\u0275\u0275reference(27),u=e.\u0275\u0275reference(34),p=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("matMenuTriggerFor",p.column.canSort?s:c),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,26,p.column.name)),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("localize",p.column.name),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(4,28,p.column.name)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",p.column.canSort&&p.sortType.sortBy===p.column.sortBy)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngSwitch",p.column.dataType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(30,fi,p.sortType.sortBy!==p.column.sortBy||!p.sortType.sortAscending)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Date"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Number"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","String"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Status"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngSwitch",p.column.dataType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(32,fi,p.sortType.sortBy!==p.column.sortBy||p.sortType.sortAscending)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Date"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Number"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","String"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Status"),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",p.canMoveLeft(r)||p.canMoveRight(r)||p.column.canHide)("ngIfElse",u),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",p.canMoveLeft(r)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",p.canMoveRight(r)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",p.column.canHide),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",u)}}var mi=function(){function i(n,t){var r=this;this.detailsPaneLauncher=n,this.scorecardService=t,this.onSortColumn=new e.EventEmitter,this.moveColumnLeft=function(a){K.moveColumnLeft(a,r.column.id)},this.moveColumnRight=function(a){K.moveColumnRight(a,r.column.id)},this.hideColumn=function(a){K.hideColumn(a,r.column.id)}}return i.prototype.ngOnInit=function(){this.columnSettings$=this.scorecardService.getColumnSettings()},i.prototype.showHideColumns=function(){this.detailsPaneLauncher.openScorecardColumnSettingsPane(this.scorecardService)},i.prototype.changeColumnSettings=function(n,t){b.fF.assertValue(t,"columnSettingsAction columnSettings");var r=_.cloneDeep(t);n(r),this.scorecardService.updateScorecard({columnSettings:r})},i.prototype.canMoveLeft=function(n){return K.canMoveLeft(n,this.columnIndex)},i.prototype.canMoveRight=function(n){return K.canMoveRight(n,this.columnIndex)},i.prototype.sort=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,w.__generator)(this,function(r){return b.fF.assert(function(){return t.column.canSort},"Cannot sort this column."),this.onSortColumn.emit(this.sortType.sortBy!==this.column.sortBy||this.sortType.sortAscending!==n?{sortBy:this.column.sortBy,sortAscending:n}:W.Ij),[2]})})},i.componentId="ScorecardColumnContextMenuComponentId",i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(et))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-column-context-menu"]],inputs:{column:"column",columnIndex:"columnIndex",sortType:"sortType"},outputs:{onSortColumn:"onSortColumn"},decls:2,vars:3,consts:[[4,"ngIf"],["mat-button","","cdkMonitorElementFocus","",1,"scorecard-column-menu-trigger",3,"matMenuTriggerFor"],[1,"column-name",3,"localize","pbiTooltip"],["class","sort-icon",3,"upArrow",4,"ngIf","ngIfElse"],["chevron",""],["xPosition","after",1,"scorecard-column-menu",3,"overlapTrigger"],["scorecardColumnMenu","matMenu"],["mat-menu-item","",3,"ngSwitch","click"],["size","small","name","checkmark",3,"ngClass"],["localize","Menu_OldestToNewest",4,"ngSwitchCase"],["localize","Menu_Ascending",4,"ngSwitchCase"],["localize","Menu_Sort_AZ",4,"ngSwitchCase"],["localize","Menu_Sort_FromLowPriority",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["localize","Menu_NewestToOldest",4,"ngSwitchCase"],["localize","Menu_Descending",4,"ngSwitchCase"],["localize","Menu_Sort_ZA",4,"ngSwitchCase"],["localize","Menu_Sort_FromHighPriority",4,"ngSwitchCase"],["mat-menu-item","","class","customize-column-button","localizeTooltip","Scorecard_Column_Settings_CustomizeColumn",3,"matMenuTriggerFor",4,"ngIf","ngIfElse"],[1,"scorecard-column-settings-menu",3,"overlapTrigger"],["scorecardColumnSettingsMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],[4,"ngTemplateOutlet"],["columnSettingsButton",""],[1,"sort-icon",3,"upArrow"],["name","chevrondownsmall","size","small",1,"chevrondown"],["localize","Menu_OldestToNewest"],["localize","Menu_Ascending"],["localize","Menu_Sort_AZ"],["localize","Menu_Sort_FromLowPriority"],["localize","Menu_NewestToOldest"],["localize","Menu_Descending"],["localize","Menu_Sort_ZA"],["localize","Menu_Sort_FromHighPriority"],["mat-menu-item","","localizeTooltip","Scorecard_Column_Settings_CustomizeColumn",1,"customize-column-button",3,"matMenuTriggerFor"],["localize","Scorecard_Column_Settings_CustomizeColumn"],["name","chevronrightmedium","size","mini",1,"chevron-right"],["mat-menu-item","",3,"click"],["localize","Menu_MoveLeft","localizeTooltip","Menu_MoveLeft"],["localize","Menu_MoveRight","localizeTooltip","Menu_MoveRight"],["localize","Menu_HideThisColumn","localizeTooltip","Menu_HideThisColumn"],["mat-menu-item","",1,"column-settings-button",3,"click"],["localize","Scorecard_Column_Settings","localizeTooltip","Scorecard_Column_Settings"]],template:function(t,r){1&t&&(e.\u0275\u0275template(0,ga,35,34,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,r.columnSettings$))},dependencies:[j.NgClass,j.NgIf,j.NgTemplateOutlet,j.NgSwitch,j.NgSwitchCase,j.NgSwitchDefault,rn.X,Zr.r,Fi.d,Vt.W0,Vt.tN,Vt.D8,ln._,qe.V,Vi,j.AsyncPipe,Mt.F],styles:[".scorecard-column-menu-trigger[_ngcontent-%COMP%]{padding-left:0;width:100%;border:none;background:none;color:inherit;display:flex;flex-direction:row}.scorecard-column-menu-trigger[_ngcontent-%COMP%]   .column-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.scorecard-column-menu-trigger[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-left:4px;padding-top:4px}  .scorecard-column-menu-trigger .sort-icon .mat-icon{margin:0 4px}  .mat-menu-panel.scorecard-column-settings-menu{min-height:fit-content}  .scorecard-column-menu .mat-menu-item{padding-left:8px}  .scorecard-column-menu .mat-menu-item.column-settings-button{padding-left:32px}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px;padding-right:16px}.mat-menu-item[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:flex;padding-right:8px}.mat-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{height:inherit;display:flex;align-items:center}.mat-menu-item.customize-column-button[_ngcontent-%COMP%]{justify-content:space-between;padding-left:32px}.mat-menu-item.customize-column-button[_ngcontent-%COMP%]   .chevron-right[_ngcontent-%COMP%]{height:inherit;display:flex;align-items:center}"],changeDetection:0}),i}();function fa(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",2)(2,"scorecard-column-context-menu",3),e.\u0275\u0275listener("onSortColumn",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.sortColumn(s))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("column",r.column)("columnIndex",r.index)("sortType",r.sort)}}function vi(i,n){if(1&i&&e.\u0275\u0275element(0,"sort-icon",7),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("reserveSpaceWhenHidden",t.reserveSpaceForSortIcon)("hidden",t.sort.sortBy!==t.column.sortBy)("upArrow",!t.sort.sortAscending)}}function Ci(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",4),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.toggleSort(s.sort,s.column.sortBy))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"span",5),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275template(5,vi,1,3,"sort-icon",6),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("sort-col",r.column.canSort),e.\u0275\u0275attributeInterpolate2("aria-label","",e.\u0275\u0275pipeBind1(1,7,r.column.name)," ",e.\u0275\u0275pipeBind1(2,9,"Sort"),""),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("localize",r.column.name),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(4,11,r.column.name)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.column.canSort)}}var Jr=function(){function i(){this.onSortColumn=new e.EventEmitter,this.reserveSpaceForSortIcon=!0}return i.prototype.sortColumn=function(n){this.onSortColumn.emit(n)},i.prototype.toggleSort=function(n,t){var r=B.toggleSort(n,t);this.onSortColumn.emit(r)},i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-column-header"]],inputs:{column:"column",index:"index",sort:"sort",isEditMode:"isEditMode",reserveSpaceForSortIcon:"reserveSpaceForSortIcon"},outputs:{onSortColumn:"onSortColumn"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["columnNameWithSortIcon",""],[1,"column-menu-sort"],[1,"scorecard-column-context-menu",3,"column","columnIndex","sortType","onSortColumn"],[1,"column-sort",3,"click"],[1,"column-name",3,"localize","pbiTooltip"],[3,"reserveSpaceWhenHidden","hidden","upArrow",4,"ngIf"],[3,"reserveSpaceWhenHidden","hidden","upArrow"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,fa,3,3,"ng-container",0),e.\u0275\u0275template(1,Ci,6,13,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",r.isEditMode)("ngIfElse",a)}},dependencies:[j.NgIf,rn.X,qe.V,mi,Vi,Mt.F],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .column-sort[_ngcontent-%COMP%]{padding-left:0;width:100%;border:none;background:none;color:inherit;display:flex;flex-direction:row;align-items:center;cursor:default}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]     sort-icon mat-icon.sort-icon{font-weight:var(--font-weight-semi-bold)}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:hover     sort-icon mat-icon.sort-icon.hide{display:inline;visibility:visible;color:var(--fluent-theme-neutral-tertia-color)}[_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:focus:hover, [_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .column-sort.sort-col[_ngcontent-%COMP%]:focus:hover:active{background-color:var(--fluent-theme-neutral-lighter-color)}[_nghost-%COMP%]   .column-sort[_ngcontent-%COMP%]   .column-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]   .scorecard-column-context-menu[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:focus:hover, [_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]:focus:hover:active{background-color:var(--fluent-theme-neutral-lighter-color)}[_nghost-%COMP%]   .column-menu-sort[_ngcontent-%COMP%]     sort-icon mat-icon.sort-icon.hide{color:transparent}"],changeDetection:0}),i}(),Gi=M(68233),Ot=(0,w.__assign)((0,w.__assign)({},Gi._),{Default:0,XXXXMidLarge:1736}),Kr=(0,w.__spreadArray)([],Object.values(Ot).sort(function(i,n){return n-i}),!0);function Ar(i,n){for(var t=0,r=Kr;t<r.length;t++){var a=r[t];if(!_.isNil(i[a])&&n>=a)return i[a]}return i[Ot.Default]}var Pn,Dn,Cr,ei,_i,l,h,C,y,m,S,F,A,R,V,k=((Pn={})[0]=((Dn={})[Ot.XXXXXLarge]=584,Dn[Ot.XXXXMidLarge]=562,Dn[Ot.XXXXLarge]=516,Dn[Ot.XXLarge]=438,Dn[Ot.XLarge]=298,Dn[Ot.Large]=292,Dn[Ot.Medium]=258,Dn[Ot.Default]=184,Dn),Pn[1]=((Cr={})[Ot.XXXXLarge]=98,Cr[Ot.XXLarge]=74,Cr[Ot.Default]=40,Cr),Pn[2]=((ei={})[Ot.Default]=76,ei),Pn[3]=((_i={})[Ot.Default]=128,_i),Pn[10]=((l={})[Ot.Default]=106,l),Pn[7]=((h={})[Ot.Default]=64,h),Pn[8]=((C={})[Ot.Default]=64,C),Pn[9]=((y={})[Ot.Default]=64,y),Pn[4]=((m={})[Ot.XXXXXLarge]=156,m[Ot.XXXXLarge]=132,m[Ot.XXLarge]=100,m[Ot.Default]=60,m),Pn[5]=((S={})[Ot.Default]=62,S),Pn[6]={},Pn),J=((F={})[Ot.XXXXXLarge]=32,F[Ot.XXLarge]=24,F[Ot.Default]=16,F),ee=((A={})[Ot.XXXXXLarge]=80,A[Ot.XXXXMidLarge]=58,A[Ot.XXXXLarge]=48,A[Ot.XXLarge]=30,A[Ot.XLarge]=26,A[Ot.Default]=20,A),De=((R={})[Ot.XXXXLarge]={avatarRowSize:"medium",avatarRowCount:4},R[Ot.XXLarge]={avatarRowSize:"small",avatarRowCount:4},R[Ot.Default]={avatarRowSize:"small",avatarRowCount:2},R),wt=((V={})[Ot.XXLarge]=!0,V[Ot.Default]=!1,V),Te=M(21661),re=M(94585),Ne=M(15015),$e=M(22318),Ie=function(){function i(){this.columnResized=new e.EventEmitter}return i.prototype.onMouseDown=function(n){return this.isResizing=!0,this.pageX=n.pageX,this.initialWidth=n.target.parentElement.offsetWidth,document.body.style.cursor="col-resize",n.stopPropagation(),!1},i.prototype.onDragStart=function(){return!1},i.prototype.onMouseMove=function(n){return!this.isResizing||(this.columnResized.emit(Math.max(0,this.initialWidth+n.pageX-this.pageX)),n.stopPropagation(),!1)},i.prototype.onMouseLeave=function(n){return!this.isResizing||(this.isResizing=!1,document.body.style.cursor="",n.stopPropagation(),!1)},i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=e.\u0275\u0275defineDirective({type:i,selectors:[["","resize-column",""]],hostBindings:function(t,r){1&t&&e.\u0275\u0275listener("mousedown",function(s){return r.onMouseDown(s)})("touchstart",function(s){return r.onMouseDown(s)})("dragstart",function(){return r.onDragStart()})("mousemove",function(s){return r.onMouseMove(s)},!1,e.\u0275\u0275resolveWindow)("touchmove",function(s){return r.onMouseMove(s)},!1,e.\u0275\u0275resolveWindow)("mouseup",function(s){return r.onMouseLeave(s)},!1,e.\u0275\u0275resolveWindow)("mouseleave",function(s){return r.onMouseLeave(s)},!1,e.\u0275\u0275resolveWindow)("touchend",function(s){return r.onMouseLeave(s)},!1,e.\u0275\u0275resolveWindow)},outputs:{columnResized:"columnResized"}}),i}(),Pt=["headers"];function Ft(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",14),e.\u0275\u0275listener("click",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onToggleExpandAll(s))}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"mat-icon",15),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("expanded",r.showAllExpanded),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,3,r.showAllExpanded?"FieldListMenuItem_CollapseAll":"FieldListMenuItem_ExpandAll"))}}function yn(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,Ft,3,5,"button",13),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2),r=e.\u0275\u0275reference(9);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,2,t.canExpandAll$))("ngIfElse",r)}}var cn=function(n){return{column:n}};function xo(i,n){if(1&i&&e.\u0275\u0275elementContainer(0,16),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,cn,t))}}function ma(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",17),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.name)}}function us(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",18),e.\u0275\u0275listener("columnResized",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext().index,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onColumnResized(a,s))}),e.\u0275\u0275elementEnd()}}function ul(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,yn,3,4,"div",9),e.\u0275\u0275template(2,xo,1,4,"ng-container",10),e.\u0275\u0275template(3,ma,2,1,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,us,1,0,"div",12),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit,r=n.index,a=e.\u0275\u0275reference(4),s=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",t.width,"px"),e.\u0275\u0275classProp("sticky-left",s.stickyFirstColumn&&0===r),e.\u0275\u0275property("ngClass",t.class)("ngStyle",t.style),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===r),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!t.headerTemplate)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!1!==t.resizable)}}function dl(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function pl(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",24),e.\u0275\u0275listener("dblclick",function(c){return c.stopPropagation()})("click",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(3).$implicit,p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onExpandNode(u,c))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3).$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("expanded",a.treeControl.isExpanded(r))}}function hl(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",22),e.\u0275\u0275template(2,pl,1,2,"button",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(2).$implicit,r=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(9);e.\u0275\u0275advance(1),e.\u0275\u0275property("cdkTreeNodePaddingIndent",r.paddingIndent),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.expandable)("ngIfElse",a)}}var gl=function(n,t){return{column:n,data:t}};function fl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",21),e.\u0275\u0275template(1,hl,3,3,"ng-container",9),e.\u0275\u0275elementContainer(2,16),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit,r=n.index,a=e.\u0275\u0275nextContext().$implicit,s=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("width",t.width,"px"),e.\u0275\u0275classProp("sticky-left",s.stickyFirstColumn&&0===r),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===r),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t.cellTemplate)("ngTemplateOutletContext",e.\u0275\u0275pureFunction2(7,gl,t,a))}}function ml(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cdk-tree-node",19),e.\u0275\u0275listener("click",function(c){var p=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(p.onClick?p.onClick(c):void 0)}),e.\u0275\u0275template(1,fl,3,10,"div",20),e.\u0275\u0275elementEnd()}if(2&i){var r=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(r.style),e.\u0275\u0275classMap(r.class),e.\u0275\u0275styleProp("height",a.rowHeight,"px")("margin-bottom",a.rowSpacing,"px"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",a.columns)("ngForTrackBy",a.trackByColumn)}}function vl(i,n){1&i&&e.\u0275\u0275element(0,"div",25)}var va=function(){function i(){var n=this;this.minBufferPx=400,this.maxBufferPx=1e3,this.enableRowVirtualization=!0,this.onResizeTreeList=new e.EventEmitter,this.onResizeColumn=new e.EventEmitter,this.onExpansionChange=new e.EventEmitter,this.columns=[],this.expandedNodeIds=[],this.rowHeight=50,this.rowSpacing=10,this.paddingIndent=15,this.getChildren=function(t){return t.children},this.rowHash=function(t,r){return r.id},this.treeControl=new re.C2(function(t){return t.level},function(t){return t.expandable},{trackBy:function(r){return r.id}}),this.nodeFlatMapper=function(t,r){return(0,w.__assign)((0,w.__assign)({},t),{level:r,expandable:_.size(n.getChildren(t))>0})}}return i.prototype.ngAfterViewInit=function(){var n,t=this;this.treeFlattener=new Ne.JZ(this.nodeFlatMapper,function(r){return r.level},function(r){return r.expandable},this.getChildren),this.dataSource=new Ne.kc(this.treeControl,this.treeFlattener),this.allRows$=this.dataSource.connect(this.cdkTree).pipe((0,Gn.d)(1)),this.visibleItems$=this.allRows$.pipe((0,Jt.w)(function(r){return t.enableRowVirtualization?t.viewport.renderedRangeStream.pipe((0,$e.O)(t.viewport.getRenderedRange()),(0,je.U)(function(a){return r.slice(a.start,a.end)})):(0,ae.of)(r)})),this.dataSource.data=this.data,(n=this.treeControl.expansionModel).select.apply(n,this.expandedNodeIds),this.setShowExpandAll(),this.canExpandAll$=this.allRows$.pipe((0,je.U)(function(r){return _.some(r,function(a){return a.expandable})})),this.expansionSub=this.treeControl.expansionModel.changed.subscribe(function(r){t.setShowExpandAll(),t.onExpansionChange.emit(r)})},i.prototype.ngOnChanges=function(n){n.data&&this.dataSource&&(this.dataSource.data=this.data,this.setShowExpandAll()),(n.rowHeight||n.rowSpacing)&&(this.totalRowHeight=this.rowHeight+this.rowSpacing)},i.prototype.ngOnDestroy=function(){var n;null===(n=this.expansionSub)||void 0===n||n.unsubscribe()},i.prototype.onExpandNode=function(n,t){this.treeControl.toggle(n),t.stopPropagation()},i.prototype.onToggleExpandAll=function(){var n;this.showAllExpanded?this.treeControl.collapseAll():(n=this.treeControl.expansionModel).select.apply(n,this.getExpandableNodeIds())},i.prototype.trackByColumn=function(n,t){return t.key},i.prototype.trackById=function(n,t){return t.id},i.prototype.scroll=function(){this.headers.nativeElement.scrollLeft=this.viewport.measureScrollOffset("left")},i.prototype.onTreeListResized=function(n){var t=this;requestAnimationFrame(function(){t.onResizeTreeList.emit(n)})},i.prototype.onColumnResized=function(n,t){var r=this;requestAnimationFrame(function(){r.onResizeColumn.emit({column:t,width:Math.max(60,n)})})},i.prototype.setShowExpandAll=function(){var n=this,t=_.filter(this.treeControl.dataNodes,function(a){return a.expandable&&n.treeControl.isExpanded(a)}).length,r=this.getExpandableNodeIds().length;0===t?this.showAllExpanded=!1:t===r&&(this.showAllExpanded=!0)},i.prototype.getExpandableNodeIds=function(){return _.map(_.filter(this.treeControl.dataNodes,function(n){return n.expandable}),function(n){return n.id})},i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["tree-list"]],viewQuery:function(t,r){if(1&t&&(e.\u0275\u0275viewQuery(re._0,7),e.\u0275\u0275viewQuery(Te.N7,7),e.\u0275\u0275viewQuery(Pt,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.cdkTree=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.viewport=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.headers=a.first)}},inputs:{columns:"columns",data:"data",expandedNodeIds:"expandedNodeIds",rowHeight:"rowHeight",rowSpacing:"rowSpacing",paddingIndent:"paddingIndent",getChildren:"getChildren",rowHash:"rowHash",stickyFirstColumn:"stickyFirstColumn"},outputs:{onResizeTreeList:"onResizeTreeList",onResizeColumn:"onResizeColumn",onExpansionChange:"onExpansionChange"},features:[e.\u0275\u0275NgOnChangesFeature],decls:10,vars:12,consts:[[1,"column-headers"],["headers",""],["class","header",3,"ngClass","ngStyle","sticky-left","width",4,"ngFor","ngForOf","ngForTrackBy"],["tabindex","-1",3,"itemSize","minBufferPx","maxBufferPx","scroll","on-resize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[3,"dataSource","treeControl","trackBy"],["class","row",3,"class","style","height","margin-bottom","click",4,"cdkTreeNodeDef"],["expanderPlaceholder",""],[1,"header",3,"ngClass","ngStyle"],[4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf","ngIfElse"],["name",""],["class","resize-handle","resize-column","",3,"columnResized",4,"ngIf"],["tabindex","-1","class","expander expander-all",3,"pbiTooltip","expanded","click",4,"ngIf","ngIfElse"],["tabindex","-1",1,"expander","expander-all",3,"pbiTooltip","click"],["fontIcon","pbi-glyph-doublechevrondown",1,"glyphicon","glyph-mini"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"name"],["resize-column","",1,"resize-handle",3,"columnResized"],[1,"row",3,"click"],["class","cell","role","cell",3,"sticky-left","width",4,"ngFor","ngForOf","ngForTrackBy"],["role","cell",1,"cell"],["cdkTreeNodePadding","",1,"tree-node-padding",3,"cdkTreeNodePaddingIndent"],["tabindex","-1","class","glyphicon expander",3,"expanded","dblclick","click",4,"ngIf","ngIfElse"],["tabindex","-1",1,"glyphicon","expander",3,"dblclick","click"],[1,"expander-placeholder"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275template(2,ul,6,10,"div",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"cdk-virtual-scroll-viewport",3),e.\u0275\u0275listener("scroll",function(){return r.scroll()})("on-resize",function(s){return r.onTreeListResized(s)}),e.\u0275\u0275template(4,dl,1,0,"ng-container",4),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275elementStart(6,"cdk-tree",5),e.\u0275\u0275template(7,ml,2,10,"cdk-tree-node",6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(8,vl,1,0,"ng-template",null,7,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.columns)("ngForTrackBy",r.trackByColumn),e.\u0275\u0275advance(1),e.\u0275\u0275property("itemSize",r.totalRowHeight)("minBufferPx",r.minBufferPx)("maxBufferPx",r.maxBufferPx),e.\u0275\u0275advance(1),e.\u0275\u0275property("cdkVirtualForOf",e.\u0275\u0275pipeBind1(5,10,r.allRows$))("cdkVirtualForTrackBy",r.trackById),e.\u0275\u0275advance(2),e.\u0275\u0275property("dataSource",r.visibleItems$)("treeControl",r.treeControl)("trackBy",r.rowHash))},dependencies:[j.NgClass,j.NgForOf,j.NgIf,j.NgTemplateOutlet,j.NgStyle,re.rO,re.XJ,re._0,re.Hs,qr.O,Xt.Hw,qe.V,Te.xd,Te.x0,Te.N7,Ie,j.AsyncPipe,Mt.F],styles:['[_nghost-%COMP%]{--headerHeight: 40px;--expanderWidth: 48px;--column-headers-backgroundColor: var(--fluent-theme-white-color);--column-headers-foregroundColor: var(--fluent-theme-neutral-primary-color);--row-backgroundColor: var(--fluent-theme-white-color);--row-foregroundColor: var(--fluent-theme-neutral-primary-color);display:flex;flex-direction:column}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{flex:1;width:100%;max-width:100%;display:block}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]:focus{outline:none}cdk-tree-node[_ngcontent-%COMP%]{display:block}.column-headers[_ngcontent-%COMP%]{margin:0;display:flex;padding:8px 0;height:var(--headerHeight);box-sizing:border-box;align-items:center;background-color:var(--column-headers-backgroundColor);color:var(--column-headers-foregroundColor);width:100%;overflow:hidden;z-index:2}.column-headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);font-weight:550;position:relative;border-right:solid 1px var(--gray-70, #BEBBB8);box-sizing:border-box;display:flex;flex-grow:0;flex-shrink:0;overflow:hidden}.column-headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.column-headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;opacity:0;width:10px;cursor:col-resize}.sticky-left[_ngcontent-%COMP%]{position:sticky!important;left:0;z-index:1!important}.sticky-left.cell[_ngcontent-%COMP%]{background-color:var(--row-backgroundColor)}.sticky-left.header[_ngcontent-%COMP%]{background-color:var(--column-headers-backgroundColor)}.row[_ngcontent-%COMP%], .cell[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-grow:0;flex-shrink:0;z-index:0;box-sizing:border-box}.row[_ngcontent-%COMP%]{background-color:var(--row-backgroundColor);color:var(--row-foregroundColor);width:fit-content}.cell[_ngcontent-%COMP%]{overflow:hidden;height:100%}.tree-node-padding[_ngcontent-%COMP%]{height:100%}.expander-placeholder[_ngcontent-%COMP%]{width:var(--expanderWidth);flex-shrink:0}.expander[_ngcontent-%COMP%]{color:var(--gray-180, #252423);transition:transform ease .15s;transform:rotate(-90deg);font-size:var(--sm-font-size, 12px);width:var(--expanderWidth);padding:0 16px;background:transparent;outline:none;display:inline-flex;align-items:center;justify-content:center;height:100%;border:none}.expander.glyphicon[_ngcontent-%COMP%]:before{content:"\\e70d"}.expander.expanded[_ngcontent-%COMP%]{transform:none}.expander[_ngcontent-%COMP%]:focus, .expander[_ngcontent-%COMP%]:hover, .expander[_ngcontent-%COMP%]:focus:hover{background:transparent}.expander[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{padding:2px;font-size:12px;height:unset}'],changeDetection:0}),i}(),_l=["columnHeader"],yl=["nameCell"],bl=["ownersCell"],wl=["statusCell"],Sl=["combinedValueTargetCell"],Ml=["changeCell"],Pl=["currentCell"],Ol=["targetCell"],xl=["milestoneCell"],Tl=["sparklineCell"],El=["dueDateCell"],Il=["blank"],Dl=function(n,t){return{"--column-spacing":n,"--border-left-width":t}};function kl(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tree-list",12),e.\u0275\u0275listener("onResizeColumn",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResizeColumn(s))})("onExpansionChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onExpansionChange(s))})("onResizeTreeList",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResizeScorecard(s))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction2(12,Dl,r.columnSpacing+"px",r.colorBorderWidth+"px")),e.\u0275\u0275classProp("hidden",!r.scorecardWidth),e.\u0275\u0275property("columns",r.columns)("data",r.goals)("expandedNodeIds",r.expandedGoalIds)("getChildren",r.getSubgoals)("rowHash",r.rowHash)("rowHeight",r.rowHeight)("rowSpacing",r.rowSpacing)("paddingIndent",0)}}function Fl(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-column-header",14),e.\u0275\u0275listener("onSortColumn",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(u.onSortColumn.emit(c))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext().column,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("column",r)("index",r.index)("sort",a.sort)("isEditMode",a.isEditMode)("reserveSpaceForSortIcon",!1)}}function Vl(i,n){if(1&i&&(e.\u0275\u0275template(0,Fl,1,5,"scorecard-column-header",13),e.\u0275\u0275pipe(1,"async")),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(1,1,t.hideColumnHeaders$))}}function Al(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275element(1,"goal-name-cell",16)(2,"div",17)(3,"goal-actions-cell",18),e.\u0275\u0275elementEnd()),2&i){var t=n.data,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t)("scorecard",r.scorecard)("boldName",0===t.level)("innerIndent",t.innerIndent*r.innerIndentSpacing),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("width",r.columnSpacing,"px"),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t)("isEditMode",r.isEditMode)("showActionIcons",r.showActionIcons)}}function Rl(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-owners-cell",19),2&i){var t=n.data,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",t)("alwaysShowAvatarRow",!0)("rowStyle","stack")("avatarSize",r.avatarRowSize)("avatarRowCount",r.avatarRowCount)}}function Ll(i,n){1&i&&e.\u0275\u0275element(0,"goal-status-cell",20),2&i&&e.\u0275\u0275property("goal",n.data)}function Gl(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-value-cell",21),2&i){var r,a,t=n.data;e.\u0275\u0275property("goal",t)("showCurrent",!0)("showTarget",null!==(r=null==t.metadata?null:t.metadata.showFinalTarget)&&void 0!==r?r:!t.targetConnection)("showMilestone",!(null!==(a=null==t.metadata?null:t.metadata.showFinalTarget)&&void 0!==a?a:!t.targetConnection))("compact",!0)}}function Nl(i,n){1&i&&e.\u0275\u0275element(0,"goal-change-cell",20),2&i&&e.\u0275\u0275property("goal",n.data)}function Hl(i,n){1&i&&e.\u0275\u0275element(0,"goal-value-cell",22),2&i&&e.\u0275\u0275property("goal",n.data)("showCurrent",!0)("compact",!0)}function zl(i,n){1&i&&e.\u0275\u0275element(0,"goal-value-cell",23),2&i&&e.\u0275\u0275property("goal",n.data)("showTarget",!0)("compact",!0)}function o(i,n){1&i&&e.\u0275\u0275element(0,"goal-value-cell",24),2&i&&e.\u0275\u0275property("goal",n.data)("showMilestone",!0)("compact",!0)}function d(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-sparkline-cell",25),2&i){var t=n.data,r=n.column,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",t)("height",a.rowHeight-10)("width",r.width-a.columnSpacing)}}function g(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-due-date-cell",26),2&i){var t=n.data,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",t)("formatOptions",r.dateFormatOptions)}}var f=function(i){function n(t,r,a,s){var u,p,c=this;return(c=i.call(this)||this).goalRowService=t,c.expansionService=r,c.changeDetector=a,c.scorecardSettings=s,c.onSortColumn=new e.EventEmitter,c.getSubgoals=function(v){return c.getGoalNodes(v.subGoals,v)},c.rowHash=function(v,P){return JSON.stringify(P)},c.rowHeight=42,c.rowSpacing=0,c.dateFormatOptions={day:"numeric",month:"numeric",year:"2-digit"},c.colorBorderWidth=4,c.resizedColumns={},c.innerIndentSpacing=16,c.columnSpacing=20,c.showActionIcons=!1,c.avatarRowSize="smallest",c.avatarRowCount=2,c.hideColumnHeaders$=null===(p=null===(u=c.scorecardSettings)||void 0===u?void 0:u.settings)||void 0===p?void 0:p.pipe((0,je.U)(function(v){return v?.hideColumnHeaders})),c}return(0,w.__extends)(n,i),n.prototype.ngAfterViewInit=function(){var t;this.columnTemplates=((t={})[0]=this.nameCell,t[1]=this.ownersCell,t[2]=this.statusCell,t[3]=this.combinedValueTargetCell,t[10]=this.changeCell,t[7]=this.currentCell,t[4]=this.sparklineCell,t[8]=this.targetCell,t[9]=this.milestoneCell,t[5]=this.dueDateCell,t[6]=null,t)},n.prototype.ngOnChanges=function(t){t.scorecard&&(this.goals=this.getGoalNodes(this.scorecard.goals),this.expandedGoalIds=this.expansionService.expandedGoalIds),(t.scorecard||t.viewSettings)&&this.columnTemplates&&this.recalculateColumnLayout(),i.prototype.ngOnChanges.call(this,t)},n.prototype.onGoalRowClick=function(t,r){this.goalRowService.onRowClick(t,r)},n.prototype.onExpansionChange=function(t){this.expansionService.expandGoals(t.added),this.expansionService.collapseGoals(t.removed)},n.prototype.onResizeScorecard=function(t){this.scorecardWidth=t.width,this.recalculateColumnLayout(),this.changeDetector.markForCheck()},n.prototype.onResizeColumn=function(t){var r=t.width,a=t.column;this.columns[a]&&(this.columns[a].width=r,this.resizedColumns[this.columns[a].id]=r-this.columnSpacing,this.recalculateColumnLayout(),this.changeDetector.markForCheck())},n.prototype.recalculateColumnLayout=function(){this.effectiveBreakpoint=this.getEffectiveBreakpoint(this.scorecardWidth);var t=this.calculateCutoffIndex(),r=this.calculateTotalWidth(this.effectiveBreakpoint,t);this.columns=this.getColumns(t,r),this.setResponsiveSettings()},n.prototype.getEffectiveBreakpoint=function(t){for(var r=0,a=Kr;r<a.length;r++){var s=a[r];if(this.calculateTotalWidth(s)<t)return s}return Ot.Default},n.prototype.calculateCutoffIndex=function(){var t,r=this.scorecard.columnSettings.length;if(null!==(t=this.viewSettings)&&void 0!==t&&t.dropColumns&&this.effectiveBreakpoint===Ot.Default)for(var a=this.colorBorderWidth,s=0;s<this.scorecard.columnSettings.length;s++)if(this.scorecard.columnSettings[s].show&&(a+=this.getBaseColumnWidth(this.scorecard.columnSettings[s].columnId,this.effectiveBreakpoint))>this.scorecardWidth){r=s||1;break}return r},n.prototype.calculateTotalWidth=function(t,r){var s,a=this;return this.colorBorderWidth+_.sumBy(_.filter(null===(s=this.scorecard)||void 0===s?void 0:s.columnSettings.slice(0,r),function(c){return c.show}),function(c){return a.getBaseColumnWidth(c.columnId,t)})},n.prototype.getBaseColumnWidth=function(t,r){var a;return(null!==(a=this.resizedColumns[t])&&void 0!==a?a:Ar(k[t],r))+Ar(ee,r)},n.prototype.getColumns=function(t,r){var s,a=this,c=function(p){var v=a.getBaseColumnWidth(p,a.effectiveBreakpoint);return Math.max(Math.floor(v/r*a.scorecardWidth),v)};return _.map(_.filter(null===(s=this.scorecard)||void 0===s?void 0:s.columnSettings.slice(0,t),function(u){return u.show}),function(u,p){return(0,w.__assign)((0,w.__assign)({},W.Ml[u.columnId]),{cellTemplate:a.columnTemplates[u.columnId],key:u.columnId.toString(),index:p,width:c(u.columnId),headerTemplate:a.columnHeader,resizable:!0})})},n.prototype.setResponsiveSettings=function(){var t=this;this.innerIndentSpacing=Ar(J,this.effectiveBreakpoint),this.columnSpacing=Ar(ee,this.effectiveBreakpoint),this.columns&&this.columns.forEach(function(r){return t.updateSettingsForColumn(r)})},n.prototype.getSettingsForColumn=function(t,r){return function(i,n,t){for(var r=function(v){if(b.fF.assert(function(){return!(!_.isNil(i[v])&&_.isNil(n[v]))},"Associated settings at ".concat(v," have no matching breakpoint in base settings and will not be triggered.")),n[v]<=t&&!_.isNil(i[v]))return{value:i[v]}},a=0,s=Kr;a<s.length;a++){var u=r(s[a]);if("object"==typeof u)return u.value}return i[Ot.Default]}(r,k[t.id],t.width-this.columnSpacing)},n.prototype.updateSettingsForColumn=function(t){var r;switch(t.id){case 0:this.showActionIcons=this.getSettingsForColumn(t,wt);break;case 1:r=this.getSettingsForColumn(t,De),this.avatarRowSize=r.avatarRowSize,this.avatarRowCount=r.avatarRowCount}},n.prototype.getGoalNodes=function(t,r){var a=this;return _.map(_.filter(t,function(s){return!s.isNew&&!s.isHidden}),function(s,c){var u=r?r.level+1:0,p=r?r.color:W.gT.ColorPalette[c%W.gT.ColorPalette.length],v=a.goalRowService.isSelected(s),P=[!1===s.isFilterMatch?"goal-not-match":"",v?"selected-goal":""].join(" ");return(0,w.__assign)((0,w.__assign)({},s),{level:u,color:p,innerIndent:u,style:{"border-left-color":p,"border-color":v?p:""},class:P,onClick:function(G){return a.goalRowService.onRowClick(s,G)}})})},n.\u0275fac=function(r){return new(r||n)(e.\u0275\u0275directiveInject(ai),e.\u0275\u0275directiveInject(xr),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Cn,8))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["compact-scorecard"]],viewQuery:function(r,a){if(1&r&&(e.\u0275\u0275viewQuery(_l,5),e.\u0275\u0275viewQuery(yl,5),e.\u0275\u0275viewQuery(bl,5),e.\u0275\u0275viewQuery(wl,5),e.\u0275\u0275viewQuery(Sl,5),e.\u0275\u0275viewQuery(Ml,5),e.\u0275\u0275viewQuery(Pl,5),e.\u0275\u0275viewQuery(Ol,5),e.\u0275\u0275viewQuery(xl,5),e.\u0275\u0275viewQuery(Tl,5),e.\u0275\u0275viewQuery(El,5),e.\u0275\u0275viewQuery(Il,5)),2&r){var s=void 0;e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.columnHeader=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.nameCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.ownersCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.statusCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.combinedValueTargetCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.changeCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.currentCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.targetCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.milestoneCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.sparklineCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.dueDateCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.blankCell=s.first)}},inputs:{scorecard:"scorecard",isEditMode:"isEditMode",viewSettings:"viewSettings",sort:"sort"},outputs:{onSortColumn:"onSortColumn"},features:[e.\u0275\u0275InheritDefinitionFeature,e.\u0275\u0275NgOnChangesFeature],decls:23,vars:1,consts:[[3,"style","hidden","columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","paddingIndent","onResizeColumn","onExpansionChange","onResizeTreeList",4,"ngIf"],["columnHeader",""],["nameCell",""],["ownersCell",""],["statusCell",""],["combinedValueTargetCell",""],["changeCell",""],["currentCell",""],["targetCell",""],["milestoneCell",""],["sparklineCell",""],["dueDateCell",""],[3,"columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","paddingIndent","onResizeColumn","onExpansionChange","onResizeTreeList"],[3,"column","index","sort","isEditMode","reserveSpaceForSortIcon","onSortColumn",4,"ngIf"],[3,"column","index","sort","isEditMode","reserveSpaceForSortIcon","onSortColumn"],[1,"displayed-name-and-action-wrapper","compact-cell"],[3,"goal","scorecard","boldName","innerIndent"],[1,"actions-spacer"],[3,"goal","isEditMode","showActionIcons"],[1,"compact-cell",3,"goal","alwaysShowAvatarRow","rowStyle","avatarSize","avatarRowCount"],[1,"compact-cell",3,"goal"],[1,"compact-cell",3,"goal","showCurrent","showTarget","showMilestone","compact"],[1,"compact-cell",3,"goal","showCurrent","compact"],[1,"compact-cell",3,"goal","showTarget","compact"],[1,"compact-cell",3,"goal","showMilestone","compact"],[1,"compact-cell",3,"goal","height","width"],[1,"compact-cell",3,"goal","formatOptions"]],template:function(r,a){1&r&&(e.\u0275\u0275template(0,kl,1,15,"tree-list",0),e.\u0275\u0275template(1,Vl,2,3,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(3,Al,4,9,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,Rl,1,5,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(7,Ll,1,1,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(9,Gl,1,5,"ng-template",null,5,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(11,Nl,1,1,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(13,Hl,1,3,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(15,zl,1,3,"ng-template",null,8,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(17,o,1,3,"ng-template",null,9,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(19,d,1,3,"ng-template",null,10,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(21,g,1,2,"ng-template",null,11,e.\u0275\u0275templateRefExtractor)),2&r&&e.\u0275\u0275property("ngIf",a.scorecard)},dependencies:[j.NgIf,zr,va,no,Ho,si,ao,ui,po,pi,Jr,j.AsyncPipe],styles:["[_nghost-%COMP%]{display:flex;flex:1}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]{flex:1;overflow:hidden;--column-headers-backgroundColor: var(--scorecard-tableHeaderBackgroundColor);--column-headers-foregroundColor: var(--scorecard-tableHeaderForegroundColor);--row-backgroundColor: var(--scorecard-tableRowBackgroundColor);--row-foregroundColor: var(--scorecard-tableRowForegroundColor);--border-left-width: 4px;--expanderWidth: 44px}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row{width:100%;border:1px solid var(--fluent-theme-neutral-lighter-color);border-left-width:var(--border-left-width);border-right:none}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row.goal-not-match{opacity:50%}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row.selected-goal{border-right:1px solid}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row goal-actions-cell .action-btn, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row .actions-spacer{display:none;visibility:hidden}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:hover goal-actions-cell .action-btn, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:focus-within goal-actions-cell .action-btn, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:hover .actions-spacer, [_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .row:focus-within .actions-spacer{display:block;visibility:visible}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .column-headers{border-left:var(--border-left-width) solid var(--column-headers-backgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-lighter-color)}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .column-headers .header{border-right:none!important}[_nghost-%COMP%]   tree-list[_ngcontent-%COMP%]     .column-headers .column-name{font-size:var(--md-font-size)}.compact-cell[_ngcontent-%COMP%]{width:100%;padding-right:var(--column-spacing);overflow:hidden}.displayed-name-and-action-wrapper[_ngcontent-%COMP%]{display:flex;height:100%}.displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]{flex:1}.displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]     .name-box{white-space:nowrap}goal-status-cell[_ngcontent-%COMP%]     status-icon{width:100%}goal-status-cell[_ngcontent-%COMP%]     status-icon .status{border-radius:4px;padding:0 2px}goal-due-date-cell[_ngcontent-%COMP%]{font-size:var(--md-font-size)}goal-change-cell[_ngcontent-%COMP%]{--change-font-size: var(--md-font-size)}"],changeDetection:0}),n}(se.w),T=M(50264);function H(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.onLinkToGoalClick())}),e.\u0275\u0275elementEnd()}}function de(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,H,1,0,"button",11),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.canEdit)}}function it(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"div",4)(2,"div",5)(3,"div",6),e.\u0275\u0275elementStart(4,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onNewGoalClick())}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275element(6,"mat-icon",8)(7,"span",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,de,2,1,"ng-container",10),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",!r.canEdit),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(5,3,"NewMetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("pbiFeatureSwitch","goalsLinkedGoals")}}function Ze(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.onCancelScorecard())}),e.\u0275\u0275element(1,"mat-icon",16),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,1,"Metrics_LinkedMetrics_CancelSelectedScorecard")))}function Xe(i,n){if(1&i&&(e.\u0275\u0275element(0,"div",13),e.\u0275\u0275template(1,Ze,5,3,"button",14)),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.onCancelScorecard)}}var lt=function(){function i(n){this.onNewGoal=new e.EventEmitter,this.onLinkToGoal=new e.EventEmitter,this.onCancelScorecard=n?.onCancelSelectedScorecard?function(){return n.onCancelSelectedScorecard()}:void 0}return i.prototype.onNewGoalClick=function(){this.onNewGoal.emit()},i.prototype.onLinkToGoalClick=function(){this.onLinkToGoal.emit()},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ot,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["empty-scorecard"]],inputs:{canEdit:"canEdit",isMetricsPicker:"isMetricsPicker"},outputs:{onNewGoal:"onNewGoal",onLinkToGoal:"onLinkToGoal"},decls:5,vars:2,consts:[[1,"empty-scorecard"],[1,"content"],[4,"ngIf","ngIfElse"],["metricsPickerView",""],[1,"icon"],["localize","ScorecardNoMetricsTitle",1,"title"],["localize","ScorecardNoMetricsDescription",1,"description"],[1,"pbi-fluent-button","primary","new-goal",3,"disabled","click"],["fontIcon","pbi-glyph-add",1,"glyphicon","glyph-small"],["localize","NewMetric"],[4,"pbiFeatureSwitch"],["class","link-to-goal","localize","Metrics_LinkedMetrics_Button_Preview",3,"click",4,"ngIf"],["localize","Metrics_LinkedMetrics_Button_Preview",1,"link-to-goal",3,"click"],["localize","ScorecardNoMetricsInfo",1,"title"],["class","cancel-scorecard-button pbi-fluent-button",3,"click",4,"ngIf"],[1,"cancel-scorecard-button","pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-chevronleftmedium",1,"glyphicon","glyph-mini"]],template:function(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,it,9,5,"ng-container",2),e.\u0275\u0275template(3,Xe,2,1,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(4);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.isMetricsPicker)("ngIfElse",a)}},dependencies:[j.NgIf,rn.X,Xt.Hw,T.P,Mt.F],styles:["[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]{width:100%;height:100%;overflow:auto;display:flex}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:auto;max-width:350px;text-align:center;display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQkAAADwCAMAAAAkXGEzAAADAFBMVEUAAAD50Rr2yhLzyhLzyhLzyRLzyRLzyRHzyBLzyRHzyRLyyRHzyRLzyRHyyRLzyRHyyBH/0hTzyhPyyRHzyRLyyBL0yRPzyRH0yxLzyRLyyRH1yxXzyRH4zRf/3CXzyRH0yhP/+UP0yhP0yRHzyRHzyhHzyRH0yRLyyRHxxxHwxhHvxRHtwxHswhHrwRHpwBHowBHvz0n777v99NDkuxHguBD99dPetRD89dT58tLcsxDnvhH89df2yhL99tn999v88cX55Y3555r44oH99939+OD66Zz444f9+OPzyxz22Fb56Z/++eT++eX9+ef56aL++un8+On9+uv78MD666v66qX+++3+++/+/PH666j99tf888z+++v+/PT+/Pb+/ff+/Pn//vr//vz+/f3u2X3asg/Sqg/Kow/huRDWrxDTrA/11UjyyRf0yxL00DP43m/333hZQD345pZPOxzzzSNWQiX////00j769Nn88sjzyRL++efz1FL222W6lA9FKwv///9PNBHwxhL////9/Pzuyzb04Y3x2G3tyCny1V7qwxv////atBb99dX///7kxELp0Gj67bTsxiDivzHny1jCvbLSy8DfuR7x4JbsxBj79dr58tb16r389+X////79d3279Tz7NT49OX69un////07tj28uT28dr18N/7+Ov//fjv6tr48MvX0Mj48936+O/s5tbz7uD++eT8/Pz29fP89+H69eHm4dPw7OH7+vb////5+Pjw7erby6D8+u/9/fvr59zm4c718+78+/j//Oz////6+fjz7+be2M739fH6+PL9+/Pu7Onr6OHz8u75+PX39evv7ej49vPr5dD+++n7+vnt6uT////8+/r////////////y7+ro49aNgWj9/Pvk3MX//O/////////WzsZPMxP////o5d/o49z////X0cXm4tv////9/f3h0ZX///7////6+ffx7+zn497t6eX39fTm4t3m493j39nz8e77+/r29fTm4dzz8e/5+Pfh3dfkktj7AAABAHRSTlMAEzZVa3yUprnN2d3n7PL7/w08s9XzTYEoYp8vxSAHikIDXHPiZr6b8P//////////////////////////HP//////////////////////////////////////////////////////////////RP///wT/CP8Pzv/+//X///+FFv83/8W3////////0f//1v///////xRA/////////9L//////9T/////////iSj/////6adb///////JlUxS////////48F///7///9z//7//////+3//9r/2dfc//8o5f/w391vIeH//+P9/ubq/+3p8+vx7ubq7fvz+PDaofzxuSMzYQAAH99JREFUeAHs04VhhTAQANCL4nC4u+4/YSeot0DyeTs8eDwet0Io40IapmU7rucHGPie69iWaUjBGSXwAsKIyzhJ8WNpEksehaApkuWxg9/hxHlGQC9FWdn4M3ZVFqAHwioXf8etGAHF1aIJ8C8EjagVPpHb+JfsXMknrUjw7yWiBaV0zMT/YrJOnRW9h//J69VYMsT4/+IBbm6cLDyHNY1wX9284HmWuYN76riL53J5d8cX64LnW9bbHWEOXsNhcCf1htfZargLsuO1dgJ3MPIDr3bw8Y26urqRIIihKLqqBMrLzGgoGGjOP66l72ay5sgRXOnJR+qu7qAJ9gaT3V1pf85LW9+AiHgAIprYw16qflRzBnXwL4M46c3JXwyESc6MXohX2xCCxfsQYm8heC88NYV91XoZp9AYYrPdDbTdTE8BpypPxLxBUwkJ291g2yCTS8CbUVlGA2K/342w90wwlX1VWEZziZCkIyRhagmFhZy8QTOSmOV5Wgy7PM+iEMzg7UR/Gf+QXSzzEcroGAHgcBbyfANtkKUaV6ISxh/u62A3bSAI47hAuaL9FBuCkMUh+NBzKkU9EAgJJG4CxLjN2nn/Fykbf6vS1lLxesct+YsDO8ffYeSBl0atfHyPA/z3EgjGLezKCEdITB3yKYFIfG/ehDgJCYQ3wpdnjBORQDyUhOj2cJzEzCHPEuh15SAGfZyQBPoDKYhLhWMl5ux2YbqaV3a1MN3ap3cJqEshCKC2xB1M99US9zDdiUgwEYqBqiGxZJRYVkYJ+5SQUAOBZdnHCUqg731tDnuoI7FilFhVRgn7FJFAb+j5gyrGiUog9vqJ1QnhJvEA02O1xCNMD8ISCDsej64INSWS1XsJJZJVYtv/3c/f35TgXEwC0djbGR6gtgSzEsn1V9NTYjuUYGISCHwd6SM4Szxbic8wVUk8y0tg5AdigsYS6+T6F4l1st7/KGFnghKY+IA4Vw4SG0aJzeZLKbE5jBL2KSmhzptDdGI4SGwZJbZbSmwPo4R9Skog7jSWCPAhJBBILIkaEi9/l3gRkBBYFV3lJpGm6S7d7VJKpOm0lODclO4okZr/+7mwhOq2uiSsRMYokWWUMLNv302bLKNExgQlmq+KAAISTzBN5SQEVsUETSVeYVpUSMzal8CkxSVhJbTWmf4pobMZJfZzK6EXML2amRaUaL4qxiHcJZiV0PNSwsxKibm2EprJSyB0u8UuICCR539I5FrnZt6CBC5cIIaqgUTOKJHnlDAzSuS5lWBtSKihwykewafE8neJ5T+RQFT/QD9DE4mCvZUSRUEJM6NEUZQSbwVrRQJndSE6n7xI/GDuPNjTRrYw7N7AlwMh7uVyl4V4+6Z3F8JiuT/YuLftBUxLYc1u2j+/YggayRmfkXQ0it/0Ht4HSTOfPh3v/9DgYHf3kH3nZuPnbrLvHu7uHrDv7Ptr4ka7QxNJIJk4coE/JiDpTMQ4fHoTqorf445MJD6xCZXF74QTEZ1ANHF8cnJ8cnx88uHbBifin9P58PPchOLid6eDK2iAauLEBdyE4uJ3wP6V9HP4pCaUF78/t73hiHtl4vTkVP98wkF+/pSbUF38jk+pXlRxE6fO4SbUF7+7bL4lgnQTP7qAm1Be/A5OqctnrG1lVyZYW5la/PYys4nFgQR7IT+5gL0Qn4rf8Zh3dSr0qYZ7Rz875ugee3NT684eFrD66Sa+ufPLsVMRx7/c+cZHE/02BmkAlZkvvr7962+/O+S3X29//cWMrOQ7l7t/PzfnRclXPsqjj25CPzz++PXPvxzx569/6AcHauIgk9cAbt0C0PKZA6qJPmlmB1TYyuib23/88ccd2+i/+fY3rXWR2MTcUgF0mAmdwtIczQTIcrxp8ETFF/qm6JuvbfONvtkyNlCiuvP9lAZN7t6FJlrqPqnuPC1ZVQ0CHeKmWmDiIA8t7t+HFvkDionBKUXb8fhZ+CwO9KCF1505c0UQmYCi0fl2U3fuVHS+PNP/9BmWH+LBKGbiVhHEJqB4i2ACPWdOgmsacz3DcDmTk+Cs7szJg4nHj8FE3vz7HJqAScRENyh7T7S1uTWRgstNQIpgohsxEQXaecI7E2mDAw3M7O+DGe0gbeDURJSwmBgEHBUmSmDh6VOwUHJvAkbc3xPuBSfMmGlrm7kcxMStApgoltPpchFMFG6JTdDuFw8ATv+Q+/VEpeJgPcGL3+kqcLRcs/id04BTXXRd/B5wfbvnv/htY3Q6y/PndkJ6bqLFEhi8mGv95NwLMFhadF93Hnd55ejRL7PXQY4wpH/50m5IbzWhgcHCosECGGhiE6SrxwSgJBvL08gAyBCH9K9e2QzprSZugUFthZtYqYHBLffF7wmxiPYQIETPWnOb4oDAQ3rEBBrSW4vfN8GgvGqiDAY33Re/Q+2O9xzBMeOQiiSjgMBDesQEFtJbS75bYLCwZmIBDLYIJd9ON49xjDF/4STIEIf0f/8tD+kFJvbAYNm+CeKDH0HACU7qIgYAhYf0D+5aP9/Xv2CfeUhvMbEJBmWziTIYbBJMBN2lVRMx2fuGHtJfLH7fB4PaBqNZ/K6BwX1B8Zu0zBwFKV1nIIMeTVtLvmsaGOSyBuar6Aal5Dvq7mmviV7fTWSXTAurbItz88oqKzdRH3ByohgAKfUAgPpJHFYTVZOI2a0sw7LaXrBhYmLMwYK7Heh4ZoIXv7NPC4aIZzWopbLZCzuw2W158Xvo8gr6xyuKoStmwqD0QcS2LkJndRUslPjvFJgwYuyuy1QMkVvaCmaSiE08LjREnG+nmQj45x8wo83ubOPF7/oEe7HjvVGbO/NrV8vEDifTELGjixCZyOxwxCaivWx5PDRRt/n4S9xTE7MuEJlg/KuLWKxBk40NMLG0g5tghLqQO1rxiyLCcLVM7JpIn+8aIqwmiov8dyF151DHEBbKW4l4a+KZC8QmGKZN+OGhScT+ri0TMIYEDhF6y0ypiSML6bzIRH7VbvF7oG6/fdbjrYk0ytNUmYfzN1vfEZjgZAoXTWjzO55U4HvIlw6CiSWAFy0BT4uYCc5sqeliexsaFF4/w4rfhGcnoz6amAcdbSvNeA0WE0jxO73wb6FpQsv/sIEXvwn3f64DGWFIb0xjMUifa9CgsP4hmrWG9Hjdefbm0dFmGq07O+U6fdeBmkDIm+5UzGkA1miaXvzGkO88OvwzwY6NIjTIzBZBYIJW/HZMh+00l2iCT2Nh32XHRnH59Ywh5GJITy9+U1LdLo9NrF5KHgAK88vLpQI0qVlDenrxm/a0YLfHJtYuIwM6r5d1yho0eLFgDWTpxW+UoOxGWI9PJs4LAFBbZmQaKgqZZasJevEb48Y12dKqV6WJar78bK1JjS0Ol5vMv2BvD6sJevEbo0/w5u8lN83k01lY+L6RYsfARoMM6JTWWyyUUvrX1pCeXvzG6ByRNc/6PTaR5WwBo7aZzc6xY2P9AtZAll78RojG2nolZfYBZSZ4Ter1fXZsVOUmRMXvN29sFr8RQuNs9A4abwdUmUgXQacABqV1qQlh8fvtW3vFb4T6kHBkeMDOPVHadBbjxs3rqpG01HLruXX9c67xLUM0nUVQ/H7+3F7xW/4Rkdp7sXujg96bYKRAJ5/L5VIvANixkfuI1u/Fn6auVEhPUwf7THH+SHdfEAwG6VtRuYktYEvrnM76aw0AyrmPQKazyLp7HJAw0NvNh8jGRvvql25GQx6b2Gmimd8GC0vFUk6AJZom9Dm7w92AEEq2iz+IWchiAtSYAJ1UTgJu4rPP7JoIywL6wAjbbIbgAkrfE7tNAOB1TgYSTXMDhPcEJx4WDekKqTxPcBP5PSl0E7bpbYtF4SL/UXrtOGoCxXW5CR7IKjcBk6PAEV47gmpMaNW9q2ViuE/WtYqDUxIhGyZSe65NDA2pMHGtLjiREvcdgS4b01m27CAM6bkBT02I3vsD1L1opIcJSWCTODa35GyeNKGZINBPzSeSseGJZKQrpGBOjb8m+oiZFWt/x3pUTGfx2UQvNcccFleS6CG93yZ6iC2rnpjoOQhKSC82EQ6rNjFMut8R6ookJ4ZjSY+nswhMJBKqTXSR7oElAqDTE3E+neXnn+2F9PyVqzbxPy/ui3YFnE9neYeH9P6biHhxrzyUcDyd5d07PKT33wSLcDh18Aw8pH//Hg/pfTcRihE6NZTpLO/f4yG97yYCynpW4pAeT+t5SO+/iQShe0eazvL8ORLSC1759LRiE0nCIEjSdJZKBQnpBSZiMcUmuukdXbkPMzduIGk9cHxfbQ8p623jM0lkr8h/E5OKuvzIK6OYYCaVcJ38fAfdBJ7Q89+PTfyhM0F+5oduAr9rw3+/34PIh67ue8Lnj/PSfpXPE/TIXb7/4gxcVRPEyB0nNEX8iJHqTYyM8N9PitxxJvBx4/ShVnQT9Tr//aTIHacHnzVAH3RGN8H/nJvInTaKIw4I5OF34TDFBD1yl8c0nKTS98TEBMEEIXLHiRNmYxKG3xFMECN3fF3l+4pCsYmPI3f300L71XuYman8n7azem5ch+LwZWZmJo3AjangLbezzOw8Xlpm5lUpUAos7x97dax4E9XXWo2n+p5D+ub8ZEUP55zlHCFkyZzmyt2s54LkVeseOMfQ9Q1jzsGHLRPvFz9NSL6wLgITcXvHGKVEgLn0UdyEveF5n1gXwTbOzJ47c2POYdIHBh/auFg18ZG+P6Y9E8QpdXqdlffNL5QqDqOgQxsXmybe+VHTFtIinNDor1CakIztnKzO1Zg2LjZNvPZCLm/ZNcGCrWG9HgJeFzcbF4Tsm9BPKXjVajho1L83NaHqUOIiw4Lsm3j3x3wTwzZNYOovxkvLy0tLoYKXjQslmCPrJn7X92C3GY4jK3G8YUMcx0tAng+Iy3FCOLJt4qS+L79VE6txL6oO1cdGgrllE+/8aGVWA8oizwmox0T//IhAsZFXHmUG+bBgwnhsxWvGK+dZsEJ6TkCpib6hxkiCgQ+3jxiYSH0XMvHFusx0QbBs0gvN0nkQcJRumEPhaIKBj4lIawIcSPdSdwEX36zLAH/ECaFM4HSATtEJtVqtWRHMCUpAhcolgYmWFGGi46+IpibyHaT+pe0CnTG1/GAmgl7eeO7cxNatO/fv29doNNy9e8eulr3/oXyZJnsfx/RIe0owqpLjo6rWhCqBYHDAGJu7ceace3UjK6DiU7WjV8G/YRyTStkzZN4hHMkT5l9Tz3iejlbXhFIIqYNKaWF+X/obSkIFKnLS1vOliQlW8hTCfM75FCcm+vr3TydodUgfS0cckj5F1TCw2lx1cueY8t0iSpgX3y+LTxdFnESl0JStRxjh8qx9VZow8OEGsDYohLNn14Qh619+RdEuVhpeWU8TS+HOgMGiMI0WoZfTtEJeXCZ8SqASYLJBJwzj+8p5Nbh3KKLZeCCg+Ig4WRT6D4VVrSzpgYdAnHA4YITDNuGvpI31Mz4yOkS9E0gEZffuZ8LQi/yuB36mKFASqbzTxpvFZs4iLkFdE/5KbMo+aQKzYGH7NiCrI+ujLUwQclyE4dIljQOQDaz4DPPMBVnzeEXeemRd/FRo6CznhBB5RCpiohE4siaCh9slGh+pjpZDCdko+/nnFEIvq2B77XO+JraUfTeblBAojGLTqX9dI5fOnan2MZqoSNMhNvgRIxIT8JYh9/r162BCrwOIA0YpK0sTOXWQAt8x3++oJrj4vgV5njl345EsDKQpiTx+fFORy6riN00eiVIV0oQJoyOjo25/xOBE6v/9WHSqETKyPjJC3COMUccNBfW6XgIw2lC3TPjV7Egj/W87tvEyJbhHxlvmA8s/6kkGrY0n5dkOYBd7ZmLUjMdX3CHfYdSJgge7d+xK0fgAHRM+ozSa6JjQOBCmgXDIV0xwQv1W7x9990yFysqQJWHO6917+bmGzGm5FTgU846JlomFx1euPHny9O8jflSpVv+j7D6Cm8jyOI5vjufd4942B5KM4uRxFRlkk4py6G4yN68LlzaizcGsYYpYkmVhtRVaXhyGccuaoDYSM0L2MJJzJme4n/f312vJHYRgv+QMH73/635NOnk24HYzh5dyHHDiHspygAy6uowGegTWGf3Fg5bEAZxeNBaaLQP/bs+r99r3tJMBCCzP907iBgao+PwVCdrq361Q0AcHv//Spe7Oo6cOEObFAyFRL2H2QEWPs07Mk/Nf+1BPT1UD9C46q5Ogl8paj+u4HqO0ZXz11R3Q19XJ+HvJAevz7w4LUTCJd19cMBj0eRhDdzgU+M06ym7fGQEFqttRIT3HhVW4XDnP7EMdHdUNWAd0Fw9cstnFzYDBtowftaBXl/jBdzWTAYjii3LWSlsFJDCFtS9IdYhCoTsmNcbjzXY7fR92e7g3EgqJCBgN6MXLw3XkV5BYZbW5XC6fD2/R66/jvQoItcV2WfFkR/tbTDUXcXwxYKhPSf97ubW19f/A+L5uMtjqXH+mZjW2CrrbfoEEGPr6otEwLYb+eLEmu339epvNZu8fGIxFEDiYhZbD7ca/9xZQ68SOhB3T2ulfCYuM3vN5fEEdAutN7cWDhuPCOu3RVrsw3m9ru/LBOWC8mkVLS+u3tJOBaG2uLW4Vf4bEhVpNG+jtkCyXGWJiY7yc3W5Dfh+X6B1Ock3iIDBEUarb3VAOEAAIIZm6WOPEQyCn9eIlU9AAhZ6ffuSTR1b98s/aZ8fsNGdeGLb2NvThRx8ff6WFAYjWT97TQqgz+mtsFbg0Q2KDriH8bPoYQzSUivOaVAlXQBm5ms5wPM/1Dw7CQpKk3RRJ1ImhUCRW7rT1iNPptDhOd7PCVBT19cnRqCdYNlj5oU/RNf6npeFYXbNTc7LVYVwjCerTz86/3AIOxz/+y/u6yXidTedpB50IILGlHH4uQ0WGcJh2Bt5Q3O/fh3n3pJTs9VySEwSB50azZQuqThJD4hhqbGyi3lSfgQXjFeqLBoMMAbEfG0QXzxxhz4DZzcQF/FTfqIThaUdtan/9/HJVixaC+Axf0WOGqH2dtgqa4a1qGzbIKkOYLQZTfhflH1NGE0wC8ckIs0il8M9ZSVIowmuyr2P5K0lI4T55iDHQiyDTjy3F3fazR1ZjCyvdTNRqj7YrFq6Orq52LQa2DB2FEeLylTbUYSMHVHKg+XwTE/krHCJUiEAAEGAwLAajhM/n57jMjS/yGUVQayqoFnv2psRIRD9PbKbtlST6B/rkDeptGBxi0ZiEF2Cvvf6kBbt56WaCHeZMC+NaT09Plx7jr+daqk1GG2pvv6ZbEIBAG7Y7LKtXWRy/K7aNIGLiWDP/4jx0DfR5lAyfHp9gEiy+P5sNFSSpXxIHs/xKY3YbOeBys1ePwFP9k1F5Q/E1YA79qp7ttIPmgz0JqWUZMYI9LJ3Fx60t1SaDILq6pnSTQWFJ/sNhcVoObt1BQSIyxlfPQ/cBnoAy7Z2e0UnAYpQsCoXQ8DA+UarOZiMKvL9bQ8BiEoHiWpRjMeZA+e2dR4/Q3Q4Nx0WMjgkDzXZ0dJgwsFdUm4x2gujp8BgWBCC21p6yWo4c3MBuA0IRkX9JQUj4+iRO8XpvpPNzgr5kIRvJZkducIyIPAJ+238om20bEIyNTsZkowMa8rtO0+0VnccdNkyO3oIw3p2an19YgIUO48oJJmGejE9LED1o0QSBdbnupLXm6JCbScQKL5eg+62xOcHrXVrKZwRjXGF4eHkkmYEFK+hyse3NJfPmINHHHFK8JrffVY9Fgd8H+KXlLI4vsDAuDECgBQ0GbRmfQ6LaZDCIjoUp/WQA4ne/27Hz6MGjfSLdJoqhWG8VBIGSg1Ryzuv15scnphXBFJdOLOfyyUyGExDvAQSj8FSSuNobQ8ah3ONxYVGswsltVc3OrciEMbS4ODs7a8Rov3kcElUmo4dBzM/LhgXxux3owLFDUdENCbcYG2iqosAkcBaRM/shodzIYTzMKcmldJpZKEKcdlgKp1nTcHDcxNXe8CAcDMX9Pl/9UTzX+BXuf7GXMwstxq1FilnQlDCMKydIovpkdBDE/KIJAm07dag7RPdFkhgZKFRjQIEgIGQsCTTzRX5O2Y/0EEom453LpXMTwODGyEGlaDQ4ZDL59O3JQTiYgsQb2ClWrT7yjx0IFiUMZnHn7r17zEKHcf+EEaJFe81gCwIQs7OLt/STQTXU+Q5NRkTcCuBOoHfYqKCLV3C1ww0x56VyNB4koRRjW6QCiWlaMROwSE5LnvKZ05cyOkzklhKjHMebk/GtsFM4Ldb68tFWMyV37iIDBqak7YFhSRiuGWwyAIFvde9OeUGUIBrqdnfe7gXFnj2SOJygNYufY5KDgiEFBQhCjgsC5mNuBuOhmMsk93vR/iQsIpc8JYmgW++Qz6UnuCQHCTO+Gxvzu2cdlpozbu0xX8W48xAxi3vaKfnoxPGWFv2KME5GGeLu3Tu6yQDE7t2pPZHEcEhK7e0vDCfSuaWZR48fPxpPmiAE1DiGmgXWI1xH93vNTe8X2Ecyue5L/tLJOxjQOCTJQYCWRkJDnwpCov6Y1fF3t/bZB7NwPwFEJYxPThiXRMXJYBB3H97ZsgLRQBD4Z2+FkYFsoQCI5afXH6OZmUfPbuSNEl7E45/tKhl5l7I5rB18xJCilH2ksN9DEpTMfrGqQ774zSDBEPQ1FQ9mZ48dtUsNSIfhfv7kSclCNyUf6ocDEB8YIOYZxD1A4Bs/cZODDmKvMJdIjIwsJxLXnz5dmpjzovyjcU7QxyTiTVzpE/mZ9Giymf7nHk7ReijllSLEG7shoT754cmTYw70NZiEokJDCFOZYRuSPFQ7VNt5+FSITrg6DPf/2jMP57SRL47//rtf90x6x0L7D1ydcvVdmXZtypVpxxV7gguTAGmgKyxIk2BBBBYeaTRzIj0B93o2Tn+r1RqMzFjp9ZO4t9Vnvu9p92l2BlUEZKCNcx+/3WXiXK/KQBFoYmaHEME95EbGK2ZzamosU8+qCggcQ9nKBHYRGXzkPDMx6rnox7eYD9+ELAsTo0eH+AgCW20Er9fzoBDw4XswpodXZdOuembO4An9X6e/m4sPisEHIkQgW8n4IVAcx37rCES3CPz5GRGInXiEjqcxC81GI1NXHeiAgK7KnUSj3ES/BBvYbkmJ9I8y+hn4NiJFqSQaBUYo9+vQz6f5AOJ0mYvwPYhMaFqtYhpNholvjZqMDDIT//rxUpbd1Pa1ZeycX1iY8elycTZw53jz3VOdIriHq20PMzOzOJHeuWPHYDydyjAM3QrUOgEwadAElaSOb9VNXeEn104XkZKXeQDAH0r/yiYQnL3YI6oKbECoU1NZFBCjUqWAWIbtsJbJfiaWy6fiI8n9+/dxGRhiFMGY2SIYbKfdZeLtj3/vVRkoAllYjOHGmlvIqhqBrSBQsTaZoL4JaCMZuiJ2pSIZ+KqMmR+NeneFyMTR46f/5c/D+mRHUTYsUFYQ00jT1i0CAtlmoYgwEbGIlsmOJ/ftR3K5EWR+ViBUeHgmLgTOHLituvD5RiC2EnFxabmA1LO6Bj0hUBXlQau1WtVyKGEmZOjAaxTRLhfMBLMQxZf0xNDxM2IOFKMSmmBRcFhBNJBps+Z0/1kXnUdjMZyOy3I+H0/mUEQynkjV6ys+S4K/BRcvfu5tJgI7zB++7NhNXd3sYeHiyuracjEpQW9EeQDDMnHJzYbhqlXLUgh0UHE9EwI/FdwEc9E/gcURYx7e///7fX2SVK04FuuNDFtVZNgCE93Isb6+WBnAC0X5SDKB8W0tI2uc1QCBnTbfY358vmdlLMwura07sD0EXMcTYWMRV+zmNF9+pWZRSsRN0GY7im6OaBInOs7mD+JZcl+spJvT/NeIKAQhoNYACJroi7LU5dFEOZspKoSwMFk3PRaRW7fWEUwGpmT19ifX32UmgiruBCpjhotYuLh8F8JAQK+xN25DAQa1dLPhXYdhurrioA8ghloNmohozAIjlRjeEBEbnqhPt1pjojf2gAB1KUix2I4RAC8UyVKyXoJtmL8WMCFaxVkUEagMZP5WBUKaIKxiHUODNkSruUbDw8ZqcQy3pnWrkJgJfziXjsd2+CIShUKGHV+3/7umUmaPGSMAfijcMEu+c52bCLaKb1gggiLmbxEgIVXk8bSeLga/3alWbK5juoWp2OxCkkaFiURieMAXsSNRSChyuD9bTAzuQGTgoSjqJoRZ8rU3ewy1z28tYn4RLAohlxQfGUnQHqugiorVMjXWmsaq3+Ri1FdTnhgeYNMwxmBGhXAQ0AppzESOgEejUVkHZ1sTFD4PmBCt4iTzgHR6YEDVCrkkJYEHdSAEeiKrLvbSZtPtVNGvSd64opgYHtyxlxMvQlgI5AupVKKoVy3qUHK3NW0Che1NzAsTwVbxWXcgPBWLQB0IAxpIDMSL26+CVI2m2qFC4iZG6+kBfmxABghQCEs0VcCm0mS3bts0p6Z0ICFMADPRo1X8tVkEZz30mggUC5lqqK7i2lq0DZ/mjie8URgnCZYF4YmUdHfd5r251YIAoU2IVjF50WNWML+4uL5MgEBItHoewiEmOzwTrDZoKhvH8Y9PDqo6gQeGUMui8CgmRKtYFawhyx7rQOBxQ8DiJhCmgpnQ8/FBfE4qAKISeHIIEz1bxe1uESu3nsR6LAKa3MbLRB73ybkjgpwCNQJPlu97mkAV8FQgugOS3Ia9r+SL7MTgUx5XwYEnzOSpY+La4RlBKgBylwk7K0SUS6XxYlMFAk+NZ2mCbjJBiVZnkSiXxt2ika/X63kC8CqYqIEit6Ga49j5bNYw8s1pD6NC4NUwYUHFAcQ7ON/VXdOYGrvXaqEDu3LXEhZeARNAwXQtx/IcsHNZc2yqhQ4cAs+Gf7zmNa95zTbcB561bL3JySyTAAAAAElFTkSuQmCC);background-position:center;background-repeat:no-repeat;background-size:contain;height:200px;width:220.83px;margin:0 auto}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600);margin-top:28px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);margin-top:20px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .new-goal[_ngcontent-%COMP%]{margin-top:28px;display:inline-flex;align-items:center}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .new-goal[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;color:var(--text-primary-content-color-hc)}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link-to-goal[_ngcontent-%COMP%]{background:transparent;border:none;text-decoration:underline;color:var(--fluent-theme-link-darker-color);font-size:var(--sm-font-size);font-weight:var(--font-weight-regular);margin-top:12px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .cancel-scorecard-button[_ngcontent-%COMP%]{margin-top:28px;padding:6px;font-size:var(--md-font-size);font-weight:var(--font-weight-regular);display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .cancel-scorecard-button[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-left:-12px}[_nghost-%COMP%]   .empty-scorecard[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .cancel-scorecard-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:6px}[_nghost-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0}),i}(),Ve=M(17174),Wt=M(87650),en=M(48205),sn=M(33846),kt=["input"];function St(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",2,3),e.\u0275\u0275listener("focus",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onInputFocus())})("blur",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onInputBlur())})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.keyupEnter())})("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onInputChanged(s))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("type",r.inputType),e.\u0275\u0275property("disabled",r.isReadOnly)("placeholder",r.placeholder)("ngModel","text"==r.inputType?r.formattedValue:r.value),e.\u0275\u0275attribute("aria-label",r.placeholder)}}function un(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("value",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function gn(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-form-field",4)(1,"mat-select",5),e.\u0275\u0275listener("selectionChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onSelectChanged(s))})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.keyupEnter())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275template(3,un,2,2,"mat-option",6),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",r.isReadOnly)("value",r.value)("placeholder",e.\u0275\u0275pipeBind1(2,4,"Generic_Select_Value")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.categories)}}var Bt=function(){function i(n,t){this.formatValuePipe=n,this.localizationService=t,this.placeholder="",this.type="number",this.onValueChanged=new e.EventEmitter,this.onInputKeyEnter=new e.EventEmitter,this.inputType="text",this.defaultDateFormat={day:"numeric",month:"short",year:"numeric"}}return i.prototype.ngOnInit=function(){this.categories||this.showFormattedValue()},i.prototype.onInputFocus=function(){this.inputType=this.type},i.prototype.onInputBlur=function(){this.showFormattedValue()},i.prototype.onInputChanged=function(n){this.value=n,this.formattedValue=this.formatValue(n),this.onValueChanged.emit(this.value)},i.prototype.onSelectChanged=function(n){this.value=n.value,this.onValueChanged.emit(this.value)},i.prototype.keyupEnter=function(){this.onInputKeyEnter&&this.onInputKeyEnter.emit()},i.prototype.focus=function(){var n,t;null===(t=null===(n=this.inputElement)||void 0===n?void 0:n.nativeElement)||void 0===t||t.focus()},i.prototype.showFormattedValue=function(){this.inputType="text",this.formattedValue=this.formatValue(this.value),"date"===this.type&&!this.formattedValue&&(this.inputType="date")},i.prototype.formatValue=function(n){var t;if("number"===this.type)return this.formatValuePipe.transform(n,this.formatString,!0,"");if(!n)return"";var r=this.localizationService.currentLanguageLocale;return ne.E.treatAsLocalDate(new Date(n)).toLocaleDateString(r,null!==(t=this.dateFormat)&&void 0!==t?t:this.defaultDateFormat)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Er.c),e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["formatted-input"]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(kt,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.inputElement=a.first))},inputs:{placeholder:"placeholder",value:"value",formatString:"formatString",isReadOnly:"isReadOnly",type:"type",dateFormat:"dateFormat",categories:"categories"},outputs:{onValueChanged:"onValueChanged",onInputKeyEnter:"onInputKeyEnter"},decls:3,vars:2,consts:[["class","input-value","step","any",3,"disabled","placeholder","type","ngModel","focus","blur","keyup.enter","ngModelChange",4,"ngIf","ngIfElse"],["categoricalTarget",""],["step","any",1,"input-value",3,"disabled","placeholder","type","ngModel","focus","blur","keyup.enter","ngModelChange"],["input",""],["appearance","none",1,"select-category"],["panelClass","goals-categorical-value-select",1,"number-select",3,"disabled","value","placeholder","selectionChange","keyup.enter"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,St,2,5,"input",0),e.\u0275\u0275template(1,gn,4,6,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",!r.categories)("ngIfElse",a)}},dependencies:[j.NgForOf,j.NgIf,Ve.Fj,Ve.JJ,Ve.On,Wt.v_,en.x8,sn.CK,Mt.F],styles:["[_ngcontent-%COMP%]::-webkit-outer-spin-button, [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"],changeDetection:0}),i}(),kn=["goal-edit-buttons-row",""],On=function(){function i(){this.onSave=new e.EventEmitter,this.onCancel=new e.EventEmitter,this.COLSPAN=W.gT.TotalNumberOfColumns}return i.prototype.onSaveClick=function(){this.onSave.emit()},i.prototype.onCancelClick=function(){this.onCancel.emit()},i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["","goal-edit-buttons-row",""]],inputs:{disableSave:"disableSave"},outputs:{onSave:"onSave",onCancel:"onCancel"},attrs:kn,decls:6,vars:8,consts:[[1,"button-box"],["data-testid","button-save","localize","PBI_Button_Label_Save",1,"button-save","pbi-fluent-button","primary",3,"disabled","click"],["data-testid","button-cancel","localize","PBI_Button_Label_Cancel",1,"button-cancel","pbi-fluent-button",3,"click"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"td")(1,"div",0)(2,"button",1),e.\u0275\u0275listener("click",function(){return r.onSaveClick()}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",2),e.\u0275\u0275listener("click",function(){return r.onCancelClick()}),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275attribute("colspan",r.COLSPAN),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",r.disableSave),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,4,"PBI_Button_Label_Save")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(5,6,"PBI_Button_Label_Cancel")))},dependencies:[rn.X,Mt.F],styles:["[_nghost-%COMP%]   .button-box[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]   .button-save[_ngcontent-%COMP%]{margin-right:8px}"],changeDetection:0}),i}(),dn=function(){function i(){}return i.GoalNameMaxLength=256,i.MaxGoalOwnerCount=5,i.ScorecardNameMaxCharacterLimit=250,i.ScorecardDescriptionMaxCharacterLimit=120,i.RoleDescriptionMaxCharacterLimit=512,i.RoleNameMaxCharacterLimit=128,i.ActiveStatusMaxCountLimit=12,i.HistoricalStatusMaxCountLimit=12,i.MaxStatusId=255,i.StatusMaxCharacterLimit=50,i.MaxNumberOfCategories=10,i.GoalValueCategoryMaxLength=40,i.GoalValueCategoryNameMaxLength=256,i.CycleCustomLabelMaxLength=32,i.CycleCustomDescriptionMaxLength=128,i.CycleMaxCustomDurationInDays=1e3,i}(),$t=function(){function i(){}return i.getPreviewValue=function(n){var t,r,a,s;if(null!==(t=n?.result)&&void 0!==t&&t[0]){var c=n.result[0],u=_.filter(n.columns,function(x){return x.isMeasure}),p=_.first(u),v=c[p.index],P=_.find(n.columns,function(x){return!!x.type&&!!x.type.dateTime});P&&(a=new Date(c[P.index])),s=(0,Zn.EO)(p,Yn.iu),_.isFinite(v)&&(r=v)}return{timestamp:a,value:r,formatString:s}},i}(),Bn=M(17085),fn=new e.InjectionToken("ConnectToDataDialogService"),bn=M(5432),wn=M(32293),Rr=M(78035),Fn=M(3307),Vn=M(12587);function D(i,n,t){return(0,nt.ZP)(i,function(r){-1===r.start.column&&(r.start.column=0,r.end.column=t-1),-1===r.start.row&&(r.start.row=0,r.end.row=n-1),r.start.row=Math.max(0,Math.min(r.start.row,n-1)),r.start.column=Math.max(0,Math.min(r.start.column,t-1)),r.end.row=Math.max(0,Math.min(r.end.row,n-1)),r.end.column=Math.max(0,Math.min(r.end.column,t-1))})}function L(i,n){switch(n){case"Date":if(i){_.isString(i)&&(i=i.replace(/\//g,"-"));var t=new Date(i);if(_.isFinite(t.getTime()))return t}return;case"Number":return _.isFinite(parseFloat(i))?parseFloat(i):void 0;default:return i}}(0,nt.Fl)(!1);var oe=function(){function i(){this._columns$=new pe.X([]),this._rows$=new pe.X([])}return Object.defineProperty(i.prototype,"columns",{get:function(){return this._columns$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rows",{get:function(){return this._rows$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rows$",{get:function(){return this._rows$.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"columns$",{get:function(){return this._columns$.asObservable()},enumerable:!1,configurable:!0}),i.prototype.setColumns=function(n){this._columns$.next(n||[])},i.prototype.setRows=function(n){this._rows$.next(n||[])},i.prototype.appendRow=function(){this.ensureRows(this.rows.length+1)},i.prototype.ensureRows=function(n){var t=this.rows;n<=t.length||this.setRows((0,w.__spreadArray)((0,w.__spreadArray)([],t,!0),_.map(new Array(n-t.length),function(){return[]}),!0))},i.prototype.setCellData=function(n,t){if(this.isValidCell(n)){var r=this.rows,a=(0,w.__spreadArray)((0,w.__spreadArray)((0,w.__spreadArray)([],_.slice(r,0,n.row),!0),[(0,w.__spreadArray)([],r[n.row],!0)],!1),_.slice(r,n.row+1,r.length),!0);a[n.row][n.column]=t,this.setRows(a)}},i.prototype.deleteRows=function(n,t){var r=this.rows;this.setRows((0,w.__spreadArray)((0,w.__spreadArray)([],_.slice(r,0,n),!0),_.slice(r,n+t,r.length),!0))},i.prototype.emptyRange=function(n){var t=this;this.setRows((0,nt.Uy)(this.rows,function(r){for(var a=(n=D(n,t.rows.length,t.columns.length)).start.row;a<=n.end.row;a++)for(var s=n.start.column;s<=n.end.column;s++)r[a][s]=null}))},i.prototype.isValidCell=function(n){return!(!_.isFinite(n.row)||!_.isFinite(n.column)||n.row>=this._rows$.value.length||n.column>=this._columns$.value.length||n.row<0||n.column<0)},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac=function(t){return new(t||i)}}),i}(),ge=function(){function i(n){this.dataSource=n,this._editingCell$=new pe.X(void 0),this._isReadOnly$=new pe.X(!1),this.isReadOnly$=this._isReadOnly$.asObservable()}return Object.defineProperty(i.prototype,"isReadOnly",{get:function(){return!!this._isReadOnly$.value},enumerable:!1,configurable:!0}),i.prototype.setReadOnly=function(n){this.cancelEditing(),this._isReadOnly$.next(!!n)},Object.defineProperty(i.prototype,"editingCell$",{get:function(){return this._editingCell$.asObservable()},enumerable:!1,configurable:!0}),i.prototype.isEditing=function(){return!!this._editingCell$.value},i.prototype.isEditingCell=function(n){var t=this._editingCell$.value;return!!t&&!!n&&n.column===t.column&&n.row===t.row},i.prototype.tryEditCell=function(n,t){this.isEditingCell(n)||this.isReadOnly||this.editCell(n,t)},i.prototype.editCell=function(n,t){this.commitPendingEdit(),this.dataSource.isValidCell(n)&&this._editingCell$.next({column:n.column,row:n.row,data:_.isNil(t)?this.dataSource.rows[n.row][n.column]:t})},i.prototype.setEditingData=function(n){var t,r,a,s=void 0===(r=(t=this._editingCell$.value||{}).row)?0:r,c=void 0===(a=t.column)?0:a;this._editingCell$.next({data:n,row:s,column:c})},i.prototype.commitPendingEdit=function(){var n=this._editingCell$.value;n&&(this.dataSource.setCellData(n,n.data),this._editingCell$.next(void 0))},i.prototype.cancelEditing=function(){this._editingCell$.value&&this._editingCell$.next(void 0)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(oe))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ce=function(){function i(n){var t=this;this.dataStore=n,this.currentSelection$=new pe.X(void 0),this._enforceSelectingColumn=!1,this.normalizedSelection$=this.currentSelection$.pipe((0,je.U)(function(r){return t.normalizeSelection(r)}),(0,Gn.d)({bufferSize:1,refCount:!0})),this.selectedCell$=this.currentSelection$.pipe((0,je.U)(function(r){return r&&{column:r.start.column,row:r.start.row}}),(0,Gn.d)({bufferSize:1,refCount:!0}))}return Object.defineProperty(i.prototype,"selectedCell",{get:function(){var t;return this.selectedCell$.pipe((0,he.q)(1)).subscribe(function(r){return t=r}),t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"normalizedSelection",{get:function(){var t;return this.normalizedSelection$.pipe((0,he.q)(1)).subscribe(function(r){return t=r}),t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selection",{get:function(){return this.currentSelection$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"enforceSelectingColumn",{set:function(t){this._enforceSelectingColumn=t},enumerable:!1,configurable:!0}),i.prototype.setSelection=function(n){n&&(this._enforceSelectingColumn&&(n.start={row:-1,column:n.start.column},n.end={row:-1,column:n.start.column}),n.start=this.normalizeCell(n.start),n.end=this.normalizeCell(n.end)),this.currentSelection$.next(n),this.clearFocus()},i.prototype.setFocus=function(n,t){this.ensureRowIsInVirtualScroll(n.row);var r=t.querySelector('[data-row="'.concat(n.row,'"][data-column="').concat(n.column,'"]'));r&&(r.focus(),this.focusedCell=n)},i.prototype.clearFocus=function(){this.focusedCell=void 0},i.prototype.ensureRowIsInVirtualScroll=function(n){var t=this.virtualScroll.getRenderedRange();n>=0&&(t.start>n||t.end<n)&&this.virtualScroll.scrollToIndex(n)},i.prototype.selectCell=function(n){n=this.normalizeCell(n),this.setSelection({start:n,end:n})},i.prototype.setSelectionStart=function(n){n=this.normalizeCell(n);var t=this.currentSelection$.value;this.setSelection({start:n,end:t?.end||n})},i.prototype.setSelectionEnd=function(n){n=this.normalizeCell(n);var t=this.currentSelection$.value;this.setSelection({start:t?.start||n,end:n})},i.prototype.selectAll=function(){this.selectCell({row:-1,column:-1})},i.prototype.normalizeCell=function(n){var t=this.dataStore.rows.length,r=this.dataStore.columns.length;return{row:_.isFinite(n?.row)?Math.max(-1,Math.min(n.row,t-1)):-1,column:_.isFinite(n?.column)?Math.max(-1,Math.min(n.column,r-1)):-1}},i.prototype.normalizeSelection=function(n){if(!_.isNil(n))return{start:{row:Math.min(n.start.row,n.end.row),column:Math.min(n.start.column,n.end.column)},end:{row:Math.max(n.start.row,n.end.row),column:Math.max(n.start.column,n.end.column)}}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(oe))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),rt=function(){function i(n,t,r){this.selectionService=n,this.dataSource=t,this.cellEditingService=r}return i.prototype.canCopyCurrentSelection=function(){return!!this.selectionService.normalizedSelection},i.prototype.copyCurrentSelection=function(n){return void 0===n&&(n=!1),(0,w.__awaiter)(this,void 0,void 0,function(){var t,u;return(0,w.__generator)(this,function(p){switch(p.label){case 0:return(t=this.selectionService.normalizedSelection)?(u=D({start:t.start||{row:0,column:0},end:t.end||{row:0,column:0}},this.dataSource.rows.length,this.dataSource.columns.length),[4,this.copy(u.start,u.end,!1,n)]):[2];case 1:return p.sent(),[2]}})})},i.prototype.copyAll=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(c){switch(c.label){case 0:return[4,this.copy({row:0,column:0},{row:this.dataSource.rows.length-1,column:this.dataSource.columns.length-1},n)];case 1:return c.sent(),[2]}})})},i.prototype.copy=function(n,t,r,a){void 0===a&&(a=!1);var c=_.map(_.slice(this.dataSource.rows,n.row,t.row+1),function(Y){return _.slice(Y,n.column,t.column+1)}),u=[];if(r){var p=_(this.dataSource.columns).map(function(Y){return Y.name}).slice(n.column,t.column+1).join("\t");u.push(p)}for(var v=0,P=c;v<P.length;v++){var G=_.join(P[v].map(function(Y){return a?'"'+(Y??"").toString().trimStart().replace(/"/g,'""'):(Y??"").toString()}),"\t");u.push(G)}return navigator.clipboard.writeText(_.join(u,"\r\n"))},i.prototype.pasteOverSelection=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,r,a,s,c;return(0,w.__generator)(this,function(u){switch(u.label){case 0:return!(n=this.selectionService.normalizedSelection)||this.cellEditingService.isReadOnly?[2]:[4,navigator.clipboard.readText()];case 1:return(t=u.sent())?(0===(r=_.map(t.split(/\n|\r\n/),function(p){return p.split(/\t/)})).length||(a=this.dataSource.columns,(s=n.start||{row:0,column:0}).row=Math.max(0,s.row),s.column=Math.max(0,s.column),this.dataSource.ensureRows(s.row+r.length),c=(0,nt.ZP)(this.dataSource.rows,function(p){for(var v=0;v<r.length;v++)for(var P=s.column,x=0;P<a.length&&x<r[v].length;P++,x++){var G=L(r[v][x],a[P].type);G&&(p[s.row+v][P]=G)}}),this.dataSource.setRows(c),this.selectionService.setSelection({start:s,end:{row:s.row+r.length-1,column:s.column+r[0].length-1}})),[2]):[2]}})})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(ce),e.\u0275\u0275inject(oe),e.\u0275\u0275inject(ge))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),gt=function(i){return i.ArrowUp="ArrowUp",i.ArrowDown="ArrowDown",i.ArrowLeft="ArrowLeft",i.ArrowRight="ArrowRight",i}({}),_t=function(i){return i.Enter="Enter",i.Tab="Tab",i.Escape="Escape",i.Delete="Delete",i.Backspace="Backspace",i.F2="F2",i.Space=" ",i}({}),zt=function(){function i(n,t,r,a){this.cellEditing=n,this.selectionService=t,this.dataSource=r,this.clipboardService=a}return i.prototype.keydown=function(n,t,r){var a=!1;"c"===n.key&&n.ctrlKey&&!this.cellEditing.isEditing()?(this.clipboardService.copyCurrentSelection(),a=!0):"v"===n.key&&n.ctrlKey&&!this.cellEditing.isEditing()?(this.clipboardService.pasteOverSelection(),a=!0):"a"===n.key&&n.ctrlKey&&!this.cellEditing.isEditing()?(this.selectionService.selectAll(),a=!0):n.key.match(/^[a-z0-9]$/i)?a=this.handleAlphaNumeric(n.key):n.key in gt?a=n.altKey?this.handleColumnResize(n.key):this.handleArrowKey(n.key,(n.shiftKey||n.ctrlKey)&&r,t):n.key===_t.Enter?a=this.handleEnter(n):n.key===_t.Tab?a=this.handleTab():n.key===_t.Escape?a=this.handleEscape():n.key===_t.Delete||n.key===_t.Backspace?a=this.handleDelete():n.key===_t.F2?a=this.handleF2():n.key===_t.Space&&(a=this.handleSpace(n)),a&&(n.stopPropagation(),n.preventDefault())},i.prototype.handleF2=function(){var n=this.selectionService.selectedCell;return!(!n||this.cellEditing.isEditingCell(n)||this.cellEditing.isReadOnly||(this.cellEditing.tryEditCell(n),0))},i.prototype.handleAlphaNumeric=function(n){var t=this.selectionService.selectedCell;if(t&&!this.cellEditing.isEditingCell(t)&&!this.cellEditing.isReadOnly){var r=this.dataSource.columns[t.column];return this.cellEditing.tryEditCell(t,L(n,r?.type)),!0}return!1},i.prototype.handleColumnResize=function(n){var t,r,a=null===(t=this.selectionService.focusedCell)||void 0===t?void 0:t.column;if(void 0!==a&&-1!==a){var s=null!==(r=this.dataSource.columns[a].width)&&void 0!==r?r:50,u=this.dataSource.columns;switch(n){case gt.ArrowLeft:u[a].width=Math.max(s-1,45),this.dataSource.setColumns(u);break;case gt.ArrowRight:u[a].width=s+1,this.dataSource.setColumns(u)}}return!0},i.prototype.handleArrowKey=function(n,t,r){var a={row:-1,column:-1};if(this.selectionService.focusedCell)a={row:this.selectionService.focusedCell.row,column:this.selectionService.focusedCell.column};else{var s=this.selectionService.selection;s?.end&&t?a=(0,w.__assign)({},s.end):s?.start&&(a=(0,w.__assign)({},s.start))}switch(n){case gt.ArrowUp:if(this.cellEditing.isEditing())return!1;a.row--;break;case gt.ArrowDown:a.row++,this.cellEditing.isReadOnly||this.dataSource.ensureRows(a.row+1);break;case gt.ArrowLeft:if(this.cellEditing.isEditing())return!1;a.column--;break;case gt.ArrowRight:if(this.cellEditing.isEditing())return!1;a.column++}return t&&this.selectionService.setSelectionEnd(a),this.selectionService.setFocus(a,r),!0},i.prototype.handleTab=function(){return this.selectionService.clearFocus(),!1},i.prototype.handleEnter=function(n){var t,r,a=this.selectionService.focusedCell;if(a)return this.selectionService.selectCell(a),null===(t=n.target)||void 0===t||t.blur(),null===(r=n.currentTarget)||void 0===r||r.focus(),!0;var s=this.selectionService.selectedCell;if(s){if(this.cellEditing.isEditingCell(s)){var c={row:s.row+1,column:s.column};return this.dataSource.ensureRows(c.row+1),this.selectionService.selectCell(c),!0}if(!this.cellEditing.isReadOnly)return this.cellEditing.tryEditCell(s),!0}return!1},i.prototype.handleSpace=function(n){var t,r,a=this.selectionService.focusedCell;if(a)return this.selectionService.selectCell(a),null===(t=n.target)||void 0===t||t.blur(),null===(r=n.currentTarget)||void 0===r||r.focus(),!0;var s=this.selectionService.selectedCell;if(s){if(this.cellEditing.isEditingCell(s))return!1;if(!this.cellEditing.isReadOnly)return this.cellEditing.tryEditCell(s),!0}return!1},i.prototype.handleEscape=function(){return this.cellEditing.cancelEditing(),!0},i.prototype.handleDelete=function(){var n=this.selectionService.normalizedSelection;return!(!n||this.cellEditing.isEditing()||this.cellEditing.isReadOnly||(-1===n.start.column&&-1!==n.start.row?(this.dataSource.deleteRows(n.start.row,n.end.row-n.start.row+1),this.selectionService.selectCell({row:n.start.row,column:-1})):this.dataSource.emptyRange(n),0))},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(ge),e.\u0275\u0275inject(ce),e.\u0275\u0275inject(oe),e.\u0275\u0275inject(rt))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),Rt=M(80786),qt=function(){function i(n,t,r){this.cellEditing=n,this.selectionService=t,this.dataSource=r}return i.prototype.doubleClick=function(n,t){this.cellEditing.isEditingCell(t)||this.cellEditing.isReadOnly||(this.cellEditing.tryEditCell(t),n.preventDefault(),n.stopPropagation())},i.prototype.mouseDown=function(n,t,r){if(this._supportRightClickMenu&&n.button===Rt.tc.Secondary)return n.preventDefault(),void n.stopPropagation();this.cellEditing.isEditingCell(t)||(n.preventDefault(),n.stopPropagation(),$(n.currentTarget).trigger("focus"),n.shiftKey&&r?this.selectionService.setSelectionEnd(t):this.selectionService.selectCell(t),this.isSelecting=!0)},i.prototype.mouseOver=function(n,t,r){this.isSelecting&&r&&(n.preventDefault(),n.stopPropagation(),this.selectionService.setSelectionEnd(t))},i.prototype.mouseLeave=function(n){this.isSelecting&&(this.isSelecting=!1,n.preventDefault(),n.stopPropagation())},i.prototype.mouseUpInCell=function(n,t){var r,a;if(this.showRightClickMenu=!1,t&&!this.cellEditing.isEditingCell(t)&&this._supportRightClickMenu&&n.button===Rt.tc.Secondary){var s=null===(r=this.selectionService.normalizedSelection)||void 0===r?void 0:r.start,c=null===(a=this.selectionService.normalizedSelection)||void 0===a?void 0:a.end;if(!s||!c)return;return this.isInEffectiveRange(t,s,c)&&(this.showRightClickMenu=!0),n.preventDefault(),void n.stopPropagation()}},Object.defineProperty(i.prototype,"supportRightClickMenu",{set:function(t){this._supportRightClickMenu=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showRightClickMenu",{get:function(){return this._showRightClickMenu},set:function(t){this._showRightClickMenu=t},enumerable:!1,configurable:!0}),i.prototype.isInEffectiveRange=function(n,t,r){var a,u=(a=D({start:t||{row:0,column:0},end:r||{row:0,column:0}},this.dataSource.rows.length,this.dataSource.columns.length)).start,p=a.end;return n.row>=u.row&&n.row<=p.row&&n.column>=u.column&&n.column<=p.column},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(ge),e.\u0275\u0275inject(ce),e.\u0275\u0275inject(oe))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ds=new e.InjectionToken("ResizeService"),ps=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["tri-cell"]],inputs:{data:"data"},decls:1,vars:1,template:function(t,r){1&t&&e.\u0275\u0275text(0),2&t&&e.\u0275\u0275textInterpolate(r.data)},styles:["[_nghost-%COMP%]{cursor:default;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"],changeDetection:0}),i}(),hs=["editor"],gs=function(){function i(){this.onDestroy$=new ir.t(1)}return i.prototype.ngOnInit=function(){var t,n=this;null===(t=this.focusEditor$)||void 0===t||t.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(){n.focusEditor()})},i.prototype.ngOnDestroy=function(){this.onDestroy$.next(),this.onDestroy$.complete()},i.prototype.ngOnChanges=function(n){if(n.data&&"Date"===this.column.type){var t=new Date(this.data);_.isFinite(t.getTime())&&(this.data=t.toISOString().slice(0,10))}if(n.column)switch(this.column.type){case"Date":this.type="date";break;case"Number":this.type="number";break;default:this.type="text"}},i.prototype.ngAfterViewInit=function(){this.focusEditor()},i.prototype.onDataChange=function(n){var t=L(n,this.column.type);_.isNil(t)||this.dataChange(t)},i.prototype.focusEditor=function(){var n;null===(n=this.editor.nativeElement)||void 0===n||n.focus()},i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["tri-cell-editor"]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(hs,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.editor=a.first))},inputs:{column:"column",data:"data",focusEditor$:"focusEditor$",dataChange:"dataChange"},features:[e.\u0275\u0275NgOnChangesFeature],decls:2,vars:3,consts:[["autofocus","",3,"type","ngModel","ngModelChange"],["editor",""]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"input",0,1),e.\u0275\u0275listener("ngModelChange",function(s){return r.onDataChange(s)}),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("type",r.type)("ngModel",r.data),e.\u0275\u0275attribute("aria-label",r.data))},dependencies:[Ve.Fj,Ve.JJ,Ve.On],styles:["input[_ngcontent-%COMP%]{border:0;width:100%;background:transparent;padding:0;display:inline-flex;align-items:center}input[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:hover, input[_ngcontent-%COMP%]:active, input[_ngcontent-%COMP%]:active:hover, input[_ngcontent-%COMP%]:focus:hover{outline:none}[_ngcontent-%COMP%]::-webkit-outer-spin-button, [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-webkit-appearance:textfield;appearance:textfield;-moz-appearance:textfield}"],changeDetection:0}),i}(),fs=function(){function i(){this.columnResized=new e.EventEmitter}return i.prototype.onMouseDown=function(n){var t,r,a;return this.isResizing=!0,this.pageX=n.pageX,this.initialWidth=null!==(a=null===(r=null===(t=n.target)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.offsetWidth)&&void 0!==a?a:0,document.body.style.cursor="col-resize",n.stopPropagation(),!1},i.prototype.onDragStart=function(){return!1},i.prototype.onMouseMove=function(n){return!this.isResizing||(this.columnResized.emit(Math.max(0,this.initialWidth+n.pageX-this.pageX)),n.stopPropagation(),!1)},i.prototype.onMouseLeave=function(n){return!this.isResizing||(this.isResizing=!1,document.body.style.cursor="",n.stopPropagation(),!1)},i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=e.\u0275\u0275defineDirective({type:i,selectors:[["","triResizeColumn",""]],hostBindings:function(t,r){1&t&&e.\u0275\u0275listener("mousedown",function(s){return r.onMouseDown(s)})("touchstart",function(s){return r.onMouseDown(s)})("dragstart",function(){return r.onDragStart()})("mousemove",function(s){return r.onMouseMove(s)},!1,e.\u0275\u0275resolveWindow)("touchmove",function(s){return r.onMouseMove(s)},!1,e.\u0275\u0275resolveWindow)("mouseup",function(s){return r.onMouseLeave(s)},!1,e.\u0275\u0275resolveWindow)("mouseleave",function(s){return r.onMouseLeave(s)},!1,e.\u0275\u0275resolveWindow)("touchend",function(s){return r.onMouseLeave(s)},!1,e.\u0275\u0275resolveWindow)},outputs:{columnResized:"columnResized"}}),i}(),ms=function(){function i(){}return i.prototype.transform=function(n,t,r){return!!n&&(-1===n.start.row||t>=n.start.row&&t<=n.end.row)&&(-1===n.start.column||r>=n.start.column&&r<=n.end.column)},i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.\u0275\u0275definePipe({name:"isSelected",type:i,pure:!0}),i}(),vs=["headers"],Cs=["table"],_s=["viewport"],Lt=["cellEditor"];function Gt(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275listener("focus",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.focusCell(s,{row:-1,column:-1}))}),e.\u0275\u0275element(1,"tri-svg-icon",12),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("tabindex",r.focusedCell?-1:0),e.\u0275\u0275attribute("data-row",-1)("data-column",-1),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","table_20_regular")}}var Tu=function(n){return{headerName:n}};function Eu(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275listener("focus",function(p){var P=e.\u0275\u0275restoreView(t).index,x=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(x.focusCell(p,{row:-1,column:P}))}),e.\u0275\u0275pipe(1,"isSelected"),e.\u0275\u0275elementContainer(2,14),e.\u0275\u0275elementStart(3,"span",15),e.\u0275\u0275listener("columnResized",function(p){var P=e.\u0275\u0275restoreView(t).index,x=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(x.onColumnResized(p,P))}),e.\u0275\u0275elementEnd()()}if(2&i){var r=n.$implicit,a=n.index,s=e.\u0275\u0275nextContext(2),c=e.\u0275\u0275reference(9);e.\u0275\u0275styleProp("width",s.columnWidths[a]),e.\u0275\u0275classProp("selection-start",e.\u0275\u0275pipeBind3(1,9,s.selection,-1,a)),e.\u0275\u0275property("tabindex",s.focusedCell||s.rowHeaders||0!==a?-1:0),e.\u0275\u0275attribute("data-row",-1)("data-column",a),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",r.headerTemplate||c)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(13,Tu,r.name))}}function Iu(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",23),e.\u0275\u0275listener("focus",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext().index,p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.focusCell(c,{row:u,column:-1}))}),e.\u0275\u0275pipe(1,"isSelected"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext().index,a=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("selection-start",e.\u0275\u0275pipeBind3(1,5,a.selection,r,-1)),e.\u0275\u0275attribute("data-row",r)("data-column",-1),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r+a.rowIndexDisplayOffset," ")}}var Du=function(n,t,r,a){return{column:n,data:t,dataChange:r,focusEditor$:a}};function ku(i,n){if(1&i&&e.\u0275\u0275elementContainer(0,14,27),2&i){var t=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext(4),a=e.\u0275\u0275reference(5);e.\u0275\u0275property("ngTemplateOutlet",t.editTemplate||a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction4(2,Du,t,r.editingCell.data,r.onEditCellDataChange.bind(r),r.focusEditor$))}}var Fu=function(n,t){return{column:n,data:t}};function Vu(i,n){if(1&i&&e.\u0275\u0275elementContainer(0,14),2&i){var t=e.\u0275\u0275nextContext(),r=t.$implicit,a=t.index,s=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275nextContext(3);var c=e.\u0275\u0275reference(7);e.\u0275\u0275property("ngTemplateOutlet",r.template||c)("ngTemplateOutletContext",e.\u0275\u0275pureFunction2(2,Fu,r,s[a]))}}function Au(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",24),e.\u0275\u0275listener("focus",function(v){var x=e.\u0275\u0275restoreView(t).index,G=e.\u0275\u0275nextContext().index,Y=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(Y.focusCell(v,{row:G,column:x}))}),e.\u0275\u0275pipe(1,"isSelected"),e.\u0275\u0275template(2,ku,2,7,"ng-container",25),e.\u0275\u0275template(3,Vu,1,5,"ng-template",null,26,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()}if(2&i){var r=n.index,a=e.\u0275\u0275reference(4),s=e.\u0275\u0275nextContext().index;e.\u0275\u0275nextContext();var c=e.\u0275\u0275reference(1),u=e.\u0275\u0275nextContext(2);e.\u0275\u0275styleProp("width",u.columnWidths[r]),e.\u0275\u0275classProp("selected-top",s===(null==u.selection||null==u.selection.start?null:u.selection.start.row)||0===s&&-1===(null==u.selection||null==u.selection.start?null:u.selection.start.row))("selected-bottom",s===(null==u.selection||null==u.selection.end?null:u.selection.end.row)&&-1!==(null==u.selection||null==u.selection.start?null:u.selection.start.row)||s===u.dataSource.rows.length-1&&-1===(null==u.selection||null==u.selection.end?null:u.selection.end.row))("selected-left",r===(null==u.selection||null==u.selection.start?null:u.selection.start.column)||0===r&&-1===(null==u.selection||null==u.selection.start?null:u.selection.start.column))("selected-right",r===(null==u.selection||null==u.selection.end?null:u.selection.end.column)&&-1!==(null==u.selection||null==u.selection.start?null:u.selection.start.column)||r===u.dataSource.columns.length-1&&-1===(null==u.selection||null==u.selection.start?null:u.selection.start.column))("selected",e.\u0275\u0275pipeBind3(1,19,u.selection,s,r))("selection-start",u.selectedCell&&u.selectedCell.row===s&&u.selectedCell.column===r),e.\u0275\u0275attribute("data-row",s)("data-column",r)("aria-colindex",(c.getRenderedRange().start||0)+r+1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",u.editingCell&&u.editingCell.row===s&&u.editingCell.column===r)("ngIfElse",a)}}function Ru(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275template(1,Iu,3,9,"div",21),e.\u0275\u0275template(2,Au,5,23,"div",22),e.\u0275\u0275elementEnd()),2&i){var t=n.index,r=e.\u0275\u0275nextContext(2).$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("aria-rowindex",t+1),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.rowHeaders),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r)("ngForTrackBy",a.trackByColumn)}}function Lu(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275listener("mousedown",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(a.appendRow(-1))})("focus",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2).$implicit,c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.focusCell(a,{row:s.length,column:-1}))}),e.\u0275\u0275text(1,"+"),e.\u0275\u0275elementEnd()}}function Gu(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",32),e.\u0275\u0275listener("mousedown",function(){var u=e.\u0275\u0275restoreView(t).index,p=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(p.appendRow(u))})("focus",function(c){var p=e.\u0275\u0275restoreView(t).index,v=e.\u0275\u0275nextContext(2).$implicit,P=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(P.focusCell(c,{row:v.length,column:p}))}),e.\u0275\u0275elementEnd()}if(2&i){var r=n.index,a=e.\u0275\u0275nextContext(4);e.\u0275\u0275styleProp("width",a.columnWidths[r])}}function Nu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",28),e.\u0275\u0275template(1,Lu,2,0,"div",29),e.\u0275\u0275template(2,Gu,1,2,"div",30),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2).$implicit,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.rowHeaders),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)("ngForTrackBy",r.trackByColumn)}}function Hu(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cdk-virtual-scroll-viewport",16,17),e.\u0275\u0275listener("scroll",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.scroll())}),e.\u0275\u0275template(2,Ru,3,4,"div",18),e.\u0275\u0275template(3,Nu,3,3,"div",19),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("itemSize",a.rowHeight),e.\u0275\u0275advance(2),e.\u0275\u0275property("cdkVirtualForOf",r)("cdkVirtualForTrackBy",a.trackByColumn)("cdkVirtualForTemplateCacheSize",100),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.showAppendRow&&!1===e.\u0275\u0275pipeBind1(4,5,a.isReadOnly$))}}function zu(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",6,7),e.\u0275\u0275template(3,Gt,2,4,"div",8),e.\u0275\u0275template(4,Eu,4,15,"div",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Hu,5,7,"cdk-virtual-scroll-viewport",10),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.rowHeaders),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)("ngForTrackBy",r.trackByColumn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(6,4,r.rows$))}}function qu(i,n){if(1&i&&e.\u0275\u0275element(0,"tri-cell-editor",33),2&i){var r=n.data,a=n.dataChange,s=n.focusEditor$;e.\u0275\u0275property("column",n.column)("data",r)("dataChange",a)("focusEditor$",s)}}function Bu(i,n){1&i&&e.\u0275\u0275element(0,"tri-cell",34),2&i&&e.\u0275\u0275property("data",n.data)}function Uu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",35),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.headerName;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}var ys=function(i){function n(t,r,a,s,c,u,p,v){var P=i.call(this)||this;return P.changeDetector=t,P.cellEditing=r,P.dataSource=a,P.selectionService=s,P.mouseEventHandler=c,P.keyboardEventHandler=u,P.clipboardService=p,P.resizeService=v,P.columnWidths=[],P.focusEditor$=new Re.xQ,P.rowHeight=24,P.isReadOnly$=P.cellEditing.isReadOnly$,P.rowHeaders=!0,P.showAppendRow=!0,P.isReadOnly=!1,P.allowExpandSelection=!0,P.enforceSelectingColumn=!1,P.clearSelectionOnDataChange=!1,P.rowIndexDisplayOffset=0,P.supportRightClickMenu=!1,P.rowsChange=new e.EventEmitter,P.selectionChange=new e.EventEmitter,P.columnWidthChange=new e.EventEmitter,P.showRightClickMenu=new e.EventEmitter,P.columns$=P.dataSource.columns$,P.rows$=P.dataSource.rows$,P}return(0,w.__extends)(n,i),n.prototype.releaseMouse=function(t){this.mouseEventHandler.mouseLeave(t)},n.prototype.ngOnInit=function(){var t=this;this.changes$("isReadOnly").subscribe(function(r){return t.cellEditing.setReadOnly(r)}),this.changes$("columns").subscribe(function(r){t.columnWidths=_.map(r,function(a){return(_.isFinite(a.width)?a.width:50)+"px"}),t.dataSource.setColumns(r),t.clearSelectionOnDataChangeHandler()}),this.changes$("rows").subscribe(function(r){t.dataSource.setRows(r),t.clearSelectionOnDataChangeHandler()}),this.dataSource.rows$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(r){t.rows!==r&&t.rowsChange.emit(r)}),this.dataSource.columns$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(r){t.columnWidths=_.map(r,function(a){return(_.isFinite(a.width)?a.width:50)+"px"})}),this.cellEditing.editingCell$.pipe((0,Fn.T)(1),(0,ie.R)(this.onDestroy$),(0,ar.b)(function(r){t.editingCell=r,t.changeDetector.markForCheck()}),(0,I.x)(function(r,a){return r?.row===a?.row&&r?.column===a?.column})).subscribe(function(){t.editingCell?setTimeout(function(){return t.focusEditor$.next()},0):setTimeout(function(){return t.table.nativeElement.focus()},0)}),this.selectionService.enforceSelectingColumn=this.enforceSelectingColumn,this.selectionService.selectedCell$.pipe((0,ie.R)(this.onDestroy$),(0,ar.b)(function(r){t.selectedCell=r,t.changeDetector.markForCheck()}),(0,jt.h)(function(r){return!!r}),(0,I.x)(function(r,a){return r.row===a.row&&r.column===a.column})).subscribe(function(r){var a,s,c;t.cellEditing.isEditing()&&!t.cellEditing.isEditingCell(r)&&t.cellEditing.commitPendingEdit();var u=(null===(a=t.viewport.nativeElement)||void 0===a?void 0:a.scrollTop)/t.rowHeight,p=u+(null===(s=t.viewport.nativeElement)||void 0===s?void 0:s.offsetHeight)/t.rowHeight;r.row>=0&&(r.row<u||r.row>=p)&&(null===(c=t.viewportComponent)||void 0===c||c.scrollToIndex(r.row))}),this.selectionService.normalizedSelection$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(r){t.selection=r,t.selectionChange.emit(r),t.changeDetector.markForCheck()}),this.resizeService&&this.resizeService.resize$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(){t.viewportComponent.checkViewportSize()}),this.mouseEventHandler.supportRightClickMenu=this.supportRightClickMenu},n.prototype.ngAfterViewInit=function(){var t=this;this.table.nativeElement.style.setProperty("--row-height",this.rowHeight+"px"),this.keyboardEventHandler.parentElement=this.table.nativeElement,setTimeout(function(){t.changes$("nextSelectionInput").subscribe(function(r){t.scrollToSelectedColumn(r),t.selectionService.setSelection(r)})},0),this.selectionService.virtualScroll=this.viewportComponent},n.prototype.scrollToSelectedColumn=function(t){var r=this;if(t){var a=0;if(this.nextSelectionInputChangedFromSelection(t)&&this.columns&&this.columnWidths)for(var s=0;s<this.columns.length&&s<=t.start.column-1;s++)a+=this.substractWidh(this.columnWidths[s]);setTimeout(function(){var c,u;(null===(c=r.viewport)||void 0===c?void 0:c.nativeElement.clientWidth)<a&&(null===(u=r.viewport)||void 0===u||u.nativeElement.scroll(a,0))},300)}},n.prototype.nextSelectionInputChangedFromSelection=function(t){var r,a,s,c,u,p,v,P;return t.end.column!==(null===(a=null===(r=this.selection)||void 0===r?void 0:r.end)||void 0===a?void 0:a.column)||t.end.row!==(null===(c=null===(s=this.selection)||void 0===s?void 0:s.end)||void 0===c?void 0:c.row)||t.start.row!==(null===(p=null===(u=this.selection)||void 0===u?void 0:u.start)||void 0===p?void 0:p.row)||t.start.column!==(null===(P=null===(v=this.selection)||void 0===v?void 0:v.start)||void 0===P?void 0:P.column)},n.prototype.substractWidh=function(t){var r,a=null===(r=t?.match(/\d+(\.\d+)?/g))||void 0===r?void 0:r.map(Number);return a?a[0]:0},n.prototype.flushPendingChanges=function(){var t;return this.cellEditing.commitPendingEdit(),this.rows$.pipe((0,he.q)(1)).subscribe(function(r){return t=r}),t},n.prototype.trackByColumn=function(t){return t},n.prototype.scroll=function(){this.headers.nativeElement.style.transform="translateX(".concat(-this.viewport.nativeElement.scrollLeft,"px)")},n.prototype.onColumnResized=function(t,r){this.columnWidths[r]=t+"px",this.columnWidthChange.emit({width:t,column:r})},n.prototype.onCellMouseDown=function(t){var r=this.getCell();r&&this.mouseEventHandler.mouseDown(t,r,this.allowExpandSelection)},n.prototype.onCellMouseUp=function(t){var r=this.getCell();this.mouseEventHandler.mouseUpInCell(t,r),this.mouseEventHandler.showRightClickMenu&&this.showRightClickMenu.emit({pageX:t.pageX,pageY:t.pageY})},n.prototype.onCellMouseOver=function(t){var r=this.getCell();r&&this.mouseEventHandler.mouseOver(t,r,this.allowExpandSelection)},n.prototype.onCellDoubleClick=function(t){var r=this.getCell();r&&this.mouseEventHandler.doubleClick(t,r)},n.prototype.onEditCellDataChange=function(t){this.cellEditing.setEditingData(t)},n.prototype.focusCell=function(t,r){this.selectionService.setFocus(r,this.table.nativeElement),this.scrollViewportHorizontally(t.target)},Object.defineProperty(n.prototype,"focusedCell",{get:function(){return this.selectionService.focusedCell},enumerable:!1,configurable:!0}),n.prototype.scrollViewportHorizontally=function(t){var r=this.viewport.nativeElement,a=t.offsetLeft;(r.scrollLeft+r.clientWidth<a||r.scrollLeft>a)&&(r.scrollLeft=a-(r.clientWidth-t.clientWidth)/2,this.viewport.nativeElement.scrollIntoView())},n.prototype.handleKeydown=function(t){this.keyboardEventHandler.keydown(t,this.table.nativeElement,this.allowExpandSelection)},n.prototype.getCell=function(){var t=$("[data-clickable]:hover").get(0);if(t){var r=t.getAttribute("data-row"),a=t.getAttribute("data-column");if(r&&a){var s=parseInt(r,10),c=parseInt(a,10);if(_.isFinite(s)&&_.isFinite(c))return{row:s,column:c}}}},n.prototype.appendRow=function(t){this.dataSource.appendRow(),this.selectionService.selectCell({row:this.dataSource.rows.length,column:t})},n.prototype.clearSelectionOnDataChangeHandler=function(){this.clearSelectionOnDataChange&&this.selectionService.setSelection(void 0)},n.\u0275fac=function(r){return new(r||n)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(ge),e.\u0275\u0275directiveInject(oe),e.\u0275\u0275directiveInject(ce),e.\u0275\u0275directiveInject(qt),e.\u0275\u0275directiveInject(zt),e.\u0275\u0275directiveInject(rt),e.\u0275\u0275directiveInject(ds,8))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["tri-grid"]],viewQuery:function(r,a){if(1&r&&(e.\u0275\u0275viewQuery(vs,5),e.\u0275\u0275viewQuery(Cs,5),e.\u0275\u0275viewQuery(_s,5,e.ElementRef),e.\u0275\u0275viewQuery(Te.N7,5),e.\u0275\u0275viewQuery(Lt,5)),2&r){var s=void 0;e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.headers=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.table=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.viewport=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.viewportComponent=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.cellEditor=s.first)}},hostBindings:function(r,a){1&r&&e.\u0275\u0275listener("mouseup",function(c){return a.releaseMouse(c)},!1,e.\u0275\u0275resolveWindow)("mouseleave",function(c){return a.releaseMouse(c)},!1,e.\u0275\u0275resolveWindow)},inputs:{columns:"columns",rows:"rows",rowHeaders:"rowHeaders",showAppendRow:"showAppendRow",isReadOnly:"isReadOnly",allowExpandSelection:"allowExpandSelection",enforceSelectingColumn:"enforceSelectingColumn",nextSelectionInput:"nextSelectionInput",clearSelectionOnDataChange:"clearSelectionOnDataChange",rowIndexDisplayOffset:"rowIndexDisplayOffset",supportRightClickMenu:"supportRightClickMenu"},outputs:{rowsChange:"rowsChange",selectionChange:"selectionChange",columnWidthChange:"columnWidthChange",showRightClickMenu:"showRightClickMenu"},features:[e.\u0275\u0275ProvidersFeature([ce,ge,oe,qt,zt,rt]),e.\u0275\u0275InheritDefinitionFeature],decls:10,vars:3,consts:[["tabindex","-1","role","table",1,"table",3,"keydown","mousedown","mouseover","mouseup","dblclick"],["table",""],[4,"ngIf"],["defaultCellEditor",""],["defaultViewCell",""],["defaultHeaderCell",""],["role","row",1,"headers"],["headers",""],["class","header selectable table-icon","role","columnheader","data-clickable","true",3,"tabindex","focus",4,"ngIf"],["class","header selectable","data-clickable","true","role","columnheader",3,"selection-start","tabindex","width","focus",4,"ngFor","ngForOf","ngForTrackBy"],[3,"itemSize","scroll",4,"ngIf"],["role","columnheader","data-clickable","true",1,"header","selectable","table-icon",3,"tabindex","focus"],["tri-svg-icon-20","",1,"table-svg-icon",3,"name"],["data-clickable","true","role","columnheader",1,"header","selectable",3,"tabindex","focus"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["triResizeColumn","",1,"resize-handle",3,"columnResized"],[3,"itemSize","scroll"],["viewport",""],["class","row","role","row",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy","cdkVirtualForTemplateCacheSize"],["class","row","role","row","tabindex","0",4,"ngIf"],["role","row",1,"row"],["class","cell row-header selectable","role","gridcell","tabindex","-1","data-clickable","true",3,"selection-start","focus",4,"ngIf"],["class","cell selectable","role","gridcell","tabindex","-1","data-clickable","true",3,"selected-top","selected-bottom","selected-left","selected-right","selected","selection-start","width","focus",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell","tabindex","-1","data-clickable","true",1,"cell","row-header","selectable",3,"focus"],["role","gridcell","tabindex","-1","data-clickable","true",1,"cell","selectable",3,"focus"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf","ngIfElse"],["viewCell",""],["cellEditor",""],["role","row","tabindex","0",1,"row"],["class","cell row-header","role","gridcell","tabindex","-1",3,"mousedown","focus",4,"ngIf"],["tabindex","-1","class","cell","role","gridcell",3,"width","mousedown","focus",4,"ngFor","ngForOf","ngForTrackBy"],["role","gridcell","tabindex","-1",1,"cell","row-header",3,"mousedown","focus"],["tabindex","-1","role","gridcell",1,"cell",3,"mousedown","focus"],[3,"column","data","dataChange","focusEditor$"],[3,"data"],[1,"default-header-name"]],template:function(r,a){1&r&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275listener("keydown",function(c){return a.handleKeydown(c)})("mousedown",function(c){return a.onCellMouseDown(c)})("mouseover",function(c){return a.onCellMouseOver(c)})("mouseup",function(c){return a.onCellMouseUp(c)})("dblclick",function(c){return a.onCellDoubleClick(c)}),e.\u0275\u0275template(2,zu,7,6,"ng-container",2),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,qu,1,4,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(6,Bu,1,1,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(8,Uu,2,1,"ng-template",null,5,e.\u0275\u0275templateRefExtractor)),2&r&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,1,a.columns$)))},dependencies:[j.NgForOf,j.NgIf,j.NgTemplateOutlet,Te.xd,Te.x0,Te.N7,gr.M,ps,gs,fs,j.AsyncPipe,ms],styles:['[_nghost-%COMP%]{height:100%;width:100%;display:flex;background:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);--row-height: $default-row-height}[_nghost-%COMP%]   *[_ngcontent-%COMP%]{box-sizing:border-box}[_nghost-%COMP%]   *[_ngcontent-%COMP%]:focus{outline:none}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{overflow-x:auto;height:calc(100% - var(--row-height));position:absolute;top:var(--row-height);bottom:0;width:100%;scrollbar-width:thin}[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;height:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border:1px solid var(--fluentThemeNeutralSecondaryAltColor, #767676);border-radius:20px;background-color:var(--fluentThemeNeutralSecondaryAltColor, #767676)}.table[_ngcontent-%COMP%]{height:100%;display:flex;position:relative;max-width:100%;overflow-x:hidden;width:max-content;padding-right:5px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]{text-align:start;display:flex;flex-wrap:nowrap;height:var(--row-height);width:100%;border-left:1px solid var(--colorNeutralStroke2)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:inline-flex;position:relative;min-width:45px;height:var(--row-height);line-height:12px;margin:0;padding:3px 6px;background:var(--colorNeutralBackground2);flex-shrink:0;flex-grow:0;overflow:hidden;border-top:solid 1px var(--colorNeutralStroke2);border-bottom:solid 1px var(--colorNeutralStroke2);border-right:solid 1px var(--colorNeutralStroke2);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .default-header-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;opacity:0;width:10px;cursor:col-resize}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.selection-start[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2Selected);border-bottom:2px solid var(--colorNeutralStrokeAccessibleSelected);color:var(--colorNeutralForeground1Selected);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600)}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.selection-start[_ngcontent-%COMP%]{border-bottom:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:focus{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:4px;padding:2px 4px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground2Hover);color:var(--colorNeutralForeground1Hover)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:active{background:var(--colorNeutralBackground2Pressed);color:var(--colorNeutralForeground1Pressed)}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]:focus{padding:2px 5px 2px 4px}.table[_ngcontent-%COMP%]   .headers[_ngcontent-%COMP%]   .header.table-icon[_ngcontent-%COMP%]   .table-svg-icon[_ngcontent-%COMP%]{fill:var(--colorNeutralForeground2)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;border-left:solid 1px var(--colorNeutralStroke2)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .selectable[_ngcontent-%COMP%]:not(.selection-start):focus{border:2px solid var(--colorNeutralStrokeFocus2);border-radius:4px;padding:1.5px 4px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{cursor:default;position:relative;display:inline-flex;flex-grow:0;min-width:45px;height:var(--row-height);padding:3.5px 6px;align-items:center;overflow:hidden;border-bottom:solid 1px var(--colorNeutralStroke2);border-right:solid 1px var(--colorNeutralStroke2);background:var(--colorSubtleBackground);outline:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.number-cell[_ngcontent-%COMP%]{text-align:right}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2);justify-content:center;padding:3px 0 0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header.selection-start[_ngcontent-%COMP%]{background:var(--colorNeutralBackground2Selected);border-right:2px solid var(--colorNeutralStrokeAccessibleSelected);color:var(--colorNeutralForeground1Selected);font-family:var(--fluent-font-family, "Segoe UI");font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-semi-bold, 600)}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header.selection-start[_ngcontent-%COMP%]{border-right:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:hover{background:var(--colorNeutralBackground2Hover);color:var(--colorNeutralForeground1Hover)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:active{background:var(--colorNeutralBackground2Pressed);color:var(--colorNeutralForeground1Pressed)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.row-header[_ngcontent-%COMP%]:focus{padding:1px 1px 0 0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected[_ngcontent-%COMP%]{background:var(--colorSubtleBackgroundSelected)}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]:not(.selected-bottom){padding-bottom:5px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]:not(.selected-top){padding-top:5px}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]{border-top:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-top:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]{border-top:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-top[_ngcontent-%COMP%]:before{border-top:1px solid var(--colorNeutralStrokeFocus1);top:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]{border-bottom:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-bottom:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]{border-bottom:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-bottom[_ngcontent-%COMP%]:before{border-bottom:1px solid var(--colorNeutralStrokeFocus1);bottom:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]{border-left:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-left:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]{border-left:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-left[_ngcontent-%COMP%]:before{border-left:1px solid var(--colorNeutralStrokeFocus1);left:0}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]{border-right:2px solid var(--colorNeutralStrokeAccessibleSelected);padding-right:4px}@media (forced-colors: active){.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]{border-right:2px solid var(--globalColorhcHighlight)!important}}.table[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .cell.selected.selected-right[_ngcontent-%COMP%]:before{border-right:1px solid var(--colorNeutralStrokeFocus1);right:0}'],changeDetection:0}),n}(Vn.w),Mc=M(17177),ju=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[j.CommonModule,Ve.u5,Rr.Y,Te.Cl,Mc.T6]}),i}(),Ca=M(4633),Wu=["formatSwitchCell"];function $u(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatValue"),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(),r=t.data,a=t.column;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(2,1,r,a.formatString))}}function Qu(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"date"),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(),r=t.data,a=t.column;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(2,1,r,a.formatString||"shortDate","UTC"))}}function Xu(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext().data;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function Yu(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext().data;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function Zu(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0,1),e.\u0275\u0275template(1,$u,3,4,"ng-container",2),e.\u0275\u0275template(2,Qu,3,5,"ng-container",2),e.\u0275\u0275template(3,Xu,2,1,"ng-container",2),e.\u0275\u0275template(4,Yu,2,1,"ng-container",3),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.column;e.\u0275\u0275property("ngSwitch",null==t?null:t.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Number"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Date"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","Text")}}var bs=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["format-switch-cell-template"]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(Wu,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.formatSwitchCell=a.first))},decls:2,vars:0,consts:[["formatSwitchCell",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(t,r){1&t&&e.\u0275\u0275template(0,Zu,5,4,"ng-template",null,0,e.\u0275\u0275templateRefExtractor)},dependencies:[j.NgSwitch,j.NgSwitchCase,j.NgSwitchDefault,j.DatePipe,Er.c],changeDetection:0}),i}(),ql=M(44641),Pc=M(11941),Ju=M(39686);function Ku(i,n){if(1&i&&e.\u0275\u0275element(0,"message-banner",12),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBanner)}}function ed(i,n){1&i&&e.\u0275\u0275element(0,"mat-icon",13)}function td(i,n){1&i&&e.\u0275\u0275element(0,"mat-icon",14)}function nd(i,n){1&i&&e.\u0275\u0275element(0,"pbi-spinner",15)}function rd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"tri-grid",17,18),e.\u0275\u0275listener("rowsChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onRowUpdate(s))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(3,"section")(4,"div",19),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"pbi-radio-group",20),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.showFinalTarget=s)}),e.\u0275\u0275elementStart(8,"pbi-radio-button",21),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"pbi-radio-button",21),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"localize"),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("rows",r.gridData)("columns",r.columnsConfig),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,8,"Metrics_Targets_Editor_Select_Target")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.showFinalTarget),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,10,"Target_Next")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(13,12,"Target_Final"))}}var Oc=function(){function i(n,t,r,a,s){this.dialogRef=n,this.localizationService=r,this.telemetryService=a,this.changeDetector=s,this.isFullScreen=!1,this.onDestroy$=new Re.xQ,this.resultType=2,this.TargetColumnIndex=0,this.DueDateColumnIndex=1,this.telemetryService.logEvent(Ue),this.goal$=t.goal$,this.goalTargets$=t.goalTargets$,this.onDoneCallback=t.onDoneCallback,this.columnsConfig=[{name:this.localizationService.get("Target"),type:"Number",width:i.GridColumnWidthInPx},{name:this.localizationService.get("DueDate"),type:"Date",width:i.GridColumnWidthInPx}],this.DuplicateTargetDates={bannerType:1,iconName:i.ErrorIcon,message:this.localizationService.get("Metrics_Targets_Editor_Error_Duplicate_Target_Dates")},this.MissingTargetDate={bannerType:1,iconName:i.ErrorIcon,message:this.localizationService.get("Metrics_Targets_Editor_Error_Missing_Target_Date")},this.MissingTargetValue={bannerType:1,iconName:i.ErrorIcon,message:this.localizationService.get("Metrics_Targets_Editor_Error_Missing_Target_Value")}}return i.prototype.ngOnInit=function(){var n=this;this.goal$.pipe((0,he.q)(1)).subscribe(function(t){var r,a;n.columnsConfig=[(0,w.__assign)((0,w.__assign)({},n.columnsConfig[n.TargetColumnIndex]),{formatString:t.valuesFormatString}),(0,w.__assign)((0,w.__assign)({},n.columnsConfig[n.DueDateColumnIndex]),{formatString:t.datesFormatString})],n.showFinalTarget=null!==(a=null===(r=t.metadata)||void 0===r?void 0:r.showFinalTarget)&&void 0!==a?a:!t.targetConnection}),this.goalTargets$.pipe((0,he.q)(1)).subscribe(function(t){n.gridData=t.map(function(r){return[r.target,new Date(r.timestamp)]}),n.changeDetector.markForCheck()})},i.prototype.ngAfterViewInit=function(){var n=this;this.columnsConfig=_.map(this.columnsConfig,function(t){return t.template=n.formatSwitchCellTemplate.formatSwitchCell,t})},i.prototype.ngOnDestroy=function(){this.onDestroy$.next(),this.onDestroy$.complete()},i.prototype.onRowUpdate=function(n){this.gridData=n},i.prototype.toggleFullScreen=function(){this.isFullScreen?(this.dialogRef.updateSize("70%","80%"),this.isFullScreen=!1):(this.dialogRef.updateSize("100%","100%"),this.isFullScreen=!0)},i.prototype.close=function(){this.telemetryService.logEvent(E),this.dialogRef.close()},i.prototype.onDone=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,r,a,s;return(0,w.__generator)(this,function(c){if(this.gridData=this.gridEditor.flushPendingChanges(),(n=this.gridData.filter(function(u){return!(_.isNil(u[0])&&_.isNil(u[1]))}).map(function(u){return{timestamp:_.isNil(u[1])?void 0:u[1],target:_.isNil(u[0])?void 0:u[0]}})).find(function(u){return _.isNil(u.timestamp)&&!_.isNil(u.target)}))return this.messageBanner=this.MissingTargetDate,[2];if(n.find(function(u){return!_.isNil(u.timestamp)&&_.isNil(u.target)}))return this.messageBanner=this.MissingTargetValue,[2];for(t=new Set,r=0,a=n;r<a.length;r++){if(t.has((s=a[r].timestamp).getTime()))return this.messageBanner=this.DuplicateTargetDates,[2];t.add(s.getTime())}return this.onDoneCallback(n.map(function(u){return{timestamp:u.timestamp.toISOString(),target:u.target}}),this.showFinalTarget,this.columnsConfig[this.TargetColumnIndex].formatString),this.telemetryService.logEvent(xn),this.dialogRef.close(),[2]})})},i.prototype.valueFormatStringChanged=function(n){this.columnsConfig=[(0,w.__assign)((0,w.__assign)({},this.columnsConfig[this.TargetColumnIndex]),{formatString:n}),this.columnsConfig[1]]},i.ErrorIcon="pbi-glyph-blocked2",i.GridColumnWidthInPx=200,i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(wn.so),e.\u0275\u0275directiveInject(wn.WI),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(Ca.y0),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-targets-editor"]],viewQuery:function(t,r){if(1&t&&(e.\u0275\u0275viewQuery(ys,5),e.\u0275\u0275viewQuery(bs,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.gridEditor=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.formatSwitchCellTemplate=a.first)}},decls:27,vars:29,consts:[[3,"viewModel",4,"ngIf"],[1,"title"],["mat-icon-button","",1,"pbi-icon-button",3,"click"],["class","glyph-small","fontIcon","pbi-glyph-fullscreen",4,"ngIf"],["class","glyph-small","fontIcon","pbi-glyph-fullscreenexit",4,"ngIf"],[1,"targets-editor-value-formatting-box"],[1,"goals-value-formatting",3,"formatString","dataType","formatStringChange"],["class","pbi-spinner-large",4,"ngIf","ngIfElse"],["showGrid",""],[1,"actions"],[1,"pbi-fluent-button","primary",3,"disabled","click"],[1,"pbi-fluent-button","secondary",3,"click"],[3,"viewModel"],["fontIcon","pbi-glyph-fullscreen",1,"glyph-small"],["fontIcon","pbi-glyph-fullscreenexit",1,"glyph-small"],[1,"pbi-spinner-large"],[1,"grid-container"],[3,"rows","columns","rowsChange"],["gridEditor",""],[1,"displayed-target-title"],[1,"displayed-target-options",3,"ngModel","ngModelChange"],[3,"value"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,Ku,1,1,"message-banner",0),e.\u0275\u0275elementStart(1,"header")(2,"div",1),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",2),e.\u0275\u0275listener("click",function(){return r.toggleFullScreen()}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275template(7,ed,1,0,"mat-icon",3),e.\u0275\u0275template(8,td,1,0,"mat-icon",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"section"),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",5)(13,"value-formatting",6),e.\u0275\u0275listener("formatStringChange",function(c){return r.valueFormatStringChanged(c)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,nd,1,0,"pbi-spinner",7),e.\u0275\u0275template(15,rd,14,14,"ng-template",null,8,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275element(17,"format-switch-cell-template"),e.\u0275\u0275elementStart(18,"div",9)(19,"button",10),e.\u0275\u0275listener("click",function(){return r.onDone()}),e.\u0275\u0275pipe(20,"localize"),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"button",11),e.\u0275\u0275listener("click",function(){return r.close()}),e.\u0275\u0275pipe(24,"localize"),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"localize"),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(16);e.\u0275\u0275property("ngIf",r.messageBanner),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,15,"Metrics_Targets_Editor_Title")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,17,"Fullscreen_Toggle")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.isFullScreen),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isFullScreen),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(11,19,"Metrics_Targets_Editor_Description"),"\n"),e.\u0275\u0275advance(3),e.\u0275\u0275property("formatString",r.columnsConfig[0].formatString)("dataType",r.resultType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.gridData)("ngIfElse",a),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",!r.gridData),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(20,21,"Done_ButtonText")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,23,"Done_ButtonText")," "),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(24,25,"PBI_Button_Label_Cancel")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(26,27,"PBI_Button_Label_Cancel")," ")}},dependencies:[j.NgIf,Ve.JJ,Ve.On,Xt.Hw,ql.A,Pc.o,Ju.d,Jn.k,bn.d,ys,bs,Mt.F],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]     .targets-editor-value-formatting-box mat-select{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .targets-editor-value-formatting-box mat-select .mat-select-value{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .targets-editor-value-formatting-box mat-select .mat-select-arrow{color:var(--gray-140, #484644);padding-right:14px}[_nghost-%COMP%]     .targets-editor-value-formatting-box num-up-down .inputRange{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .targets-editor-value-formatting-box num-up-down .inputRange .inputUpDown{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .targets-editor-value-formatting-box num-up-down label{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);line-height:20px}[_nghost-%COMP%]     .targets-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn{background-color:transparent;border:none}[_nghost-%COMP%]     .targets-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}header[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-dark-color, #201F1E);display:flex;flex-direction:row;align-items:center;justify-content:space-between}header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-semi-bold, 600)}header[_ngcontent-%COMP%], section[_ngcontent-%COMP%], tri-grid[_ngcontent-%COMP%], .targets-editor-value-formatting-box[_ngcontent-%COMP%], .displayed-target-title[_ngcontent-%COMP%]{margin-bottom:16px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:end;gap:8px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin:5px 5px 0 0}.pbi-spinner-large[_ngcontent-%COMP%]{height:100%}.displayed-target-title[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px)}.displayed-target-options[_ngcontent-%COMP%]{display:flex;gap:36px}.grid-container[_ngcontent-%COMP%]{flex-grow:1}'],changeDetection:0}),i}();function id(i,n){if(1&i&&e.\u0275\u0275element(0,"message-banner",12),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBanner)}}function od(i,n){1&i&&e.\u0275\u0275element(0,"mat-icon",13)}function ad(i,n){1&i&&e.\u0275\u0275element(0,"mat-icon",14)}function sd(i,n){1&i&&e.\u0275\u0275element(0,"pbi-spinner",15)}function ld(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"tri-grid",17,18),e.\u0275\u0275listener("rowsChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onRowUpdate(s))}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("rows",r.gridData)("columns",r.columnsConfig)}}var xc=function(){function i(n,t,r,a,s){this.dialogRef=n,this.localizationService=r,this.telemetryService=a,this.changeDetector=s,this.isFullScreen=!1,this.onDestroy$=new Re.xQ,this.resultType=2,this.ValueColumnIndex=0,this.DateAddedColumnIndex=1,this.telemetryService.logEvent(Lr),this.goal$=t.goal$,this.goalValues$=t.goalValues$,this.onDoneCallback=t.onDoneCallback,this.columnsConfig=[{name:this.localizationService.get("Visual_Tablix_Values"),type:"Number",width:i.GridColumnWidthInPx},{name:this.localizationService.get("Date"),type:"Date",width:i.GridColumnWidthInPx}],this.DuplicateCurrentValueDates={bannerType:1,iconName:i.ErrorIcon,message:this.localizationService.get("Metrics_Values_Editor_Error_Duplicate_Current_Value_Dates")},this.MissingCurrentValueDate={bannerType:1,iconName:i.ErrorIcon,message:this.localizationService.get("Metrics_Values_Editor_Error_Missing_Current_Value_Date")},this.MissingCurrentValue={bannerType:1,iconName:i.ErrorIcon,message:this.localizationService.get("Metrics_Values_Editor_Error_Missing_Current_Value")}}return i.prototype.ngOnInit=function(){var n=this;this.goal$.pipe((0,he.q)(1)).subscribe(function(t){n.columnsConfig=[(0,w.__assign)((0,w.__assign)({},n.columnsConfig[n.ValueColumnIndex]),{formatString:t.valuesFormatString}),(0,w.__assign)((0,w.__assign)({},n.columnsConfig[n.DateAddedColumnIndex]),{formatString:t.datesFormatString})]}),this.goalValues$.pipe((0,he.q)(1)).subscribe(function(t){n.gridData=t.map(function(r){return[r.value,new Date(r.timestamp)]}),n.changeDetector.markForCheck()})},i.prototype.ngAfterViewInit=function(){var n=this;this.columnsConfig=_.map(this.columnsConfig,function(t){return t.template=n.formatSwitchCellTemplate.formatSwitchCell,t})},i.prototype.ngOnDestroy=function(){this.onDestroy$.next(),this.onDestroy$.complete()},i.prototype.onRowUpdate=function(n){this.gridData=n},i.prototype.toggleFullScreen=function(){this.isFullScreen?(this.dialogRef.updateSize("70%","80%"),this.isFullScreen=!1):(this.dialogRef.updateSize("100%","100%"),this.isFullScreen=!0)},i.prototype.close=function(){this.telemetryService.logEvent(Pe),this.dialogRef.close()},i.prototype.onDone=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,r,a,s;return(0,w.__generator)(this,function(c){if(this.gridData=this.gridEditor.flushPendingChanges(),(n=this.gridData.filter(function(u){return!(_.isNil(u[0])&&_.isNil(u[1]))}).map(function(u){return{timestamp:_.isNil(u[1])?void 0:u[1],value:_.isNil(u[0])?void 0:u[0]}})).find(function(u){return _.isNil(u.timestamp)&&!_.isNil(u.value)}))return this.messageBanner=this.MissingCurrentValueDate,[2];if(n.find(function(u){return!_.isNil(u.timestamp)&&_.isNil(u.value)}))return this.messageBanner=this.MissingCurrentValue,[2];for(t=new Set,r=0,a=n;r<a.length;r++){if(t.has((s=a[r].timestamp).getTime()))return this.messageBanner=this.DuplicateCurrentValueDates,[2];t.add(s.getTime())}return this.onDoneCallback(n.map(function(u){return{timestamp:u.timestamp.toISOString(),value:u.value}}),this.columnsConfig[this.ValueColumnIndex].formatString),this.telemetryService.logEvent(yr),this.dialogRef.close(),[2]})})},i.prototype.valueFormatStringChanged=function(n){this.columnsConfig=[(0,w.__assign)((0,w.__assign)({},this.columnsConfig[this.ValueColumnIndex]),{formatString:n}),this.columnsConfig[1]]},i.ErrorIcon="pbi-glyph-blocked2",i.GridColumnWidthInPx=200,i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(wn.so),e.\u0275\u0275directiveInject(wn.WI),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(Ca.y0),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-values-editor"]],viewQuery:function(t,r){if(1&t&&(e.\u0275\u0275viewQuery(ys,5),e.\u0275\u0275viewQuery(bs,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.gridEditor=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.formatSwitchCellTemplate=a.first)}},decls:27,vars:29,consts:[[3,"viewModel",4,"ngIf"],[1,"title"],["mat-icon-button","",1,"pbi-icon-button",3,"click"],["class","glyph-small","fontIcon","pbi-glyph-fullscreen",4,"ngIf"],["class","glyph-small","fontIcon","pbi-glyph-fullscreenexit",4,"ngIf"],[1,"values-editor-value-formatting-box"],[1,"goals-value-formatting",3,"formatString","dataType","formatStringChange"],["class","pbi-spinner-large",4,"ngIf","ngIfElse"],["showGrid",""],[1,"actions"],[1,"pbi-fluent-button","primary",3,"disabled","click"],[1,"pbi-fluent-button","secondary",3,"click"],[3,"viewModel"],["fontIcon","pbi-glyph-fullscreen",1,"glyph-small"],["fontIcon","pbi-glyph-fullscreenexit",1,"glyph-small"],[1,"pbi-spinner-large"],[1,"grid-container"],[3,"rows","columns","rowsChange"],["gridEditor",""]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,id,1,1,"message-banner",0),e.\u0275\u0275elementStart(1,"header")(2,"div",1),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",2),e.\u0275\u0275listener("click",function(){return r.toggleFullScreen()}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275template(7,od,1,0,"mat-icon",3),e.\u0275\u0275template(8,ad,1,0,"mat-icon",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"section"),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",5)(13,"value-formatting",6),e.\u0275\u0275listener("formatStringChange",function(c){return r.valueFormatStringChanged(c)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,sd,1,0,"pbi-spinner",7),e.\u0275\u0275template(15,ld,3,2,"ng-template",null,8,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275element(17,"format-switch-cell-template"),e.\u0275\u0275elementStart(18,"div",9)(19,"button",10),e.\u0275\u0275listener("click",function(){return r.onDone()}),e.\u0275\u0275pipe(20,"localize"),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"button",11),e.\u0275\u0275listener("click",function(){return r.close()}),e.\u0275\u0275pipe(24,"localize"),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"localize"),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(16);e.\u0275\u0275property("ngIf",r.messageBanner),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,15,"Metrics_Values_Editor_Title")),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,17,"Fullscreen_Toggle")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.isFullScreen),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isFullScreen),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(11,19,"Metrics_Values_Editor_Description"),"\n"),e.\u0275\u0275advance(3),e.\u0275\u0275property("formatString",r.columnsConfig[0].formatString)("dataType",r.resultType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.gridData)("ngIfElse",a),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",!r.gridData),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(20,21,"Done_ButtonText")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,23,"Done_ButtonText")," "),e.\u0275\u0275advance(2),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(24,25,"PBI_Button_Label_Cancel")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(26,27,"PBI_Button_Label_Cancel")," ")}},dependencies:[j.NgIf,Xt.Hw,ql.A,Jn.k,bn.d,ys,bs,Mt.F],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]     .values-editor-value-formatting-box mat-select{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .values-editor-value-formatting-box mat-select .mat-select-value{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .values-editor-value-formatting-box mat-select .mat-select-arrow{color:var(--gray-140, #484644);padding-right:14px}[_nghost-%COMP%]     .values-editor-value-formatting-box num-up-down .inputRange{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]     .values-editor-value-formatting-box num-up-down .inputRange .inputUpDown{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}[_nghost-%COMP%]     .values-editor-value-formatting-box num-up-down label{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);line-height:20px}[_nghost-%COMP%]     .values-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn{background-color:transparent;border:none}[_nghost-%COMP%]     .values-editor-value-formatting-box .valueFormatterToggleButtonsGroup .btn:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}header[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-dark-color, #201F1E);display:flex;flex-direction:row;align-items:center;justify-content:space-between}header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-semi-bold, 600)}header[_ngcontent-%COMP%], section[_ngcontent-%COMP%], tri-grid[_ngcontent-%COMP%], .values-editor-value-formatting-box[_ngcontent-%COMP%]{margin-bottom:16px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:end;gap:8px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin:5px 5px 0 0}.pbi-spinner-large[_ngcontent-%COMP%]{height:100%}.grid-container[_ngcontent-%COMP%]{flex-grow:1}'],changeDetection:0}),i}(),Tc=function(){function i(n){this.dialogService=n}return i.prototype.launchTargetsEditor=function(n,t,r){this.dialogService.open(Oc,{width:"70%",height:"80%",maxWidth:"100%",maxHeight:"100%",autoFocus:!1,data:{goal$:(0,ae.of)(n),goalTargets$:t,onDoneCallback:r}})},i.prototype.launchValuesEditor=function(n,t,r){this.dialogService.open(xc,{width:"70%",height:"80%",maxWidth:"100%",maxHeight:"100%",autoFocus:!1,data:{goal$:(0,ae.of)(n),goalValues$:t,onDoneCallback:r}})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Ut.x))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),cd=M(56083),Ec=function(){function i(n,t){this.localizationService=n,this.tutorialPopupService=t}return i.prototype.startFirstGoalTutorial=function(){this.tutorialPopupService.startTutorial(this.createFirstGoalTutorialModel())},i.prototype.createFirstGoalTutorialModel=function(){var n,t="ScorecardTutorialFirstGoalName",r="ScorecardTutorialFirstGoalCurrent",a="ScorecardTutorialFirstGoalTarget";return{isSequentialTutorial:!0,itemKeys:[t,r,a],items:(n={},n[t]={title:this.localizationService.get("ScorecardTutorial_MetricName_Title"),text:this.localizationService.get("ScorecardTutorial_MetricName_Text"),buttonLabel:this.localizationService.get("TutorialPopup_Next"),dataStoreKey:t,canShow:function(){return $(W.gT.ScorecardTutorial_FirstGoalNameSelector).length>0},attachTo:function(){return $(W.gT.ScorecardTutorial_FirstGoalNameSelector)},offset:{top:0,left:-10}},n[r]={title:this.localizationService.get("ScorecardTutorial_MetricCurrent_Title"),text:this.localizationService.get("ScorecardTutorial_MetricCurrent_Text"),buttonLabel:this.localizationService.get("TutorialPopup_Next"),dataStoreKey:r,canShow:function(){return $(W.gT.ScorecardTutorial_FirstGoalCurrentSelector).length>0},attachTo:function(){return $(W.gT.ScorecardTutorial_FirstGoalCurrentSelector)},offset:{top:0,left:-10}},n[a]={title:this.localizationService.get("ScorecardTutorial_MetricTarget_Title"),text:this.localizationService.get("ScorecardTutorial_MetricTarget_Text"),buttonLabel:this.localizationService.get("Done_ButtonText"),dataStoreKey:a,canShow:function(){return $(W.gT.ScorecardTutorial_FirstGoalTargetSelector).length>0},attachTo:function(){return $(W.gT.ScorecardTutorial_FirstGoalTargetSelector)},offset:{top:0,left:-10}},n)}},i.prototype.startGoalRollupsTutorial=function(){this.tutorialPopupService.startTutorial(this.createGoalRollupsTutorialModel())},i.prototype.createGoalRollupsTutorialModel=function(){var n,t="GoalRollupsTutorial",r=W.gT.ScorecardTutorial_GoalRollupSelector;return{itemKeys:[t],items:(n={},n[t]={title:this.localizationService.get("TutorialPopup_MetricsRollupsTitle"),text:this.localizationService.get("TutorialPopup_MetricsRollupsContent"),buttonLabel:this.localizationService.get("TutorialPopup_GotIt"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},preferredOrientation:"bottom",telemetryEventArgs:[cr],customClass:"goal-rollups-tutorial"},n)}},i.prototype.startGoalRollupsDetailsPaneTutorial=function(){this.tutorialPopupService.startTutorial(this.createGoalRollupsDetailsPaneTutorialModel())},i.prototype.createGoalRollupsDetailsPaneTutorialModel=function(){var n,t="GoalRollupsDetailsPaneTutorial",r=W.gT.ScorecardTutorial_GoalRollupDetailsPaneSelector;return{itemKeys:[t],items:(n={},n[t]={title:this.localizationService.get("TutorialPopup_MetricsRollupsTitle_DetailsPane"),text:this.localizationService.get("TutorialPopup_MetricsRollupsContent_DetailsPane"),buttonLabel:this.localizationService.get("TutorialPopup_GotIt"),dataStoreKey:t,canShow:function(){return!!$(r)},attachTo:function(){return $(r)},learnMoreText:this.localizationService.get("LearnMore"),learnMoreUrl:"https://learn.microsoft.com/en-us/power-bi/create-reports/service-metrics-submetrics#get-started-creating-rollups",preferredOrientation:"right",telemetryEventArgs:[Gr],customClass:"show-goal-rollups-coachmark"},n)}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(ft.o),e.\u0275\u0275inject(cd.yU))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ud=function(n){return{isNew:n}};function dd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(2,ud,t.goal.isNew&&!t.selectedValue)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.currentStatus)}}function pd(i,n){1&i&&e.\u0275\u0275element(0,"tri-svg-icon",16),2&i&&e.\u0275\u0275property("name","link_20_regular")}var tc=function(n){return{selected:n}};function hd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onValueSelect(s.allGoalValueOptions[2].value))}),e.\u0275\u0275element(1,"tri-svg-icon",7),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!r.capabilities.selectMultiple)("ngClass",e.\u0275\u0275pureFunction1(5,tc,(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[2].value.type)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[2].value.type?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.allGoalValueOptions[2].displayName," ")}}function gd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onValueSelect(s.allGoalValueOptions[1].value))}),e.\u0275\u0275element(1,"tri-svg-icon",18),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!r.capabilities.selectConnect),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","edit_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,3,"Rollups_Connect_Edit")," ")}}function fd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onValueSelect(s.allGoalValueOptions[2].value))}),e.\u0275\u0275element(1,"tri-svg-icon",18),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!r.capabilities.selectMultiple),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","edit_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,3,r.isGoalCurrentValuePicker?"Rollups_Multiple_Values_Edit":"Rollups_Multiple_Targets_Edit")," ")}}function md(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",17),e.\u0275\u0275listener("click",function(){var u=e.\u0275\u0275restoreView(t).$implicit,p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onSelectRollup(u))}),e.\u0275\u0275element(2,"tri-svg-icon",19),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!a.capabilities.selectRollup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==a.selectedValue?null:a.selectedValue.rollupType)===r?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",a.metricRollupDisplayNames[r]," ")}}var Ic=function(){function i(n,t,r){this.localizationService=n,this.changeDetector=t,this.goalsTutorialService=r,this.onCurrentSelection=new e.EventEmitter,this.MetricRollupOptions=[1,2,4,3],this.isSelected=!1,this.isSubmetricSelected=!1,this.capabilities={},this.allGoalValueOptions=[],this.metricRollupDisplayNames={},this.setOptions()}return i.prototype.ngOnInit=function(){this.isGoalCurrentValuePicker=1===this.goalValueType},i.prototype.ngOnChanges=function(n){var t,r;if(n.goal&&(this.isCategorical=!!this.goal.valuesCategoryId,this.showGoalRollupsCoachmark&&this.goalsTutorialService.startGoalRollupsTutorial()),n.goalCapabilities&&(this.capabilities={editCalculation:this.goalCapabilities.editCalculationType,selectManual:!0,selectRollup:this.goalCapabilities.usePickerRollup,selectConnect:this.isGoalCurrentValuePicker?this.goalCapabilities.connectCurrentValueToData:this.goalCapabilities.connectTargetValueToData,selectMultiple:this.isGoalCurrentValuePicker?this.goalCapabilities.editMultipleValues:this.goalCapabilities.editMultipleTargets}),n.currentGoalValueTypeSelection){if(_.isUndefined(null===(r=null===(t=n.currentGoalValueTypeSelection)||void 0===t?void 0:t.currentValue)||void 0===r?void 0:r.rollupType))this.isSubmetricSelected=!1,this.selectedValue=n.currentGoalValueTypeSelection.currentValue,this.currentStatus=void 0===this.selectedValue?this.localizationService.get("Set_Up"):this.allGoalValueOptions[n.currentGoalValueTypeSelection.currentValue.type].buttonText;else{this.isSubmetricSelected=!0,this.selectedValue=n.currentGoalValueTypeSelection.currentValue;var a=Ei(n.currentGoalValueTypeSelection.currentValue.rollupType);this.selectedValue.rollupType=a,this.currentStatus=void 0===this.selectedValue?this.localizationService.get("Set_Up"):this.metricRollupDisplayNames[a]}this.changeDetector.markForCheck()}},i.prototype.setOptions=function(){this.metricRollupDisplayNames=Xo(this.localizationService),this.allGoalValueOptions=[{displayName:this.localizationService.get("Rollups_Manual_Metric"),value:{type:0},buttonText:this.localizationService.get("Rollups_Manual")},{displayName:this.localizationService.get("Rollups_Connect_To_Data"),value:{type:1},buttonText:""},{displayName:this.localizationService.get("Rollups_Multiple_Targets"),value:{type:2},buttonText:this.localizationService.get("Rollups_Multiple")}]},i.prototype.onValueSelect=function(n){this.onCurrentSelection.emit(n)},i.prototype.onSelectRollup=function(n){this.onCurrentSelection.emit({type:4,rollupType:n})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Ec))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-value-type-picker"]],inputs:{goal:"goal",hasMultipleTargets:"hasMultipleTargets",goalValueType:"goalValueType",currentGoalValueTypeSelection:"currentGoalValueTypeSelection",goalCapabilities:"goalCapabilities",showGoalRollupsCoachmark:"showGoalRollupsCoachmark"},outputs:{onCurrentSelection:"onCurrentSelection"},features:[e.\u0275\u0275NgOnChangesFeature],decls:26,vars:35,consts:[["mat-button","","cdkMonitorElementFocus","","data-testid","goal-value-input-menu-btn",1,"goal-value-input-menu-trigger",3,"matMenuTriggerFor","disabled"],[3,"ngClass",4,"ngIf"],[3,"name",4,"ngIf"],[1,"chevron-down",3,"name"],["xPosition","before",1,"goal-value-input-menu",3,"overlapTrigger"],["goalValueInputMenu","matMenu"],["mat-menu-item","",3,"disabled","ngClass","click"],[1,"margin-right",3,"ngClass","name"],["mat-menu-item","",1,"goal-value-input-sub-menu-button","submetrics-menu-trigger",3,"disabled","matMenuTriggerFor"],["name","chevronrightmedium","size","mini"],["mat-menu-item","",3,"disabled","ngClass","click",4,"ngIf"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],[1,"goal-value-input-sub-menu",3,"overlapTrigger"],["goalValueInputRollupsMenu","matMenu"],[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"name"],["mat-menu-item","",3,"disabled","click"],[1,"margin-right",3,"name"],[1,"margin-right-sub-menu",3,"ngClass","name"]],template:function(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275template(2,dd,2,4,"span",1),e.\u0275\u0275template(3,pd,1,1,"tri-svg-icon",2),e.\u0275\u0275element(4,"tri-svg-icon",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-menu",4,5)(7,"button",6),e.\u0275\u0275listener("click",function(){return r.onValueSelect(r.allGoalValueOptions[0].value)}),e.\u0275\u0275element(8,"tri-svg-icon",7),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"button",8)(11,"div"),e.\u0275\u0275element(12,"tri-svg-icon",7),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(15,"pbi-icon",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"button",6),e.\u0275\u0275listener("click",function(){return r.onValueSelect(r.allGoalValueOptions[1].value)}),e.\u0275\u0275element(17,"tri-svg-icon",7),e.\u0275\u0275text(18),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,hd,3,7,"button",10),e.\u0275\u0275element(20,"mat-divider"),e.\u0275\u0275template(21,gd,4,5,"button",11),e.\u0275\u0275template(22,fd,4,5,"button",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"mat-menu",12,13),e.\u0275\u0275template(25,md,4,4,"ng-container",14),e.\u0275\u0275elementEnd()),2&t){var c,a=e.\u0275\u0275reference(6),s=e.\u0275\u0275reference(24);e.\u0275\u0275property("matMenuTriggerFor",a)("disabled",!r.capabilities.editCalculation),e.\u0275\u0275attribute("aria-label",null!==(c=r.currentStatus)&&void 0!==c?c:e.\u0275\u0275pipeBind1(1,27,"Set_Up")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==r.selectedValue?null:r.selectedValue.type)!==r.allGoalValueOptions[1].value.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[1].value.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("name","chevron_down_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",!r.capabilities.selectManual||!r.isGoalCurrentValuePicker&&r.hasMultipleTargets)("ngClass",e.\u0275\u0275pureFunction1(31,tc,(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[0].value.type)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[0].value.type?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.allGoalValueOptions[0].displayName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!r.capabilities.selectRollup)("matMenuTriggerFor",s),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",r.isSubmetricSelected?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(14,29,"Rollups_Use_Submetrics")),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",!r.capabilities.selectConnect)("ngClass",e.\u0275\u0275pureFunction1(33,tc,(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[1].value.type)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[1].value.type?"show-checkmark":"hide-checkmark")("name","checkmark_20_regular"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.allGoalValueOptions[1].displayName," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.isGoalCurrentValuePicker),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!!r.goal.valueConnection&&r.isGoalCurrentValuePicker||!!r.goal.targetConnection&&!r.isGoalCurrentValuePicker),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.isCategorical&&r.isGoalCurrentValuePicker&&(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[0].value.type||!r.isGoalCurrentValuePicker&&(null==r.selectedValue?null:r.selectedValue.type)===r.allGoalValueOptions[2].value.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.MetricRollupOptions)}},dependencies:[j.NgClass,j.NgForOf,j.NgIf,Fi.d,Vt.W0,Vt.tN,Vt.D8,ln._,gr.M,Mt.F],styles:['.goal-value-input-menu-trigger[_ngcontent-%COMP%]{padding:6px 8px;width:100%;background:none;border:1px solid var(--gray-110, #8A8886);border-radius:2px;display:flex;flex-direction:row}.goal-value-input-menu-trigger[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding-left:4px;padding-top:4px}.goal-value-input-menu-trigger[_ngcontent-%COMP%]:active, .goal-value-input-menu-trigger[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--gray-88, #E0E0E0)}.goal-value-input-menu-trigger[_ngcontent-%COMP%]:disabled{color:var(--gray-90, #A19F9D);background-color:var(--gray-20, #F3F2F1);border-color:var(--gray-20, #F3F2F1)}button[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);color:var(--fluent-theme-neutral-primary-color, #323130);padding:6px 12px;height:32px}button[_ngcontent-%COMP%]   .isNew[_ngcontent-%COMP%]{color:var(--fluent-theme-link-darker-color, #005A9E)}button[_ngcontent-%COMP%]   tri-svg-icon.chevron-down[_ngcontent-%COMP%]{height:16px;width:16px;margin:2px;padding-left:4px}button[_ngcontent-%COMP%]   tri-svg-icon.margin-right[_ngcontent-%COMP%]{margin-right:8px}button[_ngcontent-%COMP%]   tri-svg-icon.margin-right-sub-menu[_ngcontent-%COMP%]{margin-right:6px}button[_ngcontent-%COMP%]   .show-checkmark[_ngcontent-%COMP%]{visibility:visible}button[_ngcontent-%COMP%]   .hide-checkmark[_ngcontent-%COMP%]{visibility:hidden}button[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--gray-96, #F5F5F5)}button[_ngcontent-%COMP%]:disabled   tri-svg-icon[_ngcontent-%COMP%]{opacity:50%}  .goal-value-input-menu-trigger .sort-icon .mat-icon{margin:0 4px}  .mat-menu-panel.goal-value-input-sub-menu{min-height:fit-content;transform:translateY(8px);width:100px;min-width:100px}  .goal-value-input-menu .mat-menu-item{padding-left:8px}  .goal-value-input-menu .mat-menu-content{width:190px;min-width:190px}  .goal-value-input-sub-menu .mat-menu-content{width:100px;min-width:100px}  .goal-value-input-sub-menu .mat-menu-content button{width:100px;min-width:100px}  .goal-rollups-tutorial.tutorial-popup .box{background-color:var(--gray-130, #605E5C)}  .goal-rollups-tutorial.tutorial-popup .box .arrow{background-color:var(--gray-130, #605E5C)}  .goal-rollups-tutorial.tutorial-popup .box .title{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--xlg-font-size, 20px);font-weight:var(--font-weight-semi-bold, 600)}  .goal-rollups-tutorial.tutorial-popup .box .text{margin:10px 10px 0;line-height:22px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center}.mat-menu-item[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:flex}.mat-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{height:inherit;display:flex;align-items:center}.mat-menu-item.goal-value-input-sub-menu-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.mat-menu-item[_ngcontent-%COMP%]:active, .mat-menu-item[_ngcontent-%COMP%]:hover{background-color:var(--gray-96, #F5F5F5)}.mat-menu-item[_ngcontent-%COMP%]:disabled{color:var(--gray-90, #A19F9D)}.selected[_ngcontent-%COMP%]{pointer-events:none;user-select:none;-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none}'],changeDetection:0}),i}(),vd=["valueInput"],Cd=["valueSelect"],_d=["targetInput"],yd=["targetSelect"],bd=["valueFormattingTmpl"],wd=["valueFormatting"];function Sd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13)(1,"button",14),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.openGoalValuesEditor())}),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()()}2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,1,"Edit")))}function Md(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",15)(1,"input",16,17),e.\u0275\u0275listener("focus",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onCurrentValueFocus())})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.save())})("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onCurrentValueChange(s))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("type",r.valueInputType),e.\u0275\u0275property("readonly",!r.capabilities.editCurrentValue||r.isValueSubmetricsSelected)("ngModel",r.valueInputValue),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,5,"CurrentValue"))("placeholder",r.displayedGoal.valueConnection||r.displayedGoal.valueRollup||r.isValueSubmetricsSelected?"-":e.\u0275\u0275pipeBind1(4,7,"Enter_Value"))}}function Pd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"option",22),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("ngValue",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function Od(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"select",18,19),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.valueSelected=s)}),e.\u0275\u0275element(2,"option",20),e.\u0275\u0275template(3,Pd,2,2,"option",21),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!r.capabilities.editCurrentValue)("ngModel",r.valueSelected),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",null==r.goalValueCategoryLists[r.selectedCategoryListIndex]?null:r.goalValueCategoryLists[r.selectedCategoryListIndex].categories)}}function xd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"goal-value-type-picker",23),e.\u0275\u0275listener("onCurrentSelection",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onCurrentSelectionCurrentValueChange(s))}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("canCustomizeStatus",null==r.capabilities.scorecardCapabilities?null:r.capabilities.scorecardCapabilities.customizeStatus)("goal",r.displayedGoal)("currentGoalValueTypeSelection",r.currentGoalValueTypeSelection)("goalValueType",1)("goalCapabilities",r.capabilities)("showGoalRollupsCoachmark",(null==r.displayedGoal.subGoals?null:r.displayedGoal.subGoals.length)>0&&r.capabilities.usePickerRollup)}}function Td(i,n){1&i&&e.\u0275\u0275element(0,"span",26)}function Ed(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275template(1,Td,1,0,"span",24),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onConnectCurrentToDataClick())}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.displayedGoal.valueConnection),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",r.displayedGoal.valueConnection?"UpdateConnection":"ConnectToData")}}function Id(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13)(1,"button",14),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.openGoalTargetsEditor())}),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()()}2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,1,"Edit")))}function Dd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",15)(1,"input",27,28),e.\u0275\u0275listener("focus",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onTargetValueFocus())})("keyup.enter",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.save())})("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onTargetValueChange(s))}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("type",r.targetInputType),e.\u0275\u0275property("readonly",!r.capabilities.editTargetValue||r.isTargetSubmetricsSelected)("ngModel",r.targetInputValue)("pbiTooltipDisabled",!(r.capabilities.supportMultipleTargetsEditing&&r.targetCount>1&&!r.displayedGoal.targetConnection&&!r.isTargetSubmetricsSelected))("pbiTooltipPosition","below"),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,7,"Target"))("placeholder",r.displayedGoal.targetConnection||r.displayedGoal.targetRollup||r.isTargetSubmetricsSelected?"-":e.\u0275\u0275pipeBind1(4,9,"Enter_A_Value"))}}function kd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"option",22),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("ngValue",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.displayName," ")}}function Fd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"select",29,30),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.targetSelected=s)}),e.\u0275\u0275element(2,"option",31),e.\u0275\u0275template(3,kd,2,2,"option",21),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!r.capabilities.editTargetValue)("ngModel",r.targetSelected),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",null==r.goalValueCategoryLists[r.selectedCategoryListIndex]?null:r.goalValueCategoryLists[r.selectedCategoryListIndex].categories)}}function Vd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"goal-value-type-picker",32),e.\u0275\u0275listener("onCurrentSelection",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onCurrentSelectionTargetChange(s))}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("canCustomizeStatus",null==r.capabilities.scorecardCapabilities?null:r.capabilities.scorecardCapabilities.customizeStatus)("goal",r.displayedGoal)("hasMultipleTargets",r.targetCount>1)("currentGoalValueTypeSelection",r.targetGoalValueTypeSelection)("goalValueType",2)("goalCapabilities",r.capabilities)}}function Ad(i,n){1&i&&e.\u0275\u0275element(0,"span",26)}function Rd(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275template(1,Ad,1,0,"span",24),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onConnectTargetToDataClick())}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.displayedGoal.targetConnection),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",r.displayedGoal.targetConnection?"UpdateConnection":"ConnectToData")}}function Ld(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",33,34)(2,"div",35),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"value-formatting",36),e.\u0275\u0275listener("formatStringChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.valueFormatStringChanged(s))})("onSelectedCategoryListChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.selectCategoryList(s))}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(r.formattedValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("formatString",r.formatString)("dataType",r.resultType)("supportCategoricalValues",r.capabilities.useCategoricalValues&&!r.isValueSubmetricsSelected&&!r.isTargetSubmetricsSelected)("goalValueCategoryLists",r.goalValueCategoryLists)("selectedCategoryListIndex",r.selectedCategoryListIndex)("launchCategoryListsEditPane",r.launchCategoryListsEditPane)}}var ya,ba,ws,wa,Sa,Ss,Ma,Un=function(i){return i[i.None=0]="None",i[i.Value=1]="Value",i[i.Target=2]="Target",i}({}),nc=function(){function i(n,t,r,a,s,c,u,p,v,P,x){var G=this;this.elementRef=n,this.pbiOverlay=t,this.changeDetector=r,this.formatValuePipe=a,this.localizationService=s,this.detailsPaneLauncher=c,this.goalValuesEditorLauncher=u,this.dialogService=p,this.scorecardService=v,this.connectToDataDialog=P,this.scorecardSettings=x,this.currentTargetChange=new e.EventEmitter,this.currentValueChange=new e.EventEmitter,this.targetsChange=new e.EventEmitter,this.valuesChange=new e.EventEmitter,this.valueRollupsChange=new e.EventEmitter,this.targetRollupsChange=new e.EventEmitter,this.onCategoryListIdChanged=new e.EventEmitter,this.onSave=new e.EventEmitter,this.onConnectionChanged=new e.EventEmitter,this.PaddingFromComponentToEditor=4,this.GoalEditValueTooltipId="goal-edit-value-formatting",this.resultType=2,this.formatNilReturn="",this.focusedInput=Un.None,this.goalValueCategoryLists=[],this.isValueSubmetricsSelected=!1,this.isTargetSubmetricsSelected=!1,this.currentGoalValueTypeSelection=void 0,this.targetGoalValueTypeSelection=void 0,this.launchCategoryListsEditPane=function(Y){G.overlayRef&&(G.overlayRef.close(),G.overlayRef=null),G.detailsPaneLauncher.openCategoryListsEditPane(G.scorecardService,Y,function(Ae){_.isEmpty(G.goalValueCategoryLists)&&(G.formatString="");var xe=G.displayedGoal.valuesCategoryId;if(xe){var Be=_.findIndex(G.goalValueCategoryLists,function(Je){return Je.id===xe});Ae&&1===G.goalValueCategoryLists.length&&(Be=0),Be<0?(G.selectedCategoryListIndex=Be,G.onCategoryListIdChanged.emit(xe),G.formatGoalValues()):G.selectCategoryList(Be)}else G.selectCategoryList(Be=Ae&&1===G.goalValueCategoryLists.length?0:-1)})}}return i.prototype.ngOnInit=function(){var t,r,a,s,n=this;if(this.formatString=this.displayedGoal.valuesCategoryId?bn.d.CategoricalFormatString:this.displayedGoal.valuesFormatString,this.originalCurrentValue=this.currentValue.value,this.capabilities.useCategoricalValues&&(this.categoryListsSubscribe=this.scorecardService.getScorecard().pipe((0,I.x)(function(p,v){return _.isEqual(p.goalValueCategories,v.goalValueCategories)})).subscribe(function(){var p;n.goalValueCategoryLists=n.scorecardService.getGoalValueCategoryLists(n.displayedGoal),n.selectedCategoryListIndex=null!==(p=_.findIndex(n.goalValueCategoryLists,function(v){return v.id===n.displayedGoal.valuesCategoryId}))&&void 0!==p?p:-1})),this.capabilities.supportMultipleTargetsEditing&&!this.displayedGoal.targetConnection){var c;c=this.displayedGoal.isNew?0:null!==(a=null===(r=null===(t=this.displayedGoal.aggregations)||void 0===t?void 0:t.find(function(p){return"NumberOfTargets"===p.type}))||void 0===r?void 0:r.value)&&void 0!==a?a:0,this.targetCount=Math.max(c,1)}if(_.isUndefined(null===(s=this.displayedGoal.metadata)||void 0===s?void 0:s.showFinalTarget)&&this.capabilities.supportMultipleTargetsEditing){var u=!this.displayedGoal.targetConnection;this.displayedGoal.metadata?this.displayedGoal.metadata.showFinalTarget=u:this.displayedGoal.metadata={showFinalTarget:u}}this.formatGoalValues(),this.updateCurrentGoalValueTypeSelection(void 0,1),this.updateCurrentGoalValueTypeSelection(void 0,2)},i.prototype.save=function(){this.onSave.emit()},i.prototype.onCurrentSelectionCurrentValueChange=function(n){var t;return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(r){return this.isValueSubmetricsSelected=null!==(t=!_.isUndefined(n.rollupType))&&void 0!==t&&t,1!==n.type&&this.displayedGoal.valueConnection&&(this.displayedGoal.valueConnection=void 0,this.onConnectionChanged.emit()),_.isUndefined(n.rollupType)?2===n.type?(this.displayedGoal.valueRollup=void 0,this.openGoalValuesEditor()):1===n.type?this.onConnectCurrentToDataClick():this.displayedGoal.valueRollup=void 0:(this.currentValue=(0,w.__assign)((0,w.__assign)({},this.currentValue),{value:null}),this.currentValueChange.emit(this.currentValue),this.formatGoalValues()),this.changeDetector.detectChanges(),this.valueRollupsChange.emit({rollupType:n.rollupType,type:n.type}),this.updateCurrentGoalValueTypeSelection(n,1),[2]})})},i.prototype.onCurrentSelectionTargetChange=function(n){var t;return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(r){return this.isTargetSubmetricsSelected=null!==(t=!_.isUndefined(n.rollupType))&&void 0!==t&&t,1!==n.type&&this.displayedGoal.targetConnection&&(this.displayedGoal.targetConnection=void 0,this.onConnectionChanged.emit()),_.isUndefined(n.rollupType)?2===n.type?this.openGoalTargetsEditor():1===n.type?this.onConnectTargetToDataClick():this.displayedGoal.targetRollup=void 0:(this.currentTarget=(0,w.__assign)((0,w.__assign)({},this.currentTarget),{target:null}),this.currentTargetChange.emit(this.currentTarget),this.formatGoalValues()),this.changeDetector.detectChanges(),this.targetRollupsChange.emit({rollupType:n.rollupType,type:n.type}),this.updateCurrentGoalValueTypeSelection(n,2),[2]})})},i.prototype.updateCurrentGoalValueTypeSelection=function(n,t){var r,a,s,c,u,p;2===t?this.targetGoalValueTypeSelection=this.displayedGoal.targetConnection?{type:1}:this.isTargetSubmetricsSelected||_.isNil(n)&&!_.isNil(null===(r=this.displayedGoal)||void 0===r?void 0:r.targetRollup)?{type:4,rollupType:null!==(a=n?.rollupType)&&void 0!==a?a:null===(s=this.displayedGoal.targetRollup)||void 0===s?void 0:s.rollupType}:this.targetCount>1?{type:2}:this.displayedGoal.isNew&&void 0===n?void 0:{type:0}:this.currentGoalValueTypeSelection=this.displayedGoal.valueConnection?{type:1}:this.isValueSubmetricsSelected||_.isNil(n)&&!_.isNil(null===(c=this.displayedGoal)||void 0===c?void 0:c.valueRollup)?{type:4,rollupType:null!==(u=n?.rollupType)&&void 0!==u?u:null===(p=this.displayedGoal.valueRollup)||void 0===p?void 0:p.rollupType}:this.displayedGoal.isNew&&void 0===n?void 0:{type:0}},i.prototype.ngOnDestroy=function(){this.overlayRef&&(this.overlayRef.close(),this.overlayRef=null),this.connectToDataDialog.close(),this.categoryListsSubscribe&&this.categoryListsSubscribe.unsubscribe()},i.prototype.onConnectCurrentToDataClick=function(){var n=this;this.detailsPaneLauncher.closeGoalDetails(),this.getDialogConfig(1).then(function(t){n.connectToDataDialog.open(t).pipe((0,he.q)(1)).subscribe(function(r){var a;if(r){var c=(0,w.__rest)(r,["previewResult"]);n.displayedGoal.valueConnection=c;var u=(a=$t.getPreviewValue(r.previewResult)).value;n.valueFormatStringChanged(a.formatString),n.currentValue=(0,w.__assign)((0,w.__assign)({},n.currentValue),{value:u}),n.currentValueChange.emit(n.currentValue),n.capabilities.supportMultipleValuesEditing&&(n.values=void 0,n.valuesChange.emit(n.values)),n.formatGoalValues(),n.updateCurrentGoalValueTypeSelection({type:1},1),n.onConnectionChanged.emit(),n.changeDetector.detectChanges()}})})},i.prototype.onConnectTargetToDataClick=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return this.detailsPaneLauncher.closeGoalDetails(),this.capabilities.supportMultipleTargetsEditing&&!this.displayedGoal.targetConnection&&(this.targetCount>1||null!=this.currentTarget.target)?[4,this.dialogService.showConfirmationDialog({title:this.localizationService.get("Metrics_Switch_To_Connected_Data"),message:this.localizationService.get("Metrics_Switch_To_Connected_Data_Multiple_Goal_Targets"),okButtonText:this.localizationService.get("ModalDialogButtonText_Continue")}).afterClosed().toPromise()]:[3,2];case 1:if(1!==a.sent())return[2];a.label=2;case 2:return this.getDialogConfig(2).then(function(s){r.connectToDataDialog.open(s).pipe((0,he.q)(1)).subscribe(function(c){var u,p;if(c){var P=(0,w.__rest)(c,["previewResult"]);r.displayedGoal.targetConnection=P;var x=(u=$t.getPreviewValue(c.previewResult)).value;if(r.valueFormatStringChanged(u.formatString),r.currentTarget=(0,w.__assign)((0,w.__assign)({},r.currentTarget),{target:x}),r.currentTargetChange.emit(r.currentTarget),r.capabilities.supportMultipleTargetsEditing){r.targets=void 0,r.targetsChange.emit(r.targets),r.targetCount=void 0;var Y=!1;null!==(p=r.displayedGoal)&&void 0!==p&&p.metadata?r.displayedGoal.metadata.showFinalTarget=Y:r.displayedGoal.metadata={showFinalTarget:Y}}r.formatGoalValues(),r.updateCurrentGoalValueTypeSelection({type:1},2),r.onConnectionChanged.emit(),r.changeDetector.detectChanges()}})}),[2]}})})},i.prototype.onCurrentValueFocus=function(){this.focusedInput!==Un.Value&&(this.focusedInput=Un.Value,this.formatGoalValues(),this.valueInput.nativeElement.click()),this.capabilities.changeValueFormat&&null==this.overlayRef&&this.openValueFormattingPane()},i.prototype.onTargetValueFocus=function(){this.focusedInput!==Un.Target&&(this.focusedInput=Un.Target,this.formatGoalValues(),this.targetInput.nativeElement.click()),this.capabilities.changeValueFormat&&null==this.overlayRef&&this.openValueFormattingPane()},i.prototype.valueFormatStringChanged=function(n){var t=this.formatString===bn.d.CategoricalFormatString;this.formatString=n,this.displayedGoal.valuesFormatString=n===bn.d.CategoricalFormatString?"":n??"",t&&this.formatString!==bn.d.CategoricalFormatString&&this.onCategoryListIdChanged.emit(null),this.formatGoalValues()},i.prototype.isCategoricalValue=function(n){var t,r;return this.isCategoricalFormat&&this.selectedCategoryListIndex>=0&&this.selectedCategoryListIndex<(null===(t=this.goalValueCategoryLists)||void 0===t?void 0:t.length)&&(null===(r=this.goalValueCategoryLists[this.selectedCategoryListIndex])||void 0===r?void 0:r.categories.length)>n},i.prototype.onCurrentValueChange=function(n){var t=this,r=_.isNil(n)||""===n?null:+n;this.currentValue=(0,w.__assign)((0,w.__assign)({},this.currentValue),{value:r}),this.currentValueChange.emit(this.currentValue),this.currentGoalValueTypeSelection={type:0},this.capabilities.supportMultipleValuesEditing&&this.values&&(this.values=(0,nt.ZP)(this.values,function(a){var s=a.find(function(c){return new Date(c.timestamp).getTime()===new Date(t.currentValue.timestamp).getTime()});s?s.value=t.currentValue.value:a.push(t.currentValue)}),this.valuesChange.emit(this.values)),this.formatGoalValues()},i.prototype.onTargetValueChange=function(n){var t=this,r=_.isNil(n)||""===n?null:+n;this.currentTarget=(0,w.__assign)((0,w.__assign)({},this.currentTarget),{target:r}),this.currentTargetChange.emit(this.currentTarget),this.targetGoalValueTypeSelection={type:0},this.capabilities.supportMultipleTargetsEditing&&this.targets&&(b.fF.assert(function(){return t.targetCount<=1&&t.targets.length<=1},"Inline target editor should only be enabled if there's at most one target!"),this.targets=[this.currentTarget],this.targetsChange.emit(this.targets)),this.formatGoalValues()},i.prototype.openGoalTargetsEditor=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,w.__generator)(this,function(a){return b.fF.assertValue(_.isNil(this.displayedGoal.targetConnection),"Targets can only be edited if there is no target connection"),n=this.getGoalTargets(),this.goalValuesEditorLauncher.launchTargetsEditor(this.displayedGoal,n,function(c,u,p){return(0,w.__awaiter)(r,void 0,void 0,function(){var v,P;return(0,w.__generator)(this,function(x){return c.length>0?(c.sort(function(G,Y){return new Date(G.timestamp).getTime()-new Date(Y.timestamp).getTime()}),this.currentTarget=u?ke.r.calculateFinalTarget(c):ke.r.calculateNextTarget(c),this.targets=c):((v=ne.E.getCurrentLocalDay()).setMonth(v.getMonth()+1),this.currentTarget={timestamp:v.toISOString(),target:null},this.targets=[this.currentTarget]),this.currentTargetChange.emit(this.currentTarget),this.targetsChange.emit(this.targets),null!==(P=this.displayedGoal)&&void 0!==P&&P.metadata?this.displayedGoal.metadata.showFinalTarget=u:this.displayedGoal.metadata={showFinalTarget:u},this.targetCount=c.length,this.formatString=p,this.displayedGoal.valuesFormatString=p,this.formatGoalValues(),this.updateCurrentGoalValueTypeSelection({type:2},2),[2]})})}),[2]})})},i.prototype.openGoalValuesEditor=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,w.__generator)(this,function(a){return b.fF.assertValue(_.isNil(this.displayedGoal.valueConnection),"Values can only be edited if there is no value connection"),n=this.getGoalValues(),this.goalValuesEditorLauncher.launchValuesEditor(this.displayedGoal,n,function(c,u){return(0,w.__awaiter)(r,void 0,void 0,function(){return(0,w.__generator)(this,function(p){return c.length>0?(c.sort(function(v,P){return new Date(v.timestamp).getTime()-new Date(P.timestamp).getTime()}),this.currentValue=(0,w.__assign)((0,w.__assign)({},this.currentValue),{value:ke.r.calculateCurrentValue(c)}),this.values=c):(this.currentValue=(0,w.__assign)((0,w.__assign)({},this.currentValue),{value:null}),this.values=[this.currentValue]),this.currentValueChange.emit(this.currentValue),this.valuesChange.emit(this.values),this.formatString=u,this.displayedGoal.valuesFormatString=u,this.formatGoalValues(),this.updateCurrentGoalValueTypeSelection({type:0},1),[2]})})}),[2]})})},i.prototype.getGoalTargets=function(){var t,r,n=this;return this.displayedGoal.isNew||this.targets?r=(0,ae.of)(null!==(t=this.targets)&&void 0!==t?t:[]):(this.scorecardService.expandGoalValues(this.displayedGoal.id,!1),r=this.scorecardService.getGoal(this.displayedGoal.id).pipe((0,jt.h)(function(a){return a.isExpanded}),(0,je.U)(function(a){var s;return null!==(s=a.goalValues)&&void 0!==s?s:[]}),(0,je.U)(function(a){return a.filter(function(s){return!_.isNil(s.target)})}))),r.pipe((0,je.U)(function(a){return(0,nt.ZP)(a,function(s){if(!_.isNil(n.targetCount)&&n.targetCount<=1){b.fF.assert(function(){return s.length<=1},"Inline target editor should only be enabled if there's at most one target!");var c=s.find(function(u){return new Date(u.timestamp).getTime()===new Date(n.currentTarget.timestamp).getTime()});c?c.target=n.currentTarget.target:s.push(n.currentTarget)}})}),(0,je.U)(function(a){return(0,nt.ZP)(a,function(s){s.sort(function(c,u){return new Date(c.timestamp).getTime()-new Date(u.timestamp).getTime()})})}))},i.prototype.getGoalValues=function(){var t,r,n=this;return this.displayedGoal.isNew||this.values?r=(0,ae.of)(null!==(t=this.values)&&void 0!==t?t:[]):(this.scorecardService.expandGoalValues(this.displayedGoal.id,!1),r=this.scorecardService.getGoal(this.displayedGoal.id).pipe((0,jt.h)(function(a){return a.isExpanded}),(0,je.U)(function(a){var s;return null!==(s=a.goalValues)&&void 0!==s?s:[]}),(0,je.U)(function(a){return a.filter(function(s){return!_.isNil(s.value)})}))),r.pipe((0,je.U)(function(a){return(0,nt.ZP)(a,function(s){var c=s.find(function(u){return new Date(u.timestamp).getTime()===new Date(n.currentValue.timestamp).getTime()});c?c.value=n.currentValue.value:n.originalCurrentValue!==n.currentValue.value&&s.push(n.currentValue)})}),(0,je.U)(function(a){return(0,nt.ZP)(a,function(s){s.sort(function(c,u){return new Date(c.timestamp).getTime()-new Date(u.timestamp).getTime()})})}))},i.prototype.onMouseClick=function(n){var t,r,a,s,c,u,p,v,P=n?.target;return null!==(t=this.valueSelect)&&void 0!==t&&t.nativeElement.contains(P)?(this.focusedInput!==Un.Value&&(this.focusedInput=Un.Value,this.formatGoalValues()),void(this.overlayRef||this.openValueFormattingPane())):null!==(r=this.targetSelect)&&void 0!==r&&r.nativeElement.contains(P)?(this.focusedInput!==Un.Target&&(this.focusedInput=Un.Target,this.formatGoalValues()),void(this.overlayRef||this.openValueFormattingPane())):void(null!==(a=this.valueInput)&&void 0!==a&&a.nativeElement.contains(P)||null!==(s=this.targetInput)&&void 0!==s&&s.nativeElement.contains(P)||null!==(u=null===(c=this.valueFormatting)||void 0===c?void 0:c.nativeElement)&&void 0!==u&&u.contains(P)||P.classList.contains("mat-option-text")||P.classList.contains("pbi-menu-item")||null!==(p=this.valueInput)&&void 0!==p&&p.nativeElement.contains(document.activeElement)||null!==(v=this.targetInput)&&void 0!==v&&v.nativeElement.contains(document.activeElement)||(this.focusedInput!==Un.None&&(this.focusedInput=Un.None,this.formatGoalValues()),this.overlayRef&&(this.overlayRef.close(),this.overlayRef=null)))},i.prototype.selectCategoryList=function(n){var t;this.selectedCategoryListIndex=n,this.onCategoryListIdChanged.emit(null===(t=this.goalValueCategoryLists[this.selectedCategoryListIndex])||void 0===t?void 0:t.id),this.formatGoalValues()},Object.defineProperty(i.prototype,"valueSelected",{get:function(){return this.isCategoricalValue(this.currentValue.value)?this.currentValue.value:void 0},set:function(t){var r=this;this.currentValue=(0,w.__assign)((0,w.__assign)({},this.currentValue),{value:t}),this.currentValueChange.emit(this.currentValue),this.capabilities.supportMultipleValuesEditing&&this.values&&(this.values=(0,nt.ZP)(this.values,function(a){var s=a.find(function(c){return new Date(c.timestamp).getTime()===new Date(r.currentValue.timestamp).getTime()});s?s.value=r.currentValue.value:a.push(r.currentValue)}),this.valuesChange.emit(this.values)),this.formatGoalValues()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"targetSelected",{get:function(){return this.isCategoricalValue(this.currentTarget.target)?this.currentTarget.target:void 0},set:function(t){var r=this,a=t;this.currentTarget=(0,w.__assign)((0,w.__assign)({},this.currentTarget),{target:a}),this.currentTargetChange.emit(this.currentTarget),this.capabilities.supportMultipleTargetsEditing&&this.targets&&(b.fF.assert(function(){return r.targetCount<=1&&r.targets.length<=1},"Inline target editor should only be enabled if there's at most one target!"),this.targets=[this.currentTarget],this.targetsChange.emit(this.targets)),this.formatGoalValues()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isCategoricalFormat",{get:function(){return this.formatString===bn.d.CategoricalFormatString},enumerable:!1,configurable:!0}),i.prototype.openValueFormattingPane=function(){var n=this.pbiOverlay.position().flexibleConnectedTo(this.elementRef.nativeElement).withPositions([(0,_e.xe)(0,-this.PaddingFromComponentToEditor)]).withPush(!0).withGrowAfterOpen(!0);this.overlayRef=this.pbiOverlay.open({component:Bn.i,data:{id:this.GoalEditValueTooltipId,templateRef:this.valueFormattingTmpl},options:{positionStrategy:n,hasBackdrop:!1,disposeOnNavigation:!0},hasCaret:!1,focusElementOnClose:null,disableCloseOnEsc:!0,disableFocusTrapSetting:{disable:!0}}),this.overlayRef.componentRef.changeDetectorRef.detectChanges()},i.prototype.formatValue=function(n){var t,r;return this.formatString!==bn.d.CategoricalFormatString?this.formatValuePipe.transform(n,this.formatString,!0,this.formatNilReturn):this.isCategoricalValue(n)?null===(r=null===(t=this.goalValueCategoryLists[this.selectedCategoryListIndex])||void 0===t?void 0:t.categories[n])||void 0===r?void 0:r.displayName:void 0},i.prototype.formatGoalValues=function(){var n,t,r,a,s=this.focusedInput===Un.Value&&this.capabilities.editCurrentValue,c=this.focusedInput===Un.Target&&this.capabilities.editTargetValue;this.valueInputType=s?"number":"text",this.targetInputType=c?"number":"text",this.valueInputValue=s?null!==(t=null===(n=this.currentValue.value)||void 0===n?void 0:n.toString())&&void 0!==t?t:"":this.formatValue(this.currentValue.value),this.targetInputValue=c?null!==(a=null===(r=this.currentTarget.target)||void 0===r?void 0:r.toString())&&void 0!==a?a:"":this.formatValue(this.currentTarget.target),this.formattedValue="",this.focusedInput===Un.Value&&(this.formattedValue=this.formatValue(this.currentValue.value)),this.focusedInput===Un.Target&&(this.formattedValue=this.formatValue(this.currentTarget.target))},i.prototype.getDialogConfig=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a;return(0,w.__generator)(this,function(c){switch(c.label){case 0:return r={data:{}},(a=1===n?this.displayedGoal.valueConnection:this.displayedGoal.targetConnection)&&(r.data.reportUrl=a.reportUrl,a.shouldClearGoalValues&&(r.data.banner={bannerType:2,iconName:"pbi-glyph-info",message:this.localizationService.get("Metric_Clear_Values_On_New_Connection_Warning")})),this.scorecardSettings?[4,this.scorecardSettings.settings.pipe((0,he.q)(1)).toPromise()]:[2,r];case 1:return c.sent().alwaysMaximize&&(r.height="100%",r.width="100%",r.hideFullscreenToggle=!0),[2,r]}})})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(be._),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Er.c),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(Tc),e.\u0275\u0275directiveInject(Ut.x),e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(fn),e.\u0275\u0275directiveInject(Cn,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-value-input"]],viewQuery:function(t,r){if(1&t&&(e.\u0275\u0275viewQuery(vd,5),e.\u0275\u0275viewQuery(Cd,5),e.\u0275\u0275viewQuery(_d,5),e.\u0275\u0275viewQuery(yd,5),e.\u0275\u0275viewQuery(bd,5,e.TemplateRef),e.\u0275\u0275viewQuery(wd,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.valueInput=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.valueSelect=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.targetInput=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.targetSelect=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.valueFormattingTmpl=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.valueFormatting=a.first)}},hostBindings:function(t,r){1&t&&e.\u0275\u0275listener("click",function(s){return r.onMouseClick(s)},!1,e.\u0275\u0275resolveDocument)},inputs:{displayedGoal:"displayedGoal",currentValue:"currentValue",capabilities:"capabilities",currentTarget:"currentTarget",targets:"targets",values:"values",goalStatuses:"goalStatuses"},outputs:{currentTargetChange:"currentTargetChange",currentValueChange:"currentValueChange",targetsChange:"targetsChange",valuesChange:"valuesChange",valueRollupsChange:"valueRollupsChange",targetRollupsChange:"targetRollupsChange",onCategoryListIdChanged:"onCategoryListIdChanged",onSave:"onSave",onConnectionChanged:"onConnectionChanged"},decls:24,vars:17,consts:[[1,"input-box-sm","right-padding","current"],[1,"value-input-title"],["localize","CurrentValue",1,"input-title"],["class","input-action-txt",4,"ngIf"],[1,"input"],["class","input-box right-margin",4,"ngIf","ngIfElse"],["selectCategoricalValue",""],[4,"ngIf"],[1,"input-box-sm","target"],[1,"target-input-title"],[1,"input-title"],["selectCategoricalTarget",""],["valueFormattingTmpl",""],[1,"input-action-txt"],[1,"link",3,"click"],[1,"input-box","right-margin"],["data-testid","current-value-input-box","step","any",3,"readonly","type","ngModel","focus","keyup.enter","ngModelChange"],["valueInput",""],["data-testid","select-categorical-value",1,"select-categorical-value",3,"disabled","ngModel","ngModelChange"],["valueSelect",""],["value","","selected","!valueSelected","hidden","!!valueSelected}}"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[3,"canCustomizeStatus","goal","currentGoalValueTypeSelection","goalValueType","goalCapabilities","showGoalRollupsCoachmark","onCurrentSelection"],["localize","Logical_Or_Operator",4,"ngIf"],[1,"link",3,"localize","click"],["localize","Logical_Or_Operator"],["data-testid","target-value-input-box","step","any",3,"readonly","type","ngModel","pbiTooltipDisabled","pbiTooltipPosition","focus","keyup.enter","ngModelChange"],["targetInput",""],[1,"select-categorical-target",3,"disabled","ngModel","ngModelChange"],["targetSelect",""],["value","","selected","!targetSelected","hidden","!!targetSelected"],[3,"canCustomizeStatus","goal","hasMultipleTargets","currentGoalValueTypeSelection","goalValueType","goalCapabilities","onCurrentSelection"],["data-testid","value-formatting-box",1,"value-formatting-box"],["valueFormatting",""],[1,"result"],[1,"goals-value-formatting",3,"formatString","dataType","supportCategoricalValues","goalValueCategoryLists","selectedCategoryListIndex","launchCategoryListsEditPane","formatStringChange","onSelectedCategoryListChange"]],template:function(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275element(2,"div",2),e.\u0275\u0275template(3,Sd,4,3,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275template(5,Md,5,9,"div",5),e.\u0275\u0275template(6,Od,4,3,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(8,xd,2,6,"div",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,Ed,5,2,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",8)(11,"div",9)(12,"div",10),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(15,Id,4,3,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",4),e.\u0275\u0275template(17,Dd,5,11,"div",5),e.\u0275\u0275template(18,Fd,4,3,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(20,Vd,2,6,"div",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,Rd,5,2,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(22,Ld,5,7,"ng-template",null,12,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(7),s=e.\u0275\u0275reference(19);e.\u0275\u0275classProp("inner-input-box-with-rollups",r.capabilities.supportsRollup),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.capabilities.supportMultipleValuesEditing&&r.capabilities.editMultipleValues&&!r.capabilities.supportsRollup),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.isCategoricalFormat)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.capabilities.connectCurrentValueToData&&!r.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("inner-input-box-with-rollups",r.capabilities.supportsRollup),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(14,15,r.capabilities.supportMultipleTargetsEditing?null!=r.displayedGoal.metadata&&r.displayedGoal.metadata.showFinalTarget?"Target_Final":"Target_Next":"Target")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.capabilities.supportMultipleTargetsEditing&&r.capabilities.editMultipleTargets&&!r.capabilities.supportsRollup),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!r.isCategoricalFormat)("ngIfElse",s),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.capabilities.connectTargetValueToData&&!r.capabilities.supportsRollup)}},dependencies:[j.NgForOf,j.NgIf,Ve.YN,Ve.Kr,Ve.Fj,Ve.EJ,Ve.JJ,Ve.On,rn.X,bn.d,Ic,Mt.F],styles:["[_nghost-%COMP%]{display:inline-flex}.inner-input-box-with-rollups[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center}.right-padding[_ngcontent-%COMP%]{padding-right:8px}.right-margin[_ngcontent-%COMP%]{margin-right:4px}.select-categorical-value[_ngcontent-%COMP%], .select-categorical-target[_ngcontent-%COMP%]{width:100%;height:32px}.value-input-title[_ngcontent-%COMP%], .target-input-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.edit-targets-title[_ngcontent-%COMP%]{padding-top:9px;padding-bottom:4px}.pbi-text-field-error-message[_ngcontent-%COMP%]{fill:var(--fluent-theme-error-dark-color, #A80000);color:var(--fluent-theme-error-dark-color, #A80000)}  #goal-edit-value-formatting{background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}  #goal-edit-value-formatting .value-formatting-box .result{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--gray-180, #252423);line-height:20px;height:20px;padding:12px 12px 8px;border-bottom:1px solid var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}  #goal-edit-value-formatting .value-formatting-box mat-select{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}  #goal-edit-value-formatting .value-formatting-box mat-select .mat-select-value{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}  #goal-edit-value-formatting .value-formatting-box mat-select .mat-select-arrow{color:var(--gray-140, #484644);padding-right:14px}  #goal-edit-value-formatting .value-formatting-box num-up-down .inputRange{height:28px;border:1px solid var(--gray-110, #8A8886);border-radius:2px}  #goal-edit-value-formatting .value-formatting-box num-up-down .inputRange .inputUpDown{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);line-height:20px}  #goal-edit-value-formatting .value-formatting-box num-up-down label{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);line-height:20px}  #goal-edit-value-formatting .value-formatting-box .valueFormatterToggleButtonsGroup .btn{background-color:transparent;border:none}  #goal-edit-value-formatting .value-formatting-box .valueFormatterToggleButtonsGroup .btn:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}",".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:100px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background-color:var(--scorecard-tableEditRowBackgroundColor);color:var(--scorecard-tableEditRowForegroundColor);border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell.cell-right-edge[_ngcontent-%COMP%]{border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:none;max-width:none;min-width:392px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .inner-input-box-with-rollups[_ngcontent-%COMP%]{max-width:none}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]{width:104px;max-width:104px;min-width:auto}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:4px 6px}[_nghost-%COMP%]:hover   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td.bulk-editing-off[_ngcontent-%COMP%]{width:0px;max-width:0px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden;margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-semi-bold, 600);padding-top:9px;padding-bottom:4px}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{vertical-align:middle;padding:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{display:flex;flex:1;padding-left:20px;padding-right:20px;width:1000px;min-width:1000px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);height:32px;padding:6px 8px;box-sizing:border-box;color:var(--scorecard-tableInputForegroundColor);background:var(--scorecard-tableInputBackgroundColor);border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{border:2px solid var(--fluent-theme-error-dark-alt-color, #D83B01);outline-color:var(--fluent-theme-error-dark-alt-color, #D83B01)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-ms-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableInputForegroundColor)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{padding:0;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-outer-spin-button, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}[_nghost-%COMP%]   .right-padding[_ngcontent-%COMP%]{padding-right:8px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableEditRowForegroundColor);padding-top:4px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--scorecard-tableRowLinkColor);cursor:pointer;text-decoration:none;background-color:transparent;border:none;padding:0}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{color:var(--fluent-theme-link-darker-color, #005A9E)}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link.inactive[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertia-color, #A19F9D);pointer-events:none}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:1px;height:100%;background-color:var(--gray-80, #B3B0AD);margin:0 12px}[_nghost-%COMP%]   .width-override[_ngcontent-%COMP%]{width:24px}[_nghost-%COMP%]     .mat-form-field{background:var(--scorecard-tableInputBackgroundColor)!important}[_nghost-%COMP%]     emails-list-modern.disabled .mat-form-field{filter:brightness(95%)}[_nghost-%COMP%]   .goal-owners-input[_ngcontent-%COMP%]{padding-bottom:9px}[_nghost-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:1 0 260px;max-width:400px}[_nghost-%COMP%]   .input-box-xs[_ngcontent-%COMP%]{flex:1 1 100px;max-width:140px;min-width:110px}[_nghost-%COMP%]   .input-box-sm[_ngcontent-%COMP%]{flex:1 1 100px;max-width:200px;min-width:140px}[_nghost-%COMP%]   .input-box-md[_ngcontent-%COMP%]{flex:1 1 200px;max-width:300px;min-width:130px}[_nghost-%COMP%]   .input-box-lg[_ngcontent-%COMP%]{flex:1 1 250px;min-width:150px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),i}(),Dc="PBI.EmailsList.PasteInfo",Gd=Ce.cx[Dc]=(0,Ce.b1)(Dc),mn=M(93247),_a=M(90341),kc=M(76920),yi=M(37419),tn=M(48138),Hn=M(4437),rc=M(10519),Hi=M(63057),To=M(51193),Fc=M(94130),Nd=M(77445),Vc=M(60733),Ac=new e.InjectionToken("MatChipRemove"),Rc=new e.InjectionToken("MatChipAvatar"),Lc=new e.InjectionToken("MatChipTrailingIcon"),qd=(0,tn.sb)((0,tn.pj)((0,tn.Kr)(function(n){this._elementRef=n}),"primary"),-1);(ya=function(){}).\u0275fac=function(n){return new(n||ya)},ya.\u0275dir=e.\u0275\u0275defineDirective({type:ya,selectors:[["mat-chip-avatar"],["","matChipAvatar",""]],hostAttrs:[1,"mat-chip-avatar"],features:[e.\u0275\u0275ProvidersFeature([{provide:Rc,useExisting:ya}])]});(ba=function(){}).\u0275fac=function(n){return new(n||ba)},ba.\u0275dir=e.\u0275\u0275defineDirective({type:ba,selectors:[["mat-chip-trailing-icon"],["","matChipTrailingIcon",""]],hostAttrs:[1,"mat-chip-trailing-icon"],features:[e.\u0275\u0275ProvidersFeature([{provide:Lc,useExisting:ba}])]});var Ms=function(i){function n(r,a,s,c,u,p,v,P){var x;return(x=i.call(this,r)||this)._ngZone=a,x._changeDetectorRef=u,x._hasFocus=!1,x.chipListSelectable=!0,x._chipListMultiple=!1,x._chipListDisabled=!1,x.role="option",x._selected=!1,x._selectable=!0,x._disabled=!1,x._removable=!0,x._onFocus=new Re.xQ,x._onBlur=new Re.xQ,x.selectionChange=new e.EventEmitter,x.destroyed=new e.EventEmitter,x.removed=new e.EventEmitter,x._addHostClassName(),x._chipRippleTarget=p.createElement("div"),x._chipRippleTarget.classList.add("mat-chip-ripple"),x._elementRef.nativeElement.appendChild(x._chipRippleTarget),x._chipRipple=new tn.IR((0,kc.Z)(x),a,x._chipRippleTarget,s),x._chipRipple.setupTriggerEvents(r),x.rippleConfig=c||{},x._animationsDisabled="NoopAnimations"===v,x.tabIndex=null!=P&&parseInt(P)||-1,x}(0,yi.Z)(n,i);var t=n.prototype;return t._addHostClassName=function(){var a="mat-basic-chip",s=this._elementRef.nativeElement;s.hasAttribute(a)||s.tagName.toLowerCase()===a?s.classList.add(a):s.classList.add("mat-standard-chip")},t.ngOnDestroy=function(){this.destroyed.emit({chip:this}),this._chipRipple._removeTriggerEvents()},t.select=function(){this._selected||(this._selected=!0,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())},t.deselect=function(){this._selected&&(this._selected=!1,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())},t.selectViaInteraction=function(){this._selected||(this._selected=!0,this._dispatchSelectionChange(!0),this._changeDetectorRef.markForCheck())},t.toggleSelected=function(a){return void 0===a&&(a=!1),this._selected=!this.selected,this._dispatchSelectionChange(a),this._changeDetectorRef.markForCheck(),this.selected},t.focus=function(){this._hasFocus||(this._elementRef.nativeElement.focus(),this._onFocus.next({chip:this})),this._hasFocus=!0},t.remove=function(){this.removable&&this.removed.emit({chip:this})},t._handleClick=function(a){this.disabled&&a.preventDefault()},t._handleKeydown=function(a){if(!this.disabled)switch(a.keyCode){case mn.yY:case mn.ZH:this.remove(),a.preventDefault();break;case mn.L_:this.selectable&&this.toggleSelected(!0),a.preventDefault()}},t._blur=function(){var a=this;this._ngZone.onStable.pipe((0,he.q)(1)).subscribe(function(){a._ngZone.run(function(){a._hasFocus=!1,a._onBlur.next({chip:a})})})},t._dispatchSelectionChange=function(a){void 0===a&&(a=!1),this.selectionChange.emit({source:this,isUserInput:a,selected:this._selected})},(0,_a.Z)(n,[{key:"rippleDisabled",get:function(){return this.disabled||this.disableRipple||this._animationsDisabled||!!this.rippleConfig.disabled}},{key:"selected",get:function(){return this._selected},set:function(a){var s=(0,Hn.Ig)(a);s!==this._selected&&(this._selected=s,this._dispatchSelectionChange())}},{key:"value",get:function(){return void 0!==this._value?this._value:this._elementRef.nativeElement.textContent},set:function(a){this._value=a}},{key:"selectable",get:function(){return this._selectable&&this.chipListSelectable},set:function(a){this._selectable=(0,Hn.Ig)(a)}},{key:"disabled",get:function(){return this._chipListDisabled||this._disabled},set:function(a){this._disabled=(0,Hn.Ig)(a)}},{key:"removable",get:function(){return this._removable},set:function(a){this._removable=(0,Hn.Ig)(a)}},{key:"ariaSelected",get:function(){return this.selectable&&(this._chipListMultiple||this.selected)?this.selected.toString():null}}]),n}(qd);(ws=Ms).\u0275fac=function(n){return new(n||ws)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(e.NgZone),e.\u0275\u0275directiveInject(rc.t4),e.\u0275\u0275directiveInject(tn.Y2,8),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(j.DOCUMENT),e.\u0275\u0275directiveInject(e.ANIMATION_MODULE_TYPE,8),e.\u0275\u0275injectAttribute("tabindex"))},ws.\u0275dir=e.\u0275\u0275defineDirective({type:ws,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(n,t,r){var a;1&n&&(e.\u0275\u0275contentQuery(r,Rc,5),e.\u0275\u0275contentQuery(r,Lc,5),e.\u0275\u0275contentQuery(r,Ac,5)),2&n&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.avatar=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.trailingIcon=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.removeIcon=a.first))},hostAttrs:[1,"mat-chip","mat-focus-indicator"],hostVars:15,hostBindings:function(n,t){1&n&&e.\u0275\u0275listener("click",function(a){return t._handleClick(a)})("keydown",function(a){return t._handleKeydown(a)})("focus",function(){return t.focus()})("blur",function(){return t._blur()}),2&n&&(e.\u0275\u0275attribute("tabindex",t.disabled?null:t.tabIndex)("role",t.role)("disabled",t.disabled||null)("aria-disabled",t.disabled.toString())("aria-selected",t.ariaSelected),e.\u0275\u0275classProp("mat-chip-selected",t.selected)("mat-chip-with-avatar",t.avatar)("mat-chip-with-trailing-icon",t.trailingIcon||t.removeIcon)("mat-chip-disabled",t.disabled)("_mat-animation-noopable",t._animationsDisabled))},inputs:{color:"color",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",selected:"selected",value:"value",selectable:"selectable",disabled:"disabled",removable:"removable"},outputs:{selectionChange:"selectionChange",destroyed:"destroyed",removed:"removed"},exportAs:["matChip"],features:[e.\u0275\u0275InheritDefinitionFeature]});var ic=function(){function i(t,r){this._parentChip=t,"BUTTON"===r.nativeElement.nodeName&&r.nativeElement.setAttribute("type","button")}return i.prototype._handleClick=function(r){var a=this._parentChip;a.removable&&!a.disabled&&a.remove(),r.stopPropagation(),r.preventDefault()},i}();(wa=ic).\u0275fac=function(n){return new(n||wa)(e.\u0275\u0275directiveInject(Ms),e.\u0275\u0275directiveInject(e.ElementRef))},wa.\u0275dir=e.\u0275\u0275defineDirective({type:wa,selectors:[["","matChipRemove",""]],hostAttrs:[1,"mat-chip-remove","mat-chip-trailing-icon"],hostBindings:function(n,t){1&n&&e.\u0275\u0275listener("click",function(a){return t._handleClick(a)})},features:[e.\u0275\u0275ProvidersFeature([{provide:Ac,useExisting:wa}])]});var Hc=new e.InjectionToken("mat-chips-default-options"),Bd=(0,tn.FD)(function(){return function(n,t,r,a){this._defaultErrorStateMatcher=n,this._parentForm=t,this._parentFormGroup=r,this.ngControl=a,this.stateChanges=new Re.xQ}}()),Ud=0,jd=function(n,t){this.source=n,this.value=t},oc=function(i){function n(r,a,s,c,u,p,v){var P;return(P=i.call(this,p,c,u,v)||this)._elementRef=r,P._changeDetectorRef=a,P._dir=s,P.controlType="mat-chip-list",P._lastDestroyedChipIndex=null,P._destroyed=new Re.xQ,P._uid="mat-chip-list-"+Ud++,P._tabIndex=0,P._userTabIndex=null,P._onTouched=function(){},P._onChange=function(){},P._multiple=!1,P._compareWith=function(x,G){return x===G},P._disabled=!1,P.ariaOrientation="horizontal",P._selectable=!0,P.change=new e.EventEmitter,P.valueChange=new e.EventEmitter,P.ngControl&&(P.ngControl.valueAccessor=(0,kc.Z)(P)),P}(0,yi.Z)(n,i);var t=n.prototype;return t.ngAfterContentInit=function(){var a=this;this._keyManager=new To.Em(this.chips).withWrap().withVerticalOrientation().withHomeAndEnd().withHorizontalOrientation(this._dir?this._dir.value:"ltr"),this._dir&&this._dir.change.pipe((0,ie.R)(this._destroyed)).subscribe(function(s){return a._keyManager.withHorizontalOrientation(s)}),this._keyManager.tabOut.subscribe(function(){return a._allowFocusEscape()}),this.chips.changes.pipe((0,$e.O)(null),(0,ie.R)(this._destroyed)).subscribe(function(){(a.disabled||!a.selectable)&&Promise.resolve().then(function(){a._syncChipsState()}),a._resetChips(),a._initializeSelection(),a._updateTabIndex(),a._updateFocusForDestroyedChips(),a.stateChanges.next()})},t.ngOnInit=function(){this._selectionModel=new Nd.Ov(this.multiple,void 0,!1),this.stateChanges.next()},t.ngDoCheck=function(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==this._disabled&&(this.disabled=!!this.ngControl.disabled))},t.ngOnDestroy=function(){var a;null==(a=this._keyManager)||a.destroy(),this._destroyed.next(),this._destroyed.complete(),this.stateChanges.complete(),this._dropSubscriptions()},t.registerInput=function(a){this._chipInput=a,this._elementRef.nativeElement.setAttribute("data-mat-chip-input",a.id)},t.setDescribedByIds=function(a){a.length?this._elementRef.nativeElement.setAttribute("aria-describedby",a.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")},t.writeValue=function(a){this.chips&&this._setSelectionByValue(a,!1)},t.registerOnChange=function(a){this._onChange=a},t.registerOnTouched=function(a){this._onTouched=a},t.setDisabledState=function(a){this.disabled=a,this.stateChanges.next()},t.onContainerClick=function(a){this._originatesFromChip(a)||this.focus()},t.focus=function(a){this.disabled||this._chipInput&&this._chipInput.focused||(this.chips.length>0?(this._keyManager.setFirstItemActive(),this.stateChanges.next()):(this._focusInput(a),this.stateChanges.next()))},t._focusInput=function(a){this._chipInput&&this._chipInput.focus(a)},t._keydown=function(a){var s=a.target;s&&s.classList.contains("mat-chip")&&(this._keyManager.onKeydown(a),this.stateChanges.next())},t._updateTabIndex=function(){this._tabIndex=this._userTabIndex||(0===this.chips.length?-1:0)},t._updateFocusForDestroyedChips=function(){if(null!=this._lastDestroyedChipIndex)if(this.chips.length){var a=Math.min(this._lastDestroyedChipIndex,this.chips.length-1);this._keyManager.setActiveItem(a)}else this.focus();this._lastDestroyedChipIndex=null},t._isValidIndex=function(a){return a>=0&&a<this.chips.length},t._setSelectionByValue=function(a,s){var c=this;if(void 0===s&&(s=!0),this._clearSelection(),this.chips.forEach(function(p){return p.deselect()}),Array.isArray(a))a.forEach(function(p){return c._selectValue(p,s)}),this._sortValues();else{var u=this._selectValue(a,s);u&&s&&this._keyManager.setActiveItem(u)}},t._selectValue=function(a,s){var c=this;void 0===s&&(s=!0);var u=this.chips.find(function(p){return null!=p.value&&c._compareWith(p.value,a)});return u&&(s?u.selectViaInteraction():u.select(),this._selectionModel.select(u)),u},t._initializeSelection=function(){var a=this;Promise.resolve().then(function(){(a.ngControl||a._value)&&(a._setSelectionByValue(a.ngControl?a.ngControl.value:a._value,!1),a.stateChanges.next())})},t._clearSelection=function(a){this._selectionModel.clear(),this.chips.forEach(function(s){s!==a&&s.deselect()}),this.stateChanges.next()},t._sortValues=function(){var a=this;this._multiple&&(this._selectionModel.clear(),this.chips.forEach(function(s){s.selected&&a._selectionModel.select(s)}),this.stateChanges.next())},t._propagateChanges=function(a){var s;s=Array.isArray(this.selected)?this.selected.map(function(c){return c.value}):this.selected?this.selected.value:a,this._value=s,this.change.emit(new jd(this,s)),this.valueChange.emit(s),this._onChange(s),this._changeDetectorRef.markForCheck()},t._blur=function(){var a=this;this._hasFocusedChip()||this._keyManager.setActiveItem(-1),this.disabled||(this._chipInput?setTimeout(function(){a.focused||a._markAsTouched()}):this._markAsTouched())},t._markAsTouched=function(){this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next()},t._allowFocusEscape=function(){var a=this;-1!==this._tabIndex&&(this._tabIndex=-1,setTimeout(function(){a._tabIndex=a._userTabIndex||0,a._changeDetectorRef.markForCheck()}))},t._resetChips=function(){this._dropSubscriptions(),this._listenToChipsFocus(),this._listenToChipsSelection(),this._listenToChipsRemoved()},t._dropSubscriptions=function(){this._chipFocusSubscription&&(this._chipFocusSubscription.unsubscribe(),this._chipFocusSubscription=null),this._chipBlurSubscription&&(this._chipBlurSubscription.unsubscribe(),this._chipBlurSubscription=null),this._chipSelectionSubscription&&(this._chipSelectionSubscription.unsubscribe(),this._chipSelectionSubscription=null),this._chipRemoveSubscription&&(this._chipRemoveSubscription.unsubscribe(),this._chipRemoveSubscription=null)},t._listenToChipsSelection=function(){var a=this;this._chipSelectionSubscription=this.chipSelectionChanges.subscribe(function(s){s.source.selected?a._selectionModel.select(s.source):a._selectionModel.deselect(s.source),a.multiple||a.chips.forEach(function(c){!a._selectionModel.isSelected(c)&&c.selected&&c.deselect()}),s.isUserInput&&a._propagateChanges()})},t._listenToChipsFocus=function(){var a=this;this._chipFocusSubscription=this.chipFocusChanges.subscribe(function(s){var c=a.chips.toArray().indexOf(s.chip);a._isValidIndex(c)&&a._keyManager.updateActiveItem(c),a.stateChanges.next()}),this._chipBlurSubscription=this.chipBlurChanges.subscribe(function(){a._blur(),a.stateChanges.next()})},t._listenToChipsRemoved=function(){var a=this;this._chipRemoveSubscription=this.chipRemoveChanges.subscribe(function(s){var c=s.chip,u=a.chips.toArray().indexOf(s.chip);a._isValidIndex(u)&&c._hasFocus&&(a._lastDestroyedChipIndex=u)})},t._originatesFromChip=function(a){for(var s=a.target;s&&s!==this._elementRef.nativeElement;){if(s.classList.contains("mat-chip"))return!0;s=s.parentElement}return!1},t._hasFocusedChip=function(){return this.chips&&this.chips.some(function(a){return a._hasFocus})},t._syncChipsState=function(){var a=this;this.chips&&this.chips.forEach(function(s){s._chipListDisabled=a._disabled,s._chipListMultiple=a.multiple,s.chipListSelectable=a._selectable})},(0,_a.Z)(n,[{key:"selected",get:function(){var a,s;return this.multiple?(null==(a=this._selectionModel)?void 0:a.selected)||[]:null==(s=this._selectionModel)?void 0:s.selected[0]}},{key:"role",get:function(){return this._explicitRole?this._explicitRole:this.empty?null:"listbox"},set:function(a){this._explicitRole=a}},{key:"multiple",get:function(){return this._multiple},set:function(a){this._multiple=(0,Hn.Ig)(a),this._syncChipsState()}},{key:"compareWith",get:function(){return this._compareWith},set:function(a){this._compareWith=a,this._selectionModel&&this._initializeSelection()}},{key:"value",get:function(){return this._value},set:function(a){this.writeValue(a),this._value=a}},{key:"id",get:function(){return this._chipInput?this._chipInput.id:this._uid}},{key:"required",get:function(){var a,s,c;return null!=(a=null!=(s=this._required)?s:null==(c=this.ngControl)||null==(c=c.control)?void 0:c.hasValidator(Ve.kI.required))&&a},set:function(a){this._required=(0,Hn.Ig)(a),this.stateChanges.next()}},{key:"placeholder",get:function(){return this._chipInput?this._chipInput.placeholder:this._placeholder},set:function(a){this._placeholder=a,this.stateChanges.next()}},{key:"focused",get:function(){return this._chipInput&&this._chipInput.focused||this._hasFocusedChip()}},{key:"empty",get:function(){return(!this._chipInput||this._chipInput.empty)&&(!this.chips||0===this.chips.length)}},{key:"shouldLabelFloat",get:function(){return!this.empty||this.focused}},{key:"disabled",get:function(){return this.ngControl?!!this.ngControl.disabled:this._disabled},set:function(a){this._disabled=(0,Hn.Ig)(a),this._syncChipsState()}},{key:"selectable",get:function(){return this._selectable},set:function(a){this._selectable=(0,Hn.Ig)(a),this._syncChipsState()}},{key:"tabIndex",set:function(a){this._userTabIndex=a,this._tabIndex=a}},{key:"chipSelectionChanges",get:function(){return Hi.T.apply(void 0,this.chips.map(function(a){return a.selectionChange}))}},{key:"chipFocusChanges",get:function(){return Hi.T.apply(void 0,this.chips.map(function(a){return a._onFocus}))}},{key:"chipBlurChanges",get:function(){return Hi.T.apply(void 0,this.chips.map(function(a){return a._onBlur}))}},{key:"chipRemoveChanges",get:function(){return Hi.T.apply(void 0,this.chips.map(function(a){return a.destroyed}))}}]),n}(Bd);(Sa=oc).\u0275fac=function(n){return new(n||Sa)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Fc.Is,8),e.\u0275\u0275directiveInject(Ve.F,8),e.\u0275\u0275directiveInject(Ve.sg,8),e.\u0275\u0275directiveInject(tn.rD),e.\u0275\u0275directiveInject(Ve.a5,10))},Sa.\u0275cmp=e.\u0275\u0275defineComponent({type:Sa,selectors:[["mat-chip-list"]],contentQueries:function(n,t,r){var a;1&n&&e.\u0275\u0275contentQuery(r,Ms,5),2&n&&e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.chips=a)},hostAttrs:["ngSkipHydration","",1,"mat-chip-list"],hostVars:14,hostBindings:function(n,t){1&n&&e.\u0275\u0275listener("focus",function(){return t.focus()})("blur",function(){return t._blur()})("keydown",function(a){return t._keydown(a)}),2&n&&(e.\u0275\u0275hostProperty("id",t._uid),e.\u0275\u0275attribute("tabindex",t.disabled?null:t._tabIndex)("aria-required",t.role?t.required:null)("aria-disabled",t.disabled.toString())("aria-invalid",t.errorState)("aria-multiselectable",t.multiple)("role",t.role)("aria-orientation",t.ariaOrientation),e.\u0275\u0275classProp("mat-chip-list-disabled",t.disabled)("mat-chip-list-invalid",t.errorState)("mat-chip-list-required",t.required))},inputs:{role:"role",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],errorStateMatcher:"errorStateMatcher",multiple:"multiple",compareWith:"compareWith",value:"value",required:"required",placeholder:"placeholder",disabled:"disabled",ariaOrientation:["aria-orientation","ariaOrientation"],selectable:"selectable",tabIndex:"tabIndex"},outputs:{change:"change",valueChange:"valueChange"},exportAs:["matChipList"],features:[e.\u0275\u0275ProvidersFeature([{provide:Vc.Eo,useExisting:Sa}]),e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:2,vars:0,consts:[[1,"mat-chip-list-wrapper"]],template:function(n,t){1&n&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275projection(1),e.\u0275\u0275elementEnd())},styles:['.mat-chip{position:relative;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);border:none;-webkit-appearance:none;-moz-appearance:none}.mat-chip::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}.mat-standard-chip._mat-animation-noopable{transition:none !important;animation:none !important}.mat-standard-chip .mat-chip-remove{border:none;-webkit-appearance:none;-moz-appearance:none;padding:0;background:none}.mat-standard-chip .mat-chip-remove.mat-icon,.mat-standard-chip .mat-chip-remove .mat-icon{width:18px;height:18px;font-size:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:"";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip.mat-chip-selected{outline-width:3px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit;overflow:hidden;transform:translateZ(0)}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}'],encapsulation:2,changeDetection:0});var Wd=0,Bl=function(){function i(t,r){this._elementRef=t,this.focused=!1,this._addOnBlur=!1,this.chipEnd=new e.EventEmitter,this.placeholder="",this.id="mat-chip-list-input-"+Wd++,this._disabled=!1,this.inputElement=this._elementRef.nativeElement,this.separatorKeyCodes=r.separatorKeyCodes}var n=i.prototype;return n.ngOnChanges=function(){this._chipList.stateChanges.next()},n.ngOnDestroy=function(){this.chipEnd.complete()},n.ngAfterContentInit=function(){this._focusLastChipOnBackspace=this.empty},n._keydown=function(r){if(r){if(r.keyCode===mn.Mf&&!(0,mn.Vb)(r,"shiftKey")&&this._chipList._allowFocusEscape(),r.keyCode===mn.ZH&&this._focusLastChipOnBackspace)return this._chipList._keyManager.setLastItemActive(),void r.preventDefault();this._focusLastChipOnBackspace=!1}this._emitChipEnd(r)},n._keyup=function(r){!this._focusLastChipOnBackspace&&r.keyCode===mn.ZH&&this.empty&&(this._focusLastChipOnBackspace=!0,r.preventDefault())},n._blur=function(){this.addOnBlur&&this._emitChipEnd(),this.focused=!1,this._chipList.focused||this._chipList._blur(),this._chipList.stateChanges.next()},n._focus=function(){this.focused=!0,this._focusLastChipOnBackspace=this.empty,this._chipList.stateChanges.next()},n._emitChipEnd=function(r){!this.inputElement.value&&r&&this._chipList._keydown(r),(!r||this._isSeparatorKey(r))&&(this.chipEnd.emit({input:this.inputElement,value:this.inputElement.value,chipInput:this}),r?.preventDefault())},n._onInput=function(){this._chipList.stateChanges.next()},n.focus=function(r){this.inputElement.focus(r)},n.clear=function(){this.inputElement.value="",this._focusLastChipOnBackspace=!0},n._isSeparatorKey=function(r){return!(0,mn.Vb)(r)&&new Set(this.separatorKeyCodes).has(r.keyCode)},(0,_a.Z)(i,[{key:"chipList",set:function(r){r&&(this._chipList=r,this._chipList.registerInput(this))}},{key:"addOnBlur",get:function(){return this._addOnBlur},set:function(r){this._addOnBlur=(0,Hn.Ig)(r)}},{key:"disabled",get:function(){return this._disabled||this._chipList&&this._chipList.disabled},set:function(r){this._disabled=(0,Hn.Ig)(r)}},{key:"empty",get:function(){return!this.inputElement.value}}]),i}();(Ss=Bl).\u0275fac=function(n){return new(n||Ss)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(Hc))},Ss.\u0275dir=e.\u0275\u0275defineDirective({type:Ss,selectors:[["input","matChipInputFor",""]],hostAttrs:[1,"mat-chip-input","mat-input-element"],hostVars:5,hostBindings:function(n,t){1&n&&e.\u0275\u0275listener("keydown",function(a){return t._keydown(a)})("keyup",function(a){return t._keyup(a)})("blur",function(){return t._blur()})("focus",function(){return t._focus()})("input",function(){return t._onInput()}),2&n&&(e.\u0275\u0275hostProperty("id",t.id),e.\u0275\u0275attribute("disabled",t.disabled||null)("placeholder",t.placeholder||null)("aria-invalid",t._chipList&&t._chipList.ngControl?t._chipList.ngControl.invalid:null)("aria-required",t._chipList&&t._chipList.required||null))},inputs:{chipList:["matChipInputFor","chipList"],addOnBlur:["matChipInputAddOnBlur","addOnBlur"],separatorKeyCodes:["matChipInputSeparatorKeyCodes","separatorKeyCodes"],placeholder:"placeholder",id:"id",disabled:"disabled"},outputs:{chipEnd:"matChipInputTokenEnd"},exportAs:["matChipInput","matChipInputFor"],features:[e.\u0275\u0275NgOnChangesFeature]});var zc=function(){};(Ma=zc).\u0275fac=function(n){return new(n||Ma)},Ma.\u0275mod=e.\u0275\u0275defineNgModule({type:Ma}),Ma.\u0275inj=e.\u0275\u0275defineInjector({providers:[tn.rD,{provide:Hc,useValue:{separatorKeyCodes:[mn.K5]}}],imports:[tn.BQ]});var Ps,Eo,Os,Oa,xs,xa,Ta,$d=M(73058),Qd=M(40133),Xd=M(58417),ac=M(82762),Yd=M(37272),Jd=M(69903),Kd=M(6663),ep=M(59822),qc=M(15910),tp=M(59055),np=M(629),rp=function(){function i(n,t,r){this.promiseFactory=n,this.telemetryService=t,this.httpService=r}return i.prototype.emailIsInVerifiedDomain=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(s){switch(s.label){case 0:t=this.promiseFactory.defer(),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.getVerifiedDomains()];case 2:return r=s.sent(),t.resolve(this.verifyEmailInGivenVerifiedDomains(n,r)),[3,4];case 3:return s.sent(),t.reject(),[3,4];case 4:return[2,t.promise]}})})},i.prototype.getVerifiedDomains=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,r,a,s,c;return(0,w.__generator)(this,function(p){switch(p.label){case 0:return this.verifiedDomainsPromise?[2,this.verifiedDomainsPromise]:[3,1];case 1:n=this.promiseFactory.defer(),t=this.telemetryService.startEvent(tp.f8),r=this.httpService.powerbiRequestOptions(t.event,"TenantVerifiedDomains"),p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.httpService.get("powerbi/invitation/verifiedDomains",r)];case 3:return a=p.sent(),s={verifiedDomains:{},blockedDomains:{}},(c=a.data).verifiedDomains&&c.verifiedDomains.map(function(v){var P=v.toUpperCase();return s.verifiedDomains[P]=P,P}),c.blockedDomains&&c.blockedDomains.map(function(v){var P=v.toUpperCase();return s.blockedDomains[P]=P,P}),n.resolve(s),t.resolve(),[3,5];case 4:return p.sent(),n.reject(),[3,5];case 5:return this.verifiedDomainsPromise=n.promise,[2,this.verifiedDomainsPromise]}})})},i.prototype.verifyEmailInGivenVerifiedDomains=function(n,t){var r=n.split("@");return!(!t||!_.isEmpty(t.verifiedDomains))||r.length>1&&t&&!!t.verifiedDomains[r[1].toUpperCase()]},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Uo.t),e.\u0275\u0275inject(Ca.y0),e.\u0275\u0275inject(np.M))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(),ip=M(62661),Pa=M(59051),_r=M(26124),Bc=M(34763),op=M(48636),sc=M(59787),ap=M(22760),sp=["panel"];function lp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275listener("@panelAnimation.done",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u._animationDone.next(c))}),e.\u0275\u0275projection(2),e.\u0275\u0275elementEnd()}if(2&i){var r=n.id,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("id",a.id)("ngClass",a._classList)("@panelAnimation",a.isOpen?"visible":"hidden"),e.\u0275\u0275attribute("aria-label",a.ariaLabel||null)("aria-labelledby",a._getPanelAriaLabelledby(r))}}var up=(0,_r.X$)("panelAnimation",[(0,_r.SB)("void, hidden",(0,_r.oB)({opacity:0,transform:"scaleY(0.8)"})),(0,_r.eR)(":enter, hidden => visible",[(0,_r.ru)([(0,_r.jt)("0.03s linear",(0,_r.oB)({opacity:1})),(0,_r.jt)("0.12s cubic-bezier(0, 0, 0.2, 1)",(0,_r.oB)({transform:"scaleY(1)"}))])]),(0,_r.eR)(":leave, visible => hidden",[(0,_r.jt)("0.075s linear",(0,_r.oB)({opacity:0}))])]),dp=0,pp=function(n,t){this.source=n,this.option=t},hp=(0,tn.Kr)(function(){return function(){}}()),Uc=new e.InjectionToken("mat-autocomplete-default-options",{providedIn:"root",factory:function(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}}),lc=function(i){(0,yi.Z)(t,i);var n=t.prototype;function t(r,a,s,c){var u;return(u=i.call(this)||this)._changeDetectorRef=r,u._elementRef=a,u._defaults=s,u._activeOptionChanges=Bc.w.EMPTY,u.showPanel=!1,u._isOpen=!1,u.displayWith=null,u.optionSelected=new e.EventEmitter,u.opened=new e.EventEmitter,u.closed=new e.EventEmitter,u.optionActivated=new e.EventEmitter,u._classList={},u.id="mat-autocomplete-"+dp++,u.inertGroups=c?.SAFARI||!1,u._autoActiveFirstOption=!!s.autoActiveFirstOption,u._autoSelectActiveOption=!!s.autoSelectActiveOption,u._requireSelection=!!s.requireSelection,u}return n._setColor=function(a){this._color=a,this._setThemeClasses(this._classList)},n.ngAfterContentInit=function(){var a=this;this._keyManager=new To.s1(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(function(s){a.isOpen&&a.optionActivated.emit({source:a,option:a.options.toArray()[s]||null})}),this._setVisibility()},n.ngOnDestroy=function(){var a;null==(a=this._keyManager)||a.destroy(),this._activeOptionChanges.unsubscribe()},n._setScrollTop=function(a){this.panel&&(this.panel.nativeElement.scrollTop=a)},n._getScrollTop=function(){return this.panel?this.panel.nativeElement.scrollTop:0},n._setVisibility=function(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()},n._emitSelectEvent=function(a){var s=new pp(this,a);this.optionSelected.emit(s)},n._getPanelAriaLabelledby=function(a){return this.ariaLabel?null:this.ariaLabelledby?(a?a+" ":"")+this.ariaLabelledby:a},n._setVisibilityClasses=function(a){a[this._visibleClass]=this.showPanel,a[this._hiddenClass]=!this.showPanel},n._setThemeClasses=function(a){a["mat-primary"]="primary"===this._color,a["mat-warn"]="warn"===this._color,a["mat-accent"]="accent"===this._color},n._skipPredicate=function(a){return a.disabled},(0,_a.Z)(t,[{key:"isOpen",get:function(){return this._isOpen&&this.showPanel}},{key:"autoActiveFirstOption",get:function(){return this._autoActiveFirstOption},set:function(a){this._autoActiveFirstOption=(0,Hn.Ig)(a)}},{key:"autoSelectActiveOption",get:function(){return this._autoSelectActiveOption},set:function(a){this._autoSelectActiveOption=(0,Hn.Ig)(a)}},{key:"requireSelection",get:function(){return this._requireSelection},set:function(a){this._requireSelection=(0,Hn.Ig)(a)}},{key:"classList",set:function(a){this._classList=a&&a.length?(0,Hn.du)(a).reduce(function(s,c){return s[c]=!0,s},{}):{},this._setVisibilityClasses(this._classList),this._setThemeClasses(this._classList),this._elementRef.nativeElement.className=""}}]),t}(hp);(Ps=lc).\u0275fac=function(n){return new(n||Ps)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(Uc),e.\u0275\u0275directiveInject(rc.t4))},Ps.\u0275dir=e.\u0275\u0275defineDirective({type:Ps,viewQuery:function(n,t){var r;1&n&&(e.\u0275\u0275viewQuery(e.TemplateRef,7),e.\u0275\u0275viewQuery(sp,5)),2&n&&(e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(t.template=r.first),e.\u0275\u0275queryRefresh(r=e.\u0275\u0275loadQuery())&&(t.panel=r.first))},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",autoSelectActiveOption:"autoSelectActiveOption",requireSelection:"requireSelection",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[e.\u0275\u0275InheritDefinitionFeature]});var fp=function(i){function n(){var r,a;return(a=i.apply(this,arguments)||this)._visibleClass="mat-mdc-autocomplete-visible",a._hiddenClass="mat-mdc-autocomplete-hidden",a._animationDone=new e.EventEmitter,a._hideSingleSelectionIndicator=null!=(r=a._defaults.hideSingleSelectionIndicator)&&r,a}(0,yi.Z)(n,i);var t=n.prototype;return t._syncParentProperties=function(){if(this.options)for(var s,a=(0,ip.Z)(this.options);!(s=a()).done;)s.value._changeDetectorRef.markForCheck()},t.ngOnDestroy=function(){i.prototype.ngOnDestroy.call(this),this._animationDone.complete()},t._skipPredicate=function(a){return!1},(0,_a.Z)(n,[{key:"hideSingleSelectionIndicator",get:function(){return this._hideSingleSelectionIndicator},set:function(a){this._hideSingleSelectionIndicator=(0,Hn.Ig)(a),this._syncParentProperties()}}]),n}(lc);(Eo=fp).\u0275fac=function(){var i;return function(t){return(i||(i=e.\u0275\u0275getInheritedFactory(Eo)))(t||Eo)}}(),Eo.\u0275cmp=e.\u0275\u0275defineComponent({type:Eo,selectors:[["mat-autocomplete"]],contentQueries:function(n,t,r){var a;1&n&&(e.\u0275\u0275contentQuery(r,tn.K7,5),e.\u0275\u0275contentQuery(r,tn.ey,5)),2&n&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.optionGroups=a),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.options=a))},hostAttrs:["ngSkipHydration","",1,"mat-mdc-autocomplete"],inputs:{disableRipple:"disableRipple",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matAutocomplete"],features:[e.\u0275\u0275ProvidersFeature([{provide:tn.HF,useExisting:Eo}]),e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:1,vars:0,consts:[["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id","ngClass"],["panel",""]],template:function(n,t){1&n&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275template(0,lp,3,5,"ng-template"))},dependencies:[j.NgClass],styles:["div.mat-mdc-autocomplete-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[up]},changeDetection:0});var cc=function(n){this.elementRef=n};(Os=cc).\u0275fac=function(n){return new(n||Os)(e.\u0275\u0275directiveInject(e.ElementRef))},Os.\u0275dir=e.\u0275\u0275defineDirective({type:Os});var mp=function(i){function n(){return i.apply(this,arguments)||this}return(0,yi.Z)(n,i),n}(cc);(Oa=mp).\u0275fac=function(){var i;return function(t){return(i||(i=e.\u0275\u0275getInheritedFactory(Oa)))(t||Oa)}}(),Oa.\u0275dir=e.\u0275\u0275defineDirective({type:Oa,selectors:[["","matAutocompleteOrigin",""]],exportAs:["matAutocompleteOrigin"],features:[e.\u0275\u0275InheritDefinitionFeature]});var vp={provide:Ve.JU,useExisting:(0,e.forwardRef)(function(){return Wc}),multi:!0},uc=new e.InjectionToken("mat-autocomplete-scroll-strategy"),jc={provide:uc,deps:[Pa.aV],useFactory:function(i){return function(){return i.scrollStrategies.reposition()}}},dc=function(){function i(t,r,a,s,c,u,p,v,P,x,G){var Y=this;this._element=t,this._overlay=r,this._viewContainerRef=a,this._zone=s,this._changeDetectorRef=c,this._dir=p,this._formField=v,this._document=P,this._viewportRuler=x,this._defaults=G,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=Bc.w.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new Re.xQ,this._windowBlurHandler=function(){Y._canOpenOnNextFocus=Y._document.activeElement!==Y._element.nativeElement||Y.panelOpen},this._onChange=function(){},this._onTouched=function(){},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,op.P)(function(){var ue=Y.autocomplete?Y.autocomplete.options:null;return ue?ue.changes.pipe((0,$e.O)(ue),(0,Jt.w)(function(){return Hi.T.apply(void 0,ue.map(function(Se){return Se.onSelectionChange}))})):Y._zone.onStable.pipe((0,he.q)(1),(0,Jt.w)(function(){return Y.optionSelections}))}),this._handlePanelKeydown=function(ue){var Se;(ue.keyCode===mn.hY&&!(0,mn.Vb)(ue)||ue.keyCode===mn.LH&&(0,mn.Vb)(ue,"altKey"))&&(Y._pendingAutoselectedOption&&(Y._updateNativeInputValue(null!=(Se=Y._valueBeforeAutoSelection)?Se:""),Y._pendingAutoselectedOption=null),Y._closeKeyEventStream.next(),Y._resetActiveItem(),ue.stopPropagation(),ue.preventDefault())},this._trackedModal=null,this._scrollStrategy=u}var n=i.prototype;return n.ngAfterViewInit=function(){var r=this,a=this._getWindow();typeof a<"u"&&this._zone.runOutsideAngular(function(){return a.addEventListener("blur",r._windowBlurHandler)})},n.ngOnChanges=function(r){r.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())},n.ngOnDestroy=function(){var r=this._getWindow();typeof r<"u"&&r.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()},n.openPanel=function(){this._attachOverlay(),this._floatLabel(),this._trackedModal&&(0,To.Zf)(this._trackedModal,"aria-owns",this.autocomplete.id)},n.closePanel=function(){var r=this;this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(function(){r.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal)&&(0,To.iD)(this._trackedModal,"aria-owns",this.autocomplete.id)},n.updatePosition=function(){this._overlayAttached&&this._overlayRef.updatePosition()},n._getOutsideClickStream=function(){var r=this;return(0,Hi.T)((0,sc.R)(this._document,"click"),(0,sc.R)(this._document,"auxclick"),(0,sc.R)(this._document,"touchend")).pipe((0,jt.h)(function(a){var s=(0,rc.sA)(a),c=r._formField?r._formField._elementRef.nativeElement:null,u=r.connectedTo?r.connectedTo.elementRef.nativeElement:null;return r._overlayAttached&&s!==r._element.nativeElement&&r._document.activeElement!==r._element.nativeElement&&(!c||!c.contains(s))&&(!u||!u.contains(s))&&!!r._overlayRef&&!r._overlayRef.overlayElement.contains(s)}))},n.writeValue=function(r){var a=this;Promise.resolve(null).then(function(){return a._assignOptionValue(r)})},n.registerOnChange=function(r){this._onChange=r},n.registerOnTouched=function(r){this._onTouched=r},n.setDisabledState=function(r){this._element.nativeElement.disabled=r},n._handleKeydown=function(r){var a=r.keyCode,s=(0,mn.Vb)(r);if(a===mn.hY&&!s&&r.preventDefault(),this.activeOption&&a===mn.K5&&this.panelOpen&&!s)this.activeOption._selectViaInteraction(),this._resetActiveItem(),r.preventDefault();else if(this.autocomplete){var c=this.autocomplete._keyManager.activeItem,u=a===mn.LH||a===mn.JH;a===mn.Mf||u&&!s&&this.panelOpen?this.autocomplete._keyManager.onKeydown(r):u&&this._canOpen()&&this.openPanel(),(u||this.autocomplete._keyManager.activeItem!==c)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._element.nativeElement.value),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}},n._handleInput=function(r){var a=r.target,s=a.value;"number"===a.type&&(s=""==s?null:parseFloat(s)),this._previousValue!==s&&(this._previousValue=s,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(s),s||this._clearPreviousSelectedOption(null,!1),this._canOpen()&&this._document.activeElement===r.target&&this.openPanel())},n._handleFocus=function(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0},n._handleClick=function(){this._canOpen()&&!this.panelOpen&&this.openPanel()},n._floatLabel=function(r){void 0===r&&(r=!1),this._formField&&"auto"===this._formField.floatLabel&&(r?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)},n._resetLabel=function(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)},n._subscribeToClosingActions=function(){var r=this,a=this._zone.onStable.pipe((0,he.q)(1)),s=this.autocomplete.options.changes.pipe((0,ar.b)(function(){return r._positionStrategy.reapplyLastPosition()}),(0,vt.g)(0));return(0,Hi.T)(a,s).pipe((0,Jt.w)(function(){return r._zone.run(function(){var c=r.panelOpen;r._resetActiveItem(),r._updatePanelState(),r._changeDetectorRef.detectChanges(),r.panelOpen&&r._overlayRef.updatePosition(),c!==r.panelOpen&&(r.panelOpen?(r._captureValueOnAttach(),r._emitOpened()):r.autocomplete.closed.emit())}),r.panelClosingActions}),(0,he.q)(1)).subscribe(function(c){return r._setValueAndClose(c)})},n._emitOpened=function(){this.autocomplete.opened.emit()},n._captureValueOnAttach=function(){this._valueOnAttach=this._element.nativeElement.value},n._destroyPanel=function(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)},n._assignOptionValue=function(r){var a=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(r):r;this._updateNativeInputValue(a??"")},n._updateNativeInputValue=function(r){this._formField?this._formField._control.value=r:this._element.nativeElement.value=r,this._previousValue=r},n._setValueAndClose=function(r){var a=this,s=this.autocomplete,c=r?r.source:this._pendingAutoselectedOption;c?(this._clearPreviousSelectedOption(c),this._assignOptionValue(c.value),this._onChange(c.value),s._emitSelectEvent(c),this._element.nativeElement.focus()):s.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),s._animationDone?s._animationDone.pipe((0,he.q)(1)).subscribe(function(){return a._onChange(null)}):this._onChange(null)),this.closePanel()},n._clearPreviousSelectedOption=function(r,a){var s;null==(s=this.autocomplete)||null==(s=s.options)||s.forEach(function(c){c!==r&&c.selected&&c.deselect(a)})},n._attachOverlay=function(){var a,c,r=this,s=this._overlayRef;s?(this._positionStrategy.setOrigin(this._getConnectedElement()),s.updateSize({width:this._getPanelWidth()})):(this._portal=new ap.UE(this.autocomplete.template,this._viewContainerRef,{id:null==(c=this._formField)?void 0:c.getLabelId()}),s=this._overlay.create(this._getOverlayConfig()),this._overlayRef=s,this._viewportSubscription=this._viewportRuler.change().subscribe(function(){r.panelOpen&&s&&s.updateSize({width:r._getPanelWidth()})})),s&&!s.hasAttached()&&(s.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());var u=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._setColor(null==(a=this._formField)?void 0:a.color),this._updatePanelState(),this._applyModalPanelOwnership(),this._captureValueOnAttach(),this.panelOpen&&u!==this.panelOpen&&this._emitOpened()},n._updatePanelState=function(){if(this.autocomplete._setVisibility(),this.panelOpen){var r=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=r.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=r.outsidePointerEvents().subscribe())}else{var a,s;null==(a=this._keydownSubscription)||a.unsubscribe(),null==(s=this._outsideClickSubscription)||s.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}},n._getOverlayConfig=function(){var r,a;return new Pa.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:null!=(r=this._dir)?r:void 0,panelClass:null==(a=this._defaults)?void 0:a.overlayPanelClass})},n._getOverlayPosition=function(){var r=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(r),this._positionStrategy=r,r},n._setStrategyPositions=function(r){var u,a=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],s=this._aboveClass,c=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:s},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:s}];u="above"===this.position?c:"below"===this.position?a:[].concat(a,c),r.withPositions(u)},n._getConnectedElement=function(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element},n._getPanelWidth=function(){return this.autocomplete.panelWidth||this._getHostWidth()},n._getHostWidth=function(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width},n._resetActiveItem=function(){var r=this.autocomplete;if(r.autoActiveFirstOption){for(var a=-1,s=0;s<r.options.length;s++)if(!r.options.get(s).disabled){a=s;break}r._keyManager.setActiveItem(a)}else r._keyManager.setActiveItem(-1)},n._canOpen=function(){var r=this._element.nativeElement;return!r.readOnly&&!r.disabled&&!this._autocompleteDisabled},n._getWindow=function(){var r;return(null==(r=this._document)?void 0:r.defaultView)||window},n._scrollToOption=function(r){var a=this.autocomplete,s=(0,tn.CB)(r,a.options,a.optionGroups);if(0===r&&1===s)a._setScrollTop(0);else if(a.panel){var c=a.options.toArray()[r];if(c){var u=c._getHostElement(),p=(0,tn.jH)(u.offsetTop,u.offsetHeight,a._getScrollTop(),a.panel.nativeElement.offsetHeight);a._setScrollTop(p)}}},n._applyModalPanelOwnership=function(){var r=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(r){var a=this.autocomplete.id;this._trackedModal&&(0,To.iD)(this._trackedModal,"aria-owns",a),(0,To.Zf)(r,"aria-owns",a),this._trackedModal=r}},n._clearFromModal=function(){this._trackedModal&&((0,To.iD)(this._trackedModal,"aria-owns",this.autocomplete.id),this._trackedModal=null)},(0,_a.Z)(i,[{key:"autocompleteDisabled",get:function(){return this._autocompleteDisabled},set:function(r){this._autocompleteDisabled=(0,Hn.Ig)(r)}},{key:"panelOpen",get:function(){return this._overlayAttached&&this.autocomplete.showPanel}},{key:"panelClosingActions",get:function(){var r=this;return(0,Hi.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,jt.h)(function(){return r._overlayAttached})),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,jt.h)(function(){return r._overlayAttached})):(0,ae.of)()).pipe((0,je.U)(function(a){return a instanceof tn.rN?a:null}))}},{key:"activeOption",get:function(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}}]),i}();(xs=dc).\u0275fac=function(n){return new(n||xs)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(Pa.aV),e.\u0275\u0275directiveInject(e.ViewContainerRef),e.\u0275\u0275directiveInject(e.NgZone),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(uc),e.\u0275\u0275directiveInject(Fc.Is,8),e.\u0275\u0275directiveInject(Vc.G_,9),e.\u0275\u0275directiveInject(j.DOCUMENT,8),e.\u0275\u0275directiveInject(Te.rL),e.\u0275\u0275directiveInject(Uc,8))},xs.\u0275dir=e.\u0275\u0275defineDirective({type:xs,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[e.\u0275\u0275NgOnChangesFeature]});var Io,Ea,Ia,Da,Wc=function(i){function n(){var t;return(t=i.apply(this,arguments)||this)._aboveClass="mat-mdc-autocomplete-panel-above",t}return(0,yi.Z)(n,i),n}(dc);function yp(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",0,1),e.\u0275\u0275projection(2),e.\u0275\u0275elementEnd()),2&i){var t=n.id,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("id",r.id)("ngClass",r._classList),e.\u0275\u0275attribute("aria-label",r.ariaLabel||null)("aria-labelledby",r._getPanelAriaLabelledby(t))}}(xa=Wc).\u0275fac=function(){var i;return function(t){return(i||(i=e.\u0275\u0275getInheritedFactory(xa)))(t||xa)}}(),xa.\u0275dir=e.\u0275\u0275defineDirective({type:xa,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(n,t){1&n&&e.\u0275\u0275listener("focusin",function(){return t._handleFocus()})("blur",function(){return t._onTouched()})("input",function(a){return t._handleInput(a)})("keydown",function(a){return t._handleKeydown(a)})("click",function(){return t._handleClick()}),2&n&&e.\u0275\u0275attribute("autocomplete",t.autocompleteAttribute)("role",t.autocompleteDisabled?null:"combobox")("aria-autocomplete",t.autocompleteDisabled?null:"list")("aria-activedescendant",t.panelOpen&&t.activeOption?t.activeOption.id:null)("aria-expanded",t.autocompleteDisabled?null:t.panelOpen.toString())("aria-controls",t.autocompleteDisabled||!t.panelOpen||null==t.autocomplete?null:t.autocomplete.id)("aria-haspopup",t.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[e.\u0275\u0275ProvidersFeature([vp]),e.\u0275\u0275InheritDefinitionFeature]}),(Ta=function(){}).\u0275fac=function(n){return new(n||Ta)},Ta.\u0275mod=e.\u0275\u0275defineNgModule({type:Ta}),Ta.\u0275inj=e.\u0275\u0275defineInjector({providers:[jc],imports:[Pa.U8,tn.Ng,tn.BQ,j.CommonModule,Te.ZD,tn.Ng,tn.BQ]});var $c=function(i){function n(){var t;return(t=i.apply(this,arguments)||this)._visibleClass="mat-autocomplete-visible",t._hiddenClass="mat-autocomplete-hidden",t._animationDone=null,t}return(0,yi.Z)(n,i),n}(lc);(Io=$c).\u0275fac=function(){var i;return function(t){return(i||(i=e.\u0275\u0275getInheritedFactory(Io)))(t||Io)}}(),Io.\u0275cmp=e.\u0275\u0275defineComponent({type:Io,selectors:[["mat-autocomplete"]],contentQueries:function(n,t,r){var a;1&n&&(e.\u0275\u0275contentQuery(r,tn.K7,5),e.\u0275\u0275contentQuery(r,sn.CK,5)),2&n&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.optionGroups=a),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.options=a))},hostAttrs:["ngSkipHydration","",1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[e.\u0275\u0275ProvidersFeature([{provide:tn.HF,useExisting:Io}]),e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(n,t){1&n&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275template(0,yp,3,4,"ng-template"))},dependencies:[j.NgClass],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}"],encapsulation:2,changeDetection:0});var wp={provide:Ve.JU,useExisting:(0,e.forwardRef)(function(){return pc}),multi:!0},pc=function(i){function n(){var t;return(t=i.apply(this,arguments)||this)._aboveClass="mat-autocomplete-panel-above",t}return(0,yi.Z)(n,i),n}(dc);(Ea=pc).\u0275fac=function(){var i;return function(t){return(i||(i=e.\u0275\u0275getInheritedFactory(Ea)))(t||Ea)}}(),Ea.\u0275dir=e.\u0275\u0275defineDirective({type:Ea,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(n,t){1&n&&e.\u0275\u0275listener("focusin",function(){return t._handleFocus()})("blur",function(){return t._onTouched()})("input",function(a){return t._handleInput(a)})("keydown",function(a){return t._handleKeydown(a)})("click",function(){return t._handleClick()}),2&n&&e.\u0275\u0275attribute("autocomplete",t.autocompleteAttribute)("role",t.autocompleteDisabled?null:"combobox")("aria-autocomplete",t.autocompleteDisabled?null:"list")("aria-activedescendant",t.panelOpen&&t.activeOption?t.activeOption.id:null)("aria-expanded",t.autocompleteDisabled?null:t.panelOpen.toString())("aria-owns",t.autocompleteDisabled||!t.panelOpen||null==t.autocomplete?null:t.autocomplete.id)("aria-haspopup",t.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[e.\u0275\u0275ProvidersFeature([wp]),e.\u0275\u0275InheritDefinitionFeature]});var Sp=function(i){function n(){return i.apply(this,arguments)||this}return(0,yi.Z)(n,i),n}(cc);(Ia=Sp).\u0275fac=function(){var i;return function(t){return(i||(i=e.\u0275\u0275getInheritedFactory(Ia)))(t||Ia)}}(),Ia.\u0275dir=e.\u0275\u0275defineDirective({type:Ia,selectors:[["","matAutocompleteOrigin",""]],exportAs:["matAutocompleteOrigin"],features:[e.\u0275\u0275InheritDefinitionFeature]});var Qc=function(){};(Da=Qc).\u0275fac=function(n){return new(n||Da)},Da.\u0275mod=e.\u0275\u0275defineNgModule({type:Da}),Da.\u0275inj=e.\u0275\u0275defineInjector({providers:[jc],imports:[Pa.U8,sn.Uc,tn.BQ,j.CommonModule,Te.ZD,sn.Uc,tn.BQ]});var Mp=M(73425),Pp=["emailsInput"],Op=["emailsList"];function xp(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.getSuggestionsText(t)," ")}}function Tp(i,n){if(1&i&&e.\u0275\u0275text(0),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate(t.inputLabel)}}function Ep(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",15),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("name",t.inputIcon)}}function Ip(i,n){1&i&&e.\u0275\u0275element(0,"pbi-icon",21)}var Xc=function(n,t){return{userEmail:n,displayName:t}};function Dp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-chip",18),e.\u0275\u0275listener("removed",function(){var u=e.\u0275\u0275restoreView(t).$implicit,p=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(p.remove(u))}),e.\u0275\u0275element(1,"user-details-host",19),e.\u0275\u0275template(2,Ip,1,0,"pbi-icon",20),e.\u0275\u0275elementEnd()}if(2&i){var r=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("disabled",a.disabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("details",e.\u0275\u0275pureFunction2(5,Xc,null==r?null:r.userPrincipalName,null==r?null:r.displayName))("forceShowDisplayNameInTooltip",!0)("coloredDefaultUserPhoto",a.coloredDefaultUserPhoto),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(null!=a.ngControl&&a.ngControl.disabled))}}function kp(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",16),e.\u0275\u0275template(1,Dp,3,8,"mat-chip",17),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(2,1,t.selectedUsers$))}}function Fp(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",22),e.\u0275\u0275element(1,"spinner"),e.\u0275\u0275elementEnd())}function Vp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",23,24),e.\u0275\u0275listener("matChipInputTokenEnd",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.add(u,2))})("paste",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275reference(2);return e.\u0275\u0275nextContext().onPaste(u),e.\u0275\u0275resetView(p.closePanel())})("blur",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onBlur(u))})("focus",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onFocus(u))})("keydown.escape",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275reference(2),v=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(v.onEscape(u,p))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(13),s=e.\u0275\u0275reference(6);e.\u0275\u0275property("placeholder",e.\u0275\u0275pipeBind1(3,9,r.selectedUsers$).length>0?void 0:r.inputPlaceholder)("disabled",r.disabled)("formControl",r.emailsListControl)("matAutocomplete",a)("matChipInputFor",s)("matChipInputSeparatorKeyCodes",r.separatorKeysCodes),e.\u0275\u0275attribute("title",r.inputPlaceholder)("aria-label",r.inputAriaLabelledBy?void 0:r.inputPlaceholder)("aria-labelledby",r.inputAriaLabelledBy)}}function Ap(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",25),e.\u0275\u0275element(1,"user-details-host",26),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275property("showOneLine",!1)("details",e.\u0275\u0275pureFunction2(6,Xc,r.getUserEmail(t),t.displayName))("forceShowDisplayNameInTooltip",!0)("coloredDefaultUserPhoto",r.coloredDefaultUserPhoto),e.\u0275\u0275attribute("data-testid",r.getUserEmail(t))}}function Rp(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",27),e.\u0275\u0275element(2,"message-banner",28),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("viewModel",t.messageBannerViewModel)}}var Yc=function(i){function n(t,r,a,s,c,u){var p=i.call(this)||this;return p.userDirectoryHttpService=t,p.localizationService=r,p.domainHelperService=a,p.telemetryService=s,p.cdr=c,p.ngControl=u,p.showRelevantUsers=!0,p.defaultSelectedUsers=[],p.coloredDefaultUserPhoto=!1,p.onInputFocus=new e.EventEmitter,p.awaitingRequestsCount=new pe.X(0),p.isBusy$=p.awaitingRequestsCount.pipe((0,je.U)(function(v){return _.gt(v,0)}),(0,I.x)(),(0,Gn.d)(1)),p.separatorKeysCodes=[mn.K5],p.emailsListControl=new Ve.p4("",null,p.findUserValidator()),p.emailSuggestionResults=new pe.X([]),p.selectedUsers$=new pe.X([]),p.onSelectedUsersChange=function(){},p.onComponentBlur=function(){},p.ngControl&&(p.ngControl.valueAccessor=p),p}return(0,w.__extends)(n,i),n.prototype.ngOnInit=function(){var t=this;this.pasteHandler=new Re.xQ,this.lifecycleSubscriptions.add(this.pasteHandler.pipe((0,Jd.p)(1e3),(0,Jt.w)(function(r){return(0,w.__awaiter)(t,void 0,void 0,function(){var a,s,c,u,p,v;return(0,w.__generator)(this,function(P){switch(P.label){case 0:return this.emailsListControl.markAsPending(),a=r.clipboardData.getData("Text").split(/;|,|\n/).filter(function(x){return _.trim(x).length>0}),s=_.size(a)<=100,c=this.telemetryService.startEvent(Gd,{inputCount:_.size(a)}),[4,this.addUser(a,s,3)];case 1:return u=P.sent(),p=0===_.size(u),this.propagateSelectedUsersChange(p),this.emailsInput.nativeElement.value=_.join(u,","),(v=_.size(a)>100)&&this.emailsListControl.setErrors({TooManyUsers:_.size(a)}),(p||v)&&this.cdr.markForCheck(),c.resolve(),[2]}})})})).subscribe()),this.lifecycleSubscriptions.add(this.emailsListControl.statusChanges.pipe((0,$e.O)(this.emailsListControl.status),(0,I.x)(),(0,Kd.G)(),(0,jt.h)(function(r){return"PENDING"===r[0]})).subscribe(function(){return t.cdr.markForCheck()})),this.actions&&this.actions.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(r){0===r&&t.reset()}),this.applyDefaultSelectedUsers(),this.onChanges$.subscribe(function(r){t.onChanges(r)})},n.prototype.ngAfterViewInit=function(){this.notUseUnallowedAttributes()},n.prototype.onChanges=function(t){t.defaultSelectedUsers&&this.applyDefaultSelectedUsers()},n.prototype.applyDefaultSelectedUsers=function(){this.defaultSelectedUsers&&this.defaultSelectedUsers.length>0&&this.selectedUsers$.value&&0===this.selectedUsers$.value.length&&this.selectedUsers$.next(this.defaultSelectedUsers)},n.prototype.reset=function(){this.selectedUsers$.next([]),this.emailsListControl.setValue(null),this.emailsInput&&(this.emailsInput.nativeElement.value=""),this.propagateSelectedUsersChange(!0)},n.prototype.propagateSelectedUsersChange=function(t){t&&this.emailsListControl.setErrors(null),this.onSelectedUsersChange(this.selectedUsers$.value)},n.prototype.add=function(t,r){var a;return(0,w.__awaiter)(this,void 0,void 0,function(){var s;return(0,w.__generator)(this,function(p){switch(p.label){case 0:return this.emailsListControl.invalid||this.emailsListControl.pending?[2]:(s=null===(a=t.chipInput)||void 0===a?void 0:a.inputElement,[4,this.addUser([t.value],!0,r)]);case 1:return 0===p.sent().length&&(s&&(s.value=""),this.propagateSelectedUsersChange(!0),this.emailsListControl.setValue(null)),[2]}})})},Object.defineProperty(n.prototype,"hasValidPendingInput",{get:function(){var r=this.emailsInput.nativeElement.value;return!!r&&Si.JJ.test(r)},enumerable:!1,configurable:!0}),n.prototype.addUser=function(t,r,a){return(0,w.__awaiter)(this,void 0,void 0,function(){var s,c,u,p,v,P;return(0,w.__generator)(this,function(x){switch(x.label){case 0:s=[],c=0,u=t,x.label=1;case 1:return c<u.length?(p=u[c],(p=_.trim(p))?(v=void 0,r?[4,this.findUsers(p).pipe((0,je.U)(function(G){return 1===G.length?G[0]:null})).toPromise()]:[3,3]):[3,6]):[3,7];case 2:v=x.sent(),x.label=3;case 3:return this.emailsListControl.value||1!==a?(P=void 0,v?[3,5]:[4,this.validateEmail(p,r&&this.checkValidOrgUser,!r||this.allowExternalUsers)]):[3,6];case 4:P=x.sent(),x.label=5;case 5:P?(this.emailsListControl.setErrors(P),s.push(p),this.cdr.markForCheck()):this.selectedUsers$.next(this.selectedUsers$.value.concat([v??this.getADUserMetadataFromEmail(p)])),x.label=6;case 6:return c++,[3,1];case 7:return[2,s]}})})},n.prototype.getADUserMetadataFromEmail=function(t){return{displayName:void 0,userPrincipalName:t,objectId:void 0,emailAddress:t,objectType:1,isSecurityGroup:!1}},n.prototype.remove=function(t){this.selectedUsers$.next(this.selectedUsers$.value.filter(function(r){return r!==t})),this.propagateSelectedUsersChange(!0)},n.prototype.select=function(t){this.selectedUsers$.next(this.selectedUsers$.value.concat([t.option.value])),this.propagateSelectedUsersChange(!0),this.emailsInput.nativeElement.value="",this.emailsListControl.setValue(null)},n.prototype.findUserValidator=function(){var t=this;return function(r){return(0,Qd.H)(500).pipe((0,Jt.w)(function(){var a=_.trim(r.value);return _.isString(r.value)&&a?t.findUsers(r.value).pipe((0,ar.b)(function(c){return t.emailSuggestionResults.next(c)}),(0,st.zg)(function(c){return _.isEmpty(c)?t.validateEmail(r.value,t.checkValidOrgUser,t.allowExternalUsers):(0,ae.of)(null)})):(t.emailSuggestionResults.next([]),(0,ae.of)(null))}))}},n.prototype.sendFindUsersRequest=function(t){var r=this;return function(i,n){return new Xd.y(function(t){var r,a;try{r=i()}catch(u){return void t.error(u)}try{a=n()}catch(u){return void t.error(u)}var c=(a?(0,ac.D)(a):Yd.E).subscribe(t);return function(){c.unsubscribe(),r&&r.unsubscribe()}})}(function(){return{unsubscribe:function(){return r.awaitingRequestsCount.next(r.awaitingRequestsCount.value-1)}}},function(){var s=r.allowAnyGroup||r.allowSecurityGroups||r.allowUnifiedGroups||r.allowEmailEnabledSecurityGroups?r.blockUsers?2:3:1;return r.awaitingRequestsCount.next(r.awaitingRequestsCount.value+1),r.userDirectoryHttpService.findUsers(t,s,$d.OsI,!!r.includeGuests,r.showRelevantUsers,r.allowAnyGroup,!0)})},n.prototype.findUsers=function(t){var r=this;return this.sendFindUsersRequest(t).pipe((0,je.U)(function(a){return _.reduce(a.data,function(s,c){var u;if(r.isValidObjectType(c)&&-1===_.findIndex(r.selectedUsers$.value,function(G){return r.compareADEntities(c,G)})){var v=c.displayName&&c.displayName.toLocaleLowerCase()===t.toLocaleLowerCase(),P=null===(u=c.userPrincipalName)||void 0===u?void 0:u.split("@")[0],x=P&&P.toLocaleLowerCase()===t.toLocaleLowerCase();v||x?s.unshift(c):s.push(c)}return s},[])}),(0,ep.K)(function(){return(0,ae.of)([])}))},n.prototype.compareADEntities=function(t,r){return t.userPrincipalName&&r.userPrincipalName?t.userPrincipalName===r.userPrincipalName:!(!t.objectId||!r.objectId)&&t.objectId===r.objectId},n.prototype.writeValue=function(t){t&&this.selectedUsers$.next(t)},n.prototype.registerOnChange=function(t){this.onSelectedUsersChange=t},n.prototype.registerOnTouched=function(t){this.onComponentBlur=t},n.prototype.onPaste=function(t){t.preventDefault(),this.pasteHandler.next(t)},Object.defineProperty(n.prototype,"messageBannerViewModel",{get:function(){var r=this.localizationService.get("ClientError_UnknownClientErrorValue"),a=1;return this.emailsListControl.hasError("DuplicateEmail")||this.emailsListControl.hasError("InvalidEmail")?r=this.localizationService.get("Sharing_InvalidEmail"):this.emailsListControl.hasError("ExternalUser")?(r=this.localizationService.format("Sharing_ExternalOrganization",this.emailsListControl.getError("ExternalUser")),a=1):this.emailsListControl.hasError("InvalidOrgUser")?(r=this.localizationService.format("GrantAccessPane_InvalidEmails",this.emailsListControl.getError("InvalidOrgUser")),a=1):this.emailsListControl.hasError("TooManyUsers")&&(r=this.localizationService.format("TooManyUsers_BlockedEmails",this.emailsListControl.getError("TooManyUsers")),a=1),{bannerType:a,iconName:1===a?"pbi-glyph-error-circle-exclamation":"pbi-glyph-warning",message:r}},enumerable:!1,configurable:!0}),n.prototype.onBlur=function(t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r,a;return(0,w.__generator)(this,function(s){switch(s.label){case 0:return t.relatedTarget&&"MAT-OPTION"===t.relatedTarget.tagName?[2]:(this.onComponentBlur(this.selectedUsers$.value),this.addUserOnBlur?(r=this.emailsInput.nativeElement,this.emailsListControl.pending?[4,this.emailsListControl.statusChanges.pipe((0,jt.h)(function(c){return"PENDING"!==c}),(0,he.q)(1)).toPromise()]:[3,2]):[3,3]);case 1:s.sent(),s.label=2;case 2:return(a=_.trim(r.value))?[2,this.add({input:r,value:a,chipInput:new Bl(this.emailsInput,{separatorKeyCodes:[]})},1)]:[2];case 3:return[2]}})})},n.prototype.onEscape=function(t,r){var a;null!==(a=r?.autocomplete)&&void 0!==a&&a.isOpen&&(t?.stopPropagation(),r.closePanel())},n.prototype.onFocus=function(t){this.onInputFocus.emit(t)},n.prototype.validateEmail=function(t,r,a){return void 0===a&&(a=!1),(0,w.__awaiter)(this,void 0,void 0,function(){var c;return(0,w.__generator)(this,function(u){switch(u.label){case 0:return Si.JJ.test(t)?-1!==_.findIndex(this.selectedUsers$.value,function(p){return p.userPrincipalName===t})?[2,{DuplicateEmail:!0}]:[4,this.domainHelperService.emailIsInVerifiedDomain(t)]:[3,2];case 1:return(c=u.sent())||a?c&&r?[2,{InvalidOrgUser:t}]:[2,null]:[2,{ExternalUser:t}];case 2:return[2,{InvalidEmail:!0}]}})})},n.prototype.isValidObjectType=function(t){return 2===t.objectType?!!this.allowAnyGroup||(t.isSecurityGroup?this.allowSecurityGroups||this.allowEmailEnabledSecurityGroups&&3===t.groupType:2===t.groupType?this.allowDistributionLists:this.allowUnifiedGroups):1===t.objectType&&t.aadAppId?this.allowServicePrincipals:(1===t.objectType||3===t.objectType)&&!this.blockUsers},n.prototype.getUserEmail=function(t){return t.userPrincipalName||t.emailAddress||(t.aadAppId?"AppID: "+t.aadAppId:null)},n.prototype.notUseUnallowedAttributes=function(){this.emailsList._multiple=void 0,this.emailsList.ariaOrientation=void 0},n.prototype.getSuggestionsText=function(t){return t>0?this.localizationService.format("Email_Address_Suggestion_Count_Text",[t]):""},n.\u0275fac=function(r){return new(r||n)(e.\u0275\u0275directiveInject(qc.W),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(rp),e.\u0275\u0275directiveInject(Ca.y0),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Ve.a5,10))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["emails-list-modern"]],viewQuery:function(r,a){if(1&r&&(e.\u0275\u0275viewQuery(Pp,5),e.\u0275\u0275viewQuery(Op,5)),2&r){var s=void 0;e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.emailsInput=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.emailsList=s.first)}},hostVars:4,hostBindings:function(r,a){2&r&&e.\u0275\u0275classProp("disabled",(null==a.ngControl?null:a.ngControl.disabled)||a.disabled)("invalid",(null==a.ngControl?null:a.ngControl.invalid)||a.emailsListControl.invalid)},inputs:{allowAnyGroup:"allowAnyGroup",allowSecurityGroups:"allowSecurityGroups",allowUnifiedGroups:"allowUnifiedGroups",allowEmailEnabledSecurityGroups:"allowEmailEnabledSecurityGroups",allowObjectIds:"allowObjectIds",blockUsers:"blockUsers",isRequired:"isRequired",includeGuests:"includeGuests",allowExternalUsers:"allowExternalUsers",allowDistributionLists:"allowDistributionLists",allowServicePrincipals:"allowServicePrincipals",inputLabel:"inputLabel",inputPlaceholder:"inputPlaceholder",inputIcon:"inputIcon",inputAriaLabelledBy:"inputAriaLabelledBy",disabled:"disabled",maxSelectableUsers:"maxSelectableUsers",hideChips:"hideChips",hideError:"hideError",hideInput:"hideInput",addUserOnBlur:"addUserOnBlur",checkValidOrgUser:"checkValidOrgUser",showRelevantUsers:"showRelevantUsers",actions:"actions",defaultSelectedUsers:"defaultSelectedUsers",coloredDefaultUserPhoto:"coloredDefaultUserPhoto"},outputs:{onInputFocus:"onInputFocus"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:17,vars:17,consts:[["id","emailsList","appearance","none","cdkScrollable","",1,"emails-list"],["class","x-screen-reader","aria-live","assertive",4,"ngIf"],[1,"email-list-input-wrapper"],[3,"ngIf"],["role","listbox",1,"chip-list",3,"required"],["emailsList",""],["class","inputIcon","size","small",3,"name",4,"ngIf"],["class","chips-wrapper",4,"ngIf"],["class","autoCompleteSpinner",4,"ngIf"],["matChipInput","","aria-owns","email-list-modern-suggestions","aria-controls","email-list-modern-suggestions","data-testid","emails-list-input","data-unique-id","EmailsListInput",3,"placeholder","disabled","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd","paste","blur","focus","keydown.escape",4,"ngIf"],["id","email-list-modern-suggestions","data-testid","email-sugessions-dropdown",3,"optionSelected"],["auto","matAutocomplete"],["data-automation-type","Suggestion",3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["aria-live","assertive",1,"x-screen-reader"],["size","small",1,"inputIcon",3,"name"],[1,"chips-wrapper"],["defaultTabIndex","0","tabindex","0","role","option",3,"disabled","removed",4,"ngFor","ngForOf"],["defaultTabIndex","0","tabindex","0","role","option",3,"disabled","removed"],[3,"details","forceShowDisplayNameInTooltip","coloredDefaultUserPhoto"],["name","close","size","mini","matChipRemove","",4,"ngIf"],["name","close","size","mini","matChipRemove",""],[1,"autoCompleteSpinner"],["matChipInput","","aria-owns","email-list-modern-suggestions","aria-controls","email-list-modern-suggestions","data-testid","emails-list-input","data-unique-id","EmailsListInput",3,"placeholder","disabled","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd","paste","blur","focus","keydown.escape"],["emailsInput","","trigger","matAutocompleteTrigger"],["data-automation-type","Suggestion",3,"value"],[3,"showOneLine","details","forceShowDisplayNameInTooltip","coloredDefaultUserPhoto"],["role","alert","aria-atomic","true"],[3,"viewModel"]],template:function(r,a){var s;(1&r&&(e.\u0275\u0275elementStart(0,"mat-form-field",0),e.\u0275\u0275template(1,xp,2,1,"div",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"label",2),e.\u0275\u0275template(4,Tp,1,1,"ng-template",3),e.\u0275\u0275elementStart(5,"mat-chip-list",4,5),e.\u0275\u0275template(7,Ep,1,1,"pbi-icon",6),e.\u0275\u0275template(8,kp,3,3,"div",7),e.\u0275\u0275template(9,Fp,2,0,"div",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,Vp,4,11,"input",9),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"mat-autocomplete",10,11),e.\u0275\u0275listener("optionSelected",function(u){return a.select(u)}),e.\u0275\u0275template(14,Ap,2,9,"mat-option",12),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(16,Rp,3,1,"ng-container",13)),2&r)&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(s=e.\u0275\u0275pipeBind1(2,11,a.emailSuggestionResults))?null:s.length),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",a.inputLabel),e.\u0275\u0275advance(1),e.\u0275\u0275property("required",a.isRequired),e.\u0275\u0275attribute("aria-label",a.inputAriaLabelledBy?void 0:a.inputPlaceholder)("aria-labelledby",a.inputAriaLabelledBy),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!!a.inputIcon),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a.hideChips),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.emailsListControl.pending),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a.hideInput&&(!a.maxSelectableUsers||e.\u0275\u0275pipeBind1(11,13,a.selectedUsers$).length<a.maxSelectableUsers)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(15,15,a.emailSuggestionResults)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.emailsListControl.invalid&&!a.hideError))},dependencies:[j.NgForOf,j.NgIf,$c,pc,Te.PQ,sn.CK,oc,Ms,Bl,ic,Wt.v_,Ve.Fj,Ve.JJ,Ve.oH,ln._,Mp.O,ql.A,te.s,j.AsyncPipe],styles:['[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{border:0px solid;width:min-content;min-height:32px;padding:6px 8px!important;margin:0!important;box-sizing:border-box;caret-color:auto;line-height:1.4}[_nghost-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{display:block;line-height:1.125}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]{max-width:100%;display:flex}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]     .mat-chip-list-wrapper{max-width:100%;margin:0}[_nghost-%COMP%]   .chip-list[_ngcontent-%COMP%]   .chips-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-height:190px;overflow:auto}[_nghost-%COMP%]   .inputIcon[_ngcontent-%COMP%]{padding:0 8px}[_nghost-%COMP%]     .mat-chip{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);font-weight:400;padding:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis}[_nghost-%COMP%]     .mat-standard-chip{min-height:24px!important}[_nghost-%COMP%]     .mat-standard-chip.mat-chip-with-trailing-icon{padding:0 2px 0 0!important}[_nghost-%COMP%]     .mat-standard-chip .mat-chip-remove{height:12px!important}[_nghost-%COMP%]     .mat-form-field-appearance-standard, [_nghost-%COMP%]     .mat-form-field-wrapper, [_nghost-%COMP%]     .mat-form-field-flex{padding:0}[_nghost-%COMP%]     .mat-form-field-infix{border:0px;padding:0;width:min-content;min-height:32px}[_nghost-%COMP%]     .mat-form-field-appearance-standard .mat-form-field-flex, [_nghost-%COMP%]     .mat-chip-list-wrapper{padding-top:0!important;padding-bottom:0!important}[_nghost-%COMP%]     user-details-host{width:calc(100% - 24px)}[_nghost-%COMP%]     user-details{width:100%}[_nghost-%COMP%]     .user-info{width:calc(100% - 29px)}[_nghost-%COMP%]     .user-name, [_nghost-%COMP%]     .user-email{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]{display:flex;flex-flow:wrap}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]   .email-list-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{opacity:1;color:var(--colorNeutralForeground4, #707070)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{border:1px solid var(--fluent-theme-neutral-tertia-color, #A19F9D);border-radius:2px;background-color:var(--fluent-theme-white-color, #FFF)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]:hover{border-color:var(--fluent-theme-black-color, #000)}[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]:focus-within{border:2px solid var(--colorNeutralStrokeFocus2)}[_nghost-%COMP%]   .autoCompleteSpinner[_ngcontent-%COMP%]{position:absolute;top:4px;right:6px;overflow:auto}.invalid[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{border-color:var(--fluent-theme-error-dark-color, #A80000)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-light-color, #EDEBE9)}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{display:none}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{width:100%}html:not([dir="rtl"])   .disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{margin-right:12px}html[dir="rtl"]   .disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   user-details-host[_ngcontent-%COMP%]{margin-left:12px}.disabled[_nghost-%COMP%]   .emails-list[_ngcontent-%COMP%]   .chip-list[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--colorNeutralForegroundDisabled, #bdbdbd)}user-details-host[_ngcontent-%COMP%]     .user-email, user-details-host[_ngcontent-%COMP%]     .user-name{line-height:16px}.mat-option.mat-active[_ngcontent-%COMP%]{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color)}.x-screen-reader[_ngcontent-%COMP%]{position:absolute!important;overflow:hidden!important;clip:rect(1px,1px,1px,1px)!important;width:1px!important;height:1px!important;border:0!important;padding:0!important;margin:0!important}'],changeDetection:0}),n}(se.w),hc=M(56011),Lp=function(){function i(n){this.scorecardService=n}return Object.defineProperty(i.prototype,"scorecard",{get:function(){return this.scorecardService.getCurrentScorecard()},enumerable:!1,configurable:!0}),i.prototype.updateScorecardStatuses=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(t){switch(t.label){case 0:return i.isLocalScorecard?(this.scorecard.goalStatuses=n.goalStatuses,this.scorecard.goalStatuses.nextId=this.scorecard.goalStatuses.statuses.length,this.commit(),[3,3]):[3,1];case 1:return[4,this.scorecardService.updateScorecard(n)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},i.prototype.createCategoryListHandler=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return i.isLocalScorecard?(_.isUndefined(this.scorecard.goalValueCategories)&&(this.scorecard.goalValueCategories=[]),t=q.getGoalValueCategoriesCreateRequest(n),r={id:this.scorecard.goalValueCategories.length.toString(),scorecardId:"",name:"",categories:t.categories},this.scorecard.goalValueCategories.push(r),this.commit(),[2,r]):[3,1];case 1:return[4,this.scorecardService.createCategoryList(n)];case 2:return[2,a.sent()]}})})},i.prototype.updateCategoryListHandler=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t;return(0,w.__generator)(this,function(r){switch(r.label){case 0:return i.isLocalScorecard?(t=_.findIndex(this.scorecard.goalValueCategories,function(a){return a.id===n.id}),this.scorecard.goalValueCategories[t]=n,this.commit(),[2,n]):[3,1];case 1:return[4,this.scorecardService.updateCategoryList(n)];case 2:return[2,r.sent()]}})})},i.prototype.deleteCategoryListHandler=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t;return(0,w.__generator)(this,function(r){switch(r.label){case 0:return i.isLocalScorecard?(_.remove(this.scorecard.goalValueCategories,function(a){return a.id===n}),t=0,this.scorecard.goalValueCategories.forEach(function(a){a.id=t.toString(),t+=1}),this.commit(),[3,3]):[3,1];case 1:return[4,this.scorecardService.deleteCategoryList(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},i.prototype.commit=function(){this.scorecardService.loadPrefetchedScorecard(this.scorecard)},i.isLocalScorecard=!1,i}(),Gp=["matSelect"];function Np(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-option",6),e.\u0275\u0275listener("onSelectionChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onValueSelect(s))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&i){var r=n.$implicit;e.\u0275\u0275styleProp("background-color",r.color),e.\u0275\u0275property("value",r),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.displayName," ")}}function Hp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.onEdit())}),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()()}2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,1,"EditStatusRules_Button_Text")," "))}var Zc=function(){function i(n,t,r){this.detailsPaneLauncher=n,this.localizationService=t,this.scorecardService=r,this.canCustomizeStatus=!1,this.onSelect=new e.EventEmitter,this.createGoalHelper=new Lp(r),this.goalStatusHelper=new N.p(this.localizationService),this.defaultColor=W.xt.defaultColorPalette[0].backgroundColor,this.statusForm=new Ve.nJ({statusPicker:new Ve.p4(null)})}return i.prototype.focus=function(){this.matSelect._elementRef.nativeElement.focus()},i.prototype.onEdit=function(){var n=this;this.detailsPaneLauncher.openEditStatusesPane(this.scorecardService,function(t){return n.createGoalHelper.updateScorecardStatuses(t)},!this.canCustomizeStatus),this.matSelect.close()},i.prototype.ngOnInit=function(){this.displayGoalStatuses=this.configStatus(this.goalStatuses)},i.prototype.ngOnChanges=function(n){var t,r,a;n.goalStatuses&&(this.displayGoalStatuses=this.configStatus(this.goalStatuses)),n.isReadOnly&&(this.isReadOnly?null===(t=this.statusForm)||void 0===t||t.get("statusPicker").disable():null===(r=this.statusForm)||void 0===r||r.get("statusPicker").enable()),n.status&&(this.currentStatus=N.p.getGoalStatus(this.status,this.goalStatuses),_.isNil(this.status)&&this.showUndefinedAsEmpty&&(this.currentStatus=void 0),null===(a=this.statusForm.get("statusPicker"))||void 0===a||a.setValue(this.currentStatus)),n.showUndefinedAsEmpty&&(this.defaultColor=this.showUndefinedAsEmpty?"transparent":W.xt.defaultColorPalette[0].backgroundColor)},i.prototype.compareOptions=function(n,t){return n.id===t.id},i.prototype.onValueSelect=function(n){n.isUserInput&&(this.currentStatus=n.source.value,this.onSelect.emit(n.source.value))},i.prototype.configStatus=function(n){var t=[];if(!_.isEmpty(n))for(var r=0,a=n;r<a.length;r++){var s=a[r];if(!s.historical){var c={id:s.id,displayName:this.goalStatusHelper.tryLocalizeDisplayName(s.displayName),color:s.color,historical:s.historical,labelColor:s.labelColor};t.push(c)}}return t},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(et))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["status-picker"]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(Gp,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.matSelect=a.first))},inputs:{canCustomizeStatus:"canCustomizeStatus",goalStatuses:"goalStatuses",status:"status",isReadOnly:"isReadOnly",onSave:"onSave",showUndefinedAsEmpty:"showUndefinedAsEmpty"},outputs:{onSelect:"onSelect"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:10,consts:[[3,"formGroup"],["appearance","none"],["pbiInput","","pbiMatSelect","","disableOptionCentering","","data-testid","goal-status-picker","panelClass","goal-status-panel","formControlName","statusPicker",1,"custom-mat-select",3,"placeholder","aria-label","compareWith"],["matSelect",""],["class","custom-mat-option",3,"background-color","value","onSelectionChange",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"custom-mat-option",3,"value","onSelectionChange"],[1,"editStatus",3,"click"]],template:function(t,r){var a;(1&t&&(e.\u0275\u0275elementStart(0,"form",0)(1,"mat-form-field",1)(2,"mat-select",2,3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275template(5,Np,2,4,"mat-option",4),e.\u0275\u0275template(6,Hp,4,3,"div",5),e.\u0275\u0275elementEnd()()()),2&t)&&(e.\u0275\u0275property("formGroup",r.statusForm),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",null!==(a=null==r.currentStatus?null:r.currentStatus.color)&&void 0!==a?a:r.defaultColor),e.\u0275\u0275propertyInterpolate("aria-label",e.\u0275\u0275pipeBind1(4,8,"SelectStatus")),e.\u0275\u0275property("placeholder",null==r.currentStatus?null:r.currentStatus.displayName)("compareWith",r.compareOptions),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.displayGoalStatuses),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.canCustomizeStatus))},dependencies:[j.NgForOf,j.NgIf,Ve._Y,Ve.JJ,Ve.JL,Wt.v_,en.x8,sn.CK,Ve.sg,Ve.u,Mt.F],styles:['.custom-mat-option{height:24px!important;line-height:24px!important;margin:6px 32px 6px 8px;border-radius:12px}  .custom-mat-option span{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);text-align:center}  .mat-option.mat-active{outline:2px solid var(--fluent-theme-neutral-dark-color, #201F1E)}  .editStatus{width:100%;background-color:transparent!important;border:none;border-top:1px solid var(--gray-60, #C8C6C4);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}  .editStatus:hover,   .editStatus:active{background-color:transparent!important;border-top:1px solid var(--gray-60, #C8C6C4)!important}  .goal-status-panel{margin-top:42px;margin-bottom:42px;width:100%;max-width:100%!important;min-width:100%!important;margin-left:16px;box-shadow:var(--fluent-shadow-depth8, 0px 0px 2px var(--colorNeutralShadowAmbient), 0px 4px 8px var(--colorNeutralShadowKey))!important;border-radius:2px!important;position:relative;top:-12px}[_nghost-%COMP%]     mat-form-field{width:100%!important;border:1px solid var(--gray-110, #8A8886);box-sizing:border-box;border-radius:2px;height:32px;padding:2px}[_nghost-%COMP%]     mat-form-field mat-select{border-radius:24px}[_nghost-%COMP%]     .mat-select-trigger{height:24px!important;width:100%;display:flex;align-items:center}[_nghost-%COMP%]     .custom-mat-select .mat-select-value{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130);text-align:center;border-radius:12px;margin-left:8px;margin-right:8px;line-height:24px!important;height:24px!important}[_nghost-%COMP%]     .custom-mat-select .mat-select-arrow-wrapper{font-family:PowrMDL2;font-style:normal;font-size:32px;display:inline-block;font-size:12px;margin-right:8px;color:var(--gray-140, #484644)}[_nghost-%COMP%]     .custom-mat-select .mat-select-arrow-wrapper:before{content:"\\e70d"}[_nghost-%COMP%]     .custom-mat-select .mat-select-arrow-wrapper .mat-select-arrow{display:none}[_nghost-%COMP%]     .custom-mat-select.mat-select-disabled .mat-select-arrow-wrapper{display:none}[_nghost-%COMP%]     .custom-mat-select:focus{outline:2px solid var(--fluent-theme-neutral-dark-color, #201F1E)}[_nghost-%COMP%]     .mat-select-value{width:100%;max-width:100%}[_nghost-%COMP%]     .mat-select-placeholder{color:unset}[_nghost-%COMP%]     .mat-select-value-text{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}[_nghost-%COMP%]     .mat-form-field-wrapper{padding:0!important}[_nghost-%COMP%]     .mat-form-field-wrapper .mat-form-field-flex{height:unset!important}[_nghost-%COMP%]     .mat-form-field-wrapper .mat-form-field-infix{padding:0!important;border:none!important;top:1px}'],changeDetection:0}),i}(),zp=["nameInput"],qp=["goal-edit-row",""];function Bp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"pbi-checkbox",17),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.onSelectGoalCheckbox())}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()()}if(2&i){var a,s,r=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("box-checked",null==(a=e.\u0275\u0275pipeBind1(1,4,r.selectedGoalIds$))?null:a[r.displayedGoal.id]),e.\u0275\u0275advance(2),e.\u0275\u0275property("checked",null==(s=e.\u0275\u0275pipeBind1(3,6,r.selectedGoalIds$))?null:s[r.displayedGoal.id])("disabled",null==r.displayedGoal?null:r.displayedGoal.isNew)}}function Up(i,n){1&i&&e.\u0275\u0275element(0,"td",18)}function jp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13),e.\u0275\u0275element(2,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",19),e.\u0275\u0275element(4,"div",20),e.\u0275\u0275elementStart(5,"div",21)(6,"emails-list-modern",22),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.selectedUsers=s)}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275property("allowAnyGroup",!0)("maxSelectableUsers",r.maxGoalOwnerCount)("ngModel",r.selectedUsers)("addUserOnBlur",!0)("inputPlaceholder",e.\u0275\u0275pipeBind1(7,7,"Enter_Name"))("disabled",!r.capabilities.editOwners)("hideInput",!r.capabilities.editOwners)}}function Wp(i,n){1&i&&e.\u0275\u0275element(0,"span",31)}function $p(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",28),e.\u0275\u0275template(1,Wp,1,0,"span",29),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",30),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onUpdateStatusRules())}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.displayedGoal.hasStatusRules),e.\u0275\u0275advance(3),e.\u0275\u0275property("localize",r.displayedGoal.hasStatusRules?"UpdateMetricStatusRules":"SetupMetricStatusRules")}}function Qp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",23),e.\u0275\u0275element(2,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",24),e.\u0275\u0275element(4,"div",25),e.\u0275\u0275elementStart(5,"status-picker",26),e.\u0275\u0275listener("onSelect",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onStatusChange(s))}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,$p,5,2,"div",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("canCustomizeStatus",null==r.capabilities.scorecardCapabilities?null:r.capabilities.scorecardCapabilities.customizeStatus)("status",null==r.currentValue?null:r.currentValue.status)("goalStatuses",e.\u0275\u0275pipeBind1(6,7,r.goalStatuses$))("pbiTooltip",e.\u0275\u0275pipeBind1(7,9,"MetricStatus_ReadOnly"))("pbiTooltipDisabled",!r.displayedGoal.hasStatusRules)("isReadOnly",!r.capabilities.editStatus),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.showUpdateRules&&r.capabilities.editStatusRules)}}function Xp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13),e.\u0275\u0275element(2,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",32),e.\u0275\u0275element(4,"div",33),e.\u0275\u0275elementStart(5,"div",9)(6,"input",34),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onStartDateChange(s))}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"div",35)(9,"div",36),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"localize"),e.\u0275\u0275element(12,"i",37),e.\u0275\u0275pipe(13,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",9)(15,"input",38),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onDueDateChange(s))}),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275property("min",r.SqlDateTimeMinValue)("max",r.SqlDateTimeMaxValue)("ngModel",r.startDateShort)("disabled",!r.capabilities.editStartDate),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(7,12,"Start_Date")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(11,14,"DueDate")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(13,16,"Metrics_Due_Date_Tooltip")),e.\u0275\u0275advance(3),e.\u0275\u0275property("min",r.SqlDateTimeMinValue)("max",r.SqlDateTimeMaxValue)("ngModel",r.completionDateShort)("disabled",!r.capabilities.editDueDate),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(16,18,"DueDate"))}}var Yp=function(){return[]},Jc=function(){function i(n,t,r,a,s,c,u,p){this.featureSwitches=n,this.scorecardService=t,this.scorecardConfigurationService=r,this.detailsPaneLauncher=a,this.capabilityService=s,this.telemetryService=c,this.scorecardHost=u,this.settingsService=p,this.TotalNumberOfColumns=W.gT.TotalNumberOfColumns,this.GoalNameMaxLength=dn.GoalNameMaxLength,this.maxGoalOwnerCount=1,this.currentValue={},this.supportMultipleTargets=!1,this.supportMultipleValuesEditing=!1,this.indentation=0,this.selectedUsers=[],this.showUpdateRules=!1,this.goalCurrentValueSelection=void 0,this.goalTargetValueSelection=void 0,this.SqlDateTimeMinValue=W.gT.SqlDateTimeMinValue,this.SqlDateTimeMaxValue=W.gT.SqlDateTimeMaxValue,this.isSingleGoalVisual=!1}return Object.defineProperty(i.prototype,"indent",{set:function(t){this.indentation=ke.r.getSafeIndentation(t)},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){var n,r,a,s,c,u,p,t=this;b.fF.assertValue(this.goal,"No goal to edit"),this.displayedGoal=_.cloneDeep(this.goal),this.startDateShort=null===(a=null===(r=this.displayedGoal)||void 0===r?void 0:r.startDate)||void 0===a?void 0:a.slice(0,10),this.completionDateShort=null===(c=null===(s=this.displayedGoal)||void 0===s?void 0:s.completionDate)||void 0===c?void 0:c.slice(0,10);var v=ke.r.buildCurrentGoalValue(this.goal);if(this.currentTarget={timestamp:v.timestamp,target:v.target},v.target=void 0,this.currentValue=v,this.supportMultipleValuesEditing=this.featureSwitches.featureSwitches.goalsMultipleValuesEditor,this.supportMultipleTargets=this.featureSwitches.featureSwitches.powerBIGoalsMultipleTargets,this.supportMultipleTargets&&(this.currentTarget=ke.r.getCurrentGoalTarget(this.displayedGoal),!this.currentTarget)){var P=ne.E.getCurrentUTCDay();P.setMonth(P.getMonth()+1),this.currentTarget={timestamp:P.toISOString()}}var x=this.displayedGoal.owner;this.selectedUsers=x?[{displayName:"",userPrincipalName:x,objectId:"",objectType:1,isSecurityGroup:!1}]:[];var G=this.displayedGoal.additionalOwners;_.isEmpty(G)||(n=this.selectedUsers).push.apply(n,G.filter(function(ue){return ue.userPrincipalName}).map(function(ue){return{displayName:"",userPrincipalName:ue.userPrincipalName,objectId:"",objectType:1,isSecurityGroup:!1}})),this.showUpdateRules=this.featureSwitches.featureSwitches.powerBIGoalsStatusRules,this.bulkDeleteEnabled=this.featureSwitches.featureSwitches.goalsBulkDelete,this.selectedGoalIds$=this.scorecardService.getSelectedGoalIdsObservable();var Y=this.scorecardService.getColumnSettings();this.showDueDate$=Y.pipe((0,I.x)(),(0,je.U)(function(ue){return K.isColumnVisible(ue,5)})),this.showOwner$=Y.pipe((0,I.x)(),(0,je.U)(function(ue){return K.isColumnVisible(ue,1)})),this.showStatus$=Y.pipe((0,I.x)(),(0,je.U)(function(ue){return K.isColumnVisible(ue,2)})),this.maxGoalOwnerCount=this.featureSwitches.featureSwitches.powerBIGoalsMultipleGoalOwners?dn.MaxGoalOwnerCount:1,null===(p=null===(u=this.settingsService)||void 0===u?void 0:u.settings)||void 0===p||p.pipe((0,he.q)(1)).subscribe(function(ue){var Se;t.isSingleGoalVisual=!_.isNil(null===(Se=_.first(ue.filters))||void 0===Se?void 0:Se.goalId)}),this.goalStatuses$=this.scorecardService.goalStatusesByScorecardId$.pipe((0,je.U)(function(ue){return ue[t.goal.scorecardId]})),this.updateCapabilities()},i.prototype.ngAfterViewInit=function(){this.displayedGoal.isNew&&this.nameInput.nativeElement.focus()},i.prototype.ngOnChanges=function(n){n.goal&&this.displayedGoal&&!this.goal.isNew&&(this.displayedGoal.hasStatusRules=this.goal.hasStatusRules,this.updateCapabilities(),this.displayedGoal.cycleMetadata=(0,w.__assign)({},this.goal.cycleMetadata),this.displayedGoal.metadata=(0,w.__assign)({},this.goal.metadata),this.displayedGoal.cycle=this.goal.cycle,this.displayedGoal.cyclePeriod=this.goal.cyclePeriod,this.displayedGoal.cycleRollingInterval=this.goal.cycleRollingInterval)},i.prototype.onSelectGoalCheckbox=function(){this.scorecardService.toggleSelectedGoal(this.displayedGoal.id,!1,!0)},i.prototype.onSave=function(){var n,t,r,a,s,c,u,p,v,P,x,G,Y,ue;return(0,w.__awaiter)(this,void 0,void 0,function(){var xe,Be,Je,ut,It,mt,bt,z;return(0,w.__generator)(this,function(Me){switch(Me.label){case 0:return _.isNil(this.goal.valueRollup)||_.isUndefined(this.goalCurrentValueSelection)||4===(null===(n=this.goalCurrentValueSelection)||void 0===n?void 0:n.type)?[3,2]:[4,this.scorecardService.deleteGoalValueRollup(this.displayedGoal.id,1)];case 1:Me.sent(),Me.label=2;case 2:return _.isNil(this.goal.targetRollup)||_.isUndefined(this.goalTargetValueSelection)||4===(null===(t=this.goalTargetValueSelection)||void 0===t?void 0:t.type)?[3,4]:[4,this.scorecardService.deleteGoalValueRollup(this.displayedGoal.id,2)];case 3:Me.sent(),Me.label=4;case 4:return!_.isUndefined(this.goalCurrentValueSelection)&&1!==(null===(r=this.goalCurrentValueSelection)||void 0===r?void 0:r.type)&&this.goal.valueConnection?[4,this.scorecardService.deleteGoalQueryConnection(this.displayedGoal.id,1)]:[3,6];case 5:if(!1===(null!==(a=Me.sent())&&void 0!==a&&a))return[2];Me.label=6;case 6:return!_.isUndefined(this.goalTargetValueSelection)&&1!==(null===(s=this.goalTargetValueSelection)||void 0===s?void 0:s.type)&&this.goal.targetConnection?[4,this.scorecardService.deleteGoalQueryConnection(this.displayedGoal.id,2)]:[3,8];case 7:if(!1===(null!==(c=Me.sent())&&void 0!==c&&c))return[2];Me.label=8;case 8:if(!ke.r.allGoalInputsValid(this.displayedGoal))return[2];_.isEmpty(this.selectedUsers)?(this.displayedGoal.owner="",this.displayedGoal.additionalOwners=[]):(this.displayedGoal.owner=this.selectedUsers[0].userPrincipalName||this.selectedUsers[0].emailAddress,xe=this.selectedUsers.slice(1).map(function(at){return{userPrincipalName:at.userPrincipalName||at.emailAddress}}),this.displayedGoal.additionalOwners=xe),Me.label=9;case 9:return Me.trys.push([9,31,,32]),this.scorecardService.setGoalState(this.displayedGoal.id,"Saving"),[4,this.scorecardService.saveGoal(this.displayedGoal.id,this.displayedGoal)];case 10:return Be=Me.sent(),this.displayedGoal.id=Be,Je=_.cloneDeep(this.currentValue),ut=_.cloneDeep(this.currentTarget),(this.displayedGoal.valueConnection||!_.isNil(null===(u=this.displayedGoal)||void 0===u?void 0:u.valueRollup)||!_.isUndefined(null===(p=this.goalCurrentValueSelection)||void 0===p?void 0:p.rollupType))&&(Je.value=void 0,this.values=void 0),(this.displayedGoal.targetConnection||!_.isNil(null===(v=this.displayedGoal)||void 0===v?void 0:v.targetRollup)||!_.isUndefined(null===(P=this.goalTargetValueSelection)||void 0===P?void 0:P.rollupType))&&(ut.target=void 0,this.targets=void 0),this.supportMultipleTargets||(Je.target=ut.target),_.isEmpty(this.displayedGoal.goalValues)?[4,this.scorecardService.saveGoalValue(this.displayedGoal.id,Je)]:[3,12];case 11:return Me.sent(),[3,14];case 12:return mt=ke.r.buildCurrentGoalValue(this.displayedGoal,!0),Zt.areGoalValuesEqual(Je,mt,!_.isNil(this.displayedGoal.valueConnection),this.supportMultipleTargets||!_.isNil(this.displayedGoal.targetConnection))?[3,14]:(It=Zt.diffGoalValues(Je,mt),[4,this.scorecardService.saveGoalValue(this.displayedGoal.id,It)]);case 13:Me.sent(),Me.label=14;case 14:return this.supportMultipleValuesEditing&&this.values?[4,this.scorecardService.overwriteMultipleGoalValues(this.displayedGoal.id,this.values)]:[3,16];case 15:Me.sent(),Me.label=16;case 16:return this.supportMultipleTargets?this.targets?[4,this.scorecardService.overwriteGoalTargets(this.displayedGoal.id,this.targets)]:[3,18]:[3,20];case 17:return Me.sent(),[3,20];case 18:return void 0===ut.target||(mt=ke.r.buildCurrentGoalValue(this.displayedGoal)).target===ut.target?[3,20]:[4,this.scorecardService.saveGoalValue(this.displayedGoal.id,ut)];case 19:Me.sent(),Me.label=20;case 20:return _.isUndefined(null===(x=this.goalCurrentValueSelection)||void 0===x?void 0:x.rollupType)?[3,22]:[4,this.scorecardService.upsertGoalValueRollup(this.displayedGoal.id,1,this.goalCurrentValueSelection.rollupType)];case 21:Me.sent(),Me.label=22;case 22:return _.isUndefined(null===(G=this.goalTargetValueSelection)||void 0===G?void 0:G.rollupType)?[3,24]:[4,this.scorecardService.upsertGoalValueRollup(this.displayedGoal.id,2,this.goalTargetValueSelection.rollupType)];case 23:Me.sent(),Me.label=24;case 24:return[4,this.scorecardService.updateGoalQueryConnection(this.displayedGoal.id,1,this.displayedGoal.valueConnection)];case 25:return Me.sent(),[4,this.scorecardService.updateGoalQueryConnection(this.displayedGoal.id,2,this.displayedGoal.targetConnection)];case 26:return Me.sent(),this.displayedGoal.isNew&&this.newGoalRules?[4,this.scorecardService.saveStatusRules(this.displayedGoal.id,this.newGoalRules)]:[3,28];case 27:Me.sent(),Me.label=28;case 28:return this.scorecardService.setGoalState(this.displayedGoal.id,"Consumption"),this.isSingleGoalVisual?(bt=this.scorecardService.getCurrentScorecard(),z=this,[4,this.scorecardService.getGoal(this.displayedGoal.id).pipe((0,jt.h)(function(at){return!at.currentRefreshInProgress&&!at.targetRefreshInProgress}),(0,he.q)(1)).toPromise()]):[3,30];case 29:z.displayedGoal=Me.sent(),this.scorecardHost.onUpdateScorecard(bt),this.scorecardHost.onSelectGoals([this.displayedGoal]),this.scorecardHost.showGoals(!1,bt,[this.displayedGoal]),Me.label=30;case 30:return _.isNil(null===(Y=this.goalCurrentValueSelection)||void 0===Y?void 0:Y.type)||this.telemetryService.logEvent(ni,{calculationType:this.getMetricCalculationType(this.goalCurrentValueSelection.type)}),_.isNil(null===(ue=this.goalTargetValueSelection)||void 0===ue?void 0:ue.type)||this.telemetryService.logEvent(sr,{calculationType:this.getMetricCalculationType(this.goalTargetValueSelection.type)}),[3,32];case 31:return Me.sent(),b.fF.assertFail("Could not save goal"),this.scorecardService.setGoalState(this.displayedGoal.id,"Editing"),[3,32];case 32:return[2]}})})},i.prototype.onUpdateStatusRules=function(){var n=this;this.displayedGoal.isNew?this.detailsPaneLauncher.openGoalStatusRulesPane(this.scorecardService.getGoalStatuses(this.displayedGoal),this.displayedGoal,this.newGoalRules,function(t){return(0,w.__awaiter)(n,void 0,void 0,function(){return(0,w.__generator)(this,function(r){return t=_.some(t?.rules)?t:void 0,this.newGoalRules=t,this.displayedGoal.hasStatusRules=!!t,this.updateCapabilities(),[2,t]})})}):this.detailsPaneLauncher.openGoalDetails(this.scorecardService,this.goal.id,Yr.ShowStatusRules,this.scorecardConfigurationService.getConfiguration())},i.prototype.onCancel=function(){this.scorecardService.cancelEditing(this.displayedGoal.id)},i.prototype.onStartDateChange=function(n){var t=new Date(n);_.isEmpty(n)||!_.isFinite(t.getTime())||(this.displayedGoal.startDate=t.toISOString(),this.startDateShort=n)},i.prototype.onDueDateChange=function(n){var t=new Date(n);_.isEmpty(n)||!_.isFinite(t.getTime())||(this.displayedGoal.completionDate=t.toISOString(),this.completionDateShort=n)},i.prototype.onSetCustomStatusesClick=function(){},i.prototype.onStatusChange=function(n){b.fF.assert(function(){return!!n},"status should not be null"),this.currentValue.status=n.id},i.prototype.allValid=function(){return ke.r.allGoalInputsValid(this.displayedGoal)},i.prototype.onCategoryListIdChanged=function(n){this.displayedGoal.valuesCategoryId=n,this.updateCapabilities()},i.prototype.onConnectionChanged=function(){this.updateCapabilities()},i.prototype.onTargetsChanged=function(n){this.updateCapabilities(n)},i.prototype.onValueRollupChanged=function(n){4!==n.type&&this.updateCapabilities(),this.goalCurrentValueSelection=n},i.prototype.onTargetRollupChanged=function(n){4!==n.type&&this.updateCapabilities(),this.goalTargetValueSelection=n},i.prototype.updateCapabilities=function(n){var t=this.displayedGoal;n&&(t=(0,w.__assign)((0,w.__assign)({},t),{aggregations:(0,w.__spreadArray)((0,w.__spreadArray)([],_.filter(t.aggregations,function(r){return"NumberOfTargets"!==r.type}),!0),[{type:"NumberOfTargets",value:n.length}],!1)})),this.capabilities=this.capabilityService.getCurrentGoalCapabilities(t),this.capabilities.useCategoricalValues=this.capabilities.useCategoricalValues&&!this.isSingleGoalVisual},i.prototype.getMetricCalculationType=function(n){switch(n){case 1:return Yt.Connect;case 4:return Yt.Rollup;case 0:case 2:return Yt.Manual;default:return void b.fF.assertNever(n)}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(Oi.V),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(hr),e.\u0275\u0275directiveInject(Ca.y0),e.\u0275\u0275directiveInject(ot,8),e.\u0275\u0275directiveInject(Cn,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["","goal-edit-row",""]],viewQuery:function(t,r){if(1&t&&(e.\u0275\u0275viewQuery(zp,5),e.\u0275\u0275viewQuery(nc,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.nameInput=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.valueInput=a.first)}},inputs:{color:"color",goal:"goal",indent:"indent"},features:[e.\u0275\u0275NgOnChangesFeature],attrs:qp,decls:26,vars:42,consts:[[1,"checkmark-td"],["class","select-checkmark",3,"box-checked",4,"ngIf"],["class","cell cell-indent",4,"ngFor","ngForOf"],[1,"cell","cell-left-edge","cell-right-edge"],[1,"cell-box"],[1,"color-box"],[1,"edit-row-content"],[1,"input-box-lg","goal-name"],[1,"input-title",3,"localize"],[1,"input-box"],["data-testid","goal-name-input-box","type","text",3,"maxlength","ngModel","disabled","keyup.enter","ngModelChange"],["nameInput",""],[4,"ngIf"],[1,"divider"],[1,"inner-input-box-with-rollups",3,"displayedGoal","currentValue","currentTarget","values","targets","goalStatuses","capabilities","displayedGoalChange","currentValueChange","currentTargetChange","valuesChange","targetsChange","onCategoryListIdChanged","onConnectionChanged","valueRollupsChange","targetRollupsChange","onSave"],["valueInput",""],[1,"select-checkmark"],[3,"checked","disabled","onChange"],[1,"cell","cell-indent"],[1,"input-box-md"],["localize","Owners_Lowercase",1,"input-title"],["data-testid","goal-owners-input",1,"input-box","goal-owners-input"],[3,"allowAnyGroup","maxSelectableUsers","ngModel","addUserOnBlur","inputPlaceholder","disabled","hideInput","ngModelChange"],[1,"divider","width-override"],[1,"input-box-sm"],["localize","Status",1,"input-title"],[3,"canCustomizeStatus","status","goalStatuses","pbiTooltip","pbiTooltipDisabled","isReadOnly","onSelect"],["class","input-action-txt",4,"ngIf"],[1,"input-action-txt"],["localize","Logical_Or_Operator",4,"ngIf"],[1,"link",3,"localize","click"],["localize","Logical_Or_Operator"],[1,"input-box-xs","right-padding","input-box-with-rollups"],["localize","Start_Date",1,"input-title"],["data-testid","start-date-input","type","date",3,"min","max","ngModel","disabled","ngModelChange"],[1,"input-box-xs","input-box-with-rollups"],[1,"input-title"],[1,"glyphicon","glyph-small","pbi-glyph-info","icon",3,"pbiTooltip"],["data-testid","due-date-input","type","date",3,"min","max","ngModel","disabled","ngModelChange"]],template:function(t,r){var a;(1&t&&(e.\u0275\u0275elementStart(0,"td",0),e.\u0275\u0275template(1,Bp,4,8,"div",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,Up,1,0,"td",2),e.\u0275\u0275elementStart(3,"td",3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275element(6,"div",5),e.\u0275\u0275elementStart(7,"div",6)(8,"div",7),e.\u0275\u0275element(9,"div",8),e.\u0275\u0275elementStart(10,"div",9)(11,"input",10,11),e.\u0275\u0275listener("keyup.enter",function(){return r.onSave()})("ngModelChange",function(c){return r.displayedGoal.name=c}),e.\u0275\u0275pipe(13,"localize"),e.\u0275\u0275pipe(14,"localize"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(15,jp,8,9,"ng-container",12),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275elementStart(17,"div",13),e.\u0275\u0275element(18,"div"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"goal-value-input",14,15),e.\u0275\u0275listener("displayedGoalChange",function(c){return r.displayedGoal=c})("currentValueChange",function(c){return r.currentValue=c})("currentTargetChange",function(c){return r.currentTarget=c})("valuesChange",function(c){return r.values=c})("targetsChange",function(c){return r.targets=c})("onCategoryListIdChanged",function(c){return r.onCategoryListIdChanged(c)})("onConnectionChanged",function(){return r.onConnectionChanged()})("targetsChange",function(c){return r.onTargetsChanged(c)})("valueRollupsChange",function(c){return r.onValueRollupChanged(c)})("targetRollupsChange",function(c){return r.onTargetRollupChanged(c)})("onSave",function(){return r.onSave()}),e.\u0275\u0275pipe(21,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(22,Qp,9,11,"ng-container",12),e.\u0275\u0275pipe(23,"async"),e.\u0275\u0275template(24,Xp,17,20,"ng-container",12),e.\u0275\u0275pipe(25,"async"),e.\u0275\u0275elementEnd()()()),2&t)&&(e.\u0275\u0275classProp("bulk-editing-off",!r.bulkDeleteEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.bulkDeleteEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction0(41,Yp).constructor(r.indentation)),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("selected-goal",null==(a=e.\u0275\u0275pipeBind1(4,27,r.selectedGoalIds$))?null:a[r.displayedGoal.id]),e.\u0275\u0275attribute("colspan",r.TotalNumberOfColumns-r.indentation-1),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("cell-box-with-rollups",r.capabilities.supportsRollup),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("background-color",r.color),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("localize",0===r.indentation?"MetricName":"SubmetricName"),e.\u0275\u0275advance(2),e.\u0275\u0275property("maxlength",r.GoalNameMaxLength)("ngModel",r.displayedGoal.name)("disabled",!r.capabilities.editName),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(13,29,0===r.indentation?"MetricName":"SubmetricName"))("placeholder",e.\u0275\u0275pipeBind1(14,31,"NameYourMetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(16,33,r.showOwner$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("displayedGoal",r.displayedGoal)("currentValue",r.currentValue)("currentTarget",r.currentTarget)("values",r.values)("targets",r.targets)("goalStatuses",e.\u0275\u0275pipeBind1(21,35,r.goalStatuses$))("capabilities",r.capabilities),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(23,37,r.showStatus$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(25,39,r.showDueDate$)))},dependencies:[j.NgForOf,j.NgIf,Yc,Ve.Fj,Ve.JJ,Ve.nD,Ve.On,rn.X,hc.v,qe.V,nc,Zc,j.AsyncPipe,Mt.F],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:100px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background-color:var(--scorecard-tableEditRowBackgroundColor);color:var(--scorecard-tableEditRowForegroundColor);border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell.cell-right-edge[_ngcontent-%COMP%]{border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:none;max-width:none;min-width:392px}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .inner-input-box-with-rollups[_ngcontent-%COMP%]{max-width:none}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]{width:104px;max-width:104px;min-width:auto}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .cell-box-with-rollups[_ngcontent-%COMP%]   .input-box-with-rollups[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:4px 6px}[_nghost-%COMP%]:hover   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td.bulk-editing-off[_ngcontent-%COMP%]{width:0px;max-width:0px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden;margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-semi-bold, 600);padding-top:9px;padding-bottom:4px}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{vertical-align:middle;padding:0}[_nghost-%COMP%]   .input-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{cursor:pointer}[_nghost-%COMP%]   .edit-row-content[_ngcontent-%COMP%]{display:flex;flex:1;padding-left:20px;padding-right:20px;width:1000px;min-width:1000px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);height:32px;padding:6px 8px;box-sizing:border-box;color:var(--scorecard-tableInputForegroundColor);background:var(--scorecard-tableInputBackgroundColor);border:1px solid var(--gray-110, #8A8886);border-radius:2px}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:invalid{border:2px solid var(--fluent-theme-error-dark-alt-color, #D83B01);outline-color:var(--fluent-theme-error-dark-alt-color, #D83B01)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{filter:brightness(90%)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-ms-input-placeholder, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableInputForegroundColor)}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{padding:0;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-outer-spin-button, [_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}[_nghost-%COMP%]   .input-box[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}[_nghost-%COMP%]   .right-padding[_ngcontent-%COMP%]{padding-right:8px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableEditRowForegroundColor);padding-top:4px}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--scorecard-tableRowLinkColor);cursor:pointer;text-decoration:none;background-color:transparent;border:none;padding:0}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{color:var(--fluent-theme-link-darker-color, #005A9E)}[_nghost-%COMP%]   .input-action-txt[_ngcontent-%COMP%]   .link.inactive[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-tertia-color, #A19F9D);pointer-events:none}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:1px;height:100%;background-color:var(--gray-80, #B3B0AD);margin:0 12px}[_nghost-%COMP%]   .width-override[_ngcontent-%COMP%]{width:24px}[_nghost-%COMP%]     .mat-form-field{background:var(--scorecard-tableInputBackgroundColor)!important}[_nghost-%COMP%]     emails-list-modern.disabled .mat-form-field{filter:brightness(95%)}[_nghost-%COMP%]   .goal-owners-input[_ngcontent-%COMP%]{padding-bottom:9px}[_nghost-%COMP%]   goal-value-input[_ngcontent-%COMP%]{flex:1 0 260px;max-width:400px}[_nghost-%COMP%]   .input-box-xs[_ngcontent-%COMP%]{flex:1 1 100px;max-width:140px;min-width:110px}[_nghost-%COMP%]   .input-box-sm[_ngcontent-%COMP%]{flex:1 1 100px;max-width:200px;min-width:140px}[_nghost-%COMP%]   .input-box-md[_ngcontent-%COMP%]{flex:1 1 200px;max-width:300px;min-width:130px}[_nghost-%COMP%]   .input-box-lg[_ngcontent-%COMP%]{flex:1 1 250px;min-width:150px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),i}(),Zp=["chart"],Jp=["goal-row",""];function Kp(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",5)(1,"pbi-checkbox",6),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onSelectGoalCheckbox())}),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("box-checked",null==r.scorecard||null==r.scorecard.selectedGoalIds?null:r.scorecard.selectedGoalIds[r.displayedGoal.id]),e.\u0275\u0275advance(1),e.\u0275\u0275property("checked",r.isChecked)}}function e0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",5)(1,"pbi-radio-button",7),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onSelectGoalCheckbox())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!r.canSelectGoal)("pbiTooltip",r.selectGoalDisabledTooltip?e.\u0275\u0275pipeBind1(2,5,r.selectGoalDisabledTooltip):"")("pbiTooltipDisabled",r.canSelectGoal)("isCompact",!0)("checked",r.isChecked)}}function t0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",5)(1,"pbi-checkbox",8),e.\u0275\u0275listener("onChange",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onSelectGoalCheckbox())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!r.canSelectGoal)("pbiTooltip",r.selectGoalDisabledTooltip?e.\u0275\u0275pipeBind1(2,4,r.selectGoalDisabledTooltip):"")("pbiTooltipDisabled",r.canSelectGoal)("checked",r.isChecked)}}function n0(i,n){1&i&&e.\u0275\u0275element(0,"td",9)}function r0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onShowChildrenChange())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("rotate90",!r.showChildren),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(3,6,r.showChildren?"Collapse_Expand_Submetrics_Button_Functional_Description_Hide_Submetrics":"Collapse_Expand_Submetrics_Button_Functional_Description_Show_Submetrics")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,4,r.showChildren?"Collapse_Expand_Submetrics_Button_Functional_Description_Hide_Submetrics":"Collapse_Expand_Submetrics_Button_Functional_Description_Show_Submetrics"))}}function o0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",30),e.\u0275\u0275listener("click",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onGoalRowClick(a))}),e.\u0275\u0275elementEnd()}}function a0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",21)(1,"div",22)(2,"div",23),e.\u0275\u0275listener("click",function(u){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(p.onGoalRowClick(u))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,r0,4,8,"ng-container",24),e.\u0275\u0275template(4,o0,1,0,"ng-template",null,25,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"div",26),e.\u0275\u0275element(7,"goal-name-cell",27)(8,"goal-actions-cell",28),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275reference(5),a=e.\u0275\u0275nextContext(2).$implicit,s=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("--borderColor",s.color)("max-width",s.forceColumnMinWidths?s.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",s.ListViewCellMinWidths[a.columnId],"px"),e.\u0275\u0275classProp("selected-goal",(null==s.scorecard||null==s.scorecard.selectedGoalIds?null:s.scorecard.selectedGoalIds[s.displayedGoal.id])||s.highlightRow),e.\u0275\u0275attribute("colspan",s.MAX_COLSPAN-s.indentation),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",s.color),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",s.hasVisibleChildren)("ngIfElse",r),e.\u0275\u0275advance(4),e.\u0275\u0275property("goal",s.displayedGoal)("scorecard",s.scorecard),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",s.displayedGoal)("isEditMode",e.\u0275\u0275pipeBind1(9,17,s.isEditMode$))}}function s0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",31),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onGoalRowClick(p))}),e.\u0275\u0275element(1,"goal-owners-cell",32),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)}}function l0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",33),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onGoalRowClick(p))}),e.\u0275\u0275element(1,"status-icon",34),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(1),e.\u0275\u0275property("status",null==c.currentValue?null:c.currentValue.status)("goalStatuses",c.goalStatuses)}}function c0(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-change-cell",32),2&i){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("goal",t.displayedGoal)}}function u0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",35),e.\u0275\u0275listener("click",function(P){e.\u0275\u0275restoreView(t);var x=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(x.onGoalRowClick(P))}),e.\u0275\u0275element(1,"goal-value-cell",36),e.\u0275\u0275template(2,c0,1,1,"goal-change-cell",37),e.\u0275\u0275elementEnd()}if(2&i){var u,p,r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showCurrent",!0)("showTarget",null!==(u=null==c.displayedGoal.metadata?null:c.displayedGoal.metadata.showFinalTarget)&&void 0!==u?u:!c.displayedGoal.targetConnection)("showMilestone",!(null!==(p=null==c.displayedGoal.metadata?null:c.displayedGoal.metadata.showFinalTarget)&&void 0!==p?p:!c.displayedGoal.targetConnection)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.isChangeVisible)}}function d0(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-change-cell",32),2&i){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("goal",t.displayedGoal)}}function p0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",38),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onGoalRowClick(p))}),e.\u0275\u0275element(1,"goal-value-cell",39),e.\u0275\u0275template(2,d0,1,1,"goal-change-cell",37),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showCurrent",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",c.isChangeVisible)}}function h0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",40),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onGoalRowClick(p))}),e.\u0275\u0275element(1,"goal-value-cell",41),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showTarget",!0)}}function g0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",42),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onGoalRowClick(p))}),e.\u0275\u0275element(1,"goal-value-cell",43),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)("showMilestone",!0)}}function f0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",44,45),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onGoalRowClick(p))}),e.\u0275\u0275element(2,"goal-sparkline-cell",46),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(2),e.\u0275\u0275property("goal",c.displayedGoal)("sparklineValues",c.sparklineValues)}}function m0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",47),e.\u0275\u0275listener("click",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(v.onGoalRowClick(p))}),e.\u0275\u0275element(1,"goal-due-date-cell",32),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.last,c=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("max-width",c.forceColumnMinWidths?c.ListViewCellMinWidths[a.columnId]+"px":void 0)("min-width",c.ListViewCellMinWidths[a.columnId],"px")("--borderColor",c.color),e.\u0275\u0275classProp("selected-goal",(null==c.scorecard||null==c.scorecard.selectedGoalIds?null:c.scorecard.selectedGoalIds[c.displayedGoal.id])||c.highlightRow)("cell-right-edge",s),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",c.displayedGoal)}}function v0(i,n){1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,a0,10,19,"td",12),e.\u0275\u0275template(2,s0,2,11,"td",13),e.\u0275\u0275template(3,l0,2,12,"td",14),e.\u0275\u0275template(4,u0,3,15,"td",15),e.\u0275\u0275template(5,p0,3,13,"td",16),e.\u0275\u0275template(6,h0,2,12,"td",17),e.\u0275\u0275template(7,g0,2,12,"td",18),e.\u0275\u0275template(8,f0,3,12,"td",19),e.\u0275\u0275template(9,m0,2,11,"td",20),e.\u0275\u0275elementContainerEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",1),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",2),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",3),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",7),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",8),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",9),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",4),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",5))}function C0(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0,10),e.\u0275\u0275template(1,v0,10,9,"ng-container",11),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("ngSwitch",t.columnId),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.show)}}var _0=function(){return[]},Kc=function(){function i(n,t,r,a,s,c,u,p){this.elementRef=n,this.scorecardService=t,this.featureSwitches=r,this.localizationService=a,this.scorecardConfigurationService=s,this.capabilityService=c,this.hierarchyService=u,this.goalRowService=p,this.showChildren=!0,this.highlightRow=!1,this.showChildrenChange=new e.EventEmitter,this.tabIndex=0,this.MAX_COLSPAN=W.gT.MaxSubGoals+1,this.ListViewCellMinWidths=W.gT.ListViewCellMinWidths,this.currentValue=null,this.displayedGoal=null,this.indentation=0,this.canSelectGoal=!0,b.fF.assertValue(this.hierarchyService,"No hierarchy service")}return Object.defineProperty(i.prototype,"goal",{set:function(t){var r,a,s,c,u;if(this.displayedGoal=t,this.capabilities=this.capabilityService.getCurrentGoalCapabilities(t),this.sparklineValues=Ir.buildSparklineValues(t,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations).map(function(v){return{value:v.value,timestamp:v.timestamp}}),this.sparklineOptions=Ir.getSparklineOptions(t,this.scorecardService.getGoalStatuses(t),this.scorecardConfigurationService.getConfiguration()),this.currentValue=ke.r.buildCurrentGoalValue(t),this.valueChange=ke.r.calculateValueChange(t,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.hasValueOrTarget=!_.isNil(this.currentValue.value)||!_.isNil(this.currentValue.finalTarget)||!_.isNil(this.currentValue.nextTarget),this.displayedGoal.completionDate){var p=this.localizationService.currentLanguageLocale;this.completionDate=ne.E.treatAsLocalDate(new Date(this.displayedGoal.completionDate)).toLocaleDateString(p,{day:"numeric",month:"short",year:"numeric"})}this.hasVisibleChildren=_.some(t.subGoals,function(v){return!v.isHidden}),this.canSelectGoal=null===(a=null===(r=this.capabilities.selectGoal)||void 0===r?void 0:r.enabled)||void 0===a||a,this.selectGoalDisabledTooltip=null===(s=this.capabilities.selectGoal)||void 0===s?void 0:s.disabledMessageKey,this.showDisabledGoalSelected=null===(u=null===(c=this.capabilities.selectGoal)||void 0===c?void 0:c.disabledReasons)||void 0===u?void 0:u.has("AlreadyLinked")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"indent",{set:function(t){this.indentation=ke.r.getSafeIndentation(t)},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){this.isEditMode$=this.scorecardService.isEditMode(),this.bulkDeleteEnabled=this.featureSwitches.featureSwitches.goalsBulkDelete},i.prototype.ngOnChanges=function(n){var t,r,a,s;if(n.scorecard){var c=this.scorecardConfigurationService.getConfiguration();!(null===(t=c?.scorecardDisplayOptions)||void 0===t)&&t.isMobileLayout||this.scorecard.activeGoalId===this.displayedGoal.id&&this.focus(),this.isChangeVisible=K.isColumnVisible(this.scorecard.columnSettings,10)}n.goal&&(this.formatString=n.goal.currentValue.valuesFormatString,this.isCyclePeriodLabelLocalizable=ke.r.isCyclePeriodLabelLocalizable(null===(r=this.valueChange)||void 0===r?void 0:r.period)),(n.scorecard||n.goal)&&(this.goalStatuses=this.scorecardService.getGoalStatuses(this.displayedGoal),this.categories=this.scorecardService.getGoalValueCategories(this.displayedGoal),this.isChecked=this.canSelectGoal?null===(s=null===(a=this.scorecard)||void 0===a?void 0:a.selectedGoalIds)||void 0===s?void 0:s[this.displayedGoal.id]:this.showDisabledGoalSelected)},i.prototype.ngAfterViewInit=function(){var n;this.lineChartChangeObserver=q.observeAndRemoveFocusableAttributes(null===(n=this.chart)||void 0===n?void 0:n.nativeElement)},i.prototype.ngOnDestroy=function(){var n;null===(n=this.lineChartChangeObserver)||void 0===n||n.disconnect()},i.prototype.onShowChildrenChange=function(){this.showChildrenChange&&this.showChildrenChange.emit(!this.showChildren)},i.prototype.onGoalRowClick=function(n){this.goalRowService.onRowClick(this.displayedGoal,n)},i.prototype.onSelectGoalCheckbox=function(){this.goalRowService.onCheckboxClick(this.displayedGoal)},i.prototype.focus=function(){var n;null===(n=this.elementRef)||void 0===n||n.nativeElement.focus()},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(Oi.V),e.\u0275\u0275directiveInject(hr),e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(ai))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["","goal-row",""]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(Zp,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.chart=a.first))},hostVars:1,hostBindings:function(t,r){2&t&&e.\u0275\u0275attribute("tabindex",r.tabIndex)},inputs:{color:"color",showChildren:"showChildren",scorecard:"scorecard",columnSettings:"columnSettings",highlightRow:"highlightRow",scorecardSelectionMode:"scorecardSelectionMode",goal:"goal",indent:"indent",forceColumnMinWidths:"forceColumnMinWidths"},outputs:{showChildrenChange:"showChildrenChange"},features:[e.\u0275\u0275NgOnChangesFeature],attrs:Jp,decls:6,vars:10,consts:[[1,"checkmark-td"],["class","select-checkmark",3,"box-checked",4,"ngIf"],["class","select-checkmark",4,"ngIf"],["class","cell cell-indent",4,"ngFor","ngForOf"],[3,"ngSwitch",4,"ngFor","ngForOf"],[1,"select-checkmark"],[3,"checked","onChange"],["name","selectGoalInVisual",1,"select-goal-in-visual-radio",3,"disabled","pbiTooltip","pbiTooltipDisabled","isCompact","checked","change"],[3,"disabled","pbiTooltip","pbiTooltipDisabled","checked","onChange"],[1,"cell","cell-indent"],[3,"ngSwitch"],[4,"ngIf"],["class","cell cell-left-edge",3,"selected-goal","--borderColor","max-width","min-width",4,"ngSwitchCase"],["class","cell cell-owner",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-progress-icon",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-value-combined",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-value",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-target",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-milestone",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-sparkline",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],["class","cell cell-due-date",3,"max-width","min-width","selected-goal","cell-right-edge","--borderColor","click",4,"ngSwitchCase"],[1,"cell","cell-left-edge"],[1,"cell-box"],[1,"color-box",3,"click"],[4,"ngIf","ngIfElse"],["noChildren",""],[1,"displayed-name-and-action-wrapper"],[3,"goal","scorecard"],[3,"goal","isEditMode"],[1,"collapse-box","powervisuals-glyph","chevron-down",3,"pbiTooltip","click"],[1,"collapse-box",3,"click"],[1,"cell","cell-owner",3,"click"],[3,"goal"],[1,"cell","cell-progress-icon",3,"click"],[3,"status","goalStatuses"],[1,"cell","cell-value-combined",3,"click"],[3,"goal","showCurrent","showTarget","showMilestone"],[3,"goal",4,"ngIf"],[1,"cell","cell-value",3,"click"],[3,"goal","showCurrent"],[1,"cell","cell-target",3,"click"],[3,"goal","showTarget"],[1,"cell","cell-milestone",3,"click"],[3,"goal","showMilestone"],[1,"cell","cell-sparkline",3,"click"],["chart",""],[3,"goal","sparklineValues"],[1,"cell","cell-due-date",3,"click"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"td",0),e.\u0275\u0275template(1,Kp,2,3,"div",1),e.\u0275\u0275template(2,e0,3,7,"div",2),e.\u0275\u0275template(3,t0,3,6,"div",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,n0,1,0,"td",3),e.\u0275\u0275template(5,C0,2,2,"ng-container",4)),2&t&&(e.\u0275\u0275classProp("show-checkmark",!!r.scorecardSelectionMode)("show-on-hover-only","ctrl"===r.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","ctrl"===r.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","single"===r.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","multiple"===r.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction0(9,_0).constructor(r.indentation)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.columnSettings))},dependencies:[j.NgForOf,j.NgIf,j.NgSwitch,j.NgSwitchCase,hc.v,Pc.o,qe.V,zr,Br,no,Ho,si,ao,ui,pi,j.AsyncPipe,Mt.F],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:60px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark){width:0px;max-width:0px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark)   .select-checkmark[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background:var(--scorecard-tableRowBackgroundColor);padding-right:10px;border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .rotate90[_ngcontent-%COMP%]{transform:rotate(-90deg)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .collapse-box[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:48px;min-width:48px;background-color:transparent;border:none}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]{display:flex;width:100%}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]{flex-grow:1;max-height:3.6em;line-height:1.8em}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{margin-right:10px}[_nghost-%COMP%]   .cell-owner[_ngcontent-%COMP%]{width:250px;max-width:300px}[_nghost-%COMP%]   .cell-progress-icon[_ngcontent-%COMP%]{width:220px;max-width:250px;text-align:center;padding-right:20px}[_nghost-%COMP%]   .cell-sparkline[_ngcontent-%COMP%]{width:150px;overflow:hidden}[_nghost-%COMP%]   .cell-due-date[_ngcontent-%COMP%]{width:150px}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]{width:51px;text-align:center}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]   .context-menu-icon[_ngcontent-%COMP%]{color:var(--gray-140, #484644);font-size:16px;cursor:pointer}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]{width:220px}[_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]{width:92px}[_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]{width:72px}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}[_nghost-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   goal-actions-cell[_ngcontent-%COMP%], [_nghost-%COMP%]:focus-within   goal-actions-cell[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .selected-goal.cell[_ngcontent-%COMP%]{border-top:2px solid var(--borderColor);border-bottom:2px solid var(--borderColor)}[_nghost-%COMP%]   .selected-goal.cell-right-edge[_ngcontent-%COMP%]{border-right:2px solid var(--borderColor)}[_nghost-%COMP%]   .cell-right-edge[_ngcontent-%COMP%]{width:2px;border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}  .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}"],changeDetection:0}),i}(),y0=["goal-group",""];function b0(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function w0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"td",9),e.\u0275\u0275element(1,"div"),e.\u0275\u0275elementEnd()),2&i){var t=n.index,r=e.\u0275\u0275nextContext(4);e.\u0275\u0275classProp("goal-drag-placeholder-line",r.goalDragInfo&&t>=r.goalDragInfo.destGoalDropLevel)}}var S0=function(){return[]};function M0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tr"),e.\u0275\u0275element(1,"td",6),e.\u0275\u0275template(2,w0,2,2,"td",7),e.\u0275\u0275elementStart(3,"td",8),e.\u0275\u0275element(4,"div"),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("bulk-editing-off",!t.bulkDeleteEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction0(4,S0).constructor(t.MaxSubGoals)),e.\u0275\u0275advance(1),e.\u0275\u0275attribute("colspan",50)}}function P0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"div",10),e.\u0275\u0275elementStart(2,"div",11),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(2).goal,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("background-color",r.color),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.name)}}var O0=function(n,t){return{goal:n,level:t}};function x0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"tr",3),e.\u0275\u0275listener("showChildrenChange",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext().goal,P=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(P.onShowChildrenChange(v.id,p))})("cdkDragStarted",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(v.onDragStart(p))})("cdkDragMoved",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(v.onDragMove(p))}),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275template(3,M0,5,5,"tr",4),e.\u0275\u0275template(4,P0,4,3,"div",5),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext(),a=r.goal,s=r.i,c=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275classProp("disabled","Saving"===a.state||"Deleting"===a.state)("goal-not-match",!1===a.isFilterMatch),e.\u0275\u0275property("scorecard",c.scorecard)("columnSettings",c.columnSettings)("goal",a)("indent",s)("color",c.color)("highlightRow",c.goalDragInfo&&a.id===c.goalDragInfo.destParentGoalId)("scorecardSelectionMode",c.scorecardSelectionMode)("showChildren",c.showChildren[a.id])("forceColumnMinWidths",c.forceColumnMinWidths)("cdkDragData",e.\u0275\u0275pureFunction2(16,O0,a,s))("cdkDragDisabled","Saving"===a.state||"Deleting"===a.state)("cdkDragStartDelay",c.goalDragStartDelayInMs)}}function T0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"tr",12,13),e.\u0275\u0275elementStart(3,"tr",14),e.\u0275\u0275listener("onSave",function(){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275reference(2);return e.\u0275\u0275resetView(v.onSave())})("onCancel",function(){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275reference(2);return e.\u0275\u0275resetView(v.onCancel())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275reference(2),a=e.\u0275\u0275nextContext(),s=a.goal,c=a.i,u=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275classProp("goal-not-match",!1===s.isFilterMatch),e.\u0275\u0275property("goal",s)("indent",c)("color",u.color),e.\u0275\u0275advance(2),e.\u0275\u0275property("id",s.id)("disableSave",!r.allValid())}}function E0(i,n){1&i&&e.\u0275\u0275elementContainer(0)}var I0=function(n,t){return{goal:n,i:t}};function D0(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,E0,1,0,"ng-container",0),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext(2).i;e.\u0275\u0275nextContext();var a=e.\u0275\u0275reference(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction2(2,I0,t,r+1))}}function k0(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,D0,2,5,"ng-container",2),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.isHidden)}}function F0(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,k0,2,1,"ng-container",15),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext().goal,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.subGoals)("ngForTrackBy",r.goalId)}}function V0(i,n){if(1&i&&(e.\u0275\u0275template(0,x0,5,19,"ng-container",2),e.\u0275\u0275template(1,T0,4,7,"ng-container",2),e.\u0275\u0275template(2,F0,2,2,"ng-container",2)),2&i){var t=n.goal,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",null==t.state||"Consumption"===t.state||"Saving"===t.state||"Deleting"===t.state),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Editing"===t.state),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==t.subGoals?null:t.subGoals.length)>0&&r.showChildren[t.id]&&(null==r.goalDragInfo?null:r.goalDragInfo.sourceGoalId)!==t.id)}}var A0=function(n){return{goal:n,i:0}},R0=function(n){return{dragStartThreshold:n.featureSwitches.goalsDelayDragAndDrop?W.gT.GoalDragStartThresholdInPx:W.gT.DefaultDragThresholdInPx,pointerDirectionChangeThreshold:W.gT.DefaultDragThresholdInPx}},eu=function(){function i(n){this.featureSwitches=n,this.showChildren={},this.goalDragInfo={},this.showChildrenChange=new e.EventEmitter,this.dragMoved=new e.EventEmitter,this.dragStarted=new e.EventEmitter,this.MaxSubGoals=W.gT.MaxSubGoals,this.goalDragStartDelayInMs=0}return i.prototype.ngOnInit=function(){this.bulkDeleteEnabled=this.featureSwitches.featureSwitches.goalsBulkDelete,this.goalDragStartDelayInMs=this.featureSwitches.featureSwitches.goalsDelayDragAndDrop?W.gT.GoalDragStartDelayInMs:0},i.prototype.goalId=function(n,t){return t.id},i.prototype.onShowChildrenChange=function(n,t){this.showChildrenChange.emit({id:n,value:t})},i.prototype.onDragMove=function(n){this.dragMoved.emit(n)},i.prototype.onDragStart=function(n){this.dragStarted.emit(n)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(_n.vZ))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["","goal-group",""]],inputs:{scorecard:"scorecard",columnSettings:"columnSettings",goal:"goal",color:"color",showChildren:"showChildren",goalDragInfo:"goalDragInfo",scorecardSelectionMode:"scorecardSelectionMode",forceColumnMinWidths:"forceColumnMinWidths"},outputs:{showChildrenChange:"showChildrenChange",dragMoved:"dragMoved",dragStarted:"dragStarted"},features:[e.\u0275\u0275ProvidersFeature([{provide:X.ni,useFactory:R0,deps:[_n.vZ]}])],attrs:y0,decls:3,vars:4,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],["goalWithChildrenTmpl",""],[4,"ngIf"],["goal-row","","cdkDrag","",1,"goal-row",3,"scorecard","columnSettings","goal","indent","color","highlightRow","scorecardSelectionMode","showChildren","forceColumnMinWidths","cdkDragData","cdkDragDisabled","cdkDragStartDelay","showChildrenChange","cdkDragStarted","cdkDragMoved"],[4,"cdkDragPlaceholder"],[4,"cdkDragPreview"],["colspan","1",1,"goal-placeholder-checkbox"],["class","cell cell-indent",3,"goal-drag-placeholder-line",4,"ngFor","ngForOf"],[1,"goal-drag-placeholder-line"],[1,"cell","cell-indent"],[1,"goal-drag-preview-accent"],[1,"goal-drag-preview-content"],["goal-edit-row","","data-testid","goal-edit-row",1,"goal-edit-row",3,"goal","indent","color"],["editRow",""],["goal-edit-buttons-row","",1,"button-row",3,"id","disableSave","onSave","onCancel"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,b0,1,0,"ng-container",0),e.\u0275\u0275template(1,V0,3,3,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,A0,r.goal))}},dependencies:[j.NgForOf,j.NgIf,j.NgTemplateOutlet,X.Zt,X.pV,X.Hk,Kc,On,Jc],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   .goal-edit-row[_ngcontent-%COMP%]{box-sizing:border-box;border:none;height:96px}[_nghost-%COMP%]   .goal-not-match[_ngcontent-%COMP%]{opacity:50%}[_nghost-%COMP%]   .button-row[_ngcontent-%COMP%]{height:32px;box-sizing:border-box;border:none}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:.4}.row[_ngcontent-%COMP%]{box-sizing:border-box;border:none}.goal-row[_ngcontent-%COMP%]{box-sizing:border-box;border:none;height:60px}.cdk-drag-placeholder[_ngcontent-%COMP%]{height:2px}.goal-drag-placeholder-line[_ngcontent-%COMP%]{background-color:var(--fluent-theme-black-color, #000)}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border:none;height:60px;display:flex;width:25%;opacity:.7;background-color:var(--scorecard-tableBackgroundColor);font-family:var(--scorecard-fontFamily)}.goal-drag-preview-accent[_ngcontent-%COMP%]{width:6px;border-radius:4px;margin-right:12px}.goal-drag-preview-content[_ngcontent-%COMP%]{display:inline-flex;align-items:center;min-width:fit-content;overflow:hidden;text-overflow:ellipsis}.goal-placeholder-checkbox[_ngcontent-%COMP%]{width:35px}.goal-placeholder-checkbox.bulk-editing-off[_ngcontent-%COMP%]{width:0px}"],changeDetection:0}),i}();function L0(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"visual-modern",2),e.\u0275\u0275listener("on-resize",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResize(s))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",r.visualDefinition)("useOnPushChangeDetection",!0)}}var tu=function(){function i(n,t,r,a,s,c,u,p){this.geocoder=n,this.geolocation=t,this.localizationService=r,this.moduleLoader=a,this.promiseFactory=s,this.visualPlugin=c,this.visualHostTooltipServiceFactory=u,this.changeDetector=p,this.initialVisualWidth=360,this.initialVisualHeight=172}return i.prototype.ngOnInit=function(){var n=this;this.visualPlugin.ensureBuiltInPlugins().then(function(){n.initializeVisual(),n.isLoaded=!0,n.changeDetector.detectChanges()})},i.prototype.ngOnChanges=function(n){n.values&&(this.generateDataView(),this.update())},i.prototype.initializeVisual=function(){var n=this,t=(0,lo.ED)((0,so.q)({geocoder:this.geocoder,geolocation:this.geolocation,localizationService:this.localizationService,moduleLoader:this.moduleLoader,promiseFactory:this.promiseFactory,visualHostTooltipService:this.visualHostTooltipServiceFactory.create(),getAzureMapToken:void 0,azureMapsEndpoint:void 0,geocoderIndexedDB:void 0}),function(r){r.getLocalizedString=function(a){for(var s,c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];return(s=n.localizationService).format.apply(s,(0,w.__spreadArray)([a],c||[],!1))},r.getViewMode=function(){return 0},r.locale=function(){return(0,qn.uD)()},r.promiseFactory=function(){return n.promiseFactory}});this.visualDefinition={interactivityOptions:{},type:In.L.kpi.name,allowInvalidDataView:!0,themeCollection:void 0,viewport:{height:this.initialVisualHeight,width:this.initialVisualWidth,scale:1},dataTransforms:void 0,hostServices:t,visualAdapterHostServices:{startProgressBar:_.noop,stopProgressBar:_.noop,getNextDataSegment:function(){return(0,w.__awaiter)(n,void 0,void 0,function(){return(0,w.__generator)(this,function(a){return[2,{}]})})}},stylePresetName:void 0,additionalObjectUpdates:_.noop,visualPlugin:this.visualPlugin},this.generateDataView(),this.update()},i.prototype.update=function(){this.visualDefinition&&(this.visualDefinition.data={dataView:this.dataView})},i.prototype.onResize=function(n){this.visualDefinition&&(this.visualDefinition.viewport={width:n.width,height:n.height,scale:1})},i.prototype.generateDataView=function(){var n,t,r=((n={})[Yn.iu.objectName]=((t={})[Yn.iu.propertyName]=this.formatString,t),n),a=[{displayName:this.localizationService.get("Date"),type:Dr.Ge.fromPrimitiveTypeAndCategory(6),roles:{TrendLine:!0}},{displayName:this.localizationService.get("Value"),type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Indicator:!0},index:0,objects:r},{displayName:this.localizationService.get("MetricsName_New_Singular"),type:Dr.Ge.fromPrimitiveTypeAndCategory(3),roles:{Goal:!0},index:0,objects:r}],c=(0,Et.Oh)((0,Et.fL)("Date"),"Date"),u=_.sortBy(this.values,function(v){return new Date(v.timestamp)}),p=_.findLast(u,function(v){return _.isFinite(v.target)});u=_.filter(u,function(v){return _.isFinite(v.value)}),p&&(_.some(u)?_.last(u).target=p.target:u=[p]),this.dataView={metadata:{columns:a,objects:{indicator:{showIcon:!1}}},categorical:{categories:[{source:a[0],values:_.map(u,function(v){return ne.E.treatAsLocalDate(new Date(v.timestamp))}),identity:_.map(u,function(v){return(0,Ya.TZ)((0,Et.Dg)(c,(0,Et.fL)(v.timestamp)))})}],values:(0,Za.Yv)([{source:a[1],values:_.map(u,function(v){return v.value})},{source:a[2],values:_.map(u,function(v){return v.target})}])}}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Ja.i),e.\u0275\u0275directiveInject(Si._1),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(Ka.m),e.\u0275\u0275directiveInject(Uo.t),e.\u0275\u0275directiveInject(jo.D),e.\u0275\u0275directiveInject(es.q),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-kpi"]],inputs:{values:"values",formatString:"formatString"},features:[e.\u0275\u0275ProvidersFeature((0,w.__spreadArray)([],Xa.H,!0)),e.\u0275\u0275NgOnChangesFeature],decls:2,vars:1,consts:[[1,"kpi-wrapper"],["class","kpi",3,"viewModel","useOnPushChangeDetection","on-resize",4,"ngIf"],[1,"kpi",3,"viewModel","useOnPushChangeDetection","on-resize"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,L0,1,2,"visual-modern",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isLoaded))},dependencies:[j.NgIf,co.y,qr.O],styles:["[_nghost-%COMP%]{min-height:150px;display:flex;height:100%;width:100%}.kpi-wrapper[_ngcontent-%COMP%]{flex:1;position:relative}.kpi-wrapper[_ngcontent-%COMP%]   .kpi[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}"],changeDetection:0}),i}();function G0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"table",1)(1,"tbody")(2,"tr")(3,"td",2)(4,"div",3),e.\u0275\u0275element(5,"div",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"td",5),e.\u0275\u0275element(7,"goal-value-cell",6)(8,"goal-change-cell",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"td",8),e.\u0275\u0275element(10,"goal-sparkline-cell",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"td",9),e.\u0275\u0275elementEnd()()()),2&i){var r,a,t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275styleProp("--borderColor",t.color),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("background-color",t.color),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("--borderColor",t.color),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t.goal)("showCurrent",!0)("showTarget",null!==(r=null==t.goal.metadata?null:t.goal.metadata.showFinalTarget)&&void 0!==r?r:!t.goal.targetConnection)("showMilestone",!(null!==(a=null==t.goal.metadata?null:t.goal.metadata.showFinalTarget)&&void 0!==a?a:!t.goal.targetConnection)),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t.goal),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("--borderColor",t.color),e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",t.goal),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("--borderColor",t.color)}}var N0=function(){function i(){this.color=W.gT.ColorPalette[0]}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-row-preview"]],inputs:{goal:"goal",color:"color"},decls:1,vars:1,consts:[["class","scorecard-table2","width","100%",4,"ngIf"],["width","100%",1,"scorecard-table2"],[1,"cell","cell-left-edge"],[1,"cell-box"],[1,"color-box"],["colspan","2",1,"cell","cell-value"],[3,"goal","showCurrent","showTarget","showMilestone"],[3,"goal"],["colspan","2",1,"cell","cell-sparkline"],[1,"cell","cell-value","cell-right-edge"]],template:function(t,r){1&t&&e.\u0275\u0275template(0,G0,12,16,"table",0),2&t&&e.\u0275\u0275property("ngIf",r.goal)},dependencies:[j.NgIf,zr,ui,pi],styles:[".cell[_ngcontent-%COMP%]{border:none;box-sizing:border-box}.cell-indent[_ngcontent-%COMP%]{width:36px}.cell-left-edge[_ngcontent-%COMP%]{border-top-left-radius:4px;border-bottom-left-radius:4px}.cell-right-edge[_ngcontent-%COMP%]{border-top-right-radius:4px;border-bottom-right-radius:4px}.cell-box[_ngcontent-%COMP%]{display:flex;height:100%}.cell-box[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{min-width:6px;width:6px;border-top-left-radius:4px;border-bottom-left-radius:4px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}.dialog-config[_ngcontent-%COMP%]     .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{height:60px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark){width:0px;max-width:0px}[_nghost-%COMP%]   .checkmark-td[_ngcontent-%COMP%]:not(.show-checkmark)   .select-checkmark[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{background:var(--scorecard-tableRowBackgroundColor);padding-right:10px;border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);border-bottom:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]   .rotate90[_ngcontent-%COMP%]{transform:rotate(-90deg)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .collapse-box[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:48px;min-width:48px;background-color:transparent;border:none}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]{display:flex;width:100%}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-name-cell[_ngcontent-%COMP%]{flex-grow:1;max-height:3.6em;line-height:1.8em}[_nghost-%COMP%]   .cell-box[_ngcontent-%COMP%]   .displayed-name-and-action-wrapper[_ngcontent-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{margin-right:10px}[_nghost-%COMP%]   .cell-owner[_ngcontent-%COMP%]{width:250px;max-width:300px}[_nghost-%COMP%]   .cell-progress-icon[_ngcontent-%COMP%]{width:220px;max-width:250px;text-align:center;padding-right:20px}[_nghost-%COMP%]   .cell-sparkline[_ngcontent-%COMP%]{width:150px;overflow:hidden}[_nghost-%COMP%]   .cell-due-date[_ngcontent-%COMP%]{width:150px}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]{width:51px;text-align:center}[_nghost-%COMP%]   .cell-context-menu[_ngcontent-%COMP%]   .context-menu-icon[_ngcontent-%COMP%]{color:var(--gray-140, #484644);font-size:16px;cursor:pointer}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]{width:220px}[_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]{width:92px}[_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]{width:72px}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .cell-value-combined[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-value[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-milestone[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%], [_nghost-%COMP%]   .cell-target[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}[_nghost-%COMP%]   goal-actions-cell[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]:hover   goal-actions-cell[_ngcontent-%COMP%], [_nghost-%COMP%]:focus-within   goal-actions-cell[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .selected-goal.cell[_ngcontent-%COMP%]{border-top:2px solid var(--borderColor);border-bottom:2px solid var(--borderColor)}[_nghost-%COMP%]   .selected-goal.cell-right-edge[_ngcontent-%COMP%]{border-right:2px solid var(--borderColor)}[_nghost-%COMP%]   .cell-right-edge[_ngcontent-%COMP%]{width:2px;border-right:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9)}  .simpleConfirmationDialog.updateConfirmationDialogPanel{width:580px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-actions button{border-width:1px;height:32px;padding:0;width:80px;margin-left:8px}  .simpleConfirmationDialog.updateConfirmationDialogPanel .mat-mdc-dialog-content{padding-left:8px}"],changeDetection:0}),i}(),H0={day:"numeric",month:"numeric",year:"2-digit"},nu=function(){function i(){}return i.prototype.transform=function(n,t){return new Date(n).toLocaleDateString(t,H0)},i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.\u0275\u0275definePipe({name:"formatDate",type:i,pure:!0}),i}(),z0=["chart"];function q0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",25),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",null==t.goal?null:t.goal.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",null==t.goal?null:t.goal.scorecardName," ")}}function B0(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function U0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",31)(1,"span",32),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,2,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString))}}function j0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",31)(1,"span",32),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",33),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,3,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.valueChange.period)}}function W0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",28)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,U0,4,6,"span",29),e.\u0275\u0275template(4,j0,6,7,"ng-template",null,30,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"span"),e.\u0275\u0275text(7,")"),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275reference(5),r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("(",r.valueChange.isIncrease?"\u2191":"\u2193",""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.periodLocalizeString&&!r.periodLocalizeString.endsWith("Custom"))("ngIfElse",t)}}function $0(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,B0,1,0,"ng-container",26),e.\u0275\u0275template(2,W0,8,3,"div",27),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(),r=e.\u0275\u0275reference(22);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",r),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.settings.showGoalVisualGrowth&&!(t.supportCategoricalValues&&null!=t.goal&&t.goal.valuesCategoryId)&&t.hasData&&t.valueChange)}}var Q0=function(n){return{userEmail:n}};function X0(i,n){if(1&i&&e.\u0275\u0275element(0,"user-details-host",37),2&i){var r,t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("details",e.\u0275\u0275pureFunction1(4,Q0,t.owners[0]))("photoSize",null!==(r=t.settings.goalVisualOwnerPhotoSize)&&void 0!==r?r:20)("showUserInfo",t.showOwnerName)("showTooltip",!0)}}function Y0(i,n){if(1&i&&e.\u0275\u0275element(0,"avatar-row",38),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("emails",t.owners)("numAvatarsToShow",t.OwnersToShow)}}function Z0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",34),e.\u0275\u0275template(1,X0,1,6,"user-details-host",35),e.\u0275\u0275template(2,Y0,1,2,"ng-template",null,36,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(3),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1===r.owners.length)("ngIfElse",t)}}function J0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"h1",39),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",null==t.goal?null:t.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",null==t.goal?null:t.goal.name," ")}}function K0(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",41)(1,"div",42,43),e.\u0275\u0275element(3,"goal-history-chart",44),e.\u0275\u0275elementEnd()()),2&i){var r,t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("values",t.goal.goalValues)("formatString",t.goal.valuesFormatString)("color",null!==(r=null==t.settings.theme?null:t.settings.theme.goalVisualCurrentLineColor)&&void 0!==r?r:t.statusColor)("targetLineColor",null==t.settings.theme?null:t.settings.theme.goalVisualTargetLineColor)("showGoalTargets",t.supportMultipleTargets&&t.settings.showGoalVisualTargetLine)("legend",t.supportMultipleTargets&&t.settings.showGoalVisualLegends?"Visible":"None")("showZoom",!1)("shadeCurrentArea",t.shadeCurrentArea)("type","ComboChart")("axesOptions",t.axesOptions)}}function eh(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,K0,4,10,"section",40),e.\u0275\u0275elementContainerEnd()),2&i){var r,t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null===(r=t.settings.showVisualization)||void 0===r||r)}}function th(i,n){if(1&i&&e.\u0275\u0275element(0,"status-icon",45),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("status",null==t.currentValue?null:t.currentValue.status)("goalStatuses",t.goal.goalStatuses)}}function nh(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"label",46),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatDate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(4,1,t.goal.completionDate,t.locale),"")}}function rh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",50),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.goal.notesCount," ")}}function ih(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",47),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.openNotes())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"tri-svg-icon",48),e.\u0275\u0275template(3,rh,2,1,"span",49),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,2,"Notes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.goal.notesCount>0)}}function oh(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function ah(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",51),e.\u0275\u0275template(1,oh,1,0,"ng-container",26),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(22);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)}}function sh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",52)(1,"div",53)(2,"div",54),e.\u0275\u0275pipe(3,"formatValue"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"formatValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",55),e.\u0275\u0275pipe(7,"formatValue"),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"formatValue"),e.\u0275\u0275elementEnd()()()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(3,4,t.currentValue.value,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(5,8,t.currentValue.value,t.goal.valuesFormatString)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(7,11,t.currentValue.target,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" /",e.\u0275\u0275pipeBind2(9,15,t.currentValue.target,t.goal.valuesFormatString)," ")}}function lh(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",21),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.onEdit())}),e.\u0275\u0275element(2,"tri-svg-icon",22)(3,"span",56),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("name","edit_20_regular"))}var Ul=function(){function i(n,t,r,a,s){this.appSettings=n,this.featureSwitches=t,this.localizationService=r,this.cd=a,this.scorecardHost=s,this.currentValue=null,this.showGrowth=!1,this.showOwnerName=!1,this.shadeCurrentArea=!0,this.owners=[],this.OwnersToShow=4,this.supportCategoricalValues=this.featureSwitches.featureSwitches.goalsCategoricalValues,this.supportMultipleTargets=this.featureSwitches.featureSwitches.powerBIGoalsMultipleTargets}return Object.defineProperty(i.prototype,"scorecardRoutePath",{get:function(){return"/groups/".concat(this.goal.groupId||"me","/scorecards/").concat(this.goal.scorecardId).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"inServiceUrl",{get:function(){return"".concat(this.appSettings.baseUrl).concat(this.scorecardRoutePath,"?goal=").concat(this.goal.id)},enumerable:!1,configurable:!0}),i.prototype.ngOnInit=function(){var t,r,a,n=this;b.fF.assertValue(this.goal,"Missing goal"),this.setDisplayedVals(),this.locale=this.localizationService.currentLanguageLocale,this.supportCategoricalValues&&null!==(t=this.goal)&&void 0!==t&&t.valuesCategoryId&&(this.categories=null!==(a=null===(r=_.find(this.goal.goalValueCategories,function(s){return s.id===n.goal.valuesCategoryId}))||void 0===r?void 0:r.categories)&&void 0!==a?a:[])},i.prototype.ngOnChanges=function(n){var t,r,a,s,c,u,p,v;if(n.goal&&(this.setDisplayedVals(),this.supportCategoricalValues&&n.goal.currentValue.valuesCategoryId&&(this.categories=null!==(a=null===(r=_.find(this.goal.goalValueCategories,function(x){return x.id===n.goal.currentValue.valuesCategoryId}))||void 0===r?void 0:r.categories)&&void 0!==a?a:[]),this.owners=this.goal.owner?[this.goal.owner]:[],this.goal.additionalOwners&&(t=this.owners).push.apply(t,this.goal.additionalOwners.map(function(x){return x.userPrincipalName}))),n.settings){this.cd.markForCheck();var P=n.settings.currentValue;this.isEditMode=!P?.disableEdit,this.axesOptions={xAxis:{show:null===(s=P?.showGoalVisualXAxis)||void 0===s||s,fontProperties:null===(c=P?.theme)||void 0===c?void 0:c.goalVisualXAxis},yAxis:{show:null===(u=P?.showGoalVisualYAxis)||void 0===u||u,fontProperties:null===(p=P?.theme)||void 0===p?void 0:p.goalVisualYAxis}},this.shadeCurrentArea=null===(v=P?.currentAreaShaded)||void 0===v||v}},i.prototype.ngAfterViewInit=function(){var n;this.lineChartChangeObserver=q.observeAndRemoveFocusableAttributes(null===(n=this.chart)||void 0===n?void 0:n.nativeElement)},i.prototype.ngOnDestroy=function(){var n;null===(n=this.lineChartChangeObserver)||void 0===n||n.disconnect()},i.prototype.openNotes=function(){this.scorecardHost.openNotes(this.goal)},i.prototype.onEdit=function(){this.scorecardHost.editGoal()},i.prototype.onOpenInService=function(){this.scorecardHost.openLink(this.inServiceUrl)},i.prototype.setDisplayedVals=function(){var n;this.currentValue=ke.r.buildCurrentGoalValue(this.goal),this.valueChange=ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.periodLocalizeString=_.isNil(null===(n=this.valueChange)||void 0===n?void 0:n.period)?void 0:"PercentGrowth_"+this.getPeriodSuffix(this.valueChange.period);var r=N.p.getGoalStatus(this.currentValue.status,this.goal.goalStatuses);this.statusColor=N.p.getGoalSparklineColor(r.color),this.sparklineValues=Ir.buildSparklineValues(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.hasData=_.some(this.sparklineValues)},i.prototype.getPeriodSuffix=function(n){switch(n){case"Period_DoD":case"Period_MoM":case"Period_QoQ":case"Period_WoW":case"Period_YoY":return n;default:return"Period_Custom"}},i.componentId="GoalTileComponentId",i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Go.de),e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(ot,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goal-tile"]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(z0,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.chart=a.first))},inputs:{goal:"goal",settings:"settings"},features:[e.\u0275\u0275NgOnChangesFeature],decls:32,vars:17,consts:[[1,"goal-tile"],[1,"header-container"],["class","scorecard-name",3,"pbiTooltip",4,"ngIf"],[1,"details"],[1,"value-and-growth"],[4,"ngIf"],["class","owners",4,"ngIf"],["class","goal-name",3,"pbiTooltip",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"footer-container"],[1,"status-and-date"],[3,"status","goalStatuses",4,"ngIf"],[1,"target-date"],[1,"notes-and-menu"],["mat-icon-button","",3,"pbiTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["fontIcon","pbi-glyph-more",1,"glyph-small"],["noChart",""],["valueAndTarget",""],[1,"context-menu-dropdown",3,"xPosition"],["contextMenu","matMenu"],["mat-menu-item","",1,"goal-tile-context-menu-item",3,"click"],["tri-svg-icon-16","",3,"name"],["localize","OpenScorecard"],["localize","OpenNotes"],[1,"scorecard-name",3,"pbiTooltip"],[4,"ngTemplateOutlet"],["class","growth",4,"ngIf"],[1,"growth"],["class","period","localize-fragments","",3,"localize",4,"ngIf","ngIfElse"],["customPeriod",""],["localize-fragments","",1,"period",3,"localize"],["fragment-index","0"],["fragment-index","1"],[1,"owners"],[3,"details","photoSize","showUserInfo","showTooltip",4,"ngIf","ngIfElse"],["hasMultipleOwners",""],[3,"details","photoSize","showUserInfo","showTooltip"],[3,"emails","numAvatarsToShow"],[1,"goal-name",3,"pbiTooltip"],["class","visual-container",4,"ngIf"],[1,"visual-container"],[1,"visual"],["chart",""],[3,"values","formatString","color","targetLineColor","showGoalTargets","legend","showZoom","shadeCurrentArea","type","axesOptions"],[3,"status","goalStatuses"],["localize","Due"],["mat-icon-button","",3,"pbiTooltip","click"],["tri-svg-icon-16","","name","comment_16_regular",1,"tri-svg"],["class","notes-count",4,"ngIf"],[1,"notes-count"],[1,"no-chart"],[1,"value-wrapper"],[1,"value-target"],[1,"value",3,"pbiTooltip"],[1,"target",3,"pbiTooltip"],["localize","Edit_Metric"]],template:function(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"section",0)(1,"section",1),e.\u0275\u0275template(2,q0,2,2,"div",2),e.\u0275\u0275elementStart(3,"div",3)(4,"div",4),e.\u0275\u0275template(5,$0,3,2,"ng-container",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,Z0,4,2,"div",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,J0,2,2,"h1",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,eh,2,1,"ng-container",8),e.\u0275\u0275elementStart(9,"section",9)(10,"div",10),e.\u0275\u0275template(11,th,1,2,"status-icon",11),e.\u0275\u0275elementStart(12,"div",12),e.\u0275\u0275template(13,nh,5,4,"ng-container",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"div",13),e.\u0275\u0275template(15,ih,4,4,"button",14),e.\u0275\u0275elementStart(16,"button",15),e.\u0275\u0275pipe(17,"localize"),e.\u0275\u0275element(18,"mat-icon",16),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(19,ah,2,1,"ng-template",null,17,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(21,sh,10,18,"ng-template",null,18,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"mat-menu",19,20),e.\u0275\u0275template(25,lh,4,1,"ng-container",5),e.\u0275\u0275elementStart(26,"button",21),e.\u0275\u0275listener("click",function(){return r.onOpenInService()}),e.\u0275\u0275element(27,"tri-svg-icon",22)(28,"span",23),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"button",21),e.\u0275\u0275listener("click",function(){return r.openNotes()}),e.\u0275\u0275element(30,"tri-svg-icon",22)(31,"span",24),e.\u0275\u0275elementEnd()()),2&t){var a=e.\u0275\u0275reference(20),s=e.\u0275\u0275reference(24);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.settings.showGoalVisualScorecardName),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.hasData),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.settings.showGoalVisualOwner&&r.owners.length>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.settings.showGoalVisualGoalName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.hasData)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.settings.showGoalVisualStatus),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.settings.showGoalVisualDueDate&&(null==r.goal?null:r.goal.completionDate)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.settings.showGoalVisualNotes),e.\u0275\u0275advance(1),e.\u0275\u0275property("matMenuTriggerFor",s),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(17,15,"HotkeyDialog_Open_Context_Menu")),e.\u0275\u0275advance(7),e.\u0275\u0275property("xPosition","after"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.isEditMode),e.\u0275\u0275advance(2),e.\u0275\u0275property("name","open_20_regular"),e.\u0275\u0275advance(3),e.\u0275\u0275property("name","note_20_regular")}},dependencies:[j.NgIf,j.NgTemplateOutlet,rn.X,Xt.Hw,Vt.W0,Vt.tN,Vt.D8,qe.V,gr.M,te.s,Ee,uo,Br,Mt.F,Xr.D,Er.c,nu],styles:['.goal-tile[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;width:100%;height:100%;color:var(--fluent-theme-neutral-primary-alt-color, #3B3A39);background-color:var(--scorecard-goalVisualBackgroundColor);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);white-space:nowrap}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:4px 7px;color:var(--fluent-theme-black-color, #000)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .scorecard-name[_ngcontent-%COMP%]{margin:0 0 4px;color:var(--scorecard-goalVisualScorecardName-color);font-size:var(--scorecard-goalVisualScorecardName-size);font-family:var(--scorecard-goalVisualScorecardName-family);font-weight:var(--scorecard-goalVisualScorecardName-weight);font-style:var(--scorecard-goalVisualScorecardName-style);text-decoration:var(--scorecard-goalVisualScorecardName-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--scorecard-goalVisualCurrentValue-color);font-size:var(--scorecard-goalVisualCurrentValue-size);font-family:var(--scorecard-goalVisualCurrentValue-family);font-weight:var(--scorecard-goalVisualCurrentValue-weight);font-style:var(--scorecard-goalVisualCurrentValue-style);text-decoration:var(--scorecard-goalVisualCurrentValue-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{color:var(--scorecard-goalVisualTargetValue-color);font-size:var(--scorecard-goalVisualTargetValue-size);font-family:var(--scorecard-goalVisualTargetValue-family);font-weight:var(--scorecard-goalVisualTargetValue-weight);font-style:var(--scorecard-goalVisualTargetValue-style);text-decoration:var(--scorecard-goalVisualTargetValue-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:6px;color:var(--scorecard-goalVisualGrowth-color);font-size:var(--scorecard-goalVisualGrowth-size);font-family:var(--scorecard-goalVisualGrowth-family);font-weight:var(--scorecard-goalVisualGrowth-weight);font-style:var(--scorecard-goalVisualGrowth-style);text-decoration:var(--scorecard-goalVisualGrowth-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:8px;width:8px}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value-and-growth[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .period[_ngcontent-%COMP%]{padding-left:4px}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .owners[_ngcontent-%COMP%]{display:flex;align-items:center}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .owners[_ngcontent-%COMP%]     .user-info{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .owners[_ngcontent-%COMP%]     .user-image{margin:0}.goal-tile[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .goal-name[_ngcontent-%COMP%]{margin:4px 0;color:var(--scorecard-goalVisualGoalName-color);font-size:var(--scorecard-goalVisualGoalName-size);font-family:var(--scorecard-goalVisualGoalName-family);font-weight:var(--scorecard-goalVisualGoalName-weight);font-style:var(--scorecard-goalVisualGoalName-style);text-decoration:var(--scorecard-goalVisualGoalName-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .visual-container[_ngcontent-%COMP%]{display:flex;flex-grow:1;padding:4px 7px}.goal-tile[_ngcontent-%COMP%]   .visual-container[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]{flex:1;display:flex}.goal-tile[_ngcontent-%COMP%]   .visual-container[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]   goal-history-chart[_ngcontent-%COMP%]{width:100%;flex:1}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]{display:flex;flex-grow:1;padding:4px 7px}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{margin:auto}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:34px}.goal-tile[_ngcontent-%COMP%]   .no-chart[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:22px}.goal-tile[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{display:flex;align-items:baseline}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:4px 7px}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%], .goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .notes-and-menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;color:var(--scorecard-goalVisualDueDate-color);font-size:var(--scorecard-goalVisualDueDate-size);font-family:var(--scorecard-goalVisualDueDate-family);font-weight:var(--scorecard-goalVisualDueDate-weight);font-style:var(--scorecard-goalVisualDueDate-style);text-decoration:var(--scorecard-goalVisualDueDate-textDecoration)}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]{padding-right:10px}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   .status-and-date[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]     .status{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;height:14px;line-height:14px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400)}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;padding:0;border:none;background:none;height:100%;width:32px}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:before{vertical-align:middle}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{color:var(--scorecard-goalVisualNotes-color);font-size:var(--scorecard-goalVisualNotes-size)}.goal-tile[_ngcontent-%COMP%]   .footer-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .notes-count[_ngcontent-%COMP%]{position:absolute;font-size:9px;font-weight:600;top:-1px;right:3px;border-radius:30px;padding:1px 4px;background:var(--fluent-theme-primary-color, #F2C811);color:var(--text-primary-content-color-hc, #000)}  .context-menu-dropdown{min-height:unset}  .context-menu-dropdown .mat-menu-content{padding:4px!important}  .context-menu-dropdown .mat-menu-content .goal-tile-context-menu-item{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;padding:0 8px!important;max-height:32px}  .context-menu-dropdown .mat-menu-content .goal-tile-context-menu-item tri-svg-icon{margin-right:4px}'],changeDetection:0}),i}();function ch(i,n){1&i&&e.\u0275\u0275elementContainer(0)}var ru=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["goals-tooltip"]],inputs:{args:"args"},decls:2,vars:2,consts:[["role","tooltip",1,"pbi-goals-tooltip-content","themeableElement",3,"id"],[4,"ngTemplateOutlet"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,ch,1,0,"ng-container",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("id",r.args.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",r.args.templateRef))},dependencies:[j.NgTemplateOutlet],styles:["@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0}to{opacity:1}}[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;overflow:auto;border-radius:2px;border:1px solid var(--scorecard-backgroundColor);background-color:var(--scorecard-backgroundColor);color:var(--scorecard-neutralPrimaryColor);box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 8px 16px var(--colorNeutralShadowKey);animation:_ngcontent-%COMP%_fade-in .15s ease;font-size:var(--sm-font-size, 12px);word-break:break-word}.pbi-goals-tooltip-content[_ngcontent-%COMP%]{background-color:var(--scorecard-backgroundColor);z-index:1;padding:7px}"],changeDetection:0}),i}(),jl=function(){function i(n,t,r,a){this.sideFlyoutService=n,this.scorecardService=t,this.hierarchyService=r,this.telemetryService=a,this._showHierarchiesPane$=new pe.X(!1),this._showHeatmapConfigurationPane$=new pe.X(!1),this._showHeatmapDisplaySettingsPane$=new pe.X(!1),this.showHierarchiesPane$=this._showHierarchiesPane$.asObservable(),this.showHeatmapConfigurationPane$=this._showHeatmapConfigurationPane$.asObservable(),this.showHeatmapDisplaySettingsPane$=this._showHeatmapDisplaySettingsPane$.asObservable()}return i.prototype.openHierarchiesBuilder=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,a,s=this;return(0,w.__generator)(this,function(c){switch(c.label){case 0:return this.telemetryService.logEvent(Ke,{entryPoint:n}),t=new ir.t(1),this.sideFlyoutService.show({componentManifest:{componentId:"HierarchyBuilderPaneComponentId",modulePath:"@powerbi/GoalsHierarchy/goals-hierarchy.module#GoalsHierarchyModule",inputArgs:{scorecard$:this.scorecardService.getScorecard(),close:function(p){s.sideFlyoutService.hide(),t.next(p),t.complete()},saveQueryHierarchyAsUser:function(p){s.scorecardService.updateScorecard({queryHierarchyAsUser:p})}}},paneClass:"hierarchy-builder"}),[4,t.toPromise()];case 1:return c.sent()&&(a=this.scorecardService.getCurrentScorecard(),this.scorecardService.setActiveHierarchy(void 0),this.hierarchyService.loadHierarchies(a.groupId,a.id,!1)),[2]}})})},i.prototype.showHierarchiesPane=function(){this._showHierarchiesPane$.next(!0)},i.prototype.hideHierarchiesPane=function(){this._showHierarchiesPane$.next(!1)},i.prototype.showHeatmapConfigurationPane=function(){this.hideHeatmapDisplaySettingsPane(),this._showHeatmapConfigurationPane$.next(!0)},i.prototype.hideHeatmapConfigurationPane=function(){this._showHeatmapConfigurationPane$.next(!1)},i.prototype.showHeatmapDisplaySettingsPane=function(){this.hideHeatmapConfigurationPane(),this._showHeatmapDisplaySettingsPane$.next(!0)},i.prototype.hideHeatmapDisplaySettingsPane=function(){this._showHeatmapDisplaySettingsPane$.next(!1)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Mo.p),e.\u0275\u0275inject(et),e.\u0275\u0275inject(Nn),e.\u0275\u0275inject(eo.y0))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),iu=function(){function i(n,t,r){this.goalsHttpService=n,this.scorecardService=t,this.goalsErrorService=r,this._viewsById$=new pe.X(null),this._isSaving$=new pe.X(!1),this._isLoading$=new pe.X(!1),this.isLoading$=this._isLoading$,this.isSaving$=this._isSaving$,this.views$=this._viewsById$.pipe((0,jt.h)(function(a){return!!a}),(0,I.x)(),(0,je.U)(function(a){return _.values(a)}),(0,Gn.d)({bufferSize:1,refCount:!0}))}return Object.defineProperty(i.prototype,"defaultListView",{get:function(){return _.find(this._viewsById$.value,function(t){return t.isDefault&&"List"===t.viewType})},enumerable:!1,configurable:!0}),i.prototype.getDefaultView=function(n){return this.views$.pipe((0,je.U)(function(t){return _.find(t,function(r){return r.isDefault&&r.viewType===n})}))},i.prototype.loadViews=function(n){return void 0===n&&(n=!1),(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:if(t=this.scorecardService.getCurrentScorecard(),!n&&null!==this._viewsById$.value||this._isLoading$.value)return[2];this._isLoading$.next(!0),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.goalsHttpService.getScorecardViews(t.groupId,t.id).toPromise()];case 2:return r=a.sent(),this._viewsById$.next(_.keyBy(r,function(s){return s.id})),[3,4];case 3:return this._isLoading$.next(!1),[7];case 4:return[2]}})})},i.prototype.saveView=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return t=this.scorecardService.getCurrentScorecard(),[4,this.loadViews()];case 1:a.sent(),this._isSaving$.next(!0),a.label=2;case 2:return a.trys.push([2,8,9,10]),this._viewsById$.value[n.id]?[4,this.goalsHttpService.updateScorecardView(t.groupId,t.id,n).toPromise()]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,this.goalsHttpService.createScorecardView(t.groupId,t.id,n).toPromise()];case 5:a.sent(),a.label=6;case 6:return[4,this.loadViews(!0)];case 7:return a.sent(),[3,10];case 8:return r=a.sent(),this.goalsErrorService.showUserError(r,"SaveViewError"),[3,10];case 9:return this._isSaving$.next(!1),[7];case 10:return[2]}})})},i.prototype.clearCache=function(){this._viewsById$.next(null)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Ye),e.\u0275\u0275inject(et),e.\u0275\u0275inject(Lo))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),gc=function(){function i(n,t,r,a,s){var c=this;this.scorecardService=n,this.hierarchyService=t,this.localizationService=r,this.viewsService=a,this.goalsHttpService=s,this._goalsByHierarchyItemId$=new pe.X({}),this._selectedHierarchyItems$=new pe.X([]),this._displaySettings$=new pe.X({}),this.onDestroy$=new Re.xQ,this._isLoadingView$=new pe.X(!1),this.hierarchyService.hierarchyItems$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(u){var p;if(c._selectedHierarchyItems$.value.length>1){for(var v=[],P=(0,w.__assign)({},c._goalsByHierarchyItemId$.value),x=0,G=c._selectedHierarchyItems$.value;x<G.length;x++){var Y=G[x];if(Y.id){var Se=null===(p=ho([Ii(Y)],u))||void 0===p?void 0:p[0];if(Se?.id&&Se.id!==Y.id){v.push(Se),P[Se.id]=P[Y.id],delete P[Y.id];continue}}v.push(Y)}c._selectedHierarchyItems$.next(v),c._goalsByHierarchyItemId$.next(P)}}),this.totalItem={id:void 0,value:this.localizationService.get("Visual_Totals"),parent:void 0,parentHierarchyItemId:void 0,level:0},this._hasViewChanges$=(0,Mn.aj)([this.selectedHierarchyItems$,this.viewsService.getDefaultView("Heatmap")]).pipe((0,je.U)(function(u){var p=u[0],v=u[1];return v?!_.isEqual(di(p),v.heatmapViewDetails.hierarchyItemPaths):_.size(p)>1}),(0,Gn.d)({bufferSize:1,refCount:!0})),this._hasSettingsChanges$=(0,Mn.aj)([this._displaySettings$,this.viewsService.getDefaultView("Heatmap")]).pipe((0,je.U)(function(u){var p,v=u[0],P=u[1],x=null!==(p=P?.heatmapViewDetails.heatmapDisplaySettings)&&void 0!==p?p:W.rl;return!_.isEqual(v,x)}),(0,Gn.d)({bufferSize:1,refCount:!0}))}return i.prototype.ngOnDestroy=function(){this.onDestroy$.next(!0),this.onDestroy$.complete()},Object.defineProperty(i.prototype,"goalsByHierarchyItemId$",{get:function(){return this._goalsByHierarchyItemId$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectedHierarchyItems$",{get:function(){return this._selectedHierarchyItems$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectedHierarchyItems",{get:function(){return this._selectedHierarchyItems$.value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"displaySettings$",{get:function(){return this._displaySettings$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasViewChanges$",{get:function(){return this._hasViewChanges$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasSettingsChanges$",{get:function(){return this._hasSettingsChanges$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isSaving$",{get:function(){return this.viewsService.isSaving$},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isLoading$",{get:function(){return this._isLoadingView$},enumerable:!1,configurable:!0}),i.prototype.addHierarchyItem=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t;return(0,w.__generator)(this,function(r){switch(r.label){case 0:return t=_.uniqBy((0,w.__spreadArray)((0,w.__spreadArray)([],this._selectedHierarchyItems$.value,!0),[n],!1),function(a){return a.id}),this._selectedHierarchyItems$.next(t),[4,this.loadGoalsForHierarchyItem(n)];case 1:return r.sent(),[2]}})})},i.prototype.removeHierarchyItem=function(n){n.id?this._selectedHierarchyItems$.next(_.filter(this._selectedHierarchyItems$.value,function(t){return t.id!==n.id})):b.fF.assertFail("Cannot remove totals")},i.prototype.setHierarchyItems=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a,s;return(0,w.__generator)(this,function(u){switch(u.label){case 0:for(t=_.uniqBy((0,w.__spreadArray)([this.totalItem],n,!0),function(p){return p.id}),this._selectedHierarchyItems$.next(t),r=[],a=0,s=t;a<s.length;a++)r.push(this.loadGoalsForHierarchyItem(s[a]));return[4,Promise.all(r)];case 1:return u.sent(),[2]}})})},i.prototype.reset=function(n){void 0===n&&(n=!1),this._selectedHierarchyItems$.next([this.totalItem]),n&&this.clearCache()},i.prototype.refreshAll=function(){for(var n=0,t=this._selectedHierarchyItems$.value;n<t.length;n++)this.loadGoalsForHierarchyItem(t[n],!0)},i.prototype.clearCache=function(){this._goalsByHierarchyItemId$.next({})},i.prototype.loadDefaultView=function(n,t,r){var a,s;return(0,w.__awaiter)(this,void 0,void 0,function(){var c,u,p;return(0,w.__generator)(this,function(v){switch(v.label){case 0:if(!n&&!t)return b.fF.assertFail("loadDefaultView called without restoring items or settings"),[2];this._isLoadingView$.next(!0),v.label=1;case 1:return v.trys.push([1,,8,9]),[4,this.viewsService.loadViews(!1)];case 2:return v.sent(),[4,this.viewsService.getDefaultView("Heatmap").pipe((0,he.q)(1)).toPromise()];case 3:return c=v.sent(),t&&(u=null===(a=c?.heatmapViewDetails)||void 0===a?void 0:a.heatmapDisplaySettings,this.setDisplaySettings((0,w.__assign)((0,w.__assign)({},W.rl),u))),n?(p=void 0,c?[4,this.hierarchyService.getHierarchyItemsForPath(null===(s=c?.heatmapViewDetails)||void 0===s?void 0:s.hierarchyItemPaths).pipe((0,he.q)(1)).toPromise()]:[3,5]):[3,7];case 4:p=v.sent(),v.label=5;case 5:return[4,this.setHierarchyItems(p=p||r||[])];case 6:v.sent(),v.label=7;case 7:return[3,9];case 8:return this._isLoadingView$.next(!1),[7];case 9:return[2]}})})},i.prototype.saveView=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){var r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return n||t?[4,this.viewsService.getDefaultView("Heatmap").pipe((0,he.q)(1)).toPromise()]:(b.fF.assertFail("saveView called without saving items or settings"),[2]);case 1:return r=a.sent(),r=_.cloneDeep(r)||{isDefault:!0,name:"",viewType:"Heatmap",id:void 0,scorecardId:this.scorecardId,heatmapViewDetails:{heatmapDisplaySettings:void 0,hierarchyItemPaths:void 0}},n&&(r.heatmapViewDetails.hierarchyItemPaths=di(this.selectedHierarchyItems)),t&&(r.heatmapViewDetails.heatmapDisplaySettings=this._displaySettings$.value),[4,this.viewsService.saveView(r)];case 2:return a.sent(),[2]}})})},i.prototype.loadGoalsForHierarchyItem=function(n,t){return void 0===t&&(t=!1),(0,w.__awaiter)(this,void 0,void 0,function(){var r,a,s,c=this;return(0,w.__generator)(this,function(u){switch(u.label){case 0:return r=this.scorecardService.getCurrentScorecard(),b.fF.assertValue(r,"scorecard not loaded"),this.scorecardId!==r.id&&(this._goalsByHierarchyItemId$.next({}),this.scorecardId=r.id,t=!0),!t&&this._goalsByHierarchyItemId$.value[n?.id]?[2]:(this._goalsByHierarchyItemId$.next((0,w.__assign)((0,w.__assign)({},this._goalsByHierarchyItemId$.value),((s={})[n?.id]={},s))),a=n?.id?di([n]):void 0,[4,this.goalsHttpService.getScorecard(r.groupId,r.id,!0,a).toPromise().then(function(p){var v,P=c.checkGoalsConnectedToHierarchy(a,p.goals),x=_.keyBy(P,"id");c._goalsByHierarchyItemId$.next((0,w.__assign)((0,w.__assign)({},c._goalsByHierarchyItemId$.value),((v={})[n?.id]=x,v)))}).catch(function(p){var v;b.fF.assertFail(p),c._goalsByHierarchyItemId$.next((0,w.__assign)((0,w.__assign)({},c._goalsByHierarchyItemId$.value),((v={})[n?.id]=null,v)))})]);case 1:return u.sent(),[2]}})})},i.prototype.setDisplaySettings=function(n){this._displaySettings$.next(n)},i.prototype.checkGoalsConnectedToHierarchy=function(n,t){var r=this;return _.map(t,function(a){var s,c,u=!_.isEmpty(n),p=u&&a.valueConnection&&!r.hierarchyService.isDatasetMappedToHierarchyPath(null===(s=a.valueConnection)||void 0===s?void 0:s.datasetId,n),v=u&&a.targetConnection&&!r.hierarchyService.isDatasetMappedToHierarchyPath(null===(c=a.targetConnection)||void 0===c?void 0:c.datasetId,n);return(0,w.__assign)((0,w.__assign)({},a),{isCurrentValueNotConnectedToHierarchy:p,isTargetValueNotConnectedToHierarchy:v})})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(et),e.\u0275\u0275inject(Nn),e.\u0275\u0275inject(ft.o),e.\u0275\u0275inject(iu),e.\u0275\u0275inject(Ye))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),ou=M(18460);function uh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("title",t.valueTooltip),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind3(2,2,t.currentValue.value,t.categories,t.formatString)," ")}}function dh(i,n){if(1&i&&e.\u0275\u0275element(0,"goal-change-cell",10),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("goal",t.goal)("arrowSize",t.changeArrowSize)("nilDisplayString","\u2014")}}function ph(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,uh,3,6,"div",7),e.\u0275\u0275template(2,dh,1,3,"goal-change-cell",8),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.displaySettings.showValueChange),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displaySettings.showValueChange)}}function hh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",11)(1,"span",12),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("targetOnly",!t.displaySettings.showCurrentValue),e.\u0275\u0275property("title",t.targetTooltip),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.displaySettings.showValueChange?"|":"/"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind3(4,5,t.currentValue.target,t.categories,t.formatString)," ")}}function gh(i,n){if(1&i&&e.\u0275\u0275element(0,"status-icon",13,14),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("status",null==t.currentValue?null:t.currentValue.status)("goalStatuses",t.goalStatuses)}}function fh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",2)(1,"div",3),e.\u0275\u0275template(2,ph,3,2,"ng-container",4),e.\u0275\u0275template(3,hh,5,9,"div",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,gh,2,2,"status-icon",6),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("background",t.backgroundColor),e.\u0275\u0275classProp("isSelected",t.isSelected),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.displaySettings.showCurrentValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displaySettings.showTargetValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displaySettings.showStatus)}}function mh(i,n){1&i&&e.\u0275\u0275element(0,"pbi-spinner",15)}var au=function(){function i(n,t,r,a){this.localizationService=n,this.formatGoalValuePipe=t,this.featureSwitches=r,this.scorecardService=a,this.currentValue=null,this.changeArrowSize="mini"}return i.prototype.ngOnChanges=function(n){var t;if((n.goal||n.displaySettings)&&this.goal){this.currentValue=ke.r.buildCurrentGoalValue(this.goal),this.categories=this.scorecardService.getGoalValueCategories(this.goal),this.goalStatuses=this.scorecardService.getGoalStatuses(this.goal);var r=N.p.getGoalStatus(this.currentValue.status,this.goalStatuses).color;this.backgroundColor=this.displaySettings.showStatusColor?N.p.getGoalStatusColor(r,!1,!1):void 0,this.formatString=this.goal.valuesFormatString,this.valueTooltip=this.goal.isCurrentValueNotConnectedToHierarchy?"".concat(this.localizationService.get("CurrentValue")," ").concat(this.localizationService.get("Metrics_Tooltip_ValueNotConnected")):this.formatGoalValuePipe.transform(this.currentValue.value,this.categories,this.goal.valuesFormatString,!1),this.targetTooltip=this.goal.isTargetValueNotConnectedToHierarchy?"".concat(this.localizationService.get("Role_DisplayName_TargetValue")," ").concat(this.localizationService.get("Metrics_Tooltip_ValueNotConnected")):this.formatGoalValuePipe.transform(this.currentValue.target,this.categories,this.goal.valuesFormatString,!1),this.displaySettings.showValueChange&&(this.valueChange=ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.isCyclePeriodLabelLocalizable=ke.r.isCyclePeriodLabelLocalizable(null===(t=this.valueChange)||void 0===t?void 0:t.period))}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(Xr.D),e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(et))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["hierarchy-goal-cell"]],inputs:{goal:"goal",scorecard:"scorecard",displaySettings:"displaySettings",isSelected:"isSelected"},features:[e.\u0275\u0275NgOnChangesFeature],decls:3,vars:2,consts:[["class","cell",3,"background","isSelected",4,"ngIf","ngIfElse"],["loading",""],[1,"cell"],[1,"content"],[4,"ngIf"],["class","target",3,"title","targetOnly",4,"ngIf"],[3,"status","goalStatuses",4,"ngIf"],["class","value",3,"title",4,"ngIf"],[3,"goal","arrowSize","nilDisplayString",4,"ngIf"],[1,"value",3,"title"],[3,"goal","arrowSize","nilDisplayString"],[1,"target",3,"title"],[1,"slash"],[3,"status","goalStatuses"],["statusCell",""],[1,"pbi-spinner-small"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,fh,5,7,"div",0),e.\u0275\u0275template(1,mh,1,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",r.goal)("ngIfElse",a)}},dependencies:[j.NgIf,Jn.k,zr,Br,Xr.D],styles:["[_nghost-%COMP%]{flex:1;height:100%;display:flex;flex-direction:column;justify-content:center}.cell[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;border-bottom:4px solid transparent}.content[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:flex-start;box-sizing:border-box;white-space:nowrap;width:100%;padding:0 6px}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.content[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400)}.content[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]   .slash[_ngcontent-%COMP%]{margin:0 1px}.content[_ngcontent-%COMP%]   .target.targetOnly[_ngcontent-%COMP%]{font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.content[_ngcontent-%COMP%]   .target.targetOnly[_ngcontent-%COMP%]   .slash[_ngcontent-%COMP%]{display:none}.content[_ngcontent-%COMP%]   goal-change-cell[_ngcontent-%COMP%]{display:flex;overflow:hidden;--container-align-items: baseline;--arrow-margin: 0 4px;--change-font-size: var(--vlg-font-size);--change-font-weight: var(--font-weight-semi-bold)}status-icon[_ngcontent-%COMP%]{display:flex;justify-content:center}status-icon[_ngcontent-%COMP%]     .status{font-size:var(--sm-font-size, 12px);line-height:16px;height:16px;width:fit-content}.isSelected[_ngcontent-%COMP%]{border-color:var(--fluent-theme-neutral-secondary-color, #605E5C)}"],changeDetection:0}),i}(),vh=["nameCell"],Ch=["hierarchyGoalCell"],_h=["columnHeader"];function yh(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tree-list",6),e.\u0275\u0275listener("onResizeColumn",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onResizeColumn(s))})("onExpansionChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onExpansionChange(s))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275classMap(r.heatmapClassname),e.\u0275\u0275property("columns",r.columns)("data",r.goals)("expandedNodeIds",r.expandedGoalIds)("getChildren",r.getSubgoals)("rowHash",r.rowHash)("rowHeight",r.rowHeight)("rowSpacing",r.rowSpacing)("stickyFirstColumn",!0)}}function bh(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",10),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(5);e.\u0275\u0275property("pbiTooltip",t)}}function wh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"Metrics_Tooltip_LinkedHierarchical")," "))}function Sh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"CurrentValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function Mh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",15),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"Role_DisplayName_TargetValue")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,4,"Metrics_Tooltip_ValueAddedManually")," "))}function Ph(i,n){if(1&i&&(e.\u0275\u0275template(0,Sh,6,6,"div",14),e.\u0275\u0275template(1,Mh,6,6,"div",14)),2&i){var t=e.\u0275\u0275nextContext(2).data;e.\u0275\u0275property("ngIf",!t.valueConnection),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.targetConnection)}}function Oh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275template(1,wh,3,3,"div",12),e.\u0275\u0275template(2,Ph,2,2,"ng-template",null,13,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(3),r=e.\u0275\u0275nextContext().data;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isLinked)("ngIfElse",t)}}function xh(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275listener("click",function(){var c=e.\u0275\u0275restoreView(t).data,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.onGoalNameClicked(c))}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,bh,1,1,"pbi-icon",8),e.\u0275\u0275template(4,Oh,4,2,"ng-template",null,9,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()}if(2&i){var r=n.data;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isLinked||!r.valueConnection||!r.targetConnection)}}function Th(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"hierarchy-goal-cell",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext(),v=p.data,P=p.column,x=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(x.openGoalDetails(v,P.data))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(),a=r.column,s=r.data,c=e.\u0275\u0275nextContext();e.\u0275\u0275property("goal",null==c.goalsByHierarchyItemIds[a.data.id]?null:c.goalsByHierarchyItemIds[a.data.id][s.id])("scorecard",c.scorecard)("displaySettings",c.displaySettings)("isSelected",a.data.id===c.activeItemId&&s.id===c.scorecard.activeGoalId)}}function Eh(i,n){1&i&&e.\u0275\u0275template(0,Th,1,4,"hierarchy-goal-cell",16),2&i&&e.\u0275\u0275property("ngIf",!n.data.isLinked||!n.column.data.id)}function Ih(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div")(2,"span",29),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.hierarchyName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(": ",t.levels.join(" > "),"")}}function Dh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"span",29),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Visual_Totals")))}function kh(i,n){if(1&i&&(e.\u0275\u0275template(0,Ih,6,2,"ng-container",12),e.\u0275\u0275template(1,Dh,3,3,"ng-template",null,28,e.\u0275\u0275templateRefExtractor)),2&i){var t=e.\u0275\u0275reference(2),r=e.\u0275\u0275nextContext().column,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",a.hierarchyPathsByKey[r.key])("ngIfElse",t)}}function Fh(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",30),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext().column,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.removeColumn(a.data))}),e.\u0275\u0275element(1,"pbi-icon",31)(2,"span",32),e.\u0275\u0275elementEnd()}}function Vh(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",24),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.hierarchyPane.showHeatmapDisplaySettingsPane())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275element(2,"pbi-icon",33)(3,"span",34),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,1,r.hierarchyPane.showHeatmapDisplaySettingsPane$))}}function Ah(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",18)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"pbi-icon",19),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,kh,3,2,"ng-template",null,20,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"mat-menu",21,22),e.\u0275\u0275template(8,Fh,3,0,"button",23),e.\u0275\u0275elementStart(9,"button",24),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.hierarchyPane.showHeatmapConfigurationPane())}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275element(11,"pbi-icon",25)(12,"span",26),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,Vh,4,3,"button",27),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=n.column,a=e.\u0275\u0275reference(5),s=e.\u0275\u0275reference(7),c=e.\u0275\u0275nextContext();e.\u0275\u0275property("matMenuTriggerFor",s)("pbiTooltip",a),e.\u0275\u0275attribute("aria-label",r.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.name),e.\u0275\u0275advance(4),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!!r.data.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,8,c.hierarchyPane.showHeatmapConfigurationPane$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(14,10,c.canEditHeatmap$))}}function Rh(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-lazy-load",35),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("modulePath",t.hierarchyModulePath)("componentId",t.heatmapConfigurationComponentId)}}function Lh(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-lazy-load",36),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("modulePath",t.hierarchyModulePath)("componentId",t.heatmapDisplaySettingsComponentId)}}var su=function(i){return i.Name="name",i}({}),Wl="TOTAL";function lu(i,n,t,r){void 0===r&&(r=0);for(var a=0,s=i;a<s.length;a++){var c=s[a];if(_.isEmpty(c.children)||lu(c.children,n,t,r+1),n[c.id]&&(delete n[c.id],t.push((0,w.__assign)((0,w.__assign)({},c),{level:r}))),_.isEmpty(n))return}}var cu=function(i){function n(t,r,a,s,c,u,p,v,P,x){var G=i.call(this)||this;return G.hierarchyPane=t,G.hierarchyService=r,G.detailsPaneLauncher=a,G.changeDetector=s,G.localization=c,G.heatmapService=u,G.scorecardService=p,G.scorecardConfigurationService=v,G.capabilityService=P,G.expansionService=x,G.columnsByKey={},G.hierarchyPathsByKey={},G.hierarchyModulePath="@powerbi/GoalsHierarchy/goals-hierarchy.module#GoalsHierarchyModule",G.heatmapConfigurationComponentId="HeatmapConfigurationPaneComponentId",G.heatmapDisplaySettingsComponentId="HeatmapDisplaySettingsPaneComponentId",G.getSubgoals=function(Y){return G.getGoalNodes(Y.subGoals,Y)},G.rowHash=function(Y,ue){return JSON.stringify(ue)},G.rowHeight=50,G.rowSpacing=8,G.canEditHeatmap$=G.capabilityService.getScorecardCapabilities().pipe((0,je.U)(function(Y){return Y.editHeatmap})),G}return(0,w.__extends)(n,i),n.prototype.ngOnInit=function(){var t=this;this.hierarchyPane.showHeatmapConfigurationPane();var r=this.scorecardService.getCurrentScorecard().hierarchyPaths;this.hierarchyService.getHierarchyItemsForPath(r).pipe((0,he.q)(1)).subscribe(function(a){return t.heatmapService.loadDefaultView(!0,!0,a)}),this.scorecardService.setActiveHierarchy(void 0),this.scorecardService.getScorecard().pipe((0,ar.b)(function(a){t.scorecard=a,t.goals=t.getGoalNodes(a.goals),t.expandedGoalIds=t.expansionService.expandedGoalIds,t.changeDetector.markForCheck()}),(0,Jt.w)(function(a){return t.hierarchyService.getHierarchyItemsForPath(a.hierarchyPaths)}),(0,ie.R)(this.onDestroy$)).subscribe(function(a){t.activeItemId=1===_.size(a)?a[0].id:void 0}),this.heatmapService.goalsByHierarchyItemId$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(a){t.goalsByHierarchyItemIds=a,t.changeDetector.markForCheck()}),this.heatmapService.displaySettings$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(a){t.displaySettings=a;var s="show-value-only";t.displaySettings.showCurrentValue&&t.displaySettings.showValueChange?s=t.displaySettings.showTargetValue?"show-change-target":"show-change-only":t.displaySettings.showCurrentValue&&t.displaySettings.showTargetValue&&(s="show-value-target"),t.heatmapClassname="heat-map "+s,t.changeDetector.markForCheck()})},n.prototype.ngAfterViewInit=function(){var t=this;this.updateColumns([]),this.heatmapService.selectedHierarchyItems$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(r){t.updateColumns(r),t.changeDetector.markForCheck()})},n.prototype.getCachedColumn=function(t,r){return this.columnsByKey[t]||(this.columnsByKey[t]=r()),this.columnsByKey[t]},n.prototype.updateColumns=function(t){var r=this,a=_.flatMap(Object.values(this.hierarchyService.hierarchyItems)),s=_.keyBy(t,function(u){var p;return null!==(p=u.id)&&void 0!==p?p:Wl}),c=[];lu(a,s,c,0),s[Wl]&&(c.unshift(s[Wl]),delete s[Wl]),c.push.apply(c,Object.values(s)),t=c,this.columns=(0,w.__spreadArray)([this.getCachedColumn(su.Name,function(){return{key:su.Name,name:r.localization.get("Name"),width:400,cellTemplate:r.nameCell}})],_.map(t,function(u){return r.getCachedColumn(u.id,function(){return{key:u.id,name:(0,Zn.WU)(u.value),class:"column-center-name",resizable:!1,headerTemplate:r.columnHeader,cellTemplate:r.hierarchyGoalCell,data:u}})}),!0),t.forEach(function(u){if(u.id&&!r.hierarchyPathsByKey[u.id]){var p=Ii(u);r.hierarchyPathsByKey[u.id]=r.hierarchyService.formatHierarchyItemPath(p)}})},n.prototype.onGoalNameClicked=function(t){this.detailsPaneLauncher.openGoalDetails(this.scorecardService,t.id,Yr.Default,this.scorecardConfigurationService.getConfiguration()),this.changeDetector.markForCheck()},n.prototype.openGoalDetails=function(t,r){var a;return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(s){switch(s.label){case 0:return null!==(a=this.goalsByHierarchyItemIds[r?.id])&&void 0!==a&&a[t.id]?[4,this.scorecardService.setActiveHierarchy(r?.id?di([r]):void 0)]:[3,2];case 1:s.sent(),this.detailsPaneLauncher.openGoalDetails(this.scorecardService,t.id,Yr.Default,this.scorecardConfigurationService.getConfiguration()),this.changeDetector.markForCheck(),s.label=2;case 2:return[2]}})})},n.prototype.removeColumn=function(t){this.heatmapService.removeHierarchyItem(t)},n.prototype.onResizeColumn=function(t){this.columns[t.column].width=t.width},n.prototype.onExpansionChange=function(t){this.expansionService.expandGoals(t.added),this.expansionService.collapseGoals(t.removed)},n.prototype.getGoalNodes=function(t,r){return _.map(_.filter(t,function(a){return!a.isNew&&!a.isHidden}),function(a,s){return(0,w.__assign)((0,w.__assign)({},a),{style:r?r.style:{"border-color":W.gT.ColorPalette[s%W.gT.ColorPalette.length]},class:!1===a.isFilterMatch?"goal-not-match":""})})},n.\u0275fac=function(r){return new(r||n)(e.\u0275\u0275directiveInject(jl),e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(gc),e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(Oi.V),e.\u0275\u0275directiveInject(hr),e.\u0275\u0275directiveInject(xr))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["heat-map"]],viewQuery:function(r,a){if(1&r&&(e.\u0275\u0275viewQuery(vh,5),e.\u0275\u0275viewQuery(Ch,5),e.\u0275\u0275viewQuery(_h,5)),2&r){var s=void 0;e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.nameCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.hierarchyGoalCell=s.first),e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(a.columnHeader=s.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:11,vars:7,consts:[[3,"class","columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","stickyFirstColumn","onResizeColumn","onExpansionChange",4,"ngIf"],["nameCell",""],["hierarchyGoalCell",""],["columnHeader",""],["class","configuration-pane",3,"modulePath","componentId",4,"ngIf"],["class","display-settings-pane",3,"modulePath","componentId",4,"ngIf"],[3,"columns","data","expandedNodeIds","getChildren","rowHash","rowHeight","rowSpacing","stickyFirstColumn","onResizeColumn","onExpansionChange"],[1,"name",3,"click"],["class","name-info","name","info","size","mini",3,"pbiTooltip",4,"ngIf"],["infoTooltip",""],["name","info","size","mini",1,"name-info",3,"pbiTooltip"],[1,"goal-info-tooltip"],[4,"ngIf","ngIfElse"],["manualTooltip",""],[4,"ngIf"],[1,"tooltip-value-label"],[3,"goal","scorecard","displaySettings","isSelected","click",4,"ngIf"],[3,"goal","scorecard","displaySettings","isSelected","click"],["mat-button","","cdkMonitorElementFocus","",1,"heatmap-column-header",3,"matMenuTriggerFor","pbiTooltip"],["name","chevrondownsmall","size","mini",1,"chevrondown"],["hierarchyPathTooltip",""],["xPosition","after",1,"heatmap-column-menu",3,"overlapTrigger"],["heatmapColumnMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"disabled","click"],["name","edit","size","small",1,"icon"],["localize","MetricsCustomizeHeatmap"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],["total",""],[1,"tooltip-hierarchy-name"],["mat-menu-item","",3,"click"],["name","delete","size","small",1,"icon"],["localize","MetricsHierarchy_Builder_Remove_Level"],["name","settings","size","small",1,"icon"],["localize","DisplaySettings_Open"],[1,"configuration-pane",3,"modulePath","componentId"],[1,"display-settings-pane",3,"modulePath","componentId"]],template:function(r,a){1&r&&(e.\u0275\u0275template(0,yh,1,10,"tree-list",0),e.\u0275\u0275template(1,xh,6,2,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(3,Eh,1,1,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,Ah,15,12,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(7,Rh,1,2,"pbi-lazy-load",4),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,Lh,1,2,"pbi-lazy-load",5),e.\u0275\u0275pipe(10,"async")),2&r&&(e.\u0275\u0275property("ngIf",a.scorecard),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,3,a.hierarchyPane.showHeatmapConfigurationPane$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(10,5,a.hierarchyPane.showHeatmapDisplaySettingsPane$)))},dependencies:[j.NgIf,ou.R,rn.X,Vt.W0,Vt.tN,Vt.D8,ln._,qe.V,au,va,j.AsyncPipe,Mt.F],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .heat-map[_ngcontent-%COMP%]{flex:1;overflow:hidden;padding-left:30px;--column-headers-backgroundColor: var(--scorecard-tableBackgroundColor);--row-backgroundColor: var(--scorecard-tableRowBackgroundColor)}[_nghost-%COMP%]   .heat-map.show-value-only[_ngcontent-%COMP%]{--cell-width: 88px}[_nghost-%COMP%]   .heat-map.show-value-target[_ngcontent-%COMP%]{--cell-width: 152px}[_nghost-%COMP%]   .heat-map.show-change-only[_ngcontent-%COMP%]{--cell-width: 132px}[_nghost-%COMP%]   .heat-map.show-change-target[_ngcontent-%COMP%]{--cell-width: 208px}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap;overflow:hidden;height:100%;display:flex;align-items:center;flex:1}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]:hover{text-decoration:underline}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]   .name-info[_ngcontent-%COMP%]{margin:0 6px}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;align-items:flex-start;justify-content:flex-start;padding:0;background:none;border:none}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:focus:hover, [_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]:focus:hover:active{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-left:6px;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .heatmap-column-header[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{padding:6px}[_nghost-%COMP%]   .configuration-pane[_ngcontent-%COMP%]{border-left:1px solid var(--gray-50, #D2D0CE)}[_nghost-%COMP%]   .configuration-pane[_ngcontent-%COMP%]     pbi-side-pane{width:450px}[_nghost-%COMP%]     .column-center-name{justify-content:center}[_nghost-%COMP%]     .heat-map .column-headers{padding-left:6px}[_nghost-%COMP%]     .heat-map .column-headers .header{width:var(--cell-width)}[_nghost-%COMP%]     .row{border-left:6px solid transparent;border-radius:4px 8px 8px 4px;box-shadow:0 0 2px var(--colorNeutralShadowAmbient),0 2px 4px var(--colorNeutralShadowKey)}[_nghost-%COMP%]     .row.goal-not-match{opacity:50%}[_nghost-%COMP%]     .cell{width:var(--cell-width)}[_nghost-%COMP%]   hierarchy-goal-cell[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .name[_ngcontent-%COMP%]:hover{cursor:pointer;opacity:.7}.goal-info-tooltip[_ngcontent-%COMP%]   .tooltip-value-label[_ngcontent-%COMP%], .tooltip-hierarchy-name[_ngcontent-%COMP%]{font-weight:600}  .mat-menu-panel.heatmap-column-menu{min-height:fit-content;margin-top:4px}  .mat-menu-panel.heatmap-column-menu .mat-menu-content{padding:0}  .mat-menu-panel.heatmap-column-menu .mat-menu-item{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px}  .mat-menu-panel.heatmap-column-menu .mat-menu-item:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}  .mat-menu-panel.heatmap-column-menu .mat-menu-item pbi-icon{display:flex;padding-right:8px}"],changeDetection:0}),n}(se.w),Gh=["chart"];function Nh(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Hh(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Nh,1,0,"ng-container",8),e.\u0275\u0275elementContainerEnd()),2&i){e.\u0275\u0275nextContext();var t=e.\u0275\u0275reference(11);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)}}function zh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",20)(1,"span",21),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,2,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString))}}function qh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",22)(1,"span",23),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"formatGoalValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",24),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("localize",t.periodLocalizeString),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.valueChange.isPercentage?t.valueChange.changeAmount+"%":e.\u0275\u0275pipeBind3(3,3,t.valueChange.changeAmount,t.categories,t.goal.valuesFormatString)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.valueChange.period)}}function Bh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275element(1,"mat-icon",16),e.\u0275\u0275elementStart(2,"div",17),e.\u0275\u0275template(3,zh,4,6,"span",18),e.\u0275\u0275template(4,qh,6,7,"ng-template",null,19,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275reference(5),r=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("rotate180",!r.valueChange.isIncrease),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.periodLocalizeString&&!r.periodLocalizeString.endsWith("Custom"))("ngIfElse",t)}}function Uh(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Bh,6,4,"div",11),e.\u0275\u0275elementStart(2,"div",12,13),e.\u0275\u0275element(4,"goal-history-chart",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.valueChange),e.\u0275\u0275advance(3),e.\u0275\u0275property("values",t.sparklineValues)("formatString",t.goal.valuesFormatString)("color",t.statusColor)("showGoalTargets",!1)("axesOptions",t.axesOptions)("legend","None")}}function jh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275template(1,Uh,5,7,"ng-container",10),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(),r=e.\u0275\u0275reference(11);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.hasData)("ngIfElse",r)}}function Wh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",25),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"formatGoalValue"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(2,1,t.currentValue.value,t.categories,t.goal.valuesFormatString))}}function $h(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",26)(1,"div",27)(2,"div",28),e.\u0275\u0275pipe(3,"formatValue"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"formatValue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",29),e.\u0275\u0275pipe(7,"formatValue"),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"formatValue"),e.\u0275\u0275elementEnd()()()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(3,4,t.currentValue.value,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(5,8,t.currentValue.value,t.goal.valuesFormatString)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind3(7,11,t.currentValue.target,t.goal.valuesFormatString,!1)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" /",e.\u0275\u0275pipeBind2(9,15,t.currentValue.target,t.goal.valuesFormatString)," ")}}var fc=function(){function i(n,t){this.featureSwitches=n,this.localizationService=t,this.axesOptions=Qo,this.currentValue=null,this.supportCategoricalValues=this.featureSwitches.featureSwitches.goalsCategoricalValues}return i.prototype.ngOnInit=function(){var t,r,n=this;b.fF.assertValue(this.goal,"Missing goal"),this.setDisplayedVals(),this.locale=this.localizationService.currentLanguageLocale,this.supportCategoricalValues&&this.goal.valuesCategoryId&&(this.categories=null!==(r=null===(t=_.find(this.goal.goalValueCategories,function(a){return a.id===n.goal.valuesCategoryId}))||void 0===t?void 0:t.categories)&&void 0!==r?r:[])},i.prototype.ngOnChanges=function(n){var t,r;n.goal&&(this.setDisplayedVals(),this.supportCategoricalValues&&n.goal.currentValue.valuesCategoryId&&(this.categories=null!==(r=null===(t=_.find(this.goal.goalValueCategories,function(a){return a.id===n.goal.currentValue.valuesCategoryId}))||void 0===t?void 0:t.categories)&&void 0!==r?r:[]))},i.prototype.ngAfterViewInit=function(){var n;this.lineChartChangeObserver=q.observeAndRemoveFocusableAttributes(null===(n=this.chart)||void 0===n?void 0:n.nativeElement)},i.prototype.ngOnDestroy=function(){var n;null===(n=this.lineChartChangeObserver)||void 0===n||n.disconnect()},i.prototype.setDisplayedVals=function(){var n;this.currentValue=ke.r.buildCurrentGoalValue(this.goal),this.valueChange=ke.r.calculateValueChange(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.periodLocalizeString=_.isNil(null===(n=this.valueChange)||void 0===n?void 0:n.period)?void 0:this.getPeriodSuffix(this.valueChange.period);var r=N.p.getGoalStatus(this.currentValue.status,this.goalStatuses);this.statusColor=N.p.getGoalSparklineColor(r.color),this.sparklineValues=Ir.buildSparklineValues(this.goal,this.featureSwitches.featureSwitches.goalsSparklineChangeAggregations),this.hasData=_.some(this.sparklineValues)},i.prototype.getPeriodSuffix=function(n){switch(n){case"Period_DoD":case"Period_MoM":case"Period_QoQ":case"Period_WoW":case"Period_YoY":return n;default:return"PercentGrowth_Period_Custom"}},i.componentId="RelevantGoalChartComponentId",i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["relevant-goal-chart"]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(Gh,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.chart=a.first))},inputs:{goal:"goal",goalStatuses:"goalStatuses"},features:[e.\u0275\u0275NgOnChangesFeature],decls:12,vars:7,consts:[[1,"relevant-goal"],[1,"title-and-value"],[4,"ngIf"],[1,"title",3,"pbiTooltip"],[3,"pbiTooltip"],["class","growth-and-visual",4,"ngIf","ngIfElse"],["useCategories",""],["valueAndTarget",""],[4,"ngTemplateOutlet"],[1,"growth-and-visual"],[4,"ngIf","ngIfElse"],["class","growth",4,"ngIf"],[1,"visual"],["chart",""],["type","AreaChart",3,"values","formatString","color","showGoalTargets","axesOptions","legend"],[1,"growth"],["fontIcon","pbi-glyph-arrow",1,"glyphicon","glyph-micro"],[1,"change"],["class","period","localize-fragments","",3,"localize",4,"ngIf","ngIfElse"],["customPeriod",""],["localize-fragments","",1,"period",3,"localize"],["fragment-index","0",1,"valueChangePeriod"],["localize-fragments","",3,"localize"],["fragment-index","0"],["fragment-index","1"],[1,"current-value"],[1,"value-wrapper"],[1,"value-target"],[1,"value",3,"pbiTooltip"],[1,"target",3,"pbiTooltip"]],template:function(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Hh,2,1,"ng-container",2),e.\u0275\u0275elementStart(3,"span",3),e.\u0275\u0275text(4),e.\u0275\u0275elementStart(5,"span",4),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,jh,2,2,"div",5),e.\u0275\u0275template(8,Wh,3,5,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,$h,10,18,"ng-template",null,7,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(9);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.hasData&&!(r.supportCategoricalValues&&r.goal.valuesCategoryId)),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",r.goal.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",r.goal.scorecardName," > "),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",r.goal.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",r.goal.name,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(r.supportCategoricalValues&&r.goal.valuesCategoryId))("ngIfElse",a)}},dependencies:[j.NgIf,j.NgTemplateOutlet,rn.X,Xt.Hw,qe.V,uo,Xr.D,Er.c],styles:['.relevant-goal[_ngcontent-%COMP%]{flex:1;width:284px;background-color:var(--fluent-theme-white-color, #FFF);border-radius:2px}.relevant-goal[_ngcontent-%COMP%]   .rotate180[_ngcontent-%COMP%]{transform:rotate(180deg);-webkit-transform:rotate(180deg)}.relevant-goal[_ngcontent-%COMP%]:hover, .relevant-goal[_ngcontent-%COMP%]:focus:hover{cursor:pointer}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;height:66px;padding:0 16px}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);line-height:20px;color:var(--fluent-theme-neutral-primary-color, #323130);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:18px}.relevant-goal[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:14px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:168px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:1px;padding:7px 16px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:8px!important;width:8px!important}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .rotate180[_ngcontent-%COMP%]{transform:rotate(180deg)}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .change[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);margin-left:4px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .growth[_ngcontent-%COMP%]   .change[_ngcontent-%COMP%]   .valueChangePeriod[_ngcontent-%COMP%]{margin-right:4px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]{flex:1;display:flex;padding:7px 10px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .visual[_ngcontent-%COMP%]   goal-history-chart[_ngcontent-%COMP%]{width:100%;flex:1}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{margin:auto}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:34px}.relevant-goal[_ngcontent-%COMP%]   .growth-and-visual[_ngcontent-%COMP%]   .value-wrapper[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{font-size:22px}.relevant-goal[_ngcontent-%COMP%]   .current-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:168px;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--pbi-font-32, 32px);font-weight:var(--font-weight-semi-bold, 600)}.relevant-goal[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]{display:flex;align-items:baseline}.relevant-goal[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-primary-color, #323130);font-weight:var(--font-weight-semi-bold, 600)}.relevant-goal[_ngcontent-%COMP%]   .value-target[_ngcontent-%COMP%]   .target[_ngcontent-%COMP%]{color:var(--fluent-theme-neutral-primary-alt-color, #3B3A39)}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;height:44px;padding:0 16px}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);font-size:14px;line-height:18px;color:var(--fluent-theme-neutral-secondary-color, #605E5C);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:4px}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]{width:95px;margin-right:7px}.relevant-goal[_ngcontent-%COMP%]   .date-and-status[_ngcontent-%COMP%]   status-icon[_ngcontent-%COMP%]     .status{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}'],changeDetection:0}),i}();function Qh(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"goal-kpi",5),e.\u0275\u0275listener("onSelected",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onPointSelected(s))}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("values",r.goal.goalValues)("formatString",r.goal.valuesFormatString)}}function Xh(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",6),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",7),e.\u0275\u0275element(4,"label",8),e.\u0275\u0275elementStart(5,"span"),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.goal.name),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" : ",t.completionDate,"")}}var mc=function(){function i(n){this.localizationService=n}return i.prototype.ngOnInit=function(){if(this.goal.completionDate){var n=this.localizationService.currentLanguageLocale;this.completionDate=new Date(this.goal.completionDate).toLocaleDateString(n,{day:"numeric",month:"short",year:"numeric"})}},i.componentId="RelevantGoalKpiComponentId",i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["relevant-goal-kpi"]],inputs:{goal:"goal"},decls:5,vars:2,consts:[[1,"relevant-goal","pbi-depth-1","pbi-depth-interactive"],[1,"relevant-goal-kpi"],[3,"values","formatString","onSelected",4,"ngIf"],[1,"relevant-goal-details"],[4,"ngIf"],[3,"values","formatString","onSelected"],[1,"title"],[1,"target-date"],["localize","KpiTargetDateFieldListDisplayName"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Qh,1,2,"goal-kpi",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",3),e.\u0275\u0275template(4,Xh,7,2,"ng-container",4),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.goal),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.goal))},dependencies:[j.NgIf,rn.X,tu],styles:['.relevant-goal[_ngcontent-%COMP%]{flex:1;height:262px;width:285px;background:var(--fluent-theme-white-color, #FFF);border-radius:2px}.relevant-goal[_ngcontent-%COMP%]:hover, .relevant-goal[_ngcontent-%COMP%]:focus:hover{cursor:pointer}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-details[_ngcontent-%COMP%]{border-top:1px solid var(--fluent-theme-neutral-light-color, #EDEBE9);padding:16px}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-details[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);line-height:20px;color:var(--fluent-theme-neutral-primary-color, #323130);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-details[_ngcontent-%COMP%]   .target-date[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--sm-font-size, 12px);font-weight:var(--font-weight-regular, 400);line-height:16px;color:var(--fluent-theme-neutral-secondary-color, #605E5C);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-kpi[_ngcontent-%COMP%]{height:194px}.relevant-goal[_ngcontent-%COMP%]   .relevant-goal-kpi[_ngcontent-%COMP%]   visual-modern[_ngcontent-%COMP%]{border:none!important;padding:0!important}'],changeDetection:0}),i}(),bi=function(i){return i[i.None=0]="None",i[i.View=1]="View",i[i.TenantView=2]="TenantView",i[i.Favorite=3]="Favorite",i[i.Frequent=4]="Frequent",i[i.Promoted=5]="Promoted",i[i.Learning=6]="Learning",i[i.Discover=7]="Discover",i[i.Teams=8]="Teams",i[i.TeamAnalytics=9]="TeamAnalytics",i[i.PromotedSample=10]="PromotedSample",i}({});function Zh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",7),e.\u0275\u0275element(1,"tri-svg-icon",8),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("pbiTooltip",t.recommendationReason),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.recommendationReason,"")}}var vc=function(){function i(n){this.localizationService=n}return i.prototype.ngOnChanges=function(n){var t;(this.relevantMeasure||n.relevantMeasure)&&(this.recommendationReason=function(i,n){var t="";switch(i){case bi.View:t=n.format("Recommended_Reason_View");break;case bi.Favorite:t=n.get("Recommended_Reason_Favorite");break;case bi.Frequent:t=n.get("Recommended_Reason_Frequent");break;case bi.Promoted:t=n.format("Recommended_Reason_Featured");break;case bi.Learning:t=n.get("TopNav_HelpMenu_GettingStarted");break;case bi.Discover:t=n.get("Recommended_Reason_Discover");break;case bi.TeamAnalytics:t=n.get("Teams_Analyze_Usage");break;default:t=n.get("Recommended_Reason_None")}return t}(null===(t=this.relevantMeasure)||void 0===t?void 0:t.recommendationReason,this.localizationService))},i.componentId="RelevantMeasureComponentId",i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["relevant-measure"]],inputs:{relevantMeasure:"relevantMeasure"},features:[e.\u0275\u0275NgOnChangesFeature],decls:11,vars:4,consts:[[1,"relevant-measure"],[1,"measure"],[1,"title-and-value"],["class","title",3,"pbiTooltip",4,"ngIf"],[3,"pbiTooltip"],[1,"measure-report"],["fontIcon","pbi-glyph-barchart",1,"glyph-small"],[1,"title",3,"pbiTooltip"],["name","folder_open_20_regular","tri-svg-icon-16",""]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275template(3,Zh,3,2,"span",3),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",5)(7,"div"),e.\u0275\u0275element(8,"mat-icon",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div"),e.\u0275\u0275text(10),e.\u0275\u0275elementEnd()()()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!(null==r.relevantMeasure||!r.relevantMeasure.recommendationReason)),e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",null==r.relevantMeasure?null:r.relevantMeasure.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(null==r.relevantMeasure?null:r.relevantMeasure.name),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(null==r.relevantMeasure?null:r.relevantMeasure.value))},dependencies:[j.NgIf,Xt.Hw,qe.V,gr.M],styles:['.relevant-measure[_ngcontent-%COMP%]{flex:1;width:284px;background-color:var(--fluent-theme-white-color, #FFF);border-radius:2px}.relevant-measure[_ngcontent-%COMP%]:hover, .relevant-measure[_ngcontent-%COMP%]:focus:hover{cursor:pointer}.relevant-measure[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;height:66px;padding:0 16px}.relevant-measure[_ngcontent-%COMP%]   .title-and-value[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);line-height:20px;color:var(--fluent-theme-neutral-primary-color, #323130);white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]{height:100%}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]   .measure-report[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:168px}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]   .measure-report[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:48px!important;width:48px!important}.relevant-measure[_ngcontent-%COMP%]   .measure[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}'],changeDetection:0}),i}(),Jh=M(73088),Kh=M(74199);function eg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"label"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,t.labels[0]))}}function tg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"label"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localizeFormat"),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(2,1,r.labels[1],t))}}function ng(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(a.onDissmis())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"pbi-icon",10),e.\u0275\u0275elementEnd()}2&i&&e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,1,"Dismiss"))}function rg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275element(1,"i",3),e.\u0275\u0275elementStart(2,"div",4),e.\u0275\u0275template(3,eg,3,3,"label",5),e.\u0275\u0275template(4,tg,3,4,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(u.openSharingDialog())}),e.\u0275\u0275pipe(7,"localize"),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"localize"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(10,ng,3,3,"button",8),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275reference(5),a=e.\u0275\u0275nextContext().ngIf,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",1===a)("ngIfElse",r),e.\u0275\u0275advance(3),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(7,5,s.labels[2])),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(9,7,s.labels[2])),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",s.showDismiss)}}function ig(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,rg,11,9,"div",1),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t>0)}}function og(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,ig,2,1,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&i){var r,t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==(r=e.\u0275\u0275pipeBind1(2,1,t.noAccessUsers$))?null:r.length)}}var uu=function(){function i(n,t){var r;this.goalsHttpService=n,this.scorecardActions=t,this.labels=["Member_No_Scorecard_Access","Members_No_Scorecard_Access","Manage_Scorecard_Access"],this.showDismiss=!0,this.userAccess={userPrincipalNames:{},aadAppIds:{},groupIds:{}},this.noAccessUsers$=new pe.X([]),this.show=!0,b.fF.assertValue(3===(null===(r=this.labels)||void 0===r?void 0:r.length),"Should only contain 3 labels")}return i.prototype.ngOnChanges=function(n){var t,r;(n.scorecard&&this.scorecard.reportId&&_.isNil(null===(t=n.scorecard.previousValue)||void 0===t?void 0:t.reportId)&&this.users||n.users&&null!==(r=this.scorecard)&&void 0!==r&&r.reportId)&&this.updateUserAccessInfo()},i.prototype.onDissmis=function(){this.show=!1},i.prototype.openSharingDialog=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(n){switch(n.label){case 0:return[4,this.scorecardActions.share(this.scorecard,this.noAccessUsers$.value)];case 1:return n.sent(),[2]}})})},i.prototype.updateUserAccessInfo=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t;return(0,w.__generator)(this,function(a){switch(a.label){case 0:if(!_.some(this.users))return[3,5];if(n=this.getCheckScorecardAccessRequest(this.users),!(_.some(n.userPrincipalNames)||_.some(n.aadAppIds)||_.some(n.groupIds)))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.goalsHttpService.checkAccess(this.scorecard.groupId,this.scorecard.id,n).toPromise()];case 2:return t=a.sent(),this.updateAcessInfo(t),[3,4];case 3:return a.sent(),this.noAccessUsers$.next([]),[3,4];case 4:return this.noAccessUsers$.next(this.countUsersWithNoAccess(this.users)),[3,6];case 5:this.noAccessUsers$.next([]),a.label=6;case 6:return[2]}})})},i.prototype.getCheckScorecardAccessRequest=function(n){for(var t={userPrincipalNames:[],aadAppIds:[],groupIds:[]},r=0,a=n;r<a.length;r++){var s=a[r];2===s.objectType?void 0===this.userAccess.groupIds[s.objectId]&&t.groupIds.push(s.objectId):s.userPrincipalName?void 0===this.userAccess.userPrincipalNames[s.userPrincipalName]&&t.userPrincipalNames.push(s.userPrincipalName):void 0===this.userAccess.aadAppIds[s.aadAppId]&&t.aadAppIds.push(s.aadAppId)}return t},i.prototype.countUsersWithNoAccess=function(n){for(var t=[],r=0,a=n;r<a.length;r++){var s=a[r];2===s.objectType?!0!==this.userAccess.groupIds[s.objectId]&&t.push(s):s.userPrincipalName?!0!==this.userAccess.userPrincipalNames[s.userPrincipalName]&&t.push(s):!0!==this.userAccess.aadAppIds[s.aadAppId]&&t.push(s)}return t},i.prototype.updateAcessInfo=function(n){for(var t=0,r=_.keys(n?.userPrincipalNames);t<r.length;t++)this.userAccess.userPrincipalNames[a=r[t]]=n.userPrincipalNames[a];for(var s=0,c=_.keys(n?.aadAppIds);s<c.length;s++)this.userAccess.aadAppIds[a=c[s]]=n.aadAppIds[a];for(var u=0,p=_.keys(n?.groupIds);u<p.length;u++){var a;this.userAccess.groupIds[a=p[u]]=n.groupIds[a]}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Ye),e.\u0275\u0275directiveInject(Jh.F))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-access-banner"]],inputs:{scorecard:"scorecard",users:"users",labels:"labels",showDismiss:"showDismiss"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[[4,"ngIf"],["class","message-banner",4,"ngIf"],[1,"message-banner"],["aria-hidden","true",1,"glyphicon","pbi-glyph-info","glyph-small","message-banner-icon"],[1,"message-banner-text-container"],[4,"ngIf","ngIfElse"],["multiple",""],[3,"click"],["class","close",3,"click",4,"ngIf"],[1,"close",3,"click"],["name","close","size","mini"]],template:function(t,r){1&t&&e.\u0275\u0275template(0,og,3,3,"ng-container",0),2&t&&e.\u0275\u0275property("ngIf",r.show&&(null==r.scorecard?null:r.scorecard.reportId))},dependencies:[j.NgIf,ln._,j.AsyncPipe,Mt.F,Kh.j],styles:['[_nghost-%COMP%]{display:block;font-size:12px}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;padding:10px 12px;background-color:var(--gray-20, #F3F2F1);margin-bottom:10px}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{margin:0 0 0 auto;border:0;padding:0;background-color:transparent;color:inherit;display:flex;align-items:center}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]{display:block;line-height:16px;-webkit-user-select:text;-ms-user-select:text;user-select:text}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background-color:transparent;margin:0;padding:0;align-self:flex-end;text-decoration:underline;color:var(--fluent-theme-link-darker-color, #005A9E)}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{color:var(--fluent-theme-link-alt-color, #004578)}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:1px solid var(--gray-140, #484644)}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none}[_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-text-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{color:var(--gray-90, #A19F9D)}html:not([dir="rtl"])   [_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-icon[_ngcontent-%COMP%]{margin-right:8px}html[dir="rtl"]   [_nghost-%COMP%]   .message-banner[_ngcontent-%COMP%]   .message-banner-icon[_ngcontent-%COMP%]{margin-left:8px}'],changeDetection:0}),i}();function ag(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"input",7),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.bucketId=s)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"input",8),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.bucketName=s)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.addBucket())}),e.\u0275\u0275element(4,"mat-icon",10)(5,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.deleteBucket())}),e.\u0275\u0275element(7,"mat-icon",12)(8,"span",13),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",r.bucketId),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",r.bucketName)}}function sg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275listener("cdkDragEntered",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.dragEnteredGroup(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"label",15),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()}if(2&i){var r=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("cdkDragDisabled",!e.\u0275\u0275pipeBind1(1,2,a.isEditMode$)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(r.name)}}function lg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"goal-tile",17),e.\u0275\u0275listener("cdkDropListDropped",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.drop(c))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()()}if(2&i){var r=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("goal",r)("goalStatuses",a.metricsGoalStatuses)("settings",a.boardSettings)("cdkDragDisabled",!e.\u0275\u0275pipeBind1(2,4,a.isEditMode$))}}var du=function(){function i(n){var t=this;this.scorecardService=n,this.bucketArr=[],this.bucketName="",this.bucketId="",this.boardGoals=[],this.boardGroups=[],this.isEditMode$=this.scorecardService.isEditMode(),this.scorecardBoard$=this.scorecardService.getBoard(),this.scorecardBoard$.pipe().subscribe(function(r){t.boardGroups=r?.groups}),this.boardGoals=this.scorecardService.flatten()}return i.prototype.addBucket=function(){""!==this.bucketName&&this.scorecardService.addGroupToBoard(this.bucketId,this.bucketName)},i.prototype.deleteBucket=function(){this.scorecardService.deleteGroupFromBoard(this.bucketId)},i.prototype.drop=function(n){n.previousContainer===n.container?(0,X.bA)(n.container.data,n.previousIndex,n.currentIndex):(0,X.EA)(n.previousContainer.data,n.container.data,n.previousIndex,n.currentIndex)},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(et))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-board-view"]],inputs:{boardSettings:"boardSettings",metricsGoalStatuses:"metricsGoalStatuses"},decls:8,vars:6,consts:[[4,"ngIf"],["cdkDropListGroup","",1,"group-container"],["cdkDropList","",1,"group-list",3,"cdkDropListData","cdkDropListDropped"],["cdkDropList","","class","group-box","cdkDrag","",3,"cdkDragDisabled","cdkDragEntered",4,"ngFor","ngForOf"],["cdkDropListGroup",""],[1,"metric-container"],["cdkDropList","",4,"ngFor","ngForOf"],["type","text","placeholder","id",3,"ngModel","ngModelChange"],["type","text","placeholder","name",3,"ngModel","ngModelChange"],[3,"click"],["fontIcon","pbi-glyph-add",1,"glyphicon","glyph-mini"],["localize","Add_Group_To_Board_Visual"],["fontIcon","pbi-glyph-delete",1,"glyphicon","glyph-mini"],["localize","Delete_Group_From_Board_Visual"],["cdkDropList","","cdkDrag","",1,"group-box",3,"cdkDragDisabled","cdkDragEntered"],[1,"group-name"],["cdkDropList",""],["cdkDrag","",1,"metric-tile",3,"goal","goalStatuses","settings","cdkDragDisabled","cdkDropListDropped"]],template:function(t,r){1&t&&(e.\u0275\u0275template(0,ag,9,2,"div",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"div",1)(3,"div",2),e.\u0275\u0275listener("cdkDropListDropped",function(s){return r.drop(s)}),e.\u0275\u0275template(4,sg,4,4,"div",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",4)(6,"div",5),e.\u0275\u0275template(7,lg,3,6,"div",6),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,4,r.isEditMode$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("cdkDropListData",r.boardGroups),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.boardGroups),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.boardGoals))},dependencies:[j.NgForOf,j.NgIf,X.Wj,X.Fd,X.Zt,Ve.Fj,Ve.JJ,Ve.On,rn.X,Xt.Hw,Ul,j.AsyncPipe],styles:[".metric-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:row;gap:20px;margin:30px}.metric-container[_ngcontent-%COMP%]   .metric-tile[_ngcontent-%COMP%]{width:250px;height:180px;display:flex}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.group-container[_ngcontent-%COMP%]{max-width:100%;margin:0 25px 25px 0;vertical-align:top}.group-container[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]{overflow:hidden;display:block}.group-container[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]   .group-box[_ngcontent-%COMP%]{padding:20px;margin:20px;background-color:#d3d3d3;border-radius:20px;min-height:250px;display:flex;flex-wrap:wrap;flex-direction:row;gap:20px}.delete-group-button[_ngcontent-%COMP%]{font-size:medium;margin-left:auto;padding:0;border:none;background:none}.group-name[_ngcontent-%COMP%]{font-weight:700}"]}),i}(),cg=function(n){return{action:n}};function ug(i,n){if(1&i&&e.\u0275\u0275elementContainer(0,5),2&i){var t=n.$implicit;e.\u0275\u0275nextContext(3);var r=e.\u0275\u0275reference(3);e.\u0275\u0275property("ngTemplateOutlet",r)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,cg,t))}}function dg(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,ug,1,4,"ng-container",4),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function pg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onAddNote())}),e.\u0275\u0275element(1,"pbi-icon",7)(2,"div",8),e.\u0275\u0275elementEnd()}}function hg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onEditCheckIn())}),e.\u0275\u0275element(1,"pbi-icon",9)(2,"div",10),e.\u0275\u0275elementEnd()}}function gg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onDeleteCheckIn())}),e.\u0275\u0275element(1,"pbi-icon",11)(2,"div",12),e.\u0275\u0275elementEnd()}}function fg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onEditNote())}),e.\u0275\u0275element(1,"pbi-icon",9)(2,"div",13),e.\u0275\u0275elementEnd()}}function mg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.args.onDeleteNote())}),e.\u0275\u0275element(1,"pbi-icon",11)(2,"div",14),e.\u0275\u0275elementEnd()}}function vg(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,dg,2,1,"ng-container",1),e.\u0275\u0275template(2,pg,3,0,"button",3),e.\u0275\u0275template(3,hg,3,0,"button",3),e.\u0275\u0275template(4,gg,3,0,"button",3),e.\u0275\u0275template(5,fg,3,0,"button",3),e.\u0275\u0275template(6,mg,3,0,"button",3),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.goalActions),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onAddNote),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onEditCheckIn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onDeleteCheckIn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onEditNote),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.args.onDeleteNote)}}function Cg(i,n){if(1&i&&e.\u0275\u0275element(0,"mat-icon",22),2&i){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("fontIcon",t.iconName)}}function _g(i,n){if(1&i&&e.\u0275\u0275element(0,"pbi-icon",23),2&i){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function yg(i,n){if(1&i&&e.\u0275\u0275element(0,"tri-svg-icon",24),2&i){var t=e.\u0275\u0275nextContext(2).action;e.\u0275\u0275property("name",t.iconName)}}function bg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",16)(1,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext().action;return e.\u0275\u0275resetView(s.onClick())}),e.\u0275\u0275template(2,Cg,1,1,"mat-icon",18),e.\u0275\u0275template(3,_g,1,1,"pbi-icon",19),e.\u0275\u0275template(4,yg,1,1,"tri-svg-icon",20),e.\u0275\u0275element(5,"div",21),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext().action;e.\u0275\u0275property("tooltipKey",null==r?null:r.disabledTooltipKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",r.disabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","mat"===r.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","pbi"===r.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","tri"===r.iconType),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",r.labelKey)}}function wg(i,n){1&i&&e.\u0275\u0275template(0,bg,6,6,"tooltip-wrapper",15),2&i&&e.\u0275\u0275property("ngIf",n.action)}var pu=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-context-menu"]],inputs:{args:"args"},decls:4,vars:1,consts:[[1,"context-menu"],[4,"ngIf"],["actionOption",""],["class","option",3,"click",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"option",3,"click"],["name","add","size","small",1,"icon"],["localize","MetricsDetailsPane_DetailsTab_Add_Note",1,"text"],["name","edit","size","small",1,"icon"],["localize","MetricsDetailsPane_DetailsTab_Edit_Check_In",1,"text"],["name","delete","size","small",1,"icon"],["localize","MetricsDetailsPane_DetailsTab_Delete_Check_In",1,"text"],["localize","MetricsDetailsPane_DetailsTab_Edit_Note",1,"text"],["localize","MetricsDetailsPane_DetailsTab_Delete_Note",1,"text"],[3,"tooltipKey",4,"ngIf"],[3,"tooltipKey"],["mat-icon-button","",1,"option",3,"disabled","click"],["class","glyphicon glyph-small icon",3,"fontIcon",4,"ngIf"],["size","small","class","icon",3,"name",4,"ngIf"],["tri-svg-icon-16","","class","tri-svg icon",3,"name",4,"ngIf"],[1,"text",3,"localize"],[1,"glyphicon","glyph-small","icon",3,"fontIcon"],["size","small",1,"icon",3,"name"],["tri-svg-icon-16","",1,"tri-svg","icon",3,"name"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,vg,7,6,"ng-container",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,wg,1,1,"ng-template",null,2,e.\u0275\u0275templateRefExtractor)),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.args))},dependencies:[j.NgForOf,j.NgIf,j.NgTemplateOutlet,rn.X,Xt.Hw,ln._,gr.M,Tr],styles:['[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{width:fit-content;padding:2px 0;background-color:#fff;border-radius:2px;box-sizing:border-box;box-shadow:0 3.2px 7.2px rgba(0,0,0,.13),0 .6px 1.8px rgba(0,0,0,.11)}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]{height:36px;display:flex;align-items:center;cursor:pointer;background-color:transparent;border:none;min-width:-webkit-fill-available}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]:disabled{cursor:default}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]:disabled   .text[_ngcontent-%COMP%]{color:var(--gray-80)}[_nghost-%COMP%]   .option[_ngcontent-%COMP%]:hover{background:var(--gray-20, #F3F2F1)}[_nghost-%COMP%]   .icon[_ngcontent-%COMP%]{height:16px;width:16px;font-size:16px;display:inline-block;padding-left:8px;padding-right:8px}[_nghost-%COMP%]   .text[_ngcontent-%COMP%]{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--gray-180, #252423);text-align:left;display:inline-block}'],changeDetection:0}),i}(),$l=function(){function i(){this.filterBy=new e.EventEmitter}return i.prototype.onFilterBy=function(n){this.filterBy.emit(n)},i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-filter"]],inputs:{filterText:"filterText"},outputs:{filterBy:"filterBy"},decls:5,vars:7,consts:[[1,"toolbar-filter-glyph"],["fontIcon","pbi-glyph-search",1,"glyphicon","glyph-mini"],[3,"ngModel","ngModelChange"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"mat-icon",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"input",2),e.\u0275\u0275listener("ngModelChange",function(s){return r.onFilterBy(s)}),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",r.filterText),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,3,"Filter_By_Keyword"))("placeholder",e.\u0275\u0275pipeBind1(4,5,"Filter_By_Keyword")))},dependencies:[Ve.Fj,Ve.JJ,Ve.On,Xt.Hw,Mt.F],styles:["[_nghost-%COMP%]{display:inline-block;margin-right:8px;align-items:center;vertical-align:top;height:32px;width:230px}[_nghost-%COMP%]   .toolbar-filter-glyph[_ngcontent-%COMP%]{display:inline-block;margin:0;padding:0;border:none;outline:none;height:32px;width:32px;color:var(--gray-180, #252423);background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1);border-top-left-radius:4px;border-bottom-left-radius:4px}[_nghost-%COMP%]   .toolbar-filter-glyph[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-top:10px;margin-left:10px;height:12px;width:12px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{display:inline-block;vertical-align:top;margin:0;padding:0;height:32px;width:198px;color:var(--gray-180, #252423);font-weight:400;font-size:14px;line-height:20px;border:0px;border-top-right-radius:4px;border-bottom-right-radius:4px;background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus{border:0px;outline:none}"],changeDetection:0}),i}(),Sg=function(n){return{active:n}};function Mg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"button",4,5),e.\u0275\u0275element(2,"mat-icon",6)(3,"span",7),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(1),r=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(2);e.\u0275\u0275property("matMenuTriggerFor",a)("ngClass",e.\u0275\u0275pureFunction1(4,Sg,!0===t.menuOpen)),e.\u0275\u0275advance(2),e.\u0275\u0275property("fontIcon",r.selectedOption.icon),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",r.selectedOption.label)}}function Pg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",8),e.\u0275\u0275listener("click",function(){var u=e.\u0275\u0275restoreView(t).$implicit,p=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(p.onSwitchView(u.value))}),e.\u0275\u0275element(1,"mat-icon",6)(2,"span",9),e.\u0275\u0275elementEnd()}if(2&i){var r=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",a.viewType===r.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("fontIcon",r.icon),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",r.label)("localizeTooltip",r.label)}}var Cc=function(i){function n(t,r,a,s){var c=i.call(this)||this;c.scorecardService=t,c.hierarchyService=r,c.featureSwitches=a,c.changeDetector=s;var u=c.featureSwitches.featureSwitches.scorecardCompactView,p=c.featureSwitches.featureSwitches.metricsBoardView,v=c.hierarchyService.hasHierarchies$.pipe((0,je.U)(function(P){return c.featureSwitches.featureSwitches.goalsHierarchies&&c.featureSwitches.featureSwitches.goalsHierarchiesHeatmap&&P}),(0,ie.R)(c.onDestroy$));return(0,Mn.aj)([c.scorecardService.viewType$,v]).pipe((0,ie.R)(c.onDestroy$)).subscribe(function(P){c.updateViewOptions(P[0],u,P[1],p)}),c}return(0,w.__extends)(n,i),n.prototype.onSwitchView=function(t){this.scorecardService.setViewType(t)},n.prototype.updateViewOptions=function(t,r,a,s){var c=[{value:"List",label:"ListView",icon:"pbi-glyph-allapps"}];r&&c.push({value:"Compact",label:"Scorecard_CompactView_Preview",icon:"pbi-glyph-allapps"}),s&&c.push({value:"Board",label:"Display_Mode_Board_View",icon:"pbi-glyph-table"}),a&&c.push({value:"Heatmap",label:"MetricsHeatmap_Preview",icon:"pbi-glyph-table"}),this.options=c,this.showViewSwitcher=c.length>1,this.viewType=t,this.selectedOption=c.find(function(u){return u.value===t}),this.changeDetector.markForCheck()},n.\u0275fac=function(r){return new(r||n)(e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["view-switcher"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:3,consts:[["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true","class","view-mode-picker pbi-fluent-button",3,"matMenuTriggerFor","ngClass",4,"ngIf"],[1,"view-mode-picker-menu",3,"overlapTrigger"],["viewSwitcherMenu","matMenu"],["mat-menu-item","","class","pbi-fluent-button",3,"disabled","click",4,"ngFor","ngForOf"],["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true",1,"view-mode-picker","pbi-fluent-button",3,"matMenuTriggerFor","ngClass"],["viewSwitcherMenuTrigger","matMenuTrigger"],[1,"glyphicon","glyph-small",3,"fontIcon"],[3,"localize"],["mat-menu-item","",1,"pbi-fluent-button",3,"disabled","click"],[3,"localize","localizeTooltip"]],template:function(r,a){1&r&&(e.\u0275\u0275template(0,Mg,4,6,"button",0),e.\u0275\u0275elementStart(1,"mat-menu",1,2),e.\u0275\u0275template(3,Pg,3,4,"button",3),e.\u0275\u0275elementEnd()),2&r&&(e.\u0275\u0275property("ngIf",a.showViewSwitcher&&a.selectedOption),e.\u0275\u0275advance(1),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",a.options))},dependencies:[j.NgClass,j.NgForOf,j.NgIf,rn.X,Zr.r,Xt.Hw,Vt.W0,Vt.tN,Vt.D8],styles:[".view-mode-picker[_ngcontent-%COMP%]{border:none;display:inline-flex;align-items:center;background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}.view-mode-picker[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}.view-mode-picker[_ngcontent-%COMP%]:hover{background-color:var(--gray-20, #F3F2F1)}.view-mode-picker[_ngcontent-%COMP%]:active{background-color:var(--gray-30, #EDEBE9)}.view-mode-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-weight:400;margin-right:8px;color:var(--fluent-theme-black-color, #000)}  .mat-menu-panel.view-mode-picker-menu .mat-menu-content{padding:0}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px;padding-right:16px}.mat-menu-item[_ngcontent-%COMP%]:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}"],changeDetection:0}),n}(se.w);function Og(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",6)(1,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onLinkedMetricInit.emit())}),e.\u0275\u0275element(2,"span",11),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("tooltipKey",null==r.capabilities||null==r.capabilities.createLinkedGoal?null:r.capabilities.createLinkedGoal.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=r.capabilities&&null!=r.capabilities.createLinkedGoal&&r.capabilities.createLinkedGoal.enabled))}}function xg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tooltip-wrapper",6)(1,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.hierarchyPane.openHierarchiesBuilder("ScorecardNewButton"))}),e.\u0275\u0275element(2,"span",13),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("tooltipKey",null==r.capabilities||null==r.capabilities.editHierarchies?null:r.capabilities.editHierarchies.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=r.capabilities&&null!=r.capabilities.editHierarchies&&r.capabilities.editHierarchies.enabled)),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize",r.hasHierarchies?"MetricsManageHierarchies_Preview":"MetricsHierarchy_SetupHierarchy_Preview")}}var _c=function(){function i(n,t){var r=this;this.hierarchyPane=n,this.scorecardService=t,this.onNewGoal=new e.EventEmitter,this.onNewSubGoal=new e.EventEmitter,this.onLinkedMetricInit=new e.EventEmitter,this.connectedGoalSubscrition=this.scorecardService.getScorecard().pipe((0,je.U)(function(a){return q.anyGoals(a.goals,function(s){return!!s.valueConnection||!!s.targetConnection})}),(0,I.x)()).subscribe(function(a){r.anyConnectedGoals=a,r.updateCapabilities()})}return i.prototype.ngOnChanges=function(n){(n.scorecardCapabilities||n.hasHierarchies||n.numberOfSelectedGoals)&&this.updateCapabilities()},i.prototype.ngOnDestroy=function(){this.connectedGoalSubscrition.unsubscribe()},i.prototype.updateCapabilities=function(){this.scorecardCapabilities&&(this.capabilities=(0,w.__assign)({},this.scorecardCapabilities),this.capabilities.editHierarchies=Pr.clone(this.scorecardCapabilities.editHierarchies).disableIf(!this.anyConnectedGoals&&!this.hasHierarchies,"NoConnections","MetricsHierarchy_No_Connections_Tooltip").build(),this.capabilities.createSubgoal=Pr.clone(this.scorecardCapabilities.createGoal).disableIf(1!==this.numberOfSelectedGoals,"InvalidSelection").build())},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(jl),e.\u0275\u0275directiveInject(et))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-new-button"]],inputs:{isEditMode:"isEditMode",scorecardCapabilities:"scorecardCapabilities",numberOfSelectedGoals:"numberOfSelectedGoals",hasHierarchies:"hasHierarchies"},outputs:{onNewGoal:"onNewGoal",onNewSubGoal:"onNewSubGoal",onLinkedMetricInit:"onLinkedMetricInit"},features:[e.\u0275\u0275NgOnChangesFeature],decls:15,vars:13,consts:[["mat-button-toggle","",1,"new-btn","pbi-fluent-button","pbi-focus-outline","primary",3,"matMenuTriggerFor","disabled"],[1,"glyphicon","pbi-glyph-add","glyph-small","icon"],["localize","New",1,"label"],[1,"glyphicon","pbi-glyph-chevrondownsmall","glyph-small","icon"],[1,"new-menu",3,"overlapTrigger"],["newBtnDropdownMenu","matMenu"],[3,"tooltipKey"],["mat-menu-item","",1,"pbi-fluent-button",3,"disabled","click"],["localize","NewMetric"],[3,"tooltipKey",4,"pbiFeatureSwitch"],["localize","AddSubmetric"],["localize","Metrics_LinkedMetrics_Button_Preview"],["mat-menu-item","",1,"pbi-fluent-button","manage-hierarchies-btn",3,"disabled","click"],[3,"localize"]],template:function(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"button",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"i",1)(3,"span",2)(4,"i",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-menu",4,5)(7,"tooltip-wrapper",6)(8,"button",7),e.\u0275\u0275listener("click",function(){return r.onNewGoal.emit()}),e.\u0275\u0275element(9,"span",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(10,Og,3,2,"tooltip-wrapper",9),e.\u0275\u0275elementStart(11,"tooltip-wrapper",6)(12,"button",7),e.\u0275\u0275listener("click",function(){return r.onNewSubGoal.emit()}),e.\u0275\u0275element(13,"span",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,xg,3,3,"tooltip-wrapper",9),e.\u0275\u0275elementEnd()),2&t){var a=e.\u0275\u0275reference(6);e.\u0275\u0275property("matMenuTriggerFor",a)("disabled",!r.isEditMode),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,11,"New"))("aria-expanded",!0===a.menuOpen),e.\u0275\u0275advance(5),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("tooltipKey",null==r.capabilities||null==r.capabilities.createGoal?null:r.capabilities.createGoal.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=r.capabilities&&null!=r.capabilities.createGoal&&r.capabilities.createGoal.enabled)),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiFeatureSwitch","goalsLinkedGoals"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tooltipKey",null==r.capabilities||null==r.capabilities.createSubgoal?null:r.capabilities.createSubgoal.disabledMessageKey),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!(null!=r.capabilities&&null!=r.capabilities.createSubgoal&&r.capabilities.createSubgoal.enabled)),e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiFeatureSwitch","goalsHierarchies")}},dependencies:[rn.X,Vt.W0,Vt.tN,Vt.D8,T.P,Tr,Mt.F],styles:[".new-btn[_ngcontent-%COMP%]{display:flex;align-items:center;padding:6px 10px}.new-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:0 4px}.new-btn[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{padding:0 4px}.manage-hierarchies-btn[_ngcontent-%COMP%]{border-top:1px solid var(--gray-40, #E1DFDD)}.manage-hierarchies-btn[_ngcontent-%COMP%]:active, .manage-hierarchies-btn[_ngcontent-%COMP%]:focus{border-top:1px solid var(--gray-40, #E1DFDD)}  .mat-menu-panel.new-menu .mat-menu-content{padding:0}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px}.mat-menu-item[_ngcontent-%COMP%]:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}"],changeDetection:0}),i}();function Tg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.hierarchyPane.showHeatmapDisplaySettingsPane())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275element(2,"pbi-icon",13)(3,"span",14),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,1,r.hierarchyPane.showHeatmapDisplaySettingsPane$))}}var hu=function(i){function n(t,r,a,s,c,u,p){var v=i.call(this)||this;return v.hierarchyPane=t,v.capabilityService=r,v.heatmapService=a,v.hierarchyService=s,v.localizationService=c,v.scorecardService=u,v.changeDetector=p,v.filterBy=new e.EventEmitter,v.isEditMode$=v.scorecardService.isEditMode(),v.scorecardCapabilities$=v.capabilityService.getScorecardCapabilities(),v.canEditHeatmap$=v.scorecardCapabilities$.pipe((0,je.U)(function(P){return P.editHeatmap})),v.hasHierarchies$=v.hierarchyService.hasHierarchies$,v.heatmapService.selectedHierarchyItems$.subscribe(function(P){var x=P.length-1;v.dropdownLabel=x>0?v.localizationService.format("MetricsHeatmap_ComparingItems",x):v.localizationService.get("Add_Columns"),v.changeDetector.markForCheck()}),v}return(0,w.__extends)(n,i),n.\u0275fac=function(r){return new(r||n)(e.\u0275\u0275directiveInject(jl),e.\u0275\u0275directiveInject(hr),e.\u0275\u0275directiveInject(gc),e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["scorecard-heatmap-toolbar"]],inputs:{filterText:"filterText"},outputs:{filterBy:"filterBy"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:22,vars:22,consts:[[1,"scorecard-heatmap-toolbar"],[1,"left-actions"],["mat-button","","cdkMonitorElementFocus","",1,"heatmap-menu-button","pbi-fluent-button","pbi-icon-button","pbi-with-text",3,"matMenuTriggerFor"],["name","chevrondownsmall","size","mini",1,"chevrondown"],[1,"right-actions"],[3,"filterText","filterBy"],[3,"isEditMode","scorecardCapabilities","hasHierarchies"],["xPosition","after",1,"heatmap-menu",3,"overlapTrigger"],["heatmapMenu","matMenu"],["mat-menu-item","",3,"disabled","click"],["name","edit","size","small",1,"icon"],["localize","MetricsCustomizeHeatmap"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],["name","settings","size","small",1,"icon"],["localize","DisplaySettings_Open"]],template:function(r,a){if(1&r&&(e.\u0275\u0275elementStart(0,"section",0)(1,"div",1)(2,"button",2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"pbi-icon",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",4)(8,"scorecard-filter",5),e.\u0275\u0275listener("filterBy",function(u){return a.filterBy.emit(u)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(9,"view-switcher")(10,"scorecard-new-button",6),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275pipe(12,"async"),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"mat-menu",7,8)(16,"button",9),e.\u0275\u0275listener("click",function(){return a.hierarchyPane.showHeatmapConfigurationPane()}),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275element(18,"pbi-icon",10)(19,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(20,Tg,4,3,"button",12),e.\u0275\u0275pipe(21,"async"),e.\u0275\u0275elementEnd()),2&r){var s=e.\u0275\u0275reference(15);e.\u0275\u0275advance(2),e.\u0275\u0275property("matMenuTriggerFor",s),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(3,10,"Add_Columns")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(a.dropdownLabel),e.\u0275\u0275advance(3),e.\u0275\u0275property("filterText",a.filterText),e.\u0275\u0275advance(2),e.\u0275\u0275property("isEditMode",e.\u0275\u0275pipeBind1(11,12,a.isEditMode$))("scorecardCapabilities",e.\u0275\u0275pipeBind1(12,14,a.scorecardCapabilities$))("hasHierarchies",e.\u0275\u0275pipeBind1(13,16,a.hasHierarchies$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(17,18,a.hierarchyPane.showHeatmapConfigurationPane$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(21,20,a.canEditHeatmap$))}},dependencies:[j.NgIf,rn.X,Vt.W0,Vt.tN,Vt.D8,ln._,Cc,$l,_c,j.AsyncPipe,Mt.F],styles:[".scorecard-heatmap-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;box-sizing:border-box;padding:0 30px 12px;width:100%;font-family:var(--scorecard-fontFamily);color:var(--scorecard-headerForegroundColor);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid rgba(0,0,0,.05);vertical-align:top}.scorecard-heatmap-toolbar[_ngcontent-%COMP%]   .right-actions[_ngcontent-%COMP%]{display:inline-flex}.scorecard-heatmap-toolbar[_ngcontent-%COMP%]   .right-actions[_ngcontent-%COMP%]   .hierarchies-btn[_ngcontent-%COMP%]{background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}.pbi-fluent-button[_ngcontent-%COMP%]{border:none;display:inline-flex;align-items:center}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}.pbi-fluent-button[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}.pbi-fluent-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .pbi-fluent-button[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin:0 8px}.heatmap-menu-button[_ngcontent-%COMP%]{padding:0 8px}  .mat-menu-panel.heatmap-menu{min-height:fit-content;margin-top:4px}  .mat-menu-panel.heatmap-menu .mat-menu-content{padding:0}  .mat-menu-panel.heatmap-menu .mat-menu-item{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px}  .mat-menu-panel.heatmap-menu .mat-menu-item:disabled{background:transparent;color:var(--gray-80, #B3B0AD)}  .mat-menu-panel.heatmap-menu .mat-menu-item pbi-icon{display:flex;padding-right:8px}"],changeDetection:0}),n}(se.w);function Eg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",13),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()),2&i){var t=n.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.hierarchyName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(": ",t.levels.join(" > "),"")}}function Ig(i,n){if(1&i&&e.\u0275\u0275template(0,Eg,5,2,"div",12),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("ngForOf",t.displayPaths)}}function Dg(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",10),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,Ig,1,1,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit,r=e.\u0275\u0275reference(5);e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiTooltip",r)("pbiTooltipDisabled",t.showingAll),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.showingAll?e.\u0275\u0275pipeBind1(3,3,"MetricsHierarchy_SelectHierarchy"):t.displayLabel," ")}}function kg(i,n){1&i&&e.\u0275\u0275element(0,"span",14)}function Fg(i,n){1&i&&e.\u0275\u0275element(0,"pbi-spinner",15)}var Vg=function(n){return{active:n}};function Ag(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"button",4,5),e.\u0275\u0275template(2,Dg,6,5,"ng-container",6),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,kg,1,0,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(6,Fg,1,0,"pbi-spinner",8),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275element(8,"pbi-icon",9),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(1),r=e.\u0275\u0275reference(5),a=e.\u0275\u0275nextContext(),s=e.\u0275\u0275reference(3);e.\u0275\u0275property("matMenuTriggerFor",s)("ngClass",e.\u0275\u0275pureFunction1(9,Vg,!0===t.menuOpen)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(3,5,a.hierarchyDisplayInfo$))("ngIfElse",r),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,7,a.isSwitchingPath$))}}function Rg(i,n){1&i&&e.\u0275\u0275element(0,"pbi-lazy-load",16)}var yc=function(){function i(n,t){this.hierarchyService=n,this.scorecardService=t,this.showButton$=this.hierarchyService.hasHierarchies$,this.hierarchyDisplayInfo$=this.hierarchyService.getHierarchyDisplayInfoObservable(this.scorecardService.hierarchyPaths$),this.isSwitchingPath$=this.scorecardService.isSwitchingHierarchyPath()}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(et))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-hierarchy-button"]],decls:5,vars:3,consts:[["cdkMonitorElementFocus","","mat-button","","aria-expanded","hierarchySlicerMenuTrigger.menuOpen === true","class","hierarchy-btn pbi-fluent-button pbi-icon-button pbi-with-text",3,"matMenuTriggerFor","ngClass",4,"ngIf"],["xPosition","after","yPosition","below",1,"hierarchy-slicer-menu"],["hierarchySlicerMenu","matMenu"],["matMenuContent",""],["cdkMonitorElementFocus","","mat-button","","aria-expanded","hierarchySlicerMenuTrigger.menuOpen === true",1,"hierarchy-btn","pbi-fluent-button","pbi-icon-button","pbi-with-text",3,"matMenuTriggerFor","ngClass"],["hierarchySlicerMenuTrigger","matMenuTrigger"],[4,"ngIf","ngIfElse"],["loadingHierarchies",""],["class","pbi-spinner-small",4,"ngIf"],["size","mini","name","chevrondownsmall","localizeTooltip","View_Options",1,"icon"],[3,"pbiTooltip","pbiTooltipDisabled"],["hierarchySlicerTooltip",""],[4,"ngFor","ngForOf"],[1,"hierarchy-name"],["localize","All"],[1,"pbi-spinner-small"],["modulePath","@powerbi/GoalsHierarchy/goals-hierarchy.module#GoalsHierarchyModule","componentId","HierarchySlicerComponentId"]],template:function(t,r){1&t&&(e.\u0275\u0275template(0,Ag,9,11,"button",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"mat-menu",1,2),e.\u0275\u0275template(4,Rg,1,0,"ng-template",3),e.\u0275\u0275elementEnd()),2&t&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,r.showButton$))},dependencies:[j.NgClass,j.NgForOf,j.NgIf,ou.R,rn.X,Zr.r,Vt.W0,Vt.D8,Vt.hd,ln._,Jn.k,qe.V,j.AsyncPipe,Mt.F],styles:['.hierarchy-btn[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px;background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}.hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{height:20px}html:not([dir="rtl"])[_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-spinner[_ngcontent-%COMP%]{margin-right:8px}html:not([dir="rtl"])[_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .hierarchy-btn[_ngcontent-%COMP%]   pbi-icon[_ngcontent-%COMP%]{margin-right:8px}.hierarchy-name[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}'],changeDetection:0}),i}(),Lg=M(24150);function Gg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",7),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.scorecardName=s)}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngModel",r.scorecardName)}}function Ng(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-svg-icon",8),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onScorecardNameEdit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("can-display",e.\u0275\u0275pipeBind1(1,3,r.isEditMode$)),e.\u0275\u0275property("name","edit_20_regular")}}function Hg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",7),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.scorecardDescription=s)}),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("ngModel",r.scorecardDescription)}}function zg(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-svg-icon",11),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.onDescriptionEdit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("can-display",e.\u0275\u0275pipeBind1(1,3,r.isEditMode$)),e.\u0275\u0275property("name","edit_20_regular")}}function qg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",9),e.\u0275\u0275template(1,Hg,1,1,"input",4),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,zg,2,5,"tri-svg-icon",10),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiEditableLabel",t.pbiEditableDescriptionOptions)("pbiEditableLabelValue",t.scorecardDescription)("pbiEditableLabelMode",e.\u0275\u0275pipeBind1(2,5,t.isEditMode$))("pbiEditableLabelEditable",t.isScorecardDescriptionEditable),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.isScorecardDescriptionEditable)}}function Bg(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",3),e.\u0275\u0275template(2,Gg,1,1,"input",4),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,Ng,2,5,"tri-svg-icon",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,qg,4,7,"span",6),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("pbiEditableLabel",t.pbiEditableNameOptions)("pbiEditableLabelValue",t.scorecardName)("pbiEditableLabelMode",e.\u0275\u0275pipeBind1(3,6,t.isEditMode$))("pbiEditableLabelEditable",t.isScorecardNameEditable),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.isScorecardNameEditable),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!t.scorecardDescription)}}function Ug(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1,"-"),e.\u0275\u0275elementEnd())}function jg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",12),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,Ug,2,0,"div",13),e.\u0275\u0275elementStart(3,"div",14),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("title",t.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.scorecardName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showTitleDash),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("title",t.scorecardDescription),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.scorecardDescription)}}var Ql=function(){function i(n,t,r){this.changeDetector=n,this.scorecardService=t,this.telemetryService=r,this.isNewHeader=!0,this.isScorecardNameEditable=!1,this.isScorecardDescriptionEditable=!1,this.isEditMode$=this.scorecardService.isEditMode()}return i.prototype.ngOnInit=function(){var n=this;this.showTitleDash=void 0!==this.scorecardDescription&&""!==this.scorecardDescription&&this.isNewHeader;var t=this.scorecardName,r=this.scorecardDescription;this.pbiEditableNameOptions={disableClick:!0,customTooltip:!1,inputMatchLabelWidth:!1,onEdit:this.onScorecardNameEdit.bind(this),onBlur:function(){return(0,w.__awaiter)(n,void 0,void 0,function(){return(0,w.__generator)(this,function(s){switch(s.label){case 0:return this.isScorecardNameEditable=!1,t===this.scorecardName?[2]:(this.telemetryService.logEvent(Bi),[4,this.updateScorecardDetails()]);case 1:return s.sent(),t=this.scorecardName,[2]}})})}},this.pbiEditableDescriptionOptions={disableClick:!0,customTooltip:!1,inputMatchLabelWidth:!1,onEdit:this.onDescriptionEdit.bind(this),onBlur:function(){return(0,w.__awaiter)(n,void 0,void 0,function(){return(0,w.__generator)(this,function(s){switch(s.label){case 0:return this.isScorecardDescriptionEditable=!1,r===this.scorecardDescription?[2]:(this.telemetryService.logEvent(jn),[4,this.updateScorecardDetails()]);case 1:return s.sent(),r=this.scorecardDescription,[2]}})})}}},i.prototype.ngOnChanges=function(n){n.scorecardDescription&&(this.showTitleDash=void 0!==this.scorecardDescription&&""!==this.scorecardDescription)},i.prototype.onScorecardNameEdit=function(){this.isScorecardNameEditable=!0,this.changeDetector.markForCheck()},i.prototype.onDescriptionEdit=function(){this.isScorecardDescriptionEditable=!0,this.changeDetector.markForCheck()},i.prototype.updateScorecardDetails=function(){return this.scorecardService.updateScorecard({name:this.scorecardName,description:this.scorecardDescription})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(Ca.y0))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-title"]],inputs:{scorecardName:"scorecardName",scorecardDescription:"scorecardDescription",isTitleEditable:"isTitleEditable",isNewHeader:"isNewHeader"},features:[e.\u0275\u0275NgOnChangesFeature],decls:4,vars:4,consts:[["data-testid","scorecard-title",1,"scorecard-title"],[4,"ngIf","ngIfElse"],["staticTitle",""],[1,"editableLabel"],[3,"ngModel","ngModelChange",4,"pbiEditableLabel","pbiEditableLabelValue","pbiEditableLabelMode","pbiEditableLabelEditable"],["tri-svg-icon-16","","class","tri-svg","data-testid","edit-scorecard-title",3,"name","can-display","click",4,"ngIf"],["class","editableDescription",4,"ngIf"],[3,"ngModel","ngModelChange"],["tri-svg-icon-16","","data-testid","edit-scorecard-title",1,"tri-svg",3,"name","click"],[1,"editableDescription"],["tri-svg-icon-16","","class","tri-svg",3,"name","can-display","click",4,"ngIf"],["tri-svg-icon-16","",1,"tri-svg",3,"name","click"],[1,"title",3,"title"],["class","dash",4,"ngIf"],[1,"subtitle",3,"title"],[1,"dash"]],template:function(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"section",0),e.\u0275\u0275template(1,Bg,6,8,"ng-container",1),e.\u0275\u0275template(2,jg,5,5,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&t){var a=e.\u0275\u0275reference(3);e.\u0275\u0275classProp("old-header",!r.isNewHeader),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isTitleEditable)("ngIfElse",a)}},dependencies:[j.NgIf,Ve.Fj,Ve.JJ,Ve.On,Lg.D,gr.M,j.AsyncPipe],styles:[".scorecard-title.old-header[_ngcontent-%COMP%]{display:block}.scorecard-title.old-header[_ngcontent-%COMP%]   .editableLabel[_ngcontent-%COMP%]     pbi-text-label{max-width:90%}.scorecard-title.old-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:10px}.scorecard-title.old-header[_ngcontent-%COMP%]   .editableDescription[_ngcontent-%COMP%]     pbi-text-label{max-width:90%}.scorecard-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;box-sizing:border-box;padding:12px 30px 6px;width:100%;background-color:var(--scorecard-headerBackgroundColor)}.scorecard-title[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--scorecard-headerForegroundColor);font-family:var(--scorecard-fontFamily);font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.scorecard-title[_ngcontent-%COMP%]   .editableLabel[_ngcontent-%COMP%]{height:40px;display:flex;align-items:center;padding-bottom:0;margin-right:10px;color:var(--scorecard-headerForegroundColor);font-family:var(--scorecard-fontFamily);font-size:var(--vlg-font-size, 18px);font-weight:var(--font-weight-semi-bold, 600)}.scorecard-title[_ngcontent-%COMP%]   .editableLabel[_ngcontent-%COMP%]:hover   .tri-svg.can-display[_ngcontent-%COMP%]{visibility:visible}.scorecard-title[_ngcontent-%COMP%]   .editableDescription[_ngcontent-%COMP%]{flex-grow:100;display:flex;align-items:center;color:var(--scorecard-headerForegroundColor);opacity:.9;font-family:var(--scorecard-fontFamily);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}.scorecard-title[_ngcontent-%COMP%]   .editableDescription[_ngcontent-%COMP%]:hover   .tri-svg.can-display[_ngcontent-%COMP%]{visibility:visible}.scorecard-title[_ngcontent-%COMP%]   .tri-svg[_ngcontent-%COMP%]{height:16px;width:16px;margin-left:6px;margin-right:4px;visibility:hidden}.scorecard-title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 12px 6px 16px;box-sizing:border-box;border:2px solid #0F6CBD;border-radius:4px}.scorecard-title[_ngcontent-%COMP%]   .dash[_ngcontent-%COMP%]{padding:0 8px}.scorecard-title[_ngcontent-%COMP%]   .dash[_ngcontent-%COMP%], .scorecard-title[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:var(--scorecard-headerForegroundColor);opacity:.9;font-family:var(--scorecard-fontFamily);font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400)}"],changeDetection:0}),i}();function Wg(i,n){if(1&i&&e.\u0275\u0275element(0,"scorecard-title",7),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecardName",t.scorecard.name)("isTitleEditable",t.isTitleEditable)}}function $g(i,n){1&i&&e.\u0275\u0275element(0,"scorecard-hierarchy-button")}function Qg(i,n){1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,$g,1,0,"scorecard-hierarchy-button",8),e.\u0275\u0275elementContainerEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiFeatureSwitch","goalsHierarchies"))}function Xg(i,n){1&i&&e.\u0275\u0275element(0,"scorecard-hierarchy-button")}function Yg(i,n){1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Xg,1,0,"scorecard-hierarchy-button",8),e.\u0275\u0275elementContainerEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("pbiFeatureSwitch","goalsHierarchies"))}var gu=function(){function i(n,t){this.hierarchyService=n,this.featureSwitchService=t,this.filterBy=new e.EventEmitter,this.onLinkedMetricInit=new e.EventEmitter,this.onNewGoal=new e.EventEmitter,this.onNewSubGoal=new e.EventEmitter,this.isTitleEditable=this.featureSwitchService.featureSwitches.goalsSkipScorecardCreationPane}return i.prototype.ngOnInit=function(){this.hasHierarchies$=this.hierarchyService.hasHierarchies$},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(_n.vZ))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-list-toolbar"]],inputs:{isEditMode:"isEditMode",scorecard:"scorecard",scorecardCapabilities:"scorecardCapabilities",numberOfSelectedGoals:"numberOfSelectedGoals",filterText:"filterText",showTitle:"showTitle"},outputs:{filterBy:"filterBy",onLinkedMetricInit:"onLinkedMetricInit",onNewGoal:"onNewGoal",onNewSubGoal:"onNewSubGoal"},decls:10,vars:10,consts:[["data-testid","scorecard-list-toolbar",1,"scorecard-list-toolbar"],[1,"left-actions","actions-container"],[3,"scorecardName","isTitleEditable",4,"ngIf"],[4,"ngIf"],[1,"right-actions","actions-container"],[3,"filterText","filterBy"],[3,"isEditMode","scorecardCapabilities","numberOfSelectedGoals","hasHierarchies","onNewGoal","onNewSubGoal","onLinkedMetricInit"],[3,"scorecardName","isTitleEditable"],[4,"pbiFeatureSwitch"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"section",0)(1,"div",1),e.\u0275\u0275template(2,Wg,1,2,"scorecard-title",2),e.\u0275\u0275template(3,Qg,2,1,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",4),e.\u0275\u0275template(5,Yg,2,1,"ng-container",3),e.\u0275\u0275elementStart(6,"scorecard-filter",5),e.\u0275\u0275listener("filterBy",function(s){return r.filterBy.emit(s)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"view-switcher"),e.\u0275\u0275elementStart(8,"scorecard-new-button",6),e.\u0275\u0275listener("onNewGoal",function(){return r.onNewGoal.emit()})("onNewSubGoal",function(){return r.onNewSubGoal.emit()})("onLinkedMetricInit",function(){return r.onLinkedMetricInit.emit()}),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.showTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.showTitle),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.showTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("filterText",r.filterText),e.\u0275\u0275advance(2),e.\u0275\u0275property("isEditMode",r.isEditMode)("scorecardCapabilities",r.scorecardCapabilities)("numberOfSelectedGoals",r.numberOfSelectedGoals)("hasHierarchies",e.\u0275\u0275pipeBind1(9,8,r.hasHierarchies$)))},dependencies:[j.NgIf,T.P,Cc,Ql,$l,yc,_c,j.AsyncPipe],styles:["[_nghost-%COMP%]{--toolbar-padding: 0px 30px 12px 30px}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap;box-sizing:border-box;padding:var(--toolbar-padding);width:100%;font-family:var(--scorecard-fontFamily);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);vertical-align:top}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]     .no-line .mat-form-field-underline{display:none}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{border-top:0px}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]     .scorecard-title{padding:0}[_nghost-%COMP%]   .scorecard-list-toolbar[_ngcontent-%COMP%]     .scorecard-title .editableLabel{font-size:var(--lg-font-size)}"],changeDetection:0}),i}(),fu=function(){function i(){this.filterBy=new e.EventEmitter}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-metric-picker-toolbar"]],inputs:{filterText:"filterText"},outputs:{filterBy:"filterBy"},decls:4,vars:1,consts:[[1,"scorecard-picker-toolbar"],[1,"left-actions"],[1,"right-actions"],[3,"filterText","filterBy"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"section",0),e.\u0275\u0275element(1,"div",1),e.\u0275\u0275elementStart(2,"div",2)(3,"scorecard-filter",3),e.\u0275\u0275listener("filterBy",function(s){return r.filterBy.emit(s)}),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("filterText",r.filterText))},dependencies:[$l],styles:[".scorecard-picker-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;box-sizing:border-box;padding:0 30px 12px;width:100%;font-family:var(--scorecard-fontFamily);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);vertical-align:top}"],changeDetection:0}),i}(),bc=M(78181),Zg=M(69437),Jg=["scorecardStatusTiles"];function Kg(i,n){1&i&&e.\u0275\u0275element(0,"pbi-office-icon",11)}var e1=function(n){return{"background-color":n}};function t1(i,n){if(1&i&&e.\u0275\u0275element(0,"div",12),2&i){var t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275styleMap(e.\u0275\u0275pureFunction1(2,e1,t.color))}}function n1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-button-toggle",5),e.\u0275\u0275listener("click",function(){var c=e.\u0275\u0275restoreView(t).$implicit,u=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(u.onStatusTileClicked(c))}),e.\u0275\u0275elementStart(1,"span",6),e.\u0275\u0275template(2,Kg,1,0,"pbi-office-icon",7),e.\u0275\u0275template(3,t1,1,4,"div",8),e.\u0275\u0275elementStart(4,"div",9),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"span",10),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd()()}if(2&i){var r=n.$implicit;e.\u0275\u0275classProp("filtered-on",r.filteredOn)("hide",r.collapsed),e.\u0275\u0275property("checked",r.filteredOn),e.\u0275\u0275attribute("aria-label",r.displayName),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.filteredOn),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.filteredOn),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.displayName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.count)}}function r1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onCollapse())}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("expanded",!r.collapsed),e.\u0275\u0275attribute("aria-label",r.collapseButtonAriaLabel),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.collapseButtonLabel)}}var mu=function(){function i(n,t){this.changeDetectorRef=n,this.localizationService=t,this.onStatusSelected=new e.EventEmitter,this.collapsed=!0,this.columnGap=8,this.enableCollapse=!1,this.tileMinWidth=140,this.tileMaxWidth=210,this.goalStatusHelper=new N.p(this.localizationService)}return i.prototype.onResize=function(){this.updateGoalStatusTiles()},i.prototype.ngAfterViewInit=function(){this.updateGoalStatusTiles()},i.prototype.ngOnChanges=function(){this.updateGoalStatusTiles()},i.prototype.onStatusTileClicked=function(n){if(_.isNil(this.selectedStatuses)&&(this.selectedStatuses=[]),n.status){var t=_.find(this.selectedStatuses,function(r){return N.p.statusesMatch(r,n.status)});t?this.selectedStatuses=_.without(this.selectedStatuses,t):this.selectedStatuses.push(n.status)}else this.selectedStatuses=[];this.updateGoalStatusTiles(),this.onStatusSelected.emit(this.selectedStatuses)},i.prototype.onCollapse=function(){this.collapsed=!this.collapsed,this.updateGoalStatusTiles()},i.prototype.updateGoalStatusTiles=function(){this.createStatusTiles(),this.calculateGrid(),this.collapseGrid(),this.changeDetectorRef.markForCheck()},i.prototype.createStatusTiles=function(){var n;if(this.goals&&0!==(null===(n=this.goals)||void 0===n?void 0:n.length)&&(1!==this.goals.length||!_.isNil(this.goals[0].name))){var t=q.flattenGoals(this.goals);this.statusTiles=[];var r=_.isEmpty(this.selectedStatuses);this.statusTiles.push({displayName:this.localizationService.get("MetricsName_New"),count:_.size(t),collapsed:!1,filteredOn:r});for(var a=_.filter(this.goalStatusList,function(G){return!G.historical}),c=0,u=N.p.getDistinctStatuses(t,this.goalStatusesByScorecardId,a);c<u.length;c++){var p=u[c],v=this.goalStatusHelper.tryLocalizeDisplayName(p.displayName)||this.localizationService.get("NullValue"),P=N.p.listIncludesMatchingStatus(this.selectedStatuses,p),x=N.p.getGoalStatusIconColor(p.color);this.statusTiles.push({status:p,displayName:v,color:x,count:p.count,collapsed:!1,filteredOn:P})}}},i.prototype.calculateGrid=function(){var n,t;if(this.statusTiles&&0!==(null===(n=this.statusTiles)||void 0===n?void 0:n.length)&&null!==(t=this.scorecardStatusTiles)&&void 0!==t&&t.nativeElement){var r=this.statusTiles.length;if(this.availableSpace=this.scorecardStatusTiles.nativeElement.clientWidth,this.availableSpace<this.tileMinWidth)return this.gridLayout={numberOfRows:r,numberOfColumns:1},this.gridStyle={"column-gap":"".concat(this.columnGap,"px"),"grid-template-columns":"repeat(".concat(this.gridLayout.numberOfColumns,", 1fr)")},void(this.enableCollapse=!0);if(this.availableSpace>r*this.tileMaxWidth+(r-1)*this.columnGap)return this.gridLayout={numberOfRows:1,numberOfColumns:r},this.gridStyle={"column-gap":"".concat(this.columnGap,"px"),"grid-template-columns":"repeat(auto-fill, ".concat(this.tileMaxWidth,"px)")},void(this.enableCollapse=!1);for(var a=Math.floor((this.availableSpace-this.tileMinWidth)/(this.tileMinWidth+this.columnGap)+1),c=[];a>0&&(this.availableSpace-(a-1)*this.columnGap)/a<=this.tileMaxWidth;)c.push({numberOfRows:Math.ceil(this.statusTiles.length/a),numberOfColumns:a}),a-=1;switch(c.length){case 0:a=Math.floor((this.availableSpace-this.tileMinWidth)/(this.tileMinWidth+this.columnGap)+1),this.gridLayout={numberOfRows:Math.ceil(this.statusTiles.length/a),numberOfColumns:a};break;case 1:this.gridLayout=c[0];break;default:if(this.availableSpace>=768){this.gridLayout=c[c.length-1];break}if(this.availableSpace<=767&&this.availableSpace>480){this.gridLayout=c[Math.ceil(c.length/2)-1];break}if(this.availableSpace<=480){this.gridLayout=c[0];break}}this.gridStyle={"column-gap":"".concat(this.columnGap,"px"),"grid-template-columns":"repeat(".concat(this.gridLayout.numberOfColumns,", 1fr)")},this.enableCollapse=this.gridLayout.numberOfRows>1}},i.prototype.collapseGrid=function(){if(this.enableCollapse){if(!this.collapsed)return this.collapseButtonLabel=this.localizationService.get("Collapse"),void(this.collapseButtonAriaLabel=this.localizationService.get("CollapseStatuses"));for(var n=!0,t=this.gridLayout.numberOfColumns-1;t<this.statusTiles.length;t++)this.statusTiles[t].filteredOn&&(n=!1);n?this.standardCollapse():this.rearrangeCollapse(),this.collapseButtonLabel=this.localizationService.format("ShowXMore",[this.collapsedStatuses]),this.collapseButtonAriaLabel=this.localizationService.format("ShowMoreStatuses",[this.collapsedStatuses])}},i.prototype.standardCollapse=function(){for(var n=this.gridLayout.numberOfColumns-1;n<this.statusTiles.length;n++)this.statusTiles[n].collapsed=!0;this.collapsedStatuses=this.statusTiles.length-(this.gridLayout.numberOfColumns-1)},i.prototype.rearrangeCollapse=function(){var n=[this.statusTiles[0]],t=this.statusTiles.filter(function(s){return s.filteredOn&&s.status}),r=this.statusTiles.filter(function(s){return!s.filteredOn&&s.status});n=(n=n.concat(t)).concat(r),this.collapsedStatuses=0;for(var a=0;a<n.length;a++)!n[a].filteredOn&&a>this.gridLayout.numberOfColumns-2&&(n[a].collapsed=!0,this.collapsedStatuses+=1);this.statusTiles=n},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard-status-tiles"]],viewQuery:function(t,r){var a;(1&t&&e.\u0275\u0275viewQuery(Jg,5),2&t)&&(e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.scorecardStatusTiles=a.first))},hostBindings:function(t,r){1&t&&e.\u0275\u0275listener("resize",function(s){return r.onResize(s)},!1,e.\u0275\u0275resolveWindow)},inputs:{goals:"goals",goalStatusesByScorecardId:"goalStatusesByScorecardId",goalStatusList:"goalStatusList",selectedStatuses:"selectedStatuses"},outputs:{onStatusSelected:"onStatusSelected"},features:[e.\u0275\u0275NgOnChangesFeature],decls:5,vars:4,consts:[[1,"scorecard-status-tiles"],["multiple","",1,"status-tiles-btn-group"],["scorecardStatusTiles",""],["class","status-tile",3,"checked","filtered-on","hide","click",4,"ngFor","ngForOf"],["class","status-tiles-collapse-btn",3,"expanded","click",4,"ngIf"],[1,"status-tile",3,"checked","click"],[1,"status-tile-flex-container"],["class","status-tile-icon","name","CheckmarkWithDynamicColor_16",4,"ngIf"],["class","status-tile-dot",3,"style",4,"ngIf"],[1,"status-tile-name"],[1,"status-tile-count"],["name","CheckmarkWithDynamicColor_16",1,"status-tile-icon"],[1,"status-tile-dot"],[1,"status-tiles-collapse-btn",3,"click"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"section",0)(1,"mat-button-toggle-group",1,2),e.\u0275\u0275template(3,n1,8,10,"mat-button-toggle",3),e.\u0275\u0275template(4,r1,3,4,"button",4),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275styleMap(r.gridStyle),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.statusTiles),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.enableCollapse))},dependencies:[j.NgForOf,j.NgIf,bc.A9,bc.Yi,Zg.m],styles:[".scorecard-status-tiles[_ngcontent-%COMP%]{box-sizing:border-box;padding:0 30px;font-family:var(--scorecard-fontFamily);background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD);width:100%}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]{display:grid;row-gap:12px;grid-template-rows:repeat(auto-fill,40px);column-gap:8px;grid-template-columns:repeat(auto-fill,140px);padding:12px 0;width:100%;border:var(--focus-outline-definition, 2.5px solid) transparent}@media screen and (-ms-high-contrast: active){.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]{border:none}}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;justify-content:space-between;min-width:140px;max-width:210px;padding:0;box-shadow:none;border:1px solid var(--gray-30, #EDEBE9);border-radius:2px;background-color:var(--fluent-theme-white-color, #FFF)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile.hide[_ngcontent-%COMP%]{display:none}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]:hover{background-color:var(--gray-20, #F3F2F1)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]:active{background-color:var(--gray-30, #EDEBE9)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile.filtered-on[_ngcontent-%COMP%]{border:1px solid var(--gray-140, #484644)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button{width:100%;padding:10px 12px}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content{display:flex;box-sizing:border-box;justify-content:space-between;max-height:20px;padding:0;line-height:20px}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container{text-align:left;max-width:80%}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container .status-tile-dot{display:inline-block;height:8px;width:8px;margin:6px 8px 6px 0;border-radius:50%;background-color:var(--fluent-theme-black-color, #000)}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container .status-tile-icon{display:inline-block;vertical-align:top;height:16px;width:16px;margin:1px 4px 2px 0}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-flex-container .status-tile-name{display:inline-block;width:100%;line-height:20px;font-family:var(--scorecard-fontFamily);font-size:var(--md-font-size, 14px);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tile[_ngcontent-%COMP%]     .mat-button-toggle-button .mat-button-toggle-label-content .status-tile-count{max-width:20%;font-family:var(--scorecard-fontFamily);font-size:var(--md-font-size, 14px);text-align:right;line-height:20px}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin:auto 0 auto auto;padding:0;color:var(--fluent-theme-link-darker-alt-color, #106EBE);background:transparent;border:var(--focus-outline-definition, 2.5px solid) transparent}@media screen and (-ms-high-contrast: active){.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]{border:none}}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:hover, .scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:active{border:var(--focus-outline-definition, 2.5px solid) transparent}@media screen and (-ms-high-contrast: active){.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:hover, .scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn[_ngcontent-%COMP%]:active{border:none}}.scorecard-status-tiles[_ngcontent-%COMP%]   .status-tiles-btn-group[_ngcontent-%COMP%]   .status-tiles-collapse-btn.expanded[_ngcontent-%COMP%]{flex-direction:row;margin:auto auto auto 12px}"],changeDetection:0}),i}(),o1=M(87582),a1=M(85928),s1=M(48741),wc=function(){function i(n,t,r,a){this.appSettings=n,this.mashupService=t,this.httpClient=r,this.goalsHttpService=a}return i.prototype.evaluateQuery=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a;return(0,w.__generator)(this,function(u){switch(u.label){case 0:return[4,this.mashupService.getPQEndpoint().pipe((0,he.q)(1)).toPromise()];case 1:return t=u.sent(),[4,this.mashupService.getPQToken("".concat(this.appSettings.powerQueryResourceName,"/.default")).pipe((0,he.q)(1)).toPromise()];case 2:return r=u.sent(),a="".concat(t,"/api/evaluator/evaluate"),[4,this.httpClient.post(a,{mashupDocument:n,queryName:"Query",fastCombine:!0},{headers:{"x-ms-api-version":"2.0",authorization:"Bearer ".concat(r)}}).pipe((0,he.q)(1)).toPromise()];case 3:return[2,u.sent()]}})})},i.prototype.importGoal=function(n,t,r,a,s){return(0,w.__awaiter)(this,void 0,void 0,function(){var c,u,p,v,P,x,G,Y,ue,Se,Ae,xe,Je,ut;return(0,w.__generator)(this,function(It){switch(It.label){case 0:c=[],u=_.indexOf(a,"Name"),p=_.indexOf(a,"Owner"),v=_.indexOf(a,"Status"),P=_.indexOf(a,"Value"),x=_.indexOf(a,"Due Date"),G=_.indexOf(a,"Notes"),c.push(u,p,v,P,x,G),-1!==v&&(Y=this.getStatus(r,v,s)),ue=0,Se=0,Ae=r.rows,It.label=1;case 1:return Se<Ae.length?[4,this.goalsHttpService.createGoal(n,t,{name:(xe=Ae[Se])[u],owner:xe[p],completionDate:xe[x]}).pipe().toPromise()]:[3,5];case 2:return Je=It.sent(),ut={timestamp:"2:00",status:Y[ue]},ue+=1,[4,this.goalsHttpService.createGoalValue(n,t,Je.id,ut)];case 3:It.sent(),It.label=4;case 4:return Se++,[3,1];case 5:return[2]}})})},i.prototype.getStatus=function(n,t,r){for(var s=[],c=0,u=n.rows;c<u.length;c++){var v=u[c][t].replace(/\s/g,"");s.push(v)}for(var P=[],x=0,G=s;x<G.length;x++){var ue=N.p.getGoalStatusId(G[x],r);P.push(ue)}return P},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Go.de),e.\u0275\u0275inject(a1.M),e.\u0275\u0275inject(s1.eN),e.\u0275\u0275inject(Ye))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}();function l1(i,n){if(1&i&&e.\u0275\u0275element(0,"message-banner",10),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBannerModelColumn)}}function c1(i,n){if(1&i&&e.\u0275\u0275element(0,"message-banner",10),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275property("viewModel",t.messageBannerModelEmpty)}}function u1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("value",n.index),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.sheetName)}}function d1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275element(1,"p",12),e.\u0275\u0275elementStart(2,"select",13),e.\u0275\u0275listener("change",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.onSelectTable(s.target.value))}),e.\u0275\u0275template(3,u1,2,2,"option",14),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.goalPreviewData)}}function p1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"option",24),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function h1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"th")(1,"div",19)(2,"div",20)(3,"select",21),e.\u0275\u0275listener("ngModelChange",function(u){var v=e.\u0275\u0275restoreView(t).index,P=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(P.matchedHeaderName[v]=u)}),e.\u0275\u0275text(4),e.\u0275\u0275template(5,p1,2,2,"option",22),e.\u0275\u0275element(6,"option"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",23),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()()()}if(2&i){var r=n.index,a=n.$implicit,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",s.matchedHeaderName[r]),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",s.matchedHeaderName[r]," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",s.scorecardAttributes),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(a)}}function g1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"td"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function f1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tr"),e.\u0275\u0275template(1,g1,2,1,"td",18),e.\u0275\u0275elementEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function m1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",16)(1,"table",17)(2,"tr"),e.\u0275\u0275template(3,h1,9,4,"th",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,f1,2,1,"tr",18),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.matchedHeaderName)("ngForOf",t.goalImportFileMetadata.tables[t.selectTable].column),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.goalImportFileMetadata.tables[t.selectTable].rows)}}function v1(i,n){1&i&&e.\u0275\u0275element(0,"pbi-spinner",25)}function C1(i,n){1&i&&e.\u0275\u0275element(0,"span",32)}function _1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",33),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.numGoals,"")}}function y1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",26)(1,"div",27)(2,"button",28),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.importFromFile())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.close())}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(4,C1,1,0,"span",30),e.\u0275\u0275template(5,_1,2,1,"span",31),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",r.hasDataLoaded),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.hasDataLoaded)}}var b1=function(){function i(n,t,r,a){this.data=n,this.mashupEvaluationService=t,this.localizationService=r,this.dialogService=a,this.selectTable=0,this.maxPercent=0,this.numGoals=0,this.emptyFile=!1,this.exceedsColumns=!1,this.hasDataLoaded=!1,this.messageBannerModelColumn={bannerType:0,iconName:"pbi-glyph-warning",message:this.localizationService.get("MetricsScorecard_Import_Error_Column_Num")},this.messageBannerModelEmpty={bannerType:0,iconName:"pbi-glyph-error",message:this.localizationService.get("MetricsScorecard_Import_Error_Empty_File")}}return i.prototype.ngOnInit=function(){var n=this;this.goalImportFileMetadata={file_name:"ExampleFile",tables:[]},this.goalPreviewData=this.goalImportFileMetadata.tables,this.scorecardAttributes=["Name","Owner","Status","Value","Progress","Due Date","Notes"],this.getAllTables().then(function(t){if(_.isEmpty(t))n.emptyFile=!0;else{for(var r=0,a=t;r<a.length;r++){var s=a[r];n.goalPreviewData.push({sheetName:s.sheetName,tableName:s.tableName,column:[],rows:[]})}n.onSelectTable(0)}})},i.prototype.onSelectTable=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return this.selectTable=n,t=this.goalImportFileMetadata.tables[n],_.isEmpty(t.column)?(this.hasDataLoaded=!1,[4,this.evaluatePreviewTable(t.sheetName,t.tableName)]):[3,2];case 1:r=a.sent(),this.goalImportFileMetadata.tables[this.selectTable].column=r.columns,this.goalImportFileMetadata.tables[this.selectTable].rows=r.rows,a.label=2;case 2:return this.setHeaders(),this.numGoals=this.goalImportFileMetadata.tables[this.selectTable].rows.length,this.exceedsColumns=this.goalImportFileMetadata.tables[this.selectTable].column.length>=7,[2]}})})},i.prototype.setHeaders=function(){this.excelHeaders=this.goalImportFileMetadata.tables[this.selectTable].column;for(var n=[],t=0,r=this.excelHeaders;t<r.length;t++)this.stringSimilarity(r[t],this.scorecardAttributes),n.push(this.maxPercentHeader);this.matchedHeaderName=n,this.hasDataLoaded=!0},i.prototype.getAllTables=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,r,a,s,c,u,p;return(0,w.__generator)(this,function(v){switch(v.label){case 0:return n=this.data.fileData,b.fF.assertValue(this.data.fileData,"Missing file data"),[4,this.mashupEvaluationService.evaluateQuery('section Section1; shared Query = let source = Excel.Workbook(Binary.FromText("'.concat(n,'")) in source;'))];case 1:for(t=v.sent(),r=[],a=_.indexOf(t.columns,"Name"),s=_.indexOf(t.columns,"Kind"),c=0,u=t.rows;c<u.length;c++)"Table"===(p=u[c])[s]&&r.push({sheetName:p[a],tableName:p[s],column:[],rows:[]});return[2,r]}})})},i.prototype.importFromFile=function(){var n;return(0,w.__awaiter)(this,void 0,void 0,function(){var r;return(0,w.__generator)(this,function(a){switch(a.label){case 0:return[4,this.mashupEvaluationService.importGoal((r=this.data.scorecard).groupId,r.id,this.goalImportFileMetadata.tables[this.selectTable],this.matchedHeaderName,null===(n=r.goalStatuses)||void 0===n?void 0:n.statuses)];case 1:return a.sent(),this.close(),[2]}})})},i.prototype.evaluatePreviewTable=function(n,t){return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(a){return[2,this.mashupEvaluationService.evaluateQuery('section Section1; shared Query = let source = Excel.Workbook(Binary.FromText("'.concat(this.data.fileData,'")){[Item="').concat(n,'",Kind="').concat(t,'"]}[Data] in source;'))]})})},i.prototype.stringSimilarity=function(n,t,r){function a(Je,ut){Je=" ".repeat(ut-1)+Je.toLowerCase()+" ".repeat(ut-1);for(var It=new Array(Je.length-ut+1),mt=0;mt<It.length;mt++)It[mt]=Je.slice(mt,mt+ut);return It}void 0===r&&(r=2),this.maxPercent=0;for(var s=0,c=0,u=t;c<u.length;c++){var p=u[c];if(!n?.length||!p?.length)return 0;for(var P=n.length<p.length?p:n,x=a(n.length<p.length?n:p,r),G=a(P,r),Y=new Set(x),ue=G.length,Se=0,Ae=0,xe=G;Ae<xe.length;Ae++)Y.delete(xe[Ae])&&Se++;(s=Se/ue)>this.maxPercent&&(this.maxPercent=s,this.maxPercentHeader=p)}},i.prototype.close=function(){this.dialogService.closeAll()},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(wn.WI),e.\u0275\u0275directiveInject(wc),e.\u0275\u0275directiveInject(ft.o),e.\u0275\u0275directiveInject(Ut.x))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["import-dialog"]],features:[e.\u0275\u0275ProvidersFeature([wc])],decls:13,vars:9,consts:[[1,"header"],["mat-dialog-title","","localize","MetricsScorecard_Import_Dialog_Header"],[1,"title"],["mat-icon-button","",1,"close",3,"click"],["fontIcon","pbi-glyph-close",1,"glyph-mini"],["class","impact-margin",3,"viewModel",4,"ngIf"],["class","select",4,"ngIf"],["class","scroll",4,"ngIf"],["class","pbi-spinner-large",4,"ngIf"],["class","import",4,"ngIf"],[1,"impact-margin",3,"viewModel"],[1,"select"],["localize","MetricsScorecard_Import_Dialog_Description",1,"description"],[1,"select-table",3,"change"],["class","table-select",3,"value",4,"ngFor","ngForOf"],[1,"table-select",3,"value"],[1,"scroll"],["id","preview-table"],[4,"ngFor","ngForOf"],[1,"table-headers"],["id","left"],[1,"col-headers",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"right"],[3,"value"],[1,"pbi-spinner-large"],[1,"import"],[1,"dialog-buttons"],["localize","Import","localizeTooltip","Import",1,"pbi-fluent-button","primary",3,"click"],["localize","PBI_Button_Label_Cancel","localizeTooltip","PBI_Button_Label_Cancel",1,"pbi-fluent-button",3,"click"],["class","num-goals","localize","MetricsScorecard_Import_Dialog_Number_Metrics",4,"ngIf"],["class","number",4,"ngIf"],["localize","MetricsScorecard_Import_Dialog_Number_Metrics",1,"num-goals"],[1,"number"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"section",0),e.\u0275\u0275element(1,"h1",1)(2,"div",2),e.\u0275\u0275elementStart(3,"button",3),e.\u0275\u0275listener("click",function(){return r.close()}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275element(5,"mat-icon",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,l1,1,1,"message-banner",5),e.\u0275\u0275template(7,c1,1,1,"message-banner",5),e.\u0275\u0275elementStart(8,"div"),e.\u0275\u0275template(9,d1,4,1,"div",6),e.\u0275\u0275template(10,m1,5,3,"div",7),e.\u0275\u0275template(11,v1,1,0,"pbi-spinner",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,y1,6,2,"section",9)),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,7,"Close")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.exceedsColumns),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.emptyFile),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",(null==r.goalPreviewData?null:r.goalPreviewData.length)>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.hasDataLoaded),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.hasDataLoaded&&!r.emptyFile),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==r.goalPreviewData?null:r.goalPreviewData.length)>0))},dependencies:[j.NgForOf,j.NgIf,wn.uh,Ve.YN,Ve.Kr,Ve.EJ,Ve.JJ,Ve.On,rn.X,Zr.r,Xt.Hw,ql.A,Jn.k,Mt.F],styles:[".header[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;flex-direction:row;align-items:center}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1 1 auto}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:none;margin:0;background-color:transparent;border:0;padding:0}.header[_ngcontent-%COMP%]   button.close[_ngcontent-%COMP%]{flex:0 0 20px;align-self:flex-start}.select-table[_ngcontent-%COMP%]{border-bottom:revert;width:10%;margin-left:10px;height:32px;cursor:pointer;padding:0 8px;border-width:1px}div.scroll[_ngcontent-%COMP%]{height:55vh;overflow-y:scroll}.description[_ngcontent-%COMP%]{display:inline}.select[_ngcontent-%COMP%]{padding-bottom:15px}#preview-table[_ngcontent-%COMP%]{padding-top:15px;border-collapse:collapse;width:100%}#preview-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], #preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #bebebe;padding:4px}#preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding-top:4px;padding-bottom:4px;font-size:12px;text-align:left;background-color:#ccc}.col-headers[_ngcontent-%COMP%]{border-color:transparent;background-color:transparent;border-bottom:black;font-size:14px;text-overflow:ellipsis}.table-headers[_ngcontent-%COMP%]{display:flex;padding-left:10px;padding-right:8px}.right[_ngcontent-%COMP%]{font-weight:400;text-align:center;padding-left:4vh}.pbi-fluent-button[_ngcontent-%COMP%]{margin-left:8px}.pbi-spinner-large[_ngcontent-%COMP%]{top:50%;left:50%;position:absolute}.loading-spinner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;opacity:0;animation-name:fade-in;animation-duration:.5s;animation-iteration-count:1;animation-timing-function:linear;animation-delay:1s;animation-fill-mode:forwards}.import[_ngcontent-%COMP%]{flex:0 0 55px;display:flex;bottom:13%;flex-direction:inherit;align-items:flex-end;padding-right:1%;position:fixed;display:-webkit-inline-box}.number[_ngcontent-%COMP%]{padding-left:1%;display:contents}.num-goals[_ngcontent-%COMP%]{margin-left:25px}"]}),i}(),w1=new e.InjectionToken("LinkedMetricsLauncherService"),Sc=M(23558),S1=["inputFile"],M1=["columnTable"],P1=function(){return["Metric_Owner_No_Scorecard_Access","Metric_Owners_No_Scorecard_Access","Share_Now"]};function O1(i,n){if(1&i&&(e.\u0275\u0275element(0,"scorecard-access-banner",8),e.\u0275\u0275pipe(1,"async")),2&i){var t=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecard",t)("users",e.\u0275\u0275pipeBind1(1,3,r.goalOwners$))("labels",e.\u0275\u0275pureFunction0(5,P1))}}function x1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"label",18)(1,"input",19,20),e.\u0275\u0275listener("change",function(a){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(s.onImportClick(a))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",21),e.\u0275\u0275elementEnd()}}function T1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onNewGoalClick())}),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275element(3,"mat-icon",13)(4,"span",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onNewSubGoalClick())}),e.\u0275\u0275pipe(6,"localize"),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275element(8,"span",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,x1,4,0,"label",17),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275classProp("primary",!r.toolbarNewLook),e.\u0275\u0275property("disabled",!r.scorecardCapabilities.createGoal.enabled),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,7,"NewMetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",!r.scorecardCapabilities.createGoal.enabled||1!==e.\u0275\u0275pipeBind1(7,11,r.numberOfSelectedGoals$)),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(6,9,"AddSubmetric")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",r.showImportButton)}}var E1=function(n){return{active:n}};function I1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"button",32,33),e.\u0275\u0275element(2,"mat-icon",34)(3,"span",35)(4,"mat-icon",36),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(1);e.\u0275\u0275nextContext();var r=e.\u0275\u0275reference(4),a=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("matMenuTriggerFor",r)("ngClass",e.\u0275\u0275pureFunction1(5,E1,!0===t.menuOpen)),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("fontIcon","List"===a.viewType?"pbi-glyph-list":"pbi-glyph-table"),e.\u0275\u0275advance(1),e.\u0275\u0275property("localize","View")("localizeTooltip","View")}}function D1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",37),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(a.openHeatmapConfigurationPane())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"mat-icon",38)(3,"span",39),e.\u0275\u0275elementEnd()}2&i&&e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,1,"MetricsCustomizeHeatmap"))}function k1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",40),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var a=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(a.openHierarchiesBuilder())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275element(2,"mat-icon",41)(3,"span",42),e.\u0275\u0275elementEnd()}2&i&&e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,1,"MetricsManageHierarchies"))}function F1(i,n){1&i&&e.\u0275\u0275element(0,"scorecard-hierarchy-button")}function V1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,I1,5,7,"button",22),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"mat-menu",23,24)(5,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onScorecardViewClick())}),e.\u0275\u0275element(6,"mat-icon",26)(7,"span",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",25),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.onHeatmapViewClick())}),e.\u0275\u0275element(9,"mat-icon",28)(10,"span",29),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(11,D1,4,3,"button",30),e.\u0275\u0275template(12,k1,4,3,"button",31),e.\u0275\u0275template(13,F1,1,0,"scorecard-hierarchy-button",7),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,5,r.hasHierarchies$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("overlapTrigger",!1),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf","Heatmap"===r.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isEditMode&&"Heatmap"===r.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","List"===r.viewType)}}function A1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",9)(1,"div",10),e.\u0275\u0275template(2,T1,10,13,"ng-container",7),e.\u0275\u0275element(3,"div",11),e.\u0275\u0275template(4,V1,14,7,"ng-container",7),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275classProp("new-look",t.toolbarNewLook),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",("List"===t.viewType||"Compact"===t.viewType)&&t.isEditMode),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.showHierarchies)}}function R1(i,n){if(1&i&&e.\u0275\u0275element(0,"scorecard-title",43),2&i){var t=e.\u0275\u0275nextContext(2).ngIf,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecardName",t.name)("scorecardDescription",t.description)("isTitleEditable",r.isTitleEditable)}}function L1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-metric-picker-toolbar",50),e.\u0275\u0275listener("filterBy",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onFilterKeywordChange(s))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(5);e.\u0275\u0275property("filterText",e.\u0275\u0275pipeBind1(1,1,r.filterBy$).keyword)}}function G1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-list-toolbar",51),e.\u0275\u0275listener("filterBy",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(u.onFilterKeywordChange(c))})("onNewGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onNewGoalClick(!1))})("onNewSubGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onNewSubGoalClick())})("onLinkedMetricInit",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(c.onLinkedMetricInit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(4).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("isEditMode",a.isEditMode)("scorecard",r)("scorecardCapabilities",a.scorecardCapabilities)("numberOfSelectedGoals",e.\u0275\u0275pipeBind1(1,6,a.numberOfSelectedGoals$))("filterText",e.\u0275\u0275pipeBind1(2,8,a.filterBy$).keyword)("showTitle","Compact"===a.viewType)}}function N1(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,L1,2,3,"scorecard-metric-picker-toolbar",48),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,G1,3,10,"ng-template",null,49,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275reference(4),r=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,2,r.showPickerToolbar$))("ngIfElse",t)}}function H1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-status-tiles",52),e.\u0275\u0275listener("onStatusSelected",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(u.onGoalsStatusTileSelectionChange(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("goals",r.goals)("goalStatusesByScorecardId",e.\u0275\u0275pipeBind1(1,4,a.goalStatusesByScorecardId$))("goalStatusList",null==r.goalStatuses?null:r.goalStatuses.statuses)("selectedStatuses",e.\u0275\u0275pipeBind1(2,6,a.filterBy$).statuses)}}function z1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",53)(1,"div"),e.\u0275\u0275element(2,"mat-icon",54),e.\u0275\u0275elementStart(3,"input",55),e.\u0275\u0275listener("ngModelChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onFilterKeywordChange(s))}),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-icon",56),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.toggleFilterRow())}),e.\u0275\u0275elementEnd()()()}if(2&i){var r=e.\u0275\u0275nextContext(4);e.\u0275\u0275classProp("toolbar-visible",r.isEditMode),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",e.\u0275\u0275pipeBind1(6,9,r.filterBy$).keyword),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,5,"Filter_By_Keyword"))("placeholder",e.\u0275\u0275pipeBind1(5,7,"Filter_By_Keyword"))}}function q1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",63),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"pbi-checkbox",64),e.\u0275\u0275listener("onChange",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(c.onSelectAllGoals(s))}),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext(6);e.\u0275\u0275classProp("box-checked",e.\u0275\u0275pipeBind1(1,5,r.allGoalsSelected$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("checked",e.\u0275\u0275pipeBind1(3,7,r.allGoalsSelected$))("pbiTooltip",e.\u0275\u0275pipeBind1(5,11,"Metrics_BulkEditing_SelectAllMetrics")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(4,9,"Metrics_BulkEditing_SelectAllMetrics"))}}function B1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",73),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(9);return e.\u0275\u0275resetView(s.onToggleExpandAllMetrics())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275element(3,"mat-icon",74),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(9);e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(1,2,e.\u0275\u0275pipeBind1(2,4,r.showAllChildren$)?"FieldListMenuItem_CollapseAll":"FieldListMenuItem_ExpandAll")),e.\u0275\u0275advance(3),e.\u0275\u0275property("fontIcon",e.\u0275\u0275pipeBind1(4,6,r.showAllChildren$)?"pbi-glyph-doublechevrondown":"pbi-glyph-doublechevronright")}}function U1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",75),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(9);return e.\u0275\u0275resetView(s.toggleFilterRow())}),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275element(5,"mat-icon",76),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(9);e.\u0275\u0275property("pbiTooltip",e.\u0275\u0275pipeBind1(3,6,e.\u0275\u0275pipeBind1(4,8,r.filterRowVisible$)?"Filters_Hide":"Filters_Show")),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(1,2,e.\u0275\u0275pipeBind1(2,4,r.filterRowVisible$)?"Filters_Hide":"Filters_Show"))}}function j1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"th",67)(1,"div",68),e.\u0275\u0275template(2,B1,5,8,"button",69),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,U1,6,10,"button",70),e.\u0275\u0275elementStart(5,"div",71)(6,"scorecard-column-header",72),e.\u0275\u0275listener("onSortColumn",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(8);return e.\u0275\u0275resetView(v.sortColumn(p))}),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275elementEnd()()()()}if(2&i){var r=e.\u0275\u0275nextContext(2),a=r.$implicit,s=r.index,c=e.\u0275\u0275nextContext(6);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",c.collapseGoalsByDefault&&e.\u0275\u0275pipeBind1(3,6,c.hasExpandableGoals$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!c.goalsNewHeaderEnabled),e.\u0275\u0275advance(2),e.\u0275\u0275property("column",c.ScorecardColumnConfigs[a.columnId])("index",s)("sort",e.\u0275\u0275pipeBind1(7,8,c.sort$))("isEditMode",c.isEditMode)}}function W1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"th",78)(1,"scorecard-column-header",72),e.\u0275\u0275listener("onSortColumn",function(p){e.\u0275\u0275restoreView(t);var v=e.\u0275\u0275nextContext(9);return e.\u0275\u0275resetView(v.sortColumn(p))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()()}if(2&i){var r=e.\u0275\u0275nextContext(3),a=r.$implicit,s=r.index,c=e.\u0275\u0275nextContext(6);e.\u0275\u0275advance(1),e.\u0275\u0275property("column",c.ScorecardColumnConfigs[a.columnId])("index",s)("sort",e.\u0275\u0275pipeBind1(2,4,c.sort$))("isEditMode",c.isEditMode)}}function $1(i,n){if(1&i&&e.\u0275\u0275template(0,W1,3,6,"th",77),2&i){var t=e.\u0275\u0275nextContext(2).$implicit,r=e.\u0275\u0275nextContext(6);e.\u0275\u0275property("ngIf",!r.ScorecardColumnConfigs[t.columnId].hideHeaderInListView)}}function Q1(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,j1,8,10,"th",65),e.\u0275\u0275template(2,$1,1,1,"ng-template",null,66,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275reference(3),r=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0==r.columnId)("ngIfElse",t)}}function X1(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Q1,4,2,"ng-container",7),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.show)}}function Y1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"thead")(1,"tr",60)(2,"th",61),e.\u0275\u0275template(3,q1,6,13,"div",62),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,X1,2,1,"ng-container",59),e.\u0275\u0275elementEnd()()),2&i){var t=e.\u0275\u0275nextContext(5);e.\u0275\u0275advance(2),e.\u0275\u0275classProp("show-checkmark",!!t.scorecardSelectionMode)("show-on-hover-only","ctrl"===t.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","single"!==t.scorecardSelectionMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.columnSettings)("ngForTrackBy",t.columnSettingId)}}function Z1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tbody",80),e.\u0275\u0275listener("showChildrenChange",function(v){e.\u0275\u0275restoreView(t);var P=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(P.onShowChildrenChange(v))})("dragStarted",function(v){e.\u0275\u0275restoreView(t);var P=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(P.onGoalDragStart(v))})("dragMoved",function(v){e.\u0275\u0275restoreView(t);var P=e.\u0275\u0275nextContext(6);return e.\u0275\u0275resetView(P.onGoalDragMove(v))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(),a=r.$implicit,s=r.index,c=e.\u0275\u0275nextContext(4).ngIf,u=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecard",c)("columnSettings",u.columnSettings)("goal",a)("color",u.colorPalette[s%u.colorPalette.length])("showChildren",e.\u0275\u0275pipeBind1(1,8,u.showChildren$))("goalDragInfo",u.goalDragInfo)("scorecardSelectionMode",u.scorecardSelectionMode)("forceColumnMinWidths",u.forceColumnMinWidths)}}function J1(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Z1,2,10,"tbody",79),e.\u0275\u0275elementContainerEnd()),2&i){var t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.isHidden)}}function K1(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"table",57,58),e.\u0275\u0275listener("cdkDropListDropped",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onDropGoal(s))})("cdkDropListSorted",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onGoalDropListSorted(s))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Y1,5,7,"thead",7),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,J1,2,1,"ng-container",59),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(4);e.\u0275\u0275styleProp("padding-left",r.scorecardTablePadding.left,"px")("padding-right",r.scorecardTablePadding.right,"px"),e.\u0275\u0275property("cdkDropListDisabled",!e.\u0275\u0275pipeBind1(2,8,r.canDragAndDrop$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(4,10,r.showHeaders$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(6,12,r.goals$))("ngForTrackBy",r.goalId)}}function ef(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"compact-scorecard",81),e.\u0275\u0275listener("onSortColumn",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(u.sortColumn(c))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(3).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("scorecard",r)("isEditMode",a.isEditMode)("viewSettings",a.viewSettings)("sort",e.\u0275\u0275pipeBind1(1,4,a.sort$))}}function tf(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,N1,5,4,"ng-container",7),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275template(4,H1,3,8,"scorecard-status-tiles",44),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275template(8,z1,8,11,"div",45),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,K1,7,14,"table",46),e.\u0275\u0275template(11,ef,2,6,"compact-scorecard",47),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.goalsNewHeaderEnabled&&!(e.\u0275\u0275pipeBind1(2,5,t.hideToolbar$)||e.\u0275\u0275pipeBind1(3,7,t.hideHeader$))),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.goalsNewHeaderEnabled&&e.\u0275\u0275pipeBind1(5,9,t.showStatus$)&&!(e.\u0275\u0275pipeBind1(6,11,t.hideCards$)||e.\u0275\u0275pipeBind1(7,13,t.hideHeader$))),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,15,t.filterRowVisible$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","List"===t.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Compact"===t.viewType)}}function nf(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"scorecard-heatmap-toolbar",50),e.\u0275\u0275listener("filterBy",function(s){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.onFilterKeywordChange(s))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("filterText",e.\u0275\u0275pipeBind1(1,1,r.filterBy$).keyword)}}function rf(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,nf,2,3,"scorecard-heatmap-toolbar",82),e.\u0275\u0275element(2,"heat-map",83),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.goalsNewHeaderEnabled)}}function af(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"scorecard-list-toolbar",84),e.\u0275\u0275listener("filterBy",function(c){e.\u0275\u0275restoreView(t);var u=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(u.onFilterKeywordChange(c))})("onNewGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onNewGoalClick(!1))})("onNewSubGoal",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onNewSubGoalClick())})("onLinkedMetricInit",function(){e.\u0275\u0275restoreView(t);var c=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(c.onLinkedMetricInit())}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"scorecard-board-view",85),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2).ngIf,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("isEditMode",a.isEditMode)("scorecardCapabilities",a.scorecardCapabilities)("numberOfSelectedGoals",e.\u0275\u0275pipeBind1(2,6,a.numberOfSelectedGoals$))("filterText",e.\u0275\u0275pipeBind1(3,8,a.filterBy$).keyword),e.\u0275\u0275advance(3),e.\u0275\u0275property("boardSettings",a.boardSettings)("metricsGoalStatuses",null==r.goalStatuses?null:r.goalStatuses.statuses)}}function sf(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",3),e.\u0275\u0275listener("on-resize",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.setVisibleColumns())}),e.\u0275\u0275template(2,O1,2,6,"scorecard-access-banner",4),e.\u0275\u0275template(3,A1,5,4,"div",5),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275template(6,R1,1,3,"scorecard-title",6),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,tf,12,17,"ng-container",7),e.\u0275\u0275template(10,rf,3,1,"ng-container",7),e.\u0275\u0275template(11,af,5,10,"ng-container",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("overflow-x",null!=r.viewSettings&&r.viewSettings.dropColumns?"hidden":"auto"),e.\u0275\u0275classProp("heat-map-scroll","Heatmap"===r.viewType)("new-header",r.goalsNewHeaderEnabled)("compact","Compact"===r.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.showScorecardAccessBanner&&r.isEditMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.goalsNewHeaderEnabled&&(r.isEditMode||r.toolbarNewLook)&&!(e.\u0275\u0275pipeBind1(4,14,r.hideToolbar$)||e.\u0275\u0275pipeBind1(5,16,r.hideHeader$))),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",r.goalsNewHeaderEnabled&&!(e.\u0275\u0275pipeBind1(7,18,r.hideTitle$)||e.\u0275\u0275pipeBind1(8,20,r.hideHeader$))&&"Compact"!==r.viewType),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf","List"===r.viewType||"Compact"===r.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Heatmap"===r.viewType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Board"===r.viewType)}}function lf(i,n){if(1&i){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"empty-scorecard",86),e.\u0275\u0275listener("onNewGoal",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onNewGoalClick(!0))})("onLinkToGoal",function(){e.\u0275\u0275restoreView(t);var s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onLinkedMetricInit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&i){var r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("isMetricsPicker",e.\u0275\u0275pipeBind1(1,2,r.showPickerToolbar$))("canEdit",r.isEditMode&&e.\u0275\u0275pipeBind1(2,4,r.userHasEditPermissions$))}}function cf(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,sf,12,22,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,lf,3,6,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&i){var t=e.\u0275\u0275reference(4),r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,2,r.hasGoals$))("ngIfElse",t)}}function uf(i,n){1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"span",89),e.\u0275\u0275elementContainerEnd())}function df(i,n){1&i&&e.\u0275\u0275element(0,"span",90)}function pf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",87),e.\u0275\u0275template(1,uf,2,0,"ng-container",0),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,df,1,0,"ng-template",null,88,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&i){var t=e.\u0275\u0275reference(4),r=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("border-top",r.toolbarNewLook),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null===e.\u0275\u0275pipeBind1(2,4,r.scorecard$))("ngIfElse",t)}}var vu=function(){function i(n,t,r,a,s,c,u,p,v,P,x,G,Y,ue,Se,Ae){var xe=this;this.scorecardService=n,this.heatmapService=t,this.detailsPaneLauncher=r,this.hierarchyPane=a,this.changeDetectorRef=s,this.featureSwitchService=c,this.goalsTutorialService=u,this.hierarchyService=p,this.capabilityService=v,this.expansionService=P,this.scorecardElement=x,this.linkedMetricsLauncher=G,this.dialogService=Y,this.viewsService=ue,this.scorecardSettings=Se,this.scorecardHost=Ae,this.colorPalette=W.gT.ColorPalette,this.viewType="List",this.sort$=new pe.X((0,w.__assign)({},W.Ij)),this.filterRowVisible$=new pe.X(!1),this.filterBy$=new pe.X({}),this.onDestroy$=new ir.t(1),this.boardSettings={showGoalVisualGoalName:!0,showGoalVisualOwner:!0,showGoalVisualGrowth:!0,showGoalVisualScorecardName:!0,showVisualization:!0},this.goalDragInfo={},this.ScorecardColumnConfigs=W.Ml,this.forceColumnMinWidths=!1,this.scorecardTablePadding=W.gT.ScorecardTablePadding,this.sortColumn=function(Be){return xe.sort$.next(Be)},this.isExcelFile=!1}return i.prototype.goalId=function(n,t){return t.id},i.prototype.columnSettingId=function(n,t){return t.columnId},i.prototype.ngOnInit=function(){var t,r,a,s,c,u,p,v,P,x,G,Y,ue,Se,Ae,xe,n=this;b.fF.assertValue(this.scorecardDetails$,"Scorecard details should be set at initialization time"),this.showImportButton=!!this.featureSwitchService.featureSwitches.goalsShowImportFromFileUI&&!!this.dialogService,this.showColumnSettingsMenu=!!this.featureSwitchService.featureSwitches.goalsColumnSettings,this.showHierarchies=!!this.featureSwitchService.featureSwitches.goalsHierarchies,this.toolbarNewLook=!!this.featureSwitchService.featureSwitches.goalsHierarchies,this.showScorecardAccessBanner=!!this.featureSwitchService.featureSwitches.goalsScorecardAccessBanner,this.bulkDeleteEnabled=!!this.featureSwitchService.featureSwitches.goalsBulkDelete,this.goalsNewHeaderEnabled=this.featureSwitchService.featureSwitches.goalsNewHeader,this.isTitleEditable=this.featureSwitchService.featureSwitches.goalsSkipScorecardCreationPane,this.collapseGoalsByDefault=!!this.featureSwitchService.featureSwitches.collapseGoalsByDefault,this.scorecard$=this.scorecardDetails$.pipe((0,I.x)(function(z,fe){return!fe.reload&&_.isEqual(z,fe)}),(0,Jt.w)(function(z){if(!z)return(0,ae.of)(void 0);if(!(z.groupId&&z.scorecardId||z.prefetchedScorecard))return(0,ae.of)(null);var fe;if(z.prefetchedScorecard)fe=n.scorecardService.loadPrefetchedScorecard(z.prefetchedScorecard);else{var Me=n.showHierarchies?function(i){if(!_.isEmpty(i)){for(var t=[],r=0,a=_.split(i,";");r<a.length;r++){var s=a[r];if(!s.includes(":"))return;var c=_.split(s,":"),u=c[0],v=_.map(_.split(c[1],","),function(P){return decodeURIComponent(P)});t.push({hierarchyId:u,levels:v})}return _.isEmpty(t)?void 0:t}}(z.initialHierarchyPath):void 0;fe=n.scorecardService.loadScorecard(z.groupId,z.scorecardId,!0,Me)}return z.reload?fe:fe.pipe((0,vt.g)(0),(0,$e.O)(void 0))}),(0,Gn.d)(1)),(0,Mn.aj)([this.scorecardDetails$,this.scorecard$]).pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){var fe=z[0],Me=z[1];if(fe&&fe.onScorecardUpdated&&Me){var at=_.filter(Me.goals,function(At){return!At.isNew}),xt=q.flattenGoals(at);fe.onScorecardUpdated((0,w.__assign)((0,w.__assign)({},Me),{goals:xt}))}}),(0,Mn.aj)([this.scorecardDetails$,this.scorecard$]).pipe((0,I.x)(function(z,fe){var Me=z[0],at=z[1],xt=fe[0],At=fe[1];return at?.id===At?.id&&Me?.initialSelectedGoalId===xt?.initialSelectedGoalId})).pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){var fe=z[0],Me=z[1];!_.isNil(fe?.initialSelectedGoalId)&&!_.isNil(Me)&&n.detailsPaneLauncher.openGoalDetails(n.scorecardService,fe?.initialSelectedGoalId,Yr.Default)}),(0,Mn.aj)([this.scorecardDetails$,this.scorecardService.isLoading()]).pipe((0,ie.R)(this.onDestroy$),(0,jt.h)(function(z){var fe=z[0];return!!fe?.onLoading})).subscribe(function(z){return z[0].onLoading(z[1])}),this.hasGoals$=this.scorecard$.pipe((0,je.U)(function(z){var fe;return(null===(fe=z?.goals)||void 0===fe?void 0:fe.length)>0})),this.goals$=this.scorecard$.pipe((0,je.U)(function(z){return z?.goals})),this.hasSavedGoals$=this.goals$.pipe((0,je.U)(function(z){var fe;return(null===(fe=z?.filter(function(Me){return!Me?.isNew}))||void 0===fe?void 0:fe.length)>0})),null===(r=null===(t=this.scorecardSettings)||void 0===t?void 0:t.settings)||void 0===r||r.pipe().subscribe(function(z){n.boardSettings=z}),this.columnSettings$=this.scorecard$.pipe((0,I.x)(function(z,fe){return _.isEqual(z?.columnSettings,fe?.columnSettings)}),(0,je.U)(function(z){return z?.columnSettings})),this.showStatus$=this.columnSettings$.pipe((0,je.U)(function(z){return K.isColumnVisible(z,2)})),this.userHasEditPermissions$=this.scorecard$.pipe((0,je.U)(function(z){return(0,ur.yE)(Qe(z?.permissions),2)}));var Be=this.scorecardDetails$.pipe((0,jt.h)(function(z){return!!z?.settings$}),(0,Jt.w)(function(z){return z?.settings$}),(0,$e.O)(void 0));this.showHeaders$=(0,Mn.aj)([this.scorecard$,Be]).pipe((0,je.U)(function(z){var fe=z[0],Me=z[1];return!Me?.hideColumnHeaders&&_.some(fe?.goals,function(at){return null==at.state||"Consumption"===at.state})}));var Je=this.scorecardService.isEditMode();Je.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){n.isEditMode=z,n.changeDetectorRef.markForCheck()}),this.scorecardDetails$.pipe((0,Jt.w)(function(z){var fe;return null!==(fe=z?.isEditMode$)&&void 0!==fe?fe:(0,ae.of)(!1)}),(0,ie.R)(this.onDestroy$)).subscribe(function(z){return n.scorecardService.setEditMode(z)}),this.scorecardDetails$.pipe((0,jt.h)(function(z){return!!z?.refresh$}),(0,Jt.w)(function(z){return z?.refresh$}),(0,Sc.M)(this.scorecard$.pipe((0,jt.h)(function(z){return!!z}))),(0,ie.R)(this.onDestroy$)).subscribe(function(z){var Me=z[1];"Heatmap"===n.scorecardService.viewType?n.heatmapService.refreshAll():n.heatmapService.clearCache(),n.hierarchyService.loadHierarchies(Me.groupId,Me.id,!1),n.scorecardService.loadScorecard(Me.groupId,Me.id,!1,Me.hierarchyPaths)}),this.scorecardDetails$.pipe((0,jt.h)(function(z){return!!z?.bulkEditingClearSelection$}),(0,Jt.w)(function(z){return z?.bulkEditingClearSelection$}),(0,ie.R)(this.onDestroy$)).subscribe(function(){return n.scorecardService.unselectAllGoals()}),this.scorecardDetails$.pipe((0,jt.h)(function(z){return!!z?.bulkEditingDelete$}),(0,Jt.w)(function(z){return z?.bulkEditingDelete$}),(0,ie.R)(this.onDestroy$)).subscribe(function(){return n.scorecardService.bulkDeleteGoalsPrompt()}),this.scorecardDetails$.pipe((0,jt.h)(function(z){return!!z?.bulkEditingUpdate$}),(0,Jt.w)(function(z){return z?.bulkEditingUpdate$}),(0,ie.R)(this.onDestroy$)).subscribe(function(){return n.openBulkUpdatePane()}),this.selectedGoalIds$=this.scorecardService.getSelectedGoalIdsObservable(),this.numberOfSelectedGoals$=this.selectedGoalIds$.pipe((0,je.U)(function(z){return _.isNil(z)?0:Object.keys(z).length})),this.numberOfSelectedGoals$.pipe((0,Sc.M)(this.scorecardDetails$),(0,I.x)(function(z,fe){return z[0]===fe[0]})).subscribe(function(z){var fe=z[0],Me=z[1];_.isFunction(Me?.onNumberOfSelectedGoalsChange)&&!_.isNil(fe)&&Me.onNumberOfSelectedGoalsChange(fe)});var ut=this.goals$.pipe((0,je.U)(function(z){return q.flattenGoals(z)}));this.allGoalsSelected$=(0,Mn.aj)([ut,this.selectedGoalIds$]).pipe((0,I.x)(function(z,fe){var At=fe[1];return z[0].length===fe[0].length&&Object.keys(z[1]).length===Object.keys(At).length}),(0,je.U)(function(z){var Me=z[1];return _.filter(z[0],function(xt){return!xt.isNew&&(!n.scorecardHost||n.scorecardHost.canSelectGoal(xt).enabled)}).length===Object.keys(Me).length})),this.scorecard$.pipe((0,Ao.o)(function(z){return _.isNil(z)},!0)).subscribe(function(z){var fe;!_.isNil(z)&&(_.isNil(z?.goals)||0===(null===(fe=z?.goals)||void 0===fe?void 0:fe.length))&&n.scorecardService.userHasWritePermissions()&&n.onNewGoalClick(!0)});var It=this.scorecardService.isLoading(),mt=this.scorecardService.isEditing();this.showChildren$=this.expansionService.expansionMap$,this.showAllChildren$=this.expansionService.showAllExpanded$,this.hasExpandableGoals$=this.expansionService.hasExpandableGoals$;var bt=this.capabilityService.getScorecardCapabilities();bt.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){n.scorecardCapabilities=z,n.changeDetectorRef.markForCheck()}),this.canDragAndDrop$=(0,Mn.aj)([Je,this.filterBy$,this.sort$,It,mt,this.numberOfSelectedGoals$,bt]).pipe((0,je.U)(function(z){var fe,Me=(fe=z)[0],at=fe[1],xt=fe[2],At=fe[3],Do=fe[4],zi=fe[5];return fe[6].reorderGoal&&Me&&_.isEmpty(at.keyword)&&_.isEmpty(at.statuses)&&"Rank"===xt.sortBy&&!At&&!Do&&zi<=1})),this.scorecardDetails$.pipe((0,Jt.w)(function(z){return z.filterBy$})).pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){n.filterBy$.next(z)}),(0,Mn.aj)([this.scorecardDetails$,this.filterBy$]).pipe((0,I.x)(function(z,fe){var Me=z[1],at=fe[1];return _.isEqual(Me?.keyword,at?.keyword)&&_.isEqual(Me?.statuses,at?.statuses)})).pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){var fe=z[0],Me=z[1];_.isFunction(fe?.onFiltersUpdated)&&!_.isNil(Me)&&fe.onFiltersUpdated(Me)}),(0,Mn.aj)([this.sort$,this.filterBy$,this.filterRowVisible$,this.columnSettings$,this.scorecardService.viewType$]).pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){var fe=z[0],Me=z[1],at=z[2],xt=z[3],At=z[4];Me.matchStatus=K.isColumnVisible(xt,2),Me.matchOwner=K.isColumnVisible(xt,1),"Heatmap"===At?n.scorecardService.applySortAndFilter((0,w.__assign)({},W.Ij),n.goalsNewHeaderEnabled?{keyword:Me?.keyword}:{}):("List"===At||"Compact"===At)&&n.scorecardService.applySortAndFilter(fe,n.goalsNewHeaderEnabled||at?Me:{statuses:Me?.statuses})}),this.goalOwners$=this.goals$.pipe((0,je.U)(q.getGoalOwners)),this.scorecard$.pipe((0,jt.h)(function(z){return!!z}),(0,I.x)(function(z,fe){return z.id===fe.id}),(0,ie.R)(this.onDestroy$)).subscribe(function(z){n.hierarchyService.loadHierarchies(z.groupId,z.id)}),this.scorecardService.getActiveGoalId().pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){_.isNil(z)?n.detailsPaneLauncher.closeGoalDetails():(n.detailsPaneLauncher.openGoalDetails(n.scorecardService,z,Yr.Default),n.showChildrenForSelectedMetrics(z))}),this.goalStatusesByScorecardId$=this.scorecardService.goalStatusesByScorecardId$,this.hasHierarchies$=this.hierarchyService.hasHierarchies$,this.displayMode$=null===(s=null===(a=this.scorecardSettings)||void 0===a?void 0:a.settings)||void 0===s?void 0:s.pipe((0,je.U)(function(z){return z?.displayMode})),this.hideHeader$=null===(u=null===(c=this.scorecardSettings)||void 0===c?void 0:c.settings)||void 0===u?void 0:u.pipe((0,je.U)(function(z){return z?.hideScorecardHeader})),this.hideTitle$=null===(v=null===(p=this.scorecardSettings)||void 0===p?void 0:p.settings)||void 0===v?void 0:v.pipe((0,je.U)(function(z){return z?.hideScorecardTitle})),this.hideToolbar$=null===(x=null===(P=this.scorecardSettings)||void 0===P?void 0:P.settings)||void 0===x?void 0:x.pipe((0,je.U)(function(z){return z?.hideScorecardToolbar})),this.hideCards$=null===(Y=null===(G=this.scorecardSettings)||void 0===G?void 0:G.settings)||void 0===Y?void 0:Y.pipe((0,je.U)(function(z){return z?.hideGoalCards})),this.showPickerToolbar$=null===(Se=null===(ue=this.scorecardSettings)||void 0===ue?void 0:ue.settings)||void 0===Se?void 0:Se.pipe((0,je.U)(function(z){return z?.showPickerToolbar})),this.scorecardService.scorecardSelectionMode$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){return n.scorecardSelectionMode=z}),this.scorecardService.viewType$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){return n.viewType=z}),null===(xe=null===(Ae=this.scorecardSettings)||void 0===Ae?void 0:Ae.settings)||void 0===xe||xe.pipe((0,he.q)(1)).subscribe(function(z){var fe,Me=null===(fe=_.first(z.filters))||void 0===fe?void 0:fe.goalId;Me&&z.isEditingGoal&&n.scorecardService.setGoalState(Me,"Editing")}),this.columnSettings$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){return n.columnSettings=z}),this.scorecard$.pipe((0,ie.R)(this.onDestroy$)).subscribe(function(z){return n.visualScorecard=z}),this.featureSwitchService.featureSwitches.scorecardListViewSettings&&this.viewsService&&(this.viewsService.loadViews(!1),this.viewsService.getDefaultView("List").pipe((0,ie.R)(this.onDestroy$)).subscribe(function(){n.viewSettings=n.viewsService.defaultListView?n.viewsService.defaultListView.listViewDetails:W.lb,n.setVisibleColumns()}))},i.prototype.ngOnDestroy=function(){this.detailsPaneLauncher.closeGoalDetails(),this.onDestroy$.next(!0),this.onDestroy$.complete()},i.prototype.showChildrenForSelectedMetrics=function(n){var t=this.scorecardService.getCurrentScorecard(),r=q.getGoal(t?.goals,n);for(n=r.parentId;n&&null!=(r=q.getGoal(t?.goals,n));)this.expansionService.expandGoal(n),n=r.parentId},i.prototype.onShowChildrenChange=function(n){n.value?this.expansionService.expandGoal(n.id):this.expansionService.collapseGoal(n.id)},i.prototype.onToggleExpandAllMetrics=function(){this.expansionService.toggleExpandAll()},i.prototype.onNewGoalClick=function(n){this.scorecardService.setViewType("List"),this.scorecardService.addGoal(),n&&this.goalsTutorialService.startFirstGoalTutorial()},i.prototype.openHierarchiesBuilder=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){return(0,w.__generator)(this,function(n){switch(n.label){case 0:return[4,this.hierarchyPane.openHierarchiesBuilder("HeatmapHeader")];case 1:return n.sent(),[2]}})})},i.prototype.openHeatmapConfigurationPane=function(){this.hierarchyPane.showHeatmapConfigurationPane()},i.prototype.onScorecardViewClick=function(){this.scorecardService.setViewType("List")},i.prototype.onHeatmapViewClick=function(){this.scorecardService.setViewType("Heatmap")},i.prototype.onSelectAllGoals=function(){this.scorecardService.toggleSelectAllGoals()},i.prototype.openBulkUpdatePane=function(){var n=this;this.detailsPaneLauncher.openBulkEditingPane(this.scorecardService,function(t){return n.scorecardService.bulkUpdateGoals(t)})},i.prototype.onNewSubGoalClick=function(){if(1===this.scorecardService.numberOfSelectedGoals()){var n=this.scorecardService.getFirstSelectedGoalId();this.expansionService.expandGoal(n),this.scorecardService.addSubGoal(n)}},i.prototype.onImportClick=function(n){var t=this,r=n.target;if(this.isExcelFile=!!r.files[0].name.match(/(.xls|.xlsx)/),this.isExcelFile){var a=new FileReader;a.onload=function(s){var u=a.result.toString().replace(/^data:(.*,)?/,"");u.length%4>0&&(u+="=".repeat(4-u.length%4)),t.inputFile.nativeElement.value="",t.dialogService.open(b1,{width:"70%",height:"80%",data:{fileData:u,scorecard:t.visualScorecard}}).afterClosed().pipe((0,Sc.M)(t.scorecard$)).subscribe(function(v){var x=v[1];t.scorecardService.loadScorecard(x.groupId,x.id)})},a.readAsDataURL(r.files[0])}},i.prototype.updateSorting=function(n,t){var r=B.toggleSort(n,t);this.sort$.next(r)},i.prototype.toggleFilterRow=function(){var n=!this.filterRowVisible$.value;this.filterRowVisible$.next(n),n||this.onFilterKeywordChange("")},i.prototype.onFilterKeywordChange=function(n){var t=(0,w.__assign)((0,w.__assign)({},this.filterBy$.value),{keyword:n});this.filterBy$.next(t)},i.prototype.onGoalsStatusTileSelectionChange=function(n){var t,r={keyword:null===(t=this.filterBy$.value)||void 0===t?void 0:t.keyword,statuses:n};this.filterBy$.next(r)},i.prototype.onGoalDragStart=function(n){var t=n.source.data.goal,r=n.source.data.level,a=n.source.dropContainer.getSortedItems(),s=a.findIndex(function(c){return c.data.goal.id===t.id});b.fF.assertValue(-1!==s,"Goal should exist in the drop list"),this.goalDragInfo=(0,nt.ZP)(this.goalDragInfo,function(c){return c.sourceGoalId=t.id,c.rankOrderedPrevGoal=s>0?a[s-1].data:void 0,c.rankOrderedNextGoal=s<a.length-1?a[s+1].data:void 0,c.destParentGoalId=t.parentId,c.destGoalDropLevel=r,c}),this.changeDetectorRef.detectChanges()},i.prototype.onGoalDragMove=function(n){var t,r,a,s;if(this.goalDragInfo.rankOrderedPrevGoal||this.goalDragInfo.rankOrderedNextGoal){if(!this.goalDragInfo.rankOrderedPrevGoal)return void(this.goalDragInfo=(0,nt.ZP)(this.goalDragInfo,function(Me){return Me.destParentGoalId=void 0,Me.destGoalDropLevel=0,Me}));var p,v,c=this.goalDragInfo.rankOrderedPrevGoal,u=c.level<W.gT.MaxSubGoals;if(this.featureSwitchService.featureSwitches.goalsXAxisDragAndDrop){var x=n.source.getPlaceholderElement(),It=Array.from(x.querySelectorAll(".cell-indent")).map(function(xt){return xt.getBoundingClientRect().right});for(v=0;v<It.length&&It[v]<=n.pointerPosition.x;)v++;var Ae=null!==(s=null===(a=this.goalDragInfo.rankOrderedNextGoal)||void 0===a?void 0:a.level)&&void 0!==s?s:0,mt=c.level+(u?1:0);v=_.clamp(v,Ae,mt),p=mt}else{var G=(x=n.source.getPlaceholderElement()).getBoundingClientRect(),ue=20+G.height,Se=_.clamp(n.pointerPosition.y-(G.top-10),0,ue-1),xe=(Ae=null!==(r=null===(t=this.goalDragInfo.rankOrderedNextGoal)||void 0===t?void 0:t.level)&&void 0!==r?r:0,c.level-Ae+1);u&&xe++;var Je=Math.floor(Se/(ue/xe));v=(p=c.level+(u?1:0))-Je}var z=this.scorecardService.getCurrentScorecard(),fe=c.goal;for(u||(fe=fe.parentId?q.getGoal(z.goals,fe.parentId):void 0);p>v;)fe=fe.parentId?q.getGoal(z.goals,fe.parentId):void 0,p--;this.goalDragInfo=(0,nt.ZP)(this.goalDragInfo,function(Me){return Me.destParentGoalId=fe?.id,Me.destGoalDropLevel=v,Me})}},i.prototype.setVisibleColumns=function(){var n,t,r;if(this.columnSettings=this.visualScorecard.columnSettings,null!==(n=this.viewSettings)&&void 0!==n&&n.dropColumns){var a=(null===(t=this.scorecardElement)||void 0===t?void 0:t.nativeElement.offsetWidth)||0;((null===(r=this.columnTableElement)||void 0===r?void 0:r.nativeElement.offsetWidth)||0)>a&&(!1===this.forceColumnMinWidths&&(this.cutoffWidth=a),this.forceColumnMinWidths=!0);for(var c=W.gT.ScorecardTablePadding.left+W.gT.ScorecardTablePadding.right,u=0;u<this.visualScorecard.columnSettings.length;u++)if(this.visualScorecard.columnSettings[u].show&&(c+=W.gT.ListViewCellMinWidths[this.visualScorecard.columnSettings[u].columnId]||0)>a){this.columnSettings=this.visualScorecard.columnSettings.slice(0,u||1);break}a>this.cutoffWidth&&(this.forceColumnMinWidths=!1)}else this.forceColumnMinWidths=!1;this.changeDetectorRef.markForCheck()},i.prototype.onGoalDropListSorted=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a;return(0,w.__generator)(this,function(s){return b.fF.assertValue((t=n.item.data.goal.id)===this.goalDragInfo.sourceGoalId,"Dragged goal does not match."),r=n.container.getSortedItems(),a=r.map(function(c){return c.data}).filter(function(c){return c.goal.id!==t}),this.goalDragInfo=(0,nt.ZP)(this.goalDragInfo,function(c){return c.rankOrderedNextGoal=n.currentIndex<a.length?a[n.currentIndex]:void 0,c.rankOrderedPrevGoal=n.currentIndex-1>=0?a[n.currentIndex-1]:void 0,c}),[2]})})},i.prototype.onDropGoal=function(n){return(0,w.__awaiter)(this,void 0,void 0,function(){var t,r,a;return(0,w.__generator)(this,function(s){switch(s.label){case 0:return b.fF.assertValue((t=n.item.data.goal).id===this.goalDragInfo.sourceGoalId,"Dragged goal does not match."),this.goalDragInfo.rankOrderedNextGoal&&(a=this.goalDragInfo.rankOrderedNextGoal.goal,(this.goalDragInfo.destParentGoalId&&a.parentId===this.goalDragInfo.destParentGoalId||!a.parentId&&!this.goalDragInfo.destParentGoalId)&&(r=this.goalDragInfo.rankOrderedNextGoal.goal)),[4,this.scorecardService.moveGoal(t.id,r?.id,this.goalDragInfo.destParentGoalId)];case 1:return s.sent(),this.goalDragInfo=(0,nt.ZP)(this.goalDragInfo,function(){return{}}),[2]}})})},i.prototype.onLinkedMetricInit=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var n,t,a=this;return(0,w.__generator)(this,function(s){return this.linkedMetricsLauncher&&(n=_.map(q.flattenGoals(this.scorecardService.getCurrentScorecard().goals),"id"),t=this.scorecardDetails$.pipe((0,Jt.w)(function(c){var u;return null!==(u=c?.reportId$)&&void 0!==u?u:a.scorecard$.pipe((0,je.U)(function(p){return p.reportId}))}),(0,I.x)()),this.linkedMetricsLauncher.launchLinkedMetrics(n,t).pipe((0,he.q)(1)).subscribe(function(c){c?.length>=1&&a.scorecardService.createLinkedGoals(c)})),[2]})})},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(et),e.\u0275\u0275directiveInject(gc),e.\u0275\u0275directiveInject(vr),e.\u0275\u0275directiveInject(jl),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(_n.vZ),e.\u0275\u0275directiveInject(Ec),e.\u0275\u0275directiveInject(Nn),e.\u0275\u0275directiveInject(hr),e.\u0275\u0275directiveInject(xr),e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(w1,8),e.\u0275\u0275directiveInject(Ut.x),e.\u0275\u0275directiveInject(iu),e.\u0275\u0275directiveInject(Cn,8),e.\u0275\u0275directiveInject(ot,8))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["scorecard"]],viewQuery:function(t,r){if(1&t&&(e.\u0275\u0275viewQuery(S1,5),e.\u0275\u0275viewQuery(M1,5)),2&t){var a=void 0;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.inputFile=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.columnTableElement=a.first)}},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["noScorecard",""],["noGoals",""],[1,"scorecard",3,"on-resize"],[3,"scorecard","users","labels",4,"ngIf"],["class","toolbar",3,"new-look",4,"ngIf"],[3,"scorecardName","scorecardDescription","isTitleEditable",4,"ngIf"],[4,"ngIf"],[3,"scorecard","users","labels"],[1,"toolbar"],[1,"toolbar-btns"],[1,"spacer"],[1,"add-goal-btn","pbi-fluent-button",3,"disabled","click"],["fontIcon","pbi-glyph-add",1,"glyphicon","glyph-small"],["localize","NewMetric"],[1,"add-subgoal-btn","pbi-fluent-button",3,"disabled","click"],["localize","AddSubmetric"],["class","label pbi-fluent-button primary",4,"ngIf"],[1,"label","pbi-fluent-button","primary"],["type","file",3,"change"],["inputFile",""],["localize","Import"],["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true","class","view-mode-picker-btn pbi-fluent-button",3,"matMenuTriggerFor","ngClass",4,"ngIf"],[1,"view-mode-picker-menu",3,"overlapTrigger"],["viewSwitcherMenu","matMenu"],["mat-menu-item","",1,"pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-list",1,"glyphicon","glyph-small"],["localize","Scorecard","localizeTooltip","Scorecard"],["fontIcon","pbi-glyph-table",1,"glyphicon","glyph-small"],["localize","MetricsHeatmap","localizeTooltip","MetricsHeatmap"],["class","customize-heatmap-btn pbi-fluent-button",3,"click",4,"ngIf"],["class","hierarchies-btn pbi-fluent-button",3,"click",4,"ngIf"],["cdkMonitorElementFocus","","mat-button","","aria-expanded","viewSwitcherMenuTrigger.menuOpen === true",1,"view-mode-picker-btn","pbi-fluent-button",3,"matMenuTriggerFor","ngClass"],["viewSwitcherMenuTrigger","matMenuTrigger"],[1,"glyph-small",3,"fontIcon"],[3,"localize","localizeTooltip"],["fontIcon","pbi-glyph-chevrondownsmall","localizeTooltip","View_Options",1,"glyph-mini","chevron-down"],[1,"customize-heatmap-btn","pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-barchartverticaledit",1,"glyphicon","glyph-small"],["localize","MetricsCustomizeHeatmap"],[1,"hierarchies-btn","pbi-fluent-button",3,"click"],["fontIcon","pbi-glyph-inline-drill-nocircle",1,"glyphicon","glyph-small"],["localize","MetricsManageHierarchies"],[3,"scorecardName","scorecardDescription","isTitleEditable"],[3,"goals","goalStatusesByScorecardId","goalStatusList","selectedStatuses","onStatusSelected",4,"ngIf"],["class","filter-row",3,"toolbar-visible",4,"ngIf"],["class","scorecard-table","cdkDropList","",3,"padding-left","padding-right","cdkDropListDisabled","cdkDropListDropped","cdkDropListSorted",4,"ngIf"],[3,"scorecard","isEditMode","viewSettings","sort","onSortColumn",4,"ngIf"],[3,"filterText","filterBy",4,"ngIf","ngIfElse"],["listToolbar",""],[3,"filterText","filterBy"],[3,"isEditMode","scorecard","scorecardCapabilities","numberOfSelectedGoals","filterText","showTitle","filterBy","onNewGoal","onNewSubGoal","onLinkedMetricInit"],[3,"goals","goalStatusesByScorecardId","goalStatusList","selectedStatuses","onStatusSelected"],[1,"filter-row"],["fontIcon","pbi-glyph-filter",1,"filter-icon","glyphicon","glyph-small"],[3,"ngModel","ngModelChange"],["fontIcon","pbi-glyph-close",1,"close-icon","glyphicon","glyph-small",3,"click"],["cdkDropList","",1,"scorecard-table",3,"cdkDropListDisabled","cdkDropListDropped","cdkDropListSorted"],["columnTable",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"scorecard-header"],["colspan","1",1,"checkmark-th"],["class","select-checkmark",3,"box-checked",4,"ngIf"],[1,"select-checkmark"],[3,"checked","pbiTooltip","onChange"],["colspan","5",4,"ngIf","ngIfElse"],["columnHeader",""],["colspan","5"],[1,"filter-btn-and-name"],["class","collapse-btn",3,"pbiTooltip","click",4,"ngIf"],["class","filter-btn",3,"pbiTooltip","click",4,"ngIf"],[1,"name-col","sort-col"],[3,"column","index","sort","isEditMode","onSortColumn"],[1,"collapse-btn",3,"pbiTooltip","click"],[1,"glyphicon","glyph-mini",3,"fontIcon"],[1,"filter-btn",3,"pbiTooltip","click"],["fontIcon","pbi-glyph-filter",1,"glyphicon","glyph-small"],["colspan","1","class","sort-col",4,"ngIf"],["colspan","1",1,"sort-col"],["goal-group","",3,"scorecard","columnSettings","goal","color","showChildren","goalDragInfo","scorecardSelectionMode","forceColumnMinWidths","showChildrenChange","dragStarted","dragMoved",4,"ngIf"],["goal-group","",3,"scorecard","columnSettings","goal","color","showChildren","goalDragInfo","scorecardSelectionMode","forceColumnMinWidths","showChildrenChange","dragStarted","dragMoved"],[3,"scorecard","isEditMode","viewSettings","sort","onSortColumn"],[3,"filterText","filterBy",4,"ngIf"],[1,"heat-map"],[3,"isEditMode","scorecardCapabilities","numberOfSelectedGoals","filterText","filterBy","onNewGoal","onNewSubGoal","onLinkedMetricInit"],[3,"boardSettings","metricsGoalStatuses"],[3,"isMetricsPicker","canEdit","onNewGoal","onLinkToGoal"],[1,"no-goals","center-text"],["loading",""],["localize","Scorecard_DoesNotExist"],["localize","Scorecard_Loading"]],template:function(t,r){if(1&t&&(e.\u0275\u0275template(0,cf,5,4,"ng-container",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275template(2,pf,5,6,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(3);e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,2,r.scorecard$))("ngIfElse",a)}},dependencies:[j.NgClass,j.NgForOf,j.NgIf,X.Wj,qr.O,Ve.Fj,Ve.JJ,Ve.On,rn.X,Zr.r,Xt.Hw,Vt.W0,Vt.tN,Vt.D8,hc.v,qe.V,lt,eu,cu,uu,du,Ql,f,Jr,gu,fu,mu,hu,yc,j.AsyncPipe,Mt.F],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;height:100%}[_nghost-%COMP%]    {color:var(--scorecard-neutralPrimaryColor)}[_nghost-%COMP%]   .scorecard[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;flex:1}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]{padding:20px 50px 0;width:100%;box-sizing:border-box}[_nghost-%COMP%]   .toolbar.new-look[_ngcontent-%COMP%]{padding:0 30px 4px;background-color:var(--scorecard-headerBackgroundColor);border-bottom:1px solid var(--gray-50, #D2D0CE);display:flex;flex-direction:column}[_nghost-%COMP%]   .toolbar.new-look[_ngcontent-%COMP%]   .pbi-fluent-button[_ngcontent-%COMP%]{border:none}[_nghost-%COMP%]   .toolbar.new-look[_ngcontent-%COMP%]   .pbi-fluent-button[_ngcontent-%COMP%]:disabled{background:transparent}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]{display:inline-flex;width:100%}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{overflow:visible}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon.glyph-small[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon.glyph-mini[_ngcontent-%COMP%]{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .mat-icon.mat-ligature-font[fontIcon][_ngcontent-%COMP%]{overflow:auto}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-flex;align-items:center}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled   span[_ngcontent-%COMP%]{color:var(--gray-90, #A19F9D)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .add-goal-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchies-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .view-mode-picker-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .customize-heatmap-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchy-slicer-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;color:var(--fluent-theme-black-color, #000)}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .view-mode-picker-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchy-slicer-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0 8px}[_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .add-goal-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .add-subgoal-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchies-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .view-mode-picker-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .customize-heatmap-btn[_ngcontent-%COMP%], [_nghost-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-btns[_ngcontent-%COMP%]   .hierarchy-slicer-btn[_ngcontent-%COMP%]{margin-right:8px;background-color:var(--fluent-theme-neutral-lighter-alt-color, #FAF9F8)}[_nghost-%COMP%]   pbi-dropdown-trigger[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]{color:var(--scorecard-tableHeaderForegroundColor);background-color:rgba(0,0,0,.05);border-radius:4px;margin:10px 30px 0}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:var(--scorecard-tableHeaderForegroundColor)}[_nghost-%COMP%]   .filter-row.toolbar-visible[_ngcontent-%COMP%]{margin-top:20px}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;height:45px;outline:none}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]{font-size:20px;margin-top:4px;margin-right:12px;padding-left:15px}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{cursor:pointer;font-size:16px;margin-top:8px;margin-right:10px}[_nghost-%COMP%]   .filter-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:none;flex:1;font-size:var(--md-font-size, 14px);outline:none;padding-left:0}[_nghost-%COMP%]   .scorecard-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0px 10px;empty-cells:hide;padding-top:0;padding-bottom:0;color:var(--scorecard-tableRowForegroundColor)}[_nghost-%COMP%]   .scorecard-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1;background:var(--scorecard-tableBackgroundColor);height:40px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]{text-align:left}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:var(--lg-font-size, 16px);font-weight:var(--font-weight-regular, 400);color:var(--scorecard-tableHeaderForegroundColor);font-weight:500}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.checkmark-th[_ngcontent-%COMP%]{width:35px;max-width:35px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.checkmark-th[_ngcontent-%COMP%]:not(.show-checkmark){width:0px;max-width:0px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.checkmark-th[_ngcontent-%COMP%]:not(.show-checkmark)   .select-checkmark[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{visibility:hidden}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.show-on-hover-only[_ngcontent-%COMP%]:hover   .select-checkmark[_ngcontent-%COMP%], [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.show-on-hover-only[_ngcontent-%COMP%]   .select-checkmark.box-checked[_ngcontent-%COMP%]{visibility:visible}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]{margin-right:15px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .select-checkmark[_ngcontent-%COMP%]     pbi-checkbox{margin-bottom:0}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th.dueDate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .sort-col[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .collapse-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;margin-left:6px;min-width:48px;width:48px;background-color:transparent;border:none;padding:2px}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .collapse-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:unset}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{background-color:transparent;border:none;font-size:20px;padding:0 12px;color:inherit}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;height:unset}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:focus:hover{background-color:var(--fluent-theme-neutral-lighter-color, #F3F2F1)}[_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:active, [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn.active[_ngcontent-%COMP%], [_nghost-%COMP%]   .scorecard-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .filter-btn-and-name[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]:active:focus:hover{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}[_nghost-%COMP%]   .add-goal-btn-box[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]   .add-goal-btn-box[_ngcontent-%COMP%]   .add-goal-btn[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);color:var(--gray-180, #252423);padding:6px 18px;box-sizing:border-box;border-radius:2px;height:32px;display:inline-block;cursor:pointer;background-color:var(--fluent-theme-primary-color, #F2C811)}[_nghost-%COMP%]   .center-text[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);text-align:center}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]{overflow:hidden;padding:0 20px}@media screen and (min-width: 1024px){[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]{padding:0 26px}}@media screen and (min-width: 1366px){[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]{padding:0 60px}}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]   compact-scorecard[_ngcontent-%COMP%]{overflow:hidden}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]   scorecard-list-toolbar[_ngcontent-%COMP%]{--toolbar-padding: 12px 0 12px 0}[_nghost-%COMP%]   .compact.scorecard[_ngcontent-%COMP%]     .scorecard-status-tiles{padding:0}label.label[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:-100%}.label[_ngcontent-%COMP%]{cursor:pointer;padding:5px 15px;display:inline-block}.no-goals[_ngcontent-%COMP%], empty-scorecard[_ngcontent-%COMP%]{color:var(--scorecard-tableHeaderForegroundColor);padding:20px;flex:1}.no-goals.border-top[_ngcontent-%COMP%], empty-scorecard.border-top[_ngcontent-%COMP%]{border-top:1px solid var(--gray-50, #D2D0CE)}.heat-map-scroll[_ngcontent-%COMP%]{overflow:hidden}.heat-map[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex}.mat-menu-item[_ngcontent-%COMP%]{color:var(--gray-180, #252423);display:flex;flex-direction:row;align-items:center;height:36px;padding-right:16px}  .view-mode-picker-menu mat-icon{display:flex;align-items:center}  .view-mode-picker-menu .mat-icon{overflow:visible}  .view-mode-picker-menu .mat-icon.glyph-small{font-size:var(--lg-font-size, 16px);width:var(--lg-font-size, 16px);height:var(--lg-font-size, 16px)}  .view-mode-picker-menu .mat-icon.glyph-mini{font-size:var(--sm-font-size, 12px);width:var(--sm-font-size, 12px);height:var(--sm-font-size, 12px)}  .view-mode-picker-menu .mat-icon.mat-ligature-font[fontIcon]{overflow:auto}.new-header   scorecard[_nghost-%COMP%], scorecard   [_nghost-%COMP%]{display:block}  .hierarchy-slicer-menu .mat-menu-content{padding:0!important}"],changeDetection:0}),i}();function hf(i,n){if(1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"path",4)),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("d",t.path)("stroke",t.settings.lineColor)("stroke-width",t.settings.lineWidth)}}function gf(i,n){if(1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"circle")),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("cx",t.min.x)("cy",t.min.y)("r",t.settings.dotRadius)("fill",t.settings.dotFillColor)("stroke",t.settings.dotColor)("stroke-width",t.settings.dotStrokeWidth)}}function ff(i,n){if(1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"circle")),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275attribute("cx",t.max.x)("cy",t.max.y)("r",t.settings.dotRadius)("fill",t.settings.dotFillColor)("stroke",t.settings.dotColor)("stroke-width",t.settings.dotStrokeWidth)}}function mf(i,n){if(1&i&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275elementStart(0,"div",5)(1,"table")(2,"tr")(3,"th",6),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"th",7),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"formatValue"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"tr")(10,"th",6),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"th",7),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"formatValue"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"tr")(17,"th",6),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"th",7),e.\u0275\u0275text(21),e.\u0275\u0275elementEnd()()()()),2&i){var t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,6,"High")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(8,8,t.tooltip.high,t.formatString)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(12,11,"Low")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(15,13,t.tooltip.low,t.formatString)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(19,16,"Cycle")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.tooltip.cycle)}}var vf=function(){function i(n){this.localizationService=n,this.DefaultOptions={height:48,width:120,lineColor:"#5BD667",lineWidth:2,dotRadius:2,dotStrokeWidth:1,dotFillColor:"#161514",dotColor:"#5BD667",showMax:!0,showMin:!0,tension:.5},this.settings=Object.assign({},this.DefaultOptions)}return Object.defineProperty(i.prototype,"values",{set:function(t){this.sparklinePoints=t?.filter(function(r){return null!=r.value&&null!=r.timestamp}),this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"options",{set:function(t){this.settings=Object.assign({},this.DefaultOptions,t),this.sparklinePoints&&this.update()},enumerable:!1,configurable:!0}),i.prototype.ngOnChanges=function(n){n.cycle&&(this.tooltip=Object.assign({},this.tooltip,{cycle:this.getCycleText()})),n.formatString&&this.update()},i.prototype.update=function(){var n;this.viewBox="0 0 ".concat(this.settings.width," ").concat(this.settings.height),(null===(n=this.sparklinePoints)||void 0===n?void 0:n.length)>=2?(this.points=i.calculatePoints(this.sparklinePoints,this.settings),this.path=i.calculatePath(this.points,this.settings),this.min=this.points.reduce(function(t,r){return t?.y<r.y?t:r}),this.max=this.points.reduce(function(t,r){return t?.y>r.y?t:r}),this.tooltip=this.getTooltipData(this.sparklinePoints)):(this.points=null,this.path=null,this.min=null,this.max=null)},i.calculatePoints=function(n,t){var r=n.map(function(Se){return{value:Se.value,timestamp:new Date(Se.timestamp)}}),a=_.map(r,function(Se){return Se.value}),s=_.min(a),c=_.max(a),u=_.map(r,function(Se){return Se.timestamp.getTime()}),p=_.min(u),v=_.max(u),P=this.calculateSafeRange(c,s),x=this.calculateSafeRange(v,p),G=t.dotRadius+t.dotStrokeWidth+this.PaddingOnEdges,Y=t.width-2*G,ue=t.height-2*G;return r.map(function(Se){return{x:(Se.timestamp.getTime()-p)/x*Y+G,y:(1-(Se.value-s)/P)*ue+G}})},i.calculatePath=function(n,t){for(var r="M ".concat(n[0].x,", ").concat(n[0].y),a=[],s=0;s<n.length;s++)if(0===s||s===n.length-1)a.push({x:0,y:0});else{var c=this.calculateDerivative(n[s-1],n[s+1]),u=Math.sqrt(1+c*c);a.push({x:1/u,y:c/u})}for(s=0;s<n.length-1;s++){var p=n[s],v=n[s+1],P=Math.abs(v.x-p.x),x=Math.abs(v.y-p.y),G=Math.min(P,x)*t.tension,ue=p.y+G*a[s].y,Se=v.x-G*a[s+1].x,Ae=v.y-G*a[s+1].y,xe="C ".concat(p.x+G*a[s].x,", ").concat(ue," ").concat(Se,", ").concat(Ae," ").concat(v.x,", ").concat(v.y);r+=" ".concat(xe)}return r},i.calculateDerivative=function(n,t){return t.x===n.x?0:(t.y-n.y)/(t.x-n.x)},i.calculateSafeRange=function(n,t){var r=n-t;return 0===r?1:r},i.prototype.getTooltipData=function(n){var t=_.map(n,function(s){return s.value}),r=_.min(t);return{high:_.max(t),low:r,cycle:this.getCycleText()}},i.prototype.getCycleText=function(){switch(this.cycle){case 1:return this.localizationService.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Daily");case 2:return this.localizationService.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Weekly");case 3:return this.localizationService.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Monthly");case 4:return this.localizationService.get("MetricsDetailsPane_TimePeriodTab_RadioButton_Quarterly");case 5:return this.localizationService.get("MetricsDetailsPane_TimePeriodTab_RadioButton_Yearly");default:return"-"}},i.PaddingOnEdges=1.5,i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(ft.o))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["sparkline"]],inputs:{values:"values",options:"options",formatString:"formatString",cycle:"cycle"},features:[e.\u0275\u0275NgOnChangesFeature],decls:7,vars:11,consts:[["role","img",3,"aria-label","pbiTooltip","pbiTooltipDisabled"],["fill","transparent",4,"ngIf"],[4,"ngIf"],["tooltipTmpl",""],["fill","transparent"],[1,"sparkline-tooltip"],[1,"text"],[1,"value"]],template:function(t,r){if(1&t&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(0,"svg",0),e.\u0275\u0275pipe(1,"localize"),e.\u0275\u0275template(2,hf,1,3,"path",1),e.\u0275\u0275template(3,gf,1,6,"circle",2),e.\u0275\u0275template(4,ff,1,6,"circle",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,mf,22,18,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&t){var a=e.\u0275\u0275reference(6);e.\u0275\u0275property("aria-label",e.\u0275\u0275pipeBind1(1,9,"Metrics_Sparkline_AltText"))("pbiTooltip",a)("pbiTooltipDisabled",!r.tooltip),e.\u0275\u0275attribute("width",r.settings.width)("height",r.settings.height)("viewBox",r.viewBox),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",r.path),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.settings.showMin&&r.min),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.settings.showMax&&r.max)}},dependencies:[j.NgIf,qe.V,Mt.F,Er.c],styles:['[_nghost-%COMP%]   .sparkline[_ngcontent-%COMP%]{height:100%;width:100%}  .sparkline-tooltip{padding:5px 15px}  .sparkline-tooltip .text{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-semi-bold, 600);text-align:right;padding-right:8px}  .sparkline-tooltip .value{font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);text-align:left}'],changeDetection:0}),i}(),Cf=function(){function i(){this.mappings=[{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:Math.pow(10,3)}]}return i.prototype.transform=function(n,t){if(void 0===t&&(t=2),null==n||isNaN(n))return"\u2014";if(0===n)return"0";(null==t||t<0||isNaN(t))&&(t=2);for(var r=Math.pow(10,t),a=n<0?"-":"",s="",c=n=Math.abs(n),u=0,p=this.mappings;u<p.length;u++){var v=p[u],P=_.round(n*r/v.value)/r;if(P>=1){c=P,s=v.key;break}}return"".concat(a).concat(c).concat(s)},i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.\u0275\u0275definePipe({name:"shortNumber",type:i,pure:!0}),i}(),_f=M(52910),Cu=(M(94120),M(82775),M(90938)),_u=M(52040),yu=M(93367),bu=M(16095),wf=M(70137),wu=M(88717),Su=M(68264),Sf=M(47754),Mf=function(){function i(n,t){this.profileImageService=n,this.userHttpService=t,this.usersCache={}}return i.prototype.getUserPhoto=function(n){return(0,ac.D)(this.profileImageService.getOtherUserPhoto(n))},i.prototype.getUserDetails=function(n){var t=this;n=_.filter(n,function(v){return!!v});var r=[],a=[];if(_.isEmpty(n))return(0,ac.D)([]);for(var s=0,c=n;s<c.length;s++){var p=c[s].toLowerCase();this.usersCache[p]||(this.usersCache[p]=new ir.t(1),a.push(p)),r.push(this.usersCache[p])}return _.isEmpty(a)||this.userHttpService.getUserDetails(a).pipe((0,he.q)(1)).subscribe(function(v){var P={};if(_.some(v?.data))for(var x=0,G=v?.data;x<G.length;x++){var Se=(Y=G[x]).userPrincipalName,Ae=Y.objectId;t.upsert(Y.emailAddress,Y,P),t.upsert(Se,Y,P),t.upsert(Ae,Y,P)}for(var Be=0,Je=_.filter(a,function(ut){return!P[ut]});Be<Je.length;Be++){var Y;t.usersCache[Y=Je[Be]].next(void 0),t.usersCache[Y].complete()}},function(){for(var v,P,x=0,G=a;x<G.length;x++){var Y=G[x];null===(v=t.usersCache[Y])||void 0===v||v.next(void 0),null===(P=t.usersCache[Y])||void 0===P||P.complete(),delete t.usersCache[Y]}}),(0,Di.D)(r).pipe((0,je.U)(function(v){return _.filter(v,function(P){return!!P})}))},i.prototype.findUsers=function(n,t){return this.userHttpService.findUsers(n,1,t,!0,!0).pipe((0,je.U)(function(r){return r?.data}))},i.prototype.upsert=function(n,t,r){if(n){var a=n.toLowerCase();this.usersCache[a]||(this.usersCache[a]=new ir.t(1)),this.usersCache[a].next(t),this.usersCache[a].complete(),r[a]=!0}},i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(Sf.L),e.\u0275\u0275inject(qc.W))},i.\u0275prov=e.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(),Mu=M(79061),Pf=M(76037),Pu=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:pn.K,useClass:Mf}],imports:[j.CommonModule,Mu.v,Pf.J,Cu.g,wu.R,Su.z]}),i}();function Of(i){return function(){return i.scrollStrategies.close()}}var xf=function(){function i(){}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:uc,deps:[Pa.aV],useFactory:Of}],imports:[j.CommonModule,Qc,zc,Wt.wp,Ve.UX,Te.Cl,Su.z,yu.U,wf.F,Cu.g,Pu,wu.R,_u.x,bu.Z]}),i}(),Tf=M(22346),Ef=M(82156),If=M(71328),Df=M(76966),kf=M(47913),Ff=M(6015),Vf=M(94770),Af=M(23612),Rf=M(45411),Lf=(M(5209),M(52601),M(25834)),Gf=M.n(Lf),Nf=M(59215),Hf=M.n(Nf),zf=M(51269),qf=M.n(zf),Bf=M(53581),Uf=M.n(Bf),jf=M(76902),Wf=M.n(jf),$f=M(9382),Qf=M.n($f),Xf=M(87491),Xl=M.n(Xf),ka={};ka.styleTagTransform=Qf(),ka.setAttributes=Uf(),ka.insert=qf().bind(null,"head"),ka.domAPI=Hf(),ka.insertStyleElement=Wf(),Gf()(Xl(),ka),Xl()&&Xl().locals&&Xl(),M(45690);var Ou="appBarSprite",Yf={name:Ou,sprite:window[Ou]},Zf=M(59951),Jf=M(16748),Kf=M(76777),em=M(44913),tm=M(33161),nm=M(54485),rm=[{componentId:fc.componentId,type:fc},{componentId:mc.componentId,type:mc},{componentId:vc.componentId,type:vc},{componentId:o1.a.componentId,type:vu},{componentId:ye.H.componentId,type:pu},{componentId:Bn.i.componentId,type:ru},{componentId:mi.componentId,type:mi},{componentId:Ul.componentId,type:Ul}],om=((0,w.__spreadArray)((0,w.__spreadArray)([],[Ee,lt,Bt,zr,Ul,eu,uo,tu,Kc,N0,ru,Oc,xc,nc,Ic,cu,au,fc,mc,vc,uu,du,mi,vu,pu,Vi,vf,Br,Zc,va,Cc,Ql,bs],!0),[f,On,Jc,no,Ho,si,ao,ui,po,pi,Jr,$l,gu,fu,mu,Ql,hu,yc,_c,Cf,Ie,nu,Tr],!1),function(){function i(n){n.registerIcons(Yf.sprite)}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275inject(nm.u))},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[vr,Tc,wc],imports:[j.CommonModule,re.nZ,Df.c,_f.O,X._t,Tf.J,xf,Ve.u5,Ef.N.withManifests(rm),Mu.v,If.G,bc.vV,Fi.t,Xt.Ps,Vt.jT,en.uw,_u.x,kf.V,Ff.C,Vf.f,Af.N,yu.U,Rf.m,Zf.v,Jf.H,bu.Z,Ve.UX,Te.Cl,em.lK,tm.R,Mc.T6,Pu,Kf.H,ju]}),i}())},8748:function(pt,Ct,M){"use strict";M.d(Ct,{o:function(){return Re}});var w=M(81337),b=M(12966),e=M(41114),j="PBI.MashupEditor.OnReadyError",qe=e.cx[j]=(0,e.b1)(j),te="PBI.MashupEditor.OnTokenError",Le=e.cx[te]=(0,e.b1)(te),tt=M(48741),Ge=M(50423),He=M(95281),Z=M(35911),Ee=M(73221),se=M(4633),I=M(78590),ie=M(59017),ye=M(23558),W=M(59973),ne=M(83317),ve=M(76746),me=M(85928),q=M(65181),be=["mashupIframe"],pe={readyState:0},Re=function(Qe){function ke(N,B,X,K,le,ae){var ze=Qe.call(this)||this;return ze.appSettings=N,ze.ref=B,ze.mashupService=X,ze.localizationService=K,ze.telemetryService=le,ze.componentStore=ae,ze.onError=new Ge.EventEmitter,ze.onReady=new Ge.EventEmitter,ze.readyState$=ze.componentStore.select(function(st){return st.readyState}),ze.updateState=ze.componentStore.updater(function(st,vt){return(0,w.__assign)((0,w.__assign)({},st),{readyState:vt})}),ze}return(0,w.__extends)(ke,Qe),ke.prototype.ngOnInit=function(){var B,X,K,le,N=this;!this.theme&&!(null===(X=null===(B=this.clientConfiguration)||void 0===B?void 0:B.editorSettings)||void 0===X)&&X.themeOverride&&(this.theme=null===(le=null===(K=this.clientConfiguration)||void 0===K?void 0:K.editorSettings)||void 0===le?void 0:le.themeOverride),this.componentStore.setState(pe),this.changes$("flow").pipe((0,ye.M)(this.readyState$),(0,W.h)(function(ae){return!!ae[0]&&1!==ae[1]}),(0,ne.R)(this.onDestroy$)).subscribe(function(ae){var st=ae[1];return(0,w.__awaiter)(N,void 0,void 0,function(){return(0,w.__generator)(this,function(vt){switch(vt.label){case 0:return this.updateState(1),0===st?[3,2]:[4,this.endFlow()];case 1:vt.sent(),vt.label=2;case 2:return this.startFlow(),[2]}})})})},ke.prototype.ngAfterViewInit=function(){var N=this;(0,Z.mv)(this.clientConfiguration,"clientConfiguration is required"),this.mashupService.getPQToken("".concat(this.appSettings.powerQueryResourceName,"/.default")).toPromise().catch(function(){}),this.mashupDataSubscription=(0,ie.aj)([this.mashupService.getPQEndpoint()]).pipe((0,W.h)(function(B){return!!B[0]})).subscribe(function(B){N.initMashupeditor(B[0])},function(B){N.onError.emit(B)})},ke.prototype.ngOnDestroy=function(){return this.mashupEditorClient&&this.mashupEditorClient.dispose(),this.mashupDataSubscription&&this.mashupDataSubscription.unsubscribe(),Qe.prototype.ngOnDestroy.call(this)},ke.prototype.setFocus=function(){var N=this.mashupIframe.nativeElement.contentDocument||this.mashupIframe.nativeElement.contentWindow;N?.focus()},ke.prototype.activateQuery=function(N){return this.mashupEditorClient.activateQuery(N)},ke.prototype.addQuery=function(N,B){return this.mashupEditorClient.addQuery(N,B)},ke.prototype.cancelCurrentEvaluation=function(){return this.mashupEditorClient.dataPreview.cancelCurrentEvaluation()},ke.prototype.getEditingSessionMashup=function(){return this.mashupEditorClient.getEditingSessionMashup()},ke.prototype.getQueriesInfo=function(){return this.mashupEditorClient.getQueriesInfo()},ke.prototype.getQueryScript=function(N){return this.mashupEditorClient.getQueryScript(N)},ke.prototype.getDataSourceQueryScript=function(N,B){return this.mashupEditorClient.getDataSourceQueryScript(N,B)},ke.prototype.setUserSettings=function(N){return this.mashupEditorClient.setUserSettings(N)},ke.prototype.refreshActiveQueryResult=function(){return this.mashupEditorClient.refreshActiveQueryResult()},ke.prototype.getSelectedStepName=function(){return this.mashupEditorClient.getSelectedStepName()},ke.prototype.getActiveQueryName=function(){return this.mashupEditorClient.getActiveQueryName()},ke.prototype.getClientSettings=function(N){return{allowedOrigin:N,container:this.mashupIframe.nativeElement,url:this.createMashupEditorUrl(N),className:"mashup-editor-client-iframe"}},ke.prototype.createMashupEditorUrl=function(N){var B="".concat(N,"/MashupEditor");if(this.mashupEditorFeatureFlags&&this.mashupEditorFeatureFlags.size>0){var X=new tt.LE;this.mashupEditorFeatureFlags.forEach(function(K,le){X=X.set(le,K)}),B=B+"?"+X.toString()}return B},ke.prototype.getEditorSettings=function(){var N={cancelButtonLabel:this.localizationService.get("Cancel_ButtonText"),closeButtonSettings:{showConfirmationPrompt:!1,actionOnClick:I.w9.Cancel},commitButtonLabel:this.localizationService.get("ModalDialog_Save"),enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!1,returnQueryEditorResult:!1,showCancelButton:!0,useHostConnectionProvider:!1};return{addFocusTrapZone:!1,locale:this.localizationService.currentLanguageLocale,sessionId:this.telemetryService.sessionId,queryEditorSettings:N,showCloseButton:!0,showHeader:!1,themeOverride:this.theme||b.C8}},ke.prototype.endFlow=function(){return(0,w.__awaiter)(this,void 0,void 0,function(){var N;return(0,w.__generator)(this,function(B){switch(B.label){case 0:if(!this.mashupEditorClient)return[2];B.label=1;case 1:return B.trys.push([1,3,,4]),[4,this.mashupEditorClient.endFlow()];case 2:return B.sent(),this.updateState(3),[3,4];case 3:return N=B.sent(),this.onError.emit(N),this.updateState(4),[3,4];case 4:return[2]}})})},ke.prototype.startFlow=function(){var N=this;!this.flow||!this.mashupEditorClient||this.mashupEditorClient.ready.then(function(){N.mashupEditorClient.startFlow(N.flow,N.editorOnCommit,N.editorOnCancel).then(function(){N.updateState(2),N.onReady.emit(),N.ref.detectChanges()},function(B){N.updateState(4)})},function(B){N.onError.emit(B),N.updateState(4),N.telemetryService.logEvent(qe,{reason:B?B+"":void 0})})},ke.prototype.initMashupeditor=function(N){var B=this,X=this.getClientSettings(N),K=this.getEditorSettings();this.mashupEditorClient=function(ke){return new I.Cq(ke)}(_.merge({clientSettings:X,editorSettings:K,acquireToken:function(ae){return B.mashupService.getPQToken("".concat(ae,"/.default")).toPromise().catch(function(ze){B.onError.emit(ze),B.telemetryService.logEvent(Le,{reason:ze?ze.status+"":void 0})})}},this.clientConfiguration)),this.startFlow()},ke.\u0275fac=function(B){return new(B||ke)(Ge.\u0275\u0275directiveInject(ve.de),Ge.\u0275\u0275directiveInject(Ge.ChangeDetectorRef),Ge.\u0275\u0275directiveInject(me.M),Ge.\u0275\u0275directiveInject(q.o),Ge.\u0275\u0275directiveInject(se.y0),Ge.\u0275\u0275directiveInject(He.m1))},ke.\u0275cmp=Ge.\u0275\u0275defineComponent({type:ke,selectors:[["mashup-editor"]],viewQuery:function(B,X){var K;(1&B&&Ge.\u0275\u0275viewQuery(be,5),2&B)&&(Ge.\u0275\u0275queryRefresh(K=Ge.\u0275\u0275loadQuery())&&(X.mashupIframe=K.first))},inputs:{clientConfiguration:"clientConfiguration",mashupEditorFeatureFlags:"mashupEditorFeatureFlags",flow:"flow",editorOnCommit:"editorOnCommit",editorOnCancel:"editorOnCancel",theme:"theme"},outputs:{onError:"onError",onReady:"onReady"},features:[Ge.\u0275\u0275ProvidersFeature([He.m1]),Ge.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["id","mashupIframe","pbi-auto-focus","","data-testid","mashup-iframe"],["mashupIframe",""]],template:function(B,X){1&B&&Ge.\u0275\u0275element(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:flex}#mashupIframe[_ngcontent-%COMP%]{background:var(--white-color, #FFF);display:flex;flex:1 1 auto;align-items:stretch;justify-content:center}#mashupIframe[_ngcontent-%COMP%]     .mashup-editor-client-iframe{border:none;width:100%;height:100%;display:block!important}"],changeDetection:0}),ke}(Ee.w)},12966:function(pt,Ct,M){"use strict";M.d(Ct,{C8:function(){return w},z6:function(){return b}});var w={palette:{themeDarker:"#b1920b",themeDark:"#bc9a0a",themeDarkAlt:"#c5a20b",themePrimary:"#f2c811",themeSecondary:"#f2c811",themeTertiary:"#f7de72",themeLight:"#f9e48a",themeLighter:"#fbefba",themeLighterAlt:"#fdf6d7"},semanticColors:{primaryButton:{text:{default:"#333333"}},checkableInput:{text:{checked:"#333333"}},grid:{cell:{linkText:{default:"#7D6807",focused:"#5C4C05"}}}}},b={palette:{themePrimary:"#117865",themeLighterAlt:"#f1faf8",themeLighter:"#c9e9e3",themeLight:"#9fd6cc",themeTertiary:"#54ae9d",themeSecondary:"#218875",themeDarkAlt:"#0f6c5b",themeDark:"#0d5b4d",themeDarker:"#094339",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},semanticColors:{}}},71328:function(pt,Ct,M){"use strict";M.d(Ct,{G:function(){return be}});var w=M(32293),b=M(50423),e=M(77476),j=M(8748);function qe(_e,pe){if(1&_e){var Re=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"mashup-editor",1),b.\u0275\u0275listener("onError",function(){b.\u0275\u0275restoreView(Re);var N=b.\u0275\u0275nextContext();return b.\u0275\u0275resetView(N.onError)}),b.\u0275\u0275elementEnd()}if(2&_e){var Qe=b.\u0275\u0275nextContext();b.\u0275\u0275property("clientConfiguration",Qe.mashUpEditorInput.clientConfiguration)("editorOnCommit",Qe.onCommit)("editorOnCancel",Qe.onCancel)("flow",Qe.mashUpEditorInput.flow)}}var te=function(){function _e(pe,Re){var Qe=this;this.dialogRef=pe,this.onCommit=function(ke,N){Qe.mashUpEditorInput.editorOnCommit(ke,N),Qe.dialogRef.close(N)},this.onCancel=function(ke){Qe.mashUpEditorInput.editorOnCancel(ke),Qe.dialogRef.close()},this.onError=function(ke){Qe.mashUpEditorInput.onError(ke)},this.mashUpEditorInput=Re.input}return _e.\u0275fac=function(Re){return new(Re||_e)(b.\u0275\u0275directiveInject(w.so),b.\u0275\u0275directiveInject(w.WI))},_e.\u0275cmp=b.\u0275\u0275defineComponent({type:_e,selectors:[["mashup-editor-dialog"]],decls:1,vars:1,consts:[["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError",4,"ngIf"],["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError"]],template:function(Re,Qe){1&Re&&b.\u0275\u0275template(0,qe,1,4,"mashup-editor",0),2&Re&&b.\u0275\u0275property("ngIf",!!Qe.mashUpEditorInput.clientConfiguration)},dependencies:[e.NgIf,j.o],styles:["[_nghost-%COMP%]     mashup-editor{display:flex;width:80vw;height:80vh}[_nghost-%COMP%]{display:flex}"]}),_e}(),tt=new b.InjectionToken("MashUpEditorErrorHandler"),Ge=new b.InjectionToken("MashUpEditorLauncher"),He=M(78590),Z=M(33554),Ee=M(82762),se=M(48787),I=M(42195),ie=M(58938),ye=function(_e){return _e.OnCommit="OnCommit",_e.OnCancel="OnCancel",_e}({}),ne={provide:Ge,useClass:function(){function _e(pe,Re){this.dialogService=pe,this.errorHandler=Re,this.lifeCycleEvent$=new Z.t(1)}return _e.prototype.editQueries=function(pe,Re){return this.launchMashUpEditor(Re.clientConfiguration,{kind:He.Mw.EditQuery,hostContext:Re.hostContext||pe.hostContext,mashupDefinition:{editingSessionMashup:pe,kind:He.Qo.TransientMashup}})},_e.prototype.addQueries=function(pe,Re){var Qe=this.buildFlowForAddQueries(pe,Re);return this.launchMashUpEditor(Re.clientConfiguration,Qe)},_e.prototype.manageDataSources=function(pe,Re){return this.launchMashUpEditor(Re.clientConfiguration,{kind:He.Mw.ManageConnections,hostContext:Re.hostContext,connectionOverrides:pe.connectionOverrides})},_e.prototype.buildFlowForAddQueries=function(pe,Re){var Qe={kind:He.Mw.AddQueries,hostContext:Re.hostContext||pe.hostContext};return function(_e){return!_.has(_e,"mashupDocument")||_.isNil(_e.mashupDocument)}(pe)?(Qe.mashupTemplateImportAllowed=!0,Qe.mashupDefinition={editingSessionEmptyMashup:pe,kind:He.Qo.TransientEmptyMashup}):(Qe.mashupTemplateImportAllowed=!1,Qe.mashupDefinition={editingSessionMashup:pe,kind:He.Qo.TransientMashup}),Qe},_e.prototype.launchMashUpEditor=function(pe,Re){var Qe=this;return(0,Ee.D)(this.dialogService.showTemplateDialog("MashUpEditorDialogComponentId",{title:"Mash Up Editor Dialog",input:{clientConfiguration:pe,flow:Re,editorOnCommit:function(B,X){return Qe.onCommit(B,X)},editorOnCancel:function(B){return Qe.onCancel(B)},onError:function(B){var X;return null===(X=Qe.errorHandler)||void 0===X?void 0:X.handleError(B)}}})).pipe((0,se.q)(1),(0,I.zg)(function(N){return N.afterClosed()})).toPromise()},_e.prototype.onCommit=function(pe,Re){this.lifeCycleEvent$.next({type:ye.OnCommit,payload:Re})},_e.prototype.onCancel=function(pe){this.lifeCycleEvent$.next({type:ye.OnCancel,payload:void 0})},_e.\u0275fac=function(Re){return new(Re||_e)(b.\u0275\u0275inject(ie.x),b.\u0275\u0275inject(tt,8))},_e.\u0275prov=b.\u0275\u0275defineInjectable({token:_e,factory:_e.\u0275fac}),_e}()},ve=M(79061),me=M(24495),be=function(){function _e(){}return _e.\u0275fac=function(Re){return new(Re||_e)},_e.\u0275mod=b.\u0275\u0275defineNgModule({type:_e}),_e.\u0275inj=b.\u0275\u0275defineInjector({providers:[ne],imports:[e.CommonModule,ve.v,me.z.withManifest([{componentIdentifier:"MashUpEditorDialogComponentId",componentType:te}])]}),_e}()},85928:function(pt,Ct,M){"use strict";M.d(Ct,{M:function(){return ve}});var w=M(36444),b=M(35911),e=M(85732),j=(0,e.ZF)("urlConfiguration"),qe=(0,e.P1)(j,function(me){return me.powerQueryHostUrl}),te=M(37263),Le=M(59694),tt=M(11547),Ge=M(82762),He=M(35510),Z=M(42195),Ee=M(14172),se=M(17653),I=M(88255),ie=M(50423),ye=M(62113),W=M(73875),ne=window,ve=function(){function me(q,be,_e,pe){var Re=this;this.store=q,this.accessTokenProviderService=be,this.httpService=_e,this.inTeams=pe,this.getAADToken$=function(Qe){return(0,tt.of)(null).pipe((0,Z.zg)(function(){if(ne.clientAuthEnabled)return(0,Ge.D)(Re.accessTokenProviderService.acquireToken("MashupService",[Qe],!1)).pipe((0,Ee.U)(function(X){return X.token}));if(Re.inTeams){var ke=Qe.substring(0,Qe.lastIndexOf("/"));return w.authentication.initialize(),(0,Ge.D)(w.authentication.getAuthToken({resources:[ke],silent:!0}))}var N=(0,Le.W)("{0}/msal",ne.baseUrl||window.location.origin),B=Re.httpService.powerbiRequestOptions();return B.params={scopes:Qe},Re.httpService.get(N,B).pipe((0,Ee.U)(function(X){return X.data.AccessToken}))}),(0,se.b)(function(ke){var B=1e3*(0,b.oG)(ke).exp;Re.AADTokenCache$.next(new Map(Re.AADTokenCache$.getValue()).set(Qe,{token:ke,expiration:B}))}))},this.AADTokenCache$=new He.X(new Map)}return me.prototype.getPQEndpoint=function(){return this.store.select(qe).pipe((0,Ee.U)(function(q){return(0,Le.g)(q)?null:q.replace(/\/$/,"")}))},me.prototype.getPQToken=function(q){var be=this;return this.AADTokenCache$.pipe((0,I.P)(),(0,Z.zg)(function(_e){return!_e.has(q)||Date.now()+3e5>_e.get(q).expiration?be.getAADToken$(q):(0,tt.of)(_e.get(q).token)}))},me.\u0275fac=function(be){return new(be||me)(ie.\u0275\u0275inject(e.yh),ie.\u0275\u0275inject(ye.Q),ie.\u0275\u0275inject(W.O),ie.\u0275\u0275inject(te.$,8))},me.\u0275prov=ie.\u0275\u0275defineInjectable({token:me,factory:me.\u0275fac,providedIn:"root"}),me}()},47754:function(pt,Ct,M){"use strict";M.d(Ct,{L:function(){return ye}});var w=M(82515),b=M(14463),e=M(34410),j=M(59055),qe=M(38078),te=M(4633),Le=M(76609),tt=M(50423),Ge=M(27887),He=M(79474),Z=M(18942),Ee=M(85732),ye=function(){function W(ne,ve,me,q,be,_e,pe,Re){this.applicationOptions=ne,this.userInfo=ve,this.userProfileImageService=me,this.telemetryService=q,this.sanitizer=be,this.store=_e,this.groupPhotos=[],this.userPhotos=[],this.findGroupIconPromises=[],this.getOtherUserPhotoPromises=[],this.getGroupIconPromises=[],this.userMetadataHttpService=pe,this.promiseFactory=Re}return W.prototype.getGroupIcons=function(ne){var ve=this;if(void 0===ne&&(ne=4900),this.groupIconsPromise)return this.groupIconsPromise;var me=this.promiseFactory.defer();return setTimeout(function(){var q=ve.telemetryService.startEvent(j.Sj);ve.userMetadataHttpService.getUserGroupIcons(q.event).toPromise().then(function(be){be.data&&(me.resolve(be.data),ve.store.dispatch(new w.YI({groupIcons:be.data})))},function(){me.reject()})},ne),this.groupIconsPromise=me.promise,me.promise},W.prototype.getGroupIcon=function(ne,ve){var me=this;void 0===ve&&(ve=4900);var q=_.find(this.getGroupIconPromises,function(pe){return pe.groupObjectId===ne});if(q)return q.promise;var be=this.promiseFactory.defer(),_e=this.applicationOptions.isE2ERun?this.getRejectedHttpResultPromiseWithNotFound():this.userMetadataHttpService.getGroupIcon(ne).toPromise();return setTimeout(function(){_e.then(function(pe){if(pe.data){var Re=me.base64Enconding(pe.data.groupIcon);be.resolve(Re),me.groupPhotos.push({groupObjectId:ne,groupIcon:Re})}else be.reject()},function(pe){me.resultHasStatusEquivalentOfNotFound(pe.status)?(be.resolve(""),me.groupPhotos.push({groupObjectId:ne,groupIcon:""})):be.reject()})},ve),this.getGroupIconPromises.push({groupObjectId:ne,promise:be.promise}),be.promise},W.prototype.getUserPhoto=function(){var ne=this;if(this._userPhotoPromise)return this._userPhotoPromise;var ve=this.userProfileImageService.getUserPhoto();return this._userPhotoPromise=ve,ve.then(function(me){ne.userPhotos.push({userObjectId:ne.userInfo.puid,userIcon:me});var q=me.substring(4,me.length-1),be=ne.sanitizer.bypassSecurityTrustUrl(q);ne.store.dispatch(new w.Ar(be))},function(me){if(me.name!==Le.SJ)throw me}),ve},W.prototype.getOtherUserPhoto=function(ne){var ve=this,me=_.find(this.getOtherUserPhotoPromises,function(_e){return _e.userObjectId===ne});if(me)return me.promise;var q=this.promiseFactory.defer();return(this.applicationOptions.isE2ERun?this.getRejectedHttpResultPromiseWithNotFound():this.userMetadataHttpService.getOtherUserPhoto(ne).toPromise()).then(function(_e){if(_e.data.type===qe.JA){var pe=URL.createObjectURL(_e.data);return q.resolve(pe),void ve.userPhotos.push({userObjectId:ne,userIcon:pe})}q.reject()},function(_e){ve.resultHasStatusEquivalentOfNotFound(_e.status)?(q.resolve(""),ve.userPhotos.push({userObjectId:ne,userIcon:""})):q.reject()}),this.getOtherUserPhotoPromises.push({userObjectId:ne,promise:q.promise}),q.promise},W.prototype.findGroupIcon=function(ne,ve){var me=this,q=_.find(this.findGroupIconPromises,function(_e){return _e.groupObjectId===ne});if(q)return q.promise;var be=this.promiseFactory.defer();return this.getGroupIcons(ve).then(function(_e){var pe=_.find(_e,function(Qe){return Qe.groupObjectId===ne});if(pe){var Re=me.base64Enconding(pe.groupIcon);be.resolve(Re),me.groupPhotos.push({groupObjectId:ne,groupIcon:Re})}else be.reject("Group with objectid "+ne+" has no icon")},function(){be.reject()}),this.findGroupIconPromises.push({groupObjectId:ne,promise:be.promise}),be.promise},W.prototype.findOrGetGroupPhoto=function(ne){var ve=this,me=this.promiseFactory.defer(),q=_.find(this.groupPhotos,function(be){return be.groupObjectId===ne});return q?""!==q.groupIcon?me.resolve(q.groupIcon):me.reject():this.findGroupIcon(ne).then(function(be){me.resolve(be)},function(){ve.getGroupIcon(ne).then(function(be){me.resolve(be)},function(be){me.reject()})}),me.promise},W.prototype.findOrGetUserPhoto=function(ne){var ve=this.promiseFactory.defer(),me=_.find(this.userPhotos,function(q){return q.userObjectId===ne});return me?""!==me.userIcon?ve.resolve(me.userIcon):ve.reject():ne===this.userInfo.puid?this._userPhotoPromise&&this._userPhotoPromise.then(function(q){ve.resolve(q)}):this.getOtherUserPhoto(ne).then(function(q){q?ve.resolve(q):ve.reject()}),ve.promise},W.prototype.base64Enconding=function(ne){return"data:image/jpeg;base64,"+ne},W.prototype.resultHasStatusEquivalentOfNotFound=function(ne){return 404===ne||400===ne||500===ne},W.prototype.getRejectedHttpResultPromiseWithNotFound=function(){return this.promiseFactory.reject({data:{},status:404,headers:function(){return""}})},W.\u0275fac=function(ve){return new(ve||W)(tt.\u0275\u0275inject(Ge.V),tt.\u0275\u0275inject(He.a),tt.\u0275\u0275inject(Le.lH),tt.\u0275\u0275inject(te.y0),tt.\u0275\u0275inject(Z.H7),tt.\u0275\u0275inject(Ee.yh),tt.\u0275\u0275inject(e.y),tt.\u0275\u0275inject(b.t))},W.\u0275prov=tt.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac,providedIn:"root"}),W}()},45690:function(pt){pt.exports={ApplyAllSlicersWeb_15x17:"ApplyAllSlicersWeb_15x17",ClearAllSlicersWeb_16:"ClearAllSlicersWeb_16",ArrowRightWeb_16:"ArrowRightWeb_16",LineWeb_16:"LineWeb_16",Oval_16:"Oval_16",Rectangle_16:"Rectangle_16",TriangleIsoc_16:"TriangleIsoc_16",ActualSizePBI_16:"ActualSizePBI_16",BookmarkPBI_16:"BookmarkPBI_16",BookmarkedPBI_16:"BookmarkedPBI_16",Color_16:"Color_16",Comment_16:"Comment_16",CheckmarkWithDynamicColor_16:"CheckmarkWithDynamicColor_16",DownloadPBI_16:"DownloadPBI_16",EditPBI_16:"EditPBI_16",EditPBI2_16:"EditPBI2_16",HtmlEmbed_16:"HtmlEmbed_16",ExcelPBI_16:"ExcelPBI_16",ExportPBI_16:"ExportPBI_16",file_16:"file_16",FitPage_16:"FitPage_16",FitWidth_16:"FitWidth_16",FullScreenSizeIcon_16:"FullScreenSizeIcon_16",Lightbulb_16:"Lightbulb_16",LineageView_16:"LineageView_16",MobilePhone_16:"MobilePhone_16",MorePBI_16:"MorePBI_16",MultipleUnreadMail_16:"MultipleUnreadMail_16",NoEditPBI_16x17:"NoEditPBI_16x17",PBIModelingView_16:"PBIModelingView_16",PdfPBI_16:"PdfPBI_16",PinToDashboard_16:"PinToDashboard_16",PowerAutomate_16:"PowerAutomate_16",PowerPointMonoline_16:"PowerPointMonoline_16",PrintPBI_16:"PrintPBI_16",QRCode_16:"QRCode_16",Save_16:"Save_16",SaveACopy_16:"SaveACopy_16",SeeRelatedContent_16:"SeeRelatedContent_16",SettingsPBI_16:"SettingsPBI_16",ShareasLink_16:"ShareasLink_16",SharePBI_16:"SharePBI_16",SharePointMonoline_16:"SharePointMonoline_16",ShareReport_16:"ShareReport_16",TeamsMonoline_16:"TeamsMonoline_16",UsageMetrics_16:"UsageMetrics_16",ViewPBI_16:"ViewPBI_16",WebPublish_16:"WebPublish_16",CodeEdit_16:"CodeEdit_16",AddAPlace_16:"AddAPlace_16",AccessNewTable_16:"AccessNewTable_16",BarChart4_16:"BarChart4_16",PBIReportTemplate_16:"PBIReportTemplate_16",RefreshNow_16:"RefreshNow_16",RefreshCancel_16:"RefreshCancel_16",DateTime_16:"DateTime_16",PeopleSettings_16:"PeopleSettings_16",Database_16:"Database_16",ImpactAnalysis_16:"ImpactAnalysis_16",AutoCreateReport_16:"AutoCreateReport_16",PaginatedReport_16:"PaginatedReport_16",CloudImportExport_16:"CloudImportExport_16",GenericScan_16:"GenericScan_16",Key_16:"Key_16",Repair_16:"Repair_16",Unknown_16:"Unknown_16",RefreshHistory_16:"RefreshHistory_16",BackChevron_16:"BackChevron_16",Medical_16:"Medical_16",QueryList_16:"QueryList_16",PermissionsKey_16:"PermissionsKey_16"}},5209:function(){window.appBarSprite={icons:[{type:"svg",id:"ApplyAllSlicersWeb_15x17",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.001 7V4H1.00098V11C1.00098 12.1046 1.89641 13 3.00098 13H11.001V14H3.00098C1.34412 14 0.000976562 12.6569 0.000976562 11V3C0.000976562 1.34315 1.34412 0 3.00098 0H11.001C12.6578 0 14.001 1.34315 14.001 3V7H13.001Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M2.50102 6.49993C2.4998 6.36593 2.52636 6.23314 2.57902 6.10993C2.62949 5.99438 2.70104 5.88926 2.79002 5.79993C2.88313 5.70886 2.99142 5.63475 3.11002 5.58093C3.23214 5.52348 3.36612 5.49573 3.50102 5.49993C3.6327 5.49921 3.7631 5.52577 3.88402 5.57793C4.00189 5.62958 4.11011 5.70093 4.20402 5.78893C4.2989 5.87923 4.37354 5.98864 4.42302 6.10993C4.47471 6.23344 4.50123 6.36603 4.50102 6.49993C4.50231 6.63425 4.47576 6.76738 4.42302 6.89093C4.37308 7.00735 4.30148 7.11323 4.21202 7.20293C4.11942 7.29462 4.01101 7.36881 3.89202 7.42193C3.76994 7.47927 3.63575 7.50604 3.50102 7.49993C3.36669 7.50122 3.23356 7.47466 3.11002 7.42193C2.99187 7.37077 2.88358 7.29937 2.79002 7.21093C2.69715 7.12448 2.62502 7.01817 2.57902 6.89993C2.5304 6.77202 2.50402 6.63673 2.50102 6.49993Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M2.50102 10.4999C2.4998 10.3659 2.52636 10.2331 2.57902 10.1099C2.62916 9.99332 2.70073 9.88715 2.79002 9.79693C2.88295 9.70591 2.9913 9.6321 3.11002 9.57893C3.23217 9.52173 3.36624 9.49464 3.50102 9.49993C3.63282 9.49906 3.76332 9.52598 3.88402 9.57893C4.00205 9.62985 4.11033 9.70091 4.20402 9.78893C4.2989 9.87923 4.37354 9.98864 4.42302 10.1099C4.47471 10.2334 4.50123 10.366 4.50102 10.4999C4.50231 10.6342 4.47576 10.7674 4.42302 10.8909C4.37287 11.0075 4.3013 11.1137 4.21202 11.2039C4.11908 11.2949 4.01073 11.3688 3.89202 11.4219C3.76994 11.4793 3.63575 11.506 3.50102 11.4999C3.36669 11.5012 3.23356 11.4747 3.11002 11.4219C2.99187 11.3708 2.88358 11.2994 2.79002 11.2109C2.69703 11.1242 2.62489 11.0175 2.57902 10.8989C2.53051 10.7713 2.50413 10.6364 2.50102 10.4999Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M6.55036 7.00008C6.40711 7.00245 6.26847 6.94943 6.16336 6.85208V6.84808C6.11302 6.8047 6.07263 6.75099 6.04495 6.69058C6.01726 6.63018 6.00293 6.56452 6.00293 6.49808C6.00293 6.43163 6.01726 6.36597 6.04495 6.30557C6.07263 6.24517 6.11302 6.19145 6.16336 6.14808C6.26847 6.05072 6.40711 5.99771 6.55036 6.00008H10.9504C11.0942 5.99879 11.2329 6.05327 11.3374 6.15208C11.3877 6.19545 11.4281 6.24917 11.4558 6.30957C11.4835 6.36997 11.4978 6.43563 11.4978 6.50208C11.4978 6.56852 11.4835 6.63418 11.4558 6.69458C11.4281 6.75499 11.3877 6.80871 11.3374 6.85208C11.2377 6.94438 11.1079 6.99683 10.9726 7H9.74193L9.72696 7.00008H6.55036Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M9.56658 11L8.54198 10H6.55036C6.4072 9.99819 6.26875 10.0511 6.16336 10.148C6.11302 10.1914 6.07263 10.2451 6.04495 10.3055C6.01726 10.3659 6.00293 10.4316 6.00293 10.498C6.00293 10.5645 6.01726 10.6302 6.04495 10.6906C6.07263 10.751 6.11302 10.8047 6.16336 10.848V10.852C6.26875 10.949 6.4072 11.0019 6.55036 11H9.56658Z"},{type:"path",className:"OfficeIconColors_HighContrast",d:"M9.28074 9.28033L10.1949 10.1945L10.207 10.2069L12 11.9999V13.9999C12 14.0462 12.0129 14.0916 12.0373 14.131C12.0616 14.1704 12.0965 14.2022 12.138 14.2229L13.638 14.9729C13.6726 14.9907 13.711 15 13.75 14.9999C13.8163 14.9999 13.8799 14.9735 13.9268 14.9267C13.9737 14.8798 14 14.8162 14 14.7499V12.0004L16.7201 9.28033C17.1926 8.80786 16.8579 8 16.1898 8H9.81107C9.14289 8 8.80827 8.80786 9.28074 9.28033Z"}],viewBox:"0 0 17 15"},{type:"svg",id:"ClearAllSlicersWeb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M734 2048q-38 0-73-14t-62-42L56 1449q-26-26-41-62t-15-74q0-38 15-74t41-62L1177 56q27-27 62-41t74-15q80 0 136 56l543 543q56 56 56 136 0 38-14 73t-42 63L943 1920h657q26 0 45 19t19 45q0 26-19 45t-45 19H734zM1920 735q0-26-19-45l-543-543q-19-19-45-19t-45 19L453 962l633 633 815-815q19-19 19-45zM735 1921q26 0 45-19l216-216-634-634-216 216q-18 18-18 45 0 12 4 24t14 21l544 544q19 19 45 19z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"ArrowRightWeb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16 7L9 14V11H0V3H9V0L16 7ZM1 10H10V11.5859L14.5859 7L10 2.41406V4H1V10Z"}],viewBox:"0 0 15 14"},{type:"svg",id:"LineWeb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M1.52606 0.89759L0.897522 1.52612L14.4738 15.1024L15.1024 14.4739L1.52606 0.89759Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Oval_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8 0C3.6 0 0 2.7 0 6C0 9.3 3.6 12 8 12C12.4 12 16 9.3 16 6C16 2.7 12.4 0 8 0ZM8 11C4.1 11 1 8.8 1 6C1 3.2 4.1 1 8 1C11.9 1 15 3.2 15 6C15 8.8 11.9 11 8 11Z"}],viewBox:"0 0 16 12"},{type:"svg",id:"Rectangle_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0 0V12H16V0H0ZM15 11H1V1H15V11Z"}],viewBox:"0 0 16 12"},{type:"svg",id:"TriangleIsoc_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8 0L0 16H16L8 0ZM8 2.2L14.4 15H1.6L8 2.2Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ActualSizePBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,2v12h16V2H0z M15,13H1V3h14V13z M9.516,6.93C9.349,6.977,9.177,7,9,7V6c0.141,0,0.271-0.026,0.391-0.078\r\n\ts0.224-0.122,0.312-0.211C9.797,5.617,9.87,5.51,9.922,5.391S10,5.141,10,5h1v5h-1V6.719C9.849,6.807,9.688,6.878,9.516,6.93z\r\n\t M7.148,6.852C7.049,6.753,7,6.635,7,6.5s0.049-0.253,0.148-0.352S7.365,6,7.5,6s0.253,0.049,0.352,0.148S8,6.365,8,6.5\r\n\tS7.951,6.753,7.852,6.852S7.635,7,7.5,7S7.247,6.951,7.148,6.852z M7.148,8.852C7.049,8.753,7,8.635,7,8.5s0.049-0.253,0.148-0.352\r\n\tS7.365,8,7.5,8s0.253,0.049,0.352,0.148S8,8.365,8,8.5S7.951,8.753,7.852,8.852S7.635,9,7.5,9S7.247,8.951,7.148,8.852z M4.516,6.93\r\n\tC4.349,6.977,4.177,7,4,7V6c0.141,0,0.271-0.026,0.391-0.078s0.224-0.122,0.312-0.211C4.797,5.617,4.87,5.51,4.922,5.391\r\n\tS5,5.141,5,5h1v5H5V6.719C4.849,6.807,4.688,6.878,4.516,6.93z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,3h14v10H1V3z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,2h16v12H0V2z M15,13V3H1v10H15z"},{type:"path",className:"OfficeIconColors_m23",d:"M5,10V6.719C4.849,6.807,4.688,6.878,4.516,6.93C4.349,6.977,4.177,7,4,7V6c0.141,0,0.271-0.026,0.391-0.078\r\n\tC4.51,5.87,4.615,5.799,4.703,5.711C4.797,5.617,4.87,5.51,4.922,5.391C4.974,5.271,5,5.141,5,5h1v5H5z M10,10V6.719\r\n\tC9.849,6.807,9.688,6.878,9.516,6.93C9.349,6.977,9.177,7,9,7V6c0.141,0,0.271-0.026,0.391-0.078C9.51,5.87,9.615,5.799,9.703,5.711\r\n\tC9.797,5.617,9.87,5.51,9.922,5.391C9.974,5.271,10,5.141,10,5h1v5H10z M7.5,7C7.365,7,7.247,6.951,7.148,6.852S7,6.635,7,6.5\r\n\ts0.049-0.253,0.148-0.352S7.365,6,7.5,6s0.253,0.049,0.352,0.148S8,6.365,8,6.5S7.951,6.753,7.852,6.852S7.635,7,7.5,7z M7.5,9\r\n\tC7.365,9,7.247,8.951,7.148,8.852S7,8.635,7,8.5s0.049-0.253,0.148-0.352S7.365,8,7.5,8s0.253,0.049,0.352,0.148S8,8.365,8,8.5\r\n\tS7.951,8.753,7.852,8.852S7.635,9,7.5,9z"}],viewBox:"0 0 16 16"},{type:"svg",id:"BookmarkPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13,0v16l-5-2.523L3,16V0H13z M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023\r\n\tc0.672,0.333,3.328,1.685,4,2.023V1z"},{type:"path",className:"OfficeIconColors_m20",d:"M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023c0.672,0.333,3.328,1.685,4,2.023V1z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,0v16l-5-2.523L3,16V0H13z M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023\r\n\tc0.672,0.333,3.328,1.685,4,2.023V1z"}],viewBox:"0 0 16 16"},{type:"svg",id:"BookmarkedPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13,0v16l-5-2.523L3,16V0H13z"},{type:"path",className:"OfficeIconColors_m218",d:"M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023c0.672,0.333,3.328,1.685,4,2.023V1z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,0v16l-5-2.523L3,16V0H13z M12,1H4v13.375c0.672-0.339,3.328-1.69,4-2.023\r\n\tc0.672,0.333,3.328,1.685,4,2.023V1z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Color_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1536 640 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -384 -128 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -384 128 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m 896 384 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -128 384 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 m -538 -1408 q 139 0 272 36 q 132 37 249 103 q 116 67 214 160 q 97 94 167 208 q 70 114 109 245 q 39 131 39 272 q 0 120 -38 242 q -39 122 -106 236 q -68 114 -161 213 q -93 100 -201 174 q -109 74 -229 116 q -120 43 -242 43 q -72 0 -128 -37 q -56 -37 -95 -94 q -39 -56 -59 -124 q -21 -67 -21 -129 q 0 -49 15 -92 q 14 -43 36 -82 q 22 -39 47 -75 q 25 -36 47 -70 q 22 -33 37 -65 q 14 -32 14 -64 q 0 -25 -21 -59 q -22 -33 -52 -63 q -31 -29 -65 -50 q -34 -20 -58 -20 q -38 0 -72 19 q -35 19 -71 47 q -36 29 -74 62 q -39 33 -83 61 q -45 29 -97 48 q -52 19 -115 19 q -50 0 -96 -21 q -47 -21 -82 -57 q -36 -35 -57 -82 q -21 -46 -21 -96 q 0 -133 37 -261 q 36 -127 102 -241 q 66 -113 158 -209 q 92 -96 203 -166 q 111 -69 238 -108 q 126 -39 260 -39 m 922 1024 q 0 -124 -34 -239 q -35 -114 -96 -214 q -62 -99 -148 -181 q -86 -81 -188 -140 q -103 -58 -218 -90 q -116 -32 -238 -32 q -116 0 -226 34 q -110 35 -206 96 q -97 61 -177 145 q -81 85 -139 184 q -58 100 -90 211 q -32 111 -32 226 q 0 24 11 47 q 11 23 29 41 q 18 18 41 29 q 23 11 47 11 q 50 0 93 -19 q 43 -19 82 -48 q 39 -28 77 -61 q 37 -33 77 -62 q 40 -28 85 -47 q 45 -19 98 -19 q 34 0 71 13 q 37 14 73 38 q 36 24 69 55 q 33 31 58 66 q 24 35 39 72 q 14 37 14 71 q 0 46 -14 86 q -15 41 -37 78 q -22 37 -47 72 q -25 35 -47 70 q -22 36 -36 72 q -15 36 -15 75 q 0 33 12 77 q 11 44 33 84 q 22 40 55 67 q 32 28 74 28 q 106 0 210 -37 q 104 -37 199 -101 q 94 -64 175 -151 q 81 -86 140 -186 q 59 -99 93 -207 q 33 -108 33 -214 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1070 1984 q -11 0 -16 -1 q -6 -1 -8 -2 q -57 -24 -97 -54 q -41 -29 -67 -68 q -26 -38 -38 -86 q -12 -48 -12 -109 q 0 -34 9 -66 q 9 -32 24 -62 q 15 -30 34 -58 q 18 -28 38 -56 q 15 -22 32 -47 q 16 -24 29 -51 q 13 -26 22 -54 q 9 -27 9 -56 q 0 -27 -7 -51 q -7 -24 -23 -48 q -17 -23 -43 -48 q -27 -24 -67 -53 q -12 -9 -25 -19 q -13 -9 -27 -17 q -14 -8 -31 -13 q -17 -5 -38 -5 q -41 0 -77 15 q -37 15 -71 39 q -34 24 -66 52 q -33 29 -66 56 q -33 27 -68 49 q -36 23 -75 33 q -24 7 -46 9 q -23 3 -43 3 q -37 0 -71 -16 q -35 -16 -62 -43 q -27 -27 -43 -62 q -16 -34 -16 -71 q 0 -113 31 -229 q 31 -115 89 -222 q 58 -106 141 -199 q 83 -93 187 -162 q 103 -69 226 -109 q 122 -39 260 -39 q 134 0 259 35 q 125 35 235 98 q 109 64 200 152 q 90 88 155 195 q 65 107 101 228 q 36 122 36 252 q 0 114 -38 229 q -39 115 -103 221 q -65 106 -150 198 q -86 92 -180 160 q -94 69 -190 108 q -97 40 -184 41 q -17 0 -35 1 q -18 2 -34 2 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 998 0 q 139 0 272 36 q 132 37 249 103 q 116 67 214 160 q 97 94 167 208 q 70 114 109 245 q 39 131 39 272 q 0 120 -38 242 q -39 122 -106 236 q -68 114 -161 213 q -93 100 -201 174 q -109 74 -229 116 q -120 43 -242 43 q -72 0 -128 -37 q -56 -37 -95 -94 q -39 -56 -59 -124 q -21 -67 -21 -129 q 0 -49 15 -92 q 14 -43 36 -82 q 22 -39 47 -75 q 25 -36 47 -70 q 22 -33 37 -65 q 14 -32 14 -64 q 0 -25 -21 -59 q -22 -33 -52 -63 q -31 -29 -65 -50 q -34 -20 -58 -20 q -38 0 -72 19 q -35 19 -71 47 q -36 29 -74 62 q -39 33 -83 61 q -45 29 -97 48 q -52 19 -115 19 q -50 0 -96 -21 q -47 -21 -82 -57 q -36 -35 -57 -82 q -21 -46 -21 -96 q 0 -133 37 -261 q 36 -127 102 -241 q 66 -113 158 -209 q 92 -96 203 -166 q 111 -69 238 -108 q 126 -39 260 -39 m 922 1024 q 0 -124 -34 -239 q -35 -114 -96 -214 q -62 -99 -148 -181 q -86 -81 -188 -140 q -103 -58 -218 -90 q -116 -32 -238 -32 q -116 0 -226 34 q -110 35 -206 96 q -97 61 -177 145 q -81 85 -139 184 q -58 100 -90 211 q -32 111 -32 226 q 0 24 11 47 q 11 23 29 41 q 18 18 41 29 q 23 11 47 11 q 50 0 93 -19 q 43 -19 82 -48 q 39 -28 77 -61 q 37 -33 77 -62 q 40 -28 85 -47 q 45 -19 98 -19 q 34 0 71 13 q 37 14 73 38 q 36 24 69 55 q 33 31 58 66 q 24 35 39 72 q 14 37 14 71 q 0 46 -14 86 q -15 41 -37 78 q -22 37 -47 72 q -25 35 -47 70 q -22 36 -36 72 q -15 36 -15 75 q 0 33 12 77 q 11 44 33 84 q 22 40 55 67 q 32 28 74 28 q 106 0 210 -37 q 104 -37 199 -101 q 94 -64 175 -151 q 81 -86 140 -186 q 59 -99 93 -207 q 33 -108 33 -214 z"},{type:"path",className:"OfficeIconColors_m24",d:"M 768 640 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1152 512 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m210",d:"M 1536 640 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m213",d:"M 1664 1024 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"},{type:"path",className:"OfficeIconColors_m219",d:"M 1536 1408 q 0 27 -10 50 q -10 23 -27 40 q -18 18 -41 28 q -23 10 -50 10 q -27 0 -50 -10 q -23 -10 -40 -28 q -18 -17 -28 -40 q -10 -23 -10 -50 q 0 -27 10 -50 q 10 -23 28 -41 q 17 -17 40 -27 q 23 -10 50 -10 q 27 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 23 10 50 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Comment_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -1280 m 1664 128 h -1536 v 1024 h 256 v 331 l 331 -331 h 949 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 448 1344 h -256 v -1152 h 1664 v 1152 h -986 l -422 422 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -1280 m 1664 128 h -1536 v 1024 h 256 v 331 l 331 -331 h 949 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"CheckmarkWithDynamicColor_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 704 1562 l -474 -474 l 90 -90 l 384 384 l 896 -896 l 90 90 z"},{type:"path",className:"OfficeIconColors_m22 OfficeIconColors_DynamicColor",d:"M 704 1562 l -474 -474 l 90 -90 l 384 384 l 896 -896 l 90 90 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"DownloadPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M3,15h9v1H3V15z M12.352,8.352l-0.703-0.703L8,11.32V0H7v11.32L3.352,7.648L2.648,8.352L7.5,13.242\r\n\tL12.352,8.352z"},{type:"path",className:"OfficeIconColors_m22",d:"M3,16v-1h9v1H3z"},{type:"path",className:"OfficeIconColors_m24",d:"M12.352,8.352L7.5,13.242L2.648,8.352l0.703-0.703L7,11.32V0h1v11.32l3.648-3.672L12.352,8.352z"}],viewBox:"0 0 16 16"},{type:"svg",id:"EditPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,2.617c0,0.344-0.065,0.677-0.195,1s-0.32,0.609-0.57,0.859l-10.29,10.29L0,16l1.234-4.945L11.523,0.766\r\n\tc0.25-0.25,0.536-0.44,0.859-0.57s0.656-0.195,1-0.195c0.359,0,0.698,0.07,1.016,0.211c0.318,0.135,0.594,0.323,0.828,0.562\r\n\tc0.24,0.234,0.427,0.51,0.562,0.828C15.93,1.919,16,2.258,16,2.617z M2.547,11.156c0.552,0.182,1.026,0.474,1.422,0.875\r\n\tc0.401,0.396,0.693,0.87,0.875,1.422L13.289,5L11,2.711L2.547,11.156z M1.375,14.625l2.57-0.641c-0.052-0.24-0.138-0.466-0.258-0.68\r\n\tc-0.115-0.214-0.255-0.404-0.422-0.57c-0.167-0.167-0.357-0.307-0.57-0.422c-0.214-0.12-0.44-0.206-0.68-0.258L1.375,14.625z\r\n\t M14,4.289c0.13-0.13,0.255-0.253,0.375-0.367c0.12-0.115,0.227-0.234,0.32-0.359c0.094-0.13,0.167-0.268,0.219-0.414\r\n\tC14.971,2.997,15,2.823,15,2.625C15,2.401,14.956,2.193,14.867,2c-0.083-0.198-0.2-0.37-0.352-0.516\r\n\tC14.37,1.333,14.198,1.216,14,1.133C13.807,1.044,13.599,1,13.375,1c-0.198,0-0.372,0.029-0.523,0.086\r\n\tc-0.146,0.052-0.284,0.125-0.414,0.219c-0.125,0.094-0.245,0.201-0.359,0.32S11.841,1.87,11.711,2L14,4.289z"},{type:"path",className:"OfficeIconColors_m20",d:"M1.375,14.625l2.57-0.641c-0.052-0.24-0.138-0.466-0.258-0.68c-0.115-0.214-0.255-0.404-0.422-0.57\r\n\tc-0.167-0.167-0.357-0.307-0.57-0.422c-0.214-0.12-0.44-0.206-0.68-0.258L1.375,14.625z"},{type:"path",className:"OfficeIconColors_m212",d:"M2.547,11.156c0.552,0.182,1.026,0.474,1.422,0.875c0.401,0.396,0.693,0.87,0.875,1.422L13.289,5L11,2.711\r\n\tL2.547,11.156z"},{type:"path",className:"OfficeIconColors_m221",d:"M14,4.289c0.13-0.13,0.255-0.253,0.375-0.367c0.12-0.115,0.227-0.234,0.32-0.359\r\n\tc0.094-0.13,0.167-0.268,0.219-0.414C14.971,2.997,15,2.823,15,2.625C15,2.401,14.956,2.193,14.867,2\r\n\tc-0.083-0.198-0.2-0.37-0.352-0.516C14.37,1.333,14.198,1.216,14,1.133C13.807,1.044,13.599,1,13.375,1\r\n\tc-0.198,0-0.372,0.029-0.523,0.086c-0.146,0.052-0.284,0.125-0.414,0.219c-0.125,0.094-0.245,0.201-0.359,0.32S11.841,1.87,11.711,2\r\n\tL14,4.289z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,2.617c0,0.344-0.065,0.677-0.195,1s-0.32,0.609-0.57,0.859l-10.29,10.29L0,16l1.234-4.945L11.523,0.766\r\n\tc0.25-0.25,0.536-0.44,0.859-0.57s0.656-0.195,1-0.195c0.359,0,0.698,0.07,1.016,0.211c0.318,0.135,0.594,0.323,0.828,0.562\r\n\tc0.24,0.234,0.427,0.51,0.562,0.828C15.93,1.919,16,2.258,16,2.617z M2.547,11.156c0.552,0.182,1.026,0.474,1.422,0.875\r\n\tc0.401,0.396,0.693,0.87,0.875,1.422L13.289,5L11,2.711L2.547,11.156z M1.375,14.625l2.57-0.641c-0.052-0.24-0.138-0.466-0.258-0.68\r\n\tc-0.115-0.214-0.255-0.404-0.422-0.57c-0.167-0.167-0.357-0.307-0.57-0.422c-0.214-0.12-0.44-0.206-0.68-0.258L1.375,14.625z\r\n\t M14,4.289c0.13-0.13,0.255-0.253,0.375-0.367c0.12-0.115,0.227-0.234,0.32-0.359c0.094-0.13,0.167-0.268,0.219-0.414\r\n\tC14.971,2.997,15,2.823,15,2.625C15,2.401,14.956,2.193,14.867,2c-0.083-0.198-0.2-0.37-0.352-0.516\r\n\tC14.37,1.333,14.198,1.216,14,1.133C13.807,1.044,13.599,1,13.375,1c-0.198,0-0.372,0.029-0.523,0.086\r\n\tc-0.146,0.052-0.284,0.125-0.414,0.219c-0.125,0.094-0.245,0.201-0.359,0.32S11.841,1.87,11.711,2L14,4.289z"}],viewBox:"0 0 16 16"},{type:"svg",id:"EditPBI2_16",children:[{type:"path",d:"M15.1813 0.926893C14.0291 -0.284951 12.1047 -0.309226 10.9222 0.873168L1.54741 10.2475C1.21958 10.5754 0.992038 10.9899 \r\n0.891482 11.4424L0.0138652 15.3923C-0.0232157 15.5592 0.0275431 15.7335 0.148442 15.8544C0.26934 15.9753 0.443618 16.026 0.610502 \r\n15.9889L4.53689 15.1157C5.00432 15.0118 5.43243 14.7767 5.77103 14.4381L15.129 5.08003C16.27 3.939 16.2933 2.09631 15.1813 \r\n0.926893ZM11.6293 1.58029C12.4143 0.795384 13.6917 0.811498 14.4566 1.61596C15.1948 2.39225 15.1793 3.61548 14.4219 4.37293L13.7507 \r\n5.04418L10.958 2.25155L11.6293 1.58029ZM10.2509 2.95864L13.0436 5.7513L5.06391 13.731C4.85976 13.9352 4.60164 14.0769 4.31982 \r\n14.1396L1.1605 14.8421L1.86768 11.6593C1.92698 11.3924 2.06117 11.148 2.2545 10.9547L10.2509 2.95864Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"HtmlEmbed_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 530 1403 l -530 -379 l 530 -379 l 62 87 l -408 292 l 412 292 m 922 -671 l 530 379 l -530 379 l -62 -87 l 408 -292 l -412 -292 m -731 845 l 510 -1149 l 96 43 l -510 1149 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 530 1403 l -530 -379 l 530 -379 l 62 87 l -408 292 l 412 292 m 922 -671 l 530 379 l -530 379 l -62 -87 l 408 -292 l -412 -292 m -731 845 l 510 -1149 l 96 43 l -510 1149 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ExcelPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15,0c0.135,0,0.264,0.026,0.387,0.078c0.122,0.052,0.229,0.124,0.32,0.215\r\n\tc0.091,0.091,0.162,0.198,0.215,0.32C15.974,0.736,16,0.865,16,1v14c0,0.136-0.026,0.265-0.078,0.387\r\n\tc-0.053,0.122-0.124,0.229-0.215,0.32c-0.092,0.091-0.198,0.163-0.32,0.215C15.264,15.974,15.135,16,15,16H4\r\n\tc-0.136,0-0.265-0.026-0.387-0.078c-0.123-0.052-0.229-0.124-0.32-0.215c-0.092-0.091-0.163-0.198-0.215-0.32\r\n\tC3.025,15.265,3,15.136,3,15v-2H1c-0.136,0-0.265-0.025-0.387-0.078c-0.123-0.052-0.229-0.123-0.32-0.215\r\n\tc-0.092-0.091-0.163-0.197-0.215-0.32C0.025,12.265,0,12.136,0,12V4c0-0.135,0.025-0.264,0.078-0.387\r\n\tc0.052-0.122,0.123-0.229,0.215-0.32C0.384,3.202,0.49,3.13,0.613,3.078C0.735,3.026,0.864,3,1,3h2V1\r\n\tc0-0.135,0.025-0.264,0.078-0.387c0.052-0.122,0.123-0.229,0.215-0.32C3.384,0.202,3.49,0.13,3.613,0.078C3.735,0.026,3.864,0,4,0\r\n\tH15z M3.875,11.25l1.141-2.086l1.117,2.086h1.992L6.102,7.977L8.078,4.75H6.172L5.078,6.742L4.07,4.75H2.047l1.922,3.234\r\n\tL1.859,11.25H3.875z M9,3V1H4v2H9z M9,15v-2H4v2H9z M15,3V1h-5v2H15z M15,7V4h-5v3H15z M15,11V8h-5v3H15z M15,15v-3h-5v3H15z"},{type:"path",className:"OfficeIconColors_m20",d:"M3.875,11.25l1.141-2.086l1.117,2.086h1.992L6.102,7.977L8.078,4.75H6.172L5.078,6.742L4.07,4.75H2.047\r\n\tl1.922,3.234L1.859,11.25H3.875z M9,3V1H4v2H9z M9,15v-2H4v2H9z M15,3V1h-5v2H15z M15,7V4h-5v3H15z M15,11V8h-5v3H15z M15,15v-3h-5\r\n\tv3H15z"},{type:"path",className:"OfficeIconColors_m2194",d:"M15,0c0.135,0,0.264,0.026,0.387,0.078c0.122,0.052,0.229,0.124,0.32,0.215\r\n\tc0.091,0.091,0.162,0.198,0.215,0.32C15.974,0.736,16,0.865,16,1v14c0,0.136-0.026,0.265-0.078,0.387\r\n\tc-0.053,0.122-0.124,0.229-0.215,0.32c-0.092,0.091-0.198,0.163-0.32,0.215C15.264,15.974,15.135,16,15,16H4\r\n\tc-0.136,0-0.265-0.026-0.387-0.078c-0.123-0.052-0.229-0.124-0.32-0.215c-0.092-0.091-0.163-0.198-0.215-0.32\r\n\tC3.025,15.265,3,15.136,3,15v-2H1c-0.136,0-0.265-0.025-0.387-0.078c-0.123-0.052-0.229-0.123-0.32-0.215\r\n\tc-0.092-0.091-0.163-0.197-0.215-0.32C0.025,12.265,0,12.136,0,12V4c0-0.135,0.025-0.264,0.078-0.387\r\n\tc0.052-0.122,0.123-0.229,0.215-0.32C0.384,3.202,0.49,3.13,0.613,3.078C0.735,3.026,0.864,3,1,3h2V1\r\n\tc0-0.135,0.025-0.264,0.078-0.387c0.052-0.122,0.123-0.229,0.215-0.32C3.384,0.202,3.49,0.13,3.613,0.078C3.735,0.026,3.864,0,4,0\r\n\tH15z M3.875,11.25l1.141-2.086l1.117,2.086h1.992L6.102,7.977L8.078,4.75H6.172L5.078,6.742L4.07,4.75H2.047l1.922,3.234\r\n\tL1.859,11.25H3.875z M9,3V1H4v2H9z M9,15v-2H4v2H9z M15,3V1h-5v2H15z M15,7V4h-5v3H15z M15,11V8h-5v3H15z M15,15v-3h-5v3H15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ExportPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.953,8.5l-3.602,3.602l-0.703-0.703l2.406-2.414H2v-1h12.031l-2.383-2.383l0.703-0.703L15.953,8.5z M0,12\r\n\th1V5H0V12z"},{type:"path",className:"OfficeIconColors_m24",d:"M11.648,11.398l2.406-2.414L2,8.984v-1l12.031,0l-2.383-2.383l0.703-0.703L15.953,8.5l-3.602,3.602\r\n\tL11.648,11.398z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,12h1V5H0V12z"}],viewBox:"0 0 16 16"},{type:"svg",id:"file_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 0 l 640 640 v 1408 h -1536 v -2048 m 1344 640 l -448 -448 v 448 m 512 1280 v -1152 h -640 v -640 h -640 v 1792 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1088 64 l 640 640 v 1280 h -1408 v -1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 0 l 640 640 v 1408 h -1536 v -2048 m 1344 640 l -448 -448 v 448 m 512 1280 v -1152 h -640 v -640 h -640 v 1792 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"FitPage_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,2v12h16V2H0z M15,13H1V3h14V13z M14,12h-3v-1h2V9h1V12z M13,5h-2V4h3v3h-1V5z M3,7H2V4h3v1H3V7z M5,12H2\r\n\tV9h1v2h2V12z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,3h14v10H1V3z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,2h16v12H0V2z M15,13V3H1v10H15z"},{type:"path",className:"OfficeIconColors_m24",d:"M13,7V5h-2V4h3v3H13z M3,5v2H2V4h3v1H3z M14,9v3h-3v-1h2V9H14z M5,11v1H2V9h1v2H5z"}],viewBox:"0 0 16 16"},{type:"svg",id:"FitWidth_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,2v12h16V2H0z M15,13H1V3h14V13z M12.328,8H9V7h3.328l-0.664-0.664l0.672-0.672L14.18,7.5l-1.844,1.836\r\n\tl-0.672-0.672L12.328,8z M3.664,9.336L1.82,7.5l1.844-1.836l0.672,0.672L3.672,7H7v1H3.672l0.664,0.664L3.664,9.336z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,3h14v10H1V3z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,2h16v12H0V2z M15,13V3H1v10H15z"},{type:"path",className:"OfficeIconColors_m24",d:"M4.336,8.664L3.664,9.336L1.82,7.5l1.844-1.836l0.672,0.672L3.672,7H7v1H3.672L4.336,8.664z M11.664,8.664\r\n\tL12.328,8H9V7h3.328l-0.664-0.664l0.672-0.672L14.18,7.5l-1.844,1.836L11.664,8.664z"}],viewBox:"0 0 16 16"},{type:"svg",id:"FullScreenSizeIcon_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15,1v5h-1V2.711L2.711,14H6v1H1v-5h1v3.289L13.289,2H10V1H15z"},{type:"path",className:"OfficeIconColors_m22",d:"M15,1v5h-1V2.711L2.711,14H6v1H1v-5h1v3.289L13.289,2H10V1H15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Lightbulb_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 2048 h -384 v -128 h 384 m -128 -1918 q 88 6 170 33 q 81 28 152 73 q 71 46 130 106 q 59 61 101 134 q 41 73 64 156 q 23 83 23 172 q 0 70 -10 131 q -11 61 -34 115 q -23 55 -58 105 q -36 50 -86 98 q -39 38 -74 84 q -36 47 -63 100 q -27 53 -43 110 q -16 58 -16 117 v 256 h -640 v -256 q 0 -59 -16 -117 q -16 -57 -43 -110 q -27 -53 -62 -100 q -36 -46 -75 -84 q -50 -48 -85 -98 q -36 -50 -59 -105 q -23 -54 -33 -115 q -11 -61 -11 -131 q 0 -90 25 -176 q 24 -85 68 -160 q 44 -75 106 -138 q 62 -62 137 -107 q 75 -45 161 -70 q 85 -25 177 -25 h 37 q 14 0 29 0 q 14 0 28 2 m 128 1534 h -384 v 128 h 384 m 235 -631 q 40 -38 68 -77 q 28 -39 46 -83 q 18 -43 27 -92 q 8 -48 8 -105 q 0 -112 -45 -212 q -45 -100 -122 -175 q -77 -74 -179 -118 q -103 -43 -217 -43 h -26 q -114 0 -216 43 q -103 44 -180 118 q -77 75 -122 175 q -45 100 -45 212 q 0 57 9 105 q 8 49 26 92 q 18 44 46 83 q 28 39 68 77 q 85 81 141 178 q 55 97 78 197 h 416 q 23 -100 79 -197 q 55 -97 140 -178 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 971 65 q 86 0 167 22 q 80 23 150 63 q 69 41 127 97 q 57 56 99 124 q 41 68 64 145 q 22 78 22 160 q 0 63 -9 118 q -10 55 -30 104 q -21 50 -53 94 q -32 45 -76 88 q -78 75 -127 162 q -49 88 -75 181 l -14 49 v 256 h -514 v -256 l -12 -49 q -23 -94 -74 -181 q -51 -87 -128 -162 q -44 -43 -76 -88 q -32 -44 -52 -94 q -21 -49 -30 -104 q -10 -55 -10 -118 q 0 -120 47 -231 q 47 -110 128 -195 q 80 -85 188 -136 q 107 -50 229 -50 q 8 0 11 1 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 2048 h -384 v -128 h 384 m -128 -1918 q 88 6 170 33 q 81 28 152 73 q 71 46 130 106 q 59 61 101 134 q 41 73 64 156 q 23 83 23 172 q 0 70 -10 131 q -11 61 -34 115 q -23 55 -58 105 q -36 50 -86 98 q -39 38 -74 84 q -36 47 -63 100 q -27 53 -43 110 q -16 58 -16 117 v 256 h -640 v -256 q 0 -59 -16 -117 q -16 -57 -43 -110 q -27 -53 -62 -100 q -36 -46 -75 -84 q -50 -48 -85 -98 q -36 -50 -59 -105 q -23 -54 -33 -115 q -11 -61 -11 -131 q 0 -90 25 -176 q 24 -85 68 -160 q 44 -75 106 -138 q 62 -62 137 -107 q 75 -45 161 -70 q 85 -25 177 -25 h 37 q 14 0 29 0 q 14 0 28 2 m 128 1534 h -384 v 128 h 384 m 235 -631 q 40 -38 68 -77 q 28 -39 46 -83 q 18 -43 27 -92 q 8 -48 8 -105 q 0 -112 -45 -212 q -45 -100 -122 -175 q -77 -74 -179 -118 q -103 -43 -217 -43 h -26 q -114 0 -216 43 q -103 44 -180 118 q -77 75 -122 175 q -45 100 -45 212 q 0 57 9 105 q 8 49 26 92 q 18 44 46 83 q 28 39 68 77 q 85 81 141 178 q 55 97 78 197 h 416 q 23 -100 79 -197 q 55 -97 140 -178 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"LineageView_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13,10V7H8V5h2V0H5v5h2v2H2v3H0v5h5v-5H3V8h9v2h-2v5h5v-5H13z M6,4V1h3v3H6z M4,11v3H1v-3H4z M14,14h-3v-3h3\r\n\tV14z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,11h3v3H1V11z M11,11v3h3v-3H11z"},{type:"path",className:"OfficeIconColors_m26",d:"M9,4H6V1h3V4z"},{type:"path",className:"OfficeIconColors_m25",d:"M9,1v3H6V1H9 M10,0H5v5h5V0L10,0z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,10V7H8V5H7v2H2v3H0v5h5v-5H3V8h9v2h-2v5h5v-5H13z M4,11v3H1v-3H4z M14,14h-3v-3h3V14z"}],viewBox:"0 0 16 16"},{type:"svg",id:"MobilePhone_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 1792 h -256 v -128 h 256 m 384 -1664 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 1792 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -1024 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1792 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 m 1024 1920 v -1792 h -1024 v 1792 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 516 1988 q -26 0 -45 -19 q -19 -19 -19 -45 v -1792 q 0 -26 19 -45 q 19 -19 45 -19 h 1024 q 26 0 45 19 q 19 19 19 45 v 1792 q 0 26 -19 45 q -19 19 -45 19 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 1792 h -256 v -128 h 256 m 384 -1664 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 1792 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -1024 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1792 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 m 1024 1920 v -1792 h -1024 v 1792 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"MorePBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M2,7c0.141,0,0.271,0.026,0.391,0.078C2.51,7.13,2.615,7.203,2.703,7.297C2.797,7.385,2.87,7.49,2.922,7.609\r\n\tC2.974,7.729,3,7.859,3,8S2.974,8.271,2.922,8.391C2.87,8.51,2.797,8.617,2.703,8.711C2.615,8.799,2.51,8.87,2.391,8.922\r\n\tC2.271,8.974,2.141,9,2,9S1.729,8.974,1.609,8.922C1.49,8.87,1.383,8.799,1.289,8.711C1.201,8.617,1.13,8.51,1.078,8.391\r\n\tC1.026,8.271,1,8.141,1,8s0.026-0.271,0.078-0.391C1.13,7.49,1.201,7.385,1.289,7.297C1.383,7.203,1.49,7.13,1.609,7.078\r\n\tC1.729,7.026,1.859,7,2,7z M8,7c0.141,0,0.271,0.026,0.391,0.078C8.51,7.13,8.615,7.203,8.703,7.297\r\n\tC8.797,7.385,8.87,7.49,8.922,7.609C8.974,7.729,9,7.859,9,8S8.974,8.271,8.922,8.391C8.87,8.51,8.797,8.617,8.703,8.711\r\n\tC8.615,8.799,8.51,8.87,8.391,8.922C8.271,8.974,8.141,9,8,9S7.729,8.974,7.609,8.922C7.49,8.87,7.383,8.799,7.289,8.711\r\n\tC7.201,8.617,7.13,8.51,7.078,8.391C7.026,8.271,7,8.141,7,8s0.026-0.271,0.078-0.391C7.13,7.49,7.201,7.385,7.289,7.297\r\n\tC7.383,7.203,7.49,7.13,7.609,7.078C7.729,7.026,7.859,7,8,7z M14,7c0.141,0,0.271,0.026,0.391,0.078\r\n\tc0.12,0.052,0.224,0.125,0.312,0.219c0.094,0.089,0.167,0.193,0.219,0.312C14.974,7.729,15,7.859,15,8s-0.026,0.271-0.078,0.391\r\n\tc-0.052,0.12-0.125,0.227-0.219,0.32c-0.089,0.089-0.193,0.159-0.312,0.211C14.271,8.974,14.141,9,14,9s-0.271-0.026-0.391-0.078\r\n\tc-0.12-0.052-0.227-0.122-0.32-0.211C13.2,8.617,13.13,8.51,13.078,8.391C13.026,8.271,13,8.141,13,8s0.026-0.271,0.078-0.391\r\n\tc0.052-0.12,0.122-0.224,0.211-0.312c0.094-0.094,0.201-0.167,0.32-0.219C13.729,7.026,13.859,7,14,7z"},{type:"path",className:"OfficeIconColors_m22",d:"M2,7c0.141,0,0.271,0.026,0.391,0.078C2.51,7.13,2.615,7.203,2.703,7.297C2.797,7.385,2.87,7.49,2.922,7.609\r\n\tC2.974,7.729,3,7.859,3,8S2.974,8.271,2.922,8.391C2.87,8.51,2.797,8.617,2.703,8.711C2.615,8.799,2.51,8.87,2.391,8.922\r\n\tC2.271,8.974,2.141,9,2,9S1.729,8.974,1.609,8.922C1.49,8.87,1.383,8.799,1.289,8.711C1.201,8.617,1.13,8.51,1.078,8.391\r\n\tC1.026,8.271,1,8.141,1,8s0.026-0.271,0.078-0.391C1.13,7.49,1.201,7.385,1.289,7.297C1.383,7.203,1.49,7.13,1.609,7.078\r\n\tC1.729,7.026,1.859,7,2,7z M8,7c0.141,0,0.271,0.026,0.391,0.078C8.51,7.13,8.615,7.203,8.703,7.297\r\n\tC8.797,7.385,8.87,7.49,8.922,7.609C8.974,7.729,9,7.859,9,8S8.974,8.271,8.922,8.391C8.87,8.51,8.797,8.617,8.703,8.711\r\n\tC8.615,8.799,8.51,8.87,8.391,8.922C8.271,8.974,8.141,9,8,9S7.729,8.974,7.609,8.922C7.49,8.87,7.383,8.799,7.289,8.711\r\n\tC7.201,8.617,7.13,8.51,7.078,8.391C7.026,8.271,7,8.141,7,8s0.026-0.271,0.078-0.391C7.13,7.49,7.201,7.385,7.289,7.297\r\n\tC7.383,7.203,7.49,7.13,7.609,7.078C7.729,7.026,7.859,7,8,7z M14,7c0.141,0,0.271,0.026,0.391,0.078\r\n\tc0.12,0.052,0.224,0.125,0.312,0.219c0.094,0.089,0.167,0.193,0.219,0.312C14.974,7.729,15,7.859,15,8s-0.026,0.271-0.078,0.391\r\n\tc-0.052,0.12-0.125,0.227-0.219,0.32c-0.089,0.089-0.193,0.159-0.312,0.211C14.271,8.974,14.141,9,14,9s-0.271-0.026-0.391-0.078\r\n\tc-0.12-0.052-0.227-0.122-0.32-0.211C13.2,8.617,13.13,8.51,13.078,8.391C13.026,8.271,13,8.141,13,8s0.026-0.271,0.078-0.391\r\n\tc0.052-0.12,0.122-0.224,0.211-0.312c0.094-0.094,0.201-0.167,0.32-0.219C13.729,7.026,13.859,7,14,7z"}],viewBox:"0 0 16 16"},{type:"svg",id:"MultipleUnreadMail_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 256 h 2048 v 1408 h -2048 m 1819 -1280 h -1590 l 795 562 m 896 590 v -1067 l -896 633 l -896 -633 v 1067 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1984 1600 h -1920 v -1280 h 1920 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 0 256 h 2048 v 1408 h -2048 m 1819 -1280 h -1590 l 795 562 m 896 590 v -1067 l -896 633 l -896 -633 v 1067 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"NoEditPBI_16x17",children:[{type:"path",d:"M15.1794 0.926893C14.0271 -0.284951 12.1027 -0.309226 10.9203 0.873168L1.54545 \r\n10.2475C1.21763 10.5754 0.990085 10.9899 0.889529 11.4424L0.0119121 15.3923C-0.0251689 \r\n15.5592 0.02559 15.7335 0.146489 15.8544C0.267387 15.9753 0.441665 16.026 0.608549 \r\n15.9889L4.53494 15.1157C5.00237 15.0118 5.43048 14.7767 5.76907 14.4381L6.20707 14.0001C6.09703 \r\n13.6111 6.02873 13.2046 6.00729 12.7857L5.06196 13.731C4.85781 13.9352 4.59969 14.0769 \r\n4.31786 14.1396L1.15855 14.8421L1.86572 11.6593C1.92502 11.3924 2.05921 11.148 2.25254 \r\n10.9547L10.2489 2.95864L13.0416 5.7513L11.7856 7.00729C12.2045 7.02872 12.6111 7.09702 \r\n13.0001 7.20705L15.1271 5.08003C16.2681 3.939 16.2913 2.09631 15.1794 0.926893ZM11.6274 \r\n1.58029C12.4123 0.795384 13.6898 0.811498 14.4547 1.61596C15.1928 2.39225 15.1774 3.61548 \r\n14.42 4.37293L13.7487 5.04418L10.9561 2.25155L11.6274 1.58029ZM7 12.5C7 14.9853 9.01472 \r\n17 11.5 17C13.9853 17 16 14.9853 16 12.5C16 10.0147 13.9853 8 11.5 8C9.01472 8 7 10.0147 \r\n7 12.5ZM8 12.5C8 10.567 9.567 9 11.5 9C12.2862 9 13.0118 9.2592 13.5961 9.69681L8.69681 \r\n14.5961C8.2592 14.0118 8 13.2862 8 12.5ZM11.5 16C10.7138 16 9.9882 15.7408 9.40391 \r\n15.3032L14.3032 10.4039C14.7408 10.9882 15 11.7138 15 12.5C15 14.433 13.433 16 11.5 16Z"},{type:"path",className:"PowerBIIconColors11",d:"M7 12.5C7 14.9853 9.01472 17 11.5 17C13.9853 17 16 14.9853 16 12.5C16 10.0147 \r\n13.9853 8 11.5 8C9.01472 8 7 10.0147 7 12.5ZM8 12.5C8 10.567 9.567 9 11.5 9C12.2862 9 \r\n13.0118 9.2592 13.5961 9.69681L8.69681 14.5961C8.2592 14.0118 8 13.2862 8 12.5ZM11.5 \r\n16C10.7138 16 9.9882 15.7408 9.40391 15.3032L14.3032 10.4039C14.7408 10.9882 15 11.7138 \r\n15 12.5C15 14.433 13.433 16 11.5 16Z"}],viewBox:"0 0 16 17"},{type:"svg",id:"PBIModelingView_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1152 896 v -512 h -640 v 128 h 384 v 896 h -384 v 128 h 640 v -512 h 896 v 896 h -896 v -256 h -768 v -256 h -384 v -896 h 384 v -256 h 768 v -256 h 896 v 896 m -768 896 h 640 v -384 h -640 m -512 -512 h -640 v 384 h 640 m 512 -512 h 640 v -384 h -640 m 0 896 h 640 v -128 h -640 m 0 -896 h 640 v -128 h -640 m -1152 512 v 128 h 640 v -128 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 64 1344 v -768 h 768 v 768 m 384 512 v -768 h 768 v 768 m -768 -1024 v -768 h 768 v 768 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1152 896 v -512 h -640 v 128 h 384 v 896 h -384 v 128 h 640 v -512 h 896 v 896 h -896 v -256 h -768 v -256 h -384 v -896 h 384 v -256 h 768 v -256 h 896 v 896 m -768 896 h 640 v -384 h -640 m -512 -512 h -640 v 384 h 640 m 512 -512 h 640 v -384 h -640 m 0 896 h 640 v -128 h -640 m 0 -896 h 640 v -128 h -640 m -1152 512 v 128 h 640 v -128 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PdfPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14,5V3.289L10.711,0H1v5H0v8h1v3h13v-3h1V5H14z M11,1.711L12.289,3H11V1.711z M2,1h8v3h3v1H2V1z M13,15H2\r\n\tv-2h11V15z M14,12H1V6h13V12z M11,11h-1V7h2.5v1H11v1h1.5v1H11V11z M3,10h0.5c0.208,0,0.404-0.039,0.586-0.117\r\n\ts0.341-0.185,0.477-0.32s0.242-0.294,0.32-0.477S5,8.708,5,8.5S4.961,8.096,4.883,7.914s-0.185-0.341-0.32-0.477\r\n\ts-0.294-0.242-0.477-0.32S3.708,7,3.5,7H2v4h1V10z M3,8h0.5c0.135,0,0.253,0.049,0.352,0.148S4,8.365,4,8.5S3.951,8.753,3.852,8.852\r\n\tS3.635,9,3.5,9H3V8z M7.773,10.844c0.245-0.104,0.458-0.247,0.641-0.43c0.182-0.182,0.326-0.393,0.43-0.633C8.948,9.536,9,9.276,9,9\r\n\tS8.948,8.466,8.844,8.227C8.74,7.982,8.596,7.768,8.414,7.586S8.018,7.26,7.773,7.156C7.534,7.052,7.276,7,7,7H6v4h1\r\n\tC7.276,11,7.534,10.948,7.773,10.844z M7,8c0.141,0,0.271,0.026,0.391,0.078s0.224,0.125,0.312,0.219\r\n\tC7.797,8.385,7.87,8.49,7.922,8.609S8,8.859,8,9S7.974,9.271,7.922,9.391s-0.125,0.227-0.219,0.32\r\n\tC7.615,9.799,7.51,9.87,7.391,9.922S7.141,10,7,10V8z"},{type:"path",className:"OfficeIconColors_m20",d:"M13,5H2V1h9l2,2V5z M1,6v6h13V6H1z M2,15h11v-2H2V15z"},{type:"path",className:"OfficeIconColors_m22",d:"M13,5V4h-3V1H2v4H1V0h9.711L14,3.289V5H13z M13,13v2H2v-2H1v3h13v-3H13z M11,3h1.289L11,1.711V3z"},{type:"path",className:"OfficeIconColors_m213",d:"M14,6v6H1V6H14 M15,5H0v8h15V5L15,5z"},{type:"path",className:"OfficeIconColors_m23",d:"M4.562,7.438c-0.135-0.135-0.294-0.242-0.477-0.32S3.708,7,3.5,7H2v4h1v-1h0.5\r\n\tc0.208,0,0.404-0.039,0.586-0.117s0.341-0.185,0.477-0.32s0.242-0.294,0.32-0.477S5,8.708,5,8.5S4.961,8.096,4.883,7.914\r\n\tS4.698,7.573,4.562,7.438z M3.852,8.852C3.753,8.951,3.635,9,3.5,9H3V8h0.5c0.135,0,0.253,0.049,0.352,0.148S4,8.365,4,8.5\r\n\tS3.951,8.753,3.852,8.852z M8.414,7.586C8.232,7.404,8.018,7.26,7.773,7.156C7.534,7.052,7.276,7,7,7H6v4h1\r\n\tc0.276,0,0.534-0.052,0.773-0.156c0.245-0.104,0.458-0.247,0.641-0.43c0.182-0.182,0.326-0.393,0.43-0.633C8.948,9.536,9,9.276,9,9\r\n\tS8.948,8.466,8.844,8.227C8.74,7.982,8.596,7.768,8.414,7.586z M7.922,9.391C7.87,9.51,7.797,9.617,7.703,9.711\r\n\tC7.615,9.799,7.51,9.87,7.391,9.922S7.141,10,7,10V8c0.141,0,0.271,0.026,0.391,0.078s0.224,0.125,0.312,0.219\r\n\tC7.797,8.385,7.87,8.49,7.922,8.609S8,8.859,8,9S7.974,9.271,7.922,9.391z M11,8v1h1.5v1H11v1h-1V7h2.5v1H11z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PinToDashboard_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M10.156,0.453C9.984,0.625,9.826,0.794,9.68,0.961C9.539,1.122,9.419,1.292,9.32,1.469\r\n\ts-0.177,0.37-0.234,0.578C9.034,2.25,9.008,2.479,9.008,2.734c0,0.177,0.016,0.346,0.047,0.508L6.094,6.203\r\n\tc-0.391-0.13-0.799-0.195-1.227-0.195c-0.516,0-1.01,0.096-1.484,0.289C2.914,6.49,2.497,6.768,2.133,7.133L1.781,7.484L4.797,10.5\r\n\tl-4.445,4.438L0,16l1.062-0.352L5.5,11.203l3.016,3.016c0.229-0.229,0.435-0.453,0.617-0.672c0.182-0.224,0.336-0.458,0.461-0.703\r\n\tc0.13-0.245,0.229-0.505,0.297-0.781s0.102-0.583,0.102-0.922c0-0.208-0.016-0.417-0.047-0.625\r\n\tc-0.031-0.208-0.081-0.411-0.148-0.609l2.961-2.961c0.161,0.031,0.331,0.047,0.508,0.047c0.26,0,0.492-0.026,0.695-0.078\r\n\tc0.208-0.057,0.398-0.135,0.57-0.234c0.177-0.099,0.346-0.219,0.508-0.359c0.167-0.146,0.336-0.305,0.508-0.477L10.156,0.453z\r\n\t M13.266,5.992c-0.146,0-0.284-0.016-0.414-0.047c-0.125-0.036-0.255-0.076-0.391-0.117L8.625,9.672\r\n\tc0.052,0.13,0.102,0.253,0.148,0.367c0.047,0.115,0.086,0.232,0.117,0.352c0.036,0.115,0.062,0.234,0.078,0.359\r\n\tC8.99,10.87,9,11,9,11.141C9,11.432,8.956,11.719,8.867,12c-0.089,0.276-0.216,0.534-0.383,0.773L3.227,7.516\r\n\tC3.466,7.349,3.724,7.224,4,7.141c0.281-0.089,0.57-0.133,0.867-0.133c0.141,0,0.271,0.01,0.391,0.031\r\n\tc0.125,0.016,0.245,0.039,0.359,0.07s0.229,0.07,0.344,0.117s0.237,0.096,0.367,0.148l3.844-3.836\r\n\tc-0.042-0.135-0.081-0.266-0.117-0.391c-0.031-0.13-0.047-0.268-0.047-0.414c0-0.286,0.068-0.557,0.203-0.812l3.867,3.867\r\n\tC13.823,5.924,13.552,5.992,13.266,5.992z"},{type:"path",className:"OfficeIconColors_m212",d:"M13.266,5.992c0.286,0,0.557-0.068,0.812-0.203l-3.867-3.867c-0.135,0.255-0.203,0.526-0.203,0.812\r\n\tc0,0.146,0.016,0.284,0.047,0.414c0.036,0.125,0.076,0.255,0.117,0.391L6.328,7.375c-0.13-0.052-0.253-0.102-0.367-0.148\r\n\tC5.846,7.18,5.732,7.141,5.617,7.109c-0.115-0.031-0.234-0.055-0.359-0.07c-0.12-0.021-0.25-0.031-0.391-0.031\r\n\tC4.57,7.008,4.281,7.052,4,7.141C3.724,7.224,3.466,7.349,3.227,7.516l5.258,5.258c0.167-0.24,0.294-0.497,0.383-0.773\r\n\tC8.956,11.719,9,11.432,9,11.141C9,11,8.99,10.87,8.969,10.75c-0.016-0.125-0.042-0.245-0.078-0.359\r\n\tc-0.031-0.12-0.07-0.237-0.117-0.352C8.727,9.924,8.677,9.802,8.625,9.672l3.836-3.844c0.135,0.042,0.266,0.081,0.391,0.117\r\n\tC12.982,5.977,13.12,5.992,13.266,5.992z"},{type:"path",className:"OfficeIconColors_m210",d:"M1.781,7.484l0.352-0.352C2.497,6.769,2.915,6.49,3.387,6.297c0.472-0.192,0.965-0.289,1.48-0.289\r\n\tc0.427,0,0.836,0.065,1.227,0.195l2.961-2.961C9.023,3.081,9.008,2.912,9.008,2.734c0-0.255,0.027-0.485,0.082-0.691\r\n\tc0.055-0.206,0.132-0.397,0.23-0.574c0.099-0.177,0.22-0.348,0.363-0.512s0.301-0.332,0.473-0.504l5.391,5.391\r\n\tc-0.172,0.172-0.34,0.33-0.504,0.473C14.879,6.46,14.71,6.581,14.535,6.68c-0.175,0.099-0.364,0.176-0.57,0.23\r\n\ts-0.438,0.082-0.699,0.082c-0.177,0-0.347-0.016-0.508-0.047L9.797,9.906c0.067,0.198,0.117,0.401,0.148,0.609\r\n\tc0.031,0.209,0.047,0.417,0.047,0.625c0,0.339-0.034,0.646-0.102,0.922c-0.067,0.276-0.165,0.536-0.293,0.781\r\n\ts-0.282,0.478-0.465,0.699s-0.388,0.446-0.617,0.676L1.781,7.484z M13.266,5.992c0.286,0,0.558-0.067,0.812-0.203l-3.867-3.867\r\n\tc-0.136,0.255-0.203,0.526-0.203,0.812c0,0.146,0.017,0.283,0.051,0.41c0.034,0.128,0.071,0.259,0.113,0.395L6.328,7.375\r\n\tc-0.13-0.052-0.253-0.102-0.367-0.148S5.731,7.141,5.617,7.109S5.384,7.054,5.262,7.035C5.14,7.017,5.008,7.008,4.867,7.008\r\n\tc-0.297,0-0.585,0.043-0.863,0.129S3.466,7.349,3.227,7.516l5.258,5.258c0.167-0.239,0.294-0.499,0.383-0.777S9,11.433,9,11.141\r\n\tC9,11,8.991,10.869,8.973,10.746c-0.019-0.122-0.044-0.242-0.078-0.359s-0.074-0.232-0.121-0.348\r\n\tC8.727,9.925,8.677,9.803,8.625,9.672l3.836-3.844c0.136,0.042,0.267,0.08,0.395,0.113C12.983,5.976,13.12,5.992,13.266,5.992z"},{type:"path",className:"OfficeIconColors_m22",d:"M1.062,15.648L5.5,11.203L4.797,10.5l-4.445,4.438L0,16L1.062,15.648z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PowerAutomate_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.576,6.732l-4.667-5.334C10.687,1.145,10.367,1,10.031,1H1.303C0.839,1,0.432,1.262,0.241,1.685\r\n\tS0.12,2.586,0.425,2.935L4.419,7.5l-3.995,4.565c-0.305,0.349-0.375,0.827-0.184,1.25C0.432,13.737,0.839,14,1.303,14h8.728\r\n\tc0.336,0,0.655-0.145,0.878-0.398l4.668-5.333C15.959,7.83,15.959,7.17,15.576,6.732z M1.178,2.276\r\n\tc-0.062-0.07-0.043-0.142-0.026-0.178C1.168,2.062,1.21,2,1.303,2h7.901L5.083,6.739L1.178,2.276z M1.151,12.902\r\n\tc-0.017-0.037-0.035-0.108,0.026-0.179L5.749,7.5L5.748,7.499l4.572-5.257l2.118,2.421L5.026,13H1.303\r\n\tC1.21,13,1.168,12.938,1.151,12.902z M14.824,7.61l-4.667,5.333C10.125,12.979,10.079,13,10.031,13H6.364l6.737-7.579l1.722,1.969\r\n\tC14.879,7.453,14.879,7.547,14.824,7.61z"},{type:"path",className:"OfficeIconColors_m20",d:"M1.303,1.5c-0.27,0-0.496,0.146-0.607,0.391c-0.11,0.245-0.071,0.512,0.105,0.714L5.084,7.5l-4.283,4.895\r\n\tc-0.177,0.202-0.216,0.47-0.105,0.715C0.805,13.351,1.038,13.5,1.303,13.5h8.729c0.192,0,0.375-0.083,0.502-0.229l4.668-5.333\r\n\tc0.218-0.25,0.217-0.627-0.001-0.878l-4.667-5.334C10.406,1.583,10.223,1.5,10.031,1.5H1.303z"},{type:"path",className:"OfficeIconColors_m228",d:"M15.576,6.732l-4.667-5.334C10.687,1.145,10.367,1,10.031,1H1.303C0.839,1,0.432,1.262,0.241,1.685\r\n\tS0.12,2.586,0.425,2.935L4.419,7.5l-3.995,4.565c-0.305,0.349-0.375,0.827-0.184,1.25C0.432,13.737,0.839,14,1.303,14h8.728\r\n\tc0.336,0,0.655-0.145,0.878-0.398l4.668-5.333C15.959,7.83,15.959,7.17,15.576,6.732z M1.178,2.276\r\n\tc-0.062-0.07-0.043-0.142-0.026-0.178C1.168,2.062,1.21,2,1.303,2h7.901L5.083,6.739L1.178,2.276z M1.151,12.902\r\n\tc-0.017-0.037-0.035-0.108,0.026-0.179L5.749,7.5L5.748,7.499l4.572-5.257l2.118,2.421L5.026,13H1.303\r\n\tC1.21,13,1.168,12.938,1.151,12.902z M14.824,7.61l-4.667,5.333C10.125,12.979,10.079,13,10.031,13H6.364l6.737-7.579l1.722,1.969\r\n\tC14.879,7.453,14.879,7.547,14.824,7.61z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PowerPointMonoline_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -121 0 -234 -27 q -114 -27 -216 -77 q -102 -50 -190 -121 q -89 -71 -159 -159 h -97 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 97 q 70 -88 159 -159 q 88 -71 190 -121 q 102 -50 216 -77 q 113 -27 234 -27 m 128 384 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 512 h 640 q 0 -113 -26 -218 q -27 -105 -76 -198 q -50 -93 -119 -173 q -70 -79 -155 -140 q -85 -60 -184 -101 q -100 -40 -208 -56 m -128 -11 q -92 0 -178 18 q -87 18 -166 51 q -80 33 -151 80 q -72 48 -133 108 h 628 m -663 1056 h 206 v -271 h 107 q 72 0 130 -23 q 57 -22 97 -61 q 40 -39 62 -92 q 21 -52 21 -113 q 0 -131 -78 -202 q -79 -70 -223 -70 h -322 m 663 1311 q 113 0 218 -27 q 105 -27 198 -76 q 93 -49 173 -119 q 79 -69 140 -155 q 60 -85 101 -184 q 40 -99 56 -207 h -630 v 385 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -752 q 60 59 131 106 q 71 47 150 80 q 79 33 166 51 q 86 18 177 18 m -366 -932 h -91 v -196 h 95 q 36 0 58 8 q 21 8 32 21 q 11 14 15 31 q 3 17 3 35 q 0 52 -26 76 q -27 25 -86 25 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1984 q -109 0 -214 -24 q -105 -24 -201 -70 q -96 -46 -181 -113 q -85 -67 -153 -153 l -19 -24 h -128 q -26 0 -45 -19 q -19 -19 -19 -45 v -1024 q 0 -26 19 -45 q 19 -19 45 -19 h 128 l 19 -24 q 68 -86 153 -153 q 85 -67 181 -113 q 96 -46 201 -70 q 105 -24 214 -24 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"},{type:"path",className:"OfficeIconColors_m2264",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -121 0 -234 -27 q -114 -27 -216 -77 q -102 -50 -190 -121 q -89 -71 -159 -159 h -97 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 97 q 70 -88 159 -159 q 88 -71 190 -121 q 102 -50 216 -77 q 113 -27 234 -27 m 128 384 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 512 h 640 q 0 -113 -26 -218 q -27 -105 -76 -198 q -50 -93 -119 -173 q -70 -79 -155 -140 q -85 -60 -184 -101 q -100 -40 -208 -56 m -128 -11 q -92 0 -178 18 q -87 18 -166 51 q -80 33 -151 80 q -72 48 -133 108 h 628 m -663 1056 h 206 v -271 h 107 q 72 0 130 -23 q 57 -22 97 -61 q 40 -39 62 -92 q 21 -52 21 -113 q 0 -131 -78 -202 q -79 -70 -223 -70 h -322 m 663 1311 q 113 0 218 -27 q 105 -27 198 -76 q 93 -49 173 -119 q 79 -69 140 -155 q 60 -85 101 -184 q 40 -99 56 -207 h -630 v 385 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -752 q 60 59 131 106 q 71 47 150 80 q 79 33 166 51 q 86 18 177 18 m -366 -932 h -91 v -196 h 95 q 36 0 58 8 q 21 8 32 21 q 11 14 15 31 q 3 17 3 35 q 0 52 -26 76 q -27 25 -86 25 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"PrintPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15,6c0.135,0,0.263,0.026,0.383,0.078c0.125,0.052,0.232,0.125,0.32,0.219\r\n\tc0.094,0.089,0.167,0.195,0.219,0.32C15.974,6.737,16,6.865,16,7v7h-4v2H4v-2H0V7c0-0.135,0.026-0.263,0.078-0.383\r\n\tC0.13,6.492,0.2,6.385,0.289,6.297C0.383,6.203,0.49,6.13,0.609,6.078C0.734,6.026,0.865,6,1,6h3V0h8v6H15z M5,6h6V1H5V6z M11,11H5\r\n\tv4h6V11z M15,7H1v6h3v-3h8v3h3V7z M2.5,8c0.135,0,0.253,0.049,0.352,0.148S3,8.365,3,8.5S2.951,8.753,2.852,8.852S2.635,9,2.5,9\r\n\tS2.247,8.951,2.148,8.852S2,8.635,2,8.5s0.049-0.253,0.148-0.352S2.365,8,2.5,8z"},{type:"path",className:"OfficeIconColors_m21",d:"M15,7H1v6h3v-3h8v3h3V7z M2.5,8c0.135,0,0.253,0.049,0.352,0.148S3,8.365,3,8.5S2.951,8.753,2.852,8.852\r\n\tS2.635,9,2.5,9S2.247,8.951,2.148,8.852S2,8.635,2,8.5s0.049-0.253,0.148-0.352S2.365,8,2.5,8z"},{type:"path",className:"OfficeIconColors_m20",d:"M11,1v5H5V1H11z M5,15h6v-4H5V15z"},{type:"path",className:"OfficeIconColors_m22",d:"M15,6c0.135,0,0.263,0.026,0.383,0.078c0.125,0.052,0.232,0.125,0.32,0.219\r\n\tc0.094,0.089,0.167,0.195,0.219,0.32C15.974,6.737,16,6.865,16,7v7h-4v2H4v-2H0V7c0-0.135,0.026-0.263,0.078-0.383\r\n\tC0.13,6.492,0.2,6.385,0.289,6.297C0.383,6.203,0.49,6.13,0.609,6.078C0.734,6.026,0.865,6,1,6h3V0h8v6H15z M5,6h6V1H5V6z M11,11H5\r\n\tv4h6V11z M15,7H1v6h3v-3h8v3h3V7z M2.5,8c0.135,0,0.253,0.049,0.352,0.148S3,8.365,3,8.5S2.951,8.753,2.852,8.852S2.635,9,2.5,9\r\n\tS2.247,8.951,2.148,8.852S2,8.635,2,8.5s0.049-0.253,0.148-0.352S2.365,8,2.5,8z"}],viewBox:"0 0 16 16"},{type:"svg",id:"QRCode_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M3,5V3h2v2H3z M1,7V1h6v6H1z M2,2v4h4V2H2z M3,13v-2h2v2H3z M1,15V9h6v6H1z M2,10v4h4v-4H2z M13,3v2h-2V3H13\r\n\tz M9,1h6v6H9V1z M14,6V2h-4v4H14z M9,12h1v1H9V12z M11,10h-1v1H9V9h2V10z M13,9v1h-1V9H13z M12,10v2h-2v-1h1v-1H12z M10,13h2v1h-1v1\r\n\tH9v-1h1V13z M12,15v-1h2v1H12z M15,14h-1v-2h1V14z M14,10V9h1v2h-1v1h-1v-2H14z M12,13v-1h1v1H12z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,1h6v6H1V1z M1,15h6V9H1V15z M9,1v6h6V1H9z M9,15h6V9H9V15z"},{type:"path",className:"OfficeIconColors_m22",d:"M3,5V3h2v2H3z M1,7V1h6v6H1z M2,2v4h4V2H2z M3,13v-2h2v2H3z M1,15V9h6v6H1z M2,10v4h4v-4H2z M13,3v2h-2V3H13\r\n\tz M9,1h6v6H9V1z M14,6V2h-4v4H14z M9,12h1v1H9V12z M11,10h-1v1H9V9h2V10z M13,9v1h-1V9H13z M12,10v2h-2v-1h1v-1H12z M10,13h2v1h-1v1\r\n\tH9v-1h1V13z M12,15v-1h2v1H12z M15,14h-1v-2h1V14z M14,10V9h1v2h-1v1h-1v-2H14z M12,13v-1h1v1H12z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Save_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -1728 l -320 -320 v -1728 m 512 128 v 640 h 1024 v -640 m -128 1792 v -512 h -768 v 512 m 1280 -1792 h -256 v 768 h -1280 v -768 h -256 v 1547 l 245 245 h 139 v -640 h 1024 v 640 h 384 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1694 909 h -1329 v -850 h 1329 m -143 1917 h -1057 v -716 h 1057 z"},{type:"path",className:"OfficeIconColors_m221",d:"M 1984 64 v 1920 h -497 v -640 h -934 v 640 h -206 l -283 -283 v -1637 h 365 v 776 h 1176 v -776 z"},{type:"path",className:"OfficeIconColors_m220",d:"M 2048 0 v 2048 h -1728 l -320 -320 v -1728 m 512 128 v 640 h 1024 v -640 m -128 1792 v -512 h -768 v 512 m 1280 -1792 h -256 v 768 h -1280 v -768 h -256 v 1547 l 245 245 h 139 v -640 h 1024 v 640 h 384 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"SaveACopy_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M2,9H1.711L1,8.289V1h1v4h6V1h1v4h1V1c0-0.141-0.026-0.271-0.078-0.391C9.87,0.49,9.797,0.385,9.703,0.297\r\n\tC9.615,0.203,9.51,0.13,9.391,0.078C9.271,0.026,9.141,0,9,0H1C0.859,0,0.729,0.026,0.609,0.078C0.49,0.13,0.383,0.203,0.289,0.297\r\n\tC0.201,0.385,0.13,0.49,0.078,0.609C0.026,0.729,0,0.859,0,1v7.711L1.289,10H5V8H4v1H3V7h2V6H2V9z M3,1h4v3H3V1z M15.922,6.609\r\n\tc-0.052-0.119-0.125-0.223-0.219-0.312c-0.088-0.094-0.192-0.167-0.312-0.219S15.141,6,15,6H7C6.859,6,6.729,6.026,6.609,6.078\r\n\tC6.49,6.13,6.383,6.203,6.289,6.297C6.201,6.385,6.13,6.49,6.078,6.609C6.026,6.729,6,6.859,6,7v7.711L7.289,16H16V7\r\n\tC16,6.859,15.974,6.729,15.922,6.609z M9,7h4v3H9V7z M13,15h-2v-1h-1v1H9v-2h4V15z M15,15h-1v-3H8v3H7.711L7,14.289V7h1v4h6V7h1V15z\r\n\t"},{type:"path",className:"OfficeIconColors_m20",d:"M9,5H5v4H1V1h8V5z M14,7h-1H9H8H7v7.289V15h0.711H8h1h1h1h2h1h1V7H14z"},{type:"path",className:"OfficeIconColors_m22",d:"M2,5V1H1v7.289L1.711,9H2V6h3v1H3v2h1V8h1v2H1.289L0,8.711V1c0-0.141,0.026-0.271,0.078-0.391\r\n\tC0.13,0.49,0.201,0.385,0.289,0.297C0.383,0.203,0.49,0.13,0.609,0.078C0.729,0.026,0.859,0,1,0h8c0.141,0,0.271,0.026,0.391,0.078\r\n\tC9.51,0.13,9.615,0.203,9.703,0.297C9.797,0.385,9.87,0.49,9.922,0.609C9.974,0.729,10,0.859,10,1v4H9V1H8v4H2z M3,4h4V1H3V4z"},{type:"path",className:"OfficeIconColors_m219",d:"M15,6c0.141,0,0.271,0.026,0.391,0.078s0.224,0.125,0.312,0.219c0.094,0.089,0.167,0.193,0.219,0.312\r\n\tC15.974,6.729,16,6.859,16,7v9H7.289L6,14.711V7c0-0.141,0.026-0.271,0.078-0.391C6.13,6.49,6.201,6.385,6.289,6.297\r\n\tC6.383,6.203,6.49,6.13,6.609,6.078C6.729,6.026,6.859,6,7,6H15z M9,7v3h4V7H9z M13,15v-2H9v2h1v-1h1v1H13z M15,7h-1v4H8V7H7v7.289\r\n\tL7.711,15H8v-3h6v3h1V7z"}],viewBox:"0 0 16 16"},{type:"svg",id:"SeeRelatedContent_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,5V0h-5v2.562l-6,4V5H0v5h5V8.438l6,4V15h5v-5h-5v1.234L5.398,7.5L11,3.766V5H16z M12,1h3v3h-3V1z M4,9H1\r\n\tV6h3V9z M12,11h3v3h-3V11z"},{type:"path",className:"OfficeIconColors_m26",d:"M1,6h3v3H1V6z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,1v3h-3V1H15z M12,14h3v-3h-3V14z"},{type:"path",className:"OfficeIconColors_m22",d:"M5,6.562l6-4V0h5v5h-5V3.766L5.398,7.5L11,11.234V10h5v5h-5v-2.562l-6-4V6.562z M12,1v3h3V1H12z M12,11v3h3\r\n\tv-3H12z"},{type:"path",className:"OfficeIconColors_m25",d:"M4,6v3H1V6H4 M5,5H0v5h5V5L5,5z"}],viewBox:"0 0 16 16"},{type:"svg",id:"SettingsPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.93,7.719c0,0.047,0,0.094,0,0.141c0.005,0.046,0.008,0.093,0.008,0.14s-0.003,0.094-0.008,0.141\r\n\tc0,0.047,0,0.094,0,0.141l2.023,1.258l-1.242,2.992L12.391,12c-0.125,0.135-0.255,0.266-0.391,0.391l0.531,2.32l-2.992,1.242\r\n\tL8.281,13.93c-0.047,0-0.094,0.003-0.141,0.008c-0.047,0-0.094,0-0.141,0s-0.094,0-0.141,0c-0.047-0.005-0.094-0.008-0.141-0.008\r\n\tl-1.258,2.023l-2.992-1.242L4,12.391C3.865,12.266,3.734,12.135,3.609,12l-2.32,0.531L0.047,9.539L2.07,8.281\r\n\tc0-0.047-0.003-0.094-0.008-0.141c0-0.047,0-0.094,0-0.141s0-0.094,0-0.141C2.068,7.812,2.07,7.766,2.07,7.719L0.047,6.461\r\n\tl1.242-2.992L3.609,4C3.734,3.865,3.865,3.734,4,3.609l-0.531-2.32l2.992-1.242L7.719,2.07c0.047,0,0.094,0,0.141,0\r\n\tC7.906,2.065,7.953,2.062,8,2.062S8.094,2.065,8.141,2.07c0.047,0,0.094,0,0.141,0L9.54,0.047l2.992,1.242L12,3.609\r\n\tC12.135,3.734,12.266,3.865,12.391,4l2.32-0.531l1.242,2.992L13.93,7.719z M13.016,8.734c0.01-0.125,0.021-0.247,0.031-0.367\r\n\tc0.01-0.125,0.016-0.25,0.016-0.375c0-0.12-0.005-0.242-0.016-0.367s-0.021-0.247-0.031-0.367L14.86,6.11l-0.672-1.625L12.07,4.977\r\n\tc-0.161-0.198-0.328-0.38-0.5-0.547c-0.167-0.167-0.349-0.333-0.547-0.5l0.492-2.117L9.891,1.141L8.734,2.984\r\n\tc-0.12-0.01-0.242-0.021-0.367-0.031C8.242,2.943,8.12,2.938,8,2.938c-0.125,0-0.25,0.005-0.375,0.016\r\n\tc-0.12,0.01-0.242,0.021-0.367,0.031L6.109,1.141L4.484,1.812L4.977,3.93c-0.198,0.161-0.38,0.328-0.547,0.5\r\n\tc-0.167,0.167-0.333,0.349-0.5,0.547L1.812,4.484L1.141,6.109l1.844,1.156C2.975,7.39,2.964,7.515,2.954,7.64\r\n\tc-0.01,0.12-0.016,0.242-0.016,0.367c0,0.12,0.005,0.242,0.016,0.367c0.01,0.126,0.02,0.248,0.03,0.368L1.141,9.891l0.672,1.625\r\n\tl2.117-0.492c0.161,0.198,0.326,0.38,0.492,0.547c0.172,0.167,0.357,0.333,0.555,0.5l-0.492,2.117L6.11,14.86l1.156-1.844\r\n\tc0.12,0.01,0.242,0.021,0.367,0.031S7.88,13.062,8,13.062c0.125,0,0.247-0.005,0.367-0.016c0.125-0.01,0.25-0.021,0.375-0.031\r\n\tl1.148,1.844l1.625-0.672l-0.492-2.117c0.198-0.161,0.38-0.326,0.547-0.492c0.167-0.172,0.333-0.357,0.5-0.555l2.117,0.492\r\n\tl0.672-1.625L13.016,8.734z M8,5.062c0.406,0,0.786,0.078,1.141,0.234c0.359,0.152,0.671,0.36,0.937,0.626S10.552,6.5,10.703,6.86\r\n\tc0.156,0.354,0.235,0.734,0.235,1.14s-0.078,0.789-0.234,1.148c-0.151,0.354-0.359,0.664-0.625,0.93\r\n\tc-0.266,0.266-0.578,0.477-0.937,0.633C8.786,10.862,8.406,10.938,8,10.938s-0.789-0.075-1.148-0.227\r\n\tc-0.354-0.156-0.664-0.367-0.93-0.633c-0.266-0.266-0.477-0.576-0.633-0.93C5.138,8.789,5.062,8.406,5.062,8\r\n\ts0.076-0.786,0.227-1.141C5.445,6.5,5.656,6.188,5.922,5.922c0.266-0.266,0.576-0.474,0.93-0.625C7.211,5.141,7.594,5.062,8,5.062z\r\n\t M8,10.062c0.286,0,0.555-0.052,0.805-0.156c0.25-0.109,0.469-0.258,0.656-0.445s0.333-0.406,0.438-0.656\r\n\tc0.109-0.25,0.164-0.518,0.164-0.805s-0.055-0.555-0.164-0.805c-0.104-0.25-0.25-0.469-0.438-0.656S9.055,6.206,8.805,6.102\r\n\tC8.555,5.992,8.286,5.938,8,5.938S7.445,5.992,7.195,6.102c-0.25,0.104-0.469,0.25-0.656,0.438S6.203,6.945,6.094,7.195\r\n\tC5.99,7.445,5.938,7.714,5.938,8c0,0.286,0.052,0.555,0.156,0.805c0.109,0.25,0.258,0.469,0.445,0.656s0.406,0.336,0.656,0.445\r\n\tC7.445,10.01,7.714,10.062,8,10.062z"},{type:"path",className:"OfficeIconColors_m20",d:"M13.016,8.734c0.01-0.125,0.021-0.247,0.031-0.367c0.01-0.125,0.016-0.25,0.016-0.375\r\n\tc0-0.12-0.005-0.242-0.016-0.367s-0.021-0.247-0.031-0.367L14.86,6.11l-0.672-1.625L12.07,4.977c-0.161-0.198-0.328-0.38-0.5-0.547\r\n\tc-0.167-0.167-0.349-0.333-0.547-0.5l0.492-2.117L9.891,1.141L8.734,2.984c-0.12-0.01-0.242-0.021-0.367-0.031\r\n\tC8.242,2.943,8.12,2.938,8,2.938c-0.125,0-0.25,0.005-0.375,0.016c-0.12,0.01-0.242,0.021-0.367,0.031L6.109,1.141L4.484,1.812\r\n\tL4.977,3.93c-0.198,0.161-0.38,0.328-0.547,0.5c-0.167,0.167-0.333,0.349-0.5,0.547L1.812,4.484L1.141,6.109l1.844,1.156\r\n\tC2.975,7.39,2.964,7.515,2.954,7.64c-0.01,0.12-0.016,0.242-0.016,0.367c0,0.12,0.005,0.242,0.016,0.367\r\n\tc0.01,0.126,0.02,0.248,0.03,0.368L1.141,9.891l0.672,1.625l2.117-0.492c0.161,0.198,0.326,0.38,0.492,0.547\r\n\tc0.172,0.167,0.357,0.333,0.555,0.5l-0.492,2.117L6.11,14.86l1.156-1.844c0.12,0.01,0.242,0.021,0.367,0.031S7.88,13.062,8,13.062\r\n\tc0.125,0,0.247-0.005,0.367-0.016c0.125-0.01,0.25-0.021,0.375-0.031l1.148,1.844l1.625-0.672l-0.492-2.117\r\n\tc0.198-0.161,0.38-0.326,0.547-0.492c0.167-0.172,0.333-0.357,0.5-0.555l2.117,0.492l0.672-1.625L13.016,8.734z M8,5.062\r\n\tc0.406,0,0.786,0.078,1.141,0.234c0.359,0.152,0.671,0.36,0.937,0.626S10.552,6.5,10.703,6.86c0.156,0.354,0.235,0.734,0.235,1.14\r\n\ts-0.078,0.789-0.234,1.148c-0.151,0.354-0.359,0.664-0.625,0.93c-0.266,0.266-0.578,0.477-0.937,0.633\r\n\tC8.786,10.862,8.406,10.938,8,10.938s-0.789-0.075-1.148-0.227c-0.354-0.156-0.664-0.367-0.93-0.633\r\n\tc-0.266-0.266-0.477-0.576-0.633-0.93C5.138,8.789,5.062,8.406,5.062,8s0.076-0.786,0.227-1.141C5.445,6.5,5.656,6.188,5.922,5.922\r\n\tc0.266-0.266,0.576-0.474,0.93-0.625C7.211,5.141,7.594,5.062,8,5.062z"},{type:"path",className:"OfficeIconColors_m22",d:"M13.93,7.719c0,0.047,0,0.094,0,0.141c0.005,0.046,0.008,0.093,0.008,0.14s-0.003,0.094-0.008,0.141\r\n\tc0,0.047,0,0.094,0,0.141l2.023,1.258l-1.242,2.992L12.391,12c-0.125,0.135-0.255,0.266-0.391,0.391l0.531,2.32l-2.992,1.242\r\n\tL8.281,13.93c-0.047,0-0.094,0.003-0.141,0.008c-0.047,0-0.094,0-0.141,0s-0.094,0-0.141,0c-0.047-0.005-0.094-0.008-0.141-0.008\r\n\tl-1.258,2.023l-2.992-1.242L4,12.391C3.865,12.266,3.734,12.135,3.609,12l-2.32,0.531L0.047,9.539L2.07,8.281\r\n\tc0-0.047-0.003-0.094-0.008-0.141c0-0.047,0-0.094,0-0.141s0-0.094,0-0.141C2.068,7.812,2.07,7.766,2.07,7.719L0.047,6.461\r\n\tl1.242-2.992L3.609,4C3.734,3.865,3.865,3.734,4,3.609l-0.531-2.32l2.992-1.242L7.719,2.07c0.047,0,0.094,0,0.141,0\r\n\tC7.906,2.065,7.953,2.062,8,2.062S8.094,2.065,8.141,2.07c0.047,0,0.094,0,0.141,0L9.54,0.047l2.992,1.242L12,3.609\r\n\tC12.135,3.734,12.266,3.865,12.391,4l2.32-0.531l1.242,2.992L13.93,7.719z M13.016,8.734c0.01-0.125,0.021-0.247,0.031-0.367\r\n\tc0.01-0.125,0.016-0.25,0.016-0.375c0-0.12-0.005-0.242-0.016-0.367s-0.021-0.247-0.031-0.367L14.86,6.11l-0.672-1.625L12.07,4.977\r\n\tc-0.161-0.198-0.328-0.38-0.5-0.547c-0.167-0.167-0.349-0.333-0.547-0.5l0.492-2.117L9.891,1.141L8.734,2.984\r\n\tc-0.12-0.01-0.242-0.021-0.367-0.031C8.242,2.943,8.12,2.938,8,2.938c-0.125,0-0.25,0.005-0.375,0.016\r\n\tc-0.12,0.01-0.242,0.021-0.367,0.031L6.109,1.141L4.484,1.812L4.977,3.93c-0.198,0.161-0.38,0.328-0.547,0.5\r\n\tc-0.167,0.167-0.333,0.349-0.5,0.547L1.812,4.484L1.141,6.109l1.844,1.156C2.975,7.39,2.964,7.515,2.954,7.64\r\n\tc-0.01,0.12-0.016,0.242-0.016,0.367c0,0.12,0.005,0.242,0.016,0.367c0.01,0.126,0.02,0.248,0.03,0.368L1.141,9.891l0.672,1.625\r\n\tl2.117-0.492c0.161,0.198,0.326,0.38,0.492,0.547c0.172,0.167,0.357,0.333,0.555,0.5l-0.492,2.117L6.11,14.86l1.156-1.844\r\n\tc0.12,0.01,0.242,0.021,0.367,0.031S7.88,13.062,8,13.062c0.125,0,0.247-0.005,0.367-0.016c0.125-0.01,0.25-0.021,0.375-0.031\r\n\tl1.148,1.844l1.625-0.672l-0.492-2.117c0.198-0.161,0.38-0.326,0.547-0.492c0.167-0.172,0.333-0.357,0.5-0.555l2.117,0.492\r\n\tl0.672-1.625L13.016,8.734z M8,5.062c0.406,0,0.786,0.078,1.141,0.234c0.359,0.152,0.671,0.36,0.937,0.626S10.552,6.5,10.703,6.86\r\n\tc0.156,0.354,0.235,0.734,0.235,1.14s-0.078,0.789-0.234,1.148c-0.151,0.354-0.359,0.664-0.625,0.93\r\n\tc-0.266,0.266-0.578,0.477-0.937,0.633C8.786,10.862,8.406,10.938,8,10.938s-0.789-0.075-1.148-0.227\r\n\tc-0.354-0.156-0.664-0.367-0.93-0.633c-0.266-0.266-0.477-0.576-0.633-0.93C5.138,8.789,5.062,8.406,5.062,8\r\n\ts0.076-0.786,0.227-1.141C5.445,6.5,5.656,6.188,5.922,5.922c0.266-0.266,0.576-0.474,0.93-0.625C7.211,5.141,7.594,5.062,8,5.062z\r\n\t M8,10.062c0.286,0,0.555-0.052,0.805-0.156c0.25-0.109,0.469-0.258,0.656-0.445s0.333-0.406,0.438-0.656\r\n\tc0.109-0.25,0.164-0.518,0.164-0.805s-0.055-0.555-0.164-0.805c-0.104-0.25-0.25-0.469-0.438-0.656S9.055,6.206,8.805,6.102\r\n\tC8.555,5.992,8.286,5.938,8,5.938S7.445,5.992,7.195,6.102c-0.25,0.104-0.469,0.25-0.656,0.438S6.203,6.945,6.094,7.195\r\n\tC5.99,7.445,5.938,7.714,5.938,8c0,0.286,0.052,0.555,0.156,0.805c0.109,0.25,0.258,0.469,0.445,0.656s0.406,0.336,0.656,0.445\r\n\tC7.445,10.01,7.714,10.062,8,10.062z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ShareasLink_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 2048 1216 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -512 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 64 v 128 h -64 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -64 v -128 h 64 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 m -640 -384 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -69 q 43 -43 69 -102 q 25 -58 25 -124 q 0 -66 -25 -124 q -26 -58 -69 -102 q -44 -43 -102 -69 q -58 -25 -124 -25 h -512 q -66 0 -124 25 q -59 26 -102 69 q -44 44 -69 102 q -25 58 -25 124 q 0 66 25 124 q 25 59 69 102 q 43 44 102 69 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -36 q -82 -35 -142 -96 q -61 -60 -96 -142 q -36 -81 -36 -174 q 0 -93 36 -175 q 35 -81 96 -142 q 60 -60 142 -96 q 81 -35 174 -35 h 512 q 93 0 175 35 q 81 36 142 96 q 60 61 96 142 q 35 82 35 175 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"SharePBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M11,12l1-1v3H0V4h1v9h10V12z M4.492,9.734C3.956,10.104,3.458,10.526,3,11v-1\r\n\tc0-0.646,0.083-1.266,0.25-1.859c0.167-0.599,0.401-1.156,0.703-1.672C4.26,5.948,4.625,5.477,5.047,5.055\r\n\tc0.427-0.427,0.898-0.792,1.414-1.094C6.982,3.654,7.539,3.417,8.133,3.25C8.732,3.083,9.354,3,10,3V0l5.5,5.5L10,11V8\r\n\tC9.333,8,8.68,8.068,8.039,8.203c-0.635,0.13-1.25,0.326-1.844,0.586C5.602,9.044,5.034,9.359,4.492,9.734z M4.125,8.766\r\n\tC5,8.182,5.935,7.742,6.93,7.445S8.948,7,10,7h1v1.586L14.086,5.5L11,2.414V4h-0.211c-0.292,0-0.565,0.003-0.82,0.008\r\n\tC9.714,4.013,9.461,4.031,9.211,4.062c-0.25,0.026-0.5,0.073-0.75,0.141c-0.25,0.062-0.516,0.151-0.797,0.266\r\n\tC7.211,4.656,6.789,4.896,6.398,5.188c-0.385,0.292-0.732,0.625-1.039,1c-0.302,0.37-0.56,0.773-0.773,1.211\r\n\tC4.378,7.831,4.224,8.286,4.125,8.766z"},{type:"path",className:"OfficeIconColors_m26",d:"M10.789,4c-0.292,0-0.565,0.003-0.82,0.008C9.714,4.013,9.461,4.031,9.211,4.062\r\n\tc-0.25,0.026-0.5,0.073-0.75,0.141c-0.25,0.062-0.516,0.151-0.797,0.266C7.211,4.656,6.789,4.896,6.398,5.188\r\n\tc-0.385,0.292-0.732,0.625-1.039,1c-0.302,0.37-0.56,0.773-0.773,1.211C4.378,7.831,4.224,8.286,4.125,8.766\r\n\tC5,8.182,5.935,7.742,6.93,7.445C7.924,7.148,8.948,7,10,7h1v1.586L14.086,5.5L11,2.414V4H10.789z"},{type:"path",className:"OfficeIconColors_m22",d:"M11,12l1-1v3H0V4h1v9h10V12z"},{type:"path",className:"OfficeIconColors_m25",d:"M10,8C9.333,8,8.68,8.068,8.039,8.203c-0.635,0.13-1.25,0.326-1.844,0.586\r\n\tc-0.594,0.255-1.161,0.57-1.703,0.945C3.956,10.104,3.458,10.526,3,11v-1c0-0.646,0.083-1.266,0.25-1.859\r\n\tc0.167-0.599,0.401-1.156,0.703-1.672C4.26,5.948,4.625,5.477,5.047,5.055c0.427-0.427,0.898-0.792,1.414-1.094\r\n\tC6.982,3.654,7.539,3.417,8.133,3.25C8.732,3.083,9.354,3,10,3V0l5.5,5.5L10,11V8z M10.789,4c-0.292,0-0.565,0.003-0.82,0.008\r\n\tC9.714,4.013,9.461,4.031,9.211,4.062c-0.25,0.026-0.5,0.073-0.75,0.141c-0.25,0.062-0.516,0.151-0.797,0.266\r\n\tC7.211,4.656,6.789,4.896,6.398,5.188c-0.385,0.292-0.732,0.625-1.039,1c-0.302,0.37-0.56,0.773-0.773,1.211\r\n\tC4.378,7.831,4.224,8.286,4.125,8.766C5,8.182,5.935,7.742,6.93,7.445C7.924,7.148,8.948,7,10,7h1v1.586L14.086,5.5L11,2.414V4\r\n\tH10.789z"}],viewBox:"0 0 16 16"},{type:"svg",id:"SharePointMonoline_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1567 641 q 100 6 188 48 q 88 42 153 111 q 65 69 103 159 q 37 91 37 193 q 0 106 -40 199 q -40 94 -109 163 q -70 70 -163 110 q -94 40 -200 40 q -25 0 -49 -3 q -25 -2 -48 -6 q -5 82 -39 153 q -34 72 -90 125 q -56 54 -129 84 q -74 31 -157 31 q -82 0 -154 -30 q -73 -30 -129 -82 q -56 -52 -91 -122 q -35 -70 -41 -150 h -481 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 267 q 33 -84 90 -155 q 56 -70 130 -121 q 73 -51 161 -80 q 88 -28 184 -28 q 126 0 237 48 q 110 48 193 130 q 82 83 130 193 q 48 111 48 237 q 0 9 0 17 q 0 8 -1 16 m -607 -513 q -69 0 -132 18 q -64 19 -119 53 q -55 34 -99 81 q -44 47 -74 104 h 616 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 196 q 73 -42 157 -59 q 2 -10 3 -20 q 0 -10 0 -21 q 0 -99 -37 -187 q -38 -87 -103 -153 q -66 -65 -153 -103 q -88 -37 -187 -37 m -480 1327 q 66 12 142 12 q 69 0 129 -15 q 60 -15 105 -47 q 45 -31 71 -81 q 25 -49 25 -117 q 0 -74 -29 -125 q -29 -50 -81 -84 q -59 -37 -109 -59 q -51 -22 -89 -38 q -38 -15 -59 -31 q -22 -15 -22 -39 q 0 -13 10 -24 q 9 -11 26 -20 q 16 -8 38 -13 q 22 -4 48 -4 q 49 0 98 12 q 49 12 84 35 l 49 32 v -228 l -20 -8 q -79 -32 -214 -32 q -72 0 -134 17 q -63 17 -109 50 q -46 33 -72 81 q -27 49 -27 111 q 0 48 14 85 q 13 37 40 67 q 27 31 68 57 q 41 26 96 50 q 85 35 128 60 q 43 25 43 56 q 0 33 -30 48 q -31 15 -88 15 q -25 0 -55 -5 q -30 -5 -59 -15 q -30 -9 -57 -22 q -27 -13 -47 -28 l -51 -39 v 241 l 18 9 q 25 13 56 21 q 30 8 64 15 m 544 465 q 60 0 113 -23 q 52 -22 91 -61 q 39 -39 62 -92 q 22 -52 22 -112 q 0 -35 -9 -69 q -9 -33 -23 -62 v 35 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -414 q 6 54 31 101 q 24 47 63 81 q 38 35 87 54 q 49 20 105 20 m 512 -384 q 79 0 149 -31 q 70 -30 122 -82 q 52 -52 83 -122 q 30 -70 30 -149 q 0 -79 -30 -149 q -31 -69 -83 -122 q -53 -52 -122 -83 q -70 -30 -149 -30 q -74 0 -139 26 q -66 27 -117 73 v 438 q 51 40 88 94 q 37 54 55 119 q 54 18 113 18 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1024 1984 q -69 0 -130 -25 q -62 -25 -109 -69 q -47 -44 -76 -104 q -30 -59 -36 -127 l -5 -59 h -540 q -26 0 -45 -19 q -19 -19 -19 -45 v -1024 q 0 -26 19 -45 q 19 -19 45 -19 h 310 l 16 -40 q 31 -78 83 -142 q 51 -63 117 -108 q 66 -45 144 -70 q 78 -24 162 -24 q 112 0 212 43 q 99 43 173 116 q 73 74 116 173 q 43 100 43 212 q 0 7 0 13 q 0 6 -1 13 l -7 67 l 67 4 q 88 5 165 42 q 77 37 134 97 q 57 61 90 140 q 32 79 32 168 q 0 93 -35 174 q -36 82 -96 142 q -61 61 -142 96 q -82 36 -175 36 q -23 0 -44 -2 q -22 -2 -43 -6 l -70 -12 l -4 72 q -4 70 -33 130 q -29 61 -76 106 q -48 45 -110 70 q -62 26 -132 26 z"},{type:"path",className:"OfficeIconColors_m2268",d:"M 1567 641 q 100 6 188 48 q 88 42 153 111 q 65 69 103 159 q 37 91 37 193 q 0 106 -40 199 q -40 94 -109 163 q -70 70 -163 110 q -94 40 -200 40 q -25 0 -49 -3 q -25 -2 -48 -6 q -5 82 -39 153 q -34 72 -90 125 q -56 54 -129 84 q -74 31 -157 31 q -82 0 -154 -30 q -73 -30 -129 -82 q -56 -52 -91 -122 q -35 -70 -41 -150 h -481 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 267 q 33 -84 90 -155 q 56 -70 130 -121 q 73 -51 161 -80 q 88 -28 184 -28 q 126 0 237 48 q 110 48 193 130 q 82 83 130 193 q 48 111 48 237 q 0 9 0 17 q 0 8 -1 16 m -607 -513 q -69 0 -132 18 q -64 19 -119 53 q -55 34 -99 81 q -44 47 -74 104 h 616 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 196 q 73 -42 157 -59 q 2 -10 3 -20 q 0 -10 0 -21 q 0 -99 -37 -187 q -38 -87 -103 -153 q -66 -65 -153 -103 q -88 -37 -187 -37 m -480 1327 q 66 12 142 12 q 69 0 129 -15 q 60 -15 105 -47 q 45 -31 71 -81 q 25 -49 25 -117 q 0 -74 -29 -125 q -29 -50 -81 -84 q -59 -37 -109 -59 q -51 -22 -89 -38 q -38 -15 -59 -31 q -22 -15 -22 -39 q 0 -13 10 -24 q 9 -11 26 -20 q 16 -8 38 -13 q 22 -4 48 -4 q 49 0 98 12 q 49 12 84 35 l 49 32 v -228 l -20 -8 q -79 -32 -214 -32 q -72 0 -134 17 q -63 17 -109 50 q -46 33 -72 81 q -27 49 -27 111 q 0 48 14 85 q 13 37 40 67 q 27 31 68 57 q 41 26 96 50 q 85 35 128 60 q 43 25 43 56 q 0 33 -30 48 q -31 15 -88 15 q -25 0 -55 -5 q -30 -5 -59 -15 q -30 -9 -57 -22 q -27 -13 -47 -28 l -51 -39 v 241 l 18 9 q 25 13 56 21 q 30 8 64 15 m 544 465 q 60 0 113 -23 q 52 -22 91 -61 q 39 -39 62 -92 q 22 -52 22 -112 q 0 -35 -9 -69 q -9 -33 -23 -62 v 35 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -414 q 6 54 31 101 q 24 47 63 81 q 38 35 87 54 q 49 20 105 20 m 512 -384 q 79 0 149 -31 q 70 -30 122 -82 q 52 -52 83 -122 q 30 -70 30 -149 q 0 -79 -30 -149 q -31 -69 -83 -122 q -53 -52 -122 -83 q -70 -30 -149 -30 q -74 0 -139 26 q -66 27 -117 73 v 438 q 51 40 88 94 q 37 54 55 119 q 54 18 113 18 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ShareReport_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,3v10h5.352c-0.073-0.156-0.135-0.318-0.188-0.484C5.112,12.344,5.073,12.172,5.047,12H1V4.555l7,3.508\r\n\tl7-3.508v5.75c0.188,0.089,0.365,0.195,0.531,0.32c0.167,0.12,0.323,0.255,0.469,0.406V3H0z M8,6.938L2.117,4h11.766L8,6.938z\r\n\t M7.117,10.914C7.039,11.096,7,11.292,7,11.5c0,0.167,0.026,0.326,0.078,0.477c0.052,0.146,0.122,0.281,0.211,0.406\r\n\tc0.094,0.125,0.206,0.234,0.336,0.328c0.13,0.094,0.273,0.167,0.43,0.219c-0.016,0.094-0.029,0.19-0.039,0.289\r\n\tC8.005,13.312,8,13.406,8,13.5c0,0.073,0.005,0.148,0.016,0.227c0.01,0.078,0.021,0.154,0.031,0.227\r\n\tc-0.297-0.052-0.57-0.151-0.82-0.297c-0.25-0.151-0.466-0.336-0.648-0.555c-0.182-0.219-0.326-0.464-0.43-0.734\r\n\tC6.049,12.091,6,11.802,6,11.5c0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.307-0.565,0.531-0.789\r\n\tc0.229-0.229,0.495-0.409,0.797-0.539C7.831,9.068,8.156,9,8.5,9h2c0.344,0,0.667,0.068,0.969,0.203\r\n\tc0.302,0.13,0.565,0.31,0.789,0.539c0.229,0.224,0.409,0.487,0.539,0.789C12.932,10.833,13,11.156,13,11.5\r\n\tc0,0.297-0.049,0.581-0.148,0.852c-0.099,0.271-0.237,0.516-0.414,0.734c-0.177,0.214-0.388,0.396-0.633,0.547\r\n\tc-0.245,0.151-0.513,0.255-0.805,0.312v-1.039c0.146-0.052,0.281-0.125,0.406-0.219s0.229-0.201,0.313-0.32\r\n\tc0.089-0.125,0.156-0.26,0.203-0.406C11.974,11.81,12,11.656,12,11.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C10.904,10.039,10.708,10,10.5,10h-2\r\n\tc-0.208,0-0.404,0.039-0.586,0.117c-0.182,0.078-0.341,0.185-0.477,0.32S7.195,10.732,7.117,10.914z M15.844,12.617\r\n\tC15.948,12.888,16,13.174,16,13.477c0,0.344-0.065,0.669-0.195,0.977c-0.13,0.302-0.31,0.57-0.539,0.805\r\n\tc-0.224,0.229-0.49,0.411-0.797,0.547C14.167,15.935,13.844,16,13.5,16h-2c-0.344,0-0.669-0.065-0.977-0.195\r\n\tc-0.302-0.135-0.568-0.318-0.797-0.547c-0.224-0.234-0.401-0.503-0.531-0.805C9.065,14.146,9,13.82,9,13.477\r\n\tc0-0.297,0.049-0.581,0.148-0.852s0.237-0.516,0.414-0.734c0.177-0.224,0.388-0.411,0.633-0.562c0.245-0.156,0.513-0.263,0.805-0.32\r\n\tv1.039c-0.151,0.052-0.289,0.128-0.414,0.227c-0.12,0.094-0.224,0.206-0.312,0.336c-0.083,0.125-0.151,0.263-0.203,0.414\r\n\tC10.023,13.169,10,13.32,10,13.477c0,0.203,0.039,0.398,0.117,0.586c0.078,0.182,0.185,0.344,0.32,0.484\r\n\tc0.135,0.141,0.294,0.253,0.477,0.336C11.096,14.961,11.292,15,11.5,15h2c0.208,0,0.404-0.039,0.586-0.117\r\n\tc0.182-0.083,0.341-0.195,0.477-0.336c0.135-0.141,0.242-0.302,0.32-0.484C14.961,13.875,15,13.68,15,13.477\r\n\tc0-0.161-0.026-0.318-0.078-0.469c-0.052-0.156-0.125-0.297-0.219-0.422c-0.089-0.13-0.198-0.242-0.328-0.336\r\n\tc-0.13-0.099-0.273-0.172-0.43-0.219c0.016-0.094,0.029-0.187,0.039-0.281C13.995,11.651,14,11.555,14,11.461\r\n\tc0-0.073-0.005-0.148-0.016-0.227c-0.01-0.078-0.021-0.154-0.031-0.227c0.297,0.057,0.57,0.161,0.82,0.312\r\n\tc0.25,0.151,0.466,0.336,0.648,0.555C15.604,12.094,15.745,12.341,15.844,12.617z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,4.555l6.958,3.487C6.283,8.302,5,9.751,5,11.5c0,0.17,0.012,0.337,0.035,0.5H1V4.555z M8.073,8.026\r\n\tC8.213,8.009,8.356,8,8.5,8h2c1.398,0,2.604,0.819,3.165,2.004c0.476,0.022,0.927,0.139,1.335,0.333V4.555L8.073,8.026z M2.117,4\r\n\tL8,6.938L13.883,4H2.117z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,3v8.031c-0.146-0.151-0.302-0.286-0.469-0.406c-0.167-0.125-0.344-0.232-0.531-0.32v-5.75L8,8.062\r\n\tL1,4.555V12h4.047c0.026,0.172,0.065,0.344,0.117,0.516C5.216,12.682,5.279,12.844,5.352,13H0V3H16z M8,6.938L13.883,4H2.117\r\n\tL8,6.938z"},{type:"path",className:"OfficeIconColors_m23",d:"M8.5,10c-0.208,0-0.404,0.039-0.586,0.117c-0.182,0.078-0.341,0.185-0.477,0.32s-0.242,0.294-0.32,0.477\r\n\tC7.039,11.096,7,11.292,7,11.5c0,0.167,0.026,0.325,0.078,0.477c0.052,0.146,0.122,0.281,0.211,0.406\r\n\tc0.094,0.125,0.206,0.234,0.336,0.328c0.13,0.094,0.273,0.167,0.43,0.219c-0.016,0.094-0.029,0.19-0.039,0.289\r\n\tC8.005,13.312,8,13.406,8,13.5c0,0.073,0.005,0.148,0.016,0.227c0.01,0.078,0.021,0.154,0.031,0.227\r\n\tc-0.297-0.052-0.57-0.151-0.82-0.297c-0.25-0.151-0.466-0.336-0.648-0.555c-0.182-0.219-0.326-0.464-0.43-0.734\r\n\tC6.049,12.091,6,11.802,6,11.5c0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.307-0.565,0.531-0.789\r\n\tc0.229-0.229,0.495-0.409,0.797-0.539C7.831,9.068,8.156,9,8.5,9h2c0.344,0,0.667,0.068,0.969,0.203\r\n\tc0.302,0.13,0.565,0.31,0.789,0.539c0.229,0.224,0.409,0.487,0.539,0.789C12.932,10.833,13,11.156,13,11.5\r\n\tc0,0.297-0.05,0.581-0.148,0.852c-0.099,0.271-0.237,0.516-0.414,0.734c-0.177,0.214-0.388,0.396-0.633,0.547\r\n\tc-0.245,0.151-0.513,0.255-0.805,0.312v-1.039c0.146-0.052,0.281-0.125,0.406-0.219s0.229-0.2,0.313-0.32\r\n\tc0.089-0.125,0.156-0.26,0.203-0.406C11.974,11.81,12,11.656,12,11.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C10.904,10.039,10.708,10,10.5,10H8.5z M13.953,11.008\r\n\tc0.297,0.057,0.57,0.161,0.82,0.312c0.25,0.151,0.466,0.336,0.648,0.555c0.182,0.219,0.323,0.466,0.422,0.742\r\n\tC15.948,12.888,16,13.175,16,13.477c0,0.344-0.065,0.669-0.195,0.977c-0.13,0.302-0.31,0.57-0.539,0.805\r\n\tc-0.224,0.229-0.49,0.411-0.797,0.547C14.167,15.935,13.844,16,13.5,16h-2c-0.344,0-0.669-0.065-0.977-0.195\r\n\tc-0.302-0.135-0.568-0.318-0.797-0.547c-0.224-0.234-0.401-0.503-0.531-0.805C9.065,14.146,9,13.82,9,13.477\r\n\tc0-0.297,0.049-0.581,0.148-0.852s0.237-0.516,0.414-0.734c0.177-0.224,0.388-0.411,0.633-0.562c0.245-0.156,0.513-0.263,0.805-0.32\r\n\tv1.039c-0.151,0.052-0.289,0.128-0.414,0.227c-0.12,0.094-0.224,0.206-0.312,0.336c-0.083,0.125-0.151,0.263-0.203,0.414\r\n\tC10.023,13.169,10,13.32,10,13.477c0,0.203,0.039,0.398,0.117,0.586c0.078,0.182,0.185,0.344,0.32,0.484\r\n\tc0.135,0.141,0.294,0.253,0.477,0.336C11.096,14.961,11.292,15,11.5,15h2c0.208,0,0.404-0.039,0.586-0.117\r\n\tc0.182-0.083,0.341-0.195,0.477-0.336c0.135-0.141,0.242-0.302,0.32-0.484C14.961,13.875,15,13.68,15,13.477\r\n\tc0-0.161-0.026-0.318-0.078-0.469c-0.052-0.156-0.125-0.297-0.219-0.422c-0.089-0.13-0.198-0.242-0.328-0.336\r\n\tc-0.13-0.099-0.273-0.172-0.43-0.219c0.016-0.094,0.029-0.187,0.039-0.281C13.995,11.651,14,11.555,14,11.461\r\n\tc0-0.073-0.005-0.148-0.016-0.227C13.974,11.156,13.964,11.081,13.953,11.008z"}],viewBox:"0 0 16 16"},{type:"svg",id:"TeamsMonoline_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1792 640 q -53 0 -99 -20 q -47 -20 -82 -55 q -35 -35 -55 -82 q -20 -46 -20 -99 q 0 -53 20 -100 q 20 -46 55 -81 q 35 -35 82 -55 q 46 -20 99 -20 q 53 0 100 20 q 46 20 81 55 q 35 35 55 81 q 20 47 20 100 q 0 53 -20 99 q -20 47 -55 82 q -35 35 -81 55 q -47 20 -100 20 m 0 -384 q -27 0 -50 10 q -23 10 -40 27 q -18 18 -28 41 q -10 23 -10 50 q 0 27 10 50 q 10 23 28 40 q 17 18 40 28 q 23 10 50 10 q 27 0 50 -10 q 23 -10 41 -28 q 17 -17 27 -40 q 10 -23 10 -50 q 0 -27 -10 -50 q -10 -23 -27 -41 q -18 -17 -41 -27 q -23 -10 -50 -10 m 151 512 q 22 0 41 8 q 19 9 33 23 q 14 14 23 33 q 8 19 8 41 v 521 q 0 72 -27 136 q -28 64 -75 111 q -48 47 -112 74 q -64 28 -136 28 q -52 0 -95 -13 q -36 71 -89 129 q -53 59 -119 101 q -67 42 -145 65 q -78 23 -162 23 q -94 0 -179 -29 q -86 -28 -157 -79 q -71 -51 -124 -122 q -53 -70 -83 -154 h -417 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 640 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 q 79 0 149 30 q 70 30 122 82 q 52 53 82 123 q 30 70 30 149 q 0 63 -19 120 q -19 57 -52 104 q -34 47 -81 82 q -47 36 -103 56 v 22 h 279 h 8 m -415 -640 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 h 256 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 94 q 57 -34 93 -92 q 35 -58 35 -130 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 m 384 768 h -256 v 640 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -469 q 27 57 69 104 q 41 47 94 80 q 52 34 114 53 q 61 19 128 19 q 93 0 175 -36 q 81 -35 142 -96 q 60 -60 96 -142 q 35 -81 35 -174 m 384 -576 h -256 v 576 q 0 68 -17 138 q 28 5 51 5 q 46 0 87 -18 q 40 -17 70 -47 q 30 -30 48 -70 q 17 -40 17 -86 m -1120 46 v -640 h 256 v -192 h -704 v 192 h 256 v 640 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1088 1984 q -81 0 -156 -25 q -76 -24 -139 -69 q -64 -45 -112 -108 q -49 -62 -76 -139 l -15 -43 h -462 q -26 0 -45 -19 q -19 -19 -19 -45 v -1024 q 0 -26 19 -45 q 19 -19 45 -19 h 704 v -64 q 0 -66 25 -125 q 25 -58 69 -102 q 43 -43 102 -68 q 58 -25 124 -25 q 66 0 125 25 q 58 25 102 68 q 43 44 68 102 q 25 59 25 125 q 0 51 -15 98 q -16 47 -44 87 q -28 40 -67 70 q -39 31 -87 47 l -43 15 v 131 h 727 q 17 0 29 12 q 12 12 12 29 v 521 q 0 59 -22 111 q -23 52 -62 90 q -39 39 -91 61 q -52 23 -111 23 q -20 0 -39 -2 q -19 -2 -39 -8 l -50 -15 l -24 47 q -33 66 -81 118 q -49 53 -108 89 q -59 37 -127 56 q -69 20 -142 20 m 704 -1408 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 z"},{type:"path",className:"OfficeIconColors_m2267",d:"M 1792 640 q -53 0 -99 -20 q -47 -20 -82 -55 q -35 -35 -55 -82 q -20 -46 -20 -99 q 0 -53 20 -100 q 20 -46 55 -81 q 35 -35 82 -55 q 46 -20 99 -20 q 53 0 100 20 q 46 20 81 55 q 35 35 55 81 q 20 47 20 100 q 0 53 -20 99 q -20 47 -55 82 q -35 35 -81 55 q -47 20 -100 20 m 0 -384 q -27 0 -50 10 q -23 10 -40 27 q -18 18 -28 41 q -10 23 -10 50 q 0 27 10 50 q 10 23 28 40 q 17 18 40 28 q 23 10 50 10 q 27 0 50 -10 q 23 -10 41 -28 q 17 -17 27 -40 q 10 -23 10 -50 q 0 -27 -10 -50 q -10 -23 -27 -41 q -18 -17 -41 -27 q -23 -10 -50 -10 m 151 512 q 22 0 41 8 q 19 9 33 23 q 14 14 23 33 q 8 19 8 41 v 521 q 0 72 -27 136 q -28 64 -75 111 q -48 47 -112 74 q -64 28 -136 28 q -52 0 -95 -13 q -36 71 -89 129 q -53 59 -119 101 q -67 42 -145 65 q -78 23 -162 23 q -94 0 -179 -29 q -86 -28 -157 -79 q -71 -51 -124 -122 q -53 -70 -83 -154 h -417 q -26 0 -49 -10 q -24 -10 -41 -28 q -18 -17 -28 -41 q -10 -23 -10 -49 v -1024 q 0 -26 10 -50 q 10 -23 28 -41 q 17 -17 41 -27 q 23 -10 49 -10 h 640 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 q 79 0 149 30 q 70 30 122 82 q 52 53 82 123 q 30 70 30 149 q 0 63 -19 120 q -19 57 -52 104 q -34 47 -81 82 q -47 36 -103 56 v 22 h 279 h 8 m -415 -640 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 h 256 q 26 0 50 10 q 23 10 41 27 q 17 18 27 41 q 10 24 10 50 v 94 q 57 -34 93 -92 q 35 -58 35 -130 q 0 -53 -20 -100 q -20 -46 -55 -81 q -35 -35 -81 -55 q -47 -20 -100 -20 m 384 768 h -256 v 640 q 0 26 -10 49 q -10 24 -27 41 q -18 18 -41 28 q -24 10 -50 10 h -469 q 27 57 69 104 q 41 47 94 80 q 52 34 114 53 q 61 19 128 19 q 93 0 175 -36 q 81 -35 142 -96 q 60 -60 96 -142 q 35 -81 35 -174 m 384 -576 h -256 v 576 q 0 68 -17 138 q 28 5 51 5 q 46 0 87 -18 q 40 -17 70 -47 q 30 -30 48 -70 q 17 -40 17 -86 m -1120 46 v -640 h 256 v -192 h -704 v 192 h 256 v 640 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"UsageMetrics_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14,7h1v9h-1V7z M4,10.5l1-1V16H4V10.5z M2,12.5l1-1V16H2V12.5z M6,8.5l1-1V16H6V8.5z M8,7.5l1,1v7.492H8\r\n\tV7.5z M10.5,10L11,9.5V16h-1V9.5L10.5,10z M12,8.5l1-1V16h-1V8.5z M0,14.5l1-1V16H0V14.5z M16,2v4h-1V3.711l-4.5,4.492l-3-3\r\n\tL0,12.711v-1.422l7.5-7.492l3,3L14.289,3H12V2H16z"},{type:"path",className:"OfficeIconColors_m22",d:"M14,7h1v9h-1V7z M4,10.5l1-1V16H4V10.5z M2,12.5l1-1V16H2V12.5z M6,8.5l1-1V16H6V8.5z M8,7.5l1,1v7.492H8\r\n\tV7.5z M10.5,10L11,9.5V16h-1V9.5L10.5,10z M12,8.5l1-1V16h-1V8.5z M0,14.5l1-1V16H0V14.5z M16,2v4h-1V3.711l-4.5,4.492l-3-3\r\n\tL0,12.711v-1.422l7.5-7.492l3,3L14.289,3H12V2H16z"}],viewBox:"0 0 16 16"},{type:"svg",id:"ViewPBI_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14.75,2c0.172,0,0.333,0.034,0.484,0.102c0.151,0.062,0.284,0.151,0.398,0.266\r\n\tc0.115,0.115,0.203,0.247,0.266,0.398C15.966,2.917,16,3.078,16,3.25v9.5c0,0.172-0.034,0.333-0.102,0.484\r\n\tc-0.062,0.151-0.151,0.284-0.266,0.398s-0.247,0.206-0.398,0.273C15.083,13.969,14.922,14,14.75,14H1.25\r\n\tc-0.172,0-0.333-0.031-0.484-0.094c-0.151-0.068-0.284-0.159-0.398-0.273c-0.115-0.115-0.206-0.247-0.273-0.398\r\n\tC0.031,13.083,0,12.922,0,12.75v-9.5c0-0.172,0.031-0.333,0.094-0.484c0.068-0.151,0.159-0.284,0.273-0.398\r\n\tc0.115-0.115,0.247-0.203,0.398-0.266C0.917,2.034,1.078,2,1.25,2H14.75z M15,3.25c0-0.073-0.023-0.133-0.07-0.18\r\n\tC14.883,3.023,14.823,3,14.75,3H1.25C1.177,3,1.117,3.023,1.07,3.07C1.023,3.117,1,3.177,1,3.25v9.5c0,0.073,0.023,0.133,0.07,0.18\r\n\tC1.117,12.977,1.177,13,1.25,13h13.5c0.073,0,0.133-0.023,0.18-0.07S15,12.823,15,12.75V3.25z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,3.25c0-0.073-0.023-0.133-0.07-0.18C14.883,3.023,14.823,3,14.75,3H1.25C1.177,3,1.117,3.023,1.07,3.07\r\n\tC1.023,3.117,1,3.177,1,3.25v9.5c0,0.073,0.023,0.133,0.07,0.18C1.117,12.977,1.177,13,1.25,13h13.5c0.073,0,0.133-0.023,0.18-0.07\r\n\tS15,12.823,15,12.75V3.25z"},{type:"path",className:"OfficeIconColors_m22",d:"M14.75,2c0.172,0,0.333,0.034,0.484,0.102c0.151,0.062,0.284,0.151,0.398,0.266\r\n\tc0.115,0.115,0.203,0.247,0.266,0.398C15.966,2.917,16,3.078,16,3.25v9.5c0,0.172-0.034,0.333-0.102,0.484\r\n\tc-0.062,0.151-0.151,0.284-0.266,0.398s-0.247,0.206-0.398,0.273C15.083,13.969,14.922,14,14.75,14H1.25\r\n\tc-0.172,0-0.333-0.031-0.484-0.094c-0.151-0.068-0.284-0.159-0.398-0.273c-0.115-0.115-0.206-0.247-0.273-0.398\r\n\tC0.031,13.083,0,12.922,0,12.75v-9.5c0-0.172,0.031-0.333,0.094-0.484c0.068-0.151,0.159-0.284,0.273-0.398\r\n\tc0.115-0.115,0.247-0.203,0.398-0.266C0.917,2.034,1.078,2,1.25,2H14.75z M15,3.25c0-0.073-0.023-0.133-0.07-0.18\r\n\tC14.883,3.023,14.823,3,14.75,3H1.25C1.177,3,1.117,3.023,1.07,3.07C1.023,3.117,1,3.177,1,3.25v9.5c0,0.073,0.023,0.133,0.07,0.18\r\n\tC1.117,12.977,1.177,13,1.25,13h13.5c0.073,0,0.133-0.023,0.18-0.07S15,12.823,15,12.75V3.25z"}],viewBox:"0 0 16 16"},{type:"svg",id:"WebPublish_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,1v13h12v-1H1V5h14v4h1V1H0z M15,4H1V2h14V4z M13.5,8.797l2.5,2.492L15.289,12L14,10.711V16h-1v-5.289\r\n\tL11.711,12L11,11.289L13.5,8.797z"},{type:"path",className:"OfficeIconColors_m21",d:"M1,2h14v2H1V2z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,5H1v8h10.297l-1.712-1.712L13.5,7.385L15,8.88V5z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,1v8h-1V5H1v8h11v1H0V1H16z M15,2H1v2h14V2z"},{type:"path",className:"OfficeIconColors_m24",d:"M13.5,8.797l2.5,2.492L15.289,12L14,10.711V16h-1v-5.289L11.711,12L11,11.289L13.5,8.797z"}],viewBox:"0 0 16 16"},{type:"svg",id:"CodeEdit_16",children:[{type:"path",className:"OfficeIconColors_m20",d:"M11.8359 4.94531C11.9453 4.83594 12 4.70312 12 4.54688C12 4.38542 11.9453 4.25521 11.8359 4.15625C11.7318 4.05208 11.599 4 11.4375 4C11.3646 4 11.2943 4.01302 11.2266 4.03906C11.1589 4.0599 11.099 4.09635 11.0469 4.14844L5.64062 9.57031L5.375 10.625L6.42969 10.3594L11.8359 4.94531Z"},{type:"path",className:"OfficeIconColors_m22",d:"M1.71094 8L3.3125 9.60156L3.02344 10.7344L0.289062 8L3.64844 4.64844L4.35156 5.35156L1.71094 8ZM15.7109 8L12.3516 11.3516L11.6484 10.6484L14.2891 8L13.125 6.83594C13.2604 6.70052 13.3828 6.57552 13.4922 6.46094C13.6016 6.34115 13.7005 6.21615 13.7891 6.08594L15.7109 8Z"},{type:"path",className:"OfficeIconColors_m24",d:"M11.4375 3C11.6562 3 11.8594 3.03906 12.0469 3.11719C12.2396 3.19531 12.4062 3.30469 12.5469 3.44531C12.6875 3.58594 12.7969 3.75 12.875 3.9375C12.9583 4.125 13 4.32812 13 4.54688C13 4.75 12.9609 4.94792 12.8828 5.14062C12.8047 5.33333 12.6927 5.5026 12.5469 5.64844L6.94531 11.2656L4 12L4.73438 9.05469L10.3359 3.44531C10.4818 3.29948 10.651 3.1901 10.8438 3.11719C11.0365 3.03906 11.2344 3 11.4375 3ZM11.8359 4.94531C11.9453 4.83594 12 4.70312 12 4.54688C12 4.38542 11.9453 4.25521 11.8359 4.15625C11.7318 4.05208 11.599 4 11.4375 4C11.3646 4 11.2943 4.01302 11.2266 4.03906C11.1589 4.0599 11.099 4.09635 11.0469 4.14844L5.64062 9.57031L5.375 10.625L6.42969 10.3594L11.8359 4.94531Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"AddAPlace_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1920 1024 h -896 v 896 h -128 v -896 h -896 v -128 h 896 v -896 h 128 v 896 h 896 z"},{type:"path",className:"OfficeIconColors_m27",d:"M 1920 1024 h -896 v 896 h -128 v -896 h -896 v -128 h 896 v -896 h 128 v 896 h 896 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"AccessNewTable_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 0 0 h 2048 v 2048 h -2048 m 128 -1920 v 256 h 1792 v -256 m -1280 1280 v -384 h -512 v 384 m 640 -384 v 384 h 512 v -384 m 0 512 h -512 v 384 h 512 m -512 -1024 h 512 v -384 h -512 m 640 512 v 384 h 512 v -384 m -512 -128 h 512 v -384 h -512 m -768 0 h -512 v 384 h 512 m -512 640 v 384 h 512 v -384 m 768 384 h 512 v -384 h -512 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 64 1984 v -1920 h 1920 v 1920 z"},{type:"path",className:"OfficeIconColors_m21",d:"M 64 448 v -384 h 1920 v 384 z"},{type:"path",className:"OfficeIconColors_m23",d:"M 1984 1024 h -576 v 384 h 576 v 128 h -576 v 448 h -128 v -448 h -512 v 448 h -128 v -448 h -576 v -128 h 576 v -384 h -576 v -128 h 576 v -448 h 128 v 448 h 512 v -448 h 128 v 448 h 576 m -704 512 v -384 h -512 v 384 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 0 0 h 2048 v 2048 h -2048 m 1920 -128 v -1408 h -1792 v 1408 m 1792 -1536 v -256 h -1792 v 256 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"BarChart4_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,16h3v-5H0V16z M1,12h1v3H1V12z M4,16h3V7H4V16z M5,8h1v7H5V8z M8,16h3V3H8V16z M9,4h1v11H9V4z M12,7v9h3\r\n\tV7H12z M14,15h-1V8h1V15z"},{type:"path",className:"OfficeIconColors_m20",d:"M5,8v7h1V8H5z M9,4v11h1V4H9z M1,12v3h1v-3H1z M14,8h-1v7h1V8z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,16h3v-5H0V16z M1,12h1v3H1V12z M4,16h3V7H4V16z M5,8h1v7H5V8z M8,16h3V3H8V16z M9,4h1v11H9V4z M12,7v9h3\r\n\tV7H12z M14,15h-1V8h1V15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PBIReportTemplate_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,11h-1v5h1V11z M14,9h-1v7h1V9z M12,11h-1v5h1V11z M10,13H9v3h1V13z M2,0v1H1V0H2z M2,2v1H1V2H2z M2,4v1\r\n\tH1V4H2z M2,6v1H1V6H2z M2,8v1H1V8H2z M2,10v1H1v-1H2z M2,12v1H1v-1H2z M1,14h1v1H1V14z M2,16v-1h1v1H2z M4,0v1H3V0H4z M4,16v-1h1v1\r\n\tH4z M6,0v1H5V0H6z M6,16v-1h1v1H6z M8,0v1H7V0H8z M10,0v1H9V0H10z M12,0v1h-1V0H12z M13,2h-1V1h1V2z M13,3v1h-1V3H13z M12,6V5h1v1\r\n\tH12z M12,8V7h1v1H12z"},{type:"path",className:"OfficeIconColors_m20",d:"M13,0H1v16h7v-4h2v-2h2V8h1V0z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,11h-1v5h1V11z M14,9h-1v7h1V9z M12,11h-1v5h1V11z M10,13H9v3h1V13z"},{type:"path",className:"OfficeIconColors_m22",d:"M2,0v1H1V0H2z M2,2v1H1V2H2z M2,4v1H1V4H2z M2,6v1H1V6H2z M2,8v1H1V8H2z M2,10v1H1v-1H2z M2,12v1H1v-1H2z\r\n\t M1,14h1v1H1V14z M2,16v-1h1v1H2z M4,0v1H3V0H4z M4,16v-1h1v1H4z M6,0v1H5V0H6z M6,16v-1h1v1H6z M8,0v1H7V0H8z M10,0v1H9V0H10z\r\n\t M12,0v1h-1V0H12z M13,2h-1V1h1V2z M13,3v1h-1V3H13z M12,6V5h1v1H12z M12,8V7h1v1H12z"}],viewBox:"0 0 16 16"},{type:"svg",id:"RefreshNow_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M10.133,0.297c0.865,0.234,1.656,0.602,2.375,1.102c0.719,0.495,1.336,1.083,1.852,1.766\r\n\tc0.521,0.677,0.925,1.43,1.211,2.258C15.857,6.245,16,7.104,16,8c0,0.734-0.096,1.443-0.289,2.125\r\n\tc-0.188,0.682-0.456,1.32-0.805,1.914c-0.344,0.594-0.76,1.135-1.25,1.625c-0.484,0.484-1.023,0.901-1.617,1.25\r\n\tc-0.594,0.344-1.232,0.612-1.914,0.805C9.443,15.906,8.734,16,8,16s-1.443-0.094-2.125-0.281c-0.682-0.193-1.32-0.461-1.914-0.805\r\n\tc-0.594-0.349-1.135-0.766-1.625-1.25c-0.484-0.49-0.901-1.031-1.25-1.625c-0.344-0.594-0.612-1.229-0.805-1.906\r\n\tC0.094,9.451,0,8.74,0,8c0-0.729,0.096-1.438,0.289-2.125c0.193-0.688,0.466-1.333,0.82-1.938c0.359-0.609,0.794-1.161,1.305-1.656\r\n\tC2.924,1.781,3.5,1.354,4.141,1H2V0h4v4H5V1.68C4.391,1.971,3.839,2.339,3.344,2.781c-0.49,0.438-0.909,0.932-1.258,1.484\r\n\tC1.737,4.812,1.469,5.404,1.281,6.039C1.094,6.674,1,7.328,1,8c0,0.641,0.083,1.26,0.25,1.859c0.167,0.594,0.401,1.151,0.703,1.672\r\n\tc0.307,0.516,0.674,0.987,1.102,1.414c0.427,0.427,0.898,0.794,1.414,1.102c0.521,0.302,1.078,0.536,1.672,0.703\r\n\tC6.734,14.917,7.354,15,8,15c0.641,0,1.258-0.083,1.852-0.25c0.599-0.167,1.156-0.401,1.672-0.703\r\n\tc0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414c0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8\r\n\tc0-0.781-0.128-1.534-0.383-2.258c-0.25-0.724-0.602-1.383-1.055-1.977c-0.453-0.594-0.995-1.107-1.625-1.539\r\n\tc-0.625-0.438-1.315-0.76-2.07-0.969L10.133,0.297z"},{type:"path",className:"OfficeIconColors_m22",d:"M10.133,0.297c0.865,0.234,1.656,0.602,2.375,1.102c0.719,0.495,1.336,1.083,1.852,1.766\r\n\tc0.521,0.677,0.925,1.43,1.211,2.258C15.857,6.245,16,7.104,16,8c0,0.734-0.096,1.443-0.289,2.125\r\n\tc-0.188,0.682-0.456,1.32-0.805,1.914c-0.344,0.594-0.76,1.135-1.25,1.625c-0.484,0.484-1.023,0.901-1.617,1.25\r\n\tc-0.594,0.344-1.232,0.612-1.914,0.805C9.443,15.906,8.734,16,8,16s-1.443-0.094-2.125-0.281c-0.682-0.193-1.32-0.461-1.914-0.805\r\n\tc-0.594-0.349-1.135-0.766-1.625-1.25c-0.484-0.49-0.901-1.031-1.25-1.625c-0.344-0.594-0.612-1.229-0.805-1.906\r\n\tC0.094,9.451,0,8.74,0,8c0-0.729,0.096-1.438,0.289-2.125c0.193-0.688,0.466-1.333,0.82-1.938c0.359-0.609,0.794-1.161,1.305-1.656\r\n\tC2.924,1.781,3.5,1.354,4.141,1H2V0h4v4H5V1.68C4.391,1.971,3.839,2.339,3.344,2.781c-0.49,0.438-0.909,0.932-1.258,1.484\r\n\tC1.737,4.812,1.469,5.404,1.281,6.039C1.094,6.674,1,7.328,1,8c0,0.641,0.083,1.26,0.25,1.859c0.167,0.594,0.401,1.151,0.703,1.672\r\n\tc0.307,0.516,0.674,0.987,1.102,1.414c0.427,0.427,0.898,0.794,1.414,1.102c0.521,0.302,1.078,0.536,1.672,0.703\r\n\tC6.734,14.917,7.354,15,8,15c0.641,0,1.258-0.083,1.852-0.25c0.599-0.167,1.156-0.401,1.672-0.703\r\n\tc0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414c0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8\r\n\tc0-0.781-0.128-1.534-0.383-2.258c-0.25-0.724-0.602-1.383-1.055-1.977c-0.453-0.594-0.995-1.107-1.625-1.539\r\n\tc-0.625-0.438-1.315-0.76-2.07-0.969L10.133,0.297z"}],viewBox:"0 0 16 16"},{type:"svg",id:"RefreshCancel_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8.0 16.0q1.1015625 0.0 2.12109375 -0.28515625t1.91015625 -0.80859375t1.62109375 -1.25390625t1.25390625 -1.62109375t0.80859375 -1.91015625t0.28515625 -2.12109375t-0.28515625 -2.12109375t-0.80859375 -1.91015625t-1.25390625 -1.62109375t-1.62109375 -1.25390625t-1.91015625 -0.80859375t-2.12109375 -0.28515625t-2.12109375 0.28515625t-1.91015625 0.80859375t-1.62109375 1.25390625t-1.25390625 1.62109375t-0.80859375 1.91015625t-0.28515625 2.12109375 t0.28515625 2.12109375t0.80859375 1.91015625t1.25390625 1.62109375t1.62109375 1.25390625t1.91015625 0.80859375t2.12109375 0.28515625zM8.0 1.0q1.28125 0.0 2.44921875 0.4375t2.13671875 1.2734375l-9.875 9.875q-0.8359375 -0.96875 -1.2734375 -2.13671875t-0.4375 -2.44921875q0.0 -0.96875 0.25 -1.86328125t0.70703125 -1.671875t1.09375 -1.4140625t1.4140625 -1.09375t1.671875 -0.70703125t1.86328125 -0.25zM13.2890625 3.4140625q0.8359375 0.96875 1.2734375 2.13671875t0.4375 2.44921875 q0.0 0.96875 -0.25 1.86328125t-0.70703125 1.671875t-1.09375 1.4140625t-1.4140625 1.09375t-1.671875 0.70703125t-1.86328125 0.25q-1.28125 0.0 -2.44921875 -0.4375t-2.13671875 -1.2734375z"},{type:"path",className:"OfficeIconColors_m22",d:"M8.0 16.0q1.1015625 0.0 2.12109375 -0.28515625t1.91015625 -0.80859375t1.62109375 -1.25390625t1.25390625 -1.62109375t0.80859375 -1.91015625t0.28515625 -2.12109375t-0.28515625 -2.12109375t-0.80859375 -1.91015625t-1.25390625 -1.62109375t-1.62109375 -1.25390625t-1.91015625 -0.80859375t-2.12109375 -0.28515625t-2.12109375 0.28515625t-1.91015625 0.80859375t-1.62109375 1.25390625t-1.25390625 1.62109375t-0.80859375 1.91015625t-0.28515625 2.12109375 t0.28515625 2.12109375t0.80859375 1.91015625t1.25390625 1.62109375t1.62109375 1.25390625t1.91015625 0.80859375t2.12109375 0.28515625zM8.0 1.0q1.28125 0.0 2.44921875 0.4375t2.13671875 1.2734375l-9.875 9.875q-0.8359375 -0.96875 -1.2734375 -2.13671875t-0.4375 -2.44921875q0.0 -0.96875 0.25 -1.86328125t0.70703125 -1.671875t1.09375 -1.4140625t1.4140625 -1.09375t1.671875 -0.70703125t1.86328125 -0.25zM13.2890625 3.4140625q0.8359375 0.96875 1.2734375 2.13671875t0.4375 2.44921875 q0.0 0.96875 -0.25 1.86328125t-0.70703125 1.671875t-1.09375 1.4140625t-1.4140625 1.09375t-1.671875 0.70703125t-1.86328125 0.25q-1.28125 0.0 -2.44921875 -0.4375t-2.13671875 -1.2734375z"}],viewBox:"0 0 16 16"},{type:"svg",id:"DateTime_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M7,8h1v0.672C7.915,8.778,7.833,8.887,7.758,9H7V8z M12,6h-1v1h0.5H12V6z M7,7h1V6H7V7z M10,6H9v1h1V6z\r\n\t M3,11h1v-1H3V11z M5,7h1V6H5V7z M3,9h1V8H3V9z M16,11.5c0,0.62-0.12,1.203-0.359,1.75c-0.234,0.547-0.555,1.023-0.961,1.43\r\n\tc-0.406,0.406-0.883,0.729-1.43,0.969C12.703,15.883,12.12,16,11.5,16s-1.203-0.117-1.75-0.352c-0.547-0.24-1.023-0.562-1.43-0.969\r\n\tc-0.406-0.406-0.729-0.883-0.969-1.43C7.317,13.169,7.302,13.083,7.274,13H7.258H1V1h2V0h1v1h7V0h1v1h2v6.758V7.77\r\n\tc0.244,0.162,0.473,0.343,0.68,0.55c0.406,0.406,0.727,0.883,0.961,1.43C15.88,10.297,16,10.88,16,11.5z M2,4h11V2h-1v1h-1V2H4v1H3\r\n\tV2H2V4z M7.352,9.75c0.24-0.547,0.562-1.023,0.969-1.43s0.883-0.727,1.43-0.961C10.297,7.12,10.88,7,11.5,7\r\n\tc0.529,0,1.025,0.106,1.5,0.281V7.258V5H2v7h5.028h0.021C7.028,11.835,7,11.672,7,11.5C7,10.88,7.117,10.297,7.352,9.75z M15,11.5\r\n\tc0-0.484-0.094-0.938-0.281-1.359c-0.182-0.427-0.432-0.797-0.75-1.109c-0.313-0.318-0.682-0.568-1.109-0.75\r\n\tC12.438,8.094,11.984,8,11.5,8s-0.94,0.094-1.367,0.281c-0.422,0.182-0.792,0.432-1.109,0.75c-0.312,0.312-0.562,0.682-0.75,1.109\r\n\tC8.091,10.562,8,11.016,8,11.5s0.091,0.94,0.273,1.367c0.188,0.422,0.438,0.792,0.75,1.109c0.318,0.312,0.688,0.562,1.109,0.75\r\n\tC10.56,14.909,11.016,15,11.5,15s0.938-0.091,1.359-0.273c0.427-0.188,0.797-0.438,1.109-0.75c0.318-0.318,0.568-0.688,0.75-1.109\r\n\tC14.906,12.44,15,11.984,15,11.5z M12,9h-1v3h2.5v-1H12V9z M5,9h1V8H5V9z M5,11h1v-1H5V11z"},{type:"path",className:"OfficeIconColors_m26",d:"M2,2h11v2H2V2z"},{type:"path",className:"OfficeIconColors_m20",d:"M15,11.5c0,1.933-1.567,3.5-3.5,3.5c-1.762,0-3.205-1.306-3.45-3H2V5h11v3.35\r\n\tC14.179,8.913,15,10.106,15,11.5z"},{type:"path",className:"OfficeIconColors_m24",d:"M11.5,7c0.62,0,1.203,0.12,1.75,0.359c0.547,0.234,1.023,0.555,1.43,0.961\r\n\tc0.406,0.406,0.727,0.883,0.961,1.43C15.88,10.297,16,10.88,16,11.5s-0.12,1.203-0.359,1.75c-0.234,0.547-0.555,1.023-0.961,1.43\r\n\tc-0.406,0.406-0.883,0.729-1.43,0.969C12.703,15.883,12.12,16,11.5,16s-1.203-0.117-1.75-0.352c-0.547-0.24-1.023-0.562-1.43-0.969\r\n\tc-0.406-0.406-0.729-0.883-0.969-1.43C7.117,12.703,7,12.12,7,11.5s0.117-1.203,0.352-1.75c0.24-0.547,0.562-1.023,0.969-1.43\r\n\tc0.406-0.406,0.883-0.727,1.43-0.961C10.297,7.12,10.88,7,11.5,7z M11.5,15c0.484,0,0.938-0.091,1.359-0.273\r\n\tc0.427-0.188,0.797-0.438,1.109-0.75c0.318-0.318,0.568-0.688,0.75-1.109C14.906,12.44,15,11.984,15,11.5s-0.094-0.938-0.281-1.359\r\n\tc-0.182-0.427-0.432-0.797-0.75-1.109c-0.313-0.318-0.682-0.568-1.109-0.75C12.438,8.094,11.984,8,11.5,8s-0.94,0.094-1.367,0.281\r\n\tc-0.422,0.182-0.792,0.432-1.109,0.75c-0.312,0.312-0.562,0.682-0.75,1.109C8.091,10.562,8,11.016,8,11.5s0.091,0.94,0.273,1.367\r\n\tc0.188,0.422,0.438,0.792,0.75,1.109c0.318,0.312,0.688,0.562,1.109,0.75C10.56,14.909,11.016,15,11.5,15z"},{type:"path",className:"OfficeIconColors_m22",d:"M14,1v6.758c-0.309-0.207-0.644-0.374-1-0.5V5H2v7h5.028\r\n\tc0.039,0.347,0.117,0.681,0.23,1H1V1h2V0h1v1h7V0h1v1H14z M2,2v2h11V2h-1v1h-1V2H4v1H3V2H2z M6,11v-1H5v1H6z M12,6v1h-1V6H12z\r\n\t M7.758,9C7.833,8.887,7.915,8.778,8,8.672V8H7v1H7.758z M3,8h1v1H3V8z M6,8H5v1h1V8z M5,6h1v1H5V6z M4,10H3v1h1V10z M7,7h1V6H7V7z\r\n\t M10,7H9V6h1V7z M12,11h1.5v1H11V9h1V11z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PeopleSettings_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.844,7.898c-0.104-0.359-0.253-0.693-0.445-1c-0.193-0.312-0.427-0.594-0.703-0.844\r\n\tc-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062C12.891,3.924,13,3.474,13,3\r\n\tc0-0.412-0.081-0.799-0.242-1.164c-0.156-0.365-0.37-0.682-0.641-0.953c-0.145-0.145-0.303-0.273-0.475-0.385\r\n\tc-0.149-0.098-0.309-0.183-0.478-0.255C10.799,0.081,10.412,0,10,0C9.771,0,9.548,0.025,9.333,0.075\r\n\tc-0.17,0.04-0.336,0.095-0.498,0.167c-0.365,0.156-0.682,0.37-0.953,0.641S7.396,1.471,7.234,1.836C7.078,2.201,7,2.588,7,3\r\n\tc0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062C7.88,5.586,7.573,5.799,7.297,6.055\r\n\tc-0.271,0.25-0.502,0.531-0.695,0.844c-0.07,0.111-0.129,0.228-0.187,0.345c-0.092-0.126-0.186-0.25-0.297-0.361\r\n\tC5.846,6.612,5.529,6.398,5.164,6.242C4.799,6.081,4.411,6,4,6S3.201,6.081,2.836,6.242c-0.365,0.156-0.682,0.37-0.953,0.641\r\n\tS1.396,7.471,1.234,7.836C1.078,8.201,1,8.589,1,9c0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062\r\n\tc-0.339,0.172-0.646,0.385-0.922,0.641c-0.271,0.25-0.503,0.531-0.695,0.844c-0.193,0.307-0.341,0.641-0.445,1\r\n\tC0.052,14.253,0,14.62,0,15h1c0-0.411,0.078-0.799,0.234-1.164c0.161-0.365,0.378-0.682,0.648-0.953s0.589-0.484,0.953-0.641\r\n\tC3.201,12.081,3.589,12,4,12s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641s0.484,0.589,0.641,0.953\r\n\tC6.919,14.201,7,14.589,7,15h1c0-0.38-0.052-0.747-0.156-1.102c-0.104-0.359-0.253-0.693-0.445-1\r\n\tc-0.193-0.312-0.427-0.594-0.703-0.844c-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062\r\n\tC6.891,9.924,7,9.474,7,9c0-0.412,0.078-0.799,0.234-1.164c0.022-0.051,0.046-0.101,0.071-0.15c0.152-0.303,0.344-0.57,0.578-0.803\r\n\tc0.271-0.271,0.588-0.484,0.953-0.641C9.201,6.081,9.588,6,10,6s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641\r\n\ts0.484,0.588,0.641,0.953c0.026,0.058,0.049,0.117,0.071,0.176c0.38,0.027,0.748,0.103,1.097,0.219\r\n\tC13.903,8.119,13.876,8.008,13.844,7.898z M5.836,9.781c-0.104,0.24-0.247,0.451-0.43,0.633c-0.177,0.177-0.388,0.32-0.633,0.43\r\n\tC4.529,10.948,4.271,11,4,11c-0.276,0-0.536-0.052-0.781-0.156c-0.24-0.109-0.451-0.253-0.633-0.43\r\n\tc-0.177-0.182-0.32-0.393-0.43-0.633C2.052,9.536,2,9.276,2,9c0-0.271,0.052-0.529,0.156-0.773c0.109-0.245,0.253-0.456,0.43-0.633\r\n\tc0.182-0.182,0.393-0.326,0.633-0.43C3.464,7.055,3.724,7,4,7c0.271,0,0.529,0.055,0.773,0.164c0.245,0.104,0.456,0.247,0.633,0.43\r\n\tc0.182,0.177,0.326,0.388,0.43,0.633C5.945,8.471,6,8.729,6,9C6,9.276,5.945,9.536,5.836,9.781z M10.773,4.844\r\n\tC10.529,4.948,10.271,5,10,5C9.724,5,9.463,4.948,9.219,4.844C9.086,4.783,8.962,4.712,8.847,4.631\r\n\tc-0.093-0.065-0.18-0.138-0.261-0.217c-0.177-0.182-0.32-0.393-0.43-0.633C8.052,3.537,8,3.276,8,3c0-0.271,0.052-0.529,0.156-0.773\r\n\tc0.109-0.245,0.252-0.456,0.43-0.633c0.182-0.182,0.393-0.326,0.633-0.43C9.463,1.055,9.724,1,10,1c0.271,0,0.529,0.055,0.773,0.164\r\n\tc0.245,0.104,0.456,0.248,0.633,0.43c0.103,0.1,0.193,0.211,0.271,0.333c0.06,0.094,0.113,0.194,0.158,0.3\r\n\tC11.945,2.471,12,2.729,12,3c0,0.276-0.055,0.537-0.164,0.781c-0.104,0.24-0.247,0.451-0.43,0.633\r\n\tC11.229,4.591,11.018,4.734,10.773,4.844z M15,12.5c0,0.161-0.016,0.32-0.047,0.477l0.969,0.398l-0.383,0.93l-0.969-0.406\r\n\tc-0.078,0.13-0.177,0.255-0.297,0.375c-0.12,0.115-0.245,0.214-0.375,0.297l0.406,0.969l-0.93,0.383l-0.398-0.969\r\n\tC12.82,14.984,12.661,15,12.5,15s-0.32-0.016-0.477-0.047l-0.398,0.969l-0.93-0.383l0.406-0.969\r\n\tc-0.266-0.182-0.49-0.406-0.672-0.672l-0.969,0.406l-0.383-0.93l0.969-0.398C10.016,12.82,10,12.661,10,12.5s0.016-0.32,0.047-0.477\r\n\tl-0.969-0.398l0.383-0.93l0.969,0.406c0.177-0.271,0.401-0.495,0.672-0.672l-0.406-0.969l0.93-0.383l0.398,0.969\r\n\tc0.073-0.01,0.143-0.018,0.211-0.023c0.073-0.01,0.146-0.016,0.219-0.016c0.089,0,0.174,0.005,0.258,0.016\r\n\tc0.083,0.01,0.169,0.023,0.258,0.039l0.406-0.984l0.93,0.383l-0.414,0.984c0.276,0.167,0.503,0.385,0.68,0.656l0.969-0.406\r\n\tl0.383,0.93l-0.969,0.398C14.984,12.18,15,12.339,15,12.5z M14,12.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C12.904,11.039,12.708,11,12.5,11c-0.203,0-0.396,0.039-0.578,0.117\r\n\tc-0.182,0.078-0.344,0.188-0.484,0.328c-0.135,0.135-0.242,0.294-0.32,0.477C11.039,12.104,11,12.297,11,12.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.083,0.182,0.193,0.341,0.328,0.477s0.294,0.242,0.477,0.32C12.109,13.961,12.305,14,12.508,14\r\n\ts0.393-0.039,0.57-0.117c0.182-0.083,0.341-0.193,0.477-0.328c0.141-0.135,0.25-0.294,0.328-0.477C13.961,12.896,14,12.703,14,12.5z\r\n\t"},{type:"path",className:"OfficeIconColors_m20",d:"M12,3c0,1.104-0.896,2-2,2C8.896,5,8,4.104,8,3s0.896-2,2-2C11.104,1,12,1.896,12,3z M12.833,8.012\r\n\tC12.425,6.841,11.311,6,10,6C8.343,6,7,7.343,7,9h2.671c0.773-0.625,1.757-1,2.829-1C12.612,8,12.723,8.004,12.833,8.012z M4,11\r\n\tc1.104,0,2-0.896,2-2c0-1.104-0.896-2-2-2S2,7.896,2,9C2,10.104,2.896,11,4,11z M4,12c1.657,0,3,1.343,3,3H1C1,13.343,2.343,12,4,12\r\n\tz"},{type:"path",className:"OfficeIconColors_m22",d:"M13.844,7.898c-0.104-0.359-0.253-0.693-0.445-1c-0.193-0.312-0.427-0.594-0.703-0.844\r\n\tc-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062C12.891,3.924,13,3.474,13,3\r\n\tc0-0.412-0.081-0.799-0.242-1.164c-0.156-0.365-0.37-0.682-0.641-0.953c-0.145-0.145-0.303-0.273-0.475-0.385\r\n\tc-0.149-0.098-0.309-0.183-0.478-0.255C10.799,0.081,10.412,0,10,0C9.771,0,9.548,0.025,9.333,0.075\r\n\tc-0.17,0.04-0.336,0.095-0.498,0.167c-0.365,0.156-0.682,0.37-0.953,0.641S7.396,1.471,7.234,1.836C7.078,2.201,7,2.588,7,3\r\n\tc0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062C7.88,5.586,7.573,5.799,7.297,6.055\r\n\tc-0.271,0.25-0.502,0.531-0.695,0.844c-0.07,0.111-0.129,0.228-0.187,0.345c-0.092-0.126-0.186-0.25-0.297-0.361\r\n\tC5.846,6.612,5.529,6.398,5.164,6.242C4.799,6.081,4.411,6,4,6S3.201,6.081,2.836,6.242c-0.365,0.156-0.682,0.37-0.953,0.641\r\n\tS1.396,7.471,1.234,7.836C1.078,8.201,1,8.589,1,9c0,0.474,0.107,0.924,0.32,1.352c0.219,0.427,0.518,0.781,0.898,1.062\r\n\tc-0.339,0.172-0.646,0.385-0.922,0.641c-0.271,0.25-0.503,0.531-0.695,0.844c-0.193,0.307-0.341,0.641-0.445,1\r\n\tC0.052,14.253,0,14.62,0,15h1c0-0.411,0.078-0.799,0.234-1.164c0.161-0.365,0.378-0.682,0.648-0.953s0.589-0.484,0.953-0.641\r\n\tC3.201,12.081,3.589,12,4,12s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641s0.484,0.589,0.641,0.953\r\n\tC6.919,14.201,7,14.589,7,15h1c0-0.38-0.052-0.747-0.156-1.102c-0.104-0.359-0.253-0.693-0.445-1\r\n\tc-0.193-0.312-0.427-0.594-0.703-0.844c-0.271-0.255-0.576-0.469-0.914-0.641c0.38-0.281,0.677-0.635,0.891-1.062\r\n\tC6.891,9.924,7,9.474,7,9c0-0.412,0.078-0.799,0.234-1.164c0.022-0.051,0.046-0.101,0.071-0.15c0.152-0.303,0.344-0.57,0.578-0.803\r\n\tc0.271-0.271,0.588-0.484,0.953-0.641C9.201,6.081,9.588,6,10,6s0.799,0.081,1.164,0.242c0.365,0.156,0.682,0.37,0.953,0.641\r\n\ts0.484,0.588,0.641,0.953c0.026,0.058,0.049,0.117,0.071,0.176c0.38,0.027,0.748,0.103,1.097,0.219\r\n\tC13.903,8.119,13.876,8.008,13.844,7.898z M5.836,9.781c-0.104,0.24-0.247,0.451-0.43,0.633c-0.177,0.177-0.388,0.32-0.633,0.43\r\n\tC4.529,10.948,4.271,11,4,11c-0.276,0-0.536-0.052-0.781-0.156c-0.24-0.109-0.451-0.253-0.633-0.43\r\n\tc-0.177-0.182-0.32-0.393-0.43-0.633C2.052,9.536,2,9.276,2,9c0-0.271,0.052-0.529,0.156-0.773c0.109-0.245,0.253-0.456,0.43-0.633\r\n\tc0.182-0.182,0.393-0.326,0.633-0.43C3.464,7.055,3.724,7,4,7c0.271,0,0.529,0.055,0.773,0.164c0.245,0.104,0.456,0.247,0.633,0.43\r\n\tc0.182,0.177,0.326,0.388,0.43,0.633C5.945,8.471,6,8.729,6,9C6,9.276,5.945,9.536,5.836,9.781z M10.773,4.844\r\n\tC10.529,4.948,10.271,5,10,5C9.724,5,9.463,4.948,9.219,4.844C9.086,4.783,8.962,4.712,8.847,4.631\r\n\tc-0.093-0.065-0.18-0.138-0.261-0.217c-0.177-0.182-0.32-0.393-0.43-0.633C8.052,3.537,8,3.276,8,3c0-0.271,0.052-0.529,0.156-0.773\r\n\tc0.109-0.245,0.252-0.456,0.43-0.633c0.182-0.182,0.393-0.326,0.633-0.43C9.463,1.055,9.724,1,10,1c0.271,0,0.529,0.055,0.773,0.164\r\n\tc0.245,0.104,0.456,0.248,0.633,0.43c0.103,0.1,0.193,0.211,0.271,0.333c0.06,0.094,0.113,0.194,0.158,0.3\r\n\tC11.945,2.471,12,2.729,12,3c0,0.276-0.055,0.537-0.164,0.781c-0.104,0.24-0.247,0.451-0.43,0.633\r\n\tC11.229,4.591,11.018,4.734,10.773,4.844z"},{type:"path",className:"OfficeIconColors_m23",d:"M15,12.5c0,0.161-0.016,0.32-0.047,0.477l0.969,0.398l-0.383,0.93l-0.969-0.406\r\n\tc-0.078,0.13-0.177,0.255-0.297,0.375c-0.12,0.115-0.245,0.214-0.375,0.297l0.406,0.969l-0.93,0.383l-0.398-0.969\r\n\tC12.82,14.984,12.661,15,12.5,15s-0.32-0.016-0.477-0.047l-0.398,0.969l-0.93-0.383l0.406-0.969\r\n\tc-0.266-0.182-0.49-0.406-0.672-0.672l-0.969,0.406l-0.383-0.93l0.969-0.398C10.016,12.82,10,12.661,10,12.5s0.016-0.32,0.047-0.477\r\n\tl-0.969-0.398l0.383-0.93l0.969,0.406c0.177-0.271,0.401-0.495,0.672-0.672l-0.406-0.969l0.93-0.383l0.398,0.969\r\n\tc0.073-0.01,0.143-0.018,0.211-0.023c0.073-0.01,0.146-0.016,0.219-0.016c0.089,0,0.174,0.005,0.258,0.016\r\n\tc0.083,0.01,0.169,0.023,0.258,0.039l0.406-0.984l0.93,0.383l-0.414,0.984c0.276,0.167,0.503,0.385,0.68,0.656l0.969-0.406\r\n\tl0.383,0.93l-0.969,0.398C14.984,12.18,15,12.339,15,12.5z M14,12.5c0-0.208-0.039-0.404-0.117-0.586\r\n\tc-0.078-0.182-0.185-0.341-0.32-0.477s-0.294-0.242-0.477-0.32C12.904,11.039,12.708,11,12.5,11c-0.203,0-0.396,0.039-0.578,0.117\r\n\tc-0.182,0.078-0.344,0.188-0.484,0.328c-0.135,0.135-0.242,0.294-0.32,0.477C11.039,12.104,11,12.297,11,12.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.083,0.182,0.193,0.341,0.328,0.477s0.294,0.242,0.477,0.32C12.109,13.961,12.305,14,12.508,14\r\n\ts0.393-0.039,0.57-0.117c0.182-0.083,0.341-0.193,0.477-0.328c0.141-0.135,0.25-0.294,0.328-0.477C13.961,12.896,14,12.703,14,12.5z\r\n\t"}],viewBox:"0 0 16 16"},{type:"svg",id:"Database_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1792 1664 q 0 53 -27 102 q -28 49 -78 91 q -50 43 -120 78 q -70 35 -155 60 q -86 25 -184 39 q -98 14 -204 14 q -106 0 -204 -14 q -98 -14 -183 -39 q -86 -25 -156 -60 q -70 -35 -120 -78 q -50 -42 -77 -91 q -28 -49 -28 -102 v -1280 q 0 -79 61 -149 q 60 -70 164 -123 q 104 -52 244 -82 q 140 -30 299 -30 q 159 0 299 30 q 140 30 244 82 q 104 53 165 123 q 60 70 60 149 m -768 -256 q -147 0 -265 25 q -118 26 -201 64 q -84 38 -129 83 q -45 45 -45 84 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 q 0 -39 -45 -84 q -45 -45 -128 -83 q -84 -38 -202 -64 q -118 -25 -265 -25 m 0 1792 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 v -1068 q -52 39 -121 71 q -69 32 -151 54 q -82 23 -175 35 q -93 12 -193 12 q -100 0 -193 -12 q -93 -12 -175 -35 q -82 -22 -151 -54 q -69 -32 -121 -71 v 1068 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 z"},{type:"path",className:"OfficeIconColors_m20",d:"M 1728 384 v 1339 q 3 0 3 2 q 0 7 -25 28 q -25 22 -73 51 q -48 29 -117 61 q -69 32 -156 59 q -87 27 -191 44 q -105 18 -223 18 q -100 0 -180 -12 q -80 -12 -142 -32 q -63 -19 -110 -45 q -47 -25 -81 -51 q -79 -62 -113 -141 v -1321 q 0 -58 51 -116 q 51 -57 144 -103 q 92 -45 222 -73 q 129 -28 287 -28 q 158 0 288 28 q 129 28 222 73 q 92 46 143 103 q 51 58 51 116 z"},{type:"path",className:"OfficeIconColors_m22",d:"M 1792 1664 q 0 53 -27 102 q -28 49 -78 91 q -50 43 -120 78 q -70 35 -155 60 q -86 25 -184 39 q -98 14 -204 14 q -106 0 -204 -14 q -98 -14 -183 -39 q -86 -25 -156 -60 q -70 -35 -120 -78 q -50 -42 -77 -91 q -28 -49 -28 -102 v -1280 q 0 -79 61 -149 q 60 -70 164 -123 q 104 -52 244 -82 q 140 -30 299 -30 q 159 0 299 30 q 140 30 244 82 q 104 53 165 123 q 60 70 60 149 m -768 -256 q -147 0 -265 25 q -118 26 -201 64 q -84 38 -129 83 q -45 45 -45 84 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 q 0 -39 -45 -84 q -45 -45 -128 -83 q -84 -38 -202 -64 q -118 -25 -265 -25 m 0 1792 q 147 0 265 -26 q 118 -25 202 -63 q 83 -38 128 -83 q 45 -45 45 -84 v -1068 q -52 39 -121 71 q -69 32 -151 54 q -82 23 -175 35 q -93 12 -193 12 q -100 0 -193 -12 q -93 -12 -175 -35 q -82 -22 -151 -54 q -69 -32 -121 -71 v 1068 q 0 39 45 84 q 45 45 129 83 q 83 38 201 63 q 118 26 265 26 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"ImpactAnalysis_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,5v9H4v-2H2v-2H0V1h10.258C9.898,1.104,9.549,1.24,9.211,1.406C8.878,1.573,8.56,1.771,8.258,2H1v7h10V5\r\n\th0.5L12,5.5V10H3v1h10V6l1-1v7H5v1h10V5H16z M7,7c0-0.458,0.06-0.901,0.18-1.328c0.12-0.427,0.286-0.826,0.5-1.195\r\n\tc0.219-0.37,0.479-0.706,0.781-1.008c0.307-0.307,0.646-0.568,1.016-0.781c0.37-0.219,0.768-0.388,1.195-0.508\r\n\tC11.099,2.06,11.542,2,12,2h1.289l-1.141-1.148l0.703-0.703L15.203,2.5l-2.352,2.352l-0.703-0.703L13.289,3H12\r\n\tc-0.552,0-1.07,0.107-1.555,0.32C9.961,3.529,9.536,3.815,9.172,4.18C8.812,4.539,8.526,4.961,8.312,5.445C8.104,5.93,8,6.448,8,7H7\r\n\tz"},{type:"path",className:"OfficeIconColors_m20",d:"M5.75,8.25V7c0-0.569,0.075-1.125,0.226-1.666c0.147-0.524,0.353-1.019,0.621-1.483L6.604,3.84\r\n\tC6.876,3.381,7.2,2.961,7.577,2.585C7.789,2.373,8.014,2.178,8.252,2H1v7h10V5h-0.879c-0.022,0.021-0.044,0.042-0.066,0.064\r\n\tC9.812,5.308,9.612,5.598,9.459,5.944C9.322,6.264,9.25,6.612,9.25,7v1.25H5.75z M5,12v1h10V6h-1v6H5z M12,10V6h1v5H3v-1H12z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,5v9H4v-2H2v-2H0V1h10.258C9.898,1.104,9.549,1.24,9.211,1.406C8.878,1.573,8.56,1.771,8.258,2H1v7h10V5\r\n\th0.5L12,5.5V10H3v1h10V6l1-1v7H5v1h10V5H16z"},{type:"path",className:"OfficeIconColors_m24",d:"M7,7c0-0.458,0.06-0.901,0.18-1.328c0.12-0.427,0.286-0.826,0.5-1.195c0.219-0.37,0.479-0.706,0.781-1.008\r\n\tc0.307-0.307,0.646-0.568,1.016-0.781c0.37-0.219,0.768-0.388,1.195-0.508C11.099,2.06,11.542,2,12,2h1.289l-1.141-1.148\r\n\tl0.703-0.703L15.203,2.5l-2.352,2.352l-0.703-0.703L13.289,3H12c-0.552,0-1.07,0.107-1.555,0.32C9.961,3.529,9.536,3.815,9.172,4.18\r\n\tC8.812,4.539,8.526,4.961,8.312,5.445C8.104,5.93,8,6.448,8,7H7z"}],viewBox:"0 0 16 16"},{type:"svg",id:"AutoCreateReport_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.758,6L13.9,9H16l-5.25,7H8.688l2-4h-2l3.023-6H15.758z M14,10h-1.9l1.859-3h-1.631l-2.016,4h2\r\n\tl-1.882,3.766L14,10z M9,1v8.158l-1,1.984V0h3v5.189l-1,1.984V1H9z M13,4v1h-1V3h3v2h-1V4H13z M0,13h3V8H0V13z M1,9h1v3H1V9z M7,13\r\n\tH4V3h3V13z M6,4H5v8h1V4z"},{type:"path",className:"OfficeIconColors_m212",d:"M14,10h-1.9l1.859-3h-1.631l-2.016,4h2l-1.882,3.766L14,10z"},{type:"path",className:"OfficeIconColors_m211",d:"M15.758,6L13.9,9H16l-5.25,7H8.688l2-4h-2l3.023-6H15.758z M14,10h-1.9l1.859-3h-1.631l-2.016,4h2\r\n\tl-1.882,3.766L14,10z"},{type:"path",className:"OfficeIconColors_m20",d:"M1,9h1v3H1V9z M6,4H5v8h1V4z M9,9.158V1h1v6.173L9,9.158z M13,5V4\r\n\th1v1H13z"},{type:"path",className:"OfficeIconColors_m22",d:"M9,1v8.158l-1,1.984V0h3v5.189l-1,1.984V1H9z M13,4v1h-1V3h3v2h-1V4H13z M0,13h3V8H0V13z M1,9h1v3H1V9z\r\n\t M7,13H4V3h3V13z M6,4H5v8h1V4z"}],viewBox:"0 0 16 16"},{type:"svg",id:"PaginatedReport_16",children:[{type:"path",d:"M5,1C3.895,1,3,1.895,3,3V13C3,14.105,3.895,15,5,15H11C12.105,15,13,14.105,13,13V5.414C13,5.016,12.842,4.635,12.561,4.353L9.647,1.439C9.366,1.158,8.984,1,8.586,1H5ZM4,3C4,2.448,4.448,2,5,2H8V4.5C8,5.328,8.672,6,9.5,6H12V13C12,13.552,11.552,14,11,14H5C4.448,14,4,13.552,4,13V3ZM11.793,5H9.5C9.224,5,9,4.776,9,4.5V2.207L11.793,5ZM8,13C7.724,13,7.5,12.776,7.5,12.5V7.5C7.5,7.224,7.724,7,8,7C8.276,7,8.5,7.224,8.5,7.5V12.5C8.5,12.776,8.276,13,8,13ZM10.5,13C10.224,13,10,12.776,10,12.5V9.5C10,9.224,10.224,9,10.5,9C10.776,9,11,9.224,11,9.5V12.5C11,12.776,10.776,13,10.5,13ZM5.5,13C5.224,13,5,12.776,5,12.5V10.5C5,10.224,5.224,10,5.5,10C5.776,10,6,10.224,6,10.5V12.5C6,12.776,5.776,13,5.5,13Z"}],viewBox:"0 0 16 16"},{type:"svg",id:"CloudImportExport_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M12.727,6.008c0.458,0.031,0.887,0.144,1.285,0.336c0.398,0.193,0.745,0.447,1.039,0.762\r\n\tc0.294,0.315,0.526,0.679,0.695,1.09S16,9.042,16,9.5c0,0.484-0.093,0.939-0.277,1.363c-0.185,0.425-0.435,0.795-0.75,1.109\r\n\tc-0.315,0.315-0.685,0.565-1.109,0.75C13.438,12.908,12.984,13,12.5,13H12v-1h0.5c0.344,0,0.668-0.064,0.973-0.195\r\n\tc0.305-0.13,0.57-0.309,0.797-0.535s0.405-0.492,0.535-0.797S15,9.844,15,9.5s-0.065-0.668-0.195-0.973s-0.309-0.57-0.535-0.797\r\n\ts-0.492-0.405-0.797-0.535C13.168,7.065,12.844,7,12.5,7c-0.094,0-0.187,0.005-0.277,0.016c-0.091,0.011-0.181,0.026-0.27,0.047\r\n\tc-0.052-0.438-0.18-0.842-0.383-1.215c-0.203-0.372-0.458-0.695-0.766-0.969S10.146,4.391,9.75,4.234S8.938,4,8.5,4\r\n\tC8.136,4,7.784,4.055,7.445,4.164S6.796,4.427,6.512,4.625S5.977,5.062,5.758,5.34C5.539,5.619,5.364,5.93,5.234,6.273\r\n\tC4.844,6.091,4.432,6,4,6C3.583,6,3.194,6.078,2.832,6.234C2.47,6.391,2.152,6.605,1.879,6.879S1.391,7.472,1.234,7.836\r\n\tC1.078,8.201,1,8.589,1,9c0,0.318,0.048,0.623,0.145,0.914c0.096,0.292,0.231,0.562,0.406,0.809\r\n\tc0.174,0.248,0.385,0.465,0.633,0.652c0.247,0.188,0.52,0.334,0.816,0.438v1.047c-0.438-0.114-0.84-0.294-1.207-0.539\r\n\tc-0.367-0.244-0.684-0.537-0.949-0.879c-0.266-0.341-0.473-0.72-0.621-1.137C0.074,9.889,0,9.453,0,9\r\n\tc0-0.552,0.105-1.07,0.316-1.555s0.497-0.907,0.859-1.27c0.362-0.362,0.785-0.648,1.27-0.859S3.448,5,4,5\r\n\tc0.239,0,0.481,0.023,0.727,0.07c0.208-0.317,0.45-0.604,0.727-0.859c0.275-0.255,0.575-0.473,0.898-0.652s0.667-0.317,1.031-0.414\r\n\tC7.747,3.048,8.12,3,8.5,3c0.474,0,0.931,0.073,1.371,0.219c0.44,0.146,0.847,0.351,1.219,0.613c0.372,0.263,0.699,0.58,0.98,0.949\r\n\tC12.352,5.151,12.57,5.56,12.727,6.008z M7,13.289l1.148-1.141l0.703,0.703L6.5,15.203l-2.352-2.352l0.703-0.703L6,13.289V8h1\r\n\tV13.289z M12.148,10.852L11,9.711V15h-1V9.711l-1.148,1.141l-0.703-0.703L10.5,7.797l2.352,2.352L12.148,10.852z"},{type:"path",className:"OfficeIconColors_m20",d:"M15.5,9.5c0,0.409-0.079,0.803-0.235,1.169c-0.154,0.361-0.37,0.683-0.642,0.954s-0.593,0.487-0.954,0.642\r\n\tC13.306,12.421,12.912,12.5,12.5,12.5H12v-0.386l0.151,0.15l2.115-2.115L10.5,6.383L8,8.883V7H5v3.886l-0.151-0.15l-1.661,1.661\r\n\tc-0.19-0.045-0.377-0.096-0.554-0.173c-0.418-0.181-0.791-0.433-1.108-0.75s-0.569-0.69-0.75-1.108C0.593,9.943,0.5,9.484,0.5,9\r\n\tc0-0.478,0.093-0.936,0.274-1.361c0.182-0.422,0.434-0.797,0.751-1.114s0.69-0.57,1.108-0.75C3.347,5.467,4.199,5.412,4.972,5.64\r\n\tc0.112-0.216,0.244-0.419,0.393-0.609C5.613,4.714,5.903,4.44,6.226,4.215s0.682-0.402,1.066-0.527\r\n\tc0.895-0.29,1.914-0.241,2.769,0.126c0.48,0.207,0.907,0.495,1.269,0.855c0.362,0.362,0.649,0.789,0.856,1.27\r\n\tc0.075,0.176,0.135,0.361,0.183,0.564c0.452-0.019,0.896,0.06,1.301,0.232c0.362,0.155,0.684,0.371,0.954,0.642\r\n\tc0.271,0.271,0.487,0.593,0.642,0.954C15.421,8.698,15.5,9.091,15.5,9.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M12.727,6.008c0.458,0.031,0.887,0.144,1.285,0.336c0.398,0.193,0.745,0.447,1.039,0.762\r\n\tc0.294,0.315,0.526,0.679,0.695,1.09S16,9.042,16,9.5c0,0.484-0.093,0.939-0.277,1.363c-0.185,0.425-0.435,0.795-0.75,1.109\r\n\tc-0.315,0.315-0.685,0.565-1.109,0.75C13.438,12.908,12.984,13,12.5,13H12v-1h0.5c0.344,0,0.668-0.064,0.973-0.195\r\n\tc0.305-0.13,0.57-0.309,0.797-0.535s0.405-0.492,0.535-0.797S15,9.844,15,9.5s-0.065-0.668-0.195-0.973s-0.309-0.57-0.535-0.797\r\n\ts-0.492-0.405-0.797-0.535C13.168,7.065,12.844,7,12.5,7c-0.094,0-0.187,0.005-0.277,0.016c-0.091,0.011-0.181,0.026-0.27,0.047\r\n\tc-0.052-0.438-0.18-0.842-0.383-1.215c-0.203-0.372-0.458-0.695-0.766-0.969S10.146,4.391,9.75,4.234S8.938,4,8.5,4\r\n\tC8.136,4,7.784,4.055,7.445,4.164S6.796,4.427,6.512,4.625S5.977,5.062,5.758,5.34C5.539,5.619,5.364,5.93,5.234,6.273\r\n\tC4.844,6.091,4.432,6,4,6C3.583,6,3.194,6.078,2.832,6.234C2.47,6.391,2.152,6.605,1.879,6.879S1.391,7.472,1.234,7.836\r\n\tC1.078,8.201,1,8.589,1,9c0,0.318,0.048,0.623,0.145,0.914c0.096,0.292,0.231,0.562,0.406,0.809\r\n\tc0.174,0.248,0.385,0.465,0.633,0.652c0.247,0.188,0.52,0.334,0.816,0.438v1.047c-0.438-0.114-0.84-0.294-1.207-0.539\r\n\tc-0.367-0.244-0.684-0.537-0.949-0.879c-0.266-0.341-0.473-0.72-0.621-1.137C0.074,9.889,0,9.453,0,9\r\n\tc0-0.552,0.105-1.07,0.316-1.555s0.497-0.907,0.859-1.27c0.362-0.362,0.785-0.648,1.27-0.859S3.448,5,4,5\r\n\tc0.239,0,0.481,0.023,0.727,0.07c0.208-0.317,0.45-0.604,0.727-0.859c0.275-0.255,0.575-0.473,0.898-0.652s0.667-0.317,1.031-0.414\r\n\tC7.747,3.048,8.12,3,8.5,3c0.474,0,0.931,0.073,1.371,0.219c0.44,0.146,0.847,0.351,1.219,0.613c0.372,0.263,0.699,0.58,0.98,0.949\r\n\tC12.352,5.151,12.57,5.56,12.727,6.008z"},{type:"path",className:"OfficeIconColors_m24",d:"M7,13.289l1.148-1.141l0.703,0.703L6.5,15.203l-2.352-2.352l0.703-0.703L6,13.289V8h1V13.289z\r\n\t M12.148,10.852L11,9.711V15h-1V9.711l-1.148,1.141l-0.703-0.703L10.5,7.797l2.352,2.352L12.148,10.852z"}],viewBox:"0 0 16 16"},{type:"svg",id:"GenericScan_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M0,5V1h4v1H1v3H0z M1,11v3h3v1H0v-4H1z M3,11V5h1v6H3z M6,11V5h1v6H6z M9,11V5h1v6H9z M12,1h4v4h-1V2h-3V1z\r\n\t M13,5v6h-1V5H13z M15,14v-3h1v4h-4v-1H15z"},{type:"path",className:"OfficeIconColors_m22",d:"M0,5V1h4v1H1v3H0z M1,11v3h3v1H0v-4H1z M3,11V5h1v6H3z M6,11V5h1v6H6z M9,11V5h1v6H9z M12,1h4v4h-1V2h-3V1z\r\n\t M13,5v6h-1V5H13z M15,14v-3h1v4h-4v-1H15z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Key_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M16,12.289V16h-4v-2h-2v-2H8v-1.617c-0.386,0.203-0.789,0.357-1.211,0.461C6.367,10.948,5.938,11,5.5,11\r\n\tc-0.505,0-0.992-0.064-1.461-0.195c-0.469-0.13-0.906-0.314-1.312-0.555C2.32,10.011,1.949,9.723,1.613,9.387S0.989,8.68,0.75,8.273\r\n\tC0.51,7.867,0.325,7.43,0.195,6.961C0.065,6.492,0,6.005,0,5.5c0-0.505,0.065-0.992,0.195-1.461C0.325,3.57,0.51,3.133,0.75,2.727\r\n\tC0.989,2.32,1.277,1.949,1.613,1.613S2.32,0.99,2.727,0.75C3.133,0.511,3.57,0.326,4.039,0.195C4.508,0.065,4.995,0,5.5,0\r\n\tc0.505,0,0.992,0.065,1.461,0.195C7.43,0.326,7.867,0.511,8.273,0.75C8.68,0.99,9.051,1.277,9.387,1.613s0.624,0.707,0.863,1.113\r\n\ts0.425,0.844,0.555,1.312S11,4.995,11,5.5c0,0.266-0.021,0.529-0.062,0.789c-0.042,0.261-0.102,0.516-0.18,0.766L16,12.289z\r\n\t M15,12.711L9.609,7.32c0.114-0.297,0.208-0.595,0.281-0.895C9.963,6.126,10,5.818,10,5.5c0-0.62-0.119-1.203-0.355-1.75\r\n\tC9.407,3.203,9.086,2.727,8.68,2.32S7.797,1.593,7.25,1.355C6.703,1.119,6.12,1,5.5,1C4.88,1,4.297,1.119,3.75,1.355\r\n\tC3.203,1.593,2.727,1.914,2.32,2.32S1.592,3.203,1.355,3.75C1.118,4.297,1,4.88,1,5.5c0,0.62,0.118,1.203,0.355,1.75\r\n\tC1.592,7.797,1.914,8.273,2.32,8.68s0.883,0.729,1.43,0.965C4.297,9.882,4.88,10,5.5,10c0.505,0,1.001-0.086,1.488-0.258\r\n\tC7.475,9.57,7.914,9.323,8.305,9H9v2h2v2h2v2h2V12.711z M4,3c0.141,0,0.271,0.026,0.391,0.078C4.51,3.13,4.616,3.202,4.707,3.293\r\n\tC4.798,3.384,4.87,3.49,4.922,3.609C4.974,3.729,5,3.859,5,4S4.974,4.271,4.922,4.391C4.87,4.511,4.798,4.616,4.707,4.707\r\n\tC4.616,4.798,4.51,4.87,4.391,4.922C4.271,4.974,4.141,5,4,5S3.729,4.974,3.609,4.922C3.489,4.87,3.384,4.798,3.293,4.707\r\n\tC3.202,4.616,3.13,4.511,3.078,4.391C3.026,4.271,3,4.141,3,4s0.026-0.271,0.078-0.391C3.13,3.49,3.202,3.384,3.293,3.293\r\n\tC3.384,3.202,3.489,3.13,3.609,3.078C3.729,3.026,3.859,3,4,3z"},{type:"path",className:"OfficeIconColors_m20",d:"M10.188,7.191c0.073-0.215,0.136-0.431,0.189-0.647C10.458,6.207,10.5,5.855,10.5,5.5\r\n\tc0-0.685-0.133-1.341-0.397-1.949c-0.261-0.603-0.622-1.136-1.07-1.584s-0.981-0.809-1.584-1.07c-1.216-0.526-2.681-0.527-3.898,0\r\n\tc-0.603,0.261-1.136,0.622-1.584,1.07c-0.449,0.449-0.81,0.982-1.07,1.584C0.633,4.158,0.5,4.813,0.5,5.5s0.133,1.342,0.396,1.949\r\n\tc0.261,0.602,0.621,1.135,1.07,1.584c0.45,0.45,0.983,0.811,1.584,1.07c1.101,0.477,2.404,0.532,3.604,0.11\r\n\tc0.482-0.17,0.927-0.41,1.324-0.714l0.021,2h2v2h2v2h3v-2.996L10.188,7.191z"},{type:"path",className:"OfficeIconColors_m22",d:"M16,12.289V16h-4v-2h-2v-2H8v-1.617c-0.386,0.203-0.789,0.357-1.211,0.461C6.367,10.948,5.938,11,5.5,11\r\n\tc-0.505,0-0.992-0.064-1.461-0.195c-0.469-0.13-0.906-0.314-1.312-0.555C2.32,10.011,1.949,9.723,1.613,9.387S0.989,8.68,0.75,8.273\r\n\tC0.51,7.867,0.325,7.43,0.195,6.961C0.065,6.492,0,6.005,0,5.5c0-0.505,0.065-0.992,0.195-1.461C0.325,3.57,0.51,3.133,0.75,2.727\r\n\tC0.989,2.32,1.277,1.949,1.613,1.613S2.32,0.99,2.727,0.75C3.133,0.511,3.57,0.326,4.039,0.195C4.508,0.065,4.995,0,5.5,0\r\n\tc0.505,0,0.992,0.065,1.461,0.195C7.43,0.326,7.867,0.511,8.273,0.75C8.68,0.99,9.051,1.277,9.387,1.613s0.624,0.707,0.863,1.113\r\n\ts0.425,0.844,0.555,1.312S11,4.995,11,5.5c0,0.266-0.021,0.529-0.062,0.789c-0.042,0.261-0.102,0.516-0.18,0.766L16,12.289z\r\n\t M15,12.711L9.609,7.32c0.114-0.297,0.208-0.595,0.281-0.895C9.963,6.126,10,5.818,10,5.5c0-0.62-0.119-1.203-0.355-1.75\r\n\tC9.407,3.203,9.086,2.727,8.68,2.32S7.797,1.593,7.25,1.355C6.703,1.119,6.12,1,5.5,1C4.88,1,4.297,1.119,3.75,1.355\r\n\tC3.203,1.593,2.727,1.914,2.32,2.32S1.592,3.203,1.355,3.75C1.118,4.297,1,4.88,1,5.5c0,0.62,0.118,1.203,0.355,1.75\r\n\tC1.592,7.797,1.914,8.273,2.32,8.68s0.883,0.729,1.43,0.965C4.297,9.882,4.88,10,5.5,10c0.505,0,1.001-0.086,1.488-0.258\r\n\tC7.475,9.57,7.914,9.323,8.305,9H9v2h2v2h2v2h2V12.711z M4,3c0.141,0,0.271,0.026,0.391,0.078C4.51,3.13,4.616,3.202,4.707,3.293\r\n\tC4.798,3.384,4.87,3.49,4.922,3.609C4.974,3.729,5,3.859,5,4S4.974,4.271,4.922,4.391C4.87,4.511,4.798,4.616,4.707,4.707\r\n\tC4.616,4.798,4.51,4.87,4.391,4.922C4.271,4.974,4.141,5,4,5S3.729,4.974,3.609,4.922C3.489,4.87,3.384,4.798,3.293,4.707\r\n\tC3.202,4.616,3.13,4.511,3.078,4.391C3.026,4.271,3,4.141,3,4s0.026-0.271,0.078-0.391C3.13,3.49,3.202,3.384,3.293,3.293\r\n\tC3.384,3.202,3.489,3.13,3.609,3.078C3.729,3.026,3.859,3,4,3z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Repair_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M15.078,1.719c0.137,0.234,0.26,0.458,0.371,0.672c0.113,0.214,0.211,0.43,0.293,0.648\r\n\tc0.084,0.219,0.148,0.447,0.191,0.684C15.979,3.96,16,4.219,16,4.5c0,0.412-0.053,0.809-0.16,1.191\r\n\tc-0.105,0.383-0.258,0.741-0.453,1.074c-0.195,0.333-0.43,0.638-0.707,0.914c-0.275,0.276-0.58,0.512-0.914,0.707\r\n\tc-0.332,0.195-0.691,0.347-1.074,0.453C12.309,8.947,11.912,9,11.5,9c-0.119,0-0.24-0.005-0.363-0.016\r\n\tc-0.121-0.01-0.242-0.026-0.363-0.047l-6.297,6.297c-0.25,0.25-0.535,0.44-0.855,0.57S2.966,16,2.617,16\r\n\tc-0.359,0-0.698-0.069-1.016-0.207c-0.318-0.138-0.595-0.325-0.832-0.562c-0.237-0.237-0.425-0.515-0.562-0.832\r\n\tC0.069,14.081,0,13.742,0,13.383c0-0.349,0.065-0.684,0.195-1.004c0.13-0.32,0.32-0.605,0.57-0.855l6.297-6.297\r\n\tc-0.021-0.12-0.037-0.241-0.047-0.363C7.005,4.741,7,4.62,7,4.5c0-0.411,0.053-0.809,0.16-1.191\r\n\tc0.106-0.383,0.258-0.741,0.453-1.074C7.809,1.901,8.044,1.597,8.32,1.32c0.276-0.276,0.581-0.512,0.914-0.707\r\n\tc0.334-0.195,0.691-0.346,1.074-0.453C10.691,0.054,11.09,0,11.5,0c0.281,0,0.541,0.022,0.777,0.066\r\n\tc0.238,0.044,0.465,0.108,0.684,0.191c0.219,0.083,0.436,0.181,0.648,0.293c0.215,0.112,0.438,0.236,0.672,0.371L11.203,4L12,4.797\r\n\tL15.078,1.719z M11.5,8c0.484,0,0.939-0.092,1.363-0.277c0.426-0.185,0.795-0.435,1.109-0.75c0.316-0.315,0.566-0.685,0.75-1.109\r\n\tC14.908,5.439,15,4.984,15,4.5c0-0.38-0.062-0.747-0.188-1.102L12,6.203L9.797,4l2.805-2.812C12.248,1.062,11.881,1,11.5,1\r\n\tc-0.484,0-0.938,0.093-1.363,0.277c-0.424,0.185-0.793,0.435-1.109,0.75c-0.315,0.315-0.565,0.685-0.75,1.109\r\n\tC8.092,3.562,8,4.016,8,4.5c0,0.183,0.016,0.359,0.047,0.531s0.067,0.344,0.109,0.516l-6.68,6.688\r\n\tc-0.151,0.151-0.269,0.326-0.352,0.523C1.042,12.956,1,13.164,1,13.383s0.043,0.428,0.129,0.625c0.086,0.198,0.202,0.37,0.348,0.516\r\n\tc0.146,0.146,0.317,0.262,0.516,0.348C2.19,14.957,2.398,15,2.617,15s0.427-0.042,0.625-0.125c0.198-0.083,0.372-0.2,0.523-0.352\r\n\tl6.688-6.68c0.172,0.042,0.344,0.078,0.516,0.109S11.318,8,11.5,8z"},{type:"path",className:"OfficeIconColors_m20",d:"M15.5,4.5c0,0.553-0.107,1.079-0.319,1.563c-0.207,0.479-0.495,0.905-0.855,1.264\r\n\tc-0.356,0.358-0.782,0.646-1.263,0.854c-0.67,0.292-1.457,0.396-2.184,0.263C10.79,8.429,10.7,8.411,10.611,8.393l-6.492,6.484\r\n\tc-0.196,0.196-0.426,0.351-0.683,0.459C3.176,15.445,2.9,15.5,2.617,15.5c-0.287,0-0.565-0.058-0.824-0.171\r\n\tc-0.254-0.109-0.479-0.262-0.67-0.452c-0.188-0.188-0.342-0.413-0.453-0.67C0.558,13.948,0.5,13.67,0.5,13.383\r\n\tc0-0.286,0.056-0.562,0.165-0.82c0.107-0.256,0.262-0.485,0.458-0.682l6.484-6.492C7.589,5.299,7.571,5.21,7.555,5.121\r\n\tC7.519,4.92,7.5,4.713,7.5,4.5c0-0.553,0.107-1.079,0.319-1.563c0.209-0.479,0.497-0.904,0.854-1.262\r\n\tc0.361-0.359,0.786-0.646,1.264-0.855c0.877-0.381,1.913-0.428,2.832-0.103l0.746,0.264L10.504,4l1.497,1.497l3.02-3.012\r\n\tl0.264,0.747C15.428,3.639,15.5,4.065,15.5,4.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M15.078,1.719c0.137,0.234,0.26,0.458,0.371,0.672c0.113,0.214,0.211,0.43,0.293,0.648\r\n\tc0.084,0.219,0.148,0.447,0.191,0.684C15.979,3.96,16,4.219,16,4.5c0,0.412-0.053,0.809-0.16,1.191\r\n\tc-0.105,0.383-0.258,0.741-0.453,1.074c-0.195,0.333-0.43,0.638-0.707,0.914c-0.275,0.276-0.58,0.512-0.914,0.707\r\n\tc-0.332,0.195-0.691,0.347-1.074,0.453C12.309,8.947,11.912,9,11.5,9c-0.119,0-0.24-0.005-0.363-0.016\r\n\tc-0.121-0.01-0.242-0.026-0.363-0.047l-6.297,6.297c-0.25,0.25-0.535,0.44-0.855,0.57S2.966,16,2.617,16\r\n\tc-0.359,0-0.698-0.069-1.016-0.207c-0.318-0.138-0.595-0.325-0.832-0.562c-0.237-0.237-0.425-0.515-0.562-0.832\r\n\tC0.069,14.081,0,13.742,0,13.383c0-0.349,0.065-0.684,0.195-1.004c0.13-0.32,0.32-0.605,0.57-0.855l6.297-6.297\r\n\tc-0.021-0.12-0.037-0.241-0.047-0.363C7.005,4.741,7,4.62,7,4.5c0-0.411,0.053-0.809,0.16-1.191\r\n\tc0.106-0.383,0.258-0.741,0.453-1.074C7.809,1.901,8.044,1.597,8.32,1.32c0.276-0.276,0.581-0.512,0.914-0.707\r\n\tc0.334-0.195,0.691-0.346,1.074-0.453C10.691,0.054,11.09,0,11.5,0c0.281,0,0.541,0.022,0.777,0.066\r\n\tc0.238,0.044,0.465,0.108,0.684,0.191c0.219,0.083,0.436,0.181,0.648,0.293c0.215,0.112,0.438,0.236,0.672,0.371L11.203,4L12,4.797\r\n\tL15.078,1.719z M11.5,8c0.484,0,0.939-0.092,1.363-0.277c0.426-0.185,0.795-0.435,1.109-0.75c0.316-0.315,0.566-0.685,0.75-1.109\r\n\tC14.908,5.439,15,4.984,15,4.5c0-0.38-0.062-0.747-0.188-1.102L12,6.203L9.797,4l2.805-2.812C12.248,1.062,11.881,1,11.5,1\r\n\tc-0.484,0-0.938,0.093-1.363,0.277c-0.424,0.185-0.793,0.435-1.109,0.75c-0.315,0.315-0.565,0.685-0.75,1.109\r\n\tC8.092,3.562,8,4.016,8,4.5c0,0.183,0.016,0.359,0.047,0.531s0.067,0.344,0.109,0.516l-6.68,6.688\r\n\tc-0.151,0.151-0.269,0.326-0.352,0.523C1.042,12.956,1,13.164,1,13.383s0.043,0.428,0.129,0.625c0.086,0.198,0.202,0.37,0.348,0.516\r\n\tc0.146,0.146,0.317,0.262,0.516,0.348C2.19,14.957,2.398,15,2.617,15s0.427-0.042,0.625-0.125c0.198-0.083,0.372-0.2,0.523-0.352\r\n\tl6.688-6.68c0.172,0.042,0.344,0.078,0.516,0.109S11.318,8,11.5,8z"}],viewBox:"0 0 16 16"},{type:"svg",id:"Unknown_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M14.703,5.516c-0.178-0.635-0.429-1.23-0.754-1.785c-0.326-0.555-0.715-1.059-1.168-1.512\r\n\ts-0.957-0.842-1.512-1.168c-0.555-0.325-1.15-0.577-1.785-0.754C8.849,0.12,8.188,0.031,7.5,0.031S6.151,0.12,5.516,0.297\r\n\tC4.88,0.474,4.285,0.726,3.73,1.051C3.176,1.376,2.672,1.766,2.219,2.219S1.376,3.176,1.051,3.73\r\n\tC0.725,4.285,0.474,4.88,0.297,5.516C0.12,6.151,0.031,6.812,0.031,7.5S0.12,8.849,0.297,9.484c0.177,0.636,0.428,1.23,0.754,1.785\r\n\tc0.325,0.555,0.715,1.059,1.168,1.512s0.957,0.843,1.512,1.168c0.555,0.326,1.149,0.577,1.785,0.754\r\n\tc0.635,0.178,1.297,0.266,1.984,0.266s1.349-0.088,1.984-0.266c0.635-0.177,1.23-0.428,1.785-0.754\r\n\tc0.555-0.325,1.059-0.715,1.512-1.168s0.842-0.957,1.168-1.512c0.325-0.555,0.576-1.149,0.754-1.785\r\n\tc0.177-0.635,0.266-1.297,0.266-1.984S14.88,6.151,14.703,5.516z M13.797,9.234c-0.156,0.558-0.377,1.078-0.66,1.562\r\n\tc-0.284,0.484-0.624,0.925-1.02,1.32c-0.396,0.396-0.836,0.736-1.32,1.02c-0.484,0.284-1.006,0.504-1.562,0.66\r\n\tc-0.558,0.156-1.136,0.234-1.734,0.234c-0.599,0-1.177-0.078-1.734-0.234c-0.558-0.156-1.078-0.376-1.562-0.66\r\n\tc-0.484-0.283-0.925-0.623-1.32-1.02c-0.396-0.396-0.736-0.836-1.02-1.32c-0.284-0.484-0.504-1.005-0.66-1.562\r\n\tC1.047,8.677,0.969,8.099,0.969,7.5c0-0.599,0.078-1.177,0.234-1.734c0.156-0.557,0.376-1.078,0.66-1.562\r\n\tc0.284-0.484,0.624-0.924,1.02-1.32c0.396-0.396,0.836-0.735,1.32-1.02c0.484-0.284,1.005-0.504,1.562-0.66\r\n\tC6.323,1.047,6.901,0.969,7.5,0.969c0.599,0,1.177,0.078,1.734,0.234c0.557,0.156,1.078,0.376,1.562,0.66\r\n\tc0.484,0.284,0.924,0.624,1.32,1.02c0.396,0.396,0.735,0.836,1.02,1.32c0.283,0.484,0.504,1.005,0.66,1.562\r\n\tc0.156,0.558,0.234,1.136,0.234,1.734C14.031,8.099,13.953,8.677,13.797,9.234z M7,11h1v1H7V11z M9.801,5.031\r\n\tC9.934,5.333,10,5.656,10,6c0,0.312-0.05,0.585-0.148,0.816c-0.1,0.232-0.223,0.441-0.371,0.629S9.172,7.804,9,7.957\r\n\tC8.828,8.111,8.668,8.265,8.52,8.418C8.371,8.572,8.247,8.736,8.148,8.91C8.049,9.085,8,9.281,8,9.5V10H7V9.5\r\n\tc0-0.312,0.049-0.584,0.148-0.816C7.247,8.452,7.371,8.242,7.52,8.055S7.828,7.697,8,7.543C8.172,7.39,8.332,7.236,8.48,7.082\r\n\tc0.148-0.153,0.272-0.316,0.371-0.488C8.95,6.422,9,6.224,9,6c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.185-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.294-0.242-0.477-0.32C7.903,4.539,7.708,4.5,7.5,4.5c-0.208,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.341,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C6.039,5.597,6,5.792,6,6H5\r\n\tc0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539S7.156,3.5,7.5,3.5\r\n\ts0.667,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539S9.668,4.729,9.801,5.031z"},{type:"path",className:"OfficeIconColors_m20",d:"M14.531,7.5c0,0.642-0.085,1.271-0.253,1.869c-0.166,0.594-0.405,1.159-0.71,1.68\r\n\tc-0.306,0.521-0.675,0.999-1.098,1.422c-0.426,0.426-0.904,0.795-1.422,1.098c-0.517,0.303-1.082,0.542-1.68,0.71\r\n\tc-0.599,0.168-1.228,0.253-1.869,0.253c-0.643,0-1.271-0.085-1.869-0.253c-0.597-0.167-1.162-0.406-1.681-0.71\r\n\tc-0.52-0.304-0.998-0.674-1.421-1.098c-0.424-0.423-0.794-0.901-1.098-1.422c-0.304-0.518-0.543-1.083-0.71-1.68\r\n\tC0.554,8.771,0.469,8.142,0.469,7.5c0-0.642,0.085-1.271,0.253-1.869C0.89,5.033,1.128,4.468,1.432,3.95\r\n\tc0.304-0.518,0.673-0.997,1.098-1.421C2.952,2.106,3.431,1.737,3.95,1.432c0.521-0.305,1.085-0.544,1.681-0.71\r\n\tc1.194-0.336,2.54-0.336,3.738,0c0.597,0.167,1.161,0.406,1.681,0.71c0.518,0.304,0.995,0.673,1.421,1.097\r\n\tc0.424,0.425,0.793,0.903,1.098,1.421c0.305,0.521,0.543,1.086,0.71,1.68C14.446,6.229,14.531,6.858,14.531,7.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M7.5,0.031c0.688,0,1.349,0.089,1.984,0.266c0.635,0.177,1.23,0.429,1.785,0.754\r\n\tc0.555,0.326,1.059,0.715,1.512,1.168s0.842,0.957,1.168,1.512c0.325,0.555,0.576,1.15,0.754,1.785\r\n\tc0.177,0.636,0.266,1.297,0.266,1.984s-0.089,1.349-0.266,1.984c-0.178,0.636-0.429,1.23-0.754,1.785\r\n\tc-0.326,0.555-0.715,1.059-1.168,1.512s-0.957,0.843-1.512,1.168c-0.555,0.326-1.15,0.577-1.785,0.754\r\n\tc-0.636,0.178-1.297,0.266-1.984,0.266s-1.349-0.088-1.984-0.266c-0.636-0.177-1.23-0.428-1.785-0.754\r\n\tc-0.555-0.325-1.059-0.715-1.512-1.168s-0.843-0.957-1.168-1.512c-0.326-0.555-0.577-1.149-0.754-1.785\r\n\tC0.12,8.849,0.031,8.188,0.031,7.5S0.12,6.151,0.297,5.516C0.474,4.88,0.725,4.285,1.051,3.73c0.325-0.555,0.715-1.059,1.168-1.512\r\n\tS3.176,1.376,3.73,1.051C4.285,0.726,4.88,0.474,5.516,0.297C6.151,0.12,6.812,0.031,7.5,0.031z M7.5,14.031\r\n\tc0.599,0,1.177-0.078,1.734-0.234c0.557-0.156,1.078-0.376,1.562-0.66c0.484-0.283,0.924-0.623,1.32-1.02\r\n\tc0.396-0.396,0.735-0.836,1.02-1.32c0.283-0.484,0.504-1.005,0.66-1.562c0.156-0.557,0.234-1.135,0.234-1.734\r\n\tc0-0.599-0.078-1.177-0.234-1.734c-0.156-0.557-0.377-1.078-0.66-1.562c-0.284-0.484-0.624-0.924-1.02-1.32\r\n\tc-0.396-0.396-0.836-0.735-1.32-1.02c-0.484-0.284-1.006-0.504-1.562-0.66C8.677,1.047,8.099,0.969,7.5,0.969\r\n\tc-0.599,0-1.177,0.078-1.734,0.234C5.208,1.359,4.688,1.58,4.203,1.863c-0.484,0.284-0.925,0.624-1.32,1.02\r\n\tc-0.396,0.396-0.736,0.836-1.02,1.32c-0.284,0.484-0.504,1.005-0.66,1.562C1.047,6.323,0.969,6.901,0.969,7.5\r\n\tc0,0.599,0.078,1.177,0.234,1.734c0.156,0.558,0.376,1.078,0.66,1.562c0.284,0.484,0.624,0.925,1.02,1.32\r\n\tc0.396,0.396,0.836,0.736,1.32,1.02c0.484,0.284,1.005,0.504,1.562,0.66C6.323,13.953,6.901,14.031,7.5,14.031z"},{type:"path",className:"OfficeIconColors_m24",d:"M7.5,3.5c0.344,0,0.667,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539s0.406,0.491,0.539,0.793\r\n\tC9.934,5.333,10,5.656,10,6c0,0.312-0.05,0.585-0.148,0.816c-0.1,0.232-0.223,0.441-0.371,0.629S9.172,7.804,9,7.957\r\n\tC8.828,8.111,8.668,8.265,8.52,8.418C8.371,8.572,8.247,8.736,8.148,8.91C8.049,9.085,8,9.281,8,9.5V10H7V9.5\r\n\tc0-0.312,0.049-0.584,0.148-0.816C7.247,8.452,7.371,8.242,7.52,8.055S7.828,7.697,8,7.543C8.172,7.39,8.332,7.236,8.48,7.082\r\n\tc0.148-0.153,0.272-0.316,0.371-0.488C8.95,6.422,9,6.224,9,6c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.185-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.294-0.242-0.477-0.32C7.903,4.539,7.708,4.5,7.5,4.5c-0.208,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.341,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C6.039,5.597,6,5.792,6,6H5\r\n\tc0-0.344,0.065-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539S7.156,3.5,7.5,3.5z M7,11h1v1H7V11z"}],viewBox:"0 0 16 16"},{type:"svg",id:"RefreshHistory_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M8,4v4.289l2.852,2.859l-0.703,0.703L7,8.711V4H8z M15.375,4.883C15.792,5.883,16,6.922,16,8\r\n\ts-0.208,2.117-0.625,3.117c-0.406,0.953-0.979,1.8-1.719,2.539c-0.74,0.74-1.586,1.313-2.539,1.719C10.117,15.792,9.078,16,8,16\r\n\tc-0.906,0-1.781-0.148-2.625-0.445c-0.823-0.286-1.576-0.693-2.258-1.219C2.44,13.81,1.859,13.19,1.375,12.477\r\n\tc-0.245-0.359-0.458-0.734-0.641-1.125c-0.177-0.391-0.323-0.797-0.438-1.219l0.961-0.266c0.208,0.755,0.529,1.448,0.961,2.078\r\n\tc0.438,0.63,0.953,1.172,1.547,1.625c0.594,0.453,1.253,0.805,1.977,1.055S7.219,15,8,15c0.641,0,1.258-0.083,1.852-0.25\r\n\tc0.599-0.167,1.156-0.401,1.672-0.703c0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414\r\n\tc0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8c0-0.641-0.083-1.258-0.25-1.852\r\n\tc-0.167-0.599-0.404-1.156-0.711-1.672c-0.302-0.521-0.667-0.995-1.094-1.422c-0.427-0.427-0.901-0.792-1.422-1.094\r\n\tC11.008,1.654,10.45,1.417,9.852,1.25C9.258,1.083,8.641,1,8,1C7.323,1,6.667,1.096,6.031,1.289C5.396,1.477,4.802,1.745,4.25,2.094\r\n\tC3.703,2.443,3.208,2.865,2.766,3.359C2.328,3.849,1.966,4.396,1.68,5H4v1H0V2h1v2.141c0.089-0.167,0.185-0.328,0.289-0.484\r\n\tc0.104-0.161,0.214-0.318,0.328-0.469C2.107,2.536,2.68,1.974,3.336,1.5C4.023,1.01,4.76,0.638,5.547,0.383C6.333,0.128,7.151,0,8,0\r\n\tc1.078,0,2.117,0.208,3.117,0.625c0.953,0.406,1.8,0.979,2.539,1.719C14.396,3.083,14.969,3.93,15.375,4.883z"},{type:"path",className:"OfficeIconColors_m20",d:"M8,1c3.866,0,7,3.134,7,7s-3.134,7-7,7s-7-3.134-7-7S4.134,1,8,1z"},{type:"path",className:"OfficeIconColors_m22",d:"M8,4v4.289l2.852,2.859l-0.703,0.703L7,8.711V4H8z M15.375,4.883C15.792,5.883,16,6.922,16,8\r\n\ts-0.208,2.117-0.625,3.117c-0.406,0.953-0.979,1.8-1.719,2.539c-0.74,0.74-1.586,1.313-2.539,1.719C10.117,15.792,9.078,16,8,16\r\n\tc-0.906,0-1.781-0.148-2.625-0.445c-0.823-0.286-1.576-0.693-2.258-1.219C2.44,13.81,1.859,13.19,1.375,12.477\r\n\tc-0.245-0.359-0.458-0.734-0.641-1.125c-0.177-0.391-0.323-0.797-0.438-1.219l0.961-0.266c0.208,0.755,0.529,1.448,0.961,2.078\r\n\tc0.438,0.63,0.953,1.172,1.547,1.625c0.594,0.453,1.253,0.805,1.977,1.055S7.219,15,8,15c0.641,0,1.258-0.083,1.852-0.25\r\n\tc0.599-0.167,1.156-0.401,1.672-0.703c0.521-0.307,0.995-0.674,1.422-1.102s0.792-0.898,1.094-1.414\r\n\tc0.307-0.521,0.544-1.078,0.711-1.672C14.917,9.266,15,8.646,15,8c0-0.641-0.083-1.258-0.25-1.852\r\n\tc-0.167-0.599-0.404-1.156-0.711-1.672c-0.302-0.521-0.667-0.995-1.094-1.422c-0.427-0.427-0.901-0.792-1.422-1.094\r\n\tC11.008,1.654,10.45,1.417,9.852,1.25C9.258,1.083,8.641,1,8,1C7.323,1,6.667,1.096,6.031,1.289C5.396,1.477,4.802,1.745,4.25,2.094\r\n\tC3.703,2.443,3.208,2.865,2.766,3.359C2.328,3.849,1.966,4.396,1.68,5H4v1H0V2h1v2.141c0.089-0.167,0.185-0.328,0.289-0.484\r\n\tc0.104-0.161,0.214-0.318,0.328-0.469C2.107,2.536,2.68,1.974,3.336,1.5C4.023,1.01,4.76,0.638,5.547,0.383C6.333,0.128,7.151,0,8,0\r\n\tc1.078,0,2.117,0.208,3.117,0.625c0.953,0.406,1.8,0.979,2.539,1.719C14.396,3.083,14.969,3.93,15.375,4.883z"}],viewBox:"0 0 16 16"},{type:"svg",id:"BackChevron_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1272 1728 l -696 -696 l 696 -697 l 114 113 l -584 584 l 584 583 z"},{type:"path",className:"OfficeIconColors_DynamicColor",d:"M 1272 1728 l -696 -696 l 696 -697 l 114 113 l -584 584 l 584 583 z"}],viewBox:"0,0,2048,2048"},{type:"svg",id:"Medical_16",children:[{type:"path",className:"OfficeIconColors_HighContrast",d:"M13.5,5c0.344,0,0.666,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539s0.406,0.491,0.539,0.793\r\n\tC15.934,6.833,16,7.156,16,7.5c0,0.297-0.05,0.581-0.148,0.852c-0.1,0.271-0.237,0.515-0.414,0.73\r\n\tc-0.178,0.217-0.389,0.4-0.633,0.551C14.56,9.784,14.291,9.891,14,9.953v0.797c0,0.464-0.058,0.916-0.172,1.355\r\n\tc-0.115,0.44-0.277,0.855-0.488,1.246s-0.467,0.748-0.766,1.07c-0.3,0.323-0.636,0.602-1.008,0.836\r\n\tc-0.373,0.234-0.775,0.417-1.207,0.547C9.927,15.936,9.474,16,9,16c-0.474,0-0.927-0.064-1.359-0.195\r\n\tc-0.433-0.13-0.835-0.312-1.207-0.547c-0.373-0.234-0.708-0.513-1.008-0.836c-0.3-0.322-0.555-0.68-0.766-1.07\r\n\ts-0.374-0.806-0.488-1.246C4.057,11.666,4,11.214,4,10.75V8.961C3.359,8.904,2.79,8.75,2.293,8.5\r\n\tC1.795,8.25,1.377,7.922,1.039,7.516C0.7,7.109,0.442,6.638,0.266,6.102C0.088,5.565,0,4.984,0,4.359V0h2.5\r\n\tc0.135,0,0.252,0.05,0.352,0.148C2.95,0.248,3,0.365,3,0.5c0,0.136-0.05,0.253-0.148,0.352C2.752,0.951,2.635,1,2.5,1H1v3.359\r\n\tc0,0.552,0.077,1.052,0.23,1.5C1.384,6.308,1.609,6.69,1.906,7.008C2.203,7.326,2.569,7.57,3.004,7.742C3.438,7.914,3.938,8,4.5,8\r\n\tc0.526,0,1.005-0.081,1.438-0.242C6.37,7.597,6.738,7.365,7.043,7.062c0.305-0.302,0.54-0.668,0.707-1.098\r\n\tC7.917,5.535,8,5.055,8,4.523V1H6.5C6.364,1,6.247,0.951,6.148,0.852C6.049,0.753,6,0.636,6,0.5c0-0.135,0.049-0.252,0.148-0.352\r\n\tC6.247,0.05,6.364,0,6.5,0H9v4.359c0,0.625-0.089,1.206-0.266,1.742C8.557,6.638,8.299,7.109,7.961,7.516\r\n\tC7.622,7.922,7.204,8.25,6.707,8.5C6.209,8.75,5.641,8.904,5,8.961v1.789c0,0.558,0.1,1.093,0.301,1.605\r\n\tc0.2,0.514,0.479,0.965,0.836,1.355c0.356,0.391,0.778,0.703,1.266,0.938C7.889,14.883,8.422,15,9,15s1.11-0.117,1.598-0.352\r\n\tc0.486-0.234,0.908-0.547,1.266-0.938c0.356-0.391,0.635-0.842,0.836-1.355C12.899,11.843,13,11.308,13,10.75V9.953\r\n\tc-0.292-0.062-0.561-0.169-0.805-0.32c-0.245-0.15-0.456-0.334-0.633-0.551c-0.178-0.216-0.315-0.459-0.414-0.73\r\n\tC11.049,8.081,11,7.797,11,7.5c0-0.344,0.064-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539\r\n\tS13.156,5,13.5,5z M13.5,9c0.208,0,0.403-0.039,0.586-0.117c0.182-0.078,0.341-0.185,0.477-0.32c0.135-0.135,0.242-0.294,0.32-0.477\r\n\tC14.961,7.904,15,7.708,15,7.5c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.186-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.295-0.242-0.477-0.32C13.903,6.039,13.708,6,13.5,6c-0.209,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.342,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C12.039,7.097,12,7.292,12,7.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.078,0.183,0.185,0.341,0.32,0.477c0.135,0.136,0.294,0.242,0.477,0.32\r\n\tC13.096,8.961,13.291,9,13.5,9z"},{type:"path",className:"OfficeIconColors_m20",d:"M13.5,9.5L13.5,9.5c-1.1,0-2-0.9-2-2v0c0-1.1,0.9-2,2-2h0c1.1,0,2,0.9,2,2v0C15.5,8.6,14.6,9.5,13.5,9.5z"},{type:"path",className:"OfficeIconColors_m22",d:"M13.5,5c0.344,0,0.666,0.066,0.969,0.199c0.302,0.133,0.566,0.312,0.793,0.539s0.406,0.491,0.539,0.793\r\n\tC15.934,6.833,16,7.156,16,7.5c0,0.297-0.05,0.581-0.148,0.852c-0.1,0.271-0.237,0.515-0.414,0.73\r\n\tc-0.178,0.217-0.389,0.4-0.633,0.551C14.56,9.784,14.291,9.891,14,9.953v0.797c0,0.464-0.058,0.916-0.172,1.355\r\n\tc-0.115,0.44-0.277,0.855-0.488,1.246s-0.467,0.748-0.766,1.07c-0.3,0.323-0.636,0.602-1.008,0.836\r\n\tc-0.373,0.234-0.775,0.417-1.207,0.547C9.927,15.936,9.474,16,9,16c-0.474,0-0.927-0.064-1.359-0.195\r\n\tc-0.433-0.13-0.835-0.312-1.207-0.547c-0.373-0.234-0.708-0.513-1.008-0.836c-0.3-0.322-0.555-0.68-0.766-1.07\r\n\ts-0.374-0.806-0.488-1.246C4.057,11.666,4,11.214,4,10.75V8.961C3.359,8.904,2.79,8.75,2.293,8.5\r\n\tC1.795,8.25,1.377,7.922,1.039,7.516C0.7,7.109,0.442,6.638,0.266,6.102C0.088,5.565,0,4.984,0,4.359V0h2.5\r\n\tc0.135,0,0.252,0.05,0.352,0.148C2.95,0.248,3,0.365,3,0.5c0,0.136-0.05,0.253-0.148,0.352C2.752,0.951,2.635,1,2.5,1H1v3.359\r\n\tc0,0.552,0.077,1.052,0.23,1.5C1.384,6.308,1.609,6.69,1.906,7.008C2.203,7.326,2.569,7.57,3.004,7.742C3.438,7.914,3.938,8,4.5,8\r\n\tc0.526,0,1.005-0.081,1.438-0.242C6.37,7.597,6.738,7.365,7.043,7.062c0.305-0.302,0.54-0.668,0.707-1.098\r\n\tC7.917,5.535,8,5.055,8,4.523V1H6.5C6.364,1,6.247,0.951,6.148,0.852C6.049,0.753,6,0.636,6,0.5c0-0.135,0.049-0.252,0.148-0.352\r\n\tC6.247,0.05,6.364,0,6.5,0H9v4.359c0,0.625-0.089,1.206-0.266,1.742C8.557,6.638,8.299,7.109,7.961,7.516\r\n\tC7.622,7.922,7.204,8.25,6.707,8.5C6.209,8.75,5.641,8.904,5,8.961v1.789c0,0.558,0.1,1.093,0.301,1.605\r\n\tc0.2,0.514,0.479,0.965,0.836,1.355c0.356,0.391,0.778,0.703,1.266,0.938C7.889,14.883,8.422,15,9,15s1.11-0.117,1.598-0.352\r\n\tc0.486-0.234,0.908-0.547,1.266-0.938c0.356-0.391,0.635-0.842,0.836-1.355C12.899,11.843,13,11.308,13,10.75V9.953\r\n\tc-0.292-0.062-0.561-0.169-0.805-0.32c-0.245-0.15-0.456-0.334-0.633-0.551c-0.178-0.216-0.315-0.459-0.414-0.73\r\n\tC11.049,8.081,11,7.797,11,7.5c0-0.344,0.064-0.667,0.195-0.969c0.13-0.302,0.309-0.566,0.535-0.793s0.492-0.406,0.797-0.539\r\n\tS13.156,5,13.5,5z M13.5,9c0.208,0,0.403-0.039,0.586-0.117c0.182-0.078,0.341-0.185,0.477-0.32c0.135-0.135,0.242-0.294,0.32-0.477\r\n\tC14.961,7.904,15,7.708,15,7.5c0-0.208-0.039-0.403-0.117-0.586c-0.078-0.182-0.186-0.341-0.32-0.477\r\n\tc-0.136-0.135-0.295-0.242-0.477-0.32C13.903,6.039,13.708,6,13.5,6c-0.209,0-0.404,0.039-0.586,0.117\r\n\tc-0.183,0.078-0.342,0.185-0.477,0.32c-0.136,0.136-0.242,0.294-0.32,0.477C12.039,7.097,12,7.292,12,7.5\r\n\tc0,0.208,0.039,0.404,0.117,0.586c0.078,0.183,0.185,0.341,0.32,0.477c0.135,0.136,0.294,0.242,0.477,0.32\r\n\tC13.096,8.961,13.291,9,13.5,9z"}],viewBox:"0 0 16 16"},{type:"svg",id:"QueryList_16",children:[{type:"path",d:"M1664 128H0V0h1664v128zm0 512H0V512h1664v128zM0 1024h768v128H0v-128zm2048 0v219l-384 384v421h-384v-421l-384-384v-219h1152zm-128 128h-896v37l384 384v347h128v-347l384-384v-37z"}],viewBox:"0 0 2048 2048"},{type:"svg",id:"PermissionsKey_16",children:[{type:"path",className:"OfficeIconColors_m227",d:"M15 12.7109L9.60938 7.32031C9.72396 7.02344 9.81771 6.72656 9.89062 6.42969C9.96354 6.1276 10 5.81771 10 5.5C10 4.88021 9.88021 4.29688 9.64062 3.75C9.40625 3.20312 9.08594 2.72656 8.67969 2.32031C8.27344 1.91406 7.79688 1.59375 7.25 1.35938C6.70312 1.11979 6.11979 1 5.5 1C4.88021 1 4.29688 1.11979 3.75 1.35938C3.20312 1.59375 2.72656 1.91406 2.32031 2.32031C1.91406 2.72656 1.59115 3.20312 1.35156 3.75C1.11719 4.29688 1 4.88021 1 5.5C1 6.11979 1.11719 6.70312 1.35156 7.25C1.59115 7.79688 1.91406 8.27344 2.32031 8.67969C2.72656 9.08594 3.20312 9.40885 3.75 9.64844C4.29688 9.88281 4.88021 10 5.5 10C6.00521 10 6.5 9.91406 6.98438 9.74219C7.47396 9.57031 7.91406 9.32292 8.30469 9H9V11H11V13H13V15H15V12.7109Z"},{type:"path",className:"OfficeIconColors_m2148",d:"M16 12.2891V16H12V14H10V12H8V10.3828C7.61458 10.5859 7.21094 10.7396 6.78906 10.8438C6.36719 10.9479 5.9375 11 5.5 11C4.99479 11 4.50781 10.9349 4.03906 10.8047C3.57031 10.6745 3.13281 10.4896 2.72656 10.25C2.32031 10.0104 1.94792 9.72396 1.60938 9.39062C1.27604 9.05208 0.989583 8.67969 0.75 8.27344C0.510417 7.86719 0.325521 7.42969 0.195312 6.96094C0.0651042 6.49219 0 6.00521 0 5.5C0 4.99479 0.0651042 4.50781 0.195312 4.03906C0.325521 3.57031 0.510417 3.13281 0.75 2.72656C0.989583 2.32031 1.27604 1.95052 1.60938 1.61719C1.94792 1.27865 2.32031 0.989583 2.72656 0.75C3.13281 0.510417 3.57031 0.325521 4.03906 0.195312C4.50781 0.0651042 4.99479 0 5.5 0C6.00521 0 6.49219 0.0651042 6.96094 0.195312C7.42969 0.325521 7.86719 0.510417 8.27344 0.75C8.67969 0.989583 9.04948 1.27865 9.38281 1.61719C9.72135 1.95052 10.0104 2.32031 10.25 2.72656C10.4896 3.13281 10.6745 3.57031 10.8047 4.03906C10.9349 4.50781 11 4.99479 11 5.5C11 5.76562 10.9792 6.02865 10.9375 6.28906C10.8958 6.54948 10.8359 6.80469 10.7578 7.05469L16 12.2891ZM15 12.7109L9.60938 7.32031C9.72396 7.02344 9.81771 6.72656 9.89062 6.42969C9.96354 6.1276 10 5.81771 10 5.5C10 4.88021 9.88021 4.29688 9.64062 3.75C9.40625 3.20312 9.08594 2.72656 8.67969 2.32031C8.27344 1.91406 7.79688 1.59375 7.25 1.35938C6.70312 1.11979 6.11979 1 5.5 1C4.88021 1 4.29688 1.11979 3.75 1.35938C3.20312 1.59375 2.72656 1.91406 2.32031 2.32031C1.91406 2.72656 1.59115 3.20312 1.35156 3.75C1.11719 4.29688 1 4.88021 1 5.5C1 6.11979 1.11719 6.70312 1.35156 7.25C1.59115 7.79688 1.91406 8.27344 2.32031 8.67969C2.72656 9.08594 3.20312 9.40885 3.75 9.64844C4.29688 9.88281 4.88021 10 5.5 10C6.00521 10 6.5 9.91406 6.98438 9.74219C7.47396 9.57031 7.91406 9.32292 8.30469 9H9V11H11V13H13V15H15V12.7109ZM4 3C4.14062 3 4.27083 3.02604 4.39062 3.07812C4.51042 3.13021 4.61458 3.20312 4.70312 3.29688C4.79688 3.38542 4.86979 3.48958 4.92188 3.60938C4.97396 3.72917 5 3.85938 5 4C5 4.14062 4.97396 4.27083 4.92188 4.39062C4.86979 4.51042 4.79688 4.61719 4.70312 4.71094C4.61458 4.79948 4.51042 4.86979 4.39062 4.92188C4.27083 4.97396 4.14062 5 4 5C3.85938 5 3.72917 4.97396 3.60938 4.92188C3.48958 4.86979 3.38281 4.79948 3.28906 4.71094C3.20052 4.61719 3.13021 4.51042 3.07812 4.39062C3.02604 4.27083 3 4.14062 3 4C3 3.85938 3.02604 3.72917 3.07812 3.60938C3.13021 3.48958 3.20052 3.38542 3.28906 3.29688C3.38281 3.20312 3.48958 3.13021 3.60938 3.07812C3.72917 3.02604 3.85938 3 4 3Z"}],viewBox:"0 0 16 16"}]}},5432:function(pt,Ct,M){"use strict";M.d(Ct,{d:function(){return B}});var w=M(81337),b=M(50423),e=M(3613),j=function(){function X(K){this.cultureService=K,this.currencyRecentFormats=[]}return X.prototype.getCurrencyGeneralFormat=function(){return this.currencyGeneralFormat||(this.currencyGeneralFormat={culture:null,displayLabel:this.localizationService.get("Format_Label_Currency_General"),symbol:"$",positivePattern:0,negativePattern:0,formatType:"CurrencyGeneral"}),this.currencyGeneralFormat},X.prototype.getCurrencyCommonFormats=function(){if(!this.currencyCommonFormats){var K=_.filter(this.cultureService.getAllCurrencySymbolCustomFormatItemsInfo(),function(le){return"en-US"===le.culture||"en-GB"===le.culture||"fr-CH"===le.culture||null===le.culture});this.currencyCommonFormats=_.flatten([this.getCurrencyGeneralFormat(),K.find(function(le){return"en-US"===le.culture}),K.find(function(le){return"en-GB"===le.culture}),K.filter(function(le){return!le.culture&&"\u20ac"===le.symbol}),K.find(function(le){return!le.culture&&"\xa5"===le.symbol}),K.find(function(le){return"fr-CH"===le.culture})])}return this.currencyCommonFormats},X.prototype.getCurrencyAllFormats=function(){if(!this.currencyAllFormats){var K=this.cultureService.getAllCurrencySymbolCustomFormatItemsInfo();this.currencyAllFormats=(0,w.__spreadArray)([this.getCurrencyGeneralFormat()],K,!0)}return this.currencyAllFormats},X.prototype.getCurrencyAllCultureFormats=function(){return this.cultureService.getAllCurrencySymbolCustomFormatItemsInfo()},X.prototype.getCurrencyRecentFormats=function(){return this.currencyRecentFormats},X.\u0275fac=function(le){return new(le||X)(b.\u0275\u0275inject(e.h))},X.\u0275prov=b.\u0275\u0275defineInjectable({token:X,factory:X.\u0275fac,providedIn:"root"}),X}(),qe=M(61353),te=M(98776),Le=M(18967),tt=M(62458),Ge=M(64560),He=M(65181),Z=M(77476),Ee=M(59968),se=M(48205),I=M(33846),ie=M(7970),ye=M(80357),W=M(86663),ne=M(69437),ve=M(36858),me=M(85102);function q(X,K){if(1&X&&(b.\u0275\u0275elementStart(0,"mat-option",7),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&X){var le=K.$implicit;b.\u0275\u0275property("value",le.value)("pbiTooltip",le.label),b.\u0275\u0275attribute("aria-label",le.label),b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",le.label," ")}}var be=function(K){return{btnDisabled:K}},_e=function(K){return{isToggled:K}};function pe(X,K){if(1&X){var le=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementContainerStart(0),b.\u0275\u0275elementStart(1,"div",8)(2,"div")(3,"button",9),b.\u0275\u0275listener("click",function(){b.\u0275\u0275restoreView(le);var st=b.\u0275\u0275nextContext();return b.\u0275\u0275resetView(st.onCurrencyClicked())}),b.\u0275\u0275pipe(4,"localize"),b.\u0275\u0275pipe(5,"localize"),b.\u0275\u0275element(6,"pbi-office-icon",10),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(7,"button",11),b.\u0275\u0275listener("pbiMenuButtonClick",function(st){b.\u0275\u0275restoreView(le);var vt=b.\u0275\u0275nextContext();return b.\u0275\u0275resetView(vt.onCurrencyItemClicked(st))}),b.\u0275\u0275pipe(8,"localize"),b.\u0275\u0275pipe(9,"localize"),b.\u0275\u0275element(10,"pbi-icon",12),b.\u0275\u0275elementEnd()(),b.\u0275\u0275elementStart(11,"button",13),b.\u0275\u0275listener("click",function(){b.\u0275\u0275restoreView(le);var st=b.\u0275\u0275nextContext();return b.\u0275\u0275resetView(st.onChangePercentageToggle())}),b.\u0275\u0275pipe(12,"localize"),b.\u0275\u0275pipe(13,"localize"),b.\u0275\u0275element(14,"pbi-office-icon",14),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(15,"button",13),b.\u0275\u0275listener("click",function(){b.\u0275\u0275restoreView(le);var st=b.\u0275\u0275nextContext();return b.\u0275\u0275resetView(st.onChangeThousandSeparatorToggle())}),b.\u0275\u0275pipe(16,"localize"),b.\u0275\u0275pipe(17,"localize"),b.\u0275\u0275element(18,"pbi-office-icon",15),b.\u0275\u0275elementEnd()(),b.\u0275\u0275elementStart(19,"div",16),b.\u0275\u0275pipe(20,"localize"),b.\u0275\u0275elementStart(21,"span",17),b.\u0275\u0275element(22,"pbi-office-icon",18),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(23,"num-up-down",19),b.\u0275\u0275listener("modelValueChange",function(st){b.\u0275\u0275restoreView(le);var vt=b.\u0275\u0275nextContext();return b.\u0275\u0275resetView(vt.onDecimalPlacesChanged(st))}),b.\u0275\u0275elementEnd()(),b.\u0275\u0275elementContainerEnd()}if(2&X){var ae=b.\u0275\u0275nextContext();b.\u0275\u0275advance(3),b.\u0275\u0275property("disabled",!ae.isNumericFormatEnabled())("pbiTooltip",b.\u0275\u0275pipeBind1(4,22,"Value_Formatting_Tooltip_Currency_Format")),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(5,24,"Value_Formatting_ARIA_Label_Currency_Format")),b.\u0275\u0275advance(4),b.\u0275\u0275property("ngClass",b.\u0275\u0275pureFunction1(40,be,!ae.isNumericFormatEnabled()))("pbiMenu",ae.currencyMenu)("pbiTooltip",b.\u0275\u0275pipeBind1(8,26,"Value_Formatting_Tooltip_Currency_Format"))("disabled",!ae.isNumericFormatEnabled()),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(9,28,"Value_Formatting_ARIA_Label_Currency_Format")),b.\u0275\u0275advance(4),b.\u0275\u0275property("ngClass",b.\u0275\u0275pureFunction1(42,_e,ae.isPercentFormatterToggled()))("disabled",!ae.isNumericFormatEnabled())("pbiTooltip",b.\u0275\u0275pipeBind1(12,30,"Value_Formatting_Tooltip_Percentage_Format")),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(13,32,"Value_Formatting_ARIA_Label_Percentage_Format")),b.\u0275\u0275advance(4),b.\u0275\u0275property("ngClass",b.\u0275\u0275pureFunction1(44,_e,ae.isThousandSeparatorToggled()))("disabled",!ae.isNumericFormatEnabled(!0))("pbiTooltip",b.\u0275\u0275pipeBind1(16,34,"Ribbon_Tooltip_DataFormatDecimalPlaces")),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(17,36,"Value_Formatting_ARIA_Label_Thousands_Separator_Format")),b.\u0275\u0275advance(4),b.\u0275\u0275property("pbiTooltip",b.\u0275\u0275pipeBind1(20,38,"Ribbon_Tooltip_DataFormatDecimalPlaces")),b.\u0275\u0275advance(3),b.\u0275\u0275property("disabled",(null==ae.formatInformation?null:ae.formatInformation.format)===ae.FormatNumberWhole),b.\u0275\u0275advance(1),b.\u0275\u0275property("options",ae.options)("useModernStyles",!0)("modelValue",ae.formatInformation&&ae.formatInformation.accuracy)("isDisabled",!ae.isNumericFormatEnabled()||(null==ae.formatInformation?null:ae.formatInformation.format)===ae.FormatNumberWhole)}}function Re(X,K){if(1&X&&(b.\u0275\u0275elementStart(0,"mat-option",7),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&X){var le=K.index,ae=b.\u0275\u0275nextContext(3);b.\u0275\u0275property("value",le)("pbiTooltip",ae.categoryListNames[le]),b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",ae.categoryListNames[le]," ")}}function Qe(X,K){if(1&X){var le=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementContainerStart(0),b.\u0275\u0275elementStart(1,"mat-select",21),b.\u0275\u0275listener("valueChange",function(st){b.\u0275\u0275restoreView(le);var vt=b.\u0275\u0275nextContext(2);return b.\u0275\u0275resetView(vt.selectedCategoryList=st)}),b.\u0275\u0275pipe(2,"localize"),b.\u0275\u0275template(3,Re,2,3,"mat-option",4),b.\u0275\u0275elementStart(4,"div",22)(5,"button",23),b.\u0275\u0275listener("click",function(){b.\u0275\u0275restoreView(le);var st=b.\u0275\u0275nextContext(2);return b.\u0275\u0275resetView(st.launchCategoryListsEditPane(!1))}),b.\u0275\u0275pipe(6,"localize"),b.\u0275\u0275pipe(7,"localize"),b.\u0275\u0275element(8,"span",24),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(9,"button",25),b.\u0275\u0275listener("click",function(){b.\u0275\u0275restoreView(le);var st=b.\u0275\u0275nextContext(2);return b.\u0275\u0275resetView(st.launchCategoryListsEditPane(!0))}),b.\u0275\u0275pipe(10,"localize"),b.\u0275\u0275pipe(11,"localize"),b.\u0275\u0275element(12,"span",26),b.\u0275\u0275elementEnd()()(),b.\u0275\u0275elementContainerEnd()}if(2&X){var ae=b.\u0275\u0275nextContext(2);b.\u0275\u0275advance(1),b.\u0275\u0275property("value",ae.selectedCategoryList),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(2,7,"Value_Formatting_ARIA_Label_SelectCategoryListDropdown")),b.\u0275\u0275advance(2),b.\u0275\u0275property("ngForOf",ae.goalValueCategoryLists),b.\u0275\u0275advance(2),b.\u0275\u0275property("pbiTooltip",b.\u0275\u0275pipeBind1(6,9,"Manage_Lists")),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(7,11,"Manage_Lists")),b.\u0275\u0275advance(4),b.\u0275\u0275property("pbiTooltip",b.\u0275\u0275pipeBind1(10,13,"Create_A_List")),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(11,15,"Create_A_List"))}}function ke(X,K){if(1&X&&b.\u0275\u0275template(0,Qe,13,17,"ng-container",20),2&X){var le=b.\u0275\u0275nextContext();b.\u0275\u0275property("ngIf",(null==le.goalValueCategoryLists?null:le.goalValueCategoryLists.length)>0)}}var N=[{value:"General",label:"Format_Label_General"},{value:"CurrencyCustom",label:"Format_Label_Currency"},{value:"DateTimeGeneralPattern",label:"Format_Label_DateTime"},{value:"NumberDecimal",label:"DataType_Label_Number"},{value:"NumberWhole",label:"DataType_Label_WholeNumber"},{value:"Percentage",label:"Format_Label_Percentage"},{value:"Scientific",label:"Format_Label_Scientific"},{value:"Text",label:"Text"},{value:"Boolean",label:"DataType_Label_Boolean"},{value:"Binary",label:"DataType_Binary"},{value:"Custom",label:"DataType_Label_Categorical"}],B=function(){function X(K,le,ae,ze){this.cultureService=K,this.currencyFormatService=le,this.dateTimeFormatService=ae,this.localizationService=ze,this.formatStringChange=new b.EventEmitter,this.onSelectedCategoryListChange=new b.EventEmitter,this.availableFormats=[],this.options={unitSymbol:"",minValue:0,maxValue:15},this.FormatNumberWhole="NumberWhole",this.formatUtils=new te.c(this.cultureService.getFormatInfo()),this.allCurrenciesOptions=K.getAllCurrencySymbolCustomFormatItemsInfo(),this.commonCurrenciesOptions=K.getAllCommonCurrencySymbolCustomFormatItemsInfo(),this.availableCurrencyFormats=this.generateCurrencyFormatInfoMapping(this.allCurrenciesOptions),this.currencyMenu=this.currencyFormatInfoToPbiMenuAdaptor(this.commonCurrenciesOptions,this.allCurrenciesOptions)}return Object.defineProperty(X.prototype,"formatString",{set:function(le){this.formatInformation=this.cultureService.tryParse(le,this.dataType),le===X.CategoricalFormatString&&(this.formatInformation.format="Custom"),this.updateCompatibleFormats()},enumerable:!1,configurable:!0}),Object.defineProperty(X.prototype,"dataType",{get:function(){return this._dataType},set:function(le){this._dataType=le,this.formatInformation&&(this.isCategorical?this.formatInformation.format="Custom":this.formatInformation=this.cultureService.tryParse(this.formatInformation.formatString,le)),this.updateCompatibleFormats()},enumerable:!1,configurable:!0}),Object.defineProperty(X.prototype,"goalValueCategoryLists",{get:function(){return this._goalValueCategoryLists},set:function(le){var ae=this;this.supportCategoricalValues&&(this._goalValueCategoryLists=le,this.categoryListNames=le.map(function(ze){return ae.getCategoryListName(ze)}))},enumerable:!1,configurable:!0}),X.prototype.ngOnInit=function(){this.updateCompatibleFormats()},X.prototype.isNumericFormatEnabled=function(K){void 0===K&&(K=!1);var le=this.dataType,ae=this.formatInformation&&this.formatInformation.format;return(ae&&K?this.isValidNumericFormat(ae):"Custom"!==ae)&&(2===le||3===le||4===le||13===le)},X.prototype.isThousandSeparatorToggled=function(){return this.formatInformation&&this.formatInformation.thousandSeparator},X.prototype.isPercentFormatterToggled=function(){return this.formatInformation&&"Percentage"===this.formatInformation.format},X.prototype.onChangePercentageToggle=function(){var K;this.formatInformation=this.formatInformation&&"Percentage"===this.formatInformation.format?void 0:this.formatUtils.changeFormat(this.dataType,this.formatInformation,"Percentage"),this.formatStringChange.emit(null===(K=this.formatInformation)||void 0===K?void 0:K.formatString)},X.prototype.onChangeThousandSeparatorToggle=function(){var K;this.formatInformation=this.formatUtils.toggleThousandsSeparator(this.dataType,this.formatInformation),this.formatStringChange.emit(null===(K=this.formatInformation)||void 0===K?void 0:K.formatString)},X.prototype.onCurrencyClicked=function(){var K;this.formatInformation=this.formatUtils.changeFormat(this.dataType,this.formatInformation,"CurrencyCustom"),this.formatStringChange.emit(null===(K=this.formatInformation)||void 0===K?void 0:K.formatString)},X.prototype.onCurrencyItemClicked=function(K){this.availableCurrencyFormats=this.generateCurrencyFormatInfoMapping(this.allCurrenciesOptions);var ae=this.availableCurrencyFormats.get(K.text);this.formatInformation=this.formatUtils.changeFormat(this.dataType,this.formatInformation,"CurrencyCustom"),this.formatInformation=this.formatUtils.setCurrencyFormat(this.dataType,this.formatInformation,this.formatInformation.format,ae.culture,ae.symbol,ae.positivePattern,ae.negativePattern),this.formatStringChange.emit(this.formatInformation.formatString)},X.prototype.onDecimalPlacesChanged=function(K){this.formatInformation=this.formatUtils.setAccuracy(this.dataType,this.formatInformation,K),this.formatStringChange.emit(this.formatInformation.formatString)},Object.defineProperty(X.prototype,"selectedFormat",{get:function(){if(!this.formatInformation)return"General";var le=this.formatInformation.format;switch(this.formatInformation.format){case"CurrencyCustom":le="CurrencyCustom";break;case"DateTimeCustom":case"DateTimeGeneralPattern":this.formatInformation.dateTimeCustomFormat&&(le=this.formatInformation.dateTimeCustomFormat.formatString)}return le},set:function(le){var ae,ze;switch(le){case"General":this.formatInformation=void 0;break;case"NumberDecimal":case"NumberWhole":case"Percentage":case"CurrencyCustom":case"Scientific":case"Binary":case"Boolean":case"Text":this.formatInformation=this.formatUtils.changeFormat(this.dataType,this.formatInformation,le);break;case"Custom":this.formatInformation={format:le,formatString:X.CategoricalFormatString,thousandSeparator:void 0,currencyFormat:void 0,dateTimeCustomFormat:void 0},_.isEmpty(this.categoryListNames)?(this.selectedCategoryList=-1,this.formatStringChange.emit(null===(ae=this.formatInformation)||void 0===ae?void 0:ae.formatString),this.launchCategoryListsEditPane(!0)):this.selectedCategoryList=0;break;default:var st=this.dateTimeFormatService.getFormat(le);this.formatInformation=this.formatUtils.setDateTimeFormat(this.dataType,this.formatInformation,st.formatType,st.pattern,st.formatString)}this.formatStringChange.emit(null===(ze=this.formatInformation)||void 0===ze?void 0:ze.formatString)},enumerable:!1,configurable:!0}),Object.defineProperty(X.prototype,"selectedCategoryList",{get:function(){return this.selectedCategoryListIndex},set:function(le){this.selectedCategoryListIndex=le,this.onSelectedCategoryListChange.emit(le)},enumerable:!1,configurable:!0}),Object.defineProperty(X.prototype,"isCategorical",{get:function(){var le;return(null===(le=this.formatInformation)||void 0===le?void 0:le.formatString)===X.CategoricalFormatString},enumerable:!1,configurable:!0}),X.prototype.currencyFormatInfoToPbiMenuAdaptor=function(K,le){var ae=this.buildCommonCurrencyPbiMenu(K);tt.fF.assertValue(le,"ICurrencyFormatInfo[] should not be null");var ze={type:Ge.iB.Header,text:this.localizationService.get("All_Currency_Symbols"),tooltip:this.localizationService.get("All_Currency_Symbols")};return ae.items.push({type:Ge.iB.Divider}),ae.items.push(ze),this.forgeMenuOptions(ae,le)},X.prototype.buildCommonCurrencyPbiMenu=function(K){var le={items:[]};tt.fF.assertValue(K,"ICurrencyFormatInfo[] should not be null");var ae={type:Ge.iB.Header,text:this.localizationService.get("Common_Currency_Symbols"),tooltip:this.localizationService.get("Common_Currency_Symbols")};return le.items.push(ae),this.forgeMenuOptions(le,K)},X.prototype.forgeMenuOptions=function(K,le){for(var ae=K,ze=0;ze<le.length;ze++)ae.items.push({id:ze,type:Ge.iB.Button,text:le[ze].displayLabel,tooltip:le[ze].displayLabel,disabled:!1});return ae},X.prototype.generateCurrencyFormatInfoMapping=function(K){var le=new Map;tt.fF.assertValue(K,"ICurrencyFormatInfo[] should not be null");for(var ae=0,ze=K;ae<ze.length;ae++){var st=ze[ae];le.set(st.displayLabel,st)}return le},X.prototype.isValidNumericFormat=function(K){return"General"===K||"CurrencyGeneral"===K||"CurrencyCustom"===K||"Scientific"===K||"Percentage"===K||"NumberDecimal"===K||"NumberWhole"===K||"Custom"===K},X.prototype.getCompatibleFormats=function(K){switch(K){case 4:case 3:case 2:var le=["General","NumberWhole","NumberDecimal","CurrencyCustom","Percentage","Scientific"];return this.supportCategoricalValues&&le.push("Custom"),le;case 6:case 7:case 9:return[];case 11:return["Binary"];case 5:return["Boolean"];case 1:case 13:return["Text"];default:return["General"]}},X.prototype.updateCompatibleFormats=function(){var K=this;switch(this.dataType){case 6:this.availableFormats=_.map(this.dateTimeFormatService.getDateFormats(),function(ae){return{value:ae.formatString,label:ae.displayLabel}});break;case 9:this.availableFormats=_.map(this.dateTimeFormatService.getTimeFormats(),function(ae){return{value:ae.formatString,label:ae.displayLabel}});break;case 7:this.availableFormats=_.map(this.dateTimeFormatService.getCommonFormats(),function(ae){return{value:ae.formatString,label:ae.displayLabel}});break;default:var le=this.getCompatibleFormats(this.dataType);this.availableFormats=_.filter(_.map(N,function(ae){return{value:ae.value,label:K.localizationService.get(ae.label)}}),function(ae){return _.some(le,function(ze){return ze===ae.value})})}},X.prototype.getCategoryListName=function(K){if(_.isEmpty(K.name)){var le=_.map(K.categories,function(ae){return ae.displayName});return _.join(le,", ")}return K.name},X.CategoricalFormatString="CategoricalFormatString",X.\u0275fac=function(le){return new(le||X)(b.\u0275\u0275directiveInject(e.h),b.\u0275\u0275directiveInject(j),b.\u0275\u0275directiveInject(qe.u),b.\u0275\u0275directiveInject(He.o))},X.\u0275cmp=b.\u0275\u0275defineComponent({type:X,selectors:[["value-formatting"]],inputs:{formatString:"formatString",dataType:"dataType",supportCategoricalValues:"supportCategoricalValues",goalValueCategoryLists:"goalValueCategoryLists",selectedCategoryListIndex:"selectedCategoryListIndex",launchCategoryListsEditPane:"launchCategoryListsEditPane"},outputs:{formatStringChange:"formatStringChange",onSelectedCategoryListChange:"onSelectedCategoryListChange"},features:[b.\u0275\u0275ProvidersFeature([{provide:j,useClass:j},{provide:Le.c,useClass:e.h},{provide:qe.u,useClass:qe.u}])],decls:10,vars:11,consts:[[1,"valueFormatterToolbarContainer"],[1,"valueFormatterDropdownGroup",3,"pbiTooltip"],["name","PBIDataFormat_16",1,"icon-format"],["pbiMatSelect","","panelClass","pbi-modern-select-panel","disableOptionCentering","","role","combobox",1,"pbi-modern-select","valueFormatDropdown",3,"value","disabled","valueChange"],[3,"value","pbiTooltip",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["categoryListsSelector",""],[3,"value","pbiTooltip"],[1,"valueFormatterToggleButtonsGroup"],[1,"btn","toggleBtn","icon","splitButtonText",3,"disabled","pbiTooltip","click"],["name","CurrencyFormat_16",1,"icon-currency"],[1,"btn","toggleBtn","icon","splitButton",3,"ngClass","pbiMenu","pbiTooltip","disabled","pbiMenuButtonClick"],["name","chevrondownsmall","size","mini",1,"chevrondown"],[1,"btn","toggleBtn","icon","focusOutline",3,"ngClass","disabled","pbiTooltip","click"],["name","Percentage_16"],["name","CommaFormat_16"],[1,"valueFormatterNumUpDownGroup",3,"pbiTooltip"],[1,"icon"],["name","DecreaseDecimals_16",1,"icon-decreaseDecimals",3,"disabled"],["attr.aria-label","'Value_Formatting_ARIA_Label_Decimal_Place_Format' | localize","placeholderText","Auto",1,"numUpDown",3,"options","useModernStyles","modelValue","isDisabled","modelValueChange"],[4,"ngIf"],["pbiMatSelect","","panelClass","pbi-modern-select-panel","disableOptionCentering","","role","combobox",1,"pbi-modern-select","select-category-list-dropdown",3,"value","valueChange"],[1,"edit-category-lists-in-dropdown"],[1,"btn","edit-category-lists-button",3,"pbiTooltip","click"],["localize","Manage_Lists"],[1,"btn","create-category-list-button",3,"pbiTooltip","click"],["localize","Create_A_List"]],template:function(le,ae){if(1&le&&(b.\u0275\u0275elementStart(0,"div",0)(1,"div",1),b.\u0275\u0275pipe(2,"localize"),b.\u0275\u0275element(3,"pbi-office-icon",2),b.\u0275\u0275elementStart(4,"mat-select",3),b.\u0275\u0275listener("valueChange",function(vt){return ae.selectedFormat=vt}),b.\u0275\u0275pipe(5,"localize"),b.\u0275\u0275template(6,q,2,4,"mat-option",4),b.\u0275\u0275elementEnd()(),b.\u0275\u0275template(7,pe,24,46,"ng-container",5),b.\u0275\u0275template(8,ke,1,1,"ng-template",null,6,b.\u0275\u0275templateRefExtractor),b.\u0275\u0275elementEnd()),2&le){var ze=b.\u0275\u0275reference(9);b.\u0275\u0275advance(1),b.\u0275\u0275property("pbiTooltip",b.\u0275\u0275pipeBind1(2,7,"Value_Formatting_Tooltip_ComboBox")),b.\u0275\u0275advance(3),b.\u0275\u0275property("value",ae.selectedFormat)("disabled",ae.availableFormats.length<=1),b.\u0275\u0275attribute("aria-label",b.\u0275\u0275pipeBind1(5,9,"Value_Formatting_ARIA_Label_ComboBox")),b.\u0275\u0275advance(2),b.\u0275\u0275property("ngForOf",ae.availableFormats),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",!ae.isCategorical)("ngIfElse",ze)}},dependencies:[Z.NgClass,Z.NgForOf,Z.NgIf,Ee.X,se.x8,I.CK,ie.x4,ye.l8,W._,ne.m,ve.V,me.F],styles:['.focusOutline[_ngcontent-%COMP%]{outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]{background-color:inherit;border-top:inherit;display:flex;flex-direction:row;padding:8px 10px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;padding-right:13px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatDropdown[_ngcontent-%COMP%]{background-color:var(--fluent-theme-white-color, #FFF);border:1px solid var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4);display:table;height:24px;width:150px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatDropdown[_ngcontent-%COMP%]     .mat-select-arrow{color:var(--fluent-theme-neutral-primary-color, #323130)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatDropdown[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]   .valueFormatOptions[_ngcontent-%COMP%]{height:30px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterDropdownGroup[_ngcontent-%COMP%]     .mat-select-disabled .mat-select-value{color:var(--fluent-theme-black-color, #000)!important;opacity:.38}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .select-category-list-dropdown[_ngcontent-%COMP%]{width:150px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .edit-category-lists[_ngcontent-%COMP%]:hover, .valueFormatterToolbarContainer[_ngcontent-%COMP%]   .edit-category-lists[_ngcontent-%COMP%]:active{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]{display:flex;align-items:center}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{box-shadow:unset;display:inline-block;height:24px;margin:0;outline:unset;padding:0;vertical-align:middle;width:24px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .icon-arrowDown[_ngcontent-%COMP%]{font-size:xx-small}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:inherit}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .isToggled[_ngcontent-%COMP%]{background-color:var(--fluent-theme-primary-color, #F2C811)!important}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .isToggled[_ngcontent-%COMP%]   .pbi-office-icon[_ngcontent-%COMP%]{fill:var(--button-primary-content-color)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .isToggled[_ngcontent-%COMP%]   .pbi-office-icon[_ngcontent-%COMP%]     svg>path.OfficeIconColors_m22{fill:var(--button-primary-content-color)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButton[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;width:15px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButton[_ngcontent-%COMP%]:focus:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButton[_ngcontent-%COMP%]   .chevrondown[_ngcontent-%COMP%]{display:flex;align-items:center}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .btnDisabled[_ngcontent-%COMP%]{cursor:default}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButtonText[_ngcontent-%COMP%]{width:16px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .splitButtonText[_ngcontent-%COMP%]:focus:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterToggleButtonsGroup[_ngcontent-%COMP%]   .focusOutline[_ngcontent-%COMP%]:focus{outline:var(--focus-two-tone-outline-definition, auto 1px);outline-color:var(--focus-two-tone-outline-color, -webkit-focus-ring-color);outline:1px solid var(--fluent-theme-neutral-primary-hover-color, #232322)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]{display:flex;align-items:center}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]{margin-left:10px;width:82px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field{width:100%}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .numUpDownWrapper.modern-styles .unit-numupdown{border:1px solid var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4);background:var(--fluent-theme-white-color, #FFF)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .numUpDownWrapper.modern-styles .unit-numupdown .navigationButtons .buttonBox{color:var(--fluent-theme-neutral-primary-color, #323130)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .numUpDownWrapper.modern-styles .unit-numupdown .navigationButtons .buttonBox:hover{background-color:transparent}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field._mat-animation-noopable .mat-form-field-label{height:26px;padding-left:7px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     input{caret-color:var(--fluent-theme-neutral-tertiary-alt-color, #C8C6C4)}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field-appearance-legacy .mat-form-field-label{top:12px;left:6.5px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .valueFormatterNumUpDownGroup[_ngcontent-%COMP%]   .numUpDown[_ngcontent-%COMP%]     .mat-form-field.mat-focused .mat-form-field-label{color:var(--fluent-theme-black-color, #000);opacity:.54}.valueFormatterToolbarContainer[_ngcontent-%COMP%]     .pbi-office-icon{width:16px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .icon-decreaseDecimals[_ngcontent-%COMP%]{padding-left:4px;padding-top:4px}.valueFormatterToolbarContainer[_ngcontent-%COMP%]   .icon-format[_ngcontent-%COMP%]{padding-right:10px;padding-top:2px}.edit-category-lists-in-dropdown[_ngcontent-%COMP%]{border-top:1px solid var(--gray-60, #C8C6C4);display:flex;flex-direction:column}.edit-category-lists-button[_ngcontent-%COMP%], .create-category-list-button[_ngcontent-%COMP%]{width:100%;background-color:transparent;border:none;font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);font-size:var(--md-font-size, 14px);font-weight:var(--font-weight-regular, 400);color:var(--fluent-theme-neutral-primary-color, #323130)}.edit-category-lists-button[_ngcontent-%COMP%]:hover, .create-category-list-button[_ngcontent-%COMP%]:hover, .edit-category-lists-button[_ngcontent-%COMP%]:active, .create-category-list-button[_ngcontent-%COMP%]:active{background-color:var(--fluent-theme-neutral-quarter-alt-color, #E1DFDD)}']}),X}()},90127:function(pt,Ct,M){"use strict";M.d(Ct,{D:function(){return qe}});var w=M(62458),b=M(50423),e=M(9380),j=M(82621),qe=function(){function te(Le,tt){this.featureSwitchServices=Le,this.formatValuePipe=tt}return te.prototype.transform=function(Le,tt,Ge,He,Z){var Ee;return void 0===He&&(He=!0),void 0===Z&&(Z="\u2014"),this.featureSwitchServices.featureSwitches.goalsCategoricalValues&&tt?_.isNil(Le)?Z:(w.fF.assert(function(){return _.isNumber(Le)},"formatGoalValue transform value"),null===(Ee=tt[Le])||void 0===Ee?void 0:Ee.displayName):this.formatValuePipe.transform(Le,Ge,He,Z)},te.\u0275fac=function(tt){return new(tt||te)(b.\u0275\u0275directiveInject(e.vZ,16),b.\u0275\u0275directiveInject(j.c,16))},te.\u0275pipe=b.\u0275\u0275definePipe({name:"formatGoalValue",type:te,pure:!0}),te}()},82621:function(pt,Ct,M){"use strict";M.d(Ct,{c:function(){return qe}});var w=M(62458),b=M(58098),e=M(72489),j=M(50423),qe=function(){function te(){}return te.prototype.transform=function(Le,tt,Ge,He){if(void 0===Ge&&(Ge=!0),void 0===He&&(He="\u2014"),w.fF.assert(function(){return _.isNil(Le)||te.isPrimitiveValue(Le)},"Should only use FormatValuePipe on PrimitiveValue type"),_.isNil(Le)||!te.isPrimitiveValue(Le))return He;tt=tt??te.getDefaultFormatString(Le);var Z=(0,e.Ue)({format:tt,formatSingleValues:!0,columnType:void 0});return Ge&&_.isNumber(Le)&&(Z=(0,e.Ue)({format:tt,value:_.isNumber(Le)?Le:0,precision:Number.NaN,displayUnitSystemType:b.V.WholeUnits,formatSingleValues:!1,allowFormatBeautification:!0,columnType:void 0})),Z.format(Le)},te.getDefaultFormatString=function(Le){var tt=te.valueTypeDescriptorFromPrimitiveValue(Le);if(tt.integer){if(Le<te.MIN_INTEGER_VALUE_FOR_DISPLAY_UNITS)return te.INT_FORMAT_STRING_NO_DISPLAY_UNITS;var He=(0,e.Ue)({value:_.isNumber(Le)?Le:0}).displayUnit.project(Le);return _.isInteger(He)?te.INT_FORMAT_STRING_NO_DISPLAY_UNITS:te.NUMERIC_FORMAT_STRING}return(0,e.v1)(tt)},te.isPrimitiveValue=function(Le){return!!(_.isString(Le)||_.isNumber(Le)||_.isBoolean(Le)||_.isDate(Le))},te.valueTypeDescriptorFromPrimitiveValue=function(Le){return _.isDate(Le)?{dateTime:!0}:_.isInteger(Le)?{integer:!0}:_.isNumber(Le)?{numeric:!0}:_.isBoolean(Le)?{bool:!0}:_.isString(Le)?{text:!0}:(w.fF.assert(function(){return!Le},"Unsupported primitive value"),{none:!0})},te.INT_FORMAT_STRING_NO_DISPLAY_UNITS="#,0",te.NUMERIC_FORMAT_STRING="#,0.00",te.MIN_INTEGER_VALUE_FOR_DISPLAY_UNITS=1e3,te.\u0275fac=function(tt){return new(tt||te)},te.\u0275pipe=j.\u0275\u0275definePipe({name:"formatValue",type:te,pure:!0}),te}()},76777:function(pt,Ct,M){"use strict";M.d(Ct,{H:function(){return ie}}),M(5432);var b=M(90127),e=M(82621),j=M(77476),qe=M(48205),te=M(79061),Le=M(91382),tt=M(93367),Ge=M(94841),He=M(45411),Z=M(16095),Ee=M(50423),se=M(54485),ie=function(){function ye(W){M.e("value-formatting").then(M.bind(M,24854)).then(function(ne){W.registerIcons(ne.iconSpriteSheet.sprite)})}return ye.\u0275fac=function(ne){return new(ne||ye)(Ee.\u0275\u0275inject(se.u))},ye.\u0275mod=Ee.\u0275\u0275defineNgModule({type:ye}),ye.\u0275inj=Ee.\u0275\u0275defineInjector({providers:[b.D,e.c],imports:[j.CommonModule,te.v,qe.uw,Le.d,Ge.b,tt.U,He.m,Z.Z]}),ye}()},87491:function(pt,Ct,M){var w=M(51968),e=M(20806)(w);e.push([pt.id,"",""]),pt.exports=e}}]);