"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["tableEx"],{52073:function(Le,me,D){function k(U,S){var C=S.getHierarchyDepth(),n=S.getChildren(U);if(!_.isEmpty(n))for(var s=0,g=n;s<g.length;s++)C=Math.min(C,S.getLevel(g[s]));return C-S.getLevel(U)}function ue(U,S){return S.isLeaf(U)?U:ue(_.head(S.getChildren(U)),S)}function ee(U,S){return void 0!==S.getLeafIndex(U)?U:ee(_.head(S.getChildren(U)),S)}function J(U,S){return S.isLeaf(U)?U:J(_.last(S.getChildren(U)),S)}function ne(U,S){return void 0!==S.getLeafIndex(U)?U:ne(_.last(S.getChildren(U)),S)}function z(U,S){return S.getLeafIndex(ue(U,S))}function F(U,S){return S.getLeafIndex(ee(U,S))}function K(U,S){return S.getLeafIndex(J(U,S))}function A(U,S){return S.getLeafIndex(ne(U,S))}D.d(me,{LF:function(){return z},O3:function(){return A},hG:function(){return F},oj:function(){return J},pA:function(){return K},zG:function(){return k}})},15366:function(Le,me,D){D.d(me,{AV:function(){return m},DJ:function(){return I},DX:function(){return V},EO:function(){return U},FA:function(){return N},MN:function(){return z},Ms:function(){return F},Sv:function(){return g},_E:function(){return n},hw:function(){return A},sB:function(){return T},sW:function(){return s},yl:function(){return C}});var k=D(81337),ue=D(62458),ee=D(52073),J=D(7911),ne=D(44404),z=10,F=50,A=20,U=20,C=function(){function f(){}return f.getAncestorsToMeasure=function(l,u){for(var h=[];;){var p=u.getParent(l);if(!p||!u.isLastItem(l,u.getChildren(p)))break;h.push({node:p,size:-1}),l=p}return h},f.getSizeDifference=function(l,u,h,p){for(var R=0,b=0,w=l;b<w.length;b++)R=Math.max(R,this.getItemSizeDifference(w[b],u,h,p));return R},f.getItemSizeDifference=function(l,u,h,p){for(var b=0,w=(0,ee.LF)(l.node,h);w<=u;w++)if((b+=p(w))>=l.size)return 0;return l.size-b},f.getPageIndex=function(l,u){return Math.floor(l/u)},f.itemRangeToPageRange=function(l,u,h){var p=this.getPageIndex(l,h),R=this.getPageIndex(u,h);if(p===R)return[{pageIndex:p,startIndex:l%h,endIndex:u%h}];var b=[];b.push({pageIndex:p,startIndex:l%h,endIndex:h-1});for(var w=p+1;w<R;w++)b.push({pageIndex:w,startIndex:0,endIndex:h-1});return b.push({pageIndex:R,startIndex:0,endIndex:u%h}),b},f}(),n=function(){function f(){}return f.linesOverlapVertically=function(l,u,h,p){return!(h>l+u||h+p<l)},f.isRowMeasured=function(l,u){return this.getMeasuredRowCount(u)>l},f.getMeasuredRowCount=function(l){var u=l.getPageRows();return _.isEmpty(u)?0:(u.length-1)*A+_.last(u).getRowHeights().length},f.remeasureRows=function(l,u,h,p,R,b,w){for(var a=0,e=C.itemRangeToPageRange(p,R,A);a<e.length;a++){var t=e[a];w.measurePage(w.getPageRows()[t.pageIndex],l,u,h,p,b,U,t.startIndex,t.endIndex-t.startIndex+1)}},f.getVisibleRowStart=function(l,u,h){var p=h.getRowHeight(l.firstLeafIndex);return{rowIndex:l.firstLeafIndex,visibleHeight:p-u+l.firstLeafTop}},f.getVisibleRange=function(l,u,h,p,R){var b=this.getVisiblePageRange(l,u,h);if(!b)return null;var w=this.getFirstVisibleIndex(b.firstPageRow,b.firstPageIndex,b.firstPageTop,l,u);if(null!=w){var a,B=this.getLastVisibleIndex(b.lastPageRow,b.lastPageIndex,b.lastPageTop,l,u);if(null!=B)return null!=p&&p>=0&&null!=R&&R>=0&&(a=Math.max(B,w.leafIndex+p-1),a=Math.min(a,R)),{firstLeafIndex:w.leafIndex,firstLeafTop:w.top,lastLeafIndex:a??B}}},f.getVisiblePageRange=function(l,u,h){for(var p=0,R=0,b=null,B=0,a=h.getPageRows();B<a.length;B++){var e=a[B],t=e.getHeight();if(this.linesOverlapVertically(p,t,l,u))b?(b.lastPageRow=e,b.lastPageIndex=R,b.lastPageTop=p):b={firstPageRow:e,firstPageIndex:R,firstPageTop:p,lastPageRow:e,lastPageIndex:R,lastPageTop:p};else if(b)break;p+=t,R++}return b},f.getFirstVisibleIndex=function(l,u,h,p,R){for(var b=0,w=h,a=0,e=l.getRowHeights();a<e.length;a++){var t=e[a];if(this.linesOverlapVertically(w,t,p,R))return{leafIndex:u*A+b,top:w};w+=t,b++}},f.getLastVisibleIndex=function(l,u,h,p,R){for(var B,b=0,w=h,a=0,e=l.getRowHeights();a<e.length;a++){var t=e[a];this.linesOverlapVertically(w,t,p,R)&&(B=u*A+b),w+=t,b++}return B},f.getBounds=function(l,u){var h=C.getPageIndex(l,A);if(!(h>=u.getPageRows().length)){for(var p=u.getPageRows()[h],R=u.getPageRowTop(p),b=l%A,w=0;w<b;w++)R+=p.getRowHeights()[w];return{top:R,height:p.getRowHeights()[b]}}},f.getOffset=function(l,u){var h=this.getBounds(l.rowIndex,u);return h?l.alignBottom?l.visibleHeight>=h.height?h.top+h.height:h.top+l.visibleHeight:l.visibleHeight>=h.height?h.top:h.top+h.height-l.visibleHeight:0},f}(),s=function(){function f(){}return f.linesOverlapHorizontally=function(l,u,h,p){return!(h>l+u||h+p<l)},f.isColumnMeasured=function(l,u){return this.getMeasuredColumnCount(u)>l},f.getMeasuredColumnCount=function(l){var u=l.getPageColumns();return _.isEmpty(u)?0:(u.length-1)*z+_.last(u).getColumnWidths().length},f.remeasureColumn=function(l,u,h,p,R,b){var w=b.getPageColumn(l,u,h,p,R);b.measurePage(w,u,h,p,R,F,l%z,1)},f.getVisibleColumnStart=function(l,u,h){var p=h.getColumnWidth(l.firstLeafIndex);return{columnIndex:l.firstLeafIndex,visibleWidth:p-u+l.firstLeafLeft}},f.getVisibleRange=function(l,u,h,p,R){var b=this.getVisiblePageRange(l,u,h);if(!b)return null;var w=this.getFirstVisibleIndex(b.firstPageColumn,b.firstPageIndex,b.firstPageLeft,l,u);if(null!=w){var a,B=this.getLastVisibleIndex(b.lastPageColumn,b.lastPageIndex,b.lastPageLeft,l,u);if(null!=B)return null!=p&&p>=0&&null!=R&&R>=0&&(a=Math.max(B,w.leafIndex+p-1),a=Math.min(a,R)),{firstLeafIndex:w.leafIndex,firstLeafLeft:w.left,lastLeafIndex:a??B}}},f.getVisiblePageRange=function(l,u,h){for(var p=0,R=0,b=null,w=0,B=h.getPageColumns();w<B.length;w++){var a=B[w],e=a.getWidth();if(this.linesOverlapHorizontally(p,e,l,u))b?(b.lastPageColumn=a,b.lastPageIndex=R,b.lastPageLeft=p):b={firstPageColumn:a,firstPageIndex:R,firstPageLeft:p,lastPageColumn:a,lastPageIndex:R,lastPageLeft:p};else if(b)break;p+=e,R++}return b},f.getFirstVisibleIndex=function(l,u,h,p,R){for(var b=0,w=h,a=0,e=l.getColumnWidths();a<e.length;a++){var t=e[a];if(this.linesOverlapHorizontally(w,t,p,R))return{leafIndex:u*z+b,left:w};w+=t,b++}return null},f.getLastVisibleIndex=function(l,u,h,p,R){for(var B,b=0,w=h,a=0,e=l.getColumnWidths();a<e.length;a++){var t=e[a];this.linesOverlapHorizontally(w,t,p,R)&&(B=u*z+b),w+=t,b++}return B},f.getBounds=function(l,u){var h=C.getPageIndex(l,z);if(!(h>=u.getPageColumns().length)){for(var p=u.getPageColumns()[h],R=u.getPageColumnLeft(p),b=l%z,w=p.getColumnWidths(),B=0;B<b;B++)R+=w[B];return{left:R,width:w[b]}}},f.getOffset=function(l,u){var h=this.getBounds(l.columnIndex,u);return h?l.alignRight?l.visibleWidth>=h.width?h.left+h.width:h.left+l.visibleWidth:l.visibleWidth>=h.width?h.left:h.left+h.width-l.visibleWidth:0},f}(),g=function(){function f(l,u){this.pageColumns=[],this.measureElement=l,this.sizeManager=u}return f.prototype.canAddPageColumn=function(l){return this.pageColumns.length<this.getMaxPageColumnCount(l)},f.prototype.getMaxPageColumnCount=function(l){return Math.ceil(l.getHierarchyLeafCount()/z)},f.prototype.getPageColumns=function(){return this.pageColumns},f.prototype.getPageColumnStartIndex=function(l){var u=this.pageColumns.indexOf(l);return-1===u?-1:u*z},f.prototype.getPageColumnLeft=function(l){for(var u=0,h=0,p=this.pageColumns;h<p.length;h++){var R=p[h];if(l===R)break;u+=R.getWidth()}return u},f.prototype.getColumnsWidth=function(){for(var l=0,u=0,h=this.pageColumns;u<h.length;u++)l+=h[u].getWidth();return l},f.prototype.clear=function(){this.pageColumns=[]},f.prototype.measureNextPage=function(l,u,h,p){var R=new J.VG;this.getPageColumns().push(R),this.measurePage(R,l,u,h,p,F)},f.prototype.getWidestCellBindingString=function(l,u,h,p,R,b,w){for(var B={item:null,width:-1},a=0;a<b;a++)this.updateWidestItemFromBodyCell(p.getHierarchyLeafAt(a+w),l,h,p,B);if(u){var e=p.getFloatingHierarchyLeafCount();for(a=0;a<e;a++)this.updateWidestItemFromBodyCell(p.getFloatingHierarchyLeafAt(a),l,h,p,B)}var i,t=h.getApproximateColumnHeaderWidth(l);return t>B.width&&(B.item=l,B.width=t),i=B.item===l?h.getColumnHeaderBinding(B.item,!0):h.getBodyCellBinding(B.item,!0),J.bG.build(i,f.measureRequiredStyle)},f.prototype.measurePage=function(l,u,h,p,R,b,w,B){var a=this.getPageColumnStartIndex(l);void 0===w&&(w=0),void 0===B&&(B=Math.min(p.getHierarchyLeafCount()-a,z)+w);for(var e=Math.min(h.getHierarchyLeafCount()-R,b),t="",i=h.getFloatingHierarchyItems(),o=0;o<B;o++){var d=p.getHierarchyLeafAt(o+w+a);void 0===(l.getColumnWidths()[o+w]=this.sizeManager.getColumnWidth(d))&&(t+=this.getWidestCellBindingString(d,i,u,h,p,e,R))}if(t){this.measureElement.insertAdjacentHTML("beforeend",t);var M=this.measureElement.firstChild;for(o=0;o<B;o++)void 0===l.getColumnWidths()[o+w]&&(l.getColumnWidths()[o+w]=M.offsetWidth+1,M=M.nextSibling);this.measureElement.innerHTML="",this.adjustItemsWidth(l,u,p,a,w,B)}},f.prototype.updateWidestItemFromBodyCell=function(l,u,h,p,R){var b=p.getIntersection(l,u),w=h.getApproximateBodyCellWidth(b);w>R.width&&(R.item=b,R.width=w)},f.prototype.adjustItemsWidth=function(l,u,h,p,R,b){for(var w=0;w<b;w++){var B=h.getHierarchyLeafAt(w+R+p);void 0===this.sizeManager.getColumnWidth(B)&&this.adjustItemWidth(l,w+R,p,u,h,B)}},f.prototype.adjustItemWidth=function(l,u,h,p,R,b){var w=this,B=C.getAncestorsToMeasure(b,R);_.isEmpty(B)||(this.measureAncestors(B,p),l.getColumnWidths()[u]+=C.getSizeDifference(B,u+h,R,function(a){return w.getColumnWidth(a)}))},f.prototype.measureAncestors=function(l,u){for(var h="",p=0,R=l;p<R.length;p++){var w=u.getColumnHeaderBinding(R[p].node,!0);h+=J.bG.build(w,f.measureRequiredStyle)}this.measureElement.insertAdjacentHTML("beforeend",h);for(var B=this.measureElement.firstChild,a=0,e=l;a<e.length;a++)e[a].size=B.offsetWidth+1,B=B.nextSibling;this.measureElement.innerHTML=""},f.prototype.getColumnWidth=function(l,u,h,p,R){return this.getPageColumn(l,u,h,p,R).getColumnWidths()[l%z]},f.prototype.setColumnWidth=function(l,u){this.getPageColumn(l).getColumnWidths()[l%z]=u},f.prototype.getPageColumn=function(l,u,h,p,R){var b=this.getPageIndex(l);if(u&&b>=this.pageColumns.length)for(var w=b-this.pageColumns.length+1,B=0;B<w;B++)this.measureNextPage(u,h,p,R);return this.pageColumns[b]},f.prototype.getPageIndex=function(l){return C.getPageIndex(l,z)},f.prototype.getLastMeasuredIndex=function(){var l=this.pageColumns.length;if(0===l)return-1;var u=_.last(this.pageColumns);return(l-1)*z+(u.getColumnWidths().length-1)},f.measureRequiredStyle={"box-sizing":"border-box",display:"inline-flex"},f}(),L=function(){function f(l,u,h,p){this.pageRows=[],this.measureElement=l,this.columnWidthMeasureManager=u,this.rowLevelWidthMeasureManager=h,this.sizeManager=p}return f.prototype.clear=function(){this.pageRows=[],this.clearFloatingRows()},f.prototype.clearFloatingRows=function(){this.floatingPageRow=new J.BJ},f.prototype.ensureLastPageComplete=function(l,u,h,p,R,b){if(0===this.pageRows.length)return-1;var B=this.pageRows.length-1,a=this.pageRows[B],e=a.getRowHeights().length;return e<A&&this.gotMoreRows(a,u)&&(this.measurePage(a,l,u,h,p,R,b,a.getRowHeights().length-1),a.getRowHeights().length>e)?B:-1},f.prototype.measureNextPage=function(l,u,h,p,R){var b=new J.BJ;this.getPageRows().push(b),this.measurePage(b,l,u,h,p,R,U)},f.prototype.measureFloatingRows=function(l,u,h,p,R,b,w){if(_.isEmpty(this.floatingPageRow.getRowHeights())){var B=u.getFloatingHierarchyItems();if(!_.isEmpty(B)){for(var a=Math.min(h.getHierarchyLeafCount()-R,U),e="",t=u.getFloatingHierarchyLeafCount(),i=0;i<t;i++){var o=u.getFloatingHierarchyLeafAt(i);this.floatingPageRow.getRowHeights()[i]=this.sizeManager.getRowHeight(o),void 0===this.floatingPageRow.getRowHeights()[i]&&(e+=this.getHeighestCellBindingString(o,l,u,h,a,R,p,b,w))}if(e){this.measureElement.insertAdjacentHTML("beforeend",e);var d=this.measureElement.firstChild;for(i=0;i<t;i++)void 0===this.floatingPageRow.getRowHeights()[i]&&(this.floatingPageRow.getRowHeights()[i]=d.offsetHeight,d=d.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(this.floatingPageRow,l,u,0,0,t)}}}},f.prototype.getPageIndex=function(l){return C.getPageIndex(l,A)},f.prototype.getMeasureRequiredStyle=function(l){return{"box-sizing":"border-box",width:(0,ne.S)(l)}},f.prototype.gotMoreRows=function(l,u){return u.getHierarchyLeafCount()-this.getPageRowStartIndex(l)-l.getRowHeights().length>0},f.prototype.measurePage=function(l,u,h,p,R,b,w,B,a){var e=this.getPageRowStartIndex(l);void 0===B&&(B=0),void 0===a&&(a=Math.min(h.getHierarchyLeafCount()-e,A)-B);for(var t=Math.min(p.getHierarchyLeafCount()-b,w),i="",o=0;o<a;o++){var d=h.getHierarchyLeafAt(o+B+e);void 0===(l.getRowHeights()[o+B]=this.sizeManager.getRowHeight(d))&&(i+=this.getHeighestCellBindingString(d,u,h,p,t,b,R))}if(i){this.measureElement.insertAdjacentHTML("beforeend",i);var M=this.measureElement.firstChild;for(o=0;o<a;o++)void 0===l.getRowHeights()[o+B]&&(l.getRowHeights()[o+B]=M.offsetHeight,M=M.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(l,u,h,e,B,a)}},f.prototype.getHeighestCellBindingString=function(l,u,h,p,R,b,w,B,a){for(var e={item:null,width:-1,height:-1},t=0;t<R;t++){var i=p.getHierarchyLeafAt(t+b),o=h.getIntersection(l,i),d=this.columnWidthMeasureManager.getColumnWidth(t+b,u,h,p,w),H=u.getApproximateBodyCellHeight(o,d);H>e.height&&(e.item=o,e.width=d,e.height=H)}var X,M=this.getItemWidth(l,h),x=u.getApproximateRowHeaderHeight(l,M);return x>e.height&&(e.item=l,e.height=x,e.width=M),X=e.item===l?u.getRowHeaderBinding(e.item,!0):u.getBodyCellBinding(e.item,!0,void 0,void 0,void 0,B,void 0,a),J.bG.build(X,this.getMeasureRequiredStyle(e.width))},f.prototype.getItemWidth=function(l,u){return ue.fF.assertFail("abstract method"),0},f.prototype.adjustItemsHeight=function(l,u,h,p,R,b){ue.fF.assertFail("abstract method")},f.prototype.getMaxPageRowCount=function(l){return Math.ceil(l.getHierarchyLeafCount()/A)},f.prototype.getPageRows=function(){return this.pageRows},f.prototype.getFloatingPageRow=function(){return this.floatingPageRow},f.prototype.getFloatingRowHeights=function(){return _.sum(this.floatingPageRow.getRowHeights())},f.prototype.canAddPageRow=function(l){return this.pageRows.length<this.getMaxPageRowCount(l)},f.prototype.getPageRowStartIndex=function(l){if(l===this.floatingPageRow)return 0;var u=this.pageRows.indexOf(l);return-1===u?-1:u*A},f.prototype.getPageRowTop=function(l){if(l===this.floatingPageRow)return 0;for(var u=0,h=0,p=this.pageRows;h<p.length;h++){var R=p[h];if(l===R)break;u+=R.getHeight()}return u},f.prototype.getRowsHeight=function(){for(var l=0,u=0,h=this.pageRows;u<h.length;u++)l+=h[u].getHeight();return l},f.prototype.getRowHeight=function(l,u,h,p,R,b){return this.getPageRow(l,u,h,p,b).getRowHeights()[l%A]},f.prototype.getFloatingRowHeight=function(l){return this.floatingPageRow.getRowHeights()[l]},f.prototype.getPageRow=function(l,u,h,p,R,b){var w=this.getPageIndex(l);if(u&&w>this.pageRows.length)for(var B=w-this.pageRows.length+1,a=0;a<B;a++)this.measureNextPage(u,h,p,R,b);return this.pageRows[w]},f.prototype.getLastMeasuredIndex=function(){var l=this.pageRows.length;if(0===l)return-1;var u=_.last(this.pageRows);return(l-1)*A+(u.getRowHeights().length-1)},f}(),I=function(f){function l(){return null!==f&&f.apply(this,arguments)||this}return(0,k.ZT)(l,f),l.prototype.getItemWidth=function(u,h){return this.rowLevelWidthMeasureManager.getWidth(h.getLevel(u),(0,ee.zG)(u,h))},l.prototype.adjustItemsHeight=function(u,h,p,R,b,w){for(var B=0;B<w;B++){var a=p.getHierarchyLeafAt(B+b+R);void 0===this.sizeManager.getRowHeight(a)&&this.adjustItemHeight(u,B+b,R,h,p,a)}},l.prototype.adjustItemHeight=function(u,h,p,R,b,w){var B=this,a=C.getAncestorsToMeasure(w,b);_.isEmpty(a)||(this.measureAncestors(a,R,b),u.getRowHeights()[h]+=C.getSizeDifference(a,p+h,b,function(e){return u===B.getFloatingPageRow()?B.getFloatingRowHeight(e):B.getRowHeight(e)}))},l.prototype.measureAncestors=function(u,h,p){for(var R="",b=0,w=u;b<w.length;b++){var a=h.getRowHeaderBinding((B=w[b]).node,!0);R+=J.bG.build(a,this.getMeasureRequiredStyle(this.getItemWidth(B.node,p)))}this.measureElement.insertAdjacentHTML("beforeend",R);for(var e=this.measureElement.firstChild,t=0,i=u;t<i.length;t++){var B;(B=i[t]).size=e.offsetHeight,e=e.nextSibling}this.measureElement.innerHTML=""},l}(L),m=function(f){function l(){return null!==f&&f.apply(this,arguments)||this}return(0,k.ZT)(l,f),l.prototype.getItemWidth=function(u,h){return this.rowLevelWidthMeasureManager.getLevelWidth(h.getLevel(u))},l.prototype.adjustItemsHeight=function(u,h,p,R,b,w){},l}(L),T=function(){function f(l,u,h,p){this.columnLevelHeights=[],this.measureElement=l,this.columnWidthMeasureManager=u,this.rowLevelWidthMeasureManager=h,this.sizeManager=p}return f.prototype.clear=function(){this.columnLevelHeights=[]},f.prototype.getMeasureRequiredStyle=function(l){return{"box-sizing":"border-box",width:(0,ne.S)(l)}},f.prototype.measure=function(l,u,h,p,R,b,w){if(0===this.columnLevelHeights.length){for(var B={done:!1,levels:[],spanningHeaders:[],leafCount:0},a=h.getHierarchyDepth(),e=u.getHierarchyDepth(),t=0;t<a;t++)(void 0===w||w===t)&&(this.columnLevelHeights[t]=this.sizeManager.getColumnLevelHeight(u.getCorner(e-1,t))),B.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});var i=h.getHierarchyItems();i&&this.getHeighestColumnHeaders(i,B,l,u,h,p,R,b);for(var o=0;o<e;o++)for(var d=0;d<a;d++)if(void 0===this.columnLevelHeights[d]){var H=u.getCorner(o,d),M=this.rowLevelWidthMeasureManager.getLevelWidth(o),x=l.getApproximateCornerCellHeight(H,M);x>B.levels[d].largestItemHeight&&(B.levels[d].isHeader=!1,B.levels[d].largestItem=H,B.levels[d].largestItemHeight=x,B.levels[d].largestItemWidth=M)}for(var X="",j=0,Q=B.levels;j<Q.length;j++)if((W=Q[j]).largestItem){var Y=this.getMeasureRequiredStyle(W.largestItemWidth);if(W.isHeader){var Z=l.getColumnHeaderBinding(W.largestItem,!0);X+=J.bG.build(Z,Y)}else Z=l.getCornerCellBinding(W.largestItem,!0),X+=J.bG.build(Z,Y)}if(X){this.measureElement.insertAdjacentHTML("beforeend",X);for(var q=this.measureElement.firstChild,ie=0,ae=0,le=B.levels;ae<le.length;ae++){var W;(W=le[ae]).largestItem&&((void 0===w||w===ie)&&(this.columnLevelHeights[ie]=q.offsetHeight),q=q.nextSibling),ie++}this.measureElement.innerHTML="",this.adjustLevelHeightsFromSpanningHeaders(B,l,u,h,p)}}},f.prototype.adjustLevelHeightsFromSpanningHeaders=function(l,u,h,p,R){for(var b="",w=0,B=l.spanningHeaders;w<B.length;w++)if(l.levels[(a=B[w]).levelToAdjust].largestItem){var e=this.getMeasureRequiredStyle(this.getHeaderWidth(a.item,u,h,p,R)),t=u.getColumnHeaderBinding(a.item,!0);b+=J.bG.build(t,e)}if(b){this.measureElement.insertAdjacentHTML("beforeend",b);for(var i=this.measureElement.firstChild,o=0,d=l.spanningHeaders;o<d.length;o++){var a;l.levels[(a=d[o]).levelToAdjust].largestItem&&(this.adjustLevelFromSpanningHeader(a.item,a.level,a.levelToAdjust,i.offsetHeight,p),i=i.nextSibling)}this.measureElement.innerHTML=""}},f.prototype.adjustLevelFromSpanningHeader=function(l,u,h,p,R){for(var b=0,w=u;w<=h;w++)b+=this.getLevelHeight(w);p>b&&(this.columnLevelHeights[h]+=p-b)},f.prototype.getHeighestColumnHeaders=function(l,u,h,p,R,b,w,B){for(var a=0,e=l;a<e.length;a++){var t=e[a];if(u.done)return;var i=R.isLeaf(t),o=R.getLevel(t),d=(0,ee.zG)(t,R),H=(0,ee.pA)(t,R)>=w;if(H)if(1===d){if(void 0===this.columnLevelHeights[o]){var M=this.getHeaderWidth(t,h,p,R,b),x=h.getApproximateColumnHeaderHeight(t,M);x>u.levels[o].largestItemHeight&&(u.levels[o].largestItem=t,u.levels[o].largestItemHeight=x,u.levels[o].largestItemWidth=M)}}else u.spanningHeaders.push({item:t,level:o,levelToAdjust:d+o-1});var X=R.getChildren(t);X&&this.getHeighestColumnHeaders(X,u,h,p,R,b,w,B),i&&H&&u.leafCount++,u.leafCount===B&&(u.done=!0)}},f.prototype.getHeadersHeight=function(){for(var l=0,u=0,h=this.columnLevelHeights;u<h.length;u++)l+=h[u];return l},f.prototype.getLevelTop=function(l){for(var u=0,h=0;h<l;h++)u+=this.columnLevelHeights[h];return u},f.prototype.getLevelHeight=function(l){return this.columnLevelHeights[l]},f.prototype.getHeaderWidth=function(l,u,h,p,R){for(var b=(0,ee.LF)(l,p),w=(0,ee.pA)(l,p),B=0,a=b;a<=w;a++)B+=this.columnWidthMeasureManager.getColumnWidth(a,u,h,p,R);return B},f}(),V=function(){function f(l,u){this.rowLevelWidths=[],this.measureElement=l,this.sizeManager=u}return f.prototype.clear=function(){this.rowLevelWidths=[]},f.prototype.measure=function(l,u,h,p,R,b){if(0===this.rowLevelWidths.length||void 0!==b){for(var w={done:!1,levels:[],spanningHeaders:[],leafCount:0},B=u.getHierarchyDepth(),a=h.getHierarchyDepth(),e=0;e<B;e++)(void 0===b||b===e)&&(this.rowLevelWidths[e]=this.sizeManager.getRowLevelWidth(u.getCorner(e,a-1))),w.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});this.getWidestRowHeaders(u.getHierarchyItems(),w,l,u,p,R);var t=u.getFloatingHierarchyItems();_.isEmpty(t)||(w.done=!1,w.leafCount=0,this.getWidestRowHeaders(t,w,l,u,-1,u.getFloatingHierarchyLeafCount()));for(var i=0;i<a;i++)for(var o=0;o<B;o++)if(void 0===this.rowLevelWidths[o]){var d=u.getCorner(o,i),H=l.getApproximateCornerCellWidth(d);H>w.levels[o].largestItemWidth&&(w.levels[o].isHeader=!1,w.levels[o].largestItem=d,w.levels[o].largestItemWidth=H)}for(var M="",x=0,X=w.levels;x<X.length;x++)if((j=X[x]).largestItem)if(j.isHeader){var Q=l.getRowHeaderBinding(j.largestItem,!0);M+=J.bG.build(Q,f.measureRequiredStyles)}else Q=l.getCornerCellBinding(j.largestItem,!0),M+=J.bG.build(Q,f.measureRequiredStyles);if(M){this.measureElement.insertAdjacentHTML("beforeend",M);for(var W=this.measureElement.firstChild,Y=0,Z=0,q=w.levels;Z<q.length;Z++){var j;(j=q[Z]).largestItem&&((void 0===b||b===Y)&&(this.rowLevelWidths[Y]=W.offsetWidth+1),W=W.nextSibling),Y++}this.measureElement.innerHTML="",this.adjustLevelWidthsFromSpanningHeaders(w,l,u)}}},f.prototype.adjustLevelWidthsFromSpanningHeaders=function(l,u,h){for(var p="",R=0,b=l.spanningHeaders;R<b.length;R++)if(l.levels[(w=b[R]).levelToAdjust].largestItem){var B=u.getRowHeaderBinding(w.item,!0);p+=J.bG.build(B,f.measureRequiredStyles)}if(p){this.measureElement.insertAdjacentHTML("beforeend",p);for(var a=this.measureElement.firstChild,e=0,t=l.spanningHeaders;e<t.length;e++){var w;l.levels[(w=t[e]).levelToAdjust].largestItem&&(this.adjustLevelWidthFromSpanningHeader(w.item,w.level,w.levelToAdjust,a.offsetWidth,h),a=a.nextSibling)}this.measureElement.innerHTML=""}},f.prototype.adjustLevelWidthFromSpanningHeader=function(l,u,h,p,R){for(var b=0,w=u;w<=h;w++)b+=this.getLevelWidth(w);p>b&&(this.rowLevelWidths[h]+=p-b)},f.prototype.getWidestRowHeaders=function(l,u,h,p,R,b){for(var w=0,B=l;w<B.length;w++){var a=B[w];if(u.done)return;var e=p.isLeaf(a),t=p.getLevel(a),i=(0,ee.zG)(a,p),o=(0,ee.pA)(a,p)>=R;if(o)if(1===i){if(void 0===this.rowLevelWidths[t]){var d=h.getApproximateRowHeaderWidth(a);d>u.levels[t].largestItemWidth&&(u.levels[t].largestItem=a,u.levels[t].largestItemWidth=d)}}else u.spanningHeaders.push({item:a,level:t,levelToAdjust:i+t-1});var H=p.getChildren(a);H&&this.getWidestRowHeaders(H,u,h,p,R,b),e&&o&&u.leafCount++,u.leafCount===b&&(u.done=!0)}},f.prototype.getHeadersWidth=function(){for(var l=0,u=0,h=this.rowLevelWidths;u<h.length;u++)l+=h[u];return l},f.prototype.getLevelLeft=function(l){for(var u=0,h=0;h<l;h++)u+=this.rowLevelWidths[h];return u},f.prototype.getLevelWidth=function(l){return this.rowLevelWidths[l]},f.prototype.setLevelWidth=function(l,u){this.rowLevelWidths[l]=u},f.prototype.getWidth=function(l,u){for(var h=0,p=l;p<l+u;p++)h+=this.getLevelWidth(p);return h},f.measureRequiredStyles={"box-sizing":"border-box",display:"inline-flex"},f}(),N=function(){function f(l,u){this.measureElement=l,this.sizeManager=u}return f.prototype.clear=function(){this.width=void 0},f.prototype.getHeaderBindingString=function(l,u){var h=u.getRowHeaderBinding(l,!0);return J.bG.build(h,V.measureRequiredStyles)},f.prototype.measure=function(l,u,h,p,R,b){if((void 0===this.width||void 0!==b)&&(this.width=this.sizeManager.getRowLevelWidth(u.getCorner(0,h.getHierarchyDepth()-1)),void 0===this.width)){for(var w="",B=Math.min(u.getHierarchyLeafCount()-p,R),a=0;a<B;a++)w+=this.getHeaderBindingString(u.getHierarchyLeafAt(a+p),l);var e=u.getFloatingHierarchyItems();if(!_.isEmpty(e)){var t=u.getFloatingHierarchyLeafCount();for(a=0;a<t;a++)w+=this.getHeaderBindingString(u.getFloatingHierarchyLeafAt(a),l)}if(u.getHierarchyDepth()>0)for(a=0;a<h.getHierarchyDepth();a++){var i=u.getCorner(0,a),o=l.getCornerCellBinding(i,!0);w+=J.bG.build(o,V.measureRequiredStyles)}this.measureElement.insertAdjacentHTML("beforeend",w);for(var d=this.measureElement.firstChild,H=0;d;)H=Math.max(H,d.offsetWidth+1),d=d.nextSibling;this.measureElement.innerHTML="",this.width=H}},f.prototype.getHeadersWidth=function(){return this.width},f.prototype.getLevelWidth=function(l){return this.width},f.prototype.setLevelWidth=function(l,u){this.width=u},f.prototype.getLevelLeft=function(l){return 0},f}()},79465:function(Le,me,D){D.d(me,{BM:function(){return k},aP:function(){return ne},p0:function(){return ue},xU:function(){return J},y2:function(){return ee}});var k=function(z){return z[z.Incremental=0]="Incremental",z[z.ClearRendering=1]="ClearRendering",z[z.ClearMeasurement=2]="ClearMeasurement",z[z.ClearMeasurementOnly=3]="ClearMeasurementOnly",z[z.ResizeColumn=4]="ResizeColumn",z}({}),ue=function(z){return z[z.Header=0]="Header",z[z.Body=1]="Body",z[z.Footer=2]="Footer",z[z.FooterHeader=3]="FooterHeader",z[z.MatrixRowHeader=4]="MatrixRowHeader",z[z.MatrixCorner=5]="MatrixCorner",z}({}),ee=function(z){return z[z.Table=0]="Table",z[z.Matrix=1]="Matrix",z}({}),J=function(z){return z[z.Blocked=0]="Blocked",z[z.Stepped=1]="Stepped",z}({}),ne=function(z){return z[z.Prefix=0]="Prefix",z[z.Main=1]="Main",z}({})},44404:function(Le,me,D){D.d(me,{S:function(){return ue}});var k=D(62458);function ue(ee){return k.fF.assertValue(null!=ee,"value should be defined"),0===ee?ee.toString():ee+"px"}},7911:function(Le,me,D){D.d(me,{BJ:function(){return ne},VG:function(){return J},bG:function(){return z}});var k=D(55007),ue=D(62458),ee=D(79602),J=function(){function F(){this.columnWidths=[]}return F.prototype.getColumnWidths=function(){return this.columnWidths},F.prototype.getWidth=function(){return _.sum(this.columnWidths)},F}(),ne=function(){function F(){this.rowHeights=[]}return F.prototype.getRowHeights=function(){return this.rowHeights},F.prototype.getHeight=function(){return _.sum(this.rowHeights)},F.prototype.clear=function(){this.rowHeights=[]},F}(),z=function(){function F(){}return F.build=function(K,A){if(void 0===A&&(A={}),null===K.tagName)return K.content;var U=K.tagName||"div",S="<"+U+" "+this.buildAttributes(K.attributes)+this.buildClassNames(K.classNames)+this.buildStyles(K.styleProperties,A)+">";if(_.isEmpty(K.children))null!=K.content&&(S+=K.content);else for(var C=0,n=K.children;C<n.length;C++)S+=F.build(n[C],null);return S+"</"+U+">"},F.buildMultiple=function(K){return _.map(K,function(A){return F.build(A)}).join("")},F.buildAttributes=function(K){var A="";if(K)for(var U in K)A+=U+"="+k.u3+K[U]+k.u3;return A},F.buildClassNames=function(K){if(!K||0===K.length)return"";for(var A='class="',U=0,S=K;U<S.length;U++)A+=S[U]+" ";return A+'"'},F.buildStyles=function(K,A){var U=!_.isEmpty(A),S=!_.isEmpty(K);if(!U&&!S)return"";var C="style="+k.u3;if(S)for(var n in K)C+=n+":"+K[n]+";";if(U)for(var s in A)C+=s+":"+A[s]+";";return C+k.u3},F.attachEventHandlers=function(K,A){if(A.clickHandler&&K.addEventListener("click",function(S){return A.clickHandler(S)}),A.contextMenuHandler&&K.addEventListener("contextmenu",function(S){return A.contextMenuHandler(S)}),A.scrollHandler&&ee.l.runOutsideAngular(function(){K.addEventListener("scroll",function(S){return A.scrollHandler(S)})}),!_.isEmpty(A.children)){ue.fF.assert(function(){return A.children.length===K.childNodes.length},"Element children mismatch");for(var U=0;U<A.children.length;U++)null!==A.children[U].tagName&&F.attachEventHandlers(K.childNodes[U],A.children[U])}},F.attachEventHandlersMultiple=function(K,A){var U=K;A.forEach(function(S){F.attachEventHandlers(U,S),U=U.nextElementSibling})},F}()},24133:function(Le,me,D){D.d(me,{d:function(){return B}});var k=D(81337),ue=D(11034),ee=D(62458),J=D(59107),ne=D(98094),z=D(79602),F=D(44102),K=D(93340),A=D(71090),U=D(52073),S=D(15366),C=D(44404),n=D(87914),s=D(79465),g=D(11184),L=function(){function a(e,t,i){this.onFocusChangedHandler=e,this.isA11yTable=t,this.isA11yMatrix=i}return Object.defineProperty(a.prototype,"CurrentFocus",{get:function(){return this.currentFocus},enumerable:!1,configurable:!0}),a.prototype.updateMeasureManagers=function(e,t){this.rowHeightMeasureManager=e,this.columnWidthMeasureManager=t},a.prototype.setAsFocusTableEx=function(e,t,i,o){ee.fF.assert(function(){return null!=e||i!==s.p0.Body},"body cells need row index"),i===s.p0.Header?this.currentFocus=o?{columnHeader:o}:{columnHeader:[t]}:i===s.p0.Body?this.currentFocus={bodyCell:{rowIndex:e,columnIndex:t}}:i===s.p0.Footer?this.currentFocus={floatingBodyCell:{rowIndex:e??0,columnIndex:t}}:i===s.p0.FooterHeader?this.currentFocus={floatingRowHeader:e}:i===s.p0.MatrixCorner?this.currentFocus={cornerCell:{rowLevel:t,columnLevel:e}}:i===s.p0.MatrixRowHeader?this.currentFocus=o?{rowHeader:o}:{rowHeader:[e]}:ee.fF.assertNever(i),this.updateFocusedItem()},a.prototype.updateFocusedItem=function(){if(ee.fF.assertValue(this.currentFocus,"No current focus"),this.currentFocus.columnHeader&&-1===this.currentFocus.columnHeader[0]||this.currentFocus.bodyCell&&-1===this.currentFocus.bodyCell.columnIndex||this.currentFocus.floatingBodyCell&&-1===this.currentFocus.floatingBodyCell.columnIndex)this.currentFocus.item=void 0;else{if(this.currentFocus.bodyCell){var e=this.rowNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.rowIndex),t=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.columnIndex);ee.fF.assertValue(e,"row leaf not found"),ee.fF.assertValue(t,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,t)}else this.currentFocus.columnHeader?this.currentFocus.item=this.columnNavigator.getNodeFromPath(this.currentFocus.columnHeader):this.currentFocus.rowHeader?this.currentFocus.item=this.rowNavigator.getNodeFromPath(this.currentFocus.rowHeader):this.currentFocus.cornerCell?this.currentFocus.item=this.rowNavigator.getCorner(this.currentFocus.cornerCell.rowLevel,this.currentFocus.cornerCell.columnLevel):this.currentFocus.floatingBodyCell?(e=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingBodyCell.rowIndex),t=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.floatingBodyCell.columnIndex),ee.fF.assertValue(e,"row leaf not found"),ee.fF.assertValue(t,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,t)):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus.item=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingRowHeader):ee.fF.assertFail("unexpected focus state");ee.fF.assertValue(this.currentFocus,"Undefined focused item")}},a.prototype.moveFocus=function(e,t,i,o,d,H){ee.fF.assertValue(this.currentFocus,"No initial focus");var M=this.currentFocus;this.currentFocus.bodyCell?this.currentFocus=this.moveBodyCellFocusTableEx(e,t,d,o):this.currentFocus.rowHeader?this.currentFocus=this.moveRowHeaderFocusTableEx(e,t,d,H):this.currentFocus.columnHeader?this.currentFocus=this.moveColumnHeaderFocusTableEx(e,t,o):this.currentFocus.cornerCell?this.currentFocus=this.moveCornerCellFocusTableEx(e,t):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus=this.moveFloatingRowHeaderFocusTableEx(e,t):this.currentFocus.floatingBodyCell&&(this.currentFocus=this.moveFloatingBodyCellFocusTableEx(e,t)),ee.fF.assertValue(this.currentFocus,"Undefined new focus"),this.updateFocusedItem(),this.onFocusChangedHandler&&this.onFocusChangedHandler(),this.previousFocus=M},a.prototype.moveBodyCellFocusTableEx=function(e,t,i,o){var d=this.currentFocus.bodyCell.rowIndex,H=this.currentFocus.bodyCell.columnIndex,M=this.rowNavigator.getFloatingHierarchyLeafCount()>0,x=-1===H,X=this.rowHeightMeasureManager.getPageRows().length,j=_.last(this.rowHeightMeasureManager.getPageRows()),Q=(X-1)*S.hw+(j.getRowHeights().length-1),W=this.columnWidthMeasureManager.getPageColumns().length,Y=_.last(this.columnWidthMeasureManager.getPageColumns()),Z=(W-1)*S.MN+(Y.getColumnWidths().length-1);if(t){if("home"===e)return o?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return o?this.getBottomRightCell():M?{floatingBodyCell:{rowIndex:0,columnIndex:Z}}:{bodyCell:{rowIndex:Q,columnIndex:Z}};if("up"===e)return o?{columnHeader:[this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(H))[0]]}:x?{bodyCell:{rowIndex:0,columnIndex:H}}:{columnHeader:[H]};if("down"===e)return x||!M?{bodyCell:{rowIndex:Q,columnIndex:H}}:{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:H}};if("left"===e)return o?{rowHeader:[this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(d))[0]]}:{bodyCell:{rowIndex:d,columnIndex:0}};if("right"===e)return{bodyCell:{rowIndex:d,columnIndex:Z}}}else{if("home"===e){if(o){var q=this.rowNavigator.getHierarchyLeafAt(d),ie=this.rowNavigator.getLeafAncestorAtLevel(q,0);return{rowHeader:this.rowNavigator.getPathIndices(ie)}}return{bodyCell:{rowIndex:d,columnIndex:0}}}if("end"===e)return o?{bodyCell:{rowIndex:d,columnIndex:this.columnWidthMeasureManager.getLastMeasuredIndex()}}:{bodyCell:{rowIndex:d,columnIndex:Z}};if("pageup"===e&&i)return{bodyCell:{rowIndex:le=Math.max(this.prevNonblankRowIndex(d-i+1),0),columnIndex:H}};if("pagedown"===e&&i){var de=this.prevNonblankRowIndex(Q+1);return{bodyCell:{rowIndex:le=Math.min(this.nextNonblankRowIndex(d+i-1),de),columnIndex:H}}}if("up"===e)return(le=this.prevNonblankRowIndex(d))<0?x?{bodyCell:{rowIndex:0,columnIndex:H}}:o&&this.columnNavigator.hasHierarchy()?{columnHeader:this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(H))}:{columnHeader:[H]}:{bodyCell:{rowIndex:le,columnIndex:H}};if("down"===e){var le;if(!((le=this.nextNonblankRowIndex(d))>Q))return{bodyCell:{rowIndex:le,columnIndex:H}};if(x||!M&&!o)return{bodyCell:{rowIndex:Q,columnIndex:H}};if(!o||M)return{floatingBodyCell:{rowIndex:0,columnIndex:H}}}if("left"===e)return o&&0===H?this.rowNavigator.hasHierarchy()?{rowHeader:this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(d))}:{rowHeader:[d]}:{bodyCell:{rowIndex:d,columnIndex:Math.max(H-1,-1)}};if("right"===e)return{bodyCell:{rowIndex:d,columnIndex:Math.min(H+1,Z)}}}return this.currentFocus},a.prototype.moveRowHeaderFocusTableEx=function(e,t,i,o){var d,H=this.columnWidthMeasureManager.getLastMeasuredIndex(),M=this.columnNavigator.getHierarchyDepth(),x=this.currentFocus.rowHeader,X=this.rowNavigator.getNodeFromPath(x),j=this.rowNavigator instanceof g.S?0:this.rowNavigator.getLevel(X),Q=this.rowNavigator.getItemsByLevel(j),W=Q.indexOf(X),Y=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(t){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:j,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(j)}else{if("left"===e&&x.length>1)return{rowHeader:_.dropRight(x,1)};if("right"===e){if(null!==(d=this.previousFocus)&&void 0!==d&&d.rowHeader&&_.isEqual(_.dropRight(this.previousFocus.rowHeader,1),this.currentFocus.rowHeader))return this.previousFocus;var Z=this.rowNavigator.getLeafIndex(X);if(void 0===Z)return{rowHeader:(0,k.ev)((0,k.ev)([],x||[],!0),[0],!1)};if(H>-1)return{bodyCell:{rowIndex:Z,columnIndex:0}}}if("up"===e)return(q=this.prevNonblankHeaderRowIndex(W,Q))>=0?{rowHeader:this.rowNavigator.getPathIndices(Q[q])}:{cornerCell:{rowLevel:j,columnLevel:M-1}};if("down"===e){if((q=this.nextNonblankHeaderRowIndex(W,Q))<=Q.length-1)return{rowHeader:this.rowNavigator.getPathIndices(Q[q])};if(Y)return{floatingRowHeader:0}}if("pagedown"===e){var ie=this.rowHeightMeasureManager.getLastMeasuredIndex(),ae=(0,U.hG)(this.currentFocus.item,this.rowNavigator),le=this.nextNonblankRowIndex(ae+i-1),de=this.prevNonblankRowIndex(ie+1),ce=Math.min(le,de),pe=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(ce));if(this.rowNavigator.isLeaf(X)||this.rowNavigator instanceof g.S)return{rowHeader:pe};var Me=_.take(pe,Math.min(this.currentFocus.rowHeader.length,pe.length)),q=this.nextNonblankHeaderRowIndex(W,Q);return _.isEqual(Me,this.currentFocus.rowHeader)&&q<=Q.length-1?{rowHeader:this.rowNavigator.getPathIndices(Q[q])}:{rowHeader:Me}}if("pageup"===e&&(ae=(0,U.hG)(this.currentFocus.item,this.rowNavigator),ce=Math.max(this.prevNonblankRowIndex(ae-i+1),0),pe=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(ce)),(Me=_.take(pe,Math.min(this.currentFocus.rowHeader.length,pe.length)))!==this.currentFocus.rowHeader))return{rowHeader:Me}}return x.length>1&&(t&&"left"===e||"home"===e)?{rowHeader:[x[0]]}:t&&"right"===e||"end"===e?{bodyCell:{rowIndex:(0,U.hG)(X,this.rowNavigator),columnIndex:H}}:this.currentFocus},a.prototype.moveColumnHeaderFocusTableEx=function(e,t,i){var o,d=this.currentFocus.columnHeader[0],H=this.rowNavigator.getFloatingHierarchyLeafCount()>0,M=this.rowHeightMeasureManager.getPageRows().length,x=_.last(this.rowHeightMeasureManager.getPageRows()),X=x?(M-1)*S.hw+(x.getRowHeights().length-1):-1,j=this.columnWidthMeasureManager.getPageColumns().length,Q=_.last(this.columnWidthMeasureManager.getPageColumns()),W=(j-1)*S.MN+(Q.getColumnWidths().length-1),Y=this.currentFocus.columnHeader,Z=this.columnNavigator.getNodeFromPath(Y),q=this.columnNavigator.getLevel(Z),ie=this.rowNavigator.getHierarchyDepth();if(t){if("home"===e)return i?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e){if(i)return this.getBottomRightCell();if(H)return{floatingBodyCell:{rowIndex:0,columnIndex:W}};if(-1!==X)return{bodyCell:{rowIndex:X,columnIndex:W}}}if("down"===e){var ae=this.columnNavigator.hasHierarchy?this.getFirstColumnLeafFromAncestor(Z):d;return this.getBottomFooterBodyCell(ae,X)}if("up"===e)return{columnHeader:[Y[0]]}}else{if("up"===e&&i&&this.columnNavigator.hasHierarchy()&&Y.length>1)return{columnHeader:_.dropRight(Y,1)};if("down"===e){if(i){if(null!==(o=this.previousFocus)&&void 0!==o&&o.columnHeader&&_.isEqual(_.dropRight(this.previousFocus.columnHeader,1),this.currentFocus.columnHeader))return this.previousFocus;var le=this.columnNavigator.getLeafIndex(Z);if(!this.columnNavigator.isLeaf(Z))return{columnHeader:(0,k.ev)((0,k.ev)([],this.currentFocus.columnHeader,!0),[0],!1)};if(X>=0)return{bodyCell:{rowIndex:0,columnIndex:le}};if(H)return{floatingBodyCell:{rowIndex:0,columnIndex:le}}}if(-1!==X)return{bodyCell:{rowIndex:0,columnIndex:d}}}var de=this.columnNavigator.getItemsByLevel(q),ce=de.indexOf(Z);if("left"===e)return i?ce>0?{columnHeader:this.columnNavigator.getPathIndices(de[ce-1])}:this.rowNavigator.hasHierarchy()?{cornerCell:{rowLevel:ie-1,columnLevel:q}}:{cornerCell:{rowLevel:0,columnLevel:q}}:{columnHeader:[Math.max(d-1,0)]};if("right"===e)return i&&-1!==ce?{columnHeader:this.columnNavigator.getPathIndices(de[Math.min(ce+1,de.length-1)])}:{columnHeader:[Math.min(d+1,W)]}}return"home"===e||t&&"left"===e?i?{cornerCell:{rowLevel:0,columnLevel:q}}:{columnHeader:[0]}:"end"===e||t&&"right"===e?i?this.getLastMatrixColumnCell(this.currentFocus.columnHeader.length-1):{columnHeader:[W]}:this.currentFocus},a.prototype.moveCornerCellFocusTableEx=function(e,t){var i=this.currentFocus.cornerCell.rowLevel,o=this.currentFocus.cornerCell.columnLevel,d=this.rowNavigator.getItemsByLevel(i),H=this.columnNavigator.getItemsByLevel(o),M=this.rowNavigator.getHierarchyLeafCount(),x=this.rowNavigator.getHierarchyDepth(),X=this.columnNavigator.getHierarchyDepth(),j=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(t){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:i,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(i)}else{if("up"===e&&o>0)return{cornerCell:{rowLevel:i,columnLevel:o-1}};if("down"===e){if(o<X-1)return{cornerCell:{rowLevel:i,columnLevel:o+1}};if(M>0)return{rowHeader:this.rowNavigator.getPathIndices(d[0])};if(j)return{floatingRowHeader:0}}if("right"===e){if(i<x-1)return{cornerCell:{rowLevel:i+1,columnLevel:o}};if(!_.isEmpty(H))return{columnHeader:this.columnNavigator.getPathIndices(H[0])}}if("left"===e&&i>0)return{cornerCell:{rowLevel:i-1,columnLevel:o}}}return i>0&&("home"===e||t&&"left"===e)?{cornerCell:{rowLevel:0,columnLevel:o}}:"end"===e||t&&"right"===e?this.getLastMatrixColumnCell(this.currentFocus.cornerCell.columnLevel):this.currentFocus},a.prototype.moveFloatingRowHeaderFocusTableEx=function(e,t){var i=this.rowNavigator.getHierarchyLeafCount(),o=this.columnWidthMeasureManager.getLastMeasuredIndex(),d=this.columnNavigator.getHierarchyDepth(),H=this.currentFocus.floatingRowHeader;if(ee.fF.assert(function(){return o>-1},"There can not be Floating rows without column headers"),t){if("home"===e||"up"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("down"===e&&H<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}}else{if("right"===e)return{floatingBodyCell:{rowIndex:H,columnIndex:0}};if("up"===e){if(H>0)return{floatingRowHeader:H-1};if(i>0){var M=this.rowNavigator.getItemsByLevel(0),x=this.prevNonblankHeaderRowIndex(M.length,M);return{rowHeader:this.rowNavigator.getPathIndices(M[x])}}return{cornerCell:{rowLevel:0,columnLevel:d-1}}}if("down"===e&&H<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:H+1}}return t&&"right"===e||"end"===e?{floatingBodyCell:{rowIndex:H,columnIndex:o}}:this.currentFocus},a.prototype.moveFloatingBodyCellFocusTableEx=function(e,t){var i=this.currentFocus.floatingBodyCell.columnIndex,o=this.currentFocus.floatingBodyCell.rowIndex,d=-1===i,H=this.rowHeightMeasureManager.getPageRows().length,M=_.last(this.rowHeightMeasureManager.getPageRows()),x=M?(H-1)*S.hw+(M.getRowHeights().length-1):-1,X=this.columnWidthMeasureManager.getPageColumns().length,j=_.last(this.columnWidthMeasureManager.getPageColumns()),Q=(X-1)*S.MN+(j.getColumnWidths().length-1);if(t){if("home"===e)return this.isA11yMatrix?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return this.isA11yMatrix?this.getBottomRightCell():{floatingBodyCell:{rowIndex:0,columnIndex:Q}};if("up"===e){if(this.isA11yMatrix){var W=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(i),0);return{columnHeader:[this.columnNavigator.getIndex(W)]}}return d?{bodyCell:{rowIndex:0,columnIndex:i}}:{columnHeader:[i]}}if("down"===e)return{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:i}};if("left"===e)return this.isA11yMatrix?{floatingRowHeader:o}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("right"===e)return{floatingBodyCell:{rowIndex:o,columnIndex:Q}}}else{if("home"===e)return this.isA11yMatrix?{floatingRowHeader:o}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("end"===e)return{floatingBodyCell:{rowIndex:0,columnIndex:Q}};if("up"===e)return 0===o?x>=0?{bodyCell:{rowIndex:this.prevNonblankRowIndex(x+1),columnIndex:i}}:(W=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(i),0),{columnHeader:[this.columnNavigator.getIndex(W)]}):{floatingBodyCell:{rowIndex:o-1,columnIndex:i}};if("down"===e&&o<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingBodyCell:{rowIndex:o+1,columnIndex:i}};if("left"===e)return 0===i&&this.isA11yMatrix?{floatingRowHeader:o}:{floatingBodyCell:{rowIndex:o,columnIndex:Math.max(i-1,0)}};if("right"===e)return{floatingBodyCell:{rowIndex:o,columnIndex:Math.min(i+1,Q)}}}return this.currentFocus},a.prototype.getBottomRightCell=function(){var e=this.rowNavigator.getFloatingHierarchyLeafCount(),t=this.columnWidthMeasureManager.getLastMeasuredIndex(),i=this.rowNavigator.getHierarchyLeafCount()-1;return e>0?{floatingBodyCell:{rowIndex:e-1,columnIndex:t}}:{bodyCell:{rowIndex:i,columnIndex:t}}},a.prototype.getLastMatrixColumnCell=function(e){var t=this.columnNavigator.getHierarchyLeafCount(),i=this.columnNavigator.getHierarchyLeafAt(t-1),o=this.columnNavigator.getPathIndices(i);return{columnHeader:_.dropRight(o,o.length-(e+1))}},a.prototype.getFirstColumnLeafFromAncestor=function(e){return this.columnNavigator.isLeaf(e)?this.columnNavigator.getLeafIndex(e):this.getFirstColumnLeafFromAncestor(this.columnNavigator.getChildren(e)[0])},a.prototype.getBottomFooterBodyCell=function(e,t){var i=this.rowNavigator.getFloatingHierarchyLeafCount()>0;return-1!==e&&i?{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:e}}:-1===t?this.currentFocus:{bodyCell:{rowIndex:t,columnIndex:e}}},a.prototype.getBottomFooterHeaderCell=function(e){var t=this.rowNavigator.getItemsByLevel(e);return this.rowNavigator.getFloatingHierarchyLeafCount()>0?{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}:{rowHeader:this.rowNavigator.getPathIndices(t[t.length-1])}},a.prototype.prevNonblankRowIndex=function(e){for(var t=e-1;t>=0;t--)if(!this.rowNavigator.isBlankRow(t))return t;return-1},a.prototype.nextNonblankRowIndex=function(e){for(var t=this.rowNavigator.getHierarchyLeafCount(),i=e+1;i<t;i++)if(!this.rowNavigator.isBlankRow(i))return i;return t+1},a.prototype.prevNonblankHeaderRowIndex=function(e,t){for(var i=e-1;i>=0;i--)if(!this.rowNavigator.isBlank(t[i]))return i;return-1},a.prototype.nextNonblankHeaderRowIndex=function(e,t){for(var i=e+1;i<t.length;i++)if(!this.rowNavigator.isBlank(t[i]))return i;return t.length},a}(),I=D(52287),m=function(){function a(e,t,i,o,d,H){var M=this;this.isA11yMatrix=H,this.elementOriginalCursor=t?.style.cursor,this.verticalResizeHandler=i,this.horizontalResizeHandler=o,(i||o)&&(t.addEventListener("mousedown",function(x){return t.closest("[".concat(I.y3,"=true]"))?null:M.onMouseDown(e,t,x)}),t.addEventListener("mousemove",function(x){return t.closest("[".concat(I.y3,"=true]"))?null:M.onMouseMove(t,x)}),t.addEventListener("dblclick",function(x){return t.closest("[".concat(I.y3,"=true]"))?null:M.onDoubleClick(e,t,x)})),d&&t.addEventListener("click",function(x){return M.onClick(e,t,x,d)})}return a.prototype.onMouseDown=function(e,t,i){var o=this.getActiveHandler(t,i);if(o){this.resizing=!0,this.startMousePosition=a.getMouseCoordinates(i);var d=(0,K.df)(t);this.initializeDocumentEvents(t,o,d),document.documentElement&&(this.documentOriginalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=this.getCursor(t,i)),o.onStartResize(e)}else this.resizing=!1},a.prototype.onMouseMove=function(e,t){this.startMousePosition||(e.style.cursor=this.getCursor(e,t))},a.prototype.onDoubleClick=function(e,t,i){var o=this.getActiveHandler(t,i);o&&o.onReset(e)},a.prototype.onClick=function(e,t,i,o){this.isA11yMatrix&&!t.closest("[".concat(I.y3,"=true]"))&&i.stopPropagation(),!this.resizing&&o&&o(e,i)},a.prototype.getActiveHandler=function(e,t){return this.isMouseOnVerticalHandle(e,a.getMouseCoordinates(t))?this.verticalResizeHandler:this.isMouseOnHorizontalHandle(e,a.getMouseCoordinates(t))?this.horizontalResizeHandler:null},a.prototype.getCursor=function(e,t){return this.isMouseOnVerticalHandle(e,a.getMouseCoordinates(t))?"col-resize":this.isMouseOnHorizontalHandle(e,a.getMouseCoordinates(t))?"row-resize":this.elementOriginalCursor},a.prototype.initializeDocumentEvents=function(e,t,i){var o=this;this.documentMouseMoveListener=function(d){d.preventDefault(),t.onResize(a.getMouseCoordinatesDelta(o.startMousePosition,a.getMouseCoordinates(d),i))},document.addEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseUpListener=function(d){d.preventDefault(),document.removeEventListener("mousemove",o.documentMouseMoveListener),o.documentMouseMoveListener=null,document.removeEventListener("mouseup",o.documentMouseUpListener),o.documentMouseUpListener=null,document.documentElement&&(document.documentElement.style.cursor=o.documentOriginalCursor,o.documentOriginalCursor=void 0),o.startMousePosition=null,t.onEndResize()},document.addEventListener("mouseup",this.documentMouseUpListener)},a.prototype.isMouseOnVerticalHandle=function(e,t){return!!this.verticalResizeHandler&&t.x>=e.getBoundingClientRect().right-a.HandleSize},a.prototype.isMouseOnHorizontalHandle=function(e,t){return!!this.horizontalResizeHandler&&t.y>=e.getBoundingClientRect().bottom-a.HandleSize},a.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},a.getMouseCoordinatesDelta=function(e,t,i){return t&&e?{x:(t.x-e.x)/i,y:(t.y-e.y)/i}:{x:0,y:0}},a.HandleSize=4,a}(),T=function(){function a(e,t,i){this.a11yTableFS=t,this.a11yMatrixFS=i,this.control=e}return a.prototype.onStartResize=function(e){var t=(0,U.oj)(e,this.control.getColumnNavigator()),i=this.control.getColumnNavigator().getLeafIndex(t);this.resizeState={leafToResize:t,leafToResizeIndex:i,originalWidth:this.control.getColumnWidthMeasureManager().getColumnWidth(i)}},a.prototype.onResize=function(e){if(e.x&&this.resizeState){var t=this.control.getViewport(),i=S._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager()),o=S.sW.getVisibleRange(t.left,t.width,this.control.getColumnWidthMeasureManager());if(i&&o){var d=Math.max(this.resizeState.originalWidth+e.x,m.HandleSize);this.control.getColumnWidthMeasureManager().setColumnWidth(this.resizeState.leafToResizeIndex,d),S._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,i.lastLeafIndex,o.firstLeafIndex,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ResizeColumn)}}},a.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.leafToResize,t=this.control.getColumnWidthMeasureManager().getColumnWidth(this.resizeState.leafToResizeIndex),i=this.resizeState.originalWidth;this.resizeState=void 0;var o=this.control.getViewport(),d=S._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager());if(d&&t!==i){this.control.getSizeManager().setColumnWidth(e,t);var H=S._E.getVisibleRowStart(d,o.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ClearRendering,H)}}},a.prototype.onReset=function(e){var t=this.control.getViewport(),i=S._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager());if(i){var o=(0,U.oj)(e,this.control.getColumnNavigator()),d=this.control.getColumnNavigator().getLeafIndex(o);this.control.getSizeManager().setColumnWidth(o,void 0),S.sW.remeasureColumn(d,this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,this.control.getColumnWidthMeasureManager());var H=S._E.getVisibleRowStart(i,t.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ClearRendering,H)}},a}(),f=function(){function a(e,t){this.a11yMatrixFS=t,this.control=e}return a.prototype.onStartResize=function(e){var t=this.getLevelToResize(e);this.resizeState={cornerCellToResize:this.control.getRowNavigator().getCorner(t,this.control.getColumnNavigator().getHierarchyDepth()-1),levelToResize:t,originalWidth:this.control.getRowLevelWidthMeasureManager().getLevelWidth(t)}},a.prototype.onResize=function(e){if(e.x&&this.resizeState){var t=this.control.getViewport(),i=S._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager()),o=S.sW.getVisibleRange(t.left,t.width,this.control.getColumnWidthMeasureManager());if(i){var d=Math.min(this.getMaxWidth(this.resizeState.levelToResize),Math.max(this.resizeState.originalWidth+e.x,m.HandleSize));this.control.getRowLevelWidthMeasureManager().setLevelWidth(this.resizeState.levelToResize,d),S._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,i.lastLeafIndex,o?o.firstLeafIndex:0,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ResizeColumn)}}},a.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.cornerCellToResize,t=this.control.getRowLevelWidthMeasureManager().getLevelWidth(this.resizeState.levelToResize),i=this.resizeState.originalWidth;this.resizeState=void 0;var o=this.control.getViewport(),d=S._E.getVisibleRange(o.top,o.height,this.control.getRowHeightMeasureManager());if(d&&t!==i){this.control.getSizeManager().setRowLevelWidth(e,t);var H=S._E.getVisibleRowStart(d,o.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(s.BM.ClearRendering,H)}}},a.prototype.onReset=function(e){var t=this.control.getViewport(),i=S._E.getVisibleRange(t.top,t.height,this.control.getRowHeightMeasureManager());if(i){var o=this.getLevelToResize(e),d=this.control.getRowNavigator().getCorner(o,this.control.getColumnNavigator().getHierarchyDepth()-1);this.control.getSizeManager().setRowLevelWidth(d,void 0),this.control.getRowLevelWidthMeasureManager().measure(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),i.firstLeafIndex,S.Ms,o);var H=S._E.getVisibleRowStart(i,t.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(s.BM.Incremental,H)}},a.prototype.getLevelToResize=function(e){return this.control.getSteppedLayout()?0:this.control.getRowNavigator().getRowLevel(e)},a.prototype.getMaxWidth=function(e){for(var t=this.control.getClientWidth(),i=0;i<e;i++)t-=this.control.getRowLevelWidthMeasureManager().getLevelWidth(i);return t},a}(),l=D(57470),u=D(7911),h=function(){function a(e,t,i,o,d,H,M,x,X,j,Q,W,Y){var q,Z=this;this.element=e,this.prefixCellClickHandler=t,this.prefixCellContextMenuHandler=i,this.mainCellClickHandler=o,this.mainCellContextMenuHandler=d,this.interactionHandler=H,this.section=M,this.renderType=x,this.onObject=X,this.enableCalculationHighlight=j,this.isRenderStable=Q,this.showTotalPlaceHolders=W,this.showAsTableNativeMenu=Y,this.unfrozenRowHeaders=!1,this.repeatRowHeaders=!1,this.viewSync={},this.xPosition=0,this.element.addEventListener("click",function(ie){var ae,le,de=ie.target,ce=Z.getItemByElement(de);ce&&(Z.isPrefixCell(de)?null===(ae=Z.prefixCellClickHandler)||void 0===ae||ae.call(Z,ce,ie,void 0,Z.section):null===(le=Z.mainCellClickHandler)||void 0===le||le.call(Z,ce,ie,void 0,Z.section))}),this.element.addEventListener("contextmenu",function(ie){var ae,le,de=ie.target,ce=Z.getItemByElement(de);!ce||Y||(Z.isPrefixCell(de)?null===(ae=Z.prefixCellContextMenuHandler)||void 0===ae||ae.call(Z,ce,ie):null===(le=Z.mainCellContextMenuHandler)||void 0===le||le.call(Z,ce,ie))}),this.renderType===s.y2.Table&&this.element.addEventListener("change",function(ie){var ae,le=d3.select(ie.target).attr("checkbox-rowindex");null!=le&&(null===(ae=Z.mainCellClickHandler)||void 0===ae||ae.call(Z,void 0,void 0,+le,Z.section))}),null===(q=this.interactionHandler)||void 0===q||q.setTooltipDelegate(function(ie){return Z.getItemByElement(ie.context)},this.element,this.getRegion.bind(this),!Y,function(ie){return Z.shouldHideDefaultTooltip(ie.context)})}return a.prototype.update=function(e,t,i,o){var d=this.rowHeightMeasureManager.getLastMeasuredIndex(),H=this.columnWidthMeasureManager.getLastMeasuredIndex(),M=S._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager,S.hw,d),x=S.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager,S.MN,H);if(this.section!==s.p0.Body||M){var X,j,Q;switch(x||(x={firstLeafIndex:-1,firstLeafLeft:0,lastLeafIndex:-2}),this.section){case s.p0.Header:X=[0,o.getHierarchyDepth()-1],j=this.rowHeightMeasureManager.getPageRows(),Q=this.columnWidthMeasureManager.getPageColumns();break;case s.p0.Body:X=[M.firstLeafIndex,M.lastLeafIndex],j=this.rowHeightMeasureManager.getPageRows(),Q=this.columnWidthMeasureManager.getPageColumns();break;case s.p0.Footer:X=[0,i.getFloatingHierarchyLeafCount()-1],j=[this.rowHeightMeasureManager.getFloatingPageRow()],Q=this.columnWidthMeasureManager.getPageColumns();break;default:ee.fF.assertNever(this.section)}this.renderMeta={viewport:e,binder:t,rowNavigator:i,columnNavigator:o,visibleRowRange:X,visibleColumnRange:[x.firstLeafIndex,x.lastLeafIndex],pageRows:j,pageColumns:Q},this.updateRendering()}},a.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e},a.prototype.setRepeatRowHeaders=function(e){this.repeatRowHeaders=e},a.prototype.setRowWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth();this.unfrozenRowHeaders&&(t+=e),d3.select(this.element).selectAll(".scrollable-cells-container").style("width",t+"px")},a.prototype.updateBodyLeft=function(){var e=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth();d3.select(this.element).selectAll(".scrollable-cells-viewport").style("left",e+"px")},a.prototype.shouldHideDefaultTooltip=function(e){var i=l.M.getFirstMatchingAncestor(e,function(M){return M.matches(".prefix-cell")||M.matches(".main-cell")},this.element,!0);if(!i)return!0;var d,o=d3.select(i);return!o.select(".tablixUrlIconGlyph").node()&&(!(d=o.classed("pivotTableCellWrap")||o.classed("pivotTableCellNoWrap")?o.node():o.select(".pivotTableCellWrap, .pivotTableCellNoWrap").node())||d.scrollHeight===d.clientHeight&&d.scrollWidth===d.clientWidth)},a.prototype.updateMeasureManagers=function(e,t,i,o,d){this.rowHeaderType=e,this.rowHeightMeasureManager=t,this.columnWidthMeasureManager=i,this.rowLevelWidthMeasureManager=o,this.columnLevelHeightMeasureManager=d},a.prototype.scrollToX=function(e){d3.select(this.element).selectAll(".scrollable-cells-container").style("left",-e+"px"),this.xPosition=e},a.prototype.onColumnResize=function(){var e=this;d3.select(this.element).selectAll(".row").each(function(){var t=e.getRowIndex(this),i=e.getRowHeight(t),o=e.getRowTop(t);d3.select(this).style("height",i+"px").style("top",o+"px")}),d3.select(this.element).selectAll(".prefix-cell:not(.filler-cell)").each(function(){var t=e.getRowIndex(this),i=e.getColumnIndex(this),o=e.isFillerCell(this),d=o?0:e.getPrefixCellHeight(t,i),H=o?0:e.getPrefixCellWidth(t,i),M=e.getPrefixCellLeft(t,i),x=parseFloat(d3.select(this).style("--padding-left")),X=parseFloat(d3.select(this).style("--padding-right")),j=e.getAdjustedPaddings(H,x,X),Q=j[0],W=j[1];d3.select(this).style("height",d+"px").style("width",H+"px").style("left",M+"px").style("padding-left",Q+"px").style("padding-right",W+"px")}),d3.select(this.element).selectAll(".main-cell:not(.filler-cell)").each(function(){var t=e.getRowIndex(this),i=e.getColumnIndex(this),o=e.getMainCellHeight(t,i),d=e.getMainCellWidth(t,i),H=e.getMainCellLeft(t,i),M=parseFloat(d3.select(this).style("--padding-left")),x=parseFloat(d3.select(this).style("--padding-right")),X=e.getAdjustedPaddings(d,M,x),j=X[0],Q=X[1];d3.select(this).style("height",o+"px").style("width",d+"px").style("left",H+"px").style("padding-left",j+"px").style("padding-right",Q+"px")}),this.adjustHeaders()},a.prototype.clear=function(){this.viewSync={},d3.select(this.element).html("")},a.prototype.getElementByIndex=function(e,t,i){var o=i===s.aP.Prefix?".prefix-cell":".main-cell";return d3.select(this.element).select('[row-index="'.concat(e,'"] ').concat(o,'[column-index="').concat(t,'"]')).node()},a.prototype.getItemByElement=function(e){if(this.isRenderStable()){var t=this.getRowIndex(e);if(null!=t){var i=this.getColumnIndex(e);if(null!=i){var o=this.isPrefixCell(e);return this.getCellItem(t,i,o)}}}},a.prototype.updateRendering=function(){var e=this,t=[],i=[];this.clearUnusedElements(),this.setGroupLocations(t,i),t.forEach(function(o){return e.insertRowGroup(o)}),i.forEach(function(o){return e.insertCellGroup(o)}),this.scrollToX(this.xPosition),this.adjustHeaders()},a.prototype.clearUnusedElements=function(){var e=this;for(var t in this.viewSync)if(+t<this.renderMeta.visibleRowRange[0]||+t>this.renderMeta.visibleRowRange[1])delete this.viewSync[t];else for(var i in this.viewSync[t])+i>=0&&(+i<this.renderMeta.visibleColumnRange[0]||+i>this.renderMeta.visibleColumnRange[1])&&delete this.viewSync[t][i];d3.select(this.element).selectAll(".row").filter(function(){var o=e.getRowIndex(this);return o<e.renderMeta.visibleRowRange[0]||o>e.renderMeta.visibleRowRange[1]}).remove(),d3.select(this.element).selectAll(".main-cell").filter(function(){var o=e.getColumnIndex(this);return o<e.renderMeta.visibleColumnRange[0]||o>e.renderMeta.visibleColumnRange[1]}).remove()},a.prototype.setGroupLocations=function(e,t){for(var i,o=this.renderMeta.visibleRowRange[0];o<=this.renderMeta.visibleRowRange[1];o++)if(this.viewSync[o]){i=!1;var H=void 0;this.viewSync[o][-1]||t.push({rowIndex:o,columnStart:-1,columnEnd:-1});for(var d=this.renderMeta.visibleColumnRange[0];d<=this.renderMeta.visibleColumnRange[1];d++)this.viewSync[o][d]?H=!1:(H?_.last(t).columnEnd++:(t.push({rowIndex:o,columnStart:d,columnEnd:d}),H=!0),this.viewSync[o][d]=!0)}else for(i?_.last(e).rowEnd++:(e.push({rowStart:o,rowEnd:o}),i=!0),this.viewSync[o]={"-1":!0},d=this.renderMeta.visibleColumnRange[0];d<=this.renderMeta.visibleColumnRange[1];d++)this.viewSync[o][d]=!0},a.prototype.insertRowGroup=function(e){for(var i,t=this,o=d3.select(this.element).selectAll(".row").nodes(),d=o.length-1;d>=0;d--){ee.fF.assert(function(){return t.section===s.p0.Body},"header and footer should never insert additional row groups");var H=this.getRowIndex(o[d]);if(e.rowStart>H){i=o[d];break}}var x,M=this.getRowGroupBindings(e.rowStart,e.rowEnd);i?(i.insertAdjacentHTML("afterend",u.bG.buildMultiple(M)),x=i.nextElementSibling):(this.element.insertAdjacentHTML("afterbegin",u.bG.buildMultiple(M)),x=_.first(this.element.children)),u.bG.attachEventHandlersMultiple(x,M)},a.prototype.insertCellGroup=function(e){var t;ee.fF.assert(function(){return-1!==e.columnStart},"cell group insertion of prefix cells is not supported");for(var o=d3.select(this.element).select('[row-index="'.concat(e.rowIndex,'"]')).select(".scrollable-cells-container"),d=o.node(),H=o.selectAll(".prefix-cell").nodes(),M=o.selectAll(".main-cell").nodes(),x=M.length-1;x>=0;x--){var X=this.getColumnIndex(M[x]);if(e.columnStart>X){t=M[x];break}}!t&&!_.isEmpty(H)&&(t=_.last(H));var Q,j=this.getMainBindings(e.rowIndex,e.columnStart,e.columnEnd);t?(t.insertAdjacentHTML("afterend",u.bG.buildMultiple(j)),Q=t.nextElementSibling):(d.insertAdjacentHTML("afterbegin",u.bG.buildMultiple(j)),Q=_.first(d.children)),u.bG.attachEventHandlersMultiple(Q,j)},a.prototype.getRowGroupBindings=function(e,t){for(var i,o=[],d=e;d<=t;d++){var H=this.getRowHeight(d),M=this.getRowTop(d),x=!1,X=0;this.renderMeta.binder.blankRowsEnabled()&&(x=this.renderMeta.rowNavigator.isBlankRow(d),X=this.renderMeta.rowNavigator.numberOfBlankRowsBefore(d));var j={classNames:["row"],attributes:{role:"row","row-index":d.toString()},styleProperties:{position:"absolute",height:H+"px",width:"100%",top:M+"px","pointer-events":"none"},children:[]};x?j.attributes["aria-hidden"]="true":j.attributes["aria-rowindex"]=(this.getAriaRowIndex(d)-X).toString();var Q=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth(),W=this.columnWidthMeasureManager.getColumnsWidth(),Y=this.getPrefixBindings(d),Z=this.getMainBindings(d,this.renderMeta.visibleColumnRange[0],this.renderMeta.visibleColumnRange[1]);!this.unfrozenRowHeaders&&this.renderType===s.y2.Matrix&&(i=j.children).push.apply(i,Y);var ie={attributes:{role:"presentation"},classNames:["scrollable-cells-viewport"],styleProperties:{position:"absolute","overflow-x":"clip",height:"100%",left:Q+"px",right:"0"},children:[{attributes:{role:"presentation"},classNames:["scrollable-cells-container"],styleProperties:{position:"absolute",height:"100%",width:W+"px"},children:this.unfrozenRowHeaders||this.renderType===s.y2.Table?(0,k.ev)((0,k.ev)([],Y,!0),Z,!0):Z}]};(this.onObject||this.enableCalculationHighlight)&&this.renderType===s.y2.Matrix&&(ie.attributes[I.oy]=(0).toString()),j.children.push(ie),o.push(j)}return o},a.prototype.getPrefixBindings=function(e){for(var t=[],i=this.renderMeta.rowNavigator.getHierarchyDepth(),o=0;o<i;o++){var d=this.getPrefixCellBinding(e,o);t.push(d)}return t},a.prototype.getMainBindings=function(e,t,i){for(var o=[],d=t;d<=i;d++){var H=this.getMainCellBinding(e,d);o.push(H)}return o},a.prototype.adjustCellBindingPadding=function(e,t){var i=parseFloat(e.styleProperties["padding-left"]),o=parseFloat(e.styleProperties["padding-right"]);isNaN(i)&&(i=0),isNaN(o)&&(o=0);var d=this.getAdjustedPaddings(t,i,o),M=d[1];e.styleProperties["padding-left"]=d[0]+"px",e.styleProperties["padding-right"]=M+"px",e.styleProperties["--padding-left"]=i.toString(),e.styleProperties["--padding-right"]=o.toString()},a.prototype.getAdjustedPaddings=function(e,t,i){var o=Math.max(e-t,0),d=Math.min(i,o);return[Math.min(t,e),d]},a.prototype.getRowIndex=function(e){var i=l.M.getFirstMatchingAncestor(e,function(d){return d.matches("[row-index]")},this.element,!0);return i&&+i.getAttribute("row-index")},a.prototype.getColumnIndex=function(e){var i=l.M.getFirstMatchingAncestor(e,function(d){return d.matches("[column-index]")},this.element,!0);return i&&+i.getAttribute("column-index")},a.prototype.isPrefixCell=function(e){return!!l.M.getFirstMatchingAncestor(e,function(d){return d.matches(".prefix-cell")},this.element,!0)},a.prototype.getRegion=function(e){return this.isPrefixCell(e)?s.aP.Prefix:s.aP.Main},a.prototype.isFillerCell=function(e){return!!l.M.getFirstMatchingAncestor(e,function(d){return d.matches(".filler-cell")},this.element,!0)},a.prototype.getFirstScrollableCellsContainer=function(){return d3.select(this.element).select(".scrollable-cells-container").node()},a.prototype.getAriaColIndex=function(e,t){return t?e+1:e+1+this.renderMeta.rowNavigator.getHierarchyDepth()},a.prototype.getColumnWidth=function(e,t){return t?this.rowLevelWidthMeasureManager.getLevelWidth(e):this.columnWidthMeasureManager.getPageColumns()[S.yl.getPageIndex(e,S.MN)].getColumnWidths()[e%S.MN]},a.prototype.getColumnLeft=function(e,t){if(t)return this.rowLevelWidthMeasureManager.getLevelLeft(e);var o=this.columnWidthMeasureManager.getPageColumns()[S.yl.getPageIndex(e,S.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(o)+_.sum(o.getColumnWidths().slice(0,e%S.MN))},a}(),p=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}return(0,k.ZT)(e,a),e.prototype.setResizeHandlers=function(t,i){this.columnWidthResizeHandler=t,this.rowLevelWidthResizeHandler=i},e.prototype.adjustHeaders=function(){var t=this;for(var i in d3.select(this.element).selectAll(".primary-columnheader, .secondary-columnheader").each(function(){var M=t.getRowIndex(this),x=t.getColumnIndex(this),X=t.getMainCellWidth(M,x),j=x===t.renderMeta.visibleColumnRange[0],Q=d3.select(this).classed("secondary-columnheader")&&!j;if(d3.select(this).classed("visually-hidden",Q),j&&!d3.select(this).classed("last-secondary-columnheader")){var W=t.getColumnHeaderOffset(x),Y=X-W;d3.select(this).style("transform","translateX(".concat(W,"px)")),d3.select(this).style("width",Y+"px")}else Q||(d3.select(this).style("transform",null),d3.select(this).style("width",X+"px"))}),this.viewSync)for(var o in this.viewSync[i])if("resizable"!==this.viewSync[i][o]){if("-1"===o)d3.select(this.element).select('[row-index="'.concat(i,'"]')).selectAll(".prefix-cell").each(function(){if(!t.isFillerCell(this)){var M=t.getItemByElement(this);new m(M,this,t.rowLevelWidthResizeHandler,null,t.prefixCellClickHandler,!0)}});else{var d=this.getElementByIndex(i,o,s.aP.Main);if(!this.isFillerCell(d)){var H=this.getItemByElement(d);new m(H,d,this.columnWidthResizeHandler,null,this.mainCellClickHandler,!0)}}this.viewSync[i][o]="resizable"}},e.prototype.getPrefixCellBinding=function(t,i){var o=i,d=t,H=this.rowLevelWidthMeasureManager.getLevelLeft(o),M=this.columnLevelHeightMeasureManager.getLevelHeight(d),x=this.rowLevelWidthMeasureManager.getLevelWidth(o),X=this.renderMeta.rowNavigator.getCorner(o,d),j=this.renderMeta.binder.getCornerCellBinding(X,!1,!0,this.onObject,x);return j.classNames||(j.classNames=[]),j.attributes||(j.attributes={}),j.styleProperties||(j.styleProperties={}),j.classNames.push("prefix-cell"),j.attributes.role="columnheader",j.attributes["column-index"]=i.toString(),j.attributes["aria-colindex"]=this.getAriaColIndex(i,!0).toString(),null==j.attributes.tabindex&&(j.attributes.tabindex="0"),j.styleProperties.position="absolute",j.styleProperties.left=H+"px",j.styleProperties.height=M+"px",j.styleProperties.width=x+"px",j.styleProperties["box-sizing"]="border-box",j.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(j,x),j},e.prototype.getMainCellBinding=function(t,i){var o=t,H=this.columnWidthMeasureManager.getPageColumns()[S.yl.getPageIndex(i,S.MN)],X=this.columnWidthMeasureManager.getPageColumnLeft(H)+_.sum(H.getColumnWidths().slice(0,i%S.MN));this.unfrozenRowHeaders&&(X+=this.rowLevelWidthMeasureManager.getHeadersWidth());var j=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),Q=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(j,o,!0);if(!Q)return{attributes:{role:"columnheader","column-index":i.toString(),"aria-colindex":this.getAriaColIndex(i,!1).toString()},classNames:["main-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:X+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};var Z,Y=this.renderMeta.columnNavigator.getHierarchyLeafAt(i+1);Y&&(Z=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(Y,o,!0)),Z===Q&&(Z=void 0);var q=this.getMainCellHeight(t,i),ie=this.getMainCellWidth(t,i),ae=this.renderMeta.binder.getColumnHeaderBinding(Q,!1,!0,this.onObject,Z,ie),le=this.renderMeta.columnNavigator.isLeaf(Q),de=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(Q),ce=this.renderMeta.columnNavigator.getNodeLeafCount(Q)-(i-de),pe=!le&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(Q)===i,Me=!le&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(Q)!==i,ve=Me&&1===ce;return ae.classNames||(ae.classNames=[]),ae.attributes||(ae.attributes={}),ae.styleProperties||(ae.styleProperties={}),ae.classNames.push("main-cell"),pe&&ae.classNames.push("primary-columnheader"),Me&&ae.classNames.push("secondary-columnheader"),ve&&ae.classNames.push("last-secondary-columnheader"),ae.attributes.role="columnheader",ae.attributes["column-index"]=i.toString(),ae.attributes["aria-colindex"]=this.getAriaColIndex(i,!1).toString(),ae.attributes.tabindex="0",ae.styleProperties.position="absolute",ae.styleProperties.left=X+"px",ae.styleProperties.width=ie+"px",ae.styleProperties.height=q+"px",ae.styleProperties["box-sizing"]="border-box",ae.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(ae,ie),ae},e.prototype.getAriaRowIndex=function(t){return t+1},e.prototype.getRowHeight=function(t){return this.columnLevelHeightMeasureManager.getLevelHeight(t)},e.prototype.getRowTop=function(t){return this.columnLevelHeightMeasureManager.getLevelTop(t)},e.prototype.getPrefixCellWidth=function(t,i){return this.rowLevelWidthMeasureManager.getLevelWidth(i)},e.prototype.getPrefixCellHeight=function(t,i){return this.columnLevelHeightMeasureManager.getLevelHeight(t)},e.prototype.getPrefixCellLeft=function(t,i){return this.rowLevelWidthMeasureManager.getLevelLeft(i)},e.prototype.getMainCellWidth=function(t,i){var o=this,d=t,H=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),M=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(H,d),x=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(M),X=this.renderMeta.columnNavigator.getNodeLeafCount(M)-(i-x),j=this.columnWidthMeasureManager.getLastMeasuredIndex(),Q=Math.min(i+X-1,j);return _.sum(_.range(i,Q+1).map(function(W){return o.columnWidthMeasureManager.getColumnWidth(W)}))},e.prototype.getMainCellHeight=function(t,i){var o=this,d=t,H=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),M=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(H,d),x=(0,U.zG)(M,this.renderMeta.columnNavigator);return _.sum(_.range(t,d+x-1+1).map(function(j){return o.columnLevelHeightMeasureManager.getLevelHeight(j)}))},e.prototype.getMainCellLeft=function(t,i){var d=this.columnWidthMeasureManager.getPageColumns()[S.yl.getPageIndex(i,S.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(d)+_.sum(d.getColumnWidths().slice(0,i%S.MN))},e.prototype.getCellItem=function(t,i,o){if(o)return this.renderMeta.rowNavigator.getCorner(i,t);var M=this.renderMeta.columnNavigator.getHierarchyLeafAt(i);return this.renderMeta.columnNavigator.getLeafAncestorAtLevel(M,t)},e.prototype.getColumnHeaderOffset=function(t){return this.renderMeta.viewport.left-this.getColumnLeft(t,!1)},e}(h),R=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}return(0,k.ZT)(e,a),e.prototype.scrollToY=function(t){this.element.style.top=-t+"px"},e.prototype.adjustHeaders=function(){if(this.rowHeaderType!==s.xU.Stepped&&!this.repeatRowHeaders){var t=this;d3.select(this.element).selectAll(".primary-rowheader, .secondary-rowheader").each(function(){var i=t.getRowIndex(this),o=t.getColumnIndex(this),d=t.getPrefixCellHeight(i,o),H=i===t.renderMeta.visibleRowRange[0],M=d3.select(this).classed("secondary-rowheader")&&!H;if(d3.select(this).classed("visually-hidden",M),H&&!d3.select(this).classed("last-secondary-rowheader")){var x=t.getRowHeaderOffset(i),X=d-x;d3.select(this).style("transform","translateY(".concat(x,"px)")),d3.select(this).style("height",X+"px")}else M||(d3.select(this).style("transform",null),d3.select(this).style("height",d+"px"))})}},e.prototype.getPrefixCellBinding=function(t,i){var x,o=i,d=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),H=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(d,o,!0),M=this.rowLevelWidthMeasureManager.getLevelLeft(o);if(!H)return{attributes:{role:"rowheader","column-index":i.toString(),"aria-colindex":this.getAriaColIndex(i,!0).toString()},classNames:["prefix-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:M+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};if(this.renderType===s.y2.Table){var X=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),j=this.renderMeta.columnNavigator.getColumnIndexFromQueryName(this.renderMeta.binder.getRowReferenceQueryName());x=j?this.renderMeta.rowNavigator.getIntersection(X,j):void 0}var W,Q=this.renderMeta.rowNavigator.getHierarchyLeafAt(t+1);Q&&(W=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(Q,o,!0)),W===H&&(W=void 0);var Y=this.getPrefixCellWidth(t,i),Z=this.getPrefixCellHeight(t,i),q=this.renderMeta.rowNavigator.isLeaf(H),ie=this.rowHeaderType===s.xU.Stepped,ae=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(H),le=this.renderMeta.rowNavigator.getNodeLeafCount(H)-(t-ae),de=!q&&!ie&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(H)===t,ce=!q&&!ie&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(H)!==t,pe=ce&&1===le,Me=this.renderType===s.y2.Table?this.columnWidthMeasureManager.getColumnsWidth():Y,ve=Me+"px",fe=this.renderMeta.binder.getRowHeaderBinding(H,!1,this.onObject,!1,x,W,Me,this.repeatRowHeaders?d:void 0,ce);if(fe.classNames||(fe.classNames=[]),fe.attributes||(fe.attributes={}),fe.styleProperties||(fe.styleProperties={}),fe.classNames.push("prefix-cell"),de&&fe.classNames.push("primary-rowheader"),ce&&fe.classNames.push("secondary-rowheader"),pe&&fe.classNames.push("last-secondary-rowheader"),fe.attributes["column-index"]=i.toString(),fe.attributes["aria-colindex"]=this.getAriaColIndex(i,!0).toString(),fe.attributes.tabindex="0",fe.styleProperties.position="absolute",fe.styleProperties.left=M+"px",fe.styleProperties.height=Z+"px",fe.styleProperties.width=ve,fe.styleProperties["box-sizing"]="border-box",fe.styleProperties["pointer-events"]=this.renderType===s.y2.Table?"none":"auto",this.renderType===s.y2.Table){var y=H===_.first(this.renderMeta.rowNavigator.getHierarchyItems()),r=this.renderMeta.rowNavigator.isLastItem(H,this.renderMeta.rowNavigator.getHierarchyItems()),c=this.renderMeta.binder.getBorderInfo(y,r,!0,!0,!0,s.p0.Body);fe.styleProperties["--outline-top"]=c.weightTop+1+"px",fe.styleProperties["--outline-right"]=c.weightRight+1+"px",fe.styleProperties["--outline-bottom"]=c.weightBottom+1+"px",fe.styleProperties["--outline-left"]=c.weightLeft+1+"px",fe.styleProperties["z-index"]="1"}return this.adjustCellBindingPadding(fe,Y),fe},e.prototype.getMainCellBinding=function(t,i){var o=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),d=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),H=this.renderMeta.rowNavigator.getIntersection(o,d),M=this.getRowHeight(t),x=this.getColumnWidth(i,!1),X=this.getColumnLeft(i,!1);this.unfrozenRowHeaders&&(X+=this.rowLevelWidthMeasureManager.getHeadersWidth());var j=this.renderMeta.rowNavigator.getHierarchyLeafAt(t+1),Q=j&&this.renderMeta.rowNavigator.getIntersection(j,d),W=this.renderMeta.binder.getBodyCellBinding(H,!1,M,x,!0,this.onObject,Q,this.showTotalPlaceHolders);return W.classNames||(W.classNames=[]),W.attributes||(W.attributes={}),W.styleProperties||(W.styleProperties={}),W.classNames.push("main-cell"),W.attributes.role="gridcell",W.attributes["column-index"]=i.toString(),W.attributes["aria-colindex"]=this.getAriaColIndex(i,!1).toString(),W.attributes.tabindex="0",W.styleProperties.position="absolute",W.styleProperties["box-sizing"]="border-box",W.styleProperties.height="100%",W.styleProperties.width=x+"px",W.styleProperties.left=X+"px",W.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(W,x),W},e.prototype.getAriaRowIndex=function(t){return t+1+this.renderMeta.columnNavigator.getHierarchyDepth()},e.prototype.getRowHeight=function(t){return this.rowHeightMeasureManager.getPageRows()[S.yl.getPageIndex(t,S.hw)].getRowHeights()[t%S.hw]},e.prototype.getRowTop=function(t){var o=this.rowHeightMeasureManager.getPageRows()[S.yl.getPageIndex(t,S.hw)];return this.rowHeightMeasureManager.getPageRowTop(o)+_.sum(o.getRowHeights().slice(0,t%S.hw))},e.prototype.getPrefixCellWidth=function(t,i){var o=this;if(this.rowHeaderType===s.xU.Stepped)return this.rowLevelWidthMeasureManager.getHeadersWidth();var d=i,H=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),M=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(H,d),x=(0,U.zG)(M,this.renderMeta.rowNavigator);return _.sum(_.range(d,d+x-1+1).map(function(j){return o.rowLevelWidthMeasureManager.getLevelWidth(j)}))},e.prototype.getPrefixCellHeight=function(t,i){var o=this;if(this.renderType===s.y2.Table||this.rowHeaderType===s.xU.Stepped)return this.rowHeightMeasureManager.getRowHeight(t);var d=i,H=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),M=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(H,d),x=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(M),X=this.renderMeta.rowNavigator.getNodeLeafCount(M)-(t-x),j=this.rowHeightMeasureManager.getLastMeasuredIndex(),Q=Math.min(t+X-1,j);return _.sum(_.range(t,Q+1).map(function(W){return o.rowHeightMeasureManager.getRowHeight(W)}))},e.prototype.getPrefixCellLeft=function(t,i){return this.getColumnLeft(i,!0)},e.prototype.getMainCellWidth=function(t,i){return this.getColumnWidth(i,!1)},e.prototype.getMainCellHeight=function(t,i){return this.getRowHeight(t)},e.prototype.getMainCellLeft=function(t,i){return this.getColumnLeft(i,!1)},e.prototype.getCellItem=function(t,i,o){if(o){var d=i,H=this.renderMeta.rowNavigator.getHierarchyLeafAt(t);return this.renderMeta.rowNavigator.getLeafAncestorAtLevel(H,d)}var M=this.renderMeta.rowNavigator.getHierarchyLeafAt(t),x=this.renderMeta.columnNavigator.getHierarchyLeafAt(i);return this.renderMeta.rowNavigator.getIntersection(M,x)},e.prototype.getRowHeaderOffset=function(t){return this.renderMeta.viewport.top-this.getRowTop(t)},e}(h),b=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}return(0,k.ZT)(e,a),e.prototype.adjustHeaders=function(){for(var o=this.renderMeta.columnNavigator.getHierarchyDepth()+this.renderMeta.rowNavigator.getHierarchyLeafCount()+this.renderMeta.rowNavigator.getFloatingHierarchyLeafCount(),d=0,H=d3.select(this.element).selectAll(".row").nodes().reverse();d<H.length;d++)d3.select(H[d]).attr("aria-rowindex",o--)},e.prototype.getPrefixCellBinding=function(t,i){var o=this.rowHeightMeasureManager.getFloatingRowHeight(t),d=this.rowLevelWidthMeasureManager.getHeadersWidth(),H=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),M=this.renderMeta.binder.getRowHeaderBinding(H,!1,this.onObject,!0,void 0,void 0,d);return M.classNames||(M.classNames=[]),M.attributes||(M.attributes={}),M.styleProperties||(M.styleProperties={}),M.classNames.push("prefix-cell"),M.attributes.role="rowheader",M.attributes["column-index"]=i.toString(),M.attributes["aria-colindex"]=this.getAriaColIndex(i,!0).toString(),M.attributes.tabindex="0",M.styleProperties.position="absolute",M.styleProperties.left="0",M.styleProperties.height=o+"px",M.styleProperties.width=d+"px",M.styleProperties["box-sizing"]="border-box",M.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(M,d),M},e.prototype.getMainCellBinding=function(t,i){var o=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),d=this.renderMeta.columnNavigator.getHierarchyLeafAt(i),H=this.renderMeta.rowNavigator.getIntersection(o,d),M=this.getRowHeight(t),x=this.getColumnWidth(i,!1),X=this.getColumnLeft(i,!1);this.unfrozenRowHeaders&&(X+=this.rowLevelWidthMeasureManager.getHeadersWidth());var j=this.renderMeta.binder.getBodyCellBinding(H,!1,M,x,!0,this.onObject,void 0,this.showTotalPlaceHolders);return j.classNames||(j.classNames=[]),j.attributes||(j.attributes={}),j.styleProperties||(j.styleProperties={}),j.classNames.push("main-cell"),j.attributes.role="gridcell",j.attributes["column-index"]=i.toString(),j.attributes["aria-colindex"]=this.getAriaColIndex(i,!1).toString(),j.attributes.tabindex="0",j.styleProperties.position="absolute",j.styleProperties["box-sizing"]="border-box",j.styleProperties.height="100%",j.styleProperties.width=x+"px",j.styleProperties.left=X+"px",j.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(j,x),j},e.prototype.getAriaRowIndex=function(t){return-1},e.prototype.getRowHeight=function(t){return this.rowHeightMeasureManager.getFloatingPageRow().getRowHeights()[t]},e.prototype.getRowTop=function(t){var i=this.rowHeightMeasureManager.getFloatingPageRow();return this.rowHeightMeasureManager.getPageRowTop(i)+_.sum(i.getRowHeights().slice(0,t))},e.prototype.getPrefixCellWidth=function(t,i){return this.rowLevelWidthMeasureManager.getHeadersWidth()},e.prototype.getPrefixCellHeight=function(t,i){return this.rowHeightMeasureManager.getFloatingRowHeight(t)},e.prototype.getPrefixCellLeft=function(t,i){return 0},e.prototype.getMainCellWidth=function(t,i){return this.getColumnWidth(i,!1)},e.prototype.getMainCellHeight=function(t,i){return this.getRowHeight(t)},e.prototype.getMainCellLeft=function(t,i){return this.getColumnLeft(i,!1)},e.prototype.getCellItem=function(t,i,o){if(o)return this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t);var d=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(t),H=this.renderMeta.columnNavigator.getHierarchyLeafAt(i);return this.renderMeta.rowNavigator.getIntersection(d,H)},e}(h),w=function(a){return a[a.Default=0]="Default",a[a.ColumnResizing=1]="ColumnResizing",a[a.RowLevelResizing=2]="RowLevelResizing",a}({}),B=function(){function a(e,t,i,o,d,H,M,x,X,j,Q,W,Y,Z,q){var ie=this;this.hostServices=x,this.visualStyle=X,this.showTotalPlaceHolders=Y,this.subSelectionHelper=Z,this.showAsTableNativeMenu=q,this.unfrozenRowHeaders=!1,this.isA11yTable=o,this.isA11yMatrix=d,this.renderIteration=0,this.prevHorizontalWheelTime=0,this.onObject=H,this.enableCalculationHighlighting=M,this.sizeManager=t,this.scrollingEnabled=i.scrollingEnabled;var ae=x.getLocalizedString(A.iC),le=x.getLocalizedString(A.Hw),de=x.getLocalizedString(A.dm),ce=x.getLocalizedString(A.Ds),pe=W?"interactive-grid":"",Me="<div role='document' ignore-focus-loss='true' style='position:relative'>\n                    <button class='scrollUp visually-hidden' tabindex='-1'>".concat(ae,"</button>\n                    <button class='scrollDown visually-hidden' tabindex='-1'>").concat(le,"</button>\n                    <button class='scrollLeft visually-hidden' tabindex='-1'>").concat(de,"</button>\n                    <button class='scrollRight visually-hidden' tabindex='-1'>").concat(ce,"</button>\n                    <div role='grid' class='").concat(pe," innerContainer' style='position:absolute;left:0;top:0;right:0;bottom:0'>\n                        <div role='presentation' class='top-viewport' drag-resize-disabled='true' style='position:absolute;overflow:clip;left:0;right:0;top:0'></div>\n                        <div role='presentation' class='mid-viewport' style='position:absolute;overflow:hidden;left:0;top:0;right:0;bottom:0;box-sizing:border-box'>\n                            <div role='presentation'></div>\n                        </div>\n                        <div role='presentation' class='bot-viewport' style='position:absolute;overflow:clip;left:0;right:0'></div>\n                    </div>\n                    <div class='measureElement' style='position:absolute;left:0;top:0;visibility:hidden'></div>\n                </div>");e.insertAdjacentHTML("beforeend",Me),this.element=e.lastChild,this.innerContainer=this.element.querySelector(".innerContainer"),this.measureElement=this.element.querySelector(".measureElement"),this.topViewport=this.element.querySelector(".top-viewport"),this.midViewport=this.element.querySelector(".mid-viewport"),this.innerBodyCellContainer=this.midViewport.firstElementChild,this.botViewport=this.element.querySelector(".bot-viewport"),(this.onObject||this.enableCalculationHighlighting)&&(this.topViewport.setAttribute(I.oy,(0).toString()),this.midViewport.setAttribute(I.oy,(0).toString()),this.botViewport.setAttribute(I.oy,(0).toString())),d3.select(this.element).select(".scrollUp").on("click",function(){var ve,xe;null===(ve=ie.rowScrollbar)||void 0===ve||ve.scrollPageUp();var fe=ie.getViewport(),y=S._E.getVisibleRange(fe.top,fe.height,ie.rowHeightMeasureManager,S.hw,null===(xe=ie.rowHeightMeasureManager)||void 0===xe?void 0:xe.getLastMeasuredIndex());j(y.firstLeafIndex,y.lastLeafIndex)}),d3.select(this.element).select(".scrollDown").on("click",function(){var ve,xe;null===(ve=ie.rowScrollbar)||void 0===ve||ve.scrollPageDown();var fe=ie.getViewport(),y=S._E.getVisibleRange(fe.top,fe.height,ie.rowHeightMeasureManager,S.hw,null===(xe=ie.rowHeightMeasureManager)||void 0===xe?void 0:xe.getLastMeasuredIndex());j(y.firstLeafIndex,y.lastLeafIndex)}),d3.select(this.element).select(".scrollLeft").on("click",function(){var ve,xe;null===(ve=ie.columnScrollbar)||void 0===ve||ve.scrollPageUp();var fe=ie.getViewport(),y=S.sW.getVisibleRange(fe.left,fe.width,ie.columnWidthMeasureManager,S.MN,null===(xe=ie.rowHeightMeasureManager)||void 0===xe?void 0:xe.getLastMeasuredIndex());Q(y.firstLeafIndex,y.lastLeafIndex)}),d3.select(this.element).select(".scrollRight").on("click",function(){var ve,xe;null===(ve=ie.columnScrollbar)||void 0===ve||ve.scrollPageDown();var fe=ie.getViewport(),y=S.sW.getVisibleRange(fe.left,fe.width,ie.columnWidthMeasureManager,S.MN,null===(xe=ie.rowHeightMeasureManager)||void 0===xe?void 0:xe.getLastMeasuredIndex());Q(y.firstLeafIndex,y.lastLeafIndex)}),this.options=i,this.initializeScrollbars(),this.options.whitespaceClickHandler&&this.innerContainer.addEventListener("click",function(ve){return ie.onClick(ve)}),this.options.columnResizingEnabled&&(this.columnWidthResizeHandler=new T(this,!0,!0)),this.options.rowLevelResizingEnabled&&(this.rowLevelWidthResizeHandler=new f(this,!0)),$(this.element).on(ue.BZ,function(){return ie.onFocusManagerEnter()}),this.element.addEventListener("keydown",function(ve){return ie.onKeyDown(ve)}),this.keyUpState=w.Default,this.element.addEventListener("keyup",function(){return ie.onKeyUp()}),this.focusManager=new L(function(){return ie.onFocusChanged()},this.isA11yTable,this.isA11yMatrix),this.createRenderers(),this.setSteppedLayout(!1),i.scrollingEnabled&&this.attachScrollEventHandlers()}return a.prototype.onShowTotalPlaceHoldersChanged=function(e){e!==this.showTotalPlaceHolders&&(this.showTotalPlaceHolders=e,this.topRenderer&&(this.topRenderer.showTotalPlaceHolders=e),this.midRenderer&&(this.midRenderer.showTotalPlaceHolders=e),this.botRenderer&&(this.botRenderer.showTotalPlaceHolders=e))},a.prototype.updateOptions=function(e){this.options=e},a.prototype.attachScrollEventHandlers=function(){var e=this;z.l.runOutsideAngular(function(){e.midViewport.style.overflowY="auto",e.midViewport.addEventListener("scroll",function(){return e.scrollTo(null,e.midViewport.scrollTop)}),e.innerContainer.addEventListener("wheel",function(t){var i;performance.now()-e.prevHorizontalWheelTime>100&&(e.propagateWheel=void 0),clearInterval(e.momentumScrollHandle);var o=!t.shiftKey&&Math.abs(t.deltaX)<=Math.abs(t.deltaY);if(!e.propagateWheel&&!o){var d=t.shiftKey&&Math.abs(t.deltaX)<=Math.abs(t.deltaY)?t.deltaY:t.deltaX,H=Math.max(Math.min(d,a.ScrollDeltaMax),-a.ScrollDeltaMax),M=e.scrollBy(H,0);null!==(i=e.propagateWheel)&&void 0!==i||(e.propagateWheel=!M),e.propagateWheel||(t.stopPropagation(),t.preventDefault()),e.prevHorizontalWheelTime=performance.now()}}),e.innerContainer.addEventListener("touchstart",function(t){clearInterval(e.momentumScrollHandle),e.propagateTouch=t.touches.length>1||void 0,e.touchPreviousX=t.touches[0].clientX,e.touchPreviousY=t.touches[0].clientY}),e.innerContainer.addEventListener("touchmove",function(t){var i,o;if(!e.propagateTouch){var d=e.touchPreviousX-t.touches[0].clientX,H=e.touchPreviousY-t.touches[0].clientY;if(null!==(i=e.propagateTouch)&&void 0!==i||(e.propagateTouch=0===d||Math.abs(d)<=Math.abs(H)||void 0),!e.propagateTouch){e.touchDeltaX=Math.max(Math.min(d,a.ScrollDeltaMax),-a.ScrollDeltaMax),e.touchPreviousX=t.touches[0].clientX,e.touchPreviousY=t.touches[0].clientY;var M=e.scrollBy(e.touchDeltaX,0);null!==(o=e.propagateTouch)&&void 0!==o||(e.propagateTouch=!M),e.propagateTouch||(t.stopPropagation(),t.preventDefault())}}}),e.innerContainer.addEventListener("touchend",function(){if(!e.propagateTouch){var t=e.renderIteration;e.momentumScrollHandle=setInterval(function(i){i[0]+=1/120;var o=e.touchDeltaX*(1-d3.easeCircleOut(i[0]));t!==e.renderIteration||i[0]>=120||Math.abs(o)<1?clearInterval(e.momentumScrollHandle):e.scrollBy(o,0)},1e3/60,[0])}})})},a.prototype.onFocusManagerEnter=function(){var e;null===(e=this.hostServices.telemetry())||void 0===e||e.trace(2,"TableKeyboardFocused"),this.updateFocus(),this.getFocusedCell(this.focusManager.CurrentFocus).focus({preventScroll:!0})},a.prototype.onKeyUp=function(){switch(this.keyUpState){case w.ColumnResizing:this.columnWidthResizeHandler.onEndResize(),this.keyUpState=w.Default;break;case w.RowLevelResizing:this.rowLevelWidthResizeHandler.onEndResize(),this.keyUpState=w.Default;break;case w.Default:break;default:ee.fF.assertNever(this.keyUpState)}},a.prototype.onKeyDown=function(e){var t=this;if(this.renderLock||this.keyboardLock)return e.stopPropagation(),void e.preventDefault();this.updateFocus();var i=e.code||e.key,o=e.shiftKey,d=J.M.isCtrlOrMeta(e),H=e.altKey,M=this.isA11yTable,x=this.isA11yMatrix;if("Escape"!==i&&"Esc"!==i&&"Tab"!==i){if("ArrowRight"===i||"Right"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o){if(t.focusManager.CurrentFocus.columnHeader&&t.columnWidthResizeHandler)return t.columnWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.columnWidthResizeHandler.onResize({x:1,y:0}),void(t.keyUpState=w.ColumnResizing);if(t.focusManager.CurrentFocus.cornerCell&&t.columnWidthResizeHandler)return t.rowLevelWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.rowLevelWidthResizeHandler.onResize({x:1,y:0}),void(t.keyUpState=w.RowLevelResizing);t.options.rowHeaderExpandCollapseHandler&&t.focusManager.CurrentFocus.rowHeader&&1===t.rowNavigator.getExpansionState(t.focusManager.CurrentFocus.item)&&t.options.rowHeaderExpandCollapseHandler(t.focusManager.CurrentFocus.item,!1)}else t.focusManager.moveFocus("right",d,M,x)});if("ArrowLeft"===i||"Left"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o){if(t.focusManager.CurrentFocus.columnHeader&&t.columnWidthResizeHandler)return t.columnWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.columnWidthResizeHandler.onResize({x:-1,y:0}),void(t.keyUpState=w.ColumnResizing);if(t.focusManager.CurrentFocus.cornerCell&&t.columnWidthResizeHandler)return t.rowLevelWidthResizeHandler.onStartResize(t.focusManager.CurrentFocus.item),t.rowLevelWidthResizeHandler.onResize({x:-1,y:0}),void(t.keyUpState=w.RowLevelResizing);t.options.rowHeaderExpandCollapseHandler&&t.focusManager.CurrentFocus.rowHeader&&0===t.rowNavigator.getExpansionState(t.focusManager.CurrentFocus.item)&&t.options.rowHeaderExpandCollapseHandler(t.focusManager.CurrentFocus.item,!0)}else t.focusManager.moveFocus("left",d,M,x)});if("ArrowUp"===i||"Up"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o&&!d){if(M){var X=t.focusManager.CurrentFocus;t.focusManager.moveFocus("up",d,M,x);var j=t.focusManager.CurrentFocus;t.selectFocus(e,X),t.selectFocus(e,j)}}else t.focusManager.moveFocus("up",d,M,x)});if("ArrowDown"===i||"Down"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(o&&!d){if(M){var X=t.focusManager.CurrentFocus;t.focusManager.moveFocus("down",d,M,x);var j=t.focusManager.CurrentFocus;t.selectFocus(e,X),t.selectFocus(e,j)}}else t.focusManager.moveFocus("down",d,M,x)});if("Home"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("home",d,M,x)});if("End"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("end",d,M,x)});if(this.focusManager.CurrentFocus&&(this.focusManager.CurrentFocus.bodyCell||this.focusManager.CurrentFocus.rowHeader)){if("PageDown"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("pagedown",d,M,x,t.getNumberOfVisibleRows())});if("PageUp"===i)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.focusManager.moveFocus("pageup",d,M,x,t.getNumberOfVisibleRows())})}if("F10"===i&&o)return d?void 0:(e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.showContextMenuForFocus(e)}));if("Enter"===i||"Space"===i||"Spacebar"===i||" "===i)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.selectFocus(e,t.focusManager.CurrentFocus)});if("KeyO"===i&&d&&H)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){t.activateCellContent()});if(("KeyC"===i||"c"===i)&&d&&o)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){t.options.whitespaceClickHandler(null,!0)})}},a.prototype.runIfFrameReady=function(e){return(0,k.mG)(this,void 0,void 0,function(){return(0,k.Jh)(this,function(t){switch(t.label){case 0:return this.keyboardLock=!0,e(),[4,this.requestAnimationFrameAsync()];case 1:return t.sent(),this.keyboardLock=!1,[2]}})})},a.prototype.notifyVisual=function(e){e.bodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item,e.bodyCell.rowIndex):e.columnHeader&&this.options.columnHeaderFocusHandler?this.options.columnHeaderFocusHandler(e.item):e.rowHeader&&this.options.rowHeaderFocusHandler?this.options.rowHeaderFocusHandler(e.item):e.cornerCell&&this.options.cornerCellFocusHandler?this.options.cornerCellFocusHandler(e.item):e.floatingBodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item):void 0!==e.floatingRowHeader&&this.options.rowHeaderFocusHandler&&this.options.rowHeaderFocusHandler(e.item)},a.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e,this.topRenderer.setUnfrozenRowHeaders(e),this.midRenderer.setUnfrozenRowHeaders(e),this.botRenderer.setUnfrozenRowHeaders(e)},a.prototype.setRepeatRowHeaders=function(e){this.topRenderer.setRepeatRowHeaders(e),this.midRenderer.setRepeatRowHeaders(e),this.botRenderer.setRepeatRowHeaders(e)},a.prototype.onFocusChanged=function(){var e,t=this.focusManager.CurrentFocus;ee.fF.assertValue(t,"No current focus"),this.notifyVisual(t);var o,d,H,M,x,X,le,de,i=this.getViewport();if(t.bodyCell)t.bodyCell.columnIndex>=0&&(M=t.bodyCell.columnIndex),o=t.bodyCell.rowIndex;else if(t.rowHeader){var j=S._E.getVisibleRange(i.top,i.height,this.rowHeightMeasureManager),Q=(0,U.hG)(t.item,this.rowNavigator),W=(0,U.O3)(t.item,this.rowNavigator);Q<=j.firstLeafIndex||W-Q+1>=j.lastLeafIndex-j.firstLeafIndex+1?(o=Q,d=!1):(o=Math.min(W,this.rowHeightMeasureManager.getLastMeasuredIndex()),d=!0)}else if(t.columnHeader){var q=S.sW.getVisibleRange(i.left,i.width,this.columnWidthMeasureManager);Q=(0,U.hG)(t.item,this.columnNavigator),W=(0,U.O3)(t.item,this.columnNavigator),Q<=q.firstLeafIndex||W-Q+1>=q.lastLeafIndex-q.firstLeafIndex+1?(M=Q,X=!1):(M=Math.min(W,this.columnWidthMeasureManager.getLastMeasuredIndex()),X=!0)}else t.floatingBodyCell&&(M=t.floatingBodyCell.columnIndex);if(void 0!==o&&this.rowScrollbar.visible&&(j=S._E.getVisibleRange(i.top,i.height,this.rowHeightMeasureManager))&&(o<=j.firstLeafIndex?H={rowIndex:o,visibleHeight:Number.MAX_VALUE,alignBottom:d??!1}:o>=j.lastLeafIndex&&(H={rowIndex:o,visibleHeight:Number.MAX_VALUE,alignBottom:d??!0})),void 0!==M&&this.columnScrollbar.visible&&(q=S.sW.getVisibleRange(i.left,i.width,this.columnWidthMeasureManager))&&(M<=q.firstLeafIndex?x=this.unfrozenRowHeaders&&0===M&&this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin>0?null:{columnIndex:M,visibleWidth:Number.MAX_VALUE,alignRight:X??!1}:M>=q.lastLeafIndex&&(x={columnIndex:M,visibleWidth:Number.MAX_VALUE,alignRight:X??!0})),H&&(le=S._E.getOffset(H,this.rowHeightMeasureManager),H.alignBottom&&(le-=this.rowScrollbar.viewSize)),x&&(de=S.sW.getOffset(x,this.columnWidthMeasureManager),x.alignRight&&(de-=this.columnScrollbar.viewSize),this.unfrozenRowHeaders&&(de+=this.rowLevelWidthMeasureManager.getHeadersWidth())),this.unfrozenRowHeaders&&(t.cornerCell||t.rowHeader||t.floatingRowHeader)){var ce=this.getFocusedCell(t),pe=ce.offsetLeft,Me=ce.offsetWidth;de=pe<this.columnScrollbar.viewMin||Me>this.columnScrollbar.viewSize?pe:pe+Me>this.columnScrollbar.viewMin+this.columnScrollbar.viewSize?pe-this.columnScrollbar.viewSize:null}this.scrollTo(de,le),null===(e=this.getFocusedCell(t))||void 0===e||e.focus({preventScroll:!0})},a.prototype.getFocusedCell=function(e){var t,i;if(e.bodyCell)return-1===e.bodyCell.columnIndex?this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,0,s.aP.Prefix):this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,e.bodyCell.columnIndex,s.aP.Main);if(e.columnHeader){var o=e.item,d=this.columnNavigator.getLevel(o),H=void 0;return H=this.isA11yTable?this.columnNavigator.getIndexOfFirstLeaf(o):null!==(t=this.rowNavigator.getLeafIndex(o))&&void 0!==t?t:this.rowNavigator.getIndexOfFirstLeaf(o),this.topRenderer.getElementByIndex(d,H,s.aP.Main)}if(e.rowHeader){var M=e.item;return d=null!==(i=this.columnNavigator.getLeafIndex(M))&&void 0!==i?i:this.columnNavigator.getIndexOfFirstLeaf(M),H=this.steppedLayout?0:this.rowNavigator.getLevel(M),this.midRenderer.getElementByIndex(d,H,s.aP.Prefix)}return e.cornerCell?this.topRenderer.getElementByIndex(e.cornerCell.columnLevel,e.cornerCell.rowLevel,s.aP.Prefix):e.floatingBodyCell?this.botRenderer.getElementByIndex(e.floatingBodyCell.rowIndex,e.floatingBodyCell.columnIndex,s.aP.Main):null!=e.floatingRowHeader?this.botRenderer.getElementByIndex(e.floatingRowHeader,0,s.aP.Prefix):void ee.fF.assertFail("Unexpected focused item")},a.prototype.getCurrentFocusBoundingRect=function(){var e=document.activeElement;if(e){var t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:t.width,height:t.height}}return{top:0,left:0,width:0,height:0}},a.prototype.selectFocus=function(e,t){var i=t.item,o=this.createMouseEvent(e);t.bodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(i,o,t.bodyCell.rowIndex,s.p0.Body):t.floatingBodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(i,o,void 0,s.p0.Footer):t.rowHeader||void 0!==t.floatingRowHeader?this.options.rowHeaderClickHandler&&this.options.rowHeaderClickHandler(i,o):t.columnHeader?this.options.columnHeaderClickHandler&&this.options.columnHeaderClickHandler(i,o):t.cornerCell?this.options.cornerCellClickHandler&&this.options.cornerCellClickHandler(i,o):ee.fF.assertFail("Unexpected focused item")},a.prototype.activateCellContent=function(){var t=document.activeElement;if(t&&this.focusManager.CurrentFocus&&this.options.cellContentActivationHandler){var i=this.createSimpleMouseClickEvent();this.options.cellContentActivationHandler(t,i)}},a.prototype.createSimpleMouseClickEvent=function(){var e=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:e.left,clientY:e.top,ctrlKey:!1,metaKey:!1,shiftKey:!1,altKey:!1})},a.prototype.createMouseEvent=function(e){var t=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:t.left,clientY:t.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey})},a.prototype.showContextMenuForFocus=function(e){var t,i=this.focusManager.CurrentFocus;if(-1!==(null===(t=i.bodyCell)||void 0===t?void 0:t.columnIndex)){ee.fF.assertValue(i&&i.item,"Keyboard Selection triggered with no focused cell");var o=i.item,d=this.getCurrentFocusBoundingRect(),H=new MouseEvent("contextmenu",{clientX:d.left,clientY:d.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey});i.bodyCell||i.floatingBodyCell?this.options.bodyCellContextMenuHandler&&this.options.bodyCellContextMenuHandler(o,H):i.rowHeader||void 0!==i.floatingRowHeader?this.options.rowHeaderContextMenuHandler&&this.options.rowHeaderContextMenuHandler(o,H):i.columnHeader?this.options.columnHeaderContextMenuHandler&&this.options.columnHeaderContextMenuHandler(o,H):i.cornerCell?this.options.cornerCellContextMenuHandler&&this.options.cornerCellContextMenuHandler(o,H):ee.fF.assertFail("Unexpected focused item")}},a.prototype.onClick=function(e){var t=this.rowLevelWidthMeasureManager.getHeadersWidth()+this.columnWidthMeasureManager.getColumnsWidth(),i=this.columnLevelHeightMeasureManager.getHeadersHeight()+this.rowHeightMeasureManager.getRowsHeight()+this.rowHeightMeasureManager.getFloatingRowHeights();if(!(t>=this.width&&i>=this.height)){var o=(0,K.ut)(this.element,e);(o.x>t||o.y>i)&&this.options.whitespaceClickHandler(e)}},a.prototype.initializeScrollbars=function(){var e=this;this.columnScrollbar=new F.Xg(this.element,0,!0,this.options.onScroll),this.columnScrollbar.smallIncrement=20,this.columnScrollbar.min=0,this.columnScrollbar.height=(0,C.S)(n.zf),this.columnScrollbar.element.style.position="absolute",this.columnScrollbar.element.style.left=this.isA11yTable?"1px":"0",this.columnScrollbar.element.style.bottom="0",this.columnScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar=new F.AT(this.element,0,!0,this.options.onScroll),this.rowScrollbar.smallIncrement=20,this.rowScrollbar.min=0,this.rowScrollbar.width=(0,C.S)(n.zf),this.rowScrollbar.element.style.position="absolute",this.rowScrollbar.element.style.right="0",this.rowScrollbar.element.style.top="0",this.rowScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar.element.setAttribute("aria-hidden","true"),this.columnScrollbar.element.setAttribute("aria-hidden","true")},a.prototype.setSteppedLayout=function(e){if(e!==this.steppedLayout){this.steppedLayout=e;var t=e?s.xU.Stepped:s.xU.Blocked;this.columnWidthMeasureManager=new S.Sv(this.measureElement,this.sizeManager),this.rowLevelWidthMeasureManager=this.steppedLayout?new S.FA(this.measureElement,this.sizeManager):new S.DX(this.measureElement,this.sizeManager),this.rowHeightMeasureManager=this.steppedLayout?new S.AV(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager):new S.DJ(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.columnLevelHeightMeasureManager=new S.sB(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.topRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.midRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.botRenderer.updateMeasureManagers(t,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.focusManager.updateMeasureManagers(this.rowHeightMeasureManager,this.columnWidthMeasureManager),this.clearMeasurement()}},a.prototype.createRenderers=function(){var e=this,t=this.isA11yTable?s.y2.Table:s.y2.Matrix;this.topRenderer=new p(this.topViewport,this.options.cornerCellClickHandler,this.options.cornerCellContextMenuHandler,this.options.columnHeaderClickHandler,this.options.columnHeaderContextMenuHandler,this.options.columnHeaderInteractionHandler,s.p0.Header,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.topRenderer.setResizeHandlers(this.columnWidthResizeHandler,this.rowLevelWidthResizeHandler),this.midRenderer=new R(this.innerBodyCellContainer,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,s.p0.Body,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.botRenderer=new b(this.botViewport,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,s.p0.Footer,t,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu)},a.prototype.setWidth=function(e){this.width=e,this.element.style.width=(0,C.S)(this.width),this.columnScrollbar.invalidateArrange()},a.prototype.setHeight=function(e){this.height=e,this.element.style.height=(0,C.S)(this.height),this.rowScrollbar.invalidateArrange()},a.prototype.getWidth=function(){return this.width},a.prototype.getHeight=function(){return this.height},a.prototype.setClassName=function(e){this.element.className=e},a.prototype.setColumnNavigator=function(e){this.columnNavigator=e,this.focusManager.columnNavigator=e},a.prototype.setRowNavigator=function(e){this.rowNavigator=e,this.focusManager.rowNavigator=e},a.prototype.setBinder=function(e){this.binder=e},a.prototype.getSteppedLayout=function(){return this.steppedLayout},a.prototype.getColumnNavigator=function(){return this.columnNavigator},a.prototype.getRowNavigator=function(){return this.rowNavigator},a.prototype.getSizeManager=function(){return this.sizeManager},a.prototype.getBinder=function(){return this.binder},a.prototype.getColumnWidthMeasureManager=function(){return this.columnWidthMeasureManager},a.prototype.getRowHeightMeasureManager=function(){return this.rowHeightMeasureManager},a.prototype.getColumnLevelHeightMeasureManager=function(){return this.columnLevelHeightMeasureManager},a.prototype.getRowLevelWidthMeasureManager=function(){return this.rowLevelWidthMeasureManager},a.prototype.getTopRenderer=function(){return this.topRenderer},a.prototype.getMidRenderer=function(){return this.midRenderer},a.prototype.getBotRenderer=function(){return this.botRenderer},a.prototype.getViewport=function(){var e=this.columnScrollbar.viewMin,t=this.rowScrollbar.viewMin,i=this.columnScrollbar.viewSize,o=this.rowScrollbar.viewSize;return this.unfrozenRowHeaders&&(e=Math.max(e-this.rowLevelWidthMeasureManager.getHeadersWidth(),0),i-=Math.max(this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin,0)),{left:e,top:t,width:i=Math.max(i,0),height:o=Math.max(o,0)}},a.prototype.getClientWidth=function(){return this.width-(this.rowScrollbar.visible?n.zf:0)},a.prototype.storeFocus=function(){var t,i,o,d,e=document.activeElement;if(this.topViewport.contains(e))this.topRenderer.isPrefixCell(e)?(t=this.topRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),o=s.p0.Header,d=s.aP.Prefix):(t=this.topRenderer.getRowIndex(e),i=this.topRenderer.getColumnIndex(e),o=s.p0.Header,d=s.aP.Main);else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?(t=this.midRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),o=s.p0.Body,d=s.aP.Prefix):(t=this.midRenderer.getRowIndex(e),i=this.midRenderer.getColumnIndex(e),o=s.p0.Body,d=s.aP.Main);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?(t=this.botRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),o=s.p0.Footer,d=s.aP.Prefix):(t=this.botRenderer.getRowIndex(e),i=this.botRenderer.getColumnIndex(e),o=s.p0.Footer,d=s.aP.Main);else if(this.isA11yTable){var M=d3.select(this.topViewport).select(".main-cell").node();t=this.topRenderer.getRowIndex(M),i=this.topRenderer.getColumnIndex(M),o=s.p0.Header,d=s.aP.Main}else{var x=d3.select(this.topViewport).select(".prefix-cell").node();t=this.topRenderer.getRowIndex(x),i=this.topRenderer.getColumnIndex(x),o=s.p0.Header,d=s.aP.Prefix}this.tempFocus={rowIndex:t,columnIndex:i,section:o,region:d}},a.prototype.restoreFocus=function(){var t,e=this;ee.fF.assert(function(){return!!e.tempFocus},"tempFocus must be defined"),this.tempFocus.section===s.p0.Header?t=this.topRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===s.p0.Body?t=-1===this.tempFocus.columnIndex?this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,0,s.aP.Prefix):this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===s.p0.Footer&&(t=this.botRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region)),t||(this.updateFocus(),t=this.getFocusedCell(this.focusManager.CurrentFocus)),t.focus({preventScroll:!0})},a.prototype.updateFocus=function(){var t,i,o,d,e=document.activeElement;if(this.topViewport.contains(e))if(this.topRenderer.isPrefixCell(e))t=this.topRenderer.getRowIndex(e),i=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),o=this.isA11yTable?s.p0.Header:s.p0.MatrixCorner;else{var M=this.topRenderer.getItemByElement(e);o=s.p0.Header,d=this.columnNavigator.getPathIndices(M)}else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?this.isA11yTable?(t=this.midRenderer.getRowIndex(e),i=-1,o=s.p0.Body):(M=this.midRenderer.getItemByElement(e),o=s.p0.MatrixRowHeader,d=this.rowNavigator.getPathIndices(M)):(t=this.midRenderer.getRowIndex(e),i=this.midRenderer.getColumnIndex(e),o=s.p0.Body);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?this.isA11yTable?(t=this.botRenderer.getRowIndex(e),i=-1,o=s.p0.Footer):(t=this.botRenderer.getRowIndex(e),o=s.p0.FooterHeader):(t=this.botRenderer.getRowIndex(e),i=this.botRenderer.getColumnIndex(e),o=s.p0.Footer);else if(this.isA11yTable){var x=d3.select(this.topViewport).select(".main-cell").node();t=this.topRenderer.getRowIndex(x),i=this.topRenderer.getColumnIndex(x),o=s.p0.Header}else{var X=d3.select(this.topViewport).select(".prefix-cell").node();t=this.topRenderer.getRowIndex(X),i=this.topRenderer.getColumnIndex(X),o=s.p0.MatrixCorner}this.focusManager.setAsFocusTableEx(t,i,o,d)},a.prototype.scrollBy=function(e,t){if(this.renderLock)return!1;var i,o;if(e){var d=this.columnScrollbar.viewMin;this.columnScrollbar.scrollBy(e,!0),this.columnScrollbar.refresh(),i=d!==this.columnScrollbar.viewMin}if(t){var M=this.rowScrollbar.viewMin;this.rowScrollbar.scrollBy(t,!0),this.rowScrollbar.refresh(),o=M!==this.rowScrollbar.viewMin}return!(!i&&!o||(this.refresh(),0))},a.prototype.scrollTo=function(e,t){this.renderLock||(null!=e&&(this.columnScrollbar.scrollTo(e,!0),this.columnScrollbar.refresh()),null!=t&&(this.rowScrollbar.scrollTo(t,!0),this.rowScrollbar.refresh()),this.refresh())},a.prototype.refresh=function(){if(!this.renderLock){this.options.onScroll&&this.options.onScroll();var e=this.getViewport(),t=this.columnScrollbar.viewMin,i=this.rowScrollbar.viewMin;this.topRenderer.scrollToX(t),this.midRenderer.scrollToX(t),this.botRenderer.scrollToX(t),this.midViewport.scrollTop=i,this.rowScrollbar.viewMin=this.midViewport.scrollTop,this.topRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.midRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.botRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator)}},a.prototype.renderAsync=function(e,t,i){return(0,k.mG)(this,void 0,void 0,function(){var o,d,H,M,x;return(0,k.Jh)(this,function(X){switch(X.label){case 0:return o=++this.renderIteration,e===s.BM.ClearMeasurement&&this.clearMeasurement(),this.lockRendering(),[4,this.measureAsync(t,i,o)];case 1:return x=X.sent(),d=x[0],H=x[1],o!==this.renderIteration||(this.unlockRendering(),(M=this.element.contains(document.activeElement))&&this.storeFocus(),(e===s.BM.ClearRendering||e===s.BM.ClearMeasurement)&&this.clearRendering(),this.updateRegionsPosition(),this.updateScrollbars(),this.updateScrollRegionWidth(),this.updateScrollRegionHeight(),this.scrollTo(d,H),e===s.BM.ResizeColumn&&(this.topRenderer.onColumnResize(),this.midRenderer.onColumnResize(),this.botRenderer.onColumnResize()),M&&(e===s.BM.ClearRendering||e===s.BM.ClearMeasurement)&&this.restoreFocus(),this.updateAria(),this.subSelectionHelper&&this.onObject&&this.subSelectionHelper.addDirectEditPlaceholderOutlines()),[2]}})})},a.prototype.lockRendering=function(){this.midViewport.style.overflow="hidden",this.renderLock=!0},a.prototype.unlockRendering=function(){this.scrollingEnabled&&(this.midViewport.style.overflowY="auto"),this.renderLock=!1},a.prototype.measureAsync=function(e,t,i){return(0,k.mG)(this,void 0,void 0,function(){var o,d,H,M,x,X,j;return(0,k.Jh)(this,function(Q){switch(Q.label){case 0:if(x=this.getViewport(),e?M=e.rowIndex:(X=S._E.getVisibleRange(x.top,x.height,this.rowHeightMeasureManager),M=X?X.firstLeafIndex:0),t?H=t.columnIndex:(j=S.sW.getVisibleRange(x.left,x.width,this.columnWidthMeasureManager),H=j?j.firstLeafIndex:0),H=Math.max(0,Math.floor(H-S.EO/2)),!t)return[3,4];Q.label=1;case 1:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&t.columnIndex>this.columnWidthMeasureManager.getLastMeasuredIndex()?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,M),[4,this.setTimeoutAsync()]):[3,3];case 2:return Q.sent(),i!==this.renderIteration?[2,[0,0]]:[3,1];case 3:return o=S.sW.getOffset(t,this.columnWidthMeasureManager),t.alignRight&&(o-=this.columnScrollbar.viewSize),[3,5];case 4:o=this.columnScrollbar.viewMin,Q.label=5;case 5:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&this.columnWidthMeasureManager.getColumnsWidth()-o<=this.width?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,M),[4,this.setTimeoutAsync()]):[3,7];case 6:return Q.sent(),i!==this.renderIteration?[2,[0,0]]:[3,5];case 7:if(this.rowLevelWidthMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,M,S.Ms),this.rowHeightMeasureManager.ensureLastPageComplete(this.binder,this.rowNavigator,this.columnNavigator,M,H,S.EO),!e)return[3,11];Q.label=8;case 8:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&e.rowIndex>this.rowHeightMeasureManager.getLastMeasuredIndex()?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,M,H),[4,this.setTimeoutAsync()]):[3,10];case 9:return Q.sent(),i!==this.renderIteration?[2,[0,0]]:[3,8];case 10:return d=S._E.getOffset(e,this.rowHeightMeasureManager),e.alignBottom&&(d-=this.rowScrollbar.viewSize),[3,12];case 11:d=this.rowScrollbar.viewMin,Q.label=12;case 12:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&this.rowHeightMeasureManager.getRowsHeight()-d<=this.height?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,M,H),[4,this.setTimeoutAsync()]):[3,14];case 13:return Q.sent(),i!==this.renderIteration?[2,[0,0]]:[3,12];case 14:return this.rowHeightMeasureManager.measureFloatingRows(this.binder,this.rowNavigator,this.columnNavigator,M,H,this.onObject,this.showTotalPlaceHolders),this.columnLevelHeightMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,M,H,S.EO),this.measurePageColumnsAsync(M,i),this.measurePageRowsAsync(M,H,i),[2,[o,d]]}})})},a.prototype.updateAria=function(){var e=this.columnNavigator.getHierarchyDepth()+this.rowNavigator.getHierarchyLeafCount()+this.rowNavigator.getFloatingHierarchyLeafCount(),t=this.rowNavigator.getHierarchyDepth()+this.columnNavigator.getHierarchyLeafCount();d3.select(this.innerContainer).attr("aria-rowcount",e),d3.select(this.innerContainer).attr("aria-colcount",t)},a.prototype.setTimeoutAsync=function(e){return void 0===e&&(e=0),(0,k.mG)(this,void 0,void 0,function(){return(0,k.Jh)(this,function(t){return[2,new ne.J(function(i){return z.l.setTimeout(function(){return i()},e)})]})})},a.prototype.requestAnimationFrameAsync=function(){return(0,k.mG)(this,void 0,void 0,function(){return(0,k.Jh)(this,function(e){return[2,new ne.J(function(t){return z.l.requestAnimationFrame(function(){return t()})})]})})},a.prototype.getVisibleRowStart=function(){var e=this.getViewport(),t=S._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);return t?S._E.getVisibleRowStart(t,e.top,this.rowHeightMeasureManager):null},a.prototype.getVisibleColumnStart=function(){var e=this.getViewport(),t=S.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager);return t?S.sW.getVisibleColumnStart(t,e.left,this.columnWidthMeasureManager):null},a.prototype.clearRendering=function(){this.midRenderer.clear(),this.topRenderer.clear(),this.botRenderer.clear()},a.prototype.clearMeasurement=function(){this.columnWidthMeasureManager.clear(),this.rowHeightMeasureManager.clear(),this.columnLevelHeightMeasureManager.clear(),this.rowLevelWidthMeasureManager.clear()},a.prototype.clear=function(){this.renderIteration++,this.clearRendering(),this.clearMeasurement(),this.unlockRendering()},a.prototype.updateRegionsPosition=function(){this.midViewport.style.top=this.topViewport.style.height=(0,C.S)(this.columnLevelHeightMeasureManager.getHeadersHeight()),this.topRenderer.updateBodyLeft(),this.midRenderer.updateBodyLeft(),this.botRenderer.updateBodyLeft();var e=(0,C.S)(this.rowHeightMeasureManager.getFloatingRowHeights());this.botViewport.style.height=e},a.prototype.updateScrollbars=function(){this.rowScrollbar.invalidateArrange(),this.columnScrollbar.invalidateArrange();var e=this.rowHeightMeasureManager.getFloatingRowHeights(),t=this.height-this.columnLevelHeightMeasureManager.getHeadersHeight()-e,i=this.width-this.rowLevelWidthMeasureManager.getHeadersWidth(),o=this.rowHeightMeasureManager.getRowsHeight(),d=this.columnWidthMeasureManager.getColumnsWidth(),H=this.options.scrollingEnabled&&o>0&&o>t,M=this.options.scrollingEnabled&&d>0&&d>i;!H&&M&&o>0&&(H=o>t-n.zf),!M&&H&&d>0&&(M=d>i-n.zf),this.midViewport.style.right=this.topViewport.style.right=this.botViewport.style.right=H?this.rowScrollbar.width:(0,C.S)(0);var X,j,x=M?n.zf:0;o>t-x?(X=x+e,j=x):(X=t+e-o,j=t-o),this.midViewport.style.bottom=(0,C.S)(X),this.botViewport.style.bottom=(0,C.S)(j),this.rowScrollbar.show(H),this.rowScrollbar.viewSize=this.midViewport.clientHeight,this.rowScrollbar.element.style.bottom=M?n.zf+"px":"0",this.rowScrollbar.refresh(),this.columnScrollbar.show(M),this.columnScrollbar.viewSize=this.getBodyCellWidth(),this.unfrozenRowHeaders&&(this.columnScrollbar.viewSize+=this.rowLevelWidthMeasureManager.getHeadersWidth()),this.columnScrollbar.element.style.right=H?n.zf+"px":"0",this.columnScrollbar.refresh()},a.prototype.getBodyCellWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth();return Math.min(this.midViewport.clientWidth-e,t)},a.prototype.measurePageColumnsAsync=function(e,t){return(0,k.mG)(this,void 0,void 0,function(){return(0,k.Jh)(this,function(i){switch(i.label){case 0:return[4,this.setTimeoutAsync(n.yv)];case 1:if(i.sent(),t!==this.renderIteration)return[2];i.label=2;case 2:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e),this.updateScrollRegionWidth(),[4,this.setTimeoutAsync(n.yv)]):[3,4];case 3:return i.sent(),t!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},a.prototype.measurePageRowsAsync=function(e,t,i){return(0,k.mG)(this,void 0,void 0,function(){return(0,k.Jh)(this,function(o){switch(o.label){case 0:return[4,this.setTimeoutAsync(n.yv)];case 1:if(o.sent(),i!==this.renderIteration)return[2];o.label=2;case 2:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e,t),this.updateScrollRegionHeight(),[4,this.setTimeoutAsync(n.yv)]):[3,4];case 3:return o.sent(),i!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},a.prototype.updateScrollRegionWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),t=this.columnWidthMeasureManager.getColumnsWidth(),i=this.midViewport.clientWidth;this.columnScrollbar.max=this.unfrozenRowHeaders?t+e:t,this.columnScrollbar.viewSize=this.unfrozenRowHeaders?i:i-e,this.columnScrollbar.refresh(),this.topRenderer.setRowWidth(),this.midRenderer.setRowWidth(),this.botRenderer.setRowWidth()},a.prototype.updateScrollRegionHeight=function(){var e=this.rowHeightMeasureManager.getRowsHeight(),t=this.midViewport.clientHeight,i=(0,C.S)(Math.max(e,t));this.innerBodyCellContainer.style.height=i,this.rowScrollbar.max=e,this.rowScrollbar.viewSize=t,this.rowScrollbar.refresh()},a.prototype.getNumberOfVisibleRows=function(){var e=this.getViewport(),t=S._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);if(t)return Math.max(0===t.firstLeafIndex?t.lastLeafIndex-t.firstLeafIndex:t.lastLeafIndex-t.firstLeafIndex-1,1)},a.prototype.getMidViewportBoundingClientRect=function(){return this.midViewport.getBoundingClientRect()},a.prototype.getTopViewportBoundingClientRect=function(){return this.topViewport.getBoundingClientRect()},a.prototype.getBotViewportBoundingClientRect=function(){return this.botViewport.getBoundingClientRect()},a.prototype.destroy=function(){this.renderIteration=NaN},a.ScrollDeltaMax=200,a}()},91468:function(Le,me,D){D.d(me,{CQ:function(){return h},D2:function(){return R},JT:function(){return f},K2:function(){return I},Km:function(){return i},Kq:function(){return Q},MO:function(){return T},Nk:function(){return X},Od:function(){return M},Ps:function(){return b},RD:function(){return e},RP:function(){return a},TQ:function(){return x},VM:function(){return s},X1:function(){return N},aY:function(){return j},do:function(){return l},jv:function(){return d},kJ:function(){return p},n2:function(){return L},qk:function(){return V},rP:function(){return H},s$:function(){return m},tO:function(){return t},wV:function(){return g},x9:function(){return u}});var k=D(18664),ue=D(91358),ee=D(32105),J=D(19650),ne=D(62458),z=D(32041),F=D(48066),K=D(38078),A=D(66001),U=D(7911),S=D(93340),C=D(71090),n="0.3",s="cell-interactive",g="pivotTableCellNoWrap",L="pivotTableCellWrap",I=5,m=5,T=5;function V(W){return W.insertAdjacentHTML("beforeend",U.bG.build({content:"",classNames:null,styleProperties:{position:"absolute",left:"0",top:"0",visibility:"hidden"},attributes:null},null)),W.lastChild}function N(W,Y){return _.isEmpty(W)?0:z.b.measureSvgTextWidth(Y,W)}function f(W,Y){if(_.isEmpty(W))return 0;var Z=0;return W.split("\n").forEach(function(q){var ie=N(q,Y);ie>Z&&(Z=ie)}),Z}function l(W,Y,Z){return _.isEmpty(W)?[W]:(W=W.trim(),(0,A.ql)(W,Z,z.b.measureSvgTextWidth,Y,C.uZ,void 0,!0,!0))}function u(W,Y){return Math.max(0,W-(Y.getExtraLeft()+Y.getExtraRight()))}function h(W){W.opacity=n}function p(W,Y){return ne.fF.assertValue(W,"kpi"),ne.fF.assertValue(Y,"kpiValue"),U.bG.build({content:"",classNames:[(0,ue.sq)(W,Y)||""],styleProperties:{display:"inline-block","vertical-align":"bottom",margin:"0"},attributes:null},null)}function R(W,Y,Z,q){var ie={tagName:"img",content:"",classNames:null,styleProperties:{"max-height":"100%","max-width":"100%"},attributes:{src:W,referrerpolicy:"no-referrer"},contextMenuHandler:function(le){le.stopPropagation()}};return null!=q&&(ie.attributes.alt=q),{children:[ie],classNames:[C.Ed],styleProperties:{height:Y+"px",width:Z+"px"},attributes:null}}function b(W,Y,Z,q){ne.fF.assertValue(W,"undefined iconSettings");var ie={attributes:{},styleProperties:{},classNames:["flex-container"]},ae=function(W,Y,Z){ne.fF.assertValue(W,"undefined icon");var q=Y+"px";return null===W.value?{tagName:"div",styleProperties:{height:q,width:q},attributes:{},classNames:null}:(ne.fF.assertValue(W.value,"Undefined icon value"),W.value.svgId?{tagName:"svg",attributes:{height:q,width:q,role:"img","aria-label":Z.getLocalizedString(W.value.descriptionKey)},classNames:null,styleProperties:{},children:[{tagName:"use",attributes:{href:"#"+W.value.svgId},classNames:null,styleProperties:{}}]}:null!=W.value.url?{tagName:"img",classNames:null,styleProperties:{height:q,width:q},attributes:{src:(0,K.HZ)(W.value.url),referrerpolicy:"no-referrer"}}:void ne.fF.assertFail("Unrecognized icon value"))}(W,Y,q);switch(Z.classNames.push("stretching-content"),W.layout){case"IconOnly":Z.children=[ae],B(W,Z),ie.children=[Z];break;case"After":B(W,ae),ie.children=[Z,ae];break;default:B(W,ae),ie.children=[ae,Z]}return ie}function B(W,Y){Y.classNames||(Y.classNames=[]);var Z=Y.classNames;switch(Z.push("tablixIcon"),W.layout){case"IconOnly":break;case"Before":Z.push("before");break;default:Z.push("after")}switch(W.verticalAlignment){case"Bottom":Z.push("bottom");break;case"Middle":Z.push("middle");break;default:Z.push("top")}}function a(W,Y){return W?(0,S.RP)(Y):null}function e(W,Y,Z,q,ie,ae){var le={tagName:"a",classNames:[],styleProperties:{},attributes:{href:Y,target:"_blank",rel:"noopener noreferrer",role:"link"},clickHandler:function(ce){ce.stopPropagation(),q(Y,ce)},contextMenuHandler:function(ce){ce.stopPropagation()}};return"string"==typeof W?le.content=W:le.children=[W],Z&&(le.content=void 0,le.children=void 0,le.classNames.push(C.NA,Z),le.attributes["aria-label"]=Y),ie&&(le.styleProperties.color="inherit"),ae&&(le.attributes.title=Y),le}function t(W){return W-1}function i(W,Y,Z,q,ie,ae,le){var de,ce={};return Y&&(de=W?["powervisuals-glyph","sort-icon",o(W)]:Z?["powervisuals-glyph","sort-icon",o(q),"future"]:["sort-icon"]),!W&&Z?ce["aria-label"]=le.getLocalizedString("Field_Sorting_Possible"):ce["aria-hidden"]="true",{content:C.jv,attributes:ce,styleProperties:{"font-size":ae,bottom:ie+"px"},classNames:de}}function o(W){switch(W){case 1:return"caret-up";case 2:return"caret-down"}}function d(W,Y){return(0,S.MN)(W,Y)!==F.av.NONE}function H(W){return W&&W.replace(/&#10;/g,"<BR />")}function M(W,Y){W.size&&8.52===W.size.px&&(W=(0,k.ED)(W,{size:ee.B.createFromPx(8)}));var Z={measuredFontHeight:null,textProperties:(0,k.qk)(W),fontProperties:W};return Y.addItem(Z),Z}function x(W,Y,Z){return M((0,k.ED)(W.fontProperties,Y),Z)}function X(W,Y,Z){var q=W.fontProperties;q.family&&(Y.fontFamily=q.family),q.size&&(Y.fontSize=q.size),q.weight&&(Y.fontWeight=q.weight),q.style&&(Y.fontStyle=q.style),q.textDecoration&&Z&&(Y.textDecoration=q.textDecoration)}function j(W,Y,Z){if(ne.fF.assertValue(Y,"PivotTableBinderUtils.addAlignmentCssClass - classes"),null==W||W===J.H.auto){if(!Z)return;W=Z}switch(W){case J.H.left:return void Y.push(C.z7);case J.H.center:return void Y.push(C.QM);case J.H.right:return void Y.push(C.OM);default:return}}var Q=function(){function W(){this.items=[]}return W.prototype.addItem=function(Y){this.items.push(Y)},W.prototype.measureAll=function(Y){if(!_.isEmpty(this.items)){for(var Z=[],q=0,ie=this.items;q<ie.length;q++){var le={content:"a",classNames:null,styleProperties:(0,k.wB)(ie[q].fontProperties),attributes:null};Z.push(U.bG.build(le,null))}var de=Z.join("");Y.insertAdjacentHTML("beforeend",de);for(var pe,ce=!0,Me=0,ve=this.items;Me<ve.length;Me++)ce?(ce=!1,pe=Y.firstChild):pe=pe.nextSibling,ve[Me].measuredFontHeight=Math.ceil(pe.offsetHeight);Y.innerHTML=""}},W}()},59151:function(Le,me,D){D.d(me,{P:function(){return ue}});var k=D(55007);function ue(ee,J,ne){for(var z={remove:[],merge:[]},F=0,K=ee;F<K.length;F++){var A=K[F],U={selector:A.selector,objectName:k.FX.PropColumnWidthValue.objectName,properties:{}};U.properties[k.FX.PropColumnWidthValue.propertyName]=A.value,null==A.value?z.remove.push(U):z.merge.push(U)}J.persistProperties(z,ne)}},13375:function(Le,me,D){D.d(me,{aD:function(){return U},hc:function(){return S}});var k=D(81337),ue=D(62458),ee=D(39681),J=D(38078),ne=D(93340),z=D(29043),F=D(66842),K=D(40845),A=function(C){function n(s,g,L,I,m,T,V,N){var l,u,h,p,f=this;if(L)for(h=L;h.parent;)h=h.parent;if(I)for(p=I;p.parent;)p=p.parent;var R=p&&!!p.isSubtotal,b=!R&&I&&!!I.isSubtotal,w=h&&!!h.isSubtotal,B=!w&&L&&!!L.isSubtotal,a=L.isBlankRow;return _.isString(s)&&!(null===(u=null===(l=m?.type)||void 0===l?void 0:l.misc)||void 0===u)&&u.sparkline&&(s=(0,z.th)(s,T)),(f=C.call(this,s,g,B,b,w,R,a,m,V,N,0)||this).rowItem=L,f.columnItem=I,f.hasRowSubtotalStyle=L&&L.hasSubtotalStyle,f.hasColumnSubtotalStyle=I&&I.hasSubtotalStyle,f.hasSubtotalStyle=f.hasRowSubtotalStyle||f.hasColumnSubtotalStyle,f}return(0,k.ZT)(n,C),Object.defineProperty(n.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),n}(ne.jG);function U(C,n,s,g,L,I,m,T,V,N){void 0===m&&(m=!0);var f=new S(g,L,I,N,!0);return m&&f.update(C,!1,!1,!1,n,!0,s,T,V,void 0,void 0,!1),f}var S=function(){function C(n,s,g,L,I){this.tablixProperties=s,this.hostServices=g,this.expandCompositeHierarchy=L,this.modernRowHeaderStyle=I,this.compositeGroupSeparator=n}return C.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},C.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},C.prototype.getLeafCount=function(n){var s=this.getMatrixHierarchy(n);return s?s.leafNodes.length:0},C.prototype.getLeafAt=function(n,s){var g=this.getMatrixHierarchy(n);return g?g.leafNodes[s]:null},C.prototype.getLeafIndex=function(n){return ue.fF.assertValue(n,"item"),n.leafIndex},C.prototype.getParent=function(n){return ue.fF.assertValue(n,"item"),0===n.level?null:n.parent},C.prototype.getIndex=function(n){return ue.fF.assertValue(n,"item"),n?n.index:-1},C.prototype.isLeaf=function(n){return ue.fF.assertValue(n,"item"),!n.children||0===n.children.length},C.prototype.isRowHierarchyLeaf=function(n){return!0},C.prototype.isColumnHierarchyLeaf=function(n){return!1},C.prototype.isFirstItem=function(n,s){return n===_.head(s)},C.prototype.areAllParentsFirst=function(n,s){if(!n)return!1;var g=this.getParent(n);return g?this.isFirstItem(n,n.siblings)&&this.areAllParentsFirst(g,g.siblings):this.isFirstItem(n,n.siblings)},C.prototype.isLastItem=function(n,s){if(ue.fF.assertValue(n,"item"),n!==_.last(s))return!1;if(!this.isItemRow(n)||this.isDataComplete)return!0;for(var g=n.parent;g;){if(g!==_.last(g.siblings))return!0;g=g.parent}return!1},C.prototype.isItemRow=function(n){if(!n)return!1;for(var s=n;s.parent;)s=s.parent;return s.siblings===this.rowHierarchy.root.children},C.prototype.areAllParentsLast=function(n,s){if(!n)return!1;var g=this.getParent(n);return g?this.isLastItem(n,n.siblings)&&this.areAllParentsLast(g,g.siblings):this.isLastItem(n,n.siblings)},C.prototype.getChildren=function(n){return ue.fF.assertValue(n,"item"),n.children},C.prototype.getChildrenLevelDifference=function(n){var s=1/0,g=this.getChildren(n);if(!_.isEmpty(g))for(var L=0,I=g.length;L<I;L++)s=Math.min(s,g[L].level-n.level);return s},C.prototype.getCount=function(n){return ue.fF.assertValue(n,"items"),n.length},C.prototype.getAt=function(n,s){return ue.fF.assertValue(n,"items"),n[s]},C.prototype.getLevel=function(n){return ue.fF.assertValue(n,"item"),n.level},C.prototype.getRowLeafIndex=function(n){return this.isSteppedLayout&&n.isSubtotal?n.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?n.parent.leafIndex:n.leafIndex:this.valuesOnRow?n.levelSourceIndex:-1:n.leafIndex},C.prototype.getIntersection=function(n,s){ue.fF.assertValue(n,"rowItem"),ue.fF.assertValue(s,"columnItem");var g,I,L=s.leafIndex;if(g=n.values?n.values[s.leafIndex]:void 0){var m=this.valueSources[g.valueSourceIndex||0],T=m.queryName;I=new A(g.value,g.objects,n,s,m,this.hostServices,this.formatters[T],this.tooltipFormatters[T])}else I=new A(void 0,void 0,n,s,void 0,this.hostServices,void 0,void 0);var f=this.getRowLeafIndex(n);return I.position.row.index=f,I.position.row.indexInSiblings=n.siblings.indexOf(n),I.position.row.isFirst=0===f,I.position.row.isLast=this.isDataComplete&&f===this.rowHierarchy.leafNodes.length-1,I.position.column.index=L,I.position.column.indexInSiblings=s.siblings.indexOf(s),I.position.column.isFirst=0===L,I.position.column.isLast=L===this.columnHierarchy.leafNodes.length-1,g&&g.objects&&(I.backColor=(0,J.HZ)(this.tablixProperties.PropValuesBackColor.getValue(g.objects)),I.fontColor=(0,J.HZ)(this.tablixProperties.PropValuesFontColor.getValue(g.objects))),I},C.prototype.getCorner=function(n,s){ue.fF.assert(function(){return n>=0},"rowLevel"),ue.fF.assert(function(){return s>=0},"columnLevel");var I,g=this.columnHierarchy.levels,L=this.rowHierarchy.levels;if((s===g.length-1||0===g.length)&&(I=L[n])){var m=n===L.length-1,T=this.valuesOnRow&&m;return{metadata:1===I.sources.length||I.sources.length>1&&T?I.sources[0]:null,displayName:T?"":_.map(I.sources,function(f){return f.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:m,position:this.calculateCornerCellPosition(n,s),rowLevel:n,columnLevel:s}}if(n===L.length-1&&(I=g[s])){var N=I.sources.filter(function(l){return!l.isMeasure});return{metadata:1===I.sources.length?I.sources[0]:null,displayName:_.map(N,function(l){return l.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(n,s),rowLevel:n,columnLevel:s}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(n,s),rowLevel:n,columnLevel:s}},C.prototype.calculateCornerCellPosition=function(n,s){var g=new ne.ri,L=s;g.row.index=g.row.indexInSiblings=L,g.row.isFirst=0===L;var I=this.getColumnHierarchyDepth();g.row.isLast=s===I-1;var m=n;g.column.index=g.column.indexInSiblings=m,g.column.isFirst=0===m;var T=this.getRowHierarchyDepth();return g.column.isLast=m===T-1,g},C.prototype.headerItemEquals=function(n,s){return!(!n||!s)&&n===s},C.prototype.bodyCellItemEquals=function(n,s){return n.position.isMatch(s.position)},C.prototype.cornerCellItemEquals=function(n,s){return!(!n||!s)&&n.displayName===s.displayName&&n.isColumnHeaderLeaf===s.isColumnHeaderLeaf&&n.isRowHeaderLeaf===s.isRowHeaderLeaf&&n.metadata===s.metadata},C.prototype.getColumnHierarchy=function(){return this.columnHierarchy},C.prototype.getRowHierarchy=function(){return this.rowHierarchy},C.prototype.getValueSources=function(){return this.valueSources},C.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},C.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},C.prototype.update=function(n,s,g,L,I,m,T,V,N,f,l,u){var h=this;ue.fF.assertValue(n,"matrix"),this.isSteppedLayout=s,this.valuesOnRow=g,this.areRowSubtotalsBefore=L,this.isDataComplete=I,this.valueSources=n.valueSources,this.formatters=T,this.tooltipFormatters=V||{},this.subtotalByColumn=N||{},this.multipleValueSources=n.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(n.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,u,f,l),(m=m||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(n.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,l,this.areRowSubtotalsBefore,function(p,R){return h.calculateRowHeaderPosition(p,R)}),m&&(this.updateHierarchy(this.columnHierarchy,!1,l,!1,function(p,R){return h.calculateColumnHeaderPosition(p,R)}),this.updateStaticColumnHeaders(this.columnHierarchy))},C.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},C.prototype.removeValueNodesFromColumnHierarchy=function(n){ue.fF.assertValue(n,"nodes");for(var s=0,g=n;s<g.length;s++){var L=g[s];if(!L.parent&&this.isLeaf(L))return n.length=0,void n.push({level:0});this.isLeaf(L.children[0])?L.children=void 0:this.removeValueNodesFromColumnHierarchy(L.children)}},C.prototype.addValueNodesToRowHierarchy=function(n,s){for(var g=this.getRowHierarchyDepth(),L=this.valueSources.length,I=n.length,m=0;m<I;m++){var T=n[m];if(this.isLeaf(T)){var V=void 0,N=void 0,f=void 0;if(this.isSteppedLayout&&T.isSubtotal||!s?(n.splice(m,1),V=n,N=m,f=T.level,I=I-1+L,m=m-1+L):(T.children=[],V=T.children,N=0,f=g),!T.isBlankRow)for(var l=0;l<L;l++){var u=this.createRowValueNode(l,L,T,f);V.splice(N++,0,u)}T.values=null}else this.addValueNodesToRowHierarchy(T.children,s)}},C.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},C.prototype.createRowValueNode=function(n,s,g,L){var I={level:L,levelSourceIndex:n,isSubtotal:g.isSubtotal,hasSubtotalStyle:!!g.hasSubtotalStyle,values:{}},m=0,T=0;for(var V in g.values)m%s===n&&(I.values[T++]=g.values[m]),m++;return I},C.prototype.createBlankRowValueNode=function(n){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(n),function(g){return g.valueSourceIndex}).map(function(g){return{value:"",valueSourceIndex:g,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},C.prototype.needsBlankRow=function(n,s,g){return!n.isSubtotal||s===K.we&&g!==F.t.Compact},C.prototype.findValues=function(n){if(n.values)return n.values;var s=_.first(n.children);return s?this.findValues(s):void 0},C.prototype.wrapHierarchy=function(n,s,g,L,I,m){var V,T=this;return V={levels:this.wrapLevels(n.levels,s),root:{children:this.wrapNodes(n.root.children,n,s,g)}},L&&V.root.children.length>0&&(V.root.children=_.flatMap(V.root.children,function(N){return T.needsBlankRow(N,I,m)?[N,T.createBlankRowValueNode(N)]:[N]})),V.leafNodes=[],V},C.prototype.wrapLevels=function(n,s){if(n){for(var g=[],L=0,I=n;L<I.length;L++){var m=I[L],T=(0,ee.ED)(m);if(g.push(T),m.sources.length>1&&s){for(var V=1;V<m.sources.length;V++)g.push({sources:[m.sources[V]]});T.sources.splice(1,T.sources.length-1)}}return g}},C.prototype.wrapNodes=function(n,s,g,L){if(n){for(var I=[],m=0,T=n;m<T.length;m++){var V=T[m],N=(0,ee.ED)(V);if(V.isCollapsed&&!_.isEmpty(V.children)){var f=_.find(V.children,function(w){return w.isSubtotal});f&&(N.values=f.values),N.children=null,N.hasSubtotalStyle=!0}else{if(N.isSubtotal){var l=s.levels[N.level||0];if(1===l.sources.length&&!1===this.subtotalByColumn[l.sources[0].queryName])continue}N.hasSubtotalStyle=!!V.isSubtotal||L&&!_.isEmpty(V.children),N.children=this.wrapNodes(V.children,s,g,L)}if(!_.isEmpty(N.levelValues)&&N.levelValues.length>1&&g){for(var u=N.children,h=N,p=1;p<N.levelValues.length;p++){var R=(0,ee.ED)(N),b=N.levelValues[p];b.levelSourceIndex=0,R.levelValues=[b],R.level+=p,R.isCollapsed=!0,R.children=void 0,h.isCollapsed=!1,h.children=[R],h=R}_.isEmpty(u)||(h.children=u,h.isCollapsed=!1),h.values=N.values,N.values=void 0,N.levelValues.splice(1,N.levelValues.length-1)}I.push(N)}return I}},C.prototype.updateHierarchy=function(n,s,g,L,I){n.leafNodes.length>0&&(n.leafNodes.length=0),n.root.children&&this.updateRecursive(n,n.root.children,null,n.leafNodes,s,g,L,I)},C.prototype.createEmptyNode=function(n){return void 0===n&&(n=0),{level:n,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},C.prototype.updateRecursive=function(n,s,g,L,I,m,T,V){for(var N,f=function(R,b){var w=s[R];if(w.siblings=s,n===l.rowHierarchy&&!w.isCollapsed&&!_.isEmpty(w.children)&&m===F.t.Outline&&!T&&w.children.unshift(l.createEmptyNode(w.children[0].level)),g&&(w.parent=g),N=n===l.rowHierarchy&&l.isSteppedLayout&&w.isSubtotal&&void 0!==w.levelSourceIndex?_.last(n.levels):n.levels[w.level],w.hierarchyLevel=N,N)if(w.levelValues){for(var B=[],a=[],e=0,t=w.levelValues;e<t.length;e++){var i=t[e],H=i.value;B.push(l.formatters[(o=N.sources[i.levelSourceIndex||0]).queryName].format(H,null));var M=l.tooltipFormatters[o.queryName];M&&a.push(M.format(H,null))}ue.fF.assert(function(){return B.length===a.length||_.isEmpty(a)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),w.valueFormatted=B.join(l.compositeGroupSeparator),w.tooltipValueFormatted=_.isEmpty(a)?void 0:a.join(l.compositeGroupSeparator),w.queryName=1!==N.sources.length?void 0:N.sources[0].queryName}else{var o;w.valueFormatted=(o=N.sources[w.levelSourceIndex||0]).displayName,w.tooltipValueFormatted=o.displayName,w.queryName=o.queryName}w.index=R,_.isEmpty(w.children)?(!I||!w.isSubtotal||!T&&w.parent&&!w.parent.isSubtotal||l.valuesOnRow&&w.parent)&&(w.leafIndex=L.length,L.push(w)):(I&&(w.leafIndex=L.length,L.push(w)),l.updateRecursive(n,w.children,w,L,I,m,T,V),I&&(ue.fF.assertAnyValue(_.every(w.children,function(x){return _.isEqual(x.hierarchyLevel,w.children[0].hierarchyLevel)}),"Children may come from different levels"),(!l.hasMultipleValueSources()||_.some(w.children,function(x){return _.some(x.hierarchyLevel.sources,function(X){return!X.isMeasure})}))&&(w.hasSubtotalStyle=!0))),w.position=V(w,s)},l=this,u=0,h=s.length;u<h;u++)f(u)},C.prototype.updateStaticColumnHeaders=function(n){var s=n.leafNodes;if(s&&s.length>0){if(!s[0].identity&&this.valuesOnRow&&1===s.length)return;for(var g=0,L=s.length;g<L;g++){var I=s[g];if(!I.identity&&_.isEmpty(I.levelValues)){var T=n.levels[I.level].sources[I.levelSourceIndex?I.levelSourceIndex:0];T&&(I.valueFormatted=T.displayName)}}}},C.prototype.getMatrixHierarchy=function(n){var s=this.rowHierarchy.root.children;if(s&&n===s)return this.rowHierarchy;var g=this.columnHierarchy.root.children;return g&&n===g?this.columnHierarchy:null},C.prototype.calculateRowHeaderPosition=function(n,s){var g=new ne.ri;g.row.index=this.getRowLeafIndex(n),g.row.indexInSiblings=this.getIndex(n),g.row.isFirst=this.areAllParentsFirst(n,s),g.row.isLast=this.areAllParentsLast(n,s);var L=this.getLevel(n);return g.column.index=g.column.indexInSiblings=L,g.column.isFirst=0===L,g.column.isLast=this.isLeaf(n),g},C.prototype.calculateColumnHeaderPosition=function(n,s){var g=new ne.ri,L=this.getLevel(n);g.row.index=g.row.indexInSiblings=L,g.row.isFirst=0===L,g.row.isLast=this.isLeaf(n);var I=this.getIndex(n);return g.column.index=g.column.indexInSiblings=I,g.column.isFirst=this.areAllParentsFirst(n,s),g.column.isLast=this.areAllParentsLast(n,s),g},C.prototype.getRowHeaderMetadataColumn=function(n){var s=this.getRowHeaderMetadataColumns(n);return s&&s[0]},C.prototype.getRowHeaderMetadataColumns=function(n){if(n&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,n.level)},C.prototype.getColumnHeaderMetadataColumn=function(n){var s=this.getColumnHeaderMetadataColumns(n);return s&&s[0]},C.prototype.getColumnHeaderMetadataColumns=function(n){if(n&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,n.level)},C.prototype.getHierarchyMetadataColumns=function(n,s){if(n&&n.levels&&!(n.levels.length<s)){var g=n.levels[s];if(g&&g.sources&&0!==g.sources.length)return g.sources}},C.isNodeGrandTotal=function(n){if(n){for(var s=n;s.parent;)s=s.parent;return s.isSubtotal}return!1},C}()},32771:function(Le,me,D){D.d(me,{JF:function(){return K},az:function(){return F}});var k=D(81337),ue=D(90120),ee=D(34021),J=D(44783),ne=D(62458),z=D(38078);function F(U,S,C){if(ne.fF.assertValue(U,"getColumnDataBarsSettings: column"),S){var s,g,n=U.aggregates;if(null!=S.minValue?s=S.minValue:n&&null!=n.min&&_.isNumber(n.min)&&(s=n.min),null!=S.maxValue?g=S.maxValue:n&&null!=n.max&&_.isNumber(n.max)&&(g=n.max),!(null==s||null==g||s>g)){var L=null!=S.minValue,I=null!=S.maxValue;return s>=0&&g>0&&!L&&(s=0),s<0&&g<0&&!I&&(g=0),{min:s,max:g,range:g-s,zeroPosition:0===s&&0===g?.5:s>=0&&g>0&&L?0:s<0&&g<=0&&I?1:(0-s)/(g-s),positiveColor:(0,z.HZ)(ue.v.getFillColor(C,S.positiveColor,J.U)),negativeColor:(0,z.HZ)(ue.v.getFillColor(C,S.negativeColor,J.U)),axisColor:(0,z.HZ)(ue.v.getFillColor(C,S.axisColor,J.fA)),hideText:!!S.hideText,reverseDirection:!!S.reverseDirection,strokeSettings:(0,k.pi)((0,k.pi)({},(0,ee.kG)(C)),{width:1}),totalMatching:S.totalMatchingOption}}}}function K(U,S,C,n,s){var g,L=C.getExtraLeft()+"px",I=C.getExtraRight()+"px",m=C.getExtraTop()+"px",T=C.getExtraBottom()+"px",V={children:[],attributes:{},classNames:[],styleProperties:{position:"absolute",left:L,right:I,top:m,bottom:T}},N=[],f=function(U,S,C){if(null!=S&&_.isNumber(S)&&0!==S){var I,m,T,n=U.min,s=U.max,g=U.range,L=U.zeroPosition;if(S>=s){if(1===L)return;S=s}else if(S<=n){if(0===L)return;S=n}if(0===g?(I=m=L,T=U.positiveColor):S>0?(I=L,m=(S-n)/g,T=U.positiveColor):(I=(S-n)/g,m=L,T=U.negativeColor),U.reverseDirection){var V=I;I=1-m,m=1-V}var N=100*(m-I);C?.push((S>=0?"":"-")+Math.round(N)+"%");var f={left:100*I+"%",width:N+"%",background:T},l=U.strokeSettings;return l&&l.visible&&(f.outline="".concat(l.width,"px solid ").concat(l.color),f["outline-offset"]="-".concat(l.width,"px")),{content:"",attributes:{},classNames:["dataBar"],styleProperties:f}}}(S,n,N);f&&V.children.push(f);var h,l=S.zeroPosition;S.reverseDirection&&(l=1-l),V.children.push({content:"",attributes:{},classNames:["dataBarAxis"],styleProperties:{top:"-"+m,bottom:"-"+T,left:100*l+"%","border-left-color":S.axisColor}}),s&&(h={attributes:{},classNames:["visually-hidden"],styleProperties:{},content:s.getLocalizedString("Data_Bar_Percentage",null!==(g=N[0])&&void 0!==g?g:"0%")});var p=U.styleProperties;return p.position="absolute",p.left=L,p.right=I,p.top=m,p.bottom=T,h?{children:[V,U,h],classNames:[],attributes:{},styleProperties:{}}:{children:[V,U],classNames:[],attributes:{},styleProperties:{}}}},21242:function(Le,me,D){D.d(me,{Ak:function(){return s},IP:function(){return I},JW:function(){return K},MX:function(){return C},d4:function(){return J},kH:function(){return ne},mM:function(){return n},p_:function(){return L},re:function(){return A}});var k=D(81337),ue=D(13375);function ee(m,T,V,N){var f,l,u,h,p,R;void 0===V&&(V=!0);var b=m.columnItem,w=m.rowItem,B=0,a={displayNameParts:[],valueParts:[],concatenatedParts:[],headerParts:[],otherType:{}},e=w&&!_.isEmpty(w.values),t=w&&S(w,T,V,N);t&&((f=a.displayNameParts).push.apply(f,t.displayNameParts||[]),(l=a.valueParts).push.apply(l,t.valueParts||[]),(u=a.headerParts).push.apply(u,_.map(t.valueParts,function(){return!0})),a.concatenatedParts.push(_.map(t.displayNameParts,function(){return B++})));var i=b&&S(b,T,V,N);if(i&&((h=a.displayNameParts).push.apply(h,i.displayNameParts||[]),(p=a.valueParts).push.apply(p,i.valueParts||[]),(R=a.headerParts).push.apply(R,_.map(i.valueParts,function(){return!0})),a.concatenatedParts.push(_.map(i.displayNameParts,function(){return B++}))),e)if(a.displayNameParts.push(m.columnMetadata.displayName),a.concatenatedParts.push([B++]),a.headerParts.push(!1),m.isKpi){var o={metadata:m.columnMetadata.kpi,value:m.tooltipContent};(a.otherType[a.displayNameParts.length-1]={}).kpiValue=o,a.valueParts.push(m.tooltipContent)}else _.isEmpty(m.tooltipContent)||a.valueParts.push(m.tooltipContent);return a}function J(m,T,V){if(m)return V?[{displayName:"",value:m.tooltipContent}]:function(m){for(var T=[],V=function(h){var p=_.filter(m.displayNameParts,function(B,a){return-1!==h.indexOf(a)}),R=_.filter(m.valueParts,function(B,a){return-1!==h.indexOf(a)});if((p.length>0||R.length>0)&&(T.push({displayName:p.join(" "),value:R.join(" ")}),m.otherType)){var b=_.first(h);if(_.has(m.otherType,String(b))){var w=T.length-1;delete T[w].value,T[w]=(0,k.pi)((0,k.pi)({},T[w]),m.otherType[b])}}},N=0,f=m.concatenatedParts;N<f.length;N++)V(f[N]);return T}(ee(m,T))}function ne(m,T,V,N){for(var f=[],l=0,u=m;l<u.length;l++)f.push(ee(u[l],N));var p=0,R=T.getHierarchyLeafCount()*V.getHierarchyLeafCount();return 0!==R&&(p=Math.round(m.length/R*100)),(0,k.pi)({coveragePercentage:p},z(f))}function z(m){for(var T={headers:_.uniq(_.flatten(_.map(m,function(i){return i.displayNameParts}))),isHeader:{},values:[]},V=T.values,N=T.headers,f=T.isHeader,l={},u=0;u<N.length;u++)l[N[u]]=u;for(var h=0,p=m;h<p.length;h++){var R=p[h],b=_.fill(new Array(N.length),"");for(u=0;u<R.displayNameParts.length;u++){var a=l[R.displayNameParts[u]];b[a]=R.valueParts[u],R.headerParts&&(T.isHeader[a]=R.headerParts[u])}V.push(b)}if(!_.isEmpty(m)&&m[0].headerParts)for(var e=function(o){for(var d=V[o],H=[],M=o+1;M<V.length;M++)_.every(V[M],function(ce,pe){return f[pe]&&ce===d[pe]||!f[pe]&&(""===ce||""===d[pe])})&&H.push(M);if(H.length>0)for(var j=_.reduce(d,function(ce,pe,Me){return""===pe&&ce.push(Me),ce},[]),Q=0,W=H;Q<W.length;Q++){var Z=V[W[Q]];for(M=0;M<j.length;M++){var q=j[M],ie=Z[q];""!==ie&&(d[q]=ie,j.splice(M,1),M--)}}H.sort(function(ce,pe){return pe-ce});for(var ae=0,le=H;ae<le.length;ae++)V.splice(le[ae],1)},t=0;t<V.length;t++)e(t);return T}function K(m,T){if(m)return T?[{displayName:"",value:m.displayName}]:[{displayName:m.displayName}]}function A(m,T,V,N,f,l){if(m){if(l)return[{displayName:"",value:m.isSubtotal||ue.hc.isNodeGrandTotal(m)?N:m.tooltipValueFormatted}];if(ue.hc.isNodeGrandTotal(m))return V(m)?[{displayName:m.tooltipValueFormatted}]:[{displayName:N}];var h=[],p=function(m,T){var V=C(m,T),N=V.displayNameParts,f=V.valueParts;if(N.length>0||f.length>0)return{displayName:N.join(" "),value:f.join(" ")}}(m,f);return p&&h.push(p),T(m)&&h.push({displayName:f,value:m.valueFormatted}),h}}function S(m,T,V,N){void 0===V&&(V=!0);var f=g(m),l=m.queryName,u=_.find(f,function(h){return h.queryName===l});return u&&u.isMeasure&&(m=m.parent),C(m,T,V,N)}function C(m,T,V,N){void 0===V&&(V=!0);for(var f=[],l=[];m;)if(V&&m.isSubtotal)m=m.parent;else{var u=g(m);if(!_.isEmpty(u)){for(var h=[],p=0,R=u;p<R.length;p++){var b=R[p];h.push(b.isMeasure?T:b.displayName)}f.push(h.join(" ")),_.every(u,function(w){return w.isMeasure})?l.push(u[0].displayName):l.push(m.isSubtotal?N:m.tooltipValueFormatted)}m=m.parent}return{displayNameParts:f=f.reverse(),valueParts:l=l.reverse()}}function n(m,T,V,N,f){var l=s(V,N,m,T),u=0,h=V.getHierarchyLeafCount()*N.getHierarchyLeafCount();0!==h&&(u=Math.round(l.length/h*100));for(var p=[],R=0,b=l;R<b.length;R++)p.push(ee(b[R],f));return(0,k.pi)({coveragePercentage:u},z(p))}function s(m,T,V,N){_.isEmpty(V)&&(V=m.getHierarchyItems()),_.isEmpty(N)&&(N=T.getHierarchyItems());var f=[];m.getLeaves(V,f),f=_.filter(f,function(a){return!a.isSubtotal});var l=[];T.getLeaves(N,l),l=_.filter(l,function(a){return!a.isSubtotal});for(var u=[],h=0,p=f;h<p.length;h++)for(var R=p[h],b=0,w=l;b<w.length;b++)u.push(m.getIntersection(R,w[b]));return u.filter(function(a){return!a.isSubtotal&&!a.isGrandTotal})}function g(m){var T=m.hierarchyLevel&&m.hierarchyLevel.sources;return _.isEmpty(T)?[]:_.every(T,function(V){return V.isMeasure})?[T[m.levelSourceIndex||0]]:T}function L(m){return{displayNameParts:[m.displayName],valueParts:[null]}}function I(m,T){for(var V=[],N=0;N<m.displayNameParts.length;N++){var f=m.displayNameParts[N],l=m.valueParts[N];null!=l&&(f+=": "+l),V.push(f)}if(!_.isEmpty(T))for(var u=0,h=T;u<h.length;u++)V.push(h[u]);return V.join(". ")}},29043:function(Le,me,D){D.d(me,{MV:function(){return n},th:function(){return S},wJ:function(){return C}});var k=D(53197),ue=D(90120),ee=D(51995),J=D(85308),ne=D(58520),z=D(45296),F=D(44783),K=D(62458),A=D(43286),U=52;function S(m,T){var t,V={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(m)){var N;try{N=JSON.parse(m)}catch{return}var f=+N.yl,l=+N.yh,h=+N.xl,p=+N.xh,R=null!=N.md?+N.md:void 0;_.size(N.p)>U&&T.setWarnings([new z.El]);for(var b=0,w=N.p;b<w.length;b++){var B=w[b];V.points.push({x:null!=B[0]?+B[0]:void 0,y:null!=B[1]?(t=+B[1],t*(l-f)/100+f):void 0})}return{points:_.filter(V.points,function(e){return _.isFinite(e.x)&&(null!=e.y||_.isFinite(e.y))}),lowX:h,highX:p,lowY:f,highY:l,minXDifference:R}}}function C(m,T,V){var N;K.fF.assertValue(m,"sparkline"),K.fF.assertValue(null===(N=T?.misc)||void 0===N?void 0:N.sparkline,"invalid type for sparkline"),K.fF.assertValue(V,"style");var f=T.misc.sparkline.groupingType;return{chartType:m.chartType,dataColor:V.isHighContrast?ue.v.getThemeColor(V,F.fA):m.dataColor,strokeWidth:m.strokeWidth,marker:{show:!0,typeFlags:m.marker.typeFlags,color:V.isHighContrast?ue.v.getThemeColor(V,F.fA):m.marker.color,size:m.marker.size,shape:m.marker.shape},isScalar:f&&!!(f.numeric||f.dateTime||f.temporal)}}function n(m,T,V,N,f,l,u,h){var p;if(null!=N){var a=l-V.getExtraLeft()-V.getExtraRight()-(h?h+5:0),e=f-V.getExtraTop()-V.getExtraBottom();a-T.strokeWidth>1&&e-T.strokeWidth>1&&(p=T.chartType===J.U.line?function(m,T,V,N){var o,l=m.dataColor,u=m.strokeWidth,h=m.marker,p=h.color,R=h.size,b=h.shape,w=h.typeFlags,B=m.isScalar,a=(0,A.Js)(w),e=0===a||1===a&&(0,A.yE)(w,ne.qC),t=Math.max(u,2)+(e?0:Math.ceil(R/2)),i=N.points;o=B?d3.scaleLinear().domain([N.lowX,N.highX]).range([t,T-t]):d3.scalePoint().domain(_.map(_.range(N.lowX,N.highX+1),function(q){return q.toString()})).range([t,T-t]);var j,Q,d=d3.scaleLinear().domain(d3.extent(i,function(q){return q.y})).range([V-t,t]),H=d3.line().x(function(q){return o(q.x)}).y(function(q){return d(q.y)}),M=_.filter(i,function(q){return null!=q.y}),X={tagName:"path",attributes:{d:H(M)},classNames:[],styleProperties:{stroke:l,"stroke-width":u.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},W=function(m,T){var V=T.marker.typeFlags,N=d3.extent(m,function(u){return u.y}),f=N[0],l=N[1];return _.filter(m,function(u,h){var p,R;return null!=u.y&&(!!(0,A.yE)(V,ne.$6)||(0,A.yE)(V,ne.Ps)&&0===h||(0,A.yE)(V,ne.Z$)&&h===m.length-1||(0,A.yE)(V,ne.pd)&&u.y<0||(0,A.yE)(V,ne.Zc)&&u.y===l||(0,A.yE)(V,ne.O3)&&u.y===f||(0,A.yE)(V,ne.qC)&&null==(null===(p=m[h-1])||void 0===p?void 0:p.y)&&null==(null===(R=m[h+1])||void 0===R?void 0:R.y))})}(M,m);if(!_.isEmpty(W)){var Y="markerKey".concat(R).concat(p).concat(b);j={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:Y,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:R.toString(),markerWidth:R.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,ee.F)(b).toString(),"stroke-opacity":"1",stroke:p,fill:p},attributes:{d:(0,ee.Ar)(b)}}]}]},Q={tagName:"path",attributes:{d:H(W)},classNames:[],styleProperties:{stroke:l,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(Y,")"),"marker-mid":"url(#".concat(Y,")"),"marker-end":"url(#".concat(Y,")")}}}return{tagName:"svg",children:Q?[j,X,Q]:[X],classNames:[],styleProperties:{},attributes:{height:V+"px",width:T+"px"}}}(T,a,e,N):function(m,T,V,N){var b,f=m.dataColor,l=m.isScalar,u=N.points,h=[N.lowX,N.highX],p=function(m,T,V,N,f){if(_.isEmpty(m))return 0;var h,p=N[N.length-1]-N[0];return f&&N&&N.length>1?(0!==p?(K.fF.assert(function(){return null!=T},"minXDifference cannot be null for scalar plotted as columns"),h=V*(T/(p+T))):h=V,h=Math.max(h,2)):h=V/(p+1),.8*h}(u,N.minXDifference,T,h,l),R=p/2;b=l?d3.scaleLinear().domain(h).range([R,T-R]):d3.scalePoint().domain(_.map(_.range(N.lowX,N.highX+1),function(t){return t.toString()})).range([R,T-R]);var w=d3.extent(u,function(t){return t.y});w[0]=Math.min(0,w[0]),w[1]=Math.max(0,w[1]);var B=d3.scaleLinear().domain(w).range([V,0]),a=B(0),e=p.toString();return{tagName:"svg",children:_.chain(u).filter(function(t){return null!=t.y}).map(function(t){var i=(b(t.x)-R).toString(),o=(a+(0,k.sc)(B,Math.max(0,t.y),0)).toString(),d=Math.abs((0,k.sc)(B,0,t.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:f},attributes:{x:i,y:o,width:e,height:d}}}).value(),classNames:[],styleProperties:{},attributes:{height:V+"px",width:T+"px"}}}(T,a,e,N))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(u&&"Before"!==u.layout?[p,m]:[m,p],function(o){return!!o})}}},11184:function(Le,me,D){D.d(me,{Q:function(){return J},S:function(){return ne}});var k=D(81337),ue=D(55007),ee=D(62458),J=function(){function z(F){this.matrixNavigator=F}return z.prototype.setHierarchy=function(F){this.hierarchy=F,this.floatingLeaves=[],this.getLeaves(this.getFloatingHierarchyItems(),this.floatingLeaves)},z.prototype.hasHierarchy=function(){return!_.isEmpty(this.hierarchy.levels)},z.prototype.isMultiLevelHierarchy=function(){return this.hierarchy.levels.length>1},z.prototype.getHierarchyDepth=function(){return Math.max(this.hierarchy.levels.length,1)},z.prototype.getHierarchyLeafNodes=function(){return this.hierarchy.leafNodes},z.prototype.getHierarchyLeafCount=function(){return this.hierarchy.leafNodes.length},z.prototype.getHierarchyLeafAt=function(F){return this.hierarchy.leafNodes[F]},z.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingLeaves.length},z.prototype.getFloatingHierarchyLeafAt=function(F){return this.floatingLeaves[F]},z.prototype.isBlank=function(F){return F.isBlankRow},z.prototype.isBlankRow=function(F){return this.getHierarchyLeafAt(F).isBlankRow},z.prototype.numberOfBlankRowsBefore=function(F){var K=this.getHierarchyLeafAt(F),A=this.getAncestor(K);return Math.floor(A.index/2)},z.prototype.getHierarchyItems=function(){return this.hierarchy.root.children||[]},z.prototype.getFloatingHierarchyItems=function(){return null},z.prototype.getLeafIndex=function(F){return this.matrixNavigator.getLeafIndex(F)},z.prototype.isLeaf=function(F){return this.matrixNavigator.isLeaf(F)},z.prototype.isLastItem=function(F,K){return this.matrixNavigator.isLastItem(F,K)},z.prototype.getAncestor=function(F){for(;F.parent;)F=F.parent;return F},z.prototype.getParent=function(F){return this.matrixNavigator.getParent(F)},z.prototype.getIndex=function(F){return this.matrixNavigator.getIndex(F)},z.prototype.getNodeLeafCount=function(F){var K=this;return this.isLeaf(F)?1:_.sum(_.map(F.children,function(A){return K.getNodeLeafCount(A)}))},z.prototype.getIndexOfFirstLeaf=function(F){for(;!_.isEmpty(F.children);)F=F.children[0];return this.getLeafIndex(F)},z.prototype.getPathIndices=function(F){for(var K=[this.getIndex(F)],A=this.getParent(F);A;)K=(0,k.ev)([this.getIndex(A)],K||[],!0),A=this.getParent(A);return K},z.prototype.getNodeFromPath=function(F){var K=this.hierarchy.levels.length||1;if(!(_.isEmpty(F)||F.length>K)){for(var A=this.hierarchy.root,U=0,S=F;U<S.length;U++)if(!(A=A.children[S[U]]))return;return A}},z.prototype.getLeafAncestorAtLevel=function(F,K,A){if(ee.fF.assertValue(F,"Undefined leaf node"),ee.fF.assert(function(){return K>=0},"Invalid target level"),!(K>this.getLevel(F))){for(var U=F;this.getLevel(U)>K;){if(U=this.getParent(U),A&&this.getLevel(U)<K)return;ee.fF.assertValue(U,"reached root without finding a matching ancestor")}return U}},z.prototype.getItemsByLevel=function(F){var K=[];return this.findLevelItems(F,this.hierarchy.root,-1,K),K},z.prototype.findLevelItems=function(F,K,A,U){if(!_.isEmpty(K.children))for(var S=A+1,C=0,n=K.children;C<n.length;C++){var s=n[C];S===F||S+this.matrixNavigator.getChildrenLevelDifference(s)>F?U.push(s):S<F&&this.findLevelItems(F,s,S,U)}},z.prototype.getExpansionState=function(F){return F.isCollapsed?1:!1===F.isCollapsed?0:2},z.prototype.getChildren=function(F){return this.matrixNavigator.getChildren(F)},z.prototype.getLevel=function(F){return this.matrixNavigator.getLevel(F)},z.prototype.getIntersection=function(F,K){var A=this.matrixNavigator.getIntersection(F,K);return A&&A.objects&&(A.icon=ue.FX.PropValuesIcon.getValue(A.objects),A.hyperlink=ue.FX.PropValuesWebURL.getValue(A.objects),A.altText=ue.FX.PropAltTextValue.getValue(A.objects)),A},z.prototype.getCorner=function(F,K){return this.matrixNavigator.getCorner(F,K)},z.prototype.getRowLevel=function(F){return F.rowLevel},z.prototype.getColumnLevel=function(F){return F.columnLevel},z.prototype.getRowHeaderMetadataColumn=function(F){return this.matrixNavigator.getRowHeaderMetadataColumn(F)},z.prototype.getRowHeaderMetadataColumns=function(F){return this.matrixNavigator.getRowHeaderMetadataColumns(F)},z.prototype.getColumnHeaderMetadataColumn=function(F){return this.matrixNavigator.getColumnHeaderMetadataColumn(F)},z.prototype.getColumnHeaderMetadataColumns=function(F){return this.matrixNavigator.getColumnHeaderMetadataColumns(F)},z.prototype.valuesOnRowApplied=function(){return this.matrixNavigator.valuesOnRowApplied()},z.prototype.hasMultipleValueSources=function(){return this.matrixNavigator.hasMultipleValueSources()},z.prototype.isColumnHeaderMultiValueSubtotal=function(F){return F.isSubtotal&&F.parent&&F.parent.isSubtotal},z.prototype.isRowHeaderMultiValueSubtotal=function(F){return this.valuesOnRowApplied()&&F.parent&&F.parent.isSubtotal},z.prototype.getLeaves=function(F,K){if(!_.isEmpty(F))for(var A=0,U=F;A<U.length;A++){var S=U[A];this.isLeaf(S)?K.push(S):this.getLeaves(this.getChildren(S),K)}},z.prototype.getColumnIndexFromQueryName=function(F){return null},z}(),ne=function(z){function F(){return null!==z&&z.apply(this,arguments)||this}return(0,k.ZT)(F,z),F.prototype.getIntersection=function(K,A){return this.isLeaf(K)||_.isEmpty(K.children)||!K.children[0].isSubtotal||this.valuesOnRowApplied()?z.prototype.getIntersection.call(this,K,A):z.prototype.getIntersection.call(this,K.children[0],A)},F.prototype.getChildren=function(K){return ee.fF.assertValue(K,"item"),!_.isEmpty(K.children)&&K.children[0].isSubtotal?K.children.slice(1):K.children},F.prototype.getHierarchyDepth=function(){return z.prototype.getHierarchyDepth.call(this)>0?1:0},F.prototype.getCorner=function(K,A){var U=A===this.matrixNavigator.getColumnHierarchyDepth()-1?0:this.matrixNavigator.getRowHierarchyDepth()-1;return z.prototype.getCorner.call(this,U,A)},F.prototype.getFloatingHierarchyItems=function(){var K=this.getHierarchyItems();if(_.isEmpty(K))return null;for(var A=0,U=[];;){var S=K[A];if(!S||!S.isSubtotal)break;U.push(S),A++}return _.isEmpty(U)?null:U},F.prototype.isRowHeaderMultiValueSubtotal=function(K){return this.valuesOnRowApplied()&&K.isSubtotal},F.prototype.getLeaves=function(K,A){if(!_.isEmpty(K))for(var U=0,S=K;U<S.length;U++){var C=S[U];A.push(C),this.getLeaves(this.getChildren(C),A)}},F.prototype.getPathIndices=function(K){return[this.getLeafIndex(K)]},F.prototype.getNodeFromPath=function(K){if(1===K.length)return this.getHierarchyLeafAt(K[0])},F.prototype.getItemsByLevel=function(K){return ee.fF.assert(function(){return 0===K},"Stepped PivotTable rows hierarchy has 1 level"),(0,k.ev)([],this.getHierarchyLeafNodes()||[],!0)},F.prototype.getLeafAncestorAtLevel=function(K,A){return ee.fF.assert(function(){return 0===A},"Stepped PivotTable rows hierarchy has 1 level"),ee.fF.assertValue(K,"Undefined leaf node"),K},F}(J)},76797:function(Le,me,D){D.d(me,{D:function(){return A},l:function(){return S}});var k=D(81337),ue=D(85196),ee=D(66232),J=D(62458),ne=D(78843),z=D(93340),F=D(71090),K=D(21242),A=function(C){return C[C.RowHeader=0]="RowHeader",C[C.ColumnHeader=1]="ColumnHeader",C[C.BodyCell=2]="BodyCell",C}({});function U(C){return 0===C.type}var S=function(){function C(n,s){this.hostServices=n,this.featureSwitches=s,this.clearLocal()}return C.prototype.onItemContextMenu=function(n,s,g,L,I){var m;(0,ee.n)(g),!this.isEmpty()&&this.isItemSelected(n,!0)?(m=this.selectedItems,s=this.selectionMode):m=[n];var T=this.createContextMenuArgs(n,s,m,g,L,I);T&&this.hostServices.onContextMenu(T)},C.prototype.onWhitespaceClick=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems))},C.prototype.isDrillingEnabled=function(n,s,g){var L=this.createSelectingArgs(n,g,s);return this.hostServices.onSelecting(L),1===L.action},C.prototype.select=function(n,s,g){this.updateSelection(n,s,g,!1),this.hostServices.alertScreenReader(this.getSelectionScreenReaderMessage(n)),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,g))},C.prototype.getSelectionScreenReaderMessage=function(n){var s,g,L;switch(this.indicatorStyle){case A.RowHeader:g=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n));var I=1===this.rowHierarchyNavigator.getExpansionState(n);s=_.isEmpty(this.selectedItems)?!g||n.isSubtotal||I?"Row_Group_Unselected":"Row_Unselected":!g||n.isSubtotal||I?"Row_Group_Selected":"Row_Selected";break;case A.ColumnHeader:L=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n)),s=_.isEmpty(this.selectedItems)?L&&!n.isSubtotal?"Column_Unselected":"Column_Group_Unselected":L&&!n.isSubtotal?"Column_Selected":"Column_Group_Selected";break;case A.BodyCell:g=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n.rowItem)),L=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(n.columnItem)),s=_.isEmpty(this.selectedItems)?g&&L&&!n.isSubtotal?"Intersection_Unselected":"Intersection_Group_Unselected":g&&L&&!n.isSubtotal?"Intersection_Selected":"Intersection_Group_Selected";break;default:s="Tablix_Selections_Cleared"}return this.hostServices.getLocalizedString(s)},C.prototype.getIndicatorStyle=function(){return this.indicatorStyle},C.prototype.updateSelection=function(n,s,g,L){if(this.featureSwitches.a11yMatrix&&"isRowAndColumnGrandTotal"in n&&(n.isRowAndColumnGrandTotal||n.isBlankRow))return this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0,!0;if(!L&&s!==this.selectionMode&&this.clearLocal(),this.createSelectorsByColumn(n))if(this.isItemSelected(n,L)){if(L)return!1;1===this.selectedItems.length&&1!==g?this.clearLocal():3===g?this.unselectItem(n):0===g&&(this.selectedItems=[n])}else(0===g||s!==this.selectionMode)&&this.clearLocal(),this.selectionMode=s,this.indicatorStyle=s,this.selectedItems.push(n),this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))||(this.selectedItems=[n]);else this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0;return n.isRowGrandTotal?this.indicatorStyle=A.ColumnHeader:n.isColumnGrandTotal&&(this.indicatorStyle=A.RowHeader),!0},C.prototype.isRowHeaderHighlighted=function(n){if(this.isEmpty())return!0;for(var s=0,g=this.selectedItems;s<g.length;s++)if(this.isRowHeaderOnSelectedPath(g[s],n))return!0;return!1},C.prototype.isColumnHeaderHighlighted=function(n){if(this.isEmpty())return!0;for(var s=0,g=this.selectedItems;s<g.length;s++)if(this.isColumnHeaderOnSelectedPath(g[s],n))return!0;return!1},C.prototype.isRowHeaderIndicatorOn=function(n,s){var g=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(m){return g.isRowHeaderOnSelectedPath(m,n,!0,!s)})&&!(this.indicatorStyle===A.ColumnHeader)},C.prototype.isRowHeaderDarkened=function(n){var s=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(I){return s.isRowHeaderOnSelectedPath(I,n,!0,!1)})&&this.indicatorStyle===A.RowHeader},C.prototype.isColumnHeaderIndicatorOn=function(n){var s=this;if(!this.featureSwitches.a11yMatrix)return!1;var g=this.columnHierarchyNavigator.isLeaf(n),L=_.some(this.selectedItems,function(m){return s.isColumnHeaderOnSelectedPath(m,n)});return g&&L&&!(this.indicatorStyle===A.RowHeader)},C.prototype.isColumnHeaderDarkened=function(n){var s=this;return _.some(this.selectedItems,function(I){return s.isColumnHeaderOnSelectedPath(I,n)})&&!(this.indicatorStyle===A.RowHeader)},C.prototype.isBodyCellHighlighted=function(n){if(this.isEmpty())return!0;for(var s=0,g=this.selectedItems;s<g.length;s++)if(this.isBodyCellOnSelectedPath(g[s],n))return!0;return!1},C.prototype.isBodyCellIndicatorOn=function(n){if(this.isEmpty())return!1;for(var s=0,g=this.selectedItems;s<g.length;s++)if(this.isBodyCellOnSelectedPath(g[s],n)&&this.indicatorStyle===A.BodyCell)return!0;return!1},C.prototype.isRowHeaderOnSelectedPath=function(n,s,g,L){return this.indicatorStyle===A.ColumnHeader||(I=U(n)?n.rowItem:n,this.isOnSelectedPath(this.getEffectiveSelectedHeader(I),s,g,L));var I},C.prototype.isColumnHeaderOnSelectedPath=function(n,s){return this.indicatorStyle===A.RowHeader||(g=U(n)?n.columnItem:n,this.isOnSelectedPath(this.getEffectiveSelectedHeader(g),s));var g},C.prototype.isBodyCellOnSelectedPath=function(n,s){return this.isRowHeaderOnSelectedPath(n,s.rowItem)&&this.isColumnHeaderOnSelectedPath(n,s.columnItem)},C.prototype.isOnSelectedPath=function(n,s,g,L){if(!n||n===s)return!0;var I=n;if(!g)for(;I;){if(I===s)return!0;I=I.parent}if(I=s,!L)for(;I;){if(I===n)return!0;I=I.parent}return!1},C.prototype.onDataViewChanged=function(n,s){this.rowHierarchyNavigator=n,this.columnHierarchyNavigator=s;var g=n&&n.getHierarchyItems(),L=s&&s.getHierarchyItems();if(!this.isEmpty()){for(var I=[],m=0,T=this.selectedItems;m<T.length;m++){var V=T[m],N=C.getMatchingItem(V,this.selectionMode,g,L,n);I.push(N||V)}this.selectedItems=I}},C.getMatchingItem=function(n,s,g,L,I){if(n.isBlankRow)return null;switch(s){case A.RowHeader:return this.getMatchingHeader(n,g);case A.ColumnHeader:return this.getMatchingHeader(n,L);case A.BodyCell:var m=n,T=this.getMatchingHeader(m.rowItem,g),V=this.getMatchingHeader(m.columnItem,L);return T&&V?I.getIntersection(T,V):null}},C.getMatchingHeader=function(n,s){if(s)for(var g=0,L=s;g<L.length;g++){var I=L[g];if(this.areHeadersEqual(n,I))return I;var m=this.getMatchingHeader(n,I.children);if(m)return m}return null},C.areHeadersEqual=function(n,s){if(J.fF.assert(function(){return!!n&&!!s},"items cannot be null"),(0,ne.fS)(n.identity,s.identity)&&n.queryName===s.queryName){if(!n.parent&&!s.parent)return!0;if(n.parent&&s.parent)return this.areHeadersEqual(n.parent,s.parent)}return!1},C.getMatchingItemById=function(n,s,g,L,I){var m=_.keys(n.dataMap),T=_.chain(I.getColumnHierarchy().levels).filter(function(l){return!l.sources[0].isMeasure}).map(function(l){return l.sources[0].queryName}).filter(function(l){return _.includes(m,l)}).value(),V=_.chain(I.getRowHierarchy().levels).map(function(l){return l.sources[0].queryName}).filter(function(l){return _.includes(m,l)}).value();switch(s){case A.RowHeader:return this.getMatchingHeaderById(n,V,g);case A.ColumnHeader:return this.getMatchingHeaderById(n,T,L);case A.BodyCell:var N=this.getMatchingHeaderById(n,V,g),f=this.getMatchingHeaderById(n,T,L);return N&&f?I.getIntersection(N,f):null}},C.getMatchingHeaderById=function(n,s,g){if(g)for(var L=0,I=g;L<I.length;L++)for(var m=I[L],T=function(h,p){var R=s[h];if(V.headerMatchesId(n,R,m)){if(1===p)return{value:m};J.fF.assertAnyValue(m.children,"PivotTableSelectionManager.getMatchingHeaderById encountered an ID that does not match the matrix, which should be caught earlier.");var b=V.getMatchingHeaderById(n,_.filter(s,function(w){return w!==R}),m.children);if(b)return{value:b}}},V=this,N=0,f=s.length;N<f;N++){var l=T(N,f);if("object"==typeof l)return l.value}return null},C.headerMatchesId=function(n,s,g){return J.fF.assert(function(){return!!n&&!!g},"items cannot be null"),!!(s===g.queryName&&n.dataMap&&n.dataMap[s]&&(0,ne.fS)(_.head(n.dataMap[s]),g.identity))},C.areCornerItemsEqual=function(n,s){return!(!n.metadata||!s.metadata)&&n.metadata.queryName===s.metadata.queryName},C.prototype.clearLocal=function(){this.selectedItems=[]},C.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},C.prototype.restoreSelectionState=function(n,s){if(this.clearLocal(),_.isEmpty(n))return!0;for(var g=!1,L=this.selectedItems,I=0,m=n;I<m.length;I++){var T=m[I],V=this.determineSelectionModeFromIds(T,s);if(null!=V){this.selectionMode=V,this.indicatorStyle=V;var N=C.getMatchingItemById(T,V,s.getRowHierarchy().root.children,s.getColumnHierarchy().root.children,s);N&&(L.push(N),g=!0,N.isRowGrandTotal?this.indicatorStyle=A.ColumnHeader:N.isColumnGrandTotal&&(this.indicatorStyle=A.RowHeader))}}return g},C.prototype.determineSelectionModeFromIds=function(n,s){if(!n)return this.selectionMode;var g=_.map(s.getColumnHierarchy().levels,function(V){return V.sources[0].queryName}),L=!1,I=_.map(s.getRowHierarchy().levels,function(V){return V.sources[0].queryName}),m=!1;for(var T in n.dataMap)if(_.includes(g,T))L=!0;else{if(!_.includes(I,T))return;m=!0}return L&&m?A.BodyCell:L?A.ColumnHeader:m?A.RowHeader:void 0},C.prototype.isEmpty=function(){return _.isEmpty(this.selectedItems)},C.prototype.isItemSelected=function(n,s){void 0===s&&(s=!1);for(var g=U(n)?n:void 0,L=0,I=this.selectedItems;L<I.length;L++){var m=I[L];if(U(m)&&g){if(this.areBodyCellsEqual(m,g))return!0}else if(m===n)return!0}return!(!s||this.isEmpty()||!g)&&this.isBodyCellHighlighted(g)},C.prototype.unselectItem=function(n){var s=this;U(n)?_.remove(this.selectedItems,function(g){return s.areBodyCellsEqual(g,n)}):_.pull(this.selectedItems,n)},C.prototype.areBodyCellsEqual=function(n,s){return n.rowItem===s.rowItem&&n.columnItem===s.columnItem},C.prototype.getEffectiveSelectedHeader=function(n){return n&&!n.identity&&n.parent?this.getEffectiveSelectedHeader(n.parent):n},C.prototype.getEffectiveSelectedNodes=function(n){return n.parent?[this.getEffectiveSelectedHeader(n)]:n.identity?[n]:n.siblings},C.getRoleNames=function(n){switch(n){case A.ColumnHeader:return[ue.r.columns];case A.RowHeader:return[ue.r.rows];case A.BodyCell:return[ue.r.values];default:J.fF.assertFail("unexpected PivotTableSelectionMode")}},C.prototype.createSelectingArgs=function(n,s,g){return{type:0,visualObjects:this.getVisualObjects([n]),position:C.getMouseEventPosition(g),dataRoles:C.getRoleNames(s)}},C.prototype.createSelectArgs=function(n,s){for(var g=[],L=0,I=n;L<I.length;L++){var T=this.createSelectorsByColumn(I[L]);T&&g.push({objectName:"",selectorsByColumn:T})}return{type:0,visualObjects:this.getVisualObjects(n),selectionMode:s}},C.prototype.getVisualObjects=function(n){for(var s=[],g=0,L=n;g<L.length;g++){var m=this.createSelectorsByColumn(L[g]);m&&s.push({objectName:"",selectorsByColumn:m})}return s},C.prototype.createContextMenuArgs=function(n,s,g,L,I,m){for(var V,N,f,l,u,h,T=this,p=[],R=0,b=g;R<b.length;R++){var B=this.createSelectorsByColumn(b[R]);B&&p.push(B)}var t,a={dataRoles:I,data:p,position:C.getMouseEventPosition(L)};if(U(n)||(a.nodeIndex=this.getHierarchyNodeIndex(n)),(_.isEmpty(p)||p.every(function(d){return _.isEmpty(d.dataMap)}))&&U(n)&&n.isRowAndColumnGrandTotal){var e=null===(f=null===(N=null===(V=n.columnMetadata)||void 0===V?void 0:V.type)||void 0===N?void 0:N.misc)||void 0===f?void 0:f.sparkline;return a.copyArgs={singleValue:function(){return e?n.textContent:String(n.dataPoint)}},a}if(U(n))if(null===(h=null===(u=null===(l=n.columnMetadata)||void 0===l?void 0:l.type)||void 0===u?void 0:u.misc)||void 0===h?void 0:h.sparkline)t=n.textContent;else{var o=n.dataPoint;null!=o&&(t=(0,z.pW)(o))}else t=n.tooltipValueFormatted;return a.copyArgs={grid:function(){return T.generateGridCopyCallback(g,s)}},void 0!==t&&(a.copyArgs.singleValue=function(){return String(t)}),this.featureSwitches.a11yShowAsMatrix&&(a.visualCommandConfigs=[{titleKey:"UnfreezeRowHeaders",executeFn:function(){return(0,k.mG)(T,void 0,void 0,function(){return(0,k.Jh)(this,function(H){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!0},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,k.mG)(T,void 0,void 0,function(){return(0,k.Jh)(this,function(H){return[2,!m]})})}},{titleKey:"FreezeRowHeaders",executeFn:function(){return(0,k.mG)(T,void 0,void 0,function(){return(0,k.Jh)(this,function(H){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!1},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,k.mG)(T,void 0,void 0,function(){return(0,k.Jh)(this,function(H){return[2,m]})})}}]),a},C.prototype.generateGridCopyCallback=function(n,s){var I,g=n.slice(),L=[];switch(s){case A.BodyCell:g=this.collectSelectedBodyNodes(g),I=(0,K.kH)(g,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(F.yF)),L.push.apply(L,(0,k.ev)([I.headers],I.values||[],!1));break;case A.ColumnHeader:for(var m=[],T=0,V=g;T<V.length;T++){var N=V[T];this.columnHierarchyNavigator.isLeaf(N)&&this.columnHierarchyNavigator.getColumnHeaderMetadataColumn(N).isMeasure?m.push.apply(m,N.siblings||[]):m.push(N)}I=(0,K.mM)([],g=m,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(F.yF)),L.push.apply(L,(0,k.ev)([I.headers],I.values||[],!1));break;case A.RowHeader:I=(0,K.mM)(g,[],this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(F.yF)),L.push.apply(L,(0,k.ev)([I.headers],I.values||[],!1));break;default:J.fF.assertNever(s)}return{grid:L,coveragePercentage:I?I.coveragePercentage:void 0}},C.prototype.getHierarchyNodeIndex=function(n){for(var s=[];n&&null!=n.index;)s.splice(0,0,n.index),n=n.parent;return s},C.prototype.collectSelectedBodyNodes=function(n){for(var s=[],g=0,L=n;g<L.length;g++){var I=L[g];if(!I.isSubtotal&&I.columnItem.identity&&I.rowItem.identity)s.push(I);else{var m=[],T=[];I.isRowGrandTotal||(m=this.getEffectiveSelectedNodes(I.rowItem)),I.isColumnGrandTotal||(T=this.getEffectiveSelectedNodes(I.columnItem));var V=(0,K.Ak)(this.rowHierarchyNavigator,this.columnHierarchyNavigator,m,T);s.push.apply(s,V||[])}}for(var N=0;N<s.length;N++)for(var f=s[N],l=N+1;l<s.length;l++)_.isEqual(f,s[l])&&(s.splice(l,1),l--);return s},C.prototype.createSelectorsByColumn=function(n){return U(n)?this.createSelectorsByColumnForBodyCell(n):this.createSelectorsByColumnForHeader(n)},C.prototype.createSelectorsByColumnForHeader=function(n){var s=n.queryName,g={};return C.addHeaderIdentities(n,g)?{dataMap:g,metadata:[s]}:void 0},C.prototype.createSelectorsByColumnForBodyCell=function(n){var s,g={},L=C.addHeaderIdentities(n.rowItem,g),I=C.addHeaderIdentities(n.columnItem,g),m=null===(s=n.columnMetadata)||void 0===s?void 0:s.queryName;return J.fF.assert(function(){return L||I||!!m},"Must have a row or column identity or column metadata"),{dataMap:g,metadata:m?[m]:void 0}},C.addHeaderIdentities=function(n,s){for(var g=[];n;)n.identity&&g.splice(0,0,n),n=n.parent;for(var L=0,I=g;L<I.length;L++){var m=I[L];s[m.queryName]=[m.identity]}return g.length>0},C.hasIdentity=function(n){return C.addHeaderIdentities(n,{})},C.getMouseEventPosition=function(n){return{x:n.clientX,y:n.clientY}},C}()},59784:function(Le,me,D){D.d(me,{S:function(){return ue}});var k=D(76797),ue=function(){function ee(J){this.hostServices=J}return ee.prototype.onDataViewChanged=function(J,ne,z,F,K){this.isSteppedLayout=F,this.valuesOnRowApplied=K,this.nonMeasureRowLevels=this.getNonMeasureRowLevels(J),this.valueSources=z,this.hasRows=J&&!_.isEmpty(this.nonMeasureRowLevels),this.hasColumns=ne&&!_.isEmpty(ne.levels),this.measureCount=z?z.length:0},ee.hasSortingChanged=function(J,ne){if(!J||!ne)return!1;var z=J.metadata.columns;if(_.isEmpty(z))return!1;var F=ne.metadata.columns;if(_.isEmpty(F))return!1;for(var K=function(s){var g=_.find(z,function(L){return s.queryName===L.queryName});if(g&&s.sort!==g.sort)return{value:!0}},A=0,U=F;A<U.length;A++){var C=K(U[A]);if("object"==typeof C)return C.value}return!1},ee.prototype.isCornerSortable=function(J){return this.hasRows&&null!=J.metadata&&J.position.row.isLast&&(!this.valuesOnRowApplied||!J.position.column.isLast)},ee.prototype.getNonMeasureRowLevels=function(J){if(this.valuesOnRowApplied){var ne=[];return ne.push.apply(ne,J.levels||[]),ne.pop(),ne}return J.levels},ee.prototype.isColumnHeaderSortable=function(J){var ne=k.l.hasIdentity(J);return this.hasRows&&this.measureCount>0&&!ne&&J.position.row.isLast&&!this.valuesOnRowApplied},ee.prototype.getCornerSortDirection=function(J){if(!this.isCornerSortable(J))return null;if(this.isSteppedLayout){for(var ne=null,z=0,F=this.nonMeasureRowLevels;z<F.length;z++){var K=F[z];if(1!==K.sources.length)return null;var A=K.sources[0].sort;if(null==A)return null;if(null!==ne){if(A!==ne)return null}else ne=A}return ne}return this.nonMeasureRowLevels[J.position.column.index].sources[0].sort},ee.prototype.getColumnHeaderSortDirection=function(J){return this.isColumnHeaderSortable(J)?this.getMeasureSortDirection(this.getMeasureQueryName(J)):null},ee.prototype.getMeasureQueryName=function(J){return this.hasColumns&&1===this.measureCount?this.valueSources[0].queryName:J.queryName},ee.prototype.sortCorner=function(J){var F,ne=this.getCornerSortDirection(J),z=ee.getNextSortDirection(ne);if(this.isSteppedLayout){F=[];for(var K=0,A=this.nonMeasureRowLevels;K<A.length;K++)F.push({queryName:A[K].sources[0].queryName,sortDirection:z})}else F=[{queryName:J.metadata.queryName,sortDirection:z}];this.hostServices.onCustomSort({sortDescriptors:F,suppressAnnouncements:!0})},ee.prototype.sortColumnHeader=function(J){var ne=this.getColumnHeaderSortDirection(J),z=this.getMeasureColumn(this.getMeasureQueryName(J));this.hostServices.onCustomSort({sortDescriptors:[{queryName:this.getMeasureQueryName(J),sortDirection:ee.getNextSortDirection(ne,z)}],suppressAnnouncements:!0})},ee.getNextSortDirection=function(J,ne){return void 0===J?ee.getDefaultSortDirection(ne):1===J?2:1},ee.getDefaultSortDirection=function(J){return J&&J.isMeasure&&J.type&&J.type.numeric&&!J.type.temporal?2:1},ee.prototype.getMeasureSortDirection=function(J){var ne=this.getMeasureColumn(J);if(null!=ne)return ne.sort},ee.prototype.getMeasureColumn=function(J){return _.find(this.valueSources,function(ne){return ne.queryName===J})},ee}()},97654:function(Le,me,D){D.r(me),D.d(me,{TableEx:function(){return fe}});var k=D(81337),ue=D(3665),ee=D(51650),J=D(57622),ne=D(28579),z=D(80065),F=D(52287),K=D(86900),A=D(35249),U=D(55007),S=D(40739),C=D(40550),n=D(62458),s=D(57419),g=D(59107),L=D(46135),I=D(32379),m=D(72489),T=D(79465),V=D(24133),N=D(93340),f=D(71090),l=D(73889),u=D(74304),h=D(60014),p=D(54522),R=D(44977),b=D(32105),w=D(19650),B=D(64067),a=D(79154),e=D(39681),t=D(48066),i=D(38078),o=D(58702),d=D(7911),H=D(87914),M=D(59784),x=D(91468),X=D(32771),j=D(29043),Q=D(44245),W=function(){function y(r,c){this.isA11yTable=c,this.hostServices=r}return y.prototype.sort=function(r,c,v){void 0===v&&(v=!1);var re,P=y.getSortDirection(r),E=M.S.getNextSortDirection(P,r.metadata),O=r.metadata.queryName,G={queryName:O,sortDirection:E};v?(re=_.chain(c).filter(function(te){return void 0!==te.sortOrder&&te.queryName!==O}).sortBy(function(te){return te.sortOrder}).map(function(te){return{queryName:te.queryName,sortDirection:te.sort}}).value()).push(G):re=[G],this.hostServices.onCustomSort({sortDescriptors:re,suppressAnnouncements:this.isA11yTable})},y.hasSortingChanged=function(r,c){if(!r||!c)return!1;var v=r.metadata.columns;if(_.isEmpty(v))return!1;var P=c.metadata.columns;if(_.isEmpty(P))return!1;for(var E=function(oe){var he=_.find(v,function(ge){return oe.queryName===ge.queryName});if(he&&oe.sort!==he.sort)return{value:!0}},O=0,G=P;O<G.length;O++){var te=E(G[O]);if("object"==typeof te)return te.value}return!1},y.getSortDirection=function(r){return r.metadata.sort},y}(),Y=function(){function y(r,c,v,P,E){this.a11yMatrixFS=E,this.options=r,this.selectionManager=c,this.measureElement=(0,x.qk)(v),this.legacyTooltipsEnabled=!0,this.hostServices=P}return y.prototype.setFormatMode=function(r){this.formatMode=r},y.prototype.getRowLabelAndRole=function(r){var c=this.hostServices.getLocalizedString(f.Mh),v="gridcell";return null!=r?.dataPoint&&(c=this.hostServices.getLocalizedString("Visual_Tablix_ReferenceRowWithText",r.dataPoint.toString()),v="rowheader"),{rowLabel:(0,i.HZ)(c),rowRole:v}},y.prototype.getRowHeaderBinding=function(r,c,v,P,E){this.options.onBindRowHeader&&!c&&this.options.onBindRowHeader(r);var O=this.getRowLabelAndRole(E),G=O.rowLabel,te={attributes:{role:O.rowRole},classNames:[],styleProperties:{},children:[]};return P||(te.children=[{tagName:"label",attributes:{},classNames:["visually-hidden"],styleProperties:{},children:[{tagName:"input",attributes:{type:"checkbox","checkbox-rowindex":r.index.toString()},classNames:[],styleProperties:{}},{tagName:null,content:G,attributes:{},classNames:[],styleProperties:{}}]}],this.selectionManager.isItemSelected(r)&&(te.children[0].children[0].attributes.checked="")),te},y.prototype.getColumnHeaderBinding=function(r,c,v,P,E,O){var G,re=this.formattingProperties.columnHeaders,te=this.formattingProperties.columnFormatting[r.metadata.queryName],se=(0,i.HZ)(this.getColumnHeaderLabel(r)),oe={},he=W.getSortDirection(r);v&&(oe.role="columnheader",oe["aria-colindex"]=(0,N.jT)(r.position.column.index).toString(),1===he?oe["aria-sort"]="ascending":2===he&&(oe["aria-sort"]="descending")),_.isEmpty(se)&&(se=f.jv),re.wordWrap&&(se=(0,x.rP)(se));var ge=!_.isEmpty(se.trim()),ye=this.getColumnHeaderStyle(r,c,ge),we=ye.getExtraBottom();ye.paddings.bottom+=(0,x.tO)(this.glyphFontInfo.measuredFontHeight);var He=(0,x.Km)(he,this.options.sortIconEnabled,this.options.sortingEnabled,M.S.getDefaultSortDirection(r.metadata),we,this.glyphFontInfo.textProperties.fontSize,this.hostServices);se+=d.bG.build(He,{});var Ce=(0,e.ED)(this.columnHeaderClasses);return P&&(Ce.push(F.cy),oe[F.Ez]="".concat("columnHeaders"),oe[F.QZ]="".concat(1),oe[F.CK]="Visual_Tablix_ColumnHeaders"),(0,x.aY)(te&&te.styleHeader&&te.alignment||re.alignment,Ce),!(null===(G=this.isHeaderAutoWidth)||void 0===G)&&G.call(this,r)&&(ye.maxWidth=this.getMeasureElementMaxWidth(c)),{content:se,classNames:Ce,styleProperties:ye.getAttributes(v,void 0,this.a11yMatrixFS,O),attributes:oe}},y.prototype.getRowReferenceQueryName=function(){return this.formattingProperties.rowWithReferenceText.rowWithReferenceText},y.prototype.blankRowsEnabled=function(){return!1},y.prototype.getRowBinding=function(r,c,v,P){this.options.onBindRowHeader&&this.options.onBindRowHeader(r);var E=this.getRowLabelAndRole(v),re={classNames:[],attributes:{},styleProperties:{},children:[this.getCheckboxCellBinding(r,c,E.rowLabel,P,E.rowRole)]};return this.selectionManager.isRowHighlighted(r)?this.selectionManager.isItemSelected(r)&&re.classNames.push("row-selected"):re.classNames.push("row-unselected"),this.formatMode&&re.classNames.push("format-mode"),re},y.prototype.getCheckboxCellBinding=function(r,c,v,P,E){var O={attributes:{role:E,"aria-colindex":"1",tabindex:"0","selection-cell":""},classNames:["cell-interactive"],styleProperties:{position:"absolute","box-sizing":"border-box",width:"100%",height:"100%","--outline-top":P.weightTop+1+"px","--outline-right":P.weightRight+1+"px","--outline-bottom":P.weightBottom+1+"px","--outline-left":P.weightLeft+1+"px"}};return c||(O.children=[{tagName:"label",attributes:{},classNames:["visually-hidden"],styleProperties:{},children:[{tagName:"input",attributes:{type:"checkbox","checkbox-rowindex":r.index.toString()},classNames:[],styleProperties:{}},{tagName:null,content:v,attributes:{},classNames:[],styleProperties:{}}]}],this.selectionManager.isItemSelected(r)&&(O.children[0].children[0].attributes.checked="")),O},y.prototype.getBodyCellBinding=function(r,c,v,P,E,O,G,re){var te,ge,oe=(0,i.HZ)(this.getBodyCellContent(r)),he={},ye=!_.isEmpty(oe.trim()),we=this.getBodyCellStyle(r,c,ye),He=r.columnMetadata;n.fF.assertValue(He,"Body cell with no column metadata");var Pe,Ce=this.columnsDataBarsSettings[r.columnMetadata.queryName],Re=this.shouldApplyDataBars(Ce,r),Se=this.formattingProperties.columnFormatting[He.queryName],Ie=(0,o.TS)(Se&&Se.icon,r.icon),Ne=r.hyperlink;if(Ie&&"IconOnly"===Ie.layout)oe="";else if(_.isEmpty(oe)&&(oe=f.jv),r.isKpi)oe=this.getKpiContentString(r),he={};else if(Re&&Ce.hideText)oe=c?f.jv:"";else{this.formattingProperties.values.wordWrap&&(oe=(0,x.rP)(oe));var Fe=(0,N.MN)(r.columnMetadata,oe);if(Fe!==t.av.NONE)ge=(0,x.RP)(this.formattingProperties.values.urlIcon,Fe),Pe=(0,x.RD)(oe,(0,i.HZ)(r.textContent),ge,this.options.onHyperlinkClicked),Ne=void 0;else if(this.isImage(r)){var Te=i.b$.encodeUriForImageDataSvg(r.textContent),Ee=this.formattingProperties.grid;Pe=(0,x.D2)((0,i.HZ)(Te),Ee.imageHeight,Ee.imageWidth,(0,i.HZ)(r.altText))}else this.isSparkline(r)&&(oe=c?f.jv:"")}this.options.hyperlinksEnabled&&(Pe||""!==oe&&oe!==f.jv)&&Ne&&(0,t.MN)(Ne)!==t.av.NONE&&(Pe=(0,x.RD)(Pe||oe,(0,i.HZ)(Ne),null,this.options.onHyperlinkClicked,!0,!0));var Be,We={};if(null!==(te=this.isBodyCellAutoWidth)&&void 0!==te&&te.call(this,r)){var Ae=this.getMeasureElementMaxWidth(c);void 0!==Ae&&(We["max-width"]=Ae)}if(this.a11yMatrixFS&&!c&&r.position.column.isFirst){var Ve=this.selectionManager.getRowFromCell(r);if(this.selectionManager.isItemSelected(Ve)){var ze=this.getBorderInfo(r.position.row.isFirst,r.position.row.isLast,!0,!1,!0,T.p0.Body),Oe=G&&this.selectionManager.getRowFromCell(G),Ge=Oe&&this.selectionManager.isItemSelected(Oe);Be={attributes:{"aria-hidden":"true"},classNames:[],styleProperties:{width:"100%",top:ze.weightTop+"px",bottom:Ge?"0":ze.weightBottom+"px",left:ze.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]}}}var De,be=Pe=Pe?{tagName:"div",children:[Pe],classNames:[],styleProperties:We,attributes:{}}:{tagName:"div",content:oe,classNames:[],styleProperties:We,attributes:{}};if(Ie&&(De=this.getBodyCellFontInfo(r).measuredFontHeight,be=(0,x.Ps)(Ie,De,Pe,this.hostServices)),Re&&!c&&(be=(0,X.JF)(be,Ce,we,r.dataPoint,this.hostServices)),!c&&this.isSparkline(r)&&(n.fF.assert(function(){return null!=v&&null!=P},"height and width should be defined for sparkline rendering"),be=(0,j.MV)(be,this.sparklineSettings[r.columnMetadata.queryName],we,r.dataPoint,v,P,Ie,De)),E&&(r.fontColor||r.backColor)){var Ue=this.hostServices.getLocalizedString(f.Sl);_.isEmpty(be.children)?be={attributes:{},classNames:[],styleProperties:{},children:[be,{attributes:{},classNames:["visually-hidden"],styleProperties:{},content:Ue}]}:be.children.push({attributes:{},classNames:["visually-hidden"],styleProperties:{},content:Ue})}if(this.a11yMatrixFS&&Be&&(_.isEmpty(be.children)?be={attributes:{},classNames:[],styleProperties:{},children:[be,Be]}:be.children.push(Be)),O){(he=he??{})[F.QZ]="".concat(1);var je=r.columnMetadata.isMeasure;r.isRowGrandTotal||r.isTotal?je||""===r.textContent?(be.classNames.push(F.cy),he[F.Ez]="".concat("totals"),he[F.CK]="Visual_Tablix_TotalsSection"):""!==r.textContent&&(be.classNames.push(F.cy),he[F.Ez]="".concat("total-labels"),he[F.CK]="Visual_Tablix_TotalsSection_Label",he[F.kv]=JSON.stringify({reference:h.Z.total.label,style:0}).replace(/\"/g,"&quot;")):(be.classNames.push(F.cy),he[F.Ez]="".concat(je?"measure-values":"values"),he[F.CK]="Visual_Tablix_Values")}return this.a11yMatrixFS&&(Ve=this.selectionManager.getRowFromCell(r),this.selectionManager.isBodyCellHighlighted(r)?this.selectionManager.isItemSelected(Ve)&&be.classNames.push("cell-selected"):be.classNames.push("cell-unselected")),this.addBodyCellClasses(r,!!ge,Pe.classNames,be.classNames),this.addBodyCellStyleAttributes(r,we,be.styleProperties,E,P),be.attributes=he,be},y.prototype.getMeasureElementMaxWidth=function(r){return this.formattingProperties.values.wordWrap&&r&&this.getViewport?"".concat(this.getViewport().width-H.zf-3,"px"):void 0},y.prototype.getCornerCellBinding=function(r,c,v){return v?{content:this.hostServices.getLocalizedString(f.uX),classNames:["visually-hidden"],attributes:{role:"columnheader","aria-colindex":"1",tabindex:"-1"},styleProperties:{}}:{content:"",classNames:null,styleProperties:null,attributes:void 0}},y.prototype.getApproximateRowHeaderWidth=function(r){return 0},y.prototype.getApproximateColumnHeaderWidth=function(r){var c,v,P,E,O=this.getColumnHeaderStyle(r,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,x.JT)(this.getColumnHeaderLabel(r),this.getColumnHeaderFontInfo(r).textProperties):(0,x.X1)(this.getColumnHeaderLabel(r),this.getColumnHeaderFontInfo(r).textProperties))+(null!==(v=null===(c=O.borders.left)||void 0===c?void 0:c.weight)&&void 0!==v?v:0)+(null!==(E=null===(P=O.borders.right)||void 0===P?void 0:P.weight)&&void 0!==E?E:0)},y.prototype.getApproximateBodyCellWidth=function(r){var c,v,P,E,O=0;if(r.icon){if(O=this.getBodyCellFontInfo(r).measuredFontHeight,"IconOnly"===r.icon.layout)return O;O+=x.MO}if(r.isKpi)return O+this.valueFontInfo.fontProperties.size.px;var G=r.columnMetadata&&this.columnsDataBarsSettings[r.columnMetadata.queryName];if(G&&G.hideText&&!r.isTotal&&_.isNumber(r.dataPoint))return O;var re=this.getBodyCellContent(r),te=(0,N.MN)(r.columnMetadata,re);if(te!==t.av.NONE&&(0,x.RP)(this.formattingProperties.values.urlIcon,te))return O+this.valueFontInfo.fontProperties.size.px;if(this.isImage(r))return O+this.formattingProperties.grid.imageWidth;if(this.isSparkline(r))return O;var se=this.getBodyCellFontInfo(r),oe=this.getBodyCellStyle(r,!0,!0);return O+(this.formattingProperties.values.wordWrap?(0,x.JT)(re,se.textProperties):(0,x.X1)(re,se.textProperties))+(null!==(v=null===(c=oe.borders.left)||void 0===c?void 0:c.weight)&&void 0!==v?v:0)+(null!==(E=null===(P=oe.borders.right)||void 0===P?void 0:P.weight)&&void 0!==E?E:0)},y.prototype.getApproximateCornerCellWidth=function(r){return 0},y.prototype.getApproximateRowHeaderHeight=function(r,c){return 0},y.prototype.getApproximateColumnHeaderHeight=function(r,c){var v,P,E,O,G,re=this.getColumnHeaderFontInfo(r),te=this.getColumnHeaderStyle(r,!0,!0);G=this.formattingProperties.columnHeaders.wordWrap&&null!=c?(0,x.do)(this.getColumnHeaderLabel(r),(0,x.x9)(c,te),re.textProperties).length:1;var se=null!==(P=null===(v=te.borders.top)||void 0===v?void 0:v.weight)&&void 0!==P?P:0,oe=null!==(O=null===(E=te.borders.bottom)||void 0===E?void 0:E.weight)&&void 0!==O?O:0;return re.measuredFontHeight*G+se+oe},y.prototype.getApproximateBodyCellHeight=function(r,c){var v,P,E,O,G=this.getBodyCellFontInfo(r);if(r.icon&&"IconOnly"===r.icon.layout)return G.measuredFontHeight;if(r.isKpi)return this.valueFontInfo.fontProperties.size.px;var re=this.getBodyCellContent(r),te=(0,N.MN)(r.columnMetadata,re);if(te!==t.av.NONE&&(0,x.RP)(this.formattingProperties.values.urlIcon,te))return this.valueFontInfo.fontProperties.size.px;if(this.isImage(r))return this.formattingProperties.grid.imageHeight;if(this.isSparkline(r))return G.measuredFontHeight;var se,oe=this.getBodyCellStyle(r,!0,!0);this.formattingProperties.values.wordWrap&&null!=c?(r.icon&&(c-=G.measuredFontHeight+x.MO),se=(0,x.do)(re,(0,x.x9)(c,oe),G.textProperties).length):se=1;var he=null!==(P=null===(v=oe.borders.top)||void 0===v?void 0:v.weight)&&void 0!==P?P:0,ge=null!==(O=null===(E=oe.borders.bottom)||void 0===E?void 0:E.weight)&&void 0!==O?O:0;return G.measuredFontHeight*se+he+ge},y.prototype.getApproximateCornerCellHeight=function(r,c){return 0},y.prototype.updateFormattingProperties=function(r,c,v,P){this.formattingProperties=c,this.legacyTooltipsEnabled=P;var E=c.general.textSize,O=new x.Kq,G={},re={},te={};G.family=c.columnHeaders.fontFamily||f.F2,G.size=c.columnHeaders.fontSize||E,c.columnHeaders.bold&&(G.weight=a.en),c.columnHeaders.italic&&(G.style=a.BF),c.columnHeaders.underline&&(G.textDecoration=a.f0),this.columnHeaderFontInfo=(0,x.Od)(G,O),re.family=c.values.fontFamily||f.dG,re.size=c.values.fontSize||E,c.values.bold&&(re.weight=a.en),c.values.italic&&(re.style=a.BF),c.values.underline&&(re.textDecoration=a.f0),this.valueFontInfo=(0,x.Od)(re,O);var oe,se=c.total.fontFamily;se||this.valueFontInfo.fontProperties.family!==f.dG?oe=!0:this.valueFontInfo.fontProperties.family===f.dG&&(se=f.Zk),te.family=se,te.size=c.total.fontSize,c.total.bold&&oe&&(te.weight=a.en),c.total.italic&&(te.style=a.BF),c.total.underline&&(te.textDecoration=a.f0),this.totalFontInfo=(0,x.TQ)(this.valueFontInfo,te,O),this.glyphFontInfo=(0,x.Od)({family:f.Vz,size:b.B.createFromPt((c.columnHeaders.fontSize||E).pt*f.Yo),lineHeight:"100%"},O),O.measureAll(this.measureElement),this.columnHeaderClasses=[],this.columnHeaderClasses.push(this.formattingProperties.columnHeaders.wordWrap?x.n2:x.wV),this.options.interactivityIndicatorEnabled&&this.options.sortingEnabled&&this.columnHeaderClasses.push(x.VM),this.columnsDataBarsSettings={};var he=c.columnFormatting;if(he&&r&&r.table&&!_.isEmpty(r.table.columns))for(var ge=0,ye=r.table.columns;ge<ye.length;ge++)(He=(we=ye[ge]).queryName)&&he[He]&&(this.columnsDataBarsSettings[He]=(0,X.az)(we,he[He].dataBarsSettings,v));this.sparklineSettings={};var Ce=c.sparklines;if(Ce&&r&&r.table&&!_.isEmpty(r.table.columns))for(var Re=0,Se=r.table.columns;Re<Se.length;Re++){var we,He;(He=(we=Se[Re]).queryName)&&Ce[He]&&(this.sparklineSettings[He]=(0,j.wJ)(Ce[He],we.type,v))}},y.prototype.getColumnHeaderLabel=function(r){return this.ensureMeasuringSafeText(r.metadata.displayName,this.formattingProperties.columnHeaders.wordWrap)},y.prototype.getBodyCellContent=function(r){return this.ensureMeasuringSafeText(r.textContent,this.formattingProperties.values.wordWrap)},y.prototype.ensureMeasuringSafeText=function(r,c){var v;return r?c?_.isEmpty(null===(v=r.trim)||void 0===v?void 0:v.call(r))?"":r:(0,R.zI)(r):""},y.prototype.addBodyCellStyleAttributes=function(r,c,v,P,E){c.setAttributes(v,P,void 0,this.a11yMatrixFS,E),v.position="relative",this.a11yMatrixFS||!this.selectionManager.isBodyCellHighlighted(r)&&!P&&(0,x.CQ)(v)},y.prototype.getColumnHeaderStyle=function(r,c,v){var P=new N.qZ(x.K2,x.K2);return(0,Q.aV)(r.position,P,this.formattingProperties,this.getColumnFormatting(r.metadata),this.options.tablixProperties),P.fontFamily=void 0,this.formattingProperties.columnHeaders.underline&&v&&(P.textDecoration=a.f0),(0,x.Nk)(this.columnHeaderFontInfo,P,v),P},y.prototype.getBodyCellStyle=function(r,c,v){var P=new N.qZ(x.K2,x.K2);return r.isRowGrandTotal?((0,Q.ji)(r.position,r,P,this.formattingProperties,this.getColumnFormatting(r.columnMetadata),this.options.tablixProperties),this.formattingProperties.total.underline&&v&&(P.textDecoration=a.f0),(0,x.Nk)(this.totalFontInfo,P,v)):((0,Q.cP)(r.position,r,P,this.formattingProperties,this.getColumnFormatting(r.columnMetadata),this.options.tablixProperties),this.formattingProperties.values.underline&&v&&(P.textDecoration=a.f0),(0,x.Nk)(this.valueFontInfo,P,v)),P},y.prototype.getBorderInfo=function(r,c,v,P,E,O){var G,re,te,se,we,He,Ce,Re,Se,Ie,Ne,Pe,Fe,oe=0,he=0,ge=0,ye=0;switch(O){case T.p0.Header:Fe=this.formattingProperties.columnHeaders;break;case T.p0.Body:Fe=this.formattingProperties.values;break;case T.p0.Footer:Fe=this.formattingProperties.total;break;default:n.fF.assertNever(O)}var Te=null!==(G=Fe.outlineWeight)&&void 0!==G?G:this.formattingProperties.grid.outlineWeight,Ee=null!==(re=Fe.outlineColor)&&void 0!==re?re:this.formattingProperties.grid.outlineColor,We=null===(te=this.formattingProperties.grid)||void 0===te?void 0:te.gridHorizontalColor,Ae=null===(se=this.formattingProperties.grid)||void 0===se?void 0:se.gridVerticalColor,Be=(0,B.ok)("#FFFFFF",.67,We),Ve=(0,B.ok)("#FFFFFF",.67,Ae);return r&&(0,C.yo)(Fe.outline)&&(oe=Te,we=N.Pb.Outline,Se=Ee),P&&(0,C.BK)(Fe.outline)?(he=Te,He=N.Pb.Outline,Ie=Ee):!P&&this.formattingProperties.grid.gridVertical&&(he=this.formattingProperties.grid.gridVerticalWeight,He=N.Pb.Gridline,Ie=this.selectionManager.isSelectionEmpty()?Ae:Ve),c&&(0,C.mv)(Fe.outline)?(ge=Te,Ce=N.Pb.Outline,Ne=Ee):!c&&this.formattingProperties.grid.gridHorizontal&&(ge=this.formattingProperties.grid.gridHorizontalWeight,Ce=N.Pb.Gridline,Ne=E?We:Be),v&&(0,C.fs)(Fe.outline)&&(ye=Te,Re=N.Pb.Outline,Pe=Ee),{weightTop:oe,weightRight:he,weightBottom:ge,weightLeft:ye,typeTop:we,typeRight:He,typeBottom:Ce,typeLeft:Re,colorTop:Se,colorRight:Ie,colorBottom:Ne,colorLeft:Pe}},y.prototype.addBodyCellClasses=function(r,c,v,P){var O,re,E=this.formattingProperties.columnFormatting[r.columnMetadata.queryName];v.push(this.formattingProperties.values.wordWrap?x.n2:x.wV),c&&v.push(f.LU),this.options.interactivityIndicatorEnabled&&this.options.selectionEnabled&&!r.isRowGrandTotal&&!this.formatMode&&P.push(x.VM),E&&(r.isTotal?E.styleTotal:E.styleValues)&&(O=E.alignment),c?re=w.H.center:r.isNumeric&&(re=w.H.right),(0,x.aY)(O,v,re)},y.prototype.getKpiContentString=function(r){return(0,x.kJ)(r.columnMetadata.kpi,r.textContent)},y.prototype.getColumnHeaderFontInfo=function(r){return this.columnHeaderFontInfo},y.prototype.getBodyCellFontInfo=function(r){return r.isRowGrandTotal?this.totalFontInfo:this.valueFontInfo},y.prototype.getColumnFormatting=function(r){return this.formattingProperties.columnFormatting[r.queryName]},y.prototype.shouldApplyDataBars=function(r,c){if(!r||!_.isNumber(c.dataPoint))return!1;switch(r.totalMatching){case 0:return!0;case 2:return c.isTotal;case 1:case void 0:return!c.isTotal;default:return n.fF.assertNever(r.totalMatching),!c.isTotal}},y.prototype.isImage=function(r){return!(r.isRowGrandTotal&&!_.isEmpty(r.columnMetadata.identityExprs))&&(0,p.pt)(r.columnMetadata)},y.prototype.isSparkline=function(r){var c,v=r.columnMetadata,P=null===(c=v?.type)||void 0===c?void 0:c.misc;return null!=P&&null!=P.sparkline},y}(),Z=function(){function y(){}return y.prototype.getNodeLeafCount=function(){return 1},y.prototype.isBlank=function(){return!1},y.prototype.isBlankRow=function(r){return!1},y.prototype.numberOfBlankRowsBefore=function(r){return 0},y.prototype.getIndexOfFirstLeaf=function(r){return r.position.column.index},y.prototype.hasHierarchy=function(){return!0},y.prototype.update=function(r){this.updateColumns(r)},y.prototype.getColumns=function(){return this.columns},y.prototype.getHierarchyDepth=function(){return 1},y.prototype.getHierarchyLeafCount=function(){return _.size(this.columns)},y.prototype.getHierarchyLeafAt=function(r){return this.columns[r]},y.prototype.getFloatingHierarchyLeafCount=function(){return 0},y.prototype.getFloatingHierarchyLeafAt=function(r){return null},y.prototype.getHierarchyItems=function(){return this.columns},y.prototype.getFloatingHierarchyItems=function(){return null},y.prototype.getLeafIndex=function(r){return r.position.column.index},y.prototype.isLeaf=function(r){return!0},y.prototype.isLastItem=function(r,c){return r.position.column.index===c.length-1},y.prototype.getAncestor=function(r){return null},y.prototype.getParent=function(r){return null},y.prototype.getChildren=function(r){return null},y.prototype.getLevel=function(r){return 0},y.prototype.getIndex=function(r){return r.position.column.index},y.prototype.getPathIndices=function(r){return[this.getIndex(r)]},y.prototype.getNodeFromPath=function(r){if(1===r.length)return this.columns[r[0]]},y.prototype.getItemsByLevel=function(r){return n.fF.assert(function(){return 0===r},"Table columns hierarchy has 1 level"),(0,k.ev)([],this.columns||[],!0)},y.prototype.getLeafAncestorAtLevel=function(r,c){return r},y.prototype.getExpansionState=function(r){return 2},y.prototype.getFirstDescendentLeafIndex=function(r){return this.getLeafIndex(r)},y.prototype.getIntersection=function(r,c){return null},y.prototype.getCorner=function(r,c){return null},y.prototype.getRowLevel=function(r){return 0},y.prototype.getColumnLevel=function(r){return 0},y.prototype.isColumnHeaderMultiValueSubtotal=function(r){return!1},y.prototype.isRowHeaderMultiValueSubtotal=function(r){return!1},y.prototype.getColumnIndexFromQueryName=function(r){return _.find(this.columns,function(c){return c.metadata.queryName===r})},y.prototype.updateColumns=function(r){this.columns=[];for(var c=r.length,v=0;v<c;v++)this.columns.push({metadata:r[v],position:this.calculateItemPosition(v,c)})},y.prototype.calculateItemPosition=function(r,c){var v=new N.ri;return v.row.index=v.row.indexInSiblings=0,v.row.isFirst=!0,v.row.isLast=!0,v.column.index=v.column.indexInSiblings=r,v.column.isFirst=0===r,v.column.isLast=r===c-1,v},y}(),q=function(){function y(r,c){this.tablixProperties=r,this.hostServices=c}return y.prototype.update=function(r,c,v,P,E,O){this.isDataComplete=P,this.formattingProperties=O,this.formatters=O.formatters,this.tooltipFormatters=O.tooltipFormatters||{},this.updateRows(r,c),this.updateFloatingRow(v,E)},y.prototype.getNodeLeafCount=function(){return 1},y.prototype.getIndexOfFirstLeaf=function(r){return r.index},y.prototype.hasHierarchy=function(){return!1},y.prototype.getRows=function(){return this.rows},y.prototype.isBlank=function(){return!1},y.prototype.isBlankRow=function(r){return!1},y.prototype.numberOfBlankRowsBefore=function(r){return 0},y.prototype.getHierarchyDepth=function(){return 1},y.prototype.getHierarchyLeafCount=function(){return _.size(this.rows)},y.prototype.getHierarchyLeafAt=function(r){return this.rows[r]},y.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingRow?1:0},y.prototype.getFloatingHierarchyLeafAt=function(r){return this.floatingRow},y.prototype.getHierarchyItems=function(){return this.rows},y.prototype.getFloatingHierarchyItems=function(){return this.floatingRow?[this.floatingRow]:null},y.prototype.getLeafIndex=function(r){return r.index},y.prototype.isLeaf=function(r){return!0},y.prototype.isLastItem=function(r,c){return this.isDataComplete&&r.index===c.length-1},y.prototype.getAncestor=function(r){return null},y.prototype.getParent=function(r){return null},y.prototype.getIndex=function(r){return r.index},y.prototype.getPathIndices=function(r){return[this.getIndex(r)]},y.prototype.getNodeFromPath=function(r){if(1===r.length)return this.rows[r[0]]},y.prototype.getItemsByLevel=function(r){return n.fF.assert(function(){return 0===r},"Table rows hierarchy has 1 level"),[this.rows[0]]},y.prototype.getChildren=function(r){return null},y.prototype.getLevel=function(r){return 0},y.prototype.getLeafAncestorAtLevel=function(r,c){return r},y.prototype.getExpansionState=function(r){return 2},y.prototype.getIntersection=function(r,c){var v,P,E=c.position.column.index,O=r.values[E],G=r.values.objects&&r.values.objects[E],re=c.metadata.queryName,te=c.metadata,se=r===this.floatingRow;_.isString(O)&&null!==(P=null===(v=te?.type)||void 0===v?void 0:v.misc)&&void 0!==P&&P.sparkline&&(O=(0,j.th)(O,this.hostServices));var oe=new N.ri,he=c.position;oe.column.index=he.column.index,oe.column.isFirst=he.column.isFirst,oe.column.isLast=he.column.isLast;var ge=r.index;oe.row.index=ge,oe.row.isFirst=0===ge,oe.row.isLast=this.isDataComplete&&r===_.last(this.rows);var ye,we,He=se&&!te.isMeasure&&0===he.column.index;if(He)ye=we=this.formattingProperties.total.totalLabel;else{var Ce=this.formatters[re],Re=this.tooltipFormatters[re];ye=Ce?Ce.format(O,G):null!=O?"".concat(O):"",we=Re?Re.format(O,G):ye}var Se={position:oe,dataPoint:O,isRowGrandTotal:se,columnMetadata:te,isTotal:se,isDefaultTotalLabel:He&&this.formattingProperties.total.isDefaultTotalLabel,textContent:ye,tooltipContent:we,isKpi:te&&(0,N.Y1)(te.kpi,ye),isNumeric:te&&te.type.numeric&&!te.kpi};return G&&(Se.backColor=(0,i.HZ)(this.tablixProperties.PropValuesBackColor.getValue(G)),Se.fontColor=(0,i.HZ)(this.tablixProperties.PropValuesFontColor.getValue(G)),Se.icon=U.FX.PropValuesIcon.getValue(G),Se.hyperlink=U.FX.PropValuesWebURL.getValue(G),Se.altText=U.FX.PropAltTextValue.getValue(G)),Se},y.prototype.getCorner=function(r,c){return{}},y.prototype.getRowLevel=function(r){return 0},y.prototype.getColumnLevel=function(r){return 0},y.prototype.isColumnHeaderMultiValueSubtotal=function(r){return!1},y.prototype.isRowHeaderMultiValueSubtotal=function(r){return!1},y.prototype.getColumnIndexFromQueryName=function(r){},y.prototype.updateRows=function(r,c){this.rows=[];for(var v=0;v<r.length;v++)this.rows.push({index:v,values:r[v],identity:c?c[v]:void 0})},y.prototype.updateFloatingRow=function(r,c){this.floatingRow=_.isEmpty(r)?null:{index:0,values:r,identity:void 0}},y}(),ie=D(26543),ae=function(){function y(r,c,v){this.tooltipService=r,this.selectionManager=c,this.tooltipsEnabled=!0}return y.prototype.getBodyHandler=function(){var r=this;return{addTooltip:function(v,P){return r.addBodyTooltip(v,P)},removeTooltip:function(v,P){return r.removeTooltip(P)},isTooltipEnabled:function(v){return r.tooltipsEnabled&&r.isBodyTooltipEnabled(v)},setTooltipDelegate:function(v,P,E,O,G){return r.setTooltipDelegate(v,P,O,G)},isTooltipEnabledGeneric:function(){return r.tooltipsEnabled}}},y.prototype.getHeaderHandler=function(){var r=this;return{addTooltip:function(v,P,E){return r.addHeaderTooltip(v,P,E)},removeTooltip:function(v,P){return r.removeTooltip(P)},isTooltipEnabled:function(v){return r.tooltipsEnabled},setTooltipDelegate:function(v,P,E,O,G){return r.setTooltipDelegateHeader(v,P,O,G)},isTooltipEnabledGeneric:function(){return r.tooltipsEnabled}}},y.prototype.onDataViewChanged=function(r,c){this.rowHierarchyNavigator=r,this.columnHierarchyNavigator=c},y.prototype.tooltipVisible=function(){return this.tooltipService&&this.tooltipService.visible()},y.prototype.hideTooltip=function(){this.tooltipService&&this.tooltipService.hide()},y.prototype.setTooltipsEnabled=function(r){this.tooltipsEnabled=r},y.prototype.addBodyTooltip=function(r,c){var v=this,P=d3.select(c);this.tooltipService.addTooltip(P,function(E){return v.getBodyTooltipInfo(r,E)},function(E){var O=v.getItemSelectionId(r,E);return O&&[O]})},y.prototype.setTooltipDelegate=function(r,c,v,P){var E=this,O=d3.select(c);this.tooltipService.addTooltip(O,function(G){return!E.tooltipsEnabled&&P(G)?null:E.getBodyTooltipInfo(r(G),G,!E.tooltipsEnabled)},function(G){if(!E.tooltipsEnabled)return null;var re=E.getItemSelectionId(r(G),G);return re&&[re]},!0,!0,v)},y.prototype.addHeaderTooltip=function(r,c,v){var E,O,P=this,G=d3.select(c),re=null===(O=(E=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===O?void 0:O.call(E);this.tooltipService.addTooltip(G,function(te){return P.getHeaderTooltipInfo(r,te)},re?function(te){return P.getItemSelectionId(r,te)}:function(te){},void 0,v)},y.prototype.setTooltipDelegateHeader=function(r,c,v,P){var O,G,E=this,re=d3.select(c),te=null===(G=(O=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===G?void 0:G.call(O);this.tooltipService.addTooltip(re,function(se){return!E.tooltipsEnabled&&P(se)?null:E.getHeaderTooltipInfo(r(se),se,!E.tooltipsEnabled)},function(se){return E.tooltipsEnabled&&te?[E.getItemSelectionId(r(se),se)]:null},!0,!0,v)},y.prototype.removeTooltip=function(r){var c=d3.select(r);this.tooltipService.removeTooltips(c)},y.prototype.isBodyTooltipEnabled=function(r){return!r.isRowGrandTotal||!_.isEmpty(r.textContent)},y.prototype.getHeaderTooltipInfo=function(r,c,v){if(r)return v?[{displayName:"",value:r.metadata.displayName}]:[{displayName:r.metadata.displayName}]},y.prototype.getBodyTooltipInfo=function(r,c,v){var P;if(this.rowHierarchyNavigator&&r){if(v)return"IconOnly"===(null===(P=r.icon)||void 0===P?void 0:P.layout)?void 0:[{displayName:"",value:r.tooltipContent}];var E=[],O=this.rowHierarchyNavigator.getHierarchyLeafAt(r.position.row.index);if(!r.isRowGrandTotal){var G=this.getGroupingTooltipInfo(O);G&&E.push.apply(E,G||[])}if(r.columnMetadata.isMeasure){var te=r.columnMetadata.displayName;r.isKpi?E.push({displayName:te,kpiValue:{metadata:r.columnMetadata.kpi,value:r.tooltipContent}}):_.isEmpty(r.tooltipContent)||E.push({displayName:te,value:r.tooltipContent})}else r.isRowGrandTotal&&!_.isEmpty(r.tooltipContent)&&E.push({displayName:r.tooltipContent});return _.isEmpty(E)?void 0:E}},y.prototype.getGroupingTooltipInfo=function(r){if(this.columnHierarchyNavigator&&this.rowHierarchyNavigator){for(var v=[],P=0,E=this.columnHierarchyNavigator.getColumns();P<E.length;P++){var O=E[P];if(!O.metadata.isMeasure){var G=this.rowHierarchyNavigator.getIntersection(r,O);v.push({displayName:O.metadata.displayName,value:G.tooltipContent})}}return v}},y.prototype.getItemSelectionId=function(r,c){if(this.rowHierarchyNavigator&&r&&!r.isRowGrandTotal){var v=this.rowHierarchyNavigator.getHierarchyLeafAt(r.position.row.index);return ie.l0.fromSelectorsByColumn(this.selectionManager.createSelectorsByColumn(v))}},y}(),le=D(66232),de=D(78843),ce=function(){function y(r){this.hostServices=r,this.totalLabel=this.hostServices.getLocalizedString(f.qT),this.clearLocal()}return y.prototype.onBodyCellContextMenu=function(r,c){if((0,le.n)(c),this.isTableEmpty())n.fF.assertFail("onBodyCellContextMenu should not be triggered on empty table.");else{var P,v=this.getRowFromCell(r);P=!this.isSelectionEmpty()&&this.isItemSelected(v)?this.selectedItems:[v];var E=this.createContextMenuArgs(r,P,c);E&&this.hostServices.onContextMenu(E)}},y.prototype.onBodyCellClick=function(r,c,v){n.fF.assert(function(){return null!=r||null!=v},"cell or row should be defined"),this.isTableEmpty()?n.fF.assertFail("onBodyCellClick should not be triggered on empty table."):r?r.isRowGrandTotal?this.clearHost():this.select(this.getRowFromCell(r),c):this.select(this.rows[v],c)},y.prototype.onWhitespaceClick=function(){this.clearHost()},y.prototype.isDrillingEnabled=function(r,c){if(!this.isTableEmpty()){var v={type:0,visualObjects:this.getVisualObjects([this.getRowFromCell(r)]),position:y.getMouseEventPosition(c)};return this.hostServices.onSelecting(v),1===v.action}n.fF.assertFail("isDrillingEnabled should not be triggered on empty table.")},y.prototype.select=function(r,c,v,P){if(void 0===v&&(v=!1),this.isItemSelected(r)){if(v)return;1===this.selectedItems.length&&1!==c?this.clearLocal():3===c?this.unselectItem(r):0===c&&(this.selectedItems=[r])}else 0===c&&this.clearLocal(),this.selectedItems.push(r),!P&&!this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))&&(this.selectedItems=[r]);P||this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,c))},y.prototype.isRowHighlighted=function(r){return!(!this.isSelectionEmpty()&&!this.isTableEmpty())||this.isItemSelected(r)},y.prototype.isBodyCellHighlighted=function(r){return!(!this.isSelectionEmpty()&&!this.isTableEmpty())||this.isItemSelected(this.getRowFromCell(r))},y.prototype.onDataViewChanged=function(r,c){if(this.rowNavigator=r,this.rows=r&&r.getRows(),this.totalRow=r&&r.getFloatingHierarchyLeafAt(0),this.columns=c&&c.getColumns(),!this.isSelectionEmpty()){for(var v=[],P=0,E=this.selectedItems;P<E.length;P++){var O=E[P],G=y.getMatchingRow(O,this.rows);v.push(G||O)}this.selectedItems=v}},y.prototype.clearLocal=function(){this.selectedItems=[]},y.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},y.prototype.isTableEmpty=function(){return!this.rows},y.prototype.isItemSelected=function(r){return-1!==this.selectedItems.indexOf(r)},y.prototype.unselectItem=function(r){_.pull(this.selectedItems,r)},y.prototype.clearHost=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs([]))},y.prototype.restoreSelection=function(r){if(this.clearLocal(),_.isEmpty(r))return!0;var c=_.keys(r[0].dataMap);if(1!==c.length)return!1;var v=_.chain(this.columns).filter(function(He){return!He.metadata.isMeasure}).map(function(He){return He.metadata.queryName}).value(),P=c[0];if(!_.includes(v,P))return!1;for(var E=!1,O=_.clone(r),G=0,re=this.rows;G<re.length;G++){for(var te=re[G],se=void 0,oe=function(Ce){var Re=Ce.dataMap[P][0];if(n.fF.assert(function(){return 1===Ce.dataMap[P].length},"TableExSelectionManager.restoreSelection received an identity with multiple scope identities"),n.fF.assert(function(){return(0,I.yN)(Re)},"TableExSelectionManager.restoreSelection received an identity that was not a scope identity"),(0,de.fS)(Re,te.identity))return se=Ce,"break"},he=0,ge=O;he<ge.length&&"break"!==oe(ge[he]);he++);se&&(this.select(te,3,!1,!0),_.remove(O,se),E=!0)}return E},y.prototype.getRowFromCell=function(r){var c=this;return n.fF.assert(function(){return!r.isRowGrandTotal||r.isRowGrandTotal&&!!c.totalRow},"expected a floating row to be present for a rowGrandTotal cell"),r.isRowGrandTotal?this.totalRow:this.rows[r.position.row.index]},y.prototype.getRowAtIndex=function(r){return this.rows[r]},y.prototype.createContextMenuArgs=function(r,c,v){for(var P=this,E=[],O=0,G=c;O<G.length;O++){var te=this.createSelectorsByColumn(G[O]);te&&E.push(te)}n.fF.assert(function(){return!(_.isEmpty(E)&&1!==P.rows.length)},"multi-row tables should have identities");var se={data:E,position:y.getMouseEventPosition(v)};return se.copyArgs={singleValue:function(){var ge,ye;return(null===(ye=null===(ge=r.columnMetadata.type)||void 0===ge?void 0:ge.misc)||void 0===ye?void 0:ye.sparkline)?r.textContent:(0,N.pW)(r.dataPoint)},grid:function(){var ye=P.columns.length,we=new Array(c.length+1);we[0]=new Array(ye),P.columns.forEach(function(Ce,Re){we[0][Re]=Ce.metadata.displayName}),c.forEach(function(Ce,Re){var Se=we[Re+1]=new Array(ye);P.columns.forEach(function(Ie,Ne){Se[Ne]=P.rowNavigator.getIntersection(Ce,Ie).textContent})}),r.isRowGrandTotal&&P.totalRow&&P.totalRow.values&&_.isEmpty(P.totalRow.values[0])&&(we[1][0]=P.totalLabel);var He=0;return 0!==P.rows.length&&(He=Math.round(c.length/P.rows.length*100)),{grid:we,coveragePercentage:He}}},se},y.prototype.createSelectArgs=function(r,c){return void 0===c&&(c=0),{type:0,visualObjects:this.getVisualObjects(r),selectionMode:c}},y.prototype.getVisualObjects=function(r){for(var c=[],v=0,P=r;v<P.length;v++){var O=this.createSelectorsByColumn(P[v]);O&&c.push({objectName:"",selectorsByColumn:O})}return c},y.prototype.createSelectorsByColumn=function(r){var c,v,P=_.find(this.columns,function(O){return!O.metadata.isMeasure});P&&((c={})[P.metadata.queryName]=[r.identity],v=c);var E=_(this.columns).filter(function(O){return O.metadata.isMeasure}).map(function(O){return O.metadata.queryName}).value();if(v||!_.isEmpty(E))return{dataMap:v,metadata:E}},y.getMouseEventPosition=function(r){return{x:r.clientX,y:r.clientY}},y.getMatchingRow=function(r,c){if(_.isEmpty(c))return null;for(var v=0,P=c;v<P.length;v++){var E=P[v];if((0,de.fS)(E.identity,r.identity))return E}return null},y.getMatchingColumnHeader=function(r,c){for(var v=0,P=c;v<P.length;v++){var E=P[v];if(this.areHeadersEqual(E,r))return E}return null},y.areHeadersEqual=function(r,c){return r.metadata.queryName===c.metadata.queryName},y}(),pe=D(59151),Me=function(){function y(r){this.hostServices=r,this.pendingChanges=[]}return y.prototype.onDataViewChanged=function(){this.pendingChanges=[]},y.getSelector=function(r){return{metadata:r.metadata.queryName}},y.prototype.getPendingChange=function(r){return _.find(this.pendingChanges,function(c){return ce.areHeadersEqual(c.header,r)})},y.prototype.queuePendingChange=function(r,c){var v=this.getPendingChange(r);v?v.width=c:this.pendingChanges.push({header:r,width:c})},y.prototype.getColumnWidth=function(r){var c=this.getPendingChange(r);if(c)return c.width;var v=r.metadata.objects;return v?U.FX.PropColumnWidthValue.getValue(v):void 0},y.prototype.setColumnWidth=function(r,c){this.queuePendingChange(r,c),(0,pe.P)([{selector:y.getSelector(r),value:c}],this.hostServices,!1)},y.prototype.getRowHeight=function(r){},y.prototype.setRowHeight=function(r,c){},y.prototype.getRowLevelWidth=function(r){},y.prototype.setRowLevelWidth=function(r,c){n.fF.assertFail("tableExSizeManager:setRowLevelWidth should not be called")},y.prototype.getColumnLevelHeight=function(r){},y.prototype.setColumnLevelHeight=function(r,c){},y.prototype.setMissingWidths=function(r){for(var c=[],v=0,P=r;v<P.length;v++){var E=P[v],O=E.header,G=E.width;null==this.getColumnWidth(O)&&(this.queuePendingChange(O,G),c.push({selector:y.getSelector(O),value:G}))}_.isEmpty(c)||(0,pe.P)(c,this.hostServices,!0)},y.prototype.clearWidths=function(r){for(var c=[],v=0,P=r;v<P.length;v++){var E=P[v];null!=this.getColumnWidth(E)&&c.push({selector:y.getSelector(E),value:void 0}),this.queuePendingChange(E,void 0)}_.isEmpty(c)||(0,pe.P)(c,this.hostServices,!0)},y}(),ve=D(67016),xe=D(48645),fe=function(){function y(r,c){void 0===r&&(r=(0,A.DH)()),this.options=r,this.featureSwitches=c||{},this.options.tooltipsEnabled=this.options.tooltipsEnabled,this.tooltipType=0,this.asyncSerializer=new s.W,this.supportsOnObject=this.featureSwitches.onObject&&this.featureSwitches.a11yMatrix,this.numFontDelays=0}return y.prototype.init=function(r){var v,c=this;if(this.currentViewport=r.viewport,this.element=r.element,this.hostServices=r.host,this.waitingForData=!1,this.style=r.style,this.tablixPropertyManager=new u.U(this.style),this.selectionManager=new ce(this.hostServices),this.sortingManager=new W(this.hostServices,this.featureSwitches.a11yTable),this.sizeManager=new Me(this.hostServices),this.tooltipService=(0,S.r)(r.host),this.supportsOnObject){var E=(null===(v=this.hostServices)||void 0===v?void 0:v.getSubSelectionService())??K.D.createWithDefaultHost();this.subSelectionHelper=F.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:new xe.y(E),targetSource:"format",scale:function(){return c.currentViewport.scale},selectorCallback:function(G){return c.getSelectorsByColumnFromSubselectedElement(G)}})}},Object.defineProperty(y.prototype,"showTotalPlaceHolders",{get:function(){return this.featureSwitches.onObject&&1===this.viewMode&&this.isSelected},enumerable:!1,configurable:!0}),y.prototype.onViewModeOrIsSelectedChanged=function(r,c,v){var P=this.showTotalPlaceHolders;this.viewMode=r,this.isSelected=c;var E=this.showTotalPlaceHolders;P!==E&&this.pivotTableControl instanceof V.d&&(this.pivotTableControl.onShowTotalPlaceHoldersChanged(E),v||this.pivotTableControl.renderAsync(T.BM.ClearMeasurement))},y.prototype.onViewModeChanged=function(r){this.onViewModeOrIsSelectedChanged(r,this.isSelected)},y.prototype.onSelectionStateChanged=function(r){this.onViewModeOrIsSelectedChanged(this.viewMode,r)},y.prototype.update=function(r){return(0,k.mG)(this,void 0,void 0,function(){var c=this;return(0,k.Jh)(this,function(v){switch(v.label){case 0:return null!=r.viewMode&&this.onViewModeOrIsSelectedChanged(r.viewMode,this.isSelected,!0),this.currentViewport=r.viewport,[4,this.asyncSerializer.enqueue(function(){return(0,k.mG)(c,void 0,void 0,function(){var P,E,O,G;return(0,k.Jh)(this,function(re){switch(re.label){case 0:return document.fonts&&"loaded"!==document.fonts.status&&this.numFontDelays<2?[4,new Promise(function(te){return setTimeout(te,500)})]:[3,2];case 1:return re.sent(),this.numFontDelays++,[3,0];case 2:return r.type&L.EP.Data||2===r.resizeMode?[4,this.onDataViewChanged(r.dataViews,r.operationKind,r.viewport)]:[3,4];case 3:re.sent(),re.label=4;case 4:return this.pivotTableControl&&r.type&L.EP.Resize?(this.pivotTableControl.setWidth(r.viewport.width),this.pivotTableControl.setHeight(r.viewport.height),[4,this.renderControl(T.BM.Incremental,null,null)]):[3,6];case 5:re.sent(),re.label=6;case 6:return this.supportsOnObject?r.formatMode===this.formatMode?[3,8]:(this.formatMode=r.formatMode,this.subSelectionHelper.setFormatMode(r.formatMode),r.formatMode?(this.element.get(0).setAttribute(F.y3,"true"),this.selectionManager.clearLocal()):this.element.get(0).removeAttribute(F.y3),this.pivotTableControl&&this.pivotTableControl instanceof V.d?(this.pivotTableControl.getBinder().setFormatMode(r.formatMode),[4,this.pivotTableControl.renderAsync(T.BM.ClearRendering)]):[3,8]):[3,8];case 7:re.sent(),re.label=8;case 8:return P=r.type&L.EP.Data||r.type&L.EP.Resize||r.type&L.EP.FormattingSubSelectionChange,E=r.type&L.EP.FormattingSubSelectionChange,this.subSelectionHelper&&P&&(this.subSelectionHelper.updateOutlinesFromSubSelections(r.subSelections,!0),this.hostServices.alertScreenReader&&E&&(O=this.subSelectionHelper.getLabelsFromSubSelections(r.subSelections,["aria-label"]),(G=O?.length&&O.join(" "))&&this.hostServices.alertScreenReader(G))),[2]}})})})];case 1:return v.sent(),[2]}})})},y.prototype.updatePersistedWidths=function(r){var c=U.FX.PropColumnPivotTableAutoSizeColumns.getValue(this.dataView.metadata.objects);if(!c&&this.pivotTableControl){for(var v=[],P=this.columnHierarchyNavigator.getColumns(),O=0,G=0,re=this.pivotTableControl.getColumnWidthMeasureManager().getPageColumns();G<re.length;G++)for(var oe=0,he=re[G].getColumnWidths();oe<he.length;oe++)v.push({header:P[O],width:he[oe]}),O++;this.sizeManager.setMissingWidths(v)}else c&&r&&r.metadata&&r.metadata.objects&&!U.FX.PropColumnPivotTableAutoSizeColumns.getValue(r.metadata.objects)&&this.sizeManager.clearWidths(this.columnHierarchyNavigator.getColumns())},y.prototype.onDataViewChanged=function(r,c,v){return(0,k.mG)(this,void 0,void 0,function(){var P,E,O=this;return(0,k.Jh)(this,function(G){switch(G.label){case 0:return _.isEmpty(r)?[3,5]:(P=this.dataView,this.dataView=r[0],this.formattingProperties=this.tablixPropertyManager.getTableExObjects(this.dataView,function(re){for(var te,se=[],oe=1;oe<arguments.length;oe++)se[oe-1]=arguments[oe];return(te=O.hostServices).getLocalizedString.apply(te,(0,k.ev)([re],se||[],!1))},this.style,this.featureSwitches),E=!this.dataView.metadata.segment,c!==L.su.Append?[3,2]:[4,this.onAppendDataView(P,E)]);case 1:return G.sent(),[3,4];case 2:return[4,this.onNewDataView(P,v,E)];case 3:G.sent(),G.label=4;case 4:return[3,6];case 5:this.dataView=void 0,this.selectionManager.onDataViewChanged(void 0,void 0),this.interactionManager&&this.interactionManager.onDataViewChanged(void 0,void 0),this.pivotTableControl&&this.pivotTableControl.clear(),G.label=6;case 6:return this.waitingForData=!1,[2]}})})},y.prototype.onAppendDataView=function(r,c){return(0,k.mG)(this,void 0,void 0,function(){return(0,k.Jh)(this,function(v){switch(v.label){case 0:return this.updateHierarchyNavigators(c),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),[4,this.renderControl(T.BM.Incremental,null,null)];case 1:return v.sent(),[2]}})})},y.prototype.onNewDataView=function(r,c,v){return(0,k.mG)(this,void 0,void 0,function(){var P,E,O;return(0,k.Jh)(this,function(G){switch(G.label){case 0:return P=this.getPreviousVisibleRowStart(),E=this.getPreviousVisibleColumnStart(),this.createOrUpdateControlAndNavigators(v),this.sizeManager.onDataViewChanged(),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.pivotTableControl.setWidth(c.width),this.pivotTableControl.setHeight(c.height),O=this.hostServices.tooltips(),this.tooltipType=this.options.tooltipsEnabled&&O&&O.enabled()?1:0,this.interactionManager&&this.interactionManager.setTooltipsEnabled(1===this.tooltipType),this.binder.updateFormattingProperties(this.dataView,this.formattingProperties,this.style,0===this.tooltipType),[4,this.renderControl(T.BM.ClearMeasurement,this.getVisibleRowStart(P,W.hasSortingChanged(r,this.dataView)),this.getVisibleColumnStart(E))];case 1:return G.sent(),this.updatePersistedWidths(r),[2]}})})},y.prototype.onClearSelection=function(){this.selectionManager.clearLocal(),this.renderSelection()},y.prototype.onRestoreSelection=function(r){if(this.selectionManager){var c=this.selectionManager.restoreSelection(r.selection);return this.renderSelection(),c}return!1},y.prototype.updateHierarchyNavigators=function(r){this.rowHierarchyNavigator.update(this.dataView.table.rows,this.dataView.table.identity,this.dataView.table.totals,r,this.dataView.table.columns,this.formattingProperties),this.columnHierarchyNavigator.update(this.dataView.table.columns)},y.prototype.renderControl=function(r,c,v){return this.pivotTableControl.renderAsync(r,c,v)},y.prototype.getPreviousVisibleRowStart=function(){if(this.pivotTableControl){var r=this.pivotTableControl.getVisibleRowStart();if(!r)return null;var c=this.rowHierarchyNavigator.getHierarchyLeafAt(r.rowIndex);return c?{item:c,offset:r.visibleHeight}:null}},y.prototype.getPreviousVisibleColumnStart=function(){if(this.pivotTableControl){var r=this.pivotTableControl.getVisibleColumnStart();if(!r)return null;var c=this.columnHierarchyNavigator.getHierarchyLeafAt(r.columnIndex);return c?{item:c,offset:r.visibleWidth}:null}},y.prototype.getSelectorsByColumnFromSubselectedElement=function(r){var v,c=this;if(n.fF.assert(function(){return c.supportsOnObject},"Should not be calling getSelectorsByColumnFromSubSelectedElement if does not support onObject"),this.pivotTableControl instanceof V.d)switch(d3.select(r).attr(F.Ez)){case"values":case"measure-values":var E=this.pivotTableControl.getMidRenderer().getItemByElement(r);return null!==(v=E?.columnMetadata)&&void 0!==v&&v.queryName?{metadata:[E.columnMetadata.queryName]}:{};default:return{}}},y.prototype.getVisibleRowStart=function(r,c){if(!r||0===this.pivotTableControl.getViewport().top)return null;if(c)return{rowIndex:0,visibleHeight:Number.MAX_VALUE};var v=ce.getMatchingRow(r.item,this.rowHierarchyNavigator.getRows());return v&&this.rowHierarchyNavigator.isLeaf(v)?{rowIndex:this.rowHierarchyNavigator.getLeafIndex(v),visibleHeight:r.offset}:null},y.prototype.getVisibleColumnStart=function(r){if(!r||0===this.pivotTableControl.getViewport().left)return null;var c=ce.getMatchingColumnHeader(r.item,this.columnHierarchyNavigator.getColumns());return c&&this.columnHierarchyNavigator.isLeaf(c)?{columnIndex:this.columnHierarchyNavigator.getLeafIndex(c),visibleWidth:r.offset}:null},y.prototype.renderSelection=function(){var r;null===(r=this.pivotTableControl)||void 0===r||r.renderAsync(T.BM.ClearRendering)},y.prototype.createOrUpdateControlAndNavigators=function(r){var c=this;if(this.rowHierarchyNavigator||(this.rowHierarchyNavigator=new q(this.tablixPropertyManager.tablixProperties,this.hostServices),this.columnHierarchyNavigator=new Z),this.updateHierarchyNavigators(r),!this.pivotTableControl){var v={interactivityIndicatorEnabled:this.options.interactivityIndicatorEnabled,selectionEnabled:this.options.selection&&this.options.selection.enabled,sortIconEnabled:this.options.sorting&&this.options.sorting.showActiveSortIcon,sortingEnabled:this.options.sorting&&this.options.sorting.enabled,hyperlinksEnabled:this.featureSwitches.conditionalTablixWebURL,tablixProperties:this.tablixPropertyManager.tablixProperties,onBindRowHeader:function(he){return c.onBindRowHeader(he)},onHyperlinkClicked:function(he,ge){return c.onHyperlinkClicked(he,ge)}},P=document.createElement("div");P.className="tableExContainer",this.element.append(P),this.binder=new Y(v,this.selectionManager,P,this.hostServices,this.featureSwitches.a11yMatrix);var E=this.featureSwitches.a11yTable,O=this.featureSwitches.a11yMatrix,G=this.supportsOnObject;this.pivotTableControl=new V.d(P,this.sizeManager,this.createControlOptions(),E,!1,G,this.featureSwitches.enableCalculationHighlighting,this.hostServices,this.style,this.onVerticalScrollButtonClick.bind(this),this.onHorizontalScrollButtonClick.bind(this),this.options.interactivityIndicatorEnabled,this.showTotalPlaceHolders,this.subSelectionHelper),this.binder.getViewport=O?function(){return{width:c.pivotTableControl.getWidth(),height:c.pivotTableControl.getHeight()}}:function(){return c.pivotTableControl.getViewport()}.bind(this),this.binder.isHeaderAutoWidth=function(he){return void 0===c.sizeManager.getColumnWidth(he)}.bind(this),this.binder.isBodyCellAutoWidth=function(he){var ge=c.columnHierarchyNavigator.getColumns()[he.position.column.index];return void 0===c.sizeManager.getColumnWidth(ge)}.bind(this),this.pivotTableControl.setClassName("tableEx"),this.pivotTableControl.setRowNavigator(this.rowHierarchyNavigator),this.pivotTableControl.setColumnNavigator(this.columnHierarchyNavigator),this.pivotTableControl.setBinder(this.binder)}},y.prototype.createControlOptions=function(){var r=this,c=this.options.scrolling.enabled,v=this.options.columnResizing.enabled;this.options.tooltipsEnabled&&(this.interactionManager=this.interactionManager=new ae(this.tooltipService,this.selectionManager,this.hostServices.getLocalizedString(f.qT)));var P=this.interactionManager;return this.options.selection.enabled?{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:null,columnHeaderClickHandler:function(O,G){return r.onColumnHeaderClickHandler(O,G)},columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:!this.formatMode&&P?P.getHeaderHandler():null,columnHeaderFocusHandler:function(O){return null},bodyCellClickHandler:function(O,G,re,te){return!r.formatMode&&r.onBodyCellClick(O,G,re,te)},bodyCellContextMenuHandler:function(O,G){return!r.formatMode&&r.onBodyCellContextMenu(O,G)},bodyCellInteractionHandler:!this.formatMode&&P?P.getBodyHandler():null,bodyCellFocusHandler:function(O,G){return null},cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:function(O,G){return!r.formatMode&&r.onContentActivation(O,G)},whitespaceClickHandler:function(O,G){return!r.formatMode&&r.onWhitespaceClick(G)},scrollingEnabled:c,columnResizingEnabled:v,rowLevelResizingEnabled:!1,onScroll:function(){return r.onScroll()}}:{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:null,columnHeaderClickHandler:null,columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:P?P.getHeaderHandler():null,columnHeaderFocusHandler:null,bodyCellClickHandler:null,bodyCellContextMenuHandler:null,bodyCellInteractionHandler:P?P.getBodyHandler():null,bodyCellFocusHandler:null,cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:null,whitespaceClickHandler:null,scrollingEnabled:c,columnResizingEnabled:v,rowLevelResizingEnabled:!1,onScroll:function(){return r.onScroll()}}},y.prototype.onScroll=function(){this.interactionManager&&!this.interactionManager.tooltipVisible()&&this.interactionManager.hideTooltip()},y.prototype.onHyperlinkClicked=function(r,c){this.hostServices.onHyperlinkClick(r,c)},y.prototype.onColumnHeaderClickHandler=function(r,c){this.supportsOnObject&&this.formatMode?this.subSelectionHelper.isVisualObjectSubSelected({objectName:"columnHeaders",selectorsByColumn:{}})&&this.onColumnHeaderClick(r,c):this.onColumnHeaderClick(r,c)},y.prototype.onBodyCellClick=function(r,c,v,P){if(P!==T.p0.Footer||r)if(n.fF.assert(function(){return null!=r&&null!=c||null!=v},"cell or row should be defined"),r){if(!this.selectionManager.isDrillingEnabled(r,c)){var E=void 0;if(1==(E=g.M.isCtrlOrMeta(c)||1===this.hostServices.dataMultiSelectMode()?3:c.shiftKey?1:0)&&this.selectionManager.isItemSelected(this.selectionManager.getRowFromCell(r))||1===E&&r.isRowGrandTotal)return;this.selectionManager.onBodyCellClick(r,E),this.renderSelection(),this.announceSelectionState(r,void 0)}}else{if(1==(E=c?.shiftKey?1:3)&&this.selectionManager.isItemSelected(this.selectionManager.getRowAtIndex(v)))return;this.selectionManager.onBodyCellClick(void 0,E,v),this.renderSelection(),this.announceSelectionState(r,v)}},y.prototype.onBodyCellContextMenu=function(r,c){c.stopPropagation(),c.preventDefault(),this.selectionManager.onBodyCellContextMenu(r,c)},y.prototype.onVerticalScrollButtonClick=function(r,c){var v=this.hostServices.getLocalizedString("Table_Location_Vertical",this.getScrollRowIndex(r),this.getScrollRowIndex(c));this.hostServices.alertScreenReader(v)},y.prototype.onHorizontalScrollButtonClick=function(r,c){var v=this.hostServices.getLocalizedString("Table_Location_Horizontal",this.getScrollColumnIndex(r),this.getScrollColumnIndex(c));this.hostServices.alertScreenReader(v)},y.prototype.getScrollRowIndex=function(r){return 0===r?1:(0,N.Hd)(r)},y.prototype.getScrollColumnIndex=function(r){return 0===r?1:(0,N.jT)(r)},y.prototype.announceSelectionState=function(r,c){var v;n.fF.assert(function(){return null!=r||null!=c},"cell or row should be defined");var P=this.rowHierarchyNavigator.getHierarchyLeafAt(null!==(v=r?.position.row.index)&&void 0!==v?v:c),E=this.selectionManager.isItemSelected(P),O=this.hostServices.getLocalizedString(E?f.b:f.TV);this.hostServices.alertScreenReader(O)},y.prototype.onColumnHeaderClick=function(r,c){r&&this.dataView&&this.options.sorting.enabled&&this.sortingManager.sort(r,this.dataView.table.columns,c.shiftKey)},y.prototype.onContentActivation=function(r,c){n.fF.assertValue(r,"onContentActivated - null cellElement");var v=r.querySelector("a");v&&v.dispatchEvent(c)},y.prototype.onWhitespaceClick=function(r){if(this.selectionManager.onWhitespaceClick(),this.renderSelection(),r){var c=this.hostServices.getLocalizedString("Tablix_Selections_Cleared");this.hostServices.alertScreenReader(c)}},y.prototype.onBindRowHeader=function(r){this.needsMoreData(r)&&(this.featureSwitches.a11yMatrix?setTimeout(this.hostServices.loadMoreData):this.hostServices.loadMoreData(),this.waitingForData=!0,this.hostServices.alertScreenReader(this.hostServices.getLocalizedString("Table_Loading_More_Data")))},y.prototype.needsMoreData=function(r){if(this.waitingForData||!this.dataView||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var v=this.rowHierarchyNavigator.getHierarchyLeafCount()*f.sR;return this.rowHierarchyNavigator.getLeafIndex(r)>=v},y.prototype.getFormattingModel=function(){if(this.dataView)return this.tablixPropertyManager.getFormattingModel(this.hostServices,this.formattingProperties,this.dataView,l.Y.TableEx,void 0,this.featureSwitches,this.style)},y.prototype.enumerateObjectInstances=function(r){var c=this,v=new ne.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(r,v,this.dataView,l.Y.TableEx,function(P){for(var E,O=[],G=1;G<arguments.length;G++)O[G-1]=arguments[G];return(E=c.hostServices).getLocalizedString.apply(E,(0,k.ev)([P],O||[],!1))},this.featureSwitches,void 0,this.style),v.complete()},y.prototype.enumerateObjectRepetition=function(){var r=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(r,this.dataView,l.Y.TableEx,this.featureSwitches),r},y.prototype.getSubSelectablesAsync=function(r){var c;return(0,k.mG)(this,void 0,void 0,function(){return(0,k.Jh)(this,function(v){switch(v.label){case 0:return[4,null===(c=this.pivotTableControl)||void 0===c?void 0:c.renderAsync(T.BM.Incremental)];case 1:return v.sent(),[2,this.subSelectionHelper.getAllSubSelectables(r)]}})})},y.prototype.getSubSelectionStyles=function(r){if(this.supportsOnObject){var P,E,v=_.first(r).visualObjects;if(!(v.length>0))return;switch(P=v[0],_.isEmpty(P.selectorsByColumn)||(E=(0,I.tV)(P.selectorsByColumn)),P.objectName){case"columnHeaders":var O=(0,z.RM)(this.hostServices,{boldReference:h.Z.columnHeaders.bold,italicReference:h.Z.columnHeaders.italic,underlineReference:h.Z.columnHeaders.underline,fontColorReference:h.Z.columnHeaders.fontColor,fontFamilyReference:h.Z.columnHeaders.fontFamily,fontSizeReference:h.Z.columnHeaders.fontSize,backgroundReference:h.Z.columnHeaders.backColor,horizontalAlignmentReference:h.Z.columnHeaders.alignment,wordWrapReference:h.Z.columnHeaders.wordWrap});return O.grid={type:"contextmenu"},O.border={type:"contextmenu"},(0,k.pi)({type:1},O);case"totals":var G=(0,z.RM)(this.hostServices,{boldReference:h.Z.total.bold,italicReference:h.Z.total.italic,underlineReference:h.Z.total.underline,fontColorReference:h.Z.total.fontColor,fontFamilyReference:h.Z.total.fontFamily,fontSizeReference:h.Z.total.fontSize,backgroundReference:h.Z.total.backColor});return G.grid={type:"contextmenu"},G.border={type:"contextmenu"},(0,k.pi)({type:1},G);case"values":case"measure-values":if(!E)return;var re=this.columnHierarchyNavigator.getColumnIndexFromQueryName(E.metadata);return(0,z.xs)(this.hostServices,{fontFamilyReference:h.Z.values.fontFamily,fontSizeReference:h.Z.values.fontSize,boldReference:h.Z.values.bold,italicReference:h.Z.values.italic,underlineReference:h.Z.values.underline,fontColorReference:(0,k.pi)((0,k.pi)({},h.Z.columnFormatting.fontColor),{selector:E}),precisionReference:(0,k.pi)((0,k.pi)({},h.Z.columnFormatting.labelPrecision),{selector:E}),displayUnitsReference:(0,k.pi)((0,k.pi)({},h.Z.columnFormatting.labelDisplayUnits),{selector:E}),backgroundReference:(0,k.pi)((0,k.pi)({},h.Z.columnFormatting.backColor),{selector:E}),horizontalAlignmentReference:(0,k.pi)((0,k.pi)({},h.Z.columnFormatting.alignment),{selector:E}),wordWrapReference:h.Z.values.wordWrap},{precision:{defaultPrecision:(0,m.h1)(void 0,(0,m.v1)(re.metadata.type))},grid:{type:"contextmenu"},border:{type:"contextmenu"}})}}},y.prototype.getBorderShortcuts=function(r){var c;switch(r){case"columnHeaders":c=h.Z.columnHeaders.outlineStyle;break;case"totals":c=h.Z.total.outlineStyle;break;case"values":case"measure-values":c=h.Z.values.outlineStyle;break;default:return}return[{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},c),{value:C.$m.Nil})],label:this.hostServices.getLocalizedString("Format_Border_NoBorder"),icon:"NoBorder_16"},{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},c),{value:C.$m.Top|C.$m.Bottom|C.$m.Left|C.$m.Right})],label:this.hostServices.getLocalizedString("Format_Border_AllBorders"),icon:"BoxBorder_16"},{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},c),{value:C.$m.Top})],label:this.hostServices.getLocalizedString("Format_Border_TopBorder"),icon:"TopBorder_16"},{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},c),{value:C.$m.Bottom})],label:this.hostServices.getLocalizedString("Format_Border_BottomBorder"),icon:"BottomBorder_16"},{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},c),{value:C.$m.Bottom|C.$m.Top})],label:this.hostServices.getLocalizedString("Format_Border_TopAndBottomBorder"),icon:"TopAndThickBottomBorder_16"},{type:7},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("grid"),groupUid:"".concat("grid","-").concat("border")},label:this.hostServices.getLocalizedString("Format_Border")}]},y.prototype.getGridShortcuts=function(){return[{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},h.Z.grid.gridVertical),{value:!0,isTopLevelToggle:!0}),(0,k.pi)((0,k.pi)({},h.Z.grid.gridHorizontal),{value:!0,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Small_Multiples_Layout_Grid_Line_Type_Inner"),icon:"AccessGridlinesBoth_16"},{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},h.Z.grid.gridVertical),{value:!1,isTopLevelToggle:!0}),(0,k.pi)((0,k.pi)({},h.Z.grid.gridHorizontal),{value:!0,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_Horizontal"),icon:"AccessGridlinesHorizontal_16"},{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},h.Z.grid.gridVertical),{value:!0,isTopLevelToggle:!0}),(0,k.pi)((0,k.pi)({},h.Z.grid.gridHorizontal),{value:!1,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_Vertical"),icon:"AccessGridlinesVertical_16"},{type:9,referencesAndValues:[(0,k.pi)((0,k.pi)({},h.Z.grid.gridVertical),{value:!1,isTopLevelToggle:!0}),(0,k.pi)((0,k.pi)({},h.Z.grid.gridHorizontal),{value:!1,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_None"),icon:"AccessGridlinesNone_16"},{type:7},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("grid"),groupUid:"".concat("grid","-").concat("gridHorizontal")},label:this.hostServices.getLocalizedString("Format_Grid")}]},y.prototype.getSubSelectionShortcuts=function(r,c){if(this.supportsOnObject){var E,O,P=_.first(r).visualObjects;if(!(P.length>0))return;if(E=P[0],c)switch(c){case"grid":return this.getGridShortcuts();case"border":return this.getBorderShortcuts(E.objectName)}switch(_.isEmpty(E.selectorsByColumn)||(O=(0,I.tV)(E.selectorsByColumn)),E.objectName){case"columnHeaders":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnHeaders"),groupUid:"".concat("columnHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Column_Headers")}];case"totals":case"total-labels":var G="".concat("totals","-").concat("values");return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("totals"),groupUid:G},label:this.hostServices.getLocalizedString("total-labels"===E.objectName?"Format_Total_Label":"Format_Totals")}];case"values":case"measure-values":var re="".concat("values","-").concat("values"),te=[{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("values"),groupUid:re},label:this.hostServices.getLocalizedString("Format_Values")}];if("measure-values"===E.objectName){var se=O?this.tablixPropertyManager.getConditionalFormattingSelector(l.Y.TableEx,O.metadata):void 0;te.unshift({type:8,shortcuts:[(0,k.pi)((0,k.pi)({type:6,label:this.hostServices.getLocalizedString("Background_Color")},ve.t.values.backColor),{selector:se}),(0,k.pi)((0,k.pi)({type:6,label:this.hostServices.getLocalizedString("Visual_FontColor")},ve.t.values.fontColor),{selector:se}),(0,k.pi)((0,k.pi)({type:6,label:this.hostServices.getLocalizedString("Visual_ConditionalFormatting_DataBars")},ve.t.columnFormatting.dataBars),{selector:O?this.tablixPropertyManager.getConditionalFormattingSelector(l.Y.TableEx,O.metadata,!1):void 0}),(0,k.pi)((0,k.pi)({type:6,label:this.hostServices.getLocalizedString("Visual_Tablix_Icons")},ve.t.values.icon),{selector:se}),{type:7},{type:1,destinationInfo:(0,k.pi)((0,k.pi)({},ve.t.values.backColor),{selector:se}),label:this.hostServices.getLocalizedString("Format_Cell_Elements")}],label:this.hostServices.getLocalizedString("Format_AddCellElements")})}return te.unshift({type:0}),te}}},y.prototype.onDataViewObjectChanged=function(r,c){if(!this.supportsOnObject||!this.formatMode||1!==c)return r;for(var v={objectName:"columnFormatting",propertyName:"styleValues"},P={objectName:"columnFormatting",propertyName:"backColor"},E={objectName:"columnFormatting",propertyName:"fontColor"},O={objectName:"columnFormatting",propertyName:"alignment"},G=[],re=0,te=r;re<te.length;re++){var oe=te[re].selector;if(oe&&oe.metadata){var he=this.formattingProperties.columnFormatting[oe.metadata],ge=he.styleValues||he.styleHeader||he.styleTotal;G.push(ue.v.create(P,ge).onToggleEnabled(J.W.createBooleanDataViewObjectChange(v,!0,{selector:oe})),ue.v.create(E,ge).onToggleEnabled(J.W.createBooleanDataViewObjectChange(v,!0,{selector:oe})),ue.v.create(O,ge).onToggleEnabled(J.W.createBooleanDataViewObjectChange(v,!0,{selector:oe})))}}return ee.o.applyDataViewObjectsBehaviorChanges(r,ee.o.getDataViewObjectsBehaviorChanges(r,G))},y}()}}]);