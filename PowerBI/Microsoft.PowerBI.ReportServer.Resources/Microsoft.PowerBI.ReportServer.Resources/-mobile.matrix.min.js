"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([["matrix"],{93023:function(st,J,x){x.r(J),x.d(J,{Matrix:function(){return n}});var Z=x(54522),O=x(28579),N=x(62458),G=x(46135),S=x(99318),j=x(16324),B=x(93340),U=x(71090),F=x(73889),q=x(81671),f=x(93414),d=x(74304),e=x(93568),a=x(13375),n=function(){function u(o){this.isTouchDisabled=o&&o.isTouchDisabled}return u.prototype.init=function(o){this.element=o.element,this.style=o.style,this.updateViewport(o.viewport),this.isInteractive=o.interactivity&&null!=o.interactivity.selection,this.hostServices=o.host,this.persistingObjects=!1,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1,this.tablixPropertyManager=new d.U(this.style)},u.getFormattingProperties=function(o,l){return N.fF.assertValue(o,"dataView"),l.getMatrixObjects(o)},u.prototype.onResizing=function(o){this.updateViewport(o)},u.prototype.getColumnWidthManager=function(){return this.columnWidthManager},u.prototype.onDataChanged=function(o){N.fF.assertValue(o,"options");var l=o.dataViews;if(l&&l.length>0){var c=this.dataView;this.dataView=l[0];var p=u.getFormattingProperties(this.dataView,this.tablixPropertyManager);this.formatters=p.formatters;var h=p.general.textSize;o.operationKind===G.su.Append?(this.createOrUpdateHierarchyNavigator(c.matrix.rows.root!==this.dataView.matrix.rows.root),this.tablixControl.updateModels(!1,this.hierarchyNavigator.getRowHierarchy().root.children,this.hierarchyNavigator.getColumnHierarchy().root.children),this.refreshControl(!1)):(this.createOrUpdateHierarchyNavigator(!0),this.createColumnWidthManager(),this.createTablixControl(p),this.tablixControl.getBinder().onDataViewChanged(p),this.updateInternal(h,c))}this.waitingForData=!1,this.waitingForSort=!1},u.prototype.createColumnWidthManager=function(){var o=this,l=this.hierarchyNavigator.getColumnHierarchy();this.columnWidthManager?this.persistingObjects||this.columnWidthManager.updateDataView(this.dataView,l.leafNodes):this.columnWidthManager=new q.K(this.dataView,!0,function(c){return o.persistColumnWidths(c)},l.leafNodes)},u.prototype.persistColumnWidths=function(o){this.persistingObjects=!0,this.hostServices.persistProperties(o)},u.prototype.updateViewport=function(o){this.currentViewport=o,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},u.prototype.refreshControl=function(o){(this.element.is(":visible")||1===this.getLayoutKind())&&this.tablixControl.refresh(o)},u.prototype.getLayoutKind=function(){return this.isInteractive?0:1},u.prototype.createOrUpdateHierarchyNavigator=function(o){var l=!this.dataView.metadata.segment;if(this.tablixControl)this.hierarchyNavigator.update(this.dataView.matrix,!1,!1,!1,l,o,this.formatters);else{var c=(0,a.aD)(this.dataView.matrix,l,this.formatters,this.hostServices.getLocalizedString("ListJoin_Separator"),this.tablixPropertyManager.tablixProperties,this.hostServices);this.hierarchyNavigator=c}},u.prototype.createTablixControl=function(o){this.tablixControl||(this.tablixControl=this.createControl(this.hierarchyNavigator,o.general.textSize)),this.tablixControl.wordWrapRowHeaders=o.rowHeaders.wordWrap},u.prototype.createControl=function(o,l){var c=this,p=this.getLayoutKind(),h={onBindRowHeader:function(t){c.onBindRowHeader(t)},totalLabel:this.hostServices.getLocalizedString(U.qT),onColumnHeaderClick:function(t,v){return c.onColumnHeaderClick(t,v)},showSortIcons:0===p,tablixProperties:this.tablixPropertyManager.tablixProperties},b=new e.$H(this.hierarchyNavigator,h),H=1===p?j.dk.createLayoutManager(b):j.Vz.createLayoutManager(b,this.columnWidthManager),P=document.createElement("div");this.element.append(P);var s={interactive:this.isInteractive,enableTouchSupport:!this.isTouchDisabled,layoutKind:p,fontSize:d.U.getTextSizeInPx(l)};return new f.d(o,H,b,P,s)},u.prototype.updateInternal=function(o,l){var c=this;1===this.getLayoutKind()&&this.tablixControl.layoutManager.adjustContentSize((0,Z.Gr)(this.dataView)),this.tablixControl.fontSize=d.U.getTextSizeInPx(o),this.verifyHeaderResize(),this.tablixControl.updateModels(!this.persistingObjects,this.hierarchyNavigator.getRowHierarchy().root.children,this.hierarchyNavigator.getColumnHierarchy().root.children),this.tablixControl.viewport=this.currentViewport;var p=this.shouldClearControl(l,this.dataView);setTimeout(function(){c.refreshControl(p);var h=c.columnWidthManager.onColumnsRendered(c.tablixControl.layoutManager.columnWidthsToPersist);c.persistingObjects&&!h&&(c.persistingObjects=!1)},0)},u.prototype.shouldClearControl=function(o,l){return!(this.waitingForSort&&o&&l&&(0,S.C0)(o.metadata,l.metadata))},u.prototype.onBindRowHeader=function(o){this.needsMoreData(o)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},u.prototype.onColumnHeaderClick=function(o,l){this.waitingForSort=!0,this.hostServices.onCustomSort((0,B.Av)(o,l))},u.prototype.needsMoreData=function(o){if(this.waitingForData||!this.hierarchyNavigator.isLeaf(o)||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var c=this.tablixControl.rowDimension.getItemsCount()*U.sR;return this.hierarchyNavigator.getLeafIndex(o)>=c},u.prototype.enumerateObjectInstances=function(o){var l=new O.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(o,l,this.dataView,F.Y.Matrix),l.complete()},u.prototype.enumerateObjectRepetition=function(){var o=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(o,this.dataView,F.Y.Matrix),o},u.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},u.prototype.onViewModeChanged=function(o){this.tablixControl&&this.tablixControl.toggleTouchBindings(1!==o),this.updateViewport(this.currentViewport)},u.prototype.verifyHeaderResize=function(){var o=this.shouldAllowHeaderResize();o!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=o,this.tablixControl.layoutManager.setAllowHeaderResize(o))},u}()},93568:function(st,J,x){x.d(J,{$H:function(){return P},B0:function(){return n},aV:function(){return u},cP:function(){return o},qW:function(){return H}});var Z=x(1521),O=x(79154),N=x(54522),G=x(55007),S=x(40550),j=x(62458),B=x(32041),U=x(64329),F=x(48066),q=x(66001),f=x(93340),d=x(71090),e=x(13375),a=x(64067);function n(s,r,t,v,i,C,g,y){var m,E,w,L,T;void 0===C&&(C=!1),void 0===g&&(g=!1);var R=i.grid,V=i.rowHeaders,M=i.values,W=i.columnHeaders,I=null!==(m=i.grandTotal)&&void 0!==m?m:i.rowGrandTotal,tt=i.subtotals||{},K=i.rowSubtotals||{},A=null!==(E=V.outlineWeight)&&void 0!==E?E:R.outlineWeight,D=null!==(w=V.outlineColor)&&void 0!==w?w:R.outlineColor;t.paddings.top=t.paddings.bottom=R.rowPadding;var z=e.hc.isNodeGrandTotal(r);t.borders.top=new f.om,(s.row.isFirst&&!v||v&&0===r.leafIndex)&&(t.borders.top.applyParams((0,S.yo)(V.outline),A,D,f.Pb.Outline),!(0,S.yo)(V.outline)&&(0,S.yo)(M.outline)&&(t.paddings.top+=A)),t.borders.bottom=new f.om,s.row.isLast&&(!v||v&&s.column.isLast&&!i.general.rowSubtotals)||v&&s.row.isFirst&&r.isSubtotal?(t.borders.bottom.applyParams((0,S.mv)(V.outline),A,D,f.Pb.Outline),!(0,S.mv)(V.outline)&&(0,S.mv)(M.outline)&&(t.paddings.bottom+=A)):t.borders.bottom.applyParams(R.gridHorizontal,R.gridHorizontalWeight,R.gridHorizontalColor,f.Pb.Gridline),t.borders.left=new f.om,(v||s.column.isFirst)&&(t.borders.left.applyParams((0,S.fs)(V.outline),A,D,f.Pb.Outline),!(0,S.fs)(V.outline)&&(0,S.fs)(W.outline)&&(t.paddings.left+=A)),t.borders.right=new f.om;var et=v||s.column.isLast;if(et?t.borders.right.applyParams((0,S.BK)(V.outline),A,D,f.Pb.Outline):t.borders.right.applyParams(R.gridVertical,R.gridVerticalWeight,R.gridVerticalColor,f.Pb.Gridline),r.isBlankRow&&c(t,i),I.applyToHeaders&&z)t.fontColor=I.fontColor||V.fontColor,t.backColor=I.backColor||V.backColor;else{var Y=C&&(M.fontColorPrimary!==M.fontColorSecondary||M.backColorPrimary!==M.backColorSecondary)&&(g||et),Q=null!==(L=K.fontColor)&&void 0!==L?L:tt.fontColor,at=Y&&!(r.hasSubtotalStyle&&Q)&&!(z&&I.fontColor),ot=null!==(T=K.backColor)&&void 0!==T?T:tt.backColor,lt=Y&&!(r.hasSubtotalStyle&&ot)&&!(z&&I.backColor),ut=void 0;(at||lt)&&(ut=y??p(r.position,i.general,ot)),t.fontColor=at?h(ut,M):V.fontColor,t.backColor=r.isBlankRow?l(r.isBlankRow,i):lt?b(ut,M):V.backColor}}function u(s,r,t,v){var i,C,g,y,m,E=v.grid,w=v.columnHeaders,L=v.values,T=null!==(i=v.grandTotal)&&void 0!==i?i:v.columnGrandTotal,R=null!==(C=w.outlineWeight)&&void 0!==C?C:E.outlineWeight,V=null!==(g=w.outlineColor)&&void 0!==g?g:E.outlineColor,M=v.columnFormatting[r.queryName],W=null===(m=null===(y=v.annotationFormatting)||void 0===y?void 0:y.columnHeaders)||void 0===m?void 0:m[r.queryName],I=e.hc.isNodeGrandTotal(r);t.fontColor=M&&M.styleHeader&&M.fontColor?M.fontColor:T.applyToHeaders&&I&&T.fontColor||w.fontColor,t.backColor=W&&W.backColor?W.backColor:M&&M.styleHeader&&M.backColor?M.backColor:T.applyToHeaders&&I&&T.backColor||w.backColor,W&&W.bold&&(t.fontWeight=O.en),t.paddings.top=t.paddings.bottom=E.rowPadding,t.borders.top=new f.om,s.row.isFirst&&t.borders.top.applyParams((0,S.yo)(w.outline),R,V,f.Pb.Outline),t.borders.bottom=new f.om,s.row.isLast?t.borders.bottom.applyParams((0,S.mv)(w.outline),R,V,f.Pb.Outline):t.borders.bottom.applyParams(E.gridHorizontal,E.gridHorizontalWeight,E.gridHorizontalColor,f.Pb.Gridline),t.borders.left=new f.om,s.column.isFirst&&!(0,S.fs)(w.outline)&&(0,S.fs)(L.outline)&&(t.paddings.left+=R),t.borders.right=new f.om,s.column.isLast?(t.borders.right.applyParams((0,S.BK)(w.outline),R,V,f.Pb.Outline),!(0,S.BK)(w.outline)&&(0,S.BK)(L.outline)&&(t.paddings.right+=R)):t.borders.right.applyParams(E.gridVertical,E.gridVerticalWeight,E.gridVerticalColor,f.Pb.Gridline)}function o(s,r,t,v,i,C){var g,y,m,E,w,L,T,R,V,M=i.grid,W=i.values,I=i.rowHeaders,tt=i.columnHeaders,K=i.rowSubtotals||{},A=i.columnSubtotals||{},D=i.subtotals||{},z=null!==(g=W.outlineWeight)&&void 0!==g?g:M.outlineWeight,et=null!==(y=W.outlineColor)&&void 0!==y?y:M.outlineColor;t.paddings.top=t.paddings.bottom=M.rowPadding,t.borders.top=new f.om,s.row.isFirst&&(t.borders.top.applyParams((0,S.yo)(W.outline),z,et,f.Pb.Outline),!(0,S.yo)(W.outline)&&(0,S.yo)(I.outline)&&(t.paddings.top+=z)),t.borders.bottom=new f.om,s.row.isLast&&(!v||v&&!i.general.rowSubtotals)||v&&r.isRowGrandTotal?(t.borders.bottom.applyParams((0,S.mv)(W.outline),z,et,f.Pb.Outline),!(0,S.mv)(W.outline)&&(0,S.mv)(I.outline)&&(t.paddings.bottom+=z)):t.borders.bottom.applyParams(M.gridHorizontal,M.gridHorizontalWeight,M.gridHorizontalColor),t.borders.left=new f.om,s.column.isFirst&&t.borders.left.applyParams((0,S.fs)(W.outline),z,et,f.Pb.Outline),t.borders.right=new f.om,s.column.isLast?(t.borders.right.applyParams((0,S.BK)(W.outline),z,et,f.Pb.Outline),!(0,S.BK)(W.outline)&&(0,S.BK)(tt.outline)&&(t.paddings.right+=z)):t.borders.right.applyParams(M.gridVertical,M.gridVerticalWeight,M.gridVerticalColor,f.Pb.Gridline),null!==(m=r.rowItem)&&void 0!==m&&m.isBlankRow&&c(t,i);var Y,Q,rt,X,k=r.columnMetadata&&i.columnFormatting[r.columnMetadata.queryName];k&&(r.isGrandTotal?(Q=k.styleTotal&&k.fontColor,Y=k.styleTotal&&k.backColor):r.hasSubtotalStyle?(Q=k.styleSubTotals&&k.fontColor,Y=k.styleSubTotals&&k.backColor):(Q=k.styleValues&&k.fontColor,Y=k.styleValues&&k.backColor)),r.hasColumnSubtotalStyle?(rt=null!==(E=A.fontColor)&&void 0!==E?E:D.fontColor,X=null!==(w=A.backColor)&&void 0!==w?w:D.backColor):r.hasRowSubtotalStyle?(rt=null!==(L=K.fontColor)&&void 0!==L?L:D.fontColor,X=null!==(T=K.backColor)&&void 0!==T?T:D.backColor):(rt=D.fontColor,X=D.backColor);var at=C??p(r.position,i.general,X??K.backColor),ot=h(at,W),it=b(at,W),nt=l(null===(R=r.rowItem)||void 0===R?void 0:R.isBlankRow,i);if(r.isGrandTotal){var lt=null!==(V=i.grandTotal)&&void 0!==V?V:r.isColumnGrandTotal?i.columnGrandTotal:i.rowGrandTotal;t.fontColor=r.fontColor||Q||lt.fontColor||rt||ot,t.backColor=r.backColor||Y||lt.backColor||X||nt||it}else r.hasSubtotalStyle?(t.fontColor=r.fontColor||Q||rt||ot,t.backColor=r.backColor||Y||X||nt||it):(t.fontColor=r.fontColor||Q||ot,t.backColor=r.backColor||Y||nt||it)}function l(s,r){var t,v,i;if(s){var C=null===(t=r.blankRows)||void 0===t?void 0:t.blankRowTransparency;i=null===(v=r.blankRows)||void 0===v?void 0:v.blankRowColor,null!=C&&(i=(0,Z.Et)(i,(0,a.TD)(C)))}return i}function c(s,r){var t,v,i,C,g;if(null!==(t=r?.blankRows)&&void 0!==t&&t.showBorder){var y=null===(v=r?.blankRows)||void 0===v?void 0:v.borderPosition,m=null===(i=r?.blankRows)||void 0===i?void 0:i.borderWidth,E=null===(C=r?.blankRows)||void 0===C?void 0:C.borderTransparency,w=null===(g=r?.blankRows)||void 0===g?void 0:g.borderColor;null!=w&&null!=E&&(w=(0,Z.Et)(w,(0,a.TD)(E))),("Top"===y||"TopAndBottom"===y)&&(s.borders.top.color=w,s.borders.top.weight=m),("Bottom"===y||"TopAndBottom"===y)&&(s.borders.bottom.color=w,s.borders.bottom.weight=m)}}function p(s,r,t){var v;return(v=r.rowSubtotals&&t?s.row.indexInSiblings:s.row.index)<0||v%2==0}function h(s,r){return s?r.fontColorPrimary:r.fontColorSecondary}function b(s,r){return s?r.backColorPrimary:r.backColorSecondary}function H(s,r,t,v){var i,C,g=v.grid,y=v.columnHeaders,m=v.rowHeaders,E=null!==(i=y.outlineWeight)&&void 0!==i?i:g.outlineWeight,w=null!==(C=y.outlineColor)&&void 0!==C?C:g.outlineColor;r.fontColor=y.fontColor||m.fontColor,r.backColor=y.backColor||m.backColor,r.paddings.top=r.paddings.bottom=g.rowPadding,r.borders.top=new f.om,s.row.isFirst&&r.borders.top.applyParams((0,S.yo)(y.outline),E,w,f.Pb.Outline),r.borders.bottom=new f.om,s.row.isLast?r.borders.bottom.applyParams((0,S.mv)(y.outline),E,w,f.Pb.Outline):r.borders.bottom.applyParams(g.gridHorizontal,g.gridHorizontalWeight,g.gridHorizontalColor,f.Pb.Gridline),r.borders.left=new f.om,(s.column.isFirst||t)&&(r.borders.left.applyParams((0,S.fs)(y.outline),E,w,f.Pb.Outline),!(0,S.fs)(y.outline)&&(0,S.fs)(m.outline)&&(r.paddings.left+=E)),r.borders.right=new f.om,r.borders.right.applyParams(g.gridVertical,g.gridVerticalWeight,g.gridVerticalColor,f.Pb.Gridline)}var P=function(){function s(r,t){this.hierarchyNavigator=r,this.options=t}return s.prototype.onDataViewChanged=function(r){this.formattingProperties=r,this.updateTextHeights()},s.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:d.F2,fontSize:U.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(B.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:d.dG,fontSize:U.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(B.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:d.Zk,fontSize:U.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(B.b.measureSvgTextHeight(this.textPropsTotal,"a"))},s.prototype.onStartRenderingSession=function(){},s.prototype.onEndRenderingSession=function(){},s.prototype.bindRowHeader=function(r,t){(0,f.ey)(t);var v=this.options.tablixProperties,i=new f.qZ;this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(r)&&((0,f.R5)(t,d.Eo),i.borders.right=new f.om(G.FX.PropGridOutlineWeight.defaultValue,v.PropGridOutlineColor.getValue(null))),r.isSubtotal&&(i.paddings.left=d.P$),t.contentWidth=0,this.bindHeader(r,t,t.extension.contentHost,this.hierarchyNavigator.getRowHeaderMetadataColumn(r),i),t.contentWidth=Math.ceil(t.contentWidth),this.options.onBindRowHeader&&this.options.onBindRowHeader(r),n(t.position,r,i,!1,this.formattingProperties),t.applyStyle(i)},s.prototype.unbindRowHeader=function(r,t){(0,f.G9)(t),(0,f.aP)(t)},s.prototype.bindColumnHeader=function(r,t){(0,f.ey)(t);var v=new f.qZ,i=this.options.tablixProperties,C=!1,g=t.extension.contentHost;if((g=(0,f.Ch)(g)).classList.add(d.WA),t.contentWidth=0,this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(r)){if(v.borders.bottom=new f.om(G.FX.PropGridOutlineWeight.defaultValue,i.PropGridOutlineColor.getValue(null)),(0,f.R5)(t,d.mQ),(0,f.R5)(t,d.s0),this.options.showSortIcons){var m=this.getSortableHeaderColumnMetadata(r);m&&(this.registerColumnHeaderClickHandler(m,t),g=(0,f.D6)(m.sort,g),m.sort&&(t.contentWidth=this.fontSizeHeader+d.fG))}r.isSubtotal&&r.parent&&r.parent.children.length>1&&r.parent.children[0].isSubtotal&&(C=!0)}t.extension.disableDragResize(),this.bindHeader(r,t,g,this.hierarchyNavigator.getColumnHeaderMetadataColumn(r),v,C),t.contentWidth=Math.ceil(t.contentWidth),u(t.position,r,v,this.formattingProperties),t.applyStyle(v)},s.prototype.unbindColumnHeader=function(r,t){(0,f.G9)(t),(0,f.aP)(t),this.getSortableHeaderColumnMetadata(r)&&this.unregisterColumnHeaderClickHandler(t),this.options.showSortIcons&&(0,f.Y4)(t)},s.prototype.bindHeader=function(r,t,v,i,C,g){(0,f.R5)(t,d.f),C.fontFamily=d.F2,C.fontColor=d.lN;var y=this.formattingProperties.grid.imageHeight;if(t.contentHeight=(0,N.pt)(i)?y:r.hasSubtotalStyle?this.textHeightTotal:this.textHeightValue,r.hasSubtotalStyle&&((0,f.R5)(t,d.R9),C.fontFamily=d.Zk),r.isSubtotal&&!g)return(0,f.DM)(this.options.totalLabel,v,t.extension.contentHost),void(t.contentWidth=B.b.measureSvgTextWidth(this.textPropsTotal,this.options.totalLabel));var m=this.getHeaderLabel(r);if(m)return(0,f.MN)(i,m)!==F.av.NONE?((0,f.vU)(m,v),void(t.contentWidth+=B.b.measureSvgTextWidth(this.textPropsHeader,m))):(0,N.pt)(i)&&(0,F.gU)(m)?((0,f.Hx)(r.valueFormatted,v,y),void(t.contentWidth+=y*d.wd)):((0,f.DM)(m,v,t.extension.contentHost),void(t.contentWidth+=B.b.measureSvgTextWidth(r.hasSubtotalStyle?this.textPropsTotal:this.textPropsHeader,m)));v.innerHTML=d.jv},s.prototype.applyWordWrapping=function(r,t){if(j.fF.assertValue(t,"applyWordWrapping - Undefined cell"),j.fF.assert(function(){return null!=t.containerWidth&&-1!==t.containerWidth},"applyWordWrapping - Undefined width"),j.fF.assert(function(){return null!=t.containerHeight&&-1!==t.containerHeight},"applyWordWrapping - Undefined height"),1===t.type){var v=this.hierarchyNavigator.getRowHeaderMetadataColumn(r);if(!(0,N.cR)(v)&&!(0,N.pt)(v)){var i=t.extension.contentHost;(0,f.D4)(i);var C=r.valueFormatted,g=new f.qZ;n(r.position,r,g,!1,this.formattingProperties);for(var y=t.containerWidth-(g.getExtraRight()+g.getExtraLeft()),m=t.containerHeight-(g.getExtraTop()+g.getExtraBottom()),E=Math.floor(m/this.textHeightHeader),L=0,T=(0,q.ql)(C,this.textPropsHeader,B.b.measureSvgTextWidth,y,E,null,!0);L<T.length;L++)(0,f.Ch)(i,T[L])}}},s.prototype.registerColumnHeaderClickHandler=function(r,t){var v=this;this.options.onColumnHeaderClick&&t.extension.registerClickHandler(function(g){if((0,f.xl)(g)){var y=(0,f.x7)(r.sort);v.options.onColumnHeaderClick(r.queryName?r.queryName:r.displayName,y)}})},s.prototype.unregisterColumnHeaderClickHandler=function(r){this.options.onColumnHeaderClick&&r.extension.unregisterClickHandler()},s.prototype.bindBodyCell=function(r,t){(0,f.ey)(t);var v=new f.qZ;t.contentHeight=this.textHeightValue;var i=r.kpiContent;if(i)$(t.extension.contentHost).append(i),t.contentWidth=this.fontSizeValue;else{var C=this.textPropsValue;(0,f.R5)(t,d.s0),r.isTotal&&((0,f.R5)(t,d.R9),v.fontFamily=d.Zk,t.contentHeight=this.textHeightTotal,C=this.textPropsTotal);var g=r.textContent;g&&((0,f.DM)(g,t.extension.contentHost),t.contentWidth=B.b.measureSvgTextWidth(C,g))}t.contentWidth=Math.ceil(t.contentWidth),o(t.position,r,v,!1,this.formattingProperties),t.applyStyle(v)},s.prototype.unbindBodyCell=function(r,t){(0,f.G9)(t),(0,f.aP)(t)},s.prototype.bindCornerCell=function(r,t){(0,f.ey)(t);var v=this.options.tablixProperties,i=new f.qZ;i.fontFamily=d.F2,i.fontColor=d.lN,t.contentHeight=this.textHeightHeader,t.contentWidth=0;var C=t.extension.contentHost;if((C=(0,f.Ch)(C)).classList.add(d.WA),r.isColumnHeaderLeaf&&((0,f.R5)(t,d.mQ),i.borders.bottom=new f.om(G.FX.PropGridOutlineWeight.defaultValue,v.PropGridOutlineColor.getValue(null)),this.options.showSortIcons)){var g=this.getSortableCornerColumnMetadata(r);g&&(this.registerColumnHeaderClickHandler(g,t),C=(0,f.D6)(g?g.sort:void 0,C),g.sort&&(t.contentWidth=this.fontSizeHeader+d.fG))}(0,f.DM)(r.displayName,C,t.extension.contentHost),t.contentWidth+=B.b.measureSvgTextWidth(this.textPropsHeader,r.displayName),t.contentWidth=Math.ceil(t.contentWidth),r.isRowHeaderLeaf&&(0,f.R5)(t,d.Eo),(0,f.R5)(t,d.f),H(t.position,i,!1,this.formattingProperties),t.applyStyle(i),t.extension.disableDragResize()},s.prototype.unbindCornerCell=function(r,t){(0,f.G9)(t),(0,f.aP)(t),this.options.showSortIcons&&(0,f.Y4)(t),r.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(t)},s.prototype.bindEmptySpaceHeaderCell=function(r){},s.prototype.unbindEmptySpaceHeaderCell=function(r){},s.prototype.bindEmptySpaceFooterCell=function(r){},s.prototype.unbindEmptySpaceFooterCell=function(r){},s.prototype.getHeaderLabel=function(r){return r.valueFormatted},s.prototype.getCellContent=function(r){return r.textContent||""},s.prototype.hasRowGroups=function(){var r=this.hierarchyNavigator.getRowHierarchy();return!(!r||!r.levels||0===r.levels.length)},s.prototype.getSortableCornerColumnMetadata=function(r){if(r.isColumnHeaderLeaf)return r.metadata},s.prototype.getSortableHeaderColumnMetadata=function(r){var t=this.hierarchyNavigator.getRowHierarchy();if(!t||!t.levels||0===t.levels.length)return null;var v=this.hierarchyNavigator.getValueSources(),i=v&&v.length>1,C=this.hierarchyNavigator.getColumnHierarchy(),g=C?C.levels.length:0;i?g--:1===g&&C.levels[0]&&C.levels[0].sources&&C.levels[0].sources[0]&&C.levels[0].sources[0].roles&&C.levels[0].sources[0].roles.Values&&(g=0);var y=-1;return 0===g?y=r.levelSourceIndex:r.isSubtotal&&(i?r.parent&&0===r.parent.level&&(y=r.levelSourceIndex):0===r.level&&(y=r.levelSourceIndex)),-1!==y?v[y=y||0]:null},s}()},13375:function(st,J,x){x.d(J,{aD:function(){return q},hc:function(){return f}});var Z=x(81337),O=x(62458),N=x(39681),G=x(38078),S=x(93340),j=x(29043),B=x(66842),U=x(40845),F=function(d){function e(a,n,u,o,l,c,p,h){var H,P,s,r,b=this;if(u)for(s=u;s.parent;)s=s.parent;if(o)for(r=o;r.parent;)r=r.parent;var t=r&&!!r.isSubtotal,v=!t&&o&&!!o.isSubtotal,i=s&&!!s.isSubtotal,C=!i&&u&&!!u.isSubtotal,g=u.isBlankRow;return _.isString(a)&&!(null===(P=null===(H=l?.type)||void 0===H?void 0:H.misc)||void 0===P)&&P.sparkline&&(a=(0,j.th)(a,c)),(b=d.call(this,a,n,C,v,i,t,g,l,p,h,0)||this).rowItem=u,b.columnItem=o,b.hasRowSubtotalStyle=u&&u.hasSubtotalStyle,b.hasColumnSubtotalStyle=o&&o.hasSubtotalStyle,b.hasSubtotalStyle=b.hasRowSubtotalStyle||b.hasColumnSubtotalStyle,b}return(0,Z.ZT)(e,d),Object.defineProperty(e.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(S.jG);function q(d,e,a,n,u,o,l,c,p,h){void 0===l&&(l=!0);var b=new f(n,u,o,h,!0);return l&&b.update(d,!1,!1,!1,e,!0,a,c,p,void 0,void 0,!1),b}var f=function(){function d(e,a,n,u,o){this.tablixProperties=a,this.hostServices=n,this.expandCompositeHierarchy=u,this.modernRowHeaderStyle=o,this.compositeGroupSeparator=e}return d.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},d.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},d.prototype.getLeafCount=function(e){var a=this.getMatrixHierarchy(e);return a?a.leafNodes.length:0},d.prototype.getLeafAt=function(e,a){var n=this.getMatrixHierarchy(e);return n?n.leafNodes[a]:null},d.prototype.getLeafIndex=function(e){return O.fF.assertValue(e,"item"),e.leafIndex},d.prototype.getParent=function(e){return O.fF.assertValue(e,"item"),0===e.level?null:e.parent},d.prototype.getIndex=function(e){return O.fF.assertValue(e,"item"),e?e.index:-1},d.prototype.isLeaf=function(e){return O.fF.assertValue(e,"item"),!e.children||0===e.children.length},d.prototype.isRowHierarchyLeaf=function(e){return!0},d.prototype.isColumnHierarchyLeaf=function(e){return!1},d.prototype.isFirstItem=function(e,a){return e===_.head(a)},d.prototype.areAllParentsFirst=function(e,a){if(!e)return!1;var n=this.getParent(e);return n?this.isFirstItem(e,e.siblings)&&this.areAllParentsFirst(n,n.siblings):this.isFirstItem(e,e.siblings)},d.prototype.isLastItem=function(e,a){if(O.fF.assertValue(e,"item"),e!==_.last(a))return!1;if(!this.isItemRow(e)||this.isDataComplete)return!0;for(var n=e.parent;n;){if(n!==_.last(n.siblings))return!0;n=n.parent}return!1},d.prototype.isItemRow=function(e){if(!e)return!1;for(var a=e;a.parent;)a=a.parent;return a.siblings===this.rowHierarchy.root.children},d.prototype.areAllParentsLast=function(e,a){if(!e)return!1;var n=this.getParent(e);return n?this.isLastItem(e,e.siblings)&&this.areAllParentsLast(n,n.siblings):this.isLastItem(e,e.siblings)},d.prototype.getChildren=function(e){return O.fF.assertValue(e,"item"),e.children},d.prototype.getChildrenLevelDifference=function(e){var a=1/0,n=this.getChildren(e);if(!_.isEmpty(n))for(var u=0,o=n.length;u<o;u++)a=Math.min(a,n[u].level-e.level);return a},d.prototype.getCount=function(e){return O.fF.assertValue(e,"items"),e.length},d.prototype.getAt=function(e,a){return O.fF.assertValue(e,"items"),e[a]},d.prototype.getLevel=function(e){return O.fF.assertValue(e,"item"),e.level},d.prototype.getRowLeafIndex=function(e){return this.isSteppedLayout&&e.isSubtotal?e.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?e.parent.leafIndex:e.leafIndex:this.valuesOnRow?e.levelSourceIndex:-1:e.leafIndex},d.prototype.getIntersection=function(e,a){O.fF.assertValue(e,"rowItem"),O.fF.assertValue(a,"columnItem");var n,o,u=a.leafIndex;if(n=e.values?e.values[a.leafIndex]:void 0){var l=this.valueSources[n.valueSourceIndex||0],c=l.queryName;o=new F(n.value,n.objects,e,a,l,this.hostServices,this.formatters[c],this.tooltipFormatters[c])}else o=new F(void 0,void 0,e,a,void 0,this.hostServices,void 0,void 0);var b=this.getRowLeafIndex(e);return o.position.row.index=b,o.position.row.indexInSiblings=e.siblings.indexOf(e),o.position.row.isFirst=0===b,o.position.row.isLast=this.isDataComplete&&b===this.rowHierarchy.leafNodes.length-1,o.position.column.index=u,o.position.column.indexInSiblings=a.siblings.indexOf(a),o.position.column.isFirst=0===u,o.position.column.isLast=u===this.columnHierarchy.leafNodes.length-1,n&&n.objects&&(o.backColor=(0,G.HZ)(this.tablixProperties.PropValuesBackColor.getValue(n.objects)),o.fontColor=(0,G.HZ)(this.tablixProperties.PropValuesFontColor.getValue(n.objects))),o},d.prototype.getCorner=function(e,a){O.fF.assert(function(){return e>=0},"rowLevel"),O.fF.assert(function(){return a>=0},"columnLevel");var o,n=this.columnHierarchy.levels,u=this.rowHierarchy.levels;if((a===n.length-1||0===n.length)&&(o=u[e])){var l=e===u.length-1,c=this.valuesOnRow&&l;return{metadata:1===o.sources.length||o.sources.length>1&&c?o.sources[0]:null,displayName:c?"":_.map(o.sources,function(b){return b.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:l,position:this.calculateCornerCellPosition(e,a),rowLevel:e,columnLevel:a}}if(e===u.length-1&&(o=n[a])){var h=o.sources.filter(function(H){return!H.isMeasure});return{metadata:1===o.sources.length?o.sources[0]:null,displayName:_.map(h,function(H){return H.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(e,a),rowLevel:e,columnLevel:a}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(e,a),rowLevel:e,columnLevel:a}},d.prototype.calculateCornerCellPosition=function(e,a){var n=new S.ri,u=a;n.row.index=n.row.indexInSiblings=u,n.row.isFirst=0===u;var o=this.getColumnHierarchyDepth();n.row.isLast=a===o-1;var l=e;n.column.index=n.column.indexInSiblings=l,n.column.isFirst=0===l;var c=this.getRowHierarchyDepth();return n.column.isLast=l===c-1,n},d.prototype.headerItemEquals=function(e,a){return!(!e||!a)&&e===a},d.prototype.bodyCellItemEquals=function(e,a){return e.position.isMatch(a.position)},d.prototype.cornerCellItemEquals=function(e,a){return!(!e||!a)&&e.displayName===a.displayName&&e.isColumnHeaderLeaf===a.isColumnHeaderLeaf&&e.isRowHeaderLeaf===a.isRowHeaderLeaf&&e.metadata===a.metadata},d.prototype.getColumnHierarchy=function(){return this.columnHierarchy},d.prototype.getRowHierarchy=function(){return this.rowHierarchy},d.prototype.getValueSources=function(){return this.valueSources},d.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},d.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},d.prototype.update=function(e,a,n,u,o,l,c,p,h,b,H,P){var s=this;O.fF.assertValue(e,"matrix"),this.isSteppedLayout=a,this.valuesOnRow=n,this.areRowSubtotalsBefore=u,this.isDataComplete=o,this.valueSources=e.valueSources,this.formatters=c,this.tooltipFormatters=p||{},this.subtotalByColumn=h||{},this.multipleValueSources=e.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(e.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,P,b,H),(l=l||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(e.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,H,this.areRowSubtotalsBefore,function(r,t){return s.calculateRowHeaderPosition(r,t)}),l&&(this.updateHierarchy(this.columnHierarchy,!1,H,!1,function(r,t){return s.calculateColumnHeaderPosition(r,t)}),this.updateStaticColumnHeaders(this.columnHierarchy))},d.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},d.prototype.removeValueNodesFromColumnHierarchy=function(e){O.fF.assertValue(e,"nodes");for(var a=0,n=e;a<n.length;a++){var u=n[a];if(!u.parent&&this.isLeaf(u))return e.length=0,void e.push({level:0});this.isLeaf(u.children[0])?u.children=void 0:this.removeValueNodesFromColumnHierarchy(u.children)}},d.prototype.addValueNodesToRowHierarchy=function(e,a){for(var n=this.getRowHierarchyDepth(),u=this.valueSources.length,o=e.length,l=0;l<o;l++){var c=e[l];if(this.isLeaf(c)){var p=void 0,h=void 0,b=void 0;if(this.isSteppedLayout&&c.isSubtotal||!a?(e.splice(l,1),p=e,h=l,b=c.level,o=o-1+u,l=l-1+u):(c.children=[],p=c.children,h=0,b=n),!c.isBlankRow)for(var H=0;H<u;H++){var P=this.createRowValueNode(H,u,c,b);p.splice(h++,0,P)}c.values=null}else this.addValueNodesToRowHierarchy(c.children,a)}},d.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},d.prototype.createRowValueNode=function(e,a,n,u){var o={level:u,levelSourceIndex:e,isSubtotal:n.isSubtotal,hasSubtotalStyle:!!n.hasSubtotalStyle,values:{}},l=0,c=0;for(var p in n.values)l%a===e&&(o.values[c++]=n.values[l]),l++;return o},d.prototype.createBlankRowValueNode=function(e){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(e),function(n){return n.valueSourceIndex}).map(function(n){return{value:"",valueSourceIndex:n,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},d.prototype.needsBlankRow=function(e,a,n){return!e.isSubtotal||a===U.we&&n!==B.t.Compact},d.prototype.findValues=function(e){if(e.values)return e.values;var a=_.first(e.children);return a?this.findValues(a):void 0},d.prototype.wrapHierarchy=function(e,a,n,u,o,l){var p,c=this;return p={levels:this.wrapLevels(e.levels,a),root:{children:this.wrapNodes(e.root.children,e,a,n)}},u&&p.root.children.length>0&&(p.root.children=_.flatMap(p.root.children,function(h){return c.needsBlankRow(h,o,l)?[h,c.createBlankRowValueNode(h)]:[h]})),p.leafNodes=[],p},d.prototype.wrapLevels=function(e,a){if(e){for(var n=[],u=0,o=e;u<o.length;u++){var l=o[u],c=(0,N.ED)(l);if(n.push(c),l.sources.length>1&&a){for(var p=1;p<l.sources.length;p++)n.push({sources:[l.sources[p]]});c.sources.splice(1,c.sources.length-1)}}return n}},d.prototype.wrapNodes=function(e,a,n,u){if(e){for(var o=[],l=0,c=e;l<c.length;l++){var p=c[l],h=(0,N.ED)(p);if(p.isCollapsed&&!_.isEmpty(p.children)){var b=_.find(p.children,function(i){return i.isSubtotal});b&&(h.values=b.values),h.children=null,h.hasSubtotalStyle=!0}else{if(h.isSubtotal){var H=a.levels[h.level||0];if(1===H.sources.length&&!1===this.subtotalByColumn[H.sources[0].queryName])continue}h.hasSubtotalStyle=!!p.isSubtotal||u&&!_.isEmpty(p.children),h.children=this.wrapNodes(p.children,a,n,u)}if(!_.isEmpty(h.levelValues)&&h.levelValues.length>1&&n){for(var P=h.children,s=h,r=1;r<h.levelValues.length;r++){var t=(0,N.ED)(h),v=h.levelValues[r];v.levelSourceIndex=0,t.levelValues=[v],t.level+=r,t.isCollapsed=!0,t.children=void 0,s.isCollapsed=!1,s.children=[t],s=t}_.isEmpty(P)||(s.children=P,s.isCollapsed=!1),s.values=h.values,h.values=void 0,h.levelValues.splice(1,h.levelValues.length-1)}o.push(h)}return o}},d.prototype.updateHierarchy=function(e,a,n,u,o){e.leafNodes.length>0&&(e.leafNodes.length=0),e.root.children&&this.updateRecursive(e,e.root.children,null,e.leafNodes,a,n,u,o)},d.prototype.createEmptyNode=function(e){return void 0===e&&(e=0),{level:e,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},d.prototype.updateRecursive=function(e,a,n,u,o,l,c,p){for(var h,b=function(t,v){var i=a[t];if(i.siblings=a,e===H.rowHierarchy&&!i.isCollapsed&&!_.isEmpty(i.children)&&l===B.t.Outline&&!c&&i.children.unshift(H.createEmptyNode(i.children[0].level)),n&&(i.parent=n),h=e===H.rowHierarchy&&H.isSteppedLayout&&i.isSubtotal&&void 0!==i.levelSourceIndex?_.last(e.levels):e.levels[i.level],i.hierarchyLevel=h,h)if(i.levelValues){for(var C=[],g=[],y=0,m=i.levelValues;y<m.length;y++){var E=m[y],T=E.value;C.push(H.formatters[(w=h.sources[E.levelSourceIndex||0]).queryName].format(T,null));var R=H.tooltipFormatters[w.queryName];R&&g.push(R.format(T,null))}O.fF.assert(function(){return C.length===g.length||_.isEmpty(g)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),i.valueFormatted=C.join(H.compositeGroupSeparator),i.tooltipValueFormatted=_.isEmpty(g)?void 0:g.join(H.compositeGroupSeparator),i.queryName=1!==h.sources.length?void 0:h.sources[0].queryName}else{var w;i.valueFormatted=(w=h.sources[i.levelSourceIndex||0]).displayName,i.tooltipValueFormatted=w.displayName,i.queryName=w.queryName}i.index=t,_.isEmpty(i.children)?(!o||!i.isSubtotal||!c&&i.parent&&!i.parent.isSubtotal||H.valuesOnRow&&i.parent)&&(i.leafIndex=u.length,u.push(i)):(o&&(i.leafIndex=u.length,u.push(i)),H.updateRecursive(e,i.children,i,u,o,l,c,p),o&&(O.fF.assertAnyValue(_.every(i.children,function(V){return _.isEqual(V.hierarchyLevel,i.children[0].hierarchyLevel)}),"Children may come from different levels"),(!H.hasMultipleValueSources()||_.some(i.children,function(V){return _.some(V.hierarchyLevel.sources,function(M){return!M.isMeasure})}))&&(i.hasSubtotalStyle=!0))),i.position=p(i,a)},H=this,P=0,s=a.length;P<s;P++)b(P)},d.prototype.updateStaticColumnHeaders=function(e){var a=e.leafNodes;if(a&&a.length>0){if(!a[0].identity&&this.valuesOnRow&&1===a.length)return;for(var n=0,u=a.length;n<u;n++){var o=a[n];if(!o.identity&&_.isEmpty(o.levelValues)){var c=e.levels[o.level].sources[o.levelSourceIndex?o.levelSourceIndex:0];c&&(o.valueFormatted=c.displayName)}}}},d.prototype.getMatrixHierarchy=function(e){var a=this.rowHierarchy.root.children;if(a&&e===a)return this.rowHierarchy;var n=this.columnHierarchy.root.children;return n&&e===n?this.columnHierarchy:null},d.prototype.calculateRowHeaderPosition=function(e,a){var n=new S.ri;n.row.index=this.getRowLeafIndex(e),n.row.indexInSiblings=this.getIndex(e),n.row.isFirst=this.areAllParentsFirst(e,a),n.row.isLast=this.areAllParentsLast(e,a);var u=this.getLevel(e);return n.column.index=n.column.indexInSiblings=u,n.column.isFirst=0===u,n.column.isLast=this.isLeaf(e),n},d.prototype.calculateColumnHeaderPosition=function(e,a){var n=new S.ri,u=this.getLevel(e);n.row.index=n.row.indexInSiblings=u,n.row.isFirst=0===u,n.row.isLast=this.isLeaf(e);var o=this.getIndex(e);return n.column.index=n.column.indexInSiblings=o,n.column.isFirst=this.areAllParentsFirst(e,a),n.column.isLast=this.areAllParentsLast(e,a),n},d.prototype.getRowHeaderMetadataColumn=function(e){var a=this.getRowHeaderMetadataColumns(e);return a&&a[0]},d.prototype.getRowHeaderMetadataColumns=function(e){if(e&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,e.level)},d.prototype.getColumnHeaderMetadataColumn=function(e){var a=this.getColumnHeaderMetadataColumns(e);return a&&a[0]},d.prototype.getColumnHeaderMetadataColumns=function(e){if(e&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,e.level)},d.prototype.getHierarchyMetadataColumns=function(e,a){if(e&&e.levels&&!(e.levels.length<a)){var n=e.levels[a];if(n&&n.sources&&0!==n.sources.length)return n.sources}},d.isNodeGrandTotal=function(e){if(e){for(var a=e;a.parent;)a=a.parent;return a.isSubtotal}return!1},d}()},29043:function(st,J,x){x.d(J,{MV:function(){return e},th:function(){return f},wJ:function(){return d}});var Z=x(53197),O=x(90120),N=x(51995),G=x(85308),S=x(58520),j=x(45296),B=x(44783),U=x(62458),F=x(43286),q=52;function f(l,c){var m,p={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(l)){var h;try{h=JSON.parse(l)}catch{return}var b=+h.yl,H=+h.yh,s=+h.xl,r=+h.xh,t=null!=h.md?+h.md:void 0;_.size(h.p)>q&&c.setWarnings([new j.El]);for(var v=0,i=h.p;v<i.length;v++){var C=i[v];p.points.push({x:null!=C[0]?+C[0]:void 0,y:null!=C[1]?(m=+C[1],m*(H-b)/100+b):void 0})}return{points:_.filter(p.points,function(y){return _.isFinite(y.x)&&(null!=y.y||_.isFinite(y.y))}),lowX:s,highX:r,lowY:b,highY:H,minXDifference:t}}}function d(l,c,p){var h;U.fF.assertValue(l,"sparkline"),U.fF.assertValue(null===(h=c?.misc)||void 0===h?void 0:h.sparkline,"invalid type for sparkline"),U.fF.assertValue(p,"style");var b=c.misc.sparkline.groupingType;return{chartType:l.chartType,dataColor:p.isHighContrast?O.v.getThemeColor(p,B.fA):l.dataColor,strokeWidth:l.strokeWidth,marker:{show:!0,typeFlags:l.marker.typeFlags,color:p.isHighContrast?O.v.getThemeColor(p,B.fA):l.marker.color,size:l.marker.size,shape:l.marker.shape},isScalar:b&&!!(b.numeric||b.dateTime||b.temporal)}}function e(l,c,p,h,b,H,P,s){var r;if(null!=h){var g=H-p.getExtraLeft()-p.getExtraRight()-(s?s+5:0),y=b-p.getExtraTop()-p.getExtraBottom();g-c.strokeWidth>1&&y-c.strokeWidth>1&&(r=c.chartType===G.U.line?function(l,c,p,h){var w,H=l.dataColor,P=l.strokeWidth,s=l.marker,r=s.color,t=s.size,v=s.shape,i=s.typeFlags,C=l.isScalar,g=(0,F.Js)(i),y=0===g||1===g&&(0,F.yE)(i,S.qC),m=Math.max(P,2)+(y?0:Math.ceil(t/2)),E=h.points;w=C?d3.scaleLinear().domain([h.lowX,h.highX]).range([m,c-m]):d3.scalePoint().domain(_.map(_.range(h.lowX,h.highX+1),function(D){return D.toString()})).range([m,c-m]);var W,I,L=d3.scaleLinear().domain(d3.extent(E,function(D){return D.y})).range([p-m,m]),T=d3.line().x(function(D){return w(D.x)}).y(function(D){return L(D.y)}),R=_.filter(E,function(D){return null!=D.y}),M={tagName:"path",attributes:{d:T(R)},classNames:[],styleProperties:{stroke:H,"stroke-width":P.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},tt=function(l,c){var p=c.marker.typeFlags,h=d3.extent(l,function(P){return P.y}),b=h[0],H=h[1];return _.filter(l,function(P,s){var r,t;return null!=P.y&&(!!(0,F.yE)(p,S.$6)||(0,F.yE)(p,S.Ps)&&0===s||(0,F.yE)(p,S.Z$)&&s===l.length-1||(0,F.yE)(p,S.pd)&&P.y<0||(0,F.yE)(p,S.Zc)&&P.y===H||(0,F.yE)(p,S.O3)&&P.y===b||(0,F.yE)(p,S.qC)&&null==(null===(r=l[s-1])||void 0===r?void 0:r.y)&&null==(null===(t=l[s+1])||void 0===t?void 0:t.y))})}(R,l);if(!_.isEmpty(tt)){var K="markerKey".concat(t).concat(r).concat(v);W={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:K,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:t.toString(),markerWidth:t.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,N.F)(v).toString(),"stroke-opacity":"1",stroke:r,fill:r},attributes:{d:(0,N.Ar)(v)}}]}]},I={tagName:"path",attributes:{d:T(tt)},classNames:[],styleProperties:{stroke:H,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(K,")"),"marker-mid":"url(#".concat(K,")"),"marker-end":"url(#".concat(K,")")}}}return{tagName:"svg",children:I?[W,M,I]:[M],classNames:[],styleProperties:{},attributes:{height:p+"px",width:c+"px"}}}(c,g,y,h):function(l,c,p,h){var v,b=l.dataColor,H=l.isScalar,P=h.points,s=[h.lowX,h.highX],r=function(l,c,p,h,b){if(_.isEmpty(l))return 0;var s,r=h[h.length-1]-h[0];return b&&h&&h.length>1?(0!==r?(U.fF.assert(function(){return null!=c},"minXDifference cannot be null for scalar plotted as columns"),s=p*(c/(r+c))):s=p,s=Math.max(s,2)):s=p/(r+1),.8*s}(P,h.minXDifference,c,s,H),t=r/2;v=H?d3.scaleLinear().domain(s).range([t,c-t]):d3.scalePoint().domain(_.map(_.range(h.lowX,h.highX+1),function(m){return m.toString()})).range([t,c-t]);var i=d3.extent(P,function(m){return m.y});i[0]=Math.min(0,i[0]),i[1]=Math.max(0,i[1]);var C=d3.scaleLinear().domain(i).range([p,0]),g=C(0),y=r.toString();return{tagName:"svg",children:_.chain(P).filter(function(m){return null!=m.y}).map(function(m){var E=(v(m.x)-t).toString(),w=(g+(0,Z.sc)(C,Math.max(0,m.y),0)).toString(),L=Math.abs((0,Z.sc)(C,0,m.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:b},attributes:{x:E,y:w,width:y,height:L}}}).value(),classNames:[],styleProperties:{},attributes:{height:p+"px",width:c+"px"}}}(c,g,y,h))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(P&&"Before"!==P.layout?[r,l]:[l,r],function(w){return!!w})}}}}]);