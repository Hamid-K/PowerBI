"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["new-features-dialog"],{89250:function(j,m,a){a.r(m),a.d(m,{NewFeaturesDialogModule:function(){return B}});var w=a(42437),c=a(81337),x=a(73221),e=a(50423),v=a(65181),b=a(64647),f=a(67489),s=a(77476),F=a(96777),d=a(6426),p=a(59968),u=a(85102),h=function(){function n(){this.imageUrl="../../..".concat((0,d.Xr)(),"/images/InteractiveCanvas.gif")}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["interactive-mobile-canvas"]],decls:6,vars:7,consts:[["localize","Interactive_Mobile_Canvas_New_Feature_Description",1,"dialog-description"],["fragment-index","0","tabindex","0","localize","Generic_LearnMore","href","https://go.microsoft.com/fwlink/?linkid=2170889","target","_blank",1,"pbi-external-link"],[1,"imageContainer"],["role","img","focus-nav-mode","Skip",1,"dialog-image",3,"src","alt"]],template:function(t,i){1&t&&(e.\u0275\u0275element(0,"span",0)(1,"a",1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementStart(3,"div",2),e.\u0275\u0275element(4,"img",3),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(2,3,"Generic_LearnMore")),e.\u0275\u0275advance(3),e.\u0275\u0275property("src",i.imageUrl,e.\u0275\u0275sanitizeUrl)("alt",e.\u0275\u0275pipeBind1(5,5,"Interactive_Mobile_Canvas_New_Feature_Animation_Description")))},dependencies:[p.X,u.F],styles:[".imageContainer[_ngcontent-%COMP%]{margin-top:12px}.imageContainer[_ngcontent-%COMP%]   .dialog-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.dialog-description[_ngcontent-%COMP%]:focus{outline-color:transparent}.dialog-description[_ngcontent-%COMP%]   .boldText[_ngcontent-%COMP%]{font-weight:700}"]}),n}(),C=function(){function n(){this.imageUrl="../../..".concat((0,d.Xr)(),"/images/VisualCalculationIntro.svg")}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["visual-calculation-intro"]],decls:9,vars:7,consts:[[1,"imageContainer"],["role","img","focus-nav-mode","Skip",1,"dialog-image",3,"src","alt"],["localize","VisualCalcNew_Feature_Description",1,"dialog-description"],["localize","VisualCalcNew_Feature_Description_1","localize-fragments","",1,"dialog-description"],["fragment-index","0","localize","NewVisualCalc",1,"boldText"],["fragment-index","1","localize","Home",1,"boldText"],["fragment-index","2","tabindex","0","localize","Generic_LearnMore","href","https://go.microsoft.com/fwlink/?linkid=2249857","target","_blank",1,"pbi-external-link"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"img",1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"p",2),e.\u0275\u0275elementStart(4,"p",3),e.\u0275\u0275element(5,"span",4)(6,"span",5)(7,"a",6),e.\u0275\u0275pipe(8,"localize"),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("src",i.imageUrl,e.\u0275\u0275sanitizeUrl)("alt",e.\u0275\u0275pipeBind1(2,3,"VisualCalcNew_Feature_Image_Description")),e.\u0275\u0275advance(6),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(8,5,"Generic_LearnMore")))},dependencies:[p.X,u.F],styles:[".imageContainer[_ngcontent-%COMP%]{margin-top:12px}.imageContainer[_ngcontent-%COMP%]   .dialog-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.dialog-description[_ngcontent-%COMP%]:focus{outline-color:transparent}.dialog-description[_ngcontent-%COMP%]   .boldText[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}"]}),n}(),D=a(71115),g=a(17174),y=a(37350),I=a(89330);function P(n,o){if(1&n){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tri-radio-button",12),e.\u0275\u0275listener("change",function(){var U=e.\u0275\u0275restoreView(t).$implicit,G=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(G.onValueChange(U.value))}),e.\u0275\u0275elementStart(1,"div",13),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()}if(2&n){var i=o.$implicit;e.\u0275\u0275property("value",i.value),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",i.label,"")}}var M=function(){function n(o,t){this.appThemeService=o,this.localizationService=t,this.imageUrl="../../..".concat((0,d.Xr)(),"/images/DarkModeIntro.svg"),this.dropDownOptions=[],this.dropDownOptions=[{value:"Teal",label:t.get("Default")},{value:"Light",label:t.get("Light")},{value:"Dark",label:t.get("Dark")},{value:"System",label:t.get("SettingsDataSource_SettingsAuthenticationMethod_Windows")}],this.previewPersonalizeText=t.get("PersonalizeVisual_MainMenuLabel")+" ("+t.get("Preview")+")"}return n.prototype.ngOnInit=function(){return(0,c.__awaiter)(this,void 0,void 0,function(){var o;return(0,c.__generator)(this,function(t){switch(t.label){case 0:return o=this,[4,this.appThemeService.getUserSettingAppThemeName()];case 1:return o.currentThemeValue=t.sent(),[2]}})})},n.prototype.onValueChange=function(o){return(0,c.__awaiter)(this,void 0,void 0,function(){return(0,c.__generator)(this,function(t){switch(t.label){case 0:return this.currentThemeValue=o,[4,this.appThemeService.setAppThemeByNameWithSource(o,"freDialog")];case 1:return t.sent(),[2]}})})},n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(D.T),e.\u0275\u0275directiveInject(v.o))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["dark-mode-intro"]],decls:17,vars:10,consts:[[1,"imageContainer"],["role","img","focus-nav-mode","Skip",1,"dialog-image",3,"src","alt"],[1,"boldTextCentered"],[1,"flex-row-with-wrap",3,"ngModel"],["type","radio",3,"value","change",4,"ngFor","ngForOf"],["localize","DarkMode_NewFeatureDialog_Description",1,"dialog-description"],["localize","DarkMode_NewFeatureDialog_Step1","localize-fragments","",1,"turn-on-step","dialog-description"],["fragment-index","0","localize","DarkMode_NewFeatureDialog_TurnOnPath",1,"boldText"],["localize","DarkMode_NewFeatureDialog_Step2","localize-fragments","",1,"turn-on-step","dialog-description"],["fragment-index","0","localize","DarkMode_NewFeatureDialog_Personalization",1,"boldText"],["fragment-index","1","localize","Dark",1,"boldText"],["fragment-index","2","tabindex","0","localize","Generic_LearnMore","href","https://go.microsoft.com/fwlink/?linkid=2281612","target","_blank",1,"pbi-external-link"],["type","radio",3,"value","change"],[1,"content-element-radio-header"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"img",1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span",2),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"tri-radio-group",3),e.\u0275\u0275template(6,P,3,2,"tri-radio-button",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"span",5)(8,"br"),e.\u0275\u0275elementStart(9,"span",6),e.\u0275\u0275element(10,"span",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"br"),e.\u0275\u0275elementStart(12,"span",8),e.\u0275\u0275element(13,"span",9)(14,"span",10)(15,"a",11),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("src",i.imageUrl,e.\u0275\u0275sanitizeUrl)("alt",e.\u0275\u0275pipeBind1(2,6,"DarkMode_NewFeatureDialog_ImageAltText")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(i.previewPersonalizeText),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",i.currentThemeValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",i.dropDownOptions),e.\u0275\u0275advance(9),e.\u0275\u0275attribute("aria-label",e.\u0275\u0275pipeBind1(16,8,"Generic_LearnMore")))},dependencies:[s.NgForOf,p.X,g.JJ,g.On,y.Y,I.Z,u.F],styles:['.imageContainer[_ngcontent-%COMP%]{margin-top:12px}.imageContainer[_ngcontent-%COMP%]   .dialog-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.dialog-description[_ngcontent-%COMP%]:focus{outline-color:transparent}.dialog-description[_ngcontent-%COMP%]   .boldText[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold)}.boldTextCentered[_ngcontent-%COMP%]{font-weight:var(--font-weight-semi-bold);display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center}html:not([dir="rtl"])[_nghost-%COMP%]   .turn-on-step[_ngcontent-%COMP%], html:not([dir="rtl"])   [_nghost-%COMP%]   .turn-on-step[_ngcontent-%COMP%]{margin-left:8px}html[dir="rtl"][_nghost-%COMP%]   .turn-on-step[_ngcontent-%COMP%], html[dir="rtl"]   [_nghost-%COMP%]   .turn-on-step[_ngcontent-%COMP%]{margin-right:8px}.flex-row-with-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center}']}),n}();function O(n,o){1&n&&e.\u0275\u0275element(0,"interactive-mobile-canvas")}function S(n,o){1&n&&e.\u0275\u0275element(0,"visual-calculation-intro")}function T(n,o){1&n&&e.\u0275\u0275element(0,"dark-mode-intro")}function z(n,o){if(1&n){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(r.viewModel.actionButton())}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&n){var i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(null==i.viewModel?null:i.viewModel.actionButtonText)}}function N(n,o){if(1&n){var t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275template(1,z,2,1,"button",4),e.\u0275\u0275elementStart(2,"button",5),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);var r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.nextFeature())}),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()()}if(2&n){var i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==i.viewModel?null:i.viewModel.actionButton),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.viewModel.buttonText)}}var _=function(n){function o(t,i,l){var r=n.call(this)||this;return r.localizationService=t,r.highContrastCssGenerationService=i,r.templateDialogPayload=l,r.initializeHighContrastRules(),r}return(0,c.__extends)(o,n),o.prototype.ngOnInit=function(){var t;this.args=this.templateDialogPayload.input,this.titleMap=((t={}).interactiveMobileCanvas={title:this.localizationService.get("Interactive_Mobile_Canvas_New_Feature")},t.visualCalculation={title:this.localizationService.get("VisualCalcNew_Feature_Title")},t.darkMode={title:this.localizationService.get("DarkMode_NewFeatureDialog_Title")},t),this.currentFeatureIndex=0,this.updateViewModel()},o.prototype.nextFeature=function(){this.args.features.length&&this.currentFeatureIndex!==this.args.features.length-1?(this.currentFeatureIndex++,this.updateViewModel()):this.templateDialogPayload.closeDialogFromConsumer({complete:!0})},o.prototype.getCurrentFeature=function(){return this.args.features[this.currentFeatureIndex]},o.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement input.styled-radio","{ opacity: 0 !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement input.styled-radio + span:before","{ border-color: @buttonForegroundColor !important; background-color: @buttonBackgroundColor !important;}"),this.highContrastCssGenerationService.addRule(".themeableElement input.styled-radio:focus + span:before, .themeableElement input.styled-radio:hover + span:before","{ border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement input.styled-radio:checked + span:after","{ border-color: @buttonBackgroundColor !important; background-color: @buttonForegroundColor !important; }")},o.prototype.updateViewModel=function(){var t,i=this.getCurrentFeature();this.viewModel={currentFeature:i,buttonText:this.localizationService.get(this.currentFeatureIndex===this.args.features.length-1?"Close":"TutorialPopup_Next"),title:null===(t=this.titleMap[i])||void 0===t?void 0:t.title},this.templateDialogPayload.setTitle(this.viewModel.title)},o.\u0275fac=function(i){return new(i||o)(e.\u0275\u0275directiveInject(v.o),e.\u0275\u0275directiveInject(b.g),e.\u0275\u0275directiveInject(f.x))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["new-features-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:6,vars:5,consts:[[1,"content",3,"ngSwitch"],[4,"ngSwitchCase"],["id","dialogFooter","class","newFeaturesDialog",4,"ngIf"],["id","dialogFooter",1,"newFeaturesDialog"],["class","pbi-fluent-button action","tabindex","0",3,"click",4,"ngIf"],[1,"pbi-fluent-button","primary",3,"click"],["tabindex","0",1,"pbi-fluent-button","action",3,"click"]],template:function(i,l){1&i&&(e.\u0275\u0275elementStart(0,"template-dialog")(1,"div",0),e.\u0275\u0275template(2,O,1,0,"interactive-mobile-canvas",1),e.\u0275\u0275template(3,S,1,0,"visual-calculation-intro",1),e.\u0275\u0275template(4,T,1,0,"dark-mode-intro",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,N,4,2,"div",2),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",null==l.viewModel?null:l.viewModel.currentFeature),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","interactiveMobileCanvas"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","visualCalculation"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","darkMode"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",l.viewModel))},dependencies:[s.NgIf,s.NgSwitch,s.NgSwitchCase,F.J,h,C,M],styles:['[_nghost-%COMP%]   template-dialog[_ngcontent-%COMP%]{min-height:300px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{font-size:var(--md-font-size, 14px);font-family:var(--fluent-font-family, "Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif);color:var(--neutral-primary-color, #333333);padding-left:0;padding-right:0;margin-top:8px}[_nghost-%COMP%]   #dialogFooter[_ngcontent-%COMP%]{display:flex;justify-content:flex-end!important;margin-top:8px}'],changeDetection:0}),o}(x.w),k=a(79061),V=a(42729),E=a(95228),B=function(){function n(){}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({providers:[f.x],imports:[s.CommonModule,V.c.withManifest([{componentIdentifier:w.o,componentType:_}]),k.v,g.u5,E.W]}),n}()}}]);