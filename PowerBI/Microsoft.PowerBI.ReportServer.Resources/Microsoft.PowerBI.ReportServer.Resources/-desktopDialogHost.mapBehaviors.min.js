"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["mapBehaviors"],{96071:function(_,d,r){r.r(d),r.d(d,{MapBehavior:function(){return S}});var c=r(60066),y=r(66232),n=r(30237),h=r(5962),P=r(38400),E=r(81551),T=r(79476),g=r(59107),D=r(9795),S=function(){function s(){this.mapPointerEventsDisabled=!1,this.mapPointerTimeoutSet=!1,this.viewChangedSinceLastClearMouseDown=!1,this.receivedZoomOrPanEvent=!1,this.clearMouseDownLocation=new E.E}return s.prototype.bindEvents=function(t,e,a){var i=this,o=this.root=t.root,l=this.bubbles=t.bubbles,v=this.slices=t.slices,p=this.shapes=t.shapes,L=this.visualInstanceId=t.visualInstanceId,b=t.clearCapture;if(this.focusCallback=t.focusCallback,this.hostServices=t.hostServices,this.pointLabelText=this.hostServices.getLocalizedString("Generic_Point"),this.widthDivisor=t.widthDivisor,a){var O=a.pointSourceKey;this.dataPointNavigationManager=a.dataPointNavigationManager,this.pointSourceKey=O}this.selectionHandler=e,this.hitTester=t.hitTester,o&&(this.registerArrowKeyStopper(o),this.dataPointNavigationManager&&!this.dataPointNavigationManager.isEmpty(this.pointSourceKey)&&((0,n.W3)(o.select(h.Kp),this.dataPointNavigationManager,this.pointSourceKey),(0,n.zV)(o,L,this.pointSourceKey),(0,n.lt)(o,e))),this.mapPointerEventsDisabled||(l&&l.style("pointer-events","all"),v&&v.style("pointer-events","all"),p&&p.style("pointer-events","all"));var m=function(){var f=i.activeSelection,M=d3.event;f&&(i.mapPointerEventsDisabled||f.style("pointer-events","none"),i.mapPointerEventsDisabled=!0,M.preventDefault(),i.mapPointerTimeoutSet||(i.mapPointerTimeoutSet=!0,setTimeout(function(){f&&f.style("pointer-events","all"),i.mapPointerEventsDisabled=!1,i.mapPointerTimeoutSet=!1},500)))};l&&(this.activeSelection=l,t.bubbleEventGroup.on("mousewheel",m),this.registerMapSelectionHandler(t.bubbleEventGroup,e),(0,n.TY)(t.eventManager,t.bubbleEventGroup,e),this.dataPointNavigationManager&&!this.dataPointNavigationManager.isEmpty(this.pointSourceKey)&&(0,n.I8)(t.bubbleEventGroup,this.dataPointNavigationManager,this.pointSourceKey)),v&&(this.activeSelection=v,t.sliceEventGroup.on("mousewheel",m),this.registerMapSelectionHandler(t.sliceEventGroup,e),(0,n.TY)(t.eventManager,t.sliceEventGroup,e),this.dataPointNavigationManager&&!this.dataPointNavigationManager.isEmpty(this.pointSourceKey)&&(0,n.I8)(t.sliceEventGroup,this.dataPointNavigationManager,this.pointSourceKey)),p&&(this.activeSelection=p,t.shapeEventGroup.on("mousewheel",m),this.registerMapSelectionHandler(t.shapeEventGroup,e),(0,n.TY)(t.eventManager,t.shapeEventGroup,e),this.dataPointNavigationManager&&!this.dataPointNavigationManager.isEmpty(this.pointSourceKey)&&(0,n.I8)(t.shapeEventGroup,this.dataPointNavigationManager,this.pointSourceKey)),b&&(b.on("mouseup",function(){var u=d3.event;i.shouldExitHandlerEarly(u)||(0,T.Sp)(i.clearMouseDownLocation,new E.E(u.x,u.y))<12&&!i.viewChangedSinceLastClearMouseDown&&!g.M.isCtrlOrMeta(u)&&(i.bubbles&&0!==i.bubbles.filter(function(){return this===u.target}).size()||i.slices&&0!==i.slices.filter(function(){return this===u.target}).size()||i.shapes&&0!==i.shapes.filter(function(){return this===u.target}).size()||e.handleClearSelection(),i.receivedZoomOrPanEvent=!0)},!0),b.on("mousedown",function(){var u=d3.event;i.viewChangedSinceLastClearMouseDown=!1,i.clearMouseDownLocation=new E.E(u.x,u.y)},!0),b.on("mousewheel",function(){i.receivedZoomOrPanEvent=!0},!0)),t.navigationEntry&&(0,n.W3)(d3.select(t.navigationEntry),this.dataPointNavigationManager,this.pointSourceKey)},s.prototype.bindHitTester=function(t){this.hitTester=t},s.prototype.renderSelection=function(t){this.bubbles&&this.bubbles.attr("aria-selected",function(e){return e.selected}).style("fill-opacity",function(e){return(0,c.eR)(e.selected,!1,t,!1)}).style("stroke-opacity",function(e){return(0,c.eR)(e.selected,!1,t,!1)}),this.slices&&this.slices.attr("aria-selected",function(e){return e.selected}).style("fill-opacity",function(e){return(0,c.eR)(e.data.selected,!1,t,!1)}).style("stroke-opacity",function(e){return(0,c.eR)(e.data.selected,!1,t,!1)}),this.shapes&&this.shapes.attr("aria-selected",function(e){return e.selected}).style("fill-opacity",function(e){return(0,c.eR)(e.selected,!1,t,!1)}).style("stroke-opacity",function(e){return(0,c.eR)(e.selected,!1,t,!1)})},s.prototype.viewChanged=function(){this.viewChangedSinceLastClearMouseDown=!0},s.prototype.resetZoomPan=function(){this.receivedZoomOrPanEvent=!1},s.prototype.hasReceivedZoomOrPanEvent=function(){return this.receivedZoomOrPanEvent},s.prototype.lassoSelectRect=function(t,e){if(this.hitTester){var a=this.hitTester.queryRegion(e);(0,n.ct)(t,a,this.selectionHandler)}},s.prototype.renderFocus=function(t){if(t){this.bubbles&&this.bubbles.attr("aria-label",this.pointLabelText),this.slices&&this.slices.attr("aria-label",this.pointLabelText),this.shapes&&this.shapes.attr("aria-label",this.pointLabelText);var e=d3.select(t);this.addAriaLabelToSelection(e);var a=e.node().getBoundingClientRect(),i=e.node().viewportElement.getBoundingClientRect();this.elementOutsideViewport(a,i)&&this.focusCallback();var o="".concat(c.aY,"-").concat(this.visualInstanceId);this.root.select("#"+o).attr("id",null),t.setAttribute("id",o),e.style("outline-width","".concat(1/this.widthDivisor,"px"),"important"),g.M.focus(t)}},s.prototype.elementOutsideViewport=function(t,e){return t.x<e.x||t.y<e.y||t.x+t.width>e.x+e.width||t.y+t.height>e.y+e.height},s.prototype.registerMapSelectionHandler=function(t,e){var a=this;t.on("click",function(){var i=d3.event;a.shouldExitHandlerEarly(i)||(0,y.q)(i)||(0,n.kW)(function(o){a.bubbles&&a.bubbles.style("pointer-events","all").attr("aria-label",a.pointLabelText),a.slices&&a.slices.style("pointer-events","all").attr("aria-label",a.pointLabelText),a.shapes&&a.shapes.style("pointer-events","all").attr("aria-label",a.pointLabelText),a.mapPointerEventsDisabled=!a.slices,a.addAriaLabelToSelection(d3.select(i.target));var l=(0,n.Xt)(o)?o.data:o;(0,n.c8)(l,e)})}).on("keydown.select",function(){var i=d3.event;if(!a.shouldExitHandlerEarly(i)){var o=i.keyCode;(32===o||13===o)&&(0,n.kW)(function(l){var v=(0,n.Xt)(l)?l.data:l;(0,n.c8)(v,e)},!0)}},!0)},s.prototype.registerArrowKeyStopper=function(t){$(t.node()).keydown(function(e){(0,D.Wl)(e.keyCode)&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault())})},s.prototype.shouldExitHandlerEarly=function(t){return d3.select(t.target).classed(h.Gs)},s.prototype.addAriaLabelToSelection=function(t){t.attr("aria-label",function(e){return(0,P.X)(void 0!==e.data?e.data.tooltipInfo:e.tooltipInfo)})},s.prototype.setTabbableElements=function(){$(".bm_bottomRightOverlay a").attr("tabindex",0)},s.prototype.setNonTabbableElements=function(){$(".ms-composite").children("div").attr("tabindex",-1),$(".bm_bottomLeftOverlay a").attr("tabindex",-1)},s.prototype.mapKeyboardAccessibility=function(t,e){var a=this;if(this.root){var i=this.root.select(h.PN),o=this.root.select(h.Kp);if(!i.empty()&&!this.root.selectAll(h.qG).empty()){var v=g.M.isInternetExplorerOrEdge();i.attr("tabindex",e?0:-1).attr("focusable",!!e).attr("role","region").attr("aria-label",t.getLocalizedString("Visual_AzureMapsNavigationControls")).attr("focus-nav-mode","Hierarchy").attr("style","position:absolute; inset: 4px 0px auto auto").classed(c.Pg,!v),i.selectAll(h.CL).attr("tabindex",e?0:-1).attr("focusable","true"),i.select(h.Kq).attr("tabindex",-1),$(i.node()).one("focus",function(){a.setNonTabbableElements(),a.setTabbableElements()})}$(o.node()).one("focus",function(){a.setNonTabbableElements(),a.setTabbableElements()}),this.setNonTabbableElements(),this.setTabbableElements()}},s}()},81551:function(_,d,r){r.d(d,{E:function(){return c}});var c=function(){return function(n,h){this.x=n||0,this.y=h||0}}()}}]);