(self.webpackChunkreportServerHostModern=self.webpackChunkreportServerHostModern||[]).push([["ds-variables-dialog"],{77489:function(Oe){Oe.exports=function(Q,Ae){(null==Ae||Ae>Q.length)&&(Ae=Q.length);for(var ue=0,M=new Array(Ae);ue<Ae;ue++)M[ue]=Q[ue];return M},Oe.exports.default=Oe.exports,Oe.exports.__esModule=!0},32878:function(Oe){function Xe(Ae,ue){for(var M=0;M<ue.length;M++){var $=ue[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(Ae,$.key,$)}}Oe.exports=function(Ae,ue,M){return ue&&Xe(Ae.prototype,ue),M&&Xe(Ae,M),Ae},Oe.exports.default=Oe.exports,Oe.exports.__esModule=!0},34850:function(Oe,Xe,Q){var Ae=Q(91052);Oe.exports=function(M,$){var ve=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(ve)return(ve=ve.call(M)).next.bind(ve);if(Array.isArray(M)||(ve=Ae(M))||$&&M&&"number"==typeof M.length){ve&&(M=ve);var Ne=0;return function(){return Ne>=M.length?{done:!0}:{done:!1,value:M[Ne++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},Oe.exports.default=Oe.exports,Oe.exports.__esModule=!0},12864:function(Oe,Xe,Q){var Ae=Q(74);Oe.exports=function(M,$){M.prototype=Object.create($.prototype),M.prototype.constructor=M,Ae(M,$)},Oe.exports.default=Oe.exports,Oe.exports.__esModule=!0},74:function(Oe){function Xe(Q,Ae){return Oe.exports=Xe=Object.setPrototypeOf||function(M,$){return M.__proto__=$,M},Oe.exports.default=Oe.exports,Oe.exports.__esModule=!0,Xe(Q,Ae)}Oe.exports=Xe,Oe.exports.default=Oe.exports,Oe.exports.__esModule=!0},91052:function(Oe,Xe,Q){var Ae=Q(77489);Oe.exports=function(M,$){if(M){if("string"==typeof M)return Ae(M,$);var ve=Object.prototype.toString.call(M).slice(8,-1);if("Object"===ve&&M.constructor&&(ve=M.constructor.name),"Map"===ve||"Set"===ve)return Array.from(M);if("Arguments"===ve||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ve))return Ae(M,$)}},Oe.exports.default=Oe.exports,Oe.exports.__esModule=!0},36444:function(Oe,Xe,Q){var Ae=Q(32878).default,ue=Q(12864).default,M=Q(34850).default;function $(){"use strict";$=function(){return Ne};var ve,Ne={},He=Object.prototype,Je=He.hasOwnProperty,De=Object.defineProperty||function(x,F,V){x[F]=V.value},ge="function"==typeof Symbol?Symbol:{},A=ge.iterator||"@@iterator",Le=ge.asyncIterator||"@@asyncIterator",ce=ge.toStringTag||"@@toStringTag";function E(x,F,V){return Object.defineProperty(x,F,{value:V,enumerable:!0,configurable:!0,writable:!0}),x[F]}try{E({},"")}catch{E=function(V,L,X){return V[L]=X}}function Me(x,F,V,L){var K=Object.create((F&&F.prototype instanceof Ve?F:Ve).prototype),B=new Ct(L||[]);return De(K,"_invoke",{value:me(x,V,B)}),K}function Qe(x,F,V){try{return{type:"normal",arg:x.call(F,V)}}catch(L){return{type:"throw",arg:L}}}Ne.wrap=Me;var le="suspendedStart",pe="suspendedYield",oe="executing",fe="completed",ye={};function Ve(){}function re(){}function ae(){}var se={};E(se,A,function(){return this});var de=Object.getPrototypeOf,We=de&&de(de(je([])));We&&We!==He&&Je.call(We,A)&&(se=We);var H=ae.prototype=Ve.prototype=Object.create(se);function he(x){["next","throw","return"].forEach(function(F){E(x,F,function(V){return this._invoke(F,V)})})}function J(x,F){function V(X,K,B,Ke){var d=Qe(x[X],x,K);if("throw"!==d.type){var Lt=d.arg,Mt=Lt.value;return Mt&&"object"==typeof Mt&&Je.call(Mt,"__await")?F.resolve(Mt.__await).then(function(wt){V("next",wt,B,Ke)},function(wt){V("throw",wt,B,Ke)}):F.resolve(Mt).then(function(wt){Lt.value=wt,B(Lt)},function(wt){return V("throw",wt,B,Ke)})}Ke(d.arg)}var L;De(this,"_invoke",{value:function(K,B){function Ke(){return new F(function(d,Lt){V(K,B,d,Lt)})}return L=L?L.then(Ke,Ke):Ke()}})}function me(x,F,V){var L=le;return function(X,K){if(L===oe)throw new Error("Generator is already running");if(L===fe){if("throw"===X)throw K;return{value:ve,done:!0}}for(V.method=X,V.arg=K;;){var B=V.delegate;if(B){var Ke=Ge(B,V);if(Ke){if(Ke===ye)continue;return Ke}}if("next"===V.method)V.sent=V._sent=V.arg;else if("throw"===V.method){if(L===le)throw L=fe,V.arg;V.dispatchException(V.arg)}else"return"===V.method&&V.abrupt("return",V.arg);L=oe;var d=Qe(x,F,V);if("normal"===d.type){if(L=V.done?fe:pe,d.arg===ye)continue;return{value:d.arg,done:V.done}}"throw"===d.type&&(L=fe,V.method="throw",V.arg=d.arg)}}}function Ge(x,F){var V=F.method,L=x.iterator[V];if(L===ve)return F.delegate=null,"throw"===V&&x.iterator.return&&(F.method="return",F.arg=ve,Ge(x,F),"throw"===F.method)||"return"!==V&&(F.method="throw",F.arg=new TypeError("The iterator does not provide a '"+V+"' method")),ye;var X=Qe(L,x.iterator,F.arg);if("throw"===X.type)return F.method="throw",F.arg=X.arg,F.delegate=null,ye;var K=X.arg;return K?K.done?(F[x.resultName]=K.value,F.next=x.nextLoc,"return"!==F.method&&(F.method="next",F.arg=ve),F.delegate=null,ye):K:(F.method="throw",F.arg=new TypeError("iterator result is not an object"),F.delegate=null,ye)}function Te(x){var F={tryLoc:x[0]};1 in x&&(F.catchLoc=x[1]),2 in x&&(F.finallyLoc=x[2],F.afterLoc=x[3]),this.tryEntries.push(F)}function ct(x){var F=x.completion||{};F.type="normal",delete F.arg,x.completion=F}function Ct(x){this.tryEntries=[{tryLoc:"root"}],x.forEach(Te,this),this.reset(!0)}function je(x){if(x||""===x){var F=x[A];if(F)return F.call(x);if("function"==typeof x.next)return x;if(!isNaN(x.length)){var V=-1,L=function X(){for(;++V<x.length;)if(Je.call(x,V))return X.value=x[V],X.done=!1,X;return X.value=ve,X.done=!0,X};return L.next=L}}throw new TypeError(typeof x+" is not iterable")}return re.prototype=ae,De(H,"constructor",{value:ae,configurable:!0}),De(ae,"constructor",{value:re,configurable:!0}),re.displayName=E(ae,ce,"GeneratorFunction"),Ne.isGeneratorFunction=function(x){var F="function"==typeof x&&x.constructor;return!!F&&(F===re||"GeneratorFunction"===(F.displayName||F.name))},Ne.mark=function(x){return Object.setPrototypeOf?Object.setPrototypeOf(x,ae):(x.__proto__=ae,E(x,ce,"GeneratorFunction")),x.prototype=Object.create(H),x},Ne.awrap=function(x){return{__await:x}},he(J.prototype),E(J.prototype,Le,function(){return this}),Ne.AsyncIterator=J,Ne.async=function(x,F,V,L,X){void 0===X&&(X=Promise);var K=new J(Me(x,F,V,L),X);return Ne.isGeneratorFunction(F)?K:K.next().then(function(B){return B.done?B.value:K.next()})},he(H),E(H,ce,"Generator"),E(H,A,function(){return this}),E(H,"toString",function(){return"[object Generator]"}),Ne.keys=function(x){var F=Object(x),V=[];for(var L in F)V.push(L);return V.reverse(),function X(){for(;V.length;){var K=V.pop();if(K in F)return X.value=K,X.done=!1,X}return X.done=!0,X}},Ne.values=je,Ct.prototype={constructor:Ct,reset:function(F){if(this.prev=0,this.next=0,this.sent=this._sent=ve,this.done=!1,this.delegate=null,this.method="next",this.arg=ve,this.tryEntries.forEach(ct),!F)for(var V in this)"t"===V.charAt(0)&&Je.call(this,V)&&!isNaN(+V.slice(1))&&(this[V]=ve)},stop:function(){this.done=!0;var F=this.tryEntries[0].completion;if("throw"===F.type)throw F.arg;return this.rval},dispatchException:function(F){if(this.done)throw F;var V=this;function L(Lt,Mt){return B.type="throw",B.arg=F,V.next=Lt,Mt&&(V.method="next",V.arg=ve),!!Mt}for(var X=this.tryEntries.length-1;X>=0;--X){var K=this.tryEntries[X],B=K.completion;if("root"===K.tryLoc)return L("end");if(K.tryLoc<=this.prev){var Ke=Je.call(K,"catchLoc"),d=Je.call(K,"finallyLoc");if(Ke&&d){if(this.prev<K.catchLoc)return L(K.catchLoc,!0);if(this.prev<K.finallyLoc)return L(K.finallyLoc)}else if(Ke){if(this.prev<K.catchLoc)return L(K.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return L(K.finallyLoc)}}}},abrupt:function(F,V){for(var L=this.tryEntries.length-1;L>=0;--L){var X=this.tryEntries[L];if(X.tryLoc<=this.prev&&Je.call(X,"finallyLoc")&&this.prev<X.finallyLoc){var K=X;break}}K&&("break"===F||"continue"===F)&&K.tryLoc<=V&&V<=K.finallyLoc&&(K=null);var B=K?K.completion:{};return B.type=F,B.arg=V,K?(this.method="next",this.next=K.finallyLoc,ye):this.complete(B)},complete:function(F,V){if("throw"===F.type)throw F.arg;return"break"===F.type||"continue"===F.type?this.next=F.arg:"return"===F.type?(this.rval=this.arg=F.arg,this.method="return",this.next="end"):"normal"===F.type&&V&&(this.next=V),ye},finish:function(F){for(var V=this.tryEntries.length-1;V>=0;--V){var L=this.tryEntries[V];if(L.finallyLoc===F)return this.complete(L.completion,L.afterLoc),ct(L),ye}},catch:function(F){for(var V=this.tryEntries.length-1;V>=0;--V){var L=this.tryEntries[V];if(L.tryLoc===F){var X=L.completion;if("throw"===X.type){var K=X.arg;ct(L)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(F,V,L){return this.delegate={iterator:je(F),resultName:V,nextLoc:L},"next"===this.method&&(this.arg=ve),ye}},Ne}typeof self<"u"&&self,Oe.exports=function(){var De,ge,ve={302:function(ge,A,Le){var E;A.formatArgs=function(E){if(E[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+E[0]+(this.useColors?"%c ":" ")+"+"+ge.exports.humanize(this.diff),this.useColors){var Me="color: "+this.color;E.splice(1,0,Me,"color: inherit");var Qe=0,le=0;E[0].replace(/%[a-zA-Z%]/g,function(pe){"%%"!==pe&&(Qe++,"%c"===pe&&(le=Qe))}),E.splice(le,0,Me)}},A.save=function(E){try{E?A.storage.setItem("debug",E):A.storage.removeItem("debug")}catch{}},A.load=function(){var E;try{E=A.storage.getItem("debug")}catch{}return!E&&typeof process<"u"&&"env"in process&&(E=process.env.DEBUG),E},A.useColors=function(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},A.storage=function(){try{return localStorage}catch{}}(),A.destroy=(E=!1,function(){E||(E=!0)}),A.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],A.log=console.debug||console.log||function(){},ge.exports=Le(65)(A),ge.exports.formatters.j=function(E){try{return JSON.stringify(E)}catch(Me){return"[UnexpectedJSONParseError]: "+Me.message}}},65:function(ge,A,Le){ge.exports=function(ce){function E(le){var pe,oe,fe,ye=null;function Ve(){for(var re=arguments.length,ae=new Array(re),se=0;se<re;se++)ae[se]=arguments[se];if(Ve.enabled){var de=Ve,We=Number(new Date);de.diff=We-(pe||We),de.prev=pe,de.curr=We,pe=We,ae[0]=E.coerce(ae[0]),"string"!=typeof ae[0]&&ae.unshift("%O");var he=0;ae[0]=ae[0].replace(/%([a-zA-Z%])/g,function(J,me){if("%%"===J)return"%";he++;var Ge=E.formatters[me];return"function"==typeof Ge&&(J=Ge.call(de,ae[he]),ae.splice(he,1),he--),J}),E.formatArgs.call(de,ae),(de.log||E.log).apply(de,ae)}}return Ve.namespace=le,Ve.useColors=E.useColors(),Ve.color=E.selectColor(le),Ve.extend=Me,Ve.destroy=E.destroy,Object.defineProperty(Ve,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==ye?ye:(oe!==E.namespaces&&(oe=E.namespaces,fe=E.enabled(le)),fe)},set:function(ae){ye=ae}}),"function"==typeof E.init&&E.init(Ve),Ve}function Me(le,pe){var oe=E(this.namespace+(void 0===pe?":":pe)+le);return oe.log=this.log,oe}function Qe(le){return le.toString().substring(2,le.toString().length-2).replace(/\.\*\?$/,"*")}return E.debug=E,E.default=E,E.coerce=function(le){return le instanceof Error?le.stack||le.message:le},E.disable=function(){var le=[].concat(E.names.map(Qe),E.skips.map(Qe).map(function(pe){return"-"+pe})).join(",");return E.enable(""),le},E.enable=function(le){var pe;E.save(le),E.namespaces=le,E.names=[],E.skips=[];var oe=("string"==typeof le?le:"").split(/[\s,]+/),fe=oe.length;for(pe=0;pe<fe;pe++)oe[pe]&&("-"===(le=oe[pe].replace(/\*/g,".*?"))[0]?E.skips.push(new RegExp("^"+le.slice(1)+"$")):E.names.push(new RegExp("^"+le+"$")))},E.enabled=function(le){if("*"===le[le.length-1])return!0;var pe,oe;for(pe=0,oe=E.skips.length;pe<oe;pe++)if(E.skips[pe].test(le))return!1;for(pe=0,oe=E.names.length;pe<oe;pe++)if(E.names[pe].test(le))return!0;return!1},E.humanize=Le(247),E.destroy=function(){},Object.keys(ce).forEach(function(le){E[le]=ce[le]}),E.names=[],E.skips=[],E.formatters={},E.selectColor=function(le){for(var pe=0,oe=0;oe<le.length;oe++)pe=(pe<<5)-pe+le.charCodeAt(oe),pe|=0;return E.colors[Math.abs(pe)%E.colors.length]},E.enable(E.load()),E}},247:function(ge){var A=1e3,Le=60*A,ce=60*Le,E=24*ce;function pe(oe,fe,ye,Ve){var re=fe>=1.5*ye;return Math.round(oe/ye)+" "+Ve+(re?"s":"")}ge.exports=function(oe,fe){fe=fe||{};var ye=typeof oe;if("string"===ye&&oe.length>0)return function(oe){if(!((oe=String(oe)).length>100)){var fe=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(oe);if(fe){var ye=parseFloat(fe[1]);switch((fe[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*ye;case"weeks":case"week":case"w":return 6048e5*ye;case"days":case"day":case"d":return ye*E;case"hours":case"hour":case"hrs":case"hr":case"h":return ye*ce;case"minutes":case"minute":case"mins":case"min":case"m":return ye*Le;case"seconds":case"second":case"secs":case"sec":case"s":return ye*A;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return ye;default:return}}}}(oe);if("number"===ye&&isFinite(oe))return fe.long?function(oe){var fe=Math.abs(oe);return fe>=E?pe(oe,fe,E,"day"):fe>=ce?pe(oe,fe,ce,"hour"):fe>=Le?pe(oe,fe,Le,"minute"):fe>=A?pe(oe,fe,A,"second"):oe+" ms"}(oe):function(oe){var fe=Math.abs(oe);return fe>=E?Math.round(oe/E)+"d":fe>=ce?Math.round(oe/ce)+"h":fe>=Le?Math.round(oe/Le)+"m":fe>=A?Math.round(oe/A)+"s":oe+"ms"}(oe);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(oe))}}},Ne={};function He(De){var ge=Ne[De];if(void 0!==ge)return ge.exports;var A=Ne[De]={exports:{}};return ve[De](A,A.exports,He),A.exports}ge=Object.getPrototypeOf?function(A){return Object.getPrototypeOf(A)}:function(A){return A.__proto__},He.t=function(A,Le){if(1&Le&&(A=this(A)),8&Le||"object"==typeof A&&A&&(4&Le&&A.__esModule||16&Le&&"function"==typeof A.then))return A;var ce=Object.create(null);He.r(ce);var E={};De=De||[null,ge({}),ge([]),ge(ge)];for(var Me=2&Le&&A;"object"==typeof Me&&!~De.indexOf(Me);Me=ge(Me))Object.getOwnPropertyNames(Me).forEach(function(Qe){return E[Qe]=function(){return A[Qe]}});return E.default=function(){return A},He.d(ce,E),ce},He.d=function(De,ge){for(var A in ge)He.o(ge,A)&&!He.o(De,A)&&Object.defineProperty(De,A,{enumerable:!0,get:ge[A]})},He.o=function(De,ge){return Object.prototype.hasOwnProperty.call(De,ge)},He.r=function(De){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(De,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(De,"__esModule",{value:!0})};var Je={};return function(){"use strict";He.r(Je),He.d(Je,{ActionObjectType:function(){return F},ChannelType:function(){return Tr},ChildAppWindow:function(){return xo},DialogDimension:function(){return wt},ErrorCode:function(){return L},FileOpenPreference:function(){return x},FrameContexts:function(){return d},HostClientType:function(){return B},HostName:function(){return Ke},LiveShareHost:function(){return xi},NotificationTypes:function(){return qr},ParentAppWindow:function(){return Ja},SecondaryM365ContentIdName:function(){return V},TaskModuleDimension:function(){return fn},TeamType:function(){return Lt},UserSettingTypes:function(){return hr},UserTeamRole:function(){return Mt},ViewerActionTypes:function(){return Jr},app:function(){return Vt},appEntity:function(){return Kn},appInitialization:function(){return un},appInstallDialog:function(){return Zr},authentication:function(){return xn},barCode:function(){return Cr},calendar:function(){return oi},call:function(){return Ar},chat:function(){return Kr},clipboard:function(){return wr},conversations:function(){return pr},dialog:function(){return It},enablePrintCapability:function(){return Io},executeDeepLink:function(){return ki},externalAppAuthentication:function(){return qn},externalAppCardActions:function(){return Jn},files:function(){return $n},geoLocation:function(){return ei},getAdaptiveCardSchemaVersion:function(){return qa},getContext:function(){return jo},getMruTabInstances:function(){return Ai},getTabInstances:function(){return Pi},initialize:function(){return zo},initializeWithFrameContext:function(){return Oi},liveShare:function(){return Pn},location:function(){return Qn},logs:function(){return Br},mail:function(){return ai},marketplace:function(){return kn},media:function(){return on},meeting:function(){return ni},meetingRoom:function(){return Zn},menus:function(){return Vn},monetization:function(){return Wn},navigateBack:function(){return Li},navigateCrossDomain:function(){return Ti},navigateToTab:function(){return Mi},notifications:function(){return Yn},openFilePreview:function(){return Ro},pages:function(){return rt},people:function(){return si},print:function(){return vi},profile:function(){return ui},registerAppButtonClickHandler:function(){return Bo},registerAppButtonHoverEnterHandler:function(){return Ci},registerAppButtonHoverLeaveHandler:function(){return kr},registerBackButtonHandler:function(){return wi},registerBeforeUnloadHandler:function(){return bi},registerChangeSettingsHandler:function(){return Ei},registerCustomHandler:function(){return Oo},registerFocusEnterHandler:function(){return Si},registerFullScreenHandler:function(){return Gn},registerOnLoadHandler:function(){return yi},registerOnThemeChangeHandler:function(){return jt},registerUserSettingsChangeHandler:function(){return Na},remoteCamera:function(){return Xn},returnFocus:function(){return Ri},search:function(){return li},secondaryBrowser:function(){return ti},sendCustomEvent:function(){return La},sendCustomMessage:function(){return Ta},setFrameContext:function(){return Fi},settings:function(){return zn},shareDeepLink:function(){return Di},sharing:function(){return fi},stageView:function(){return Sn},tasks:function(){return jn},teams:function(){return er},teamsCore:function(){return pn},thirdPartyCloudStorage:function(){return Dr},uploadCustomApp:function(){return Ma},version:function(){return sr},videoEffects:function(){return sn},videoEffectsEx:function(){return tr},visualMedia:function(){return Er},webStorage:function(){return Pr}});var ce,E,t,De=(0,He(302).debug)("teamsJs");function ge(t){return De.extend(t)}function A(t,r){return t+"_"+r}function Le(t){return/^v\d+_[\w.]+$/.test(t)}(t=ce||(ce={})).V_0="v0",t.V_1="v1",t.V_2="v2",t.V_3="v3",function(t){t.App_GetContext="app.getContext",t.App_Initialize="app.initialize",t.App_NotifyAppLoaded="app.notifyAppLoaded",t.App_NotifyExpectedFailure="app.notifyExpectedFailure",t.App_NotifyFailure="app.notifyFailure",t.App_NotifySuccess="app.notifySuccess",t.App_OpenLink="app.openLink",t.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",t.AppEntity_SelectAppEntity="appEntity.selectAppEntity",t.BarCode_HasPermission="barCode.hasPermission",t.BarCode_RequestPermission="barCode.requestPermission",t.BarCode_ScanBarCode="barCode.scanBarCode",t.Calendar_ComposeMeeting="calendar.composeMeeting",t.Calendar_OpenCalendarItem="calendar.openCalendarItem",t.Call_StartCall="call.startCall",t.Clipboard_Read="clipboard.read",t.Clipboard_Write="clipboard.write",t.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",t.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",t.Dialog_Update_Resize="dialog.update.resize",t.Dialog_Url_Bot_Open="dialog.url.bot.open",t.Dialog_Url_Open="dialog.url.open",t.Dialog_Url_Submit="dialog.url.submit",t.Dialog_Url_SendMessageToParentFromDialog="dialog.url.sendMessageToParentFromDialog",t.Dialog_Url_SendMessageToDialog="dialog.url.sendMessageToDialog",t.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",t.GeoLocation_HasPermission="geoLocation.hasPermission",t.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",t.GeoLocation_RequestPermission="geoLocation.hasPermission",t.GeoLocation_ShowLocation="geoLocation.showLocation",t.Location_GetLocation="location.getLocation",t.Location_ShowLocation="location.showLocation",t.Mail_ComposeMail="mail.composeMail",t.Mail_OpenMailItem="mail.openMailItem",t.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",t.Marketplace_GetCart="marketplace.getCart",t.Marketplace_RemoveCardItems="marketplace.removeCartItems",t.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",t.Media_CaptureImage="media.captureImage",t.Media_Controller="media.controller",t.Media_GetMedia="media.getMedia",t.Media_HasPermission="media.hasPermission",t.Media_RequestPermission="media.requestPermission",t.Media_ScanBarCode="media.scanBarCode",t.Media_SelectMedia="media.selectMedia",t.Media_ViewImages="media.viewImages",t.Navigation_NavigateBack="navigation.navigateBack",t.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",t.Navigation_NavigateToTab="navigation.navigateToTab",t.Navigation_ReturnFocus="navigation.returnFocus",t.Pages_AppButton_OnClick="pages.appButton.onClick",t.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",t.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",t.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",t.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",t.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",t.Pages_Config_RegisterOnRemoveHandlerHelper="pages.config.registerOnRemoveHandlerHelper",t.Pages_Config_RegisterOnSaveHandlerHelper="pages.config.registerOnSaveHandlerHelper",t.Pages_Config_SetConfig="pages.config.setConfig",t.Pages_Config_SetValidityState="pages.config.setValidityState",t.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",t.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",t.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",t.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",t.Pages_GetConfig="pages.getConfig.",t.Pages_NavigateCrossDomain="pages.navigateCrossDomain",t.Pages_NavigateToApp="pages.navigateToApp",t.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",t.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",t.Pages_ReturnFocus="pages.returnFocus",t.Pages_SetCurrentFrame="pages.setCurrentFrame",t.Pages_ShareDeepLink="pages.shareDeepLink",t.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",t.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",t.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",t.PublicAPIs_ExecuteDeepLink="executeDeepLink",t.PublicAPIs_GetContext="getContext",t.PublicAPIs_GetMruTabInstances="getMruTabInstances",t.PublicAPIs_GetTabInstances="getTabInstances",t.PublicAPIs_Initialize="initialize",t.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",t.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",t.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",t.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",t.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",t.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",t.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",t.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",t.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",t.PublicAPIs_SetFrameContext="setFrameContext",t.PublicAPIs_ShareDeepLink="shareDeepLink",t.RegisterHandler="registerHandler",t.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",t.Settings_Remove_Failure="settings.remove.failure",t.Settings_Remove_Success="settings.remove.success",t.Settings_Save_Failure="settings.save.failure",t.Settings_Save_Success="settings.save.success",t.Tasks_StartTask="tasks.startTask",t.Tasks_SubmitTask="tasks.submitTask",t.Tasks_UpdateTask="tasks.updateTask"}(E||(E={}));var Me=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com"]}'),Qe="2.0.1",oe="1.8.0",fe=He.t(Me,2).validOrigins,ye=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),Ve=/^https:\/\//,re="https",ae="teams.microsoft.com",se="The library has not yet been initialized",de="The runtime has not yet been initialized",We="The runtime version is not supported",H=function(){};H.initializeCalled=!1,H.initializeCompleted=!1,H.additionalValidOrigins=[],H.initializePromise=void 0,H.isFramelessWindow=!1,H.frameContext=void 0,H.hostClientType=void 0,H.printCapabilityEnabled=!1;var J,he={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},me=new Uint8Array(16);function Ge(){if(!J&&!(J=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return J(me)}for(var Te=[],ct=0;ct<256;++ct)Te.push((ct+256).toString(16).slice(1));var x,F,V,L,X,K,B,Ke,d,Lt,Mt,wt,je=function(r,s,u){if(he.randomUUID&&!s&&!r)return he.randomUUID();var a=(r=r||{}).random||(r.rng||Ge)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s){u=u||0;for(var c=0;c<16;++c)s[u+c]=a[c];return s}return function(t,r){return void 0===r&&(r=0),(Te[t[r+0]]+Te[t[r+1]]+Te[t[r+2]]+Te[t[r+3]]+"-"+Te[t[r+4]]+Te[t[r+5]]+"-"+Te[t[r+6]]+Te[t[r+7]]+"-"+Te[t[r+8]]+Te[t[r+9]]+"-"+Te[t[r+10]]+Te[t[r+11]]+Te[t[r+12]]+Te[t[r+13]]+Te[t[r+14]]+Te[t[r+15]]).toLowerCase()}(a)};(function(t){t.Inline="inline",t.Desktop="desktop",t.Web="web"})(x||(x={})),function(t){t.M365Content="m365content"}(F||(F={})),function(t){t.DriveId="driveId",t.GroupId="groupId",t.SiteId="siteId",t.UserId="userId"}(V||(V={})),function(t){t[t.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t[t.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",t[t.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",t[t.NETWORK_ERROR=2e3]="NETWORK_ERROR",t[t.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",t[t.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",t[t.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",t[t.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",t[t.THROTTLE=7e3]="THROTTLE",t[t.USER_ABORT=8e3]="USER_ABORT",t[t.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",t[t.OLD_PLATFORM=9e3]="OLD_PLATFORM",t[t.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",t[t.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(L||(L={})),function(t){t.GeoLocation="geolocation",t.Media="media"}(X||(X={})),function(t){t.TextPlain="text/plain",t.TextHtml="text/html",t.ImagePNG="image/png",t.ImageJPEG="image/jpeg"}(K||(K={})),function(t){t.desktop="desktop",t.web="web",t.android="android",t.ios="ios",t.ipados="ipados",t.macos="macos",t.rigel="rigel",t.surfaceHub="surfaceHub",t.teamsRoomsWindows="teamsRoomsWindows",t.teamsRoomsAndroid="teamsRoomsAndroid",t.teamsPhones="teamsPhones",t.teamsDisplays="teamsDisplays"}(B||(B={})),function(t){t.office="Office",t.outlook="Outlook",t.outlookWin32="OutlookWin32",t.orange="Orange",t.places="Places",t.teams="Teams",t.teamsModern="TeamsModern"}(Ke||(Ke={})),function(t){t.settings="settings",t.content="content",t.authentication="authentication",t.remove="remove",t.task="task",t.sidePanel="sidePanel",t.stage="stage",t.meetingStage="meetingStage"}(d||(d={})),function(t){t[t.Standard=0]="Standard",t[t.Edu=1]="Edu",t[t.Class=2]="Class",t[t.Plc=3]="Plc",t[t.Staff=4]="Staff"}(Lt||(Lt={})),function(t){t[t.Admin=0]="Admin",t[t.User=1]="User",t[t.Guest=2]="Guest"}(Mt||(Mt={})),function(t){t.Large="large",t.Medium="medium",t.Small="small"}(wt||(wt={}));var Tr,fn=wt;!function(t){t.Regular="Regular",t.Private="Private",t.Shared="Shared"}(Tr||(Tr={}));var U={errorCode:L.NOT_SUPPORTED_ON_PLATFORM},On={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},ra=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),zt=new Error("Invalid response: Received more images than the specified max limit in the response.");function Yt(t){return function(r,s){if(!r)throw new Error(t||s)}}function St(t,r){if("string"!=typeof t||"string"!=typeof r)return NaN;var s=t.split("."),u=r.split(".");function a(p){return/^\d+$/.test(p)}if(!s.every(a)||!u.every(a))return NaN;for(;s.length<u.length;)s.push("0");for(;u.length<s.length;)u.push("0");for(var c=0;c<s.length;++c)if(Number(s[c])!=Number(u[c]))return Number(s[c])>Number(u[c])?1:-1;return 0}function nr(){return je()}function Lr(t){return Object.keys(t).forEach(function(r){"object"==typeof t[r]&&Lr(t[r])}),Object.freeze(t)}function vn(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];var c=t.apply(void 0,u);return c.then(function(){r&&r(null)}).catch(function(p){r&&r(p)}),c}function Ln(t){return!(St(t.majorVersion+"."+t.minorVersion,"1.5")>=0)}function Cn(t){return"https:"===t.protocol}function dn(t,r){return new Promise(function(s,u){t||u("MimeType cannot be null or empty."),r||u("Base64 string cannot be null or empty.");var a=atob(r);if(t.startsWith("image/")){for(var c=new Uint8Array(a.length),p=0;p<a.length;p++)c[p]=a.charCodeAt(p);s(new Blob([c],{type:t}))}s(new Blob([a],{type:t}))})}function Nn(t){return new Promise(function(r,s){0===t.size&&s(new Error("Blob cannot be empty."));var u=new FileReader;u.onloadend=function(){u.result?r(u.result.toString().split(",")[1]):s(new Error("Failed to read the blob"))},u.onerror=function(){s(u.error)},u.readAsDataURL(t)})}function nt(){if(gt())throw new Error("window object undefined at SSR check");return window}function gt(){return typeof window>"u"}var Bt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function at(t){if(!Bt.test(t))throw new Error("App ID is not valid. Must be GUID format. App ID: "+t)}var Tt=ge("runtime"),yt=3;function Xt(t){return t.apiVersion===yt}var l={apiVersion:-1,supports:{}},Zi={apiVersion:3,hostVersionsInfo:On,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},Nr=[B.desktop,B.web,B.rigel,B.surfaceHub,B.teamsRoomsWindows,B.teamsRoomsAndroid,B.teamsPhones,B.teamsDisplays],xr=[].concat(Nr,[B.android,B.ios,B.ipados]);var ia=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(r){var s;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:r.isLegacyTeams,supports:Object.assign(Object.assign({},r.supports),{dialog:r.supports.dialog?{card:void 0,url:r.supports.dialog,update:null===(s=r.supports.dialog)||void 0===s?void 0:s.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(r){var a=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(r.supports,["appNotification"]);return Object.assign(Object.assign({},r),{apiVersion:3,supports:a})}}],Vr={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:Nr}],"1.9.0":[{capability:{location:{}},hostClientTypes:xr}],"2.0.0":[{capability:{people:{}},hostClientTypes:xr},{capability:{sharing:{}},hostClientTypes:[B.desktop,B.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[B.android,B.desktop,B.ios,B.teamsRoomsAndroid,B.teamsPhones,B.teamsDisplays,B.web]},{capability:{webStorage:{}},hostClientTypes:[B.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[B.android,B.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[B.android,B.ios]}]},wn=Tt.extend("generateBackCompatRuntimeConfig");function Ur(t,r){var s=Object.assign({},t);for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&("object"!=typeof r[u]||Array.isArray(r[u])?u in t||(s[u]=r[u]):s[u]=Ur(t[u]||{},r[u]));return s}function ir(t,r,s){wn("generating back compat runtime config for %s",t);var u=Object.assign({},r.supports);wn("Supported capabilities in config before updating based on highestSupportedVersion: %o",u),Object.keys(s).forEach(function(c){St(t,c)>=0&&s[c].forEach(function(p){void 0!==H.hostClientType&&p.hostClientTypes.includes(H.hostClientType)&&(u=Ur(u,p.capability))})});var a={apiVersion:yt,hostVersionsInfo:On,isLegacyTeams:!0,supports:u};return wn("Runtime config after updating based on highestSupportedVersion: %o",a),a}var or=Tt.extend("applyRuntimeConfig");function ar(t){"string"==typeof t.apiVersion&&(or("Trying to apply runtime with string apiVersion, processing as v1: %o",t),t=Object.assign(Object.assign({},t),{apiVersion:1})),or("Fast-forwarding runtime %o",t);var r=function(t){var r=t;if(r.apiVersion<yt&&ia.forEach(function(s){r.apiVersion===s.versionToUpgradeFrom&&(r=s.upgradeToNextVersion(r))}),Xt(r))return r;throw new Error("Received a runtime that could not be upgraded to the latest version")}(t);or("Applying runtime %o",r),l=Lr(r)}var sr="2.19.0",Xi=ge("internal"),oa=Xi.extend("ensureInitializeCalled"),aa=Xi.extend("ensureInitialized");function qt(){if(!H.initializeCalled)throw oa(se),new Error(se)}function b(t){if(!H.initializeCompleted)throw aa("%s. initializeCalled: %s",se,H.initializeCalled.toString()),new Error(se);for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];if(s&&s.length>0){for(var a=!1,c=0;c<s.length;c++)if(s[c]===H.frameContext){a=!0;break}if(!a)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(s)+'. Current context: "'+H.frameContext+'".')}return function(t){if(Xt(t))return!0;throw-1===t.apiVersion?new Error(de):new Error(We)}(t)}function xt(t){void 0===t&&(t=Qe);var r=St(H.clientSupportedSDKVersion,t);return!isNaN(r)&&r>=0}function Ki(){return H.hostClientType==B.android||H.hostClientType==B.ios||H.hostClientType==B.ipados}function ur(t){if(void 0===t&&(t=Qe),!Ki())throw{errorCode:L.NOT_SUPPORTED_ON_PLATFORM};if(!xt(t))throw{errorCode:L.OLD_PLATFORM}}function qe(t){return null==t}var xn,eo=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})},gn=[],yn=ge("validateOrigin");function to(){return eo(this,void 0,void 0,$().mark(function t(){return $().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",0!==gn.length?gn:gt()?(gn=fe,fe):fetch(ye).then(function(u){if(!u.ok)throw new Error("Invalid Response from Fetch Call");return u.json().then(function(a){if(la(JSON.stringify(a)))return gn=a.validOrigins;throw new Error("Valid Origins List Is Invalid")})}).catch(function(u){return yn("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",u),gn=fe}));case 1:case"end":return s.stop()}},t)}))}function la(t){var r=JSON.parse(t);try{r=JSON.parse(t)}catch{return!1}if(!r.validOrigins)return!1;for(var u,s=M(r.validOrigins);!(u=s()).done;){var a=u.value;try{new URL("https://"+a)}catch{return yn("isValidOriginsFromCDN call failed to validate origin: %s",a),!1}}return!0}function Jt(t,r){if("*."===t.substring(0,2)){var s=t.substring(1);if(r.length>s.length&&r.split(".").length===s.split(".").length&&r.substring(r.length-s.length)===s)return!0}else if(t===r)return!0;return!1}function fa(t){return to().then(function(r){if(!Cn(t))return yn("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",t,t.protocol),!1;var s=t.host;if(r.some(function(p){return Jt(p,s)}))return!0;for(var a,u=M(H.additionalValidOrigins);!(a=u()).done;){var c=a.value;if(Jt("https://"===c.substring(0,8)?c.substring(8):c,s))return!0}return yn("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",t,r,H.additionalValidOrigins),!1})}!function(t){var r,s,u,k;function c(k){return new Promise(function(j,ee){if(H.hostClientType===B.desktop||H.hostClientType===B.android||H.hostClientType===B.ios||H.hostClientType===B.ipados||H.hostClientType===B.macos||H.hostClientType===B.rigel||H.hostClientType===B.teamsRoomsWindows||H.hostClientType===B.teamsRoomsAndroid||H.hostClientType===B.teamsPhones||H.hostClientType===B.teamsDisplays||H.hostClientType===B.surfaceHub){var W=document.createElement("a");W.href=k.url,j(Ut("authentication.authenticate",[W.href,k.width,k.height,k.isExternal]).then(function(Pe){var bt=Pe[1];if(Pe[0])return bt;throw new Error(bt)}))}else r={success:j,fail:ee},function(k){C();var j=k.width||600,ee=k.height||400;j=Math.min(j,z.currentWindow.outerWidth-400),ee=Math.min(ee,z.currentWindow.outerHeight-200);var W=document.createElement("a");W.href=k.url.replace("{oauthRedirectMethod}","web");var Pe=void 0!==z.currentWindow.screenLeft?z.currentWindow.screenLeft:z.currentWindow.screenX,xe=void 0!==z.currentWindow.screenTop?z.currentWindow.screenTop:z.currentWindow.screenY;z.childWindow=z.currentWindow.open(W.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+(xe+=z.currentWindow.outerHeight/2-ee/2)+", left="+(Pe+=z.currentWindow.outerWidth/2-j/2)+", width="+j+", height="+ee),z.childWindow?(h(),s=z.currentWindow.setInterval(function(){if(!z.childWindow||z.childWindow.closed)G("CancelledByUser");else{var k=z.childOrigin;try{z.childOrigin="*",_t("ping")}finally{z.childOrigin=k}}},100),we("initialize",function(){return[d.authentication,H.hostClientType]}),we("navigateCrossDomain",function(){return!1})):G("FailedToOpenWindow")}(k)})}function C(){h();try{z.childWindow&&z.childWindow.close()}finally{z.childWindow=null,z.childOrigin=null}}function h(){s&&(clearInterval(s),s=0),ht("initialize"),ht("navigateCrossDomain")}function D(k){try{r&&r.success(k)}finally{r=void 0,C()}}function G(k){try{r&&r.fail(new Error(k))}finally{r=void 0,C()}}function be(k,j,ee){if(k){var W=document.createElement("a");W.href=decodeURIComponent(k),W.host&&W.host!==nt().location.host&&"outlook.office.com"===W.host&&W.search.indexOf("client_type=Win32_Outlook")>-1&&(j&&"result"===j&&(ee&&(W.href=I(W.href,"result",ee)),z.currentWindow.location.assign(I(W.href,"authSuccess",""))),j&&"reason"===j&&(ee&&(W.href=I(W.href,"reason",ee)),z.currentWindow.location.assign(I(W.href,"authFailure",""))))}}function I(k,j,ee){var W=k.indexOf("#"),Pe=-1===W?"#":k.substr(W);return Pe=Pe+"&"+j+(""!==ee?"="+ee:""),(k=-1===W?k:k.substr(0,W))+Pe}t.initialize=function(){we("authentication.authenticate.success",D,!1),we("authentication.authenticate.failure",G,!1)},t.registerAuthenticationHandlers=function(k){u=k},t.authenticate=function(k){var j=void 0!==k,ee=j?k:u;if(!ee)throw new Error("No parameters are provided for authentication");return b(l,d.content,d.sidePanel,d.settings,d.remove,d.task,d.stage,d.meetingStage),c(ee).then(function(W){try{return ee&&ee.successCallback?(ee.successCallback(W),""):W}finally{j||(u=void 0)}}).catch(function(W){try{if(ee&&ee.failureCallback)return ee.failureCallback(W.message),"";throw W}finally{j||(u=void 0)}})},t.getAuthToken=function(k){return qt(),function(k){return new Promise(function(j){j(Ut("authentication.getAuthToken",[k?.resources,k?.claims,k?.silent]))}).then(function(j){var W=j[1];if(j[0])return W;throw new Error(W)})}(k).then(function(j){return k&&k.successCallback?(k.successCallback(j),""):j}).catch(function(j){if(k&&k.failureCallback)return k.failureCallback(j.message),"";throw j})},t.getUser=function(k){return qt(),new Promise(function(k){k(Ut("authentication.getUser"))}).then(function(k){var ee=k[1];if(k[0])return ee;throw new Error(ee)}).then(function(j){return k&&k.successCallback?(k.successCallback(j),null):j}).catch(function(j){if(k&&k.failureCallback)return k.failureCallback(j.message),null;throw j})},t.notifySuccess=function(k,j){be(j,"result",k),b(l,d.authentication),q("authentication.authenticate.success",[k]),jr(z.parentWindow,function(){return setTimeout(function(){return z.currentWindow.close()},200)})},t.notifyFailure=function(k,j){be(j,"reason",k),b(l,d.authentication),q("authentication.authenticate.failure",[k]),jr(z.parentWindow,function(){return setTimeout(function(){return z.currentWindow.close()},200)})},(k=t.DataResidency||(t.DataResidency={})).Public="public",k.EUDB="eudb",k.Other="other"}(xn||(xn={}));var It,Vn,Kt=ce.V_2;function no(t,r){if(b(l,d.content,d.sidePanel,d.task,d.meetingStage),!It.update.isSupported())throw U;ke(t,"tasks.updateTask",[r])}function _r(t,r,s,u){if(b(l,d.content,d.sidePanel,d.meetingStage),!It.url.isSupported())throw U;u&&we("messageForParent",u),ke(t,"tasks.startTask",[It.url.getDialogInfoFromUrlDialogInfo(r)],function(a,c){s?.({err:a,result:c}),ht("messageForParent")})}function ro(t,r,s,u){if(b(l,d.content,d.sidePanel,d.meetingStage),!It.url.bot.isSupported())throw U;u&&we("messageForParent",u),ke(t,"tasks.startTask",[It.url.getDialogInfoFromBotUrlDialogInfo(r)],function(a,c){s?.({err:a,result:c}),ht("messageForParent")})}function io(t,r,s){if(b(l,d.content,d.task),!It.url.isSupported())throw U;ke(t,"tasks.completeTask",[r,s?Array.isArray(s)?s:[s]:[]])}(function(t){var p,r=[];function s(p){H.frameContext&&(H.frameContext===d.task?r.push(p):ht("messageForChild"))}t.initialize=function(){we("messageForChild",s,!1)},function(p){function v(){return b(l)&&void 0!==(l.supports.dialog&&l.supports.dialog.url)}var h;function m(h){return{url:h.url,height:h.size?h.size.height:wt.Small,width:h.size?h.size.width:wt.Small,title:h.title,fallbackUrl:h.fallbackUrl}}p.open=function(h,P,D){_r(A(Kt,E.Dialog_Url_Open),h,P,D)},p.submit=function(h,P){io(A(Kt,E.Dialog_Url_Submit),h,P)},p.sendMessageToParentFromDialog=function(h){if(b(l,d.task),!v())throw U;ke(A(Kt,E.Dialog_Url_SendMessageToParentFromDialog),"messageForParent",[h])},p.sendMessageToDialog=function(h){if(b(l,d.content,d.sidePanel,d.meetingStage),!v())throw U;ke(A(Kt,E.Dialog_Url_SendMessageToDialog),"messageForChild",[h])},p.registerOnMessageFromParent=function(h){if(b(l,d.task),!v())throw U;for(ht("messageForChild"),we("messageForChild",h),r.reverse();r.length>0;)h(r.pop())},p.isSupported=v,(h=p.bot||(p.bot={})).open=function(P,D,G){ro(A(Kt,E.Dialog_Url_Bot_Open),P,D,G)},h.isSupported=function(){return b(l)&&void 0!==(l.supports.dialog&&l.supports.dialog.url&&l.supports.dialog.url.bot)},p.getDialogInfoFromUrlDialogInfo=m,p.getDialogInfoFromBotUrlDialogInfo=function(h){var P=m(h);return P.completionBotId=h.completionBotId,P}}(t.url||(t.url={})),t.isSupported=function(){return!(!b(l)||!l.supports.dialog)},(p=t.update||(t.update={})).resize=function(v){no(A(Kt,E.Dialog_Update_Resize),v)},p.isSupported=function(){return!(!b(l)||!l.supports.dialog||!l.supports.dialog.update)},function(p){function v(){var P=l.hostVersionsInfo&&l.hostVersionsInfo.adaptiveCardSchemaVersion&&!Ln(l.hostVersionsInfo.adaptiveCardSchemaVersion);return b(l)&&void 0!==(P&&l.supports.dialog&&l.supports.dialog.card)}function m(P){return{card:P.card,height:P.size?P.size.height:wt.Small,width:P.size?P.size.width:wt.Small,title:P.title}}p.open=function(P,D){if(b(l,d.content,d.sidePanel,d.meetingStage),!v())throw U;var G=m(P);ke(A(Kt,E.Dialog_AdaptiveCard_Open),"tasks.startTask",[G],function(be,I){D?.({err:be,result:I})})},p.isSupported=v,function(P){function D(){var G=l.hostVersionsInfo&&l.hostVersionsInfo.adaptiveCardSchemaVersion&&!Ln(l.hostVersionsInfo.adaptiveCardSchemaVersion);return b(l)&&void 0!==(G&&l.supports.dialog&&l.supports.dialog.card&&l.supports.dialog.card.bot)}P.open=function(G,be){if(b(l,d.content,d.sidePanel,d.meetingStage),!D())throw U;var I=function(P){var D=m(P);return D.completionBotId=P.completionBotId,D}(G);ke(A(Kt,E.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[I],function(k,j){be?.({err:k,result:j})})},P.isSupported=D}(p.bot||(p.bot={}))}(t.adaptiveCard||(t.adaptiveCard={}))})(It||(It={})),function(t){var u,a,c,h;function p(h){c&&c(h)||(b(l),q("viewConfigItemPress",[h]))}function v(h){u&&u(h)||(b(l),q("handleNavBarMenuItemPress",[h]))}function C(h){a&&a(h)||(b(l),q("handleActionMenuItemPress",[h]))}function m(){return!(!b(l)||!l.supports.menus)}(h=t.DisplayMode||(t.DisplayMode={}))[h.ifRoom=0]="ifRoom",h[h.overflowOnly=1]="overflowOnly",t.MenuItem=function(){return function(){this.enabled=!0,this.selected=!1}}(),function(h){h.dropDown="dropDown",h.popOver="popOver"}(t.MenuListType||(t.MenuListType={})),t.initialize=function(){we("navBarMenuItemPress",v,!1),we("actionMenuItemPress",C,!1),we("setModuleView",p,!1)},t.setUpViews=function(h,P){if(b(l),!m())throw U;c=P,q("setUpViews",[h])},t.setNavBarMenu=function(h,P){if(b(l),!m())throw U;u=P,q("setNavBarMenu",[h])},t.showActionMenu=function(h,P){if(b(l),!m())throw U;a=P,q("showActionMenu",[h])},t.isSupported=m}(Vn||(Vn={}));var en=ce.V_2,da=5e3,oo=ge("app");function Hr(t,r){return gt()?(oo.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(t,r,s){return new Promise(function(u,a){var c=setTimeout(a,r,s);t().then(function(p){clearTimeout(c),u(p)}).catch(function(p){clearTimeout(c),a(p)})})}(function(){return function(t,r){return new Promise(function(s){H.initializeCalled||(H.initializeCalled=!0,Be.initializeHandlers(),H.initializePromise=function(t,r){var s=this;if(et.messageListener=function(a){return Wr(s,void 0,void 0,$().mark(function c(){return $().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,So(a);case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},c)}))},z.currentWindow=z.currentWindow||nt(),z.parentWindow=z.currentWindow.parent!==z.currentWindow.self?z.currentWindow.parent:z.currentWindow.opener,(z.parentWindow||t)&&z.currentWindow.addEventListener("message",et.messageListener,!1),!z.parentWindow){var u=z.currentWindow;if(!u.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));H.isFramelessWindow=!0,u.onNativeMessage=Ao}try{return z.parentOrigin="*",Hn(r,"initialize",[sr,yt]).then(function(a){return{context:a[0],clientType:a[1],runtimeConfig:a[2],clientSupportedSDKVersion:a[3]}})}finally{z.parentOrigin=null}}(r,t).then(function(u){var c=u.clientType,p=u.runtimeConfig,v=u.clientSupportedSDKVersion,C=void 0===v?Qe:v;H.frameContext=u.context,H.hostClientType=c,H.clientSupportedSDKVersion=C;try{hn("Parsing %s",p);var m=JSON.parse(p);if(hn("Checking if %o is a valid runtime object",m??"null"),!m||!m.apiVersion)throw new Error("Received runtime config is invalid");p&&ar(m)}catch(P){if(!(P instanceof SyntaxError))throw P;try{hn("Attempting to parse %s as an SDK version",p),isNaN(St(p,Qe))||(H.clientSupportedSDKVersion=p);var h=JSON.parse(C);if(hn("givenRuntimeConfig parsed to %o",h??"null"),!h)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");ar(h)}catch(D){if(!(D instanceof SyntaxError))throw D;ar(ir(H.clientSupportedSDKVersion,Zi,Vr))}}H.initializeCompleted=!0}),xn.initialize(),Vn.initialize(),rt.config.initialize(),It.initialize()),Array.isArray(r)&&function(t){var r=H.additionalValidOrigins.concat(t.filter(function(u){return"string"==typeof u&&Ve.test(u)})),s={};r=r.filter(function(u){return!s[u]&&(s[u]=!0,!0)}),H.additionalValidOrigins=r}(r),void 0!==H.initializePromise?s(H.initializePromise):hn("GlobalVars.initializePromise is unexpectedly undefined")})}(t,r)},da,new Error("SDK initialization timed out."))}var Vt,hn=oo.extend("initializeHelper");function ao(t,r){!qe(r)&&qt(),function(t,r){Be.themeChangeHandler=r,!qe(r)&&ke(t,"registerHandler",["themeChange"])}(t,r)}function so(t,r){return new Promise(function(s){b(l,d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),s(nn(t,"executeDeepLink",r))})}!function(t){var c,r=ge("app");t.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},(c=t.FailedReason||(t.FailedReason={})).AuthFailed="AuthFailed",c.Timeout="Timeout",c.Other="Other",function(c){c.PermissionError="PermissionError",c.NotFound="NotFound",c.Throttling="Throttling",c.Offline="Offline",c.Other="Other"}(t.ExpectedFailureReason||(t.ExpectedFailureReason={})),t.isInitialized=function(){return H.initializeCompleted},t.getFrameContext=function(){return H.frameContext},function(){if(!gt()){var c=document.getElementsByTagName("script"),p=c&&c[c.length-1]&&c[c.length-1].src,v="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";p&&0!==p.length?r("teamsjs is being used from %s. %s",p,v):r("teamsjs is being used from a script tag embedded directly in your html. %s",v)}}(),t.initialize=function(c){return function(){eo(this,void 0,void 0,$().mark(function t(){return $().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,to();case 2:case"end":return s.stop()}},t)}))}(),Hr(A(en,E.App_Initialize),c)},t._initialize=function(c){z.currentWindow=c},t._uninitialize=function(){H.initializeCalled&&(Be.uninitializeHandlers(),H.initializeCalled=!1,H.initializeCompleted=!1,H.initializePromise=void 0,H.additionalValidOrigins=[],H.frameContext=void 0,H.hostClientType=void 0,H.isFramelessWindow=!1,z.currentWindow&&z.currentWindow.removeEventListener("message",et.messageListener,!1),z.currentWindow=null,z.parentWindow=null,z.parentOrigin=null,z.childWindow=null,z.childOrigin=null,et.parentMessageQueue=[],et.childMessageQueue=[],et.nextMessageId=0,et.callbacks={},et.promiseCallbacks={})},t.getContext=function(){return new Promise(function(c){qt(),c(_n(A(en,E.App_GetContext),"getContext"))}).then(function(c){return function(t){var r;return{actionInfo:t.actionInfo,app:{locale:t.locale,sessionId:t.appSessionId?t.appSessionId:"",theme:t.theme?t.theme:"default",iconPositionVertical:t.appIconPosition,osLocaleInfo:t.osLocaleInfo,parentMessageId:t.parentMessageId,userClickTime:t.userClickTime,userFileOpenPreference:t.userFileOpenPreference,host:{name:t.hostName?t.hostName:Ke.teams,clientType:t.hostClientType?t.hostClientType:B.web,sessionId:t.sessionId?t.sessionId:"",ringId:t.ringId},appLaunchId:t.appLaunchId},page:{id:t.entityId,frameContext:t.frameContext?t.frameContext:H.frameContext,subPageId:t.subEntityId,isFullScreen:t.isFullScreen,isMultiWindow:t.isMultiWindow,sourceOrigin:t.sourceOrigin},user:{id:null!==(r=t.userObjectId)&&void 0!==r?r:"",displayName:t.userDisplayName,isCallingAllowed:t.isCallingAllowed,isPSTNCallingAllowed:t.isPSTNCallingAllowed,licenseType:t.userLicenseType,loginHint:t.loginHint,userPrincipalName:t.userPrincipalName,tenant:t.tid?{id:t.tid,teamsSku:t.tenantSKU}:void 0},channel:t.channelId?{id:t.channelId,displayName:t.channelName,relativeUrl:t.channelRelativeUrl,membershipType:t.channelType,defaultOneNoteSectionId:t.defaultOneNoteSectionId,ownerGroupId:t.hostTeamGroupId,ownerTenantId:t.hostTeamTenantId}:void 0,chat:t.chatId?{id:t.chatId}:void 0,meeting:t.meetingId?{id:t.meetingId}:void 0,sharepoint:t.sharepoint,team:t.teamId?{internalId:t.teamId,displayName:t.teamName,type:t.teamType,groupId:t.groupId,templateId:t.teamTemplateId,isArchived:t.isTeamArchived,userRole:t.userTeamRole}:void 0,sharePointSite:t.teamSiteUrl||t.teamSiteDomain||t.teamSitePath||t.mySitePath||t.mySiteDomain?{teamSiteUrl:t.teamSiteUrl,teamSiteDomain:t.teamSiteDomain,teamSitePath:t.teamSitePath,teamSiteId:t.teamSiteId,mySitePath:t.mySitePath,mySiteDomain:t.mySiteDomain}:void 0}}(c)})},t.notifyAppLoaded=function(){qt(),ke(A(en,E.App_NotifyAppLoaded),t.Messages.AppLoaded,[sr])},t.notifySuccess=function(){qt(),ke(A(en,E.App_NotifySuccess),t.Messages.Success,[sr])},t.notifyFailure=function(c){qt(),ke(A(en,E.App_NotifyFailure),t.Messages.Failure,[c.reason,c.message])},t.notifyExpectedFailure=function(c){qt(),ke(A(en,E.App_NotifyExpectedFailure),t.Messages.ExpectedFailure,[c.reason,c.message])},t.registerOnThemeChangeHandler=function(c){ao(A(en,E.App_RegisterOnThemeChangeHandler),c)},t.openLink=function(c){return so(A(en,E.App_OpenLink),c)},function(c){c.registerBeforeSuspendOrTerminateHandler=function(p){if(!p)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");b(l),function(t){Be.beforeSuspendOrTerminateHandler=t,!qe(t)&&q("registerHandler",["beforeUnload"])}(p)},c.registerOnResumeHandler=function(p){if(!p)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");b(l),function(t){Be.resumeHandler=t,!qe(t)&&q("registerHandler",["load"])}(p)}}(t.lifecycle||(t.lifecycle={}))}(Vt||(Vt={}));var rt,ze=ce.V_2;function uo(t,r){return new Promise(function(s){if(b(l,d.content,d.sidePanel,d.settings,d.remove,d.task,d.stage,d.meetingStage),!rt.isSupported())throw U;s(zr(t,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",r))})}function co(t){return new Promise(function(r){if(b(l),!rt.backStack.isSupported())throw U;r(zr(t,"navigateBack","Back navigation is not supported in the current client or context."))})}function lo(t,r){return new Promise(function(s){if(b(l),!rt.tabs.isSupported())throw U;s(zr(t,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",r))})}function fo(t,r){if(b(l),!rt.isSupported())throw U;ke(t,"returnFocus",[r])}function go(t,r){return new Promise(function(s){if(b(l),!rt.tabs.isSupported())throw U;s(_n(t,"getTabInstances",r))})}function ho(t,r){return new Promise(function(s){if(b(l),!rt.tabs.isSupported())throw U;s(_n(t,"getMruTabInstances",r))})}function po(t,r){if(b(l,d.content,d.sidePanel,d.meetingStage),!rt.isSupported())throw U;ke(t,"shareDeepLink",[r.subPageId,r.subPageLabel,r.subPageWebUrl])}function cr(t,r){if(b(l,d.content),!rt.isSupported())throw U;ke(t,"setFrameContext",[r])}!function(t){function r(m){cr(A(ze,E.Pages_SetCurrentFrame),m)}function s(){return!(!b(l)||!l.supports.pages)}var m;t.returnFocus=function(m){fo(A(ze,E.Pages_ReturnFocus),m)},t.registerFocusEnterHandler=function(m){Rt(A(ze,E.Pages_RegisterFocusEnterHandler),"focusEnter",m,[],function(){if(!s())throw U})},t.setCurrentFrame=r,t.initializeWithFrameContext=function(m,h,P){Vt.initialize(P).then(function(){return h&&h()}),r(m)},t.getConfig=function(){return new Promise(function(m){if(b(l,d.content,d.settings,d.remove,d.sidePanel),!s())throw U;m(_n(A(ze,E.Pages_GetConfig),"settings.getSettings"))})},t.navigateCrossDomain=function(m){return uo(A(ze,E.Pages_NavigateCrossDomain),m)},t.navigateToApp=function(m){return new Promise(function(h){if(b(l,d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!s())throw U;var P=A(ze,E.Pages_NavigateCrossDomain);h(l.isLegacyTeams?nn(P,"executeDeepLink",function(t){var r=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(t.appId)+"/"+encodeURIComponent(t.pageId));return t.webUrl&&r.searchParams.append("webUrl",t.webUrl),(t.channelId||t.subPageId)&&r.searchParams.append("context",JSON.stringify({channelId:t.channelId,subEntityId:t.subPageId})),r.toString()}(m)):nn(P,"pages.navigateToApp",m))})},t.shareDeepLink=function(m){return po(A(ze,E.Pages_ShareDeepLink),m)},t.registerFullScreenHandler=function(m){Rt(A(ze,E.Pages_RegisterFullScreenHandler),"fullScreenChange",m,[],function(){if(!qe(m)&&!s())throw U})},t.isSupported=s,(m=t.tabs||(t.tabs={})).navigateToTab=function(h){return lo(A(ze,E.Pages_Tabs_NavigateToTab),h)},m.getTabInstances=function(h){return go(A(ze,E.Pages_Tabs_GetTabInstances),h)},m.getMruTabInstances=function(h){return ho(A(ze,E.Pages_Tabs_GetMruTabInstances),h)},m.isSupported=function(){return!(!b(l)||!l.supports.pages||!l.supports.pages.tabs)},function(m){var h,P;function D(W,Pe){!qe(W)&&b(l,d.settings),Pe&&Pe(),h=W,!qe(W)&&ke(A(ze,E.Pages_Config_RegisterOnSaveHandlerHelper),"registerHandler",["save"])}function G(W,Pe){!qe(W)&&b(l,d.remove,d.settings),Pe&&Pe(),P=W,!qe(W)&&ke(A(ze,E.Pages_Config_RegisterOnRemoveHandlerHelper),"registerHandler",["remove"])}function be(W){var Pe=new I(W);h?h(Pe):z.childWindow?_t("settings.save",[W]):Pe.notifySuccess()}m.initialize=function(){we("settings.save",be,!1),we("settings.remove",k,!1)},m.setValidityState=function(W){if(b(l,d.settings,d.remove),!ee())throw U;ke(A(ze,E.Pages_Config_SetValidityState),"settings.setValidityState",[W])},m.setConfig=function(W){return new Promise(function(Pe){if(b(l,d.content,d.settings,d.sidePanel),!ee())throw U;Pe(nn(A(ze,E.Pages_Config_SetConfig),"settings.setSettings",W))})},m.registerOnSaveHandler=function(W){D(W,function(){if(!qe(W)&&!ee())throw U})},m.registerOnSaveHandlerHelper=D,m.registerOnRemoveHandler=function(W){G(W,function(){if(!qe(W)&&!ee())throw U})},m.registerOnRemoveHandlerHelper=G,m.registerChangeConfigHandler=function(W){Rt(A(ze,E.Pages_Config_RegisterChangeConfigHandler),"changeSettings",W,[d.content],function(){if(!ee())throw U})};var I=function(){function W(xe){this.notified=!1,this.result=xe||{}}var Pe=W.prototype;return Pe.notifySuccess=function(){this.ensureNotNotified(),ke(A(ze,E.Settings_Save_Success),"settings.save.success"),this.notified=!0},Pe.notifyFailure=function(bt){this.ensureNotNotified(),ke(A(ze,E.Settings_Save_Failure),"settings.save.failure",[bt]),this.notified=!0},Pe.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},W}();function k(){var W=new j;P?P(W):z.childWindow?_t("settings.remove",[]):W.notifySuccess()}var j=function(){function W(){this.notified=!1}var Pe=W.prototype;return Pe.notifySuccess=function(){this.ensureNotNotified(),ke(A(ze,E.Settings_Remove_Success),"settings.remove.success"),this.notified=!0},Pe.notifyFailure=function(bt){this.ensureNotNotified(),ke(A(ze,E.Settings_Remove_Failure),"settings.remove.failure",[bt]),this.notified=!0},Pe.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},W}();function ee(){return!(!b(l)||!l.supports.pages||!l.supports.pages.config)}m.isSupported=ee}(t.config||(t.config={})),function(m){var h;function P(){return co(A(ze,E.Pages_BackStack_NavigateBack))}function D(I,k,j){!qe(k)&&b(l),j&&j(),h=k,!qe(k)&&ke(I,"registerHandler",["backButton"])}function G(){h&&h()||(z.childWindow?_t("backButtonPress",[]):P())}function be(){return!(!b(l)||!l.supports.pages||!l.supports.pages.backStack)}m._initialize=function(){we("backButtonPress",G,!1)},m.navigateBack=P,m.registerBackButtonHandler=function(I){D(A(ze,E.Pages_BackStack_RegisterBackButtonHandler),I,function(){if(!qe(I)&&!be())throw U})},m.registerBackButtonHandlerHelper=D,m.isSupported=be}(t.backStack||(t.backStack={})),function(m){function h(){return!(!b(l)||!l.supports.pages||!l.supports.pages.fullTrust)}m.enterFullscreen=function(){if(b(l,d.content),!h())throw U;ke(A(ze,E.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},m.exitFullscreen=function(){if(b(l,d.content),!h())throw U;ke(A(ze,E.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},m.isSupported=h}(t.fullTrust||(t.fullTrust={})),function(m){function h(){return!(!b(l)||!l.supports.pages||!l.supports.pages.appButton)}m.onClick=function(P){Rt(A(ze,E.Pages_AppButton_OnClick),"appButtonClick",P,[d.content],function(){if(!h())throw U})},m.onHoverEnter=function(P){Rt(A(ze,E.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",P,[d.content],function(){if(!h())throw U})},m.onHoverLeave=function(P){Rt(A(ze,E.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",P,[d.content],function(){if(!h())throw U})},m.isSupported=h}(t.appButton||(t.appButton={})),function(m){function h(){return!(!b(l)||!l.supports.pages||!l.supports.pages.currentApp)}m.navigateTo=function(P){return new Promise(function(D){if(b(l,d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!h())throw U;D(lt(A(ze,E.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",P))})},m.navigateToDefaultPage=function(){return new Promise(function(P){if(b(l,d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!h())throw U;P(lt(A(ze,E.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))})},m.isSupported=h}(t.currentApp||(t.currentApp={}))}(rt||(rt={}));var pa=ge("handlers"),Be=function(){function t(){}return t.initializeHandlers=function(){t.handlers.themeChange=wo,t.handlers.load=tn,t.handlers.beforeUnload=wa,rt.backStack._initialize()},t.uninitializeHandlers=function(){t.handlers={},t.themeChangeHandler=null,t.loadHandler=null,t.beforeUnloadHandler=null,t.beforeSuspendOrTerminateHandler=null,t.resumeHandler=null},t}();Be.handlers={},Be.themeChangeHandler=null,Be.loadHandler=null,Be.beforeUnloadHandler=null,Be.beforeSuspendOrTerminateHandler=null,Be.resumeHandler=null;var vo=pa.extend("callHandler");function Qr(t,r){var s=Be.handlers[t];return s?(vo("Invoking the registered handler for message %s with arguments %o",t,r),[!0,s.apply(this,r)]):z.childWindow?(_t(t,r),[!1,void 0]):(vo("Handler for action message %s not found.",t),[!1,void 0])}function we(t,r,s,u){void 0===s&&(s=!0),void 0===u&&(u=[]),r?(Be.handlers[t]=r,s&&ke(A(ce.V_0,E.RegisterHandler),"registerHandler",[t].concat(u))):delete Be.handlers[t]}function ht(t){delete Be.handlers[t]}function Co(t){return null!=Be.handlers[t]}function Rt(t,r,s,u,a){s&&b.apply(void 0,[l].concat(u)),a&&a(),we(r,s)}function wo(t){Be.themeChangeHandler&&Be.themeChangeHandler(t),z.childWindow&&_t("themeChange",[t])}function tn(t){Be.resumeHandler?Be.resumeHandler(t):Be.loadHandler&&Be.loadHandler(t),z.childWindow&&_t("load",[t])}function wa(){var t=function(){q("readyToUnload",[])};Be.beforeSuspendOrTerminateHandler?(Be.beforeSuspendOrTerminateHandler(),z.childWindow?_t("beforeUnload"):t()):Be.beforeUnloadHandler&&Be.beforeUnloadHandler(t)||(z.childWindow?_t("beforeUnload"):t())}var Wr=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})},Un=ge("communication"),z=function(){},et=function(){};function _n(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];return Hn(t,r,u).then(function(c){return c[0]})}function Gr(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];return Ut(t,s).then(function(a){return a[0]})}function nn(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];return Hn(t,r,u).then(function(c){if(!c[0])throw new Error(c[1])})}function rn(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];return Ut(t,s).then(function(a){if(!a[0])throw new Error(a[1])})}function zr(t,r,s){for(var u=arguments.length,a=new Array(u>3?u-3:0),c=3;c<u;c++)a[c-3]=arguments[c];return Hn(t,r,a).then(function(p){if(!p[0])throw new Error(p[1]||s)})}function lt(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];return Hn(t,r,u).then(function(c){var p=c[0];if(p)throw p;return c[1]})}function it(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),u=1;u<r;u++)s[u-1]=arguments[u];return Ut(t,s).then(function(a){var c=a[0];if(c)throw c;return a[1]})}function Hn(t,r,s){if(void 0===s&&(s=void 0),!Le(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");return new Promise(function(u){u(yo(fr(t,r,s).id))})}function Ut(t,r){return void 0===r&&(r=void 0),new Promise(function(s){s(yo(fr(A(ce.V_0,"testing"),t,r).id))})}function yo(t){return new Promise(function(r){et.promiseCallbacks[t]=r})}function ke(t,r,s,u){var a;if(s instanceof Function?u=s:s instanceof Array&&(a=s),!Le(t))throw Error("apiVersionTag: "+t+" passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.");var c=fr(t,r,a);u&&(et.callbacks[c.id]=u)}function q(t,r,s){var u;r instanceof Function?s=r:r instanceof Array&&(u=r);var a=fr(A(ce.V_0,"testing"),t,u);s&&(et.callbacks[a.id]=s)}et.parentMessageQueue=[],et.childMessageQueue=[],et.nextMessageId=0,et.callbacks={},et.promiseCallbacks={};var Pa=Un.extend("sendMessageToParentHelper");function fr(t,r,s){var u=Pa,a=z.parentWindow,c=function(t,r,s){return{id:et.nextMessageId++,func:r,timestamp:Date.now(),args:s||[],apiversiontag:t}}(t,r,s);if(u("Message %i information: %o",c.id,{actionName:r,args:s}),H.isFramelessWindow)z.currentWindow&&z.currentWindow.nativeInterface&&(u("Sending message %i to parent via framelessPostMessage interface",c.id),z.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(c)));else{var p=gr(a);a&&p?(u("Sending message %i to parent via postMessage",c.id),a.postMessage(c,p)):(u("Adding message %i to parent message queue",c.id),dr(a).push(c))}return c}var bo=Un.extend("processMessage");function So(t){return Wr(this,void 0,void 0,$().mark(function r(){var s,u;return $().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t&&t.data&&"object"==typeof t.data){c.next=2;break}return c.abrupt("return",void bo("Unrecognized message format received by app, message being ignored. Message: %o",t));case 2:return c.abrupt("return",Aa(s=t.source||t.originalEvent&&t.originalEvent.source,u=t.origin||t.originalEvent&&t.originalEvent.origin).then(function(p){p?(Da(s,u),s===z.parentWindow?Ao(t):s===z.childWindow&&Ir(t)):bo("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}));case 4:case"end":return c.stop()}},r)}))}var Eo=Un.extend("shouldProcessMessage");function Aa(t,r){return Wr(this,void 0,void 0,$().mark(function s(){var u;return $().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!z.currentWindow||t!==z.currentWindow){c.next=2;break}return c.abrupt("return",(Eo("Should not process message because it is coming from the current window"),!1));case 2:if(!(z.currentWindow&&z.currentWindow.location&&r&&r===z.currentWindow.location.origin)){c.next=4;break}return c.abrupt("return",!0);case 4:return c.next=6,fa(new URL(r));case 6:return c.abrupt("return",((u=c.sent)||Eo("Message has an invalid origin of %s",r),u));case 8:case"end":return c.stop()}},s)}))}function Da(t,r){H.isFramelessWindow||z.parentWindow&&!z.parentWindow.closed&&t!==z.parentWindow?z.childWindow&&!z.childWindow.closed&&t!==z.childWindow||(z.childWindow=t,z.childOrigin=r):(z.parentWindow=t,z.parentOrigin=r),z.parentWindow&&z.parentWindow.closed&&(z.parentWindow=null,z.parentOrigin=null),z.childWindow&&z.childWindow.closed&&(z.childWindow=null,z.childOrigin=null),ko(z.parentWindow),ko(z.childWindow)}var Po=Un.extend("handleParentMessage");function Ao(t){var r=Po;if("id"in t.data&&"number"==typeof t.data.id){var s=t.data,u=et.callbacks[s.id];r("Received a response from parent for message %i",s.id),u&&(r("Invoking the registered callback for message %i with arguments %o",s.id,s.args),u.apply(null,[].concat(s.args,[s.isPartialResponse])),function(t){return!0===t.data.isPartialResponse}(t)||(r("Removing registered callback for message %i",s.id),delete et.callbacks[s.id]));var a=et.promiseCallbacks[s.id];a&&(r("Invoking the registered promise callback for message %i with arguments %o",s.id,s.args),a(s.args),r("Removing registered promise callback for message %i",s.id),delete et.promiseCallbacks[s.id])}else if("func"in t.data&&"string"==typeof t.data.func){var c=t.data;r("Received an action message %s from parent",c.func),Qr(c.func,c.args)}else r("Received an unknown message: %O",t)}function Ir(t){if("id"in t.data&&"func"in t.data){var r=t.data,s=Qr(r.func,r.args),a=s[1];s[0]&&void 0!==a?Fo(r.id,Array.isArray(a)?a:[a]):q(r.func,r.args,function(){if(z.childWindow){for(var c=arguments.length,p=new Array(c),v=0;v<c;v++)p[v]=arguments[v];var C=p.pop();Fo(r.id,p,C)}})}}function dr(t){return t===z.parentWindow?et.parentMessageQueue:t===z.childWindow?et.childMessageQueue:[]}function gr(t){return t===z.parentWindow?z.parentOrigin:t===z.childWindow?z.childOrigin:null}var Br,qr,Jr,hr,pr,ka=Un.extend("flushMessageQueue");function ko(t){for(var r=gr(t),s=dr(t),u=t==z.parentWindow?"parent":"child";t&&r&&s.length>0;){var a=s.shift();ka("Flushing message %i from "+u+" message queue via postMessage.",a?.id),t.postMessage(a,r)}}function jr(t,r){var s;s=z.currentWindow.setInterval(function(){0===dr(t).length&&(clearInterval(s),r())},100)}function Fo(t,r,s){var u=z.childWindow,a=function(t,r,s){return{id:t,args:r||[],isPartialResponse:s}}(t,r,s),c=gr(u);u&&c&&u.postMessage(a,c)}function _t(t,r){var s=z.childWindow,u=function(t,r){return{func:t,args:r||[]}}(t,r),a=gr(s);s&&a?s.postMessage(u,a):dr(s).push(u)}function Ma(t,r){b(l),q("uploadCustomApp",[t],r||Yt())}function Ta(t,r,s){b(l),q(t,r,s)}function La(t,r){if(b(l),!z.childWindow)throw new Error("The child window has not yet been initialized or is not present");_t(t,r)}function Oo(t,r){var s=this;b(l),we(t,function(){for(var u=arguments.length,a=new Array(u),c=0;c<u;c++)a[c]=arguments[c];return r.apply(s,a)})}function Na(t,r){b(l),we("userSettingsChange",r,!0,[t])}function Ro(t){b(l,d.content,d.task),q("openFilePreview",[t.entityId,t.title,t.description,t.type,t.objectUrl,t.downloadUrl,t.webPreviewUrl,t.webEditUrl,t.baseUrl,t.editFile,t.subEntityId,t.viewerAction,t.fileOpenPreference,t.conversationId,t.sizeInBytes])}(function(t){function r(){return!(!b(l)||!l.supports.logs)}t.registerGetLogHandler=function(s){if(!qe(s)&&b(l),!qe(s)&&!r())throw U;s?we("log.request",function(){q("log.receive",[s()])}):ht("log.request")},t.isSupported=r})(Br||(Br={})),function(t){t.fileDownloadStart="fileDownloadStart",t.fileDownloadComplete="fileDownloadComplete"}(qr||(qr={})),function(t){t.view="view",t.edit="edit",t.editNew="editNew"}(Jr||(Jr={})),function(t){t.fileOpenPreference="fileOpenPreference",t.theme="theme"}(hr||(hr={})),function(t){function r(){return!(!b(l)||!l.supports.conversations)}t.openConversation=function(s){return new Promise(function(u){if(b(l,d.content),!r())throw U;var a=rn("conversations.openConversation",{title:s.title,subEntityId:s.subEntityId,conversationId:s.conversationId,channelId:s.channelId,entityId:s.entityId});s.onStartConversation&&we("startConversation",function(c,p,v,C){var m;return null===(m=s.onStartConversation)||void 0===m?void 0:m.call(s,{subEntityId:c,conversationId:p,channelId:v,entityId:C})}),s.onCloseConversation&&we("closeConversation",function(c,p,v,C){var m;return null===(m=s.onCloseConversation)||void 0===m?void 0:m.call(s,{subEntityId:c,conversationId:p,channelId:v,entityId:C})}),u(a)})},t.closeConversation=function(){if(b(l,d.content),!r())throw U;q("conversations.closeConversation"),ht("startConversation"),ht("closeConversation")},t.getChatMembers=function(){return new Promise(function(s){if(b(l),!r())throw U;s(Gr("getChatMembers"))})},t.isSupported=r}(pr||(pr={}));var Zr;function Mo(t,r,s){if(0===t.length)throw new Error("Must have at least one user when creating a chat deep link");var u="users="+t.map(function(p){return encodeURIComponent(p)}).join(","),a=void 0===r?"":"&topicName="+encodeURIComponent(r),c=void 0===s?"":"&message="+encodeURIComponent(s);return re+"://"+ae+"/l/chat/0/0?"+u+a+c}!function(t){function r(){return!(!b(l)||!l.supports.appInstallDialog)}t.openAppInstallDialog=function(s){return new Promise(function(u){if(b(l,d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!r())throw new Error("Not supported");l.isLegacyTeams?u(rn("executeDeepLink",function(t){if(!t)throw new Error("App ID must be set when creating an app install dialog deep link");return re+"://"+ae+"/l/app/"+encodeURIComponent(t)}(s.appId))):(q("appInstallDialog.openAppInstallDialog",[s]),u())})},t.isSupported=r}(Zr||(Zr={}));var on,Ht=ce.V_1,_a=ge("media");function mr(t,r){if(null==t||null==r||t.length<=0)return null;var s=null,u=1;return t.sort(function(a,c){return a.sequence>c.sequence?1:-1}),t.forEach(function(a){a.sequence==u&&(s=s?new Blob([s,a.file],{type:r}):new Blob([a.file],{type:r}),u++)}),s}function Yr(t,r){if(null==t||null==r)return null;for(var s=atob(t.chunk),u=new Array(s.length),a=0;a<s.length;a++)u[a]=s.charCodeAt(a);var c=new Uint8Array(u),p=new Blob([c],{type:r});return{sequence:t.chunkSequence,file:p}}function Ha(t){!function(t){return!(!t||t.mediaType!=on.MediaType.VideoAndImage&&!t.videoAndImageProps)}(t)?function(t){return!(!t||t.mediaType!=on.MediaType.Video||!t.videoProps||t.videoProps.isFullScreenMode)}(t)?ur("2.0.3"):function(t){var r;return!(t?.mediaType!=on.MediaType.Image||null===(r=t?.imageProps)||void 0===r||!r.imageOutputFormats)}(t)&&ur("2.0.4"):ur("2.0.2")}function To(t){return!t||!(null===t.timeOutIntervalInSec||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec<=0||null!=t.timeOutIntervalInSec&&t.timeOutIntervalInSec>60)}!function(t){var s,c,D;(D=t.FileFormat||(t.FileFormat={})).Base64="base64",D.ID="id";var C=function(){};function m(){return!(!b(l)||!l.supports.permissions)}t.File=C,t.captureImage=function(D){if(!D)throw new Error("[captureImage] Callback cannot be null");b(l,d.content,d.task),H.isFramelessWindow?xt("1.7.0")?ke(A(Ht,E.Media_CaptureImage),"captureImage",D):D({errorCode:L.OLD_PLATFORM},[]):D({errorCode:L.NOT_SUPPORTED_ON_PLATFORM},[])},t.hasPermission=function(){if(b(l,d.content,d.task),!m())throw U;var D=X.Media;return new Promise(function(G){G(lt(A(Ht,E.Media_HasPermission),"permissions.has",D))})},t.requestPermission=function(){if(b(l,d.content,d.task),!m())throw U;var D=X.Media;return new Promise(function(G){G(lt(A(Ht,E.Media_RequestPermission),"permissions.request",D))})};var h=function(D){function G(I){var k;return k=D.call(this)||this,I&&(k.content=I.content,k.format=I.format,k.mimeType=I.mimeType,k.name=I.name,k.preview=I.preview,k.size=I.size),k}ue(G,D);var be=G.prototype;return be.getMedia=function(k){if(!k)throw new Error("[get Media] Callback cannot be null");b(l,d.content,d.task),xt(oe)?function(t,r,s){return null!=t&&null!=r&&r==on.FileFormat.ID&&null!=s}(this.mimeType,this.format,this.content)?xt("2.0.0")?this.getMediaViaCallback(k):this.getMediaViaHandler(k):k({errorCode:L.INVALID_ARGUMENTS},new Blob):k({errorCode:L.OLD_PLATFORM},new Blob)},be.getMediaViaCallback=function(k){var j={mediaMimeType:this.mimeType,assembleAttachment:[]},ee=[this.content];ke(A(Ht,E.Media_GetMedia),"getMedia",ee,function(W){if(k)if(W&&W.error)k(W.error,new Blob);else if(W&&W.mediaChunk)if(W.mediaChunk.chunkSequence<=0){var Pe=mr(j.assembleAttachment,j.mediaMimeType);k(W.error,Pe??new Blob)}else{var xe=Yr(W.mediaChunk,j.mediaMimeType);xe?j.assembleAttachment.push(xe):_a("Received a null assemble attachment for when decoding chunk sequence "+W.mediaChunk.chunkSequence+"; not including the chunk in the assembled file.")}else k({errorCode:L.INTERNAL_ERROR,message:"data received is null"},new Blob)})},be.getMediaViaHandler=function(k){var j=nr(),ee={mediaMimeType:this.mimeType,assembleAttachment:[]},W=[j,this.content];this.content&&!qe(k)&&ke(A(Ht,E.Media_GetMedia),"getMedia",W),we("getMedia"+j,function(Pe){if(k){var xe=JSON.parse(Pe);if(xe.error)k(xe.error,new Blob),ht("getMedia"+j);else if(xe.mediaChunk)if(xe.mediaChunk.chunkSequence<=0){var bt=mr(ee.assembleAttachment,ee.mediaMimeType);k(xe.error,bt??new Blob),ht("getMedia"+j)}else{var ft=Yr(xe.mediaChunk,ee.mediaMimeType);ft&&ee.assembleAttachment.push(ft)}else k({errorCode:L.INTERNAL_ERROR,message:"data received is null"},new Blob),ht("getMedia"+j)}})},G}(C);t.Media=h;var P=function(){function D(be){this.controllerCallback=be}var G=D.prototype;return G.notifyEventToHost=function(I,k){b(l,d.content,d.task);try{ur("2.0.3")}catch(ee){return void(k&&k(ee))}var j={mediaType:this.getMediaType(),mediaControllerEvent:I};ke(A(Ht,E.Media_Controller),"media.controller",[j],function(ee){k&&k(ee)})},G.stop=function(I){this.notifyEventToHost(s.StopRecording,I)},D}();t.VideoController=function(D){function G(){return D.apply(this,arguments)||this}ue(G,D);var be=G.prototype;return be.getMediaType=function(){return c.Video},be.notifyEventToApp=function(k){if(this.controllerCallback)switch(k){case s.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},G}(P),function(D){D[D.StartRecording=1]="StartRecording",D[D.StopRecording=2]="StopRecording"}(s=t.MediaControllerEvent||(t.MediaControllerEvent={})),function(D){D[D.Photo=1]="Photo",D[D.Document=2]="Document",D[D.Whiteboard=3]="Whiteboard",D[D.BusinessCard=4]="BusinessCard"}(t.CameraStartMode||(t.CameraStartMode={})),function(D){D[D.Camera=1]="Camera",D[D.Gallery=2]="Gallery"}(t.Source||(t.Source={})),function(D){D[D.Image=1]="Image",D[D.Video=2]="Video",D[D.VideoAndImage=3]="VideoAndImage",D[D.Audio=4]="Audio"}(c=t.MediaType||(t.MediaType={})),function(D){D[D.ID=1]="ID",D[D.URL=2]="URL"}(t.ImageUriType||(t.ImageUriType={})),function(D){D[D.IMAGE=1]="IMAGE",D[D.PDF=2]="PDF"}(t.ImageOutputFormats||(t.ImageOutputFormats={})),t.selectMedia=function(D,G){if(!G)throw new Error("[select Media] Callback cannot be null");if(b(l,d.content,d.task),xt(oe)){try{Ha(D)}catch(j){return void G(j,[])}if(function(t){return!(null==t||t.maxMediaCount>10)}(D)){var k=[D];ke(A(Ht,E.Media_SelectMedia),"selectMedia",k,function(j,ee,W){var Pe,xe;if(W)(function(t){return!(t.mediaType!=on.MediaType.Video||!t.videoProps||!t.videoProps.videoController)})(D)&&(null===(xe=null===(Pe=D?.videoProps)||void 0===Pe?void 0:Pe.videoController)||void 0===xe||xe.notifyEventToApp(W));else if(ee){for(var Mr,bt=[],ft=M(ee);!(Mr=ft()).done;)bt.push(new h(Mr.value));G(j,bt)}else G(j,[])})}else G({errorCode:L.INVALID_ARGUMENTS},[])}else G({errorCode:L.OLD_PLATFORM},[])},t.viewImages=function(D,G){if(!G)throw new Error("[view images] Callback cannot be null");if(b(l,d.content,d.task),xt(oe))if(function(t){return!(null==t||t.length<=0||t.length>10)}(D)){var be=[D];ke(A(Ht,E.Media_ViewImages),"viewImages",be,G)}else G({errorCode:L.INVALID_ARGUMENTS});else G({errorCode:L.OLD_PLATFORM})},t.scanBarCode=function(D,G){if(!D)throw new Error("[media.scanBarCode] Callback cannot be null");b(l,d.content,d.task),H.hostClientType!==B.desktop&&H.hostClientType!==B.web&&H.hostClientType!==B.rigel&&H.hostClientType!==B.teamsRoomsWindows&&H.hostClientType!==B.teamsRoomsAndroid&&H.hostClientType!==B.teamsPhones&&H.hostClientType!==B.teamsDisplays?xt("1.9.0")?To(G)?ke(A(Ht,E.Media_ScanBarCode),"media.scanBarCode",[G],D):D({errorCode:L.INVALID_ARGUMENTS},""):D({errorCode:L.OLD_PLATFORM},""):D({errorCode:L.NOT_SUPPORTED_ON_PLATFORM},"")}}(on||(on={}));var Cr,Kr,Xr=ce.V_2;(function(t){function r(){return!!(b(l)&&l.supports.barCode&&l.supports.permissions)}t.scanBarCode=function(s){return new Promise(function(u){if(b(l,d.content,d.task),!r())throw U;if(!To(s))throw{errorCode:L.INVALID_ARGUMENTS};u(lt(A(Xr,E.BarCode_ScanBarCode),"media.scanBarCode",s))})},t.hasPermission=function(){if(b(l,d.content,d.task),!r())throw U;var s=X.Media;return new Promise(function(u){u(lt(A(Xr,E.BarCode_HasPermission),"permissions.has",s))})},t.requestPermission=function(){if(b(l,d.content,d.task),!r())throw U;var s=X.Media;return new Promise(function(u){u(lt(A(Xr,E.BarCode_RequestPermission),"permissions.request",s))})},t.isSupported=r})(Cr||(Cr={})),function(t){function r(u){return new Promise(function(a){if(b(l,d.content,d.task),!s())throw U;a(l.isLegacyTeams?rn("executeDeepLink",Mo([u.user],void 0,u.message)):rn("chat.openChat",{members:[u.user],message:u.message}))})}function s(){return!(!b(l)||!l.supports.chat)}t.openChat=r,t.openGroupChat=function(u){return new Promise(function(a){if(u.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===u.users.length)a(r({user:u.users[0],message:u.message}));else{if(b(l,d.content,d.task),!s())throw U;a(l.isLegacyTeams?rn("executeDeepLink",Mo(u.users,u.topic,u.message)):rn("chat.openChat",{members:u.users,message:u.message,topic:u.topic}))}})},t.isSupported=s}(Kr||(Kr={}));var wr,Lo=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})},No=ce.V_2;!function(t){function r(){return!!(b(l)&&navigator&&navigator.clipboard&&l.supports.clipboard)}t.write=function(s){return Lo(this,void 0,void 0,$().mark(function u(){var c;return $().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(b(l,d.content,d.meetingStage,d.task,d.settings,d.stage,d.sidePanel),r()){v.next=2;break}throw U;case 2:if(s.type&&Object.values(K).includes(s.type)){v.next=4;break}throw new Error("Blob type "+s.type+" is not supported. Supported blob types are "+Object.values(K));case 4:return v.next=6,Nn(s);case 6:return c={mimeType:s.type,content:v.sent},v.abrupt("return",lt(A(No,E.Clipboard_Write),"clipboard.writeToClipboard",c));case 9:case"end":return v.stop()}},u)}))},t.read=function(){return Lo(this,void 0,void 0,$().mark(function s(){var u;return $().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(b(l,d.content,d.meetingStage,d.task,d.settings,d.stage,d.sidePanel),r()){c.next=2;break}throw U;case 2:if(!Ki()&&H.hostClientType!==B.macos){c.next=9;break}return c.t0=JSON,c.next=6,it("clipboard.readFromClipboard");case 6:return c.t1=c.sent,u=c.t0.parse.call(c.t0,c.t1),c.abrupt("return",dn(u.mimeType,u.content));case 9:return c.abrupt("return",lt(A(No,E.Clipboard_Read),"clipboard.readFromClipboard"));case 10:case"end":return c.stop()}},s)}))},t.isSupported=r}(wr||(wr={}));var ei,ti,bn=ce.V_2;function qa(){return l.hostVersionsInfo?l.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(t){function r(){return!!(b(l)&&l.supports.geoLocation&&l.supports.permissions)}t.getCurrentLocation=function(){if(b(l,d.content,d.task),!r())throw U;return lt(A(bn,E.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},t.hasPermission=function(){if(b(l,d.content,d.task),!r())throw U;var u=X.GeoLocation;return new Promise(function(a){a(lt(A(bn,E.GeoLocation_HasPermission),"permissions.has",u))})},t.requestPermission=function(){if(b(l,d.content,d.task),!r())throw U;var u=X.GeoLocation;return new Promise(function(a){a(lt(A(bn,E.GeoLocation_RequestPermission),"permissions.request",u))})},t.isSupported=r,function(u){function a(){return!!(b(l)&&l.supports.geoLocation&&l.supports.geoLocation.map&&l.supports.permissions)}u.chooseLocation=function(){if(b(l,d.content,d.task),!a())throw U;return lt(A(bn,E.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},u.showLocation=function(c){if(b(l,d.content,d.task),!a())throw U;if(!c)throw{errorCode:L.INVALID_ARGUMENTS};return lt(A(bn,E.GeoLocation_ShowLocation),"location.showLocation",c)},u.isSupported=a}(t.map||(t.map={}))}(ei||(ei={}));var xo=function(){function t(){}var r=t.prototype;return r.postMessage=function(u,a){b(l),q("messageForChild",[u],a||Yt())},r.addEventListener=function(u,a){b(l),"message"===u&&we("messageForParent",a)},t}(),Ja=function(){function t(){}var r=t.prototype;return r.postMessage=function(u,a){b(l,d.task),q("messageForParent",[u],a||Yt())},r.addEventListener=function(u,a){b(l,d.task),"message"===u&&we("messageForChild",a)},Ae(t,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}();!function(t){function r(){return!(!b(l)||!l.supports.secondaryBrowser)}t.open=function(s){if(b(l,d.content),!r())throw U;if(!s||!Cn(s))throw{errorCode:L.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return it("secondaryBrowser.open",s.toString())},t.isSupported=r}(ti||(ti={}));var Qn,Vo=ce.V_1;!function(t){function r(){return!(!b(l)||!l.supports.location)}t.getLocation=function(s,u){if(!u)throw new Error("[location.getLocation] Callback cannot be null");if(b(l,d.content,d.task),!xt("1.9.0"))throw{errorCode:L.OLD_PLATFORM};if(!s)throw{errorCode:L.INVALID_ARGUMENTS};if(!r())throw U;ke(A(Vo,E.Location_GetLocation),"location.getLocation",[s],u)},t.showLocation=function(s,u){if(!u)throw new Error("[location.showLocation] Callback cannot be null");if(b(l,d.content,d.task),!xt("1.9.0"))throw{errorCode:L.OLD_PLATFORM};if(!s)throw{errorCode:L.INVALID_ARGUMENTS};if(!r())throw U;ke(A(Vo,E.Location_ShowLocation),"location.showLocation",[s],u)},t.isSupported=r}(Qn||(Qn={}));var ni,Wn,ri=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};(function(t){var r,c,h;function m(h,P){b(l,d.sidePanel,d.meetingStage),q("meeting.updateMicState",[h,P])}(h=r||(r={}))[h.HostInitiated=0]="HostInitiated",h[h.AppInitiated=1]="AppInitiated",h[h.AppDeclinedToChange=2]="AppDeclinedToChange",h[h.AppFailedToChange=3]="AppFailedToChange",function(h){h.like="like",h.heart="heart",h.laugh="laugh",h.surprised="surprised",h.applause="applause"}(t.MeetingReactionType||(t.MeetingReactionType={})),function(h){h.Unknown="Unknown",h.Adhoc="Adhoc",h.Scheduled="Scheduled",h.Recurring="Recurring",h.Broadcast="Broadcast",h.MeetNow="MeetNow"}(t.MeetingType||(t.MeetingType={})),function(h){h.OneOnOneCall="oneOnOneCall",h.GroupCall="groupCall"}(t.CallType||(t.CallType={})),function(h){h.Collaborative="Collaborative",h.ScreenShare="ScreenShare"}(c=t.SharingProtocol||(t.SharingProtocol={})),t.getIncomingClientAudioState=function(h){if(!h)throw new Error("[get incoming client audio state] Callback cannot be null");b(l,d.sidePanel,d.meetingStage),q("getIncomingClientAudioState",h)},t.toggleIncomingClientAudio=function(h){if(!h)throw new Error("[toggle incoming client audio] Callback cannot be null");b(l,d.sidePanel,d.meetingStage),q("toggleIncomingClientAudio",h)},t.getMeetingDetails=function(h){if(!h)throw new Error("[get meeting details] Callback cannot be null");b(l,d.sidePanel,d.meetingStage,d.settings,d.content),q("meeting.getMeetingDetails",h)},t.getAuthenticationTokenForAnonymousUser=function(h){if(!h)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");b(l,d.sidePanel,d.meetingStage,d.task),q("meeting.getAuthenticationTokenForAnonymousUser",h)},t.getLiveStreamState=function(h){if(!h)throw new Error("[get live stream state] Callback cannot be null");b(l,d.sidePanel),q("meeting.getLiveStreamState",h)},t.requestStartLiveStreaming=function(h,P,D){if(!h)throw new Error("[request start live streaming] Callback cannot be null");b(l,d.sidePanel),q("meeting.requestStartLiveStreaming",[P,D],h)},t.requestStopLiveStreaming=function(h){if(!h)throw new Error("[request stop live streaming] Callback cannot be null");b(l,d.sidePanel),q("meeting.requestStopLiveStreaming",h)},t.registerLiveStreamChangedHandler=function(h){if(!h)throw new Error("[register live stream changed handler] Handler cannot be null");b(l,d.sidePanel),we("meeting.liveStreamChanged",h)},t.shareAppContentToStage=function(h,P,D){if(void 0===D&&(D={sharingProtocol:c.Collaborative}),!h)throw new Error("[share app content to stage] Callback cannot be null");b(l,d.sidePanel,d.meetingStage),q("meeting.shareAppContentToStage",[P,D],h)},t.getAppContentStageSharingCapabilities=function(h){if(!h)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");b(l,d.sidePanel,d.meetingStage),q("meeting.getAppContentStageSharingCapabilities",h)},t.stopSharingAppContentToStage=function(h){if(!h)throw new Error("[stop sharing app content to stage] Callback cannot be null");b(l,d.sidePanel,d.meetingStage),q("meeting.stopSharingAppContentToStage",h)},t.getAppContentStageSharingState=function(h){if(!h)throw new Error("[get app content stage sharing state] Callback cannot be null");b(l,d.sidePanel,d.meetingStage),q("meeting.getAppContentStageSharingState",h)},t.registerSpeakingStateChangeHandler=function(h){if(!h)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");b(l,d.sidePanel,d.meetingStage),we("meeting.speakingStateChanged",h)},t.registerRaiseHandStateChangedHandler=function(h){if(!h)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");b(l,d.sidePanel,d.meetingStage),we("meeting.raiseHandStateChanged",h)},t.registerMeetingReactionReceivedHandler=function(h){if(!h)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");b(l,d.sidePanel,d.meetingStage),we("meeting.meetingReactionReceived",h)},function(h){h.setOptions=function(P){b(l,d.sidePanel),P.contentUrl&&new URL(P.contentUrl),q("meeting.appShareButton.setOptions",[P])}}(t.appShareButton||(t.appShareButton={})),t.requestAppAudioHandling=function(h,P){if(!P)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!h.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");b(l,d.sidePanel,d.meetingStage),h.isAppHandlingAudio?function(h,P){var D=this;q("meeting.requestAppAudioHandling",[h.isAppHandlingAudio],function(G,be){if(G&&null!=be)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(G)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+G.errorCode+" "+G.message);if("boolean"!=typeof be)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");we("meeting.micStateChanged",function(I){return ri(D,void 0,void 0,$().mark(function k(){var j;return $().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.prev=0,W.next=3,h.micMuteStateChangedCallback(I);case 3:m(j=W.sent,j.isMicMuted===I.isMicMuted?r.HostInitiated:r.AppDeclinedToChange),W.next=10;break;case 7:W.prev=7,W.t0=W.catch(0),m(I,r.AppFailedToChange);case 10:case"end":return W.stop()}},k,null,[[0,7]])}))}),we("meeting.audioDeviceSelectionChanged",function(I){var k;null===(k=h.audioDeviceSelectionChangedCallback)||void 0===k||k.call(h,I)}),P(be)})}(h,P):function(h,P){q("meeting.requestAppAudioHandling",[h.isAppHandlingAudio],function(D,G){if(D&&null!=G)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(D)throw new Error("[requestAppAudioHandling] Callback response - SDK error "+D.errorCode+" "+D.message);if("boolean"!=typeof G)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Co("meeting.micStateChanged")&&ht("meeting.micStateChanged"),Co("meeting.audioDeviceSelectionChanged")&&ht("meeting.audioDeviceSelectionChanged"),P(G)})}(h,P)},t.updateMicState=function(h){m(h,r.AppInitiated)}})(ni||(ni={})),function(t){function r(){return!(!b(l)||!l.supports.monetization)}t.openPurchaseExperience=function(s,u){var a,c;return"function"==typeof s?(a=s,c=u):c=s,b(l,d.content),function(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];var c=t.apply(void 0,u);return c.then(function(p){r&&r(null,p)}).catch(function(p){r&&r(p,null)}),c}(function(){return new Promise(function(p){if(!r())throw U;p(it("monetization.openPurchaseExperience",c))})},a)},t.isSupported=r}(Wn||(Wn={}));var oi,ii=ce.V_2;!function(t){function r(){return!(!b(l)||!l.supports.calendar)}t.openCalendarItem=function(s){return new Promise(function(u){if(b(l,d.content),!r())throw new Error("Not supported");if(!s.itemId||!s.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");u(nn(A(ii,E.Calendar_OpenCalendarItem),"calendar.openCalendarItem",s))})},t.composeMeeting=function(s){return new Promise(function(u){if(b(l,d.content),!r())throw new Error("Not supported");u(l.isLegacyTeams?rn("executeDeepLink",function(t,r,s,u,a){var c=void 0===t?"":"attendees="+t.map(function(h){return encodeURIComponent(h)}).join(","),p=void 0===r?"":"&startTime="+encodeURIComponent(r),v=void 0===s?"":"&endTime="+encodeURIComponent(s),C=void 0===u?"":"&subject="+encodeURIComponent(u),m=void 0===a?"":"&content="+encodeURIComponent(a);return re+"://"+ae+"/l/meeting/new?"+c+p+v+C+m}(s.attendees,s.startTime,s.endTime,s.subject,s.content)):nn(A(ii,E.Calendar_ComposeMeeting),"calendar.composeMeeting",s))})},t.isSupported=r}(oi||(oi={}));var ai,pn,si,ui,Uo=ce.V_2;(function(t){function r(){return!(!b(l)||!l.supports.mail)}var u;t.openMailItem=function(u){return new Promise(function(a){if(b(l,d.content),!r())throw new Error("Not supported");if(!u.itemId||!u.itemId.trim())throw new Error("Must supply an itemId to openMailItem");a(nn(A(Uo,E.Mail_OpenMailItem),"mail.openMailItem",u))})},t.composeMail=function(u){return new Promise(function(a){if(b(l,d.content),!r())throw new Error("Not supported");a(nn(A(Uo,E.Mail_ComposeMail),"mail.composeMail",u))})},t.isSupported=r,(u=t.ComposeMailType||(t.ComposeMailType={})).New="new",u.Reply="reply",u.ReplyAll="replyAll",u.Forward="forward"})(ai||(ai={})),function(t){function r(){nt().print()}function s(c,p){!qe(c)&&b(l),!qe(c)&&p&&p(),function(t){Be.loadHandler=t,!qe(t)&&ke(A(ce.V_2,E.RegisterHandler),"registerHandler",["load"])}(c)}function u(c,p){!qe(c)&&b(l),!qe(c)&&p&&p(),function(t){Be.beforeUnloadHandler=t,!qe(t)&&ke(A(ce.V_2,E.RegisterHandler),"registerHandler",["beforeUnload"])}(c)}function a(){return!(!b(l)||!l.supports.teamsCore)}t.enablePrintCapability=function(){if(!H.printCapabilityEnabled){if(b(l),!a())throw U;H.printCapabilityEnabled=!0,document.addEventListener("keydown",function(c){(c.ctrlKey||c.metaKey)&&80===c.keyCode&&(r(),c.cancelBubble=!0,c.preventDefault(),c.stopImmediatePropagation())})}},t.print=r,t.registerOnLoadHandler=function(c){s(c,function(){if(!qe(c)&&!a())throw U})},t.registerOnLoadHandlerHelper=s,t.registerBeforeUnloadHandler=function(c){u(c,function(){if(!qe(c)&&!a())throw U})},t.registerBeforeUnloadHandlerHelper=u,t.isSupported=a}(pn||(pn={})),function(t){function r(u){return new Promise(function(a){if(!xt("2.0.0"))throw{errorCode:L.OLD_PLATFORM};if(!function(t){return!(t&&(t.title&&"string"!=typeof t.title||t.setSelected&&"object"!=typeof t.setSelected||t.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof t.openOrgWideSearchInChatOrChannel||t.singleSelect&&"boolean"!=typeof t.singleSelect))}(u))throw{errorCode:L.INVALID_ARGUMENTS};if(!s())throw U;a(it("people.selectPeople",u))})}function s(){return!(!b(l)||!l.supports.people)}t.selectPeople=function(u,a){var c,p,v;return b(l,d.content,d.task,d.settings),"function"==typeof u?(p=(c=[u,a])[0],v=c[1]):v=u,function(t,r){for(var s=arguments.length,u=new Array(s>2?s-2:0),a=2;a<s;a++)u[a-2]=arguments[a];var c=t.apply(void 0,u);return c.then(function(p){r&&r(void 0,p)}).catch(function(p){r&&r(p)}),c}(r,p,v)},t.isSupported=s}(si||(si={})),function(t){t.showProfile=function(r){return b(l,d.content),new Promise(function(s){var u=function(t){return t?t.modality&&"string"!=typeof t.modality?[!1,"modality must be a string"]:t.targetElementBoundingRect&&"object"==typeof t.targetElementBoundingRect?t.triggerType&&"string"==typeof t.triggerType?function(t){return t?t.displayName&&"string"!=typeof t.displayName?[!1,"displayName must be a string"]:t.identifiers&&"object"==typeof t.identifiers?t.identifiers.AadObjectId||t.identifiers.Smtp||t.identifiers.Upn?t.identifiers.AadObjectId&&"string"!=typeof t.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:t.identifiers.Smtp&&"string"!=typeof t.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:t.identifiers.Upn&&"string"!=typeof t.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(t.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(r);if(!u[0])throw{errorCode:L.INVALID_ARGUMENTS,message:u[1]};s(it("profile.showProfile",{modality:r.modality,persona:r.persona,triggerType:r.triggerType,targetRectangle:{x:r.targetElementBoundingRect.x,y:r.targetElementBoundingRect.y,width:r.targetElementBoundingRect.width,height:r.targetElementBoundingRect.height}}))})},t.isSupported=function(){return!(!b(l)||!l.supports.profile)}}(ui||(ui={}));var mn,an=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};function Ho(t,r,s,u){var a,c;return an(this,void 0,void 0,$().mark(function p(){var v;return $().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return v=Go(),!gt()&&(null===(c=null===(a=window.chrome)||void 0===a?void 0:a.webview)||void 0===c||c.registerTextureStream(t,v)),m.t0=yr,m.next=5,Wo(t,s,u);case 5:m.t1=m.sent,m.t2=new ci(s,r),m.t3=v.writable,(0,m.t0)(m.t1,m.t2,m.t3);case 9:case"end":return m.stop()}},p)}))}function Qo(t,r,s,u){var a,c;return an(this,void 0,void 0,$().mark(function p(){var v;return $().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return v=Go(),!gt()&&(null===(c=null===(a=window.chrome)||void 0===a?void 0:a.webview)||void 0===c||c.registerTextureStream(t,v)),m.t0=yr,m.next=5,Wo(t,s,u);case 5:m.t1=m.sent,m.t2=new Xa(s,r),m.t3=v.writable,(0,m.t0)(m.t1,m.t2,m.t3);case 9:case"end":return m.stop()}},p)}))}function Wo(t,r,s){return an(this,void 0,void 0,$().mark(function u(){var a,c;return $().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!gt()){v.next=2;break}throw U;case 2:return a=nt().chrome,v.prev=3,s?.reportGettingTextureStream(t),v.next=7,a.webview.getTextureStream(t);case 7:if(0!==(c=v.sent.getVideoTracks()).length){v.next=10;break}throw new Error("No video track in stream "+t);case 10:return v.abrupt("return",(s?.reportTextureStreamAcquired(),c[0]));case 13:throw v.prev=13,v.t0=v.catch(3),r("Failed to get video track from stream "+t+", error: "+v.t0),new Error("Internal error: can't get video track from stream "+t);case 16:case"end":return v.stop()}},u,null,[[3,13]])}))}function Go(){if(gt())throw U;var t=window.MediaStreamTrackGenerator;if(!t)throw U;return new t({kind:"video"})}function yr(t,r,s){new(nt().MediaStreamTrackProcessor)({track:t}).readable.pipeThrough(new TransformStream(r)).pipeTo(s)}!function(t){t.TimestampIsNull="timestamp of the original video frame is null",t.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(mn||(mn={}));var ci=function(r,s){var u=this;this.notifyError=r,this.videoFrameHandler=s,this.transform=function(a,c){return an(u,void 0,void 0,$().mark(function p(){var v,C,m;return $().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(null===(v=a.timestamp)){P.next=15;break}return P.prev=2,P.next=5,this.videoFrameHandler({videoFrame:a});case 5:C=P.sent,m=new VideoFrame(C,{timestamp:v}),c.enqueue(m),a.close(),C.close(),P.next=13;break;case 10:P.prev=10,P.t0=P.catch(2),a.close(),this.notifyError(P.t0);case 13:P.next=16;break;case 15:this.notifyError(mn.TimestampIsNull);case 16:case"end":return P.stop()}},p,this,[[2,10]])}))}},Za=function(){function t(r,s){if(this.headerBuffer=r,this.notifyError=s,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(r),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return Ae(t,[{key:"oneTextureLayoutId",get:function(){return this.headerDataView[0]}},{key:"version",get:function(){return this.headerDataView[1]}},{key:"frameRowOffset",get:function(){return this.headerDataView[2]}},{key:"frameFormat",get:function(){return this.headerDataView[3]}},{key:"frameWidth",get:function(){return this.headerDataView[4]}},{key:"frameHeight",get:function(){return this.headerDataView[5]}},{key:"multiStreamHeaderRowOffset",get:function(){return this.headerDataView[6]}},{key:"multiStreamCount",get:function(){return this.headerDataView[7]}}]),t}(),Ya=function(){function t(r,s){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var u=new Uint32Array(r),a=0,c=0;a<s;a++){var p=u[c++],v=u[c++],C=u[c++],m=new Uint8Array(r,v,C);this.metadataMap.set(p,m)}}return Ae(t,[{key:"audioInferenceResult",get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}]),t}(),Xa=function(r,s){var u=this;this.notifyError=r,this.videoFrameHandler=s,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(a,c){return an(u,void 0,void 0,$().mark(function p(){var v,C,m,h,D,G,be;return $().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(null===(v=a.timestamp)){k.next=22;break}return k.prev=2,k.next=5,this.extractVideoFrameAndMetadata(a);case 5:return m=(C=k.sent).videoFrame,D=(void 0===(h=C.metadata)?{}:h).audioInferenceResult,k.next=12,this.videoFrameHandler({videoFrame:m,audioInferenceResult:D});case 12:G=k.sent,be=new VideoFrame(G,{timestamp:v}),c.enqueue(be),m.close(),a.close(),G.close(),k.next=20;break;case 17:k.prev=17,k.t0=k.catch(2),a.close(),this.notifyError(k.t0);case 20:k.next=23;break;case 22:this.notifyError(mn.TimestampIsNull);case 23:case"end":return k.stop()}},p,this,[[2,17]])}))},this.extractVideoFrameAndMetadata=function(a){return an(u,void 0,void 0,$().mark(function c(){var p,v,C,m,h,P;return $().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(!gt()){G.next=2;break}throw U;case 2:if("NV12"===a.format){G.next=4;break}throw this.notifyError(mn.UnsupportedVideoFramePixelFormat),new Error(mn.UnsupportedVideoFramePixelFormat);case 4:return p={x:0,y:0,width:a.codedWidth,height:2},v=new ArrayBuffer(p.width*p.height*3/2),G.next=7,a.copyTo(v,{rect:p});case 7:return C=new Za(v,this.notifyError),m={x:0,y:C.multiStreamHeaderRowOffset,width:a.codedWidth,height:a.codedHeight-C.multiStreamHeaderRowOffset},h=new ArrayBuffer(m.width*m.height*3/2),G.next=10,a.copyTo(h,{rect:m});case 10:return P=new Ya(h,C.multiStreamCount),G.abrupt("return",{videoFrame:new VideoFrame(a,{timestamp:a.timestamp,visibleRect:{x:0,y:C.frameRowOffset,width:C.frameWidth,height:C.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:P.audioInferenceResult}});case 12:case"end":return G.stop()}},c,this)}))},we("video.mediaStream.audioInferenceDiscardStatusChange",function(a){u.shouldDiscardAudioInferenceResult=a.discardAudioInferenceResult})};function $t(t,r){return function(s,u){r?.reportApplyingVideoEffect(s||"",u),t(s,u).then(function(){r?.reportVideoEffectChanged(s||"",u),q("video.videoEffectReadiness",[!0,s,void 0,u])}).catch(function(a){q("video.videoEffectReadiness",[!1,s,a in sn.EffectFailureReason?a:sn.EffectFailureReason.InitializationFailure,u])})}}var Zt=function(){function t(){}return t.setTimeout=function(s,u){var a=performance.now(),c=nr();return t.setTimeoutCallbacks[c]={callback:s,timeoutInMs:u,startedAtInMs:a},c},t.clearTimeout=function(s){delete t.setTimeoutCallbacks[s]},t.setInterval=function(s,u){t.setTimeout(function a(){s(),t.setTimeout(a,u)},u)},t.tick=function(){var s=performance.now(),u=[];for(var a in t.setTimeoutCallbacks){var c=t.setTimeoutCallbacks[a];s-c.startedAtInMs>=c.timeoutInMs&&u.push(a)}for(var p=0,v=u;p<v.length;p++){var C=v[p];t.setTimeoutCallbacks[C].callback(),delete t.setTimeoutCallbacks[C]}},t}();Zt.setTimeoutCallbacks={};var br=function(){function t(s,u){this.reportStatisticsResult=u,this.sampleCount=0,this.distributionBins=new Uint32Array(s)}var r=t.prototype;return r.processStarts=function(u,a,c,p){Zt.tick(),this.suitableForThisSession(u,a,c,p)||this.reportAndResetSession(this.getStatistics(),u,p,a,c),this.start()},r.processEnds=function(){var u=performance.now()-this.frameProcessingStartedAt,a=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,u)));this.distributionBins[a]+=1,this.sampleCount+=1},r.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},r.start=function(){this.frameProcessingStartedAt=performance.now()},r.suitableForThisSession=function(u,a,c,p){return this.currentSession&&this.currentSession.effectId===u&&this.currentSession.effectParam===p&&this.currentSession.frameWidth===a&&this.currentSession.frameHeight===c},r.reportAndResetSession=function(u,a,c,p,v){var C=this;u&&this.reportStatisticsResult(u),this.resetCurrentSession(this.getNextTimeout(a,this.currentSession),a,c,p,v),this.timeoutId&&Zt.clearTimeout(this.timeoutId),this.timeoutId=Zt.setTimeout(function(){return C.reportAndResetSession(C.getStatistics(),a,c,p,v)}.bind(this),this.currentSession.timeoutInMs)},r.resetCurrentSession=function(u,a,c,p,v){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:u,effectId:a,effectParam:c,frameWidth:p,frameHeight:v},this.sampleCount=0,this.distributionBins.fill(0)},r.getNextTimeout=function(u,a){return a&&a.effectId===u?Math.min(t.maxSessionTimeoutInMs,2*a.timeoutInMs):t.initialSessionTimeoutInMs},t}();br.initialSessionTimeoutInMs=1e3,br.maxSessionTimeoutInMs=3e4;var Sr=function(){function t(s){var u=this;this.reportPerformanceEvent=s,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new br(t.distributionBinSize,function(a){return u.reportPerformanceEvent("video.performance.performanceDataGenerated",[a])})}var r=t.prototype;return r.startMonitorSlowFrameProcessing=function(){var u=this;Zt.setInterval(function(){if(0!==u.processedFrameCount){var a=u.frameProcessingTimeCost/u.processedFrameCount;a>u.frameProcessTimeLimit&&u.reportPerformanceEvent("video.performance.frameProcessingSlow",[a]),u.frameProcessingTimeCost=0,u.processedFrameCount=0}},t.calculateFPSInterval)},r.setFrameProcessTimeLimit=function(u){this.frameProcessTimeLimit=u},r.reportApplyingVideoEffect=function(u,a){var c,p;(null===(c=this.applyingEffect)||void 0===c?void 0:c.effectId)===u&&(null===(p=this.applyingEffect)||void 0===p?void 0:p.effectParam)===a||(this.applyingEffect={effectId:u,effectParam:a},this.appliedEffect=void 0)},r.reportVideoEffectChanged=function(u,a){void 0===this.applyingEffect||this.applyingEffect.effectId!==u&&this.applyingEffect.effectParam!==a||(this.appliedEffect={effectId:u,effectParam:a},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},r.reportStartFrameProcessing=function(u,a){Zt.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,u,a,this.appliedEffect.effectParam))},r.reportFrameProcessed=function(){var u;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(u=this.appliedEffect)||void 0===u?void 0:u.effectParam])))},r.reportGettingTextureStream=function(u){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=u},r.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var u=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,u])}},t}();Sr.distributionBinSize=1e3,Sr.calculateFPSInterval=1e3;var sn,li,fi,Sn,di=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};(function(t){var I,r=gt()?void 0:new Sr(q);function p(I){q("video.notifyError",[I])}function v(){return b(l)&&!!l.supports.video&&(!!l.supports.video.mediaStream||!!l.supports.video.sharedFrame)}function m(I,k){var j=this;return function(ee){return di(j,void 0,void 0,$().mark(function W(){var Pe,xe;return $().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return Pe=ee.videoFrame,k?.reportStartFrameProcessing(Pe.codedWidth,Pe.codedHeight),ft.next=4,I(ee);case 4:return xe=ft.sent,ft.abrupt("return",(k?.reportFrameProcessed(),xe));case 6:case"end":return ft.stop()}},W)}))}}function h(I,k){if(b(l,d.sidePanel),!v()||!be())throw U;we("video.newVideoFrame",function(j){if(j){var ee=j.timestamp;r?.reportStartFrameProcessing(j.width,j.height),I(function(I){if("videoFrameBuffer"in I)return I;var k=I.data,j=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(I,["data"]);return Object.assign(Object.assign({},j),{videoFrameBuffer:k})}(j),function(){r?.reportFrameProcessed(),function(I){q("video.videoFrameProcessed",[I])}(ee)},p)}},!1),q("video.registerForVideoFrame",[k])}function D(){var I;return b(l,d.sidePanel)&&function(){var I,k,j,ee;return!(null===(k=null===(I=nt().chrome)||void 0===I?void 0:I.webview)||void 0===k||!k.getTextureStream||null===(ee=null===(j=nt().chrome)||void 0===j?void 0:j.webview)||void 0===ee||!ee.registerTextureStream)}()&&!(null===(I=l.supports.video)||void 0===I||!I.mediaStream)}function be(){var I;return b(l,d.sidePanel)&&!(null===(I=l.supports.video)||void 0===I||!I.sharedFrame)}(t.VideoFrameFormat||(t.VideoFrameFormat={})).NV12="NV12",(I=t.EffectChangeType||(t.EffectChangeType={})).EffectChanged="EffectChanged",I.EffectDisabled="EffectDisabled",function(I){I.InvalidEffectId="InvalidEffectId",I.InitializationFailure="InitializationFailure"}(t.EffectFailureReason||(t.EffectFailureReason={})),t.registerForVideoFrame=function(I){if(b(l,d.sidePanel),!v())throw U;if(!I.videoFrameHandler||!I.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(we("video.setFrameProcessTimeLimit",function(k){return r?.setFrameProcessTimeLimit(k.timeLimit)},!1),D())!function(I,k){var j=this;if(b(l,d.sidePanel),!v()||!D())throw U;we("video.startVideoExtensibilityVideoStream",function(ee){return di(j,void 0,void 0,$().mark(function W(){var Pe,xe;return $().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return Pe=ee.streamId,xe=m(I,r),ft.next=3,Ho(Pe,xe,p,r);case 3:case"end":return ft.stop()}},W)}))},!1),q("video.mediaStream.registerForVideoFrame",[k])}(I.videoFrameHandler,I.config);else{if(!be())throw U;h(I.videoBufferHandler,I.config)}r?.startMonitorSlowFrameProcessing()},t.notifySelectedVideoEffectChanged=function(I,k){if(b(l,d.sidePanel),!v())throw U;q("video.videoEffectChanged",[I,k])},t.registerForVideoEffect=function(I){if(b(l,d.sidePanel),!v())throw U;we("video.effectParameterChange",$t(I,r),!1),q("video.registerForVideoEffect")},t.isSupported=v})(sn||(sn={})),function(t){var r="search.queryChange",s="search.queryClose",u="search.queryExecute";function a(){return!(!b(l)||!l.supports.search)}t.registerHandlers=function(c,p,v){if(b(l,d.content),!a())throw U;we(s,c),we(u,p),v&&we(r,v)},t.unregisterHandlers=function(){if(b(l,d.content),!a())throw U;q("search.unregister"),ht(r),ht(s),ht(u)},t.isSupported=a,t.closeSearch=function(){return new Promise(function(c){if(b(l,d.content),!a())throw new Error("Not supported");c(rn("search.closeSearch"))})}}(li||(li={})),function(t){function r(p){return new Promise(function(v){if(!c())throw U;v(it(t.SharingAPIMessages.shareWebContent,p))})}function c(){return!(!b(l)||!l.supports.sharing)}t.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},t.shareWebContent=function(p,v){try{(function(p){if(!(p&&p.content&&p.content.length))throw{errorCode:L.INVALID_ARGUMENTS,message:"Shared content is missing"}})(p),function(p){if(p.content.some(function(C){return!C.type}))throw{errorCode:L.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(p.content.some(function(C){return C.type!==p.content[0].type}))throw{errorCode:L.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(p),function(p){if("URL"!==p.content[0].type)throw{errorCode:L.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(p.content.some(function(C){return!C.url}))throw{errorCode:L.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(p)}catch(C){return vn(function(){return Promise.reject(C)},v)}return b(l,d.content,d.sidePanel,d.task,d.stage,d.meetingStage),vn(r,v,p)},t.isSupported=c}(fi||(fi={})),function(t){var u;function s(){return!(!b(l)||!l.supports.stageView)}(u=t.StageViewOpenMode||(t.StageViewOpenMode={})).modal="modal",u.popout="popout",u.popoutWithChat="popoutWithChat",t.open=function(u){return new Promise(function(a){if(b(l,d.content),!s())throw U;if(!u)throw new Error("[stageView.open] Stage view params cannot be null");a(it("stageView.open",u))})},t.isSupported=s}(Sn||(Sn={}));var Er,Pr,hi=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};(function(t){var u,a;(a=t.CameraRestriction||(t.CameraRestriction={}))[a.FrontOrRear=1]="FrontOrRear",a[a.FrontOnly=2]="FrontOnly",a[a.RearOnly=3]="RearOnly",function(a){a[a.Camera=1]="Camera",a[a.Gallery=2]="Gallery"}(t.Source||(t.Source={})),t.hasPermission=function(){if(b(l,d.content,d.task),!u.isSupported())throw U;return it("permissions.has",X.Media)},t.requestPermission=function(){if(b(l,d.content,d.task),!u.isSupported())throw U;return it("permissions.request",X.Media)},function(a){function c(){return!!(b(l)&&l.supports.visualMedia&&l.supports.visualMedia.image&&l.supports.permissions)}function p(){if(!c())throw U}function v(m){if(!m||m.maxVisualMediaCount>10||m.maxVisualMediaCount<1)throw ra}function C(m,h){if(h.length>m)throw zt}a.captureImages=function(m){return hi(this,void 0,void 0,$().mark(function h(){var P;return $().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return b(l,d.content,d.task),p(),v(m),G.next=3,it("visualMedia.image.captureImages",m);case 3:return G.abrupt("return",(C(m.maxVisualMediaCount,P=G.sent),P));case 5:case"end":return G.stop()}},h)}))},a.retrieveImages=function(m){return hi(this,void 0,void 0,$().mark(function h(){var P;return $().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return b(l,d.content,d.task),p(),v(m),G.next=3,it("visualMedia.image.retrieveImages",m);case 3:return G.abrupt("return",(C(m.maxVisualMediaCount,P=G.sent),P));case 5:case"end":return G.stop()}},h)}))},a.isSupported=c}(u=t.image||(t.image={}))})(Er||(Er={})),function(t){function r(){return!(!b(l)||!l.supports.webStorage)}t.isWebStorageClearedOnUserLogOut=function(){return b(l),r()},t.isSupported=r}(Pr||(Pr={}));var Ar,un,pi=ce.V_2;(function(t){var r,u;function s(){return!(!b(l)||!l.supports.call)}(u=r=t.CallModalities||(t.CallModalities={})).Unknown="unknown",u.Audio="audio",u.Video="video",u.VideoBasedScreenSharing="videoBasedScreenSharing",u.Data="data",t.startCall=function(u){var a=A(pi,E.Call_StartCall);return new Promise(function(c){var p;if(b(l,d.content,d.task),!s())throw U;if(!l.isLegacyTeams)return ke(a,"call.startCall",[u],c);c(_n(a,"executeDeepLink",function(t,r,s){if(0===t.length)throw new Error("Must have at least one target when creating a call deep link");var u="users="+t.map(function(p){return encodeURIComponent(p)}).join(","),a=void 0===r?"":"&withVideo="+encodeURIComponent(r),c=void 0===s?"":"&source="+encodeURIComponent(s);return re+"://"+ae+"/l/call/0/0?"+u+a+c}(u.targets,null===(p=u.requestedModalities)||void 0===p?void 0:p.includes(r.Video),u.source)).then(function(v){if(!v)throw new Error("The call was not properly started");return v}))})},t.isSupported=s})(Ar||(Ar={})),function(t){t.Messages=Vt.Messages,t.FailedReason=Vt.FailedReason,t.ExpectedFailureReason=Vt.ExpectedFailureReason,t.notifyAppLoaded=function(){Vt.notifyAppLoaded()},t.notifySuccess=function(){Vt.notifySuccess()},t.notifyFailure=function(r){Vt.notifyFailure(r)},t.notifyExpectedFailure=function(r){Vt.notifyExpectedFailure(r)}}(un||(un={}));var Dr,mi=ge("thirdPartyCloudStorage");!function(t){var r=[],s={fileType:"",assembleAttachment:[]},u=!0,a=null;function c(v){if(a)if(v&&v.error)a([],v.error),a=null;else if(v&&v.fileChunk)try{u||0!==v.fileChunk.chunkSequence||(mi("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),u=!0,a([],{errorCode:L.INTERNAL_ERROR,message:"error occurred while receiving data"}),r=[],a=null);var C=Yr(v.fileChunk,v.fileType);if(C?s.assembleAttachment.push(C):(mi("Received a null assemble attachment for when decoding chunk sequence "+v.fileChunk.chunkSequence+"; not including the chunk in the assembled file."),a?a([],{errorCode:L.INTERNAL_ERROR,message:"error occurred while receiving data"}):a=null,r=[],a=null,u=!0),u=v.fileChunk.endOfFile,v.fileChunk.endOfFile){var m=mr(s.assembleAttachment,s.fileType);if(m){var h=new File([m],v.fileName,{type:m.type});r.push(h)}v.isLastFile&&a&&(a(r,v.error),r=[],a=null,u=!0),s={fileType:"",assembleAttachment:[]}}}catch(P){a&&(a([],{errorCode:L.INTERNAL_ERROR,message:P}),r=[],a=null,u=!0)}else a([],{errorCode:L.INTERNAL_ERROR,message:"data received is null"}),r=[],a=null,u=!0}function p(){return!(!b(l)||!l.supports.thirdPartyCloudStorage)}t.getDragAndDropFiles=function(v,C){if(!C)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(v&&""!==v){if(b(l,d.content,d.task),!p())throw U;if(a)throw a=null,new Error("getDragAndDropFiles cannot be called twice");a=C,u=!0,q("thirdPartyCloudStorage.getDragAndDropFiles",[v],c)}else C([],{errorCode:L.INVALID_ARGUMENTS})},t.isSupported=p}(Dr||(Dr={}));var st=ce.V_1;function zo(t,r){Hr(A(st,E.PublicAPIs_Initialize),r).then(function(){t&&t()})}function Io(){pn.enablePrintCapability()}function vi(){pn.print()}function jo(t){qt(),ke(A(st,E.PublicAPIs_GetContext),"getContext",function(r){r.frameContext||(r.frameContext=H.frameContext),t(r)})}function jt(t){ao(A(st,E.PublicAPIs_RegisterOnThemeChangeHandlerHelper),t)}function Gn(t){Rt(A(st,E.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",t,[])}function Bo(t){Rt(A(st,E.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",t,[d.content])}function Ci(t){Rt(A(st,E.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",t,[d.content])}function kr(t){Rt(A(st,E.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",t,[d.content])}function wi(t){rt.backStack.registerBackButtonHandlerHelper(A(st,E.PublicAPIs_RegisterBackButtonHandler),t)}function yi(t){pn.registerOnLoadHandlerHelper(t)}function bi(t){pn.registerBeforeUnloadHandlerHelper(t)}function Si(t){Rt(A(st,E.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",t,[])}function Ei(t){Rt(A(st,E.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",t,[d.content])}function Pi(t,r){b(l),go(A(st,E.PublicAPIs_GetTabInstances),r).then(function(s){t(s)})}function Ai(t,r){b(l),ho(A(st,E.PublicAPIs_GetMruTabInstances),r).then(function(s){t(s)})}function Di(t){po(A(st,E.PublicAPIs_ShareDeepLink),{subPageId:t.subEntityId,subPageLabel:t.subEntityLabel,subPageWebUrl:t.subEntityWebUrl})}function ki(t,r){b(l,d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage);var s=r??Yt();so(A(st,E.PublicAPIs_ExecuteDeepLink),t).then(function(){s(!0)}).catch(function(u){s(!1,u.message)})}function Fi(t){cr(A(st,E.PublicAPIs_SetFrameContext),t)}function Oi(t,r,s){Hr(A(st,E.PublicAPIs_Initialize),s).then(function(){return r&&r()}),cr(A(st,E.PublicAPIs_SetFrameContext),t)}var zn,En=ce.V_1;function Ri(t){fo(A(En,E.Navigation_ReturnFocus),t)}function Mi(t,r){b(l);var s=r??Yt();lo(A(En,E.Navigation_NavigateToTab),t).then(function(){s(!0)}).catch(function(u){s(!1,u.message)})}function Ti(t,r){b(l,d.content,d.sidePanel,d.settings,d.remove,d.task,d.stage,d.meetingStage);var s=r??Yt();uo(A(En,E.Navigation_NavigateCrossDomain),t).then(function(){s(!0)}).catch(function(u){s(!1,u.message)})}function Li(t){b(l);var r=t??Yt();co(A(En,E.Navigation_NavigateBack)).then(function(){r(!0)}).catch(function(s){r(!1,s.message)})}!function(t){t.setValidityState=function(r){rt.config.setValidityState(r)},t.getSettings=function(r){b(l,d.content,d.settings,d.remove,d.sidePanel),rt.getConfig().then(function(s){r(s)})},t.setSettings=function(r,s){b(l,d.content,d.settings,d.sidePanel);var u=s??Yt();rt.config.setConfig(r).then(function(){u(!0)}).catch(function(a){u(!1,a.message)})},t.registerOnSaveHandler=function(r){rt.config.registerOnSaveHandlerHelper(r)},t.registerOnRemoveHandler=function(r){rt.config.registerOnRemoveHandlerHelper(r)}}(zn||(zn={}));var jn,Pn,In=ce.V_1;(function(t){function u(a){return a.height=a.height?a.height:fn.Small,a.width=a.width?a.width:fn.Small,a}t.startTask=function(a,c){var p=A(In,E.Tasks_StartTask),v=c?function(C){var m,h;return c(null!==(m=C.err)&&void 0!==m?m:"",null!==(h=C.result)&&void 0!==h?h:"")}:void 0;return void 0===a.card&&void 0===a.url||a.card?(b(l,d.content,d.sidePanel,d.meetingStage),ke(p,"tasks.startTask",[a],c)):void 0!==a.completionBotId?ro(p,function(a){if(void 0===a.url||void 0===a.completionBotId)throw new Error("Both url "+a.url+" and completionBotId "+a.completionBotId+" are required for bot url dialog. At least one is undefined.");return{url:a.url,size:{height:a.height?a.height:fn.Small,width:a.width?a.width:fn.Small},title:a.title,fallbackUrl:a.fallbackUrl,completionBotId:a.completionBotId}}(a),v):_r(p,function(a){if(void 0===a.url)throw new Error("url property of taskInfo object can't be undefined");return{url:a.url,size:{height:a.height?a.height:fn.Small,width:a.width?a.width:fn.Small},title:a.title,fallbackUrl:a.fallbackUrl}}(a),v),new xo},t.updateTask=function(a){var C=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(a=u(a),["width","height"]);if(Object.keys(C).length)throw new Error("resize requires a TaskInfo argument containing only width and height");no(A(In,E.Tasks_UpdateTask),a)},t.submitTask=function(a,c){io(A(In,E.Tasks_SubmitTask),a,c)},t.getDefaultSizeIfNotProvided=u})(jn||(jn={})),function(t){var u;(u=t.UserMeetingRole||(t.UserMeetingRole={})).guest="Guest",u.attendee="Attendee",u.presenter="Presenter",u.organizer="Organizer",function(u){u.added="Added",u.alreadyExists="AlreadyExists",u.conflict="Conflict",u.notFound="NotFound"}(t.ContainerState||(t.ContainerState={})),t.isSupported=function(){return!(!b(l,d.meetingStage,d.sidePanel)||!l.supports.interactive)}}(Pn||(Pn={}));var xi=function(){function t(){}var r=t.prototype;return r.getFluidTenantInfo=function(){return Qt(),new Promise(function(u){u(it("interactive.getFluidTenantInfo"))})},r.getFluidToken=function(u){return Qt(),new Promise(function(a){a(it("interactive.getFluidToken",u))})},r.getFluidContainerId=function(){return Qt(),new Promise(function(u){u(it("interactive.getFluidContainerId"))})},r.setFluidContainerId=function(u){return Qt(),new Promise(function(a){a(it("interactive.setFluidContainerId",u))})},r.getNtpTime=function(){return Qt(),new Promise(function(u){u(it("interactive.getNtpTime"))})},r.registerClientId=function(u){return Qt(),new Promise(function(a){a(it("interactive.registerClientId",u))})},r.getClientRoles=function(u){return Qt(),new Promise(function(a){a(it("interactive.getClientRoles",u))})},r.getClientInfo=function(u){return Qt(),new Promise(function(a){a(it("interactive.getClientInfo",u))})},t.create=function(){return Qt(),new t},t}();function Qt(){if(!Pn.isSupported())throw new Error("LiveShareHost Not supported")}var Vi=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function An(t){try{return t.cartItems=Fr(t.cartItems),t}catch{throw new Error("Error deserializing cart")}}function Fr(t){return t.map(function(r){if(r.imageURL){var s=new URL(r.imageURL);r.imageURL=s}return r.accessories&&(r.accessories=Fr(r.accessories)),r})}var Hi=function t(r){try{return r.map(function(s){var u=s.imageURL,a=s.accessories,c=function(r,s){var u={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&s.indexOf(a)<0&&(u[a]=r[a]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(r);c<a.length;c++)s.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(r,a[c])&&(u[a[c]]=r[a[c]])}return u}(s,["imageURL","accessories"]),p=Object.assign({},c);return u&&(p.imageURL=u.href),a&&(p.accessories=t(a)),p})}catch{throw new Error("Error serializing cart items")}};function Wi(t){if(null!=t){if(!Array.isArray(t)||0===t.length)throw new Error("CartItem.accessories must be a non-empty array");for(var s,r=M(t);!(s=r()).done;){var u=s.value;if(u.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");Or(u)}}}function Or(t){if(!t.id)throw new Error("cartItem.id must not be empty");if(!t.name)throw new Error("cartItem.name must not be empty");(function(t){if("number"!=typeof t||t<0)throw new Error("price "+t+" must be a number not less than 0");if(parseFloat(t.toFixed(3))!==t)throw new Error("price "+t+" must have at most 3 decimal places")})(t.price),function(t){if("number"!=typeof t||t<=0||parseInt(t.toString())!==t)throw new Error("quantity "+t+" must be an integer greater than 0")}(t.quantity)}function Bn(t){if(null!=t){if(!t)throw new Error("id must not be empty");if(!1===("string"==typeof(r=t)&&Vi.test(r)))throw new Error("id must be a valid UUID")}var r}var kn,qn,Jn,$n,Zn,Yn,Xn,Dn=ce.V_2;(function(t){var a;function u(){return!(!b(l)||!l.supports.marketplace)}t.cartVersion={majorVersion:1,minorVersion:1},(a=t.Intent||(t.Intent={})).TACAdminUser="TACAdminUser",a.TeamsAdminUser="TeamsAdminUser",a.TeamsEndUser="TeamsEndUser",function(a){a.Open="Open",a.Processing="Processing",a.Processed="Processed",a.Closed="Closed",a.Error="Error"}(t.CartStatus||(t.CartStatus={})),t.getCart=function(){if(b(l,d.content,d.task),!u())throw U;return lt(A(Dn,E.Marketplace_GetCart),"marketplace.getCart",t.cartVersion).then(An)},t.addOrUpdateCartItems=function(a){if(b(l,d.content,d.task),!u())throw U;if(!a)throw new Error("addOrUpdateCartItemsParams must be provided");return Bn(a?.cartId),function(t){if(!Array.isArray(t)||0===t.length)throw new Error("cartItems must be a non-empty array");for(var s,r=M(t);!(s=r()).done;){var u=s.value;Or(u),Wi(u.accessories)}}(a?.cartItems),lt(A(Dn,E.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},a),{cartItems:Hi(a.cartItems),cartVersion:t.cartVersion})).then(An)},t.removeCartItems=function(a){if(b(l,d.content,d.task),!u())throw U;if(!a)throw new Error("removeCartItemsParams must be provided");if(Bn(a?.cartId),!Array.isArray(a?.cartItemIds)||0===a?.cartItemIds.length)throw new Error("cartItemIds must be a non-empty array");return lt(A(Dn,E.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},a),{cartVersion:t.cartVersion})).then(An)},t.updateCartStatus=function(a){if(b(l,d.content,d.task),!u())throw U;if(!a)throw new Error("updateCartStatusParams must be provided");return Bn(a?.cartId),function(t){if(!Object.values(kn.CartStatus).includes(t))throw new Error("cartStatus "+t+" is not valid")}(a?.cartStatus),lt(A(Dn,E.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},a),{cartVersion:t.cartVersion})).then(An)},t.isSupported=u})(kn||(kn={})),function(t){var s,a,v,r="Action.Execute";function c(v){if(v.requestType===s.ActionExecuteInvokeRequest){if(v.type!==r)throw{errorCode:a.INTERNAL_ERROR,message:"Invalid action type "+v.type+'. Action type must be "'+r+'"'}}else if(v.requestType===s.QueryMessageExtensionRequest){if(v.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(v.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(var h,m=M(v.parameters);!(h=m()).done;){var P=h.value;if(P.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(P.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function p(){return!(!b(l)||!l.supports.externalAppAuthentication)}(v=s=t.OriginalRequestType||(t.OriginalRequestType={})).ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",v.QueryMessageExtensionRequest="QueryMessageExtensionRequest",function(v){v.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",v.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(t.InvokeResponseType||(t.InvokeResponseType={})),function(v){v.INTERNAL_ERROR="INTERNAL_ERROR"}(a=t.InvokeErrorCode||(t.InvokeErrorCode={})),t.authenticateAndResendRequest=function(v,C,m){if(b(l,d.content),!p())throw U;return at(v),c(m),Ut("externalAppAuthentication.authenticateAndResendRequest",[v,m,C.url.href,C.width,C.height,C.isExternal]).then(function(h){var D=h[1];if(h[0]&&null!=D.responseType)return D;throw D})},t.authenticateWithSSO=function(v,C){if(b(l,d.content),!p())throw U;return at(v),Ut("externalAppAuthentication.authenticateWithSSO",[v,C.claims,C.silent]).then(function(m){if(!m[0])throw m[1]})},t.authenticateWithSSOAndResendRequest=function(v,C,m){if(b(l,d.content),!p())throw U;return at(v),c(m),Ut("externalAppAuthentication.authenticateWithSSOAndResendRequest",[v,m,C.claims,C.silent]).then(function(h){var D=h[1];if(h[0]&&null!=D.responseType)return D;throw D})},t.isSupported=p}(qn||(qn={})),function(t){var c;function a(){return!(!b(l)||!l.supports.externalAppCardActions)}(c=t.ActionOpenUrlType||(t.ActionOpenUrlType={})).DeepLinkDialog="DeepLinkDialog",c.DeepLinkOther="DeepLinkOther",c.DeepLinkStageView="DeepLinkStageView",c.GenericUrl="GenericUrl",function(c){c.INTERNAL_ERROR="INTERNAL_ERROR",c.INVALID_LINK="INVALID_LINK",c.NOT_SUPPORTED="NOT_SUPPORTED"}(t.ActionOpenUrlErrorCode||(t.ActionOpenUrlErrorCode={})),function(c){c.INTERNAL_ERROR="INTERNAL_ERROR"}(t.ActionSubmitErrorCode||(t.ActionSubmitErrorCode={})),t.processActionSubmit=function(c,p){if(b(l,d.content),!a())throw U;return at(c),Ut("externalAppCardActions.processActionSubmit",[c,p]).then(function(v){if(!v[0])throw v[1]})},t.processActionOpenUrl=function(c,p){if(b(l,d.content),!a())throw U;return at(c),Ut("externalAppCardActions.processActionOpenUrl",[c,p.href]).then(function(v){var C=v[0];if(C)throw C;return v[1]})},t.isSupported=a}(Jn||(Jn={})),function(t){var C;function v(C,m){return{errorCode:C,message:m}}(C=t.CloudStorageProvider||(t.CloudStorageProvider={})).Dropbox="DROPBOX",C.Box="BOX",C.Sharefile="SHAREFILE",C.GoogleDrive="GOOGLEDRIVE",C.Egnyte="EGNYTE",C.SharePoint="SharePoint",function(C){C[C.Sharepoint=0]="Sharepoint",C[C.WopiIntegration=1]="WopiIntegration",C[C.Google=2]="Google",C[C.OneDrive=3]="OneDrive",C[C.Recent=4]="Recent",C[C.Aggregate=5]="Aggregate",C[C.FileSystem=6]="FileSystem",C[C.Search=7]="Search",C[C.AllFiles=8]="AllFiles",C[C.SharedWithMe=9]="SharedWithMe"}(t.CloudStorageProviderType||(t.CloudStorageProviderType={})),function(C){C.ClassMaterials="classMaterials"}(t.SpecialDocumentLibraryType||(t.SpecialDocumentLibraryType={})),function(C){C.Readonly="readonly"}(t.DocumentLibraryAccessType||(t.DocumentLibraryAccessType={})),function(C){C.Downloaded="Downloaded",C.Downloading="Downloading",C.Failed="Failed"}(t.FileDownloadStatus||(t.FileDownloadStatus={})),function(C){C.Download="DOWNLOAD",C.Upload="UPLOAD",C.Delete="DELETE"}(t.CloudStorageProviderFileAction||(t.CloudStorageProviderFileAction={})),t.getCloudStorageFolders=function(C,m){if(b(l,d.content),!C||0===C.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!m)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");q("files.getCloudStorageFolders",[C],m)},t.addCloudStorageFolder=function(C,m){if(b(l,d.content),!C||0===C.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!m)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");q("files.addCloudStorageFolder",[C],m)},t.deleteCloudStorageFolder=function(C,m,h){if(b(l,d.content),!C)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!m)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!h)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");q("files.deleteCloudStorageFolder",[C,m],h)},t.getCloudStorageFolderContents=function(C,m,h){if(b(l,d.content),!C||!m)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!h)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in C&&!C.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");q("files.getCloudStorageFolderContents",[C,m],h)},t.openCloudStorageFile=function(C,m,h){if(b(l,d.content),!C||!m)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(C.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");q("files.openCloudStorageFile",[C,m,h])},t.getExternalProviders=function(C,m){if(void 0===C&&(C=!1),b(l,d.content),!m)throw new Error("[files.getExternalProviders] Callback cannot be null");q("files.getExternalProviders",[C],m)},t.copyMoveFiles=function(C,m,h,P,D,G){if(void 0===D&&(D=!1),b(l,d.content),!C||0===C.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!m)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!h)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!P)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!G)throw new Error("[files.copyMoveFiles] callback cannot be null");q("files.copyMoveFiles",[C,m,h,P,D],G)},t.getFileDownloads=function(C){if(b(l,d.content),!C)throw new Error("[files.getFileDownloads] Callback cannot be null");q("files.getFileDownloads",[],C)},t.openDownloadFolder=function(C,m){if(void 0===C&&(C=void 0),b(l,d.content),!m)throw new Error("[files.openDownloadFolder] Callback cannot be null");q("files.openDownloadFolder",[C],m)},t.addCloudStorageProvider=function(C){if(b(l,d.content),!C)throw v(L.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");q("files.addCloudStorageProvider",[],C)},t.removeCloudStorageProvider=function(C,m){if(b(l,d.content),!m)throw v(L.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!C||!C.content)throw v(L.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");q("files.removeCloudStorageProvider",[C],m)},t.addCloudStorageProviderFile=function(C,m){if(b(l,d.content),!m)throw v(L.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!C||!C.content)throw v(L.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");q("files.addCloudStorageProviderFile",[C],m)},t.renameCloudStorageProviderFile=function(C,m){if(b(l,d.content),!m)throw v(L.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!C||!C.content)throw v(L.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");q("files.renameCloudStorageProviderFile",[C],m)},t.deleteCloudStorageProviderFile=function(C,m){if(b(l,d.content),!m)throw v(L.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(C&&C.content&&C.content.itemList&&C.content.itemList.length>0))throw v(L.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");q("files.deleteCloudStorageProviderFile",[C],m)},t.downloadCloudStorageProviderFile=function(C,m){if(b(l,d.content),!m)throw v(L.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(C&&C.content&&C.content.itemList&&C.content.itemList.length>0))throw v(L.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");q("files.downloadCloudStorageProviderFile",[C],m)},t.uploadCloudStorageProviderFile=function(C,m){if(b(l,d.content),!m)throw v(L.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(C&&C.content&&C.content.itemList&&C.content.itemList.length>0))throw v(L.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!C.content.destinationFolder)throw v(L.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");q("files.uploadCloudStorageProviderFile",[C],m)},t.registerCloudStorageProviderListChangeHandler=function(C){if(b(l),!C)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");we("files.cloudStorageProviderListChange",C)},t.registerCloudStorageProviderContentChangeHandler=function(C){if(b(l),!C)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");we("files.cloudStorageProviderContentChange",C)}}($n||($n={})),function(t){function r(){return!(!b(l)||!l.supports.meetingRoom)}t.getPairedMeetingRoomInfo=function(){return new Promise(function(s){if(b(l),!r())throw U;s(it("meetingRoom.getPairedMeetingRoomInfo"))})},t.sendCommandToPairedMeetingRoom=function(s){return new Promise(function(u){if(!s||0==s.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(b(l),!r())throw U;u(it("meetingRoom.sendCommandToPairedMeetingRoom",s))})},t.registerMeetingRoomCapabilitiesUpdateHandler=function(s){if(!s)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(b(l),!r())throw U;we("meetingRoom.meetingRoomCapabilitiesUpdate",function(u){b(l),s(u)})},t.registerMeetingRoomStatesUpdateHandler=function(s){if(!s)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(b(l),!r())throw U;we("meetingRoom.meetingRoomStatesUpdate",function(u){b(l),s(u)})},t.isSupported=r}(Zn||(Zn={})),function(t){function r(){return!(!b(l)||!l.supports.notifications)}t.showNotification=function(s){if(b(l,d.content),!r())throw U;q("notifications.showNotification",[s])},t.isSupported=r}(Yn||(Yn={})),function(t){var c;function a(){return!(!b(l)||!l.supports.remoteCamera)}(c=t.ControlCommand||(t.ControlCommand={})).Reset="Reset",c.ZoomIn="ZoomIn",c.ZoomOut="ZoomOut",c.PanLeft="PanLeft",c.PanRight="PanRight",c.TiltUp="TiltUp",c.TiltDown="TiltDown",function(c){c[c.CommandResetError=0]="CommandResetError",c[c.CommandZoomInError=1]="CommandZoomInError",c[c.CommandZoomOutError=2]="CommandZoomOutError",c[c.CommandPanLeftError=3]="CommandPanLeftError",c[c.CommandPanRightError=4]="CommandPanRightError",c[c.CommandTiltUpError=5]="CommandTiltUpError",c[c.CommandTiltDownError=6]="CommandTiltDownError",c[c.SendDataError=7]="SendDataError"}(t.ErrorReason||(t.ErrorReason={})),function(c){c[c.None=0]="None",c[c.ControlDenied=1]="ControlDenied",c[c.ControlNoResponse=2]="ControlNoResponse",c[c.ControlBusy=3]="ControlBusy",c[c.AckTimeout=4]="AckTimeout",c[c.ControlTerminated=5]="ControlTerminated",c[c.ControllerTerminated=6]="ControllerTerminated",c[c.DataChannelError=7]="DataChannelError",c[c.ControllerCancelled=8]="ControllerCancelled",c[c.ControlDisabled=9]="ControlDisabled",c[c.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(t.SessionTerminatedReason||(t.SessionTerminatedReason={})),t.getCapableParticipants=function(c){if(!c)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(b(l,d.sidePanel),!a())throw U;q("remoteCamera.getCapableParticipants",c)},t.requestControl=function(c,p){if(!c)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!p)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(b(l,d.sidePanel),!a())throw U;q("remoteCamera.requestControl",[c],p)},t.sendControlCommand=function(c,p){if(!c)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!p)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(b(l,d.sidePanel),!a())throw U;q("remoteCamera.sendControlCommand",[c],p)},t.terminateSession=function(c){if(!c)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(b(l,d.sidePanel),!a())throw U;q("remoteCamera.terminateSession",c)},t.registerOnCapableParticipantsChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(b(l,d.sidePanel),!a())throw U;we("remoteCamera.capableParticipantsChange",c)},t.registerOnErrorHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(b(l,d.sidePanel),!a())throw U;we("remoteCamera.handlerError",c)},t.registerOnDeviceStateChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(b(l,d.sidePanel),!a())throw U;we("remoteCamera.deviceStateChange",c)},t.registerOnSessionStatusChangeHandler=function(c){if(!c)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(b(l,d.sidePanel),!a())throw U;we("remoteCamera.sessionStatusChange",c)},t.isSupported=a}(Xn||(Xn={}));var Kn,er,ji=ce.V_1;(function(t){function r(){return!(!b(l)||!l.supports.appEntity)}t.selectAppEntity=function(s,u,a,c){if(b(l,d.content),!r())throw U;if(!s||0==s.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!c)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");ke(A(ji,E.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[s,u,a],c)},t.isSupported=r})(Kn||(Kn={})),function(t){var a;function u(){return!(!b(l)||!l.supports.teams)}(a=t.ChannelType||(t.ChannelType={}))[a.Regular=0]="Regular",a[a.Private=1]="Private",a[a.Shared=2]="Shared",t.getTeamChannels=function(a,c){if(b(l,d.content),!u())throw U;if(!a)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!c)throw new Error("[teams.getTeamChannels] Callback cannot be null");q("teams.getTeamChannels",[a],c)},t.refreshSiteUrl=function(a,c){if(b(l),!u())throw U;if(!a)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!c)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");q("teams.refreshSiteUrl",[a],c)},t.isSupported=u,function(a){function p(){return!(!b(l)||!l.supports.teams||!l.supports.teams.fullTrust)}(function(v){function C(){return!!(b(l)&&l.supports.teams&&l.supports.teams.fullTrust&&l.supports.teams.fullTrust.joinedTeams)}v.getUserJoinedTeams=function(m){return new Promise(function(h){if(b(l),!C())throw U;if((H.hostClientType===B.android||H.hostClientType===B.teamsRoomsAndroid||H.hostClientType===B.teamsPhones||H.hostClientType===B.teamsDisplays)&&!xt("2.0.1"))throw new Error(JSON.stringify({errorCode:L.OLD_PLATFORM}));h(Gr("getUserJoinedTeams",m))})},v.isSupported=C})(a.joinedTeams||(a.joinedTeams={})),a.getConfigSetting=function(v){return new Promise(function(C){if(b(l),!p())throw U;C(Gr("getConfigSetting",v))})},a.isSupported=p}(t.fullTrust||(t.fullTrust={}))}(er||(er={}));var tr,Rr=function(r,s,u,a){return new(u||(u=Promise))(function(p,v){function C(P){try{h(a.next(P))}catch(D){v(D)}}function m(P){try{h(a.throw(P))}catch(D){v(D)}}function h(P){P.done?p(P.value):function(p){return p instanceof u?p:new u(function(v){v(p)})}(P.value).then(C,m)}h((a=a.apply(r,s||[])).next())})};!function(t){t.frameProcessingTimeoutInMs=2e3;var s,m,r=gt()?void 0:new Sr(q);function u(){var m=setTimeout(function(){C("Frame not processed in "+t.frameProcessingTimeoutInMs+"ms",s.Warn)},t.frameProcessingTimeoutInMs);return function(){clearTimeout(m)}}function a(m,h){var P=this;return function(D){return Rr(P,void 0,void 0,$().mark(function G(){var be,I,k;return $().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return h.reportStartFrameProcessing((be=D.videoFrame).codedWidth,be.codedHeight),I=u(),ee.next=5,m(D);case 5:return k=ee.sent,ee.abrupt("return",(I(),h.reportFrameProcessed(),k));case 7:case"end":return ee.stop()}},G)}))}}function p(){return b(l),sn.isSupported()}function C(m,h){void 0===h&&(h=s.Warn),q("video.notifyError",[m,h])}(m=s=t.ErrorLevel||(t.ErrorLevel={})).Fatal="fatal",m.Warn="warn",t.registerForVideoFrame=function(m){var P,D,h=this;if(!p())throw U;if(!m.videoFrameHandler||!m.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(b(l,d.sidePanel)){if(we("video.setFrameProcessTimeLimit",function(G){return r?.setFrameProcessTimeLimit(G)},!1),null===(P=l.supports.video)||void 0===P?void 0:P.mediaStream)we("video.startVideoExtensibilityVideoStream",function(G){return Rr(h,void 0,void 0,$().mark(function be(){var I,k,j;return $().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(I=G.streamId,k=G.metadataInTexture,j=r?a(m.videoFrameHandler,r):m.videoFrameHandler,!k){W.next=6;break}return W.next=4,Qo(I,j,C,r);case 4:W.next=8;break;case 6:return W.next=8,Ho(I,j,C,r);case 8:case"end":return W.stop()}},be)}))},!1),q("video.mediaStream.registerForVideoFrame",[m.config]);else{if(null===(D=l.supports.video)||void 0===D||!D.sharedFrame)throw U;we("video.newVideoFrame",function(G){if(G){r?.reportStartFrameProcessing(G.width,G.height);var be=u(),I=G.timestamp;m.videoBufferHandler(function(m){return m.videoFrameBuffer=m.videoFrameBuffer||m.data,delete m.data,m}(G),function(){be(),r?.reportFrameProcessed(),function(m){q("video.videoFrameProcessed",[m])}(I)},C)}},!1),q("video.registerForVideoFrame",[m.config])}r?.startMonitorSlowFrameProcessing()}},t.notifySelectedVideoEffectChanged=function(m,h,P){if(b(l,d.sidePanel),!p())throw U;q("video.videoEffectChanged",[m,h,P])},t.registerForVideoEffect=function(m){if(b(l,d.sidePanel),!p())throw U;we("video.effectParameterChange",$t(m,r),!1),q("video.registerForVideoEffect")},t.updatePersonalizedEffects=function(m){if(b(l,d.sidePanel),!sn.isSupported())throw U;q("video.personalizedEffectsChanged",[m])},t.isSupported=p,t.notifyFatalError=function(m){if(b(l),!sn.isSupported())throw U;C(m,s.Fatal)}}(tr||(tr={}))}(),Je}()},78590:function(Oe,Xe,Q){"use strict";Q.d(Xe,{w9:function(){return kr},rP:function(){return qo},Qo:function(){return ue},Cq:function(){return Bo},Mw:function(){return M}});var ue,e,M,$,ve,Ne,He,Je,De,ge,A,Le,Ae={};Q.r(Ae),Q.d(Ae,{addQueryParameters:function(){return vi},getOrigin:function(){return jo},removeQueryAndFragment:function(){return Io}}),(e=ue||(ue={}))[e.ExistingPersistedMashup=0]="ExistingPersistedMashup",e[e.TransientMashup=1]="TransientMashup",e[e.TransientEmptyMashup=2]="TransientEmptyMashup",function(e){e.AddQueries="addQueries",e.BrowseMashup="BrowseMashup",e.ConnectToDataSource="ConnectToDataSource",e.CreateConnection="CreateConnection",e.DataPreview="DataPreview",e.DiagramView="DiagramView",e.EditConnection="EditConnection",e.EditDataflowComputeEngineSettings="EditDataflowComputeEngineSettings",e.EditCubeVariables="editCubeVariables",e.EditQuery="editQuery",e.EditQuickCreate="EditQuickCreate",e.ImportMashupTemplate="importMashupTemplate",e.IncrementalRefreshSettings="incrementalRefreshSettings",e.ManageConnections="manageConnections",e.ManageDataflowComputeEngine="manageDataflowComputeEngine",e.Navigate="navigate",e.QuickCreate="QuickCreate",e.RefreshSettings="refreshSettings",e.ResolveResourceChallenge="ResolveResourceChallenge",e.ShowRefreshHistory="showRefreshHistory"}(M||(M={})),function(e){e.Cancelled="Cancelled",e.CombineFiles="CombineFiles",e.CsvTextSettings="CsvTextSettings",e.DataDiscovery="DataDiscovery",e.DataSources="DataSources",e.DataSourceSettings="DataSourceSettings",e.FolderPreview="FolderPreview",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.Loading="Loading",e.MappingEditor="MappingEditor",e.Navigator="Navigator",e.QueryEditor="QueryEditor",e.QuickCreate="QuickCreate",e.RecentDataPreview="RecentDataPreview",e.RefreshSettings="RefreshSettings",e.TemplateCredentials="TemplateCredentials",e.TemplateParameters="TemplateParameters",e.TextByExample="TextByExample"}($||($={})),function(e){e.Attach="Attach"}(ve||(ve={})),function(e){e.Busy="Busy",e.Error="Error",e.Ready="Ready",e.Unknown="Unknown"}(Ne||(Ne={})),function(e){e.Editable="Editable",e.Hidden="Hidden",e.Readonly="Readonly"}(He||(He={})),function(e){e.Dataflow="Dataflow",e.Project="Project"}(Je||(Je={})),function(e){e.Definition="Definition",e.Instance="Instance"}(De||(De={})),function(e){e.DataSourceTemplateKind="DataSourceTemplateKind"}(ge||(ge={})),function(e){e.DataSourceTemplateKind="DataSourceTemplateKind",e.Navigation="Navigation"}(A||(A={})),function(e){e.Busy="Busy",e.Error="Error",e.Ready="Ready",e.Unknown="Unknown"}(Le||(Le={}));var Fn,On,ce=Q(90341);function ye(e){throw new Error("Unexpected value: "+e)}function J(e){switch(e.kind){case M.BrowseMashup:case M.ConnectToDataSource:case M.DataPreview:case M.DiagramView:case M.EditConnection:case M.EditCubeVariables:case M.EditDataflowComputeEngineSettings:case M.EditQuickCreate:case M.ImportMashupTemplate:case M.IncrementalRefreshSettings:case M.ManageConnections:case M.ManageDataflowComputeEngine:case M.Navigate:case M.QuickCreate:case M.RefreshSettings:case M.ShowRefreshHistory:return!0;case M.AddQueries:case M.CreateConnection:case M.EditQuery:case M.ResolveResourceChallenge:return!e.keepFlowRunningOnCommit;default:ye(e)}}function me(e){switch(e.kind){case M.AddQueries:case M.BrowseMashup:case M.ConnectToDataSource:case M.CreateConnection:case M.DataPreview:case M.DiagramView:case M.EditConnection:case M.EditCubeVariables:case M.EditDataflowComputeEngineSettings:case M.EditQuery:case M.EditQuickCreate:case M.ImportMashupTemplate:case M.IncrementalRefreshSettings:case M.ManageConnections:case M.ManageDataflowComputeEngine:case M.Navigate:case M.QuickCreate:case M.RefreshSettings:case M.ShowRefreshHistory:return!0;case M.ResolveResourceChallenge:return!e.keepFlowRunningOnCancel;default:ye(e)}}function U(e,n){return e.kind===n.kind}function zt(e){St(e)}function St(e,n){if(null==e)throw new Error(n?n():"Value should be defined");return e}!function(e){e.ClientInstanceId="clientInstanceId",e.ProtocolId="protocolId"}(Fn||(Fn={})),function(e){e.DataAutomationId="data-automation-id",e.DataIsAutoFocusable="data-is-autofocusable",e.DataIsFocusable="data-is-focusable"}(On||(On={}));var Rn,vn,Mn,Tn,Nt,Ln,Cn,dn,Nn,nt,gt,Bt,at,Ot,Tt,yt,Xt,Lr=function(){function e(i,o,f){this.iFrameElement=document.createElement("iframe"),this.iFrameElementOriginalDisplayValue=this.iFrameElement.style.display,this.iFrameElement.src=i,this.iFrameElement.title="Power Query",this.iFrameElement.allow="clipboard-read; clipboard-write",this.iFrameElement.setAttribute(On.DataIsFocusable,"true"),zt(o),this.container=o,f&&(this.iFrameElement.className=f),this.hide(),this.container.appendChild(this.iFrameElement),this.isDisposed=!1}var n=e.prototype;return n.addEventListener=function(o,f,w){this.isDisposed||(zt(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.addEventListener(o,f,w))},n.removeEventListener=function(o,f,w){this.isDisposed||(zt(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.removeEventListener(o,f,w))},n.postMessage=function(o,f,w){this.isDisposed||(zt(this.iFrameElement.contentWindow),this.iFrameElement.contentWindow.postMessage(o,f,w))},n.hide=function(){if(!this.isDisposed){var o=this.iFrameElement.style.display;"none"!==o&&(this.iFrameElementOriginalDisplayValue=o,this.iFrameElement.style.display="none")}},n.show=function(){this.isDisposed||(this.iFrameElement.style.display=this.iFrameElementOriginalDisplayValue)},n.dispose=function(){this.container.removeChild(this.iFrameElement),this.isDisposed=!0},e}();!function(e){e.GetEntityQueryScript="browseMashupCallbacks.getEntityQueryScript"}(Rn||(Rn={})),function(e){e.GetInitialComputeEngineSettings="computeEngineCallbacks.getInitialComputeEngineSettings"}(vn||(vn={})),function(e){e.OnStateChanged="createConnectionFlowClientCallbacks.onStateChanged"}(Mn||(Mn={})),function(e){e.OnSampleDataItemClick="dataDiscoveryFormCallbacks.onSampleDataItemClick"}(Tn||(Tn={})),function(e){e.OnEvaluationEnded="dataPreview.onEvaluationEnded",e.OnEvaluationStarted="dataPreview.onEvaluationStarted",e.OnQueryScriptChange="dataPreview.onQueryScriptChange",e.OnTableSelectionChanged="dataPreview.onTableSelectionChanged"}(Nt||(Nt={})),function(e){e.OnControlStateChanged="flowControlRpcMethodNames.onControlStateChanged"}(Ln||(Ln={})),function(e){e.OnCommandExecuted="hostCommandsCallbacks.onCommandExecuted"}(Cn||(Cn={})),function(e){e.GetLoginSuccessRedirectUri="hostPopupsCallbacks.getLoginSuccessRedirectUri",e.OpenHostPopup="hostPopupsCallbacks.openHostPopup"}(dn||(dn={})),function(e){e.OnUnlinkConnection="manageConnectionsFlowCallbacks.onUnlinkConnection"}(Nn||(Nn={})),function(e){e.GenerateNewEntityFieldNames="mappingEditorCallbacks.generateNewEntityFieldNames",e.GenerateNewEntityNames="mappingEditorCallbacks.generateNewEntityNames",e.GetEntities="mappingEditorCallbacks.getEntities",e.GetEntityFields="mappingEditorCallbacks.getEntityFields",e.GetEntityKeys="mappingEditorCallbacks.getEntityKeys",e.ValidateMappingEditorResult="mappingEditorCallbacks.validateMappingEditorResult"}(nt||(nt={})),function(e){e.GetEntityTypeFields="mappingCallbacks.getEntityTypeFields",e.GetEntityTypes="mappingCallbacks.getEntityTypes"}(gt||(gt={})),function(e){e.GetEntityDefinitionFromEntityPath="mappingCallbacksV2.getEntityDefinitionFromEntityPath",e.GetManifestDefinitionFromManifestPath="mappingCallbacksV2.getManifestDefinitionFromManifestPath",e.GetRootManifestDefinition="mappingCallbacksV2.getRootManifestDefinition"}(Bt||(Bt={})),function(e){e.GetMashupSensitivityLabel="mashupEditorClientCallbacks.getMashupSensitivityLabel",e.OnComputeEngineSettingsChanged="mashupEditorClientCallbacks.onComputeEngineSettingsChanged",e.OnEditingSessionMashupChanged="mashupEditorClientCallbacks.onEditingSessionMashupChanged",e.OnEditingSessionMashupInitialized="mashupEditorClientCallbacks.onEditingSessionMashupInitialized",e.OnMashupEditorClick="mashupEditorClientCallbacks.onMashupEditorClick",e.RenameMashup="mashupEditorClientCallbacks.renameMashup"}(at||(at={})),function(e){e.OnNewSqlQueryButtonClicked="powerBIDataMart.onNewSqlQueryButtonClicked",e.OnNewVisualQueryButtonClicked="powerBIDataMart.onNewVisualQueryButtonClicked",e.OnSaveAsViewButtonClicked="powerBIDataMart.onSaveAsViewButtonClicked",e.OnViewSqlButtonClicked="powerBIDataMart.onViewSqlButtonClicked",e.OnVisualizeResultButtonClicked="powerBIDataMart.onVisualizeResultButtonClicked"}(Ot||(Ot={})),function(e){e.OnDownloadExcelFileButtonClick="queryEditorPreviewButtonsCallbacks.onDownloadExcelFileButtonClick",e.OnSaveAsTableButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsTableButtonClick",e.OnSaveAsViewButtonClick="queryEditorPreviewButtonsCallbacks.onSaveAsViewButtonClick",e.OnVisualizeResultsButtonClick="queryEditorPreviewButtonsCallbacks.onVisualizeResultsButtonClick"}(Tt||(Tt={})),function(e){e.OnCommandBarPopupButtonClick="queryEditorCallbacks.onCommandBarPopupButtonClick",e.OnDiagramViewCommandBarPopupButtonClick="queryEditorCallbacks.onDiagramViewCommandBarPopupButtonClick",e.OnOpenInExcelButtonClick="queryEditorCallbacks.onOpenInExcelButtonClick",e.ValidateQuery="queryEditorCallbacks.validateQuery",e.ValidateQueryNameInteractive="queryEditorCallbacks.validateQueryNameInteractive"}(yt||(yt={})),function(e){e.GetUserSettings="userSettings.getUserSettings",e.SetUserSettings="userSettings.setUserSettings"}(Xt||(Xt={}));var l,$i=function(){function e(i,o,f,w,T){this.clientRpcChannel=i,this.clientRpcEndpointHost=o,this.client=f,this.configuration=w,this.clientStartTime=T,this.registerRpcMethods()}var n=e.prototype;return n.dispose=function(){this.unregisterRpcMethods()},n.registerRpcMethods=function(){var f,w,T,ne,Y,Z,ie,Fe,ot,ut,Et,Re,Se,dt,pt,$e,Pt,At,mt,tt,Wt,vt,cn,Gt,ln,Dt,kt,Ft,S,g,y,O,N,R,te,Ce,Ee,Ze,Ie,Ye,Jo,$o,Zo,Yo,Xo,Ko,ea,ta,na,o=this;this.register("acquireToken",function(Ue){return o.configuration.acquireToken(Ue)}),this.register("getClientStartTime",function(){return o.clientStartTime}),this.register("getSettings",function(){return o.configuration.editorSettings}),this.register("getVersion",function(){return"22.28.0"}),this.register("hasMappingCallbacks",function(){return null!=o.configuration.mappingCallbacks}),this.register("hasMappingCallbacksV2",function(){return null!=o.configuration.mappingCallbacksV2}),this.register("onAppReady",function(){return o.clientRpcEndpointHost.onAppReady()}),this.register("onCancel",function(){return o.clientRpcEndpointHost.onCancelCurrentFlow()}),this.register("onCommit",function(){}),this.register("onCommit2",function(Ue){return o.clientRpcEndpointHost.onCommitCurrentFlow(Ue)}),this.register("onFlowReady",function(){return o.clientRpcEndpointHost.onCurrentFlowReady()}),!(null===(f=this.configuration.browseMashupCallbacks)||void 0===f)&&f.getEntityQueryScript&&this.register(Rn.GetEntityQueryScript,this.configuration.browseMashupCallbacks.getEntityQueryScript),!(null===(w=this.configuration.computeEngineCallbacks)||void 0===w)&&w.getInitialComputeEngineSettings&&this.register(vn.GetInitialComputeEngineSettings,this.configuration.computeEngineCallbacks.getInitialComputeEngineSettings),!(null===(T=this.configuration.createConnectionFlowClientCallbacks)||void 0===T)&&T.onStateChanged&&this.register(Mn.OnStateChanged,this.configuration.createConnectionFlowClientCallbacks.onStateChanged),!(null===(ne=this.configuration.dataPreviewCallbacks)||void 0===ne)&&ne.onEvaluationEnded&&this.register(Nt.OnEvaluationEnded,this.configuration.dataPreviewCallbacks.onEvaluationEnded),!(null===(Y=this.configuration.dataPreviewCallbacks)||void 0===Y)&&Y.onEvaluationStarted&&this.register(Nt.OnEvaluationStarted,this.configuration.dataPreviewCallbacks.onEvaluationStarted),!(null===(Z=this.configuration.dataPreviewCallbacks)||void 0===Z)&&Z.onQueryScriptChange&&this.register(Nt.OnQueryScriptChange,this.configuration.dataPreviewCallbacks.onQueryScriptChange),!(null===(ie=this.configuration.dataPreviewCallbacks)||void 0===ie)&&ie.onTableSelectionChanged&&this.register(Nt.OnTableSelectionChanged,this.configuration.dataPreviewCallbacks.onTableSelectionChanged),!(null===(Fe=this.configuration.flowControlCallbacks)||void 0===Fe)&&Fe.onControlStateChanged&&this.register(Ln.OnControlStateChanged,function(){var Ue;return null===(Ue=o.configuration.flowControlCallbacks)||void 0===Ue?void 0:Ue.onControlStateChanged(o.client)}),!(null===(ot=this.configuration.hostPopupsCallbacks)||void 0===ot)&&ot.getLoginSuccessRedirectUri&&this.register(dn.GetLoginSuccessRedirectUri,this.configuration.hostPopupsCallbacks.getLoginSuccessRedirectUri),!(null===(ut=this.configuration.hostPopupsCallbacks)||void 0===ut)&&ut.openHostPopup&&this.register(dn.OpenHostPopup,this.configuration.hostPopupsCallbacks.openHostPopup),!(null===(Et=this.configuration.hostCommandsCallbacks)||void 0===Et)&&Et.onCommandExecuted&&this.register(Cn.OnCommandExecuted,this.configuration.hostCommandsCallbacks.onCommandExecuted),!(null===(Re=this.configuration.manageConnectionsFlowCallbacks)||void 0===Re)&&Re.onUnlinkConnection&&this.register(Nn.OnUnlinkConnection,this.configuration.manageConnectionsFlowCallbacks.onUnlinkConnection),!(null===(Se=this.configuration.mappingEditorCallbacks)||void 0===Se)&&Se.generateNewEntityFieldNames&&this.register(nt.GenerateNewEntityFieldNames,this.configuration.mappingEditorCallbacks.generateNewEntityFieldNames),!(null===(dt=this.configuration.mappingEditorCallbacks)||void 0===dt)&&dt.generateNewEntityNames&&this.register(nt.GenerateNewEntityNames,this.configuration.mappingEditorCallbacks.generateNewEntityNames),!(null===(pt=this.configuration.mappingEditorCallbacks)||void 0===pt)&&pt.getEntities&&this.register(nt.GetEntities,this.configuration.mappingEditorCallbacks.getEntities),!(null===($e=this.configuration.mappingEditorCallbacks)||void 0===$e)&&$e.getEntityFields&&this.register(nt.GetEntityFields,this.configuration.mappingEditorCallbacks.getEntityFields),!(null===(Pt=this.configuration.mappingEditorCallbacks)||void 0===Pt)&&Pt.getEntityKeys&&this.register(nt.GetEntityKeys,this.configuration.mappingEditorCallbacks.getEntityKeys),!(null===(At=this.configuration.mappingEditorCallbacks)||void 0===At)&&At.validateMappingEditorResult&&this.register(nt.ValidateMappingEditorResult,this.configuration.mappingEditorCallbacks.validateMappingEditorResult),!(null===(mt=this.configuration.mappingCallbacks)||void 0===mt)&&mt.getEntityTypeFields&&this.register(gt.GetEntityTypeFields,this.configuration.mappingCallbacks.getEntityTypeFields),!(null===(tt=this.configuration.mappingCallbacks)||void 0===tt)&&tt.getEntityTypes&&this.register(gt.GetEntityTypes,null===(Wt=this.configuration.mappingCallbacks)||void 0===Wt?void 0:Wt.getEntityTypes),!(null===(vt=this.configuration.mappingCallbacksV2)||void 0===vt)&&vt.getEntityDefinitionFromEntityPath&&this.register(Bt.GetEntityDefinitionFromEntityPath,this.configuration.mappingCallbacksV2.getEntityDefinitionFromEntityPath),!(null===(cn=this.configuration.mappingCallbacksV2)||void 0===cn)&&cn.getManifestDefinitionFromManifestPath&&this.register(Bt.GetManifestDefinitionFromManifestPath,this.configuration.mappingCallbacksV2.getManifestDefinitionFromManifestPath),!(null===(Gt=this.configuration.mappingCallbacksV2)||void 0===Gt)&&Gt.getRootManifestDefinition&&this.register(Bt.GetRootManifestDefinition,null===(ln=this.configuration.mappingCallbacksV2)||void 0===ln?void 0:ln.getRootManifestDefinition),!(null===(Dt=this.configuration.mashupEditorClientCallbacks)||void 0===Dt)&&Dt.getMashupSensitivityLabel&&this.register(at.GetMashupSensitivityLabel,this.configuration.mashupEditorClientCallbacks.getMashupSensitivityLabel),!(null===(kt=this.configuration.mashupEditorClientCallbacks)||void 0===kt)&&kt.onComputeEngineSettingsChanged&&this.register(at.OnComputeEngineSettingsChanged,this.configuration.mashupEditorClientCallbacks.onComputeEngineSettingsChanged),!(null===(Ft=this.configuration.mashupEditorClientCallbacks)||void 0===Ft)&&Ft.onEditingSessionMashupChanged&&this.register(at.OnEditingSessionMashupChanged,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupChanged),!(null===(S=this.configuration.mashupEditorClientCallbacks)||void 0===S)&&S.onEditingSessionMashupInitialized&&this.register(at.OnEditingSessionMashupInitialized,this.configuration.mashupEditorClientCallbacks.onEditingSessionMashupInitialized),!(null===(g=this.configuration.mashupEditorClientCallbacks)||void 0===g)&&g.onMashupEditorClick&&this.register(at.OnMashupEditorClick,null===(y=this.configuration.mashupEditorClientCallbacks)||void 0===y?void 0:y.onMashupEditorClick),!(null===(O=this.configuration.mashupEditorClientCallbacks)||void 0===O)&&O.renameMashup&&this.register(at.RenameMashup,this.configuration.mashupEditorClientCallbacks.renameMashup),!(null===(N=this.configuration.powerBIDataMartCallbacks)||void 0===N)&&N.onNewSqlQueryButtonClicked&&this.register(Ot.OnNewSqlQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewSqlQueryButtonClicked),!(null===(R=this.configuration.powerBIDataMartCallbacks)||void 0===R)&&R.onNewVisualQueryButtonClicked&&this.register(Ot.OnNewVisualQueryButtonClicked,this.configuration.powerBIDataMartCallbacks.onNewVisualQueryButtonClicked),!(null===(te=this.configuration.powerBIDataMartCallbacks)||void 0===te)&&te.onSaveAsViewButtonClicked&&this.register(Ot.OnSaveAsViewButtonClicked,this.configuration.powerBIDataMartCallbacks.onSaveAsViewButtonClicked),!(null===(Ce=this.configuration.powerBIDataMartCallbacks)||void 0===Ce)&&Ce.onViewSqlButtonClicked&&this.register(Ot.OnViewSqlButtonClicked,this.configuration.powerBIDataMartCallbacks.onViewSqlButtonClicked),!(null===(Ee=this.configuration.powerBIDataMartCallbacks)||void 0===Ee)&&Ee.onVisualizeResultButtonClicked&&this.register(Ot.OnVisualizeResultButtonClicked,this.configuration.powerBIDataMartCallbacks.onVisualizeResultButtonClicked),!(null===(Ze=this.configuration.queryEditorCallbacks)||void 0===Ze)&&Ze.onCommandBarPopupButtonClick&&this.register(yt.OnCommandBarPopupButtonClick,function(){var Ue;return St(null===(Ue=o.configuration.queryEditorCallbacks)||void 0===Ue?void 0:Ue.onCommandBarPopupButtonClick)(o.client)}),!(null===(Ie=this.configuration.queryEditorCallbacks)||void 0===Ie)&&Ie.onDiagramViewCommandBarPopupButtonClick&&this.register(yt.OnDiagramViewCommandBarPopupButtonClick,function(){var Ue;return St(null===(Ue=o.configuration.queryEditorCallbacks)||void 0===Ue?void 0:Ue.onDiagramViewCommandBarPopupButtonClick)(o.client)}),!(null===(Ye=this.configuration.queryEditorCallbacks)||void 0===Ye)&&Ye.onOpenInExcelButtonClick&&this.register(yt.OnOpenInExcelButtonClick,function(Ue){var _e;return St(null===(_e=o.configuration.queryEditorCallbacks)||void 0===_e?void 0:_e.onOpenInExcelButtonClick)(o.client,Ue)}),!(null===(Jo=this.configuration.queryEditorCallbacks)||void 0===Jo)&&Jo.validateQuery&&this.register(yt.ValidateQuery,function(Ue){var _e;return St(null===(_e=o.configuration.queryEditorCallbacks)||void 0===_e?void 0:_e.validateQuery)(o.client,Ue)}),!(null===($o=this.configuration.queryEditorCallbacks)||void 0===$o)&&$o.validateQueryNameInteractive&&this.register(yt.ValidateQueryNameInteractive,function(Ue){var _e;return St(null===(_e=o.configuration.queryEditorCallbacks)||void 0===_e?void 0:_e.validateQueryNameInteractive)(o.client,Ue)}),!(null===(Zo=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Zo)&&Zo.onDownloadExcelFileButtonClick&&this.register(Tt.OnDownloadExcelFileButtonClick,function(Ue){var _e;return St(null===(_e=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===_e?void 0:_e.onDownloadExcelFileButtonClick)(Ue)}),!(null===(Yo=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Yo)&&Yo.onSaveAsTableButtonClick&&this.register(Tt.OnSaveAsTableButtonClick,function(Ue){var _e;return St(null===(_e=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===_e?void 0:_e.onSaveAsTableButtonClick)(Ue)}),!(null===(Xo=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Xo)&&Xo.onSaveAsViewButtonClick&&this.register(Tt.OnSaveAsViewButtonClick,function(Ue){var _e;return St(null===(_e=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===_e?void 0:_e.onSaveAsViewButtonClick)(Ue)}),!(null===(Ko=this.configuration.queryEditorPreviewButtonsCallbacks)||void 0===Ko)&&Ko.onVisualizeResultsButtonClick&&this.register(Tt.OnVisualizeResultsButtonClick,function(Ue){var _e;return St(null===(_e=o.configuration.queryEditorPreviewButtonsCallbacks)||void 0===_e?void 0:_e.onVisualizeResultsButtonClick)(Ue)}),!(null===(ea=this.configuration.userSettingsStorageCallbacks)||void 0===ea)&&ea.getUserSettings&&this.register(Xt.GetUserSettings,this.configuration.userSettingsStorageCallbacks.getUserSettings),!(null===(ta=this.configuration.userSettingsStorageCallbacks)||void 0===ta)&&ta.setUserSettings&&this.register(Xt.SetUserSettings,this.configuration.userSettingsStorageCallbacks.setUserSettings),null!==(na=this.configuration.dataDiscoveryFormCallbacks)&&void 0!==na&&na.onSampleDataItemClick&&this.register(Tn.OnSampleDataItemClick,function(Ue){var _e;return St(null===(_e=o.configuration.dataDiscoveryFormCallbacks)||void 0===_e?void 0:_e.onSampleDataItemClick)(Ue)})},n.unregisterRpcMethods=function(){this.unregister("acquireToken"),this.unregister("getClientStartTime"),this.unregister("getSettings"),this.unregister("getVersion"),this.unregister("onAppReady"),this.unregister("onCancel"),this.unregister("onCommit"),this.unregister("onFlowReady"),this.unregister(Rn.GetEntityQueryScript),this.unregister(vn.GetInitialComputeEngineSettings),this.unregister(Mn.OnStateChanged),this.unregister(Nt.OnEvaluationEnded),this.unregister(Nt.OnEvaluationStarted),this.unregister(Nt.OnQueryScriptChange),this.unregister(Nt.OnTableSelectionChanged),this.unregister(dn.GetLoginSuccessRedirectUri),this.unregister(dn.OpenHostPopup),this.unregister(Cn.OnCommandExecuted),this.unregister(Nn.OnUnlinkConnection),this.unregister(nt.GenerateNewEntityFieldNames),this.unregister(nt.GenerateNewEntityNames),this.unregister(nt.GetEntities),this.unregister(nt.GetEntityFields),this.unregister(nt.GetEntityKeys),this.unregister(nt.ValidateMappingEditorResult),this.unregister(gt.GetEntityTypeFields),this.unregister(gt.GetEntityTypes),this.unregister(Bt.GetEntityDefinitionFromEntityPath),this.unregister(Bt.GetManifestDefinitionFromManifestPath),this.unregister(Bt.GetRootManifestDefinition),this.unregister(at.GetMashupSensitivityLabel),this.unregister(at.OnComputeEngineSettingsChanged),this.unregister(at.OnEditingSessionMashupChanged),this.unregister(at.OnEditingSessionMashupInitialized),this.unregister(at.OnMashupEditorClick),this.unregister(at.RenameMashup),this.unregister(Ot.OnNewSqlQueryButtonClicked),this.unregister(Ot.OnNewVisualQueryButtonClicked),this.unregister(Ot.OnSaveAsViewButtonClicked),this.unregister(Ot.OnViewSqlButtonClicked),this.unregister(Ot.OnVisualizeResultButtonClicked),this.unregister(yt.OnCommandBarPopupButtonClick),this.unregister(yt.OnDiagramViewCommandBarPopupButtonClick),this.unregister(yt.OnOpenInExcelButtonClick),this.unregister(yt.ValidateQuery),this.unregister(yt.ValidateQueryNameInteractive),this.unregister(Tt.OnDownloadExcelFileButtonClick),this.unregister(Tt.OnSaveAsTableButtonClick),this.unregister(Tt.OnSaveAsViewButtonClick),this.unregister(Tt.OnVisualizeResultsButtonClick),this.unregister(Xt.GetUserSettings),this.unregister(Xt.SetUserSettings),this.unregister(Tn.OnSampleDataItemClick)},n.register=function(o,f){this.clientRpcChannel.register(o,f)},n.unregister=function(o){this.clientRpcChannel.unregister(o)},e}();!function(e){e.ActivateQuery="activateQuery",e.AddQuery="addQuery",e.CancelAddQueriesFlow="cancelAddQueriesFlow",e.ClickCancelButton="clickCancelButton",e.ClickCommitButton="clickCommitButton",e.ClickCustomButton="clickCustomButton",e.ClickNextStageButton="clickNextStageButton",e.ClickPreviousStageButton="clickPreviousStageButton",e.CreateConnectionFlow_Commit="createConnectionFlow_commit",e.DataPreview_CancelCurrentQueryEvaluation="dataPreview_cancelCurrentQueryEvaluation",e.DataPreview_SelectColumns="dataPreview_selectColumns",e.DeleteAllQueries="deleteAllQueries",e.DisposeService="disposeService",e.EndFlow="endFlow",e.GetActiveQueryName="getActiveQueryName",e.GetCancelButtonLabel="getCancelButtonLabel",e.GetCommitButtonLabel="getCommitButtonLabel",e.GetCommitResult="getCommitResult",e.GetComputeEngineSettings="getComputeEngineSettings",e.GetCurrentFlow="getCurrentFlow",e.GetCustomButtonLabel="getCustomButtonLabel",e.GetDataSourceQueryScript="getDataSourceQueryScript",e.GetDataWizardFooter_ClickCancelButton="getDataWizardFooter_clickCancelButton",e.GetDataWizardFooter_ClickCommitButton="getDataWizardFooter_clickCommitButton",e.GetDataWizardFooter_ClickCustomButton="getDataWizardFooter_clickCustomButton",e.GetDataWizardFooter_ClickNextStageButton="getDataWizardFooter_clickNextStageButton",e.GetDataWizardFooter_ClickPreviousStageButton="getDataWizardFooter_clickPreviousStageButton",e.GetEditingSessionId="getEditingSessionId",e.GetEditingSessionMashup="getEditingSessionMashup",e.GetFooterMessage="getFooterMessage",e.GetGetDataWizardFlowStage="getGetDataWizardFlowStage",e.GetIncrementalRefreshSettings="getIncrementalRefreshSettings",e.GetMashupGatewayVersion="getMashupGatewayVersion",e.GetNextStageButtonLabel="getNextStageButtonLabel",e.GetPreviousStageButtonLabel="getPreviousStageButtonLabel",e.GetQueriesInfo="getQueriesInfo",e.GetQueryEditorState="getQueryEditorState",e.GetQueryEditorStateOrThrow="getQueryEditorStateOrThrow",e.GetQueryNames="getQueryNames",e.GetQueryScript="getQueryScript",e.GetReadyState="getReadyState",e.GetRefreshSettings="getRefreshSettings",e.GetSelectedStepName="getSelectedStepName",e.GetUserSettings="getUserSettings",e.IsCancelButtonEnabled="isCancelButtonEnabled",e.IsCancelButtonVisible="isCancelButtonVisible",e.IsCommitButtonEnabled="isCommitButtonEnabled",e.IsCommitButtonVisible="isCommitButtonVisible",e.IsCustomButtonEnabled="isCustomButtonEnabled",e.IsCustomButtonVisible="isCustomButtonVisible",e.IsDialogVisible="isDialogVisible",e.IsFeatureSupported="isFeatureSupported",e.IsFooterOverlayVisible="isFooterOverlayVisible",e.IsNextStageButtonEnabled="isNextStageButtonEnabled",e.IsNextStageButtonVisible="isNextStageButtonVisible",e.IsPreviousStageButtonEnabled="isPreviousStageButtonEnabled",e.IsPreviousStageButtonVisible="isPreviousStageButtonVisible",e.LogXFramePerformanceMarks="logXFramePerformanceMarks",e.OnHostPopupCancelled="onHostPopupCancelled",e.RefreshActiveQueryResult="refreshActiveQueryResult",e.SetCommitButtonEnabledStatePolicy="setCommitButtonEnabledStatePolicy",e.SetUserSettings="setUserSettings",e.StartFlow="startFlow",e.TrySetQueryScript="trySetQueryScript"}(l||(l={}));var Zi=function(){function e(i){this.clientRpcChannel=i}var n=e.prototype;return n.activateQuery=function(o){return this.clientRpcChannel.call(l.ActivateQuery,[o])},n.addQuery=function(o,f,w){return this.clientRpcChannel.call(l.AddQuery,[o,f,w])},n.endFlow=function(){return this.clientRpcChannel.callIfSupported(l.EndFlow)},n.cancelAddQueriesFlow=function(){return this.clientRpcChannel.call(l.CancelAddQueriesFlow)},n.clickCancelButton=function(){return this.clientRpcChannel.call(l.ClickCancelButton)},n.clickCommitButton=function(){return this.clientRpcChannel.call(l.ClickCommitButton)},n.clickCustomButton=function(){return this.clientRpcChannel.call(l.ClickCustomButton)},n.clickNextStageButton=function(){return this.clientRpcChannel.call(l.ClickNextStageButton)},n.clickPreviousStageButton=function(){return this.clientRpcChannel.call(l.ClickPreviousStageButton)},n.createConnectionFlow_commit=function(o){return this.clientRpcChannel.call(l.CreateConnectionFlow_Commit,[o])},n.dataPreview_cancelCurrentQueryEvaluation=function(){return this.clientRpcChannel.call(l.DataPreview_CancelCurrentQueryEvaluation)},n.dataPreview_selectColumns=function(o){return this.clientRpcChannel.callIfSupported(l.DataPreview_SelectColumns,[o])},n.deleteAllQueries=function(){return this.clientRpcChannel.callIfSupported(l.DeleteAllQueries)},n.disposeService=function(){return this.clientRpcChannel.callIfSupported(l.DisposeService)},n.getActiveQueryName=function(){return this.clientRpcChannel.call(l.GetActiveQueryName)},n.getCancelButtonLabel=function(){return this.clientRpcChannel.call(l.GetCancelButtonLabel)},n.getCommitButtonLabel=function(){return this.clientRpcChannel.call(l.GetCommitButtonLabel)},n.getCustomButtonLabel=function(){return this.clientRpcChannel.call(l.GetCustomButtonLabel)},n.getCommitResult=function(){return this.clientRpcChannel.call(l.GetCommitResult)},n.getComputeEngineSettings=function(){return this.clientRpcChannel.call(l.GetComputeEngineSettings)},n.getCurrentFlow=function(){return this.clientRpcChannel.callIfSupported(l.GetCurrentFlow)},n.getDataSourceQueryScript=function(o,f){return this.clientRpcChannel.call(l.GetDataSourceQueryScript,[o,f])},n.getDataWizardFooter_clickCancelButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickCancelButton)},n.getDataWizardFooter_clickCommitButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickCommitButton)},n.getDataWizardFooter_clickCustomButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickCustomButton)},n.getDataWizardFooter_clickNextStageButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickNextStageButton)},n.getDataWizardFooter_clickPreviousStageButton=function(){return this.clientRpcChannel.call(l.GetDataWizardFooter_ClickPreviousStageButton)},n.getEditingSessionId=function(){return this.clientRpcChannel.call(l.GetEditingSessionId)},n.getEditingSessionMashup=function(o){return this.clientRpcChannel.call(l.GetEditingSessionMashup,[o])},n.getFooterMessage=function(){return this.clientRpcChannel.call(l.GetFooterMessage)},n.getGetDataWizardFlowStage=function(){return this.clientRpcChannel.callIfSupported(l.GetGetDataWizardFlowStage)},n.getIncrementalRefreshSettings=function(){return this.clientRpcChannel.call(l.GetIncrementalRefreshSettings)},n.getMashupGatewayVersion=function(){return this.clientRpcChannel.call(l.GetMashupGatewayVersion)},n.getNextStageButtonLabel=function(){return this.clientRpcChannel.call(l.GetNextStageButtonLabel)},n.getPreviousStageButtonLabel=function(){return this.clientRpcChannel.call(l.GetPreviousStageButtonLabel)},n.getQueriesInfo=function(){return this.clientRpcChannel.call(l.GetQueriesInfo)},n.getQueryEditorState=function(){return this.clientRpcChannel.call(l.GetQueryEditorState)},n.getQueryEditorStateOrThrow=function(){return this.clientRpcChannel.call(l.GetQueryEditorStateOrThrow)},n.getQueryNames=function(){return this.clientRpcChannel.call(l.GetQueryNames)},n.getQueryScript=function(o){return this.clientRpcChannel.call(l.GetQueryScript,[o])},n.getReadyState=function(){return this.clientRpcChannel.call(l.GetReadyState)},n.getRefreshSettings=function(){return this.clientRpcChannel.callIfSupported(l.GetRefreshSettings)},n.getSelectedStepName=function(){return this.clientRpcChannel.call(l.GetSelectedStepName)},n.getUserSettings=function(){return this.clientRpcChannel.call(l.GetUserSettings)},n.isCancelButtonEnabled=function(){return this.clientRpcChannel.call(l.IsCancelButtonEnabled)},n.isCancelButtonVisible=function(){return this.clientRpcChannel.call(l.IsCancelButtonVisible)},n.isCommitButtonEnabled=function(){return this.clientRpcChannel.call(l.IsCommitButtonEnabled)},n.isCommitButtonVisible=function(){return this.clientRpcChannel.call(l.IsCommitButtonVisible)},n.isCustomButtonEnabled=function(){return this.clientRpcChannel.call(l.IsCustomButtonEnabled)},n.isCustomButtonVisible=function(){return this.clientRpcChannel.call(l.IsCustomButtonVisible)},n.isDialogVisible=function(){return this.clientRpcChannel.call(l.IsDialogVisible)},n.isFeatureSupported=function(o){return this.clientRpcChannel.call(l.IsFeatureSupported,[o])},n.isFooterOverlayVisible=function(){return this.clientRpcChannel.call(l.IsFooterOverlayVisible)},n.isNextStageButtonEnabled=function(){return this.clientRpcChannel.call(l.IsNextStageButtonEnabled)},n.isNextStageButtonVisible=function(){return this.clientRpcChannel.call(l.IsNextStageButtonVisible)},n.isPreviousStageButtonEnabled=function(){return this.clientRpcChannel.call(l.IsPreviousStageButtonEnabled)},n.isPreviousStageButtonVisible=function(){return this.clientRpcChannel.call(l.IsPreviousStageButtonVisible)},n.logXFramePerformanceMarks=function(o){return this.clientRpcChannel.call(l.LogXFramePerformanceMarks,[o])},n.onHostPopupCancelled=function(o){return this.clientRpcChannel.callIfSupported(l.OnHostPopupCancelled,[o])},n.refreshActiveQueryResult=function(){return this.clientRpcChannel.callIfSupported(l.RefreshActiveQueryResult)},n.setCommitButtonEnabledStatePolicy=function(o){return this.clientRpcChannel.call(l.SetCommitButtonEnabledStatePolicy,[o])},n.setUserSettings=function(o){return this.clientRpcChannel.callIfSupported(l.SetUserSettings,[o])},n.startFlow=function(o,f){return this.clientRpcChannel.callIfSupported(l.StartFlow,[o,f])},n.trySetQueryScript=function(o,f){return this.clientRpcChannel.call(l.TrySetQueryScript,[o,f])},e}(),Nr=Q(37419),rr=function(){function e(){var i=this;this.resolveMethod=function(o){},this.rejectMethod=function(o){},this.promise=new Promise(function(o,f){i.resolveMethod=o,i.rejectMethod=f})}e.createResolvedDeferred=function(){var o=new e;return o.resolve(),o};var n=e.prototype;return n.resolve=function(o){this.resolveMethod(o)},n.reject=function(o){this.rejectMethod(o)},e}(),Yi=Q(11105);function Vr(){return Yi.Z()}function wn(){wn=function(){return n};var e,n={},i=Object.prototype,o=i.hasOwnProperty,f=Object.defineProperty||function(S,g,y){S[g]=y.value},w="function"==typeof Symbol?Symbol:{},T=w.iterator||"@@iterator",ne=w.asyncIterator||"@@asyncIterator",Y=w.toStringTag||"@@toStringTag";function Z(S,g,y){return Object.defineProperty(S,g,{value:y,enumerable:!0,configurable:!0,writable:!0}),S[g]}try{Z({},"")}catch{Z=function(y,O,N){return y[O]=N}}function ie(S,g,y,O){var R=Object.create((g&&g.prototype instanceof dt?g:dt).prototype),te=new kt(O||[]);return f(R,"_invoke",{value:cn(S,y,te)}),R}function Fe(S,g,y){try{return{type:"normal",arg:S.call(g,y)}}catch(O){return{type:"throw",arg:O}}}n.wrap=ie;var ot="suspendedStart",ut="suspendedYield",Et="executing",Re="completed",Se={};function dt(){}function pt(){}function $e(){}var Pt={};Z(Pt,T,function(){return this});var At=Object.getPrototypeOf,mt=At&&At(At(Ft([])));mt&&mt!==i&&o.call(mt,T)&&(Pt=mt);var tt=$e.prototype=dt.prototype=Object.create(Pt);function Wt(S){["next","throw","return"].forEach(function(g){Z(S,g,function(y){return this._invoke(g,y)})})}function vt(S,g){function y(N,R,te,Ce){var Ee=Fe(S[N],S,R);if("throw"!==Ee.type){var Ze=Ee.arg,Ie=Ze.value;return Ie&&"object"==typeof Ie&&o.call(Ie,"__await")?g.resolve(Ie.__await).then(function(Ye){y("next",Ye,te,Ce)},function(Ye){y("throw",Ye,te,Ce)}):g.resolve(Ie).then(function(Ye){Ze.value=Ye,te(Ze)},function(Ye){return y("throw",Ye,te,Ce)})}Ce(Ee.arg)}var O;f(this,"_invoke",{value:function(R,te){function Ce(){return new g(function(Ee,Ze){y(R,te,Ee,Ze)})}return O=O?O.then(Ce,Ce):Ce()}})}function cn(S,g,y){var O=ot;return function(N,R){if(O===Et)throw new Error("Generator is already running");if(O===Re){if("throw"===N)throw R;return{value:e,done:!0}}for(y.method=N,y.arg=R;;){var te=y.delegate;if(te){var Ce=Gt(te,y);if(Ce){if(Ce===Se)continue;return Ce}}if("next"===y.method)y.sent=y._sent=y.arg;else if("throw"===y.method){if(O===ot)throw O=Re,y.arg;y.dispatchException(y.arg)}else"return"===y.method&&y.abrupt("return",y.arg);O=Et;var Ee=Fe(S,g,y);if("normal"===Ee.type){if(O=y.done?Re:ut,Ee.arg===Se)continue;return{value:Ee.arg,done:y.done}}"throw"===Ee.type&&(O=Re,y.method="throw",y.arg=Ee.arg)}}}function Gt(S,g){var y=g.method,O=S.iterator[y];if(O===e)return g.delegate=null,"throw"===y&&S.iterator.return&&(g.method="return",g.arg=e,Gt(S,g),"throw"===g.method)||"return"!==y&&(g.method="throw",g.arg=new TypeError("The iterator does not provide a '"+y+"' method")),Se;var N=Fe(O,S.iterator,g.arg);if("throw"===N.type)return g.method="throw",g.arg=N.arg,g.delegate=null,Se;var R=N.arg;return R?R.done?(g[S.resultName]=R.value,g.next=S.nextLoc,"return"!==g.method&&(g.method="next",g.arg=e),g.delegate=null,Se):R:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,Se)}function ln(S){var g={tryLoc:S[0]};1 in S&&(g.catchLoc=S[1]),2 in S&&(g.finallyLoc=S[2],g.afterLoc=S[3]),this.tryEntries.push(g)}function Dt(S){var g=S.completion||{};g.type="normal",delete g.arg,S.completion=g}function kt(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(ln,this),this.reset(!0)}function Ft(S){if(S||""===S){var g=S[T];if(g)return g.call(S);if("function"==typeof S.next)return S;if(!isNaN(S.length)){var y=-1,O=function N(){for(;++y<S.length;)if(o.call(S,y))return N.value=S[y],N.done=!1,N;return N.value=e,N.done=!0,N};return O.next=O}}throw new TypeError(typeof S+" is not iterable")}return pt.prototype=$e,f(tt,"constructor",{value:$e,configurable:!0}),f($e,"constructor",{value:pt,configurable:!0}),pt.displayName=Z($e,Y,"GeneratorFunction"),n.isGeneratorFunction=function(S){var g="function"==typeof S&&S.constructor;return!!g&&(g===pt||"GeneratorFunction"===(g.displayName||g.name))},n.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,$e):(S.__proto__=$e,Z(S,Y,"GeneratorFunction")),S.prototype=Object.create(tt),S},n.awrap=function(S){return{__await:S}},Wt(vt.prototype),Z(vt.prototype,ne,function(){return this}),n.AsyncIterator=vt,n.async=function(S,g,y,O,N){void 0===N&&(N=Promise);var R=new vt(ie(S,g,y,O),N);return n.isGeneratorFunction(g)?R:R.next().then(function(te){return te.done?te.value:R.next()})},Wt(tt),Z(tt,Y,"Generator"),Z(tt,T,function(){return this}),Z(tt,"toString",function(){return"[object Generator]"}),n.keys=function(S){var g=Object(S),y=[];for(var O in g)y.push(O);return y.reverse(),function N(){for(;y.length;){var R=y.pop();if(R in g)return N.value=R,N.done=!1,N}return N.done=!0,N}},n.values=Ft,kt.prototype={constructor:kt,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Dt),!g)for(var y in this)"t"===y.charAt(0)&&o.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=e)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var y=this;function O(Ze,Ie){return te.type="throw",te.arg=g,y.next=Ze,Ie&&(y.method="next",y.arg=e),!!Ie}for(var N=this.tryEntries.length-1;N>=0;--N){var R=this.tryEntries[N],te=R.completion;if("root"===R.tryLoc)return O("end");if(R.tryLoc<=this.prev){var Ce=o.call(R,"catchLoc"),Ee=o.call(R,"finallyLoc");if(Ce&&Ee){if(this.prev<R.catchLoc)return O(R.catchLoc,!0);if(this.prev<R.finallyLoc)return O(R.finallyLoc)}else if(Ce){if(this.prev<R.catchLoc)return O(R.catchLoc,!0)}else{if(!Ee)throw new Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return O(R.finallyLoc)}}}},abrupt:function(g,y){for(var O=this.tryEntries.length-1;O>=0;--O){var N=this.tryEntries[O];if(N.tryLoc<=this.prev&&o.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var R=N;break}}R&&("break"===g||"continue"===g)&&R.tryLoc<=y&&y<=R.finallyLoc&&(R=null);var te=R?R.completion:{};return te.type=g,te.arg=y,R?(this.method="next",this.next=R.finallyLoc,Se):this.complete(te)},complete:function(g,y){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&y&&(this.next=y),Se},finish:function(g){for(var y=this.tryEntries.length-1;y>=0;--y){var O=this.tryEntries[y];if(O.finallyLoc===g)return this.complete(O.completion,O.afterLoc),Dt(O),Se}},catch:function(g){for(var y=this.tryEntries.length-1;y>=0;--y){var O=this.tryEntries[y];if(O.tryLoc===g){var N=O.completion;if("throw"===N.type){var R=N.arg;Dt(O)}return R}}throw new Error("illegal catch attempt")},delegateYield:function(g,y,O){return this.delegate={iterator:Ft(g),resultName:y,nextLoc:O},"next"===this.method&&(this.arg=e),Se}},n}var ir="__SUPPORTS_METHOD__",or=function(){function e(i){var o=this;this.onMessageReceived=function(f){f.method?o.handleRequestMessageReceived(f):o.handleResponseMessageReceived(f)},this.options=i,this.ready=!1,this.methodCallbackMap=new Map,this.requestDeferredByMessageId=new Map,this.queuedRequestMessages=[],this.options.rpcWindow.addListener(this.onMessageReceived),this.internalRegister(ir,function(f){return o.handleSupportsMethodMessage(f)})}var n=e.prototype;return n.call=function(o,f){return this.internalCall(e.normalizeMethodName(o),f)},n.callIfSupported=function(o,f){return function(e,n,i,o){return new(i||(i=Promise))(function(w,T){function ne(ie){try{Z(o.next(ie))}catch(Fe){T(Fe)}}function Y(ie){try{Z(o.throw(ie))}catch(Fe){T(Fe)}}function Z(ie){ie.done?w(ie.value):function(w){return w instanceof i?w:new i(function(T){T(w)})}(ie.value).then(ne,Y)}Z((o=o.apply(e,n||[])).next())})}(this,void 0,void 0,wn().mark(function w(){return wn().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.next=2,this.supportsMethod(o);case 2:if(!Y.sent){Y.next=5;break}return Y.abrupt("return",this.call(o,f));case 5:return Y.abrupt("return",void 0);case 6:case"end":return Y.stop()}},w,this)}))},n.dispose=function(){this.internalUnregister(ir),this.requestDeferredByMessageId.forEach(function(o){return o.reject(function(e){var n=new Error("Rpc disposed");if(null!=n.stack)return n;try{throw n}catch(i){return i}}())}),this.requestDeferredByMessageId.clear(),this.options.rpcWindow.removeListener(this.onMessageReceived)},n.register=function(o,f){var w=this,T=e.normalizeMethodName(o);this.internalRegister(T,function(){for(var ne,Y,Z=arguments.length,ie=new Array(Z),Fe=0;Fe<Z;Fe++)ie[Fe]=arguments[Fe];return null===(Y=(ne=w.options).onMethodInvoked)||void 0===Y||Y.call(ne,o,ie),f.apply(void 0,ie)})},n.supportsMethod=function(o){return this.internalCall(ir,[o])},n.unregister=function(o){var f=e.normalizeMethodName(o);this.internalUnregister(f)},n.canPostMessage=function(o){return this.ready},n.internalCall=function(o,f){void 0===f&&(f=void 0);var w=Vr(),T={id:w,method:o,params:f},ne=new rr;return this.requestDeferredByMessageId.set(w,ne),this.canPostMessage(T)?this.tryPostMessage(T):this.queuedRequestMessages.push(T),ne.promise},n.internalRegister=function(o,f){if(this.methodCallbackMap.has(o))throw new Error("Rpc method with name '"+o+"' already registered.");this.methodCallbackMap.set(o,f)},n.internalUnregister=function(o){this.methodCallbackMap.delete(o)},n.onReady=function(){this.ready=!0,this.flushRequestMessageQueue()},e.getResponseMessageError=function(o){return o instanceof Error?{message:o.message,name:o.name,stack:o.stack}:o},e.normalizeMethodName=function(o){return o.toUpperCase()},n.flushRequestMessageQueue=function(){var o=this;this.queuedRequestMessages.forEach(function(f){return o.tryPostMessage(f)}),this.queuedRequestMessages=[]},n.handleRequestMessageReceived=function(o){var f=this,w=this.methodCallbackMap.get(o.method);if(w){var T={signature:o.signature,id:o.id};try{var ne=w.apply(this,o.params);Promise.resolve(ne).then(function(Y){T.result=Y,f.postMessage(T)}).catch(function(Y){T.error=e.getResponseMessageError(Y),f.postMessage(T)})}catch(Y){T.error=e.getResponseMessageError(Y),this.postMessage(T)}}},n.handleResponseMessageReceived=function(o){var f=o.id,w=this.requestDeferredByMessageId.get(f);w&&(o.error?w.reject(o.error):w.resolve(o.result),this.requestDeferredByMessageId.delete(f))},n.handleSupportsMethodMessage=function(o){return this.methodCallbackMap.has(e.normalizeMethodName(o))},n.postMessage=function(o){this.options.rpcWindow.postMessage(o)},n.tryPostMessage=function(o){try{this.postMessage(o)}catch(T){if(T instanceof Error){var f=o.id,w=this.requestDeferredByMessageId.get(f);w&&(w.reject(T),this.requestDeferredByMessageId.delete(f))}}},(0,ce.Z)(e,[{key:"rpcHandshakeHandler",get:function(){return this.options.rpcHandshakeHandler}}]),e}(),ar=function(e){function n(o){var f;return(f=e.call(this,o)||this).clientOptions=o,f.internalRegister(o.rpcHandshakeHandler.getReadyMessageMethod(),function(){return f.handleReadyMessage()}),f}return(0,Nr.Z)(n,e),n.prototype.handleReadyMessage=function(){return this.internalUnregister(this.rpcHandshakeHandler.getReadyMessageMethod()),this.onReady(),this.clientOptions.onAck&&this.clientOptions.onAck(),this.rpcHandshakeHandler.createAckResponse()},n}(or);function ci(e,n,i){var o;return e&&Zt(e)&&e.hasOwnProperty(n)&&null!==(o=e[n])&&void 0!==o?o:i}function Zt(e){return function(e){return null!==e&&"object"==typeof e}(e)&&!Array.isArray(e)&&e.constructor===Object}var Sn=function(){function e(i){this.signature=i}var n=e.prototype;return n.deserialize=function(o){var f=o.data;return Zt(f)?ci(f,"data",f):f},n.serialize=function(o){return o.signature=this.signature,{id:o.id,kind:ci(o,"method",e.emptyValue),signature:e.frameSignature,data:o}},e}();Sn.emptyValue="",Sn.frameSignature="FxFrameControl";var un,Er=function(){function e(){}var n=e.prototype;return n.createAckResponse=function(){return"start"},n.getReadyMessageMethod=function(){return"ready"},n.isAckResponse=function(o){return"start"===o},e}(),Pr=function(){function e(i){this.signature=i}var n=e.prototype;return n.deserialize=function(o){return o.data},n.serialize=function(o){return o.signature=this.signature,o},e}(),pi="__PONG__",Ar=function(){function e(){}var n=e.prototype;return n.createAckResponse=function(){return pi},n.getReadyMessageMethod=function(){return"__PING__"},n.isAckResponse=function(o){return o===pi},e}();!function(e){e.Default="default",e.AzurePortal_v1_0_0="azureportal-v1.0.0"}(un||(un={}));var st=function(){function e(i){zt(i.targetWindow),zt(i.sourceWindow),this.options=i,this.eventListeners=new Map}var n=e.prototype;return n.addListener=function(o){var f=this;if(this.eventListeners.has(o))throw new Error("Duplicate rpc listener added.");var w=function(ne){return f.handleMessageReceived(ne,o)};this.eventListeners.set(o,w),this.options.sourceWindow.addEventListener(e.eventTypeName,w)},n.postMessage=function(o){var f=this.options.targetOriginProvider.getTargetOrigin(o);this.options.targetWindow.postMessage(this.options.rpcMessageConverter.serialize(o),f)},n.removeListener=function(o){var f=this.eventListeners.get(o);f&&(this.options.sourceWindow.removeEventListener(e.eventTypeName,f),this.eventListeners.delete(o))},e.isMessageEvent=function(o){return!function(e){return null==e}(o.data)},n.canProcessMessage=function(o){return!!o&&o.signature===this.options.rpcMessageConverter.signature},n.handleMessageReceived=function(o,f){if(e.isMessageEvent(o)){var w=this.options.rpcMessageConverter.deserialize(o);this.canProcessMessage(w)&&this.options.allowedOrigins.some(function(T){return function(e,n){if("*"===n)return!0;if(n.startsWith("https://*.")&&e.startsWith("https://")){var o=n.substring(9);return e.substring(8).endsWith(o)}return e===n}(o.origin,T)})&&(this.options.targetOriginProvider.onMessageReceived(o.origin),f(w))}},e}();st.eventTypeName="message";var zo=function(){function e(i){this.explicitTargetOrigin=i}var n=e.prototype;return n.getTargetOrigin=function(o){return this.explicitTargetOrigin},n.onMessageReceived=function(o){},e}();function Io(e){var n=e.indexOf("#"),i=n>=0?e.substring(0,n):e,o=e.indexOf("?");return o>=0?i.substring(0,o):i}function vi(e){for(var i=e.indexOf("?")>-1?"&":"?",o=arguments.length,f=new Array(o>1?o-1:0),w=1;w<o;w++)f[w-1]=arguments[w];return""+e+i+f.map(function(ne){return encodeURIComponent(ne.name)+"="+encodeURIComponent(ne.value)}).join("&")}function jo(e){var n=e.indexOf("//");if(n>=0){var i=e.indexOf("/",n+=2);if(i>=0)return e.substring(0,i)}return e}function jt(){jt=function(){return n};var e,n={},i=Object.prototype,o=i.hasOwnProperty,f=Object.defineProperty||function(S,g,y){S[g]=y.value},w="function"==typeof Symbol?Symbol:{},T=w.iterator||"@@iterator",ne=w.asyncIterator||"@@asyncIterator",Y=w.toStringTag||"@@toStringTag";function Z(S,g,y){return Object.defineProperty(S,g,{value:y,enumerable:!0,configurable:!0,writable:!0}),S[g]}try{Z({},"")}catch{Z=function(y,O,N){return y[O]=N}}function ie(S,g,y,O){var R=Object.create((g&&g.prototype instanceof dt?g:dt).prototype),te=new kt(O||[]);return f(R,"_invoke",{value:cn(S,y,te)}),R}function Fe(S,g,y){try{return{type:"normal",arg:S.call(g,y)}}catch(O){return{type:"throw",arg:O}}}n.wrap=ie;var ot="suspendedStart",ut="suspendedYield",Et="executing",Re="completed",Se={};function dt(){}function pt(){}function $e(){}var Pt={};Z(Pt,T,function(){return this});var At=Object.getPrototypeOf,mt=At&&At(At(Ft([])));mt&&mt!==i&&o.call(mt,T)&&(Pt=mt);var tt=$e.prototype=dt.prototype=Object.create(Pt);function Wt(S){["next","throw","return"].forEach(function(g){Z(S,g,function(y){return this._invoke(g,y)})})}function vt(S,g){function y(N,R,te,Ce){var Ee=Fe(S[N],S,R);if("throw"!==Ee.type){var Ze=Ee.arg,Ie=Ze.value;return Ie&&"object"==typeof Ie&&o.call(Ie,"__await")?g.resolve(Ie.__await).then(function(Ye){y("next",Ye,te,Ce)},function(Ye){y("throw",Ye,te,Ce)}):g.resolve(Ie).then(function(Ye){Ze.value=Ye,te(Ze)},function(Ye){return y("throw",Ye,te,Ce)})}Ce(Ee.arg)}var O;f(this,"_invoke",{value:function(R,te){function Ce(){return new g(function(Ee,Ze){y(R,te,Ee,Ze)})}return O=O?O.then(Ce,Ce):Ce()}})}function cn(S,g,y){var O=ot;return function(N,R){if(O===Et)throw new Error("Generator is already running");if(O===Re){if("throw"===N)throw R;return{value:e,done:!0}}for(y.method=N,y.arg=R;;){var te=y.delegate;if(te){var Ce=Gt(te,y);if(Ce){if(Ce===Se)continue;return Ce}}if("next"===y.method)y.sent=y._sent=y.arg;else if("throw"===y.method){if(O===ot)throw O=Re,y.arg;y.dispatchException(y.arg)}else"return"===y.method&&y.abrupt("return",y.arg);O=Et;var Ee=Fe(S,g,y);if("normal"===Ee.type){if(O=y.done?Re:ut,Ee.arg===Se)continue;return{value:Ee.arg,done:y.done}}"throw"===Ee.type&&(O=Re,y.method="throw",y.arg=Ee.arg)}}}function Gt(S,g){var y=g.method,O=S.iterator[y];if(O===e)return g.delegate=null,"throw"===y&&S.iterator.return&&(g.method="return",g.arg=e,Gt(S,g),"throw"===g.method)||"return"!==y&&(g.method="throw",g.arg=new TypeError("The iterator does not provide a '"+y+"' method")),Se;var N=Fe(O,S.iterator,g.arg);if("throw"===N.type)return g.method="throw",g.arg=N.arg,g.delegate=null,Se;var R=N.arg;return R?R.done?(g[S.resultName]=R.value,g.next=S.nextLoc,"return"!==g.method&&(g.method="next",g.arg=e),g.delegate=null,Se):R:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,Se)}function ln(S){var g={tryLoc:S[0]};1 in S&&(g.catchLoc=S[1]),2 in S&&(g.finallyLoc=S[2],g.afterLoc=S[3]),this.tryEntries.push(g)}function Dt(S){var g=S.completion||{};g.type="normal",delete g.arg,S.completion=g}function kt(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(ln,this),this.reset(!0)}function Ft(S){if(S||""===S){var g=S[T];if(g)return g.call(S);if("function"==typeof S.next)return S;if(!isNaN(S.length)){var y=-1,O=function N(){for(;++y<S.length;)if(o.call(S,y))return N.value=S[y],N.done=!1,N;return N.value=e,N.done=!0,N};return O.next=O}}throw new TypeError(typeof S+" is not iterable")}return pt.prototype=$e,f(tt,"constructor",{value:$e,configurable:!0}),f($e,"constructor",{value:pt,configurable:!0}),pt.displayName=Z($e,Y,"GeneratorFunction"),n.isGeneratorFunction=function(S){var g="function"==typeof S&&S.constructor;return!!g&&(g===pt||"GeneratorFunction"===(g.displayName||g.name))},n.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,$e):(S.__proto__=$e,Z(S,Y,"GeneratorFunction")),S.prototype=Object.create(tt),S},n.awrap=function(S){return{__await:S}},Wt(vt.prototype),Z(vt.prototype,ne,function(){return this}),n.AsyncIterator=vt,n.async=function(S,g,y,O,N){void 0===N&&(N=Promise);var R=new vt(ie(S,g,y,O),N);return n.isGeneratorFunction(g)?R:R.next().then(function(te){return te.done?te.value:R.next()})},Wt(tt),Z(tt,Y,"Generator"),Z(tt,T,function(){return this}),Z(tt,"toString",function(){return"[object Generator]"}),n.keys=function(S){var g=Object(S),y=[];for(var O in g)y.push(O);return y.reverse(),function N(){for(;y.length;){var R=y.pop();if(R in g)return N.value=R,N.done=!1,N}return N.done=!0,N}},n.values=Ft,kt.prototype={constructor:kt,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Dt),!g)for(var y in this)"t"===y.charAt(0)&&o.call(this,y)&&!isNaN(+y.slice(1))&&(this[y]=e)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var y=this;function O(Ze,Ie){return te.type="throw",te.arg=g,y.next=Ze,Ie&&(y.method="next",y.arg=e),!!Ie}for(var N=this.tryEntries.length-1;N>=0;--N){var R=this.tryEntries[N],te=R.completion;if("root"===R.tryLoc)return O("end");if(R.tryLoc<=this.prev){var Ce=o.call(R,"catchLoc"),Ee=o.call(R,"finallyLoc");if(Ce&&Ee){if(this.prev<R.catchLoc)return O(R.catchLoc,!0);if(this.prev<R.finallyLoc)return O(R.finallyLoc)}else if(Ce){if(this.prev<R.catchLoc)return O(R.catchLoc,!0)}else{if(!Ee)throw new Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return O(R.finallyLoc)}}}},abrupt:function(g,y){for(var O=this.tryEntries.length-1;O>=0;--O){var N=this.tryEntries[O];if(N.tryLoc<=this.prev&&o.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var R=N;break}}R&&("break"===g||"continue"===g)&&R.tryLoc<=y&&y<=R.finallyLoc&&(R=null);var te=R?R.completion:{};return te.type=g,te.arg=y,R?(this.method="next",this.next=R.finallyLoc,Se):this.complete(te)},complete:function(g,y){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&y&&(this.next=y),Se},finish:function(g){for(var y=this.tryEntries.length-1;y>=0;--y){var O=this.tryEntries[y];if(O.finallyLoc===g)return this.complete(O.completion,O.afterLoc),Dt(O),Se}},catch:function(g){for(var y=this.tryEntries.length-1;y>=0;--y){var O=this.tryEntries[y];if(O.tryLoc===g){var N=O.completion;if("throw"===N.type){var R=N.arg;Dt(O)}return R}}throw new Error("illegal catch attempt")},delegateYield:function(g,y,O){return this.delegate={iterator:Ft(g),resultName:y,nextLoc:O},"next"===this.method&&(this.arg=e),Se}},n}var Ci,kr,wi,yi,bi,Si,Ei,Pi,Ai,Di,ki,Fi,Oi,En,Ri,Mi,Ti,Li,zn,Ni,In,jn,Pn,xi,Qt,Vi,Ui,_i,An,Fr,Hi,Qi,Wi,Or,Bn,Gi,zi,Ii,Dn,kn,qn,Jn,$n,Zn,Yn,Xn,ji,Kn,er,tr,Rr,t,r,s,u,a,c,p,v,C,m,h,P,D,G,be,I,k,j,ee,W,Pe,xe,bt,ft,Mr,Bi,qo,Ka,es,ts,ns,rs,is,os,as,ss,us,cs,ls,fs,ds,gs,hs,ps,ms,vs,Cs,ws,ys,bs,Ss,Es,Ps,As,Ds,ks,Fs,Os,Rs,Ms,Gn=function(e,n,i,o){return new(i||(i=Promise))(function(w,T){function ne(ie){try{Z(o.next(ie))}catch(Fe){T(Fe)}}function Y(ie){try{Z(o.throw(ie))}catch(Fe){T(Fe)}}function Z(ie){ie.done?w(ie.value):function(w){return w instanceof i?w:new i(function(T){T(w)})}(ie.value).then(ne,Y)}Z((o=o.apply(e,n||[])).next())})},Bo=function(){function e(i){var f,w,T,o=this,ne=new Date;this.instanceId=Vr(),this.configuration=i;var Y=null!==(f=this.configuration.clientSettings.clientEnvironment)&&void 0!==f?f:this.createDefaultClientEnvironment(this.configuration.clientSettings.container,this.configuration.clientSettings.className),Z=[{name:Fn.ClientInstanceId,value:this.instanceId}];this.configuration.clientSettings.protocolId&&Z.push({name:Fn.ProtocolId,value:this.configuration.clientSettings.protocolId});var ie=vi.apply(Ae,[this.configuration.clientSettings.url].concat(Z));this.appWindow=Y.appWindowFactory(ie);var Fe=void 0!==this.configuration.clientSettings.allowedOrigin?this.configuration.clientSettings.allowedOrigin:"*",ot=function(e,n){return n===un.AzurePortal_v1_0_0?{rpcMessageConverter:new Sn(e),rpcHandshakeHandler:new Er}:{rpcMessageConverter:new Pr(e),rpcHandshakeHandler:new Ar}}(function(e){return null==e?"mspq":"mspq-"+e}(this.instanceId),null!==(w=this.configuration.clientSettings.protocolId)&&void 0!==w?w:un.Default);this.clientRpcChannel=new ar({debugName:"MashupEditorClient.clientRpcChannel",enableDebugLogging:null!==(T=this.configuration.clientSettings.enableDebugLogging)&&void 0!==T&&T,rpcHandshakeHandler:ot.rpcHandshakeHandler,rpcWindow:new st({allowedOrigins:[Fe],rpcMessageConverter:ot.rpcMessageConverter,sourceWindow:Y.clientWindow,targetOriginProvider:new zo(Fe),targetWindow:this.appWindow})}),this.clientRpcEndpoint=new $i(this.clientRpcChannel,{onCancelCurrentFlow:function(){return o.onCancelCurrentFlow()},onCommitCurrentFlow:function(Et){return o.onCommitCurrentFlow(Et)},onCurrentFlowReady:function(){return o.onCurrentFlowReady()},onAppReady:function(){return o.appReady.resolve()}},this,i,ne),this.serviceProxy=new Zi(this.clientRpcChannel),this.appReady=new rr}var n=e.prototype;return n.activateQuery=function(o){return this.serviceProxy.activateQuery(o)},n.addQuery=function(o,f,w){return this.serviceProxy.addQuery(o,f,w)},n.deleteAllQueries=function(){return this.serviceProxy.deleteAllQueries()},n.onHostPopupCancelled=function(o){return this.serviceProxy.onHostPopupCancelled(o)},n.cancelAddQueriesFlow=function(){return this.serviceProxy.cancelAddQueriesFlow()},n.endFlow=function(){return this.appWindow.hide(),this.serviceProxy.endFlow()},n.getActiveQueryName=function(){return this.serviceProxy.getActiveQueryName()},n.getCommitResult=function(){return this.serviceProxy.getCommitResult()},n.getComputeEngineSettings=function(){return this.serviceProxy.getComputeEngineSettings()},n.getCurrentFlow=function(){return this.serviceProxy.getCurrentFlow()},n.getDataSourceQueryScript=function(o,f){return this.serviceProxy.getDataSourceQueryScript(o,f)},n.getEditingSessionId=function(){return this.serviceProxy.getEditingSessionId()},n.getEditingSessionMashup=function(o){return this.serviceProxy.getEditingSessionMashup(o)},n.getMashupGatewayVersion=function(){return this.serviceProxy.getMashupGatewayVersion()},n.getGetDataWizardFlowStage=function(){return this.serviceProxy.getGetDataWizardFlowStage()},n.getFooterMessage=function(){return this.serviceProxy.getFooterMessage()},n.getIncrementalRefreshSettings=function(){return this.serviceProxy.getIncrementalRefreshSettings()},n.getQueriesInfo=function(){return this.serviceProxy.getQueriesInfo()},n.getQueryEditorState=function(){return this.serviceProxy.getQueryEditorState()},n.getQueryEditorStateOrThrow=function(){return this.serviceProxy.getQueryEditorStateOrThrow()},n.getQueryNames=function(){return this.serviceProxy.getQueryNames()},n.getQueryScript=function(o){return this.serviceProxy.getQueryScript(o)},n.getReadyState=function(){return this.serviceProxy.getReadyState()},n.getRefreshSettings=function(){return this.serviceProxy.getRefreshSettings()},n.getSelectedStepName=function(){return this.serviceProxy.getSelectedStepName()},n.getUserSettings=function(){return this.serviceProxy.getUserSettings()},n.isDialogVisible=function(){return this.serviceProxy.isDialogVisible()},n.isFeatureSupported=function(o){return this.serviceProxy.isFeatureSupported(o)},n.isFooterOverlayVisible=function(){return this.serviceProxy.isFooterOverlayVisible()},n.logXFramePerformanceMarks=function(o){return this.serviceProxy.logXFramePerformanceMarks(o)},n.refreshActiveQueryResult=function(){return this.serviceProxy.refreshActiveQueryResult()},n.setCommitButtonEnabledStatePolicy=function(o){return this.serviceProxy.setCommitButtonEnabledStatePolicy(o)},n.setUserSettings=function(o){return this.serviceProxy.setUserSettings(o)},n.startFlow=function(o,f,w,T){return Gn(this,void 0,void 0,jt().mark(function ne(){return jt().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,this.ready;case 2:return ie.next=4,this.getCurrentFlow();case 4:if(null==ie.sent){ie.next=7;break}throw Error("cannot start a new flow when an existing flow is running");case 7:return this.currentFlowConfiguration={flowReady:new rr,shouldEndFlowOnCommit:J(o),shouldEndFlowOnCancel:me(o),onCommit:function(ot,ut){if(U(ut,o))return f(ot,ut);throw new Error("The flow "+o.kind+" returned the wrong type of result: "+ut.kind)},onCancel:w},this.appWindow.show(),this.serviceProxy.startFlow(o,T),ie.abrupt("return",this.currentFlowConfiguration.flowReady.promise);case 11:case"end":return ie.stop()}},ne,this)}))},n.dispose=function(){return Gn(this,void 0,void 0,jt().mark(function o(){return jt().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return this.appWindow.hide(),w.prev=1,w.next=4,this.serviceProxy.disposeService();case 4:return w.prev=4,this.clientRpcEndpoint.dispose(),this.clientRpcChannel.dispose(),this.appWindow.dispose(),w.finish(4);case 9:case"end":return w.stop()}},o,this,[[1,,4,9]])}))},n.trySetQueryScript=function(o,f){return this.serviceProxy.trySetQueryScript(o,f)},n.createDefaultClientEnvironment=function(o,f){return{clientWindow:window,appWindowFactory:function(T){return new Lr(T,o,f)}}},n.onCancelCurrentFlow=function(){return Gn(this,void 0,void 0,jt().mark(function o(){return jt().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!this.configuration.onCancel){w.next=2;break}return w.abrupt("return",this.configuration.onCancel(this));case 2:return zt(this.currentFlowConfiguration),w.next=5,this.currentFlowConfiguration.onCancel(this);case 5:this.currentFlowConfiguration.shouldEndFlowOnCancel&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return w.stop()}},o,this)}))},n.onCommitCurrentFlow=function(o){return Gn(this,void 0,void 0,jt().mark(function f(){return jt().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!this.configuration.onCommit){T.next=2;break}return T.abrupt("return",this.configuration.onCommit(this));case 2:return zt(this.currentFlowConfiguration),T.next=5,this.currentFlowConfiguration.onCommit(this,o);case 5:this.currentFlowConfiguration.shouldEndFlowOnCommit&&(this.appWindow.hide(),this.currentFlowConfiguration=void 0);case 6:case"end":return T.stop()}},f,this)}))},n.onCurrentFlowReady=function(){zt(this.currentFlowConfiguration),this.currentFlowConfiguration.flowReady.resolve()},(0,ce.Z)(e,[{key:"dataPreview",get:function(){var o=this;return{cancelCurrentEvaluation:function(){return o.serviceProxy.dataPreview_cancelCurrentQueryEvaluation()},selectColumns:function(w){return o.serviceProxy.dataPreview_selectColumns(w)}}}},{key:"getDataWizardFooterCallbacks",get:function(){var o=this;return{clickCancelButton:function(){return o.serviceProxy.getDataWizardFooter_clickCancelButton()},clickCommitButton:function(){return o.serviceProxy.getDataWizardFooter_clickCommitButton()},clickCustomButton:function(){return o.serviceProxy.getDataWizardFooter_clickCustomButton()},clickNextStageButton:function(){return o.serviceProxy.getDataWizardFooter_clickNextStageButton()},clickPreviousStageButton:function(){return o.serviceProxy.getDataWizardFooter_clickPreviousStageButton()}}}},{key:"cancelButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickCancelButton()},getLabel:function(){return o.serviceProxy.getCancelButtonLabel()},isEnabled:function(){return o.serviceProxy.isCancelButtonEnabled()},isVisible:function(){return o.serviceProxy.isCancelButtonVisible()}}}},{key:"commitButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickCommitButton()},getLabel:function(){return o.serviceProxy.getCommitButtonLabel()},isEnabled:function(){return o.serviceProxy.isCommitButtonEnabled()},isVisible:function(){return o.serviceProxy.isCommitButtonVisible()}}}},{key:"customButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickCustomButton()},getLabel:function(){return o.serviceProxy.getCustomButtonLabel()},isEnabled:function(){return o.serviceProxy.isCustomButtonEnabled()},isVisible:function(){return o.serviceProxy.isCustomButtonVisible()}}}},{key:"nextStageButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickNextStageButton()},getLabel:function(){return o.serviceProxy.getNextStageButtonLabel()},isEnabled:function(){return o.serviceProxy.isNextStageButtonEnabled()},isVisible:function(){return o.serviceProxy.isNextStageButtonVisible()}}}},{key:"createConnectionFlowCallbacks",get:function(){var o=this;return{commit:function(w){return o.serviceProxy.createConnectionFlow_commit(w)}}}},{key:"previousStageButton",get:function(){var o=this;return{click:function(){return o.serviceProxy.clickPreviousStageButton()},getLabel:function(){return o.serviceProxy.getPreviousStageButtonLabel()},isEnabled:function(){return o.serviceProxy.isPreviousStageButtonEnabled()},isVisible:function(){return o.serviceProxy.isPreviousStageButtonVisible()}}}},{key:"ready",get:function(){return this.appReady.promise}}]),e}();!function(e){e.Success="Success",e.Error_EmptyName="Error_EmptyName",e.Error_InvalidCharacters="Error_InvalidCharacters",e.Error_NameAlreadyExists="Error_NameAlreadyExists",e.Error_NameTooLong="Error_NameTooLong"}(Ci||(Ci={})),function(e){e.Cancel="Cancel",e.Commit="Commit"}(kr||(kr={})),function(e){e.AlwaysCancel="AlwaysCancel",e.AlwaysCommit="AlwaysCommit",e.Ask="Ask"}(wi||(wi={})),function(e){e.BuiltInCommand="BuiltInCommand",e.HostCommand="HostCommand"}(yi||(yi={})),function(e){e.Kusto="kusto",e.Sql="sql"}(bi||(bi={})),function(e){e.StepLabel="StepLabel",e.StepName="StepName"}(Si||(Si={})),function(e){e.CalculatedEntity="CalculatedEntity",e.Default="Default",e.LinkedEntity="LinkedEntity",e.Parameter="Parameter",e.Visual="Visual"}(Ei||(Ei={})),function(e){e.Data="Data",e.Schema="Schema"}(Pi||(Pi={})),function(e){e.None="None",e.Query="Query",e.Step="Step"}(Ai||(Ai={})),function(e){e.Critical="Critical",e.Error="Error"}(Di||(Di={})),function(e){e.AlwaysDisabled="AlwaysDisabled",e.Default="Default"}(ki||(ki={})),function(e){e.Cancelled="Cancelled",e.Completed="Completed",e.Failed="Failed",e.NotStarted="NotStarted",e.Running="Running"}(Fi||(Fi={})),function(e){e.Access="Access",e.Access_Monocolor="Access_Monocolor",e.ActiveDirectory="ActiveDirectory",e.AddFuzzyClusterColumn="AddFuzzyClusterColumn",e.AddRankColumn="AddRankColumn",e.AdobeAnalytics="AdobeAnalytics",e.AIInsights="AIInsights",e.AllFilled="AllFilled",e.AllRegular="AllRegular",e.Alternates="Alternates",e.AnyType="AnyType",e.AppendQueries="AppendQueries",e.AppendQueriesAsNew="AppendQueriesAsNew",e.AzureAnalysisServices="AzureAnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureFilled="AzureFilled",e.AzureHdInsightClusters="AzureHdInsightClusters",e.AzureRegular="AzureRegular",e.AzureSql="AzureSql",e.AzureSynapse="AzureSynapse",e.AzureTables="AzureTables",e.Binary="Binary",e.Blog="Blog",e.BlueLink="BlueLink",e.CalculatedEntity="CalculatedEntity",e.Calculator="Calculator",e.Cancel="Cancel",e.CancelRefresh="CancelRefresh",e.Cds="Cds",e.ChartClusteredBar="ChartClusteredBar",e.ChartClusteredColumn="ChartClusteredColumn",e.ChartLine="ChartLine",e.ChartPercentageStackedArea="ChartPercentageStackedArea",e.ChartPercentageStackedBar="ChartPercentageStackedBar",e.ChartPercentageStackedColumn="ChartPercentageStackedColumn",e.ChartStackedArea="ChartStackedArea",e.ChartStackedBar="ChartStackedBar",e.ChartStackedColumn="ChartStackedColumn",e.Checkmark="Checkmark",e.ChooseColumns="ChooseColumns",e.ClearFilter="ClearFilter",e.Close="Close",e.CloseAndLoad="CloseAndLoad",e.CloseAndLoadTo="CloseAndLoadTo",e.CloseRed="CloseRed",e.Column="Column",e.ColumnByExample="ColumnByExample",e.CombineFiles="CombineFiles",e.Community="Community",e.ConditionalColumn="ConditionalColumn",e.ConnectDatabase="ConnectDatabase",e.Copilot="Copilot",e.Copy="Copy",e.CountRows="CountRows",e.Cube="Cube",e.CubeAddAndExpandDimensionColumn="CubeAddAndExpandDimensionColumn",e.CubeCollapseAndRemoveColumns="CubeCollapseAndRemoveColumns",e.CubeDimension="CubeDimension",e.CubeDimensionAttribute="CubeDimensionAttribute",e.CubeDimensionHierarchy="CubeDimensionHierarchy",e.CubeMeasure="CubeMeasure",e.CubeServer="CubeServer",e.Currency="Currency",e.CustomColumn="CustomColumn",e.Cut="Cut",e.Database="Database",e.DatabaseClock="DatabaseClock",e.DatabaseDynamic="DatabaseDynamic",e.DatabaseFilled="DatabaseFilled",e.DatabaseLightning="DatabaseLightning",e.DatabaseOpaque="DatabaseOpaque",e.DatabaseRefresh="DatabaseRefresh",e.DatabaseRegular="DatabaseRegular",e.Databases="Databases",e.DatabaseUnknown="DatabaseUnknown",e.Dataflows="Dataflows",e.Dataverse="Dataverse",e.Date="Date",e.DateTime="DateTime",e.DateTimeZone="DateTimeZone",e.Delete="Delete",e.DeleteFile="DeleteFile",e.DemoteHeaders="DemoteHeaders",e.DetectDataType="DetectDataType",e.Diagram="Diagram",e.Documentation="Documentation",e.DragQueries="DragQueries",e.DragQueryGroups="DragQueryGroups",e.DuplicateColumn="DuplicateColumn",e.Duration="Duration",e.Dynamics365="Dynamics365",e.Empty="Empty",e.Entity="Entity",e.Error="Error",e.Excel="Excel",e.Excel_Monocolor="Excel_Monocolor",e.Exchange="Exchange",e.Exchange_Monocolor="Exchange_Monocolor",e.Expand="Expand",e.ExpandColumn="ExpandColumn",e.Fabric="Fabric",e.FabricFilled="FabricFilled",e.FabricRegular="FabricRegular",e.FastCopy="FastCopy",e.Feedback="Feedback",e.FeedbackExtremelyDissatisfied="FeedbackExtremelyDissatisfied",e.FeedbackExtremelySatisfied="FeedbackExtremelySatisfied",e.FeedbackSomewhatDissatisfied="FeedbackSomewhatDissatisfied",e.FeedbackSomewhatSatisfied="FeedbackSomewhatSatisfied",e.Fhir="Fhir",e.FileFilled="FileFilled",e.FileRegular="FileRegular",e.FillDown="FillDown",e.FillUp="FillUp",e.Filter="Filter",e.FitToView="FitToView",e.FluentView="FluentView",e.Folder="Folder",e.FormatText="FormatText",e.FullScreen="FullScreen",e.Function="Function",e.Gear="Gear",e.GetData="GetData",e.GoogleAnalytics="GoogleAnalytics",e.GoToColumn="GoToColumn",e.GridAutoFilter="GridAutoFilter",e.GridCombineFiles="GridCombineFiles",e.GridEditFilter="GridEditFilter",e.GridExpandColumn="GridExpandColumn",e.GridSortedAscending="GridSortedAscending",e.GridSortedDescending="GridSortedDescending",e.GroupBy="GroupBy",e.HorizontalLayout="HorizontalLayout",e.IndexColumn="IndexColumn",e.Info="Info",e.InsertColumnsLeft="InsertColumnsLeft",e.InsertColumnsRight="InsertColumnsRight",e.InsertRowsAbove="InsertRowsAbove",e.InsertRowsBelow="InsertRowsBelow",e.InvokeCustomFunction="InvokeCustomFunction",e.JoinKindFullOuter="JoinKindFullOuter",e.JoinKindInner="JoinKindInner",e.JoinKindLeftAnti="JoinKindLeftAnti",e.JoinKindLeftOuter="JoinKindLeftOuter",e.JoinKindRightAnti="JoinKindRightAnti",e.JoinKindRightOuter="JoinKindRightOuter",e.KeepBottomRows="KeepBottomRows",e.KeepDuplicates="KeepDuplicates",e.KeepErrors="KeepErrors",e.KeepRange="KeepRange",e.KeepTopRows="KeepTopRows",e.Key="Key",e.KeyboardShortcuts="KeyboardShortcuts",e.Kusto="Kusto",e.LightBulb="LightBulb",e.LinkedEntity="LinkedEntity",e.List="List",e.ListToTable="ListToTable",e.Load="Load",e.Logical="Logical",e.ManageConnections="ManageConnections",e.ManageDataSources="ManageDataSources",e.Map="Map",e.MapToEntity="MapToEntity",e.MashupGraphCollapse="MashupGraphCollapse",e.MashupGraphExpand="MashupGraphExpand",e.MashupGraphRelated="MashupGraphRelated",e.MathInfo="MathInfo",e.MergeColumns="MergeColumns",e.MergeQueries="MergeQueries",e.MergeQueriesAsNew="MergeQueriesAsNew",e.More="More",e.MoveColumns="MoveColumns",e.MoveColumnsLeft="MoveColumnsLeft",e.MoveColumnsRight="MoveColumnsRight",e.MoveColumnsToBeginning="MoveColumnsToBeginning",e.MoveColumnsToEnd="MoveColumnsToEnd",e.MoveDown="MoveDown",e.MoveLeft="MoveLeft",e.MoveRight="MoveRight",e.MoveUp="MoveUp",e.Neutral="Neutral",e.Number="Number",e.OData="OData",e.Odbc="Odbc",e.OnlineServicesFilled="OnlineServicesFilled",e.OnlineServicesRegular="OnlineServicesRegular",e.OtherFilled="OtherFilled",e.OtherRegular="OtherRegular",e.Parameter="Parameter",e.Parquet="Parquet",e.Parse="Parse",e.Paste="Paste",e.Pdf="Pdf",e.Pencil="Pencil",e.Percentage="Percentage",e.PivotColumn="PivotColumn",e.Plus="Plus",e.PowerBI="PowerBI",e.PowerBIReport="PowerBIReport",e.PowerPlatformFilled="PowerPlatformFilled",e.PowerPlatformRegular="PowerPlatformRegular",e.PowerQuery="PowerQuery",e.PrimitiveToList="PrimitiveToList",e.PrivacyBuffering="PrivacyBuffering",e.PromoteHeaders="PromoteHeaders",e.Properties="Properties",e.QuerySettings="QuerySettings",e.QuestionMark="QuestionMark",e.Record="Record",e.Reference="Reference",e.Refresh="Refresh",e.RemoveAlternateRows="RemoveAlternateRows",e.RemoveBlankRows="RemoveBlankRows",e.RemoveBottomRows="RemoveBottomRows",e.RemoveColumns="RemoveColumns",e.RemoveDuplicates="RemoveDuplicates",e.RemoveErrors="RemoveErrors",e.RemoveOtherColumns="RemoveOtherColumns",e.RemoveRows="RemoveRows",e.RemoveTopRows="RemoveTopRows",e.Rename="Rename",e.ReplaceErrors="ReplaceErrors",e.ReplaceValues="ReplaceValues",e.Reset="Reset",e.ReverseRows="ReverseRows",e.Rounding="Rounding",e.Salesforce="Salesforce",e.Save="Save",e.Scientific="Scientific",e.Script="Script",e.Sensitivity="Sensitivity",e.Settings="Settings",e.Share="Share",e.SharePoint="SharePoint",e.Sheet="Sheet",e.SheetAccess="SheetAccess",e.SheetCsv="SheetCsv",e.SheetDataflow="SheetDataflow",e.SheetExcel="SheetExcel",e.SheetHtml="SheetHtml",e.SheetJson="SheetJson",e.SheetSql="SheetSql",e.SheetText="SheetText",e.SheetXml="SheetXml",e.SortAscending="SortAscending",e.SortDescending="SortDescending",e.Spark="Spark",e.Sparkle="Sparkle",e.Sparkle_Monocolor="Sparkle_Monocolor",e.SplitColumn="SplitColumn",e.Standard="Standard",e.Statistics="Statistics",e.Success="Success",e.Suggestion="Suggestion",e.Support="Support",e.Table="Table",e.TableSchema="TableSchema",e.Template="Template",e.Text="Text",e.TextFile="TextFile",e.Time="Time",e.ToTable="ToTable",e.Transpose="Transpose",e.Trigonometry="Trigonometry",e.UnknownType="UnknownType",e.Unlink="Unlink",e.UnpivotColumns="UnpivotColumns",e.Vertica="Vertica",e.VerticalLayout="VerticalLayout",e.View="View",e.Visual="Visual",e.Wand="Wand",e.Warning="Warning",e.Web="Web",e.Website="Website",e.WholeNumber="WholeNumber",e.Worksheet="Worksheet"}(Oi||(Oi={})),function(e){e.FullRefresh="FullRefresh",e.IncrementalRefresh="IncrementalRefresh"}(En||(En={})),function(e){e.Days="Days",e.Months="Months",e.Quarters="Quarters",e.Years="Years"}(Ri||(Ri={})),function(e){e.Custom="Custom",e.Standard="Standard",e.System="System"}(Mi||(Mi={})),function(e){e.EvaluateTop1000Rows="EvaluateTop1000Rows",e.EvaluateEntireDataset="EvaluateEntireDataset"}(Ti||(Ti={})),function(e){e.Action="Action.Type",e.Any="Any.Type",e.Binary="Binary.Type",e.Byte="Byte.Type",e.Character="Character.Type",e.Currency="Currency.Type",e.Date="Date.Type",e.DateTime="DateTime.Type",e.DateTimeZone="DateTimeZone.Type",e.Decimal="Decimal.Type",e.Double="Double.Type",e.Duration="Duration.Type",e.Function="Function.Type",e.Int16="Int16.Type",e.Int32="Int32.Type",e.Int64="Int64.Type",e.Int8="Int8.Type",e.List="List.Type",e.Logical="Logical.Type",e.None="None.Type",e.Null="Null.Type",e.Number="Number.Type",e.Percentage="Percentage.Type",e.Record="Record.Type",e.Single="Single.Type",e.Table="Table.Type",e.Text="Text.Type",e.Time="Time.Type",e.Type="Type.Type"}(Li||(Li={})),function(e){e.MultiLine="MultiLine",e.SingleLine="SingleLine"}(zn||(zn={})),function(e){e.Always="Always",e.BasedOnProjectSettings="BasedOnProjectSettings",e.Never="Never"}(Ni||(Ni={})),function(e){e.Collapsed="Collapsed",e.Expanded="Expanded",e.Maximized="Maximized"}(In||(In={})),function(e){e.Host="Host",e.Initialization="Initialization",e.UserInteraction="UserInteraction"}(jn||(jn={})),function(e){e.Action="action",e.Any="any",e.AnyNonNull="anynonnull",e.Binary="binary",e.Currency="currency",e.Date="date",e.DateTime="datetime",e.DateTimeZone="datetimezone",e.Duration="duration",e.Exception="exception",e.Function="function",e.List="list",e.Logical="logical",e.None="none",e.Null="null",e.Number="number",e.Percentage="percentage",e.Record="record",e.Table="table",e.Text="text",e.Time="time",e.Type="type",e.WholeNumber="wholenumber"}(Pn||(Pn={})),function(e){e.Auto="Auto",e.Percent="Percent",e.Pixels="Pixels"}(xi||(xi={})),function(e){e.Cells="Cells",e.Columns="Columns",e.Rows="Rows"}(Qt||(Qt={})),function(e){e.Access="access",e.ActiveDirectory="activeDirectory",e.AdobeAnalytics="adobeAnalytics",e.AnalysisServices="analysisServices",e.AzureAnalysisServices="azureAnalysisServices",e.AzureBlobs="azureBlobs",e.AzureDataLake="azureDataLake",e.AzureHdInsightHdfs="azureHdInsightHdfs",e.AzureSql="azureSql",e.AzureSqlDw="azureSqlDW",e.AzureTables="azureTables",e.Blank="blank",e.Db2="db2",e.Dynamics365="dynamics365",e.EnterData="enterData",e.Excel="excel",e.ExchangeOnline="exchangeOnline",e.FolderContents="folderContents",e.FolderFiles="folderFiles",e.GoogleAnalytics="googleAnalytics",e.Json="json",e.MySql="mySql",e.Odata="odata",e.Odbc="odbc",e.Oracle="oracle",e.Parquet="parquet",e.Pdf="pdf",e.PostgreSql="postgreSql",e.SharepointFolder="sharepointFolder",e.SharepointList="sharepointList",e.SharepointOnlineList="sharepointOnlineList",e.SalesforceObjects="salesforceObjects",e.SalesforceReports="salesforceReports",e.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",e.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",e.SapHanaDatabase="SapHanaDatabase",e.Sql="sql",e.Sybase="sybase",e.Teradata="teradata",e.TextCsv="textCsv",e.Web="web",e.WebApi="webApi",e.Xml="xml"}(Vi||(Vi={})),function(e){e.Extension="extension"}(Ui||(Ui={})),function(e){e.Failed="Failed",e.Idle="Idle",e.InProgress="InProgress",e.Success="Success"}(_i||(_i={})),function(e){e.WaitingToStart="WaitingToStart",e.EvaluatingRelationships="EvaluatingRelationships",e.WaitingForOtherEntities="WaitingForOtherEntities",e.EvaluatingSchema="EvaluatingSchema",e.DeletingEntity="DeletingEntity",e.CreatingEntity="CreatingEntity",e.DeletingExistingData="DeletingExistingData",e.EvaluatingData="EvaluatingData",e.ProvisioningTempStorage="ProvisioningTempStorage",e.UploadingDataToTempStorage="UploadingDataToTempStorage",e.InitializingLoadSession="InitializingLoadSession",e.WaitingForLoadSessionToInitialize="WaitingForLoadSessionToInitialize",e.CreatingDefinitionGroup="CreatingDefinitionGroup",e.CreatingDefinitionGroupDetails="CreatingDefinitionGroupDetails",e.UploadingData="UploadingData",e.GeneratingFieldMapping="GeneratingFieldMapping",e.AutoSequencing="AutoSequencing",e.ExecutingLoad="ExecutingLoad",e.WaitingForLoadToComplete="WaitingForLoadToComplete",e.GeneratingExecutionErrors="GeneratingExecutionErrors",e.Success="Success",e.SignInRequired="SignInRequired",e.DeletingExistingDataFailed="DeletingExistingDataFailed",e.EvaluationFailed="EvaluationFailed",e.CreatingEntityFailed="CreatingEntityFailed",e.DeletingEntityFailed="DeletingEntityFailed",e.RetrievingEntityMetadataFailed="RetrievingEntityMetadataFailed",e.Canceled="Canceled",e.LoadToCdsPartiallySucceeded="LoadToCdsPartiallySucceeded",e.LoadToCdsFailed="LoadToCdsFailed",e.LoadFailedDueToErrorInOtherEntity="LoadFailedDueToErrorInOtherEntity",e.Unknown="Unknown"}(An||(An={})),function(e){e.Composition="Composition",e.Conditional="Conditional",e.CountDistinctValues="CountDistinctValues",e.CountValues="CountValues",e.Date_Age="Date_Age",e.Date_CombineWithTime="Date_CombineWithTime",e.Date_Day="Date_Day",e.Date_DayOfWeek="Date_DayOfWeek",e.Date_DayOfWeekName="Date_DayOfWeekName",e.Date_DayOfYear="Date_DayOfYear",e.Date_DaysInMonth="Date_DaysInMonth",e.Date_Earliest="Date_Earliest",e.Date_EndOfDay="Date_EndOfDay",e.Date_EndOfMonth="Date_EndOfMonth",e.Date_EndOfQuarter="Date_EndOfQuarter",e.Date_EndOfWeek="Date_EndOfWeek",e.Date_EndOfYear="Date_EndOfYear",e.Date_From="Date_From",e.Date_Latest="Date_Latest",e.Date_Month="Date_Month",e.Date_MonthName="Date_MonthName",e.Date_QuarterOfYear="Date_QuarterOfYear",e.Date_StartOfDay="Date_StartOfDay",e.Date_StartOfMonth="Date_StartOfMonth",e.Date_StartOfQuarter="Date_StartOfQuarter",e.Date_StartOfWeek="Date_StartOfWeek",e.Date_StartOfYear="Date_StartOfYear",e.Date_SubtractDays="Date_SubtractDays",e.Date_WeekOfMonth="Date_WeekOfMonth",e.Date_WeekOfYear="Date_WeekOfYear",e.Date_Year="Date_Year",e.DateTime_Earliest="DateTime_Earliest",e.DateTime_From="DateTime_From",e.DateTime_Latest="DateTime_Latest",e.DateTime_Subtract="DateTime_Subtract",e.DateTime_SubtractDays="DateTime_SubtractDays",e.DateTimeZone_Earliest="DateTimeZone_Earliest",e.DateTimeZone_From="DateTimeZone_From",e.DateTimeZone_Latest="DateTimeZone_Latest",e.DateTimeZone_Subtract="DateTimeZone_Subtract",e.DateTimeZone_SubtractDays="DateTimeZone_SubtractDays",e.DateTimeZone_ToLocal="DateTimeZone_ToLocal",e.Number_Abs="Number_Abs",e.Number_Acos="Number_Acos",e.Number_Asin="Number_Asin",e.Number_Atan="Number_Atan",e.Number_Average="Number_Average",e.Number_Cos="Number_Cos",e.Number_Cube="Number_Cube",e.Number_Divide="Number_Divide",e.Number_Exp="Number_Exp",e.Number_Factorial="Number_Factorial",e.Number_From="Number_From",e.Number_IntegerDivide="Number_IntegerDivide",e.Number_IsEven="Number_IsEven",e.Number_IsOdd="Number_IsOdd",e.Number_Ln="Number_Ln",e.Number_Log10="Number_Log10",e.Number_Maximum="Number_Maximum",e.Number_Median="Number_Median",e.Number_Minimum="Number_Minimum",e.Number_Modulo="Number_Modulo",e.Number_MultiplyColumnAndConstant="Number_MultiplyColumnAndConstant",e.Number_MultiplyColumns="Number_MultiplyColumns",e.Number_PercentOf="Number_PercentOf",e.Number_Power="Number_Power",e.Number_Range="Number_Range",e.Number_Round="Number_Round",e.Number_RoundDown="Number_RoundDown",e.Number_RoundUp="Number_RoundUp",e.Number_Sign="Number_Sign",e.Number_Sin="Number_Sin",e.Number_Sqrt="Number_Sqrt",e.Number_Square="Number_Square",e.Number_StandardDeviation="Number_StandardDeviation",e.Number_Subtract="Number_Subtract",e.Number_SumColumnAndConstant="Number_SumColumnAndConstant",e.Number_SumColumns="Number_SumColumns",e.Number_Tan="Number_Tan",e.Reference="Reference",e.Text_AfterDelimiter="Text_AfterDelimiter",e.Text_BeforeDelimiter="Text_BeforeDelimiter",e.Text_BetweenDelimiters="Text_BetweenDelimiters",e.Text_Combine="Text_Combine",e.Text_End="Text_End",e.Text_Length="Text_Length",e.Text_Literal="Text_Literal",e.Text_Middle="Text_Middle",e.Text_Reference="Text_Reference",e.Text_Remove="Text_Remove",e.Text_Replace="Text_Replace",e.Text_Select="Text_Select",e.Text_Start="Text_Start",e.Time_Earliest="Time_Earliest",e.Time_EndOfHour="Time_EndOfHour",e.Time_From="Time_From",e.Time_Hour="Time_Hour",e.Time_Latest="Time_Latest",e.Time_Minute="Time_Minute",e.Time_Second="Time_Second",e.Time_StartOfHour="Time_StartOfHour",e.Time_Subtract="Time_Subtract"}(Fr||(Fr={})),function(e){e.UnknownError="UnknownError",e.InvalidConnectionProvider="InvalidConnectionProvider"}(Hi||(Hi={})),function(e){e.Adf="Adf",e.CdsA="CdsA",e.Desktop="Desktop",e.DmtsPowerBi="DmtsPowerBi",e.DmtsSa="DmtsSa",e.None="None",e.PowerApps="PowerApps",e.SelfHosted="SelfHosted"}(Qi||(Qi={})),function(e){e.SqlDw="SqlDw",e.SynapseOnDemand="SynapseOnDemand"}(Wi||(Wi={})),function(e){e.Error="Error",e.Warning="Warning"}(Or||(Or={})),function(e){e[e.sunday=0]="sunday",e[e.monday=1]="monday",e[e.tuesday=2]="tuesday",e[e.wednesday=3]="wednesday",e[e.thursday=4]="thursday",e[e.friday=5]="friday",e[e.saturday=6]="saturday"}(Bn||(Bn={})),function(e){e.Boolean="Boolean",e.DateAndTime="DateAndTime",e.DateOnly="DateOnly",e.Decimal="Decimal",e.Double="Double",e.Integer="Integer",e.Lookup="Lookup",e.Memo="Memo",e.Money="Money",e.String="String"}(Gi||(Gi={})),function(e){e.Resource="Resource",e.Personal="Personal",e.VirtualNetwork="VirtualNetwork"}(zi||(zi={})),function(e){e[e.none=0]="none",e[e.fetchDataSourceDetails=1]="fetchDataSourceDetails",e[e.schemaRowsets=2]="schemaRowsets",e[e.mdDataset=4]="mdDataset",e[e.columnOrdinals=8]="columnOrdinals",e[e.statefulSessions=16]="statefulSessions",e[e.directQuerySingleSignOn_Kerberos=32]="directQuerySingleSignOn_Kerberos",e[e.mashupCustomConnectors=64]="mashupCustomConnectors",e[e.mashupCustomConnectorsForODG=128]="mashupCustomConnectorsForODG",e[e.sapHanaSSOManagedProvider=256]="sapHanaSSOManagedProvider",e[e.filteringMashupExtensionsOnODG=512]="filteringMashupExtensionsOnODG",e[e.certifiedConnectors=1024]="certifiedConnectors",e[e.mashupAzureConnectorsCachingPool=2048]="mashupAzureConnectorsCachingPool",e[e.skipTestConnection=4096]="skipTestConnection",e[e.encryptedConnectionOptionOverride=8192]="encryptedConnectionOptionOverride",e[e.mashupADONetProviderSSO=16384]="mashupADONetProviderSSO",e[e.authTypeSAS=32768]="authTypeSAS",e[e.powerQueryOnlineCachingPool=65536]="powerQueryOnlineCachingPool",e[e.ssoTestConnection=131072]="ssoTestConnection",e[e.mashupIgnorePreviouslyCachedData=262144]="mashupIgnorePreviouslyCachedData",e[e.mashupQueryStatus=524288]="mashupQueryStatus",e[e.multipleResults=1048576]="multipleResults",e[e.renewDiagnosticsStorageAccess=2097152]="renewDiagnosticsStorageAccess",e[e.oAuthResource=4194304]="oAuthResource",e[e.statefulDbConnection=8388608]="statefulDbConnection",e[e.discoverDatasourcesUsingMashupDSR=16777216]="discoverDatasourcesUsingMashupDSR"}(Ii||(Ii={})),function(e){e.Critical="Critical",e.Error="Error",e.Warning="Warning",e.Informational="Informational",e.Verbose="Verbose"}(Dn||(Dn={})),function(e){e[e.connectionNotFound=0]="connectionNotFound",e[e.failedToRefreshConnection=1]="failedToRefreshConnection",e[e.unauthorizedConnection=2]="unauthorizedConnection"}(kn||(kn={})),function(e){e.DifferentUser="DifferentUser",e.NoMatchingConnection="NoMatchingConnection",e.NonOAuthConnection="NonOAuthConnection ",e.NoToken="NoToken"}(qn||(qn={})),function(e){e.Active="ActivePowerAppsEnvironment",e.HardDeleted="HardDeletedPowerAppsEnvironment",e.SoftDeleted="SoftDeletedPowerAppsEnvironment",e.Unknown="UnknownPowerAppsEnvironment"}(Jn||(Jn={})),function(e){e.MappingEditorProperties="MappingEditorProperties"}($n||($n={})),function(e){e[e.day=0]="day",e[e.month=1]="month",e[e.quarter=2]="quarter",e[e.year=3]="year"}(Zn||(Zn={})),function(e){e.Minutes="Minutes",e.Hours="Hours",e.Days="Days",e.Weeks="Weeks",e.Months="Months"}(Yn||(Yn={})),function(e){e[e.uploadFileMalformedMultipartContent=1]="uploadFileMalformedMultipartContent",e[e.uploadFileUnsupportedFileExtension=2]="uploadFileUnsupportedFileExtension",e[e.oAuthStartLoginFailed=3]="oAuthStartLoginFailed",e[e.oAuthFinishLoginFailed=4]="oAuthFinishLoginFailed",e[e.normalizeResourceFailed=8]="normalizeResourceFailed",e[e.editVersionMismatch=9]="editVersionMismatch",e[e.updateGatewayVersion=10]="updateGatewayVersion",e[e.mashupTooLong=11]="mashupTooLong",e[e.gatewayBindingMultipleMatchingGatewayError=12]="gatewayBindingMultipleMatchingGatewayError",e[e.gatewayBindingNoMatchingDataSourceError=13]="gatewayBindingNoMatchingDataSourceError",e[e.gatewayBindingNoMatchingGatewayError=14]="gatewayBindingNoMatchingGatewayError"}(Xn||(Xn={})),function(e){e.NoTextExampleFound="NoTextExampleFound",e.NoTextProgramFound="NoTextProgramFound",e.NoTextProgramFoundBeforeCancellation="NoTextProgramFoundBeforeCancellation",e.NoTextProgramFoundBeforeTimeout="NoTextProgramFoundBeforeTimeout"}(ji||(ji={})),function(e){e.Successful="Successful",e.Failed="Failed",e.SessionExpired="SessionExpired"}(Kn||(Kn={})),function(e){e.AM="AM",e.PM="PM"}(er||(er={})),function(e){e[e.anonymous=1]="anonymous",e[e.basic=2]="basic",e[e.oAuth2=3]="oAuth2",e[e.windows=4]="windows",e[e.key=5]="key",e[e.sas=6]="sas",e[e.servicePrincipal=7]="servicePrincipal"}(tr||(tr={})),function(e){e.Access="access",e.ActiveDirectory="activeDirectory",e.AdobeAnalytics="adobeAnalytics",e.AnalysisServices="analysisServices",e.AzureAnalysisServices="azureAnalysisServices",e.AzureBlobs="azureBlobs",e.AzureDataLake="azureDataLake",e.AzureHdInsightHdfs="azureHdInsightHdfs",e.AzureSql="azureSql",e.AzureSqlDw="azureSqlDW",e.AzureTables="azureTables",e.Blank="blank",e.Db2="db2",e.Dynamics365="dynamics365",e.EnterData="enterData",e.Excel="excel",e.ExchangeOnline="exchangeOnline",e.FolderContents="folderContents",e.FolderFiles="folderFiles",e.GoogleAnalytics="googleAnalytics",e.Json="json",e.MySql="mySql",e.Odata="odata",e.Odbc="odbc",e.Oracle="oracle",e.Parquet="parquet",e.Pdf="pdf",e.PostgreSql="postgreSql",e.SharepointFolder="sharepointFolder",e.SharepointList="sharepointList",e.SharepointOnlineList="sharepointOnlineList",e.SalesforceObjects="salesforceObjects",e.SalesforceReports="salesforceReports",e.SapBusinessWarehouseAppServer="SapBusinessWarehouseAppServer",e.SapBusinessWarehouseMessageServer="SapBusinessWarehouseMessageServer",e.SapHanaDatabase="SapHanaDatabase",e.Sql="sql",e.Sybase="sybase",e.Teradata="teradata",e.TextCsv="textCsv",e.Web="web",e.WebApi="webApi",e.Xml="xml"}(Rr||(Rr={})),function(e){e.Automatic="Automatic",e.Explicit="Explicit",e.Fixed="Fixed"}(t||(t={})),function(e){e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(r||(r={})),function(e){e.AccessPremiumConnectionNotAllowed="AccessPremiumConnectionNotAllowed",e.AdfConnectionEvaluationError="AdfConnectionEvaluationError",e.CdsaFeatureNotAvailableError="CdsaFeatureNotAvailableError",e.ConnectionApiPolicyViolation="ConnectionApiPolicyViolation",e.ConnectionCouldNotBeCreated="ConnectionCouldNotBeCreated",e.ConnectionCouldNotBeUpdated="ConnectionCouldNotBeUpdated",e.ConnectionKindNotSupported="ConnectionKindNotSupported",e.ConnectionNotFound="ConnectionNotFound",e.ConnectionShareNotAllowedInEnvironment="ConnectionShareNotAllowedInEnvironment",e.DataAccessError="DataAccessError",e.DataflowDatasourceIsReadOnly="DataflowDatasourceIsReadOnly",e.DataSourceUnreachableOrGatewayRequired="DataSourceUnreachableOrGatewayRequired",e.DuplicateDataSourceNameError="DuplicateDataSourceNameError",e.EncryptionNotSupportedForKindAndGateway="EncryptionNotSupportedForKindAndGateway",e.ExceededLimit="ExceededLimit",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUnsupportedByLicense="GatewayUnsupportedByLicense",e.InvalidCredentials="InvalidCredentials",e.InvalidPath="InvalidPath",e.OAuthLoginFailed="OAuthLoginFailed",e.OboSignInError="OboSignInError",e.OboTokenAcquisitionFailed="OboTokenAcquisitionFailed",e.TooManyConnections="TooManyConnections",e.UnknownDmtsError="UnknownDmtsError",e.UnknownError="UnknownError",e.UnknownGatewayError="UnknownGatewayError",e.Unsupported="Unsupported"}(s||(s={})),function(e){e.AddStep="AddStep",e.CreateQuery="CreateQuery",e.DeleteQuery="DeleteQuery",e.ExplainQuery="ExplainQuery",e.ExplainStep="ExplainStep"}(u||(u={})),function(e){e.CouldNotExplainQuery="CouldNotExplainQuery",e.CouldNotGenerateQuery="CouldNotGenerateQuery",e.CouldNotGenerateStep="CouldNotGenerateStep",e.DataItemsMissing="DataItemsMissing",e.LanguageNotSupported="LanguageNotSupported",e.OutOfScope="OutOfScope",e.QueryNotFound="QueryNotFound",e.SkillNotFound="SkillNotFound",e.TableNotFound="TableNotFound",e.Unknown="Unknown"}(a||(a={})),function(e){e.Action="Action",e.Error="Error"}(c||(c={})),function(e){e.Automatic="Automatic",e.Explicit="Explicit",e.Fixed="Fixed"}(p||(p={})),function(e){e.Singleton="Singleton",e.Database="Database",e.Uri="Uri",e.Custom="Custom"}(v||(v={})),function(e){e.BuiltIn="BuiltIn",e.Extension="Extension"}(C||(C={})),function(e){e.JsonDsr="JsonDsr",e.MScript="MScript",e.QueryModel="QueryModel"}(m||(m={})),function(e){e.DSR="DSR",e.Reference="Reference",e.Script="Script"}(h||(h={})),function(e){e.Cluster="Cluster",e.Database="Database",e.Lakehouse="Lakehouse",e.Object="Object",e.Schema="Schema",e.Server="Server",e.Table="Table",e.Warehouse="Warehouse",e.Workspace="Workspace"}(P||(P={})),function(e){e.Constant="Constant",e.Duplicate="Duplicate",e.Empty="Empty",e.Index="Index"}(D||(D={})),function(e){e[e.false=0]="false",e[e.true=1]="true",e[e.notApplicable=2]="notApplicable",e[e.existingConnection=3]="existingConnection"}(G||(G={})),function(e){e.ApiHubTokenExchangeFailed="ApiHubTokenExchangeFailed",e.Cancelled="Cancelled",e.DuplicateEvaluationId="DuplicateEvaluationId",e.ErrorGettingPowerBIPrivateLinkConfig="ErrorGettingPowerBIPrivateLinkConfig",e.EvaluationAgentNotFound="EvaluationAgentNotFound",e.EvaluationQuotaReached="EvaluationQuotaReached",e.ExternalServiceError="ExternalServiceError",e.GatewayDetailsNotFound="GatewayDetailsNotFound",e.GatewayNeeded="GatewayNeeded",e.GatewayNotAuthorized="GatewayNotAuthorized",e.GatewayNotFound="GatewayNotFound",e.GatewayUnknownError="GatewayUnknownError",e.GatewayUnreachable="GatewayUnreachable",e.GatewayUpgradeRequired="GatewayUpgradeRequired",e.GatewayUserError="GatewayUserError",e.MashupEntityNotFound="MashupEntityNotFound",e.MaxConcurrentEvaluationsReached="MaxConcurrentEvaluationsReached",e.NetworkAccessDenied="NetworkAccessDenied",e.NoPowerBiClusterForTenant="NoPowerBiClusterForTenant",e.ParameterNotFound="ParameterNotFound",e.PowerAppsEnvironmentNotFound="PowerAppsEnvironmentNotFound",e.QueryNameAndQueryScriptBothSpecified="QueryNameAndQueryScriptBothSpecified",e.QueryNameAndQueryScriptNotSpecified="QueryNameAndQueryScriptNotSpecified",e.QueryNotFound="QueryNotFound",e.StepNotFound="StepNotFound",e.UnableToContactBackend="UnableToContactBackend",e.Unknown="Unknown",e.UnsupportedKind="UnsupportedKind",e.ValueTooComplex="ValueTooComplex"}(be||(be={})),function(e){e.Path="Path",e.QueryScript="QueryScript"}(I||(I={})),function(e){e.AutoFilterColumnValues="AutoFilterColumnValues",e.BinaryMetadata="BinaryMetadata",e.ConnectorRows="ConnectorRows",e.ConnectorSchema="ConnectorSchema",e.CubeAllowedValues="CubeAllowedValues",e.CubeDisplayFolders="CubeDisplayFolders",e.CubeParameters="CubeParameters",e.DataSourceQuery="DataSourceQuery",e.DetailsPreview="DetailsPreview",e.DetectTableHeaderAndColumnTypes="DetectTableHeaderAndColumnTypes",e.DsrDetailsFetching="DsrDetailsFetching",e.ExcelTableInferenceGetInferredTables="ExcelTableInferenceGetInferredTables",e.ExpandColumnNames="ExpandColumnNames",e.FunctionBrowser="FunctionBrowser",e.JsonTableInferenceGetJsonText="JsonTableInferenceGetJsonText",e.LoadToCdsCreateEntitiesRelationships="LoadToCdsCreateEntitiesRelationships",e.LoadToCdsRelationships="LoadToCdsRelationships",e.LoadToCdsSchema="LoadToCdsSchema",e.MappingEditorQueryProfiling="MappingEditorQueryProfiling",e.MappingEditorSchemaResult="MappingEditorSchemaResult",e.MappingEditorTypeMetadata="MappingEditorTypeMetadata",e.MashupLoad="MashupLoad",e.MergeMatchAnalysis="MergeMatchAnalysis",e.MergeQueriesPreview="MergeQueriesPreview",e.MergeQueriesSuggestionsLeftCandidatePreview="MergeQueriesSuggestionsLeftCandidatePreview",e.MergeQueriesSuggestionsRightCandidatePreview="MergeQueriesSuggestionsRightCandidatePreview",e.NaturalLanguageValidation="NaturalLanguageValidation",e.NavigatorCubeAllowedValues="NavigatorCubeAllowedValues",e.NavigatorCubeParameters="NavigatorCubeParameters",e.NavigatorCubePreview="NavigatorCubePreview",e.NavigatorDiscoverRelatedTables="NavigatorDiscoverRelatedTables",e.NavigatorPreview="NavigatorPreview",e.NavigatorTemporaryQueryForIndirectionNode="NavigatorTemporaryQueryForIndirectionNode",e.Preview="Preview",e.QueryAnalysis="QueryAnalysis",e.QueryPlan="QueryPlan",e.QuerySanitizer="QuerySanitizer",e.QuerySanitizerAnalysis="QuerySanitizerAnalysis",e.QuerySanitizerQueryAnalysis="QuerySanitizerQueryAnalysis",e.QueryScriptPreview="QueryScriptPreview",e.SemanticEntitySets="SemanticEntitySets",e.SemanticDataGetData="SemanticDataGetData",e.SemanticDataList="SemanticDataList",e.SemanticDataSearchInDataflow="SemanticDataSearchInDataflow",e.SplitColumnInferMultiplePositions="SplitColumnInferMultiplePositions",e.SplitColumnNumberOfColumns="SplitColumnNumberOfColumns",e.StepAnalysis="StepAnalysis",e.TableProfiler="TableProfiler",e.TextByExampleGetText="TextByExampleGetText",e.WebByExampleExecuteSelectors="WebByExampleExecuteSelectors",e.WebByExampleGetHtml="WebByExampleGetHtml"}(k||(k={})),function(e){e.None="None",e.Any="Any",e.Access="Access",e.Excel="Excel",e.Json="Json",e.TextCsv="TextCsv",e.Pdf="Pdf",e.Xml="Xml"}(j||(j={})),function(e){e.List="List"}(ee||(ee={})),function(e){e.MenuItem="MenuItem",e.Separator="Separator"}(W||(W={})),function(e){e.Max="Max",e.Mean="Mean",e.Min="Min",e.Mode="Mode",e.RoundedMean="RoundedMean"}(Pe||(Pe={})),function(e){e.Cancelled="Cancelled",e.CombineFiles="CombineFiles",e.CsvTextSettings="CsvTextSettings",e.DataDiscovery="DataDiscovery",e.DataSources="DataSources",e.DataSourceSettings="DataSourceSettings",e.FolderPreview="FolderPreview",e.IncrementalRefreshSettings="IncrementalRefreshSettings",e.Loading="Loading",e.MappingEditor="MappingEditor",e.Navigator="Navigator",e.QueryEditor="QueryEditor",e.QuickCreate="QuickCreate",e.RecentDataPreview="RecentDataPreview",e.RefreshSettings="RefreshSettings",e.TemplateCredentials="TemplateCredentials",e.TemplateParameters="TemplateParameters",e.TextByExample="TextByExample"}(xe||(xe={})),function(e){e.Database="Database",e.File="File"}(bt||(bt={})),function(e){e.AlwaysWhenInferringAllColumnTypes="AlwaysWhenInferringAllColumnTypes",e.BasedOnMetadata="BasedOnMetadata",e.Never="Never"}(ft||(ft={})),function(e){e.Always="Always",e.Never="Never",e.HasNewLoadableQueries="HasNewLoadableQueries",e.NumberOfQueries="NumberOfQueries"}(Mr||(Mr={})),function(e){e.Equals="Equals",e.GreaterThan="GreaterThan",e.GreaterThanOrEqual="GreaterThanOrEqual",e.LessThan="LessThan",e.LessThanOrEqual="LessThanOrEqual"}(Bi||(Bi={})),function(e){e.Adf="Adf",e.Athena="Athena",e.CdsA="CdsA",e.CdsLite="CdsLite",e.CdsT="CdsT",e.CdsV1="CdsAdHoc",e.CustomerInsights="CustomerInsights",e.CustomerInsightsPPDF="CustomerInsightsPPDF",e.D365TalentInsights="D365TalentInsights",e.DataIntegration="DataIntegration",e.DesktopBootstrap="DesktopBootstrap",e.DesktopUITester="DesktopUITester",e.DmtsPowerBiExperimental="DmtsPowerBiExperimental",e.DmtsSaExperimental="DmtsSaExperimental",e.ExcelDesktop="ExcelDesktop",e.ExcelOnline="ExcelOnline",e.ExcelOnlineDmtsPowerBi="ExcelOnlineDmtsPowerBi",e.Experimental="Experimental",e.Flow="Flow",e.IAPDataflowTemplateReferenceApp="IAPDataflowTemplateReferenceApp",e.IntelligentOrderManagement="IntelligentOrderManagement",e.InternalPortal="InternalPortal",e.KustoViewDesigner="KustoViewDesigner",e.MashupEditorBootstrap="MashupEditorBootstrap",e.PowerAppsTeams="PowerAppsTeams",e.PowerBIDataMart="PowerBIDataMart",e.PowerBIModeling="PowerBIModeling",e.PowerBIModelingDmtsPowerBi="PowerBIModelingDmtsPowerBi",e.PowerBIPaginatedReports="PowerBIPaginatedReports",e.PowerBIPPDF="PowerBIPPDF",e.PowerBIReportView="PowerBIReportView",e.PowerPlatformDataflowAdlsGen2="PowerPlatformDataflowAdlsGen2",e.PowerPlatformDataflowsBootstrap="PowerPlatformDataflowsBootstrap",e.PowerPlatformExperimental="PowerPlatformExperimental",e.PowerQueryDesktop="PowerQueryDesktop",e.ProcessAdvisor="ProcessAdvisor",e.SupplyChainVisibility="SupplyChainVisibility",e.SustainabilityCloud="SustainabilityCloud",e.Synapse="Synapse",e.TridentDataflow="TridentDataflow",e.TridentDataPipeline="TridentDataPipeline",e.TridentDataverseOneLake="TridentDataverseOneLake",e.TridentDataWarehouse="TridentDataWarehouse",e.TridentEventStream="TridentEventStream",e.TridentKusto="TridentKusto",e.TridentLakehouse="TridentLakehouse",e.TridentLakeWarehouse="TridentLakeWarehouse",e.TridentMountedDataWarehouse="TridentMountedDataWarehouse",e.TridentOneLake="TridentOneLake",e.TridentReplicator="TridentReplicator",e.TridentSynapseLink="TridentSynapseLink"}(qo||(qo={})),function(e){e.Boolean="Boolean"}(Ka||(Ka={})),function(e){e.NaN="NaN",e.NegativeInfinity="NegativeInfinity",e.PositiveInfinity="PositiveInfinity",e.FormattedNumber="FormattedNumber",e.Number="Number"}(es||(es={})),function(e){e.Access="Access",e.ActiveDirectory="ActiveDirectory",e.AdoDotNet="AdoDotNet",e.AdobeAnalytics="AdobeAnalytics",e.AnalysisServices="AnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.Cdpa="CDPA",e.CurrentWorkbook="CurrentWorkbook",e.DB2="DB2",e.Environment="Environment",e.Essbase="Essbase",e.Exchange="Exchange",e.File="File",e.Folder="Folder",e.Ftp="Ftp",e.GoogleAnalytics="GoogleAnalytics",e.HDInsight="HDInsight",e.Hdfs="Hdfs",e.Informix="Informix",e.MQ="MQ",e.MicrosoftInformationProtection="MicrosoftInformationProtection",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.OleDb="OleDb",e.Oracle="Oracle",e.PostgreSQL="PostgreSQL",e.PowerBIDataflow="PowerBI",e.Python="Python",e.R="R",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Spark="Spark",e.Sql="SQL",e.Staging="Staging",e.Sybase="Sybase",e.Teradata="Teradata",e.Web="Web"}(ts||(ts={})),function(e){e.TemplateMetadata="Metadata.json",e.MashupDocument="MashupDocument.pq",e.MashupMetadata="MashupMetadata.json"}(ns||(ns={})),function(e){e.GroupNestingLimitReached="GroupNestingLimitReached",e.NullMashupXml="NullMashupXml",e.Unknown="Unknown"}(rs||(rs={})),function(e){e.CompletedSuccessfully="CompletedSuccessfully",e.CompletedWithExpectedError="CompletedWithExpectedError",e.CompletedWithUnexpectedError="CompletedWithUnexpectedError",e.Started="Started"}(is||(is={})),function(e){e.Above="Above",e.Below="Below"}(os||(os={})),function(e){e.ErrorInvokingOpenAiApi="ErrorInvokingOpenAiApi",e.NoProgramFound="NoProgramFound",e.OpenAiApiKeyNotProvided="OpenAiApiKeyNotProvided",e.RequestCanceled="RequestCanceled"}(as||(as={})),function(e){e.Ascii="Ascii",e.Utf8="Utf8",e.Utf16="Utf16",e.Windows="Windows"}(ss||(ss={})),function(e){e.Excel="Excel",e.Json="Json",e.Parquet="Parquet",e.Text="Text"}(us||(us={})),function(e){e.Colon="Colon",e.Comma="Comma",e.None="None",e.Semicolon="Semicolon",e.Space="Space",e.Tab="Tab"}(cs||(cs={})),function(e){e.Even="Even",e.Odd="Odd"}(ls||(ls={})),function(e){e.None="None",e.Private="Private",e.Organizational="Organizational",e.Public="Public"}(fs||(fs={})),function(e){e.ChangeModes="ChangeModes"}(ds||(ds={})),function(e){e.QueryNeedsToFold="QueryNeedsToFold"}(gs||(gs={})),function(e){e.AzureBlob="AzureBlob",e.Database="Database"}(hs||(hs={})),function(e){e.DynamicPlanFolded="DynamicPlanFolded",e.DynamicPlanMightFold="DynamicPlanMightFold",e.DynamicPlanNotFolded="DynamicPlanNotFolded",e.DynamicPlanOpaque="DynamicPlanOpaque",e.ErrorRetrievingPlan="ErrorRetrievingPlan",e.FoldedQueryNotImplemented="FoldedQueryNotImplemented",e.FoldedQueryNull="FoldedQueryNull",e.FoldedWithQuery="FoldedWithQuery",e.NotFolded="NotFolded",e.NotFoldedPrivacyBuffering="NotFoldedPrivacyBuffering",e.NotTable="NotTable",e.OpaqueConstant="OpaqueConstant",e.UnexpectedPlanKind="UnexpectedPlanKind"}(ps||(ps={})),function(e){e.ActiveDirectory="ActiveDirectory",e.AdobeAnalytics="AdobeAnalytics",e.AmazonRedshift="AmazonRedshift",e.AnalysisServices="AnalysisServices",e.AzureAnalysisServices="AzureAnalysisServices",e.AzureBlobs="AzureBlobs",e.AzureDataExplorer="AzureDataExplorer",e.AzureDataLakeStorage="AzureDataLakeStorage",e.AzureTables="AzureTables",e.AIFunctions="AIFunctions",e.AIInsights="AIInsights",e.AzureMLFunctions="AzureMLFunctions",e.AIInsightsInProc="AIInsightsInProc",e.Cds="Cds",e.CommonDataService="CommonDataService",e.DataLake="DataLake",e.Dataverse="Dataverse",e.DB2="DB2",e.ElasticSearch="ElasticSearch",e.Exchange="Exchange",e.Fhir="Fhir",e.File="File",e.Folder="Folder",e.GoogleAnalytics="GoogleAnalytics",e.GoogleBigQuery="GoogleBigQuery",e.HDInsight="HDInsight",e.Impala="Impala",e.Kusto="Kusto",e.Lakehouse="Lakehouse",e.MySql="MySql",e.OData="OData",e.Odbc="Odbc",e.Oracle="Oracle",e.OracleERP="OracleERP",e.PostgreSQL="PostgreSQL",e.PowerBI="PowerBI",e.PowerBIDatamarts="PowerBIDatamarts",e.PowerPlatformDataflows="PowerPlatformDataflows",e.PQGenericInvokeTestExtension="PQGenericInvokeTestExtension",e.Salesforce="Salesforce",e.SapBusinessWarehouse="SapBusinessWarehouse",e.SAPERP="SAPERP",e.SapHana="SapHana",e.SharePoint="SharePoint",e.Snowflake="Snowflake",e.Spark="Spark",e.SQL="SQL",e.Sybase="Sybase",e.Teradata="Teradata",e.Vertica="Vertica",e.Warehouse="Warehouse",e.Web="Web"}(ms||(ms={})),function(e){e.CompilationError="CompilationError",e.InvalidQueryName="InvalidQueryName",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(vs||(vs={})),function(e){e.Failure="Failure",e.Success="Success"}(Cs||(Cs={})),function(e){e[e.endpointNotAvailableInRegion=0]="endpointNotAvailableInRegion",e[e.httpError=1]="httpError",e[e.invalidInput=2]="invalidInput",e[e.maxRetriesReached=3]="maxRetriesReached",e[e.modelError=4]="modelError"}(ws||(ws={})),function(e){e.Error="Error",e.Ok="Ok"}(ys||(ys={})),function(e){e.Default="Default",e.FastCopy="FastCopy"}(bs||(bs={})),function(e){e.ConnectionsAuthorizationFailed="ConnectionsAuthorizationFailed",e.DuplicateQueryId="DuplicateQueryId",e.DuplicateQueryName="DuplicateQueryName",e.DuplicateStepName="DuplicateStepName",e.InvalidQueryName="InvalidQueryName",e.MashupDocumentNotASectionDocument="MashupDocumentNotASectionDocument",e.ParsingError="ParsingError",e.UnexpectedQueryIdFormat="UnexpectedQueryIdFormat"}(Ss||(Ss={})),function(e){e.Custom="Custom",e.DropColumn="DropColumn",e.DropBlankRows="DropBlankRows",e.DropDuplicates="DropDuplicates",e.FillColumn="FillColumn",e.SplitColumn="SplitColumn",e.UnpivotColumns="UnpivotColumns",e.UnpivotOtherColumns="UnpivotOtherColumns"}(Es||(Es={})),function(e){e.Column="Column",e.ColumnType="ColumnType",e.Count="Count",e.ErrorCount="ErrorCount",e.NullCount="NullCount",e.DistinctCount="DistinctCount",e.UniqueCount="UniqueCount",e.Min="Min",e.Max="Max",e.ValueDistribution="ValueDistribution",e.Average="Average",e.EmptyStringCount="EmptyStringCount",e.TextLengthDistribution="TextLengthDistribution",e.NaNCount="NaNCount",e.ZeroCount="ZeroCount",e.EvenCount="EvenCount",e.OddCount="OddCount",e.StandardDeviation="StandardDeviation",e.SignDistribution="SignDistribution",e.ParityDistribution="ParityDistribution",e.TrueCount="TrueCount",e.FalseCount="FalseCount",e.YearDistribution="YearDistribution",e.MonthDistribution="MonthDistribution",e.DayDistribution="DayDistribution",e.WeekOfYearDistribution="WeekOfYearDistribution",e.DayOfWeekDistribution="DayOfWeekDistribution",e.AmPmDistribution="AmPmDistribution",e.HourDistribution="HourDistribution"}(Ps||(Ps={})),function(e){e.AppendRows="AppendRows",e.ReplaceRows="ReplaceRows",e.UpsertRows="UpsertRows"}(As||(As={})),function(e){e.SelectRows="SelectRows",e.Sort="Sort",e.SelectColumns="SelectColumns",e.RenameColumns="RenameColumns",e.AddColumn="AddColumn",e.ReplaceColumns="ReplaceColumns",e.ReplaceRows="ReplaceRows",e.AddRows="AddRows",e.SplitColumn="SplitColumn",e.ReplaceTable="ReplaceTable"}(Ds||(Ds={})),function(e){e.InvocationPattern="InvocationPattern",e.Script="Script"}(ks||(ks={})),function(e){e.DataSourceTag="DataSourceTag",e.QueryEditorMessageBar="QueryEditorMessageBar",e.QuickCreateForm="QuickCreateForm",e.WebByExampleForm="WebByExampleForm"}(Fs||(Fs={})),function(e){e.Append="Append",e.Replace="Replace"}(Os||(Os={})),function(e){e.CompilationError="CompilationError",e.ParsingError="ParsingError",e.Success="Success",e.UnexpectedDocumentKind="UnexpectedDocumentKind"}(Rs||(Rs={})),function(e){e.Link="Link",e.Text="Text"}(Ms||(Ms={}))},74568:function(Oe,Xe,Q){"use strict";Q.d(Xe,{m:function(){return Je}});var Ae=Q(77476),ue=Q(17174),M=Q(79061),$=Q(71328),ve=Q(94785),Ne=Q(38426),He=Q(50423),Je=function(){function De(){}return De.\u0275fac=function(A){return new(A||De)},De.\u0275mod=He.\u0275\u0275defineNgModule({type:De}),De.\u0275inj=He.\u0275\u0275defineInjector({imports:[Ae.CommonModule,ue.u5,M.v,ve.g,Ne._,$.G]}),De}()},69049:function(Oe,Xe,Q){"use strict";Q.r(Xe),Q.d(Xe,{DSVariablesDialogModule:function(){return je}});var ue=Q(32293),M=Q(50423),$=Q(81337),ve=Q(41114),Ne="PBI.DataSourceVariables.PQEndpointRetrieved",Je=(ve.cx[Ne]=(0,ve.b1)(Ne),"PBI.DataSourceVariables.PQEndpointRetrievalFailure"),ge=(ve.cx[Je]=(0,ve.b1)(Je),"PBI.DataSourceVariables.ShowMashupEditor"),A=ve.cx[ge]=(0,ve.b1)(ge),Le="PBI.DataSourceVariables.CloseMashupEditor",ce=ve.cx[Le]=(0,ve.b1)(Le),E=Q(98665),Me=Q(78590),Qe=Q(59017),le=Q(11547),pe=Q(59973),oe=Q(48787),fe=Q(42195),ye=Q(73875),Ve=function(){function x(F){this.httpService=F,this.DataSourceVariablesUriPrefix="explore/dataSourceVariables"}return x.prototype.getDataSourceMetadataUri=function(F){return(0,le.of)("powerbi/databases/v201606/datasets/"+F+"/datasourcesForVariables")},x.prototype.getMDocument=function(F,V){return this.httpService.post(this.DataSourceVariablesUriPrefix+"/"+F+"/mdocument",V)},x.prototype.extractVariables=function(F){return this.httpService.post(this.DataSourceVariablesUriPrefix+"/extract",F)},x.\u0275fac=function(V){return new(V||x)(M.\u0275\u0275inject(ye.O))},x.\u0275prov=M.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac,providedIn:"root"}),x}(),re=Q(18950),ae=Q(65181),se=Q(77476),de=Q(73425),We=Q(52349);function H(x,F){1&x&&M.\u0275\u0275element(0,"spinner",2)}var he=function(F){return{hidden:F}};function J(x,F){if(1&x){var V=M.\u0275\u0275getCurrentView();M.\u0275\u0275elementStart(0,"mashup-editor",3),M.\u0275\u0275listener("onError",function(K){M.\u0275\u0275restoreView(V);var B=M.\u0275\u0275nextContext();return M.\u0275\u0275resetView(B.onError(K))})("onReady",function(){M.\u0275\u0275restoreView(V);var K=M.\u0275\u0275nextContext();return M.\u0275\u0275resetView(K.onReady())}),M.\u0275\u0275elementEnd()}if(2&x){var L=M.\u0275\u0275nextContext();M.\u0275\u0275property("ngClass",M.\u0275\u0275pureFunction1(5,he,L.loading))("clientConfiguration",L.clientConfiguration)("flow",L.flow)("editorOnCommit",L.editorOnCommit)("editorOnCancel",L.editorOnCancel)}}var me=function(){function x(F,V,L,X,K){this.ref=F,this.dataSourceVariablesService=V,this.errorService=L,this.localizationService=X,this.telemetryService=K,this.onCancel=new M.EventEmitter,this.onCommit=new M.EventEmitter,this.loading=!0}return x.prototype.ngOnInit=function(){var F=this;(0,Qe.aj)([this.dataSourceVariablesService.getMDocument(this.modelId,{overrides:this.currentOverrides}),this.dataSourceVariablesService.getDataSourceMetadataUri(this.dbName)]).pipe((0,pe.h)(function(V){return!!V[0]&&!!V[1]}),(0,oe.q)(1)).subscribe(function(V){var L=V[0],X=V[1];try{F.currentMDocument={document:L.data.document},F.clientConfiguration={editorSettings:F.getEditorSettings()};var K={type:Me.rP.PowerBIReportView,details:{modelGuid:F.dbName,appServicesEndpoint:X,useGatewaySSO:"true"}};F.flow={hostContext:K,kind:Me.Mw.EditCubeVariables,mashupDefinition:{kind:Me.Qo.TransientMashup,editingSessionMashup:{mashupName:"",mashupDocument:F.currentMDocument.document,documentLocale:"",queryGroups:void 0,gatewayObjectId:F.gatewayObjectId,queriesMetadata:void 0,connectionOverrides:void 0,hostContext:K}},queryName:"Cube"},F.editorOnCommit=function(d){return F.commit(d)},F.editorOnCancel=function(d){return F.cancel()},F.ref.markForCheck()}catch(d){F.onError(d)}})},x.prototype.getEditorSettings=function(){return{sessionId:this.telemetryService.sessionId,locale:this.localizationService.currentLanguageLocale,queryEditorSettings:{enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!1,returnQueryEditorResult:!1,useHostConnectionProvider:!1,closeButtonSettings:{showConfirmationPrompt:!1,actionOnClick:Me.w9.Cancel}},showCloseButton:!0}},x.prototype.commit=function(F){return(0,$.mG)(this,void 0,void 0,function(){var V,L=this;return(0,$.Jh)(this,function(X){switch(X.label){case 0:return this.telemetryService.logEvent(ce,{cancelled:!1}),[4,F.getEditingSessionMashup()];case 1:return V=X.sent(),this.extractOverrides(V.mashupDocument,this.currentMDocument).subscribe(function(K){return L.onCommit.emit(K)}),[2]}})})},x.prototype.cancel=function(){return(0,$.mG)(this,void 0,void 0,function(){return(0,$.Jh)(this,function(F){return this.telemetryService.logEvent(ce,{cancelled:!0}),this.onCancel.emit(),[2]})})},x.prototype.onError=function(F){var L,X,K,V=this;if(_.isString(F))X=F,K=500;else{var B=F.error;K=F.status,X=B&&(B.message||B.code)||(null===(L=F?.data)||void 0===L?void 0:L.Message)}this.errorService.error(X,"mashupEditorError",{onDialogClosed:function(){return V.onCancel.emit()},statusCode:"".concat(K)})},x.prototype.onReady=function(){this.telemetryService.logEvent(A),this.loading=!1,this.ref.markForCheck()},x.prototype.extractOverrides=function(F,V){return this.dataSourceVariablesService.extractVariables({currentMDocument:{document:F},originalMDocument:V}).pipe((0,fe.VS)(function(K){return(0,le.of)(K.data.hasDifferences&&K.data.overrides)}))},x.\u0275fac=function(V){return new(V||x)(M.\u0275\u0275directiveInject(M.ChangeDetectorRef),M.\u0275\u0275directiveInject(Ve),M.\u0275\u0275directiveInject(re.T),M.\u0275\u0275directiveInject(ae.o),M.\u0275\u0275directiveInject(E.y0))},x.\u0275cmp=M.\u0275\u0275defineComponent({type:x,selectors:[["datasource-mashup-editor"]],inputs:{dbName:"dbName",modelId:"modelId",currentOverrides:"currentOverrides",gatewayObjectId:"gatewayObjectId"},outputs:{onCancel:"onCancel",onCommit:"onCommit"},decls:2,vars:2,consts:[["size","xlarge",4,"ngIf"],[3,"ngClass","clientConfiguration","flow","editorOnCommit","editorOnCancel","onError","onReady",4,"ngIf"],["size","xlarge"],[3,"ngClass","clientConfiguration","flow","editorOnCommit","editorOnCancel","onError","onReady"]],template:function(V,L){1&V&&(M.\u0275\u0275template(0,H,1,0,"spinner",0),M.\u0275\u0275template(1,J,1,7,"mashup-editor",1)),2&V&&(M.\u0275\u0275property("ngIf",L.loading),M.\u0275\u0275advance(1),M.\u0275\u0275property("ngIf",!!L.clientConfiguration))},dependencies:[se.NgClass,se.NgIf,de.O,We.o],styles:["[_nghost-%COMP%]{height:768px;width:1024px;max-height:75vh;max-width:75vw;display:flex;flex-direction:column;align-items:stretch;justify-content:center}[_nghost-%COMP%]   spinner[_ngcontent-%COMP%], [_nghost-%COMP%]   mashup-editor[_ngcontent-%COMP%]{display:flex;justify-content:center;flex:1 1 auto}[_nghost-%COMP%]   spinner[_ngcontent-%COMP%]{align-items:center}[_nghost-%COMP%]   mashup-editor[_ngcontent-%COMP%]{align-items:stretch}[_nghost-%COMP%]   mashup-editor.hidden[_ngcontent-%COMP%]{display:none}"]}),x}(),Ge=function(){function x(F,V){this.matDialogRef=F,this.titleKey=V.titleKey,this.dbName=V.dbName,this.modelId=V.modelId,this.gatewayObjectId=V.gatewayObjectId,this.currentOverrides=V.currentOverrides}return x.prototype.onCommit=function(F){this.close(F)},x.prototype.onCancel=function(){this.close()},x.prototype.close=function(F){this.matDialogRef.close(F)},x.\u0275fac=function(V){return new(V||x)(M.\u0275\u0275directiveInject(ue.so),M.\u0275\u0275directiveInject(ue.WI))},x.\u0275cmp=M.\u0275\u0275defineComponent({type:x,selectors:[["ds-variables-dialog"]],decls:4,vars:4,consts:[[1,"table"],[3,"currentOverrides","gatewayObjectId","dbName","modelId","onCancel","onCommit"]],template:function(V,L){1&V&&(M.\u0275\u0275elementStart(0,"mat-dialog-content")(1,"section",0)(2,"datasource-mashup-editor",1),M.\u0275\u0275listener("onCancel",function(){return L.onCancel()})("onCommit",function(K){return L.onCommit(K)}),M.\u0275\u0275elementEnd()()(),M.\u0275\u0275element(3,"mat-dialog-actions")),2&V&&(M.\u0275\u0275advance(2),M.\u0275\u0275property("currentOverrides",L.currentOverrides)("gatewayObjectId",L.gatewayObjectId)("dbName",L.dbName)("modelId",L.modelId))},dependencies:[me,ue.xY,ue.H8],styles:["mat-dialog-content[_ngcontent-%COMP%]{padding:0;margin:0}mat-dialog-actions[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),x}(),Te=Q(74568),ct=Q(76966),je=function(){function x(){}return x.\u0275fac=function(V){return new(V||x)},x.\u0275mod=M.\u0275\u0275defineNgModule({type:x}),x.\u0275inj=M.\u0275\u0275defineInjector({imports:[Te.m,ct.c.withManifest([{componentIdentifier:"DSVariablesDialog",componentType:Ge}])]}),x}()},52349:function(Oe,Xe,Q){"use strict";Q.d(Xe,{o:function(){return We}});var Ae=Q(81337),ue={palette:{themeDarker:"#b1920b",themeDark:"#bc9a0a",themeDarkAlt:"#c5a20b",themePrimary:"#f2c811",themeSecondary:"#f2c811",themeTertiary:"#f7de72",themeLight:"#f9e48a",themeLighter:"#fbefba",themeLighterAlt:"#fdf6d7"},semanticColors:{primaryButton:{text:{default:"#333333"}},checkableInput:{text:{checked:"#333333"}},grid:{cell:{linkText:{default:"#7D6807",focused:"#5C4C05"}}}}},ve=Q(41114),Ne="PBI.MashupEditor.OnReadyError",He=ve.cx[Ne]=(0,ve.b1)(Ne),Je="PBI.MashupEditor.OnTokenError",De=ve.cx[Je]=(0,ve.b1)(Je),ge=Q(48741),A=Q(50423),Le=Q(95281),ce=Q(48501),E=Q(73221),Me=Q(98665),Qe=Q(78590),le=Q(59017),pe=Q(23558),oe=Q(59973),fe=Q(83317),ye=Q(76746),Ve=Q(85928),re=Q(65181),ae=["mashupIframe"],de={readyState:0},We=function(H){function he(J,me,Ge,Te,ct,Ct){var je=H.call(this)||this;return je.appSettings=J,je.ref=me,je.mashupService=Ge,je.localizationService=Te,je.telemetryService=ct,je.componentStore=Ct,je.onError=new A.EventEmitter,je.onReady=new A.EventEmitter,je.readyState$=je.componentStore.select(function(x){return x.readyState}),je.updateState=je.componentStore.updater(function(x,F){return(0,Ae.pi)((0,Ae.pi)({},x),{readyState:F})}),je}return(0,Ae.ZT)(he,H),he.prototype.ngOnInit=function(){var me,Ge,Te,ct,J=this;!this.theme&&!(null===(Ge=null===(me=this.clientConfiguration)||void 0===me?void 0:me.editorSettings)||void 0===Ge)&&Ge.themeOverride&&(this.theme=null===(ct=null===(Te=this.clientConfiguration)||void 0===Te?void 0:Te.editorSettings)||void 0===ct?void 0:ct.themeOverride),this.componentStore.setState(de),this.changes$("flow").pipe((0,pe.M)(this.readyState$),(0,oe.h)(function(Ct){return!!Ct[0]&&1!==Ct[1]}),(0,fe.R)(this.onDestroy$)).subscribe(function(Ct){var x=Ct[1];return(0,Ae.mG)(J,void 0,void 0,function(){return(0,Ae.Jh)(this,function(F){switch(F.label){case 0:return this.updateState(1),0===x?[3,2]:[4,this.endFlow()];case 1:F.sent(),F.label=2;case 2:return this.startFlow(),[2]}})})})},he.prototype.ngAfterViewInit=function(){var J=this;(0,ce.mv)(this.clientConfiguration,"clientConfiguration is required"),this.mashupService.getPQToken("".concat(this.appSettings.powerQueryResourceName,"/.default")).toPromise().catch(function(){}),this.mashupDataSubscription=(0,le.aj)([this.mashupService.getPQEndpoint()]).pipe((0,oe.h)(function(me){return!!me[0]})).subscribe(function(me){J.initMashupeditor(me[0])},function(me){J.onError.emit(me)})},he.prototype.ngOnDestroy=function(){return this.mashupEditorClient&&this.mashupEditorClient.dispose(),this.mashupDataSubscription&&this.mashupDataSubscription.unsubscribe(),H.prototype.ngOnDestroy.call(this)},he.prototype.setFocus=function(){var J=this.mashupIframe.nativeElement.contentDocument||this.mashupIframe.nativeElement.contentWindow;J?.focus()},he.prototype.activateQuery=function(J){return this.mashupEditorClient.activateQuery(J)},he.prototype.addQuery=function(J,me){return this.mashupEditorClient.addQuery(J,me)},he.prototype.cancelCurrentEvaluation=function(){return this.mashupEditorClient.dataPreview.cancelCurrentEvaluation()},he.prototype.getEditingSessionMashup=function(){return this.mashupEditorClient.getEditingSessionMashup()},he.prototype.getQueriesInfo=function(){return this.mashupEditorClient.getQueriesInfo()},he.prototype.getQueryScript=function(J){return this.mashupEditorClient.getQueryScript(J)},he.prototype.getDataSourceQueryScript=function(J,me){return this.mashupEditorClient.getDataSourceQueryScript(J,me)},he.prototype.setUserSettings=function(J){return this.mashupEditorClient.setUserSettings(J)},he.prototype.refreshActiveQueryResult=function(){return this.mashupEditorClient.refreshActiveQueryResult()},he.prototype.getSelectedStepName=function(){return this.mashupEditorClient.getSelectedStepName()},he.prototype.getActiveQueryName=function(){return this.mashupEditorClient.getActiveQueryName()},he.prototype.getClientSettings=function(J){return{allowedOrigin:J,container:this.mashupIframe.nativeElement,url:this.createMashupEditorUrl(J),className:"mashup-editor-client-iframe"}},he.prototype.createMashupEditorUrl=function(J){var me="".concat(J,"/MashupEditor");if(this.mashupEditorFeatureFlags&&this.mashupEditorFeatureFlags.size>0){var Ge=new ge.LE;this.mashupEditorFeatureFlags.forEach(function(Te,ct){Ge=Ge.set(ct,Te)}),me=me+"?"+Ge.toString()}return me},he.prototype.getEditorSettings=function(){var J={cancelButtonLabel:this.localizationService.get("Cancel_ButtonText"),closeButtonSettings:{showConfirmationPrompt:!1,actionOnClick:Qe.w9.Cancel},commitButtonLabel:this.localizationService.get("ModalDialog_Save"),enableAIInsights:!1,enableCalculatedEntities:!0,enableLinkedEntities:!0,enableMappingAsAStep:!1,returnQueryEditorResult:!1,showCancelButton:!0,useHostConnectionProvider:!1};return{addFocusTrapZone:!1,locale:this.localizationService.currentLanguageLocale,sessionId:this.telemetryService.sessionId,queryEditorSettings:J,showCloseButton:!0,showHeader:!1,themeOverride:this.theme||ue}},he.prototype.endFlow=function(){return(0,Ae.mG)(this,void 0,void 0,function(){var J;return(0,Ae.Jh)(this,function(me){switch(me.label){case 0:if(!this.mashupEditorClient)return[2];me.label=1;case 1:return me.trys.push([1,3,,4]),[4,this.mashupEditorClient.endFlow()];case 2:return me.sent(),this.updateState(3),[3,4];case 3:return J=me.sent(),this.onError.emit(J),this.updateState(4),[3,4];case 4:return[2]}})})},he.prototype.startFlow=function(){var J=this;!this.flow||!this.mashupEditorClient||this.mashupEditorClient.ready.then(function(){J.mashupEditorClient.startFlow(J.flow,J.editorOnCommit,J.editorOnCancel).then(function(){J.updateState(2),J.onReady.emit(),J.ref.detectChanges()},function(me){J.updateState(4)})},function(me){J.onError.emit(me),J.updateState(4),J.telemetryService.logEvent(He,{reason:me?me+"":void 0})})},he.prototype.initMashupeditor=function(J){var me=this,Ge=this.getClientSettings(J),Te=this.getEditorSettings();this.mashupEditorClient=function(he){return new Qe.Cq(he)}(_.merge({clientSettings:Ge,editorSettings:Te,acquireToken:function(Ct){return me.mashupService.getPQToken("".concat(Ct,"/.default")).toPromise().catch(function(je){me.onError.emit(je),me.telemetryService.logEvent(De,{reason:je?je.status+"":void 0})})}},this.clientConfiguration)),this.startFlow()},he.\u0275fac=function(me){return new(me||he)(A.\u0275\u0275directiveInject(ye.de),A.\u0275\u0275directiveInject(A.ChangeDetectorRef),A.\u0275\u0275directiveInject(Ve.M),A.\u0275\u0275directiveInject(re.o),A.\u0275\u0275directiveInject(Me.y0),A.\u0275\u0275directiveInject(Le.m1))},he.\u0275cmp=A.\u0275\u0275defineComponent({type:he,selectors:[["mashup-editor"]],viewQuery:function(me,Ge){var Te;(1&me&&A.\u0275\u0275viewQuery(ae,5),2&me)&&(A.\u0275\u0275queryRefresh(Te=A.\u0275\u0275loadQuery())&&(Ge.mashupIframe=Te.first))},inputs:{clientConfiguration:"clientConfiguration",mashupEditorFeatureFlags:"mashupEditorFeatureFlags",flow:"flow",editorOnCommit:"editorOnCommit",editorOnCancel:"editorOnCancel",theme:"theme"},outputs:{onError:"onError",onReady:"onReady"},features:[A.\u0275\u0275ProvidersFeature([Le.m1]),A.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["id","mashupIframe","pbi-auto-focus","","data-testid","mashup-iframe"],["mashupIframe",""]],template:function(me,Ge){1&me&&A.\u0275\u0275element(0,"div",0,1)},styles:["[_nghost-%COMP%]{display:flex}#mashupIframe[_ngcontent-%COMP%]{background:var(--white-color, #FFF);display:flex;flex:1 1 auto;align-items:stretch;justify-content:center}#mashupIframe[_ngcontent-%COMP%]     .mashup-editor-client-iframe{border:none;width:100%;height:100%;display:block!important}"],changeDetection:0}),he}(E.w)},71328:function(Oe,Xe,Q){"use strict";Q.d(Xe,{G:function(){return Ve}});var Ae=Q(32293),ue=Q(50423),M=Q(77476),$=Q(52349);function ve(re,ae){if(1&re){var se=ue.\u0275\u0275getCurrentView();ue.\u0275\u0275elementStart(0,"mashup-editor",1),ue.\u0275\u0275listener("onError",function(){ue.\u0275\u0275restoreView(se);var H=ue.\u0275\u0275nextContext();return ue.\u0275\u0275resetView(H.onError)}),ue.\u0275\u0275elementEnd()}if(2&re){var de=ue.\u0275\u0275nextContext();ue.\u0275\u0275property("clientConfiguration",de.mashUpEditorInput.clientConfiguration)("editorOnCommit",de.onCommit)("editorOnCancel",de.onCancel)("flow",de.mashUpEditorInput.flow)}}var Ne=function(){function re(ae,se){var de=this;this.dialogRef=ae,this.onCommit=function(We,H){de.mashUpEditorInput.editorOnCommit(We,H),de.dialogRef.close(H)},this.onCancel=function(We){de.mashUpEditorInput.editorOnCancel(We),de.dialogRef.close()},this.onError=function(We){de.mashUpEditorInput.onError(We)},this.mashUpEditorInput=se.input}return re.\u0275fac=function(se){return new(se||re)(ue.\u0275\u0275directiveInject(Ae.so),ue.\u0275\u0275directiveInject(Ae.WI))},re.\u0275cmp=ue.\u0275\u0275defineComponent({type:re,selectors:[["mashup-editor-dialog"]],decls:1,vars:1,consts:[["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError",4,"ngIf"],["pbi-auto-focus","","cdkFocusInitial","",3,"clientConfiguration","editorOnCommit","editorOnCancel","flow","onError"]],template:function(se,de){1&se&&ue.\u0275\u0275template(0,ve,1,4,"mashup-editor",0),2&se&&ue.\u0275\u0275property("ngIf",!!de.mashUpEditorInput.clientConfiguration)},dependencies:[M.NgIf,$.o],styles:["[_nghost-%COMP%]     mashup-editor{display:flex;width:80vw;height:80vh}[_nghost-%COMP%]{display:flex}"]}),re}(),Je=new ue.InjectionToken("MashUpEditorErrorHandler"),De=new ue.InjectionToken("MashUpEditorLauncher"),ge=Q(78590),A=Q(33554),Le=Q(82762),ce=Q(48787),E=Q(42195),Me=Q(58938),Qe=function(re){return re.OnCommit="OnCommit",re.OnCancel="OnCancel",re}({}),pe={provide:De,useClass:function(){function re(ae,se){this.dialogService=ae,this.errorHandler=se,this.lifeCycleEvent$=new A.t(1)}return re.prototype.editQueries=function(ae,se){return this.launchMashUpEditor(se.clientConfiguration,{kind:ge.Mw.EditQuery,hostContext:se.hostContext||ae.hostContext,mashupDefinition:{editingSessionMashup:ae,kind:ge.Qo.TransientMashup}})},re.prototype.addQueries=function(ae,se){var de=this.buildFlowForAddQueries(ae,se);return this.launchMashUpEditor(se.clientConfiguration,de)},re.prototype.manageDataSources=function(ae,se){return this.launchMashUpEditor(se.clientConfiguration,{kind:ge.Mw.ManageConnections,hostContext:se.hostContext,connectionOverrides:ae.connectionOverrides})},re.prototype.buildFlowForAddQueries=function(ae,se){var de={kind:ge.Mw.AddQueries,hostContext:se.hostContext||ae.hostContext};return function(re){return!_.has(re,"mashupDocument")||_.isNil(re.mashupDocument)}(ae)?(de.mashupTemplateImportAllowed=!0,de.mashupDefinition={editingSessionEmptyMashup:ae,kind:ge.Qo.TransientEmptyMashup}):(de.mashupTemplateImportAllowed=!1,de.mashupDefinition={editingSessionMashup:ae,kind:ge.Qo.TransientMashup}),de},re.prototype.launchMashUpEditor=function(ae,se){var de=this;return(0,Le.D)(this.dialogService.showTemplateDialog("MashUpEditorDialogComponentId",{title:"Mash Up Editor Dialog",input:{clientConfiguration:ae,flow:se,editorOnCommit:function(he,J){return de.onCommit(he,J)},editorOnCancel:function(he){return de.onCancel(he)},onError:function(he){var J;return null===(J=de.errorHandler)||void 0===J?void 0:J.handleError(he)}}})).pipe((0,ce.q)(1),(0,E.zg)(function(H){return H.afterClosed()})).toPromise()},re.prototype.onCommit=function(ae,se){this.lifeCycleEvent$.next({type:Qe.OnCommit,payload:se})},re.prototype.onCancel=function(ae){this.lifeCycleEvent$.next({type:Qe.OnCancel,payload:void 0})},re.\u0275fac=function(se){return new(se||re)(ue.\u0275\u0275inject(Me.x),ue.\u0275\u0275inject(Je,8))},re.\u0275prov=ue.\u0275\u0275defineInjectable({token:re,factory:re.\u0275fac}),re}()},oe=Q(79061),fe=Q(24495),Ve=function(){function re(){}return re.\u0275fac=function(se){return new(se||re)},re.\u0275mod=ue.\u0275\u0275defineNgModule({type:re}),re.\u0275inj=ue.\u0275\u0275defineInjector({providers:[pe],imports:[M.CommonModule,oe.v,fe.z.withManifest([{componentIdentifier:"MashUpEditorDialogComponentId",componentType:Ne}])]}),re}()},85928:function(Oe,Xe,Q){"use strict";Q.d(Xe,{M:function(){return oe}});var Ae=Q(36444),ue=Q(48501),M=Q(85732),$=(0,M.ZF)("urlConfiguration"),ve=(0,M.P1)($,function(fe){return fe.powerQueryHostUrl}),Ne=Q(37263),He=Q(59694),Je=Q(11547),De=Q(82762),ge=Q(35510),A=Q(42195),Le=Q(14172),ce=Q(17653),E=Q(88255),Me=Q(50423),Qe=Q(62113),le=Q(73875),pe=window,oe=function(){function fe(ye,Ve,re,ae){var se=this;this.store=ye,this.accessTokenProviderService=Ve,this.httpService=re,this.inTeams=ae,this.getAADToken$=function(de){return(0,Je.of)(null).pipe((0,A.zg)(function(){if(pe.clientAuthEnabled)return(0,De.D)(se.accessTokenProviderService.acquireToken("MashupService",[de],!1)).pipe((0,Le.U)(function(J){return J.token}));if(se.inTeams){var We=de.substring(0,de.lastIndexOf("/"));return Ae.authentication.initialize(),(0,De.D)(Ae.authentication.getAuthToken({resources:[We],silent:!0}))}var H=(0,He.W)("{0}/msal",pe.baseUrl||window.location.origin),he=se.httpService.powerbiRequestOptions();return he.params={scopes:de},se.httpService.get(H,he).pipe((0,Le.U)(function(J){return J.data.AccessToken}))}),(0,ce.b)(function(We){var he=1e3*(0,ue.oG)(We).exp;se.AADTokenCache$.next(new Map(se.AADTokenCache$.getValue()).set(de,{token:We,expiration:he}))}))},this.AADTokenCache$=new ge.X(new Map)}return fe.prototype.getPQEndpoint=function(){return this.store.select(ve).pipe((0,Le.U)(function(ye){return(0,He.g)(ye)?null:ye.replace(/\/$/,"")}))},fe.prototype.getPQToken=function(ye){var Ve=this;return this.AADTokenCache$.pipe((0,E.P)(),(0,A.zg)(function(re){return!re.has(ye)||Date.now()+3e5>re.get(ye).expiration?Ve.getAADToken$(ye):(0,Je.of)(re.get(ye).token)}))},fe.\u0275fac=function(Ve){return new(Ve||fe)(Me.\u0275\u0275inject(M.yh),Me.\u0275\u0275inject(Qe.Q),Me.\u0275\u0275inject(le.O),Me.\u0275\u0275inject(Ne.$,8))},fe.\u0275prov=Me.\u0275\u0275defineInjectable({token:fe,factory:fe.\u0275fac,providedIn:"root"}),fe}()}}]);