"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["gauge","animatedNumber"],{58914:function(ct,B,c){c.r(B),c.d(B,{AnimatedNumber:function(){return w}});var f=c(81337),k=c(94478),g=c(62458),w=function(C){function P(m,V){var d=C.call(this,"animatedNumber")||this;return m&&(d.svg=m),V&&(d.animator=V),d}return(0,f.__extends)(P,C),P.prototype.init=function(m){this.options=m,this.svg||(this.svg=d3.select(m.element.get(0)).append("svg")),this.currentViewport=m.viewport,this.hostServices=m.host,this.style=m.style,this.updateViewportDependantProperties()},P.prototype.updateViewportDependantProperties=function(){var m=this.currentViewport;this.svg.attr("width",m.width).attr("height",m.height)},P.prototype.update=function(m){g.fF.assertValue(m,"options"),this.currentViewport=m.viewport;var V=this.dataViews=m.dataViews;if(V&&V[0]){var d=V[0];this.updateViewportDependantProperties(),this.getMetaDataColumn(d),this.updateInternal(d&&d.single?d.single.value:0,m.suppressAnimations,!0,this.formatter)}},P.prototype.setFormatter=function(m){this.formatter=m},P.prototype.onDataChanged=function(m){this.update({dataViews:m.dataViews,suppressAnimations:m.suppressAnimations,viewport:this.currentViewport})},P.prototype.onResizing=function(m){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:m})},P.prototype.canResizeTo=function(m){return!0},P.prototype.updateInternal=function(m,V,d,F){void 0===d&&(d=!1);var D=this.value,v=(0,k.Mb)(this.animator,V);this.doValueTransition(D,m,null,this.options.animation,v,d,F),this.value=m},P}(c(68193).V)},68193:function(ct,B,c){c.d(B,{V:function(){return F}});var f=c(14599),k=c(53197),g=c(90120),K=c(38400),w=c(79154),C=c(62458),P=c(32041),m=c(64329),V=c(10389),d=c(72489),F=function(){function D(v){this.defaultTitleColor="#333333",this._animatedTextOptions={},this.mainText=(0,w.CH)("mainText"),this.name=v,this.visualConfiguration={maxFontSize:60}}return D.prototype.getMetaDataColumn=function(v){if(v&&v.metadata&&v.metadata.columns)for(var b=0,T=v.metadata.columns.length;b<T;b++){var A=v.metadata.columns[b];if(A.isMeasure){this.metaDataColumn=A;break}}},D.prototype.getAdjustedFontHeight=function(v,b,T){var A,J,N,O,R={fontFamily:null===(A=this._animatedTextOptions.textProperties)||void 0===A?void 0:A.fontFamily,fontWeight:null===(J=this._animatedTextOptions.textProperties)||void 0===J?void 0:J.fontWeight,fontStyle:null===(N=this._animatedTextOptions.textProperties)||void 0===N?void 0:N.fontStyle,textDecoration:null===(O=this._animatedTextOptions.textProperties)||void 0===O?void 0:O.textDecoration,text:b};return this.getAdjustedFontHeightCore(R,v,T,0)},D.prototype.getAdjustedFontHeightCore=function(v,b,T,A){return A>10?T:(v.fontSize=m.FP.toString(T),P.b.measureSvgTextWidth(v)<b?T:this.getAdjustedFontHeightCore(v,b,.9*T,A+1))},D.prototype.clear=function(){this.svg.select(this.mainText.selector).text("")},D.prototype.doValueTransition=function(v,b,T,A,J,N,O,R){var z,at,W,it;if(N||v!==b||null==b){v||(v=0),R||(R=this.getDefaultDatumTransform());var M=this.svg,rt=this.currentViewport,G=rt.height,U=rt.width,lt=this.getSeedFontHeight(U,G),ut=this.getTranslateX(U),nt=this.getTranslateY(lt),X=this.metaDataColumn;O||(O=(0,d.Ue)({format:this.getFormatString(this.dataPointObjects,X),value:b,displayUnitSystemType:T,formatSingleValues:!0,allowFormatBeautification:!0,columnType:X?X.type:void 0}));var Y=String(v),j=String(b);(_.isEmpty(b)||"string"!=typeof b)&&(j=O.format(b)),(_.isEmpty(v)||"string"!=typeof v)&&(Y=O.format(v)),M.classed(this.name,!0);var ht=[R.getDatum(b,j)],st=M.selectAll("text").data(ht),Q=st.enter().append("text").classed(this.mainText.class,!0).merge(st),ot=this.getAdjustedFontHeight(U,j,lt);if(nt=this.getTranslateY(ot+(G-ot)/2),Q.text(Y).attr("text-anchor",this.getTextAnchor()).attr("font-size",ot).attr("transform",(0,V.Iu)(ut,nt)).style("font-style",null===(z=this._animatedTextOptions.textProperties)||void 0===z?void 0:z.fontStyle).style("text-decoration",null===(at=this._animatedTextOptions.textProperties)||void 0===at?void 0:at.textDecoration).style("font-weight",null===(W=this._animatedTextOptions.textProperties)||void 0===W?void 0:W.fontWeight).style("font-family",null===(it=this._animatedTextOptions.textProperties)||void 0===it?void 0:it.fontFamily).style("fill",this.getTextColor()).call(K.Q,[Y]),null==b||X&&(0,k.v9)(X.type)||"string"==typeof b||"string"==typeof v)Q.text(j).call(K.Q,[j]);else{var dt=v;Q.transition().duration(J).tween("text",function(Z){var vt=R.getValue(Z),ft=d3.interpolate(dt,vt);return function(mt){var pt=ft(mt);this.textContent=O.format(pt)}})}return(0,V.bL)(A,Q),Q}},D.prototype.getDefaultDatumTransform=function(){return{getDatum:function(b,T){return{value:b}},getValue:function(b){return b.value}}},Object.defineProperty(D.prototype,"animatedTextOptions",{get:function(){return this._animatedTextOptions},set:function(b){this._animatedTextOptions=b},enumerable:!1,configurable:!0}),D.prototype.getTextColor=function(){var v,b=this.style&&g.v.getThemeColor(this.style,"foreground");return(null===(v=this._animatedTextOptions)||void 0===v?void 0:v.titleColor)||b||this.defaultTitleColor},D.prototype.getSeedFontHeight=function(v,b){var T=Math.floor(.75*Math.min(v,b)),A=this.visualConfiguration.maxFontSize;return A?Math.min(A,T):T},D.prototype.getTranslateX=function(v){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return 0;case"right":return v}return v/2},D.prototype.getTranslateY=function(v){return v},D.prototype.getTextAnchor=function(){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return"start";case"right":return"end"}return"middle"},D.prototype.getFormatString=function(v,b){return C.fF.assertAnyValue(b,"column"),(0,d.eU)(v,b,f.e0.formatString)},D}()},27115:function(ct,B,c){c.r(B),c.d(B,{Gauge:function(){return St}});var f=c(81337),k=c(94478),g=c(5719),K=c(53197),w=c(60066),C=c(90120),P=c(21181),m=c(18664),V=c(80065),d=c(52287),F=c(86900),D=c(32379),v=c(33777),b=c(38400),T=c(51129),A=c(72902),J=c(40739),N=c(44783),O=c(79154),R=c(62458),z=c(38265),at=c(34644),W=c(32041),it=c(59107),M=c(56578),rt=c(10389),G=c(46135),U=c(38958),lt=c(58914),ut=c(54522),nt=c(34021),X=c(11305),Y=c(82755),j=c(72489),ht=c(26543),st=c(56707),Q=c(70188),Z=function(){function o(){}return o.getDefaultGaugeLabelSettings=function(t,e,a){var i=(0,P.bT)({show:!0,labelColor:e,fontSize:st.qy,style:t,textClassName:"largeLightLabel"});return a&&(i.fontProperties=(0,m.ED)(i.fontProperties,{family:a})),i.position=null,i.bold=!1,i.italic=!1,i.underline=!1,i.showDynamicLabels=!1,i},o.getDefaultDataPointSettings=function(t){var e=t.colorPalette.dataColors.getAllColors();return{fillColor:C.v.getDataColorByIndex(t,0,N.fA),targetColor:e&&e.length>1?C.v.getDataColorByIndex(t,1,N.fA):C.v.getThemeColor(t,"foregroundNeutralSecondary")}},o.convert=function(t,e){var a,i=t.columns,n=t.objects.getStaticObjects(),r=i.getValueMetadataColumn(g.Vd.y),s=this.parseGaugeData(t),u=this.convertDataLabelSettings(n,"labels",e,s.minDynamicFormatString),h=this.convertDataLabelSettings(n,"labels",e,s.maxDynamicFormatString),l=this.convertDataLabelSettings(n,"target",e,s.targetDynamicFormatString),p=C.v.getThemeColor(e,N.fA),x=this.convertDataLabelSettings(n,"calloutValue",e,null!==(a=s.dynamicCalloutLabelFormatString)&&void 0!==a?a:s.valueDynamicFormatString,p,z.Wn.lightSecondary.family),S=r&&null!=r.queryName?ht.dw.builder().withMeasure(r.queryName).createSelectionId():void 0;return{maxLabel:this.createLabel(s.max,i.getValueMetadataColumn(g.Vd.maxValue),h,r),minLabel:this.createLabel(s.min,i.getValueMetadataColumn(g.Vd.minValue),u,r,s.max),target:{label:this.createLabel(s.target,i.getValueMetadataColumn(g.Vd.targetValue),l,r),ratio:this.getTargetRatio(s)},calloutLabel:this.createLabel(s.callout,r,x,r),tooltipInfo:s.tooltipItems,formattedTooltip:(0,b.X)(s.tooltipItems),ratio:this.getValueRatio(s),dataPointSettings:this.convertDataPointSettings(n,e),identity:S,strokeSettings:(0,nt.kG)(e)}},o.parseGaugeData=function(t){var e=t.columns,a=t.objects.getStaticObjects(),i=e.getValueMetadataColumn(g.Vd.y),n=a?a.axis:null,r=t.data.hasValues(g.Vd.y),s=t.data.hasValues(g.Vd.maxValue),u=t.data.hasValues(g.Vd.minValue),l={max:null,min:null,target:null,value:null,callout:null,tooltipItems:[],dynamicCalloutEnabled:!1};if(r){l.value=t.data.getValue(g.Vd.y,0),l.valueDynamicFormatString=l.minDynamicFormatString=l.maxDynamicFormatString=t.data.getFormatString(g.Vd.y,0);var p=(0,ut.xq)(l.value,i,g.qJ.general.formatString,!1,l.valueDynamicFormatString);l.tooltipItems.push({displayName:t.data.getValueDisplayName(g.Vd.y),value:p})}if(t.data.hasValues(g.Vd.targetValue)){var y=e.getValueMetadataColumn(g.Vd.targetValue);l.target=t.data.getValue(g.Vd.targetValue,0),l.targetDynamicFormatString=t.data.getFormatString(g.Vd.targetValue,0),p=(0,ut.xq)(l.target,y,g.qJ.general.formatString,!1,l.targetDynamicFormatString),l.tooltipItems.push({displayName:t.data.getValueDisplayName(g.Vd.targetValue),value:p})}else n&&(l.target=n.target);if(l.dynamicCalloutEnabled=(0,Y.NA)(a,g.qJ.calloutValue.showDynamicLabels,!1),l.dynamicCalloutEnabled){var x=(0,Y.NA)(a,g.qJ.calloutValue.dynamicLabelValue);l.callout=x,l.dynamicCalloutLabelFormatString=t.data.getFormatStringForRelatedObject(g.qJ.calloutValue.dynamicLabelValue)}else l.callout=l.value;if(s)l.max=t.data.getValue(g.Vd.maxValue,0),l.maxDynamicFormatString=t.data.getFormatString(g.Vd.maxValue,0);else if(n&&null!=n.max)l.max=n.max;else if(l.max=1,r&&l.value&&0!==l.value){var S=!1;if(i){var L=(0,j.EO)(i,g.qJ.general.formatString,!0);null!=L&&(S=(0,j.G2)(L).hasPercent)}S||(l.max=l.value<0?0:2*l.value)}return u?(l.min=t.data.getValue(g.Vd.minValue,0),l.minDynamicFormatString=t.data.getFormatString(g.Vd.minValue,0)):n&&null!=n.min?l.min=n.min:(l.min=0,r&&null!=l.value&&l.value<0&&(l.min=2*l.value)),(0,X.VT)(t,l.tooltipItems,0,void 0,g.qJ.general.formatString),l},o.createLabel=function(t,e,a,i,n){var s=(0,m.qk)(a.fontProperties),u=this.getFormatter(a,e,i,n||t);return a.showDynamicLabels&&(s.text=u.format(t)),s.text=u.format(t),{value:t,requiredSpace:{width:W.b.measureSvgTextWidth(s),height:W.b.estimateSvgTextHeight(s)},text:s.text,formatter:u,settings:a}},o.getFormatter=function(t,e,a,i){var n=0===t.displayUnits?i:null;(!e||!e.objects||_.isEmpty((0,Y.NA)(e.objects,g.qJ.general.formatString)))&&(e=a);var r=t.dynamicFormatString||(0,j.EO)(e,g.qJ.general.formatString),s=(0,Q.h1)(t.precision,r),u=(0,Q.YO)(t,r,n,s);return u.formatSingleValues=!(t.displayUnits>0),0===t.displayUnits&&(u.value=n),(0,j.Ue)(u)},o.getValueRatio=function(t){return!_.isNumber(t.value)||!this.isValid(t)||t.value<=t.min?0:t.value>=t.max?1:(t.value-t.min)/(t.max-t.min)},o.isValid=function(t){return _.isNumber(t.min)&&_.isNumber(t.max)&&t.min<=t.max},o.getTargetRatio=function(t){if(!this.isValid(t)||!_.isNumber(t.target))return-1;var e=t.max-t.min;return 0!==e?(t.target-t.min)/e:0},o.convertDataLabelSettings=function(t,e,a,i,n,r){var s=o.getDefaultGaugeLabelSettings(a,n,r);return s.dynamicFormatString=i,t&&(0,P.ww)(t[e],s,void 0,a),s},o.convertDataPointSettings=function(t,e){var a=o.getDefaultDataPointSettings(e),i=C.v.create(e);return{fillColor:i.getColorForPropertyWithDefaultColor(t,g.qJ.dataPoint.fill,a.fillColor),targetColor:i.getColorForPropertyWithDefaultColor(t,g.qJ.dataPoint.target,a.targetColor)}},o}(),vt=c(41234),St=function(){function o(t,e){this.lastAngle=-Math.PI/2,t&&(t.gaugeSmallViewPortProperties&&(this.gaugeSmallViewPortProperties=t.gaugeSmallViewPortProperties),this.animator=t.animator,this.tooltipsEnabled=t.tooltipsEnabled,this.behavior=t.behavior,this.featureSwitches=e||{},this.onObjectEnabled=this.featureSwitches.onObject)}return o.prototype.getDataLabelsCard=function(){var t,e;return this.generateLabelsCard("labels","Visual_DataPointsLabels",(0,f.__assign)((0,f.__assign)({},g.qJ.labels),{displayUnits:g.qJ.labels.labelDisplayUnits,precision:g.qJ.labels.labelPrecision}),this.getDataLabelSettingsOptions(void 0,null!==(e=null===(t=this.data)||void 0===t?void 0:t.minLabel.settings)&&void 0!==e?e:Z.getDefaultGaugeLabelSettings(this.style)),void 0)},o.prototype.getTargetLabelCard=function(){var t,e,a;return this.generateLabelsCard("target","Visual_Gauge_Axis_TargetLabel",(0,f.__assign)((0,f.__assign)({},g.qJ.target),{displayUnits:g.qJ.target.labelDisplayUnits,precision:g.qJ.target.labelPrecision}),this.getDataLabelSettingsOptions(void 0,null!==(a=null===(e=null===(t=this.data)||void 0===t?void 0:t.target)||void 0===e?void 0:e.label.settings)&&void 0!==a?a:Z.getDefaultGaugeLabelSettings(this.style)),!0)},o.prototype.getCalloutValueCard=function(){var t,e;return this.generateLabelsCard("calloutValue","Visual_Gauge_CalloutValue",(0,f.__assign)((0,f.__assign)({},g.qJ.calloutValue),{displayUnits:g.qJ.calloutValue.labelDisplayUnits,precision:g.qJ.calloutValue.labelPrecision,showDynamicLabels:g.qJ.calloutValue.showDynamicLabels,dynamicLabelValue:g.qJ.calloutValue.dynamicLabelValue}),this.getDataLabelSettingsOptions(void 0,null!==(e=null===(t=this.data)||void 0===t?void 0:t.calloutLabel.settings)&&void 0!==e?e:Z.getDefaultGaugeLabelSettings(this.style,C.v.getThemeColor(this.style,N.fA),z.Wn.lightSecondary.family)),!0)},o.prototype.generateLabelsCard=function(t,e,a,i,n){var r=this;return(0,P.XQ)({cardBuilder:new M.CQ(new M.lg(t),e,a,function(s){return r.hostService.getLocalizedString(s)}),dataLabelsProps:a,featureSwitches:this.featureSwitches,hostServices:this.hostService,options:i,omitDescription:n,omitDynamicLabelSelector:!0,instanceKind:3})},o.prototype.getColorsCard=function(){var e,a,t=this,i=null!==(a=null===(e=this.data)||void 0===e?void 0:e.dataPointSettings)&&void 0!==a?a:Z.getDefaultDataPointSettings(this.style),n=g.qJ.dataPoint;return new M.CQ(new M.lg("datapoint"),"Visual_Colors",n,function(r){return t.hostService.getLocalizedString(r)}).addGroup("datapoint",function(r){return r.addSimpleSlice(n.fill.propertyName,new M.BT({descriptor:(0,f.__assign)((0,f.__assign)({},n.fill),{instanceKind:3}),value:{value:i.fillColor}}).build()).addSimpleSlice(n.target.propertyName,new M.BT({descriptor:(0,f.__assign)((0,f.__assign)({},n.target),{instanceKind:3}),value:{value:i.targetColor}}).build())}).build()},o.prototype.getGaugeAxisCard=function(){var t,e=this,a=this.dataView;if(a?.metadata){var i=g.qJ.axis,n=(t=o.getGaugeObjectsProperties(a)).min,r=t.max,s=t.target;return new M.CQ(new M.lg("axis"),"Visual_Gauge_Axis",i,function(u){return e.hostService.getLocalizedString(u)}).addGroup("axis",function(u){return u.addSimpleSlice(i.min.propertyName,new M.mu({descriptor:(0,f.__assign)((0,f.__assign)({},i.min),{instanceKind:3}),value:n,options:{maxValue:null!=r?{type:1,value:r}:void 0}}).build(),function(h){return h.withDisabled((0,U.c5)(a,g.Vd.minValue))}).addSimpleSlice(i.max.propertyName,new M.mu({descriptor:(0,f.__assign)((0,f.__assign)({},i.max),{instanceKind:3}),value:r,options:{minValue:null!=n?{type:0,value:n}:void 0}}).build(),function(h){return h.withDisabled((0,U.c5)(a,g.Vd.maxValue))}).addSimpleSlice(i.target.propertyName,new M.mu({descriptor:(0,f.__assign)((0,f.__assign)({},i.target),{instanceKind:3}),value:s,options:{minValue:null!=n?{type:0,value:n}:void 0,maxValue:null!=r?{type:1,value:r}:void 0}}).build(),function(h){return h.withDisabled((0,U.c5)(a,g.Vd.targetValue))})}).build()}},o.prototype.getFormattingModel=function(){var t=this;return new M.Nq(function(){return t.getGaugeAxisCard()},function(){return t.getColorsCard()},function(){return t.getDataLabelsCard()},function(){return t.getTargetLabelCard()},function(){return t.getCalloutValueCard()}).build()},o.prototype.getDataLabelSettingsOptions=function(t,e){return{dataLabelsSettings:e,show:!0,precision:!0,displayUnits:!0,fontSize:!0,fontFamily:!0,enumeration:t,style:this.style,bold:!0,italic:!0,underline:!0,enableDynamicLabelPickers:e.showDynamicLabels,dynamicLabelValue:e.dynamicLabelValue}},o.getGaugeObjectsProperties=function(t){var e={},a=t.metadata.objects,i=!!a&&!!a.axis;return(0,U.c5)(t,g.Vd.minValue)||(e.min=i?a.axis.min:void 0),(0,U.c5)(t,g.Vd.maxValue)||(e.max=i?a.axis.max:void 0),(0,U.c5)(t,g.Vd.targetValue)||(e.target=i?a.axis.target:void 0),e},o.prototype.init=function(t){var a,e=this;if(this.element=t.element,this.currentViewport=t.viewport,this.style=t.style,this.settings=o.DefaultStyleProperties,this.tooltipService=(0,J.r)(t.host),this.labelPosition=0,this.margin={top:0,left:0,right:0,bottom:0},this.color=d3.scaleOrdinal([C.v.getSentimentColor(this.style,"bad"),C.v.getSentimentColor(this.style,"neutral"),C.v.getSentimentColor(this.style,"good")]).domain([0,1,2]),this.hostService=t.host,this.behavior&&(this.interactivityService=(0,A.ub)(this.hostService,this.featureSwitches)),this.onObjectEnabled){var n=(null===(a=this.hostService)||void 0===a?void 0:a.getSubSelectionService())??F.D.createWithDefaultHost();this.subSelectionHelper=d.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostService,renderer:n,targetSource:"format",scale:function(){return e.currentViewport.scale}})}var r=this.svg=d3.select(this.element.get(0)).append("svg").classed("gauge",!0);if(this.interactivityService){var s=it.M.isInternetExplorerOrEdge();r.attr("tabindex",0).attr("focusable",!0).classed(w.Pg,!s)}var u=this.mainGraphicsContext=r.append("g");u.attr("class",o.MainGaugeGroupClassName),this.onObjectEnabled&&u.attr(d.CP,!0),this.initKpiBands();var h=this.backgroundArc=d3.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2).endAngle(Math.PI/2),l=this.foregroundArc=d3.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2);this.backgroundArcPath=u.append("path").classed("backgroundArc",!0).attr("d",h),this.foregroundArcPath=u.append("path").datum({endAngle:-Math.PI/2}).classed("foregroundArc",!0).attr("d",l);var p=this.animatedNumberGraphicsContext=r.append("g");this.animatedNumber=new lt.AnimatedNumber(p),this.animatedNumber.init(t);var y=this.gaugeVisualProperties=this.getGaugeVisualProperties(),x=this.getAnimatedNumberProperties(y.radius,y.innerRadiusFactor,y.top,y.left);this.animatedNumberGraphicsContext.attr("transform",x.transformString),this.animatedNumber.onResizing(x.viewport)},o.prototype.update=function(t){var e;if(R.fF.assertValue(t,"options"),this.currentViewport=t.viewport,this.onObjectEnabled){var a=t.formatMode;this.subSelectionHelper.setFormatMode(a),null===(e=this.interactivityService)||void 0===e||e.setFormatMode(a),this.formatMode=a}if(t.dataViews&&t.dataViews[0]){var i=this.dataView=t.dataViews[0],n=(0,T.G)(i,{formatStringProp:g.qJ.general.formatString});if(t.type&G.EP.Data||!this.data){this.data=Z.convert(n,this.style);var r=(0,v.b)([i],!1,!1,!1,["Tooltips"]);this.hostService.setWarnings(r)}(t.type&G.EP.Resize||t.type&G.EP.ResizeEnd)&&(t.suppressAnimations=!0),this.dataView.single={value:this.data.calloutLabel.value,column:void 0},this.labels=[this.data.minLabel,this.data.maxLabel],this.showTargetLabel=this.data.target.ratio>=0&&this.data.target.ratio<=1&&this.currentViewport.width>150&&this.showSideNumbersLabelText()&&this.data.target.label.settings.show;var s=o.calculatePosition(this.data,this.showTargetLabel,this.currentViewport,this.gaugeSmallViewPortProperties);this.labelPosition=s.labelPosition,this.margin=s.margin,this.gaugeVisualProperties=this.getGaugeVisualProperties(),this.drawViewPort(this.gaugeVisualProperties),this.updateInternal(t.suppressAnimations),this.updateCalloutValue(t.suppressAnimations);var h=t.type&G.EP.FormattingSubSelectionChange;if(this.subSelectionHelper&&(t.type&G.EP.Data||t.type&G.EP.Resize||t.type&G.EP.FormattingSubSelectionChange)&&(this.subSelectionHelper.updateOutlinesFromSubSelections(t.subSelections,!0),this.hostService.alertScreenReader&&h)){var l=this.subSelectionHelper.getLabelsFromSubSelections(t.subSelections,["aria-label"]),p=l?.length&&l.join(" ");p&&this.hostService.alertScreenReader(p)}}},o.prototype.updateCalloutValue=function(t){var e=this.data.calloutLabel.settings;if(this.data.calloutLabel.settings.show){var a=this.getAnimatedNumberProperties(this.gaugeVisualProperties.radius,this.gaugeVisualProperties.innerRadiusFactor,this.gaugeVisualProperties.top,this.gaugeVisualProperties.left),i={fontFamily:e.fontProperties.family,fontStyle:e.fontProperties.style,fontWeight:e.fontProperties.weight,textDecoration:e.fontProperties.textDecoration};this.animatedNumberGraphicsContext.attr("transform",a.transformString),this.animatedNumber.animatedTextOptions={textProperties:i,titleColor:e.fontProperties.color};var n=this.data.calloutLabel.formatter;this.animatedNumber.setFormatter(n),this.animatedNumber.update({viewport:a.viewport,dataViews:[this.dataView],suppressAnimations:t}),this.animatedNumberGraphicsContext.selectAll("title").remove(),this.animatedNumberGraphicsContext.append("title").text(n.format(this.data.calloutLabel.value)),this.onObjectEnabled&&this.animatedNumberGraphicsContext.classed(d.cy,!0).attr(d.Ez,"callout-value").attr(d.CK,"Visual_Gauge_CalloutValue").attr(d.QZ,2)}else this.animatedNumber.clear(),this.animatedNumberGraphicsContext.selectAll("title").remove()},o.prototype.initKpiBands=function(){if(this.settings.kpiBands.show)for(var t=this.kpiArcs=[],e=this.kpiArcPaths=[],a=this.mainGraphicsContext,i=0;i<3;i++){var n=d3.arc().innerRadius(0).outerRadius(0).startAngle(0).endAngle(0);t.push(n);var r=a.append("path").attr("d",n);e.push(r)}},o.prototype.updateKpiBands=function(t,e,a,i){if(this.settings.kpiBands.show)for(var n=0;n<i.length;n++)this.kpiArcs[n].innerRadius(t*e-(o.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness)).outerRadius(t*e-o.KpiBandDistanceFromMainArc).startAngle(i[n].start).endAngle(i[n].end),this.kpiArcPaths[n].attr("fill",i[n].fill).attr("d",this.kpiArcs[n]).attr("transform",a)},o.prototype.removeTargetElements=function(){this.targetLine&&(this.targetLine.remove(),this.targetText.remove(),this.targetConnector.remove(),this.targetLine=this.targetConnector=this.targetText=null,this.interactivityTarget&&(this.interactivityTarget.remove(),this.interactivityTarget=null))},o.prototype.updateTargetLine=function(t,e,a,i){var n=this;this.targetLine||(this.targetLine=this.mainGraphicsContext.append("line"));var r=this.data.target.ratio*Math.PI,s=i-t*Math.sin(r),u=a-t*Math.cos(r),h=i-e*Math.sin(r),l=a-e*Math.cos(r);if(this.targetLine.attr("x1",l).attr("y1",h).attr("x2",u).attr("y2",s),this.onObjectEnabled){this.interactivityTarget||(this.interactivityTarget=this.mainGraphicsContext.append("line").attr("class",o.InteractivityTargetClassSelector.class).classed(d.cy,!0).attr(d.Ez,"target").attr(d.CK,"Target").attr(d.QZ,3)),this.interactivityTarget.attr("x1",l).attr("y1",h).attr("x2",u).attr("y2",s);var p=this.interactivityTarget.node();d.O5.setDataForElement(p,{getRegionOutlines:function(){return n.getTargetOutline(p)}})}},o.prototype.getTargetOutline=function(t){var e=t.getBoundingClientRect(),i=e.x,n=e.y,s=e.width,u=this.data.ratio>.5;return[{id:"target",outline:{points:[{x:u?i+s:i,y:n},{x:u?i:i+s,y:n+e.height}],type:2}}]},o.prototype.getAnimatedNumberProperties=function(t,e,a,i){var n=Math.PI/4,u=t*e-(this.settings.kpiBands.show?o.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness:0),h=u*Math.cos(n),l=u*Math.sin(n),p=a-l,y=i-h,x=2*h;return{transformString:(0,rt.Iu)(y*=1,p*=1),viewport:{height:l,width:x,scale:1}}},o.prototype.getGaugeVisualProperties=function(){var t=this.currentViewport,e=this.margin,a=t.width-e.right-e.left,i=a/2,n=t.height-e.top-e.bottom,r=Math.min(i,n),s=o.InnerRadiusFactor,u=e.left+i,h=r+(n-r)/2+e.top;return{radius:r,innerRadiusOfArc:r*s,left:u,top:h,height:n,width:a,margin:e,transformString:(0,rt.Iu)(u,h),innerRadiusFactor:s}},o.prototype.drawViewPort=function(t){var e=this;R.fF.assertAnyValue(t,"Gauge options");var a=this.settings.kpiBands.separationRadians,i=o.InnerRadiusFactor,n=this.backgroundArc,r=this.color,s=[{fill:r(0),start:-Math.PI/2,end:-Math.PI/2+Math.PI/4-a},{fill:r(1),start:-Math.PI/2+1*Math.PI/4+a,end:-Math.PI/2+3*Math.PI/4-a},{fill:r(2),start:-Math.PI/2+3*Math.PI/4+a,end:Math.PI/2}],u=t.radius,h=t.transformString;this.updateKpiBands(u,i,h,s);var l=u*i,p=-Math.PI/2;n.innerRadius(l).outerRadius(u).startAngle(p).endAngle(Math.PI/2),this.backgroundArcPath.attr("d",n).attr("transform",h);var y=this.foregroundArc;if(y.innerRadius(l).outerRadius(u).startAngle(p),this.foregroundArcPath.datum({endAngle:this.lastAngle}).attr("transform",h).attr("d",y),this.onObjectEnabled){this.foregroundArcPath.classed(d.cy,!0).attr(d.Ez,"fill").attr(d.CK,"Visual_Fill").attr(d.QZ,3);var x=this.foregroundArcPath.node();d.O5.setDataForElement(x,{getRegionOutlines:function(){return e.getFillOutline(l,u,p,e.lastAngle)}})}var S=t.innerRadiusOfArc,L=t.left,E=t.top,I=t.margin,H=t.height;this.settings.targetLine.show&&$.isNumeric(this.data.target.label.value)?this.data.target.ratio<0||this.data.target.ratio>1?this.removeTargetElements():(this.updateTargetLine(u,S,L,E),this.renderTarget(u,H,t.width,I)):this.removeTargetElements(),this.svg.attr("height",this.currentViewport.height).attr("width",this.currentViewport.width)},o.prototype.getFillOutline=function(t,e,a,i){var n,r=(n=this.backgroundArcPath.node().getBoundingClientRect()).left,x=this.currentViewport.scale;return[{id:"fill",outline:{type:4,center:{x:r+n.width/2,y:n.top+n.height},innerRadius:t*x,outerRadius:e*x,startAngle:a,endAngle:i}}]},o.prototype.getSubSelectables=function(t){return this.subSelectionHelper.getAllSubSelectables(t)},o.prototype.getNextSubSelectable=function(t,e){return this.subSelectionHelper.getNextSubSelectable(t,e)},o.prototype.getSubSelectionStyles=function(t){if(this.onObjectEnabled){var a=_.first(t).visualObjects;R.fF.assert(function(){return 1===a.length},"Expected 1 visual");var i=a[0];switch(R.fF.assert(function(){return 1===t.length||t.every(function(r){return _.isEqual(r.visualObjects,[i])},"Expected 1 sub-selection or matching objects")}),i&&i.selectorsByColumn&&(0,D.fd)((0,D.tV)(i.selectorsByColumn)),i.objectName){case"callout-value":return this.getCalloutValueSubSelectionStyles();case"data-labels":return this.getDataLabelsSubSelectionStyles();case"target":return(0,V.w3)(this.hostService,void 0,(0,f.__assign)({},g.qJ.dataPoint.target));case"target-label":return this.getTargetLabelSubSelectionStyles();case"fill":return(0,V.w3)(this.hostService,void 0,(0,f.__assign)({},g.qJ.dataPoint.fill))}}},o.prototype.getCalloutValueSubSelectionStyles=function(){var t,e=(t=g.qJ.calloutValue).fontFamily;return(0,V.xs)(this.hostService,{fontFamilyReference:e,boldReference:t.bold,italicReference:t.italic,underlineReference:t.underline,fontColorReference:t.color,displayUnitsReference:t.labelDisplayUnits,precisionReference:t.labelPrecision})},o.prototype.getDataLabelsSubSelectionStyles=function(){var t,e=(t=g.qJ.labels).fontFamily;return(0,V.Jf)({hostServices:this.hostService,omitSelectorForSingleSeries:!0,individualSelector:void 0,selector:void 0,repetitionSelector:void 0},{fontFamilyReference:e,fontSizeReference:t.fontSize,boldReference:t.bold,italicReference:t.italic,underlineReference:t.underline,fontColorReference:t.color,displayUnitsReference:t.labelDisplayUnits,precisionReference:t.labelPrecision})},o.prototype.getTargetLabelSubSelectionStyles=function(){var t,e=(t=g.qJ.target).fontFamily;return(0,V.xs)(this.hostService,{fontFamilyReference:e,fontSizeReference:t.fontSize,boldReference:t.bold,italicReference:t.italic,underlineReference:t.underline,fontColorReference:t.color,displayUnitsReference:t.labelDisplayUnits,precisionReference:t.labelPrecision})},o.prototype.getSubSelectionShortcuts=function(t,e){var a=this;if(this.onObjectEnabled&&!e){var n=_.first(t).visualObjects;R.fF.assert(function(){return 1===n.length},"Expected 1 visual");var r=n[0];R.fF.assert(function(){return 1===t.length||t.every(function(u){return _.isEqual(u.visualObjects,[r])},"Expected 1 sub-selection or matching objects")});var s=function(h){return a.hostService.getLocalizedString(h)};switch(r.objectName){case"callout-value":return this.getCalloutValueShortcuts(s);case"data-labels":return this.getDataLabelsShortcuts(s);case"target":return this.getTargetShortcuts(s);case"target-label":return this.getTargetLabelShortcuts(s);case"fill":return this.getFillShortcuts(s)}}},o.prototype.getCalloutValueShortcuts=function(t){return[{type:0},(0,f.__assign)((0,f.__assign)({type:2},g.qJ.calloutValue.show),{disabledLabel:t("Delete"),keyboardShortcuts:[{key:"Delete",nextValue:!1}]}),{type:1,destinationInfo:(0,f.__assign)({},g.qJ.calloutValue.fontFamily),label:t("Format_Callout_Value")}]},o.prototype.getDataLabelsShortcuts=function(t){return[{type:0},(0,f.__assign)((0,f.__assign)({type:2},g.qJ.labels.show),{disabledLabel:t("Delete"),keyboardShortcuts:[{key:"Delete",nextValue:!1}]}),{type:1,destinationInfo:(0,f.__assign)({},g.qJ.labels.fontFamily),label:t("Format_Data_Labels")}]},o.prototype.getTargetShortcuts=function(t){return[{type:0},(0,f.__assign)((0,f.__assign)({type:2},g.qJ.target.show),{enabledLabel:t("Format_AddTargetLabel")}),{type:1,destinationInfo:(0,f.__assign)({},g.qJ.dataPoint.target),label:t("Format_Target")}]},o.prototype.getTargetLabelShortcuts=function(t){return[{type:0},(0,f.__assign)((0,f.__assign)({type:2},g.qJ.target.show),{disabledLabel:t("Delete"),keyboardShortcuts:[{key:"Delete",nextValue:!1}]}),{type:1,destinationInfo:(0,f.__assign)({},g.qJ.target.fontFamily),label:t("Format_Target_Label")}]},o.prototype.getFillShortcuts=function(t){return[{type:0},(0,f.__assign)((0,f.__assign)({type:2},g.qJ.labels.show),{enabledLabel:t("Format_AddDataLabels")}),{type:1,destinationInfo:(0,f.__assign)({},g.qJ.dataPoint.fill),label:t("Format_Fill")}]},o.prototype.updateInternal=function(t){var e=this.gaugeVisualProperties.height,a=this.gaugeVisualProperties.width,i=this.gaugeVisualProperties.radius,n=this.margin,r=(0,k.Mb)(this.animator,t),s=this.data,u=this.lastAngle=-Math.PI/2+Math.PI*this.data.ratio;if(this.foregroundArcPath.transition().ease((0,at.Ad)(this.settings.transition.ease)).duration(r).call(this.arcTween,[u,this.foregroundArc]),this.renderMinMaxLabels(this.labels,i,e,a,n),this.updateVisualConfigurations(),this.tooltipsEnabled&&(this.tooltipService.addTooltip(this.foregroundArcPath,function(p){return s.tooltipInfo},function(p){return s.identity&&[s.identity]}),this.tooltipService.addTooltip(this.backgroundArcPath,function(p){return s.tooltipInfo},function(p){return s.identity&&[s.identity]})),this.interactivityService){this.interactivityService.bind([],this.behavior,{paths:[this.foregroundArcPath],formatMode:this.formatMode});var h="".concat(this.hostService.getLocalizedString("Role_DisplayName_MinValue")," ").concat(s.minLabel.text,".")+" ".concat(this.hostService.getLocalizedString("Role_DisplayName_MaxValue")," ").concat(s.maxLabel.text,".");this.svg.attr("aria-label",s.formattedTooltip?s.formattedTooltip.concat(" ".concat(h)):h)}this.foregroundArcPath.datum().identity=s.identity},o.prototype.updateVisualConfigurations=function(){this.mainGraphicsContext.select("line:not(".concat(o.InteractivityTargetClassSelector.selector,")")).attr("stroke",this.data.dataPointSettings.targetColor).attr("stroke-width",this.settings.targetLine.thickness),(0,nt.H4)(this.mainGraphicsContext.select("path"),this.data.strokeSettings),this.onObjectEnabled&&this.mainGraphicsContext.select(o.InteractivityTargetClassSelector.selector).attr("stroke",this.data.dataPointSettings.targetColor).attr("stroke-opacity",0).style("stroke-width",this.settings.targetLine.thickness+o.InteractivityTargetPadding).style("stroke-linejoin",vt.t.round).style("stroke-dasharray","none"),this.backgroundArcPath.style("fill",C.v.getThemeColor(this.style,"backgroundLight")),this.foregroundArcPath.style("fill",this.data.dataPointSettings.fillColor)},o.prototype.renderMinMaxLabels=function(t,e,a,i,n){if(this.svg.selectAll(o.LabelText.selector).remove(),this.data.minLabel.settings.show)for(var s=t.length,u=s-1,h=this.labelPosition,l=this.data.minLabel.settings.fontProperties,p=l.size.px,y=this.settings.labels.padding,x=0;x<s;x++){var S=this.gaugeVisualProperties.top,L=(0,m.qk)(l,t[x].text);if(this.showSideNumbersLabelText()){var E=n.left+i/2-e*Math.cos(Math.PI*x/u),I=void 0,H=1===x,q=!1;2===h?(q=!0,S+=y,I=H?"end":"start",L.text=W.b.getTailoredTextOrDefault(L,e)):(I=H?"start":"end",E+=y*(H?1:-1));var tt=this.mainGraphicsContext.append("text").attr("x",E).attr("y",S).attr("dy",q?p:0).classed(o.LabelText.class,!0);this.onObjectEnabled&&tt.classed(d.cy,!0).attr(d.Ez,"data-labels").attr(d.CK,"Visual_DataPointsLabels").attr(d.QZ,2),tt.style("text-anchor",I).styles((0,m.E_)(l)).text(L.text),q||this.truncateTextIfNeeded(tt,E,H),tt.append("title").text(L.text)}}},o.prototype.truncateTextIfNeeded=function(t,e,a){t.call(K.oq,a?this.currentViewport.width-e:e,W.b.svgEllipsis)},o.prototype.renderTarget=function(t,e,a,i){var n=this.data.target,r=this.data.target.label.settings,s=n.label.value,u=n.ratio,h=t+(e-t)/2+i.top,l=u>.5,p=this.settings.labels.padding,y=l?"start":"end",x=this.data.target.label.formatter,S=Math.asin(10/t)/Math.PI,L=u<S||u>1-S?l?1-S:S:u,E=i.left+a/2-(t+p)*Math.cos(Math.PI*L),I=h-(t+p)*Math.sin(Math.PI*L);this.targetText||(this.targetText=this.mainGraphicsContext.append("text").classed(o.TargetText.class,!0)),this.onObjectEnabled&&this.targetText.classed(d.cy,!0).attr(d.Ez,"target-label").attr(d.CK,"Visual_Gauge_Axis_TargetLabel").attr(d.QZ,2),this.targetText.attr("x",E).attr("y",I).style("display",this.showTargetLabel?"":"none").style("text-anchor",y).styles((0,m.E_)(r.fontProperties)).text(x.format(s)),this.truncateTextIfNeeded(this.targetText,E,l),this.targetText.call(b.Q,[x.format(s)]),this.targetConnector||(this.targetConnector=this.mainGraphicsContext.append("line").classed(o.TargetConnector.class,!0)),u===L?this.targetConnector.style("display","none"):this.targetConnector.attr("x1",i.left+a/2-t*Math.cos(Math.PI*u)).attr("y1",h-t*Math.sin(Math.PI*u)).attr("x2",E).attr("y2",I).style("stroke-width",this.settings.targetLine.thickness).style("stroke",C.v.getThemeColor(this.style,"foregroundNeutralSecondary")).style("display","")},o.prototype.arcTween=function(t,e){t.attrTween("d",function(a){var i=d3.interpolate(a.endAngle,e[0]);return function(n){return a.endAngle=i(n),e[1](a)}})},o.calculatePosition=function(t,e,a,i){var n=o.DefaultStyleProperties,r={margin:{top:0,left:0,bottom:0,right:0},labelPosition:0};if(i&&i.smallGaugeMarginsOnSmallViewPort&&a.height<i.MinHeightGaugeSideNumbersVisible){var s=i.GaugeMarginsOnSmallViewPort;return r.margin={top:s,bottom:s,left:s,right:s},r}if(!t)return r;var u=2*n.labels.padding,h=t&&t.minLabel.settings.show;if(e){var p=(t.target.ratio<=.5?t.target.ratio:1-t.target.ratio)*Math.PI,x=(a.width-(t.target.label.requiredSpace.width+u))/(Math.cos(p)+1),S=a.width-2*x;S>0&&(t.target.ratio<.5?r.margin.left=S:r.margin.right=S);var L=(a.height-t.target.label.requiredSpace.height-u)/Math.sin(p);(S=a.height-L)>0&&(r.margin.top=S)}if(h){var E=Math.max(r.margin.left,t.minLabel.requiredSpace.width+u),I=Math.max(r.margin.right,t.maxLabel.requiredSpace.width+u),H=t.minLabel.requiredSpace.height+u;a.height-r.margin.top-H>(a.width-E-I)/2?(r.labelPosition=2,r.margin.bottom=H):(r.labelPosition=1,r.margin={left:E,right:I,top:r.margin.top,bottom:n.labels.padding})}var et=t.strokeSettings;return et&&et.visible&&(r.margin={left:r.margin.left+et.width,right:r.margin.right+et.width,top:r.margin.top+et.width,bottom:r.margin.bottom+et.width}),r},o.prototype.showSideNumbersLabelText=function(){return!(this.gaugeSmallViewPortProperties&&this.gaugeSmallViewPortProperties.hideGaugeSideNumbersOnSmallViewPort&&this.currentViewport.height<this.gaugeSmallViewPortProperties.MinHeightGaugeSideNumbersVisible)},o.DefaultStyleProperties={transition:{ease:"cubic-in-out"},targetLine:{show:!0,thickness:2},labels:{count:2,padding:5,fontSize:st.UU},kpiBands:{show:!1,separationRadians:Math.PI/128,thickness:5}},o.InnerRadiusFactor=.7,o.KpiBandDistanceFromMainArc=2,o.MainGaugeGroupClassName="mainGroup",o.InteractivityTargetPadding=8,o.InteractivityTargetClassSelector=(0,O.CH)("interactivity-target"),o.LabelText=(0,O.CH)("labelText"),o.TargetConnector=(0,O.CH)("targetConnector"),o.TargetText=(0,O.CH)("targetText"),o}()},34644:function(ct,B,c){c.d(B,{Ad:function(){return k},LL:function(){return K},_9:function(){return g}});var f=c(62458);function k(w){switch(w){case"linear":return d3.easeLinear;case"cubic-in-out":return d3.easeCubicInOut;case"cubic-out":return d3.easeCubicOut;case"back":return d3.easeBack;default:f.fF.assertNever(w)}return d3.easeCubicInOut}function g(w){return!!w.bandwidth}function K(w,C){var P=w.selectAll(_.map(C,function(m){return m.selector}).join(", ")).nodes();P.sort(function(m,V){for(var d=0,F=0;F<C.length;F++)d+=+d3.select(m).classed(C[F].class)*F,d-=+d3.select(V).classed(C[F].class)*F;return d}),d3.selectAll(P).order()}}}]);