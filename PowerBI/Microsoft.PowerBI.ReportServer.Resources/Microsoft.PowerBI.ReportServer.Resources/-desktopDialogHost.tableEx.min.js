"use strict";(self.webpackChunkdesktopDialogHost=self.webpackChunkdesktopDialogHost||[]).push([["tableEx"],{52073:function(Te,Pe,A){function N(ae,i){var P=i.getHierarchyDepth(),o=i.getChildren(ae);if(!_.isEmpty(o))for(var t=0,h=o;t<h.length;t++)P=Math.min(P,i.getLevel(h[t]));return P-i.getLevel(ae)}function pe(ae,i){return i.isLeaf(ae)?ae:pe(_.head(i.getChildren(ae)),i)}function Q(ae,i){return void 0!==i.getLeafIndex(ae)?ae:Q(_.head(i.getChildren(ae)),i)}function oe(ae,i){return i.isLeaf(ae)?ae:oe(_.last(i.getChildren(ae)),i)}function ce(ae,i){return void 0!==i.getLeafIndex(ae)?ae:ce(_.last(i.getChildren(ae)),i)}function ee(ae,i){return i.getLeafIndex(pe(ae,i))}function K(ae,i){return i.getLeafIndex(Q(ae,i))}function G(ae,i){return i.getLeafIndex(oe(ae,i))}function j(ae,i){return i.getLeafIndex(ce(ae,i))}A.d(Pe,{LF:function(){return ee},O3:function(){return j},hG:function(){return K},oj:function(){return oe},pA:function(){return G},zG:function(){return N}})},15366:function(Te,Pe,A){A.d(Pe,{AV:function(){return H},DJ:function(){return V},DX:function(){return J},EO:function(){return ae},FA:function(){return Y},MN:function(){return ee},Ms:function(){return K},Sv:function(){return h},_E:function(){return o},hw:function(){return j},sB:function(){return X},sW:function(){return t},yl:function(){return P}});var N=A(81337),pe=A(62458),Q=A(52073),oe=A(7911),ce=A(44404),ee=10,K=50,j=20,ae=20,P=function(){function F(){}return F.getAncestorsToMeasure=function(c,C){for(var d=[];;){var T=C.getParent(c);if(!T||!C.isLastItem(c,C.getChildren(T)))break;d.push({node:T,size:-1}),c=T}return d},F.getSizeDifference=function(c,C,d,T){for(var U=0,D=0,I=c;D<I.length;D++)U=Math.max(U,this.getItemSizeDifference(I[D],C,d,T));return U},F.getItemSizeDifference=function(c,C,d,T){for(var D=0,I=(0,Q.LF)(c.node,d);I<=C;I++)if((D+=T(I))>=c.size)return 0;return c.size-D},F.getPageIndex=function(c,C){return Math.floor(c/C)},F.itemRangeToPageRange=function(c,C,d){var T=this.getPageIndex(c,d),U=this.getPageIndex(C,d);if(T===U)return[{pageIndex:T,startIndex:c%d,endIndex:C%d}];var D=[];D.push({pageIndex:T,startIndex:c%d,endIndex:d-1});for(var I=T+1;I<U;I++)D.push({pageIndex:I,startIndex:0,endIndex:d-1});return D.push({pageIndex:U,startIndex:0,endIndex:C%d}),D},F}(),o=function(){function F(){}return F.linesOverlapVertically=function(c,C,d,T){return!(d>c+C||d+T<c)},F.isRowMeasured=function(c,C){return this.getMeasuredRowCount(C)>c},F.getMeasuredRowCount=function(c){var C=c.getPageRows();return _.isEmpty(C)?0:(C.length-1)*j+_.last(C).getRowHeights().length},F.remeasureRows=function(c,C,d,T,U,D,I){for(var v=0,e=P.itemRangeToPageRange(T,U,j);v<e.length;v++){var r=e[v];I.measurePage(I.getPageRows()[r.pageIndex],c,C,d,T,D,ae,r.startIndex,r.endIndex-r.startIndex+1)}},F.getVisibleRowStart=function(c,C,d){var T=d.getRowHeight(c.firstLeafIndex);return{rowIndex:c.firstLeafIndex,visibleHeight:T-C+c.firstLeafTop}},F.getVisibleRange=function(c,C,d,T,U){var D=this.getVisiblePageRange(c,C,d);if(!D)return null;var I=this.getFirstVisibleIndex(D.firstPageRow,D.firstPageIndex,D.firstPageTop,c,C);if(null!=I){var v,q=this.getLastVisibleIndex(D.lastPageRow,D.lastPageIndex,D.lastPageTop,c,C);if(null!=q)return null!=T&&T>=0&&null!=U&&U>=0&&(v=Math.max(q,I.leafIndex+T-1),v=Math.min(v,U)),{firstLeafIndex:I.leafIndex,firstLeafTop:I.top,lastLeafIndex:v??q}}},F.getVisiblePageRange=function(c,C,d){for(var T=0,U=0,D=null,q=0,v=d.getPageRows();q<v.length;q++){var e=v[q],r=e.getHeight();if(this.linesOverlapVertically(T,r,c,C))D?(D.lastPageRow=e,D.lastPageIndex=U,D.lastPageTop=T):D={firstPageRow:e,firstPageIndex:U,firstPageTop:T,lastPageRow:e,lastPageIndex:U,lastPageTop:T};else if(D)break;T+=r,U++}return D},F.getFirstVisibleIndex=function(c,C,d,T,U){for(var D=0,I=d,v=0,e=c.getRowHeights();v<e.length;v++){var r=e[v];if(this.linesOverlapVertically(I,r,T,U))return{leafIndex:C*j+D,top:I};I+=r,D++}},F.getLastVisibleIndex=function(c,C,d,T,U){for(var q,D=0,I=d,v=0,e=c.getRowHeights();v<e.length;v++){var r=e[v];this.linesOverlapVertically(I,r,T,U)&&(q=C*j+D),I+=r,D++}return q},F.getBounds=function(c,C){var d=P.getPageIndex(c,j);if(!(d>=C.getPageRows().length)){for(var T=C.getPageRows()[d],U=C.getPageRowTop(T),D=c%j,I=0;I<D;I++)U+=T.getRowHeights()[I];return{top:U,height:T.getRowHeights()[D]}}},F.getOffset=function(c,C){var d=this.getBounds(c.rowIndex,C);return d?c.alignBottom?c.visibleHeight>=d.height?d.top+d.height:d.top+c.visibleHeight:c.visibleHeight>=d.height?d.top:d.top+d.height-c.visibleHeight:0},F}(),t=function(){function F(){}return F.linesOverlapHorizontally=function(c,C,d,T){return!(d>c+C||d+T<c)},F.isColumnMeasured=function(c,C){return this.getMeasuredColumnCount(C)>c},F.getMeasuredColumnCount=function(c){var C=c.getPageColumns();return _.isEmpty(C)?0:(C.length-1)*ee+_.last(C).getColumnWidths().length},F.remeasureColumn=function(c,C,d,T,U,D){var I=D.getPageColumn(c,C,d,T,U);D.measurePage(I,C,d,T,U,K,c%ee,1)},F.getVisibleColumnStart=function(c,C,d){var T=d.getColumnWidth(c.firstLeafIndex);return{columnIndex:c.firstLeafIndex,visibleWidth:T-C+c.firstLeafLeft}},F.getVisibleRange=function(c,C,d,T,U){var D=this.getVisiblePageRange(c,C,d);if(!D)return null;var I=this.getFirstVisibleIndex(D.firstPageColumn,D.firstPageIndex,D.firstPageLeft,c,C);if(null!=I){var v,q=this.getLastVisibleIndex(D.lastPageColumn,D.lastPageIndex,D.lastPageLeft,c,C);if(null!=q)return null!=T&&T>=0&&null!=U&&U>=0&&(v=Math.max(q,I.leafIndex+T-1),v=Math.min(v,U)),{firstLeafIndex:I.leafIndex,firstLeafLeft:I.left,lastLeafIndex:v??q}}},F.getVisiblePageRange=function(c,C,d){for(var T=0,U=0,D=null,I=0,q=d.getPageColumns();I<q.length;I++){var v=q[I],e=v.getWidth();if(this.linesOverlapHorizontally(T,e,c,C))D?(D.lastPageColumn=v,D.lastPageIndex=U,D.lastPageLeft=T):D={firstPageColumn:v,firstPageIndex:U,firstPageLeft:T,lastPageColumn:v,lastPageIndex:U,lastPageLeft:T};else if(D)break;T+=e,U++}return D},F.getFirstVisibleIndex=function(c,C,d,T,U){for(var D=0,I=d,v=0,e=c.getColumnWidths();v<e.length;v++){var r=e[v];if(this.linesOverlapHorizontally(I,r,T,U))return{leafIndex:C*ee+D,left:I};I+=r,D++}return null},F.getLastVisibleIndex=function(c,C,d,T,U){for(var q,D=0,I=d,v=0,e=c.getColumnWidths();v<e.length;v++){var r=e[v];this.linesOverlapHorizontally(I,r,T,U)&&(q=C*ee+D),I+=r,D++}return q},F.getBounds=function(c,C){var d=P.getPageIndex(c,ee);if(!(d>=C.getPageColumns().length)){for(var T=C.getPageColumns()[d],U=C.getPageColumnLeft(T),D=c%ee,I=T.getColumnWidths(),q=0;q<D;q++)U+=I[q];return{left:U,width:I[D]}}},F.getOffset=function(c,C){var d=this.getBounds(c.columnIndex,C);return d?c.alignRight?c.visibleWidth>=d.width?d.left+d.width:d.left+c.visibleWidth:c.visibleWidth>=d.width?d.left:d.left+d.width-c.visibleWidth:0},F}(),h=function(){function F(c,C){this.pageColumns=[],this.measureElement=c,this.sizeManager=C}return F.prototype.canAddPageColumn=function(c){return this.pageColumns.length<this.getMaxPageColumnCount(c)},F.prototype.getMaxPageColumnCount=function(c){return Math.ceil(c.getHierarchyLeafCount()/ee)},F.prototype.getPageColumns=function(){return this.pageColumns},F.prototype.getPageColumnStartIndex=function(c){var C=this.pageColumns.indexOf(c);return-1===C?-1:C*ee},F.prototype.getPageColumnLeft=function(c){for(var C=0,d=0,T=this.pageColumns;d<T.length;d++){var U=T[d];if(c===U)break;C+=U.getWidth()}return C},F.prototype.getColumnsWidth=function(){for(var c=0,C=0,d=this.pageColumns;C<d.length;C++)c+=d[C].getWidth();return c},F.prototype.clear=function(){this.pageColumns=[]},F.prototype.measureNextPage=function(c,C,d,T){var U=new oe.VG;this.getPageColumns().push(U),this.measurePage(U,c,C,d,T,K)},F.prototype.getWidestCellBindingString=function(c,C,d,T,U,D,I){for(var q={item:null,width:-1},v=0;v<D;v++)this.updateWidestItemFromBodyCell(T.getHierarchyLeafAt(v+I),c,d,T,q);if(C){var e=T.getFloatingHierarchyLeafCount();for(v=0;v<e;v++)this.updateWidestItemFromBodyCell(T.getFloatingHierarchyLeafAt(v),c,d,T,q)}var l,r=d.getApproximateColumnHeaderWidth(c);return r>q.width&&(q.item=c,q.width=r),l=q.item===c?d.getColumnHeaderBinding(q.item,!0):d.getBodyCellBinding(q.item,!0),oe.bG.build(l,F.measureRequiredStyle)},F.prototype.measurePage=function(c,C,d,T,U,D,I,q){var v=this.getPageColumnStartIndex(c);void 0===I&&(I=0),void 0===q&&(q=Math.min(T.getHierarchyLeafCount()-v,ee)+I);for(var e=Math.min(d.getHierarchyLeafCount()-U,D),r="",l=d.getFloatingHierarchyItems(),g=0;g<q;g++){var p=T.getHierarchyLeafAt(g+I+v);void 0===(c.getColumnWidths()[g+I]=this.sizeManager.getColumnWidth(p))&&(r+=this.getWidestCellBindingString(p,l,C,d,T,e,U))}if(r){this.measureElement.insertAdjacentHTML("beforeend",r);var n=this.measureElement.firstChild;for(g=0;g<q;g++)void 0===c.getColumnWidths()[g+I]&&(c.getColumnWidths()[g+I]=n.offsetWidth+1,n=n.nextSibling);this.measureElement.innerHTML="",this.adjustItemsWidth(c,C,T,v,I,q)}},F.prototype.updateWidestItemFromBodyCell=function(c,C,d,T,U){var D=T.getIntersection(c,C),I=d.getApproximateBodyCellWidth(D);I>U.width&&(U.item=D,U.width=I)},F.prototype.adjustItemsWidth=function(c,C,d,T,U,D){for(var I=0;I<D;I++){var q=d.getHierarchyLeafAt(I+U+T);void 0===this.sizeManager.getColumnWidth(q)&&this.adjustItemWidth(c,I+U,T,C,d,q)}},F.prototype.adjustItemWidth=function(c,C,d,T,U,D){var I=this,q=P.getAncestorsToMeasure(D,U);_.isEmpty(q)||(this.measureAncestors(q,T),c.getColumnWidths()[C]+=P.getSizeDifference(q,C+d,U,function(v){return I.getColumnWidth(v)}))},F.prototype.measureAncestors=function(c,C){for(var d="",T=0,U=c;T<U.length;T++){var I=C.getColumnHeaderBinding(U[T].node,!0);d+=oe.bG.build(I,F.measureRequiredStyle)}this.measureElement.insertAdjacentHTML("beforeend",d);for(var q=this.measureElement.firstChild,v=0,e=c;v<e.length;v++)e[v].size=q.offsetWidth+1,q=q.nextSibling;this.measureElement.innerHTML=""},F.prototype.getColumnWidth=function(c,C,d,T,U){return this.getPageColumn(c,C,d,T,U).getColumnWidths()[c%ee]},F.prototype.setColumnWidth=function(c,C){this.getPageColumn(c).getColumnWidths()[c%ee]=C},F.prototype.getPageColumn=function(c,C,d,T,U){var D=this.getPageIndex(c);if(C&&D>=this.pageColumns.length)for(var I=D-this.pageColumns.length+1,q=0;q<I;q++)this.measureNextPage(C,d,T,U);return this.pageColumns[D]},F.prototype.getPageIndex=function(c){return P.getPageIndex(c,ee)},F.prototype.getLastMeasuredIndex=function(){var c=this.pageColumns.length;if(0===c)return-1;var C=_.last(this.pageColumns);return(c-1)*ee+(C.getColumnWidths().length-1)},F.measureRequiredStyle={"box-sizing":"border-box",display:"inline-flex"},F}(),b=function(){function F(c,C,d,T){this.pageRows=[],this.measureElement=c,this.columnWidthMeasureManager=C,this.rowLevelWidthMeasureManager=d,this.sizeManager=T}return F.prototype.clear=function(){this.pageRows=[],this.clearFloatingRows()},F.prototype.clearFloatingRows=function(){this.floatingPageRow=new oe.BJ},F.prototype.ensureLastPageComplete=function(c,C,d,T,U,D){if(0===this.pageRows.length)return-1;var q=this.pageRows.length-1,v=this.pageRows[q],e=v.getRowHeights().length;return e<j&&this.gotMoreRows(v,C)&&(this.measurePage(v,c,C,d,T,U,D,v.getRowHeights().length-1),v.getRowHeights().length>e)?q:-1},F.prototype.measureNextPage=function(c,C,d,T,U){var D=new oe.BJ;this.getPageRows().push(D),this.measurePage(D,c,C,d,T,U,ae)},F.prototype.measureFloatingRows=function(c,C,d,T,U,D,I){if(_.isEmpty(this.floatingPageRow.getRowHeights())){var q=C.getFloatingHierarchyItems();if(!_.isEmpty(q)){for(var v=Math.min(d.getHierarchyLeafCount()-U,ae),e="",r=C.getFloatingHierarchyLeafCount(),l=0;l<r;l++){var g=C.getFloatingHierarchyLeafAt(l);this.floatingPageRow.getRowHeights()[l]=this.sizeManager.getRowHeight(g),void 0===this.floatingPageRow.getRowHeights()[l]&&(e+=this.getHeighestCellBindingString(g,c,C,d,v,U,T,D,I))}if(e){this.measureElement.insertAdjacentHTML("beforeend",e);var p=this.measureElement.firstChild;for(l=0;l<r;l++)void 0===this.floatingPageRow.getRowHeights()[l]&&(this.floatingPageRow.getRowHeights()[l]=p.offsetHeight,p=p.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(this.floatingPageRow,c,C,0,0,r)}}}},F.prototype.getPageIndex=function(c){return P.getPageIndex(c,j)},F.prototype.getMeasureRequiredStyle=function(c){return{"box-sizing":"border-box",width:(0,ce.S)(c)}},F.prototype.gotMoreRows=function(c,C){return C.getHierarchyLeafCount()-this.getPageRowStartIndex(c)-c.getRowHeights().length>0},F.prototype.measurePage=function(c,C,d,T,U,D,I,q,v){var e=this.getPageRowStartIndex(c);void 0===q&&(q=0),void 0===v&&(v=Math.min(d.getHierarchyLeafCount()-e,j)-q);for(var r=Math.min(T.getHierarchyLeafCount()-D,I),l="",g=0;g<v;g++){var p=d.getHierarchyLeafAt(g+q+e);void 0===(c.getRowHeights()[g+q]=this.sizeManager.getRowHeight(p))&&(l+=this.getHeighestCellBindingString(p,C,d,T,r,D,U))}if(l){this.measureElement.insertAdjacentHTML("beforeend",l);var n=this.measureElement.firstChild;for(g=0;g<v;g++)void 0===c.getRowHeights()[g+q]&&(c.getRowHeights()[g+q]=n.offsetHeight,n=n.nextSibling);this.measureElement.innerHTML="",this.adjustItemsHeight(c,C,d,e,q,v)}},F.prototype.getHeighestCellBindingString=function(c,C,d,T,U,D,I,q,v){for(var e={item:null,width:-1,height:-1},r=0;r<U;r++){var l=T.getHierarchyLeafAt(r+D),g=d.getIntersection(c,l),p=this.columnWidthMeasureManager.getColumnWidth(r+D,C,d,T,I),s=C.getApproximateBodyCellHeight(g,p);s>e.height&&(e.item=g,e.width=p,e.height=s)}var S,n=this.getItemWidth(c,d),u=C.getApproximateRowHeaderHeight(c,n);return u>e.height&&(e.item=c,e.height=u,e.width=n),S=e.item===c?C.getRowHeaderBinding(e.item,!0):C.getBodyCellBinding(e.item,!0,void 0,void 0,void 0,q,void 0,v),oe.bG.build(S,this.getMeasureRequiredStyle(e.width))},F.prototype.getItemWidth=function(c,C){return pe.fF.assertFail("abstract method"),0},F.prototype.adjustItemsHeight=function(c,C,d,T,U,D){pe.fF.assertFail("abstract method")},F.prototype.getMaxPageRowCount=function(c){return Math.ceil(c.getHierarchyLeafCount()/j)},F.prototype.getPageRows=function(){return this.pageRows},F.prototype.getFloatingPageRow=function(){return this.floatingPageRow},F.prototype.getFloatingRowHeights=function(){return _.sum(this.floatingPageRow.getRowHeights())},F.prototype.canAddPageRow=function(c){return this.pageRows.length<this.getMaxPageRowCount(c)},F.prototype.getPageRowStartIndex=function(c){if(c===this.floatingPageRow)return 0;var C=this.pageRows.indexOf(c);return-1===C?-1:C*j},F.prototype.getPageRowTop=function(c){if(c===this.floatingPageRow)return 0;for(var C=0,d=0,T=this.pageRows;d<T.length;d++){var U=T[d];if(c===U)break;C+=U.getHeight()}return C},F.prototype.getRowsHeight=function(){for(var c=0,C=0,d=this.pageRows;C<d.length;C++)c+=d[C].getHeight();return c},F.prototype.getRowHeight=function(c,C,d,T,U,D){return this.getPageRow(c,C,d,T,D).getRowHeights()[c%j]},F.prototype.getFloatingRowHeight=function(c){return this.floatingPageRow.getRowHeights()[c]},F.prototype.getPageRow=function(c,C,d,T,U,D){var I=this.getPageIndex(c);if(C&&I>this.pageRows.length)for(var q=I-this.pageRows.length+1,v=0;v<q;v++)this.measureNextPage(C,d,T,U,D);return this.pageRows[I]},F.prototype.getLastMeasuredIndex=function(){var c=this.pageRows.length;if(0===c)return-1;var C=_.last(this.pageRows);return(c-1)*j+(C.getRowHeights().length-1)},F}(),V=function(F){function c(){return null!==F&&F.apply(this,arguments)||this}return(0,N.__extends)(c,F),c.prototype.getItemWidth=function(C,d){return this.rowLevelWidthMeasureManager.getWidth(d.getLevel(C),(0,Q.zG)(C,d))},c.prototype.adjustItemsHeight=function(C,d,T,U,D,I){for(var q=0;q<I;q++){var v=T.getHierarchyLeafAt(q+D+U);void 0===this.sizeManager.getRowHeight(v)&&this.adjustItemHeight(C,q+D,U,d,T,v)}},c.prototype.adjustItemHeight=function(C,d,T,U,D,I){var q=this,v=P.getAncestorsToMeasure(I,D);_.isEmpty(v)||(this.measureAncestors(v,U,D),C.getRowHeights()[d]+=P.getSizeDifference(v,T+d,D,function(e){return C===q.getFloatingPageRow()?q.getFloatingRowHeight(e):q.getRowHeight(e)}))},c.prototype.measureAncestors=function(C,d,T){for(var U="",D=0,I=C;D<I.length;D++){var v=d.getRowHeaderBinding((q=I[D]).node,!0);U+=oe.bG.build(v,this.getMeasureRequiredStyle(this.getItemWidth(q.node,T)))}this.measureElement.insertAdjacentHTML("beforeend",U);for(var e=this.measureElement.firstChild,r=0,l=C;r<l.length;r++){var q;(q=l[r]).size=e.offsetHeight,e=e.nextSibling}this.measureElement.innerHTML=""},c}(b),H=function(F){function c(){return null!==F&&F.apply(this,arguments)||this}return(0,N.__extends)(c,F),c.prototype.getItemWidth=function(C,d){return this.rowLevelWidthMeasureManager.getLevelWidth(d.getLevel(C))},c.prototype.adjustItemsHeight=function(C,d,T,U,D,I){},c}(b),X=function(){function F(c,C,d,T){this.columnLevelHeights=[],this.measureElement=c,this.columnWidthMeasureManager=C,this.rowLevelWidthMeasureManager=d,this.sizeManager=T}return F.prototype.clear=function(){this.columnLevelHeights=[]},F.prototype.getMeasureRequiredStyle=function(c){return{"box-sizing":"border-box",width:(0,ce.S)(c)}},F.prototype.measure=function(c,C,d,T,U,D,I){if(0===this.columnLevelHeights.length){for(var q={done:!1,levels:[],spanningHeaders:[],leafCount:0},v=d.getHierarchyDepth(),e=C.getHierarchyDepth(),r=0;r<v;r++)(void 0===I||I===r)&&(this.columnLevelHeights[r]=this.sizeManager.getColumnLevelHeight(C.getCorner(e-1,r))),q.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});var l=d.getHierarchyItems();l&&this.getHeighestColumnHeaders(l,q,c,C,d,T,U,D);for(var g=0;g<e;g++)for(var p=0;p<v;p++)if(void 0===this.columnLevelHeights[p]){var s=C.getCorner(g,p),n=this.rowLevelWidthMeasureManager.getLevelWidth(g),u=c.getApproximateCornerCellHeight(s,n);u>q.levels[p].largestItemHeight&&(q.levels[p].isHeader=!1,q.levels[p].largestItem=s,q.levels[p].largestItemHeight=u,q.levels[p].largestItemWidth=n)}for(var S="",y=0,f=q.levels;y<f.length;y++)if((m=f[y]).largestItem){var R=this.getMeasureRequiredStyle(m.largestItemWidth);if(m.isHeader){var x=c.getColumnHeaderBinding(m.largestItem,!0);S+=oe.bG.build(x,R)}else x=c.getCornerCellBinding(m.largestItem,!0),S+=oe.bG.build(x,R)}if(S){this.measureElement.insertAdjacentHTML("beforeend",S);for(var O=this.measureElement.firstChild,W=0,te=0,ne=q.levels;te<ne.length;te++){var m;(m=ne[te]).largestItem&&((void 0===I||I===W)&&(this.columnLevelHeights[W]=O.offsetHeight),O=O.nextSibling),W++}this.measureElement.innerHTML="",this.adjustLevelHeightsFromSpanningHeaders(q,c,C,d,T)}}},F.prototype.adjustLevelHeightsFromSpanningHeaders=function(c,C,d,T,U){for(var D="",I=0,q=c.spanningHeaders;I<q.length;I++)if(c.levels[(v=q[I]).levelToAdjust].largestItem){var e=this.getMeasureRequiredStyle(this.getHeaderWidth(v.item,C,d,T,U)),r=C.getColumnHeaderBinding(v.item,!0);D+=oe.bG.build(r,e)}if(D){this.measureElement.insertAdjacentHTML("beforeend",D);for(var l=this.measureElement.firstChild,g=0,p=c.spanningHeaders;g<p.length;g++){var v;c.levels[(v=p[g]).levelToAdjust].largestItem&&(this.adjustLevelFromSpanningHeader(v.item,v.level,v.levelToAdjust,l.offsetHeight,T),l=l.nextSibling)}this.measureElement.innerHTML=""}},F.prototype.adjustLevelFromSpanningHeader=function(c,C,d,T,U){for(var D=0,I=C;I<=d;I++)D+=this.getLevelHeight(I);T>D&&(this.columnLevelHeights[d]+=T-D)},F.prototype.getHeighestColumnHeaders=function(c,C,d,T,U,D,I,q){for(var v=0,e=c;v<e.length;v++){var r=e[v];if(C.done)return;var l=U.isLeaf(r),g=U.getLevel(r),p=(0,Q.zG)(r,U),s=(0,Q.pA)(r,U)>=I;if(s)if(1===p){if(void 0===this.columnLevelHeights[g]){var n=this.getHeaderWidth(r,d,T,U,D),u=d.getApproximateColumnHeaderHeight(r,n);u>C.levels[g].largestItemHeight&&(C.levels[g].largestItem=r,C.levels[g].largestItemHeight=u,C.levels[g].largestItemWidth=n)}}else C.spanningHeaders.push({item:r,level:g,levelToAdjust:p+g-1});var S=U.getChildren(r);S&&this.getHeighestColumnHeaders(S,C,d,T,U,D,I,q),l&&s&&C.leafCount++,C.leafCount===q&&(C.done=!0)}},F.prototype.getHeadersHeight=function(){for(var c=0,C=0,d=this.columnLevelHeights;C<d.length;C++)c+=d[C];return c},F.prototype.getLevelTop=function(c){for(var C=0,d=0;d<c;d++)C+=this.columnLevelHeights[d];return C},F.prototype.getLevelHeight=function(c){return this.columnLevelHeights[c]},F.prototype.getHeaderWidth=function(c,C,d,T,U){for(var D=(0,Q.LF)(c,T),I=(0,Q.pA)(c,T),q=0,v=D;v<=I;v++)q+=this.columnWidthMeasureManager.getColumnWidth(v,C,d,T,U);return q},F}(),J=function(){function F(c,C){this.rowLevelWidths=[],this.measureElement=c,this.sizeManager=C}return F.prototype.clear=function(){this.rowLevelWidths=[]},F.prototype.measure=function(c,C,d,T,U,D){if(0===this.rowLevelWidths.length||void 0!==D){for(var I={done:!1,levels:[],spanningHeaders:[],leafCount:0},q=C.getHierarchyDepth(),v=d.getHierarchyDepth(),e=0;e<q;e++)(void 0===D||D===e)&&(this.rowLevelWidths[e]=this.sizeManager.getRowLevelWidth(C.getCorner(e,v-1))),I.levels.push({largestItem:null,isHeader:!0,largestItemWidth:-1,largestItemHeight:-1});this.getWidestRowHeaders(C.getHierarchyItems(),I,c,C,T,U);var r=C.getFloatingHierarchyItems();_.isEmpty(r)||(I.done=!1,I.leafCount=0,this.getWidestRowHeaders(r,I,c,C,-1,C.getFloatingHierarchyLeafCount()));for(var l=0;l<v;l++)for(var g=0;g<q;g++)if(void 0===this.rowLevelWidths[g]){var p=C.getCorner(g,l),s=c.getApproximateCornerCellWidth(p);s>I.levels[g].largestItemWidth&&(I.levels[g].isHeader=!1,I.levels[g].largestItem=p,I.levels[g].largestItemWidth=s)}for(var n="",u=0,S=I.levels;u<S.length;u++)if((y=S[u]).largestItem)if(y.isHeader){var f=c.getRowHeaderBinding(y.largestItem,!0);n+=oe.bG.build(f,F.measureRequiredStyles)}else f=c.getCornerCellBinding(y.largestItem,!0),n+=oe.bG.build(f,F.measureRequiredStyles);if(n){this.measureElement.insertAdjacentHTML("beforeend",n);for(var m=this.measureElement.firstChild,R=0,x=0,O=I.levels;x<O.length;x++){var y;(y=O[x]).largestItem&&((void 0===D||D===R)&&(this.rowLevelWidths[R]=m.offsetWidth+1),m=m.nextSibling),R++}this.measureElement.innerHTML="",this.adjustLevelWidthsFromSpanningHeaders(I,c,C)}}},F.prototype.adjustLevelWidthsFromSpanningHeaders=function(c,C,d){for(var T="",U=0,D=c.spanningHeaders;U<D.length;U++)if(c.levels[(I=D[U]).levelToAdjust].largestItem){var q=C.getRowHeaderBinding(I.item,!0);T+=oe.bG.build(q,F.measureRequiredStyles)}if(T){this.measureElement.insertAdjacentHTML("beforeend",T);for(var v=this.measureElement.firstChild,e=0,r=c.spanningHeaders;e<r.length;e++){var I;c.levels[(I=r[e]).levelToAdjust].largestItem&&(this.adjustLevelWidthFromSpanningHeader(I.item,I.level,I.levelToAdjust,v.offsetWidth,d),v=v.nextSibling)}this.measureElement.innerHTML=""}},F.prototype.adjustLevelWidthFromSpanningHeader=function(c,C,d,T,U){for(var D=0,I=C;I<=d;I++)D+=this.getLevelWidth(I);T>D&&(this.rowLevelWidths[d]+=T-D)},F.prototype.getWidestRowHeaders=function(c,C,d,T,U,D){for(var I=0,q=c;I<q.length;I++){var v=q[I];if(C.done)return;var e=T.isLeaf(v),r=T.getLevel(v),l=(0,Q.zG)(v,T),g=(0,Q.pA)(v,T)>=U;if(g)if(1===l){if(void 0===this.rowLevelWidths[r]){var p=d.getApproximateRowHeaderWidth(v);p>C.levels[r].largestItemWidth&&(C.levels[r].largestItem=v,C.levels[r].largestItemWidth=p)}}else C.spanningHeaders.push({item:v,level:r,levelToAdjust:l+r-1});var s=T.getChildren(v);s&&this.getWidestRowHeaders(s,C,d,T,U,D),e&&g&&C.leafCount++,C.leafCount===D&&(C.done=!0)}},F.prototype.getHeadersWidth=function(){for(var c=0,C=0,d=this.rowLevelWidths;C<d.length;C++)c+=d[C];return c},F.prototype.getLevelLeft=function(c){for(var C=0,d=0;d<c;d++)C+=this.rowLevelWidths[d];return C},F.prototype.getLevelWidth=function(c){return this.rowLevelWidths[c]},F.prototype.setLevelWidth=function(c,C){this.rowLevelWidths[c]=C},F.prototype.getWidth=function(c,C){for(var d=0,T=c;T<c+C;T++)d+=this.getLevelWidth(T);return d},F.measureRequiredStyles={"box-sizing":"border-box",display:"inline-flex"},F}(),Y=function(){function F(c,C){this.measureElement=c,this.sizeManager=C}return F.prototype.clear=function(){this.width=void 0},F.prototype.getHeaderBindingString=function(c,C){var d=C.getRowHeaderBinding(c,!0);return oe.bG.build(d,J.measureRequiredStyles)},F.prototype.measure=function(c,C,d,T,U,D){if((void 0===this.width||void 0!==D)&&(this.width=this.sizeManager.getRowLevelWidth(C.getCorner(0,d.getHierarchyDepth()-1)),void 0===this.width)){for(var I="",q=Math.min(C.getHierarchyLeafCount()-T,U),v=0;v<q;v++)I+=this.getHeaderBindingString(C.getHierarchyLeafAt(v+T),c);var e=C.getFloatingHierarchyItems();if(!_.isEmpty(e)){var r=C.getFloatingHierarchyLeafCount();for(v=0;v<r;v++)I+=this.getHeaderBindingString(C.getFloatingHierarchyLeafAt(v),c)}if(C.getHierarchyDepth()>0)for(v=0;v<d.getHierarchyDepth();v++){var l=C.getCorner(0,v),g=c.getCornerCellBinding(l,!0);I+=oe.bG.build(g,J.measureRequiredStyles)}this.measureElement.insertAdjacentHTML("beforeend",I);for(var p=this.measureElement.firstChild,s=0;p;)s=Math.max(s,p.offsetWidth+1),p=p.nextSibling;this.measureElement.innerHTML="",this.width=s}},F.prototype.getHeadersWidth=function(){return this.width},F.prototype.getLevelWidth=function(c){return this.width},F.prototype.setLevelWidth=function(c,C){this.width=C},F.prototype.getLevelLeft=function(c){return 0},F}()},87914:function(Te,Pe,A){A.d(Pe,{yv:function(){return Q},zf:function(){return N}});var N=9,Q=250},79465:function(Te,Pe,A){A.d(Pe,{BM:function(){return N},aP:function(){return ce},p0:function(){return pe},xU:function(){return oe},y2:function(){return Q}});var N=function(ee){return ee[ee.Incremental=0]="Incremental",ee[ee.ClearRendering=1]="ClearRendering",ee[ee.ClearMeasurement=2]="ClearMeasurement",ee[ee.ClearMeasurementOnly=3]="ClearMeasurementOnly",ee[ee.ResizeColumn=4]="ResizeColumn",ee}({}),pe=function(ee){return ee[ee.Header=0]="Header",ee[ee.Body=1]="Body",ee[ee.Footer=2]="Footer",ee[ee.FooterHeader=3]="FooterHeader",ee[ee.MatrixRowHeader=4]="MatrixRowHeader",ee[ee.MatrixCorner=5]="MatrixCorner",ee}({}),Q=function(ee){return ee[ee.Table=0]="Table",ee[ee.Matrix=1]="Matrix",ee}({}),oe=function(ee){return ee[ee.Blocked=0]="Blocked",ee[ee.Stepped=1]="Stepped",ee}({}),ce=function(ee){return ee[ee.Prefix=0]="Prefix",ee[ee.Main=1]="Main",ee}({})},44404:function(Te,Pe,A){A.d(Pe,{S:function(){return pe}});var N=A(62458);function pe(Q){return N.fF.assertValue(null!=Q,"value should be defined"),0===Q?Q.toString():Q+"px"}},7911:function(Te,Pe,A){A.d(Pe,{BJ:function(){return ce},VG:function(){return oe},bG:function(){return ee}});var N=A(55007),pe=A(62458),Q=A(79602),oe=function(){function K(){this.columnWidths=[]}return K.prototype.getColumnWidths=function(){return this.columnWidths},K.prototype.getWidth=function(){return _.sum(this.columnWidths)},K}(),ce=function(){function K(){this.rowHeights=[]}return K.prototype.getRowHeights=function(){return this.rowHeights},K.prototype.getHeight=function(){return _.sum(this.rowHeights)},K.prototype.clear=function(){this.rowHeights=[]},K}(),ee=function(){function K(){}return K.build=function(G,j){if(void 0===j&&(j={}),null===G.tagName)return G.content;var ae=G.tagName||"div",i="<"+ae+" "+this.buildAttributes(G.attributes)+this.buildClassNames(G.classNames)+this.buildStyles(G.styleProperties,j)+">";if(_.isEmpty(G.children))null!=G.content&&(i+=G.content);else for(var P=0,o=G.children;P<o.length;P++)i+=K.build(o[P],null);return i+"</"+ae+">"},K.buildMultiple=function(G){return _.map(G,function(j){return K.build(j)}).join("")},K.buildAttributes=function(G){var j="";if(G)for(var ae in G)j+=ae+"="+N.u3+G[ae]+N.u3;return j},K.buildClassNames=function(G){if(!G||0===G.length)return"";for(var j='class="',ae=0,i=G;ae<i.length;ae++)j+=i[ae]+" ";return j+'"'},K.buildStyles=function(G,j){var ae=!_.isEmpty(j),i=!_.isEmpty(G);if(!ae&&!i)return"";var P="style="+N.u3;if(i)for(var o in G)P+=o+":"+G[o]+";";if(ae)for(var t in j)P+=t+":"+j[t]+";";return P+N.u3},K.attachEventHandlers=function(G,j){if(j.clickHandler&&G.addEventListener("click",function(i){return j.clickHandler(i)}),j.contextMenuHandler&&G.addEventListener("contextmenu",function(i){return j.contextMenuHandler(i)}),j.scrollHandler&&Q.l.runOutsideAngular(function(){G.addEventListener("scroll",function(i){return j.scrollHandler(i)})}),!_.isEmpty(j.children)){pe.fF.assert(function(){return j.children.length===G.childNodes.length},"Element children mismatch");for(var ae=0;ae<j.children.length;ae++)null!==j.children[ae].tagName&&K.attachEventHandlers(G.childNodes[ae],j.children[ae])}},K.attachEventHandlersMultiple=function(G,j){var ae=G;j.forEach(function(i){K.attachEventHandlers(ae,i),ae=ae.nextElementSibling})},K}()},24133:function(Te,Pe,A){A.d(Pe,{d:function(){return q}});var N=A(81337),pe=A(11034),Q=A(62458),oe=A(59107),ce=A(98094),ee=A(79602),K=A(44102),G=A(93340),j=A(71090),ae=A(52073),i=A(15366),P=A(44404),o=A(87914),t=A(79465),h=A(40183),b=function(){function v(e,r,l){this.onFocusChangedHandler=e,this.isA11yTable=r,this.isA11yMatrix=l}return Object.defineProperty(v.prototype,"CurrentFocus",{get:function(){return this.currentFocus},enumerable:!1,configurable:!0}),v.prototype.updateMeasureManagers=function(e,r){this.rowHeightMeasureManager=e,this.columnWidthMeasureManager=r},v.prototype.setAsFocusTableEx=function(e,r,l,g){Q.fF.assert(function(){return null!=e||l!==t.p0.Body},"body cells need row index"),l===t.p0.Header?this.currentFocus=g?{columnHeader:g}:{columnHeader:[r]}:l===t.p0.Body?this.currentFocus={bodyCell:{rowIndex:e,columnIndex:r}}:l===t.p0.Footer?this.currentFocus={floatingBodyCell:{rowIndex:e??0,columnIndex:r}}:l===t.p0.FooterHeader?this.currentFocus={floatingRowHeader:e}:l===t.p0.MatrixCorner?this.currentFocus={cornerCell:{rowLevel:r,columnLevel:e}}:l===t.p0.MatrixRowHeader?this.currentFocus=g?{rowHeader:g}:{rowHeader:[e]}:Q.fF.assertNever(l),this.updateFocusedItem()},v.prototype.updateFocusedItem=function(){if(Q.fF.assertValue(this.currentFocus,"No current focus"),this.currentFocus.columnHeader&&-1===this.currentFocus.columnHeader[0]||this.currentFocus.bodyCell&&-1===this.currentFocus.bodyCell.columnIndex||this.currentFocus.floatingBodyCell&&-1===this.currentFocus.floatingBodyCell.columnIndex)this.currentFocus.item=void 0;else{if(this.currentFocus.bodyCell){var e=this.rowNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.rowIndex),r=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.bodyCell.columnIndex);Q.fF.assertValue(e,"row leaf not found"),Q.fF.assertValue(r,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,r)}else this.currentFocus.columnHeader?this.currentFocus.item=this.columnNavigator.getNodeFromPath(this.currentFocus.columnHeader):this.currentFocus.rowHeader?this.currentFocus.item=this.rowNavigator.getNodeFromPath(this.currentFocus.rowHeader):this.currentFocus.cornerCell?this.currentFocus.item=this.rowNavigator.getCorner(this.currentFocus.cornerCell.rowLevel,this.currentFocus.cornerCell.columnLevel):this.currentFocus.floatingBodyCell?(e=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingBodyCell.rowIndex),r=this.columnNavigator.getHierarchyLeafAt(this.currentFocus.floatingBodyCell.columnIndex),Q.fF.assertValue(e,"row leaf not found"),Q.fF.assertValue(r,"column leaf not found"),this.currentFocus.item=this.rowNavigator.getIntersection(e,r)):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus.item=this.rowNavigator.getFloatingHierarchyLeafAt(this.currentFocus.floatingRowHeader):Q.fF.assertFail("unexpected focus state");Q.fF.assertValue(this.currentFocus,"Undefined focused item")}},v.prototype.moveFocus=function(e,r,l,g,p,s){Q.fF.assertValue(this.currentFocus,"No initial focus");var n=this.currentFocus;this.currentFocus.bodyCell?this.currentFocus=this.moveBodyCellFocusTableEx(e,r,p,g):this.currentFocus.rowHeader?this.currentFocus=this.moveRowHeaderFocusTableEx(e,r,p,s):this.currentFocus.columnHeader?this.currentFocus=this.moveColumnHeaderFocusTableEx(e,r,g):this.currentFocus.cornerCell?this.currentFocus=this.moveCornerCellFocusTableEx(e,r):void 0!==this.currentFocus.floatingRowHeader?this.currentFocus=this.moveFloatingRowHeaderFocusTableEx(e,r):this.currentFocus.floatingBodyCell&&(this.currentFocus=this.moveFloatingBodyCellFocusTableEx(e,r)),Q.fF.assertValue(this.currentFocus,"Undefined new focus"),this.updateFocusedItem(),this.onFocusChangedHandler&&this.onFocusChangedHandler(),this.previousFocus=n},v.prototype.moveBodyCellFocusTableEx=function(e,r,l,g){var p=this.currentFocus.bodyCell.rowIndex,s=this.currentFocus.bodyCell.columnIndex,n=this.rowNavigator.getFloatingHierarchyLeafCount()>0,u=-1===s,S=this.rowHeightMeasureManager.getPageRows().length,y=_.last(this.rowHeightMeasureManager.getPageRows()),f=(S-1)*i.hw+(y.getRowHeights().length-1),m=this.columnWidthMeasureManager.getPageColumns().length,R=_.last(this.columnWidthMeasureManager.getPageColumns()),x=(m-1)*i.MN+(R.getColumnWidths().length-1);if(r){if("home"===e)return g?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return g?this.getBottomRightCell():n?{floatingBodyCell:{rowIndex:0,columnIndex:x}}:{bodyCell:{rowIndex:f,columnIndex:x}};if("up"===e)return g?{columnHeader:[this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(s))[0]]}:u?{bodyCell:{rowIndex:0,columnIndex:s}}:{columnHeader:[s]};if("down"===e)return u||!n?{bodyCell:{rowIndex:f,columnIndex:s}}:{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:s}};if("left"===e)return g?{rowHeader:[this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(p))[0]]}:{bodyCell:{rowIndex:p,columnIndex:0}};if("right"===e)return{bodyCell:{rowIndex:p,columnIndex:x}}}else{if("home"===e){if(g){var O=this.rowNavigator.getHierarchyLeafAt(p),W=this.rowNavigator.getLeafAncestorAtLevel(O,0);return{rowHeader:this.rowNavigator.getPathIndices(W)}}return{bodyCell:{rowIndex:p,columnIndex:0}}}if("end"===e)return g?{bodyCell:{rowIndex:p,columnIndex:this.columnWidthMeasureManager.getLastMeasuredIndex()}}:{bodyCell:{rowIndex:p,columnIndex:x}};if("pageup"===e&&l)return{bodyCell:{rowIndex:ne=Math.max(this.prevNonblankRowIndex(p-l+1),0),columnIndex:s}};if("pagedown"===e&&l){var de=this.prevNonblankRowIndex(f+1);return{bodyCell:{rowIndex:ne=Math.min(this.nextNonblankRowIndex(p+l-1),de),columnIndex:s}}}if("up"===e)return(ne=this.prevNonblankRowIndex(p))<0?u?{bodyCell:{rowIndex:0,columnIndex:s}}:g&&this.columnNavigator.hasHierarchy()?{columnHeader:this.columnNavigator.getPathIndices(this.columnNavigator.getHierarchyLeafAt(s))}:{columnHeader:[s]}:{bodyCell:{rowIndex:ne,columnIndex:s}};if("down"===e){var ne;if(!((ne=this.nextNonblankRowIndex(p))>f))return{bodyCell:{rowIndex:ne,columnIndex:s}};if(u||!n&&!g)return{bodyCell:{rowIndex:f,columnIndex:s}};if(!g||n)return{floatingBodyCell:{rowIndex:0,columnIndex:s}}}if("left"===e)return g&&0===s?this.rowNavigator.hasHierarchy()?{rowHeader:this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(p))}:{rowHeader:[p]}:{bodyCell:{rowIndex:p,columnIndex:Math.max(s-1,-1)}};if("right"===e)return{bodyCell:{rowIndex:p,columnIndex:Math.min(s+1,x)}}}return this.currentFocus},v.prototype.moveRowHeaderFocusTableEx=function(e,r,l,g){var p,s=this.columnWidthMeasureManager.getLastMeasuredIndex(),n=this.columnNavigator.getHierarchyDepth(),u=this.currentFocus.rowHeader,S=this.rowNavigator.getNodeFromPath(u),y=this.rowNavigator instanceof h.S?0:this.rowNavigator.getLevel(S),f=this.rowNavigator.getItemsByLevel(y),m=f.indexOf(S),R=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(r){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:y,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(y)}else{if("left"===e&&u.length>1)return{rowHeader:_.dropRight(u,1)};if("right"===e){if(null!==(p=this.previousFocus)&&void 0!==p&&p.rowHeader&&_.isEqual(_.dropRight(this.previousFocus.rowHeader,1),this.currentFocus.rowHeader))return this.previousFocus;var x=this.rowNavigator.getLeafIndex(S);if(void 0===x)return{rowHeader:(0,N.__spreadArray)((0,N.__spreadArray)([],u||[],!0),[0],!1)};if(s>-1)return{bodyCell:{rowIndex:x,columnIndex:0}}}if("up"===e)return(O=this.prevNonblankHeaderRowIndex(m,f))>=0?{rowHeader:this.rowNavigator.getPathIndices(f[O])}:{cornerCell:{rowLevel:y,columnLevel:n-1}};if("down"===e){if((O=this.nextNonblankHeaderRowIndex(m,f))<=f.length-1)return{rowHeader:this.rowNavigator.getPathIndices(f[O])};if(R)return{floatingRowHeader:0}}if("pagedown"===e){var W=this.rowHeightMeasureManager.getLastMeasuredIndex(),te=(0,ae.hG)(this.currentFocus.item,this.rowNavigator),ne=this.nextNonblankRowIndex(te+l-1),de=this.prevNonblankRowIndex(W+1),le=Math.min(ne,de),z=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(le));if(this.rowNavigator.isLeaf(S)||this.rowNavigator instanceof h.S)return{rowHeader:z};var se=_.take(z,Math.min(this.currentFocus.rowHeader.length,z.length)),O=this.nextNonblankHeaderRowIndex(m,f);return _.isEqual(se,this.currentFocus.rowHeader)&&O<=f.length-1?{rowHeader:this.rowNavigator.getPathIndices(f[O])}:{rowHeader:se}}if("pageup"===e&&(te=(0,ae.hG)(this.currentFocus.item,this.rowNavigator),le=Math.max(this.prevNonblankRowIndex(te-l+1),0),z=this.rowNavigator.getPathIndices(this.rowNavigator.getHierarchyLeafAt(le)),(se=_.take(z,Math.min(this.currentFocus.rowHeader.length,z.length)))!==this.currentFocus.rowHeader))return{rowHeader:se}}return u.length>1&&(r&&"left"===e||"home"===e)?{rowHeader:[u[0]]}:r&&"right"===e||"end"===e?{bodyCell:{rowIndex:(0,ae.hG)(S,this.rowNavigator),columnIndex:s}}:this.currentFocus},v.prototype.moveColumnHeaderFocusTableEx=function(e,r,l){var g,p=this.currentFocus.columnHeader[0],s=this.rowNavigator.getFloatingHierarchyLeafCount()>0,n=this.rowHeightMeasureManager.getPageRows().length,u=_.last(this.rowHeightMeasureManager.getPageRows()),S=u?(n-1)*i.hw+(u.getRowHeights().length-1):-1,y=this.columnWidthMeasureManager.getPageColumns().length,f=_.last(this.columnWidthMeasureManager.getPageColumns()),m=(y-1)*i.MN+(f.getColumnWidths().length-1),R=this.currentFocus.columnHeader,x=this.columnNavigator.getNodeFromPath(R),O=this.columnNavigator.getLevel(x),W=this.rowNavigator.getHierarchyDepth();if(r){if("home"===e)return l?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e){if(l)return this.getBottomRightCell();if(s)return{floatingBodyCell:{rowIndex:0,columnIndex:m}};if(-1!==S)return{bodyCell:{rowIndex:S,columnIndex:m}}}if("down"===e){var te=this.columnNavigator.hasHierarchy?this.getFirstColumnLeafFromAncestor(x):p;return this.getBottomFooterBodyCell(te,S)}if("up"===e)return{columnHeader:[R[0]]}}else{if("up"===e&&l&&this.columnNavigator.hasHierarchy()&&R.length>1)return{columnHeader:_.dropRight(R,1)};if("down"===e){if(l){if(null!==(g=this.previousFocus)&&void 0!==g&&g.columnHeader&&_.isEqual(_.dropRight(this.previousFocus.columnHeader,1),this.currentFocus.columnHeader))return this.previousFocus;var ne=this.columnNavigator.getLeafIndex(x);if(!this.columnNavigator.isLeaf(x))return{columnHeader:(0,N.__spreadArray)((0,N.__spreadArray)([],this.currentFocus.columnHeader,!0),[0],!1)};if(S>=0)return{bodyCell:{rowIndex:0,columnIndex:ne}};if(s)return{floatingBodyCell:{rowIndex:0,columnIndex:ne}}}if(-1!==S)return{bodyCell:{rowIndex:0,columnIndex:p}}}var de=this.columnNavigator.getItemsByLevel(O),le=de.indexOf(x);if("left"===e)return l?le>0?{columnHeader:this.columnNavigator.getPathIndices(de[le-1])}:this.rowNavigator.hasHierarchy()?{cornerCell:{rowLevel:W-1,columnLevel:O}}:{cornerCell:{rowLevel:0,columnLevel:O}}:{columnHeader:[Math.max(p-1,0)]};if("right"===e)return l&&-1!==le?{columnHeader:this.columnNavigator.getPathIndices(de[Math.min(le+1,de.length-1)])}:{columnHeader:[Math.min(p+1,m)]}}return"home"===e||r&&"left"===e?l?{cornerCell:{rowLevel:0,columnLevel:O}}:{columnHeader:[0]}:"end"===e||r&&"right"===e?l?this.getLastMatrixColumnCell(this.currentFocus.columnHeader.length-1):{columnHeader:[m]}:this.currentFocus},v.prototype.moveCornerCellFocusTableEx=function(e,r){var l=this.currentFocus.cornerCell.rowLevel,g=this.currentFocus.cornerCell.columnLevel,p=this.rowNavigator.getItemsByLevel(l),s=this.columnNavigator.getItemsByLevel(g),n=this.rowNavigator.getHierarchyLeafCount(),u=this.rowNavigator.getHierarchyDepth(),S=this.columnNavigator.getHierarchyDepth(),y=this.rowNavigator.getFloatingHierarchyLeafCount()>0;if(r){if("home"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("up"===e)return{cornerCell:{rowLevel:l,columnLevel:0}};if("down"===e)return this.getBottomFooterHeaderCell(l)}else{if("up"===e&&g>0)return{cornerCell:{rowLevel:l,columnLevel:g-1}};if("down"===e){if(g<S-1)return{cornerCell:{rowLevel:l,columnLevel:g+1}};if(n>0)return{rowHeader:this.rowNavigator.getPathIndices(p[0])};if(y)return{floatingRowHeader:0}}if("right"===e){if(l<u-1)return{cornerCell:{rowLevel:l+1,columnLevel:g}};if(!_.isEmpty(s))return{columnHeader:this.columnNavigator.getPathIndices(s[0])}}if("left"===e&&l>0)return{cornerCell:{rowLevel:l-1,columnLevel:g}}}return l>0&&("home"===e||r&&"left"===e)?{cornerCell:{rowLevel:0,columnLevel:g}}:"end"===e||r&&"right"===e?this.getLastMatrixColumnCell(this.currentFocus.cornerCell.columnLevel):this.currentFocus},v.prototype.moveFloatingRowHeaderFocusTableEx=function(e,r){var l=this.rowNavigator.getHierarchyLeafCount(),g=this.columnWidthMeasureManager.getLastMeasuredIndex(),p=this.columnNavigator.getHierarchyDepth(),s=this.currentFocus.floatingRowHeader;if(Q.fF.assert(function(){return g>-1},"There can not be Floating rows without column headers"),r){if("home"===e||"up"===e)return{cornerCell:{rowLevel:0,columnLevel:0}};if("end"===e)return this.getBottomRightCell();if("down"===e&&s<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}}else{if("right"===e)return{floatingBodyCell:{rowIndex:s,columnIndex:0}};if("up"===e){if(s>0)return{floatingRowHeader:s-1};if(l>0){var n=this.rowNavigator.getItemsByLevel(0),u=this.prevNonblankHeaderRowIndex(n.length,n);return{rowHeader:this.rowNavigator.getPathIndices(n[u])}}return{cornerCell:{rowLevel:0,columnLevel:p-1}}}if("down"===e&&s<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingRowHeader:s+1}}return r&&"right"===e||"end"===e?{floatingBodyCell:{rowIndex:s,columnIndex:g}}:this.currentFocus},v.prototype.moveFloatingBodyCellFocusTableEx=function(e,r){var l=this.currentFocus.floatingBodyCell.columnIndex,g=this.currentFocus.floatingBodyCell.rowIndex,p=-1===l,s=this.rowHeightMeasureManager.getPageRows().length,n=_.last(this.rowHeightMeasureManager.getPageRows()),u=n?(s-1)*i.hw+(n.getRowHeights().length-1):-1,S=this.columnWidthMeasureManager.getPageColumns().length,y=_.last(this.columnWidthMeasureManager.getPageColumns()),f=(S-1)*i.MN+(y.getColumnWidths().length-1);if(r){if("home"===e)return this.isA11yMatrix?{cornerCell:{rowLevel:0,columnLevel:0}}:{columnHeader:[0]};if("end"===e)return this.isA11yMatrix?this.getBottomRightCell():{floatingBodyCell:{rowIndex:0,columnIndex:f}};if("up"===e){if(this.isA11yMatrix){var m=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0);return{columnHeader:[this.columnNavigator.getIndex(m)]}}return p?{bodyCell:{rowIndex:0,columnIndex:l}}:{columnHeader:[l]}}if("down"===e)return{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:l}};if("left"===e)return this.isA11yMatrix?{floatingRowHeader:g}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("right"===e)return{floatingBodyCell:{rowIndex:g,columnIndex:f}}}else{if("home"===e)return this.isA11yMatrix?{floatingRowHeader:g}:{floatingBodyCell:{rowIndex:0,columnIndex:0}};if("end"===e)return{floatingBodyCell:{rowIndex:0,columnIndex:f}};if("up"===e)return 0===g?u>=0?{bodyCell:{rowIndex:this.prevNonblankRowIndex(u+1),columnIndex:l}}:(m=this.columnNavigator.getLeafAncestorAtLevel(this.columnNavigator.getHierarchyLeafAt(l),0),{columnHeader:[this.columnNavigator.getIndex(m)]}):{floatingBodyCell:{rowIndex:g-1,columnIndex:l}};if("down"===e&&g<this.rowNavigator.getFloatingHierarchyLeafCount()-1)return{floatingBodyCell:{rowIndex:g+1,columnIndex:l}};if("left"===e)return 0===l&&this.isA11yMatrix?{floatingRowHeader:g}:{floatingBodyCell:{rowIndex:g,columnIndex:Math.max(l-1,0)}};if("right"===e)return{floatingBodyCell:{rowIndex:g,columnIndex:Math.min(l+1,f)}}}return this.currentFocus},v.prototype.getBottomRightCell=function(){var e=this.rowNavigator.getFloatingHierarchyLeafCount(),r=this.columnWidthMeasureManager.getLastMeasuredIndex(),l=this.rowNavigator.getHierarchyLeafCount()-1;return e>0?{floatingBodyCell:{rowIndex:e-1,columnIndex:r}}:{bodyCell:{rowIndex:l,columnIndex:r}}},v.prototype.getLastMatrixColumnCell=function(e){var r=this.columnNavigator.getHierarchyLeafCount(),l=this.columnNavigator.getHierarchyLeafAt(r-1),g=this.columnNavigator.getPathIndices(l);return{columnHeader:_.dropRight(g,g.length-(e+1))}},v.prototype.getFirstColumnLeafFromAncestor=function(e){return this.columnNavigator.isLeaf(e)?this.columnNavigator.getLeafIndex(e):this.getFirstColumnLeafFromAncestor(this.columnNavigator.getChildren(e)[0])},v.prototype.getBottomFooterBodyCell=function(e,r){var l=this.rowNavigator.getFloatingHierarchyLeafCount()>0;return-1!==e&&l?{floatingBodyCell:{rowIndex:this.rowNavigator.getFloatingHierarchyLeafCount()-1,columnIndex:e}}:-1===r?this.currentFocus:{bodyCell:{rowIndex:r,columnIndex:e}}},v.prototype.getBottomFooterHeaderCell=function(e){var r=this.rowNavigator.getItemsByLevel(e);return this.rowNavigator.getFloatingHierarchyLeafCount()>0?{floatingRowHeader:this.rowNavigator.getFloatingHierarchyLeafCount()-1}:{rowHeader:this.rowNavigator.getPathIndices(r[r.length-1])}},v.prototype.prevNonblankRowIndex=function(e){for(var r=e-1;r>=0;r--)if(!this.rowNavigator.isBlankRow(r))return r;return-1},v.prototype.nextNonblankRowIndex=function(e){for(var r=this.rowNavigator.getHierarchyLeafCount(),l=e+1;l<r;l++)if(!this.rowNavigator.isBlankRow(l))return l;return r+1},v.prototype.prevNonblankHeaderRowIndex=function(e,r){for(var l=e-1;l>=0;l--)if(!this.rowNavigator.isBlank(r[l]))return l;return-1},v.prototype.nextNonblankHeaderRowIndex=function(e,r){for(var l=e+1;l<r.length;l++)if(!this.rowNavigator.isBlank(r[l]))return l;return r.length},v}(),V=A(52287),H=function(){function v(e,r,l,g,p,s){var n=this;this.isA11yMatrix=s,this.elementOriginalCursor=r?.style.cursor,this.verticalResizeHandler=l,this.horizontalResizeHandler=g,(l||g)&&(r.addEventListener("mousedown",function(u){return r.closest("[".concat(V.y3,"=true]"))?null:n.onMouseDown(e,r,u)}),r.addEventListener("mousemove",function(u){return r.closest("[".concat(V.y3,"=true]"))?null:n.onMouseMove(r,u)}),r.addEventListener("dblclick",function(u){return r.closest("[".concat(V.y3,"=true]"))?null:n.onDoubleClick(e,r,u)})),p&&r.addEventListener("click",function(u){return n.onClick(e,r,u,p)})}return v.prototype.onMouseDown=function(e,r,l){var g=this.getActiveHandler(r,l);if(g){this.resizing=!0,this.startMousePosition=v.getMouseCoordinates(l);var p=(0,G.df)(r);this.initializeDocumentEvents(r,g,p),document.documentElement&&(this.documentOriginalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=this.getCursor(r,l)),g.onStartResize(e)}else this.resizing=!1},v.prototype.onMouseMove=function(e,r){this.startMousePosition||(e.style.cursor=this.getCursor(e,r))},v.prototype.onDoubleClick=function(e,r,l){var g=this.getActiveHandler(r,l);g&&g.onReset(e)},v.prototype.onClick=function(e,r,l,g){this.isA11yMatrix&&!r.closest("[".concat(V.y3,"=true]"))&&l.stopPropagation(),!this.resizing&&g&&g(e,l)},v.prototype.getActiveHandler=function(e,r){return this.isMouseOnVerticalHandle(e,v.getMouseCoordinates(r))?this.verticalResizeHandler:this.isMouseOnHorizontalHandle(e,v.getMouseCoordinates(r))?this.horizontalResizeHandler:null},v.prototype.getCursor=function(e,r){return this.isMouseOnVerticalHandle(e,v.getMouseCoordinates(r))?"col-resize":this.isMouseOnHorizontalHandle(e,v.getMouseCoordinates(r))?"row-resize":this.elementOriginalCursor},v.prototype.initializeDocumentEvents=function(e,r,l){var g=this;this.documentMouseMoveListener=function(p){p.preventDefault(),r.onResize(v.getMouseCoordinatesDelta(g.startMousePosition,v.getMouseCoordinates(p),l))},document.addEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseUpListener=function(p){p.preventDefault(),document.removeEventListener("mousemove",g.documentMouseMoveListener),g.documentMouseMoveListener=null,document.removeEventListener("mouseup",g.documentMouseUpListener),g.documentMouseUpListener=null,document.documentElement&&(document.documentElement.style.cursor=g.documentOriginalCursor,g.documentOriginalCursor=void 0),g.startMousePosition=null,r.onEndResize()},document.addEventListener("mouseup",this.documentMouseUpListener)},v.prototype.isMouseOnVerticalHandle=function(e,r){return!!this.verticalResizeHandler&&r.x>=e.getBoundingClientRect().right-v.HandleSize},v.prototype.isMouseOnHorizontalHandle=function(e,r){return!!this.horizontalResizeHandler&&r.y>=e.getBoundingClientRect().bottom-v.HandleSize},v.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},v.getMouseCoordinatesDelta=function(e,r,l){return r&&e?{x:(r.x-e.x)/l,y:(r.y-e.y)/l}:{x:0,y:0}},v.HandleSize=4,v}(),X=function(){function v(e,r,l){this.a11yTableFS=r,this.a11yMatrixFS=l,this.control=e}return v.prototype.onStartResize=function(e){var r=(0,ae.oj)(e,this.control.getColumnNavigator()),l=this.control.getColumnNavigator().getLeafIndex(r);this.resizeState={leafToResize:r,leafToResizeIndex:l,originalWidth:this.control.getColumnWidthMeasureManager().getColumnWidth(l)}},v.prototype.onResize=function(e){if(e.x&&this.resizeState){var r=this.control.getViewport(),l=i._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager()),g=i.sW.getVisibleRange(r.left,r.width,this.control.getColumnWidthMeasureManager());if(l&&g){var p=Math.max(this.resizeState.originalWidth+e.x,H.HandleSize);this.control.getColumnWidthMeasureManager().setColumnWidth(this.resizeState.leafToResizeIndex,p),i._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,g.firstLeafIndex,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(t.BM.ResizeColumn)}}},v.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.leafToResize,r=this.control.getColumnWidthMeasureManager().getColumnWidth(this.resizeState.leafToResizeIndex),l=this.resizeState.originalWidth;this.resizeState=void 0;var g=this.control.getViewport(),p=i._E.getVisibleRange(g.top,g.height,this.control.getRowHeightMeasureManager());if(p&&r!==l){this.control.getSizeManager().setColumnWidth(e,r);var s=i._E.getVisibleRowStart(p,g.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(t.BM.ClearRendering,s)}}},v.prototype.onReset=function(e){var r=this.control.getViewport(),l=i._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager());if(l){var g=(0,ae.oj)(e,this.control.getColumnNavigator()),p=this.control.getColumnNavigator().getLeafIndex(g);this.control.getSizeManager().setColumnWidth(g,void 0),i.sW.remeasureColumn(p,this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,this.control.getColumnWidthMeasureManager());var s=i._E.getVisibleRowStart(l,r.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(t.BM.ClearRendering,s)}},v}(),F=function(){function v(e,r){this.a11yMatrixFS=r,this.control=e}return v.prototype.onStartResize=function(e){var r=this.getLevelToResize(e);this.resizeState={cornerCellToResize:this.control.getRowNavigator().getCorner(r,this.control.getColumnNavigator().getHierarchyDepth()-1),levelToResize:r,originalWidth:this.control.getRowLevelWidthMeasureManager().getLevelWidth(r)}},v.prototype.onResize=function(e){if(e.x&&this.resizeState){var r=this.control.getViewport(),l=i._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager()),g=i.sW.getVisibleRange(r.left,r.width,this.control.getColumnWidthMeasureManager());if(l){var p=Math.min(this.getMaxWidth(this.resizeState.levelToResize),Math.max(this.resizeState.originalWidth+e.x,H.HandleSize));this.control.getRowLevelWidthMeasureManager().setLevelWidth(this.resizeState.levelToResize,p),i._E.remeasureRows(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,l.lastLeafIndex,g?g.firstLeafIndex:0,this.control.getRowHeightMeasureManager()),this.control.getRowHeightMeasureManager().clearFloatingRows(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(t.BM.ResizeColumn)}}},v.prototype.onEndResize=function(){if(this.resizeState){var e=this.resizeState.cornerCellToResize,r=this.control.getRowLevelWidthMeasureManager().getLevelWidth(this.resizeState.levelToResize),l=this.resizeState.originalWidth;this.resizeState=void 0;var g=this.control.getViewport(),p=i._E.getVisibleRange(g.top,g.height,this.control.getRowHeightMeasureManager());if(p&&r!==l){this.control.getSizeManager().setRowLevelWidth(e,r);var s=i._E.getVisibleRowStart(p,g.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.renderAsync(t.BM.ClearRendering,s)}}},v.prototype.onReset=function(e){var r=this.control.getViewport(),l=i._E.getVisibleRange(r.top,r.height,this.control.getRowHeightMeasureManager());if(l){var g=this.getLevelToResize(e),p=this.control.getRowNavigator().getCorner(g,this.control.getColumnNavigator().getHierarchyDepth()-1);this.control.getSizeManager().setRowLevelWidth(p,void 0),this.control.getRowLevelWidthMeasureManager().measure(this.control.getBinder(),this.control.getRowNavigator(),this.control.getColumnNavigator(),l.firstLeafIndex,i.Ms,g);var s=i._E.getVisibleRowStart(l,r.top,this.control.getRowHeightMeasureManager());this.control.getRowHeightMeasureManager().clear(),this.control.getColumnLevelHeightMeasureManager().clear(),this.control.renderAsync(t.BM.Incremental,s)}},v.prototype.getLevelToResize=function(e){return this.control.getSteppedLayout()?0:this.control.getRowNavigator().getRowLevel(e)},v.prototype.getMaxWidth=function(e){for(var r=this.control.getClientWidth(),l=0;l<e;l++)r-=this.control.getRowLevelWidthMeasureManager().getLevelWidth(l);return r},v}(),c=A(57470),C=A(7911),d=function(){function v(e,r,l,g,p,s,n,u,S,y,f,m,R){var O,x=this;this.element=e,this.prefixCellClickHandler=r,this.prefixCellContextMenuHandler=l,this.mainCellClickHandler=g,this.mainCellContextMenuHandler=p,this.interactionHandler=s,this.section=n,this.renderType=u,this.onObject=S,this.enableCalculationHighlight=y,this.isRenderStable=f,this.showTotalPlaceHolders=m,this.showAsTableNativeMenu=R,this.unfrozenRowHeaders=!1,this.repeatRowHeaders=!1,this.viewSync={},this.xPosition=0,this.element.addEventListener("click",function(W){var te,ne,de=W.target,le=x.getItemByElement(de);le&&(x.isPrefixCell(de)?null===(te=x.prefixCellClickHandler)||void 0===te||te.call(x,le,W,void 0,x.section):null===(ne=x.mainCellClickHandler)||void 0===ne||ne.call(x,le,W,void 0,x.section))}),this.element.addEventListener("contextmenu",function(W){var te,ne,de=W.target,le=x.getItemByElement(de);!le||R||(x.isPrefixCell(de)?null===(te=x.prefixCellContextMenuHandler)||void 0===te||te.call(x,le,W):null===(ne=x.mainCellContextMenuHandler)||void 0===ne||ne.call(x,le,W))}),this.renderType===t.y2.Table&&this.element.addEventListener("change",function(W){var te,ne=d3.select(W.target).attr("checkbox-rowindex");null!=ne&&(null===(te=x.mainCellClickHandler)||void 0===te||te.call(x,void 0,void 0,+ne,x.section))}),null===(O=this.interactionHandler)||void 0===O||O.setTooltipDelegate(function(W){return x.getItemByElement(W.context)},this.element,this.getRegion.bind(this),!R,function(W){return x.shouldHideDefaultTooltip(W.context)})}return v.prototype.update=function(e,r,l,g){var p=this.rowHeightMeasureManager.getLastMeasuredIndex(),s=this.columnWidthMeasureManager.getLastMeasuredIndex(),n=i._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager,i.hw,p),u=i.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager,i.MN,s);if(this.section!==t.p0.Body||n){var S,y,f;switch(u||(u={firstLeafIndex:-1,firstLeafLeft:0,lastLeafIndex:-2}),this.section){case t.p0.Header:S=[0,g.getHierarchyDepth()-1],y=this.rowHeightMeasureManager.getPageRows(),f=this.columnWidthMeasureManager.getPageColumns();break;case t.p0.Body:S=[n.firstLeafIndex,n.lastLeafIndex],y=this.rowHeightMeasureManager.getPageRows(),f=this.columnWidthMeasureManager.getPageColumns();break;case t.p0.Footer:S=[0,l.getFloatingHierarchyLeafCount()-1],y=[this.rowHeightMeasureManager.getFloatingPageRow()],f=this.columnWidthMeasureManager.getPageColumns();break;default:Q.fF.assertNever(this.section)}this.renderMeta={viewport:e,binder:r,rowNavigator:l,columnNavigator:g,visibleRowRange:S,visibleColumnRange:[u.firstLeafIndex,u.lastLeafIndex],pageRows:y,pageColumns:f},this.updateRendering()}},v.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e},v.prototype.setRepeatRowHeaders=function(e){this.repeatRowHeaders=e},v.prototype.setRowWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),r=this.columnWidthMeasureManager.getColumnsWidth();this.unfrozenRowHeaders&&(r+=e),d3.select(this.element).selectAll(".scrollable-cells-container").style("width",r+"px")},v.prototype.updateBodyLeft=function(){var e=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth();d3.select(this.element).selectAll(".scrollable-cells-viewport").style("left",e+"px")},v.prototype.shouldHideDefaultTooltip=function(e){var l=c.M.getFirstMatchingAncestor(e,function(n){return n.matches(".prefix-cell")||n.matches(".main-cell")},this.element,!0);if(!l)return!0;var p,g=d3.select(l);return!g.select(".tablixUrlIconGlyph").node()&&(!(p=g.classed("pivotTableCellWrap")||g.classed("pivotTableCellNoWrap")?g.node():g.select(".pivotTableCellWrap, .pivotTableCellNoWrap").node())||p.scrollHeight===p.clientHeight&&p.scrollWidth===p.clientWidth)},v.prototype.updateMeasureManagers=function(e,r,l,g,p){this.rowHeaderType=e,this.rowHeightMeasureManager=r,this.columnWidthMeasureManager=l,this.rowLevelWidthMeasureManager=g,this.columnLevelHeightMeasureManager=p},v.prototype.scrollToX=function(e){d3.select(this.element).selectAll(".scrollable-cells-container").style("left",-e+"px"),this.xPosition=e},v.prototype.onColumnResize=function(){var e=this;d3.select(this.element).selectAll(".row").each(function(){var r=e.getRowIndex(this),l=e.getRowHeight(r),g=e.getRowTop(r);d3.select(this).style("height",l+"px").style("top",g+"px")}),d3.select(this.element).selectAll(".prefix-cell:not(.filler-cell)").each(function(){var r=e.getRowIndex(this),l=e.getColumnIndex(this),g=e.isFillerCell(this),p=g?0:e.getPrefixCellHeight(r,l),s=g?0:e.getPrefixCellWidth(r,l),n=e.getPrefixCellLeft(r,l),u=parseFloat(d3.select(this).style("--padding-left")),S=parseFloat(d3.select(this).style("--padding-right")),y=e.getAdjustedPaddings(s,u,S),f=y[0],m=y[1];d3.select(this).style("height",p+"px").style("width",s+"px").style("left",n+"px").style("padding-left",f+"px").style("padding-right",m+"px")}),d3.select(this.element).selectAll(".main-cell:not(.filler-cell)").each(function(){var r=e.getRowIndex(this),l=e.getColumnIndex(this),g=e.getMainCellHeight(r,l),p=e.getMainCellWidth(r,l),s=e.getMainCellLeft(r,l),n=parseFloat(d3.select(this).style("--padding-left")),u=parseFloat(d3.select(this).style("--padding-right")),S=e.getAdjustedPaddings(p,n,u),y=S[0],f=S[1];d3.select(this).style("height",g+"px").style("width",p+"px").style("left",s+"px").style("padding-left",y+"px").style("padding-right",f+"px")}),this.adjustHeaders()},v.prototype.clear=function(){this.viewSync={},d3.select(this.element).html("")},v.prototype.getElementByIndex=function(e,r,l){var g=l===t.aP.Prefix?".prefix-cell":".main-cell";return d3.select(this.element).select('[row-index="'.concat(e,'"] ').concat(g,'[column-index="').concat(r,'"]')).node()},v.prototype.getItemByElement=function(e){if(this.isRenderStable()){var r=this.getRowIndex(e);if(null!=r){var l=this.getColumnIndex(e);if(null!=l){var g=this.isPrefixCell(e);return this.getCellItem(r,l,g)}}}},v.prototype.updateRendering=function(){var e=this,r=[],l=[];this.clearUnusedElements(),this.setGroupLocations(r,l),r.forEach(function(g){return e.insertRowGroup(g)}),l.forEach(function(g){return e.insertCellGroup(g)}),this.scrollToX(this.xPosition),this.adjustHeaders()},v.prototype.clearUnusedElements=function(){var e=this;for(var r in this.viewSync)if(+r<this.renderMeta.visibleRowRange[0]||+r>this.renderMeta.visibleRowRange[1])delete this.viewSync[r];else for(var l in this.viewSync[r])+l>=0&&(+l<this.renderMeta.visibleColumnRange[0]||+l>this.renderMeta.visibleColumnRange[1])&&delete this.viewSync[r][l];d3.select(this.element).selectAll(".row").filter(function(){var g=e.getRowIndex(this);return g<e.renderMeta.visibleRowRange[0]||g>e.renderMeta.visibleRowRange[1]}).remove(),d3.select(this.element).selectAll(".main-cell").filter(function(){var g=e.getColumnIndex(this);return g<e.renderMeta.visibleColumnRange[0]||g>e.renderMeta.visibleColumnRange[1]}).remove()},v.prototype.setGroupLocations=function(e,r){for(var l,g=this.renderMeta.visibleRowRange[0];g<=this.renderMeta.visibleRowRange[1];g++)if(this.viewSync[g]){l=!1;var s=void 0;this.viewSync[g][-1]||r.push({rowIndex:g,columnStart:-1,columnEnd:-1});for(var p=this.renderMeta.visibleColumnRange[0];p<=this.renderMeta.visibleColumnRange[1];p++)this.viewSync[g][p]?s=!1:(s?_.last(r).columnEnd++:(r.push({rowIndex:g,columnStart:p,columnEnd:p}),s=!0),this.viewSync[g][p]=!0)}else for(l?_.last(e).rowEnd++:(e.push({rowStart:g,rowEnd:g}),l=!0),this.viewSync[g]={"-1":!0},p=this.renderMeta.visibleColumnRange[0];p<=this.renderMeta.visibleColumnRange[1];p++)this.viewSync[g][p]=!0},v.prototype.insertRowGroup=function(e){for(var l,r=this,g=d3.select(this.element).selectAll(".row").nodes(),p=g.length-1;p>=0;p--){Q.fF.assert(function(){return r.section===t.p0.Body},"header and footer should never insert additional row groups");var s=this.getRowIndex(g[p]);if(e.rowStart>s){l=g[p];break}}var u,n=this.getRowGroupBindings(e.rowStart,e.rowEnd);l?(l.insertAdjacentHTML("afterend",C.bG.buildMultiple(n)),u=l.nextElementSibling):(this.element.insertAdjacentHTML("afterbegin",C.bG.buildMultiple(n)),u=_.first(this.element.children)),C.bG.attachEventHandlersMultiple(u,n)},v.prototype.insertCellGroup=function(e){var r;Q.fF.assert(function(){return-1!==e.columnStart},"cell group insertion of prefix cells is not supported");for(var g=d3.select(this.element).select('[row-index="'.concat(e.rowIndex,'"]')).select(".scrollable-cells-container"),p=g.node(),s=g.selectAll(".prefix-cell").nodes(),n=g.selectAll(".main-cell").nodes(),u=n.length-1;u>=0;u--){var S=this.getColumnIndex(n[u]);if(e.columnStart>S){r=n[u];break}}!r&&!_.isEmpty(s)&&(r=_.last(s));var f,y=this.getMainBindings(e.rowIndex,e.columnStart,e.columnEnd);r?(r.insertAdjacentHTML("afterend",C.bG.buildMultiple(y)),f=r.nextElementSibling):(p.insertAdjacentHTML("afterbegin",C.bG.buildMultiple(y)),f=_.first(p.children)),C.bG.attachEventHandlersMultiple(f,y)},v.prototype.getRowGroupBindings=function(e,r){for(var l,g=[],p=e;p<=r;p++){var s=this.getRowHeight(p),n=this.getRowTop(p),u=!1,S=0;this.renderMeta.binder.blankRowsEnabled()&&(u=this.renderMeta.rowNavigator.isBlankRow(p),S=this.renderMeta.rowNavigator.numberOfBlankRowsBefore(p));var y={classNames:["row"],attributes:{role:"row","row-index":p.toString()},styleProperties:{position:"absolute",height:s+"px",width:"100%",top:n+"px","pointer-events":"none"},children:[]};u?y.attributes["aria-hidden"]="true":y.attributes["aria-rowindex"]=(this.getAriaRowIndex(p)-S).toString();var f=this.unfrozenRowHeaders?0:this.rowLevelWidthMeasureManager.getHeadersWidth(),m=this.columnWidthMeasureManager.getColumnsWidth(),R=this.getPrefixBindings(p),x=this.getMainBindings(p,this.renderMeta.visibleColumnRange[0],this.renderMeta.visibleColumnRange[1]);!this.unfrozenRowHeaders&&this.renderType===t.y2.Matrix&&(l=y.children).push.apply(l,R);var W={attributes:{role:"presentation"},classNames:["scrollable-cells-viewport"],styleProperties:{position:"absolute","overflow-x":"clip",height:"100%",left:f+"px",right:"0"},children:[{attributes:{role:"presentation"},classNames:["scrollable-cells-container"],styleProperties:{position:"absolute",height:"100%",width:m+"px"},children:this.unfrozenRowHeaders||this.renderType===t.y2.Table?(0,N.__spreadArray)((0,N.__spreadArray)([],R,!0),x,!0):x}]};(this.onObject||this.enableCalculationHighlight)&&this.renderType===t.y2.Matrix&&(W.attributes[V.oy]=(0).toString()),y.children.push(W),g.push(y)}return g},v.prototype.getPrefixBindings=function(e){for(var r=[],l=this.renderMeta.rowNavigator.getHierarchyDepth(),g=0;g<l;g++){var p=this.getPrefixCellBinding(e,g);r.push(p)}return r},v.prototype.getMainBindings=function(e,r,l){for(var g=[],p=r;p<=l;p++){var s=this.getMainCellBinding(e,p);g.push(s)}return g},v.prototype.adjustCellBindingPadding=function(e,r){var l=parseFloat(e.styleProperties["padding-left"]),g=parseFloat(e.styleProperties["padding-right"]);isNaN(l)&&(l=0),isNaN(g)&&(g=0);var p=this.getAdjustedPaddings(r,l,g),n=p[1];e.styleProperties["padding-left"]=p[0]+"px",e.styleProperties["padding-right"]=n+"px",e.styleProperties["--padding-left"]=l.toString(),e.styleProperties["--padding-right"]=g.toString()},v.prototype.getAdjustedPaddings=function(e,r,l){var g=Math.max(e-r,0),p=Math.min(l,g);return[Math.min(r,e),p]},v.prototype.getRowIndex=function(e){var l=c.M.getFirstMatchingAncestor(e,function(p){return p.matches("[row-index]")},this.element,!0);return l&&+l.getAttribute("row-index")},v.prototype.getColumnIndex=function(e){var l=c.M.getFirstMatchingAncestor(e,function(p){return p.matches("[column-index]")},this.element,!0);return l&&+l.getAttribute("column-index")},v.prototype.isPrefixCell=function(e){return!!c.M.getFirstMatchingAncestor(e,function(p){return p.matches(".prefix-cell")},this.element,!0)},v.prototype.getRegion=function(e){return this.isPrefixCell(e)?t.aP.Prefix:t.aP.Main},v.prototype.isFillerCell=function(e){return!!c.M.getFirstMatchingAncestor(e,function(p){return p.matches(".filler-cell")},this.element,!0)},v.prototype.getFirstScrollableCellsContainer=function(){return d3.select(this.element).select(".scrollable-cells-container").node()},v.prototype.getAriaColIndex=function(e,r){return r?e+1:e+1+this.renderMeta.rowNavigator.getHierarchyDepth()},v.prototype.getColumnWidth=function(e,r){return r?this.rowLevelWidthMeasureManager.getLevelWidth(e):this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(e,i.MN)].getColumnWidths()[e%i.MN]},v.prototype.getColumnLeft=function(e,r){if(r)return this.rowLevelWidthMeasureManager.getLevelLeft(e);var g=this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(e,i.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(g)+_.sum(g.getColumnWidths().slice(0,e%i.MN))},v}(),T=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return(0,N.__extends)(e,v),e.prototype.setResizeHandlers=function(r,l){this.columnWidthResizeHandler=r,this.rowLevelWidthResizeHandler=l},e.prototype.adjustHeaders=function(){var r=this;for(var l in d3.select(this.element).selectAll(".primary-columnheader, .secondary-columnheader").each(function(){var n=r.getRowIndex(this),u=r.getColumnIndex(this),S=r.getMainCellWidth(n,u),y=u===r.renderMeta.visibleColumnRange[0],f=d3.select(this).classed("secondary-columnheader")&&!y;if(d3.select(this).classed("visually-hidden",f),y&&!d3.select(this).classed("last-secondary-columnheader")){var m=r.getColumnHeaderOffset(u),R=S-m;d3.select(this).style("transform","translateX(".concat(m,"px)")),d3.select(this).style("width",R+"px")}else f||(d3.select(this).style("transform",null),d3.select(this).style("width",S+"px"))}),this.viewSync)for(var g in this.viewSync[l])if("resizable"!==this.viewSync[l][g]){if("-1"===g)d3.select(this.element).select('[row-index="'.concat(l,'"]')).selectAll(".prefix-cell").each(function(){if(!r.isFillerCell(this)){var n=r.getItemByElement(this);new H(n,this,r.rowLevelWidthResizeHandler,null,r.prefixCellClickHandler,!0)}});else{var p=this.getElementByIndex(l,g,t.aP.Main);if(!this.isFillerCell(p)){var s=this.getItemByElement(p);new H(s,p,this.columnWidthResizeHandler,null,this.mainCellClickHandler,!0)}}this.viewSync[l][g]="resizable"}},e.prototype.getPrefixCellBinding=function(r,l){var g=l,p=r,s=this.rowLevelWidthMeasureManager.getLevelLeft(g),n=this.columnLevelHeightMeasureManager.getLevelHeight(p),u=this.rowLevelWidthMeasureManager.getLevelWidth(g),S=this.renderMeta.rowNavigator.getCorner(g,p),y=this.renderMeta.binder.getCornerCellBinding(S,!1,!0,this.onObject,u);return y.classNames||(y.classNames=[]),y.attributes||(y.attributes={}),y.styleProperties||(y.styleProperties={}),y.classNames.push("prefix-cell"),y.attributes.role="columnheader",y.attributes["column-index"]=l.toString(),y.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),null==y.attributes.tabindex&&(y.attributes.tabindex="0"),y.styleProperties.position="absolute",y.styleProperties.left=s+"px",y.styleProperties.height=n+"px",y.styleProperties.width=u+"px",y.styleProperties["box-sizing"]="border-box",y.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(y,u),y},e.prototype.getMainCellBinding=function(r,l){var g=r,s=this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(l,i.MN)],S=this.columnWidthMeasureManager.getPageColumnLeft(s)+_.sum(s.getColumnWidths().slice(0,l%i.MN));this.unfrozenRowHeaders&&(S+=this.rowLevelWidthMeasureManager.getHeadersWidth());var y=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),f=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(y,g,!0);if(!f)return{attributes:{role:"columnheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!1).toString()},classNames:["main-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:S+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};var x,R=this.renderMeta.columnNavigator.getHierarchyLeafAt(l+1);R&&(x=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(R,g,!0)),x===f&&(x=void 0);var O=this.getMainCellHeight(r,l),W=this.getMainCellWidth(r,l),te=this.renderMeta.binder.getColumnHeaderBinding(f,!1,!0,this.onObject,x,W),ne=this.renderMeta.columnNavigator.isLeaf(f),de=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(f),le=this.renderMeta.columnNavigator.getNodeLeafCount(f)-(l-de),z=!ne&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(f)===l,se=!ne&&this.renderMeta.columnNavigator.getIndexOfFirstLeaf(f)!==l,ve=se&&1===le;return te.classNames||(te.classNames=[]),te.attributes||(te.attributes={}),te.styleProperties||(te.styleProperties={}),te.classNames.push("main-cell"),z&&te.classNames.push("primary-columnheader"),se&&te.classNames.push("secondary-columnheader"),ve&&te.classNames.push("last-secondary-columnheader"),te.attributes.role="columnheader",te.attributes["column-index"]=l.toString(),te.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),te.attributes.tabindex="0",te.styleProperties.position="absolute",te.styleProperties.left=S+"px",te.styleProperties.width=W+"px",te.styleProperties.height=O+"px",te.styleProperties["box-sizing"]="border-box",te.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(te,W),te},e.prototype.getAriaRowIndex=function(r){return r+1},e.prototype.getRowHeight=function(r){return this.columnLevelHeightMeasureManager.getLevelHeight(r)},e.prototype.getRowTop=function(r){return this.columnLevelHeightMeasureManager.getLevelTop(r)},e.prototype.getPrefixCellWidth=function(r,l){return this.rowLevelWidthMeasureManager.getLevelWidth(l)},e.prototype.getPrefixCellHeight=function(r,l){return this.columnLevelHeightMeasureManager.getLevelHeight(r)},e.prototype.getPrefixCellLeft=function(r,l){return this.rowLevelWidthMeasureManager.getLevelLeft(l)},e.prototype.getMainCellWidth=function(r,l){var g=this,p=r,s=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),n=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(s,p),u=this.renderMeta.columnNavigator.getIndexOfFirstLeaf(n),S=this.renderMeta.columnNavigator.getNodeLeafCount(n)-(l-u),y=this.columnWidthMeasureManager.getLastMeasuredIndex(),f=Math.min(l+S-1,y);return _.sum(_.range(l,f+1).map(function(m){return g.columnWidthMeasureManager.getColumnWidth(m)}))},e.prototype.getMainCellHeight=function(r,l){var g=this,p=r,s=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),n=this.renderMeta.columnNavigator.getLeafAncestorAtLevel(s,p),u=(0,ae.zG)(n,this.renderMeta.columnNavigator);return _.sum(_.range(r,p+u-1+1).map(function(y){return g.columnLevelHeightMeasureManager.getLevelHeight(y)}))},e.prototype.getMainCellLeft=function(r,l){var p=this.columnWidthMeasureManager.getPageColumns()[i.yl.getPageIndex(l,i.MN)];return this.columnWidthMeasureManager.getPageColumnLeft(p)+_.sum(p.getColumnWidths().slice(0,l%i.MN))},e.prototype.getCellItem=function(r,l,g){if(g)return this.renderMeta.rowNavigator.getCorner(l,r);var n=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.columnNavigator.getLeafAncestorAtLevel(n,r)},e.prototype.getColumnHeaderOffset=function(r){return this.renderMeta.viewport.left-this.getColumnLeft(r,!1)},e}(d),U=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return(0,N.__extends)(e,v),e.prototype.scrollToY=function(r){this.element.style.top=-r+"px"},e.prototype.adjustHeaders=function(){if(this.rowHeaderType!==t.xU.Stepped&&!this.repeatRowHeaders){var r=this;d3.select(this.element).selectAll(".primary-rowheader, .secondary-rowheader").each(function(){var l=r.getRowIndex(this),g=r.getColumnIndex(this),p=r.getPrefixCellHeight(l,g),s=l===r.renderMeta.visibleRowRange[0],n=d3.select(this).classed("secondary-rowheader")&&!s;if(d3.select(this).classed("visually-hidden",n),s&&!d3.select(this).classed("last-secondary-rowheader")){var u=r.getRowHeaderOffset(l),S=p-u;d3.select(this).style("transform","translateY(".concat(u,"px)")),d3.select(this).style("height",S+"px")}else n||(d3.select(this).style("transform",null),d3.select(this).style("height",p+"px"))})}},e.prototype.getPrefixCellBinding=function(r,l){var u,g=l,p=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),s=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(p,g,!0),n=this.rowLevelWidthMeasureManager.getLevelLeft(g);if(!s)return{attributes:{role:"rowheader","column-index":l.toString(),"aria-colindex":this.getAriaColIndex(l,!0).toString()},classNames:["prefix-cell","filler-cell","visually-hidden"],styleProperties:{position:"absolute",left:n+"px",height:"0",width:"0","box-sizing":"border-box","--padding-left":"0","--padding-right":"0"}};if(this.renderType===t.y2.Table){var S=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),y=this.renderMeta.columnNavigator.getColumnIndexFromQueryName(this.renderMeta.binder.getRowReferenceQueryName());u=y?this.renderMeta.rowNavigator.getIntersection(S,y):void 0}var m,f=this.renderMeta.rowNavigator.getHierarchyLeafAt(r+1);f&&(m=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(f,g,!0)),m===s&&(m=void 0);var R=this.getPrefixCellWidth(r,l),x=this.getPrefixCellHeight(r,l),O=this.renderMeta.rowNavigator.isLeaf(s),W=this.rowHeaderType===t.xU.Stepped,te=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(s),ne=this.renderMeta.rowNavigator.getNodeLeafCount(s)-(r-te),de=!O&&!W&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(s)===r,le=!O&&!W&&this.renderMeta.rowNavigator.getIndexOfFirstLeaf(s)!==r,z=le&&1===ne,se=this.renderType===t.y2.Table?this.columnWidthMeasureManager.getColumnsWidth():R,ve=se+"px",Ce=this.renderMeta.binder.getRowHeaderBinding(s,!1,this.onObject,!1,u,m,se,this.repeatRowHeaders?p:void 0,le);if(Ce.classNames||(Ce.classNames=[]),Ce.attributes||(Ce.attributes={}),Ce.styleProperties||(Ce.styleProperties={}),Ce.classNames.push("prefix-cell"),de&&Ce.classNames.push("primary-rowheader"),le&&Ce.classNames.push("secondary-rowheader"),z&&Ce.classNames.push("last-secondary-rowheader"),Ce.attributes["column-index"]=l.toString(),Ce.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),Ce.attributes.tabindex="0",Ce.styleProperties.position="absolute",Ce.styleProperties.left=n+"px",Ce.styleProperties.height=x+"px",Ce.styleProperties.width=ve,Ce.styleProperties["box-sizing"]="border-box",Ce.styleProperties["pointer-events"]=this.renderType===t.y2.Table?"none":"auto",this.renderType===t.y2.Table){var M=s===_.first(this.renderMeta.rowNavigator.getHierarchyItems()),a=this.renderMeta.rowNavigator.isLastItem(s,this.renderMeta.rowNavigator.getHierarchyItems()),w=this.renderMeta.binder.getBorderInfo(M,a,!0,!0,!0,t.p0.Body);Ce.styleProperties["--outline-top"]=w.weightTop+1+"px",Ce.styleProperties["--outline-right"]=w.weightRight+1+"px",Ce.styleProperties["--outline-bottom"]=w.weightBottom+1+"px",Ce.styleProperties["--outline-left"]=w.weightLeft+1+"px",Ce.styleProperties["z-index"]="1"}return this.adjustCellBindingPadding(Ce,R),Ce},e.prototype.getMainCellBinding=function(r,l){var g=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),p=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),s=this.renderMeta.rowNavigator.getIntersection(g,p),n=this.getRowHeight(r),u=this.getColumnWidth(l,!1),S=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(S+=this.rowLevelWidthMeasureManager.getHeadersWidth());var y=this.renderMeta.rowNavigator.getHierarchyLeafAt(r+1),f=y&&this.renderMeta.rowNavigator.getIntersection(y,p),m=this.renderMeta.binder.getBodyCellBinding(s,!1,n,u,!0,this.onObject,f,this.showTotalPlaceHolders);return m.classNames||(m.classNames=[]),m.attributes||(m.attributes={}),m.styleProperties||(m.styleProperties={}),m.classNames.push("main-cell"),m.attributes.role="gridcell",m.attributes["column-index"]=l.toString(),m.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),m.attributes.tabindex="0",m.styleProperties.position="absolute",m.styleProperties["box-sizing"]="border-box",m.styleProperties.height="100%",m.styleProperties.width=u+"px",m.styleProperties.left=S+"px",m.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(m,u),m},e.prototype.getAriaRowIndex=function(r){return r+1+this.renderMeta.columnNavigator.getHierarchyDepth()},e.prototype.getRowHeight=function(r){return this.rowHeightMeasureManager.getPageRows()[i.yl.getPageIndex(r,i.hw)].getRowHeights()[r%i.hw]},e.prototype.getRowTop=function(r){var g=this.rowHeightMeasureManager.getPageRows()[i.yl.getPageIndex(r,i.hw)];return this.rowHeightMeasureManager.getPageRowTop(g)+_.sum(g.getRowHeights().slice(0,r%i.hw))},e.prototype.getPrefixCellWidth=function(r,l){var g=this;if(this.rowHeaderType===t.xU.Stepped)return this.rowLevelWidthMeasureManager.getHeadersWidth();var p=l,s=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),n=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(s,p),u=(0,ae.zG)(n,this.renderMeta.rowNavigator);return _.sum(_.range(p,p+u-1+1).map(function(y){return g.rowLevelWidthMeasureManager.getLevelWidth(y)}))},e.prototype.getPrefixCellHeight=function(r,l){var g=this;if(this.renderType===t.y2.Table||this.rowHeaderType===t.xU.Stepped)return this.rowHeightMeasureManager.getRowHeight(r);var p=l,s=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),n=this.renderMeta.rowNavigator.getLeafAncestorAtLevel(s,p),u=this.renderMeta.rowNavigator.getIndexOfFirstLeaf(n),S=this.renderMeta.rowNavigator.getNodeLeafCount(n)-(r-u),y=this.rowHeightMeasureManager.getLastMeasuredIndex(),f=Math.min(r+S-1,y);return _.sum(_.range(r,f+1).map(function(m){return g.rowHeightMeasureManager.getRowHeight(m)}))},e.prototype.getPrefixCellLeft=function(r,l){return this.getColumnLeft(l,!0)},e.prototype.getMainCellWidth=function(r,l){return this.getColumnWidth(l,!1)},e.prototype.getMainCellHeight=function(r,l){return this.getRowHeight(r)},e.prototype.getMainCellLeft=function(r,l){return this.getColumnLeft(l,!1)},e.prototype.getCellItem=function(r,l,g){if(g){var p=l,s=this.renderMeta.rowNavigator.getHierarchyLeafAt(r);return this.renderMeta.rowNavigator.getLeafAncestorAtLevel(s,p)}var n=this.renderMeta.rowNavigator.getHierarchyLeafAt(r),u=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(n,u)},e.prototype.getRowHeaderOffset=function(r){return this.renderMeta.viewport.top-this.getRowTop(r)},e}(d),D=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return(0,N.__extends)(e,v),e.prototype.adjustHeaders=function(){for(var g=this.renderMeta.columnNavigator.getHierarchyDepth()+this.renderMeta.rowNavigator.getHierarchyLeafCount()+this.renderMeta.rowNavigator.getFloatingHierarchyLeafCount(),p=0,s=d3.select(this.element).selectAll(".row").nodes().reverse();p<s.length;p++)d3.select(s[p]).attr("aria-rowindex",g--)},e.prototype.getPrefixCellBinding=function(r,l){var g=this.rowHeightMeasureManager.getFloatingRowHeight(r),p=this.rowLevelWidthMeasureManager.getHeadersWidth(),s=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r),n=this.renderMeta.binder.getRowHeaderBinding(s,!1,this.onObject,!0,void 0,void 0,p);return n.classNames||(n.classNames=[]),n.attributes||(n.attributes={}),n.styleProperties||(n.styleProperties={}),n.classNames.push("prefix-cell"),n.attributes.role="rowheader",n.attributes["column-index"]=l.toString(),n.attributes["aria-colindex"]=this.getAriaColIndex(l,!0).toString(),n.attributes.tabindex="0",n.styleProperties.position="absolute",n.styleProperties.left="0",n.styleProperties.height=g+"px",n.styleProperties.width=p+"px",n.styleProperties["box-sizing"]="border-box",n.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(n,p),n},e.prototype.getMainCellBinding=function(r,l){var g=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r),p=this.renderMeta.columnNavigator.getHierarchyLeafAt(l),s=this.renderMeta.rowNavigator.getIntersection(g,p),n=this.getRowHeight(r),u=this.getColumnWidth(l,!1),S=this.getColumnLeft(l,!1);this.unfrozenRowHeaders&&(S+=this.rowLevelWidthMeasureManager.getHeadersWidth());var y=this.renderMeta.binder.getBodyCellBinding(s,!1,n,u,!0,this.onObject,void 0,this.showTotalPlaceHolders);return y.classNames||(y.classNames=[]),y.attributes||(y.attributes={}),y.styleProperties||(y.styleProperties={}),y.classNames.push("main-cell"),y.attributes.role="gridcell",y.attributes["column-index"]=l.toString(),y.attributes["aria-colindex"]=this.getAriaColIndex(l,!1).toString(),y.attributes.tabindex="0",y.styleProperties.position="absolute",y.styleProperties["box-sizing"]="border-box",y.styleProperties.height="100%",y.styleProperties.width=u+"px",y.styleProperties.left=S+"px",y.styleProperties["pointer-events"]="auto",this.adjustCellBindingPadding(y,u),y},e.prototype.getAriaRowIndex=function(r){return-1},e.prototype.getRowHeight=function(r){return this.rowHeightMeasureManager.getFloatingPageRow().getRowHeights()[r]},e.prototype.getRowTop=function(r){var l=this.rowHeightMeasureManager.getFloatingPageRow();return this.rowHeightMeasureManager.getPageRowTop(l)+_.sum(l.getRowHeights().slice(0,r))},e.prototype.getPrefixCellWidth=function(r,l){return this.rowLevelWidthMeasureManager.getHeadersWidth()},e.prototype.getPrefixCellHeight=function(r,l){return this.rowHeightMeasureManager.getFloatingRowHeight(r)},e.prototype.getPrefixCellLeft=function(r,l){return 0},e.prototype.getMainCellWidth=function(r,l){return this.getColumnWidth(l,!1)},e.prototype.getMainCellHeight=function(r,l){return this.getRowHeight(r)},e.prototype.getMainCellLeft=function(r,l){return this.getColumnLeft(l,!1)},e.prototype.getCellItem=function(r,l,g){if(g)return this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r);var p=this.renderMeta.rowNavigator.getFloatingHierarchyLeafAt(r),s=this.renderMeta.columnNavigator.getHierarchyLeafAt(l);return this.renderMeta.rowNavigator.getIntersection(p,s)},e}(d),I=function(v){return v[v.Default=0]="Default",v[v.ColumnResizing=1]="ColumnResizing",v[v.RowLevelResizing=2]="RowLevelResizing",v}({}),q=function(){function v(e,r,l,g,p,s,n,u,S,y,f,m,R,x,O){var W=this;this.hostServices=u,this.visualStyle=S,this.showTotalPlaceHolders=R,this.subSelectionHelper=x,this.showAsTableNativeMenu=O,this.unfrozenRowHeaders=!1,this.isA11yTable=g,this.isA11yMatrix=p,this.renderIteration=0,this.prevHorizontalWheelTime=0,this.onObject=s,this.enableCalculationHighlighting=n,this.sizeManager=r,this.scrollingEnabled=l.scrollingEnabled;var te=u.getLocalizedString(j.iC),ne=u.getLocalizedString(j.Hw),de=u.getLocalizedString(j.dm),le=u.getLocalizedString(j.Ds),z=m?"interactive-grid":"",se="<div role='document' ignore-focus-loss='true' style='position:relative'>\n                    <button class='scrollUp visually-hidden' tabindex='-1'>".concat(te,"</button>\n                    <button class='scrollDown visually-hidden' tabindex='-1'>").concat(ne,"</button>\n                    <button class='scrollLeft visually-hidden' tabindex='-1'>").concat(de,"</button>\n                    <button class='scrollRight visually-hidden' tabindex='-1'>").concat(le,"</button>\n                    <div role='grid' class='").concat(z," innerContainer' style='position:absolute;left:0;top:0;right:0;bottom:0'>\n                        <div role='presentation' class='top-viewport' drag-resize-disabled='true' style='position:absolute;overflow:clip;left:0;right:0;top:0'></div>\n                        <div role='presentation' class='mid-viewport' style='position:absolute;overflow:hidden;left:0;top:0;right:0;bottom:0;box-sizing:border-box'>\n                            <div role='presentation'></div>\n                        </div>\n                        <div role='presentation' class='bot-viewport' style='position:absolute;overflow:clip;left:0;right:0'></div>\n                    </div>\n                    <div class='measureElement' style='position:absolute;left:0;top:0;visibility:hidden'></div>\n                </div>");e.insertAdjacentHTML("beforeend",se),this.element=e.lastChild,this.innerContainer=this.element.querySelector(".innerContainer"),this.measureElement=this.element.querySelector(".measureElement"),this.topViewport=this.element.querySelector(".top-viewport"),this.midViewport=this.element.querySelector(".mid-viewport"),this.innerBodyCellContainer=this.midViewport.firstElementChild,this.botViewport=this.element.querySelector(".bot-viewport"),(this.onObject||this.enableCalculationHighlighting)&&(this.topViewport.setAttribute(V.oy,(0).toString()),this.midViewport.setAttribute(V.oy,(0).toString()),this.botViewport.setAttribute(V.oy,(0).toString())),d3.select(this.element).select(".scrollUp").on("click",function(){var ve,be;null===(ve=W.rowScrollbar)||void 0===ve||ve.scrollPageUp();var Ce=W.getViewport(),M=i._E.getVisibleRange(Ce.top,Ce.height,W.rowHeightMeasureManager,i.hw,null===(be=W.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());y(M.firstLeafIndex,M.lastLeafIndex)}),d3.select(this.element).select(".scrollDown").on("click",function(){var ve,be;null===(ve=W.rowScrollbar)||void 0===ve||ve.scrollPageDown();var Ce=W.getViewport(),M=i._E.getVisibleRange(Ce.top,Ce.height,W.rowHeightMeasureManager,i.hw,null===(be=W.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());y(M.firstLeafIndex,M.lastLeafIndex)}),d3.select(this.element).select(".scrollLeft").on("click",function(){var ve,be;null===(ve=W.columnScrollbar)||void 0===ve||ve.scrollPageUp();var Ce=W.getViewport(),M=i.sW.getVisibleRange(Ce.left,Ce.width,W.columnWidthMeasureManager,i.MN,null===(be=W.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());f(M.firstLeafIndex,M.lastLeafIndex)}),d3.select(this.element).select(".scrollRight").on("click",function(){var ve,be;null===(ve=W.columnScrollbar)||void 0===ve||ve.scrollPageDown();var Ce=W.getViewport(),M=i.sW.getVisibleRange(Ce.left,Ce.width,W.columnWidthMeasureManager,i.MN,null===(be=W.rowHeightMeasureManager)||void 0===be?void 0:be.getLastMeasuredIndex());f(M.firstLeafIndex,M.lastLeafIndex)}),this.options=l,this.initializeScrollbars(),this.options.whitespaceClickHandler&&this.innerContainer.addEventListener("click",function(ve){return W.onClick(ve)}),this.options.columnResizingEnabled&&(this.columnWidthResizeHandler=new X(this,!0,!0)),this.options.rowLevelResizingEnabled&&(this.rowLevelWidthResizeHandler=new F(this,!0)),$(this.element).on(pe.BZ,function(){return W.onFocusManagerEnter()}),this.element.addEventListener("keydown",function(ve){return W.onKeyDown(ve)}),this.keyUpState=I.Default,this.element.addEventListener("keyup",function(){return W.onKeyUp()}),this.focusManager=new b(function(){return W.onFocusChanged()},this.isA11yTable,this.isA11yMatrix),this.createRenderers(),this.setSteppedLayout(!1),l.scrollingEnabled&&this.attachScrollEventHandlers()}return v.prototype.onShowTotalPlaceHoldersChanged=function(e){e!==this.showTotalPlaceHolders&&(this.showTotalPlaceHolders=e,this.topRenderer&&(this.topRenderer.showTotalPlaceHolders=e),this.midRenderer&&(this.midRenderer.showTotalPlaceHolders=e),this.botRenderer&&(this.botRenderer.showTotalPlaceHolders=e))},v.prototype.updateOptions=function(e){this.options=e},v.prototype.attachScrollEventHandlers=function(){var e=this;ee.l.runOutsideAngular(function(){e.midViewport.style.overflowY="auto",e.midViewport.addEventListener("scroll",function(){return e.scrollTo(null,e.midViewport.scrollTop)}),e.innerContainer.addEventListener("wheel",function(r){var l;performance.now()-e.prevHorizontalWheelTime>100&&(e.propagateWheel=void 0),clearInterval(e.momentumScrollHandle);var g=!r.shiftKey&&Math.abs(r.deltaX)<=Math.abs(r.deltaY);if(!e.propagateWheel&&!g){var p=r.shiftKey&&Math.abs(r.deltaX)<=Math.abs(r.deltaY)?r.deltaY:r.deltaX,s=Math.max(Math.min(p,v.ScrollDeltaMax),-v.ScrollDeltaMax),n=e.scrollBy(s,0);null!==(l=e.propagateWheel)&&void 0!==l||(e.propagateWheel=!n),e.propagateWheel||(r.stopPropagation(),r.preventDefault()),e.prevHorizontalWheelTime=performance.now()}}),e.innerContainer.addEventListener("touchstart",function(r){clearInterval(e.momentumScrollHandle),e.propagateTouch=r.touches.length>1||void 0,e.touchPreviousX=r.touches[0].clientX,e.touchPreviousY=r.touches[0].clientY}),e.innerContainer.addEventListener("touchmove",function(r){var l,g;if(!e.propagateTouch){var p=e.touchPreviousX-r.touches[0].clientX,s=e.touchPreviousY-r.touches[0].clientY;if(null!==(l=e.propagateTouch)&&void 0!==l||(e.propagateTouch=0===p||Math.abs(p)<=Math.abs(s)||void 0),!e.propagateTouch){e.touchDeltaX=Math.max(Math.min(p,v.ScrollDeltaMax),-v.ScrollDeltaMax),e.touchPreviousX=r.touches[0].clientX,e.touchPreviousY=r.touches[0].clientY;var n=e.scrollBy(e.touchDeltaX,0);null!==(g=e.propagateTouch)&&void 0!==g||(e.propagateTouch=!n),e.propagateTouch||(r.stopPropagation(),r.preventDefault())}}}),e.innerContainer.addEventListener("touchend",function(){if(!e.propagateTouch){var r=e.renderIteration;e.momentumScrollHandle=setInterval(function(l){l[0]+=1/120;var g=e.touchDeltaX*(1-d3.easeCircleOut(l[0]));r!==e.renderIteration||l[0]>=120||Math.abs(g)<1?clearInterval(e.momentumScrollHandle):e.scrollBy(g,0)},1e3/60,[0])}})})},v.prototype.onFocusManagerEnter=function(){var e;null===(e=this.hostServices.telemetry())||void 0===e||e.trace(2,"TableKeyboardFocused"),this.updateFocus(),this.getFocusedCell(this.focusManager.CurrentFocus).focus({preventScroll:!0})},v.prototype.onKeyUp=function(){switch(this.keyUpState){case I.ColumnResizing:this.columnWidthResizeHandler.onEndResize(),this.keyUpState=I.Default;break;case I.RowLevelResizing:this.rowLevelWidthResizeHandler.onEndResize(),this.keyUpState=I.Default;break;case I.Default:break;default:Q.fF.assertNever(this.keyUpState)}},v.prototype.onKeyDown=function(e){var r=this;if(this.renderLock||this.keyboardLock)return e.stopPropagation(),void e.preventDefault();this.updateFocus();var l=e.code||e.key,g=e.shiftKey,p=oe.M.isCtrlOrMeta(e),s=e.altKey,n=this.isA11yTable,u=this.isA11yMatrix;if("Escape"!==l&&"Esc"!==l&&"Tab"!==l){if("ArrowRight"===l||"Right"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(g){if(r.focusManager.CurrentFocus.columnHeader&&r.columnWidthResizeHandler)return r.columnWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.columnWidthResizeHandler.onResize({x:1,y:0}),void(r.keyUpState=I.ColumnResizing);if(r.focusManager.CurrentFocus.cornerCell&&r.columnWidthResizeHandler)return r.rowLevelWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.rowLevelWidthResizeHandler.onResize({x:1,y:0}),void(r.keyUpState=I.RowLevelResizing);r.options.rowHeaderExpandCollapseHandler&&r.focusManager.CurrentFocus.rowHeader&&1===r.rowNavigator.getExpansionState(r.focusManager.CurrentFocus.item)&&r.options.rowHeaderExpandCollapseHandler(r.focusManager.CurrentFocus.item,!1)}else r.focusManager.moveFocus("right",p,n,u)});if("ArrowLeft"===l||"Left"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(g){if(r.focusManager.CurrentFocus.columnHeader&&r.columnWidthResizeHandler)return r.columnWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.columnWidthResizeHandler.onResize({x:-1,y:0}),void(r.keyUpState=I.ColumnResizing);if(r.focusManager.CurrentFocus.cornerCell&&r.columnWidthResizeHandler)return r.rowLevelWidthResizeHandler.onStartResize(r.focusManager.CurrentFocus.item),r.rowLevelWidthResizeHandler.onResize({x:-1,y:0}),void(r.keyUpState=I.RowLevelResizing);r.options.rowHeaderExpandCollapseHandler&&r.focusManager.CurrentFocus.rowHeader&&0===r.rowNavigator.getExpansionState(r.focusManager.CurrentFocus.item)&&r.options.rowHeaderExpandCollapseHandler(r.focusManager.CurrentFocus.item,!0)}else r.focusManager.moveFocus("left",p,n,u)});if("ArrowUp"===l||"Up"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(g&&!p){if(n){var S=r.focusManager.CurrentFocus;r.focusManager.moveFocus("up",p,n,u);var y=r.focusManager.CurrentFocus;r.selectFocus(e,S),r.selectFocus(e,y)}}else r.focusManager.moveFocus("up",p,n,u)});if("ArrowDown"===l||"Down"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){if(g&&!p){if(n){var S=r.focusManager.CurrentFocus;r.focusManager.moveFocus("down",p,n,u);var y=r.focusManager.CurrentFocus;r.selectFocus(e,S),r.selectFocus(e,y)}}else r.focusManager.moveFocus("down",p,n,u)});if("Home"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("home",p,n,u)});if("End"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("end",p,n,u)});if(this.focusManager.CurrentFocus&&(this.focusManager.CurrentFocus.bodyCell||this.focusManager.CurrentFocus.rowHeader)){if("PageDown"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("pagedown",p,n,u,r.getNumberOfVisibleRows())});if("PageUp"===l)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.focusManager.moveFocus("pageup",p,n,u,r.getNumberOfVisibleRows())})}if("F10"===l&&g)return p?void 0:(e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){r.showContextMenuForFocus(e)}));if("Enter"===l||"Space"===l||"Spacebar"===l||" "===l)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){r.selectFocus(e,r.focusManager.CurrentFocus)});if("KeyO"===l&&p&&s)return e.preventDefault(),e.stopPropagation(),this.runIfFrameReady(function(){r.activateCellContent()});if(("KeyC"===l||"c"===l)&&p&&g)return e.stopPropagation(),e.preventDefault(),this.runIfFrameReady(function(){r.options.whitespaceClickHandler(null,!0)})}},v.prototype.runIfFrameReady=function(e){return(0,N.__awaiter)(this,void 0,void 0,function(){return(0,N.__generator)(this,function(r){switch(r.label){case 0:return this.keyboardLock=!0,e(),[4,this.requestAnimationFrameAsync()];case 1:return r.sent(),this.keyboardLock=!1,[2]}})})},v.prototype.notifyVisual=function(e){e.bodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item,e.bodyCell.rowIndex):e.columnHeader&&this.options.columnHeaderFocusHandler?this.options.columnHeaderFocusHandler(e.item):e.rowHeader&&this.options.rowHeaderFocusHandler?this.options.rowHeaderFocusHandler(e.item):e.cornerCell&&this.options.cornerCellFocusHandler?this.options.cornerCellFocusHandler(e.item):e.floatingBodyCell&&this.options.bodyCellFocusHandler?this.options.bodyCellFocusHandler(e.item):void 0!==e.floatingRowHeader&&this.options.rowHeaderFocusHandler&&this.options.rowHeaderFocusHandler(e.item)},v.prototype.setUnfrozenRowHeaders=function(e){this.unfrozenRowHeaders=e,this.topRenderer.setUnfrozenRowHeaders(e),this.midRenderer.setUnfrozenRowHeaders(e),this.botRenderer.setUnfrozenRowHeaders(e)},v.prototype.setRepeatRowHeaders=function(e){this.topRenderer.setRepeatRowHeaders(e),this.midRenderer.setRepeatRowHeaders(e),this.botRenderer.setRepeatRowHeaders(e)},v.prototype.onFocusChanged=function(){var e,r=this.focusManager.CurrentFocus;Q.fF.assertValue(r,"No current focus"),this.notifyVisual(r);var g,p,s,n,u,S,ne,de,l=this.getViewport();if(r.bodyCell)r.bodyCell.columnIndex>=0&&(n=r.bodyCell.columnIndex),g=r.bodyCell.rowIndex;else if(r.rowHeader){var y=i._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager),f=(0,ae.hG)(r.item,this.rowNavigator),m=(0,ae.O3)(r.item,this.rowNavigator);f<=y.firstLeafIndex||m-f+1>=y.lastLeafIndex-y.firstLeafIndex+1?(g=f,p=!1):(g=Math.min(m,this.rowHeightMeasureManager.getLastMeasuredIndex()),p=!0)}else if(r.columnHeader){var O=i.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager);f=(0,ae.hG)(r.item,this.columnNavigator),m=(0,ae.O3)(r.item,this.columnNavigator),f<=O.firstLeafIndex||m-f+1>=O.lastLeafIndex-O.firstLeafIndex+1?(n=f,S=!1):(n=Math.min(m,this.columnWidthMeasureManager.getLastMeasuredIndex()),S=!0)}else r.floatingBodyCell&&(n=r.floatingBodyCell.columnIndex);if(void 0!==g&&this.rowScrollbar.visible&&(y=i._E.getVisibleRange(l.top,l.height,this.rowHeightMeasureManager))&&(g<=y.firstLeafIndex?s={rowIndex:g,visibleHeight:Number.MAX_VALUE,alignBottom:p??!1}:g>=y.lastLeafIndex&&(s={rowIndex:g,visibleHeight:Number.MAX_VALUE,alignBottom:p??!0})),void 0!==n&&this.columnScrollbar.visible&&(O=i.sW.getVisibleRange(l.left,l.width,this.columnWidthMeasureManager))&&(n<=O.firstLeafIndex?u=this.unfrozenRowHeaders&&0===n&&this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin>0?null:{columnIndex:n,visibleWidth:Number.MAX_VALUE,alignRight:S??!1}:n>=O.lastLeafIndex&&(u={columnIndex:n,visibleWidth:Number.MAX_VALUE,alignRight:S??!0})),s&&(ne=i._E.getOffset(s,this.rowHeightMeasureManager),s.alignBottom&&(ne-=this.rowScrollbar.viewSize)),u&&(de=i.sW.getOffset(u,this.columnWidthMeasureManager),u.alignRight&&(de-=this.columnScrollbar.viewSize),this.unfrozenRowHeaders&&(de+=this.rowLevelWidthMeasureManager.getHeadersWidth())),this.unfrozenRowHeaders&&(r.cornerCell||r.rowHeader||r.floatingRowHeader)){var le=this.getFocusedCell(r),z=le.offsetLeft,se=le.offsetWidth;de=z<this.columnScrollbar.viewMin||se>this.columnScrollbar.viewSize?z:z+se>this.columnScrollbar.viewMin+this.columnScrollbar.viewSize?z-this.columnScrollbar.viewSize:null}this.scrollTo(de,ne),null===(e=this.getFocusedCell(r))||void 0===e||e.focus({preventScroll:!0})},v.prototype.getFocusedCell=function(e){var r,l;if(e.bodyCell)return-1===e.bodyCell.columnIndex?this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,0,t.aP.Prefix):this.midRenderer.getElementByIndex(e.bodyCell.rowIndex,e.bodyCell.columnIndex,t.aP.Main);if(e.columnHeader){var g=e.item,p=this.columnNavigator.getLevel(g),s=void 0;return s=this.isA11yTable?this.columnNavigator.getIndexOfFirstLeaf(g):null!==(r=this.rowNavigator.getLeafIndex(g))&&void 0!==r?r:this.rowNavigator.getIndexOfFirstLeaf(g),this.topRenderer.getElementByIndex(p,s,t.aP.Main)}if(e.rowHeader){var n=e.item;return p=null!==(l=this.columnNavigator.getLeafIndex(n))&&void 0!==l?l:this.columnNavigator.getIndexOfFirstLeaf(n),s=this.steppedLayout?0:this.rowNavigator.getLevel(n),this.midRenderer.getElementByIndex(p,s,t.aP.Prefix)}return e.cornerCell?this.topRenderer.getElementByIndex(e.cornerCell.columnLevel,e.cornerCell.rowLevel,t.aP.Prefix):e.floatingBodyCell?this.botRenderer.getElementByIndex(e.floatingBodyCell.rowIndex,e.floatingBodyCell.columnIndex,t.aP.Main):null!=e.floatingRowHeader?this.botRenderer.getElementByIndex(e.floatingRowHeader,0,t.aP.Prefix):void Q.fF.assertFail("Unexpected focused item")},v.prototype.getCurrentFocusBoundingRect=function(){var e=document.activeElement;if(e){var r=e.getBoundingClientRect();return{top:r.top,left:r.left,width:r.width,height:r.height}}return{top:0,left:0,width:0,height:0}},v.prototype.selectFocus=function(e,r){var l=r.item,g=this.createMouseEvent(e);r.bodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,g,r.bodyCell.rowIndex,t.p0.Body):r.floatingBodyCell?this.options.bodyCellClickHandler&&this.options.bodyCellClickHandler(l,g,void 0,t.p0.Footer):r.rowHeader||void 0!==r.floatingRowHeader?this.options.rowHeaderClickHandler&&this.options.rowHeaderClickHandler(l,g):r.columnHeader?this.options.columnHeaderClickHandler&&this.options.columnHeaderClickHandler(l,g):r.cornerCell?this.options.cornerCellClickHandler&&this.options.cornerCellClickHandler(l,g):Q.fF.assertFail("Unexpected focused item")},v.prototype.activateCellContent=function(){var r=document.activeElement;if(r&&this.focusManager.CurrentFocus&&this.options.cellContentActivationHandler){var l=this.createSimpleMouseClickEvent();this.options.cellContentActivationHandler(r,l)}},v.prototype.createSimpleMouseClickEvent=function(){var e=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:e.left,clientY:e.top,ctrlKey:!1,metaKey:!1,shiftKey:!1,altKey:!1})},v.prototype.createMouseEvent=function(e){var r=this.getCurrentFocusBoundingRect();return new MouseEvent("click",{clientX:r.left,clientY:r.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey})},v.prototype.showContextMenuForFocus=function(e){var r,l=this.focusManager.CurrentFocus;if(-1!==(null===(r=l.bodyCell)||void 0===r?void 0:r.columnIndex)){Q.fF.assertValue(l&&l.item,"Keyboard Selection triggered with no focused cell");var g=l.item,p=this.getCurrentFocusBoundingRect(),s=new MouseEvent("contextmenu",{clientX:p.left,clientY:p.top,ctrlKey:e.ctrlKey,metaKey:e.metaKey});l.bodyCell||l.floatingBodyCell?this.options.bodyCellContextMenuHandler&&this.options.bodyCellContextMenuHandler(g,s):l.rowHeader||void 0!==l.floatingRowHeader?this.options.rowHeaderContextMenuHandler&&this.options.rowHeaderContextMenuHandler(g,s):l.columnHeader?this.options.columnHeaderContextMenuHandler&&this.options.columnHeaderContextMenuHandler(g,s):l.cornerCell?this.options.cornerCellContextMenuHandler&&this.options.cornerCellContextMenuHandler(g,s):Q.fF.assertFail("Unexpected focused item")}},v.prototype.onClick=function(e){var r=this.rowLevelWidthMeasureManager.getHeadersWidth()+this.columnWidthMeasureManager.getColumnsWidth(),l=this.columnLevelHeightMeasureManager.getHeadersHeight()+this.rowHeightMeasureManager.getRowsHeight()+this.rowHeightMeasureManager.getFloatingRowHeights();if(!(r>=this.width&&l>=this.height)){var g=(0,G.ut)(this.element,e);(g.x>r||g.y>l)&&this.options.whitespaceClickHandler(e)}},v.prototype.initializeScrollbars=function(){var e=this;this.columnScrollbar=new K.Xg(this.element,0,!0,this.options.onScroll),this.columnScrollbar.smallIncrement=20,this.columnScrollbar.min=0,this.columnScrollbar.height=(0,P.S)(o.zf),this.columnScrollbar.element.style.position="absolute",this.columnScrollbar.element.style.left=this.isA11yTable?"1px":"0",this.columnScrollbar.element.style.bottom="0",this.columnScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar=new K.AT(this.element,0,!0,this.options.onScroll),this.rowScrollbar.smallIncrement=20,this.rowScrollbar.min=0,this.rowScrollbar.width=(0,P.S)(o.zf),this.rowScrollbar.element.style.position="absolute",this.rowScrollbar.element.style.right="0",this.rowScrollbar.element.style.top="0",this.rowScrollbar._onscroll.push(function(){clearInterval(e.momentumScrollHandle),e.refresh()}),this.rowScrollbar.element.setAttribute("aria-hidden","true"),this.columnScrollbar.element.setAttribute("aria-hidden","true")},v.prototype.setSteppedLayout=function(e){if(e!==this.steppedLayout){this.steppedLayout=e;var r=e?t.xU.Stepped:t.xU.Blocked;this.columnWidthMeasureManager=new i.Sv(this.measureElement,this.sizeManager),this.rowLevelWidthMeasureManager=this.steppedLayout?new i.FA(this.measureElement,this.sizeManager):new i.DX(this.measureElement,this.sizeManager),this.rowHeightMeasureManager=this.steppedLayout?new i.AV(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager):new i.DJ(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.columnLevelHeightMeasureManager=new i.sB(this.measureElement,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.sizeManager),this.topRenderer.updateMeasureManagers(r,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.midRenderer.updateMeasureManagers(r,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.botRenderer.updateMeasureManagers(r,this.rowHeightMeasureManager,this.columnWidthMeasureManager,this.rowLevelWidthMeasureManager,this.columnLevelHeightMeasureManager),this.focusManager.updateMeasureManagers(this.rowHeightMeasureManager,this.columnWidthMeasureManager),this.clearMeasurement()}},v.prototype.createRenderers=function(){var e=this,r=this.isA11yTable?t.y2.Table:t.y2.Matrix;this.topRenderer=new T(this.topViewport,this.options.cornerCellClickHandler,this.options.cornerCellContextMenuHandler,this.options.columnHeaderClickHandler,this.options.columnHeaderContextMenuHandler,this.options.columnHeaderInteractionHandler,t.p0.Header,r,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.topRenderer.setResizeHandlers(this.columnWidthResizeHandler,this.rowLevelWidthResizeHandler),this.midRenderer=new U(this.innerBodyCellContainer,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,t.p0.Body,r,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu),this.botRenderer=new D(this.botViewport,this.options.rowHeaderClickHandler,this.options.rowHeaderContextMenuHandler,this.options.bodyCellClickHandler,this.options.bodyCellContextMenuHandler,this.options.bodyCellInteractionHandler,t.p0.Footer,r,this.onObject,this.enableCalculationHighlighting,function(){return!e.renderLock},this.showTotalPlaceHolders,this.showAsTableNativeMenu)},v.prototype.setWidth=function(e){this.width=e,this.element.style.width=(0,P.S)(this.width),this.columnScrollbar.invalidateArrange()},v.prototype.setHeight=function(e){this.height=e,this.element.style.height=(0,P.S)(this.height),this.rowScrollbar.invalidateArrange()},v.prototype.getWidth=function(){return this.width},v.prototype.getHeight=function(){return this.height},v.prototype.setClassName=function(e){this.element.className=e},v.prototype.setColumnNavigator=function(e){this.columnNavigator=e,this.focusManager.columnNavigator=e},v.prototype.setRowNavigator=function(e){this.rowNavigator=e,this.focusManager.rowNavigator=e},v.prototype.setBinder=function(e){this.binder=e},v.prototype.getSteppedLayout=function(){return this.steppedLayout},v.prototype.getColumnNavigator=function(){return this.columnNavigator},v.prototype.getRowNavigator=function(){return this.rowNavigator},v.prototype.getSizeManager=function(){return this.sizeManager},v.prototype.getBinder=function(){return this.binder},v.prototype.getColumnWidthMeasureManager=function(){return this.columnWidthMeasureManager},v.prototype.getRowHeightMeasureManager=function(){return this.rowHeightMeasureManager},v.prototype.getColumnLevelHeightMeasureManager=function(){return this.columnLevelHeightMeasureManager},v.prototype.getRowLevelWidthMeasureManager=function(){return this.rowLevelWidthMeasureManager},v.prototype.getTopRenderer=function(){return this.topRenderer},v.prototype.getMidRenderer=function(){return this.midRenderer},v.prototype.getBotRenderer=function(){return this.botRenderer},v.prototype.getViewport=function(){var e=this.columnScrollbar.viewMin,r=this.rowScrollbar.viewMin,l=this.columnScrollbar.viewSize,g=this.rowScrollbar.viewSize;return this.unfrozenRowHeaders&&(e=Math.max(e-this.rowLevelWidthMeasureManager.getHeadersWidth(),0),l-=Math.max(this.rowLevelWidthMeasureManager.getHeadersWidth()-this.columnScrollbar.viewMin,0)),{left:e,top:r,width:l=Math.max(l,0),height:g=Math.max(g,0)}},v.prototype.getClientWidth=function(){return this.width-(this.rowScrollbar.visible?o.zf:0)},v.prototype.storeFocus=function(){var r,l,g,p,e=document.activeElement;if(this.topViewport.contains(e))this.topRenderer.isPrefixCell(e)?(r=this.topRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),g=t.p0.Header,p=t.aP.Prefix):(r=this.topRenderer.getRowIndex(e),l=this.topRenderer.getColumnIndex(e),g=t.p0.Header,p=t.aP.Main);else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?(r=this.midRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),g=t.p0.Body,p=t.aP.Prefix):(r=this.midRenderer.getRowIndex(e),l=this.midRenderer.getColumnIndex(e),g=t.p0.Body,p=t.aP.Main);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?(r=this.botRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.midRenderer.getColumnIndex(e),g=t.p0.Footer,p=t.aP.Prefix):(r=this.botRenderer.getRowIndex(e),l=this.botRenderer.getColumnIndex(e),g=t.p0.Footer,p=t.aP.Main);else if(this.isA11yTable){var n=d3.select(this.topViewport).select(".main-cell").node();r=this.topRenderer.getRowIndex(n),l=this.topRenderer.getColumnIndex(n),g=t.p0.Header,p=t.aP.Main}else{var u=d3.select(this.topViewport).select(".prefix-cell").node();r=this.topRenderer.getRowIndex(u),l=this.topRenderer.getColumnIndex(u),g=t.p0.Header,p=t.aP.Prefix}this.tempFocus={rowIndex:r,columnIndex:l,section:g,region:p}},v.prototype.restoreFocus=function(){var r,e=this;Q.fF.assert(function(){return!!e.tempFocus},"tempFocus must be defined"),this.tempFocus.section===t.p0.Header?r=this.topRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===t.p0.Body?r=-1===this.tempFocus.columnIndex?this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,0,t.aP.Prefix):this.midRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region):this.tempFocus.section===t.p0.Footer&&(r=this.botRenderer.getElementByIndex(this.tempFocus.rowIndex,this.tempFocus.columnIndex,this.tempFocus.region)),r||(this.updateFocus(),r=this.getFocusedCell(this.focusManager.CurrentFocus)),r.focus({preventScroll:!0})},v.prototype.updateFocus=function(){var r,l,g,p,e=document.activeElement;if(this.topViewport.contains(e))if(this.topRenderer.isPrefixCell(e))r=this.topRenderer.getRowIndex(e),l=this.isA11yTable?-1:this.topRenderer.getColumnIndex(e),g=this.isA11yTable?t.p0.Header:t.p0.MatrixCorner;else{var n=this.topRenderer.getItemByElement(e);g=t.p0.Header,p=this.columnNavigator.getPathIndices(n)}else if(this.midViewport.contains(e))this.midRenderer.isPrefixCell(e)?this.isA11yTable?(r=this.midRenderer.getRowIndex(e),l=-1,g=t.p0.Body):(n=this.midRenderer.getItemByElement(e),g=t.p0.MatrixRowHeader,p=this.rowNavigator.getPathIndices(n)):(r=this.midRenderer.getRowIndex(e),l=this.midRenderer.getColumnIndex(e),g=t.p0.Body);else if(this.botViewport.contains(e))this.botRenderer.isPrefixCell(e)?this.isA11yTable?(r=this.botRenderer.getRowIndex(e),l=-1,g=t.p0.Footer):(r=this.botRenderer.getRowIndex(e),g=t.p0.FooterHeader):(r=this.botRenderer.getRowIndex(e),l=this.botRenderer.getColumnIndex(e),g=t.p0.Footer);else if(this.isA11yTable){var u=d3.select(this.topViewport).select(".main-cell").node();r=this.topRenderer.getRowIndex(u),l=this.topRenderer.getColumnIndex(u),g=t.p0.Header}else{var S=d3.select(this.topViewport).select(".prefix-cell").node();r=this.topRenderer.getRowIndex(S),l=this.topRenderer.getColumnIndex(S),g=t.p0.MatrixCorner}this.focusManager.setAsFocusTableEx(r,l,g,p)},v.prototype.scrollBy=function(e,r){if(this.renderLock)return!1;var l,g;if(e){var p=this.columnScrollbar.viewMin;this.columnScrollbar.scrollBy(e,!0),this.columnScrollbar.refresh(),l=p!==this.columnScrollbar.viewMin}if(r){var n=this.rowScrollbar.viewMin;this.rowScrollbar.scrollBy(r,!0),this.rowScrollbar.refresh(),g=n!==this.rowScrollbar.viewMin}return!(!l&&!g||(this.refresh(),0))},v.prototype.scrollTo=function(e,r){this.renderLock||(null!=e&&(this.columnScrollbar.scrollTo(e,!0),this.columnScrollbar.refresh()),null!=r&&(this.rowScrollbar.scrollTo(r,!0),this.rowScrollbar.refresh()),this.refresh())},v.prototype.refresh=function(){if(!this.renderLock){this.options.onScroll&&this.options.onScroll();var e=this.getViewport(),r=this.columnScrollbar.viewMin,l=this.rowScrollbar.viewMin;this.topRenderer.scrollToX(r),this.midRenderer.scrollToX(r),this.botRenderer.scrollToX(r),this.midViewport.scrollTop=l,this.rowScrollbar.viewMin=this.midViewport.scrollTop,this.topRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.midRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator),this.botRenderer.update(e,this.binder,this.rowNavigator,this.columnNavigator)}},v.prototype.renderAsync=function(e,r,l){return(0,N.__awaiter)(this,void 0,void 0,function(){var g,p,s,n,u;return(0,N.__generator)(this,function(S){switch(S.label){case 0:return g=++this.renderIteration,e===t.BM.ClearMeasurement&&this.clearMeasurement(),this.lockRendering(),[4,this.measureAsync(r,l,g)];case 1:return u=S.sent(),p=u[0],s=u[1],g!==this.renderIteration||(this.unlockRendering(),(n=this.element.contains(document.activeElement))&&this.storeFocus(),(e===t.BM.ClearRendering||e===t.BM.ClearMeasurement)&&this.clearRendering(),this.updateRegionsPosition(),this.updateScrollbars(),this.updateScrollRegionWidth(),this.updateScrollRegionHeight(),this.scrollTo(p,s),e===t.BM.ResizeColumn&&(this.topRenderer.onColumnResize(),this.midRenderer.onColumnResize(),this.botRenderer.onColumnResize()),n&&(e===t.BM.ClearRendering||e===t.BM.ClearMeasurement)&&this.restoreFocus(),this.updateAria(),this.subSelectionHelper&&this.onObject&&this.subSelectionHelper.addDirectEditPlaceholderOutlines()),[2]}})})},v.prototype.lockRendering=function(){this.midViewport.style.overflow="hidden",this.renderLock=!0},v.prototype.unlockRendering=function(){this.scrollingEnabled&&(this.midViewport.style.overflowY="auto"),this.renderLock=!1},v.prototype.measureAsync=function(e,r,l){return(0,N.__awaiter)(this,void 0,void 0,function(){var g,p,s,n,u,S,y;return(0,N.__generator)(this,function(f){switch(f.label){case 0:if(u=this.getViewport(),e?n=e.rowIndex:(S=i._E.getVisibleRange(u.top,u.height,this.rowHeightMeasureManager),n=S?S.firstLeafIndex:0),r?s=r.columnIndex:(y=i.sW.getVisibleRange(u.left,u.width,this.columnWidthMeasureManager),s=y?y.firstLeafIndex:0),s=Math.max(0,Math.floor(s-i.EO/2)),!r)return[3,4];f.label=1;case 1:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&r.columnIndex>this.columnWidthMeasureManager.getLastMeasuredIndex()?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n),[4,this.setTimeoutAsync()]):[3,3];case 2:return f.sent(),l!==this.renderIteration?[2,[0,0]]:[3,1];case 3:return g=i.sW.getOffset(r,this.columnWidthMeasureManager),r.alignRight&&(g-=this.columnScrollbar.viewSize),[3,5];case 4:g=this.columnScrollbar.viewMin,f.label=5;case 5:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)&&this.columnWidthMeasureManager.getColumnsWidth()-g<=this.width?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n),[4,this.setTimeoutAsync()]):[3,7];case 6:return f.sent(),l!==this.renderIteration?[2,[0,0]]:[3,5];case 7:if(this.rowLevelWidthMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,n,i.Ms),this.rowHeightMeasureManager.ensureLastPageComplete(this.binder,this.rowNavigator,this.columnNavigator,n,s,i.EO),!e)return[3,11];f.label=8;case 8:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&e.rowIndex>this.rowHeightMeasureManager.getLastMeasuredIndex()?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n,s),[4,this.setTimeoutAsync()]):[3,10];case 9:return f.sent(),l!==this.renderIteration?[2,[0,0]]:[3,8];case 10:return p=i._E.getOffset(e,this.rowHeightMeasureManager),e.alignBottom&&(p-=this.rowScrollbar.viewSize),[3,12];case 11:p=this.rowScrollbar.viewMin,f.label=12;case 12:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)&&this.rowHeightMeasureManager.getRowsHeight()-p<=this.height?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,n,s),[4,this.setTimeoutAsync()]):[3,14];case 13:return f.sent(),l!==this.renderIteration?[2,[0,0]]:[3,12];case 14:return this.rowHeightMeasureManager.measureFloatingRows(this.binder,this.rowNavigator,this.columnNavigator,n,s,this.onObject,this.showTotalPlaceHolders),this.columnLevelHeightMeasureManager.measure(this.binder,this.rowNavigator,this.columnNavigator,n,s,i.EO),this.measurePageColumnsAsync(n,l),this.measurePageRowsAsync(n,s,l),[2,[g,p]]}})})},v.prototype.updateAria=function(){var e=this.columnNavigator.getHierarchyDepth()+this.rowNavigator.getHierarchyLeafCount()+this.rowNavigator.getFloatingHierarchyLeafCount(),r=this.rowNavigator.getHierarchyDepth()+this.columnNavigator.getHierarchyLeafCount();d3.select(this.innerContainer).attr("aria-rowcount",e),d3.select(this.innerContainer).attr("aria-colcount",r)},v.prototype.setTimeoutAsync=function(e){return void 0===e&&(e=0),(0,N.__awaiter)(this,void 0,void 0,function(){return(0,N.__generator)(this,function(r){return[2,new ce.J(function(l){return ee.l.setTimeout(function(){return l()},e)})]})})},v.prototype.requestAnimationFrameAsync=function(){return(0,N.__awaiter)(this,void 0,void 0,function(){return(0,N.__generator)(this,function(e){return[2,new ce.J(function(r){return ee.l.requestAnimationFrame(function(){return r()})})]})})},v.prototype.getVisibleRowStart=function(){var e=this.getViewport(),r=i._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);return r?i._E.getVisibleRowStart(r,e.top,this.rowHeightMeasureManager):null},v.prototype.getVisibleColumnStart=function(){var e=this.getViewport(),r=i.sW.getVisibleRange(e.left,e.width,this.columnWidthMeasureManager);return r?i.sW.getVisibleColumnStart(r,e.left,this.columnWidthMeasureManager):null},v.prototype.clearRendering=function(){this.midRenderer.clear(),this.topRenderer.clear(),this.botRenderer.clear()},v.prototype.clearMeasurement=function(){this.columnWidthMeasureManager.clear(),this.rowHeightMeasureManager.clear(),this.columnLevelHeightMeasureManager.clear(),this.rowLevelWidthMeasureManager.clear()},v.prototype.clear=function(){this.renderIteration++,this.clearRendering(),this.clearMeasurement(),this.unlockRendering()},v.prototype.updateRegionsPosition=function(){this.midViewport.style.top=this.topViewport.style.height=(0,P.S)(this.columnLevelHeightMeasureManager.getHeadersHeight()),this.topRenderer.updateBodyLeft(),this.midRenderer.updateBodyLeft(),this.botRenderer.updateBodyLeft();var e=(0,P.S)(this.rowHeightMeasureManager.getFloatingRowHeights());this.botViewport.style.height=e},v.prototype.updateScrollbars=function(){this.rowScrollbar.invalidateArrange(),this.columnScrollbar.invalidateArrange();var e=this.rowHeightMeasureManager.getFloatingRowHeights(),r=this.height-this.columnLevelHeightMeasureManager.getHeadersHeight()-e,l=this.width-this.rowLevelWidthMeasureManager.getHeadersWidth(),g=this.rowHeightMeasureManager.getRowsHeight(),p=this.columnWidthMeasureManager.getColumnsWidth(),s=this.options.scrollingEnabled&&g>0&&g>r,n=this.options.scrollingEnabled&&p>0&&p>l;!s&&n&&g>0&&(s=g>r-o.zf),!n&&s&&p>0&&(n=p>l-o.zf),this.midViewport.style.right=this.topViewport.style.right=this.botViewport.style.right=s?this.rowScrollbar.width:(0,P.S)(0);var S,y,u=n?o.zf:0;g>r-u?(S=u+e,y=u):(S=r+e-g,y=r-g),this.midViewport.style.bottom=(0,P.S)(S),this.botViewport.style.bottom=(0,P.S)(y),this.rowScrollbar.show(s),this.rowScrollbar.viewSize=this.midViewport.clientHeight,this.rowScrollbar.element.style.bottom=n?o.zf+"px":"0",this.rowScrollbar.refresh(),this.columnScrollbar.show(n),this.columnScrollbar.viewSize=this.getBodyCellWidth(),this.unfrozenRowHeaders&&(this.columnScrollbar.viewSize+=this.rowLevelWidthMeasureManager.getHeadersWidth()),this.columnScrollbar.element.style.right=s?o.zf+"px":"0",this.columnScrollbar.refresh()},v.prototype.getBodyCellWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),r=this.columnWidthMeasureManager.getColumnsWidth();return Math.min(this.midViewport.clientWidth-e,r)},v.prototype.measurePageColumnsAsync=function(e,r){return(0,N.__awaiter)(this,void 0,void 0,function(){return(0,N.__generator)(this,function(l){switch(l.label){case 0:return[4,this.setTimeoutAsync(o.yv)];case 1:if(l.sent(),r!==this.renderIteration)return[2];l.label=2;case 2:return this.columnWidthMeasureManager.canAddPageColumn(this.columnNavigator)?(this.columnWidthMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e),this.updateScrollRegionWidth(),[4,this.setTimeoutAsync(o.yv)]):[3,4];case 3:return l.sent(),r!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},v.prototype.measurePageRowsAsync=function(e,r,l){return(0,N.__awaiter)(this,void 0,void 0,function(){return(0,N.__generator)(this,function(g){switch(g.label){case 0:return[4,this.setTimeoutAsync(o.yv)];case 1:if(g.sent(),l!==this.renderIteration)return[2];g.label=2;case 2:return this.rowHeightMeasureManager.canAddPageRow(this.rowNavigator)?(this.rowHeightMeasureManager.measureNextPage(this.binder,this.rowNavigator,this.columnNavigator,e,r),this.updateScrollRegionHeight(),[4,this.setTimeoutAsync(o.yv)]):[3,4];case 3:return g.sent(),l!==this.renderIteration?[2]:[3,2];case 4:return[2]}})})},v.prototype.updateScrollRegionWidth=function(){var e=this.rowLevelWidthMeasureManager.getHeadersWidth(),r=this.columnWidthMeasureManager.getColumnsWidth(),l=this.midViewport.clientWidth;this.columnScrollbar.max=this.unfrozenRowHeaders?r+e:r,this.columnScrollbar.viewSize=this.unfrozenRowHeaders?l:l-e,this.columnScrollbar.refresh(),this.topRenderer.setRowWidth(),this.midRenderer.setRowWidth(),this.botRenderer.setRowWidth()},v.prototype.updateScrollRegionHeight=function(){var e=this.rowHeightMeasureManager.getRowsHeight(),r=this.midViewport.clientHeight,l=(0,P.S)(Math.max(e,r));this.innerBodyCellContainer.style.height=l,this.rowScrollbar.max=e,this.rowScrollbar.viewSize=r,this.rowScrollbar.refresh()},v.prototype.getNumberOfVisibleRows=function(){var e=this.getViewport(),r=i._E.getVisibleRange(e.top,e.height,this.rowHeightMeasureManager);if(r)return Math.max(0===r.firstLeafIndex?r.lastLeafIndex-r.firstLeafIndex:r.lastLeafIndex-r.firstLeafIndex-1,1)},v.prototype.getMidViewportBoundingClientRect=function(){return this.midViewport.getBoundingClientRect()},v.prototype.getTopViewportBoundingClientRect=function(){return this.topViewport.getBoundingClientRect()},v.prototype.getBotViewportBoundingClientRect=function(){return this.botViewport.getBoundingClientRect()},v.prototype.destroy=function(){this.renderIteration=NaN},v.ScrollDeltaMax=200,v}()},44102:function(Te,Pe,A){A.d(Pe,{AT:function(){return i},Xg:function(){return ae},fw:function(){return K}});var N=A(81337),pe=A(66232),Q=A(62458),oe=A(87914),ce=A(93340),ee="unselectable";function K(P,o){if(P)for(var t=0,h=P;t<h.length;t++)(0,h[t])(o)}var G=function(){function P(o,t){this._owner=o,this._direction=t,this._timerHandle=void 0,this.createView();var h=this;this._element.addEventListener("mousedown",function(b){h.onMouseDown(b)}),$(this._element).addClass(ee),$(this._svg).addClass(ee),$(this._polygon).addClass(ee)}return Object.defineProperty(P.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),P.prototype.createView=function(){var o="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(o,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",P.ARROW_COLOR),this._svg=document.createElementNS(o,"svg");var t=this._svg.style;t.position="absolute",t.left="0px",t.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=j.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},P.prototype.onMouseDown=function(o){var t=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){o.cancelBubble=!0;var h=this;this._mouseUpWrapper=function(b){h.onMouseUp(b)},j.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout(function(){t.onMouseDown(o)},100),o.preventDefault&&o.preventDefault()},P.prototype.onMouseUp=function(o){clearTimeout(this._timerHandle),j.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},P.prototype.arrange=function(o,t,h){var b=Math.min(o,t);this._polygon.setAttributeNS(null,"transform","translate("+(o-b)/2+", "+(t-b)/2+") scale("+b/16+") rotate("+h+",8,8)"),this._svg.setAttributeNS(null,"width",o+"px"),this._svg.setAttributeNS(null,"height",t+"px"),(0,ce.Py)(this._element,o),(0,ce.Iw)(this._element,t)},P.MIN_WIDTH=26,P.ARROW_COLOR="#404040",P}(),j=function(){function P(o,t,h,b){this.isModern=h,this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(o,t);var V=this;this._element.addEventListener("mousedown",function(H){V.onBackgroundMouseDown(H)}),this._element.addEventListener("pointerdown",function(H){(0,pe.n)(H)}),this._element.addEventListener("dblclick",function(H){(0,pe.n)(H)}),this._middleBar.addEventListener("mousedown",function(H){V.onMiddleBarMouseDown(H)}),this._middleBar.addEventListener("pointerdown",function(H){(0,pe.n)(H)}),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(ee),this.onScrollBehavior=b}return P.prototype.scrollBy=function(o,t){this.scrollTo(this.viewMin+o,t)},P.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},P.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},P.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},P.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(P.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._element.style.width=t,this.invalidateArrange()},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._element.style.height=t,this.invalidateArrange()},enumerable:!1,configurable:!0}),P.prototype.refresh=function(){Q.fF.assertFail("PureVirtualMethod: Scrollbar.refresh()")},Object.defineProperty(P.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!1,configurable:!0}),P.prototype._scrollSmallIncrement=function(o){this.scrollBy(this.smallIncrement*o)},Object.defineProperty(P.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!1,configurable:!0}),P.prototype.show=function(o){this._visible=o,this.element.style.visibility=o?"visible":"hidden",this.invalidateArrange()},P.prototype._getMouseOffset=function(o){return void 0!==o.offsetX?{x:o.offsetX,y:o.offsetY}:void 0!==o.layerX?{x:o.layerX,y:o.layerY}:{x:o.screenX,y:o.screenY}},P.prototype._getOffsetXDelta=function(o){return(o.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},P.prototype._getOffsetYDelta=function(o){return(o.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},P.prototype._getOffsetXTouchDelta=function(o){return this._getMouseOffset(o).x-this._offsetTouchPrevPos.x},P.prototype._getOffsetYTouchDelta=function(o){return this._getMouseOffset(o).y-this._offsetTouchPrevPos.y},P.prototype.onTouchStart=function(o){1===o.touches.length&&this.onTouchMouseDown(o.touches[0])},P.prototype.onTouchMove=function(o){1===o.touches.length&&(o.preventDefault&&o.preventDefault(),this.onTouchMouseMove(o.touches[0]))},P.prototype.onTouchEnd=function(o){this.onTouchMouseUp(1===o.touches.length?o.touches[0]:o,!0)},P.prototype.onTouchMouseDown=function(o){!this._allowMouseDrag&&o.pointerType===MSPointerEvent.MSPOINTER_TYPE_MOUSE||(this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},P.prototype._getOffsetTouchDelta=function(o){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetTouchDelta()"),null},P.prototype.onTouchMouseMove=function(o){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(o));var t=this._getOffsetTouchDelta(o);0!==t&&(this.scrollBy(-t/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(o)),o.preventDefault&&o.preventDefault(),o.cancelBubble=!0}},P.prototype.onTouchMouseUp=function(o,t){if(this._touchStarted&&this._offsetTouchStartPos){var h=this._getMouseOffset(o);!t&&(Math.abs(this._offsetTouchStartPos.x-h.x)>3||Math.abs(this._offsetTouchStartPos.y-h.y)>3)&&(o.preventDefault&&o.preventDefault(),o.cancelBubble=!0)}this._touchStarted=!1},P.prototype.createView=function(o,t){this._element=document.createElement("div"),this._element.className=P.className,this._element.setAttribute("drag-resize-disabled","true"),this._element.style.zIndex="2",this.isModern&&(this._element.style.setProperty("--background","white"),this._element.style.borderRadius=Math.ceil(oe.zf/2)+"px",this._element.style.setProperty("--opacity",".5"),this._element.style.setProperty("--opacity-hover",".6")),0===t&&o.appendChild(this._element),this.isModern||(this._minButton=new G(this,-1),this._maxButton=new G(this,1)),this._middleBar=document.createElement("div"),this._middleBar.className=P.barClassName,this.isModern&&(this._middleBar.style.setProperty("--bar-color","#605E5C"),this._middleBar.style.setProperty("--bar-color-hover","#605E5C"),this._middleBar.style.borderRadius=Math.ceil(oe.zf/2)+"px",this._middleBar.style.border="1px solid white",this._middleBar.style.boxSizing="border-box"),this._element.appendChild(this._middleBar)},P.prototype.scrollTo=function(o,t){var h=Math.min(this.max-this.viewSize,Math.max(this.min,o));(h=Math.max(this.min,h))!==this.viewMin&&(this.viewMin=h,t||K(this._onscroll,null)),this.onScrollBehavior&&this.onScrollBehavior()},P.prototype._scrollByPage=function(o){Q.fF.assertFail("PureVirtualMethod: Scrollbar._scrollByPage()")},P.prototype._getRunningSize=function(o){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getRunningSize()"),null},P.prototype._getOffsetDelta=function(o){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getOffsetDelta()"),null},P.prototype.scroll=function(o){var t=this._getOffsetDelta(o)/this._getRunningSize(!0)*(this.max-this.min);if(t<0){if(this._getScreenMousePos(o)>=this._screenMaxMousePos)return}else if(t>0&&this._getScreenMousePos(o)<=this._screenMinMousePos)return;this.scrollBy(t)},Object.defineProperty(P.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"actualHeight",{get:function(){return void 0===this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"actualButtonWidth",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"actualButtonHeight",{get:function(){return this.isModern?-1:(void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight)},enumerable:!1,configurable:!0}),P.prototype.arrange=function(){(!this._actualWidth||!this._actualHeight)&&(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=-1,this._actualButtonHeight=-1,this.isModern||(this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition()))},P.prototype._calculateButtonWidth=function(){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonWidth()"),null},P.prototype._calculateButtonHeight=function(){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._calculateButtonHeight()"),null},P.prototype._getMinButtonAngle=function(){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getMinButtonAngle()"),null},P.prototype._getMaxButtonAngle=function(){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getMaxButtonAngle()"),null},P.prototype._setMaxButtonPosition=function(){Q.fF.assertFail("PureVirtualMethod: Scrollbar._setMaxButtonPosition()")},P.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},P.prototype.onHoldBackgroundMouseDown=function(o){var t=this;this._timerHandle=setTimeout(function(){t.onBackgroundMouseDown(o)},this._timerHandle?P.ScrollbarBackgroundMousedownHoldDelay:P.ScrollbarBackgroundFirstTimeMousedownHoldDelay)},P.prototype.onBackgroundMouseDown=function(o){var t=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(o.cancelBubble=!0,this._backgroundMouseUpWrapper=function(h){t.onBackgroundMouseUp(h)},P.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(o),this.refresh(),this.onHoldBackgroundMouseDown(o),o.preventDefault&&o.preventDefault()},P.prototype.onBackgroundMouseUp=function(o){clearTimeout(this._timerHandle),this._timerHandle=void 0,P.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},P.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},P.prototype.onMiddleBarMouseDown=function(o){o.cancelBubble=!0,this._screenPrevMousePos={x:o.screenX,y:o.screenY},this.isModern?(this._screenMinMousePos=this._getScreenMousePos(o)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualLeft(this.element)),this._screenMaxMousePos=this._getScreenMousePos(o)+(this._getScreenContextualRight(this.element)-this._getScreenContextualRight(this._middleBar))):(this._screenMinMousePos=this._getScreenMousePos(o)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(o)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar))),this._screenToOffsetScale=(0,ce.df)(this.element)*this.getPinchZoomY();var t=this;this._middleBarMouseMoveWrapper=function(h){t.onMiddleBarMouseMove(h)},P.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(h){t.onMiddleBarMouseUp(h)},P.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),o.preventDefault&&o.preventDefault()},P.prototype.onMiddleBarMouseMove=function(o){this._screenPrevMousePos&&(this.scroll(o),this.refresh(),this._screenPrevMousePos={x:o.screenX,y:o.screenY})},P.prototype.onMiddleBarMouseUp=function(o){this._screenPrevMousePos=void 0,P.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,P.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,o.preventDefault&&o.preventDefault()},P.prototype._getScreenContextualLeft=function(o){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualLeft()"),null},P.prototype._getScreenContextualRight=function(o){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenContextualRight()"),null},P.prototype.onMouseWheel=function(o){o&&this.mouseWheel(o)},P.prototype.mouseWheel=function(o){this.visible&&(o<0?o=Math.min(-P.MouseWheelRange,o):o>0&&(o=Math.max(P.MouseWheelRange,o)),this.scrollBy(-o/P.MouseWheelRange*this.smallIncrement))},P.prototype._getScreenMousePos=function(o){return Q.fF.assertFail("PureVirtualMethod: Scrollbar._getScreenMousePos()"),null},P.addDocumentMouseUpEvent=function(o){document.addEventListener("mouseup",o)},P.removeDocumentMouseUpEvent=function(o){document.removeEventListener("mouseup",o)},P.addDocumentMouseMoveEvent=function(o){document.addEventListener("mousemove",o)},P.removeDocumentMouseMoveEvent=function(o){document.removeEventListener("mousemove",o)},P.DefaultScrollbarWidth="15px",P.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,P.ScrollbarBackgroundMousedownHoldDelay=50,P.MouseWheelRange=120,P.className="scroll-bar-div",P.barClassName="scroll-bar-part-bar",P.arrowClassName="scroll-bar-part-arrow",P}(),ae=function(P){function o(t,h,b,V){var H=P.call(this,t,h,b,V)||this;return H.height=j.DefaultScrollbarWidth,H}return(0,N.__extends)(o,P),o.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,G.MIN_WIDTH))},o.prototype._calculateButtonHeight=function(){return this.actualHeight},o.prototype._getMinButtonAngle=function(){return-180},o.prototype._getMaxButtonAngle=function(){return 0},o.prototype._setMaxButtonPosition=function(){(0,ce.hn)(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},o.prototype.refresh=function(){this.arrange();var t=this.actualWidth-2*this.actualButtonWidth-2,h=this.viewSize/(this.max-this.min)*t;h<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-h,h=this.MIN_BAR_SIZE),t<0&&(t=0,h=0),h=Math.min(h,t);var b=this.viewMin/(this.max-this.min)*t;(0,ce.Py)(this.middleBar,h),(0,ce.Iw)(this.middleBar,this.actualHeight);var V=this.actualButtonWidth+1+b;this.isModern?this.middleBar.style.transform="translateX(".concat(V,"px)"):(0,ce.hn)(this.middleBar,V)},o.prototype.show=function(t){t!==this.visible&&(P.prototype.show.call(this,t),t?this.element.style.height=this.height:(0,ce.Iw)(this.element,0))},o.prototype._scrollByPage=function(t){var h;if(this.isModern){var b=window.getComputedStyle(this.middleBar);h=new WebKitCSSMatrix(b.transform).m41}else h=this.middleBar.offsetLeft;var X=void 0===t.offsetX?t.layerX:t.offsetX;X>h+this.middleBar.offsetWidth?this.scrollPageDown():X<h&&this.scrollPageUp()},o.prototype._getRunningSize=function(t){var h=this.actualWidth;if(t){var V=(h-=2*(this.actualButtonWidth+1))*(this.viewSize/(this.max-this.min));V<this.MIN_BAR_SIZE&&(h-=this.MIN_BAR_SIZE-V)}return h},o.prototype._getOffsetDelta=function(t){return this._getOffsetXDelta(t)},o.prototype._getOffsetTouchDelta=function(t){return this._getOffsetXTouchDelta(t)},o.prototype._getScreenContextualLeft=function(t){return t.getBoundingClientRect().left},o.prototype._getScreenContextualRight=function(t){return t.getBoundingClientRect().right},o.prototype._getScreenMousePos=function(t){return t.screenX},o}(j),i=function(P){function o(t,h,b,V){var H=P.call(this,t,h,b,V)||this;return H.width=j.DefaultScrollbarWidth,H}return(0,N.__extends)(o,P),o.prototype._calculateButtonWidth=function(){return this.actualWidth},o.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,G.MIN_WIDTH))},o.prototype._getMinButtonAngle=function(){return-90},o.prototype._getMaxButtonAngle=function(){return 90},o.prototype._setMaxButtonPosition=function(){(0,ce.FX)(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},o.prototype.refresh=function(){this.arrange();var t=this.actualHeight-2*this.actualButtonHeight-2,h=this.viewSize/(this.max-this.min)*t;h<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-h,h=this.MIN_BAR_SIZE),t<0&&(t=0,h=0);var b=this.viewMin/(this.max-this.min)*t;(0,ce.Py)(this.middleBar,this.actualWidth),(0,ce.Iw)(this.middleBar,h);var V=this.actualButtonHeight+1+b;this.isModern?this.middleBar.style.transform="translateY(".concat(V,"px)"):(0,ce.FX)(this.middleBar,V)},o.prototype.show=function(t){t!==this.visible&&(P.prototype.show.call(this,t),t?this.element.style.width=this.width:(0,ce.Py)(this.element,0))},o.prototype._scrollByPage=function(t){var h;if(this.isModern){var b=window.getComputedStyle(this.middleBar);h=new WebKitCSSMatrix(b.transform).m42}else h=this.middleBar.offsetTop;var X=void 0===t.offsetY?t.layerY:t.offsetY;X>h+this.middleBar.offsetHeight?this.scrollPageDown():X<h&&this.scrollPageUp()},o.prototype._getRunningSize=function(t){var h=this.actualHeight;if(t){var V=(h-=2*(this.actualButtonHeight+1))*(this.viewSize/(this.max-this.min));V<this.MIN_BAR_SIZE&&(h-=this.MIN_BAR_SIZE-V)}return h},o.prototype._getOffsetDelta=function(t){return this._getOffsetYDelta(t)},o.prototype._getOffsetTouchDelta=function(t){return this._getOffsetYTouchDelta(t)},o.prototype._getScreenContextualLeft=function(t){return t.getBoundingClientRect().top},o.prototype._getScreenContextualRight=function(t){return t.getBoundingClientRect().bottom},o.prototype._getScreenMousePos=function(t){return t.screenY},o}(j)},73889:function(Te,Pe,A){A.d(Pe,{Y:function(){return N}});var N=function(pe){return pe[pe.Matrix=0]="Matrix",pe[pe.Table=1]="Table",pe[pe.PivotTable=2]="PivotTable",pe[pe.TableEx=3]="TableEx",pe}({})},71090:function(Te,Pe,A){A.d(Pe,{Ds:function(){return t},Ed:function(){return d},Eo:function(){return T},F2:function(){return R},Hw:function(){return P},JM:function(){return I},LU:function(){return C},Mh:function(){return K},NA:function(){return c},OM:function(){return l},P$:function(){return S},Pr:function(){return V},QM:function(){return r},R9:function(){return F},Sl:function(){return ae},TV:function(){return j},Vz:function(){return O},WA:function(){return H},YR:function(){return n},Yo:function(){return de},Zk:function(){return x},b:function(){return G},bn:function(){return oe},dG:function(){return m},dm:function(){return o},en:function(){return b},f:function(){return X},fG:function(){return y},iC:function(){return i},jv:function(){return g},lN:function(){return te},mQ:function(){return J},qT:function(){return Q},rJ:function(){return u},rx:function(){return s},rz:function(){return h},s$:function(){return D},s0:function(){return Y},sR:function(){return pe},uX:function(){return ee},uZ:function(){return ne},wH:function(){return p},wd:function(){return f},yF:function(){return ce},ye:function(){return W},z7:function(){return e},zq:function(){return q}});var N=A(38265),pe=.8,Q="TableTotalLabel",oe="Format_AddTotalLabel",ce="Visual_LabelText_Value",ee="Row_Selection",K="SelectRow",G="Row_Selected",j="Row_Unselected",ae="Additional_Conditional_Formatting",i="DecompositionTree_ScrollLevelUp_Tooltip",P="DecompositionTree_ScrollLevelDown_Tooltip",o="Scroll_Left",t="Scroll_Right",h="tablixDiv",b="tablixCellContentElement",V="tablixCellContentHost",H="tablixWrappingContainer",X="tablixHeader",J="tablixColumnHeaderLeaf",Y="tablixValueNumeric",F="tablixValueTotal",c="powervisuals-glyph tablixUrlIconGlyph",C="tablixValueUrlIcon",d="tablixImageContainer",T="matrixRowHeaderLeaf",D="tableFooterCell",I="tableBodyCell",q="tableBodyCellBottom",e="tablixAlignLeft",r="tablixAlignCenter",l="tablixAlignRight",g="&nbsp;",p="px",s="tablixSortIconContainer",n=10,u=5,S=5,y=5,f=1,m=N.Wn.regular.css,R=N.Wn.regular.css,x=N.Wn.bold.css,O=N.Wn.glyphs.css,W="#333",te="#666",ne=Number.POSITIVE_INFINITY,de=.71},42737:function(Te,Pe,A){A.d(Pe,{A:function(){return pe}});var N=A(62458),pe=function(){function Q(oe,ce){this._element=oe,this._handler=ce,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return Q.addDocumentMouseUpEvent=function(oe){document.addEventListener("mouseup",oe)},Q.removeDocumentMouseUpEvent=function(oe){document.removeEventListener("mouseup",oe)},Q.addDocumentMouseMoveEvent=function(oe){document.addEventListener("mousemove",oe)},Q.removeDocumentMouseMoveEvent=function(oe){document.removeEventListener("mousemove",oe)},Q.getMouseCoordinates=function(oe){return{x:oe.pageX,y:oe.pageY}},Q.getMouseCoordinateDelta=function(oe,ce){return{x:ce.x-oe.x,y:ce.y-oe.y}},Q.prototype.initialize=function(){var oe=this;this._elementMouseDownWrapper=function(ce){return oe.onElementMouseDown(ce)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(ce){return oe.onElementMouseMove(ce)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(ce){return oe.onElementMouseOut(ce)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(ce){return oe.onElementMouseDoubleClick(ce)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},Q.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(Q.prototype,"cell",{get:function(){return N.fF.assertFail("PureVirtualMethod: TablixResizer.cell"),null},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"element",{get:function(){return this._element},enumerable:!1,configurable:!0}),Q.prototype._hotSpot=function(oe){return N.fF.assertFail("PureVirtualMethod: TablixResizer._hotSpot"),!1},Q.prototype.onElementMouseDown=function(oe){var ce=this,ee=Q.getMouseCoordinates(oe);this._hotSpot(ee)&&(oe.cancelBubble=!0,this._startMousePosition=ee,this._documentMouseMoveWrapper=function(K){return ce.onDocumentMouseMove(K)},Q.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(K){return ce.onDocumentMouseUp(K)},Q.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=Q.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},Q.prototype.onElementMouseMove=function(oe){this._startMousePosition||(this._hotSpot(Q.getMouseCoordinates(oe))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=Q.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},Q.prototype.onElementMouseOut=function(oe){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},Q.prototype.onElementMouseDoubleClick=function(oe){this._hotSpot(Q.getMouseCoordinates(oe))&&this._handler.onReset(this.cell)},Q.prototype.onDocumentMouseMove=function(oe){if(this._startMousePosition){var ce=Q.getMouseCoordinateDelta(this._startMousePosition,Q.getMouseCoordinates(oe));this._handler.onResize(this.cell,ce.x,ce.y),oe.preventDefault()}},Q.prototype.onDocumentMouseUp=function(oe){this._startMousePosition=null,Q.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,Q.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),oe.preventDefault&&oe.preventDefault(),this._handler.onEndResize(this.cell)},Q.resizeHandleSize=4,Q.resizeCursor="e-resize",Q}()},93340:function(Te,Pe,A){A.d(Pe,{AB:function(){return g},Av:function(){return W},Ch:function(){return s},D4:function(){return P},D6:function(){return ne},DM:function(){return l},FX:function(){return o},G9:function(){return e},Hd:function(){return a},Hx:function(){return S},Iw:function(){return h},MN:function(){return f},Or:function(){return x},Pb:function(){return F},Py:function(){return b},R5:function(){return v},RP:function(){return m},Uy:function(){return H},W_:function(){return D},Y1:function(){return O},Y4:function(){return z},aP:function(){return r},df:function(){return J},ey:function(){return q},hn:function(){return t},jG:function(){return U},jT:function(){return w},mx:function(){return V},om:function(){return c},pW:function(){return se},qZ:function(){return C},ri:function(){return T},ut:function(){return Y},v4:function(){return p},vU:function(){return u},wC:function(){return I},wX:function(){return R},x7:function(){return te},xl:function(){return n}});var N=A(54522),pe=A(91358),Q=A(44977),oe=A(38308),ce=A(62458),ee=A(6444),K=A(64329),G=A(48066),j=A(28326),ae=A(42737),i=A(71090);function P(B){if(B)for(;B.hasChildNodes();)B.removeChild(B.firstChild)}function o(B,E){B.style.top=E+"px"}function t(B,E){B.style.left=E+"px"}function h(B,E){B.style.height=X(E)?"":E+"px"}function b(B,E){B.style.width=X(E)?"":E+"px"}function V(B){return B.offsetWidth}function H(B){return B.offsetHeight}function X(B){return-1===B}function J(B){var E=B.offsetWidth;return 0===E?1:B.getBoundingClientRect().width/E}function Y(B,E){var re=B.getBoundingClientRect(),he=J(B);return{x:(E.pageX-re.left)/he,y:(E.pageY-re.top)/he}}var F=function(B){return B[B.Outline=0]="Outline",B[B.Gridline=1]="Gridline",B}({}),c=function(){function B(E,re){this.applyParams(!0,E,re)}return B.prototype.applyParams=function(E,re,he,me){E?(this.weight=re??0,this.color=he??"black",this.type=me??F.Gridline):(this.weight=0,this.color="black",this.type=F.Gridline)},B.prototype.getCSS=function(){var E=[];return _.isNumber(this.weight)&&(E.push(this.weight+i.wH),this.color&&E.push(this.color),E.push("solid")),E.join(" ")},B.prototype.getPriority=function(E){return this===E.top||this===E.bottom?this.type===F.Outline?2:0:this===E.right||this===E.left?this.type===F.Outline?3:1:-1},B.prototype.getShadowCss=function(E,re){var me=this.weight?this.weight+5:0,we="inset ";if(this===E.left)we+=me+i.wH+" 0";else if(this===E.right)we+="-"+Math.min(me,re+5)+i.wH+" 0";else if(this===E.top)we+="0 "+me+i.wH;else{if(this!==E.bottom)return"";we+="0 -"+me+i.wH}return we+" 0 -".concat(5,"px ")+this.color},B}(),C=function(){function B(E,re){void 0===E&&(E=i.YR),void 0===re&&(re=i.rJ),this.borders={},this.paddings={top:0,left:E,bottom:0,right:re},this.fontColor="",this.fontFamily="",this.backColor=""}return B.prototype.applyStyle=function(E){var he=E.extension.contentHost.style;he.fontFamily=this.fontFamily,he.fontSize=this.fontSize?K.FP.toString(this.fontSize.px):void 0,he.fontWeight=this.fontWeight,he.fontStyle=this.fontStyle,he.textDecoration=this.textDecoration,he.color=this.fontColor,he.backgroundColor=this.backColor,he.boxShadow=this.getBoxShadow(),he.border="none",he.paddingTop=this.getPaddingTop(),he.paddingRight=this.getPaddingRight(),he.paddingBottom=this.getPaddingBottom(),he.paddingLeft=this.getPaddingLeft(),he.maxWidth=this.maxWidth},B.prototype.getPaddingTop=function(){return(this.paddings.top??0)+(null==this.borders.top?0:this.borders.top.weight)+i.wH},B.prototype.getPaddingBottom=function(){return(this.paddings.bottom??0)+(null==this.borders.bottom?0:this.borders.bottom.weight)+i.wH},B.prototype.getPaddingRight=function(){return(this.paddings.right??i.rJ)+(null==this.borders.right?0:this.borders.right.weight)+i.wH},B.prototype.getPaddingLeft=function(){return(this.paddings.left??i.YR)+(null==this.borders.left?0:this.borders.left.weight)+i.wH},B.prototype.getBoxShadow=function(E){var re,he,me,ye,we,Me,He,Fe,xe=[];return(null===(re=this.borders.left)||void 0===re?void 0:re.type)===F.Outline&&0!==this.borders.left.weight&&xe.push(this.borders.left.getShadowCss(this.borders)),(null===(he=this.borders.right)||void 0===he?void 0:he.type)===F.Outline&&0!==this.borders.right.weight&&0!==E&&xe.push(this.borders.right.getShadowCss(this.borders,E)),(null===(me=this.borders.bottom)||void 0===me?void 0:me.type)===F.Outline&&0!==this.borders.bottom.weight&&xe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(ye=this.borders.top)||void 0===ye?void 0:ye.type)===F.Outline&&0!==this.borders.top.weight&&xe.push(this.borders.top.getShadowCss(this.borders)),(null===(we=this.borders.left)||void 0===we?void 0:we.type)===F.Gridline&&0!==this.borders.left.weight&&xe.push(this.borders.left.getShadowCss(this.borders)),(null===(Me=this.borders.right)||void 0===Me?void 0:Me.type)===F.Gridline&&0!==this.borders.right.weight&&0!==E&&xe.push(this.borders.right.getShadowCss(this.borders,E)),(null===(He=this.borders.bottom)||void 0===He?void 0:He.type)===F.Gridline&&0!==this.borders.bottom.weight&&xe.push(this.borders.bottom.getShadowCss(this.borders)),(null===(Fe=this.borders.top)||void 0===Fe?void 0:Fe.type)===F.Gridline&&0!==this.borders.top.weight&&xe.push(this.borders.top.getShadowCss(this.borders)),xe.join(", ")},B.prototype.setAttributes=function(E,re,he,me,ye){if(E["padding-top"]=this.getPaddingTop(),E["padding-right"]=this.getPaddingRight(),E["padding-bottom"]=this.getPaddingBottom(),E["padding-left"]=this.getPaddingLeft(),_.isEmpty(this.fontFamily)||(E["font-family"]=this.fontFamily),null!=this.fontSize&&(E["font-size"]=K.FP.toString(this.fontSize.px)),null!=this.fontWeight&&(E["font-weight"]=this.fontWeight),_.isEmpty(this.fontStyle)||(E["font-style"]=this.fontStyle),_.isEmpty(this.textDecoration)||(E["text-decoration"]=this.textDecoration),_.isEmpty(this.fontColor)||(E.color=this.fontColor),_.isEmpty(this.backColor)||(E["background-color"]=this.backColor),me||!re&&!he){var we=parseFloat(this.getPaddingLeft()),Me=parseFloat(this.getPaddingRight()),He=this.getRightBorderMax(ye,we,Me),Fe=this.getBoxShadow(He);_.isEmpty(Fe)||(E["box-shadow"]=Fe)}_.isEmpty(this.maxWidth)||(E["max-width"]=this.maxWidth),(re||he)&&(E["--outline-top"]=this.borders.top?this.borders.top.weight+1+"px":"1px",E["--outline-right"]=this.borders.right?this.borders.right.weight+1+"px":"1px",E["--outline-bottom"]=this.borders.bottom?this.borders.bottom.weight+1+"px":"1px",E["--outline-left"]=this.borders.left?this.borders.left.weight+1+"px":"1px")},B.prototype.getRightBorderMax=function(E,re,he){if(null==E)return he;var me=Math.max(E-re,0);return Math.min(he,me)},B.prototype.getAttributes=function(E,re,he,me){var ye={};return this.setAttributes(ye,E,re,he,me),ye},B.prototype.getExtraTop=function(){var E=0;return this.paddings.top&&(E+=this.paddings.top),this.borders.top&&(E+=this.borders.top.weight),E},B.prototype.getExtraBottom=function(){var E=0;return this.paddings.bottom&&(E+=this.paddings.bottom),this.borders.bottom&&(E+=this.borders.bottom.weight),E},B.prototype.getExtraRight=function(){var E=0;return this.paddings.right&&(E+=this.paddings.right),this.borders.right&&(E+=this.borders.right.weight),E},B.prototype.getExtraLeft=function(){var E=0;return this.paddings.left&&(E+=this.paddings.left),this.borders.left&&(E+=this.borders.left.weight),E},B}(),d=function(){return function(){}}(),T=function(){function B(){this.row=new d,this.column=new d}return B.prototype.isMatch=function(E){return this.column.index===E.column.index&&this.row.index===E.row.index},B}(),U=function(){function B(E,re,he,me,ye,we,Me,He,Fe,xe,Ve){this.dataPoint=E,this.objects=re,this.isRowSubTotal=he,this.isColumnSubTotal=me,this.isRowGrandTotal=ye,this.isColumnGrandTotal=we,this.isBlankRow=Me,this.columnMetadata=He,this.formatter=Fe,this.tooltipFormatter=xe,this.type=Ve,this.position=new T,this.cachedTextContent=Fe?this.formatter.format(E,re):null!=this.dataPoint?E:""}return Object.defineProperty(B.prototype,"isTotal",{get:function(){return this.isSubtotal||this.isGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isSubtotal",{get:function(){return this.isColumnSubTotal||this.isRowSubTotal},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isGrandTotal",{get:function(){return this.isColumnGrandTotal||this.isRowGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isRowAndColumnGrandTotal",{get:function(){return this.isRowGrandTotal&&this.isColumnGrandTotal},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"textContent",{get:function(){return this.cachedTextContent},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"tooltipContent",{get:function(){return void 0===this.cachedTooltipContent&&(this.cachedTooltipContent=this.tooltipFormatter?this.tooltipFormatter.format(this.dataPoint,this.objects):this.textContent),this.cachedTooltipContent},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isKpi",{get:function(){return this.columnMetadata&&O(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"kpiContent",{get:function(){if(this.isKpi)return function(B,E){ce.fF.assertValue(B,"kpi"),ce.fF.assertValue(E,"kpiValue");var re=(0,pe.sq)(B,E)||"";return(0,oe.hi)().addClass(re).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}(this.columnMetadata.kpi,this.textContent)},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isNumeric",{get:function(){if(this.columnMetadata)return this.columnMetadata.type.numeric&&!this.columnMetadata.kpi},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isUrl",{get:function(){if(this.columnMetadata)return(0,N.cR)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isImage",{get:function(){if(this.columnMetadata)return(0,N.pt)(this.columnMetadata)},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"isValidUrl",{get:function(){return f(this.columnMetadata,this.textContent)!==G.av.NONE},enumerable:!1,configurable:!0}),B.prototype.isMatch=function(E){return this.position.isMatch(E.position)&&this.backColor===E.backColor},B}();function D(){return document.createElement("table")}function I(){var B=document.createElement("div");return B.className=i.rz,B}function q(B){B.extension.contentElement.className=i.rz+" "+i.en,B.extension.contentHost.className=i.rz+" "+i.Pr}function v(B,E){B.extension.contentHost.className+=" "+E}function e(B){B.extension.contentHost.className="",B.extension.contentHost.style.cssText=""}function r(B){B.extension.contentHost.textContent="",B.extension.contentHost.removeAttribute("title"),B.contentHeight=B.contentWidth=0,P(B.extension.contentHost)}function l(B,E,re){g(B,E),p(B,re||E)}function g(B,E){E.textContent=(0,Q.PC)(B)}function p(B,E){E.title=B}function s(B,E){var re=I();return B.appendChild(re),E&&(re.textContent=E),re}function n(B){var re=B.offsetX;return re>=0&&re<B.target.offsetWidth-ae.A.resizeHandleSize}function u(B,E,re){var he=null;0===E.childElementCount?(he=document.createElement("a"),E.appendChild(he)):he=E.children[0],he.href=B,he.target="_blank",he.rel="noopener noreferrer",he.title=B,null!=re?(he.className=i.NA+" "+re,$(E).addClass(i.LU)):he.innerText=B}function S(B,E,re){var he=I(),me=document.createElement("img");he.style.height=re+"px",he.style.width="100%",he.style.textAlign="center",me.src=B,me.style.maxHeight="100%",me.style.maxWidth="100%",he.appendChild(me),E.appendChild(he),E.title=B}function f(B,E){return(0,N.cR)(B)?(0,G.MN)(E):G.av.NONE}function m(B){switch(B){case G.av.file:case G.av.ftp:return"page2";case G.av.mailto:return"mail";case G.av.news:return"link";case G.av.telnet:return"pc1";case G.av.http:case G.av.https:return"link";default:return null}}function R(B,E,re){return x(B,E)&&(0,G.gU)(re)}function x(B,E){return(0,N.pt)(E)&&!B.isSubtotal&&!!B.identity}function O(B,E){return!(!B||void 0===E||!(0,pe.sq)(B,E))}function W(B,E){return{sortDescriptors:[{queryName:B,sortDirection:E}]}}function te(B){return 2===B?1:2}function ne(B,E){var re=I();B?(re.appendChild(de(B,!0)),re.appendChild(de(te(B),!1))):re.appendChild(de(2,!1));var he=I();return re.appendChild(he),E.appendChild(re),he}function de(B,E){var re=document.createElement("i");return re.className=i.rx+" "+(E?"sorted":"future")+" "+(1===B?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),re}function z(B){(function(B){for(var E=0,re=B.extension.contentElement.childElementCount;E<re;E++)if(B.extension.contentElement.children.item(E).classList.contains(i.rx))return!0;return!1})(B)&&$(B.extension.contentElement).find("."+i.rx).remove()}function se(B){return ce.fF.assert(function(){return!(B instanceof Date)||(0,ee.M4)(B)},"dates should implement DateWithEpochValue"),(0,ee.M4)(B)&&(B=j.y3.fromDateWithEpochValue(B).toString()),String(B)}function a(B){return B+2}function w(B){return B+2}},74304:function(Te,Pe,A){A.d(Pe,{U:function(){return l}});var N=A(81337),pe=A(67016),Q=A(60014),oe=A(85196),ce=A(29324),ee=A(54522),K=A(56707),G=A(85028),j=A(32105),ae=A(33024),i=A(55007),P=A(85308),o=A(62458),t=A(56578),h=A(64329),b=A(82755),V=A(76045),H=A(91059),X=A(96915),J=A(82386),Y=A(86878),c=A(72489),C=A(71090),d=A(73889),T=A(66842),U=A(40845),D=10,l=function(){function p(s){this.tablixProperties=new i.FX(s)}return p.getMetadataObjects=function(s){return s&&s.metadata?s.metadata.objects:null},p.prototype.enumerateObjectRepetition=function(s,n,u,S){var y,f,m,R,x,O,W;o.fF.assertValue(s,"enumeration should be defined"),o.fF.assertValue(n,"dataView can't be undefined");var ne,te=this.getSelectorData(u);switch(u){case d.Y.Table:case d.Y.TableEx:ne=this.getTableColumnMetadata(n);break;case d.Y.Matrix:case d.Y.PivotTable:ne=this.getMatrixValuesColumnMetadata(n);break;default:return void o.fF.assertNever(u)}if(ne){ne=_.uniq(ne);for(var de=u===d.Y.PivotTable||u===d.Y.TableEx,le=0,z=ne;le<z.length;le++){var se=z[le],ve=null===(W=se.type.misc)||void 0===W?void 0:W.sparkline;if(de){var Ce={containerName:se.displayName,selector:this.getSelector(se.queryName,te),allowOverrideSubtotalMatching:!0,objects:(f={},f[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},f)};if(s.push(Ce),!ve){var M={containerName:se.displayName,selector:this.getSelector(se.queryName,te),allowOverrideSubtotalMatching:!0,objects:(m={},m[this.tablixProperties.PropValuesFontColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesFontColor.propertyName]},m)};s.push(M)}if(se.type.numeric&&!ve){var a={containerName:se.displayName,selector:this.getSelector(se.queryName),objects:(R={},R[i.FX.PropColumnFormattingDataBars.objectName]={formattingProperties:[i.FX.PropColumnFormattingDataBars.propertyName]},R)};s.push(a)}var w={containerName:se.displayName,selector:this.getSelector(se.queryName,te),altStaticSelector:this.getSelector(se.queryName),allowOverrideSubtotalMatching:!0,objects:(x={},x[i.FX.PropValuesIcon.objectName]={formattingProperties:[i.FX.PropValuesIcon.propertyName]},x)};if(s.push(w),de&&S?.conditionalTablixWebURL&&!(0,ee.cR)(se)&&!ve){var L={containerName:se.displayName,selector:this.getSelector(se.queryName,te),allowOverrideSubtotalMatching:!0,objects:(O={},O[i.FX.PropValuesWebURL.objectName]={formattingProperties:[i.FX.PropValuesWebURL.propertyName]},O)};s.push(L)}}else{if(!se.isMeasure||!se.type.numeric)continue;var be={containerName:se.displayName,selector:this.getSelector(se.queryName,te),objects:(y={},y[this.tablixProperties.PropValuesBackColor.objectName]={formattingProperties:[this.tablixProperties.PropValuesBackColor.propertyName]},y)};s.push(be)}}}},p.prototype.getSelectorData=function(s){switch(s){case d.Y.Table:return[(0,H.Yp)(["Values"])];case d.Y.TableEx:return[(0,X.Ue)(1)];case d.Y.Matrix:return[(0,H.Yp)(["Rows","Columns"])];case d.Y.PivotTable:return[(0,X.Ue)(1)];default:return void o.fF.assertNever(s)}},p.prototype.getConditionalFormattingSelector=function(s,n,u){void 0===u&&(u=!0);var S=u?this.getSelectorData(s):void 0;return this.getSelector(n,S)},p.prototype.getSelector=function(s,n){var u={metadata:s};return n&&(u.data=n),u},p.prototype.getFormattingModel=function(s,n,u,S,y,f,m){void 0===y&&(y=!1),o.fF.assertValue(u,"dataView can't be undefined");var W,R=p.getMetadataObjects(u),x=n,O=n,te=this.getColumnsMetadata(u,S);W=S===d.Y.Table?this.shouldShowTableTotalsOption(u)&&i.FX.PropGeneralTableTotals.getValue(R):this.shouldShowColumnSubtotalsOption(u)&&i.FX.PropGeneralMatrixColumnSubtotals.getValue(R)||this.shouldShowRowSubtotalsOption(u)&&i.FX.PropGeneralMatrixRowSubtotals.getValue(R);var ne=this.getTablixTextClassProperties(m),de=new t.Nq(this.getStylePresetCard(s,x,S,f),this.getGridCard(s,n,S,R,ne,f),this.getBlankRowCard(s,x,S,f),this.getValueCard(s,n,S,R,f),this.getColumnHeadersCard(s,n,S,f),this.getRowHeadersCard(s,x,S,R,y,f),this.getTotalsCard(s,O,S,f),this.getColumnSubtotalCard(s,x,u,S,W,f),this.getRowSubTotalsCard(s,x,u,S,W,f),this.getColumnGrandTotalsCard(s,x,S),this.getRowGrandTotalsCard(s,x,S),this.getColumnFormattingCard(s,n,te,S),this.getCellColumnCard(s,S,u,f),this.getUrlIconCard(s,n,S),this.getImageSizeCard(s,n,S,f),this.getSparklinesCard(te,s,S)),le=this.getMatrixRowsColumnMetadata(u),z=this.getMatrixColumnsColumnMetadata(u),se=f.a11yShowAsMatrix?this.getAccessibilityCardNew(le,z,te,s,O,S):this.getAccessibilityCard(te,s,O,S);return se&&de.addCards(se),de.build()},p.prototype.getLayoutSlice=function(s,n){return new t.vi({uidBuilder:new t.IN(new t.SS(new t.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"layout"),control:new t.uY({descriptor:pe.t.general.layout,value:s.general.layout}).build(),localize:n}).build()},p.prototype.getIndentationSlice=function(s,n){if(s.general.layout===T.t.Compact){var u=s.rowHeaders;return new t.vi({uidBuilder:new t.IN(new t.SS(new t.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"indentation"),control:this.getIndentationSliderBuilder(u,n).build(),localize:n}).build()}},p.prototype.getRepeatRowHeadersSlice=function(s,n){if(s.general.layout!==T.t.Compact)return new t.vi({uidBuilder:new t.IN(new t.SS(new t.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"repeatRowHeaders"),control:new t.bd({descriptor:pe.t.rowHeaders.repeatRowHeaders,value:s.rowHeaders.repeatRowHeaders}).build(),localize:n}).build()},p.prototype.getStylePresetCard=function(s,n,u,S){var y=this,f="StylePresets";S.matrixLayouts&&u===d.Y.PivotTable&&(f="Layout_And_StylePresets");var m=function(O){return s.getLocalizedString(O)},R=new t.CQ(new t.lg("stylePreset"),f,[pe.t.general.layout,pe.t.rowHeaders.steppedLayoutIndentation,pe.t.rowHeaders.repeatRowHeaders],m);return R.addGroup(void 0,function(x){if(x.addSlicePlaceholder((0,t.E0)("stylePreset")),S.matrixLayouts&&u===d.Y.PivotTable){var O=y.getLayoutSlice(n,m),W=y.getIndentationSlice(n,m),te=y.getRepeatRowHeadersSlice(n,m);x.addSlice(O),W&&x.addSlice(W),te&&x.addSlice(te)}}),R.build()},p.prototype.getBlankRowCard=function(s,n,u,S){if(S.matrixLayouts&&u===d.Y.PivotTable){var y=function(x){return s.getLocalizedString(x)},f=pe.t.blankRows,m=new t.CQ(new t.lg("blankRows"),"Visual_Blank_Rows",f,y).addTopLevelToggle("blankRow",function(){return new t.bd({descriptor:f.showBlankRows,value:n.blankRows.showBlankRows}).build()});return m.addGroup("colors",function(R){R.withDisplayName("Generic_Color").addSimpleSlice("blankRowColor",function(){return new t.BT({descriptor:f.blankRowColor,value:{value:n.blankRows.blankRowColor}}).build()}).addSimpleSlice("blankRowTransparency",new t.JN({descriptor:f.blankRowTransparency,value:n.blankRows.blankRowTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:ae.t2},localize:y}).build(),function(x){return x.withCustomDisplayName("Transparency")})}),m.addGroup("border",function(R){R.withDisplayName("Visual_Border").addTopLevelToggle("blankRowBorder",function(){return new t.bd({descriptor:f.showBorder,value:n.blankRows.showBorder}).build()}).addSimpleSlice("blankRowBorderPosition",function(){return new t.uY({descriptor:f.borderPosition,value:n.blankRows.borderPosition}).build()}).addSimpleSlice("blankRowBorderColor",function(){return new t.BT({descriptor:f.borderColor,value:{value:n.blankRows.borderColor}}).build()}).addSimpleSlice("blankRowBorderTransparency",new t.JN({descriptor:f.borderTransparency,value:n.blankRows.borderTransparency,options:{minValue:{type:0,value:0},maxValue:{type:1,value:100},unitSymbol:ae.t2},localize:y}).build(),function(x){return x.withCustomDisplayName("Transparency")}).addSimpleSlice("blankRowBorderWidth",new t.mu({descriptor:f.borderWidth,value:n.blankRows.borderWidth,options:{minValue:{type:0,value:0},maxValue:{type:1,value:D},unitSymbol:ae.e_}}).build(),function(x){return x.withCustomDisplayName("Visual_General_Properties_Width")})}),m.build()}},p.prototype.getGridCard=function(s,n,u,S,y,f){var m=function(re){return s.getLocalizedString(re)},R=u===d.Y.TableEx?Q.Z.grid:pe.t.grid,x=u===d.Y.TableEx?Q.Z.values:pe.t.values,O=x.outlineStyle,W=x.outlineWeight,te=x.outlineColor,ne=u===d.Y.TableEx?Q.Z.columnHeaders:pe.t.columnHeaders,de=ne.outlineStyle,le=ne.outlineWeight,z=ne.outlineColor,se=u===d.Y.TableEx?Q.Z.total:pe.t.total,ve=se.outlineStyle,be=se.outlineWeight,Ce=se.outlineColor,M=pe.t.rowHeaders,a=M.outlineStyle,w=M.outlineWeight,L=M.outlineColor,ue=R.outlineStyle,fe=(0,N.__rest)(R,["imageHeight","imageWidth","outline","outlineStyle"]);fe=(0,N.__assign)((0,N.__assign)({},fe),{outlineStyle:ue,valuesOutlineStyle:O,valuesOutlineWeight:W,valuesOutlineColor:te,columnHeadersOutlineStyle:de,columnHeadersOutlineWeight:le,columnHeadersOutlineColor:z}),u===d.Y.TableEx&&(fe=(0,N.__assign)((0,N.__assign)({},fe),{totalsOutlineStyle:ve,totalsOutlineColor:Ce,totalsOutlineWeight:be})),u===d.Y.PivotTable&&(fe=(0,N.__assign)((0,N.__assign)({},fe),{rowHeaderOutlineStyle:a,rowHeaderOutlineWeight:w,rowHeaderOutlineColor:L}));var ge=n.grid,B=new t.CQ(new t.lg("grid"),"Visual_Grid",fe,m);return B.addGroup("gridHorizontal",function(E){E.withDisplayName("Visual_Gridline_Horizontal").addTopLevelToggle("gridHorizontal",function(){return new t.bd({descriptor:fe.gridHorizontal,value:ge.gridHorizontal}).build()}).addSimpleSlice("gridHorizontalColor",function(){return new t.BT({descriptor:fe.gridHorizontalColor,value:{value:ge.gridHorizontalColor}}).build()},function(re){return re.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridHorizontalWeight",new t.mu({descriptor:fe.gridHorizontalWeight,value:ge.gridHorizontalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:D}}}).build(),function(re){return re.withCustomDisplayName("Visual_General_Properties_Width")})}),B.addGroup("gridVertical",function(E){E.withDisplayName("Visual_Gridline_Vertical").addTopLevelToggle("gridVertical",function(){return new t.bd({descriptor:fe.gridVertical,value:ge.gridVertical}).build()}).addSimpleSlice("gridVerticalColor",function(){return new t.BT({descriptor:fe.gridVerticalColor,value:{value:ge.gridVerticalColor}}).build()},function(re){return re.withCustomDisplayName("Generic_Color")}).addSimpleSlice("gridVerticalWeight",new t.mu({descriptor:fe.gridVerticalWeight,value:ge.gridVerticalWeight,options:{minValue:{type:0,value:0},maxValue:{type:1,value:D}}}).build(),function(re){return re.withCustomDisplayName("Visual_General_Properties_Width")})}),B.addGroup("border",function(E){E.withDisplayName("Visual_Border").addContainer("outline",function(re){re.withDisplayName("Section"),re.addContainerItem("all",m("All"),function(he){he.addSimpleSlice("outlineStyle",function(){return new t.oM({descriptor:fe.outlineStyle,value:ge.outline}).build()},function(me){return me.withCustomDisplayName("Visual_Border_Position")}),he.addSimpleSlice("outlineColor",function(){return new t.BT({descriptor:fe.outlineColor,value:{value:ge.outlineColor}}).build()},function(me){return me.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeight",new t.mu({descriptor:fe.outlineWeight,value:ge.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:D}}}).build(),function(me){return me.withCustomDisplayName("Visual_General_Properties_Width")})}).addContainerItem("columnHeaders",m("Visual_Tablix_ColumnHeader"),function(he){var me=n.columnHeaders;he.addSimpleSlice("outlineStyleColumnHeaders",function(){return new t.oM({descriptor:de,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}),he.addSimpleSlice("outlineColorColumnHeaders",function(){return new t.BT({descriptor:z,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightColumnHeaders",new t.mu({descriptor:le,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:D}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})}),u===d.Y.PivotTable&&re.addContainerItem("rowHeaders",m("Visual_Tablix_RowHeaders"),function(he){var me=n.rowHeaders;he.addSimpleSlice("outlineStyleRowHeaders",function(){return new t.oM({descriptor:a,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}),he.addSimpleSlice("outlineColorRowHeaders",function(){return new t.BT({descriptor:L,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightRowHeaders",new t.mu({descriptor:w,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:D}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})}),re.addContainerItem("values",m("Visual_Tablix_ValuesSection"),function(he){var me=n.values;he.addSimpleSlice("outlineStyleValues",function(){return new t.oM({descriptor:O,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorValues",function(){return new t.BT({descriptor:te,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightValues",new t.mu({descriptor:W,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:D}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})}),u===d.Y.TableEx&&re.addContainerItem("outline-totals",m("Visual_Tablix_TotalsSection"),function(he){var me=n.total;he.addSimpleSlice("outlineStyleTotals",function(){return new t.oM({descriptor:ve,value:me.outline}).build()},function(ye){return ye.withCustomDisplayName("Visual_Border_Position")}).addSimpleSlice("outlineColorTotals",function(){return new t.BT({descriptor:Ce,value:{value:me.outlineColor}}).build()},function(ye){return ye.withCustomDisplayName("Generic_Color")}).addSimpleSlice("outlineWeightTotals",new t.mu({descriptor:be,value:me.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:D}}}).build(),function(ye){return ye.withCustomDisplayName("Visual_General_Properties_Width")})})})}),B.addGroup("options",function(E){E.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("rowPadding",new t.mu({descriptor:fe.rowPadding,value:ge.rowPadding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:20}}}).build()).addSimpleSlice("textSize",function(){return new t.mu({descriptor:fe.textSize,value:i.FX.PropGridPivotTableTextSize.setInstanceProperty(void 0,S,y.fontSizeOverrideFn,y.labelFontProperties.size&&y.labelFontProperties.size.pt),options:{minValue:{type:0,value:8},maxValue:{type:1,value:60}}}).build()},function(re){return re.withCustomDisplayName("Global_Font_Size")})}),B.build()},p.prototype.getValueCard=function(s,n,u,S,y){var le=(0,N.__rest)(u===d.Y.TableEx?Q.Z.values:pe.t.values,["webURL","urlIcon","icon","bandedRowHeaders","outlineStyle","outlineWeight","outlineColor"]),z=n.values,se=new t.CQ(new t.lg("values"),"Visual_Tablix_Values",le,function(M){return s.getLocalizedString(M)}),be=(new t.UN).withFontFamily({descriptor:le.fontFamily,value:z.fontFamily}).withFontSizeProperties({descriptor:le.fontSize,value:z.fontSize.pt}).withBold({descriptor:le.bold,value:z.bold}).withItalic({descriptor:le.italic,value:z.italic}).withUnderline({descriptor:le.underline,value:z.underline}).build();return se.addGroup("values",function(Ce){Ce.withDisplayName("Visual_Tablix_Values"),(u===d.Y.PivotTable||u===d.Y.TableEx)&&Ce.addCompositeSlice("font","Font",be),Ce.addSimpleSlice("fontColorPrimary",function(){return new t.BT({descriptor:le.fontColorPrimary,value:{value:z.fontColorPrimary}}).build()},function(M){return M.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColorPrimary",function(){return new t.BT({descriptor:le.backColorPrimary,value:{value:z.backColorPrimary}}).build()},function(M){return M.withCustomDisplayName("Background_Color")}).addSimpleSlice("fontColorSecondary",function(){return new t.BT({descriptor:le.fontColorSecondary,value:{value:z.fontColorSecondary}}).build()},function(M){return M.withCustomDisplayName("Visual_AlternateText_Color")}).addSimpleSlice("backColorSecondary",function(){return new t.BT({descriptor:le.backColorSecondary,value:{value:z.backColorSecondary}}).build()},function(M){return M.withCustomDisplayName("Visual_Tablix_BackColorSecondary")}).addSimpleSlice("textWrap",new t.bd({descriptor:le.wordWrap,value:z.wordWrap}).build(),function(M){return M.withCustomDisplayName("TextWrap")})}),u===d.Y.PivotTable&&se.addGroup("options",function(Ce){Ce.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("valuesOnRow",new t.bd({descriptor:le.valuesOnRow,value:i.FX.PropValuesOnRow.setInstanceProperty(void 0,S)}).build(),function(M){return M.withCustomDisplayName("Visual_PivotTable_ValuesSwitchToRows")})}),se.build()},p.prototype.getColumnHeadersCard=function(s,n,u,S){var W=(0,N.__rest)(u===d.Y.TableEx?Q.Z.columnHeaders:pe.t.columnHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor"]),te=n.columnHeaders,ne=new t.CQ(new t.lg("columnHeaders"),"Visual_Tablix_ColumnHeaders",W,function(se){return s.getLocalizedString(se)}),le=(new t.UN).withFontFamily({descriptor:W.fontFamily,value:te.fontFamily}).withFontSizeProperties({descriptor:W.fontSize,value:te.fontSize.pt}).withBold({descriptor:W.bold,value:te.bold}).withItalic({descriptor:W.italic,value:te.italic}).withUnderline({descriptor:W.underline,value:te.underline}).build();return ne.addGroup("text",function(z){z.withDisplayName("Text"),(u===d.Y.PivotTable||u===d.Y.TableEx)&&z.addCompositeSlice("font","Font",le),z.addSimpleSlice("fontColor",function(){return new t.BT({descriptor:W.fontColor,value:{value:te.fontColor}}).build()},function(ve){return ve.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new t.BT({descriptor:W.backColor,value:{value:te.backColor}}).build()},function(ve){return ve.withCustomDisplayName("Background_Color")}),(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&z.addSimpleSlice("alignment",new t.Gp({descriptor:W.alignment,value:te.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build(),function(ve){return ve.withCustomDisplayName("Visual_TextAlignment_Header")}),u===d.Y.PivotTable&&z.addSimpleSlice("titleAlignment",new t.Gp({descriptor:W.titleAlignment,value:n.columnHeaders.titleAlignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()),(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&z.addSimpleSlice("wordWrap",new t.bd({descriptor:W.wordWrap,value:te.wordWrap}).build(),function(ve){return ve.withCustomDisplayName("TextWrap")})}),(u===d.Y.PivotTable||u===d.Y.TableEx)&&ne.addGroup("options",function(z){z.withDisplayName("Desktop_FileMenu_Options").addSimpleSlice("autoSizeColumnWidth",new t.bd({descriptor:W.autoSizeColumnWidth,value:n.general.autoSizeColumnWidth}).build(),function(se){return se.withCustomDisplayName("Visual_AutoSize_Width")})}),ne.build()},p.prototype.getRowHeadersCard=function(s,n,u,S,y,f){var m=this;if(void 0===y&&(y=!1),u===d.Y.PivotTable){var R=function(a){return s.getLocalizedString(a)},le=(0,N.__rest)(pe.t.rowHeaders,["urlIcon","outlineStyle","outlineWeight","outlineColor","legacyStyleDisabled"]),z=pe.t.values.bandedRowHeaders;u===d.Y.PivotTable&&(le=(0,N.__assign)((0,N.__assign)({},le),{bandedRowHeaders:z}));var se=n.rowHeaders,ve=new t.CQ(new t.lg("rowHeaders"),"Visual_Tablix_RowHeaders",le,R),Ce=(new t.UN).withFontFamily({descriptor:le.fontFamily,value:se.fontFamily}).withFontSizeProperties({descriptor:le.fontSize,value:se.fontSize.pt}).withBold({descriptor:le.bold,value:se.bold}).withItalic({descriptor:le.italic,value:se.italic}).withUnderline({descriptor:le.underline,value:se.underline}).build();return ve.addGroup("text",function(M){M.withDisplayName("Text"),(u===d.Y.PivotTable||u===d.Y.TableEx)&&M.addCompositeSlice("font","Font",Ce),M.addSimpleSlice("fontColor",function(){return new t.BT({descriptor:le.fontColor,value:{value:se.fontColor}}).build()},function(a){return a.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new t.BT({descriptor:le.backColor,value:{value:se.backColor}}).build()},function(a){return a.withCustomDisplayName("Background_Color")}),u===d.Y.PivotTable&&M.addSimpleSlice("bandedRowHeaders",new t.bd({descriptor:le.bandedRowHeaders,value:i.FX.PropValuesBandedRowHeaders.setInstanceProperty(void 0,S)}).build()),M.addSimpleSlice("alignment",new t.Gp({descriptor:le.alignment,value:se.alignment,mode:"horizontalAlignment",supportsNoSelection:!0}).build()).addSimpleSlice("wordWrap",new t.bd({descriptor:le.wordWrap,value:se.wordWrap}).build(),function(a){return a.withCustomDisplayName("TextWrap")})}),u===d.Y.PivotTable&&y&&ve.addGroup("expandCollapseButtons",function(M){M.withDisplayName("Visual_PivotTable_ExpandCollapseButtons_Toggle"),M.addTopLevelToggle("showExpandCollapseButtons",function(){return new t.bd({descriptor:le.showExpandCollapseButtons,value:se.showExpandCollapseButtons}).build()}).addSimpleSlice("expandCollapseButtonsColor",function(){return new t.BT({descriptor:le.expandCollapseButtonsColor,value:{value:se.expandCollapseButtonsColor}}).build()},function(a){return a.withCustomDisplayName("Generic_Color")}).addSimpleSlice("expandCollapseButtonsSize",new t.mu({descriptor:le.expandCollapseButtonsSize,value:se.expandCollapseButtonsSize.pt,options:{minValue:{type:0,value:8},maxValue:{type:1,value:60},unitSymbol:"Numeric_Pixel"}}).build(),function(a){return a.withCustomDisplayName("Visual_BubbleSize")})}),f.matrixLayouts||ve.addGroup("options",function(M){M.withDisplayName("Desktop_FileMenu_Options"),M.addSimpleSlice("stepped",new t.bd({descriptor:le.stepped,value:se.steppedLayout}).build()).addSimpleSlice("steppedLayoutIndentation",m.getIndentationSliderBuilder(se,R).build())}),ve.build()}},p.prototype.getIndentationSliderBuilder=function(s,n){return new t.JN({descriptor:pe.t.rowHeaders.steppedLayoutIndentation,value:s.steppedLayoutIndentation,localize:n,options:{minValue:{type:0,value:0},maxValue:{type:1,value:150}}})},p.prototype.getTotalsCard=function(s,n,u,S){if(u===d.Y.TableEx){var O=(0,N.__rest)(u===d.Y.TableEx?Q.Z.total:pe.t.total,["outlineStyle","outlineWeight","outlineColor"]),W=n.total,te=new t.CQ(new t.lg("totals"),"Visual_Totals",O,function(z){return s.getLocalizedString(z)}),de=(new t.UN).withFontFamily({descriptor:O.fontFamily,value:W.fontFamily}).withFontSizeProperties({descriptor:O.fontSize,value:W.fontSize.pt}).withBold({descriptor:O.bold,value:W.bold}).withItalic({descriptor:O.italic,value:W.italic}).withUnderline({descriptor:O.underline,value:W.underline}).build();return te.addGroup("values",function(le){var z;le.withDisplayName("Visual_Tablix_Values"),u===d.Y.TableEx?(le.addTopLevelToggle("gridVertical",function(){return new t.bd({descriptor:O.totals,value:n.general.totals}).build()}),z=n.general.totals):z=!0,z&&le.addSimpleSlice("totalLabel",new t.fq({descriptor:O.label,value:W.totalLabel,placeholder:""}).build()).addCompositeSlice("font","Font",de),le.addSimpleSlice("fontColor",function(){return new t.BT({descriptor:O.fontColor,value:{value:W.fontColor}}).build()},function(se){return se.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new t.BT({descriptor:O.backColor,value:{value:W.backColor}}).build()},function(se){return se.withCustomDisplayName("Background_Color")})}),te.build()}},p.prototype.getColumnGrandTotalsCard=function(s,n,u){if(u!==d.Y.TableEx){var R=(0,N.__rest)(pe.t.columnTotal,["outlineStyle","outline"]),x=n.columnGrandTotal,O=new t.CQ(new t.lg("columnTotal"),"Visual_Tablix_Matrix_Column_TotalGrand",R,function(de){return s.getLocalizedString(de)}),te=(new t.UN).withFontFamily({descriptor:R.fontFamily,value:x.fontFamily}).withFontSizeProperties({descriptor:R.fontSize,value:x.fontSize.pt}).withBold({descriptor:R.bold,value:x.bold}).withItalic({descriptor:R.italic,value:x.italic}).withUnderline({descriptor:R.underline,value:x.underline}).build();return O.addGroup("values",function(ne){ne.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",te).addSimpleSlice("fontColor",function(){return new t.BT({descriptor:R.fontColor,value:{value:x.fontColor}}).build()},function(de){return de.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new t.BT({descriptor:R.backColor,value:{value:x.backColor}}).build()},function(de){return de.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new t.bd({descriptor:R.applyToHeaders,value:x.applyToHeaders}).build())}),O.build()}},p.prototype.getRowGrandTotalsCard=function(s,n,u){if(u!==d.Y.TableEx){var R=(0,N.__rest)(pe.t.rowTotal,["outlineStyle","outline"]),x=n.rowGrandTotal,O=new t.CQ(new t.lg("rowTotal"),"Visual_Tablix_Matrix_Row_TotalGrand",R,function(de){return s.getLocalizedString(de)}),te=(new t.UN).withFontFamily({descriptor:R.fontFamily,value:x.fontFamily}).withFontSizeProperties({descriptor:R.fontSize,value:x.fontSize.pt}).withBold({descriptor:R.bold,value:x.bold}).withItalic({descriptor:R.italic,value:x.italic}).withUnderline({descriptor:R.underline,value:x.underline}).build();return O.addGroup("values",function(ne){ne.withDisplayName("Visual_Tablix_Values").addCompositeSlice("font","Font",te).addSimpleSlice("fontColor",function(){return new t.BT({descriptor:R.fontColor,value:{value:x.fontColor}}).build()},function(de){return de.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){return new t.BT({descriptor:R.backColor,value:{value:x.backColor}}).build()},function(de){return de.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new t.bd({descriptor:R.applyToHeaders,value:x.applyToHeaders}).build())}),O.build()}},p.prototype.addAltTextGroup=function(s,n,u,S,y,f){_.isEmpty(S)||s.addGroup(n,function(m){m.withDisplayName("Visual_General_Properties_Description").withCollapsible(!1),m.addContainer("measure",function(R){R.withDisplayName(u);for(var x=function(de){var le;f===oe.r.rows||f===oe.r.columns?le={data:[(0,H.Yp)([f])]}:f===oe.r.values?le={data:[(0,X.Ue)(0)],metadata:de.queryName}:o.fF.assertFail("unexpected role"),R.addContainerItem(de.queryName,de.displayName,function(z){return z.addSimpleSlice("altTextColumns",new t.k0({descriptor:(0,N.__assign)((0,N.__assign)({},y.altTextColumns),{selector:le,instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},O=0,W=S;O<W.length;O++)x(W[O])})})},p.prototype.getAccessibilityCardNew=function(s,n,u,S,y,f){o.fF.assert(function(){return f===d.Y.TableEx||f===d.Y.PivotTable});var m=f===d.Y.TableEx?Q.Z.accessibility:pe.t.accessibility,R=_.filter(s,ee.pt),x=_.filter(n,ee.pt),O=_.filter(u,ee.pt),W=_.filter(u,function(le){return le.type.text}).map(function(le){return{displayName:le.displayName,value:le.queryName}});if(!(_.isEmpty(R)&&_.isEmpty(x)&&_.isEmpty(O))||f!==d.Y.PivotTable&&!_.isEmpty(W)){var ne=new t.CQ(new t.lg("accessibility"),"Accessibility",f===d.Y.TableEx?[m.altTextColumns,m.rowWithReferenceText]:[m.altTextColumns],function(z){return S.getLocalizedString(z)});if(this.addAltTextGroup(ne,"AltTextRowHeaders","Image_Alt_Text_Row_Headers",R,m,oe.r.rows),this.addAltTextGroup(ne,"AltTextColumnHeaders","Image_Alt_Text_Column_Headers",x,m,oe.r.columns),this.addAltTextGroup(ne,"AltTextValues","Image_Alt_Text_Values",O,m,oe.r.values),f===d.Y.TableEx&&!_.isEmpty(W)){var de={displayName:S.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};W.unshift(de),ne.addGroup("rowWithReferenceText",function(le){var z;le.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),le.addSimpleSlice("rowWithReferenceText",new t.uY({descriptor:(0,N.__assign)({},m.rowWithReferenceText),items:W,value:null!==(z=_.find(W,function(se){return se.value===y.rowWithReferenceText.rowWithReferenceText}))&&void 0!==z?z:W[0]}).build())})}return ne.build()}},p.prototype.getAccessibilityCard=function(s,n,u,S){if(S===d.Y.TableEx){var y=Q.Z.accessibility,f=_.filter(s,ee.pt),m=_.filter(s,function(W){return W.type.text}).map(function(W){return{displayName:W.displayName,value:W.queryName}});if(!_.isEmpty(f)||!_.isEmpty(m)){var x=new t.CQ(new t.lg("accessibility"),"Accessibility",[y.altTextColumns,y.rowWithReferenceText],function(te){return n.getLocalizedString(te)});if(_.isEmpty(f)||x.addGroup("AltTextValues",function(W){W.withDisplayName("Visual_Tablix_Accessibility_Group_AltText_Label").withCollapsible(!1),W.addContainer("measure",function(te){te.withDisplayName("Image_Alt_Text_Values");for(var ne=function(ve){te.addContainerItem(ve.queryName,ve.displayName,function(be){return be.addSimpleSlice("altTextColumns",new t.k0({descriptor:(0,N.__assign)((0,N.__assign)({},y.altTextColumns),{selector:{data:[(0,X.Ue)(0)],metadata:ve.queryName},instanceKind:2}),validators:{field:{kind:1,type:{text:!0}}},value:void 0,unwrapExprOnGet:!0}).build())})},de=0,le=f;de<le.length;de++)ne(le[de])})}),!_.isEmpty(m)){var O={displayName:n.getLocalizedString("Visual_Tablix_ReferenceRowDefaultText"),value:void 0};m.unshift(O),x.addGroup("rowWithReferenceText",function(W){var te;W.withDisplayName("Visual_Tablix_RowName_Label").withCollapsible(!1),W.addSimpleSlice("rowWithReferenceText",new t.uY({descriptor:(0,N.__assign)({},y.rowWithReferenceText),items:m,value:null!==(te=_.find(m,function(ne){return ne.value===u.rowWithReferenceText.rowWithReferenceText}))&&void 0!==te?te:m[0]}).build())})}return x.build()}}},p.prototype.getRowSubTotalsCard=function(s,n,u,S,y,f){var m=this;if(y||S===d.Y.PivotTable){var R=p.getMetadataObjects(u),x=i.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(void 0,R),O=function(z){return s.getLocalizedString(z)},W=pe.t.subTotals,te=(0,N.__assign)((0,N.__assign)({},n.subtotals),n.rowSubtotals),ne=new t.CQ(new t.lg("rowSubTotal"),"Visual_SubtotalRow",[W.rowSubtotalsLabel,W.rowSubtotals,W.rowSubtotalsPosition,W.perRowLevel,W.levelSubtotalEnabled,W.levelSubtotalLabel,W.fontColor,W.backColor,W.fontSize,W.fontFamily,W.bold,W.italic,W.underline,W.applyToHeaders],O);ne.addTopLevelToggle("rowSubtotals",function(){return new t.bd({descriptor:W.rowSubtotals,value:n.general.rowSubtotals}).build()});var de=0;return ne.addGroup("applySettingsTo",function(le){le.withContainerDisabled(!x).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perRowLevel",new t.bd({descriptor:W.perRowLevel,value:x}).build(),function(z){return z.withDisabled(!m.shouldShowRowSubtotalsOption(u)).withCustomDescriptionIf(function(){return!m.shouldShowRowSubtotalsOption(u)},"Visual_SubtotalRow_PerLevel_DisabledReason")}).addContainer("series",function(z){z.withDisplayName("Visual_Tablix_Row_Level"),z.addContainerItem("all",O("All"),function(L){return m.getRowSubtotalContainers(n,L,O,f,W,te,void 0,R)});for(var se=0,ve=u.matrix.rows.levels;se<ve.length;se++)for(var Ce=function(k){if(!k.isMeasure){var Z={metadata:k.queryName};z.addContainerItem(k.displayName,k.displayName,function(ie){return m.getRowSubtotalContainers(n,ie,O,f,W,te,Z,k.objects,de)}),de++}},M=0,a=ve[se].sources;M<a.length;M++)Ce(a[M])})}),ne.build()}},p.prototype.getRowSubtotalContainers=function(s,n,u,S,y,f,m,R,x){var O=m?i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(R,!0):i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(R,!0),W=m?"":u(C.qT),te=m?y.levelSubtotalLabel:y.rowSubtotalsLabel;n.addGroup("rows",function(ne){ne.withDisplayName("Role_DisplayName_Rows"),ne.addSimpleSlice("levelSubtotalEnabled",new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},y.levelSubtotalEnabled),{selector:m}),value:i.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,R)}).build(),function(de){return de.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!m)}).addSimpleSlice("rowSubtotalsLabel",new t.fq({descriptor:(0,N.__assign)((0,N.__assign)({},te),{selector:m}),value:O||W,placeholder:""}).build(),function(de){return de.withCustomDisplayName("Visual_Subtotal_Label")}).addSimpleSlice(m?"rowSubtotalsPositionSeries".concat(x):"rowSubtotalsPositionAll",new t.uY({descriptor:y.rowSubtotalsPosition,value:s.subtotals.rowSubtotalsPosition}).build(),function(de){return de.withCustomDisplayName("Visual_Position").withDisabled(!!m||S.matrixLayouts&&s.general.layout===T.t.Tabular)})}),n.addGroup("values",function(ne){if(ne.withDisplayName("Visual_Tablix_Values"),m)ne.withDisabled(!0,"");else{var de={id:"Row"},z=(new t.UN).withFontFamily({descriptor:(0,N.__assign)((0,N.__assign)({},y.fontFamily),{selector:de}),value:f.fontFamily}).withFontSizeProperties({descriptor:(0,N.__assign)((0,N.__assign)({},y.fontSize),{selector:de}),value:f.fontSize.pt}).withBold({descriptor:(0,N.__assign)((0,N.__assign)({},y.bold),{selector:de}),value:f.bold}).withItalic({descriptor:(0,N.__assign)((0,N.__assign)({},y.italic),{selector:de}),value:f.italic}).withUnderline({descriptor:(0,N.__assign)((0,N.__assign)({},y.underline),{selector:de}),value:f.underline}).build();ne.addCompositeSlice("font","Font",z).addSimpleSlice("fontColor",function(){var se={value:f.fontColor};return new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},y.fontColor),{selector:de}),value:se}).build()},function(se){return se.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var se={value:f.backColor};return new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},y.backColor),{selector:de}),value:se}).build()},function(se){return se.withCustomDisplayName("Background_Color")}).addSimpleSlice("applyToHeaders",new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},y.applyToHeaders),{selector:de}),value:f.applyToHeaders}).build())}})},p.prototype.getColumnSubtotalCard=function(s,n,u,S,y,f){var m=this;if(y||S===d.Y.PivotTable||this.shouldShowColumnSubtotalsOption(u)){var R=p.getMetadataObjects(u),x=i.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(R),O=function(le){return s.getLocalizedString(le)},W=pe.t.subTotals,te=(0,N.__assign)((0,N.__assign)({},n.subtotals),n.columnSubtotals),ne=new t.CQ(new t.lg("columnSubTotal"),"Visual_SubtotalColumn",[W.columnSubtotals,W.columnSubtotalsLabel,W.perColumnLevel,W.levelSubtotalEnabled,W.levelSubtotalLabel,W.fontColor,W.backColor,W.fontSize,W.fontFamily,W.bold,W.italic,W.underline,W.applyToHeaders],O);return ne.addTopLevelToggle("columnSubtotals",function(){return new t.bd({descriptor:W.columnSubtotals,value:n.general.columnSubtotals}).build()}),ne.addGroup("applySettingsTo",function(de){de.withContainerDisabled(!x).withDisplayName("Apply_Settings_To").withCollapsible(!1).addSimpleSlice("perColumnLevel",new t.bd({descriptor:W.perColumnLevel,value:x}).build(),function(le){return le.withDisabled(!m.shouldShowColumnSubtotalsOption(u)).withCustomDescriptionIf(function(){return!m.shouldShowColumnSubtotalsOption(u)},"Visual_SubtotalColumn_PerLevel_DisabledReason")}).addContainer("series",function(le){le.withDisplayName("Visual_Tablix_Column_Level"),le.addContainerItem("all",O("All"),function(w){return m.getColumnSubtotalContainers(w,O,f,W,te,void 0,R)});for(var z=0,se=u.matrix.columns.levels;z<se.length;z++)for(var be=function(L){if(!L.isMeasure){var k={metadata:L.queryName};le.addContainerItem(L.displayName,L.displayName,function(Z){return m.getColumnSubtotalContainers(Z,O,f,W,te,k,L.objects)})}},Ce=0,M=se[z].sources;Ce<M.length;Ce++)be(M[Ce])})}),ne.build()}},p.prototype.getColumnSubtotalContainers=function(s,n,u,S,y,f,m){var R=n(C.qT),x=f?i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(m,!0):i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(m,!0),O=f?S.levelSubtotalLabel:S.columnSubtotalsLabel;s.addGroup("columns",function(W){W.withDisplayName("Role_DisplayName_Columns"),W.addSimpleSlice("levelSubtotalEnabled",new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},S.levelSubtotalEnabled),{selector:f}),value:i.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(void 0,m)}).build(),function(te){return te.withCustomDisplayName("Visual_ShowSubtotal").withDisabled(!f)}).addSimpleSlice("columnSubtotalsLabel",new t.fq({descriptor:(0,N.__assign)((0,N.__assign)({},O),{selector:f}),value:x||R,placeholder:""}).build(),function(te){return te.withCustomDisplayName("Visual_Subtotal_Label")})}),s.addGroup("values",function(W){if(W.withDisplayName("Visual_Tablix_Values"),f)W.withDisabled(!0,"");else{var te={id:"Column"},de=(new t.UN).withFontFamily({descriptor:(0,N.__assign)((0,N.__assign)({},S.fontFamily),{selector:te}),value:y.fontFamily}).withFontSizeProperties({descriptor:(0,N.__assign)((0,N.__assign)({},S.fontSize),{selector:te}),value:y.fontSize.pt}).withBold({descriptor:(0,N.__assign)((0,N.__assign)({},S.bold),{selector:te}),value:y.bold}).withItalic({descriptor:(0,N.__assign)((0,N.__assign)({},S.italic),{selector:te}),value:y.italic}).withUnderline({descriptor:(0,N.__assign)((0,N.__assign)({},S.underline),{selector:te}),value:y.underline}).build();W.addCompositeSlice("font","Font",de).addSimpleSlice("fontColor",function(){var le={value:y.fontColor};return new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},S.fontColor),{selector:te}),value:le}).build()},function(le){return le.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var le={value:y.backColor};return new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},S.backColor),{selector:te}),value:le}).build()},function(le){return le.withCustomDisplayName("Background_Color")}),W.addSimpleSlice("applyToHeaders",new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},S.applyToHeaders),{selector:te}),value:y.applyToHeaders}).build())}})},p.prototype.getColumnFormattingCard=function(s,n,u,S){if(!_.isEmpty(u)){var R=(0,N.__rest)(S===d.Y.TableEx?Q.Z.columnFormatting:pe.t.columnFormatting,["dataBars"]),x=n.columnFormatting,O=new t.CQ(new t.lg("columnFormatting"),"Visual_Tablix_Specific_Column",R,function(te){return s.getLocalizedString(te)});return O.withDescription("Visual_Matrix_SpecificColumn_Description"),O.addGroup("columns",function(W){W.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(te){te.withDisplayName("Series");for(var ne=function(ve){var be=ve&&ve.objects;te.addContainerItem(ve.queryName,ve.displayName,function(Ce){Ce.addSimpleSlice(R.styleHeader,new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},R.styleHeader),{selector:{metadata:ve.queryName}}),value:x[ve.queryName].styleHeader}).build()),S===d.Y.PivotTable&&Ce.addSimpleSlice(R.styleSubtotals,new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},R.styleSubtotals),{selector:{metadata:ve.queryName}}),value:i.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(void 0,be)}).build()),Ce.addSimpleSlice(R.styleTotal,new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},R.styleTotal),{selector:{metadata:ve.queryName}}),value:x[ve.queryName].styleTotal}).build()).addSimpleSlice(R.styleValues,new t.bd({descriptor:(0,N.__assign)((0,N.__assign)({},R.styleValues),{selector:{metadata:ve.queryName}}),value:x[ve.queryName].styleValues}).build()),Ce.addGroup("values",function(M){if(M.withDisplayName("Visual_Tablix_Values").addSimpleSlice("fontColor",function(){var w={value:x[ve.queryName].fontColor};return new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},R.fontColor),{selector:{metadata:ve.queryName}}),value:w}).build()},function(w){return w.withCustomDisplayName("Text_Color")}).addSimpleSlice("backColor",function(){var w={value:x[ve.queryName].backColor};return new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},R.backColor),{selector:{metadata:ve.queryName}}),value:w}).build()},function(w){return w.withCustomDisplayName("Background_Color")}).addSimpleSlice("alignment",new t.Gp({descriptor:(0,N.__assign)((0,N.__assign)({},R.alignment),{selector:{metadata:ve.queryName}}),mode:"horizontalAlignment",supportsNoSelection:!0,value:x[ve.queryName].alignment}).build()),ve.type.numeric&&(S===d.Y.PivotTable||S===d.Y.TableEx)){var a=ve&&ve.objects;M.addSimpleSlice("labelDisplayUnits",new t.uY({descriptor:(0,N.__assign)((0,N.__assign)({},R.labelDisplayUnits),{selector:{metadata:ve.queryName}}),value:i.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(void 0,a)}).build()).addSimpleSlice("labelPrecision",new t.mu({descriptor:(0,N.__assign)((0,N.__assign)({},R.labelPrecision),{selector:{metadata:ve.queryName}}),value:i.FX.PropColumnFormattingPrecision.setInstanceProperty(void 0,a),options:{minValue:{type:0,value:0},maxValue:{type:1,value:K.vo}}}).build())}})})},de=0,le=u;de<le.length;de++)ne(le[de])})}),O.build()}},p.prototype.getCellColumnCard=function(s,n,u,S){var m=(0,Q.k)().objects,R=[];return this.enumerateObjectRepetition(R,u,n,S),(0,ce.Z)(R,function(O){return s.getLocalizedString(O)},m,"Cell_Elements","Visual_Matrix_CellElements_Description")},p.prototype.getUrlIconCard=function(s,n,u){var S=u===d.Y.TableEx?Q.Z.values.urlIcon:pe.t.values.urlIcon,y=n,f=pe.t.columnHeaders.urlIcon,m=pe.t.rowHeaders.urlIcon,x=new t.CQ(new t.lg("urlIcon"),"Visual_Tablix_UrlIcon",[S,f,m],function(W){return s.getLocalizedString(W)});return x.addGroup("urlIcon",function(O){(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&O.addSimpleSlice("values",new t.bd({descriptor:S,value:n.values.urlIcon}).build(),function(W){return W.withCustomDisplayName("Visual_Tablix_Values")}),u===d.Y.PivotTable&&O.addSimpleSlice("columnheaders",new t.bd({descriptor:f,value:y.columnHeaders.urlIcon}).build(),function(W){return W.withCustomDisplayName("Visual_Tablix_ColumnHeaders")}).addSimpleSlice("rowheaders",new t.bd({descriptor:m,value:y.rowHeaders.urlIcon}).build(),function(W){return W.withCustomDisplayName("Visual_Tablix_RowHeaders")})}),x.build()},p.prototype.getImageSizeCard=function(s,n,u,S){var y=u===d.Y.TableEx?Q.Z.grid.imageHeight:pe.t.grid.imageHeight,f=u===d.Y.TableEx?Q.Z.grid.imageWidth:pe.t.grid.imageWidth,R=new t.CQ(new t.lg("imageHeight"),"Visual_Tablix_ImageSize",[y,f],function(O){return s.getLocalizedString(O)});return R.addGroup("imageHeight",function(x){x.addSimpleSlice("imageHeight",new t.mu({descriptor:y,value:n.grid.imageHeight,options:{minValue:{type:0,value:p.ImageSizeMin},maxValue:{type:1,value:p.ImageSizeMax},unitSymbol:ae.e_}}).build()),S.tablixImageWidth&&x.addSimpleSlice("imageWidth",new t.mu({descriptor:f,value:n.grid.imageWidth,options:{minValue:{type:0,value:p.ImageSizeMin},maxValue:{type:1,value:p.ImageSizeMax},unitSymbol:ae.e_}}).build())}),R.build()},p.prototype.getSparklinesCard=function(s,n,u){var S=this;if(!_.isEmpty(s)&&this.hasSparklines(s)){var y=function(R){return n.getLocalizedString(R)},f=u===d.Y.TableEx?Q.Z.sparklines:pe.t.sparklines;return new t.CQ(new t.lg("sparklines"),"Sparkline_Label",f,y).addGroup("columns",function(m){return m.withDisplayName("Apply_Settings_To").withCollapsible(!1).addContainer("series",function(R){var x;R.withDisplayName("Sparkline_Singular_Label");for(var O=function(le){if(!(null===(x=le.type.misc)||void 0===x?void 0:x.sparkline))return"continue";var se=le?.objects,ve={metadata:le.queryName};R.addContainerItem(le.queryName,le.displayName,function(be){var Ce=i.FX.PropSparklinesChartType.setInstanceProperty(void 0,se);be.addGroup("sparklines",function(M){return M.withDisplayName("Sparkline_Singular_Label").addSimpleSlice("chartType",new t.uY({descriptor:(0,N.__assign)((0,N.__assign)({},f.chartType),{selector:ve}),value:Ce}).build()).addSimpleSlice("dataColor",new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},f.dataColor),{selector:ve}),value:{value:S.tablixProperties.PropSparklinesDataColor.setInstanceProperty(void 0,se).solid.color}}).build()).addSimpleSlice("strokeWidth",new t.JN({descriptor:(0,N.__assign)((0,N.__assign)({},f.strokeWidth),{selector:ve}),value:i.FX.PropSparklinesStrokeWidth.setInstanceProperty(void 0,se),localize:y,options:{minValue:{type:0,value:1},maxValue:{type:1,value:4}}}).build(),function(a){return a.withHidden(Ce!==P.U.line)})}),Ce===P.U.line&&be.addGroup("markers",function(M){var a=i.FX.PropSparklinesMarkerType.getValue(se);M.withDisplayName("Marker").addSimpleSlice("markers",new t.oM({descriptor:(0,N.__assign)((0,N.__assign)({},f.markers),{selector:ve}),value:a}).build()),null!=a&&0!==a&&M.addSimpleSlice("markerColor",new t.BT({descriptor:(0,N.__assign)((0,N.__assign)({},f.markerColor),{selector:ve}),value:{value:S.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(void 0,se).solid.color}}).build()).addSimpleSlice("markerShape",new t.uY({descriptor:(0,N.__assign)((0,N.__assign)({},f.markerShape),{selector:ve}),value:i.FX.PropSparklinesMarkerShape.setInstanceProperty(void 0,se)}).build()).addSimpleSlice("markerSize",new t.JN({descriptor:(0,N.__assign)((0,N.__assign)({},f.markerSize),{selector:ve}),value:i.FX.PropSparklinesMarkerSize.setInstanceProperty(void 0,se),localize:y,options:{minValue:{type:0,value:3},maxValue:{type:1,value:5}}}).build())})})},W=0,te=s;W<te.length;W++)O(te[W])})}).build()}},p.prototype.hasSparklines=function(s){for(var n,u=0,S=s;u<S.length;u++)if(null===(n=S[u].type.misc)||void 0===n?void 0:n.sparkline)return!0;return!1},p.prototype.enumerateObjectInstances=function(s,n,u,S,y,f,m,R){void 0===f&&(f={}),void 0===m&&(m=!1),o.fF.assertValue(u,"dataView can't be undefined");var W,x=p.getMetadataObjects(u),O=this.getTablixTextClassProperties(R);switch(W=S===d.Y.Table?this.shouldShowTableTotalsOption(u)&&i.FX.PropGeneralTableTotals.getValue(x):this.shouldShowColumnSubtotalsOption(u)&&i.FX.PropGeneralMatrixColumnSubtotals.getValue(x)||this.shouldShowRowSubtotalsOption(u)&&i.FX.PropGeneralMatrixRowSubtotals.getValue(x),s.objectName){case i.FX.ObjectGeneral:this.enumerateGeneralOptions(n,x,S,u);break;case i.FX.ObjectGrid:this.enumerateGridOptions(n,x,S,O,f);break;case i.FX.ObjectColumnHeaders:this.enumerateColumnHeadersOptions(n,x,S,O,f);break;case i.FX.ObjectRowHeaders:this.enumerateRowHeadersOptions(n,x,S,m,O,f);break;case i.FX.ObjectValues:this.enumerateValuesOptions(n,x,S,O,f);break;case i.FX.ObjectTotal:S===d.Y.TableEx?this.enumerateTotalOptions(n,x,d.Y.TableEx,y,f,O):W&&(S===d.Y.Table?this.enumerateTotalOptions(n,x,d.Y.TableEx,y,f,O):this.enumerateGrandTotalOptions(n,x,S,O));break;case i.FX.ObjectColumnTotal:S===d.Y.PivotTable&&this.enumerateColumnGrandTotalOptions(n,x,O,f);break;case i.FX.ObjectRowTotal:S===d.Y.PivotTable&&this.enumerateRowGrandTotalOptions(n,x,O,f);break;case i.FX.ObjectSubTotals:(W||S===d.Y.PivotTable)&&this.enumerateSubTotalsOptions(n,x,S,u,y,f,O);break;case i.FX.ObjectColumnFormatting:this.enumerateColumnFormattingOptions(n,this.getColumnsMetadata(u,S),S);break;case i.FX.ObjectSparklines:this.enumerateSparklines(n,this.getColumnsMetadata(u,S))}},p.prototype.getColumnsMetadata=function(s,n){switch(n){case d.Y.Table:case d.Y.TableEx:return this.getTableColumnMetadata(s);case d.Y.Matrix:case d.Y.PivotTable:return this.getMatrixValuesColumnMetadata(s);default:return void o.fF.assertFail("TablixUtils.enumerateObjectInstances - Unexpected tablixType: "+n)}},p.prototype.getTableColumnMetadata=function(s){if(s&&s.table&&!_.isEmpty(s.table.columns))return s.table.columns},p.prototype.getMatrixRowsColumnMetadata=function(s){if(s&&s.matrix&&!_.isEmpty(s.matrix.rows)){for(var n=[],u=0,S=s.matrix.rows.levels;u<S.length;u++)for(var f=0,m=S[u].sources;f<m.length;f++)n.push(m[f]);return n}},p.prototype.getMatrixColumnsColumnMetadata=function(s){if(s&&s.matrix&&!_.isEmpty(s.matrix.columns)){for(var n=[],u=0,S=s.matrix.columns.levels;u<S.length;u++)for(var f=0,m=S[u].sources;f<m.length;f++)n.push(m[f]);return n}},p.prototype.getMatrixValuesColumnMetadata=function(s){if(s&&s.matrix&&!_.isEmpty(s.matrix.valueSources))return s.matrix.valueSources},p.prototype.createVisualObjectInstance=function(s,n,u){void 0===n&&(n=null);var S={selector:n,objectName:s,properties:{}};return null!=u&&(S.displayName=u),S},p.prototype.enumerateGeneralOptions=function(s,n,u,S){var y=this.createVisualObjectInstance(i.FX.ObjectGeneral);switch(u){case d.Y.Table:i.FX.PropGeneralAutoSizeColumns.setInstanceProperty(y,n),i.FX.PropGeneralTextSize.setInstanceProperty(y,n),this.shouldShowTableTotalsOption(S)&&i.FX.PropGeneralTableTotals.setInstanceProperty(y,n);break;case d.Y.Matrix:i.FX.PropGeneralAutoSizeColumns.setInstanceProperty(y,n),i.FX.PropGeneralTextSize.setInstanceProperty(y,n),this.shouldShowRowSubtotalsOption(S)&&i.FX.PropGeneralMatrixRowSubtotals.setInstanceProperty(y,n),this.shouldShowColumnSubtotalsOption(S)&&i.FX.PropGeneralMatrixColumnSubtotals.setInstanceProperty(y,n)}s.pushInstance(y)},p.prototype.enumerateGridOptions=function(s,n,u,S,y){var f=this.createVisualObjectInstance(i.FX.ObjectGrid),m=S.labelFontProperties.size&&S.labelFontProperties.size.pt,R=i.FX.PropGridVertical.getValue(n);i.FX.PropGridVertical.setInstanceProperty(f,n),R&&(this.tablixProperties.PropGridVerticalColor.setInstanceProperty(f,n),i.FX.PropGridVerticalWeight.setInstanceProperty(f,n));var x=u===d.Y.Table||u===d.Y.TableEx,O=(x?i.FX.PropGridHorizontalTable:i.FX.PropGridHorizontalMatrix).getValue(n);(x?i.FX.PropGridHorizontalTable:i.FX.PropGridHorizontalMatrix).setInstanceProperty(f,n),O&&(this.tablixProperties.PropGridHorizontalColor.setInstanceProperty(f,n),i.FX.PropGridHorizontalWeight.setInstanceProperty(f,n)),i.FX.PropGridRowPadding.setInstanceProperty(f,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&i.FX.PropGridOutlineStyle.setInstanceProperty(f,n,this.outlineOverrideFn,i.e9),this.tablixProperties.PropGridOutlineColor.setInstanceProperty(f,n),i.FX.PropGridOutlineWeight.setInstanceProperty(f,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&i.FX.PropGridPivotTableTextSize.setInstanceProperty(f,n,S.fontSizeOverrideFn,m),i.FX.PropGridImageHeight.setInstanceProperty(f,n),s.pushInstance(f)},p.prototype.enumerateColumnHeadersOptions=function(s,n,u,S,y){var f=this.createVisualObjectInstance(i.FX.ObjectColumnHeaders),m=S.labelFontProperties.size&&S.labelFontProperties.size.pt;if(this.tablixProperties.PropColumnsFontColor.setInstanceProperty(f,n,S.fontColorOverrideFn,S.labelFontProperties.color),this.tablixProperties.PropColumnsBackColor.setInstanceProperty(f,n),u===d.Y.PivotTable||u===d.Y.TableEx){var x=this.ensureOutline(i.FX.PropColumnsOutlineStyle.getValue(n),n,i.UR);i.FX.PropColumnsOutlineStyle.setInstanceProperty(f,n,this.outlineOverrideFn,x);var O=this.ensureOutlineWeight(i.FX.PropColumnsOutlineWeight.getValue(n),n);i.FX.PropColumnsOutlineWeight.setInstanceProperty(f,n,this.outlineOverrideFn,O);var W=this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(n),n);this.tablixProperties.PropColumnsOutlineColor.setInstanceProperty(f,n,this.outlineOverrideFn,W),i.FX.PropColumnPivotTableAutoSizeColumns.setInstanceProperty(f,n),i.FX.PropColumnsFontFamily.setInstanceProperty(f,n,S.fontFamilyOverrideFn,S.labelFontProperties.family),i.FX.PropColumnsFontSize.setInstanceProperty(f,n,S.fontSizeOverrideFn,m),i.FX.PropColumnsBold.setInstanceProperty(f,n),i.FX.PropColumnsItalic.setInstanceProperty(f,n),i.FX.PropColumnsUnderline.setInstanceProperty(f,n),i.FX.PropColumnsAlignment.setInstanceProperty(f,n)}else i.FX.PropColumnsOutline.setInstanceProperty(f,n);u===d.Y.PivotTable&&(i.FX.PropColumnsAlignmentTitle.setInstanceProperty(f,n),i.FX.PropColumnsUrlIcon.setInstanceProperty(f,n)),(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&i.FX.PropColumnsWordWrap.setInstanceProperty(f,n),s.pushInstance(f)},p.prototype.enumerateRowHeadersOptions=function(s,n,u,S,y,f){void 0===S&&(S=!1);var m=this.createVisualObjectInstance(i.FX.ObjectRowHeaders),R=y.labelFontProperties.size&&y.labelFontProperties.size.pt;if(this.tablixProperties.PropRowsFontColor.setInstanceProperty(m,n,y.fontColorOverrideFn,y.labelFontProperties.color),this.tablixProperties.PropRowsBackColor.setInstanceProperty(m,n),u===d.Y.PivotTable||u===d.Y.TableEx){var O=this.ensureOutline(i.FX.PropRowsOutlineStyle.getValue(n),n,i.Pi);i.FX.PropRowsOutlineStyle.setInstanceProperty(m,n,this.outlineOverrideFn,O)}else i.FX.PropRowsOutline.setInstanceProperty(m,n);if(u===d.Y.PivotTable){var W=this.ensureOutlineWeight(i.FX.PropRowsOutlineWeight.getValue(n),n);i.FX.PropRowsOutlineWeight.setInstanceProperty(m,n,this.outlineOverrideFn,W);var te=this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(n),n);this.tablixProperties.PropRowsOutlineColor.setInstanceProperty(m,n,this.outlineOverrideFn,te),i.FX.PropRowsSteppedLayout.setInstanceProperty(m,n)&&i.FX.PropRowsSteppedLayoutIndentation.setInstanceProperty(m,n),i.FX.PropRowsUrlIcon.setInstanceProperty(m,n),i.FX.PropGeneralMatrixLayout.setInstanceProperty(m,n)!==T.t.Compact&&i.FX.PropRowsRepeatRowHeaders.setInstanceProperty(m,n)}(u===d.Y.Matrix||u===d.Y.PivotTable)&&i.FX.PropRowsWordWrap.setInstanceProperty(m,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropRowsFontFamily.setInstanceProperty(m,n,y.fontFamilyOverrideFn,y.labelFontProperties.family),i.FX.PropRowsFontSize.setInstanceProperty(m,n,y.fontSizeOverrideFn,R),i.FX.PropRowsBold.setInstanceProperty(m,n),i.FX.PropRowsItalic.setInstanceProperty(m,n),i.FX.PropRowsUnderline.setInstanceProperty(m,n),i.FX.PropRowsAlignment.setInstanceProperty(m,n)),u===d.Y.PivotTable&&S&&(i.FX.PropRowsShowExpandCollapseButtons.setInstanceProperty(m,n),i.FX.PropRowsShowExpandCollapseButtons.getValue(n)&&(this.tablixProperties.PropRowsExpandCollapseButtonsColor.setInstanceProperty(m,n),i.FX.PropRowsExpandCollapseButtonsSize.setInstanceProperty(m,n))),s.pushInstance(m)},p.prototype.enumerateValuesOptions=function(s,n,u,S,y){var f=this.createVisualObjectInstance(i.FX.ObjectValues),m=S.labelFontProperties.size&&S.labelFontProperties.size.pt;if(this.tablixProperties.PropValuesFontColorPrimary.setInstanceProperty(f,n,S.fontColorOverrideFn,S.labelFontProperties.color),this.tablixProperties.PropValuesBackColorPrimary.setInstanceProperty(f,n),this.tablixProperties.PropValuesFontColorSecondary.setInstanceProperty(f,n),this.tablixProperties.PropValuesBackColorSecondary.setInstanceProperty(f,n),u===d.Y.PivotTable&&(i.FX.PropValuesBandedRowHeaders.setInstanceProperty(f,n),i.FX.PropValuesOnRow.setInstanceProperty(f,n)),u===d.Y.PivotTable||u===d.Y.TableEx){var x=this.ensureOutline(i.FX.PropValuesOutlineStyle.getValue(n),n,i.IC);i.FX.PropValuesOutlineStyle.setInstanceProperty(f,n,this.outlineOverrideFn,x);var O=this.ensureOutlineWeight(i.FX.PropValuesOutlineWeight.getValue(n),n);i.FX.PropValuesOutlineWeight.setInstanceProperty(f,n,this.outlineOverrideFn,O);var W=this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(n),n);this.tablixProperties.PropValuesOutlineColor.setInstanceProperty(f,n,this.outlineOverrideFn,W)}else i.FX.PropValuesOutline.setInstanceProperty(f,n);(u===d.Y.Table||u===d.Y.TableEx||u===d.Y.PivotTable)&&i.FX.PropValuesUrlIcon.setInstanceProperty(f,n),(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropValuesWordWrap.setInstanceProperty(f,n),i.FX.PropValuesFontFamily.setInstanceProperty(f,n,S.fontFamilyOverrideFn,S.labelFontProperties.family),i.FX.PropValuesFontSize.setInstanceProperty(f,n,S.fontSizeOverrideFn,m),i.FX.PropValuesBold.setInstanceProperty(f,n),i.FX.PropValuesItalic.setInstanceProperty(f,n),i.FX.PropValuesUnderline.setInstanceProperty(f,n)),s.pushInstance(f)},p.prototype.enumerateTotalOptions=function(s,n,u,S,y,f){var m=this.createVisualObjectInstance(i.FX.ObjectTotal),R=f.boldLabelFontProperties.size&&f.boldLabelFontProperties.size.pt;if(u!==d.Y.TableEx||i.FX.PropTotalTableExTotals.setInstanceProperty(m,n)){if(u===d.Y.TableEx){var O=i.FX.PropTotalTableExTotalLabel.getValue(n,!0)||S(C.qT);m.properties[i.FX.PropTotalTableExTotalLabel.propertyName]=O}if(this.tablixProperties.PropTotalFontColor.setInstanceProperty(m,n,f.fontColorOverrideFn,f.boldLabelFontProperties.color),this.tablixProperties.PropTotalBackColor.setInstanceProperty(m,n),u===d.Y.PivotTable||u===d.Y.TableEx){var te=this.ensureOutline(i.FX.PropTotalOutlineStyle.getValue(n),n,i.Sc);i.FX.PropTotalOutlineStyle.setInstanceProperty(m,n,this.outlineOverrideFn,te)}else i.FX.PropTotalOutline.setInstanceProperty(m,n);if(u===d.Y.TableEx){var ne=this.ensureOutlineWeight(i.FX.PropTotalOutlineWeight.getValue(n),n);i.FX.PropTotalOutlineWeight.setInstanceProperty(m,n,this.outlineOverrideFn,ne);var de=this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(n),n);this.tablixProperties.PropTotalOutlineColor.setInstanceProperty(m,n,this.outlineOverrideFn,de)}(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropTotalFontFamily.setInstanceProperty(m,n,f.fontFamilyOverrideFn,f.boldLabelFontProperties.family),i.FX.PropTotalFontSize.setInstanceProperty(m,n,f.fontSizeOverrideFn,R),i.FX.PropTotalBold.setInstanceProperty(m,n),i.FX.PropTotalItalic.setInstanceProperty(m,n),i.FX.PropTotalUnderline.setInstanceProperty(m,n))}s.pushInstance(m)},p.prototype.enumerateGrandTotalOptions=function(s,n,u,S){if(u!==d.Y.PivotTable){var y=this.createVisualObjectInstance(i.FX.ObjectTotal),f=S.boldLabelFontProperties.size&&S.boldLabelFontProperties.size.pt;this.tablixProperties.PropGrandTotalFontColor.setInstanceProperty(y,n,S.fontColorOverrideFn,S.boldLabelFontProperties.color),i.FX.PropGrandTotalFontFamily.setInstanceProperty(y,n),this.tablixProperties.PropGrandTotalBackColor.setInstanceProperty(y,n),i.FX.PropGrandTotalApplyToHeaders.setInstanceProperty(y,n),u===d.Y.TableEx&&(i.FX.PropGrandTotalFontFamily.setInstanceProperty(y,n,S.fontFamilyOverrideFn,S.boldLabelFontProperties.family),i.FX.PropGrandTotalFontSize.setInstanceProperty(y,n,S.fontSizeOverrideFn,f),i.FX.PropGrandTotalBold.setInstanceProperty(y,n),i.FX.PropGrandTotalItalic.setInstanceProperty(y,n),i.FX.PropGrandTotalUnderline.setInstanceProperty(y,n)),s.pushInstance(y)}},p.prototype.enumerateColumnGrandTotalOptions=function(s,n,u,S){var y=this.createVisualObjectInstance(i.FX.ObjectColumnTotal),f=u.boldLabelFontProperties.size&&u.boldLabelFontProperties.size.pt;this.tablixProperties.PropColumnGrandTotalFontColor.setInstanceProperty(y,n,u.fontColorOverrideFn,u.boldLabelFontProperties.color),i.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(y,n),this.tablixProperties.PropColumnGrandTotalBackColor.setInstanceProperty(y,n),i.FX.PropColumnGrandTotalApplyToHeaders.setInstanceProperty(y,n),i.FX.PropColumnGrandTotalFontFamily.setInstanceProperty(y,n,u.fontFamilyOverrideFn,u.boldLabelFontProperties.family),i.FX.PropColumnGrandTotalFontSize.setInstanceProperty(y,n,u.fontSizeOverrideFn,f),i.FX.PropColumnGrandTotalBold.setInstanceProperty(y,n),i.FX.PropColumnGrandTotalItalic.setInstanceProperty(y,n),i.FX.PropColumnGrandTotalUnderline.setInstanceProperty(y,n),s.pushInstance(y)},p.prototype.enumerateRowGrandTotalOptions=function(s,n,u,S){var y=this.createVisualObjectInstance(i.FX.ObjectRowTotal),f=u.boldLabelFontProperties.size&&u.boldLabelFontProperties.size.pt;this.tablixProperties.PropRowGrandTotalFontColor.setInstanceProperty(y,n,u.fontColorOverrideFn,u.boldLabelFontProperties.color),i.FX.PropRowGrandTotalFontFamily.setInstanceProperty(y,n),this.tablixProperties.PropRowGrandTotalBackColor.setInstanceProperty(y,n),i.FX.PropRowGrandTotalApplyToHeaders.setInstanceProperty(y,n),i.FX.PropRowGrandTotalFontFamily.setInstanceProperty(y,n,u.fontFamilyOverrideFn,u.boldLabelFontProperties.family),i.FX.PropRowGrandTotalFontSize.setInstanceProperty(y,n,u.fontSizeOverrideFn,f),i.FX.PropRowGrandTotalBold.setInstanceProperty(y,n),i.FX.PropRowGrandTotalItalic.setInstanceProperty(y,n),i.FX.PropRowGrandTotalUnderline.setInstanceProperty(y,n),s.pushInstance(y)},p.prototype.enumerateSubTotalsOptions=function(s,n,u,S,y,f,m){var O,W,te,R=!1,x=!1;if(u===d.Y.PivotTable){o.fF.assertValue(y,"enumerateSubTotalsOptions - localizer"),O=y(C.qT);var ne=this.createVisualObjectInstance(i.FX.ObjectSubTotals);this.shouldShowRowSubtotalsOption(S)&&(R=i.FX.PropSubTotalsPivotTableRowSubtotals.setInstanceProperty(ne,n)),R&&(W=i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(n,!0)||O,ne.properties[i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.propertyName]=W),s.pushInstance(ne)}if(this.enumerateSubtotalsFontProperties(s,n,m,f,u,"Row"),R){ne=this.createVisualObjectInstance(i.FX.ObjectSubTotals),i.FX.PropSubTotalsPivotTableRowSubtotalsPosition.setInstanceProperty(ne,n),s.pushInstance(ne),ne=this.createVisualObjectInstance(i.FX.ObjectSubTotals);var de=i.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.setInstanceProperty(ne,n);s.pushInstance(ne,!1),de&&this.enumeratePerLevelSubtotals(s,S.matrix.rows.levels,W,y)}u===d.Y.PivotTable&&(ne=this.createVisualObjectInstance(i.FX.ObjectSubTotals),this.shouldShowColumnSubtotalsOption(S)&&(x=i.FX.PropSubTotalsPivotTableColumnSubtotals.setInstanceProperty(ne,n)),x&&(te=i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(n,!0)||O,ne.properties[i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.propertyName]=te),s.pushInstance(ne,!1)),this.enumerateSubtotalsFontProperties(s,n,m,f,u,"Column"),x&&(ne=this.createVisualObjectInstance(i.FX.ObjectSubTotals),de=i.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.setInstanceProperty(ne,n),s.pushInstance(ne,!1),o.fF.assert(function(){return!_.isEmpty(S.matrix.columns.levels)},"enumerateSubTotalsOptions: Empty column levels"),de&&this.enumeratePerLevelSubtotals(s,S.matrix.columns.levels,te,y))},p.prototype.enumerateSubtotalsFontProperties=function(s,n,u,S,y,f){var R=this.createVisualObjectInstance(i.FX.ObjectSubTotals,f?{id:f}:void 0),x=u.boldLabelFontProperties.size&&u.boldLabelFontProperties.size.pt;this.tablixProperties.PropSubTotalsFontColor.setInstanceProperty(R,n,u.fontColorOverrideFn,u.boldLabelFontProperties.color,f),i.FX.PropSubTotalsFontFamily.setInstanceProperty(R,n,void 0,void 0,f),this.tablixProperties.PropSubTotalsBackColor.setInstanceProperty(R,n,void 0,void 0,f),y===d.Y.PivotTable&&(i.FX.PropSubTotalsFontFamily.setInstanceProperty(R,n,u.fontFamilyOverrideFn,u.boldLabelFontProperties.family,f),i.FX.PropSubTotalsFontSize.setInstanceProperty(R,n,u.fontSizeOverrideFn,x,f),i.FX.PropSubTotalsBold.setInstanceProperty(R,n,void 0,void 0,f),i.FX.PropSubTotalsItalic.setInstanceProperty(R,n,void 0,void 0,f),i.FX.PropSubTotalsUnderline.setInstanceProperty(R,n,void 0,void 0,f),i.FX.PropSubTotalsApplyToHeaders.setInstanceProperty(R,n,void 0,void 0,f)),s.pushInstance(R)},p.prototype.enumeratePerLevelSubtotals=function(s,n,u,S){o.fF.assert(function(){return!_.isEmpty(n)},"enumeratePerLevelSubtotals: Empty levels");for(var y=0,f=n;y<f.length;y++)for(var R=0,x=f[y].sources;R<x.length;R++){var O=x[R];if(!O.isMeasure){var W=this.createVisualObjectInstance(i.FX.ObjectSubTotals,{metadata:O.queryName},O.displayName);i.FX.PropSubTotalsPivotTableLevelSubtotalEnabled.setInstanceProperty(W,O.objects),s.pushInstance(W,!1),W=this.createVisualObjectInstance(i.FX.ObjectSubTotals,{metadata:O.queryName},S("Visual_PivotTable_TotalLabel",O.displayName));var te=i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(O.objects,!0)||u;W.properties[i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.propertyName]=te,s.pushInstance(W,!1)}}},p.prototype.enumerateColumnFormattingOptions=function(s,n,u){if(!_.isEmpty(n))for(var S=0,y=n;S<y.length;S++){var f=y[S];s.pushContainer({displayName:f.displayName});var m=f&&f.objects,R=this.createVisualObjectInstance(i.FX.ObjectColumnFormatting,{metadata:f.queryName});f.type.numeric&&(u===d.Y.PivotTable||u===d.Y.TableEx)&&(i.FX.PropColumnFormattingDisplayUnits.setInstanceProperty(R,m),i.FX.PropColumnFormattingPrecision.setInstanceProperty(R,m),i.FX.PropColumnFormattingPrecision.setInstanceValidValues(R,{numberRange:{min:0,max:K.vo}})),this.tablixProperties.PropColumnFormattingFontColor.setInstanceProperty(R,m),this.tablixProperties.PropColumnFormattingBackColor.setInstanceProperty(R,m),(u===d.Y.PivotTable||u===d.Y.TableEx)&&i.FX.PropColumnFormattingAlignment.setInstanceProperty(R,m),i.FX.PropColumnFormattingStyleHeader.setInstanceProperty(R,m),i.FX.PropColumnFormattingStyleValues.setInstanceProperty(R,m),(u===d.Y.Matrix||u===d.Y.PivotTable)&&i.FX.PropColumnFormattingStyleSubtotals.setInstanceProperty(R,m),i.FX.PropColumnFormattingStyleTotal.setInstanceProperty(R,m),s.pushInstance(R),s.popContainer()}},p.prototype.enumerateSparklines=function(s,n){var u;if(!_.isEmpty(n))for(var S=0,y=n;S<y.length;S++){var f=y[S];if(null===(u=f.type.misc)||void 0===u?void 0:u.sparkline){s.pushContainer({displayName:f.displayName});var R=f&&f.objects,x=this.createVisualObjectInstance(i.FX.ObjectSparklines,{metadata:f.queryName});if(i.FX.PropSparklinesChartType.setInstanceProperty(x,R),this.tablixProperties.PropSparklinesDataColor.setInstanceProperty(x,R),i.FX.PropSparklinesChartType.getValue(R)===P.U.line){i.FX.PropSparklinesStrokeWidth.setInstanceProperty(x,R),i.FX.PropSparklinesStrokeWidth.setInstanceValidValues(x,{numberRange:{min:1,max:4}}),i.FX.PropSparklinesMarkerType.setInstanceProperty(x,R);var O=i.FX.PropSparklinesMarkerType.getValue(R);null!=O&&0!==O&&(this.tablixProperties.PropSparklinesMarkerColor.setInstanceProperty(x,R),i.FX.PropSparklinesMarkerSize.setInstanceProperty(x,R),i.FX.PropSparklinesMarkerSize.setInstanceValidValues(x,{numberRange:{min:3,max:5}}),i.FX.PropSparklinesMarkerShape.setInstanceProperty(x,R))}s.pushInstance(x),s.popContainer()}}},p.prototype.getTableObjects=function(s){var n=p.getMetadataObjects(s),u=i.FX.PropGeneralTextSize.getValue(n),S=null!=u?j.B.createFromPt(+u):void 0,y={general:{autoSizeColumnWidth:i.FX.PropGeneralAutoSizeColumns.getValue(n),textSize:S,totals:i.FX.PropGeneralTableTotals.getValue(n)}};y.grid={gridVertical:i.FX.PropGridVertical.getValue(n),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(n),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(n),gridHorizontal:i.FX.PropGridHorizontalTable.getValue(n),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(n),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(n),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(n),outlineWeight:i.FX.PropGridOutlineWeight.getValue(n),rowPadding:i.FX.PropGridRowPadding.getValue(n),imageHeight:i.FX.PropGridImageHeight.getValue(n)},y.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(n),backColor:this.tablixProperties.PropColumnsBackColor.getValue(n),outline:i.FX.PropColumnsOutline.getValue(n),wordWrap:i.FX.PropColumnsWordWrap.getValue(n)},y.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(n),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(n),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(n),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(n),outline:i.FX.PropValuesOutline.getValue(n),urlIcon:i.FX.PropValuesUrlIcon.getValue(n)},y.total={fontColor:this.tablixProperties.PropTotalFontColor.getValue(n),backColor:this.tablixProperties.PropTotalBackColor.getValue(n),outline:i.FX.PropTotalOutline.getValue(n)},y.columnFormatting={},y.formatters={};var f=this.getTableColumnMetadata(s);if(f)for(var m=0,R=f;m<R.length;m++){var x=R[m],O=x&&x.objects;y.columnFormatting[x.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(O),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(O),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(O),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(O),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(O)},y.formatters[x.queryName]=new c.g({column:x,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1})}return y},p.prototype.getMatrixObjects=function(s){var n=p.getMetadataObjects(s),u=i.FX.PropGeneralTextSize.getValue(n),S=null!=u?j.B.createFromPt(+u):void 0,y={general:{autoSizeColumnWidth:i.FX.PropGeneralAutoSizeColumns.getValue(n),textSize:S,rowSubtotals:i.FX.PropGeneralMatrixRowSubtotals.getValue(n),columnSubtotals:i.FX.PropGeneralMatrixColumnSubtotals.getValue(n),layout:i.FX.PropGeneralMatrixLayout.getValue(n)}};y.grid={gridVertical:i.FX.PropGridVertical.getValue(n),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(n),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(n),gridHorizontal:i.FX.PropGridHorizontalMatrix.getValue(n),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(n),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(n),outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(n),outlineWeight:i.FX.PropGridOutlineWeight.getValue(n),rowPadding:i.FX.PropGridRowPadding.getValue(n),imageHeight:i.FX.PropGridImageHeight.getValue(n)},y.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(n),backColor:this.tablixProperties.PropColumnsBackColor.getValue(n),outline:i.FX.PropColumnsOutline.getValue(n)},y.rowHeaders={fontColor:this.tablixProperties.PropRowsFontColor.getValue(n),backColor:this.tablixProperties.PropRowsBackColor.getValue(n),outline:i.FX.PropRowsOutline.getValue(n),wordWrap:i.FX.PropRowsWordWrap.getValue(n),repeatRowHeaders:i.FX.PropRowsRepeatRowHeaders.getValue(n)},y.values={fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(n),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(n),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(n),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(n),outline:i.FX.PropValuesOutline.getValue(n)},y.grandTotal={fontColor:this.tablixProperties.PropGrandTotalFontColor.getValue(n),backColor:this.tablixProperties.PropGrandTotalBackColor.getValue(n),applyToHeaders:i.FX.PropGrandTotalApplyToHeaders.getValue(n)},y.subtotals={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(n),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(n)},y.columnFormatting={},y.formatters={};var f=this.getMatrixValuesColumnMetadata(s);if(f)for(var m=0,R=f;m<R.length;m++){var x=R[m],O=x&&x.objects;y.columnFormatting[x.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(O),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(O),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(O),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(O),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(O),styleSubTotals:i.FX.PropColumnFormattingStyleSubtotals.getValue(O)},y.formatters[x.queryName]=new c.g({column:x,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1})}return this.addMatrixHierarchyColumnsFormatters(s.matrix.rows,y.formatters),this.addMatrixHierarchyColumnsFormatters(s.matrix.columns,y.formatters),y},p.prototype.addMatrixHierarchyColumnsFormatters=function(s,n,u){if(s){o.fF.assertValue(s.levels,"getMatrixHierarchyColumnsMetadata - hierarchy.levels");for(var S=0,y=s.levels;S<y.length;S++){var f=y[S];o.fF.assertValue(f.sources,"getMatrixHierarchyColumnsMetadata - level.sources");for(var m=0,R=f.sources;m<R.length;m++){var x=R[m];if(!x.isMeasure){var O=x.queryName;n[O]=new c.g({column:x,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1}),u&&(u[O]=new c.g({column:x,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!0}))}}}}},p.prototype.addMatrixHierarchySubtotalLabels=function(s,n,u,S){if(s){o.fF.assertValue(s.levels,"getMatrixHierarchyColumnsProperties - hierarchy.levels");for(var y=0,f=s.levels;y<f.length;y++){var m=f[y];o.fF.assertValue(m.sources,"getMatrixHierarchyColumnsProperties - level.sources");for(var R=void 0,x=0,O=m.sources;x<O.length;x++){var W=O[x];W.isMeasure||(S&&(R=i.FX.PropSubTotalsPivotTableLevelSubtotalLabel.getValue(W.objects)),R||(R=u),n[W.queryName]={subtotalLabel:R})}}}},p.prototype.getPivotTableObjects=function(s,n,u,S,y,f){var m,R,x,O,W,te,ne,de,le;void 0===f&&(f=!1);var z=p.getMetadataObjects(s),se=this.getTablixTextClassProperties(S),ve=se.labelFontProperties.size&&se.labelFontProperties.size.pt,be=se.boldLabelFontProperties.size&&se.boldLabelFontProperties.size.pt,Ce=i.FX.PropGridPivotTableTextSize.getValue(z,void 0,se.fontSizeOverrideFn,ve),M=null!=Ce?j.B.createFromPt(+Ce):void 0,a=i.FX.PropColumnsFontSize.getValue(z,void 0,se.fontSizeOverrideFn,ve),w=null!=a?j.B.createFromPt(+a):void 0,L=i.FX.PropRowsFontSize.getValue(z,void 0,se.fontSizeOverrideFn,ve),k=null!=L?j.B.createFromPt(+L):void 0,Z=i.FX.PropRowsExpandCollapseButtonsSize.getValue(z),ie=null!=Z?j.B.createFromPt(+Z):void 0,ue=i.FX.PropRowsExpandCompositeHierarchy.getValue(z),fe=i.FX.PropValuesFontSize.getValue(z,void 0,se.fontSizeOverrideFn,ve),ge=null!=fe?j.B.createFromPt(+fe):void 0,B=i.FX.PropGrandTotalFontSize.getValue(z,void 0,se.fontSizeOverrideFn,be),re=(null!=B&&j.B.createFromPt(+B),i.FX.PropColumnGrandTotalFontSize.getValue(z,void 0,se.fontSizeOverrideFn,be,void 0,["Column"])),he=null!=re?j.B.createFromPt(+re):void 0,me=i.FX.PropRowGrandTotalFontSize.getValue(z,void 0,se.fontSizeOverrideFn,be,void 0,["Row"]),ye=null!=me?j.B.createFromPt(+me):void 0,we=i.FX.PropSubTotalsFontSize.getValue(z,void 0,se.fontSizeOverrideFn,be),He=(null!=we&&j.B.createFromPt(+we),i.FX.PropSubTotalsFontSize.getValue(z,void 0,se.fontSizeOverrideFn,be,"Row")),Fe=null!=He?j.B.createFromPt(+He):void 0,xe=i.FX.PropSubTotalsFontSize.getValue(z,void 0,se.fontSizeOverrideFn,be,"Column"),Ve=null!=xe?j.B.createFromPt(+xe):void 0,Ie=n(C.qT),_e=i.FX.PropSubTotalsPivotTableRowSubtotalsLabel.getValue(z)||Ie,We=i.FX.PropSubTotalsPivotTableColumnSubtotalsLabel.getValue(z)||Ie,Ne=i.FX.PropRowsSteppedLayout.getValue(z),Ee=i.FX.PropGeneralMatrixLayout.getValue(z)||(Ne?T.t.Compact:T.t.Outline);y.matrixLayouts&&(Ne=Ee===T.t.Compact);var Oe={showBlankRows:i.FX.PropBlankRowsShowBlankRows.getValue(z),blankRowColor:null!==(m=this.tablixProperties.PropBlankRowsBlankRowColor.getValue(z))&&void 0!==m?m:this.tablixProperties.PropValuesBackColorPrimary.getValue(z),blankRowTransparency:i.FX.PropBlankRowsTransparency.getValue(z),showBorder:i.FX.PropBlankRowsShowBorder.getValue(z),borderPosition:null!==(R=i.FX.PropBlankRowsBorderPosition.getValue(z))&&void 0!==R?R:"Top",borderColor:null!==(x=this.tablixProperties.PropBlankRowsBorderColor.getValue(z))&&void 0!==x?x:S.colorPalette.foregroundNeutralSecondary.value,borderTransparency:i.FX.PropBlankRowsBorderTransparency.getValue(z),borderWidth:i.FX.PropBlankRowsBorderWidth.getValue(z)},Be={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(z,void 0,se.fontColorOverrideFn,se.boldLabelFontProperties.color,"Row"),fontFamily:i.FX.PropSubTotalsFontFamily.getValue(z,void 0,se.fontFamilyOverrideFn,se.boldLabelFontProperties.family,"Row"),fontSize:Fe,bold:i.FX.PropSubTotalsBold.getValue(z,void 0,void 0,void 0,"Row"),italic:i.FX.PropSubTotalsItalic.getValue(z,void 0,void 0,void 0,"Row"),underline:i.FX.PropSubTotalsUnderline.getValue(z,void 0,void 0,void 0,"Row"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(z,void 0,void 0,void 0,"Row"),applyToHeaders:i.FX.PropSubTotalsApplyToHeaders.getValue(z,void 0,void 0,void 0,"Row")},ze={fontColor:this.tablixProperties.PropSubTotalsFontColor.getValue(z,void 0,se.fontColorOverrideFn,se.boldLabelFontProperties.color,"Column"),fontFamily:i.FX.PropSubTotalsFontFamily.getValue(z,void 0,se.fontFamilyOverrideFn,se.boldLabelFontProperties.family,"Column"),fontSize:Ve,bold:i.FX.PropSubTotalsBold.getValue(z,void 0,void 0,void 0,"Column"),italic:i.FX.PropSubTotalsItalic.getValue(z,void 0,void 0,void 0,"Column"),underline:i.FX.PropSubTotalsUnderline.getValue(z,void 0,void 0,void 0,"Column"),backColor:this.tablixProperties.PropSubTotalsBackColor.getValue(z,void 0,void 0,void 0,"Column"),applyToHeaders:i.FX.PropSubTotalsApplyToHeaders.getValue(z,void 0,void 0,void 0,"Column")},Ke={fontColor:this.tablixProperties.PropColumnGrandTotalFontColor.getValue(z,void 0,se.fontColorOverrideFn,se.boldLabelFontProperties.color,void 0,["Column"]),fontFamily:i.FX.PropColumnGrandTotalFontFamily.getValue(z,void 0,se.fontFamilyOverrideFn,se.boldLabelFontProperties.family,void 0,["Column"]),fontSize:he,bold:i.FX.PropColumnGrandTotalBold.getValue(z),italic:i.FX.PropColumnGrandTotalItalic.getValue(z),underline:i.FX.PropColumnGrandTotalUnderline.getValue(z),backColor:this.tablixProperties.PropColumnGrandTotalBackColor.getValue(z),applyToHeaders:i.FX.PropColumnGrandTotalApplyToHeaders.getValue(z)},Ze={fontColor:this.tablixProperties.PropRowGrandTotalFontColor.getValue(z,void 0,se.fontColorOverrideFn,se.boldLabelFontProperties.color,void 0,["Row"]),fontFamily:i.FX.PropRowGrandTotalFontFamily.getValue(z,void 0,se.fontFamilyOverrideFn,se.boldLabelFontProperties.family,void 0,["Row"]),fontSize:ye,bold:i.FX.PropRowGrandTotalBold.getValue(z),italic:i.FX.PropRowGrandTotalItalic.getValue(z),underline:i.FX.PropRowGrandTotalUnderline.getValue(z),backColor:this.tablixProperties.PropRowGrandTotalBackColor.getValue(z),applyToHeaders:i.FX.PropRowGrandTotalApplyToHeaders.getValue(z)},Re={general:{autoSizeColumnWidth:i.FX.PropColumnPivotTableAutoSizeColumns.getValue(z),textSize:M,rowSubtotals:i.FX.PropSubTotalsPivotTableRowSubtotals.getValue(z),columnSubtotals:i.FX.PropSubTotalsPivotTableColumnSubtotals.getValue(z),layout:Ee},grid:{gridVertical:i.FX.PropGridVertical.getValue(z),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(z),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(z),gridHorizontal:i.FX.PropGridHorizontalMatrix.getValue(z),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(z),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(z),outline:i.FX.PropGridOutlineStyle.getValue(z)||i.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(z),outlineWeight:i.FX.PropGridOutlineWeight.getValue(z),rowPadding:i.FX.PropGridRowPadding.getValue(z),imageHeight:i.FX.PropGridImageHeight.getValue(z),imageWidth:i.FX.PropGridImageWidth.getValue(z)},columnHeaders:{fontColor:this.tablixProperties.PropColumnsFontColor.getValue(z,void 0,se.fontColorOverrideFn,se.labelFontProperties.color),fontFamily:i.FX.PropColumnsFontFamily.getValue(z,void 0,se.fontFamilyOverrideFn,se.labelFontProperties.family),fontSize:w,bold:i.FX.PropColumnsBold.getValue(z),italic:i.FX.PropColumnsItalic.getValue(z),underline:i.FX.PropColumnsUnderline.getValue(z),backColor:this.tablixProperties.PropColumnsBackColor.getValue(z),outline:this.ensureOutline(i.FX.PropColumnsOutlineStyle.getValue(z),z,i.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(z),z),outlineWeight:this.ensureOutlineWeight(i.FX.PropColumnsOutlineWeight.getValue(z),z),urlIcon:i.FX.PropColumnsUrlIcon.getValue(z),wordWrap:i.FX.PropColumnsWordWrap.getValue(z),alignment:i.FX.PropColumnsAlignment.getValue(z),titleAlignment:i.FX.PropColumnsAlignmentTitle.getValue(z)},rowHeaders:{fontColor:this.tablixProperties.PropRowsFontColor.getValue(z,void 0,se.fontColorOverrideFn,se.labelFontProperties.color),fontFamily:i.FX.PropRowsFontFamily.getValue(z,void 0,se.fontFamilyOverrideFn,se.labelFontProperties.family),fontSize:k,bold:i.FX.PropRowsBold.getValue(z),italic:i.FX.PropRowsItalic.getValue(z),underline:i.FX.PropRowsUnderline.getValue(z),backColor:this.tablixProperties.PropRowsBackColor.getValue(z),outline:this.ensureOutline(i.FX.PropRowsOutlineStyle.getValue(z),z,i.Pi),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropRowsOutlineColor.getValue(z),z),outlineWeight:this.ensureOutlineWeight(i.FX.PropRowsOutlineWeight.getValue(z),z),steppedLayout:Ne,steppedLayoutIndentation:i.FX.PropRowsSteppedLayoutIndentation.getValue(z),urlIcon:i.FX.PropRowsUrlIcon.getValue(z),wordWrap:i.FX.PropRowsWordWrap.getValue(z),alignment:i.FX.PropRowsAlignment.getValue(z),showExpandCollapseButtons:!!u&&i.FX.PropRowsShowExpandCollapseButtons.getValue(z),expandCollapseButtonsColor:this.tablixProperties.PropRowsExpandCollapseButtonsColor.getValue(z),expandCollapseButtonsSize:ie,expandCompositeHierarchy:ue,repeatRowHeaders:i.FX.PropRowsRepeatRowHeaders.getValue(z),legacyStyleDisabled:i.FX.PropRowsLegacyStyleDisabled.getValue(z)},values:{fontFamily:i.FX.PropValuesFontFamily.getValue(z,void 0,se.fontFamilyOverrideFn,se.labelFontProperties.family),fontSize:ge,bold:i.FX.PropValuesBold.getValue(z),italic:i.FX.PropValuesItalic.getValue(z),underline:i.FX.PropValuesUnderline.getValue(z),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(z,void 0,se.fontColorOverrideFn,se.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(z),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(z),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(z),bandedRowHeaders:i.FX.PropValuesBandedRowHeaders.getValue(z),outline:this.ensureOutline(i.FX.PropValuesOutlineStyle.getValue(z),z,i.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(z),z),outlineWeight:this.ensureOutlineWeight(i.FX.PropValuesOutlineWeight.getValue(z),z),urlIcon:i.FX.PropValuesUrlIcon.getValue(z),wordWrap:i.FX.PropValuesWordWrap.getValue(z),valuesOnRow:i.FX.PropValuesOnRow.getValue(z)},columnGrandTotal:Ke,rowGrandTotal:Ze,subtotals:{rowSubtotalsPosition:Ee===T.t.Tabular?U.I:i.FX.PropSubTotalsPivotTableRowSubtotalsPosition.getValue(z),rowSubtotalsLabel:_e,columnSubtotalsLabel:We},rowSubtotals:Be,columnSubtotals:ze,blankRows:Oe,columnFormatting:{},formatters:{},tooltipFormatters:{},sparklines:{}},Ae=this.getMatrixValuesColumnMetadata(s);if(Ae)for(var ke=0,Ue=Ae;ke<Ue.length;ke++){var Se=Ue[ke],Le=Se&&Se.objects;Re.columnFormatting[Se.queryName]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(Le),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(Le),alignment:i.FX.PropColumnFormattingAlignment.getValue(Le),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(Le),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(Le),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(Le),styleSubTotals:i.FX.PropColumnFormattingStyleSubtotals.getValue(Le),dataBarsSettings:i.FX.PropColumnFormattingDataBars.getValue(Le),icon:i.FX.PropValuesIcon.getValue(Le)};var Xe=void 0,De=void 0;if(Se.type.numeric&&(Xe=i.FX.PropColumnFormattingDisplayUnits.getValue(Le),De=i.FX.PropColumnFormattingPrecision.getValue(Le)),Re.formatters[Se.queryName]=new c.g({column:Se,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:Xe,precision:De,trailingZeroes:!0}),Re.tooltipFormatters[Se.queryName]=new c.g({column:Se,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:Xe,precision:De,trailingZeroes:!0}),null!==(O=Se.type.misc)&&void 0!==O&&O.sparkline){var Ye=i.FX.PropSparklinesChartType.getValue(Le),je=new g(Se.displayName,Se.type,n);Re.formatters[Se.queryName]=je,Re.tooltipFormatters[Se.queryName]=je,Re.sparklines[Se.queryName]={chartType:Ye,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(Le).solid.color,strokeWidth:i.FX.PropSparklinesStrokeWidth.getValue(Le),marker:{show:!0,typeFlags:i.FX.PropSparklinesMarkerType.getValue(Le),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(Le).solid.color,size:i.FX.PropSparklinesMarkerSize.getValue(Le),shape:i.FX.PropSparklinesMarkerShape.getValue(Le)}}}}f&&(Re.annotationFormatting={columnHeaders:{}},_.forEach(null===(W=s.metadata)||void 0===W?void 0:W.columns,function(Qe){var Je;if(null!==(Je=Qe.objects)&&void 0!==Je&&Je.annotations){var Ge=(0,b.NA)(Qe.objects,pe.t.annotations.highlights);Ge&&(null!=Ge.backColor||!0===Ge.emphasizeText)&&(Re.annotationFormatting.columnHeaders[Qe.queryName]={backColor:Ge.backColor,bold:Ge.emphasizeText})}}),_.isEmpty(Re.annotationFormatting.columnHeaders)&&(Re.annotationFormatting=void 0));var $e=i.FX.PropSubTotalsPivotTableRowSubtotalsPerLevel.getValue(z),qe=i.FX.PropSubTotalsPivotTableColumnSubtotalsPerLevel.getValue(z);return this.addMatrixHierarchySubtotalLabels(null===(te=s?.matrix)||void 0===te?void 0:te.rows,Re.columnFormatting,_e,$e),this.addMatrixHierarchySubtotalLabels(null===(ne=s?.matrix)||void 0===ne?void 0:ne.columns,Re.columnFormatting,We,qe),this.addMatrixHierarchyColumnsFormatters(null===(de=s?.matrix)||void 0===de?void 0:de.rows,Re.formatters,Re.tooltipFormatters),this.addMatrixHierarchyColumnsFormatters(null===(le=s?.matrix)||void 0===le?void 0:le.columns,Re.formatters,Re.tooltipFormatters),Re},p.prototype.getTableExObjects=function(s,n,u,S){var y,f=p.getMetadataObjects(s),m=this.getTablixTextClassProperties(u),R=m.labelFontProperties.size&&m.labelFontProperties.size.pt,x=m.boldLabelFontProperties.size&&m.boldLabelFontProperties.size.pt,O=i.FX.PropGridPivotTableTextSize.getValue(f),W=null!=O?j.B.createFromPt(+O):void 0,te=i.FX.PropColumnsFontSize.getValue(f,void 0,m.fontSizeOverrideFn,R),ne=null!=te?j.B.createFromPt(+te):void 0,de=i.FX.PropValuesFontSize.getValue(f,void 0,m.fontSizeOverrideFn,R),le=null!=de?j.B.createFromPt(+de):void 0,z=i.FX.PropTotalFontSize.getValue(f,void 0,m.fontSizeOverrideFn,x),se=null!=z?j.B.createFromPt(+z):void 0,ve=i.FX.ProprowWithReferenceText.getValue(f),be={general:{autoSizeColumnWidth:i.FX.PropColumnPivotTableAutoSizeColumns.getValue(f),textSize:W,totals:i.FX.PropTotalTableExTotals.getValue(f)}};be.grid={gridVertical:i.FX.PropGridVertical.getValue(f),gridVerticalColor:this.tablixProperties.PropGridVerticalColor.getValue(f),gridVerticalWeight:i.FX.PropGridVerticalWeight.getValue(f),gridHorizontal:i.FX.PropGridHorizontalTable.getValue(f),gridHorizontalColor:this.tablixProperties.PropGridHorizontalColor.getValue(f),gridHorizontalWeight:i.FX.PropGridHorizontalWeight.getValue(f),outline:i.FX.PropGridOutlineStyle.getValue(f)||i.e9,outlineColor:this.tablixProperties.PropGridOutlineColor.getValue(f),outlineWeight:i.FX.PropGridOutlineWeight.getValue(f),rowPadding:i.FX.PropGridRowPadding.getValue(f),imageHeight:i.FX.PropGridImageHeight.getValue(f),imageWidth:i.FX.PropGridImageWidth.getValue(f)},be.columnHeaders={fontColor:this.tablixProperties.PropColumnsFontColor.getValue(f,void 0,m.fontColorOverrideFn,m.labelFontProperties.color),fontFamily:i.FX.PropColumnsFontFamily.getValue(f,void 0,m.fontFamilyOverrideFn,m.labelFontProperties.family),fontSize:ne,bold:i.FX.PropColumnsBold.getValue(f),italic:i.FX.PropColumnsItalic.getValue(f),underline:i.FX.PropColumnsUnderline.getValue(f),backColor:this.tablixProperties.PropColumnsBackColor.getValue(f),outline:this.ensureOutline(i.FX.PropColumnsOutlineStyle.getValue(f),f,i.UR),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropColumnsOutlineColor.getValue(f),f),outlineWeight:this.ensureOutlineWeight(i.FX.PropColumnsOutlineWeight.getValue(f),f),wordWrap:i.FX.PropColumnsWordWrap.getValue(f),alignment:i.FX.PropColumnsAlignment.getValue(f)},be.values={fontFamily:i.FX.PropValuesFontFamily.getValue(f,void 0,m.fontFamilyOverrideFn,m.labelFontProperties.family),fontSize:le,bold:i.FX.PropValuesBold.getValue(f),italic:i.FX.PropValuesItalic.getValue(f),underline:i.FX.PropValuesUnderline.getValue(f),fontColorPrimary:this.tablixProperties.PropValuesFontColorPrimary.getValue(f,void 0,m.fontColorOverrideFn,m.labelFontProperties.color),backColorPrimary:this.tablixProperties.PropValuesBackColorPrimary.getValue(f),fontColorSecondary:this.tablixProperties.PropValuesFontColorSecondary.getValue(f),backColorSecondary:this.tablixProperties.PropValuesBackColorSecondary.getValue(f),outline:this.ensureOutline(i.FX.PropValuesOutlineStyle.getValue(f),f,i.IC),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropValuesOutlineColor.getValue(f),f),outlineWeight:this.ensureOutlineWeight(i.FX.PropValuesOutlineWeight.getValue(f),f),urlIcon:i.FX.PropValuesUrlIcon.getValue(f),wordWrap:i.FX.PropValuesWordWrap.getValue(f)};var Ce=i.FX.PropTotalTableExTotalLabel.getValue(f);be.total={totalLabel:Ce||n(C.qT),totalPlaceholderLabel:n(C.bn),isDefaultTotalLabel:!Ce,fontFamily:i.FX.PropTotalFontFamily.getValue(f,void 0,m.fontFamilyOverrideFn,m.boldLabelFontProperties.family),fontSize:se,bold:i.FX.PropTotalBold.getValue(f),italic:i.FX.PropTotalItalic.getValue(f),underline:i.FX.PropTotalUnderline.getValue(f),fontColor:this.tablixProperties.PropTotalFontColor.getValue(f,void 0,m.fontColorOverrideFn,m.boldLabelFontProperties.color),backColor:this.tablixProperties.PropTotalBackColor.getValue(f),outline:this.ensureOutline(i.FX.PropTotalOutlineStyle.getValue(f),f,i.Sc),outlineColor:this.ensureOutlineColor(this.tablixProperties.PropTotalOutlineColor.getValue(f),f),outlineWeight:this.ensureOutlineWeight(i.FX.PropTotalOutlineWeight.getValue(f),f)},be.columnFormatting={},be.formatters={},be.tooltipFormatters={},be.sparklines={};var M=this.getTableColumnMetadata(s);if(M)for(var a=0,w=M;a<w.length;a++){var L=w[a];if(L){var k=L.objects,Z=L.queryName;be.columnFormatting[Z]={fontColor:this.tablixProperties.PropColumnFormattingFontColor.getValue(k),backColor:this.tablixProperties.PropColumnFormattingBackColor.getValue(k),alignment:i.FX.PropColumnFormattingAlignment.getValue(k),styleHeader:i.FX.PropColumnFormattingStyleHeader.getValue(k),styleValues:i.FX.PropColumnFormattingStyleValues.getValue(k),styleTotal:i.FX.PropColumnFormattingStyleTotal.getValue(k),dataBarsSettings:i.FX.PropColumnFormattingDataBars.getValue(k),icon:i.FX.PropValuesIcon.getValue(k)};var ie=void 0,ue=void 0;if(L.type.numeric&&(ie=i.FX.PropColumnFormattingDisplayUnits.getValue(k),ue=i.FX.PropColumnFormattingPrecision.getValue(k)),be.formatters[Z]=new c.g({column:L,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!1,displayUnit:ie,precision:ue,trailingZeroes:!0}),be.tooltipFormatters[Z]=new c.g({column:L,formatStringPropId:i.FX.PropColumnFormatString,nullsAreBlank:!0,displayUnit:ie,precision:ue,trailingZeroes:!0}),null!==(y=L.type.misc)&&void 0!==y&&y.sparkline){var fe=i.FX.PropSparklinesChartType.getValue(k),ge=new g(L.displayName,L.type,n);be.formatters[Z]=ge,be.tooltipFormatters[Z]=ge,be.sparklines[Z]={chartType:fe,dataColor:this.tablixProperties.PropSparklinesDataColor.getValue(k).solid.color,strokeWidth:i.FX.PropSparklinesStrokeWidth.getValue(k),marker:{show:!0,typeFlags:i.FX.PropSparklinesMarkerType.getValue(k),color:this.tablixProperties.PropSparklinesMarkerColor.getValue(k).solid.color,size:i.FX.PropSparklinesMarkerSize.getValue(k),shape:i.FX.PropSparklinesMarkerShape.getValue(k)}}}}}return be.rowWithReferenceText={rowWithReferenceText:ve},be},p.prototype.ensureOutline=function(s,n,u){var S;return null!==(S=s??i.FX.PropGridOutlineStyle.getValue(n))&&void 0!==S?S:u},p.prototype.ensureOutlineWeight=function(s,n){return s??i.FX.PropGridOutlineWeight.getValue(n)},p.prototype.outlineOverrideFn=function(s,n){return!!(0,b.NA)(s,n)},p.prototype.ensureOutlineColor=function(s,n){return s??this.tablixProperties.PropGridOutlineColor.getValue(n)},p.getTextSizeInPx=function(s){return h.FP.toString(s.px)},p.prototype.shouldShowTableTotalsOption=function(s){return!(s&&s.table&&!_.isEmpty(s.table.columns)&&_.some(s.table.columns,function(u){return u.discourageAggregationAcrossGroups}))},p.prototype.shouldShowRowSubtotalsOption=function(s){return!(!s||(0,J.be)(s.matrix)<1||this.isDiscourageAggregationAcrossGroups(s.matrix.rows.levels))},p.prototype.shouldShowColumnSubtotalsOption=function(s){if(!s||!s.matrix||(0,J.pr)(s.matrix.columns)<1)return!1;var n=s.matrix.columns.levels;return s.matrix.valueSources.length>1&&(n=_.initial(n)),!this.isDiscourageAggregationAcrossGroups(n)},p.prototype.isDiscourageAggregationAcrossGroups=function(s){var n=_.last(s);return n&&_.some(n.sources,function(u){return u.discourageAggregationAcrossGroups})},p.prototype.getTablixTextClassProperties=function(s){return{fontSizeOverrideFn:this.fontSizeOverridePredicate(),fontFamilyOverrideFn:this.fontFamilyOverridePredicate(),fontColorOverrideFn:this.fontColorOverridePredicate(),labelFontProperties:(0,G.m)(s,"label"),boldLabelFontProperties:(0,G.m)(s,"boldLabel")}},p.prototype.fontSizeOverridePredicate=function(){var s=this;return function(n,u,S){var y=(0,b.RK)(n,u.objectName),f=(0,b.RK)(n,i.FX.ObjectGrid),m=(0,b.RK)(n,i.FX.ObjectValues),R=(0,b.RK)(n,i.FX.ObjectSubTotals),x=s.gridDependentObject(u.objectName),O=(0,V.N)(f,"textSize",void 0)&&!(0,V.N)(y,u.propertyName,void 0,S),W=s.valuesDependentObject(u.objectName),te=(0,V.N)(m,"fontSize",void 0)&&!(0,V.N)(y,u.propertyName,void 0,S),ne=s.subTotalsDependentObject(u.objectName),de=s.getSubTotalsValue(u.objectName,R,"fontSize",void 0)&&!(0,V.N)(y,u.propertyName,void 0,S),z=!!(0,V.N)(y,u.objectName===i.FX.ObjectGrid?"textSize":"fontSize",void 0,S);return x&&O||W&&te||ne&&de||z}},p.prototype.fontFamilyOverridePredicate=function(){var s=this;return function(n,u,S){var y=(0,b.RK)(n,u.objectName),f=(0,b.RK)(n,i.FX.ObjectValues),m=(0,b.RK)(n,i.FX.ObjectSubTotals),R=s.valuesDependentObject(u.objectName),x=(0,V.N)(f,"fontFamily",void 0)&&!(0,V.N)(y,u.propertyName,void 0),O=s.subTotalsDependentObject(u.objectName),W=s.getSubTotalsValue(u.objectName,m,"fontFamily",void 0)&&!(0,V.N)(y,u.propertyName,void 0,S),te=!!(0,V.N)(y,"fontFamily",void 0,S);return R&&x||O&&W||te}},p.prototype.fontColorOverridePredicate=function(){return function(s,n,u){var S=(0,b.RK)(s,n.objectName),y=n.objectName===i.FX.ObjectValues?"fontColorPrimary":"fontColor",f=(0,V.N)(S,y);return!!(0,V.N)(S,y,f,u)}},p.prototype.gridDependentObject=function(s){return this.valuesDependentObject(s)||s===i.FX.ObjectRowHeaders||s===i.FX.ObjectColumnHeaders||s===i.FX.ObjectValues},p.prototype.valuesDependentObject=function(s){return this.subTotalsDependentObject(s)||s===i.FX.ObjectSubTotals},p.prototype.subTotalsDependentObject=function(s){return s===i.FX.ObjectTotal||s===i.FX.ObjectRowTotal||s===i.FX.ObjectColumnTotal},p.prototype.getSubTotalsValue=function(s,n,u,S){var y=s===i.FX.ObjectRowTotal?"Row":s===i.FX.ObjectColumnTotal?"Column":void 0;return S=S??(0,V.N)(n,u),(0,V.N)(n,u,S,y)},p.ImageSizeMin=8,p.ImageSizeMax=512,p}(),g=function(){function p(s,n,u){this.displayName=s,this.sparklineType=n,this.localizer=u}return p.prototype.format=function(s,n){var u=function(p,s,n){if(n){var u=n.points;if(u=_.filter(u,function(ne){return null!=ne.x&&null!=ne.y}),!_.isEmpty(u)){var S=_.size(u);if(1===S)return{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[p,n.lowY]};var y=s.misc.sparkline.groupingType;if(y&&(y.numeric||y.dateTime||y.temporal)){var m=u[0].y,R=u[S-1].y;if(!_.some(u,function(ne){return ne.y!==m}))return{key:"Sparkline_Tooltip_ScalarNoChange",parameters:[p,m]};if((0,Y.JM)(_.map(u,function(ne){return ne.x}),_.map(u,function(ne){return ne.y}),!0).rSquared>.5){var te,W="Sparkline_Tooltip_ScalarTrend";return W+=R>m?"Up":"Down",0!==m?(te=100*(R-m)/m,W+="Percent"):(te=R-m,W+="Value"),{key:W,parameters:[p,+Math.abs(te).toFixed(2)]}}return{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[p,n.lowY,n.highY]}}return n.lowY===n.highY?{key:"Sparkline_Tooltip_SinglePoint_CategoricalSameHighLow",parameters:[p,n.lowY]}:{key:"Sparkline_Tooltip_CategoricalDifferentHighLow_ScalarNoTrend",parameters:[p,n.lowY,n.highY]}}}}(this.displayName,this.sparklineType,s);if(u)return this.localizer.apply(this,(0,N.__spreadArray)([u.key],u.parameters,!1))},p}()},91468:function(Te,Pe,A){A.d(Pe,{CQ:function(){return d},D2:function(){return U},JT:function(){return F},K2:function(){return V},Km:function(){return l},Kq:function(){return f},MO:function(){return X},Nk:function(){return S},Od:function(){return n},Ps:function(){return D},RD:function(){return e},RP:function(){return v},TQ:function(){return u},VM:function(){return t},X1:function(){return Y},aY:function(){return y},do:function(){return c},jv:function(){return p},kJ:function(){return T},n2:function(){return b},qk:function(){return J},rP:function(){return s},s$:function(){return H},tO:function(){return r},wV:function(){return h},x9:function(){return C}});var N=A(18664),pe=A(91358),Q=A(32105),oe=A(19650),ce=A(62458),ee=A(32041),K=A(48066),G=A(38078),j=A(66001),ae=A(7911),i=A(93340),P=A(71090),o="0.3",t="cell-interactive",h="pivotTableCellNoWrap",b="pivotTableCellWrap",V=5,H=5,X=5;function J(m){return m.insertAdjacentHTML("beforeend",ae.bG.build({content:"",classNames:null,styleProperties:{position:"absolute",left:"0",top:"0",visibility:"hidden"},attributes:null},null)),m.lastChild}function Y(m,R){return _.isEmpty(m)?0:ee.b.measureSvgTextWidth(R,m)}function F(m,R){if(_.isEmpty(m))return 0;var x=0;return m.split("\n").forEach(function(O){var W=Y(O,R);W>x&&(x=W)}),x}function c(m,R,x){return _.isEmpty(m)?[m]:(m=m.trim(),(0,j.ql)(m,x,ee.b.measureSvgTextWidth,R,P.uZ,void 0,!0,!0))}function C(m,R){return Math.max(0,m-(R.getExtraLeft()+R.getExtraRight()))}function d(m){m.opacity=o}function T(m,R){return ce.fF.assertValue(m,"kpi"),ce.fF.assertValue(R,"kpiValue"),ae.bG.build({content:"",classNames:[(0,pe.sq)(m,R)||""],styleProperties:{display:"inline-block","vertical-align":"bottom",margin:"0"},attributes:null},null)}function U(m,R,x,O){var W={tagName:"img",content:"",classNames:null,styleProperties:{"max-height":"100%","max-width":"100%"},attributes:{src:m,referrerpolicy:"no-referrer"},contextMenuHandler:function(ne){ne.stopPropagation()}};return null!=O&&(W.attributes.alt=O),{children:[W],classNames:[P.Ed],styleProperties:{height:R+"px",width:x+"px"},attributes:null}}function D(m,R,x,O){ce.fF.assertValue(m,"undefined iconSettings");var W={attributes:{},styleProperties:{},classNames:["flex-container"]},te=function(m,R,x){ce.fF.assertValue(m,"undefined icon");var O=R+"px";return null===m.value?{tagName:"div",styleProperties:{height:O,width:O},attributes:{},classNames:null}:(ce.fF.assertValue(m.value,"Undefined icon value"),m.value.svgId?{tagName:"svg",attributes:{height:O,width:O,role:"img","aria-label":x.getLocalizedString(m.value.descriptionKey)},classNames:null,styleProperties:{},children:[{tagName:"use",attributes:{href:"#"+m.value.svgId},classNames:null,styleProperties:{}}]}:null!=m.value.url?{tagName:"img",classNames:null,styleProperties:{height:O,width:O},attributes:{src:(0,G.HZ)(m.value.url),referrerpolicy:"no-referrer"}}:void ce.fF.assertFail("Unrecognized icon value"))}(m,R,O);switch(x.classNames.push("stretching-content"),m.layout){case"IconOnly":x.children=[te],q(m,x),W.children=[x];break;case"After":q(m,te),W.children=[x,te];break;default:q(m,te),W.children=[te,x]}return W}function q(m,R){R.classNames||(R.classNames=[]);var x=R.classNames;switch(x.push("tablixIcon"),m.layout){case"IconOnly":break;case"Before":x.push("before");break;default:x.push("after")}switch(m.verticalAlignment){case"Bottom":x.push("bottom");break;case"Middle":x.push("middle");break;default:x.push("top")}}function v(m,R){return m?(0,i.RP)(R):null}function e(m,R,x,O,W,te){var ne={tagName:"a",classNames:[],styleProperties:{},attributes:{href:R,target:"_blank",rel:"noopener noreferrer",role:"link"},clickHandler:function(le){le.stopPropagation(),O(R,le)},contextMenuHandler:function(le){le.stopPropagation()}};return"string"==typeof m?ne.content=m:ne.children=[m],x&&(ne.content=void 0,ne.children=void 0,ne.classNames.push(P.NA,x),ne.attributes["aria-label"]=R),W&&(ne.styleProperties.color="inherit"),te&&(ne.attributes.title=R),ne}function r(m){return m-1}function l(m,R,x,O,W,te,ne){var de,le={};return R&&(de=m?["powervisuals-glyph","sort-icon",g(m)]:x?["powervisuals-glyph","sort-icon",g(O),"future"]:["sort-icon"]),!m&&x?le["aria-label"]=ne.getLocalizedString("Field_Sorting_Possible"):le["aria-hidden"]="true",{content:P.jv,attributes:le,styleProperties:{"font-size":te,bottom:W+"px"},classNames:de}}function g(m){switch(m){case 1:return"caret-up";case 2:return"caret-down"}}function p(m,R){return(0,i.MN)(m,R)!==K.av.NONE}function s(m){return m&&m.replace(/&#10;/g,"<BR />")}function n(m,R){m.size&&8.52===m.size.px&&(m=(0,N.ED)(m,{size:Q.B.createFromPx(8)}));var x={measuredFontHeight:null,textProperties:(0,N.qk)(m),fontProperties:m};return R.addItem(x),x}function u(m,R,x){return n((0,N.ED)(m.fontProperties,R),x)}function S(m,R,x){var O=m.fontProperties;O.family&&(R.fontFamily=O.family),O.size&&(R.fontSize=O.size),O.weight&&(R.fontWeight=O.weight),O.style&&(R.fontStyle=O.style),O.textDecoration&&x&&(R.textDecoration=O.textDecoration)}function y(m,R,x){if(ce.fF.assertValue(R,"PivotTableBinderUtils.addAlignmentCssClass - classes"),null==m||m===oe.H.auto){if(!x)return;m=x}switch(m){case oe.H.left:return void R.push(P.z7);case oe.H.center:return void R.push(P.QM);case oe.H.right:return void R.push(P.OM);default:return}}var f=function(){function m(){this.items=[]}return m.prototype.addItem=function(R){this.items.push(R)},m.prototype.measureAll=function(R){if(!_.isEmpty(this.items)){for(var x=[],O=0,W=this.items;O<W.length;O++){var ne={content:"a",classNames:null,styleProperties:(0,N.wB)(W[O].fontProperties),attributes:null};x.push(ae.bG.build(ne,null))}var de=x.join("");R.insertAdjacentHTML("beforeend",de);for(var z,le=!0,se=0,ve=this.items;se<ve.length;se++)le?(le=!1,z=R.firstChild):z=z.nextSibling,ve[se].measuredFontHeight=Math.ceil(z.offsetHeight);R.innerHTML=""}},m}()},59151:function(Te,Pe,A){A.d(Pe,{P:function(){return pe}});var N=A(55007);function pe(Q,oe,ce){for(var ee={remove:[],merge:[]},K=0,G=Q;K<G.length;K++){var j=G[K],ae={selector:j.selector,objectName:N.FX.PropColumnWidthValue.objectName,properties:{}};ae.properties[N.FX.PropColumnWidthValue.propertyName]=j.value,null==j.value?ee.remove.push(ae):ee.merge.push(ae)}oe.persistProperties(ee,ce)}},13375:function(Te,Pe,A){A.d(Pe,{aD:function(){return ae},hc:function(){return i}});var N=A(81337),pe=A(62458),Q=A(39681),oe=A(38078),ce=A(93340),ee=A(29043),K=A(66842),G=A(40845),j=function(P){function o(t,h,b,V,H,X,J,Y){var c,C,d,T,F=this;if(b)for(d=b;d.parent;)d=d.parent;if(V)for(T=V;T.parent;)T=T.parent;var U=T&&!!T.isSubtotal,D=!U&&V&&!!V.isSubtotal,I=d&&!!d.isSubtotal,q=!I&&b&&!!b.isSubtotal,v=b.isBlankRow;return _.isString(t)&&!(null===(C=null===(c=H?.type)||void 0===c?void 0:c.misc)||void 0===C)&&C.sparkline&&(t=(0,ee.th)(t,X)),(F=P.call(this,t,h,q,D,I,U,v,H,J,Y,0)||this).rowItem=b,F.columnItem=V,F.hasRowSubtotalStyle=b&&b.hasSubtotalStyle,F.hasColumnSubtotalStyle=V&&V.hasSubtotalStyle,F.hasSubtotalStyle=F.hasRowSubtotalStyle||F.hasColumnSubtotalStyle,F}return(0,N.__extends)(o,P),Object.defineProperty(o.prototype,"isMeasure",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isValidUrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isValidImage",{get:function(){return!1},enumerable:!1,configurable:!0}),o}(ce.jG);function ae(P,o,t,h,b,V,H,X,J,Y){void 0===H&&(H=!0);var F=new i(h,b,V,Y,!0);return H&&F.update(P,!1,!1,!1,o,!0,t,X,J,void 0,void 0,!1),F}var i=function(){function P(o,t,h,b,V){this.tablixProperties=t,this.hostServices=h,this.expandCompositeHierarchy=b,this.modernRowHeaderStyle=V,this.compositeGroupSeparator=o}return P.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},P.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},P.prototype.getLeafCount=function(o){var t=this.getMatrixHierarchy(o);return t?t.leafNodes.length:0},P.prototype.getLeafAt=function(o,t){var h=this.getMatrixHierarchy(o);return h?h.leafNodes[t]:null},P.prototype.getLeafIndex=function(o){return pe.fF.assertValue(o,"item"),o.leafIndex},P.prototype.getParent=function(o){return pe.fF.assertValue(o,"item"),0===o.level?null:o.parent},P.prototype.getIndex=function(o){return pe.fF.assertValue(o,"item"),o?o.index:-1},P.prototype.isLeaf=function(o){return pe.fF.assertValue(o,"item"),!o.children||0===o.children.length},P.prototype.isRowHierarchyLeaf=function(o){return!0},P.prototype.isColumnHierarchyLeaf=function(o){return!1},P.prototype.isFirstItem=function(o,t){return o===_.head(t)},P.prototype.areAllParentsFirst=function(o,t){if(!o)return!1;var h=this.getParent(o);return h?this.isFirstItem(o,o.siblings)&&this.areAllParentsFirst(h,h.siblings):this.isFirstItem(o,o.siblings)},P.prototype.isLastItem=function(o,t){if(pe.fF.assertValue(o,"item"),o!==_.last(t))return!1;if(!this.isItemRow(o)||this.isDataComplete)return!0;for(var h=o.parent;h;){if(h!==_.last(h.siblings))return!0;h=h.parent}return!1},P.prototype.isItemRow=function(o){if(!o)return!1;for(var t=o;t.parent;)t=t.parent;return t.siblings===this.rowHierarchy.root.children},P.prototype.areAllParentsLast=function(o,t){if(!o)return!1;var h=this.getParent(o);return h?this.isLastItem(o,o.siblings)&&this.areAllParentsLast(h,h.siblings):this.isLastItem(o,o.siblings)},P.prototype.getChildren=function(o){return pe.fF.assertValue(o,"item"),o.children},P.prototype.getChildrenLevelDifference=function(o){var t=1/0,h=this.getChildren(o);if(!_.isEmpty(h))for(var b=0,V=h.length;b<V;b++)t=Math.min(t,h[b].level-o.level);return t},P.prototype.getCount=function(o){return pe.fF.assertValue(o,"items"),o.length},P.prototype.getAt=function(o,t){return pe.fF.assertValue(o,"items"),o[t]},P.prototype.getLevel=function(o){return pe.fF.assertValue(o,"item"),o.level},P.prototype.getRowLeafIndex=function(o){return this.isSteppedLayout&&o.isSubtotal?o.parent?!this.valuesOnRow&&this.areRowSubtotalsBefore?o.parent.leafIndex:o.leafIndex:this.valuesOnRow?o.levelSourceIndex:-1:o.leafIndex},P.prototype.getIntersection=function(o,t){pe.fF.assertValue(o,"rowItem"),pe.fF.assertValue(t,"columnItem");var h,V,b=t.leafIndex;if(h=o.values?o.values[t.leafIndex]:void 0){var H=this.valueSources[h.valueSourceIndex||0],X=H.queryName;V=new j(h.value,h.objects,o,t,H,this.hostServices,this.formatters[X],this.tooltipFormatters[X])}else V=new j(void 0,void 0,o,t,void 0,this.hostServices,void 0,void 0);var F=this.getRowLeafIndex(o);return V.position.row.index=F,V.position.row.indexInSiblings=o.siblings.indexOf(o),V.position.row.isFirst=0===F,V.position.row.isLast=this.isDataComplete&&F===this.rowHierarchy.leafNodes.length-1,V.position.column.index=b,V.position.column.indexInSiblings=t.siblings.indexOf(t),V.position.column.isFirst=0===b,V.position.column.isLast=b===this.columnHierarchy.leafNodes.length-1,h&&h.objects&&(V.backColor=(0,oe.HZ)(this.tablixProperties.PropValuesBackColor.getValue(h.objects)),V.fontColor=(0,oe.HZ)(this.tablixProperties.PropValuesFontColor.getValue(h.objects))),V},P.prototype.getCorner=function(o,t){pe.fF.assert(function(){return o>=0},"rowLevel"),pe.fF.assert(function(){return t>=0},"columnLevel");var V,h=this.columnHierarchy.levels,b=this.rowHierarchy.levels;if((t===h.length-1||0===h.length)&&(V=b[o])){var H=o===b.length-1,X=this.valuesOnRow&&H;return{metadata:1===V.sources.length||V.sources.length>1&&X?V.sources[0]:null,displayName:X?"":_.map(V.sources,function(F){return F.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:H,position:this.calculateCornerCellPosition(o,t),rowLevel:o,columnLevel:t}}if(o===b.length-1&&(V=h[t])){var Y=V.sources.filter(function(c){return!c.isMeasure});return{metadata:1===V.sources.length?V.sources[0]:null,displayName:_.map(Y,function(c){return c.displayName}).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0,position:this.calculateCornerCellPosition(o,t),rowLevel:o,columnLevel:t}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1,position:this.calculateCornerCellPosition(o,t),rowLevel:o,columnLevel:t}},P.prototype.calculateCornerCellPosition=function(o,t){var h=new ce.ri,b=t;h.row.index=h.row.indexInSiblings=b,h.row.isFirst=0===b;var V=this.getColumnHierarchyDepth();h.row.isLast=t===V-1;var H=o;h.column.index=h.column.indexInSiblings=H,h.column.isFirst=0===H;var X=this.getRowHierarchyDepth();return h.column.isLast=H===X-1,h},P.prototype.headerItemEquals=function(o,t){return!(!o||!t)&&o===t},P.prototype.bodyCellItemEquals=function(o,t){return o.position.isMatch(t.position)},P.prototype.cornerCellItemEquals=function(o,t){return!(!o||!t)&&o.displayName===t.displayName&&o.isColumnHeaderLeaf===t.isColumnHeaderLeaf&&o.isRowHeaderLeaf===t.isRowHeaderLeaf&&o.metadata===t.metadata},P.prototype.getColumnHierarchy=function(){return this.columnHierarchy},P.prototype.getRowHierarchy=function(){return this.rowHierarchy},P.prototype.getValueSources=function(){return this.valueSources},P.prototype.valuesOnRowApplied=function(){return this.valuesOnRow},P.prototype.hasMultipleValueSources=function(){return this.multipleValueSources},P.prototype.update=function(o,t,h,b,V,H,X,J,Y,F,c,C){var d=this;pe.fF.assertValue(o,"matrix"),this.isSteppedLayout=t,this.valuesOnRow=h,this.areRowSubtotalsBefore=b,this.isDataComplete=V,this.valueSources=o.valueSources,this.formatters=X,this.tooltipFormatters=J||{},this.subtotalByColumn=Y||{},this.multipleValueSources=o.valueSources.length>1,this.rowHierarchy=this.wrapHierarchy(o.rows,this.expandCompositeHierarchy,this.modernRowHeaderStyle,C,F,c),(H=H||this.valuesOnRow)&&(this.columnHierarchy=this.wrapHierarchy(o.columns)),this.valuesOnRow&&this.pivotValues(),this.updateHierarchy(this.rowHierarchy,this.isSteppedLayout,c,this.areRowSubtotalsBefore,function(T,U){return d.calculateRowHeaderPosition(T,U)}),H&&(this.updateHierarchy(this.columnHierarchy,!1,c,!1,function(T,U){return d.calculateColumnHeaderPosition(T,U)}),this.updateStaticColumnHeaders(this.columnHierarchy))},P.prototype.pivotValues=function(){_.isEmpty(this.columnHierarchy.root.children)||this.removeValueNodesFromColumnHierarchy(this.columnHierarchy.root.children),_.isEmpty(this.rowHierarchy.root.children)||this.addValueNodesToRowHierarchy(this.rowHierarchy.root.children,this.rowHierarchy.levels.length>0),this.moveValueLevelFromColumnToRowHierarchy()},P.prototype.removeValueNodesFromColumnHierarchy=function(o){pe.fF.assertValue(o,"nodes");for(var t=0,h=o;t<h.length;t++){var b=h[t];if(!b.parent&&this.isLeaf(b))return o.length=0,void o.push({level:0});this.isLeaf(b.children[0])?b.children=void 0:this.removeValueNodesFromColumnHierarchy(b.children)}},P.prototype.addValueNodesToRowHierarchy=function(o,t){for(var h=this.getRowHierarchyDepth(),b=this.valueSources.length,V=o.length,H=0;H<V;H++){var X=o[H];if(this.isLeaf(X)){var J=void 0,Y=void 0,F=void 0;if(this.isSteppedLayout&&X.isSubtotal||!t?(o.splice(H,1),J=o,Y=H,F=X.level,V=V-1+b,H=H-1+b):(X.children=[],J=X.children,Y=0,F=h),!X.isBlankRow)for(var c=0;c<b;c++){var C=this.createRowValueNode(c,b,X,F);J.splice(Y++,0,C)}X.values=null}else this.addValueNodesToRowHierarchy(X.children,t)}},P.prototype.moveValueLevelFromColumnToRowHierarchy=function(){this.rowHierarchy.levels.push(this.columnHierarchy.levels.pop())},P.prototype.createRowValueNode=function(o,t,h,b){var V={level:b,levelSourceIndex:o,isSubtotal:h.isSubtotal,hasSubtotalStyle:!!h.hasSubtotalStyle,values:{}},H=0,X=0;for(var J in h.values)H%t===o&&(V.values[X++]=h.values[H]),H++;return V},P.prototype.createBlankRowValueNode=function(o){return{level:0,isSubtotal:!1,hasSubtotalStyle:!1,isBlankRow:!0,value:"",values:_.map(this.findValues(o),function(h){return h.valueSourceIndex}).map(function(h){return{value:"",valueSourceIndex:h,isBlankRow:!0}}),levelValues:[{levelSourceIndex:0,value:""}]}},P.prototype.needsBlankRow=function(o,t,h){return!o.isSubtotal||t===G.we&&h!==K.t.Compact},P.prototype.findValues=function(o){if(o.values)return o.values;var t=_.first(o.children);return t?this.findValues(t):void 0},P.prototype.wrapHierarchy=function(o,t,h,b,V,H){var J,X=this;return J={levels:this.wrapLevels(o.levels,t),root:{children:this.wrapNodes(o.root.children,o,t,h)}},b&&J.root.children.length>0&&(J.root.children=_.flatMap(J.root.children,function(Y){return X.needsBlankRow(Y,V,H)?[Y,X.createBlankRowValueNode(Y)]:[Y]})),J.leafNodes=[],J},P.prototype.wrapLevels=function(o,t){if(o){for(var h=[],b=0,V=o;b<V.length;b++){var H=V[b],X=(0,Q.ED)(H);if(h.push(X),H.sources.length>1&&t){for(var J=1;J<H.sources.length;J++)h.push({sources:[H.sources[J]]});X.sources.splice(1,X.sources.length-1)}}return h}},P.prototype.wrapNodes=function(o,t,h,b){if(o){for(var V=[],H=0,X=o;H<X.length;H++){var J=X[H],Y=(0,Q.ED)(J);if(J.isCollapsed&&!_.isEmpty(J.children)){var F=_.find(J.children,function(I){return I.isSubtotal});F&&(Y.values=F.values),Y.children=null,Y.hasSubtotalStyle=!0}else{if(Y.isSubtotal){var c=t.levels[Y.level||0];if(1===c.sources.length&&!1===this.subtotalByColumn[c.sources[0].queryName])continue}Y.hasSubtotalStyle=!!J.isSubtotal||b&&!_.isEmpty(J.children),Y.children=this.wrapNodes(J.children,t,h,b)}if(!_.isEmpty(Y.levelValues)&&Y.levelValues.length>1&&h){for(var C=Y.children,d=Y,T=1;T<Y.levelValues.length;T++){var U=(0,Q.ED)(Y),D=Y.levelValues[T];D.levelSourceIndex=0,U.levelValues=[D],U.level+=T,U.isCollapsed=!0,U.children=void 0,d.isCollapsed=!1,d.children=[U],d=U}_.isEmpty(C)||(d.children=C,d.isCollapsed=!1),d.values=Y.values,Y.values=void 0,Y.levelValues.splice(1,Y.levelValues.length-1)}V.push(Y)}return V}},P.prototype.updateHierarchy=function(o,t,h,b,V){o.leafNodes.length>0&&(o.leafNodes.length=0),o.root.children&&this.updateRecursive(o,o.root.children,null,o.leafNodes,t,h,b,V)},P.prototype.createEmptyNode=function(o){return void 0===o&&(o=0),{level:o,values:{},value:"",levelValues:[{levelSourceIndex:0,value:""}]}},P.prototype.updateRecursive=function(o,t,h,b,V,H,X,J){for(var Y,F=function(U,D){var I=t[U];if(I.siblings=t,o===c.rowHierarchy&&!I.isCollapsed&&!_.isEmpty(I.children)&&H===K.t.Outline&&!X&&I.children.unshift(c.createEmptyNode(I.children[0].level)),h&&(I.parent=h),Y=o===c.rowHierarchy&&c.isSteppedLayout&&I.isSubtotal&&void 0!==I.levelSourceIndex?_.last(o.levels):o.levels[I.level],I.hierarchyLevel=Y,Y)if(I.levelValues){for(var q=[],v=[],e=0,r=I.levelValues;e<r.length;e++){var l=r[e],s=l.value;q.push(c.formatters[(g=Y.sources[l.levelSourceIndex||0]).queryName].format(s,null));var n=c.tooltipFormatters[g.queryName];n&&v.push(n.format(s,null))}pe.fF.assert(function(){return q.length===v.length||_.isEmpty(v)},"`tooltipDisplayNames` should be empty or the same length as `displayNames`"),I.valueFormatted=q.join(c.compositeGroupSeparator),I.tooltipValueFormatted=_.isEmpty(v)?void 0:v.join(c.compositeGroupSeparator),I.queryName=1!==Y.sources.length?void 0:Y.sources[0].queryName}else{var g;I.valueFormatted=(g=Y.sources[I.levelSourceIndex||0]).displayName,I.tooltipValueFormatted=g.displayName,I.queryName=g.queryName}I.index=U,_.isEmpty(I.children)?(!V||!I.isSubtotal||!X&&I.parent&&!I.parent.isSubtotal||c.valuesOnRow&&I.parent)&&(I.leafIndex=b.length,b.push(I)):(V&&(I.leafIndex=b.length,b.push(I)),c.updateRecursive(o,I.children,I,b,V,H,X,J),V&&(pe.fF.assertAnyValue(_.every(I.children,function(u){return _.isEqual(u.hierarchyLevel,I.children[0].hierarchyLevel)}),"Children may come from different levels"),(!c.hasMultipleValueSources()||_.some(I.children,function(u){return _.some(u.hierarchyLevel.sources,function(S){return!S.isMeasure})}))&&(I.hasSubtotalStyle=!0))),I.position=J(I,t)},c=this,C=0,d=t.length;C<d;C++)F(C)},P.prototype.updateStaticColumnHeaders=function(o){var t=o.leafNodes;if(t&&t.length>0){if(!t[0].identity&&this.valuesOnRow&&1===t.length)return;for(var h=0,b=t.length;h<b;h++){var V=t[h];if(!V.identity&&_.isEmpty(V.levelValues)){var X=o.levels[V.level].sources[V.levelSourceIndex?V.levelSourceIndex:0];X&&(V.valueFormatted=X.displayName)}}}},P.prototype.getMatrixHierarchy=function(o){var t=this.rowHierarchy.root.children;if(t&&o===t)return this.rowHierarchy;var h=this.columnHierarchy.root.children;return h&&o===h?this.columnHierarchy:null},P.prototype.calculateRowHeaderPosition=function(o,t){var h=new ce.ri;h.row.index=this.getRowLeafIndex(o),h.row.indexInSiblings=this.getIndex(o),h.row.isFirst=this.areAllParentsFirst(o,t),h.row.isLast=this.areAllParentsLast(o,t);var b=this.getLevel(o);return h.column.index=h.column.indexInSiblings=b,h.column.isFirst=0===b,h.column.isLast=this.isLeaf(o),h},P.prototype.calculateColumnHeaderPosition=function(o,t){var h=new ce.ri,b=this.getLevel(o);h.row.index=h.row.indexInSiblings=b,h.row.isFirst=0===b,h.row.isLast=this.isLeaf(o);var V=this.getIndex(o);return h.column.index=h.column.indexInSiblings=V,h.column.isFirst=this.areAllParentsFirst(o,t),h.column.isLast=this.areAllParentsLast(o,t),h},P.prototype.getRowHeaderMetadataColumn=function(o){var t=this.getRowHeaderMetadataColumns(o);return t&&t[0]},P.prototype.getRowHeaderMetadataColumns=function(o){if(o&&this.rowHierarchy)return this.getHierarchyMetadataColumns(this.rowHierarchy,o.level)},P.prototype.getColumnHeaderMetadataColumn=function(o){var t=this.getColumnHeaderMetadataColumns(o);return t&&t[0]},P.prototype.getColumnHeaderMetadataColumns=function(o){if(o&&this.columnHierarchy)return this.getHierarchyMetadataColumns(this.columnHierarchy,o.level)},P.prototype.getHierarchyMetadataColumns=function(o,t){if(o&&o.levels&&!(o.levels.length<t)){var h=o.levels[t];if(h&&h.sources&&0!==h.sources.length)return h.sources}},P.isNodeGrandTotal=function(o){if(o){for(var t=o;t.parent;)t=t.parent;return t.isSubtotal}return!1},P}()},32771:function(Te,Pe,A){A.d(Pe,{JF:function(){return G},az:function(){return K}});var N=A(81337),pe=A(90120),Q=A(34021),oe=A(44783),ce=A(62458),ee=A(38078);function K(ae,i,P){if(ce.fF.assertValue(ae,"getColumnDataBarsSettings: column"),i){var t,h,o=ae.aggregates;if(null!=i.minValue?t=i.minValue:o&&null!=o.min&&_.isNumber(o.min)&&(t=o.min),null!=i.maxValue?h=i.maxValue:o&&null!=o.max&&_.isNumber(o.max)&&(h=o.max),!(null==t||null==h||t>h)){var b=null!=i.minValue,V=null!=i.maxValue;return t>=0&&h>0&&!b&&(t=0),t<0&&h<0&&!V&&(h=0),{min:t,max:h,range:h-t,zeroPosition:0===t&&0===h?.5:t>=0&&h>0&&b?0:t<0&&h<=0&&V?1:(0-t)/(h-t),positiveColor:(0,ee.HZ)(pe.v.getFillColor(P,i.positiveColor,oe.U)),negativeColor:(0,ee.HZ)(pe.v.getFillColor(P,i.negativeColor,oe.U)),axisColor:(0,ee.HZ)(pe.v.getFillColor(P,i.axisColor,oe.fA)),hideText:!!i.hideText,reverseDirection:!!i.reverseDirection,strokeSettings:(0,N.__assign)((0,N.__assign)({},(0,Q.kG)(P)),{width:1}),totalMatching:i.totalMatchingOption}}}}function G(ae,i,P,o,t){var h,b=P.getExtraLeft()+"px",V=P.getExtraRight()+"px",H=P.getExtraTop()+"px",X=P.getExtraBottom()+"px",J={children:[],attributes:{},classNames:[],styleProperties:{position:"absolute",left:b,right:V,top:H,bottom:X}},Y=[],F=function(ae,i,P){if(null!=i&&_.isNumber(i)&&0!==i){var V,H,X,o=ae.min,t=ae.max,h=ae.range,b=ae.zeroPosition;if(i>=t){if(1===b)return;i=t}else if(i<=o){if(0===b)return;i=o}if(0===h?(V=H=b,X=ae.positiveColor):i>0?(V=b,H=(i-o)/h,X=ae.positiveColor):(V=(i-o)/h,H=b,X=ae.negativeColor),ae.reverseDirection){var J=V;V=1-H,H=1-J}var Y=100*(H-V);P?.push((i>=0?"":"-")+Math.round(Y)+"%");var F={left:100*V+"%",width:Y+"%",background:X},c=ae.strokeSettings;return c&&c.visible&&(F.outline="".concat(c.width,"px solid ").concat(c.color),F["outline-offset"]="-".concat(c.width,"px")),{content:"",attributes:{},classNames:["dataBar"],styleProperties:F}}}(i,o,Y);F&&J.children.push(F);var d,c=i.zeroPosition;i.reverseDirection&&(c=1-c),J.children.push({content:"",attributes:{},classNames:["dataBarAxis"],styleProperties:{top:"-"+H,bottom:"-"+X,left:100*c+"%","border-left-color":i.axisColor}}),t&&(d={attributes:{},classNames:["visually-hidden"],styleProperties:{},content:t.getLocalizedString("Data_Bar_Percentage",null!==(h=Y[0])&&void 0!==h?h:"0%")});var T=ae.styleProperties;return T.position="absolute",T.left=b,T.right=V,T.top=H,T.bottom=X,d?{children:[J,ae,d],classNames:[],attributes:{},styleProperties:{}}:{children:[J,ae],classNames:[],attributes:{},styleProperties:{}}}},21242:function(Te,Pe,A){A.d(Pe,{Ak:function(){return t},IP:function(){return V},JW:function(){return G},MX:function(){return P},d4:function(){return oe},kH:function(){return ce},mM:function(){return o},p_:function(){return b},re:function(){return j}});var N=A(81337),pe=A(13375);function Q(H,X,J,Y){var F,c,C,d,T,U;void 0===J&&(J=!0);var D=H.columnItem,I=H.rowItem,q=0,v={displayNameParts:[],valueParts:[],concatenatedParts:[],headerParts:[],otherType:{}},e=I&&!_.isEmpty(I.values),r=I&&i(I,X,J,Y);r&&((F=v.displayNameParts).push.apply(F,r.displayNameParts||[]),(c=v.valueParts).push.apply(c,r.valueParts||[]),(C=v.headerParts).push.apply(C,_.map(r.valueParts,function(){return!0})),v.concatenatedParts.push(_.map(r.displayNameParts,function(){return q++})));var l=D&&i(D,X,J,Y);if(l&&((d=v.displayNameParts).push.apply(d,l.displayNameParts||[]),(T=v.valueParts).push.apply(T,l.valueParts||[]),(U=v.headerParts).push.apply(U,_.map(l.valueParts,function(){return!0})),v.concatenatedParts.push(_.map(l.displayNameParts,function(){return q++}))),e)if(v.displayNameParts.push(H.columnMetadata.displayName),v.concatenatedParts.push([q++]),v.headerParts.push(!1),H.isKpi){var g={metadata:H.columnMetadata.kpi,value:H.tooltipContent};(v.otherType[v.displayNameParts.length-1]={}).kpiValue=g,v.valueParts.push(H.tooltipContent)}else _.isEmpty(H.tooltipContent)||v.valueParts.push(H.tooltipContent);return v}function oe(H,X,J){if(H)return J?[{displayName:"",value:H.tooltipContent}]:function(H){for(var X=[],J=function(d){var T=_.filter(H.displayNameParts,function(q,v){return-1!==d.indexOf(v)}),U=_.filter(H.valueParts,function(q,v){return-1!==d.indexOf(v)});if((T.length>0||U.length>0)&&(X.push({displayName:T.join(" "),value:U.join(" ")}),H.otherType)){var D=_.first(d);if(_.has(H.otherType,String(D))){var I=X.length-1;delete X[I].value,X[I]=(0,N.__assign)((0,N.__assign)({},X[I]),H.otherType[D])}}},Y=0,F=H.concatenatedParts;Y<F.length;Y++)J(F[Y]);return X}(Q(H,X))}function ce(H,X,J,Y){for(var F=[],c=0,C=H;c<C.length;c++)F.push(Q(C[c],Y));var T=0,U=X.getHierarchyLeafCount()*J.getHierarchyLeafCount();return 0!==U&&(T=Math.round(H.length/U*100)),(0,N.__assign)({coveragePercentage:T},ee(F))}function ee(H){for(var X={headers:_.uniq(_.flatten(_.map(H,function(l){return l.displayNameParts}))),isHeader:{},values:[]},J=X.values,Y=X.headers,F=X.isHeader,c={},C=0;C<Y.length;C++)c[Y[C]]=C;for(var d=0,T=H;d<T.length;d++){var U=T[d],D=_.fill(new Array(Y.length),"");for(C=0;C<U.displayNameParts.length;C++){var v=c[U.displayNameParts[C]];D[v]=U.valueParts[C],U.headerParts&&(X.isHeader[v]=U.headerParts[C])}J.push(D)}if(!_.isEmpty(H)&&H[0].headerParts)for(var e=function(g){for(var p=J[g],s=[],n=g+1;n<J.length;n++)_.every(J[n],function(le,z){return F[z]&&le===p[z]||!F[z]&&(""===le||""===p[z])})&&s.push(n);if(s.length>0)for(var y=_.reduce(p,function(le,z,se){return""===z&&le.push(se),le},[]),f=0,m=s;f<m.length;f++){var x=J[m[f]];for(n=0;n<y.length;n++){var O=y[n],W=x[O];""!==W&&(p[O]=W,y.splice(n,1),n--)}}s.sort(function(le,z){return z-le});for(var te=0,ne=s;te<ne.length;te++)J.splice(ne[te],1)},r=0;r<J.length;r++)e(r);return X}function G(H,X){if(H)return X?[{displayName:"",value:H.displayName}]:[{displayName:H.displayName}]}function j(H,X,J,Y,F,c){if(H){if(c)return[{displayName:"",value:H.isSubtotal||pe.hc.isNodeGrandTotal(H)?Y:H.tooltipValueFormatted}];if(pe.hc.isNodeGrandTotal(H))return J(H)?[{displayName:H.tooltipValueFormatted}]:[{displayName:Y}];var d=[],T=function(H,X){var J=P(H,X),Y=J.displayNameParts,F=J.valueParts;if(Y.length>0||F.length>0)return{displayName:Y.join(" "),value:F.join(" ")}}(H,F);return T&&d.push(T),X(H)&&d.push({displayName:F,value:H.valueFormatted}),d}}function i(H,X,J,Y){void 0===J&&(J=!0);var F=h(H),c=H.queryName,C=_.find(F,function(d){return d.queryName===c});return C&&C.isMeasure&&(H=H.parent),P(H,X,J,Y)}function P(H,X,J,Y){void 0===J&&(J=!0);for(var F=[],c=[];H;)if(J&&H.isSubtotal)H=H.parent;else{var C=h(H);if(!_.isEmpty(C)){for(var d=[],T=0,U=C;T<U.length;T++){var D=U[T];d.push(D.isMeasure?X:D.displayName)}F.push(d.join(" ")),_.every(C,function(I){return I.isMeasure})?c.push(C[0].displayName):c.push(H.isSubtotal?Y:H.tooltipValueFormatted)}H=H.parent}return{displayNameParts:F=F.reverse(),valueParts:c=c.reverse()}}function o(H,X,J,Y,F){var c=t(J,Y,H,X),C=0,d=J.getHierarchyLeafCount()*Y.getHierarchyLeafCount();0!==d&&(C=Math.round(c.length/d*100));for(var T=[],U=0,D=c;U<D.length;U++)T.push(Q(D[U],F));return(0,N.__assign)({coveragePercentage:C},ee(T))}function t(H,X,J,Y){_.isEmpty(J)&&(J=H.getHierarchyItems()),_.isEmpty(Y)&&(Y=X.getHierarchyItems());var F=[];H.getLeaves(J,F),F=_.filter(F,function(v){return!v.isSubtotal});var c=[];X.getLeaves(Y,c),c=_.filter(c,function(v){return!v.isSubtotal});for(var C=[],d=0,T=F;d<T.length;d++)for(var U=T[d],D=0,I=c;D<I.length;D++)C.push(H.getIntersection(U,I[D]));return C.filter(function(v){return!v.isSubtotal&&!v.isGrandTotal})}function h(H){var X=H.hierarchyLevel&&H.hierarchyLevel.sources;return _.isEmpty(X)?[]:_.every(X,function(J){return J.isMeasure})?[X[H.levelSourceIndex||0]]:X}function b(H){return{displayNameParts:[H.displayName],valueParts:[null]}}function V(H,X){for(var J=[],Y=0;Y<H.displayNameParts.length;Y++){var F=H.displayNameParts[Y],c=H.valueParts[Y];null!=c&&(F+=": "+c),J.push(F)}if(!_.isEmpty(X))for(var C=0,d=X;C<d.length;C++)J.push(d[C]);return J.join(". ")}},29043:function(Te,Pe,A){A.d(Pe,{MV:function(){return o},th:function(){return i},wJ:function(){return P}});var N=A(53197),pe=A(90120),Q=A(51995),oe=A(85308),ce=A(58520),ee=A(45296),K=A(44783),G=A(62458),j=A(43286),ae=52;function i(H,X){var r,J={points:[],lowX:void 0,highX:void 0,lowY:void 0,highY:void 0,minXDifference:void 0};if(!_.isEmpty(H)){var Y;try{Y=JSON.parse(H)}catch{return}var F=+Y.yl,c=+Y.yh,d=+Y.xl,T=+Y.xh,U=null!=Y.md?+Y.md:void 0;_.size(Y.p)>ae&&X.setWarnings([new ee.El]);for(var D=0,I=Y.p;D<I.length;D++){var q=I[D];J.points.push({x:null!=q[0]?+q[0]:void 0,y:null!=q[1]?(r=+q[1],r*(c-F)/100+F):void 0})}return{points:_.filter(J.points,function(e){return _.isFinite(e.x)&&(null!=e.y||_.isFinite(e.y))}),lowX:d,highX:T,lowY:F,highY:c,minXDifference:U}}}function P(H,X,J){var Y;G.fF.assertValue(H,"sparkline"),G.fF.assertValue(null===(Y=X?.misc)||void 0===Y?void 0:Y.sparkline,"invalid type for sparkline"),G.fF.assertValue(J,"style");var F=X.misc.sparkline.groupingType;return{chartType:H.chartType,dataColor:J.isHighContrast?pe.v.getThemeColor(J,K.fA):H.dataColor,strokeWidth:H.strokeWidth,marker:{show:!0,typeFlags:H.marker.typeFlags,color:J.isHighContrast?pe.v.getThemeColor(J,K.fA):H.marker.color,size:H.marker.size,shape:H.marker.shape},isScalar:F&&!!(F.numeric||F.dateTime||F.temporal)}}function o(H,X,J,Y,F,c,C,d){var T;if(null!=Y){var v=c-J.getExtraLeft()-J.getExtraRight()-(d?d+5:0),e=F-J.getExtraTop()-J.getExtraBottom();v-X.strokeWidth>1&&e-X.strokeWidth>1&&(T=X.chartType===oe.U.line?function(H,X,J,Y){var g,c=H.dataColor,C=H.strokeWidth,d=H.marker,T=d.color,U=d.size,D=d.shape,I=d.typeFlags,q=H.isScalar,v=(0,j.Js)(I),e=0===v||1===v&&(0,j.yE)(I,ce.qC),r=Math.max(C,2)+(e?0:Math.ceil(U/2)),l=Y.points;g=q?d3.scaleLinear().domain([Y.lowX,Y.highX]).range([r,X-r]):d3.scalePoint().domain(_.map(_.range(Y.lowX,Y.highX+1),function(O){return O.toString()})).range([r,X-r]);var y,f,p=d3.scaleLinear().domain(d3.extent(l,function(O){return O.y})).range([J-r,r]),s=d3.line().x(function(O){return g(O.x)}).y(function(O){return p(O.y)}),n=_.filter(l,function(O){return null!=O.y}),S={tagName:"path",attributes:{d:s(n)},classNames:[],styleProperties:{stroke:c,"stroke-width":C.toString(),"stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent"}},m=function(H,X){var J=X.marker.typeFlags,Y=d3.extent(H,function(C){return C.y}),F=Y[0],c=Y[1];return _.filter(H,function(C,d){var T,U;return null!=C.y&&(!!(0,j.yE)(J,ce.$6)||(0,j.yE)(J,ce.Ps)&&0===d||(0,j.yE)(J,ce.Z$)&&d===H.length-1||(0,j.yE)(J,ce.pd)&&C.y<0||(0,j.yE)(J,ce.Zc)&&C.y===c||(0,j.yE)(J,ce.O3)&&C.y===F||(0,j.yE)(J,ce.qC)&&null==(null===(T=H[d-1])||void 0===T?void 0:T.y)&&null==(null===(U=H[d+1])||void 0===U?void 0:U.y))})}(n,H);if(!_.isEmpty(m)){var R="markerKey".concat(U).concat(T).concat(D);y={tagName:"defs",classNames:[],styleProperties:{},attributes:{},children:[{tagName:"marker",classNames:[],styleProperties:{},attributes:{id:R,markerUnits:"strokeWidth",orient:"0",refX:"0",refY:"0",viewBox:"-6 -6 12 12",markerHeight:U.toString(),markerWidth:U.toString()},children:[{tagName:"path",classNames:[],styleProperties:{"stroke-width":(0,Q.F)(D).toString(),"stroke-opacity":"1",stroke:T,fill:T},attributes:{d:(0,Q.Ar)(D)}}]}]},f={tagName:"path",attributes:{d:s(m)},classNames:[],styleProperties:{stroke:c,"stroke-width":2..toString(),"stroke-opacity":"0",fill:"transparent","marker-start":"url(#".concat(R,")"),"marker-mid":"url(#".concat(R,")"),"marker-end":"url(#".concat(R,")")}}}return{tagName:"svg",children:f?[y,S,f]:[S],classNames:[],styleProperties:{},attributes:{height:J+"px",width:X+"px"}}}(X,v,e,Y):function(H,X,J,Y){var D,F=H.dataColor,c=H.isScalar,C=Y.points,d=[Y.lowX,Y.highX],T=function(H,X,J,Y,F){if(_.isEmpty(H))return 0;var d,T=Y[Y.length-1]-Y[0];return F&&Y&&Y.length>1?(0!==T?(G.fF.assert(function(){return null!=X},"minXDifference cannot be null for scalar plotted as columns"),d=J*(X/(T+X))):d=J,d=Math.max(d,2)):d=J/(T+1),.8*d}(C,Y.minXDifference,X,d,c),U=T/2;D=c?d3.scaleLinear().domain(d).range([U,X-U]):d3.scalePoint().domain(_.map(_.range(Y.lowX,Y.highX+1),function(r){return r.toString()})).range([U,X-U]);var I=d3.extent(C,function(r){return r.y});I[0]=Math.min(0,I[0]),I[1]=Math.max(0,I[1]);var q=d3.scaleLinear().domain(I).range([J,0]),v=q(0),e=T.toString();return{tagName:"svg",children:_.chain(C).filter(function(r){return null!=r.y}).map(function(r){var l=(D(r.x)-U).toString(),g=(v+(0,N.sc)(q,Math.max(0,r.y),0)).toString(),p=Math.abs((0,N.sc)(q,0,r.y)).toString();return{tagName:"rect",classNames:[],styleProperties:{fill:F},attributes:{x:l,y:g,width:e,height:p}}}).value(),classNames:[],styleProperties:{},attributes:{height:J+"px",width:X+"px"}}}(X,v,e,Y))}return{attributes:{},styleProperties:{},classNames:["flex-container"],children:_.filter(C&&"Before"!==C.layout?[T,H]:[H,T],function(g){return!!g})}}},40183:function(Te,Pe,A){A.d(Pe,{Q:function(){return oe},S:function(){return ce}});var N=A(81337),pe=A(55007),Q=A(62458),oe=function(){function ee(K){this.matrixNavigator=K}return ee.prototype.setHierarchy=function(K){this.hierarchy=K,this.floatingLeaves=[],this.getLeaves(this.getFloatingHierarchyItems(),this.floatingLeaves)},ee.prototype.hasHierarchy=function(){return!_.isEmpty(this.hierarchy.levels)},ee.prototype.isMultiLevelHierarchy=function(){return this.hierarchy.levels.length>1},ee.prototype.getHierarchyDepth=function(){return Math.max(this.hierarchy.levels.length,1)},ee.prototype.getHierarchyLeafNodes=function(){return this.hierarchy.leafNodes},ee.prototype.getHierarchyLeafCount=function(){return this.hierarchy.leafNodes.length},ee.prototype.getHierarchyLeafAt=function(K){return this.hierarchy.leafNodes[K]},ee.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingLeaves.length},ee.prototype.getFloatingHierarchyLeafAt=function(K){return this.floatingLeaves[K]},ee.prototype.isBlank=function(K){return K.isBlankRow},ee.prototype.isBlankRow=function(K){return this.getHierarchyLeafAt(K).isBlankRow},ee.prototype.numberOfBlankRowsBefore=function(K){var G=this.getHierarchyLeafAt(K),j=this.getAncestor(G);return Math.floor(j.index/2)},ee.prototype.getHierarchyItems=function(){return this.hierarchy.root.children||[]},ee.prototype.getFloatingHierarchyItems=function(){return null},ee.prototype.getLeafIndex=function(K){return this.matrixNavigator.getLeafIndex(K)},ee.prototype.isLeaf=function(K){return this.matrixNavigator.isLeaf(K)},ee.prototype.isLastItem=function(K,G){return this.matrixNavigator.isLastItem(K,G)},ee.prototype.getAncestor=function(K){for(;K.parent;)K=K.parent;return K},ee.prototype.getParent=function(K){return this.matrixNavigator.getParent(K)},ee.prototype.getIndex=function(K){return this.matrixNavigator.getIndex(K)},ee.prototype.getNodeLeafCount=function(K){var G=this;return this.isLeaf(K)?1:_.sum(_.map(K.children,function(j){return G.getNodeLeafCount(j)}))},ee.prototype.getIndexOfFirstLeaf=function(K){for(;!_.isEmpty(K.children);)K=K.children[0];return this.getLeafIndex(K)},ee.prototype.getPathIndices=function(K){for(var G=[this.getIndex(K)],j=this.getParent(K);j;)G=(0,N.__spreadArray)([this.getIndex(j)],G||[],!0),j=this.getParent(j);return G},ee.prototype.getNodeFromPath=function(K){var G=this.hierarchy.levels.length||1;if(!(_.isEmpty(K)||K.length>G)){for(var j=this.hierarchy.root,ae=0,i=K;ae<i.length;ae++)if(!(j=j.children[i[ae]]))return;return j}},ee.prototype.getLeafAncestorAtLevel=function(K,G,j){if(Q.fF.assertValue(K,"Undefined leaf node"),Q.fF.assert(function(){return G>=0},"Invalid target level"),!(G>this.getLevel(K))){for(var ae=K;this.getLevel(ae)>G;){if(ae=this.getParent(ae),j&&this.getLevel(ae)<G)return;Q.fF.assertValue(ae,"reached root without finding a matching ancestor")}return ae}},ee.prototype.getItemsByLevel=function(K){var G=[];return this.findLevelItems(K,this.hierarchy.root,-1,G),G},ee.prototype.findLevelItems=function(K,G,j,ae){if(!_.isEmpty(G.children))for(var i=j+1,P=0,o=G.children;P<o.length;P++){var t=o[P];i===K||i+this.matrixNavigator.getChildrenLevelDifference(t)>K?ae.push(t):i<K&&this.findLevelItems(K,t,i,ae)}},ee.prototype.getExpansionState=function(K){return K.isCollapsed?1:!1===K.isCollapsed?0:2},ee.prototype.getChildren=function(K){return this.matrixNavigator.getChildren(K)},ee.prototype.getLevel=function(K){return this.matrixNavigator.getLevel(K)},ee.prototype.getIntersection=function(K,G){var j=this.matrixNavigator.getIntersection(K,G);return j&&j.objects&&(j.icon=pe.FX.PropValuesIcon.getValue(j.objects),j.hyperlink=pe.FX.PropValuesWebURL.getValue(j.objects),j.altText=pe.FX.PropAltTextValue.getValue(j.objects)),j},ee.prototype.getCorner=function(K,G){return this.matrixNavigator.getCorner(K,G)},ee.prototype.getRowLevel=function(K){return K.rowLevel},ee.prototype.getColumnLevel=function(K){return K.columnLevel},ee.prototype.getRowHeaderMetadataColumn=function(K){return this.matrixNavigator.getRowHeaderMetadataColumn(K)},ee.prototype.getRowHeaderMetadataColumns=function(K){return this.matrixNavigator.getRowHeaderMetadataColumns(K)},ee.prototype.getColumnHeaderMetadataColumn=function(K){return this.matrixNavigator.getColumnHeaderMetadataColumn(K)},ee.prototype.getColumnHeaderMetadataColumns=function(K){return this.matrixNavigator.getColumnHeaderMetadataColumns(K)},ee.prototype.valuesOnRowApplied=function(){return this.matrixNavigator.valuesOnRowApplied()},ee.prototype.hasMultipleValueSources=function(){return this.matrixNavigator.hasMultipleValueSources()},ee.prototype.isColumnHeaderMultiValueSubtotal=function(K){return K.isSubtotal&&K.parent&&K.parent.isSubtotal},ee.prototype.isRowHeaderMultiValueSubtotal=function(K){return this.valuesOnRowApplied()&&K.parent&&K.parent.isSubtotal},ee.prototype.getLeaves=function(K,G){if(!_.isEmpty(K))for(var j=0,ae=K;j<ae.length;j++){var i=ae[j];this.isLeaf(i)?G.push(i):this.getLeaves(this.getChildren(i),G)}},ee.prototype.getColumnIndexFromQueryName=function(K){return null},ee}(),ce=function(ee){function K(){return null!==ee&&ee.apply(this,arguments)||this}return(0,N.__extends)(K,ee),K.prototype.getIntersection=function(G,j){return this.isLeaf(G)||_.isEmpty(G.children)||!G.children[0].isSubtotal||this.valuesOnRowApplied()?ee.prototype.getIntersection.call(this,G,j):ee.prototype.getIntersection.call(this,G.children[0],j)},K.prototype.getChildren=function(G){return Q.fF.assertValue(G,"item"),!_.isEmpty(G.children)&&G.children[0].isSubtotal?G.children.slice(1):G.children},K.prototype.getHierarchyDepth=function(){return ee.prototype.getHierarchyDepth.call(this)>0?1:0},K.prototype.getCorner=function(G,j){var ae=j===this.matrixNavigator.getColumnHierarchyDepth()-1?0:this.matrixNavigator.getRowHierarchyDepth()-1;return ee.prototype.getCorner.call(this,ae,j)},K.prototype.getFloatingHierarchyItems=function(){var G=this.getHierarchyItems();if(_.isEmpty(G))return null;for(var j=0,ae=[];;){var i=G[j];if(!i||!i.isSubtotal)break;ae.push(i),j++}return _.isEmpty(ae)?null:ae},K.prototype.isRowHeaderMultiValueSubtotal=function(G){return this.valuesOnRowApplied()&&G.isSubtotal},K.prototype.getLeaves=function(G,j){if(!_.isEmpty(G))for(var ae=0,i=G;ae<i.length;ae++){var P=i[ae];j.push(P),this.getLeaves(this.getChildren(P),j)}},K.prototype.getPathIndices=function(G){return[this.getLeafIndex(G)]},K.prototype.getNodeFromPath=function(G){if(1===G.length)return this.getHierarchyLeafAt(G[0])},K.prototype.getItemsByLevel=function(G){return Q.fF.assert(function(){return 0===G},"Stepped PivotTable rows hierarchy has 1 level"),(0,N.__spreadArray)([],this.getHierarchyLeafNodes()||[],!0)},K.prototype.getLeafAncestorAtLevel=function(G,j){return Q.fF.assert(function(){return 0===j},"Stepped PivotTable rows hierarchy has 1 level"),Q.fF.assertValue(G,"Undefined leaf node"),G},K}(oe)},76797:function(Te,Pe,A){A.d(Pe,{D:function(){return j},l:function(){return i}});var N=A(81337),pe=A(85196),Q=A(66232),oe=A(62458),ce=A(78843),ee=A(93340),K=A(71090),G=A(21242),j=function(P){return P[P.RowHeader=0]="RowHeader",P[P.ColumnHeader=1]="ColumnHeader",P[P.BodyCell=2]="BodyCell",P}({});function ae(P){return 0===P.type}var i=function(){function P(o,t){this.hostServices=o,this.featureSwitches=t,this.clearLocal()}return P.prototype.onItemContextMenu=function(o,t,h,b,V){var H;(0,Q.n)(h),!this.isEmpty()&&this.isItemSelected(o,!0)?(H=this.selectedItems,t=this.selectionMode):H=[o];var X=this.createContextMenuArgs(o,t,H,h,b,V);X&&this.hostServices.onContextMenu(X)},P.prototype.onWhitespaceClick=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems))},P.prototype.isDrillingEnabled=function(o,t,h){var b=this.createSelectingArgs(o,h,t);return this.hostServices.onSelecting(b),1===b.action},P.prototype.select=function(o,t,h){this.updateSelection(o,t,h,!1),this.hostServices.alertScreenReader(this.getSelectionScreenReaderMessage(o)),this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,h))},P.prototype.getSelectionScreenReaderMessage=function(o){var t,h,b;switch(this.indicatorStyle){case j.RowHeader:h=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(o));var V=1===this.rowHierarchyNavigator.getExpansionState(o);t=_.isEmpty(this.selectedItems)?!h||o.isSubtotal||V?"Row_Group_Unselected":"Row_Unselected":!h||o.isSubtotal||V?"Row_Group_Selected":"Row_Selected";break;case j.ColumnHeader:b=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(o)),t=_.isEmpty(this.selectedItems)?b&&!o.isSubtotal?"Column_Unselected":"Column_Group_Unselected":b&&!o.isSubtotal?"Column_Selected":"Column_Group_Selected";break;case j.BodyCell:h=this.rowHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(o.rowItem)),b=this.columnHierarchyNavigator.isLeaf(this.getEffectiveSelectedHeader(o.columnItem)),t=_.isEmpty(this.selectedItems)?h&&b&&!o.isSubtotal?"Intersection_Unselected":"Intersection_Group_Unselected":h&&b&&!o.isSubtotal?"Intersection_Selected":"Intersection_Group_Selected";break;default:t="Tablix_Selections_Cleared"}return this.hostServices.getLocalizedString(t)},P.prototype.getIndicatorStyle=function(){return this.indicatorStyle},P.prototype.updateSelection=function(o,t,h,b){if(this.featureSwitches.a11yMatrix&&"isRowAndColumnGrandTotal"in o&&(o.isRowAndColumnGrandTotal||o.isBlankRow))return this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0,!0;if(!b&&t!==this.selectionMode&&this.clearLocal(),this.createSelectorsByColumn(o))if(this.isItemSelected(o,b)){if(b)return!1;1===this.selectedItems.length&&1!==h?this.clearLocal():3===h?this.unselectItem(o):0===h&&(this.selectedItems=[o])}else(0===h||t!==this.selectionMode)&&this.clearLocal(),this.selectionMode=t,this.indicatorStyle=t,this.selectedItems.push(o),this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))||(this.selectedItems=[o]);else this.clearLocal(),this.selectionMode=void 0,this.indicatorStyle=void 0;return o.isRowGrandTotal?this.indicatorStyle=j.ColumnHeader:o.isColumnGrandTotal&&(this.indicatorStyle=j.RowHeader),!0},P.prototype.isRowHeaderHighlighted=function(o){if(this.isEmpty())return!0;for(var t=0,h=this.selectedItems;t<h.length;t++)if(this.isRowHeaderOnSelectedPath(h[t],o))return!0;return!1},P.prototype.isColumnHeaderHighlighted=function(o){if(this.isEmpty())return!0;for(var t=0,h=this.selectedItems;t<h.length;t++)if(this.isColumnHeaderOnSelectedPath(h[t],o))return!0;return!1},P.prototype.isRowHeaderIndicatorOn=function(o,t){var h=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(H){return h.isRowHeaderOnSelectedPath(H,o,!0,!t)})&&!(this.indicatorStyle===j.ColumnHeader)},P.prototype.isRowHeaderDarkened=function(o){var t=this;return!!this.featureSwitches.a11yMatrix&&_.some(this.selectedItems,function(V){return t.isRowHeaderOnSelectedPath(V,o,!0,!1)})&&this.indicatorStyle===j.RowHeader},P.prototype.isColumnHeaderIndicatorOn=function(o){var t=this;if(!this.featureSwitches.a11yMatrix)return!1;var h=this.columnHierarchyNavigator.isLeaf(o),b=_.some(this.selectedItems,function(H){return t.isColumnHeaderOnSelectedPath(H,o)});return h&&b&&!(this.indicatorStyle===j.RowHeader)},P.prototype.isColumnHeaderDarkened=function(o){var t=this;return _.some(this.selectedItems,function(V){return t.isColumnHeaderOnSelectedPath(V,o)})&&!(this.indicatorStyle===j.RowHeader)},P.prototype.isBodyCellHighlighted=function(o){if(this.isEmpty())return!0;for(var t=0,h=this.selectedItems;t<h.length;t++)if(this.isBodyCellOnSelectedPath(h[t],o))return!0;return!1},P.prototype.isBodyCellIndicatorOn=function(o){if(this.isEmpty())return!1;for(var t=0,h=this.selectedItems;t<h.length;t++)if(this.isBodyCellOnSelectedPath(h[t],o)&&this.indicatorStyle===j.BodyCell)return!0;return!1},P.prototype.isRowHeaderOnSelectedPath=function(o,t,h,b){return this.indicatorStyle===j.ColumnHeader||(V=ae(o)?o.rowItem:o,this.isOnSelectedPath(this.getEffectiveSelectedHeader(V),t,h,b));var V},P.prototype.isColumnHeaderOnSelectedPath=function(o,t){return this.indicatorStyle===j.RowHeader||(h=ae(o)?o.columnItem:o,this.isOnSelectedPath(this.getEffectiveSelectedHeader(h),t));var h},P.prototype.isBodyCellOnSelectedPath=function(o,t){return this.isRowHeaderOnSelectedPath(o,t.rowItem)&&this.isColumnHeaderOnSelectedPath(o,t.columnItem)},P.prototype.isOnSelectedPath=function(o,t,h,b){if(!o||o===t)return!0;var V=o;if(!h)for(;V;){if(V===t)return!0;V=V.parent}if(V=t,!b)for(;V;){if(V===o)return!0;V=V.parent}return!1},P.prototype.onDataViewChanged=function(o,t){this.rowHierarchyNavigator=o,this.columnHierarchyNavigator=t;var h=o&&o.getHierarchyItems(),b=t&&t.getHierarchyItems();if(!this.isEmpty()){for(var V=[],H=0,X=this.selectedItems;H<X.length;H++){var J=X[H],Y=P.getMatchingItem(J,this.selectionMode,h,b,o);V.push(Y||J)}this.selectedItems=V}},P.getMatchingItem=function(o,t,h,b,V){if(o.isBlankRow)return null;switch(t){case j.RowHeader:return this.getMatchingHeader(o,h);case j.ColumnHeader:return this.getMatchingHeader(o,b);case j.BodyCell:var H=o,X=this.getMatchingHeader(H.rowItem,h),J=this.getMatchingHeader(H.columnItem,b);return X&&J?V.getIntersection(X,J):null}},P.getMatchingHeader=function(o,t){if(t)for(var h=0,b=t;h<b.length;h++){var V=b[h];if(this.areHeadersEqual(o,V))return V;var H=this.getMatchingHeader(o,V.children);if(H)return H}return null},P.areHeadersEqual=function(o,t){if(oe.fF.assert(function(){return!!o&&!!t},"items cannot be null"),(0,ce.fS)(o.identity,t.identity)&&o.queryName===t.queryName){if(!o.parent&&!t.parent)return!0;if(o.parent&&t.parent)return this.areHeadersEqual(o.parent,t.parent)}return!1},P.getMatchingItemById=function(o,t,h,b,V){var H=_.keys(o.dataMap),X=_.chain(V.getColumnHierarchy().levels).filter(function(c){return!c.sources[0].isMeasure}).map(function(c){return c.sources[0].queryName}).filter(function(c){return _.includes(H,c)}).value(),J=_.chain(V.getRowHierarchy().levels).map(function(c){return c.sources[0].queryName}).filter(function(c){return _.includes(H,c)}).value();switch(t){case j.RowHeader:return this.getMatchingHeaderById(o,J,h);case j.ColumnHeader:return this.getMatchingHeaderById(o,X,b);case j.BodyCell:var Y=this.getMatchingHeaderById(o,J,h),F=this.getMatchingHeaderById(o,X,b);return Y&&F?V.getIntersection(Y,F):null}},P.getMatchingHeaderById=function(o,t,h){if(h)for(var b=0,V=h;b<V.length;b++)for(var H=V[b],X=function(d,T){var U=t[d];if(J.headerMatchesId(o,U,H)){if(1===T)return{value:H};oe.fF.assertAnyValue(H.children,"PivotTableSelectionManager.getMatchingHeaderById encountered an ID that does not match the matrix, which should be caught earlier.");var D=J.getMatchingHeaderById(o,_.filter(t,function(I){return I!==U}),H.children);if(D)return{value:D}}},J=this,Y=0,F=t.length;Y<F;Y++){var c=X(Y,F);if("object"==typeof c)return c.value}return null},P.headerMatchesId=function(o,t,h){return oe.fF.assert(function(){return!!o&&!!h},"items cannot be null"),!!(t===h.queryName&&o.dataMap&&o.dataMap[t]&&(0,ce.fS)(_.head(o.dataMap[t]),h.identity))},P.areCornerItemsEqual=function(o,t){return!(!o.metadata||!t.metadata)&&o.metadata.queryName===t.metadata.queryName},P.prototype.clearLocal=function(){this.selectedItems=[]},P.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},P.prototype.restoreSelectionState=function(o,t){if(this.clearLocal(),_.isEmpty(o))return!0;for(var h=!1,b=this.selectedItems,V=0,H=o;V<H.length;V++){var X=H[V],J=this.determineSelectionModeFromIds(X,t);if(null!=J){this.selectionMode=J,this.indicatorStyle=J;var Y=P.getMatchingItemById(X,J,t.getRowHierarchy().root.children,t.getColumnHierarchy().root.children,t);Y&&(b.push(Y),h=!0,Y.isRowGrandTotal?this.indicatorStyle=j.ColumnHeader:Y.isColumnGrandTotal&&(this.indicatorStyle=j.RowHeader))}}return h},P.prototype.determineSelectionModeFromIds=function(o,t){if(!o)return this.selectionMode;var h=_.map(t.getColumnHierarchy().levels,function(J){return J.sources[0].queryName}),b=!1,V=_.map(t.getRowHierarchy().levels,function(J){return J.sources[0].queryName}),H=!1;for(var X in o.dataMap)if(_.includes(h,X))b=!0;else{if(!_.includes(V,X))return;H=!0}return b&&H?j.BodyCell:b?j.ColumnHeader:H?j.RowHeader:void 0},P.prototype.isEmpty=function(){return _.isEmpty(this.selectedItems)},P.prototype.isItemSelected=function(o,t){void 0===t&&(t=!1);for(var h=ae(o)?o:void 0,b=0,V=this.selectedItems;b<V.length;b++){var H=V[b];if(ae(H)&&h){if(this.areBodyCellsEqual(H,h))return!0}else if(H===o)return!0}return!(!t||this.isEmpty()||!h)&&this.isBodyCellHighlighted(h)},P.prototype.unselectItem=function(o){var t=this;ae(o)?_.remove(this.selectedItems,function(h){return t.areBodyCellsEqual(h,o)}):_.pull(this.selectedItems,o)},P.prototype.areBodyCellsEqual=function(o,t){return o.rowItem===t.rowItem&&o.columnItem===t.columnItem},P.prototype.getEffectiveSelectedHeader=function(o){return o&&!o.identity&&o.parent?this.getEffectiveSelectedHeader(o.parent):o},P.prototype.getEffectiveSelectedNodes=function(o){return o.parent?[this.getEffectiveSelectedHeader(o)]:o.identity?[o]:o.siblings},P.getRoleNames=function(o){switch(o){case j.ColumnHeader:return[pe.r.columns];case j.RowHeader:return[pe.r.rows];case j.BodyCell:return[pe.r.values];default:oe.fF.assertFail("unexpected PivotTableSelectionMode")}},P.prototype.createSelectingArgs=function(o,t,h){return{type:0,visualObjects:this.getVisualObjects([o]),position:P.getMouseEventPosition(h),dataRoles:P.getRoleNames(t)}},P.prototype.createSelectArgs=function(o,t){for(var h=[],b=0,V=o;b<V.length;b++){var X=this.createSelectorsByColumn(V[b]);X&&h.push({objectName:"",selectorsByColumn:X})}return{type:0,visualObjects:this.getVisualObjects(o),selectionMode:t}},P.prototype.getVisualObjects=function(o){for(var t=[],h=0,b=o;h<b.length;h++){var H=this.createSelectorsByColumn(b[h]);H&&t.push({objectName:"",selectorsByColumn:H})}return t},P.prototype.createContextMenuArgs=function(o,t,h,b,V,H){for(var J,Y,F,c,C,d,X=this,T=[],U=0,D=h;U<D.length;U++){var q=this.createSelectorsByColumn(D[U]);q&&T.push(q)}var r,v={dataRoles:V,data:T,position:P.getMouseEventPosition(b)};if(ae(o)||(v.nodeIndex=this.getHierarchyNodeIndex(o)),(_.isEmpty(T)||T.every(function(p){return _.isEmpty(p.dataMap)}))&&ae(o)&&o.isRowAndColumnGrandTotal){var e=null===(F=null===(Y=null===(J=o.columnMetadata)||void 0===J?void 0:J.type)||void 0===Y?void 0:Y.misc)||void 0===F?void 0:F.sparkline;return v.copyArgs={singleValue:function(){return e?o.textContent:String(o.dataPoint)}},v}if(ae(o))if(null===(d=null===(C=null===(c=o.columnMetadata)||void 0===c?void 0:c.type)||void 0===C?void 0:C.misc)||void 0===d?void 0:d.sparkline)r=o.textContent;else{var g=o.dataPoint;null!=g&&(r=(0,ee.pW)(g))}else r=o.tooltipValueFormatted;return v.copyArgs={grid:function(){return X.generateGridCopyCallback(h,t)}},void 0!==r&&(v.copyArgs.singleValue=function(){return String(r)}),this.featureSwitches.a11yShowAsMatrix&&(v.visualCommandConfigs=[{titleKey:"UnfreezeRowHeaders",executeFn:function(){return(0,N.__awaiter)(X,void 0,void 0,function(){return(0,N.__generator)(this,function(s){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!0},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,N.__awaiter)(X,void 0,void 0,function(){return(0,N.__generator)(this,function(s){return[2,!H]})})}},{titleKey:"FreezeRowHeaders",executeFn:function(){return(0,N.__awaiter)(X,void 0,void 0,function(){return(0,N.__generator)(this,function(s){return this.hostServices.persistProperties({merge:[{objectName:"rowHeaders",properties:{unfrozen:!1},selector:null}]}),[2]})})},isVisibleFn:function(){return(0,N.__awaiter)(X,void 0,void 0,function(){return(0,N.__generator)(this,function(s){return[2,H]})})}}]),v},P.prototype.generateGridCopyCallback=function(o,t){var V,h=o.slice(),b=[];switch(t){case j.BodyCell:h=this.collectSelectedBodyNodes(h),V=(0,G.kH)(h,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(K.yF)),b.push.apply(b,(0,N.__spreadArray)([V.headers],V.values||[],!1));break;case j.ColumnHeader:for(var H=[],X=0,J=h;X<J.length;X++){var Y=J[X];this.columnHierarchyNavigator.isLeaf(Y)&&this.columnHierarchyNavigator.getColumnHeaderMetadataColumn(Y).isMeasure?H.push.apply(H,Y.siblings||[]):H.push(Y)}V=(0,G.mM)([],h=H,this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(K.yF)),b.push.apply(b,(0,N.__spreadArray)([V.headers],V.values||[],!1));break;case j.RowHeader:V=(0,G.mM)(h,[],this.rowHierarchyNavigator,this.columnHierarchyNavigator,this.hostServices.getLocalizedString(K.yF)),b.push.apply(b,(0,N.__spreadArray)([V.headers],V.values||[],!1));break;default:oe.fF.assertNever(t)}return{grid:b,coveragePercentage:V?V.coveragePercentage:void 0}},P.prototype.getHierarchyNodeIndex=function(o){for(var t=[];o&&null!=o.index;)t.splice(0,0,o.index),o=o.parent;return t},P.prototype.collectSelectedBodyNodes=function(o){for(var t=[],h=0,b=o;h<b.length;h++){var V=b[h];if(!V.isSubtotal&&V.columnItem.identity&&V.rowItem.identity)t.push(V);else{var H=[],X=[];V.isRowGrandTotal||(H=this.getEffectiveSelectedNodes(V.rowItem)),V.isColumnGrandTotal||(X=this.getEffectiveSelectedNodes(V.columnItem));var J=(0,G.Ak)(this.rowHierarchyNavigator,this.columnHierarchyNavigator,H,X);t.push.apply(t,J||[])}}for(var Y=0;Y<t.length;Y++)for(var F=t[Y],c=Y+1;c<t.length;c++)_.isEqual(F,t[c])&&(t.splice(c,1),c--);return t},P.prototype.createSelectorsByColumn=function(o){return ae(o)?this.createSelectorsByColumnForBodyCell(o):this.createSelectorsByColumnForHeader(o)},P.prototype.createSelectorsByColumnForHeader=function(o){var t=o.queryName,h={};return P.addHeaderIdentities(o,h)?{dataMap:h,metadata:[t]}:void 0},P.prototype.createSelectorsByColumnForBodyCell=function(o){var t,h={},b=P.addHeaderIdentities(o.rowItem,h),V=P.addHeaderIdentities(o.columnItem,h),H=null===(t=o.columnMetadata)||void 0===t?void 0:t.queryName;return oe.fF.assert(function(){return b||V||!!H},"Must have a row or column identity or column metadata"),{dataMap:h,metadata:H?[H]:void 0}},P.addHeaderIdentities=function(o,t){for(var h=[];o;)o.identity&&h.splice(0,0,o),o=o.parent;for(var b=0,V=h;b<V.length;b++){var H=V[b];t[H.queryName]=[H.identity]}return h.length>0},P.hasIdentity=function(o){return P.addHeaderIdentities(o,{})},P.getMouseEventPosition=function(o){return{x:o.clientX,y:o.clientY}},P}()},59784:function(Te,Pe,A){A.d(Pe,{S:function(){return pe}});var N=A(76797),pe=function(){function Q(oe){this.hostServices=oe}return Q.prototype.onDataViewChanged=function(oe,ce,ee,K,G){this.isSteppedLayout=K,this.valuesOnRowApplied=G,this.nonMeasureRowLevels=this.getNonMeasureRowLevels(oe),this.valueSources=ee,this.hasRows=oe&&!_.isEmpty(this.nonMeasureRowLevels),this.hasColumns=ce&&!_.isEmpty(ce.levels),this.measureCount=ee?ee.length:0},Q.hasSortingChanged=function(oe,ce){if(!oe||!ce)return!1;var ee=oe.metadata.columns;if(_.isEmpty(ee))return!1;var K=ce.metadata.columns;if(_.isEmpty(K))return!1;for(var G=function(t){var h=_.find(ee,function(b){return t.queryName===b.queryName});if(h&&t.sort!==h.sort)return{value:!0}},j=0,ae=K;j<ae.length;j++){var P=G(ae[j]);if("object"==typeof P)return P.value}return!1},Q.prototype.isCornerSortable=function(oe){return this.hasRows&&null!=oe.metadata&&oe.position.row.isLast&&(!this.valuesOnRowApplied||!oe.position.column.isLast)},Q.prototype.getNonMeasureRowLevels=function(oe){if(this.valuesOnRowApplied){var ce=[];return ce.push.apply(ce,oe.levels||[]),ce.pop(),ce}return oe.levels},Q.prototype.isColumnHeaderSortable=function(oe){var ce=N.l.hasIdentity(oe);return this.hasRows&&this.measureCount>0&&!ce&&oe.position.row.isLast&&!this.valuesOnRowApplied},Q.prototype.getCornerSortDirection=function(oe){if(!this.isCornerSortable(oe))return null;if(this.isSteppedLayout){for(var ce=null,ee=0,K=this.nonMeasureRowLevels;ee<K.length;ee++){var G=K[ee];if(1!==G.sources.length)return null;var j=G.sources[0].sort;if(null==j)return null;if(null!==ce){if(j!==ce)return null}else ce=j}return ce}return this.nonMeasureRowLevels[oe.position.column.index].sources[0].sort},Q.prototype.getColumnHeaderSortDirection=function(oe){return this.isColumnHeaderSortable(oe)?this.getMeasureSortDirection(this.getMeasureQueryName(oe)):null},Q.prototype.getMeasureQueryName=function(oe){return this.hasColumns&&1===this.measureCount?this.valueSources[0].queryName:oe.queryName},Q.prototype.sortCorner=function(oe){var K,ce=this.getCornerSortDirection(oe),ee=Q.getNextSortDirection(ce);if(this.isSteppedLayout){K=[];for(var G=0,j=this.nonMeasureRowLevels;G<j.length;G++)K.push({queryName:j[G].sources[0].queryName,sortDirection:ee})}else K=[{queryName:oe.metadata.queryName,sortDirection:ee}];this.hostServices.onCustomSort({sortDescriptors:K,suppressAnnouncements:!0})},Q.prototype.sortColumnHeader=function(oe){var ce=this.getColumnHeaderSortDirection(oe),ee=this.getMeasureColumn(this.getMeasureQueryName(oe));this.hostServices.onCustomSort({sortDescriptors:[{queryName:this.getMeasureQueryName(oe),sortDirection:Q.getNextSortDirection(ce,ee)}],suppressAnnouncements:!0})},Q.getNextSortDirection=function(oe,ce){return void 0===oe?Q.getDefaultSortDirection(ce):1===oe?2:1},Q.getDefaultSortDirection=function(oe){return oe&&oe.isMeasure&&oe.type&&oe.type.numeric&&!oe.type.temporal?2:1},Q.prototype.getMeasureSortDirection=function(oe){var ce=this.getMeasureColumn(oe);if(null!=ce)return ce.sort},Q.prototype.getMeasureColumn=function(oe){return _.find(this.valueSources,function(ce){return ce.queryName===oe})},Q}()},97654:function(Te,Pe,A){A.r(Pe),A.d(Pe,{TableEx:function(){return Ce}});var N=A(81337),pe=A(3665),Q=A(51650),oe=A(57622),ce=A(28579),ee=A(80065),K=A(52287),G=A(86900),j=A(35249),ae=A(55007),i=A(40739),P=A(40550),o=A(62458),t=A(57419),h=A(59107),b=A(46135),V=A(32379),H=A(72489),X=A(79465),J=A(24133),Y=A(93340),F=A(71090),c=A(73889),C=A(74304),d=A(60014),T=A(54522),U=A(44977),D=A(32105),I=A(19650),q=A(64067),v=A(79154),e=A(39681),r=A(48066),l=A(38078),g=A(58702),p=A(7911),s=A(87914),n=A(59784),u=A(91468),S=A(32771),y=A(29043),f=A(44245),m=function(){function M(a,w){this.isA11yTable=w,this.hostServices=a}return M.prototype.sort=function(a,w,L){void 0===L&&(L=!1);var fe,k=M.getSortDirection(a),Z=n.S.getNextSortDirection(k,a.metadata),ie=a.metadata.queryName,ue={queryName:ie,sortDirection:Z};L?(fe=_.chain(w).filter(function(ge){return void 0!==ge.sortOrder&&ge.queryName!==ie}).sortBy(function(ge){return ge.sortOrder}).map(function(ge){return{queryName:ge.queryName,sortDirection:ge.sort}}).value()).push(ue):fe=[ue],this.hostServices.onCustomSort({sortDescriptors:fe,suppressAnnouncements:this.isA11yTable})},M.hasSortingChanged=function(a,w){if(!a||!w)return!1;var L=a.metadata.columns;if(_.isEmpty(L))return!1;var k=w.metadata.columns;if(_.isEmpty(k))return!1;for(var Z=function(E){var re=_.find(L,function(he){return E.queryName===he.queryName});if(re&&E.sort!==re.sort)return{value:!0}},ie=0,ue=k;ie<ue.length;ie++){var ge=Z(ue[ie]);if("object"==typeof ge)return ge.value}return!1},M.getSortDirection=function(a){return a.metadata.sort},M}(),R=function(){function M(a,w,L,k,Z){this.a11yMatrixFS=Z,this.options=a,this.selectionManager=w,this.measureElement=(0,u.qk)(L),this.legacyTooltipsEnabled=!0,this.hostServices=k}return M.prototype.setFormatMode=function(a){this.formatMode=a},M.prototype.getRowLabelAndRole=function(a){var w=this.hostServices.getLocalizedString(F.Mh),L="gridcell";return null!=a?.dataPoint&&(w=this.hostServices.getLocalizedString("Visual_Tablix_ReferenceRowWithText",a.dataPoint.toString()),L="rowheader"),{rowLabel:(0,l.HZ)(w),rowRole:L}},M.prototype.getRowHeaderBinding=function(a,w,L,k,Z){this.options.onBindRowHeader&&!w&&this.options.onBindRowHeader(a);var ie=this.getRowLabelAndRole(Z),ue=ie.rowLabel,ge={attributes:{role:ie.rowRole},classNames:[],styleProperties:{},children:[]};return k||(ge.children=[{tagName:"label",attributes:{},classNames:["visually-hidden"],styleProperties:{},children:[{tagName:"input",attributes:{type:"checkbox","checkbox-rowindex":a.index.toString()},classNames:[],styleProperties:{}},{tagName:null,content:ue,attributes:{},classNames:[],styleProperties:{}}]}],this.selectionManager.isItemSelected(a)&&(ge.children[0].children[0].attributes.checked="")),ge},M.prototype.getColumnHeaderBinding=function(a,w,L,k,Z,ie){var ue,fe=this.formattingProperties.columnHeaders,ge=this.formattingProperties.columnFormatting[a.metadata.queryName],B=(0,l.HZ)(this.getColumnHeaderLabel(a)),E={},re=m.getSortDirection(a);L&&(E.role="columnheader",E["aria-colindex"]=(0,Y.jT)(a.position.column.index).toString(),1===re?E["aria-sort"]="ascending":2===re&&(E["aria-sort"]="descending")),_.isEmpty(B)&&(B=F.jv),fe.wordWrap&&(B=(0,u.rP)(B));var he=!_.isEmpty(B.trim()),me=this.getColumnHeaderStyle(a,w,he),ye=me.getExtraBottom();me.paddings.bottom+=(0,u.tO)(this.glyphFontInfo.measuredFontHeight);var we=(0,u.Km)(re,this.options.sortIconEnabled,this.options.sortingEnabled,n.S.getDefaultSortDirection(a.metadata),ye,this.glyphFontInfo.textProperties.fontSize,this.hostServices);B+=p.bG.build(we,{});var Me=(0,e.ED)(this.columnHeaderClasses);return k&&(Me.push(K.cy),E[K.Ez]="".concat("columnHeaders"),E[K.QZ]="".concat(1),E[K.CK]="Visual_Tablix_ColumnHeaders"),(0,u.aY)(ge&&ge.styleHeader&&ge.alignment||fe.alignment,Me),!(null===(ue=this.isHeaderAutoWidth)||void 0===ue)&&ue.call(this,a)&&(me.maxWidth=this.getMeasureElementMaxWidth(w)),{content:B,classNames:Me,styleProperties:me.getAttributes(L,void 0,this.a11yMatrixFS,ie),attributes:E}},M.prototype.getRowReferenceQueryName=function(){return this.formattingProperties.rowWithReferenceText.rowWithReferenceText},M.prototype.blankRowsEnabled=function(){return!1},M.prototype.getRowBinding=function(a,w,L,k){this.options.onBindRowHeader&&this.options.onBindRowHeader(a);var Z=this.getRowLabelAndRole(L),fe={classNames:[],attributes:{},styleProperties:{},children:[this.getCheckboxCellBinding(a,w,Z.rowLabel,k,Z.rowRole)]};return this.selectionManager.isRowHighlighted(a)?this.selectionManager.isItemSelected(a)&&fe.classNames.push("row-selected"):fe.classNames.push("row-unselected"),this.formatMode&&fe.classNames.push("format-mode"),fe},M.prototype.getCheckboxCellBinding=function(a,w,L,k,Z){var ie={attributes:{role:Z,"aria-colindex":"1",tabindex:"0","selection-cell":""},classNames:["cell-interactive"],styleProperties:{position:"absolute","box-sizing":"border-box",width:"100%",height:"100%","--outline-top":k.weightTop+1+"px","--outline-right":k.weightRight+1+"px","--outline-bottom":k.weightBottom+1+"px","--outline-left":k.weightLeft+1+"px"}};return w||(ie.children=[{tagName:"label",attributes:{},classNames:["visually-hidden"],styleProperties:{},children:[{tagName:"input",attributes:{type:"checkbox","checkbox-rowindex":a.index.toString()},classNames:[],styleProperties:{}},{tagName:null,content:L,attributes:{},classNames:[],styleProperties:{}}]}],this.selectionManager.isItemSelected(a)&&(ie.children[0].children[0].attributes.checked="")),ie},M.prototype.getBodyCellBinding=function(a,w,L,k,Z,ie,ue,fe){var ge,he,E=(0,l.HZ)(this.getBodyCellContent(a)),re={},me=!_.isEmpty(E.trim()),ye=this.getBodyCellStyle(a,w,me),we=a.columnMetadata;o.fF.assertValue(we,"Body cell with no column metadata");var Ie,Me=this.columnsDataBarsSettings[a.columnMetadata.queryName],He=this.shouldApplyDataBars(Me,a),Fe=this.formattingProperties.columnFormatting[we.queryName],xe=(0,g.TS)(Fe&&Fe.icon,a.icon),Ve=a.hyperlink;if(xe&&"IconOnly"===xe.layout)E="";else if(_.isEmpty(E)&&(E=F.jv),a.isKpi)E=this.getKpiContentString(a),re={};else if(He&&Me.hideText)E=w?F.jv:"";else{this.formattingProperties.values.wordWrap&&(E=(0,u.rP)(E));var _e=(0,Y.MN)(a.columnMetadata,E);if(_e!==r.av.NONE)he=(0,u.RP)(this.formattingProperties.values.urlIcon,_e),Ie=(0,u.RD)(E,(0,l.HZ)(a.textContent),he,this.options.onHyperlinkClicked),Ve=void 0;else if(this.isImage(a)){var We=l.b$.encodeUriForImageDataSvg(a.textContent),Ne=this.formattingProperties.grid;Ie=(0,u.D2)((0,l.HZ)(We),Ne.imageHeight,Ne.imageWidth,(0,l.HZ)(a.altText))}else this.isSparkline(a)&&(E=w?F.jv:"")}this.options.hyperlinksEnabled&&(Ie||""!==E&&E!==F.jv)&&Ve&&(0,r.MN)(Ve)!==r.av.NONE&&(Ie=(0,u.RD)(Ie||E,(0,l.HZ)(Ve),null,this.options.onHyperlinkClicked,!0,!0));var Be,Ee={};if(null!==(ge=this.isBodyCellAutoWidth)&&void 0!==ge&&ge.call(this,a)){var Oe=this.getMeasureElementMaxWidth(w);void 0!==Oe&&(Ee["max-width"]=Oe)}if(this.a11yMatrixFS&&!w&&a.position.column.isFirst){var ze=this.selectionManager.getRowFromCell(a);if(this.selectionManager.isItemSelected(ze)){var Re=this.getBorderInfo(a.position.row.isFirst,a.position.row.isLast,!0,!1,!0,X.p0.Body),Ae=ue&&this.selectionManager.getRowFromCell(ue),ke=Ae&&this.selectionManager.isItemSelected(Ae);Be={attributes:{"aria-hidden":"true"},classNames:[],styleProperties:{width:"100%",top:Re.weightTop+"px",bottom:ke?"0":Re.weightBottom+"px",left:Re.weightLeft+"px",position:"absolute","box-sizing":"border-box",overflow:"hidden","pointer-events":"none"},children:[{tagName:"svg",attributes:{height:"100%",width:"100%"},classNames:[],styleProperties:{left:"0",top:"0",position:"absolute"},children:[{tagName:"line",attributes:{x1:"1",y1:"0",x2:"1",y2:"100%",stroke:"white","stroke-width":"2"},classNames:[],styleProperties:{}},{tagName:"line",attributes:{x1:"3",y1:"0",x2:"3",y2:"100%",stroke:"black","stroke-width":"2"},classNames:[],styleProperties:{}}]}]}}}var Le,Se=Ie=Ie?{tagName:"div",children:[Ie],classNames:[],styleProperties:Ee,attributes:{}}:{tagName:"div",content:E,classNames:[],styleProperties:Ee,attributes:{}};if(xe&&(Le=this.getBodyCellFontInfo(a).measuredFontHeight,Se=(0,u.Ps)(xe,Le,Ie,this.hostServices)),He&&!w&&(Se=(0,S.JF)(Se,Me,ye,a.dataPoint,this.hostServices)),!w&&this.isSparkline(a)&&(o.fF.assert(function(){return null!=L&&null!=k},"height and width should be defined for sparkline rendering"),Se=(0,y.MV)(Se,this.sparklineSettings[a.columnMetadata.queryName],ye,a.dataPoint,L,k,xe,Le)),Z&&(a.fontColor||a.backColor)){var De=this.hostServices.getLocalizedString(F.Sl);_.isEmpty(Se.children)?Se={attributes:{},classNames:[],styleProperties:{},children:[Se,{attributes:{},classNames:["visually-hidden"],styleProperties:{},content:De}]}:Se.children.push({attributes:{},classNames:["visually-hidden"],styleProperties:{},content:De})}if(this.a11yMatrixFS&&Be&&(_.isEmpty(Se.children)?Se={attributes:{},classNames:[],styleProperties:{},children:[Se,Be]}:Se.children.push(Be)),ie){(re=re??{})[K.QZ]="".concat(1);var Ye=a.columnMetadata.isMeasure;a.isRowGrandTotal||a.isTotal?Ye||""===a.textContent?(Se.classNames.push(K.cy),re[K.Ez]="".concat("totals"),re[K.CK]="Visual_Tablix_TotalsSection"):""!==a.textContent&&(Se.classNames.push(K.cy),re[K.Ez]="".concat("total-labels"),re[K.CK]="Visual_Tablix_TotalsSection_Label",re[K.kv]=JSON.stringify({reference:d.Z.total.label,style:0}).replace(/\"/g,"&quot;")):(Se.classNames.push(K.cy),re[K.Ez]="".concat(Ye?"measure-values":"values"),re[K.CK]="Visual_Tablix_Values")}return this.a11yMatrixFS&&(ze=this.selectionManager.getRowFromCell(a),this.selectionManager.isBodyCellHighlighted(a)?this.selectionManager.isItemSelected(ze)&&Se.classNames.push("cell-selected"):Se.classNames.push("cell-unselected")),this.addBodyCellClasses(a,!!he,Ie.classNames,Se.classNames),this.addBodyCellStyleAttributes(a,ye,Se.styleProperties,Z,k),Se.attributes=re,Se},M.prototype.getMeasureElementMaxWidth=function(a){return this.formattingProperties.values.wordWrap&&a&&this.getViewport?"".concat(this.getViewport().width-s.zf-3,"px"):void 0},M.prototype.getCornerCellBinding=function(a,w,L){return L?{content:this.hostServices.getLocalizedString(F.uX),classNames:["visually-hidden"],attributes:{role:"columnheader","aria-colindex":"1",tabindex:"-1"},styleProperties:{}}:{content:"",classNames:null,styleProperties:null,attributes:void 0}},M.prototype.getApproximateRowHeaderWidth=function(a){return 0},M.prototype.getApproximateColumnHeaderWidth=function(a){var w,L,k,Z,ie=this.getColumnHeaderStyle(a,!0,!0);return(this.formattingProperties.columnHeaders.wordWrap?(0,u.JT)(this.getColumnHeaderLabel(a),this.getColumnHeaderFontInfo(a).textProperties):(0,u.X1)(this.getColumnHeaderLabel(a),this.getColumnHeaderFontInfo(a).textProperties))+(null!==(L=null===(w=ie.borders.left)||void 0===w?void 0:w.weight)&&void 0!==L?L:0)+(null!==(Z=null===(k=ie.borders.right)||void 0===k?void 0:k.weight)&&void 0!==Z?Z:0)},M.prototype.getApproximateBodyCellWidth=function(a){var w,L,k,Z,ie=0;if(a.icon){if(ie=this.getBodyCellFontInfo(a).measuredFontHeight,"IconOnly"===a.icon.layout)return ie;ie+=u.MO}if(a.isKpi)return ie+this.valueFontInfo.fontProperties.size.px;var ue=a.columnMetadata&&this.columnsDataBarsSettings[a.columnMetadata.queryName];if(ue&&ue.hideText&&!a.isTotal&&_.isNumber(a.dataPoint))return ie;var fe=this.getBodyCellContent(a),ge=(0,Y.MN)(a.columnMetadata,fe);if(ge!==r.av.NONE&&(0,u.RP)(this.formattingProperties.values.urlIcon,ge))return ie+this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return ie+this.formattingProperties.grid.imageWidth;if(this.isSparkline(a))return ie;var B=this.getBodyCellFontInfo(a),E=this.getBodyCellStyle(a,!0,!0);return ie+(this.formattingProperties.values.wordWrap?(0,u.JT)(fe,B.textProperties):(0,u.X1)(fe,B.textProperties))+(null!==(L=null===(w=E.borders.left)||void 0===w?void 0:w.weight)&&void 0!==L?L:0)+(null!==(Z=null===(k=E.borders.right)||void 0===k?void 0:k.weight)&&void 0!==Z?Z:0)},M.prototype.getApproximateCornerCellWidth=function(a){return 0},M.prototype.getApproximateRowHeaderHeight=function(a,w){return 0},M.prototype.getApproximateColumnHeaderHeight=function(a,w){var L,k,Z,ie,ue,fe=this.getColumnHeaderFontInfo(a),ge=this.getColumnHeaderStyle(a,!0,!0);ue=this.formattingProperties.columnHeaders.wordWrap&&null!=w?(0,u.do)(this.getColumnHeaderLabel(a),(0,u.x9)(w,ge),fe.textProperties).length:1;var B=null!==(k=null===(L=ge.borders.top)||void 0===L?void 0:L.weight)&&void 0!==k?k:0,E=null!==(ie=null===(Z=ge.borders.bottom)||void 0===Z?void 0:Z.weight)&&void 0!==ie?ie:0;return fe.measuredFontHeight*ue+B+E},M.prototype.getApproximateBodyCellHeight=function(a,w){var L,k,Z,ie,ue=this.getBodyCellFontInfo(a);if(a.icon&&"IconOnly"===a.icon.layout)return ue.measuredFontHeight;if(a.isKpi)return this.valueFontInfo.fontProperties.size.px;var fe=this.getBodyCellContent(a),ge=(0,Y.MN)(a.columnMetadata,fe);if(ge!==r.av.NONE&&(0,u.RP)(this.formattingProperties.values.urlIcon,ge))return this.valueFontInfo.fontProperties.size.px;if(this.isImage(a))return this.formattingProperties.grid.imageHeight;if(this.isSparkline(a))return ue.measuredFontHeight;var B,E=this.getBodyCellStyle(a,!0,!0);this.formattingProperties.values.wordWrap&&null!=w?(a.icon&&(w-=ue.measuredFontHeight+u.MO),B=(0,u.do)(fe,(0,u.x9)(w,E),ue.textProperties).length):B=1;var re=null!==(k=null===(L=E.borders.top)||void 0===L?void 0:L.weight)&&void 0!==k?k:0,he=null!==(ie=null===(Z=E.borders.bottom)||void 0===Z?void 0:Z.weight)&&void 0!==ie?ie:0;return ue.measuredFontHeight*B+re+he},M.prototype.getApproximateCornerCellHeight=function(a,w){return 0},M.prototype.updateFormattingProperties=function(a,w,L,k){this.formattingProperties=w,this.legacyTooltipsEnabled=k;var Z=w.general.textSize,ie=new u.Kq,ue={},fe={},ge={};ue.family=w.columnHeaders.fontFamily||F.F2,ue.size=w.columnHeaders.fontSize||Z,w.columnHeaders.bold&&(ue.weight=v.en),w.columnHeaders.italic&&(ue.style=v.BF),w.columnHeaders.underline&&(ue.textDecoration=v.f0),this.columnHeaderFontInfo=(0,u.Od)(ue,ie),fe.family=w.values.fontFamily||F.dG,fe.size=w.values.fontSize||Z,w.values.bold&&(fe.weight=v.en),w.values.italic&&(fe.style=v.BF),w.values.underline&&(fe.textDecoration=v.f0),this.valueFontInfo=(0,u.Od)(fe,ie);var E,B=w.total.fontFamily;B||this.valueFontInfo.fontProperties.family!==F.dG?E=!0:this.valueFontInfo.fontProperties.family===F.dG&&(B=F.Zk),ge.family=B,ge.size=w.total.fontSize,w.total.bold&&E&&(ge.weight=v.en),w.total.italic&&(ge.style=v.BF),w.total.underline&&(ge.textDecoration=v.f0),this.totalFontInfo=(0,u.TQ)(this.valueFontInfo,ge,ie),this.glyphFontInfo=(0,u.Od)({family:F.Vz,size:D.B.createFromPt((w.columnHeaders.fontSize||Z).pt*F.Yo),lineHeight:"100%"},ie),ie.measureAll(this.measureElement),this.columnHeaderClasses=[],this.columnHeaderClasses.push(this.formattingProperties.columnHeaders.wordWrap?u.n2:u.wV),this.options.interactivityIndicatorEnabled&&this.options.sortingEnabled&&this.columnHeaderClasses.push(u.VM),this.columnsDataBarsSettings={};var re=w.columnFormatting;if(re&&a&&a.table&&!_.isEmpty(a.table.columns))for(var he=0,me=a.table.columns;he<me.length;he++)(we=(ye=me[he]).queryName)&&re[we]&&(this.columnsDataBarsSettings[we]=(0,S.az)(ye,re[we].dataBarsSettings,L));this.sparklineSettings={};var Me=w.sparklines;if(Me&&a&&a.table&&!_.isEmpty(a.table.columns))for(var He=0,Fe=a.table.columns;He<Fe.length;He++){var ye,we;(we=(ye=Fe[He]).queryName)&&Me[we]&&(this.sparklineSettings[we]=(0,y.wJ)(Me[we],ye.type,L))}},M.prototype.getColumnHeaderLabel=function(a){return this.ensureMeasuringSafeText(a.metadata.displayName,this.formattingProperties.columnHeaders.wordWrap)},M.prototype.getBodyCellContent=function(a){return this.ensureMeasuringSafeText(a.textContent,this.formattingProperties.values.wordWrap)},M.prototype.ensureMeasuringSafeText=function(a,w){var L;return a?w?_.isEmpty(null===(L=a.trim)||void 0===L?void 0:L.call(a))?"":a:(0,U.zI)(a):""},M.prototype.addBodyCellStyleAttributes=function(a,w,L,k,Z){w.setAttributes(L,k,void 0,this.a11yMatrixFS,Z),L.position="relative",this.a11yMatrixFS||!this.selectionManager.isBodyCellHighlighted(a)&&!k&&(0,u.CQ)(L)},M.prototype.getColumnHeaderStyle=function(a,w,L){var k=new Y.qZ(u.K2,u.K2);return(0,f.aV)(a.position,k,this.formattingProperties,this.getColumnFormatting(a.metadata),this.options.tablixProperties),k.fontFamily=void 0,this.formattingProperties.columnHeaders.underline&&L&&(k.textDecoration=v.f0),(0,u.Nk)(this.columnHeaderFontInfo,k,L),k},M.prototype.getBodyCellStyle=function(a,w,L){var k=new Y.qZ(u.K2,u.K2);return a.isRowGrandTotal?((0,f.ji)(a.position,a,k,this.formattingProperties,this.getColumnFormatting(a.columnMetadata),this.options.tablixProperties),this.formattingProperties.total.underline&&L&&(k.textDecoration=v.f0),(0,u.Nk)(this.totalFontInfo,k,L)):((0,f.cP)(a.position,a,k,this.formattingProperties,this.getColumnFormatting(a.columnMetadata),this.options.tablixProperties),this.formattingProperties.values.underline&&L&&(k.textDecoration=v.f0),(0,u.Nk)(this.valueFontInfo,k,L)),k},M.prototype.getBorderInfo=function(a,w,L,k,Z,ie){var ue,fe,ge,B,ye,we,Me,He,Fe,xe,Ve,Ie,_e,E=0,re=0,he=0,me=0;switch(ie){case X.p0.Header:_e=this.formattingProperties.columnHeaders;break;case X.p0.Body:_e=this.formattingProperties.values;break;case X.p0.Footer:_e=this.formattingProperties.total;break;default:o.fF.assertNever(ie)}var We=null!==(ue=_e.outlineWeight)&&void 0!==ue?ue:this.formattingProperties.grid.outlineWeight,Ne=null!==(fe=_e.outlineColor)&&void 0!==fe?fe:this.formattingProperties.grid.outlineColor,Ee=null===(ge=this.formattingProperties.grid)||void 0===ge?void 0:ge.gridHorizontalColor,Oe=null===(B=this.formattingProperties.grid)||void 0===B?void 0:B.gridVerticalColor,Be=(0,q.ok)("#FFFFFF",.67,Ee),ze=(0,q.ok)("#FFFFFF",.67,Oe);return a&&(0,P.yo)(_e.outline)&&(E=We,ye=Y.Pb.Outline,Fe=Ne),k&&(0,P.BK)(_e.outline)?(re=We,we=Y.Pb.Outline,xe=Ne):!k&&this.formattingProperties.grid.gridVertical&&(re=this.formattingProperties.grid.gridVerticalWeight,we=Y.Pb.Gridline,xe=this.selectionManager.isSelectionEmpty()?Oe:ze),w&&(0,P.mv)(_e.outline)?(he=We,Me=Y.Pb.Outline,Ve=Ne):!w&&this.formattingProperties.grid.gridHorizontal&&(he=this.formattingProperties.grid.gridHorizontalWeight,Me=Y.Pb.Gridline,Ve=Z?Ee:Be),L&&(0,P.fs)(_e.outline)&&(me=We,He=Y.Pb.Outline,Ie=Ne),{weightTop:E,weightRight:re,weightBottom:he,weightLeft:me,typeTop:ye,typeRight:we,typeBottom:Me,typeLeft:He,colorTop:Fe,colorRight:xe,colorBottom:Ve,colorLeft:Ie}},M.prototype.addBodyCellClasses=function(a,w,L,k){var ie,fe,Z=this.formattingProperties.columnFormatting[a.columnMetadata.queryName];L.push(this.formattingProperties.values.wordWrap?u.n2:u.wV),w&&L.push(F.LU),this.options.interactivityIndicatorEnabled&&this.options.selectionEnabled&&!a.isRowGrandTotal&&!this.formatMode&&k.push(u.VM),Z&&(a.isTotal?Z.styleTotal:Z.styleValues)&&(ie=Z.alignment),w?fe=I.H.center:a.isNumeric&&(fe=I.H.right),(0,u.aY)(ie,L,fe)},M.prototype.getKpiContentString=function(a){return(0,u.kJ)(a.columnMetadata.kpi,a.textContent)},M.prototype.getColumnHeaderFontInfo=function(a){return this.columnHeaderFontInfo},M.prototype.getBodyCellFontInfo=function(a){return a.isRowGrandTotal?this.totalFontInfo:this.valueFontInfo},M.prototype.getColumnFormatting=function(a){return this.formattingProperties.columnFormatting[a.queryName]},M.prototype.shouldApplyDataBars=function(a,w){if(!a||!_.isNumber(w.dataPoint))return!1;switch(a.totalMatching){case 0:return!0;case 2:return w.isTotal;case 1:case void 0:return!w.isTotal;default:return o.fF.assertNever(a.totalMatching),!w.isTotal}},M.prototype.isImage=function(a){return!(a.isRowGrandTotal&&!_.isEmpty(a.columnMetadata.identityExprs))&&(0,T.pt)(a.columnMetadata)},M.prototype.isSparkline=function(a){var w,L=a.columnMetadata,k=null===(w=L?.type)||void 0===w?void 0:w.misc;return null!=k&&null!=k.sparkline},M}(),x=function(){function M(){}return M.prototype.getNodeLeafCount=function(){return 1},M.prototype.isBlank=function(){return!1},M.prototype.isBlankRow=function(a){return!1},M.prototype.numberOfBlankRowsBefore=function(a){return 0},M.prototype.getIndexOfFirstLeaf=function(a){return a.position.column.index},M.prototype.hasHierarchy=function(){return!0},M.prototype.update=function(a){this.updateColumns(a)},M.prototype.getColumns=function(){return this.columns},M.prototype.getHierarchyDepth=function(){return 1},M.prototype.getHierarchyLeafCount=function(){return _.size(this.columns)},M.prototype.getHierarchyLeafAt=function(a){return this.columns[a]},M.prototype.getFloatingHierarchyLeafCount=function(){return 0},M.prototype.getFloatingHierarchyLeafAt=function(a){return null},M.prototype.getHierarchyItems=function(){return this.columns},M.prototype.getFloatingHierarchyItems=function(){return null},M.prototype.getLeafIndex=function(a){return a.position.column.index},M.prototype.isLeaf=function(a){return!0},M.prototype.isLastItem=function(a,w){return a.position.column.index===w.length-1},M.prototype.getAncestor=function(a){return null},M.prototype.getParent=function(a){return null},M.prototype.getChildren=function(a){return null},M.prototype.getLevel=function(a){return 0},M.prototype.getIndex=function(a){return a.position.column.index},M.prototype.getPathIndices=function(a){return[this.getIndex(a)]},M.prototype.getNodeFromPath=function(a){if(1===a.length)return this.columns[a[0]]},M.prototype.getItemsByLevel=function(a){return o.fF.assert(function(){return 0===a},"Table columns hierarchy has 1 level"),(0,N.__spreadArray)([],this.columns||[],!0)},M.prototype.getLeafAncestorAtLevel=function(a,w){return a},M.prototype.getExpansionState=function(a){return 2},M.prototype.getFirstDescendentLeafIndex=function(a){return this.getLeafIndex(a)},M.prototype.getIntersection=function(a,w){return null},M.prototype.getCorner=function(a,w){return null},M.prototype.getRowLevel=function(a){return 0},M.prototype.getColumnLevel=function(a){return 0},M.prototype.isColumnHeaderMultiValueSubtotal=function(a){return!1},M.prototype.isRowHeaderMultiValueSubtotal=function(a){return!1},M.prototype.getColumnIndexFromQueryName=function(a){return _.find(this.columns,function(w){return w.metadata.queryName===a})},M.prototype.updateColumns=function(a){this.columns=[];for(var w=a.length,L=0;L<w;L++)this.columns.push({metadata:a[L],position:this.calculateItemPosition(L,w)})},M.prototype.calculateItemPosition=function(a,w){var L=new Y.ri;return L.row.index=L.row.indexInSiblings=0,L.row.isFirst=!0,L.row.isLast=!0,L.column.index=L.column.indexInSiblings=a,L.column.isFirst=0===a,L.column.isLast=a===w-1,L},M}(),O=function(){function M(a,w){this.tablixProperties=a,this.hostServices=w}return M.prototype.update=function(a,w,L,k,Z,ie){this.isDataComplete=k,this.formattingProperties=ie,this.formatters=ie.formatters,this.tooltipFormatters=ie.tooltipFormatters||{},this.updateRows(a,w),this.updateFloatingRow(L,Z)},M.prototype.getNodeLeafCount=function(){return 1},M.prototype.getIndexOfFirstLeaf=function(a){return a.index},M.prototype.hasHierarchy=function(){return!1},M.prototype.getRows=function(){return this.rows},M.prototype.isBlank=function(){return!1},M.prototype.isBlankRow=function(a){return!1},M.prototype.numberOfBlankRowsBefore=function(a){return 0},M.prototype.getHierarchyDepth=function(){return 1},M.prototype.getHierarchyLeafCount=function(){return _.size(this.rows)},M.prototype.getHierarchyLeafAt=function(a){return this.rows[a]},M.prototype.getFloatingHierarchyLeafCount=function(){return this.floatingRow?1:0},M.prototype.getFloatingHierarchyLeafAt=function(a){return this.floatingRow},M.prototype.getHierarchyItems=function(){return this.rows},M.prototype.getFloatingHierarchyItems=function(){return this.floatingRow?[this.floatingRow]:null},M.prototype.getLeafIndex=function(a){return a.index},M.prototype.isLeaf=function(a){return!0},M.prototype.isLastItem=function(a,w){return this.isDataComplete&&a.index===w.length-1},M.prototype.getAncestor=function(a){return null},M.prototype.getParent=function(a){return null},M.prototype.getIndex=function(a){return a.index},M.prototype.getPathIndices=function(a){return[this.getIndex(a)]},M.prototype.getNodeFromPath=function(a){if(1===a.length)return this.rows[a[0]]},M.prototype.getItemsByLevel=function(a){return o.fF.assert(function(){return 0===a},"Table rows hierarchy has 1 level"),[this.rows[0]]},M.prototype.getChildren=function(a){return null},M.prototype.getLevel=function(a){return 0},M.prototype.getLeafAncestorAtLevel=function(a,w){return a},M.prototype.getExpansionState=function(a){return 2},M.prototype.getIntersection=function(a,w){var L,k,Z=w.position.column.index,ie=a.values[Z],ue=a.values.objects&&a.values.objects[Z],fe=w.metadata.queryName,ge=w.metadata,B=a===this.floatingRow;_.isString(ie)&&null!==(k=null===(L=ge?.type)||void 0===L?void 0:L.misc)&&void 0!==k&&k.sparkline&&(ie=(0,y.th)(ie,this.hostServices));var E=new Y.ri,re=w.position;E.column.index=re.column.index,E.column.isFirst=re.column.isFirst,E.column.isLast=re.column.isLast;var he=a.index;E.row.index=he,E.row.isFirst=0===he,E.row.isLast=this.isDataComplete&&a===_.last(this.rows);var me,ye,we=B&&!ge.isMeasure&&0===re.column.index;if(we)me=ye=this.formattingProperties.total.totalLabel;else{var Me=this.formatters[fe],He=this.tooltipFormatters[fe];me=Me?Me.format(ie,ue):null!=ie?"".concat(ie):"",ye=He?He.format(ie,ue):me}var Fe={position:E,dataPoint:ie,isRowGrandTotal:B,columnMetadata:ge,isTotal:B,isDefaultTotalLabel:we&&this.formattingProperties.total.isDefaultTotalLabel,textContent:me,tooltipContent:ye,isKpi:ge&&(0,Y.Y1)(ge.kpi,me),isNumeric:ge&&ge.type.numeric&&!ge.kpi};return ue&&(Fe.backColor=(0,l.HZ)(this.tablixProperties.PropValuesBackColor.getValue(ue)),Fe.fontColor=(0,l.HZ)(this.tablixProperties.PropValuesFontColor.getValue(ue)),Fe.icon=ae.FX.PropValuesIcon.getValue(ue),Fe.hyperlink=ae.FX.PropValuesWebURL.getValue(ue),Fe.altText=ae.FX.PropAltTextValue.getValue(ue)),Fe},M.prototype.getCorner=function(a,w){return{}},M.prototype.getRowLevel=function(a){return 0},M.prototype.getColumnLevel=function(a){return 0},M.prototype.isColumnHeaderMultiValueSubtotal=function(a){return!1},M.prototype.isRowHeaderMultiValueSubtotal=function(a){return!1},M.prototype.getColumnIndexFromQueryName=function(a){},M.prototype.updateRows=function(a,w){this.rows=[];for(var L=0;L<a.length;L++)this.rows.push({index:L,values:a[L],identity:w?w[L]:void 0})},M.prototype.updateFloatingRow=function(a,w){this.floatingRow=_.isEmpty(a)?null:{index:0,values:a,identity:void 0}},M}(),W=A(26543),te=function(){function M(a,w,L){this.tooltipService=a,this.selectionManager=w,this.tooltipsEnabled=!0}return M.prototype.getBodyHandler=function(){var a=this;return{addTooltip:function(L,k){return a.addBodyTooltip(L,k)},removeTooltip:function(L,k){return a.removeTooltip(k)},isTooltipEnabled:function(L){return a.tooltipsEnabled&&a.isBodyTooltipEnabled(L)},setTooltipDelegate:function(L,k,Z,ie,ue){return a.setTooltipDelegate(L,k,ie,ue)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},M.prototype.getHeaderHandler=function(){var a=this;return{addTooltip:function(L,k,Z){return a.addHeaderTooltip(L,k,Z)},removeTooltip:function(L,k){return a.removeTooltip(k)},isTooltipEnabled:function(L){return a.tooltipsEnabled},setTooltipDelegate:function(L,k,Z,ie,ue){return a.setTooltipDelegateHeader(L,k,ie,ue)},isTooltipEnabledGeneric:function(){return a.tooltipsEnabled}}},M.prototype.onDataViewChanged=function(a,w){this.rowHierarchyNavigator=a,this.columnHierarchyNavigator=w},M.prototype.tooltipVisible=function(){return this.tooltipService&&this.tooltipService.visible()},M.prototype.hideTooltip=function(){this.tooltipService&&this.tooltipService.hide()},M.prototype.setTooltipsEnabled=function(a){this.tooltipsEnabled=a},M.prototype.addBodyTooltip=function(a,w){var L=this,k=d3.select(w);this.tooltipService.addTooltip(k,function(Z){return L.getBodyTooltipInfo(a,Z)},function(Z){var ie=L.getItemSelectionId(a,Z);return ie&&[ie]})},M.prototype.setTooltipDelegate=function(a,w,L,k){var Z=this,ie=d3.select(w);this.tooltipService.addTooltip(ie,function(ue){return!Z.tooltipsEnabled&&k(ue)?null:Z.getBodyTooltipInfo(a(ue),ue,!Z.tooltipsEnabled)},function(ue){if(!Z.tooltipsEnabled)return null;var fe=Z.getItemSelectionId(a(ue),ue);return fe&&[fe]},!0,!0,L)},M.prototype.addHeaderTooltip=function(a,w,L){var Z,ie,k=this,ue=d3.select(w),fe=null===(ie=(Z=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===ie?void 0:ie.call(Z);this.tooltipService.addTooltip(ue,function(ge){return k.getHeaderTooltipInfo(a,ge)},fe?function(ge){return k.getItemSelectionId(a,ge)}:function(ge){},void 0,L)},M.prototype.setTooltipDelegateHeader=function(a,w,L,k){var ie,ue,Z=this,fe=d3.select(w),ge=null===(ue=(ie=this.tooltipService).isTouchScreenOptimizedEnabled)||void 0===ue?void 0:ue.call(ie);this.tooltipService.addTooltip(fe,function(B){return!Z.tooltipsEnabled&&k(B)?null:Z.getHeaderTooltipInfo(a(B),B,!Z.tooltipsEnabled)},function(B){return Z.tooltipsEnabled&&ge?[Z.getItemSelectionId(a(B),B)]:null},!0,!0,L)},M.prototype.removeTooltip=function(a){var w=d3.select(a);this.tooltipService.removeTooltips(w)},M.prototype.isBodyTooltipEnabled=function(a){return!a.isRowGrandTotal||!_.isEmpty(a.textContent)},M.prototype.getHeaderTooltipInfo=function(a,w,L){if(a)return L?[{displayName:"",value:a.metadata.displayName}]:[{displayName:a.metadata.displayName}]},M.prototype.getBodyTooltipInfo=function(a,w,L){var k;if(this.rowHierarchyNavigator&&a){if(L)return"IconOnly"===(null===(k=a.icon)||void 0===k?void 0:k.layout)?void 0:[{displayName:"",value:a.tooltipContent}];var Z=[],ie=this.rowHierarchyNavigator.getHierarchyLeafAt(a.position.row.index);if(!a.isRowGrandTotal){var ue=this.getGroupingTooltipInfo(ie);ue&&Z.push.apply(Z,ue||[])}if(a.columnMetadata.isMeasure){var ge=a.columnMetadata.displayName;a.isKpi?Z.push({displayName:ge,kpiValue:{metadata:a.columnMetadata.kpi,value:a.tooltipContent}}):_.isEmpty(a.tooltipContent)||Z.push({displayName:ge,value:a.tooltipContent})}else a.isRowGrandTotal&&!_.isEmpty(a.tooltipContent)&&Z.push({displayName:a.tooltipContent});return _.isEmpty(Z)?void 0:Z}},M.prototype.getGroupingTooltipInfo=function(a){if(this.columnHierarchyNavigator&&this.rowHierarchyNavigator){for(var L=[],k=0,Z=this.columnHierarchyNavigator.getColumns();k<Z.length;k++){var ie=Z[k];if(!ie.metadata.isMeasure){var ue=this.rowHierarchyNavigator.getIntersection(a,ie);L.push({displayName:ie.metadata.displayName,value:ue.tooltipContent})}}return L}},M.prototype.getItemSelectionId=function(a,w){if(this.rowHierarchyNavigator&&a&&!a.isRowGrandTotal){var L=this.rowHierarchyNavigator.getHierarchyLeafAt(a.position.row.index);return W.l0.fromSelectorsByColumn(this.selectionManager.createSelectorsByColumn(L))}},M}(),ne=A(66232),de=A(78843),le=function(){function M(a){this.hostServices=a,this.totalLabel=this.hostServices.getLocalizedString(F.qT),this.clearLocal()}return M.prototype.onBodyCellContextMenu=function(a,w){if((0,ne.n)(w),this.isTableEmpty())o.fF.assertFail("onBodyCellContextMenu should not be triggered on empty table.");else{var k,L=this.getRowFromCell(a);k=!this.isSelectionEmpty()&&this.isItemSelected(L)?this.selectedItems:[L];var Z=this.createContextMenuArgs(a,k,w);Z&&this.hostServices.onContextMenu(Z)}},M.prototype.onBodyCellClick=function(a,w,L){o.fF.assert(function(){return null!=a||null!=L},"cell or row should be defined"),this.isTableEmpty()?o.fF.assertFail("onBodyCellClick should not be triggered on empty table."):a?a.isRowGrandTotal?this.clearHost():this.select(this.getRowFromCell(a),w):this.select(this.rows[L],w)},M.prototype.onWhitespaceClick=function(){this.clearHost()},M.prototype.isDrillingEnabled=function(a,w){if(!this.isTableEmpty()){var L={type:0,visualObjects:this.getVisualObjects([this.getRowFromCell(a)]),position:M.getMouseEventPosition(w)};return this.hostServices.onSelecting(L),1===L.action}o.fF.assertFail("isDrillingEnabled should not be triggered on empty table.")},M.prototype.select=function(a,w,L,k){if(void 0===L&&(L=!1),this.isItemSelected(a)){if(L)return;1===this.selectedItems.length&&1!==w?this.clearLocal():3===w?this.unselectItem(a):0===w&&(this.selectedItems=[a])}else 0===w&&this.clearLocal(),this.selectedItems.push(a),!k&&!this.hostServices.canSelect(this.createSelectArgs(this.selectedItems))&&(this.selectedItems=[a]);k||this.hostServices.onSelect(this.createSelectArgs(this.selectedItems,w))},M.prototype.isRowHighlighted=function(a){return!(!this.isSelectionEmpty()&&!this.isTableEmpty())||this.isItemSelected(a)},M.prototype.isBodyCellHighlighted=function(a){return!(!this.isSelectionEmpty()&&!this.isTableEmpty())||this.isItemSelected(this.getRowFromCell(a))},M.prototype.onDataViewChanged=function(a,w){if(this.rowNavigator=a,this.rows=a&&a.getRows(),this.totalRow=a&&a.getFloatingHierarchyLeafAt(0),this.columns=w&&w.getColumns(),!this.isSelectionEmpty()){for(var L=[],k=0,Z=this.selectedItems;k<Z.length;k++){var ie=Z[k],ue=M.getMatchingRow(ie,this.rows);L.push(ue||ie)}this.selectedItems=L}},M.prototype.clearLocal=function(){this.selectedItems=[]},M.prototype.isSelectionEmpty=function(){return _.isEmpty(this.selectedItems)},M.prototype.isTableEmpty=function(){return!this.rows},M.prototype.isItemSelected=function(a){return-1!==this.selectedItems.indexOf(a)},M.prototype.unselectItem=function(a){_.pull(this.selectedItems,a)},M.prototype.clearHost=function(){this.clearLocal(),this.hostServices.onSelect(this.createSelectArgs([]))},M.prototype.restoreSelection=function(a){if(this.clearLocal(),_.isEmpty(a))return!0;var w=_.keys(a[0].dataMap);if(1!==w.length)return!1;var L=_.chain(this.columns).filter(function(we){return!we.metadata.isMeasure}).map(function(we){return we.metadata.queryName}).value(),k=w[0];if(!_.includes(L,k))return!1;for(var Z=!1,ie=_.clone(a),ue=0,fe=this.rows;ue<fe.length;ue++){for(var ge=fe[ue],B=void 0,E=function(Me){var He=Me.dataMap[k][0];if(o.fF.assert(function(){return 1===Me.dataMap[k].length},"TableExSelectionManager.restoreSelection received an identity with multiple scope identities"),o.fF.assert(function(){return(0,V.yN)(He)},"TableExSelectionManager.restoreSelection received an identity that was not a scope identity"),(0,de.fS)(He,ge.identity))return B=Me,"break"},re=0,he=ie;re<he.length&&"break"!==E(he[re]);re++);B&&(this.select(ge,3,!1,!0),_.remove(ie,B),Z=!0)}return Z},M.prototype.getRowFromCell=function(a){var w=this;return o.fF.assert(function(){return!a.isRowGrandTotal||a.isRowGrandTotal&&!!w.totalRow},"expected a floating row to be present for a rowGrandTotal cell"),a.isRowGrandTotal?this.totalRow:this.rows[a.position.row.index]},M.prototype.getRowAtIndex=function(a){return this.rows[a]},M.prototype.createContextMenuArgs=function(a,w,L){for(var k=this,Z=[],ie=0,ue=w;ie<ue.length;ie++){var ge=this.createSelectorsByColumn(ue[ie]);ge&&Z.push(ge)}o.fF.assert(function(){return!(_.isEmpty(Z)&&1!==k.rows.length)},"multi-row tables should have identities");var B={data:Z,position:M.getMouseEventPosition(L)};return B.copyArgs={singleValue:function(){var he,me;return(null===(me=null===(he=a.columnMetadata.type)||void 0===he?void 0:he.misc)||void 0===me?void 0:me.sparkline)?a.textContent:(0,Y.pW)(a.dataPoint)},grid:function(){var me=k.columns.length,ye=new Array(w.length+1);ye[0]=new Array(me),k.columns.forEach(function(Me,He){ye[0][He]=Me.metadata.displayName}),w.forEach(function(Me,He){var Fe=ye[He+1]=new Array(me);k.columns.forEach(function(xe,Ve){Fe[Ve]=k.rowNavigator.getIntersection(Me,xe).textContent})}),a.isRowGrandTotal&&k.totalRow&&k.totalRow.values&&_.isEmpty(k.totalRow.values[0])&&(ye[1][0]=k.totalLabel);var we=0;return 0!==k.rows.length&&(we=Math.round(w.length/k.rows.length*100)),{grid:ye,coveragePercentage:we}}},B},M.prototype.createSelectArgs=function(a,w){return void 0===w&&(w=0),{type:0,visualObjects:this.getVisualObjects(a),selectionMode:w}},M.prototype.getVisualObjects=function(a){for(var w=[],L=0,k=a;L<k.length;L++){var ie=this.createSelectorsByColumn(k[L]);ie&&w.push({objectName:"",selectorsByColumn:ie})}return w},M.prototype.createSelectorsByColumn=function(a){var w,L,k=_.find(this.columns,function(ie){return!ie.metadata.isMeasure});k&&((w={})[k.metadata.queryName]=[a.identity],L=w);var Z=_(this.columns).filter(function(ie){return ie.metadata.isMeasure}).map(function(ie){return ie.metadata.queryName}).value();if(L||!_.isEmpty(Z))return{dataMap:L,metadata:Z}},M.getMouseEventPosition=function(a){return{x:a.clientX,y:a.clientY}},M.getMatchingRow=function(a,w){if(_.isEmpty(w))return null;for(var L=0,k=w;L<k.length;L++){var Z=k[L];if((0,de.fS)(Z.identity,a.identity))return Z}return null},M.getMatchingColumnHeader=function(a,w){for(var L=0,k=w;L<k.length;L++){var Z=k[L];if(this.areHeadersEqual(Z,a))return Z}return null},M.areHeadersEqual=function(a,w){return a.metadata.queryName===w.metadata.queryName},M}(),z=A(59151),se=function(){function M(a){this.hostServices=a,this.pendingChanges=[]}return M.prototype.onDataViewChanged=function(){this.pendingChanges=[]},M.getSelector=function(a){return{metadata:a.metadata.queryName}},M.prototype.getPendingChange=function(a){return _.find(this.pendingChanges,function(w){return le.areHeadersEqual(w.header,a)})},M.prototype.queuePendingChange=function(a,w){var L=this.getPendingChange(a);L?L.width=w:this.pendingChanges.push({header:a,width:w})},M.prototype.getColumnWidth=function(a){var w=this.getPendingChange(a);if(w)return w.width;var L=a.metadata.objects;return L?ae.FX.PropColumnWidthValue.getValue(L):void 0},M.prototype.setColumnWidth=function(a,w){this.queuePendingChange(a,w),(0,z.P)([{selector:M.getSelector(a),value:w}],this.hostServices,!1)},M.prototype.getRowHeight=function(a){},M.prototype.setRowHeight=function(a,w){},M.prototype.getRowLevelWidth=function(a){},M.prototype.setRowLevelWidth=function(a,w){o.fF.assertFail("tableExSizeManager:setRowLevelWidth should not be called")},M.prototype.getColumnLevelHeight=function(a){},M.prototype.setColumnLevelHeight=function(a,w){},M.prototype.setMissingWidths=function(a){for(var w=[],L=0,k=a;L<k.length;L++){var Z=k[L],ie=Z.header,ue=Z.width;null==this.getColumnWidth(ie)&&(this.queuePendingChange(ie,ue),w.push({selector:M.getSelector(ie),value:ue}))}_.isEmpty(w)||(0,z.P)(w,this.hostServices,!0)},M.prototype.clearWidths=function(a){for(var w=[],L=0,k=a;L<k.length;L++){var Z=k[L];null!=this.getColumnWidth(Z)&&w.push({selector:M.getSelector(Z),value:void 0}),this.queuePendingChange(Z,void 0)}_.isEmpty(w)||(0,z.P)(w,this.hostServices,!0)},M}(),ve=A(67016),be=A(48645),Ce=function(){function M(a,w){void 0===a&&(a=(0,j.DH)()),this.options=a,this.featureSwitches=w||{},this.options.tooltipsEnabled=this.options.tooltipsEnabled,this.tooltipType=0,this.asyncSerializer=new t.W,this.supportsOnObject=this.featureSwitches.onObject&&this.featureSwitches.a11yMatrix,this.numFontDelays=0}return M.prototype.init=function(a){var L,w=this;if(this.currentViewport=a.viewport,this.element=a.element,this.hostServices=a.host,this.waitingForData=!1,this.style=a.style,this.tablixPropertyManager=new C.U(this.style),this.selectionManager=new le(this.hostServices),this.sortingManager=new m(this.hostServices,this.featureSwitches.a11yTable),this.sizeManager=new se(this.hostServices),this.tooltipService=(0,i.r)(a.host),this.supportsOnObject){var Z=(null===(L=this.hostServices)||void 0===L?void 0:L.getSubSelectionService())??G.D.createWithDefaultHost();this.subSelectionHelper=K.O5.createHtmlSubselectionHelper({hostElement:this.element.get(0),hostServices:this.hostServices,renderer:new be.y(Z),targetSource:"format",scale:function(){return w.currentViewport.scale},selectorCallback:function(ue){return w.getSelectorsByColumnFromSubselectedElement(ue)}})}},Object.defineProperty(M.prototype,"showTotalPlaceHolders",{get:function(){return this.featureSwitches.onObject&&1===this.viewMode&&this.isSelected},enumerable:!1,configurable:!0}),M.prototype.onViewModeOrIsSelectedChanged=function(a,w,L){var k=this.showTotalPlaceHolders;this.viewMode=a,this.isSelected=w;var Z=this.showTotalPlaceHolders;k!==Z&&this.pivotTableControl instanceof J.d&&(this.pivotTableControl.onShowTotalPlaceHoldersChanged(Z),L||this.pivotTableControl.renderAsync(X.BM.ClearMeasurement))},M.prototype.onViewModeChanged=function(a){this.onViewModeOrIsSelectedChanged(a,this.isSelected)},M.prototype.onSelectionStateChanged=function(a){this.onViewModeOrIsSelectedChanged(this.viewMode,a)},M.prototype.update=function(a){return(0,N.__awaiter)(this,void 0,void 0,function(){var w=this;return(0,N.__generator)(this,function(L){switch(L.label){case 0:return null!=a.viewMode&&this.onViewModeOrIsSelectedChanged(a.viewMode,this.isSelected,!0),this.currentViewport=a.viewport,[4,this.asyncSerializer.enqueue(function(){return(0,N.__awaiter)(w,void 0,void 0,function(){var k,Z,ie,ue;return(0,N.__generator)(this,function(fe){switch(fe.label){case 0:return document.fonts&&"loaded"!==document.fonts.status&&this.numFontDelays<2?[4,new Promise(function(ge){return setTimeout(ge,500)})]:[3,2];case 1:return fe.sent(),this.numFontDelays++,[3,0];case 2:return a.type&b.EP.Data||2===a.resizeMode?[4,this.onDataViewChanged(a.dataViews,a.operationKind,a.viewport)]:[3,4];case 3:fe.sent(),fe.label=4;case 4:return this.pivotTableControl&&a.type&b.EP.Resize?(this.pivotTableControl.setWidth(a.viewport.width),this.pivotTableControl.setHeight(a.viewport.height),[4,this.renderControl(X.BM.Incremental,null,null)]):[3,6];case 5:fe.sent(),fe.label=6;case 6:return this.supportsOnObject?a.formatMode===this.formatMode?[3,8]:(this.formatMode=a.formatMode,this.subSelectionHelper.setFormatMode(a.formatMode),a.formatMode?(this.element.get(0).setAttribute(K.y3,"true"),this.selectionManager.clearLocal()):this.element.get(0).removeAttribute(K.y3),this.pivotTableControl&&this.pivotTableControl instanceof J.d?(this.pivotTableControl.getBinder().setFormatMode(a.formatMode),[4,this.pivotTableControl.renderAsync(X.BM.ClearRendering)]):[3,8]):[3,8];case 7:fe.sent(),fe.label=8;case 8:return k=a.type&b.EP.Data||a.type&b.EP.Resize||a.type&b.EP.FormattingSubSelectionChange,Z=a.type&b.EP.FormattingSubSelectionChange,this.subSelectionHelper&&k&&(this.subSelectionHelper.updateOutlinesFromSubSelections(a.subSelections,!0),this.hostServices.alertScreenReader&&Z&&(ie=this.subSelectionHelper.getLabelsFromSubSelections(a.subSelections,["aria-label"]),(ue=ie?.length&&ie.join(" "))&&this.hostServices.alertScreenReader(ue))),[2]}})})})];case 1:return L.sent(),[2]}})})},M.prototype.updatePersistedWidths=function(a){var w=ae.FX.PropColumnPivotTableAutoSizeColumns.getValue(this.dataView.metadata.objects);if(!w&&this.pivotTableControl){for(var L=[],k=this.columnHierarchyNavigator.getColumns(),ie=0,ue=0,fe=this.pivotTableControl.getColumnWidthMeasureManager().getPageColumns();ue<fe.length;ue++)for(var E=0,re=fe[ue].getColumnWidths();E<re.length;E++)L.push({header:k[ie],width:re[E]}),ie++;this.sizeManager.setMissingWidths(L)}else w&&a&&a.metadata&&a.metadata.objects&&!ae.FX.PropColumnPivotTableAutoSizeColumns.getValue(a.metadata.objects)&&this.sizeManager.clearWidths(this.columnHierarchyNavigator.getColumns())},M.prototype.onDataViewChanged=function(a,w,L){return(0,N.__awaiter)(this,void 0,void 0,function(){var k,Z,ie=this;return(0,N.__generator)(this,function(ue){switch(ue.label){case 0:return _.isEmpty(a)?[3,5]:(k=this.dataView,this.dataView=a[0],this.formattingProperties=this.tablixPropertyManager.getTableExObjects(this.dataView,function(fe){for(var ge,B=[],E=1;E<arguments.length;E++)B[E-1]=arguments[E];return(ge=ie.hostServices).getLocalizedString.apply(ge,(0,N.__spreadArray)([fe],B||[],!1))},this.style,this.featureSwitches),Z=!this.dataView.metadata.segment,w!==b.su.Append?[3,2]:[4,this.onAppendDataView(k,Z)]);case 1:return ue.sent(),[3,4];case 2:return[4,this.onNewDataView(k,L,Z)];case 3:ue.sent(),ue.label=4;case 4:return[3,6];case 5:this.dataView=void 0,this.selectionManager.onDataViewChanged(void 0,void 0),this.interactionManager&&this.interactionManager.onDataViewChanged(void 0,void 0),this.pivotTableControl&&this.pivotTableControl.clear(),ue.label=6;case 6:return this.waitingForData=!1,[2]}})})},M.prototype.onAppendDataView=function(a,w){return(0,N.__awaiter)(this,void 0,void 0,function(){return(0,N.__generator)(this,function(L){switch(L.label){case 0:return this.updateHierarchyNavigators(w),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),[4,this.renderControl(X.BM.Incremental,null,null)];case 1:return L.sent(),[2]}})})},M.prototype.onNewDataView=function(a,w,L){return(0,N.__awaiter)(this,void 0,void 0,function(){var k,Z,ie;return(0,N.__generator)(this,function(ue){switch(ue.label){case 0:return k=this.getPreviousVisibleRowStart(),Z=this.getPreviousVisibleColumnStart(),this.createOrUpdateControlAndNavigators(L),this.sizeManager.onDataViewChanged(),this.selectionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.interactionManager&&this.interactionManager.onDataViewChanged(this.rowHierarchyNavigator,this.columnHierarchyNavigator),this.pivotTableControl.setWidth(w.width),this.pivotTableControl.setHeight(w.height),ie=this.hostServices.tooltips(),this.tooltipType=this.options.tooltipsEnabled&&ie&&ie.enabled()?1:0,this.interactionManager&&this.interactionManager.setTooltipsEnabled(1===this.tooltipType),this.binder.updateFormattingProperties(this.dataView,this.formattingProperties,this.style,0===this.tooltipType),[4,this.renderControl(X.BM.ClearMeasurement,this.getVisibleRowStart(k,m.hasSortingChanged(a,this.dataView)),this.getVisibleColumnStart(Z))];case 1:return ue.sent(),this.updatePersistedWidths(a),[2]}})})},M.prototype.onClearSelection=function(){this.selectionManager.clearLocal(),this.renderSelection()},M.prototype.onRestoreSelection=function(a){if(this.selectionManager){var w=this.selectionManager.restoreSelection(a.selection);return this.renderSelection(),w}return!1},M.prototype.updateHierarchyNavigators=function(a){this.rowHierarchyNavigator.update(this.dataView.table.rows,this.dataView.table.identity,this.dataView.table.totals,a,this.dataView.table.columns,this.formattingProperties),this.columnHierarchyNavigator.update(this.dataView.table.columns)},M.prototype.renderControl=function(a,w,L){return this.pivotTableControl.renderAsync(a,w,L)},M.prototype.getPreviousVisibleRowStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleRowStart();if(!a)return null;var w=this.rowHierarchyNavigator.getHierarchyLeafAt(a.rowIndex);return w?{item:w,offset:a.visibleHeight}:null}},M.prototype.getPreviousVisibleColumnStart=function(){if(this.pivotTableControl){var a=this.pivotTableControl.getVisibleColumnStart();if(!a)return null;var w=this.columnHierarchyNavigator.getHierarchyLeafAt(a.columnIndex);return w?{item:w,offset:a.visibleWidth}:null}},M.prototype.getSelectorsByColumnFromSubselectedElement=function(a){var L,w=this;if(o.fF.assert(function(){return w.supportsOnObject},"Should not be calling getSelectorsByColumnFromSubSelectedElement if does not support onObject"),this.pivotTableControl instanceof J.d)switch(d3.select(a).attr(K.Ez)){case"values":case"measure-values":var Z=this.pivotTableControl.getMidRenderer().getItemByElement(a);return null!==(L=Z?.columnMetadata)&&void 0!==L&&L.queryName?{metadata:[Z.columnMetadata.queryName]}:{};default:return{}}},M.prototype.getVisibleRowStart=function(a,w){if(!a||0===this.pivotTableControl.getViewport().top)return null;if(w)return{rowIndex:0,visibleHeight:Number.MAX_VALUE};var L=le.getMatchingRow(a.item,this.rowHierarchyNavigator.getRows());return L&&this.rowHierarchyNavigator.isLeaf(L)?{rowIndex:this.rowHierarchyNavigator.getLeafIndex(L),visibleHeight:a.offset}:null},M.prototype.getVisibleColumnStart=function(a){if(!a||0===this.pivotTableControl.getViewport().left)return null;var w=le.getMatchingColumnHeader(a.item,this.columnHierarchyNavigator.getColumns());return w&&this.columnHierarchyNavigator.isLeaf(w)?{columnIndex:this.columnHierarchyNavigator.getLeafIndex(w),visibleWidth:a.offset}:null},M.prototype.renderSelection=function(){var a;null===(a=this.pivotTableControl)||void 0===a||a.renderAsync(X.BM.ClearRendering)},M.prototype.createOrUpdateControlAndNavigators=function(a){var w=this;if(this.rowHierarchyNavigator||(this.rowHierarchyNavigator=new O(this.tablixPropertyManager.tablixProperties,this.hostServices),this.columnHierarchyNavigator=new x),this.updateHierarchyNavigators(a),!this.pivotTableControl){var L={interactivityIndicatorEnabled:this.options.interactivityIndicatorEnabled,selectionEnabled:this.options.selection&&this.options.selection.enabled,sortIconEnabled:this.options.sorting&&this.options.sorting.showActiveSortIcon,sortingEnabled:this.options.sorting&&this.options.sorting.enabled,hyperlinksEnabled:this.featureSwitches.conditionalTablixWebURL,tablixProperties:this.tablixPropertyManager.tablixProperties,onBindRowHeader:function(re){return w.onBindRowHeader(re)},onHyperlinkClicked:function(re,he){return w.onHyperlinkClicked(re,he)}},k=document.createElement("div");k.className="tableExContainer",this.element.append(k),this.binder=new R(L,this.selectionManager,k,this.hostServices,this.featureSwitches.a11yMatrix);var Z=this.featureSwitches.a11yTable,ie=this.featureSwitches.a11yMatrix,ue=this.supportsOnObject;this.pivotTableControl=new J.d(k,this.sizeManager,this.createControlOptions(),Z,!1,ue,this.featureSwitches.enableCalculationHighlighting,this.hostServices,this.style,this.onVerticalScrollButtonClick.bind(this),this.onHorizontalScrollButtonClick.bind(this),this.options.interactivityIndicatorEnabled,this.showTotalPlaceHolders,this.subSelectionHelper),this.binder.getViewport=ie?function(){return{width:w.pivotTableControl.getWidth(),height:w.pivotTableControl.getHeight()}}:function(){return w.pivotTableControl.getViewport()}.bind(this),this.binder.isHeaderAutoWidth=function(re){return void 0===w.sizeManager.getColumnWidth(re)}.bind(this),this.binder.isBodyCellAutoWidth=function(re){var he=w.columnHierarchyNavigator.getColumns()[re.position.column.index];return void 0===w.sizeManager.getColumnWidth(he)}.bind(this),this.pivotTableControl.setClassName("tableEx"),this.pivotTableControl.setRowNavigator(this.rowHierarchyNavigator),this.pivotTableControl.setColumnNavigator(this.columnHierarchyNavigator),this.pivotTableControl.setBinder(this.binder)}},M.prototype.createControlOptions=function(){var a=this,w=this.options.scrolling.enabled,L=this.options.columnResizing.enabled;this.options.tooltipsEnabled&&(this.interactionManager=this.interactionManager=new te(this.tooltipService,this.selectionManager,this.hostServices.getLocalizedString(F.qT)));var k=this.interactionManager;return this.options.selection.enabled?{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:null,columnHeaderClickHandler:function(ie,ue){return a.onColumnHeaderClickHandler(ie,ue)},columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:!this.formatMode&&k?k.getHeaderHandler():null,columnHeaderFocusHandler:function(ie){return null},bodyCellClickHandler:function(ie,ue,fe,ge){return!a.formatMode&&a.onBodyCellClick(ie,ue,fe,ge)},bodyCellContextMenuHandler:function(ie,ue){return!a.formatMode&&a.onBodyCellContextMenu(ie,ue)},bodyCellInteractionHandler:!this.formatMode&&k?k.getBodyHandler():null,bodyCellFocusHandler:function(ie,ue){return null},cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:function(ie,ue){return!a.formatMode&&a.onContentActivation(ie,ue)},whitespaceClickHandler:function(ie,ue){return!a.formatMode&&a.onWhitespaceClick(ue)},scrollingEnabled:w,columnResizingEnabled:L,rowLevelResizingEnabled:!1,onScroll:function(){return a.onScroll()}}:{rowHeaderClickHandler:null,rowHeaderContextMenuHandler:null,rowHeaderInteractionHandler:null,rowHeaderFocusHandler:null,rowHeaderExpandCollapseHandler:null,columnHeaderClickHandler:null,columnHeaderContextMenuHandler:null,columnHeaderInteractionHandler:k?k.getHeaderHandler():null,columnHeaderFocusHandler:null,bodyCellClickHandler:null,bodyCellContextMenuHandler:null,bodyCellInteractionHandler:k?k.getBodyHandler():null,bodyCellFocusHandler:null,cornerCellClickHandler:null,cornerCellContextMenuHandler:null,cornerCellInteractionHandler:null,cornerCellFocusHandler:null,cellContentActivationHandler:null,whitespaceClickHandler:null,scrollingEnabled:w,columnResizingEnabled:L,rowLevelResizingEnabled:!1,onScroll:function(){return a.onScroll()}}},M.prototype.onScroll=function(){this.interactionManager&&!this.interactionManager.tooltipVisible()&&this.interactionManager.hideTooltip()},M.prototype.onHyperlinkClicked=function(a,w){this.hostServices.onHyperlinkClick(a,w)},M.prototype.onColumnHeaderClickHandler=function(a,w){this.supportsOnObject&&this.formatMode?this.subSelectionHelper.isVisualObjectSubSelected({objectName:"columnHeaders",selectorsByColumn:{}})&&this.onColumnHeaderClick(a,w):this.onColumnHeaderClick(a,w)},M.prototype.onBodyCellClick=function(a,w,L,k){if(k!==X.p0.Footer||a)if(o.fF.assert(function(){return null!=a&&null!=w||null!=L},"cell or row should be defined"),a){if(!this.selectionManager.isDrillingEnabled(a,w)){var Z=void 0;if(1==(Z=h.M.isCtrlOrMeta(w)||1===this.hostServices.dataMultiSelectMode()?3:w.shiftKey?1:0)&&this.selectionManager.isItemSelected(this.selectionManager.getRowFromCell(a))||1===Z&&a.isRowGrandTotal)return;this.selectionManager.onBodyCellClick(a,Z),this.renderSelection(),this.announceSelectionState(a,void 0)}}else{if(1==(Z=w?.shiftKey?1:3)&&this.selectionManager.isItemSelected(this.selectionManager.getRowAtIndex(L)))return;this.selectionManager.onBodyCellClick(void 0,Z,L),this.renderSelection(),this.announceSelectionState(a,L)}},M.prototype.onBodyCellContextMenu=function(a,w){w.stopPropagation(),w.preventDefault(),this.selectionManager.onBodyCellContextMenu(a,w)},M.prototype.onVerticalScrollButtonClick=function(a,w){var L=this.hostServices.getLocalizedString("Table_Location_Vertical",this.getScrollRowIndex(a),this.getScrollRowIndex(w));this.hostServices.alertScreenReader(L)},M.prototype.onHorizontalScrollButtonClick=function(a,w){var L=this.hostServices.getLocalizedString("Table_Location_Horizontal",this.getScrollColumnIndex(a),this.getScrollColumnIndex(w));this.hostServices.alertScreenReader(L)},M.prototype.getScrollRowIndex=function(a){return 0===a?1:(0,Y.Hd)(a)},M.prototype.getScrollColumnIndex=function(a){return 0===a?1:(0,Y.jT)(a)},M.prototype.announceSelectionState=function(a,w){var L;o.fF.assert(function(){return null!=a||null!=w},"cell or row should be defined");var k=this.rowHierarchyNavigator.getHierarchyLeafAt(null!==(L=a?.position.row.index)&&void 0!==L?L:w),Z=this.selectionManager.isItemSelected(k),ie=this.hostServices.getLocalizedString(Z?F.b:F.TV);this.hostServices.alertScreenReader(ie)},M.prototype.onColumnHeaderClick=function(a,w){a&&this.dataView&&this.options.sorting.enabled&&this.sortingManager.sort(a,this.dataView.table.columns,w.shiftKey)},M.prototype.onContentActivation=function(a,w){o.fF.assertValue(a,"onContentActivated - null cellElement");var L=a.querySelector("a");L&&L.dispatchEvent(w)},M.prototype.onWhitespaceClick=function(a){if(this.selectionManager.onWhitespaceClick(),this.renderSelection(),a){var w=this.hostServices.getLocalizedString("Tablix_Selections_Cleared");this.hostServices.alertScreenReader(w)}},M.prototype.onBindRowHeader=function(a){this.needsMoreData(a)&&(this.featureSwitches.a11yMatrix?setTimeout(this.hostServices.loadMoreData):this.hostServices.loadMoreData(),this.waitingForData=!0,this.hostServices.alertScreenReader(this.hostServices.getLocalizedString("Table_Loading_More_Data")))},M.prototype.needsMoreData=function(a){if(this.waitingForData||!this.dataView||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var L=this.rowHierarchyNavigator.getHierarchyLeafCount()*F.sR;return this.rowHierarchyNavigator.getLeafIndex(a)>=L},M.prototype.getFormattingModel=function(){if(this.dataView)return this.tablixPropertyManager.getFormattingModel(this.hostServices,this.formattingProperties,this.dataView,c.Y.TableEx,void 0,this.featureSwitches,this.style)},M.prototype.enumerateObjectInstances=function(a){var w=this,L=new ce.G;return this.dataView&&this.tablixPropertyManager.enumerateObjectInstances(a,L,this.dataView,c.Y.TableEx,function(k){for(var Z,ie=[],ue=1;ue<arguments.length;ue++)ie[ue-1]=arguments[ue];return(Z=w.hostServices).getLocalizedString.apply(Z,(0,N.__spreadArray)([k],ie||[],!1))},this.featureSwitches,void 0,this.style),L.complete()},M.prototype.enumerateObjectRepetition=function(){var a=[];return this.dataView&&this.tablixPropertyManager.enumerateObjectRepetition(a,this.dataView,c.Y.TableEx,this.featureSwitches),a},M.prototype.getSubSelectablesAsync=function(a){var w;return(0,N.__awaiter)(this,void 0,void 0,function(){return(0,N.__generator)(this,function(L){switch(L.label){case 0:return[4,null===(w=this.pivotTableControl)||void 0===w?void 0:w.renderAsync(X.BM.Incremental)];case 1:return L.sent(),[2,this.subSelectionHelper.getAllSubSelectables(a)]}})})},M.prototype.getSubSelectionStyles=function(a){if(this.supportsOnObject){var k,Z,L=_.first(a).visualObjects;if(!(L.length>0))return;switch(k=L[0],_.isEmpty(k.selectorsByColumn)||(Z=(0,V.tV)(k.selectorsByColumn)),k.objectName){case"columnHeaders":var ie=(0,ee.RM)(this.hostServices,{boldReference:d.Z.columnHeaders.bold,italicReference:d.Z.columnHeaders.italic,underlineReference:d.Z.columnHeaders.underline,fontColorReference:d.Z.columnHeaders.fontColor,fontFamilyReference:d.Z.columnHeaders.fontFamily,fontSizeReference:d.Z.columnHeaders.fontSize,backgroundReference:d.Z.columnHeaders.backColor,horizontalAlignmentReference:d.Z.columnHeaders.alignment,wordWrapReference:d.Z.columnHeaders.wordWrap});return ie.grid={type:"contextmenu"},ie.border={type:"contextmenu"},(0,N.__assign)({type:1},ie);case"totals":var ue=(0,ee.RM)(this.hostServices,{boldReference:d.Z.total.bold,italicReference:d.Z.total.italic,underlineReference:d.Z.total.underline,fontColorReference:d.Z.total.fontColor,fontFamilyReference:d.Z.total.fontFamily,fontSizeReference:d.Z.total.fontSize,backgroundReference:d.Z.total.backColor});return ue.grid={type:"contextmenu"},ue.border={type:"contextmenu"},(0,N.__assign)({type:1},ue);case"values":case"measure-values":if(!Z)return;var fe=this.columnHierarchyNavigator.getColumnIndexFromQueryName(Z.metadata);return(0,ee.xs)(this.hostServices,{fontFamilyReference:d.Z.values.fontFamily,fontSizeReference:d.Z.values.fontSize,boldReference:d.Z.values.bold,italicReference:d.Z.values.italic,underlineReference:d.Z.values.underline,fontColorReference:(0,N.__assign)((0,N.__assign)({},d.Z.columnFormatting.fontColor),{selector:Z}),precisionReference:(0,N.__assign)((0,N.__assign)({},d.Z.columnFormatting.labelPrecision),{selector:Z}),displayUnitsReference:(0,N.__assign)((0,N.__assign)({},d.Z.columnFormatting.labelDisplayUnits),{selector:Z}),backgroundReference:(0,N.__assign)((0,N.__assign)({},d.Z.columnFormatting.backColor),{selector:Z}),horizontalAlignmentReference:(0,N.__assign)((0,N.__assign)({},d.Z.columnFormatting.alignment),{selector:Z}),wordWrapReference:d.Z.values.wordWrap},{precision:{defaultPrecision:(0,H.h1)(void 0,(0,H.v1)(fe.metadata.type))},grid:{type:"contextmenu"},border:{type:"contextmenu"}})}}},M.prototype.getBorderShortcuts=function(a){var w;switch(a){case"columnHeaders":w=d.Z.columnHeaders.outlineStyle;break;case"totals":w=d.Z.total.outlineStyle;break;case"values":case"measure-values":w=d.Z.values.outlineStyle;break;default:return}return[{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},w),{value:P.$m.Nil})],label:this.hostServices.getLocalizedString("Format_Border_NoBorder"),icon:"NoBorder_16"},{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},w),{value:P.$m.Top|P.$m.Bottom|P.$m.Left|P.$m.Right})],label:this.hostServices.getLocalizedString("Format_Border_AllBorders"),icon:"BoxBorder_16"},{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},w),{value:P.$m.Top})],label:this.hostServices.getLocalizedString("Format_Border_TopBorder"),icon:"TopBorder_16"},{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},w),{value:P.$m.Bottom})],label:this.hostServices.getLocalizedString("Format_Border_BottomBorder"),icon:"BottomBorder_16"},{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},w),{value:P.$m.Bottom|P.$m.Top})],label:this.hostServices.getLocalizedString("Format_Border_TopAndBottomBorder"),icon:"TopAndThickBottomBorder_16"},{type:7},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("grid"),groupUid:"".concat("grid","-").concat("border")},label:this.hostServices.getLocalizedString("Format_Border")}]},M.prototype.getGridShortcuts=function(){return[{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridVertical),{value:!0,isTopLevelToggle:!0}),(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridHorizontal),{value:!0,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Small_Multiples_Layout_Grid_Line_Type_Inner"),icon:"AccessGridlinesBoth_16"},{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridVertical),{value:!1,isTopLevelToggle:!0}),(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridHorizontal),{value:!0,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_Horizontal"),icon:"AccessGridlinesHorizontal_16"},{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridVertical),{value:!0,isTopLevelToggle:!0}),(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridHorizontal),{value:!1,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_Vertical"),icon:"AccessGridlinesVertical_16"},{type:9,referencesAndValues:[(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridVertical),{value:!1,isTopLevelToggle:!0}),(0,N.__assign)((0,N.__assign)({},d.Z.grid.gridHorizontal),{value:!1,isTopLevelToggle:!0})],label:this.hostServices.getLocalizedString("Visual_Gridline_None"),icon:"AccessGridlinesNone_16"},{type:7},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("grid"),groupUid:"".concat("grid","-").concat("gridHorizontal")},label:this.hostServices.getLocalizedString("Format_Grid")}]},M.prototype.getSubSelectionShortcuts=function(a,w){if(this.supportsOnObject){var Z,ie,k=_.first(a).visualObjects;if(!(k.length>0))return;if(Z=k[0],w)switch(w){case"grid":return this.getGridShortcuts();case"border":return this.getBorderShortcuts(Z.objectName)}switch(_.isEmpty(Z.selectorsByColumn)||(ie=(0,V.tV)(Z.selectorsByColumn)),Z.objectName){case"columnHeaders":return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("columnHeaders"),groupUid:"".concat("columnHeaders","-").concat("text")},label:this.hostServices.getLocalizedString("Format_Column_Headers")}];case"totals":case"total-labels":var ue="".concat("totals","-").concat("values");return[{type:0},{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("totals"),groupUid:ue},label:this.hostServices.getLocalizedString("total-labels"===Z.objectName?"Format_Total_Label":"Format_Totals")}];case"values":case"measure-values":var fe="".concat("values","-").concat("values"),ge=[{type:1,destinationInfo:{cardUid:"".concat("Visual","-").concat("values"),groupUid:fe},label:this.hostServices.getLocalizedString("Format_Values")}];if("measure-values"===Z.objectName){var B=ie?this.tablixPropertyManager.getConditionalFormattingSelector(c.Y.TableEx,ie.metadata):void 0;ge.unshift({type:8,shortcuts:[(0,N.__assign)((0,N.__assign)({type:6,label:this.hostServices.getLocalizedString("Background_Color")},ve.t.values.backColor),{selector:B}),(0,N.__assign)((0,N.__assign)({type:6,label:this.hostServices.getLocalizedString("Visual_FontColor")},ve.t.values.fontColor),{selector:B}),(0,N.__assign)((0,N.__assign)({type:6,label:this.hostServices.getLocalizedString("Visual_ConditionalFormatting_DataBars")},ve.t.columnFormatting.dataBars),{selector:ie?this.tablixPropertyManager.getConditionalFormattingSelector(c.Y.TableEx,ie.metadata,!1):void 0}),(0,N.__assign)((0,N.__assign)({type:6,label:this.hostServices.getLocalizedString("Visual_Tablix_Icons")},ve.t.values.icon),{selector:B}),{type:7},{type:1,destinationInfo:(0,N.__assign)((0,N.__assign)({},ve.t.values.backColor),{selector:B}),label:this.hostServices.getLocalizedString("Format_Cell_Elements")}],label:this.hostServices.getLocalizedString("Format_AddCellElements")})}return ge.unshift({type:0}),ge}}},M.prototype.onDataViewObjectChanged=function(a,w){if(!this.supportsOnObject||!this.formatMode||1!==w)return a;for(var L={objectName:"columnFormatting",propertyName:"styleValues"},k={objectName:"columnFormatting",propertyName:"backColor"},Z={objectName:"columnFormatting",propertyName:"fontColor"},ie={objectName:"columnFormatting",propertyName:"alignment"},ue=[],fe=0,ge=a;fe<ge.length;fe++){var E=ge[fe].selector;if(E&&E.metadata){var re=this.formattingProperties.columnFormatting[E.metadata],he=re.styleValues||re.styleHeader||re.styleTotal;ue.push(pe.v.create(k,he).onToggleEnabled(oe.W.createBooleanDataViewObjectChange(L,!0,{selector:E})),pe.v.create(Z,he).onToggleEnabled(oe.W.createBooleanDataViewObjectChange(L,!0,{selector:E})),pe.v.create(ie,he).onToggleEnabled(oe.W.createBooleanDataViewObjectChange(L,!0,{selector:E})))}}return Q.o.applyDataViewObjectsBehaviorChanges(a,Q.o.getDataViewObjectsBehaviorChanges(a,ue))},M}()},44245:function(Te,Pe,A){A.d(Pe,{Yc:function(){return o},aV:function(){return ae},cP:function(){return i},ji:function(){return P}});var N=A(54522),pe=A(55007),Q=A(40550),oe=A(32041),ce=A(64329),ee=A(48066),K=A(66001),G=A(93340),j=A(71090);function ae(t,h,b,V,H){var X,J;h.fontFamily=j.F2,h.fontColor=j.lN,h.borders.bottom=new G.om(pe.FX.PropGridOutlineWeight.defaultValue,H.PropGridOutlineColor.getValue(null));var Y=b.grid,F=b.columnHeaders,d=b.total.outline,T=F.outline,U=b.values.outline,D=null!==(X=F.outlineWeight)&&void 0!==X?X:Y.outlineWeight,I=null!==(J=F.outlineColor)&&void 0!==J?J:Y.outlineColor;h.borders.top=new G.om,h.borders.top.applyParams((0,Q.yo)(T),D,I,G.Pb.Outline),h.borders.bottom=new G.om,h.borders.bottom.applyParams((0,Q.mv)(T),D,I,G.Pb.Outline),h.borders.left=new G.om,t.column.isFirst&&(h.borders.left.applyParams((0,Q.fs)(T),D,I,G.Pb.Outline),!(0,Q.fs)(T)&&((0,Q.fs)(d)||(0,Q.fs)(U))&&(h.paddings.left+=D)),h.borders.right=new G.om,t.column.isLast?(h.borders.right.applyParams((0,Q.BK)(T),D,I,G.Pb.Outline),!(0,Q.BK)(T)&&((0,Q.BK)(d)||(0,Q.BK)(U))&&(h.paddings.right+=D)):h.borders.right.applyParams(Y.gridVertical,Y.gridVerticalWeight,Y.gridVerticalColor,G.Pb.Gridline),h.fontColor=V&&V.styleHeader&&V.fontColor?V.fontColor:F.fontColor,h.backColor=V&&V.styleHeader&&V.backColor?V.backColor:F.backColor,h.paddings.top=h.paddings.bottom=Y.rowPadding}function i(t,h,b,V,H,X){var J,Y;t.row.isLast||(b.borders.bottom=new G.om(pe.FX.PropGridHorizontalWeight.defaultValue,X.PropGridHorizontalColor.getValue(null)));var F=V.grid,c=V.values,T=V.total.outline,U=c.outline,D=V.columnHeaders.outline,I=null!==(J=c.outlineWeight)&&void 0!==J?J:F.outlineWeight,q=null!==(Y=c.outlineColor)&&void 0!==Y?Y:F.outlineColor;b.borders.top=new G.om,t.row.isFirst&&b.borders.top.applyParams((0,Q.yo)(U),I,q,G.Pb.Outline),b.borders.bottom=new G.om,t.row.isLast?b.borders.bottom.applyParams((0,Q.mv)(U),I,q,G.Pb.Outline):b.borders.bottom.applyParams(F.gridHorizontal,F.gridHorizontalWeight,F.gridHorizontalColor,G.Pb.Gridline),b.borders.left=new G.om,t.column.isFirst&&(b.borders.left.applyParams((0,Q.fs)(U),I,q,G.Pb.Outline),!(0,Q.fs)(U)&&((0,Q.fs)(T)||(0,Q.fs)(D))&&(b.paddings.left+=I)),b.borders.right=new G.om,t.column.isLast?(b.borders.right.applyParams((0,Q.BK)(U),I,q,G.Pb.Outline),!(0,Q.BK)(U)&&((0,Q.BK)(T)||(0,Q.BK)(D))&&(b.paddings.right+=I)):b.borders.right.applyParams(F.gridVertical,F.gridVerticalWeight,F.gridVerticalColor,G.Pb.Gridline),b.fontColor=h.fontColor?h.fontColor:H&&H.styleValues&&H.fontColor?H.fontColor:t.row.index%2==0?c.fontColorPrimary:c.fontColorSecondary,b.backColor=h.backColor?h.backColor:H&&H.styleValues&&H.backColor?H.backColor:t.row.index%2==0?c.backColorPrimary:c.backColorSecondary,b.paddings.top=b.paddings.bottom=F.rowPadding}function P(t,h,b,V,H,X){var J,Y;b.fontFamily=j.Zk,b.borders.top=new G.om(pe.FX.PropGridOutlineWeight.defaultValue,X.PropGridOutlineColor.getValue(null));var v,e,F=V.total,c=V.grid,T=F.outline,U=V.values.outline,D=V.columnHeaders.outline,I=null!==(J=F.outlineWeight)&&void 0!==J?J:c.outlineWeight,q=null!==(Y=F.outlineColor)&&void 0!==Y?Y:c.outlineColor;b.borders.top=new G.om,b.borders.top.applyParams((0,Q.yo)(T),I,q,G.Pb.Outline),b.borders.bottom=new G.om,b.borders.bottom.applyParams((0,Q.mv)(T),I,q,G.Pb.Outline),b.borders.left=new G.om,t.column.isFirst&&(b.borders.left.applyParams((0,Q.fs)(T),I,q,G.Pb.Outline),!(0,Q.fs)(T)&&((0,Q.fs)(U)||(0,Q.fs)(D))&&(b.paddings.left+=I)),b.borders.right=new G.om,t.column.isLast?(b.borders.right.applyParams((0,Q.BK)(T),I,q,G.Pb.Outline),!(0,Q.BK)(T)&&((0,Q.BK)(U)||(0,Q.BK)(D))&&(b.paddings.right+=I)):b.borders.right.applyParams(c.gridVertical,c.gridVerticalWeight,c.gridVerticalColor,G.Pb.Gridline),H&&H.styleTotal&&(v=H.fontColor,e=H.backColor),b.fontColor=h.fontColor||v||F.fontColor,b.backColor=h.backColor||e||F.backColor,b.paddings.top=b.paddings.bottom=c.rowPadding}var o=function(){function t(h,b){this.options=h,b&&this.updateDataView(b)}return t.prototype.updateDataView=function(h){this.tableDataView=h,this.formattingProperties=h.formattingProperties,this.updateTextHeights(),this.rowHeight=this.hasImage()?Math.max(this.textHeightValue,this.formattingProperties.grid.imageHeight):this.textHeightValue},t.prototype.updateTextHeights=function(){this.fontSizeHeader=this.formattingProperties.general.textSize.px,this.textPropsHeader={fontFamily:j.F2,fontSize:ce.FP.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(oe.b.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=this.formattingProperties.general.textSize.px,this.textPropsValue={fontFamily:j.dG,fontSize:ce.FP.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(oe.b.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=this.formattingProperties.general.textSize.px,this.textPropsTotal={fontFamily:j.Zk,fontSize:ce.FP.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(oe.b.measureSvgTextHeight(this.textPropsTotal,"a"))},t.prototype.hasImage=function(){return _.some(this.tableDataView.columns,function(h){return(0,N.pt)(h)})},t.prototype.getColumnFormatting=function(h){return this.formattingProperties.columnFormatting[h.queryName]},t.prototype.onStartRenderingSession=function(){},t.prototype.onEndRenderingSession=function(){},t.prototype.bindRowHeader=function(h,b){b.contentHeight=h.totalCells?this.textHeightTotal:this.rowHeight,(0,G.G9)(b),this.options.onBindRowHeader&&this.options.onBindRowHeader(h)},t.prototype.unbindRowHeader=function(h,b){},t.prototype.bindColumnHeader=function(h,b){var V=this;b.extension.disableDragResize(),(0,G.ey)(b),(0,G.R5)(b,j.f),(0,G.R5)(b,j.mQ);var H=new G.qZ;ae(b.position,H,this.formattingProperties,this.getColumnFormatting(h),this.options.tablixProperties);var X=b.extension.contentHost;(X=(0,G.Ch)(X)).classList.add(j.WA);var Y,J=this.getWordWrappingWidth(h.queryName,b,H);null!=J&&(Y=this.getWordWrappingLines(h.displayName,J));var F=Y&&Y.length>1;if(F){b.contentHeight=Y.length*this.textHeightHeader;for(var c=0,C=Y.length;c<C-1;c++)(0,G.Ch)(X,Y[c]);X=(0,G.Ch)(X)}else b.contentHeight=this.textHeightHeader;this.sortIconsEnabled()&&(X=(0,G.D6)(h.sort,X),h.sort&&!F&&(b.contentWidth=this.fontSizeHeader+j.fG));var d=h.displayName;if(F){var T=_.last(Y);(0,G.AB)(T,X),(0,G.v4)(d,b.extension.contentHost),b.contentWidth=J}else(0,G.DM)(d,X,b.extension.contentHost),b.contentWidth+=oe.b.measureSvgTextWidth(this.textPropsHeader,d);b.contentWidth=Math.ceil(b.contentWidth),this.options.onColumnHeaderClick&&b.extension.registerClickHandler(function(I){if((0,G.xl)(I)){var q=(0,G.x7)(h.sort);V.options.onColumnHeaderClick(h.queryName?h.queryName:h.displayName,q)}}),b.applyStyle(H)},t.prototype.getWordWrappingLines=function(h,b){return(0,K.ql)(h,this.textPropsHeader,oe.b.measureSvgTextWidth,b,j.uZ,void 0,!0)},t.prototype.getWordWrappingWidth=function(h,b,V){var H;if(this.formattingProperties.columnHeaders.wordWrap&&0===this.options.layoutKind&&(b.isColumnResizing()&&b.containerWidth>=0?H=b.containerWidth:this.options.columnWidthManager&&(H=this.options.columnWidthManager.getPersistedColumnWidth(h)),null!=H))return Math.max(0,H-(V.getExtraLeft()+V.getExtraRight()))},t.prototype.unbindColumnHeader=function(h,b){(0,G.G9)(b),(0,G.aP)(b),this.sortIconsEnabled()&&(0,G.Y4)(b),this.options.onColumnHeaderClick&&b.extension.unregisterClickHandler()},t.prototype.bindBodyCell=function(h,b){(0,G.ey)(b),this.setBodyContent(h,b),b.contentWidth=Math.ceil(b.contentWidth),h.isTotal?((0,G.R5)(b,j.R9),(0,G.R5)(b,j.s$)):(0,G.R5)(b,h.position.row.isLast?j.zq:j.JM),h.isNumeric&&(0,G.R5)(b,j.s0);var V=new G.qZ;h.isTotal?P(b.position,h,V,this.formattingProperties,this.getColumnFormatting(h.columnMetadata),this.options.tablixProperties):i(b.position,h,V,this.formattingProperties,this.getColumnFormatting(h.columnMetadata),this.options.tablixProperties),b.applyStyle(V)},t.prototype.setBodyContent=function(h,b){var V=b.extension.contentHost,H=this.formattingProperties.grid.imageHeight,X=h.textContent;b.contentHeight=h.isTotal?this.textHeightTotal:h.isImage?H:this.textHeightValue;var J=(0,G.MN)(h.columnMetadata,h.textContent);if(J!==ee.av.NONE){var Y=this.formattingProperties.values.urlIcon,F=void 0;return Y&&(F=(0,G.RP)(J)),Y&&null!=F?(0,G.vU)(X,V,F):(0,G.vU)(X,V),void(b.contentWidth=Y?this.fontSizeValue:oe.b.measureSvgTextWidth(this.textPropsValue,X))}if(h.isImage&&(0,ee.gU)(X))return(0,G.Hx)(X,V,H),void(b.contentWidth=H*j.wd);var c=h.kpiContent;return c?($(V).append(c),void(b.contentWidth=this.fontSizeValue)):X?((0,G.DM)(X,V),void(b.contentWidth=oe.b.measureSvgTextWidth(h.isTotal?this.textPropsTotal:this.textPropsValue,X))):((0,G.DM)(" ",V),void(b.contentWidth=0))},t.prototype.unbindBodyCell=function(h,b){(0,G.G9)(b),(0,G.aP)(b)},t.prototype.bindCornerCell=function(h,b){b.contentWidth=0},t.prototype.unbindCornerCell=function(h,b){},t.prototype.bindEmptySpaceHeaderCell=function(h){},t.prototype.unbindEmptySpaceHeaderCell=function(h){},t.prototype.bindEmptySpaceFooterCell=function(h){},t.prototype.unbindEmptySpaceFooterCell=function(h){},t.prototype.getHeaderLabel=function(h){return h?h.displayName:""},t.prototype.getCellContent=function(h){return h},t.prototype.hasRowGroups=function(){return!1},t.prototype.sortIconsEnabled=function(){return 0===this.options.layoutKind},t}()}}]);